/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/lda_exc/lda_x_rel.mpl
  Type of functional: lda_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t8, t10, t11, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23;
  double t27, t28, t29, t30, t35, t36, t37, t41;
  double t42, t43, t44, t48, t49, t51, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t8 = POW_1_3(p->zeta_threshold);
  t10 = my_piecewise3(0.1e1 <= p->zeta_threshold, t8 * p->zeta_threshold, 1);
  t11 = POW_1_3(rho[0]);
  t15 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t11);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t17 * t3;
  t19 = 0.1e1 / M_PI;
  t20 = POW_1_3(t19);
  t21 = t20 * t20;
  t22 = 0.1e1 / t21;
  t23 = t11 * t11;
  t27 = 0.1e1 + 0.38075239991386496937e-4 * t18 * t22 * t23;
  t28 = sqrt(t27);
  t29 = t28 * t17;
  t30 = t3 * t20;
  t35 = t3 * t3;
  t36 = t16 * t35;
  t37 = 0.1e1 / t20;
  t41 = log(0.35625477770544353752e-2 * t36 * t37 * t11 + sqrt(POW_2(0.35625477770544353752e-2 * t36 * t37 * t11) + 0.1e1));
  t42 = t41 * t16;
  t43 = t35 * t21;
  t44 = 0.1e1 / t23;
  t48 = 0.10396221848752237744e2 * t29 * t30 / t11 - 0.97273285855626056446e3 * t42 * t43 * t44;
  t49 = t48 * t48;
  t51 = 0.1e1 - 0.15e1 * t49;
  tzk0 = 0.2e1 * t15 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t8, t10, t11, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23;
  double t27, t28, t29, t30, t35, t36, t37, t41;
  double t42, t43, t44, t48, t49, t51, tzk0;

  double t56, t57, t60, t61, t62, t63, t68, t69;
  double t72, t76, t80, t81, tvrho0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t8 = POW_1_3(p->zeta_threshold);
  t10 = my_piecewise3(0.1e1 <= p->zeta_threshold, t8 * p->zeta_threshold, 1);
  t11 = POW_1_3(rho[0]);
  t15 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t11);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t17 * t3;
  t19 = 0.1e1 / M_PI;
  t20 = POW_1_3(t19);
  t21 = t20 * t20;
  t22 = 0.1e1 / t21;
  t23 = t11 * t11;
  t27 = 0.1e1 + 0.38075239991386496937e-4 * t18 * t22 * t23;
  t28 = sqrt(t27);
  t29 = t28 * t17;
  t30 = t3 * t20;
  t35 = t3 * t3;
  t36 = t16 * t35;
  t37 = 0.1e1 / t20;
  t41 = log(0.35625477770544353752e-2 * t36 * t37 * t11 + sqrt(POW_2(0.35625477770544353752e-2 * t36 * t37 * t11) + 0.1e1));
  t42 = t41 * t16;
  t43 = t35 * t21;
  t44 = 0.1e1 / t23;
  t48 = 0.10396221848752237744e2 * t29 * t30 / t11 - 0.97273285855626056446e3 * t42 * t43 * t44;
  t49 = t48 * t48;
  t51 = 0.1e1 - 0.15e1 * t49;
  tzk0 = 0.2e1 * t15 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t56 = my_piecewise3(t2, 0, -t6 * t10 * t44 / 0.8e1);
  t57 = rho[0] * t56;
  t60 = rho[0] * t15;
  t61 = 0.1e1 / t28;
  t62 = t61 * t16;
  t63 = t35 * t37;
  t68 = 0.1e1 / t11 / rho[0];
  t69 = t30 * t68;
  t72 = t61 * t17;
  t76 = 0.1e1 / t23 / rho[0];
  t80 = 0.11875159256848117917e-2 * t62 * t63 * t44 - 0.34654072829174125813e1 * t29 * t69 - 0.34654072829174125814e1 * t72 * t69 + 0.64848857237084037631e3 * t42 * t43 * t76;
  t81 = t48 * t80;
  tvrho0 = tzk0 + 0.2e1 * t57 * t51 - 0.6e1 * t60 * t81;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t8, t10, t11, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23;
  double t27, t28, t29, t30, t35, t36, t37, t41;
  double t42, t43, t44, t48, t49, t51, tzk0;

  double t56, t57, t60, t61, t62, t63, t68, t69;
  double t72, t76, t80, t81, tvrho0;

  double t86, t92, t93, t98, t102, t106, t109, t111;
  double t112, t115, t121, t125, t126, tv2rho20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t8 = POW_1_3(p->zeta_threshold);
  t10 = my_piecewise3(0.1e1 <= p->zeta_threshold, t8 * p->zeta_threshold, 1);
  t11 = POW_1_3(rho[0]);
  t15 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t11);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t17 * t3;
  t19 = 0.1e1 / M_PI;
  t20 = POW_1_3(t19);
  t21 = t20 * t20;
  t22 = 0.1e1 / t21;
  t23 = t11 * t11;
  t27 = 0.1e1 + 0.38075239991386496937e-4 * t18 * t22 * t23;
  t28 = sqrt(t27);
  t29 = t28 * t17;
  t30 = t3 * t20;
  t35 = t3 * t3;
  t36 = t16 * t35;
  t37 = 0.1e1 / t20;
  t41 = log(0.35625477770544353752e-2 * t36 * t37 * t11 + sqrt(POW_2(0.35625477770544353752e-2 * t36 * t37 * t11) + 0.1e1));
  t42 = t41 * t16;
  t43 = t35 * t21;
  t44 = 0.1e1 / t23;
  t48 = 0.10396221848752237744e2 * t29 * t30 / t11 - 0.97273285855626056446e3 * t42 * t43 * t44;
  t49 = t48 * t48;
  t51 = 0.1e1 - 0.15e1 * t49;
  tzk0 = 0.2e1 * t15 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t56 = my_piecewise3(t2, 0, -t6 * t10 * t44 / 0.8e1);
  t57 = rho[0] * t56;
  t60 = rho[0] * t15;
  t61 = 0.1e1 / t28;
  t62 = t61 * t16;
  t63 = t35 * t37;
  t68 = 0.1e1 / t11 / rho[0];
  t69 = t30 * t68;
  t72 = t61 * t17;
  t76 = 0.1e1 / t23 / rho[0];
  t80 = 0.11875159256848117917e-2 * t62 * t63 * t44 - 0.34654072829174125813e1 * t29 * t69 - 0.34654072829174125814e1 * t72 * t69 + 0.64848857237084037631e3 * t42 * t43 * t76;
  t81 = t48 * t80;
  tvrho0 = tzk0 + 0.2e1 * t57 * t51 - 0.6e1 * t60 * t81;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t86 = t15 * t48;
  t92 = my_piecewise3(t2, 0, t6 * t10 * t76 / 0.12e2);
  t93 = rho[0] * t92;
  t98 = t80 * t80;
  t102 = 0.1e1 / t28 / t27;
  t106 = t63 * t76;
  t109 = rho[0] * rho[0];
  t111 = 0.1e1 / t11 / t109;
  t112 = t30 * t111;
  t115 = t102 * t16;
  t121 = 0.1e1 / t23 / t109;
  t125 = -0.1278422702025101867e-5 * t102 / rho[0] - 0.11875159256848117917e-2 * t62 * t106 + 0.46205430438898834417e1 * t29 * t112 + 0.39583864189493726391e-3 * t115 * t106 + 0.69308145658348251628e1 * t72 * t112 - 0.10808142872847339605e4 * t42 * t43 * t121;
  t126 = t48 * t125;
  tv2rho20 = 0.4e1 * t56 * t51 - 0.12e2 * t86 * t80 + 0.2e1 * t93 * t51 - 0.12e2 * t57 * t81 - 0.6e1 * t60 * t98 - 0.6e1 * t60 * t126;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t8, t10, t11, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23;
  double t27, t28, t29, t30, t35, t36, t37, t41;
  double t42, t43, t44, t48, t49, t51, tzk0;

  double t56, t57, t60, t61, t62, t63, t68, t69;
  double t72, t76, t80, t81, tvrho0;

  double t86, t92, t93, t98, t102, t106, t109, t111;
  double t112, t115, t121, t125, t126, tv2rho20;

  double t131, t141, t142, t151, t154, t156, t158, t161;
  double t164, t167, t170, t180, t184, t185, tv3rho30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t8 = POW_1_3(p->zeta_threshold);
  t10 = my_piecewise3(0.1e1 <= p->zeta_threshold, t8 * p->zeta_threshold, 1);
  t11 = POW_1_3(rho[0]);
  t15 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t11);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t17 * t3;
  t19 = 0.1e1 / M_PI;
  t20 = POW_1_3(t19);
  t21 = t20 * t20;
  t22 = 0.1e1 / t21;
  t23 = t11 * t11;
  t27 = 0.1e1 + 0.38075239991386496937e-4 * t18 * t22 * t23;
  t28 = sqrt(t27);
  t29 = t28 * t17;
  t30 = t3 * t20;
  t35 = t3 * t3;
  t36 = t16 * t35;
  t37 = 0.1e1 / t20;
  t41 = log(0.35625477770544353752e-2 * t36 * t37 * t11 + sqrt(POW_2(0.35625477770544353752e-2 * t36 * t37 * t11) + 0.1e1));
  t42 = t41 * t16;
  t43 = t35 * t21;
  t44 = 0.1e1 / t23;
  t48 = 0.10396221848752237744e2 * t29 * t30 / t11 - 0.97273285855626056446e3 * t42 * t43 * t44;
  t49 = t48 * t48;
  t51 = 0.1e1 - 0.15e1 * t49;
  tzk0 = 0.2e1 * t15 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t56 = my_piecewise3(t2, 0, -t6 * t10 * t44 / 0.8e1);
  t57 = rho[0] * t56;
  t60 = rho[0] * t15;
  t61 = 0.1e1 / t28;
  t62 = t61 * t16;
  t63 = t35 * t37;
  t68 = 0.1e1 / t11 / rho[0];
  t69 = t30 * t68;
  t72 = t61 * t17;
  t76 = 0.1e1 / t23 / rho[0];
  t80 = 0.11875159256848117917e-2 * t62 * t63 * t44 - 0.34654072829174125813e1 * t29 * t69 - 0.34654072829174125814e1 * t72 * t69 + 0.64848857237084037631e3 * t42 * t43 * t76;
  t81 = t48 * t80;
  tvrho0 = tzk0 + 0.2e1 * t57 * t51 - 0.6e1 * t60 * t81;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t86 = t15 * t48;
  t92 = my_piecewise3(t2, 0, t6 * t10 * t76 / 0.12e2);
  t93 = rho[0] * t92;
  t98 = t80 * t80;
  t102 = 0.1e1 / t28 / t27;
  t106 = t63 * t76;
  t109 = rho[0] * rho[0];
  t111 = 0.1e1 / t11 / t109;
  t112 = t30 * t111;
  t115 = t102 * t16;
  t121 = 0.1e1 / t23 / t109;
  t125 = -0.1278422702025101867e-5 * t102 / rho[0] - 0.11875159256848117917e-2 * t62 * t106 + 0.46205430438898834417e1 * t29 * t112 + 0.39583864189493726391e-3 * t115 * t106 + 0.69308145658348251628e1 * t72 * t112 - 0.10808142872847339605e4 * t42 * t43 * t121;
  t126 = t48 * t125;
  tv2rho20 = 0.4e1 * t56 * t51 - 0.12e2 * t86 * t80 + 0.2e1 * t93 * t51 - 0.12e2 * t57 * t81 - 0.6e1 * t60 * t98 - 0.6e1 * t60 * t126;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t131 = t56 * t48;
  t141 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t10 * t121);
  t142 = rho[0] * t141;
  t151 = t80 * t125;
  t154 = t27 * t27;
  t156 = 0.1e1 / t28 / t154;
  t158 = t18 * t22;
  t161 = 0.1e1 / t109;
  t164 = t63 * t121;
  t167 = t109 * rho[0];
  t170 = t30 / t11 / t167;
  t180 = 0.1e1 / t23 / t167;
  t184 = 0.48676251190042541751e-10 * t156 * t68 * t158 + 0.2556845404050203734e-5 * t102 * t161 + 0.25069780653346026714e-2 * t62 * t164 - 0.10781267102409728031e2 * t29 * t170 - 0.12784227020251018671e-5 * t156 * t161 - 0.14514083536147699677e-2 * t115 * t164 - 0.20022353190189494915e2 * t72 * t170 + 0.28821714327592905613e4 * t42 * t43 * t180;
  t185 = t48 * t184;
  tv3rho30 = 0.6e1 * t92 * t51 - 0.36e2 * t131 * t80 - 0.18e2 * t15 * t98 - 0.18e2 * t86 * t125 + 0.2e1 * t142 * t51 - 0.18e2 * t93 * t81 - 0.18e2 * t57 * t98 - 0.18e2 * t57 * t126 - 0.18e2 * t60 * t151 - 0.6e1 * t60 * t185;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t2, t3, t4, t6, t8, t10, t11, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23;
  double t27, t28, t29, t30, t35, t36, t37, t41;
  double t42, t43, t44, t48, t49, t51, tzk0;

  double t56, t57, t60, t61, t62, t63, t68, t69;
  double t72, t76, t80, t81, tvrho0;

  double t86, t92, t93, t98, t102, t106, t109, t111;
  double t112, t115, t121, t125, t126, tv2rho20;

  double t131, t141, t142, t151, t154, t156, t158, t161;
  double t164, t167, t170, t180, t184, t185, tv3rho30;

  double t191, t219, t227, t237, t240, t243, t246, tv4rho40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t8 = POW_1_3(p->zeta_threshold);
  t10 = my_piecewise3(0.1e1 <= p->zeta_threshold, t8 * p->zeta_threshold, 1);
  t11 = POW_1_3(rho[0]);
  t15 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t10 * t11);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t17 * t3;
  t19 = 0.1e1 / M_PI;
  t20 = POW_1_3(t19);
  t21 = t20 * t20;
  t22 = 0.1e1 / t21;
  t23 = t11 * t11;
  t27 = 0.1e1 + 0.38075239991386496937e-4 * t18 * t22 * t23;
  t28 = sqrt(t27);
  t29 = t28 * t17;
  t30 = t3 * t20;
  t35 = t3 * t3;
  t36 = t16 * t35;
  t37 = 0.1e1 / t20;
  t41 = log(0.35625477770544353752e-2 * t36 * t37 * t11 + sqrt(POW_2(0.35625477770544353752e-2 * t36 * t37 * t11) + 0.1e1));
  t42 = t41 * t16;
  t43 = t35 * t21;
  t44 = 0.1e1 / t23;
  t48 = 0.10396221848752237744e2 * t29 * t30 / t11 - 0.97273285855626056446e3 * t42 * t43 * t44;
  t49 = t48 * t48;
  t51 = 0.1e1 - 0.15e1 * t49;
  tzk0 = 0.2e1 * t15 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t56 = my_piecewise3(t2, 0, -t6 * t10 * t44 / 0.8e1);
  t57 = rho[0] * t56;
  t60 = rho[0] * t15;
  t61 = 0.1e1 / t28;
  t62 = t61 * t16;
  t63 = t35 * t37;
  t68 = 0.1e1 / t11 / rho[0];
  t69 = t30 * t68;
  t72 = t61 * t17;
  t76 = 0.1e1 / t23 / rho[0];
  t80 = 0.11875159256848117917e-2 * t62 * t63 * t44 - 0.34654072829174125813e1 * t29 * t69 - 0.34654072829174125814e1 * t72 * t69 + 0.64848857237084037631e3 * t42 * t43 * t76;
  t81 = t48 * t80;
  tvrho0 = tzk0 + 0.2e1 * t57 * t51 - 0.6e1 * t60 * t81;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t86 = t15 * t48;
  t92 = my_piecewise3(t2, 0, t6 * t10 * t76 / 0.12e2);
  t93 = rho[0] * t92;
  t98 = t80 * t80;
  t102 = 0.1e1 / t28 / t27;
  t106 = t63 * t76;
  t109 = rho[0] * rho[0];
  t111 = 0.1e1 / t11 / t109;
  t112 = t30 * t111;
  t115 = t102 * t16;
  t121 = 0.1e1 / t23 / t109;
  t125 = -0.1278422702025101867e-5 * t102 / rho[0] - 0.11875159256848117917e-2 * t62 * t106 + 0.46205430438898834417e1 * t29 * t112 + 0.39583864189493726391e-3 * t115 * t106 + 0.69308145658348251628e1 * t72 * t112 - 0.10808142872847339605e4 * t42 * t43 * t121;
  t126 = t48 * t125;
  tv2rho20 = 0.4e1 * t56 * t51 - 0.12e2 * t86 * t80 + 0.2e1 * t93 * t51 - 0.12e2 * t57 * t81 - 0.6e1 * t60 * t98 - 0.6e1 * t60 * t126;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t131 = t56 * t48;
  t141 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t10 * t121);
  t142 = rho[0] * t141;
  t151 = t80 * t125;
  t154 = t27 * t27;
  t156 = 0.1e1 / t28 / t154;
  t158 = t18 * t22;
  t161 = 0.1e1 / t109;
  t164 = t63 * t121;
  t167 = t109 * rho[0];
  t170 = t30 / t11 / t167;
  t180 = 0.1e1 / t23 / t167;
  t184 = 0.48676251190042541751e-10 * t156 * t68 * t158 + 0.2556845404050203734e-5 * t102 * t161 + 0.25069780653346026714e-2 * t62 * t164 - 0.10781267102409728031e2 * t29 * t170 - 0.12784227020251018671e-5 * t156 * t161 - 0.14514083536147699677e-2 * t115 * t164 - 0.20022353190189494915e2 * t72 * t170 + 0.28821714327592905613e4 * t42 * t43 * t180;
  t185 = t48 * t184;
  tv3rho30 = 0.6e1 * t92 * t51 - 0.36e2 * t131 * t80 - 0.18e2 * t15 * t98 - 0.18e2 * t86 * t125 + 0.2e1 * t142 * t51 - 0.18e2 * t93 * t81 - 0.18e2 * t57 * t98 - 0.18e2 * t57 * t126 - 0.18e2 * t60 * t151 - 0.6e1 * t60 * t185;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t191 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t10 * t180);
  t219 = t125 * t125;
  t227 = 0.1e1 / t28 / t154 / t27;
  t237 = 0.1e1 / t167;
  t240 = t63 * t180;
  t243 = t109 * t109;
  t246 = t30 / t11 / t243;
  tv4rho40 = 0.2e1 * rho[0] * t191 * t51 - 0.72e2 * t92 * t48 * t80 - 0.72e2 * t56 * t98 - 0.72e2 * t131 * t125 - 0.72e2 * t15 * t80 * t125 - 0.24e2 * t86 * t184 + 0.8e1 * t141 * t51 - 0.24e2 * t142 * t81 - 0.36e2 * t93 * t98 - 0.36e2 * t93 * t126 - 0.72e2 * t57 * t151 - 0.24e2 * t57 * t185 - 0.18e2 * t60 * t219 - 0.24e2 * t60 * t80 * t184 - 0.6e1 * t60 * t48 * (-0.2780039918912823523e-13 * t227 * t76 * t36 / t20 / t19 - 0.16225417063347513917e-9 * t156 * t111 * t158 - 0.78125831790422891872e-5 * t102 * t237 - 0.79167728378987452781e-2 * t62 * t240 + 0.3593755700803242677e2 * t29 * t246 + 0.81127085316737569591e-10 * t227 * t111 * t158 + 0.72443953114755772469e-5 * t156 * t237 + 0.61574899850323574387e-2 * t115 * t240 + 0.77009050731498057365e2 * t72 * t246 - 0.10567961920117398725e5 * t42 * t43 / t23 / t243);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t8, t10;
  double t11, t12, t13, t14, t15, t19, t20, t24;
  double t25, t26, t28, t29, t30, t34, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t51, t52, t53, t54, t59, t60, t61, t65;
  double t66, t67, t68, t72, t73, t75, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t8 = rho[0] * t7;
  t10 = 0.2e1 * t8 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = t11 * p->zeta_threshold;
  t13 = M_CBRT2;
  t14 = t13 * rho[0];
  t15 = POW_1_3(t8);
  t19 = my_piecewise3(t10, t12, 0.2e1 * t14 * t7 * t15);
  t20 = POW_1_3(t6);
  t24 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t20);
  t25 = rho[1] <= p->dens_threshold;
  t26 = rho[1] * t7;
  t28 = 0.2e1 * t26 <= p->zeta_threshold;
  t29 = t13 * rho[1];
  t30 = POW_1_3(t26);
  t34 = my_piecewise3(t28, t12, 0.2e1 * t29 * t7 * t30);
  t38 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t34 * t20);
  t39 = t24 + t38;
  t40 = POW_1_3(0.9e1);
  t41 = t40 * t40;
  t42 = t41 * t2;
  t43 = 0.1e1 / M_PI;
  t44 = POW_1_3(t43);
  t45 = t44 * t44;
  t46 = 0.1e1 / t45;
  t47 = t20 * t20;
  t51 = 0.1e1 + 0.38075239991386496937e-4 * t42 * t46 * t47;
  t52 = sqrt(t51);
  t53 = t52 * t41;
  t54 = t2 * t44;
  t59 = t2 * t2;
  t60 = t40 * t59;
  t61 = 0.1e1 / t44;
  t65 = log(0.35625477770544353752e-2 * t60 * t61 * t20 + sqrt(POW_2(0.35625477770544353752e-2 * t60 * t61 * t20) + 0.1e1));
  t66 = t65 * t40;
  t67 = t59 * t45;
  t68 = 0.1e1 / t47;
  t72 = 0.10396221848752237744e2 * t53 * t54 / t20 - 0.97273285855626056446e3 * t66 * t67 * t68;
  t73 = t72 * t72;
  t75 = 0.1e1 - 0.15e1 * t73;
  tzk0 = t39 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t8, t10;
  double t11, t12, t13, t14, t15, t19, t20, t24;
  double t25, t26, t28, t29, t30, t34, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t51, t52, t53, t54, t59, t60, t61, t65;
  double t66, t67, t68, t72, t73, t75, tzk0;

  double t76, t79, t80, t83, t84, t85, t86, t88;
  double t93, t99, t101, t104, t105, t106, t107, t108;
  double t109, t110, t111, t115, t121, t123, t124, t125;
  double t127, t128, t129, t130, t135, t136, t139, t143;
  double t147, t148, t150, tvrho0, t151, t152, t153, t157;
  double t162, t165, t167, t172, t177, t178, t179, tvrho1;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t8 = rho[0] * t7;
  t10 = 0.2e1 * t8 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = t11 * p->zeta_threshold;
  t13 = M_CBRT2;
  t14 = t13 * rho[0];
  t15 = POW_1_3(t8);
  t19 = my_piecewise3(t10, t12, 0.2e1 * t14 * t7 * t15);
  t20 = POW_1_3(t6);
  t24 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t20);
  t25 = rho[1] <= p->dens_threshold;
  t26 = rho[1] * t7;
  t28 = 0.2e1 * t26 <= p->zeta_threshold;
  t29 = t13 * rho[1];
  t30 = POW_1_3(t26);
  t34 = my_piecewise3(t28, t12, 0.2e1 * t29 * t7 * t30);
  t38 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t34 * t20);
  t39 = t24 + t38;
  t40 = POW_1_3(0.9e1);
  t41 = t40 * t40;
  t42 = t41 * t2;
  t43 = 0.1e1 / M_PI;
  t44 = POW_1_3(t43);
  t45 = t44 * t44;
  t46 = 0.1e1 / t45;
  t47 = t20 * t20;
  t51 = 0.1e1 + 0.38075239991386496937e-4 * t42 * t46 * t47;
  t52 = sqrt(t51);
  t53 = t52 * t41;
  t54 = t2 * t44;
  t59 = t2 * t2;
  t60 = t40 * t59;
  t61 = 0.1e1 / t44;
  t65 = log(0.35625477770544353752e-2 * t60 * t61 * t20 + sqrt(POW_2(0.35625477770544353752e-2 * t60 * t61 * t20) + 0.1e1));
  t66 = t65 * t40;
  t67 = t59 * t45;
  t68 = 0.1e1 / t47;
  t72 = 0.10396221848752237744e2 * t53 * t54 / t20 - 0.97273285855626056446e3 * t66 * t67 * t68;
  t73 = t72 * t72;
  t75 = 0.1e1 - 0.15e1 * t73;
  tzk0 = t39 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t76 = t13 * t7;
  t79 = t6 * t6;
  t80 = 0.1e1 / t79;
  t83 = 0.2e1 * t14 * t80 * t15;
  t84 = t15 * t15;
  t85 = 0.1e1 / t84;
  t86 = t7 * t85;
  t88 = -rho[0] * t80 + t7;
  t93 = my_piecewise3(t10, 0, 0.2e1 * t76 * t15 - t83 + 0.2e1 / 0.3e1 * t14 * t86 * t88);
  t99 = t5 * t19 * t68 / 0.8e1;
  t101 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t93 * t20 - t99);
  t104 = 0.2e1 * t29 * t80 * t30;
  t105 = rho[1] * rho[1];
  t106 = t13 * t105;
  t107 = t79 * t6;
  t108 = 0.1e1 / t107;
  t109 = t30 * t30;
  t110 = 0.1e1 / t109;
  t111 = t108 * t110;
  t115 = my_piecewise3(t28, 0, -t104 - 0.2e1 / 0.3e1 * t106 * t111);
  t121 = t5 * t34 * t68 / 0.8e1;
  t123 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t115 * t20 - t121);
  t124 = t101 + t123;
  t125 = t6 * t124;
  t127 = t6 * t39;
  t128 = 0.1e1 / t52;
  t129 = t128 * t40;
  t130 = t59 * t61;
  t135 = 0.1e1 / t20 / t6;
  t136 = t54 * t135;
  t139 = t128 * t41;
  t143 = 0.1e1 / t47 / t6;
  t147 = 0.11875159256848117917e-2 * t129 * t130 * t68 - 0.34654072829174125813e1 * t53 * t136 - 0.34654072829174125814e1 * t139 * t136 + 0.64848857237084037631e3 * t66 * t67 * t143;
  t148 = t72 * t147;
  t150 = 0.3e1 * t127 * t148;
  tvrho0 = t125 * t75 - t150 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t151 = rho[0] * rho[0];
  t152 = t13 * t151;
  t153 = t108 * t85;
  t157 = my_piecewise3(t10, 0, -t83 - 0.2e1 / 0.3e1 * t152 * t153);
  t162 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t157 * t20 - t99);
  t165 = t7 * t110;
  t167 = -rho[1] * t80 + t7;
  t172 = my_piecewise3(t28, 0, 0.2e1 * t76 * t30 - t104 + 0.2e1 / 0.3e1 * t29 * t165 * t167);
  t177 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t172 * t20 - t121);
  t178 = t162 + t177;
  t179 = t6 * t178;
  tvrho1 = t179 * t75 - t150 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t8, t10;
  double t11, t12, t13, t14, t15, t19, t20, t24;
  double t25, t26, t28, t29, t30, t34, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t51, t52, t53, t54, t59, t60, t61, t65;
  double t66, t67, t68, t72, t73, t75, tzk0;

  double t76, t79, t80, t83, t84, t85, t86, t88;
  double t93, t99, t101, t104, t105, t106, t107, t108;
  double t109, t110, t111, t115, t121, t123, t124, t125;
  double t127, t128, t129, t130, t135, t136, t139, t143;
  double t147, t148, t150, tvrho0, t151, t152, t153, t157;
  double t162, t165, t167, t172, t177, t178, t179, tvrho1;

  double t181, t183, t185, t186, t187, t189, t194, t195;
  double t197, t200, t201, t202, t208, t213, t218, t222;
  double t224, t227, t228, t229, t230, t231, t233, t234;
  double t236, t238, t239, t243, t248, t252, t254, t255;
  double t256, t258, t260, t262, t264, t267, t271, t272;
  double t275, t281, t285, t286, t288, tv2rho20, t289, t294;
  double t295, t297, t298, t302, t307, t311, t312, t314;
  double t315, t319, t321, t323, t327, t329, t334, t339;
  double t343, t344, t345, t347, tv2rho21, t352, t353, t354;
  double t358, t364, t366, t370, t371, t376, t381, t387;
  double t388, t389, tv2rho22;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t8 = rho[0] * t7;
  t10 = 0.2e1 * t8 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = t11 * p->zeta_threshold;
  t13 = M_CBRT2;
  t14 = t13 * rho[0];
  t15 = POW_1_3(t8);
  t19 = my_piecewise3(t10, t12, 0.2e1 * t14 * t7 * t15);
  t20 = POW_1_3(t6);
  t24 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t20);
  t25 = rho[1] <= p->dens_threshold;
  t26 = rho[1] * t7;
  t28 = 0.2e1 * t26 <= p->zeta_threshold;
  t29 = t13 * rho[1];
  t30 = POW_1_3(t26);
  t34 = my_piecewise3(t28, t12, 0.2e1 * t29 * t7 * t30);
  t38 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t34 * t20);
  t39 = t24 + t38;
  t40 = POW_1_3(0.9e1);
  t41 = t40 * t40;
  t42 = t41 * t2;
  t43 = 0.1e1 / M_PI;
  t44 = POW_1_3(t43);
  t45 = t44 * t44;
  t46 = 0.1e1 / t45;
  t47 = t20 * t20;
  t51 = 0.1e1 + 0.38075239991386496937e-4 * t42 * t46 * t47;
  t52 = sqrt(t51);
  t53 = t52 * t41;
  t54 = t2 * t44;
  t59 = t2 * t2;
  t60 = t40 * t59;
  t61 = 0.1e1 / t44;
  t65 = log(0.35625477770544353752e-2 * t60 * t61 * t20 + sqrt(POW_2(0.35625477770544353752e-2 * t60 * t61 * t20) + 0.1e1));
  t66 = t65 * t40;
  t67 = t59 * t45;
  t68 = 0.1e1 / t47;
  t72 = 0.10396221848752237744e2 * t53 * t54 / t20 - 0.97273285855626056446e3 * t66 * t67 * t68;
  t73 = t72 * t72;
  t75 = 0.1e1 - 0.15e1 * t73;
  tzk0 = t39 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t76 = t13 * t7;
  t79 = t6 * t6;
  t80 = 0.1e1 / t79;
  t83 = 0.2e1 * t14 * t80 * t15;
  t84 = t15 * t15;
  t85 = 0.1e1 / t84;
  t86 = t7 * t85;
  t88 = -rho[0] * t80 + t7;
  t93 = my_piecewise3(t10, 0, 0.2e1 * t76 * t15 - t83 + 0.2e1 / 0.3e1 * t14 * t86 * t88);
  t99 = t5 * t19 * t68 / 0.8e1;
  t101 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t93 * t20 - t99);
  t104 = 0.2e1 * t29 * t80 * t30;
  t105 = rho[1] * rho[1];
  t106 = t13 * t105;
  t107 = t79 * t6;
  t108 = 0.1e1 / t107;
  t109 = t30 * t30;
  t110 = 0.1e1 / t109;
  t111 = t108 * t110;
  t115 = my_piecewise3(t28, 0, -t104 - 0.2e1 / 0.3e1 * t106 * t111);
  t121 = t5 * t34 * t68 / 0.8e1;
  t123 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t115 * t20 - t121);
  t124 = t101 + t123;
  t125 = t6 * t124;
  t127 = t6 * t39;
  t128 = 0.1e1 / t52;
  t129 = t128 * t40;
  t130 = t59 * t61;
  t135 = 0.1e1 / t20 / t6;
  t136 = t54 * t135;
  t139 = t128 * t41;
  t143 = 0.1e1 / t47 / t6;
  t147 = 0.11875159256848117917e-2 * t129 * t130 * t68 - 0.34654072829174125813e1 * t53 * t136 - 0.34654072829174125814e1 * t139 * t136 + 0.64848857237084037631e3 * t66 * t67 * t143;
  t148 = t72 * t147;
  t150 = 0.3e1 * t127 * t148;
  tvrho0 = t125 * t75 - t150 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t151 = rho[0] * rho[0];
  t152 = t13 * t151;
  t153 = t108 * t85;
  t157 = my_piecewise3(t10, 0, -t83 - 0.2e1 / 0.3e1 * t152 * t153);
  t162 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t157 * t20 - t99);
  t165 = t7 * t110;
  t167 = -rho[1] * t80 + t7;
  t172 = my_piecewise3(t28, 0, 0.2e1 * t76 * t30 - t104 + 0.2e1 / 0.3e1 * t29 * t165 * t167);
  t177 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t172 * t20 - t121);
  t178 = t162 + t177;
  t179 = t6 * t178;
  tvrho1 = t179 * t75 - t150 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t181 = t124 * t75;
  t183 = t39 * t72;
  t185 = 0.6e1 * t183 * t147;
  t186 = t13 * t80;
  t187 = t186 * t15;
  t189 = t85 * t88;
  t194 = 0.4e1 * t14 * t108 * t15;
  t195 = t80 * t85;
  t197 = t14 * t195 * t88;
  t200 = 0.1e1 / t84 / t8;
  t201 = t7 * t200;
  t202 = t88 * t88;
  t208 = 0.2e1 * rho[0] * t108 - 0.2e1 * t80;
  t213 = my_piecewise3(t10, 0, -0.4e1 * t187 + 0.4e1 / 0.3e1 * t76 * t189 + t194 - 0.4e1 / 0.3e1 * t197 - 0.4e1 / 0.9e1 * t14 * t201 * t202 + 0.2e1 / 0.3e1 * t14 * t86 * t208);
  t218 = t5 * t93 * t68;
  t222 = t5 * t19 * t143 / 0.12e2;
  t224 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t213 * t20 - t218 / 0.4e1 + t222);
  t227 = 0.4e1 * t29 * t108 * t30;
  t228 = t79 * t79;
  t229 = 0.1e1 / t228;
  t230 = t229 * t110;
  t231 = t106 * t230;
  t233 = t105 * rho[1];
  t234 = t13 * t233;
  t236 = 0.1e1 / t228 / t6;
  t238 = 0.1e1 / t109 / t26;
  t239 = t236 * t238;
  t243 = my_piecewise3(t28, 0, t227 + 0.8e1 / 0.3e1 * t231 - 0.4e1 / 0.9e1 * t234 * t239);
  t248 = t5 * t115 * t68;
  t252 = t5 * t34 * t143 / 0.12e2;
  t254 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t243 * t20 - t248 / 0.4e1 + t252);
  t255 = t224 + t254;
  t256 = t6 * t255;
  t258 = t125 * t148;
  t260 = t147 * t147;
  t262 = 0.3e1 * t127 * t260;
  t264 = 0.1e1 / t52 / t51;
  t267 = t130 * t143;
  t271 = 0.1e1 / t20 / t79;
  t272 = t54 * t271;
  t275 = t264 * t40;
  t281 = 0.1e1 / t47 / t79;
  t285 = -0.1278422702025101867e-5 * t264 * t7 - 0.11875159256848117917e-2 * t129 * t267 + 0.46205430438898834417e1 * t53 * t272 + 0.39583864189493726391e-3 * t275 * t267 + 0.69308145658348251628e1 * t139 * t272 - 0.10808142872847339605e4 * t66 * t67 * t281;
  t286 = t72 * t285;
  t288 = 0.3e1 * t127 * t286;
  tv2rho20 = 0.2e1 * t181 - t185 + t256 * t75 - 0.6e1 * t258 - t262 - t288;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t289 = t178 * t75;
  t294 = t229 * t85;
  t295 = t152 * t294;
  t297 = t108 * t200;
  t298 = t297 * t88;
  t302 = my_piecewise3(t10, 0, -0.2e1 * t187 + t194 - 0.2e1 / 0.3e1 * t197 - 0.4e1 / 0.3e1 * t14 * t153 + 0.2e1 * t295 + 0.4e1 / 0.9e1 * t152 * t298);
  t307 = t5 * t157 * t68;
  t311 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t302 * t20 - t307 / 0.8e1 - t218 / 0.8e1 + t222);
  t312 = t186 * t30;
  t314 = t13 * t108;
  t315 = t110 * rho[1];
  t319 = t80 * t110;
  t321 = t29 * t319 * t167;
  t323 = t108 * t238;
  t327 = rho[1] * t108;
  t329 = -t80 + 0.2e1 * t327;
  t334 = my_piecewise3(t28, 0, -0.2e1 * t312 - 0.2e1 / 0.3e1 * t314 * t315 + t227 + 0.2e1 / 0.3e1 * t231 - 0.2e1 / 0.3e1 * t321 + 0.4e1 / 0.9e1 * t106 * t323 * t167 + 0.2e1 / 0.3e1 * t29 * t165 * t329);
  t339 = t5 * t172 * t68;
  t343 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t334 * t20 - t339 / 0.8e1 - t248 / 0.8e1 + t252);
  t344 = t311 + t343;
  t345 = t6 * t344;
  t347 = t179 * t148;
  tv2rho21 = t181 - t185 + t289 + t345 * t75 - 0.3e1 * t347 - 0.3e1 * t258 - t262 - t288;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t352 = t151 * rho[0];
  t353 = t13 * t352;
  t354 = t236 * t200;
  t358 = my_piecewise3(t10, 0, t194 + 0.8e1 / 0.3e1 * t295 - 0.4e1 / 0.9e1 * t353 * t354);
  t364 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t358 * t20 - t307 / 0.4e1 + t222);
  t366 = t110 * t167;
  t370 = t7 * t238;
  t371 = t167 * t167;
  t376 = -0.2e1 * t80 + 0.2e1 * t327;
  t381 = my_piecewise3(t28, 0, -0.4e1 * t312 + 0.4e1 / 0.3e1 * t76 * t366 + t227 - 0.4e1 / 0.3e1 * t321 - 0.4e1 / 0.9e1 * t29 * t370 * t371 + 0.2e1 / 0.3e1 * t29 * t165 * t376);
  t387 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t381 * t20 - t339 / 0.4e1 + t252);
  t388 = t364 + t387;
  t389 = t6 * t388;
  tv2rho22 = 0.2e1 * t289 - t185 + t389 * t75 - 0.6e1 * t347 - t262 - t288;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t8, t10;
  double t11, t12, t13, t14, t15, t19, t20, t24;
  double t25, t26, t28, t29, t30, t34, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t51, t52, t53, t54, t59, t60, t61, t65;
  double t66, t67, t68, t72, t73, t75, tzk0;

  double t76, t79, t80, t83, t84, t85, t86, t88;
  double t93, t99, t101, t104, t105, t106, t107, t108;
  double t109, t110, t111, t115, t121, t123, t124, t125;
  double t127, t128, t129, t130, t135, t136, t139, t143;
  double t147, t148, t150, tvrho0, t151, t152, t153, t157;
  double t162, t165, t167, t172, t177, t178, t179, tvrho1;

  double t181, t183, t185, t186, t187, t189, t194, t195;
  double t197, t200, t201, t202, t208, t213, t218, t222;
  double t224, t227, t228, t229, t230, t231, t233, t234;
  double t236, t238, t239, t243, t248, t252, t254, t255;
  double t256, t258, t260, t262, t264, t267, t271, t272;
  double t275, t281, t285, t286, t288, tv2rho20, t289, t294;
  double t295, t297, t298, t302, t307, t311, t312, t314;
  double t315, t319, t321, t323, t327, t329, t334, t339;
  double t343, t344, t345, t347, tv2rho21, t352, t353, t354;
  double t358, t364, t366, t370, t371, t376, t381, t387;
  double t388, t389, tv2rho22;

  double t392, t394, t395, t398, t400, t401, t403, t405;
  double t408, t413, t415, t419, t422, t426, t428, t432;
  double t433, t434, t439, t443, t444, t449, t452, t456;
  double t458, t461, t463, t466, t468, t470, t471, t473;
  double t476, t481, t486, t489, t493, t495, t496, t497;
  double t499, t501, t503, t505, t507, t508, t510, t512;
  double t517, t522, t532, t536, t537, t539, tv3rho30, t541;
  double t543, t544, t546, t551, t552, t561, t565, t566;
  double t568, t569, t570, t573, t576, t579, t580, t586;
  double t588, t593, t594, t596, t597, t599, t600, t606;
  double t608, t610, t614, t615, t623, t624, t625, t629;
  double t630, t636, t638, t643, t644, t645, tv3rho31, t650;
  double t658, t659, t661, t662, t666, t671, t676, t679;
  double t681, t682, t685, t693, t699, t700, t704, t710;
  double t714, t715, t720, t725, t726, t727, t729, tv3rho32;
  double t739, t740, t741, t745, t752, t755, t758, t765;
  double t769, t773, t777, t778, t785, t786, t787, tv3rho33;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t8 = rho[0] * t7;
  t10 = 0.2e1 * t8 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = t11 * p->zeta_threshold;
  t13 = M_CBRT2;
  t14 = t13 * rho[0];
  t15 = POW_1_3(t8);
  t19 = my_piecewise3(t10, t12, 0.2e1 * t14 * t7 * t15);
  t20 = POW_1_3(t6);
  t24 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t20);
  t25 = rho[1] <= p->dens_threshold;
  t26 = rho[1] * t7;
  t28 = 0.2e1 * t26 <= p->zeta_threshold;
  t29 = t13 * rho[1];
  t30 = POW_1_3(t26);
  t34 = my_piecewise3(t28, t12, 0.2e1 * t29 * t7 * t30);
  t38 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t34 * t20);
  t39 = t24 + t38;
  t40 = POW_1_3(0.9e1);
  t41 = t40 * t40;
  t42 = t41 * t2;
  t43 = 0.1e1 / M_PI;
  t44 = POW_1_3(t43);
  t45 = t44 * t44;
  t46 = 0.1e1 / t45;
  t47 = t20 * t20;
  t51 = 0.1e1 + 0.38075239991386496937e-4 * t42 * t46 * t47;
  t52 = sqrt(t51);
  t53 = t52 * t41;
  t54 = t2 * t44;
  t59 = t2 * t2;
  t60 = t40 * t59;
  t61 = 0.1e1 / t44;
  t65 = log(0.35625477770544353752e-2 * t60 * t61 * t20 + sqrt(POW_2(0.35625477770544353752e-2 * t60 * t61 * t20) + 0.1e1));
  t66 = t65 * t40;
  t67 = t59 * t45;
  t68 = 0.1e1 / t47;
  t72 = 0.10396221848752237744e2 * t53 * t54 / t20 - 0.97273285855626056446e3 * t66 * t67 * t68;
  t73 = t72 * t72;
  t75 = 0.1e1 - 0.15e1 * t73;
  tzk0 = t39 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t76 = t13 * t7;
  t79 = t6 * t6;
  t80 = 0.1e1 / t79;
  t83 = 0.2e1 * t14 * t80 * t15;
  t84 = t15 * t15;
  t85 = 0.1e1 / t84;
  t86 = t7 * t85;
  t88 = -rho[0] * t80 + t7;
  t93 = my_piecewise3(t10, 0, 0.2e1 * t76 * t15 - t83 + 0.2e1 / 0.3e1 * t14 * t86 * t88);
  t99 = t5 * t19 * t68 / 0.8e1;
  t101 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t93 * t20 - t99);
  t104 = 0.2e1 * t29 * t80 * t30;
  t105 = rho[1] * rho[1];
  t106 = t13 * t105;
  t107 = t79 * t6;
  t108 = 0.1e1 / t107;
  t109 = t30 * t30;
  t110 = 0.1e1 / t109;
  t111 = t108 * t110;
  t115 = my_piecewise3(t28, 0, -t104 - 0.2e1 / 0.3e1 * t106 * t111);
  t121 = t5 * t34 * t68 / 0.8e1;
  t123 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t115 * t20 - t121);
  t124 = t101 + t123;
  t125 = t6 * t124;
  t127 = t6 * t39;
  t128 = 0.1e1 / t52;
  t129 = t128 * t40;
  t130 = t59 * t61;
  t135 = 0.1e1 / t20 / t6;
  t136 = t54 * t135;
  t139 = t128 * t41;
  t143 = 0.1e1 / t47 / t6;
  t147 = 0.11875159256848117917e-2 * t129 * t130 * t68 - 0.34654072829174125813e1 * t53 * t136 - 0.34654072829174125814e1 * t139 * t136 + 0.64848857237084037631e3 * t66 * t67 * t143;
  t148 = t72 * t147;
  t150 = 0.3e1 * t127 * t148;
  tvrho0 = t125 * t75 - t150 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t151 = rho[0] * rho[0];
  t152 = t13 * t151;
  t153 = t108 * t85;
  t157 = my_piecewise3(t10, 0, -t83 - 0.2e1 / 0.3e1 * t152 * t153);
  t162 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t157 * t20 - t99);
  t165 = t7 * t110;
  t167 = -rho[1] * t80 + t7;
  t172 = my_piecewise3(t28, 0, 0.2e1 * t76 * t30 - t104 + 0.2e1 / 0.3e1 * t29 * t165 * t167);
  t177 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t172 * t20 - t121);
  t178 = t162 + t177;
  t179 = t6 * t178;
  tvrho1 = t179 * t75 - t150 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t181 = t124 * t75;
  t183 = t39 * t72;
  t185 = 0.6e1 * t183 * t147;
  t186 = t13 * t80;
  t187 = t186 * t15;
  t189 = t85 * t88;
  t194 = 0.4e1 * t14 * t108 * t15;
  t195 = t80 * t85;
  t197 = t14 * t195 * t88;
  t200 = 0.1e1 / t84 / t8;
  t201 = t7 * t200;
  t202 = t88 * t88;
  t208 = 0.2e1 * rho[0] * t108 - 0.2e1 * t80;
  t213 = my_piecewise3(t10, 0, -0.4e1 * t187 + 0.4e1 / 0.3e1 * t76 * t189 + t194 - 0.4e1 / 0.3e1 * t197 - 0.4e1 / 0.9e1 * t14 * t201 * t202 + 0.2e1 / 0.3e1 * t14 * t86 * t208);
  t218 = t5 * t93 * t68;
  t222 = t5 * t19 * t143 / 0.12e2;
  t224 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t213 * t20 - t218 / 0.4e1 + t222);
  t227 = 0.4e1 * t29 * t108 * t30;
  t228 = t79 * t79;
  t229 = 0.1e1 / t228;
  t230 = t229 * t110;
  t231 = t106 * t230;
  t233 = t105 * rho[1];
  t234 = t13 * t233;
  t236 = 0.1e1 / t228 / t6;
  t238 = 0.1e1 / t109 / t26;
  t239 = t236 * t238;
  t243 = my_piecewise3(t28, 0, t227 + 0.8e1 / 0.3e1 * t231 - 0.4e1 / 0.9e1 * t234 * t239);
  t248 = t5 * t115 * t68;
  t252 = t5 * t34 * t143 / 0.12e2;
  t254 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t243 * t20 - t248 / 0.4e1 + t252);
  t255 = t224 + t254;
  t256 = t6 * t255;
  t258 = t125 * t148;
  t260 = t147 * t147;
  t262 = 0.3e1 * t127 * t260;
  t264 = 0.1e1 / t52 / t51;
  t267 = t130 * t143;
  t271 = 0.1e1 / t20 / t79;
  t272 = t54 * t271;
  t275 = t264 * t40;
  t281 = 0.1e1 / t47 / t79;
  t285 = -0.1278422702025101867e-5 * t264 * t7 - 0.11875159256848117917e-2 * t129 * t267 + 0.46205430438898834417e1 * t53 * t272 + 0.39583864189493726391e-3 * t275 * t267 + 0.69308145658348251628e1 * t139 * t272 - 0.10808142872847339605e4 * t66 * t67 * t281;
  t286 = t72 * t285;
  t288 = 0.3e1 * t127 * t286;
  tv2rho20 = 0.2e1 * t181 - t185 + t256 * t75 - 0.6e1 * t258 - t262 - t288;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t289 = t178 * t75;
  t294 = t229 * t85;
  t295 = t152 * t294;
  t297 = t108 * t200;
  t298 = t297 * t88;
  t302 = my_piecewise3(t10, 0, -0.2e1 * t187 + t194 - 0.2e1 / 0.3e1 * t197 - 0.4e1 / 0.3e1 * t14 * t153 + 0.2e1 * t295 + 0.4e1 / 0.9e1 * t152 * t298);
  t307 = t5 * t157 * t68;
  t311 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t302 * t20 - t307 / 0.8e1 - t218 / 0.8e1 + t222);
  t312 = t186 * t30;
  t314 = t13 * t108;
  t315 = t110 * rho[1];
  t319 = t80 * t110;
  t321 = t29 * t319 * t167;
  t323 = t108 * t238;
  t327 = rho[1] * t108;
  t329 = -t80 + 0.2e1 * t327;
  t334 = my_piecewise3(t28, 0, -0.2e1 * t312 - 0.2e1 / 0.3e1 * t314 * t315 + t227 + 0.2e1 / 0.3e1 * t231 - 0.2e1 / 0.3e1 * t321 + 0.4e1 / 0.9e1 * t106 * t323 * t167 + 0.2e1 / 0.3e1 * t29 * t165 * t329);
  t339 = t5 * t172 * t68;
  t343 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t334 * t20 - t339 / 0.8e1 - t248 / 0.8e1 + t252);
  t344 = t311 + t343;
  t345 = t6 * t344;
  t347 = t179 * t148;
  tv2rho21 = t181 - t185 + t289 + t345 * t75 - 0.3e1 * t347 - 0.3e1 * t258 - t262 - t288;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t352 = t151 * rho[0];
  t353 = t13 * t352;
  t354 = t236 * t200;
  t358 = my_piecewise3(t10, 0, t194 + 0.8e1 / 0.3e1 * t295 - 0.4e1 / 0.9e1 * t353 * t354);
  t364 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t358 * t20 - t307 / 0.4e1 + t222);
  t366 = t110 * t167;
  t370 = t7 * t238;
  t371 = t167 * t167;
  t376 = -0.2e1 * t80 + 0.2e1 * t327;
  t381 = my_piecewise3(t28, 0, -0.4e1 * t312 + 0.4e1 / 0.3e1 * t76 * t366 + t227 - 0.4e1 / 0.3e1 * t321 - 0.4e1 / 0.9e1 * t29 * t370 * t371 + 0.2e1 / 0.3e1 * t29 * t165 * t376);
  t387 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t381 * t20 - t339 / 0.4e1 + t252);
  t388 = t364 + t387;
  t389 = t6 * t388;
  tv2rho22 = 0.2e1 * t289 - t185 + t389 * t75 - 0.6e1 * t347 - t262 - t288;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t392 = t255 * t75;
  t394 = t124 * t72;
  t395 = t394 * t147;
  t398 = 0.9e1 * t39 * t260;
  t400 = 0.9e1 * t183 * t285;
  t401 = t314 * t15;
  t403 = t186 * t189;
  t405 = t200 * t202;
  t408 = t85 * t208;
  t413 = 0.12e2 * t14 * t229 * t15;
  t415 = t14 * t153 * t88;
  t419 = t14 * t80 * t200 * t202;
  t422 = t14 * t195 * t208;
  t426 = 0.1e1 / t84 / t151 / t80;
  t428 = t202 * t88;
  t432 = t14 * t7;
  t433 = t200 * t88;
  t434 = t433 * t208;
  t439 = -0.6e1 * rho[0] * t229 + 0.6e1 * t108;
  t443 = 0.12e2 * t401 - 0.4e1 * t403 - 0.4e1 / 0.3e1 * t76 * t405 + 0.2e1 * t76 * t408 - t413 + 0.4e1 * t415 + 0.4e1 / 0.3e1 * t419 - 0.2e1 * t422 + 0.2e2 / 0.27e2 * t14 * t7 * t426 * t428 - 0.4e1 / 0.3e1 * t432 * t434 + 0.2e1 / 0.3e1 * t14 * t86 * t439;
  t444 = my_piecewise3(t10, 0, t443);
  t449 = t5 * t213 * t68;
  t452 = t5 * t93 * t143;
  t456 = 0.5e1 / 0.36e2 * t5 * t19 * t281;
  t458 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t444 * t20 - 0.3e1 / 0.8e1 * t449 + t452 / 0.4e1 - t456);
  t461 = 0.12e2 * t29 * t229 * t30;
  t463 = t106 * t236 * t110;
  t466 = 0.1e1 / t228 / t79;
  t468 = t234 * t466 * t238;
  t470 = t105 * t105;
  t471 = t13 * t470;
  t473 = 0.1e1 / t228 / t107;
  t476 = 0.1e1 / t109 / t105 / t80;
  t481 = my_piecewise3(t28, 0, -t461 - 0.12e2 * t463 + 0.4e1 * t468 - 0.2e2 / 0.27e2 * t471 * t473 * t476);
  t486 = t5 * t243 * t68;
  t489 = t5 * t115 * t143;
  t493 = 0.5e1 / 0.36e2 * t5 * t34 * t281;
  t495 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t481 * t20 - 0.3e1 / 0.8e1 * t486 + t489 / 0.4e1 - t493);
  t496 = t458 + t495;
  t497 = t6 * t496;
  t499 = t256 * t148;
  t501 = t125 * t260;
  t503 = t125 * t286;
  t505 = t147 * t285;
  t507 = 0.9e1 * t127 * t505;
  t508 = t51 * t51;
  t510 = 0.1e1 / t52 / t508;
  t512 = t42 * t46;
  t517 = t130 * t281;
  t522 = t54 / t20 / t107;
  t532 = 0.1e1 / t47 / t107;
  t536 = 0.48676251190042541751e-10 * t510 * t135 * t512 + 0.2556845404050203734e-5 * t264 * t80 + 0.25069780653346026714e-2 * t129 * t517 - 0.10781267102409728031e2 * t53 * t522 - 0.12784227020251018671e-5 * t510 * t80 - 0.14514083536147699677e-2 * t275 * t517 - 0.20022353190189494915e2 * t139 * t522 + 0.28821714327592905613e4 * t66 * t67 * t532;
  t537 = t72 * t536;
  t539 = 0.3e1 * t127 * t537;
  tv3rho30 = 0.3e1 * t392 - 0.18e2 * t395 - t398 - t400 + t497 * t75 - 0.9e1 * t499 - 0.9e1 * t501 - 0.9e1 * t503 - t507 - t539;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t541 = 0.2e1 * t344 * t75;
  t543 = 0.6e1 * t345 * t148;
  t544 = t179 * t260;
  t546 = t179 * t286;
  t551 = t178 * t72;
  t552 = t551 * t147;
  t561 = t14 * t294;
  t565 = t236 * t85;
  t566 = t152 * t565;
  t568 = t229 * t200;
  t569 = t568 * t88;
  t570 = t152 * t569;
  t573 = t108 * t426 * t202;
  t576 = t297 * t208;
  t579 = 0.8e1 * t401 - 0.4e1 / 0.3e1 * t403 - t413 + 0.8e1 / 0.3e1 * t415 + 0.4e1 / 0.9e1 * t419 - 0.2e1 / 0.3e1 * t422 - 0.4e1 / 0.3e1 * t314 * t85 + 0.8e1 * t561 + 0.16e2 / 0.9e1 * t14 * t298 - 0.8e1 * t566 - 0.8e1 / 0.3e1 * t570 - 0.2e2 / 0.27e2 * t152 * t573 + 0.4e1 / 0.9e1 * t152 * t576;
  t580 = my_piecewise3(t10, 0, t579);
  t586 = t5 * t302 * t68 / 0.4e1;
  t588 = t5 * t157 * t143;
  t593 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t580 * t20 - t586 + t588 / 0.12e2 - t449 / 0.8e1 + t452 / 0.6e1 - t456);
  t594 = t314 * t30;
  t596 = t13 * t229;
  t597 = t596 * t315;
  t599 = t13 * t236;
  t600 = t238 * t105;
  t606 = t29 * t111 * t167;
  t608 = t229 * t238;
  t610 = t106 * t608 * t167;
  t614 = 0.4e1 / 0.3e1 * t29 * t319 * t329;
  t615 = t236 * t476;
  t623 = rho[1] * t229;
  t624 = 0.6e1 * t623;
  t625 = 0.2e1 * t108 - t624;
  t629 = 0.4e1 * t594 + 0.8e1 / 0.3e1 * t597 - 0.4e1 / 0.9e1 * t599 * t600 - t461 - 0.4e1 * t463 + 0.4e1 / 0.9e1 * t468 + 0.4e1 / 0.3e1 * t606 - 0.16e2 / 0.9e1 * t610 - t614 + 0.2e2 / 0.27e2 * t234 * t615 * t167 + 0.8e1 / 0.9e1 * t106 * t323 * t329 + 0.2e1 / 0.3e1 * t29 * t165 * t625;
  t630 = my_piecewise3(t28, 0, t629);
  t636 = t5 * t334 * t68 / 0.4e1;
  t638 = t5 * t172 * t143;
  t643 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t630 * t20 - t636 + t638 / 0.12e2 - t486 / 0.8e1 + t489 / 0.6e1 - t493);
  t644 = t593 + t643;
  t645 = t6 * t644;
  tv3rho31 = t541 - t543 - 0.3e1 * t544 - 0.3e1 * t546 - 0.3e1 * t499 - 0.6e1 * t501 - 0.6e1 * t503 - t507 - t539 - 0.6e1 * t552 + t645 * t75 - 0.12e2 * t395 - t398 - t400 + t392;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t650 = t388 * t75;
  t658 = t466 * t200;
  t659 = t353 * t658;
  t661 = t236 * t426;
  t662 = t661 * t88;
  t666 = my_piecewise3(t10, 0, 0.4e1 * t401 - t413 + 0.4e1 / 0.3e1 * t415 + 0.16e2 / 0.3e1 * t561 - 0.32e2 / 0.3e1 * t566 - 0.16e2 / 0.9e1 * t570 - 0.4e1 / 0.3e1 * t152 * t354 + 0.2e2 / 0.9e1 * t659 + 0.2e2 / 0.27e2 * t353 * t662);
  t671 = t5 * t358 * t68;
  t676 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t666 * t20 - t671 / 0.8e1 - t586 + t588 / 0.6e1 + t452 / 0.12e2 - t456);
  t679 = t186 * t366;
  t681 = t238 * t167;
  t682 = t681 * rho[1];
  t685 = t110 * t329;
  t693 = t29 * t80 * t238 * t371;
  t699 = t29 * t7;
  t700 = t681 * t329;
  t704 = t29 * t319 * t376;
  t710 = 0.4e1 * t108 - t624;
  t714 = 0.8e1 * t594 + 0.4e1 / 0.3e1 * t597 - 0.4e1 / 0.3e1 * t679 + 0.8e1 / 0.9e1 * t314 * t682 + 0.4e1 / 0.3e1 * t76 * t685 - t461 - 0.4e1 / 0.3e1 * t463 + 0.8e1 / 0.3e1 * t606 - 0.8e1 / 0.9e1 * t610 - t614 + 0.4e1 / 0.9e1 * t693 - 0.2e2 / 0.27e2 * t106 * t108 * t476 * t371 - 0.8e1 / 0.9e1 * t699 * t700 - 0.2e1 / 0.3e1 * t704 + 0.4e1 / 0.9e1 * t106 * t323 * t376 + 0.2e1 / 0.3e1 * t29 * t165 * t710;
  t715 = my_piecewise3(t28, 0, t714);
  t720 = t5 * t381 * t68;
  t725 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t715 * t20 - t720 / 0.8e1 - t636 + t638 / 0.6e1 + t489 / 0.12e2 - t493);
  t726 = t676 + t725;
  t727 = t6 * t726;
  t729 = t389 * t148;
  tv3rho32 = t541 - 0.12e2 * t552 - 0.6e1 * t395 - t398 - t400 + t650 + t727 * t75 - 0.3e1 * t729 - t543 - 0.6e1 * t544 - 0.6e1 * t546 - 0.3e1 * t501 - t507 - 0.3e1 * t503 - t539;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t739 = t151 * t151;
  t740 = t13 * t739;
  t741 = t473 * t426;
  t745 = my_piecewise3(t10, 0, -t413 - 0.12e2 * t566 + 0.4e1 * t659 - 0.2e2 / 0.27e2 * t740 * t741);
  t752 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t745 * t20 - 0.3e1 / 0.8e1 * t671 + t588 / 0.4e1 - t456);
  t755 = t238 * t371;
  t758 = t110 * t376;
  t765 = t371 * t167;
  t769 = t681 * t376;
  t773 = 0.6e1 * t108 - 0.6e1 * t623;
  t777 = 0.12e2 * t594 - 0.4e1 * t679 - 0.4e1 / 0.3e1 * t76 * t755 + 0.2e1 * t76 * t758 - t461 + 0.4e1 * t606 + 0.4e1 / 0.3e1 * t693 - 0.2e1 * t704 + 0.2e2 / 0.27e2 * t29 * t7 * t476 * t765 - 0.4e1 / 0.3e1 * t699 * t769 + 0.2e1 / 0.3e1 * t29 * t165 * t773;
  t778 = my_piecewise3(t28, 0, t777);
  t785 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t778 * t20 - 0.3e1 / 0.8e1 * t720 + t638 / 0.4e1 - t493);
  t786 = t752 + t785;
  t787 = t6 * t786;
  tv3rho33 = 0.3e1 * t650 - 0.18e2 * t552 - t398 - t400 + t787 * t75 - 0.9e1 * t729 - 0.9e1 * t544 - 0.9e1 * t546 - t507 - t539;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t8, t10;
  double t11, t12, t13, t14, t15, t19, t20, t24;
  double t25, t26, t28, t29, t30, t34, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t51, t52, t53, t54, t59, t60, t61, t65;
  double t66, t67, t68, t72, t73, t75, tzk0;

  double t76, t79, t80, t83, t84, t85, t86, t88;
  double t93, t99, t101, t104, t105, t106, t107, t108;
  double t109, t110, t111, t115, t121, t123, t124, t125;
  double t127, t128, t129, t130, t135, t136, t139, t143;
  double t147, t148, t150, tvrho0, t151, t152, t153, t157;
  double t162, t165, t167, t172, t177, t178, t179, tvrho1;

  double t181, t183, t185, t186, t187, t189, t194, t195;
  double t197, t200, t201, t202, t208, t213, t218, t222;
  double t224, t227, t228, t229, t230, t231, t233, t234;
  double t236, t238, t239, t243, t248, t252, t254, t255;
  double t256, t258, t260, t262, t264, t267, t271, t272;
  double t275, t281, t285, t286, t288, tv2rho20, t289, t294;
  double t295, t297, t298, t302, t307, t311, t312, t314;
  double t315, t319, t321, t323, t327, t329, t334, t339;
  double t343, t344, t345, t347, tv2rho21, t352, t353, t354;
  double t358, t364, t366, t370, t371, t376, t381, t387;
  double t388, t389, tv2rho22;

  double t392, t394, t395, t398, t400, t401, t403, t405;
  double t408, t413, t415, t419, t422, t426, t428, t432;
  double t433, t434, t439, t443, t444, t449, t452, t456;
  double t458, t461, t463, t466, t468, t470, t471, t473;
  double t476, t481, t486, t489, t493, t495, t496, t497;
  double t499, t501, t503, t505, t507, t508, t510, t512;
  double t517, t522, t532, t536, t537, t539, tv3rho30, t541;
  double t543, t544, t546, t551, t552, t561, t565, t566;
  double t568, t569, t570, t573, t576, t579, t580, t586;
  double t588, t593, t594, t596, t597, t599, t600, t606;
  double t608, t610, t614, t615, t623, t624, t625, t629;
  double t630, t636, t638, t643, t644, t645, tv3rho31, t650;
  double t658, t659, t661, t662, t666, t671, t676, t679;
  double t681, t682, t685, t693, t699, t700, t704, t710;
  double t714, t715, t720, t725, t726, t727, t729, tv3rho32;
  double t739, t740, t741, t745, t752, t755, t758, t765;
  double t769, t773, t777, t778, t785, t786, t787, tv3rho33;

  double t792, t794, t796, t798, t801, t804, t816, t821;
  double t841, t842, t844, t846, t848, t850, t859, t861;
  double t864, t867, t876, t880, t883, t887, t889, t897;
  double t904, t909, t911, t913, t914, t919, t922, t925;
  double t929, t931, t934, t936, t939, t941, t942, t944;
  double t949, t952, t957, t962, t965, t968, t972, t974;
  double t979, t981, t983, t987, t989, tv4rho40, t990, t1005;
  double t1007, t1014, t1016, t1021, t1024, t1026, t1028, t1040;
  double t1042, t1047, t1050, t1051, t1053, t1059, t1061, t1063;
  double t1065, t1068, t1075, t1076, t1078, t1081, t1085, t1088;
  double t1101, t1102, t1110, t1111, t1116, t1119, t1120, t1122;
  double t1128, t1133, t1134, t1135, t1137, t1139, t1140, t1141;
  double t1142, t1143, t1145, t1147, t1150, t1158, tv4rho41, t1159;
  double t1161, t1167, t1172, t1175, t1183, t1188, t1192, t1209;
  double t1210, t1215, t1218, t1226, t1227, t1228, t1230, t1231;
  double t1238, t1240, t1248, t1257, t1259, t1264, t1271, t1272;
  double t1274, t1283, t1290, t1301, t1303, t1308, t1311, t1319;
  double t1323, t1333, tv4rho42, t1335, t1340, t1352, t1358, t1359;
  double t1364, t1371, t1374, t1396, t1399, t1401, t1416, t1418;
  double t1420, t1437, t1439, t1444, t1451, t1457, t1465, tv4rho43;
  double t1475, t1483, t1485, t1492, t1522, t1523, t1531, tv4rho44;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t8 = rho[0] * t7;
  t10 = 0.2e1 * t8 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t12 = t11 * p->zeta_threshold;
  t13 = M_CBRT2;
  t14 = t13 * rho[0];
  t15 = POW_1_3(t8);
  t19 = my_piecewise3(t10, t12, 0.2e1 * t14 * t7 * t15);
  t20 = POW_1_3(t6);
  t24 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t19 * t20);
  t25 = rho[1] <= p->dens_threshold;
  t26 = rho[1] * t7;
  t28 = 0.2e1 * t26 <= p->zeta_threshold;
  t29 = t13 * rho[1];
  t30 = POW_1_3(t26);
  t34 = my_piecewise3(t28, t12, 0.2e1 * t29 * t7 * t30);
  t38 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t34 * t20);
  t39 = t24 + t38;
  t40 = POW_1_3(0.9e1);
  t41 = t40 * t40;
  t42 = t41 * t2;
  t43 = 0.1e1 / M_PI;
  t44 = POW_1_3(t43);
  t45 = t44 * t44;
  t46 = 0.1e1 / t45;
  t47 = t20 * t20;
  t51 = 0.1e1 + 0.38075239991386496937e-4 * t42 * t46 * t47;
  t52 = sqrt(t51);
  t53 = t52 * t41;
  t54 = t2 * t44;
  t59 = t2 * t2;
  t60 = t40 * t59;
  t61 = 0.1e1 / t44;
  t65 = log(0.35625477770544353752e-2 * t60 * t61 * t20 + sqrt(POW_2(0.35625477770544353752e-2 * t60 * t61 * t20) + 0.1e1));
  t66 = t65 * t40;
  t67 = t59 * t45;
  t68 = 0.1e1 / t47;
  t72 = 0.10396221848752237744e2 * t53 * t54 / t20 - 0.97273285855626056446e3 * t66 * t67 * t68;
  t73 = t72 * t72;
  t75 = 0.1e1 - 0.15e1 * t73;
  tzk0 = t39 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t76 = t13 * t7;
  t79 = t6 * t6;
  t80 = 0.1e1 / t79;
  t83 = 0.2e1 * t14 * t80 * t15;
  t84 = t15 * t15;
  t85 = 0.1e1 / t84;
  t86 = t7 * t85;
  t88 = -rho[0] * t80 + t7;
  t93 = my_piecewise3(t10, 0, 0.2e1 * t76 * t15 - t83 + 0.2e1 / 0.3e1 * t14 * t86 * t88);
  t99 = t5 * t19 * t68 / 0.8e1;
  t101 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t93 * t20 - t99);
  t104 = 0.2e1 * t29 * t80 * t30;
  t105 = rho[1] * rho[1];
  t106 = t13 * t105;
  t107 = t79 * t6;
  t108 = 0.1e1 / t107;
  t109 = t30 * t30;
  t110 = 0.1e1 / t109;
  t111 = t108 * t110;
  t115 = my_piecewise3(t28, 0, -t104 - 0.2e1 / 0.3e1 * t106 * t111);
  t121 = t5 * t34 * t68 / 0.8e1;
  t123 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t115 * t20 - t121);
  t124 = t101 + t123;
  t125 = t6 * t124;
  t127 = t6 * t39;
  t128 = 0.1e1 / t52;
  t129 = t128 * t40;
  t130 = t59 * t61;
  t135 = 0.1e1 / t20 / t6;
  t136 = t54 * t135;
  t139 = t128 * t41;
  t143 = 0.1e1 / t47 / t6;
  t147 = 0.11875159256848117917e-2 * t129 * t130 * t68 - 0.34654072829174125813e1 * t53 * t136 - 0.34654072829174125814e1 * t139 * t136 + 0.64848857237084037631e3 * t66 * t67 * t143;
  t148 = t72 * t147;
  t150 = 0.3e1 * t127 * t148;
  tvrho0 = t125 * t75 - t150 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t151 = rho[0] * rho[0];
  t152 = t13 * t151;
  t153 = t108 * t85;
  t157 = my_piecewise3(t10, 0, -t83 - 0.2e1 / 0.3e1 * t152 * t153);
  t162 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t157 * t20 - t99);
  t165 = t7 * t110;
  t167 = -rho[1] * t80 + t7;
  t172 = my_piecewise3(t28, 0, 0.2e1 * t76 * t30 - t104 + 0.2e1 / 0.3e1 * t29 * t165 * t167);
  t177 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t172 * t20 - t121);
  t178 = t162 + t177;
  t179 = t6 * t178;
  tvrho1 = t179 * t75 - t150 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t181 = t124 * t75;
  t183 = t39 * t72;
  t185 = 0.6e1 * t183 * t147;
  t186 = t13 * t80;
  t187 = t186 * t15;
  t189 = t85 * t88;
  t194 = 0.4e1 * t14 * t108 * t15;
  t195 = t80 * t85;
  t197 = t14 * t195 * t88;
  t200 = 0.1e1 / t84 / t8;
  t201 = t7 * t200;
  t202 = t88 * t88;
  t208 = 0.2e1 * rho[0] * t108 - 0.2e1 * t80;
  t213 = my_piecewise3(t10, 0, -0.4e1 * t187 + 0.4e1 / 0.3e1 * t76 * t189 + t194 - 0.4e1 / 0.3e1 * t197 - 0.4e1 / 0.9e1 * t14 * t201 * t202 + 0.2e1 / 0.3e1 * t14 * t86 * t208);
  t218 = t5 * t93 * t68;
  t222 = t5 * t19 * t143 / 0.12e2;
  t224 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t213 * t20 - t218 / 0.4e1 + t222);
  t227 = 0.4e1 * t29 * t108 * t30;
  t228 = t79 * t79;
  t229 = 0.1e1 / t228;
  t230 = t229 * t110;
  t231 = t106 * t230;
  t233 = t105 * rho[1];
  t234 = t13 * t233;
  t236 = 0.1e1 / t228 / t6;
  t238 = 0.1e1 / t109 / t26;
  t239 = t236 * t238;
  t243 = my_piecewise3(t28, 0, t227 + 0.8e1 / 0.3e1 * t231 - 0.4e1 / 0.9e1 * t234 * t239);
  t248 = t5 * t115 * t68;
  t252 = t5 * t34 * t143 / 0.12e2;
  t254 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t243 * t20 - t248 / 0.4e1 + t252);
  t255 = t224 + t254;
  t256 = t6 * t255;
  t258 = t125 * t148;
  t260 = t147 * t147;
  t262 = 0.3e1 * t127 * t260;
  t264 = 0.1e1 / t52 / t51;
  t267 = t130 * t143;
  t271 = 0.1e1 / t20 / t79;
  t272 = t54 * t271;
  t275 = t264 * t40;
  t281 = 0.1e1 / t47 / t79;
  t285 = -0.1278422702025101867e-5 * t264 * t7 - 0.11875159256848117917e-2 * t129 * t267 + 0.46205430438898834417e1 * t53 * t272 + 0.39583864189493726391e-3 * t275 * t267 + 0.69308145658348251628e1 * t139 * t272 - 0.10808142872847339605e4 * t66 * t67 * t281;
  t286 = t72 * t285;
  t288 = 0.3e1 * t127 * t286;
  tv2rho20 = 0.2e1 * t181 - t185 + t256 * t75 - 0.6e1 * t258 - t262 - t288;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t289 = t178 * t75;
  t294 = t229 * t85;
  t295 = t152 * t294;
  t297 = t108 * t200;
  t298 = t297 * t88;
  t302 = my_piecewise3(t10, 0, -0.2e1 * t187 + t194 - 0.2e1 / 0.3e1 * t197 - 0.4e1 / 0.3e1 * t14 * t153 + 0.2e1 * t295 + 0.4e1 / 0.9e1 * t152 * t298);
  t307 = t5 * t157 * t68;
  t311 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t302 * t20 - t307 / 0.8e1 - t218 / 0.8e1 + t222);
  t312 = t186 * t30;
  t314 = t13 * t108;
  t315 = t110 * rho[1];
  t319 = t80 * t110;
  t321 = t29 * t319 * t167;
  t323 = t108 * t238;
  t327 = rho[1] * t108;
  t329 = -t80 + 0.2e1 * t327;
  t334 = my_piecewise3(t28, 0, -0.2e1 * t312 - 0.2e1 / 0.3e1 * t314 * t315 + t227 + 0.2e1 / 0.3e1 * t231 - 0.2e1 / 0.3e1 * t321 + 0.4e1 / 0.9e1 * t106 * t323 * t167 + 0.2e1 / 0.3e1 * t29 * t165 * t329);
  t339 = t5 * t172 * t68;
  t343 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t334 * t20 - t339 / 0.8e1 - t248 / 0.8e1 + t252);
  t344 = t311 + t343;
  t345 = t6 * t344;
  t347 = t179 * t148;
  tv2rho21 = t181 - t185 + t289 + t345 * t75 - 0.3e1 * t347 - 0.3e1 * t258 - t262 - t288;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t352 = t151 * rho[0];
  t353 = t13 * t352;
  t354 = t236 * t200;
  t358 = my_piecewise3(t10, 0, t194 + 0.8e1 / 0.3e1 * t295 - 0.4e1 / 0.9e1 * t353 * t354);
  t364 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t358 * t20 - t307 / 0.4e1 + t222);
  t366 = t110 * t167;
  t370 = t7 * t238;
  t371 = t167 * t167;
  t376 = -0.2e1 * t80 + 0.2e1 * t327;
  t381 = my_piecewise3(t28, 0, -0.4e1 * t312 + 0.4e1 / 0.3e1 * t76 * t366 + t227 - 0.4e1 / 0.3e1 * t321 - 0.4e1 / 0.9e1 * t29 * t370 * t371 + 0.2e1 / 0.3e1 * t29 * t165 * t376);
  t387 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t381 * t20 - t339 / 0.4e1 + t252);
  t388 = t364 + t387;
  t389 = t6 * t388;
  tv2rho22 = 0.2e1 * t289 - t185 + t389 * t75 - 0.6e1 * t347 - t262 - t288;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t392 = t255 * t75;
  t394 = t124 * t72;
  t395 = t394 * t147;
  t398 = 0.9e1 * t39 * t260;
  t400 = 0.9e1 * t183 * t285;
  t401 = t314 * t15;
  t403 = t186 * t189;
  t405 = t200 * t202;
  t408 = t85 * t208;
  t413 = 0.12e2 * t14 * t229 * t15;
  t415 = t14 * t153 * t88;
  t419 = t14 * t80 * t200 * t202;
  t422 = t14 * t195 * t208;
  t426 = 0.1e1 / t84 / t151 / t80;
  t428 = t202 * t88;
  t432 = t14 * t7;
  t433 = t200 * t88;
  t434 = t433 * t208;
  t439 = -0.6e1 * rho[0] * t229 + 0.6e1 * t108;
  t443 = 0.12e2 * t401 - 0.4e1 * t403 - 0.4e1 / 0.3e1 * t76 * t405 + 0.2e1 * t76 * t408 - t413 + 0.4e1 * t415 + 0.4e1 / 0.3e1 * t419 - 0.2e1 * t422 + 0.2e2 / 0.27e2 * t14 * t7 * t426 * t428 - 0.4e1 / 0.3e1 * t432 * t434 + 0.2e1 / 0.3e1 * t14 * t86 * t439;
  t444 = my_piecewise3(t10, 0, t443);
  t449 = t5 * t213 * t68;
  t452 = t5 * t93 * t143;
  t456 = 0.5e1 / 0.36e2 * t5 * t19 * t281;
  t458 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t444 * t20 - 0.3e1 / 0.8e1 * t449 + t452 / 0.4e1 - t456);
  t461 = 0.12e2 * t29 * t229 * t30;
  t463 = t106 * t236 * t110;
  t466 = 0.1e1 / t228 / t79;
  t468 = t234 * t466 * t238;
  t470 = t105 * t105;
  t471 = t13 * t470;
  t473 = 0.1e1 / t228 / t107;
  t476 = 0.1e1 / t109 / t105 / t80;
  t481 = my_piecewise3(t28, 0, -t461 - 0.12e2 * t463 + 0.4e1 * t468 - 0.2e2 / 0.27e2 * t471 * t473 * t476);
  t486 = t5 * t243 * t68;
  t489 = t5 * t115 * t143;
  t493 = 0.5e1 / 0.36e2 * t5 * t34 * t281;
  t495 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t481 * t20 - 0.3e1 / 0.8e1 * t486 + t489 / 0.4e1 - t493);
  t496 = t458 + t495;
  t497 = t6 * t496;
  t499 = t256 * t148;
  t501 = t125 * t260;
  t503 = t125 * t286;
  t505 = t147 * t285;
  t507 = 0.9e1 * t127 * t505;
  t508 = t51 * t51;
  t510 = 0.1e1 / t52 / t508;
  t512 = t42 * t46;
  t517 = t130 * t281;
  t522 = t54 / t20 / t107;
  t532 = 0.1e1 / t47 / t107;
  t536 = 0.48676251190042541751e-10 * t510 * t135 * t512 + 0.2556845404050203734e-5 * t264 * t80 + 0.25069780653346026714e-2 * t129 * t517 - 0.10781267102409728031e2 * t53 * t522 - 0.12784227020251018671e-5 * t510 * t80 - 0.14514083536147699677e-2 * t275 * t517 - 0.20022353190189494915e2 * t139 * t522 + 0.28821714327592905613e4 * t66 * t67 * t532;
  t537 = t72 * t536;
  t539 = 0.3e1 * t127 * t537;
  tv3rho30 = 0.3e1 * t392 - 0.18e2 * t395 - t398 - t400 + t497 * t75 - 0.9e1 * t499 - 0.9e1 * t501 - 0.9e1 * t503 - t507 - t539;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t541 = 0.2e1 * t344 * t75;
  t543 = 0.6e1 * t345 * t148;
  t544 = t179 * t260;
  t546 = t179 * t286;
  t551 = t178 * t72;
  t552 = t551 * t147;
  t561 = t14 * t294;
  t565 = t236 * t85;
  t566 = t152 * t565;
  t568 = t229 * t200;
  t569 = t568 * t88;
  t570 = t152 * t569;
  t573 = t108 * t426 * t202;
  t576 = t297 * t208;
  t579 = 0.8e1 * t401 - 0.4e1 / 0.3e1 * t403 - t413 + 0.8e1 / 0.3e1 * t415 + 0.4e1 / 0.9e1 * t419 - 0.2e1 / 0.3e1 * t422 - 0.4e1 / 0.3e1 * t314 * t85 + 0.8e1 * t561 + 0.16e2 / 0.9e1 * t14 * t298 - 0.8e1 * t566 - 0.8e1 / 0.3e1 * t570 - 0.2e2 / 0.27e2 * t152 * t573 + 0.4e1 / 0.9e1 * t152 * t576;
  t580 = my_piecewise3(t10, 0, t579);
  t586 = t5 * t302 * t68 / 0.4e1;
  t588 = t5 * t157 * t143;
  t593 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t580 * t20 - t586 + t588 / 0.12e2 - t449 / 0.8e1 + t452 / 0.6e1 - t456);
  t594 = t314 * t30;
  t596 = t13 * t229;
  t597 = t596 * t315;
  t599 = t13 * t236;
  t600 = t238 * t105;
  t606 = t29 * t111 * t167;
  t608 = t229 * t238;
  t610 = t106 * t608 * t167;
  t614 = 0.4e1 / 0.3e1 * t29 * t319 * t329;
  t615 = t236 * t476;
  t623 = rho[1] * t229;
  t624 = 0.6e1 * t623;
  t625 = 0.2e1 * t108 - t624;
  t629 = 0.4e1 * t594 + 0.8e1 / 0.3e1 * t597 - 0.4e1 / 0.9e1 * t599 * t600 - t461 - 0.4e1 * t463 + 0.4e1 / 0.9e1 * t468 + 0.4e1 / 0.3e1 * t606 - 0.16e2 / 0.9e1 * t610 - t614 + 0.2e2 / 0.27e2 * t234 * t615 * t167 + 0.8e1 / 0.9e1 * t106 * t323 * t329 + 0.2e1 / 0.3e1 * t29 * t165 * t625;
  t630 = my_piecewise3(t28, 0, t629);
  t636 = t5 * t334 * t68 / 0.4e1;
  t638 = t5 * t172 * t143;
  t643 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t630 * t20 - t636 + t638 / 0.12e2 - t486 / 0.8e1 + t489 / 0.6e1 - t493);
  t644 = t593 + t643;
  t645 = t6 * t644;
  tv3rho31 = t541 - t543 - 0.3e1 * t544 - 0.3e1 * t546 - 0.3e1 * t499 - 0.6e1 * t501 - 0.6e1 * t503 - t507 - t539 - 0.6e1 * t552 + t645 * t75 - 0.12e2 * t395 - t398 - t400 + t392;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t650 = t388 * t75;
  t658 = t466 * t200;
  t659 = t353 * t658;
  t661 = t236 * t426;
  t662 = t661 * t88;
  t666 = my_piecewise3(t10, 0, 0.4e1 * t401 - t413 + 0.4e1 / 0.3e1 * t415 + 0.16e2 / 0.3e1 * t561 - 0.32e2 / 0.3e1 * t566 - 0.16e2 / 0.9e1 * t570 - 0.4e1 / 0.3e1 * t152 * t354 + 0.2e2 / 0.9e1 * t659 + 0.2e2 / 0.27e2 * t353 * t662);
  t671 = t5 * t358 * t68;
  t676 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t666 * t20 - t671 / 0.8e1 - t586 + t588 / 0.6e1 + t452 / 0.12e2 - t456);
  t679 = t186 * t366;
  t681 = t238 * t167;
  t682 = t681 * rho[1];
  t685 = t110 * t329;
  t693 = t29 * t80 * t238 * t371;
  t699 = t29 * t7;
  t700 = t681 * t329;
  t704 = t29 * t319 * t376;
  t710 = 0.4e1 * t108 - t624;
  t714 = 0.8e1 * t594 + 0.4e1 / 0.3e1 * t597 - 0.4e1 / 0.3e1 * t679 + 0.8e1 / 0.9e1 * t314 * t682 + 0.4e1 / 0.3e1 * t76 * t685 - t461 - 0.4e1 / 0.3e1 * t463 + 0.8e1 / 0.3e1 * t606 - 0.8e1 / 0.9e1 * t610 - t614 + 0.4e1 / 0.9e1 * t693 - 0.2e2 / 0.27e2 * t106 * t108 * t476 * t371 - 0.8e1 / 0.9e1 * t699 * t700 - 0.2e1 / 0.3e1 * t704 + 0.4e1 / 0.9e1 * t106 * t323 * t376 + 0.2e1 / 0.3e1 * t29 * t165 * t710;
  t715 = my_piecewise3(t28, 0, t714);
  t720 = t5 * t381 * t68;
  t725 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t715 * t20 - t720 / 0.8e1 - t636 + t638 / 0.6e1 + t489 / 0.12e2 - t493);
  t726 = t676 + t725;
  t727 = t6 * t726;
  t729 = t389 * t148;
  tv3rho32 = t541 - 0.12e2 * t552 - 0.6e1 * t395 - t398 - t400 + t650 + t727 * t75 - 0.3e1 * t729 - t543 - 0.6e1 * t544 - 0.6e1 * t546 - 0.3e1 * t501 - t507 - 0.3e1 * t503 - t539;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t739 = t151 * t151;
  t740 = t13 * t739;
  t741 = t473 * t426;
  t745 = my_piecewise3(t10, 0, -t413 - 0.12e2 * t566 + 0.4e1 * t659 - 0.2e2 / 0.27e2 * t740 * t741);
  t752 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t745 * t20 - 0.3e1 / 0.8e1 * t671 + t588 / 0.4e1 - t456);
  t755 = t238 * t371;
  t758 = t110 * t376;
  t765 = t371 * t167;
  t769 = t681 * t376;
  t773 = 0.6e1 * t108 - 0.6e1 * t623;
  t777 = 0.12e2 * t594 - 0.4e1 * t679 - 0.4e1 / 0.3e1 * t76 * t755 + 0.2e1 * t76 * t758 - t461 + 0.4e1 * t606 + 0.4e1 / 0.3e1 * t693 - 0.2e1 * t704 + 0.2e2 / 0.27e2 * t29 * t7 * t476 * t765 - 0.4e1 / 0.3e1 * t699 * t769 + 0.2e1 / 0.3e1 * t29 * t165 * t773;
  t778 = my_piecewise3(t28, 0, t777);
  t785 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t778 * t20 - 0.3e1 / 0.8e1 * t720 + t638 / 0.4e1 - t493);
  t786 = t752 + t785;
  t787 = t6 * t786;
  tv3rho33 = 0.3e1 * t650 - 0.18e2 * t552 - t398 - t400 + t787 * t75 - 0.9e1 * t729 - 0.9e1 * t544 - 0.9e1 * t546 - t507 - t539;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t792 = t496 * t75;
  t794 = t125 * t537;
  t796 = t285 * t285;
  t798 = 0.9e1 * t127 * t796;
  t801 = 0.12e2 * t127 * t147 * t536;
  t804 = 0.1e1 / t52 / t508 / t51;
  t816 = t130 * t532;
  t821 = t54 / t20 / t228;
  t841 = 0.3e1 * t127 * t72 * (-0.2780039918912823523e-13 * t804 * t143 * t60 / t44 / t43 - 0.16225417063347513917e-9 * t510 * t271 * t512 - 0.78125831790422891872e-5 * t264 * t108 - 0.79167728378987452781e-2 * t129 * t816 + 0.3593755700803242677e2 * t53 * t821 + 0.81127085316737569591e-10 * t804 * t271 * t512 + 0.72443953114755772469e-5 * t510 * t108 + 0.61574899850323574387e-2 * t275 * t816 + 0.77009050731498057365e2 * t139 * t821 - 0.10567961920117398725e5 * t66 * t67 / t47 / t228);
  t842 = t497 * t148;
  t844 = t256 * t260;
  t846 = t256 * t286;
  t848 = t125 * t505;
  t850 = t186 * t405;
  t859 = 0.48e2 * t14 * t236 * t15;
  t861 = t14 * t294 * t88;
  t864 = t14 * t153 * t208;
  t867 = t14 * t195 * t439;
  t876 = t14 * t297 * t202;
  t880 = t14 * t80 * t426 * t428;
  t883 = t14 * t80 * t434;
  t887 = 0.1e1 / t84 / t352 / t108;
  t889 = t202 * t202;
  t897 = t208 * t208;
  t904 = t186 * t408;
  t909 = t596 * t15;
  t911 = t314 * t189;
  t913 = 0.16e2 / 0.3e1 * t850 + 0.8e2 / 0.27e2 * t76 * t426 * t428 - 0.16e2 / 0.3e1 * t76 * t434 + t859 - 0.16e2 * t861 + 0.8e1 * t864 - 0.8e1 / 0.3e1 * t867 + 0.2e1 / 0.3e1 * t14 * t86 * (0.24e2 * rho[0] * t236 - 0.24e2 * t229) - 0.16e2 / 0.3e1 * t876 - 0.8e2 / 0.27e2 * t880 + 0.16e2 / 0.3e1 * t883 - 0.16e3 / 0.81e2 * t14 * t7 * t887 * t889 + 0.4e2 / 0.9e1 * t432 * t426 * t202 * t208 - 0.4e1 / 0.3e1 * t14 * t201 * t897 - 0.16e2 / 0.9e1 * t432 * t433 * t439 - 0.8e1 * t904 + 0.8e1 / 0.3e1 * t76 * t85 * t439 - 0.48e2 * t909 + 0.16e2 * t911;
  t914 = my_piecewise3(t10, 0, t913);
  t919 = t5 * t444 * t68;
  t922 = t5 * t213 * t143;
  t925 = t5 * t93 * t281;
  t929 = 0.1e2 / 0.27e2 * t5 * t19 * t532;
  t931 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t914 * t20 - t919 / 0.2e1 + t922 / 0.2e1 - 0.5e1 / 0.9e1 * t925 + t929);
  t934 = 0.48e2 * t29 * t236 * t30;
  t936 = t106 * t466 * t110;
  t939 = t234 * t473 * t238;
  t941 = t228 * t228;
  t942 = 0.1e1 / t941;
  t944 = t471 * t942 * t476;
  t949 = 0.1e1 / t941 / t6;
  t952 = 0.1e1 / t109 / t233 / t108;
  t957 = my_piecewise3(t28, 0, t934 + 0.64e2 * t936 - 0.32e2 * t939 + 0.32e3 / 0.27e2 * t944 - 0.16e3 / 0.81e2 * t13 * t470 * rho[1] * t949 * t952);
  t962 = t5 * t481 * t68;
  t965 = t5 * t243 * t143;
  t968 = t5 * t115 * t281;
  t972 = 0.1e2 / 0.27e2 * t5 * t34 * t532;
  t974 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t957 * t20 - t962 / 0.2e1 + t965 / 0.2e1 - 0.5e1 / 0.9e1 * t968 + t972);
  t979 = t255 * t72 * t147;
  t981 = t124 * t260;
  t983 = t394 * t285;
  t987 = 0.36e2 * t39 * t147 * t285;
  t989 = 0.12e2 * t183 * t536;
  tv4rho40 = 0.4e1 * t792 - 0.12e2 * t794 - t798 - t801 - t841 - 0.12e2 * t842 - 0.18e2 * t844 - 0.18e2 * t846 - 0.36e2 * t848 + t6 * (t931 + t974) * t75 - 0.36e2 * t979 - 0.36e2 * t981 - 0.36e2 * t983 - t987 - t989;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t990 = t644 * t75;
  t1005 = t152 * t229 * t426 * t202;
  t1007 = t596 * t85;
  t1014 = t14 * t565;
  t1016 = t14 * t569;
  t1021 = t152 * t466 * t85;
  t1024 = t152 * t354 * t88;
  t1026 = 0.16e3 / 0.81e2 * t152 * t108 * t887 * t428 - 0.2e2 / 0.9e1 * t152 * t108 * t426 * t88 * t208 - 0.4e2 / 0.9e1 * t14 * t573 + 0.2e2 / 0.3e1 * t1005 + 0.12e2 * t1007 + 0.8e1 / 0.3e1 * t314 * t433 + 0.4e1 / 0.9e1 * t152 * t297 * t439 - 0.48e2 * t1014 - 0.16e2 * t1016 + 0.8e1 / 0.3e1 * t14 * t576 + 0.4e2 * t1021 + 0.16e2 * t1024;
  t1028 = t152 * t568 * t208;
  t1040 = -0.4e1 * t1028 + 0.4e1 / 0.3e1 * t850 + t859 - 0.12e2 * t861 + 0.4e1 * t864 - 0.2e1 / 0.3e1 * t867 - 0.8e1 / 0.3e1 * t876 - 0.2e2 / 0.27e2 * t880 + 0.4e1 / 0.3e1 * t883 - 0.2e1 * t904 - 0.36e2 * t909 + 0.8e1 * t911;
  t1042 = my_piecewise3(t10, 0, t1026 + t1040);
  t1047 = t5 * t580 * t68;
  t1050 = t5 * t302 * t143;
  t1051 = t1050 / 0.4e1;
  t1053 = t5 * t157 * t281;
  t1059 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1042 * t20 - 0.3e1 / 0.8e1 * t1047 + t1051 - 0.5e1 / 0.36e2 * t1053 - t919 / 0.8e1 + t922 / 0.4e1 - 0.5e1 / 0.12e2 * t925 + t929);
  t1061 = t29 * t230 * t167;
  t1063 = t596 * t30;
  t1065 = t599 * t315;
  t1068 = t13 * t466 * t600;
  t1075 = t29 * t111 * t329;
  t1076 = 0.4e1 * t1075;
  t1078 = t106 * t239 * t167;
  t1081 = t106 * t608 * t329;
  t1085 = t234 * t466 * t476 * t167;
  t1088 = t29 * t319 * t625;
  t1101 = rho[1] * t236;
  t1102 = 0.24e2 * t1101;
  t1110 = -0.4e1 * t1061 - 0.12e2 * t1063 - 0.12e2 * t1065 + 0.4e1 * t1068 - 0.2e2 / 0.27e2 * t13 * t473 * t476 * t233 + t1076 + 0.8e1 * t1078 - 0.16e2 / 0.3e1 * t1081 - 0.2e2 / 0.3e1 * t1085 - 0.2e1 * t1088 + 0.2e2 / 0.9e1 * t234 * t615 * t329 + 0.16e3 / 0.81e2 * t471 * t473 * t952 * t167 + 0.4e1 / 0.3e1 * t106 * t323 * t625 + 0.2e1 / 0.3e1 * t29 * t165 * (-0.6e1 * t229 + t1102) + t934 + 0.24e2 * t936 - 0.16e2 / 0.3e1 * t939 + 0.2e2 / 0.27e2 * t944;
  t1111 = my_piecewise3(t28, 0, t1110);
  t1116 = t5 * t630 * t68;
  t1119 = t5 * t334 * t143;
  t1120 = t1119 / 0.4e1;
  t1122 = t5 * t172 * t281;
  t1128 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t1111 * t20 - 0.3e1 / 0.8e1 * t1116 + t1120 - 0.5e1 / 0.36e2 * t1122 - t962 / 0.8e1 + t965 / 0.4e1 - 0.5e1 / 0.12e2 * t968 + t972);
  t1133 = t344 * t72 * t147;
  t1134 = 0.18e2 * t1133;
  t1135 = t178 * t260;
  t1137 = t645 * t148;
  t1139 = t345 * t260;
  t1140 = 0.9e1 * t1139;
  t1141 = t345 * t286;
  t1142 = 0.9e1 * t1141;
  t1143 = t179 * t505;
  t1145 = t551 * t285;
  t1147 = t179 * t537;
  t1150 = 0.3e1 * t990 + t6 * (t1059 + t1128) * t75 - t1134 - 0.9e1 * t1135 + t792 - 0.9e1 * t1137 - t1140 - t1142 - 0.9e1 * t1143 - 0.9e1 * t1145 - 0.3e1 * t1147 - 0.9e1 * t794;
  t1158 = -t798 - t801 - t841 - 0.3e1 * t842 - 0.9e1 * t844 - 0.9e1 * t846 - 0.27e2 * t848 - 0.18e2 * t979 - 0.27e2 * t981 - 0.27e2 * t983 - t987 - t989;
  tv4rho41 = t1150 + t1158;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1159 = t727 * t148;
  t1161 = t389 * t286;
  t1167 = t726 * t75;
  t1172 = t389 * t260;
  t1175 = t388 * t72 * t147;
  t1183 = t152 * t658;
  t1188 = t353 * t473 * t200;
  t1192 = t353 * t466 * t426 * t88;
  t1209 = -0.16e3 / 0.81e2 * t353 * t236 * t887 * t202 - 0.8e1 / 0.3e1 * t14 * t354 + 0.4e2 / 0.3e1 * t1183 + 0.4e2 / 0.9e1 * t152 * t662 - 0.4e2 / 0.3e1 * t1188 - 0.2e3 / 0.27e2 * t1192 + 0.2e2 / 0.27e2 * t353 * t661 * t208 + 0.8e2 / 0.27e2 * t1005 + 0.16e2 / 0.3e1 * t1007 - 0.128e3 / 0.3e1 * t1014 - 0.64e2 / 0.9e1 * t1016 + 0.16e3 / 0.3e1 * t1021 + 0.128e3 / 0.9e1 * t1024 - 0.16e2 / 0.9e1 * t1028 + t859 - 0.8e1 * t861 + 0.4e1 / 0.3e1 * t864 - 0.8e1 / 0.9e1 * t876 - 0.24e2 * t909 + 0.8e1 / 0.3e1 * t911;
  t1210 = my_piecewise3(t10, 0, t1209);
  t1215 = t5 * t666 * t68;
  t1218 = t5 * t358 * t143;
  t1226 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1210 * t20 - t1215 / 0.4e1 + t1218 / 0.12e2 - t1047 / 0.4e1 + t1050 / 0.3e1 - 0.5e1 / 0.18e2 * t1053 + t922 / 0.12e2 - 0.5e1 / 0.18e2 * t925 + t929);
  t1227 = t29 * t80;
  t1228 = t1227 * t700;
  t1230 = t106 * t108;
  t1231 = t476 * t167;
  t1238 = t314 * t366;
  t1240 = t186 * t685;
  t1248 = t106 * t608 * t376;
  t1257 = t29 * t323 * t371;
  t1259 = t329 * t329;
  t1264 = t29 * t111 * t376;
  t1271 = 0.16e2 / 0.9e1 * t1228 - 0.8e2 / 0.27e2 * t1230 * t1231 * t329 - 0.8e1 / 0.9e1 * t699 * t681 * t625 + 0.8e1 / 0.3e1 * t1238 - 0.8e1 / 0.3e1 * t1240 + 0.4e1 / 0.3e1 * t76 * t110 * t625 - 0.8e1 * t1065 + 0.8e1 / 0.9e1 * t1068 - 0.16e2 / 0.9e1 * t1248 + 0.8e1 / 0.9e1 * t106 * t323 * t710 + 0.2e2 / 0.27e2 * t234 * t615 * t376 - 0.8e1 / 0.9e1 * t1257 - 0.8e1 / 0.9e1 * t29 * t370 * t1259 + 0.4e1 / 0.3e1 * t1264 + 0.2e1 / 0.3e1 * t29 * t165 * (-0.12e2 * t229 + t1102);
  t1272 = t596 * t682;
  t1274 = t238 * t329;
  t1283 = t106 * t229 * t476 * t371;
  t1290 = t29 * t319 * t710;
  t1301 = -0.32e2 / 0.9e1 * t1272 + 0.16e2 / 0.9e1 * t314 * t1274 * rho[1] + 0.4e2 / 0.27e2 * t599 * t1231 * t105 + 0.8e2 / 0.27e2 * t1283 - 0.16e3 / 0.81e2 * t234 * t236 * t952 * t371 - 0.4e1 / 0.3e1 * t1290 - 0.8e1 * t1061 + 0.16e2 / 0.3e1 * t1075 + 0.16e2 / 0.3e1 * t1078 - 0.16e2 / 0.9e1 * t1081 - 0.4e2 / 0.27e2 * t1085 - 0.4e1 / 0.3e1 * t1088 - 0.24e2 * t1063 + t934 + 0.32e2 / 0.3e1 * t936 - 0.8e1 / 0.9e1 * t939;
  t1303 = my_piecewise3(t28, 0, t1271 + t1301);
  t1308 = t5 * t715 * t68;
  t1311 = t5 * t381 * t143;
  t1319 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t1303 * t20 - t1308 / 0.4e1 + t1311 / 0.12e2 - t1116 / 0.4e1 + t1119 / 0.3e1 - 0.5e1 / 0.18e2 * t1122 + t965 / 0.12e2 - 0.5e1 / 0.18e2 * t968 + t972);
  t1323 = -0.6e1 * t1159 - 0.3e1 * t1161 - 0.6e1 * t1147 - 0.6e1 * t1137 - 0.12e2 * t1141 - 0.18e2 * t1143 + 0.2e1 * t1167 - 0.18e2 * t1135 + 0.2e1 * t990 - 0.18e2 * t981 - 0.3e1 * t1172 - 0.6e1 * t1175 + t6 * (t1226 + t1319) * t75;
  t1333 = -0.6e1 * t979 - 0.18e2 * t983 - t987 - t989 - 0.24e2 * t1133 - 0.12e2 * t1139 - 0.18e2 * t1145 - t798 - 0.3e1 * t844 - t841 - 0.3e1 * t846 - 0.18e2 * t848 - 0.6e1 * t794 - t801;
  tv4rho42 = t1323 + t1333;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1335 = t787 * t148;
  t1340 = t786 * t75;
  t1352 = t740 * t942 * t426;
  t1358 = -0.12e2 * t909 + t859 - 0.4e1 * t861 - 0.24e2 * t1014 + 0.6e2 * t1021 + 0.8e1 * t1024 + 0.12e2 * t1183 - 0.24e2 * t1188 - 0.2e2 / 0.3e1 * t1192 - 0.8e2 / 0.27e2 * t353 * t741 + 0.14e3 / 0.27e2 * t1352 + 0.16e3 / 0.81e2 * t740 * t473 * t887 * t88;
  t1359 = my_piecewise3(t10, 0, t1358);
  t1364 = t5 * t745 * t68;
  t1371 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1359 * t20 - t1364 / 0.8e1 - 0.3e1 / 0.8e1 * t1215 + t1218 / 0.4e1 + t1051 - 0.5e1 / 0.12e2 * t1053 - 0.5e1 / 0.36e2 * t925 + t929);
  t1374 = t476 * t371;
  t1396 = t29 * t80 * t476 * t765;
  t1399 = t29 * t319 * t773;
  t1401 = t1227 * t769;
  t1416 = t186 * t755;
  t1418 = t186 * t758;
  t1420 = -0.8e1 / 0.3e1 * t76 * t700 - 0.2e2 / 0.9e1 * t314 * t1374 * rho[1] + 0.4e1 / 0.3e1 * t314 * t238 * t376 * rho[1] + 0.16e3 / 0.81e2 * t106 * t108 * t952 * t765 + 0.2e1 / 0.3e1 * t29 * t165 * (-0.18e2 * t229 + t1102) + 0.4e1 / 0.9e1 * t106 * t323 * t773 - 0.2e2 / 0.27e2 * t1396 - 0.2e1 / 0.3e1 * t1399 + 0.4e1 / 0.3e1 * t1401 + 0.2e2 / 0.9e1 * t699 * t1374 * t329 - 0.4e1 / 0.3e1 * t699 * t1274 * t376 - 0.4e1 / 0.3e1 * t699 * t681 * t710 - 0.2e2 / 0.9e1 * t1230 * t1231 * t376 + 0.8e1 / 0.3e1 * t1228 + 0.4e1 / 0.3e1 * t1416 - 0.2e1 * t1418;
  t1437 = 0.2e1 * t76 * t110 * t710 + 0.8e1 * t1238 - 0.4e1 * t1240 - 0.4e1 * t1065 - 0.4e1 / 0.3e1 * t1248 - 0.8e1 / 0.3e1 * t1257 + 0.4e1 * t1264 - 0.8e1 / 0.3e1 * t1272 + 0.2e2 / 0.9e1 * t1283 - 0.2e1 * t1290 - 0.12e2 * t1061 + t1076 + 0.8e1 / 0.3e1 * t1078 - 0.36e2 * t1063 + t934 + 0.4e1 * t936;
  t1439 = my_piecewise3(t28, 0, t1420 + t1437);
  t1444 = t5 * t778 * t68;
  t1451 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t1439 * t20 - t1444 / 0.8e1 - 0.3e1 / 0.8e1 * t1308 + t1311 / 0.4e1 + t1120 - 0.5e1 / 0.12e2 * t1122 - 0.5e1 / 0.36e2 * t968 + t972);
  t1457 = 0.3e1 * t1167 - 0.3e1 * t1335 - 0.9e1 * t1159 - 0.9e1 * t1172 - 0.9e1 * t1161 + t1340 + t6 * (t1371 + t1451) * t75 - 0.18e2 * t1175 - t1134 - 0.27e2 * t1135 - t1140 - t1142;
  t1465 = -0.27e2 * t1143 - 0.27e2 * t1145 - 0.9e1 * t1147 - 0.3e1 * t794 - t798 - t801 - t841 - 0.9e1 * t848 - 0.9e1 * t981 - 0.9e1 * t983 - t987 - t989;
  tv4rho43 = t1457 + t1465;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1475 = my_piecewise3(t10, 0, t859 + 0.64e2 * t1021 - 0.32e2 * t1188 + 0.32e3 / 0.27e2 * t1352 - 0.16e3 / 0.81e2 * t13 * t739 * rho[0] * t949 * t887);
  t1483 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1475 * t20 - t1364 / 0.2e1 + t1218 / 0.2e1 - 0.5e1 / 0.9e1 * t1053 + t929);
  t1485 = t371 * t371;
  t1492 = t376 * t376;
  t1522 = -0.16e3 / 0.81e2 * t29 * t7 * t952 * t1485 + 0.4e2 / 0.9e1 * t699 * t1374 * t376 - 0.4e1 / 0.3e1 * t29 * t370 * t1492 - 0.16e2 / 0.9e1 * t699 * t681 * t773 + 0.8e2 / 0.27e2 * t76 * t476 * t765 - 0.16e2 / 0.3e1 * t76 * t769 + 0.2e1 / 0.3e1 * t29 * t165 * (-0.24e2 * t229 + 0.24e2 * t1101) - 0.8e2 / 0.27e2 * t1396 - 0.8e1 / 0.3e1 * t1399 + 0.16e2 / 0.3e1 * t1416 - 0.8e1 * t1418 + 0.16e2 / 0.3e1 * t1401 - 0.16e2 / 0.3e1 * t1257 + 0.8e1 * t1264 + 0.16e2 * t1238 - 0.16e2 * t1061 + 0.8e1 / 0.3e1 * t76 * t110 * t773 - 0.48e2 * t1063 + t934;
  t1523 = my_piecewise3(t28, 0, t1522);
  t1531 = my_piecewise3(t25, 0, -0.3e1 / 0.8e1 * t5 * t1523 * t20 - t1444 / 0.2e1 + t1311 / 0.2e1 - 0.5e1 / 0.9e1 * t1122 + t972);
  tv4rho44 = t6 * (t1483 + t1531) * t75 - 0.12e2 * t1335 - 0.18e2 * t1172 - 0.18e2 * t1161 + 0.4e1 * t1340 - 0.36e2 * t1175 - 0.36e2 * t1135 - 0.36e2 * t1143 - 0.36e2 * t1145 - 0.12e2 * t1147 - t798 - t801 - t841 - t987 - t989;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

}

#endif

