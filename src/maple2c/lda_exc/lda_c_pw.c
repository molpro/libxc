/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/lda_exc/lda_c_pw.mpl
  Type of functional: lda_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t15, t17, t18, t19;
  double t21, t22, t26, t29, t30, t34, t36, t37;
  double t38, t39, t43, t44, t45, t47, t49, t52;
  double t56, t57, t59, t60, t63, t64, t65, t69;
  double t72, t77, t78, t79, t80, t84, t85, t87;
  double t89, tzk0;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = POW_1_3(rho[0]);
  t11 = 0.1e1 / t10;
  t12 = t9 * t11;
  t15 = 0.1e1 + t4 * t12 / 0.4e1;
  t17 = 0.1e1 / t1;
  t18 = params->beta1[0];
  t19 = t3 * t6;
  t21 = t19 * t8 * t11;
  t22 = sqrt(t21);
  t26 = params->beta2[0] * t3;
  t29 = params->beta3[0];
  t30 = POW_3_2(t21);
  t34 = t21 / 0.4e1;
  t36 = params->pp[0] + 0.1e1;
  t37 = pow(t34, t36);
  t38 = params->beta4[0] * t37;
  t39 = t18 * t22 / 0.2e1 + t26 * t12 / 0.4e1 + 0.125e0 * t29 * t30 + t38;
  t43 = 0.1e1 + t17 / t39 / 0.2e1;
  t44 = log(t43);
  t45 = t1 * t15 * t44;
  t47 = POW_1_3(p->zeta_threshold);
  t49 = my_piecewise3(0.1e1 <= p->zeta_threshold, t47 * p->zeta_threshold, 1);
  t52 = M_CBRT2;
  t56 = (0.2e1 * t49 - 0.2e1) / (0.2e1 * t52 - 0.2e1);
  t57 = params->a[2];
  t59 = params->alpha1[2];
  t60 = t59 * t3;
  t63 = 0.1e1 + t60 * t12 / 0.4e1;
  t64 = 0.1e1 / t57;
  t65 = params->beta1[2];
  t69 = params->beta2[2] * t3;
  t72 = params->beta3[2];
  t77 = params->pp[2] + 0.1e1;
  t78 = pow(t34, t77);
  t79 = params->beta4[2] * t78;
  t80 = t65 * t22 / 0.2e1 + t69 * t12 / 0.4e1 + 0.125e0 * t72 * t30 + t79;
  t84 = 0.1e1 + t64 / t80 / 0.2e1;
  t85 = log(t84);
  t87 = 0.1e1 / params->fz20;
  t89 = t56 * t57 * t63 * t85 * t87;
  tzk0 = -0.2e1 * t45 + 0.2e1 * t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t15, t17, t18, t19;
  double t21, t22, t26, t29, t30, t34, t36, t37;
  double t38, t39, t43, t44, t45, t47, t49, t52;
  double t56, t57, t59, t60, t63, t64, t65, t69;
  double t72, t77, t78, t79, t80, t84, t85, t87;
  double t89, tzk0;

  double t94, t96, t99, t101, t102, t103, t104, t106;
  double t107, t112, t114, t117, t121, t122, t123, t124;
  double t127, t131, t133, t134, t135, t137, t143, t149;
  double t151, t152, t154, tvrho0;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = POW_1_3(rho[0]);
  t11 = 0.1e1 / t10;
  t12 = t9 * t11;
  t15 = 0.1e1 + t4 * t12 / 0.4e1;
  t17 = 0.1e1 / t1;
  t18 = params->beta1[0];
  t19 = t3 * t6;
  t21 = t19 * t8 * t11;
  t22 = sqrt(t21);
  t26 = params->beta2[0] * t3;
  t29 = params->beta3[0];
  t30 = POW_3_2(t21);
  t34 = t21 / 0.4e1;
  t36 = params->pp[0] + 0.1e1;
  t37 = pow(t34, t36);
  t38 = params->beta4[0] * t37;
  t39 = t18 * t22 / 0.2e1 + t26 * t12 / 0.4e1 + 0.125e0 * t29 * t30 + t38;
  t43 = 0.1e1 + t17 / t39 / 0.2e1;
  t44 = log(t43);
  t45 = t1 * t15 * t44;
  t47 = POW_1_3(p->zeta_threshold);
  t49 = my_piecewise3(0.1e1 <= p->zeta_threshold, t47 * p->zeta_threshold, 1);
  t52 = M_CBRT2;
  t56 = (0.2e1 * t49 - 0.2e1) / (0.2e1 * t52 - 0.2e1);
  t57 = params->a[2];
  t59 = params->alpha1[2];
  t60 = t59 * t3;
  t63 = 0.1e1 + t60 * t12 / 0.4e1;
  t64 = 0.1e1 / t57;
  t65 = params->beta1[2];
  t69 = params->beta2[2] * t3;
  t72 = params->beta3[2];
  t77 = params->pp[2] + 0.1e1;
  t78 = pow(t34, t77);
  t79 = params->beta4[2] * t78;
  t80 = t65 * t22 / 0.2e1 + t69 * t12 / 0.4e1 + 0.125e0 * t72 * t30 + t79;
  t84 = 0.1e1 + t64 / t80 / 0.2e1;
  t85 = log(t84);
  t87 = 0.1e1 / params->fz20;
  t89 = t56 * t57 * t63 * t85 * t87;
  tzk0 = -0.2e1 * t45 + 0.2e1 * t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t94 = t1 * t2 * t3;
  t96 = 0.1e1 / t10 / rho[0];
  t99 = t94 * t9 * t96 * t44;
  t101 = t39 * t39;
  t102 = 0.1e1 / t101;
  t103 = t15 * t102;
  t104 = 0.1e1 / t22;
  t106 = t18 * t104 * t3;
  t107 = t9 * t96;
  t112 = sqrt(t21);
  t114 = t29 * t112 * t3;
  t117 = 0.1e1 / rho[0];
  t121 = -t106 * t107 / 0.12e2 - t26 * t107 / 0.12e2 - 0.625e-1 * t114 * t107 - t38 * t36 * t117 / 0.3e1;
  t122 = 0.1e1 / t43;
  t123 = t121 * t122;
  t124 = t103 * t123;
  t127 = t56 * t57 * t59 * t3;
  t131 = t127 * t9 * t96 * t85 * t87;
  t133 = t56 * t63;
  t134 = t80 * t80;
  t135 = 0.1e1 / t134;
  t137 = t65 * t104 * t3;
  t143 = t72 * t112 * t3;
  t149 = -t137 * t107 / 0.12e2 - t69 * t107 / 0.12e2 - 0.625e-1 * t143 * t107 - t79 * t77 * t117 / 0.3e1;
  t151 = 0.1e1 / t84;
  t152 = t151 * t87;
  t154 = t133 * t135 * t149 * t152;
  tvrho0 = -0.2e1 * t45 + 0.2e1 * t89 + rho[0] * (t99 / 0.6e1 + t124 - t131 / 0.6e1 - t154);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t15, t17, t18, t19;
  double t21, t22, t26, t29, t30, t34, t36, t37;
  double t38, t39, t43, t44, t45, t47, t49, t52;
  double t56, t57, t59, t60, t63, t64, t65, t69;
  double t72, t77, t78, t79, t80, t84, t85, t87;
  double t89, tzk0;

  double t94, t96, t99, t101, t102, t103, t104, t106;
  double t107, t112, t114, t117, t121, t122, t123, t124;
  double t127, t131, t133, t134, t135, t137, t143, t149;
  double t151, t152, t154, tvrho0;

  double t161, t163, t166, t168, t169, t171, t173, t174;
  double t175, t176, t177, t178, t181, t183, t184, t185;
  double t186, t187, t190, t193, t198, t200, t205, t206;
  double t213, t214, t215, t216, t217, t218, t219, t220;
  double t222, t223, t228, t231, t232, t233, t234, t235;
  double t237, t239, t240, t241, t244, t247, t255, t260;
  double t267, t270, t271, t272, t274, t275, t276, t277;
  double t278, t280, tv2rho20;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = POW_1_3(rho[0]);
  t11 = 0.1e1 / t10;
  t12 = t9 * t11;
  t15 = 0.1e1 + t4 * t12 / 0.4e1;
  t17 = 0.1e1 / t1;
  t18 = params->beta1[0];
  t19 = t3 * t6;
  t21 = t19 * t8 * t11;
  t22 = sqrt(t21);
  t26 = params->beta2[0] * t3;
  t29 = params->beta3[0];
  t30 = POW_3_2(t21);
  t34 = t21 / 0.4e1;
  t36 = params->pp[0] + 0.1e1;
  t37 = pow(t34, t36);
  t38 = params->beta4[0] * t37;
  t39 = t18 * t22 / 0.2e1 + t26 * t12 / 0.4e1 + 0.125e0 * t29 * t30 + t38;
  t43 = 0.1e1 + t17 / t39 / 0.2e1;
  t44 = log(t43);
  t45 = t1 * t15 * t44;
  t47 = POW_1_3(p->zeta_threshold);
  t49 = my_piecewise3(0.1e1 <= p->zeta_threshold, t47 * p->zeta_threshold, 1);
  t52 = M_CBRT2;
  t56 = (0.2e1 * t49 - 0.2e1) / (0.2e1 * t52 - 0.2e1);
  t57 = params->a[2];
  t59 = params->alpha1[2];
  t60 = t59 * t3;
  t63 = 0.1e1 + t60 * t12 / 0.4e1;
  t64 = 0.1e1 / t57;
  t65 = params->beta1[2];
  t69 = params->beta2[2] * t3;
  t72 = params->beta3[2];
  t77 = params->pp[2] + 0.1e1;
  t78 = pow(t34, t77);
  t79 = params->beta4[2] * t78;
  t80 = t65 * t22 / 0.2e1 + t69 * t12 / 0.4e1 + 0.125e0 * t72 * t30 + t79;
  t84 = 0.1e1 + t64 / t80 / 0.2e1;
  t85 = log(t84);
  t87 = 0.1e1 / params->fz20;
  t89 = t56 * t57 * t63 * t85 * t87;
  tzk0 = -0.2e1 * t45 + 0.2e1 * t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t94 = t1 * t2 * t3;
  t96 = 0.1e1 / t10 / rho[0];
  t99 = t94 * t9 * t96 * t44;
  t101 = t39 * t39;
  t102 = 0.1e1 / t101;
  t103 = t15 * t102;
  t104 = 0.1e1 / t22;
  t106 = t18 * t104 * t3;
  t107 = t9 * t96;
  t112 = sqrt(t21);
  t114 = t29 * t112 * t3;
  t117 = 0.1e1 / rho[0];
  t121 = -t106 * t107 / 0.12e2 - t26 * t107 / 0.12e2 - 0.625e-1 * t114 * t107 - t38 * t36 * t117 / 0.3e1;
  t122 = 0.1e1 / t43;
  t123 = t121 * t122;
  t124 = t103 * t123;
  t127 = t56 * t57 * t59 * t3;
  t131 = t127 * t9 * t96 * t85 * t87;
  t133 = t56 * t63;
  t134 = t80 * t80;
  t135 = 0.1e1 / t134;
  t137 = t65 * t104 * t3;
  t143 = t72 * t112 * t3;
  t149 = -t137 * t107 / 0.12e2 - t69 * t107 / 0.12e2 - 0.625e-1 * t143 * t107 - t79 * t77 * t117 / 0.3e1;
  t151 = 0.1e1 / t84;
  t152 = t151 * t87;
  t154 = t133 * t135 * t149 * t152;
  tvrho0 = -0.2e1 * t45 + 0.2e1 * t89 + rho[0] * (t99 / 0.6e1 + t124 - t131 / 0.6e1 - t154);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t161 = rho[0] * rho[0];
  t163 = 0.1e1 / t10 / t161;
  t166 = t94 * t9 * t163 * t44;
  t168 = t4 * t9;
  t169 = t96 * t102;
  t171 = t168 * t169 * t123;
  t173 = t101 * t39;
  t174 = 0.1e1 / t173;
  t175 = t15 * t174;
  t176 = t121 * t121;
  t177 = t176 * t122;
  t178 = t175 * t177;
  t181 = 0.1e1 / t22 / t21;
  t183 = t3 * t3;
  t184 = t18 * t181 * t183;
  t185 = t6 * t6;
  t186 = t185 * t7;
  t187 = t10 * t10;
  t190 = t186 / t187 / t161;
  t193 = t9 * t163;
  t198 = 0.1e1/sqrt(t21);
  t200 = t29 * t198 * t183;
  t205 = t36 * t36;
  t206 = 0.1e1 / t161;
  t213 = -t184 * t190 / 0.18e2 + t106 * t193 / 0.9e1 + t26 * t193 / 0.9e1 + 0.41666666666666666666e-1 * t200 * t190 + 0.83333333333333333333e-1 * t114 * t193 + t38 * t205 * t206 / 0.9e1 + t38 * t36 * t206 / 0.3e1;
  t214 = t213 * t122;
  t215 = t103 * t214;
  t216 = t101 * t101;
  t217 = 0.1e1 / t216;
  t218 = t15 * t217;
  t219 = t43 * t43;
  t220 = 0.1e1 / t219;
  t222 = t176 * t220 * t17;
  t223 = t218 * t222;
  t228 = t127 * t9 * t163 * t85 * t87;
  t231 = t56 * t60 * t6;
  t232 = t8 * t96;
  t233 = t232 * t135;
  t234 = t149 * t151;
  t235 = t234 * t87;
  t237 = t231 * t233 * t235;
  t239 = t134 * t80;
  t240 = 0.1e1 / t239;
  t241 = t149 * t149;
  t244 = t133 * t240 * t241 * t152;
  t247 = t65 * t181 * t183;
  t255 = t72 * t198 * t183;
  t260 = t77 * t77;
  t267 = -t247 * t190 / 0.18e2 + t137 * t193 / 0.9e1 + t69 * t193 / 0.9e1 + 0.41666666666666666666e-1 * t255 * t190 + 0.83333333333333333333e-1 * t143 * t193 + t79 * t260 * t206 / 0.9e1 + t79 * t77 * t206 / 0.3e1;
  t270 = t133 * t135 * t267 * t152;
  t271 = t134 * t134;
  t272 = 0.1e1 / t271;
  t274 = t56 * t63 * t272;
  t275 = t84 * t84;
  t276 = 0.1e1 / t275;
  t277 = t241 * t276;
  t278 = t87 * t64;
  t280 = t274 * t277 * t278;
  tv2rho20 = t99 / 0.3e1 + 0.2e1 * t124 - t131 / 0.3e1 - 0.2e1 * t154 + rho[0] * (-0.2e1 / 0.9e1 * t166 - t171 / 0.6e1 - 0.2e1 * t178 + t215 + t223 / 0.2e1 + 0.2e1 / 0.9e1 * t228 + t237 / 0.6e1 + 0.2e1 * t244 - t270 - t280 / 0.2e1);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t15, t17, t18, t19;
  double t21, t22, t26, t29, t30, t34, t36, t37;
  double t38, t39, t43, t44, t45, t47, t49, t52;
  double t56, t57, t59, t60, t63, t64, t65, t69;
  double t72, t77, t78, t79, t80, t84, t85, t87;
  double t89, tzk0;

  double t94, t96, t99, t101, t102, t103, t104, t106;
  double t107, t112, t114, t117, t121, t122, t123, t124;
  double t127, t131, t133, t134, t135, t137, t143, t149;
  double t151, t152, t154, tvrho0;

  double t161, t163, t166, t168, t169, t171, t173, t174;
  double t175, t176, t177, t178, t181, t183, t184, t185;
  double t186, t187, t190, t193, t198, t200, t205, t206;
  double t213, t214, t215, t216, t217, t218, t219, t220;
  double t222, t223, t228, t231, t232, t233, t234, t235;
  double t237, t239, t240, t241, t244, t247, t255, t260;
  double t267, t270, t271, t272, t274, t275, t276, t277;
  double t278, t280, tv2rho20;

  double t300, t301, t302, t303, t304, t307, t310, t314;
  double t315, t320, t321, t328, t329, t339, t340, t341;
  double t344, t345, t347, t348, t349, t351, t352, t355;
  double t356, t358, t359, t362, t363, t365, t367, t368;
  double t369, t370, t372, t381, t388, t398, t401, t404;
  double t406, t408, t411, t413, t416, t418, t420, t421;
  double t423, t426, t428, t431, t434, t436, t438, t440;
  double t441, t442, t444, t449, t451, t452, t454, t457;
  double t459, t461, t463, t465, t467, t470, t472, t475;
  double t476, t478, t482, t483, t485, t486, t488, t490;
  double tv3rho30;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = POW_1_3(rho[0]);
  t11 = 0.1e1 / t10;
  t12 = t9 * t11;
  t15 = 0.1e1 + t4 * t12 / 0.4e1;
  t17 = 0.1e1 / t1;
  t18 = params->beta1[0];
  t19 = t3 * t6;
  t21 = t19 * t8 * t11;
  t22 = sqrt(t21);
  t26 = params->beta2[0] * t3;
  t29 = params->beta3[0];
  t30 = POW_3_2(t21);
  t34 = t21 / 0.4e1;
  t36 = params->pp[0] + 0.1e1;
  t37 = pow(t34, t36);
  t38 = params->beta4[0] * t37;
  t39 = t18 * t22 / 0.2e1 + t26 * t12 / 0.4e1 + 0.125e0 * t29 * t30 + t38;
  t43 = 0.1e1 + t17 / t39 / 0.2e1;
  t44 = log(t43);
  t45 = t1 * t15 * t44;
  t47 = POW_1_3(p->zeta_threshold);
  t49 = my_piecewise3(0.1e1 <= p->zeta_threshold, t47 * p->zeta_threshold, 1);
  t52 = M_CBRT2;
  t56 = (0.2e1 * t49 - 0.2e1) / (0.2e1 * t52 - 0.2e1);
  t57 = params->a[2];
  t59 = params->alpha1[2];
  t60 = t59 * t3;
  t63 = 0.1e1 + t60 * t12 / 0.4e1;
  t64 = 0.1e1 / t57;
  t65 = params->beta1[2];
  t69 = params->beta2[2] * t3;
  t72 = params->beta3[2];
  t77 = params->pp[2] + 0.1e1;
  t78 = pow(t34, t77);
  t79 = params->beta4[2] * t78;
  t80 = t65 * t22 / 0.2e1 + t69 * t12 / 0.4e1 + 0.125e0 * t72 * t30 + t79;
  t84 = 0.1e1 + t64 / t80 / 0.2e1;
  t85 = log(t84);
  t87 = 0.1e1 / params->fz20;
  t89 = t56 * t57 * t63 * t85 * t87;
  tzk0 = -0.2e1 * t45 + 0.2e1 * t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t94 = t1 * t2 * t3;
  t96 = 0.1e1 / t10 / rho[0];
  t99 = t94 * t9 * t96 * t44;
  t101 = t39 * t39;
  t102 = 0.1e1 / t101;
  t103 = t15 * t102;
  t104 = 0.1e1 / t22;
  t106 = t18 * t104 * t3;
  t107 = t9 * t96;
  t112 = sqrt(t21);
  t114 = t29 * t112 * t3;
  t117 = 0.1e1 / rho[0];
  t121 = -t106 * t107 / 0.12e2 - t26 * t107 / 0.12e2 - 0.625e-1 * t114 * t107 - t38 * t36 * t117 / 0.3e1;
  t122 = 0.1e1 / t43;
  t123 = t121 * t122;
  t124 = t103 * t123;
  t127 = t56 * t57 * t59 * t3;
  t131 = t127 * t9 * t96 * t85 * t87;
  t133 = t56 * t63;
  t134 = t80 * t80;
  t135 = 0.1e1 / t134;
  t137 = t65 * t104 * t3;
  t143 = t72 * t112 * t3;
  t149 = -t137 * t107 / 0.12e2 - t69 * t107 / 0.12e2 - 0.625e-1 * t143 * t107 - t79 * t77 * t117 / 0.3e1;
  t151 = 0.1e1 / t84;
  t152 = t151 * t87;
  t154 = t133 * t135 * t149 * t152;
  tvrho0 = -0.2e1 * t45 + 0.2e1 * t89 + rho[0] * (t99 / 0.6e1 + t124 - t131 / 0.6e1 - t154);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t161 = rho[0] * rho[0];
  t163 = 0.1e1 / t10 / t161;
  t166 = t94 * t9 * t163 * t44;
  t168 = t4 * t9;
  t169 = t96 * t102;
  t171 = t168 * t169 * t123;
  t173 = t101 * t39;
  t174 = 0.1e1 / t173;
  t175 = t15 * t174;
  t176 = t121 * t121;
  t177 = t176 * t122;
  t178 = t175 * t177;
  t181 = 0.1e1 / t22 / t21;
  t183 = t3 * t3;
  t184 = t18 * t181 * t183;
  t185 = t6 * t6;
  t186 = t185 * t7;
  t187 = t10 * t10;
  t190 = t186 / t187 / t161;
  t193 = t9 * t163;
  t198 = 0.1e1/sqrt(t21);
  t200 = t29 * t198 * t183;
  t205 = t36 * t36;
  t206 = 0.1e1 / t161;
  t213 = -t184 * t190 / 0.18e2 + t106 * t193 / 0.9e1 + t26 * t193 / 0.9e1 + 0.41666666666666666666e-1 * t200 * t190 + 0.83333333333333333333e-1 * t114 * t193 + t38 * t205 * t206 / 0.9e1 + t38 * t36 * t206 / 0.3e1;
  t214 = t213 * t122;
  t215 = t103 * t214;
  t216 = t101 * t101;
  t217 = 0.1e1 / t216;
  t218 = t15 * t217;
  t219 = t43 * t43;
  t220 = 0.1e1 / t219;
  t222 = t176 * t220 * t17;
  t223 = t218 * t222;
  t228 = t127 * t9 * t163 * t85 * t87;
  t231 = t56 * t60 * t6;
  t232 = t8 * t96;
  t233 = t232 * t135;
  t234 = t149 * t151;
  t235 = t234 * t87;
  t237 = t231 * t233 * t235;
  t239 = t134 * t80;
  t240 = 0.1e1 / t239;
  t241 = t149 * t149;
  t244 = t133 * t240 * t241 * t152;
  t247 = t65 * t181 * t183;
  t255 = t72 * t198 * t183;
  t260 = t77 * t77;
  t267 = -t247 * t190 / 0.18e2 + t137 * t193 / 0.9e1 + t69 * t193 / 0.9e1 + 0.41666666666666666666e-1 * t255 * t190 + 0.83333333333333333333e-1 * t143 * t193 + t79 * t260 * t206 / 0.9e1 + t79 * t77 * t206 / 0.3e1;
  t270 = t133 * t135 * t267 * t152;
  t271 = t134 * t134;
  t272 = 0.1e1 / t271;
  t274 = t56 * t63 * t272;
  t275 = t84 * t84;
  t276 = 0.1e1 / t275;
  t277 = t241 * t276;
  t278 = t87 * t64;
  t280 = t274 * t277 * t278;
  tv2rho20 = t99 / 0.3e1 + 0.2e1 * t124 - t131 / 0.3e1 - 0.2e1 * t154 + rho[0] * (-0.2e1 / 0.9e1 * t166 - t171 / 0.6e1 - 0.2e1 * t178 + t215 + t223 / 0.2e1 + 0.2e1 / 0.9e1 * t228 + t237 / 0.6e1 + 0.2e1 * t244 - t270 - t280 / 0.2e1);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t300 = 0.1e1 / t22 / t183 / t185 / t7 * t187 / 0.4e1;
  t301 = t18 * t300;
  t302 = t161 * t161;
  t303 = 0.1e1 / t302;
  t304 = t5 * t303;
  t307 = t161 * rho[0];
  t310 = t186 / t187 / t307;
  t314 = 0.1e1 / t10 / t307;
  t315 = t9 * t314;
  t320 = 0.1e1/POW_3_2(t21);
  t321 = t29 * t320;
  t328 = t205 * t36;
  t329 = 0.1e1 / t307;
  t339 = -t301 * t304 / 0.3e1 + 0.2e1 / 0.9e1 * t184 * t310 - 0.7e1 / 0.27e2 * t106 * t315 - 0.7e1 / 0.27e2 * t26 * t315 + 0.83333333333333333332e-1 * t321 * t304 - 0.16666666666666666666e0 * t200 * t310 - 0.19444444444444444444e0 * t114 * t315 - t38 * t328 * t329 / 0.27e2 - t38 * t205 * t329 / 0.3e1 - 0.2e1 / 0.3e1 * t38 * t36 * t329;
  t340 = t339 * t122;
  t341 = t103 * t340;
  t344 = t220 * t17 * t121;
  t345 = t218 * t213 * t344;
  t347 = t176 * t121;
  t348 = t347 * t122;
  t349 = t218 * t348;
  t351 = t123 * t213;
  t352 = t175 * t351;
  t355 = 0.1e1 / t216 / t39;
  t356 = t15 * t355;
  t358 = t347 * t220 * t17;
  t359 = t356 * t358;
  t362 = 0.1e1 / t216 / t101;
  t363 = t15 * t362;
  t365 = 0.1e1 / t219 / t43;
  t367 = t1 * t1;
  t368 = 0.1e1 / t367;
  t369 = t347 * t365 * t368;
  t370 = t363 * t369;
  t372 = t65 * t300;
  t381 = t72 * t320;
  t388 = t260 * t77;
  t398 = -t372 * t304 / 0.3e1 + 0.2e1 / 0.9e1 * t247 * t310 - 0.7e1 / 0.27e2 * t137 * t315 - 0.7e1 / 0.27e2 * t69 * t315 + 0.83333333333333333332e-1 * t381 * t304 - 0.16666666666666666666e0 * t255 * t310 - 0.19444444444444444444e0 * t143 * t315 - t79 * t388 * t329 / 0.27e2 - t79 * t260 * t329 / 0.3e1 - 0.2e1 / 0.3e1 * t79 * t77 * t329;
  t401 = t133 * t135 * t398 * t152;
  t404 = t94 * t9 * t314 * t44;
  t406 = t163 * t102;
  t408 = t168 * t406 * t123;
  t411 = t168 * t169 * t214;
  t413 = t241 * t149;
  t416 = t133 * t272 * t413 * t152;
  t418 = t341 + 0.3e1 / 0.2e1 * t345 + 0.6e1 * t349 - 0.6e1 * t352 - 0.3e1 * t359 + t370 / 0.2e1 - t401 + 0.14e2 / 0.27e2 * t404 + t408 / 0.3e1 - t411 / 0.4e1 - 0.6e1 * t416;
  t420 = t56 * t63 * t240;
  t421 = t87 * t267;
  t423 = t420 * t234 * t421;
  t426 = 0.1e1 / t271 / t80;
  t428 = t56 * t63 * t426;
  t431 = t428 * t413 * t276 * t278;
  t434 = 0.1e1 / t271 / t134;
  t436 = t56 * t63 * t434;
  t438 = 0.1e1 / t275 / t84;
  t440 = t57 * t57;
  t441 = 0.1e1 / t440;
  t442 = t87 * t441;
  t444 = t436 * t413 * t438 * t442;
  t449 = t127 * t9 * t314 * t85 * t87;
  t451 = t8 * t163;
  t452 = t451 * t135;
  t454 = t231 * t452 * t235;
  t457 = t267 * t151 * t87;
  t459 = t231 * t233 * t457;
  t461 = t96 * t174;
  t463 = t168 * t461 * t177;
  t465 = t96 * t217;
  t467 = t168 * t465 * t222;
  t470 = t278 * t149;
  t472 = t274 * t267 * t276 * t470;
  t475 = t241 * t151;
  t476 = t475 * t87;
  t478 = t231 * t232 * t240 * t476;
  t482 = t56 * t59 * t19 * t8;
  t483 = t96 * t272;
  t485 = t276 * t87;
  t486 = t485 * t64;
  t488 = t482 * t483 * t241 * t486;
  t490 = 0.6e1 * t423 + 0.3e1 * t431 - t444 / 0.2e1 - 0.14e2 / 0.27e2 * t449 - t454 / 0.3e1 + t459 / 0.4e1 + t463 / 0.2e1 - t467 / 0.8e1 - 0.3e1 / 0.2e1 * t472 - t478 / 0.2e1 + t488 / 0.8e1;
  tv3rho30 = -0.2e1 / 0.3e1 * t166 - t171 / 0.2e1 - 0.6e1 * t178 + 0.3e1 * t215 + 0.3e1 / 0.2e1 * t223 + 0.2e1 / 0.3e1 * t228 + t237 / 0.2e1 + 0.6e1 * t244 - 0.3e1 * t270 - 0.3e1 / 0.2e1 * t280 + rho[0] * (t418 + t490);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t15, t17, t18, t19;
  double t21, t22, t26, t29, t30, t34, t36, t37;
  double t38, t39, t43, t44, t45, t47, t49, t52;
  double t56, t57, t59, t60, t63, t64, t65, t69;
  double t72, t77, t78, t79, t80, t84, t85, t87;
  double t89, tzk0;

  double t94, t96, t99, t101, t102, t103, t104, t106;
  double t107, t112, t114, t117, t121, t122, t123, t124;
  double t127, t131, t133, t134, t135, t137, t143, t149;
  double t151, t152, t154, tvrho0;

  double t161, t163, t166, t168, t169, t171, t173, t174;
  double t175, t176, t177, t178, t181, t183, t184, t185;
  double t186, t187, t190, t193, t198, t200, t205, t206;
  double t213, t214, t215, t216, t217, t218, t219, t220;
  double t222, t223, t228, t231, t232, t233, t234, t235;
  double t237, t239, t240, t241, t244, t247, t255, t260;
  double t267, t270, t271, t272, t274, t275, t276, t277;
  double t278, t280, tv2rho20;

  double t300, t301, t302, t303, t304, t307, t310, t314;
  double t315, t320, t321, t328, t329, t339, t340, t341;
  double t344, t345, t347, t348, t349, t351, t352, t355;
  double t356, t358, t359, t362, t363, t365, t367, t368;
  double t369, t370, t372, t381, t388, t398, t401, t404;
  double t406, t408, t411, t413, t416, t418, t420, t421;
  double t423, t426, t428, t431, t434, t436, t438, t440;
  double t441, t442, t444, t449, t451, t452, t454, t457;
  double t459, t461, t463, t465, t467, t470, t472, t475;
  double t476, t478, t482, t483, t485, t486, t488, t490;
  double tv3rho30;

  double t494, t501, t520, t523, t545, t549, t552, t556;
  double t560, t565, t569, t570, t575, t586, t599, t612;
  double t621, t626, t630, t653, t658, t682, t695, t745;
  double t798, t810, t822, tv4rho40;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = POW_1_3(rho[0]);
  t11 = 0.1e1 / t10;
  t12 = t9 * t11;
  t15 = 0.1e1 + t4 * t12 / 0.4e1;
  t17 = 0.1e1 / t1;
  t18 = params->beta1[0];
  t19 = t3 * t6;
  t21 = t19 * t8 * t11;
  t22 = sqrt(t21);
  t26 = params->beta2[0] * t3;
  t29 = params->beta3[0];
  t30 = POW_3_2(t21);
  t34 = t21 / 0.4e1;
  t36 = params->pp[0] + 0.1e1;
  t37 = pow(t34, t36);
  t38 = params->beta4[0] * t37;
  t39 = t18 * t22 / 0.2e1 + t26 * t12 / 0.4e1 + 0.125e0 * t29 * t30 + t38;
  t43 = 0.1e1 + t17 / t39 / 0.2e1;
  t44 = log(t43);
  t45 = t1 * t15 * t44;
  t47 = POW_1_3(p->zeta_threshold);
  t49 = my_piecewise3(0.1e1 <= p->zeta_threshold, t47 * p->zeta_threshold, 1);
  t52 = M_CBRT2;
  t56 = (0.2e1 * t49 - 0.2e1) / (0.2e1 * t52 - 0.2e1);
  t57 = params->a[2];
  t59 = params->alpha1[2];
  t60 = t59 * t3;
  t63 = 0.1e1 + t60 * t12 / 0.4e1;
  t64 = 0.1e1 / t57;
  t65 = params->beta1[2];
  t69 = params->beta2[2] * t3;
  t72 = params->beta3[2];
  t77 = params->pp[2] + 0.1e1;
  t78 = pow(t34, t77);
  t79 = params->beta4[2] * t78;
  t80 = t65 * t22 / 0.2e1 + t69 * t12 / 0.4e1 + 0.125e0 * t72 * t30 + t79;
  t84 = 0.1e1 + t64 / t80 / 0.2e1;
  t85 = log(t84);
  t87 = 0.1e1 / params->fz20;
  t89 = t56 * t57 * t63 * t85 * t87;
  tzk0 = -0.2e1 * t45 + 0.2e1 * t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t94 = t1 * t2 * t3;
  t96 = 0.1e1 / t10 / rho[0];
  t99 = t94 * t9 * t96 * t44;
  t101 = t39 * t39;
  t102 = 0.1e1 / t101;
  t103 = t15 * t102;
  t104 = 0.1e1 / t22;
  t106 = t18 * t104 * t3;
  t107 = t9 * t96;
  t112 = sqrt(t21);
  t114 = t29 * t112 * t3;
  t117 = 0.1e1 / rho[0];
  t121 = -t106 * t107 / 0.12e2 - t26 * t107 / 0.12e2 - 0.625e-1 * t114 * t107 - t38 * t36 * t117 / 0.3e1;
  t122 = 0.1e1 / t43;
  t123 = t121 * t122;
  t124 = t103 * t123;
  t127 = t56 * t57 * t59 * t3;
  t131 = t127 * t9 * t96 * t85 * t87;
  t133 = t56 * t63;
  t134 = t80 * t80;
  t135 = 0.1e1 / t134;
  t137 = t65 * t104 * t3;
  t143 = t72 * t112 * t3;
  t149 = -t137 * t107 / 0.12e2 - t69 * t107 / 0.12e2 - 0.625e-1 * t143 * t107 - t79 * t77 * t117 / 0.3e1;
  t151 = 0.1e1 / t84;
  t152 = t151 * t87;
  t154 = t133 * t135 * t149 * t152;
  tvrho0 = -0.2e1 * t45 + 0.2e1 * t89 + rho[0] * (t99 / 0.6e1 + t124 - t131 / 0.6e1 - t154);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t161 = rho[0] * rho[0];
  t163 = 0.1e1 / t10 / t161;
  t166 = t94 * t9 * t163 * t44;
  t168 = t4 * t9;
  t169 = t96 * t102;
  t171 = t168 * t169 * t123;
  t173 = t101 * t39;
  t174 = 0.1e1 / t173;
  t175 = t15 * t174;
  t176 = t121 * t121;
  t177 = t176 * t122;
  t178 = t175 * t177;
  t181 = 0.1e1 / t22 / t21;
  t183 = t3 * t3;
  t184 = t18 * t181 * t183;
  t185 = t6 * t6;
  t186 = t185 * t7;
  t187 = t10 * t10;
  t190 = t186 / t187 / t161;
  t193 = t9 * t163;
  t198 = 0.1e1/sqrt(t21);
  t200 = t29 * t198 * t183;
  t205 = t36 * t36;
  t206 = 0.1e1 / t161;
  t213 = -t184 * t190 / 0.18e2 + t106 * t193 / 0.9e1 + t26 * t193 / 0.9e1 + 0.41666666666666666666e-1 * t200 * t190 + 0.83333333333333333333e-1 * t114 * t193 + t38 * t205 * t206 / 0.9e1 + t38 * t36 * t206 / 0.3e1;
  t214 = t213 * t122;
  t215 = t103 * t214;
  t216 = t101 * t101;
  t217 = 0.1e1 / t216;
  t218 = t15 * t217;
  t219 = t43 * t43;
  t220 = 0.1e1 / t219;
  t222 = t176 * t220 * t17;
  t223 = t218 * t222;
  t228 = t127 * t9 * t163 * t85 * t87;
  t231 = t56 * t60 * t6;
  t232 = t8 * t96;
  t233 = t232 * t135;
  t234 = t149 * t151;
  t235 = t234 * t87;
  t237 = t231 * t233 * t235;
  t239 = t134 * t80;
  t240 = 0.1e1 / t239;
  t241 = t149 * t149;
  t244 = t133 * t240 * t241 * t152;
  t247 = t65 * t181 * t183;
  t255 = t72 * t198 * t183;
  t260 = t77 * t77;
  t267 = -t247 * t190 / 0.18e2 + t137 * t193 / 0.9e1 + t69 * t193 / 0.9e1 + 0.41666666666666666666e-1 * t255 * t190 + 0.83333333333333333333e-1 * t143 * t193 + t79 * t260 * t206 / 0.9e1 + t79 * t77 * t206 / 0.3e1;
  t270 = t133 * t135 * t267 * t152;
  t271 = t134 * t134;
  t272 = 0.1e1 / t271;
  t274 = t56 * t63 * t272;
  t275 = t84 * t84;
  t276 = 0.1e1 / t275;
  t277 = t241 * t276;
  t278 = t87 * t64;
  t280 = t274 * t277 * t278;
  tv2rho20 = t99 / 0.3e1 + 0.2e1 * t124 - t131 / 0.3e1 - 0.2e1 * t154 + rho[0] * (-0.2e1 / 0.9e1 * t166 - t171 / 0.6e1 - 0.2e1 * t178 + t215 + t223 / 0.2e1 + 0.2e1 / 0.9e1 * t228 + t237 / 0.6e1 + 0.2e1 * t244 - t270 - t280 / 0.2e1);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t300 = 0.1e1 / t22 / t183 / t185 / t7 * t187 / 0.4e1;
  t301 = t18 * t300;
  t302 = t161 * t161;
  t303 = 0.1e1 / t302;
  t304 = t5 * t303;
  t307 = t161 * rho[0];
  t310 = t186 / t187 / t307;
  t314 = 0.1e1 / t10 / t307;
  t315 = t9 * t314;
  t320 = 0.1e1/POW_3_2(t21);
  t321 = t29 * t320;
  t328 = t205 * t36;
  t329 = 0.1e1 / t307;
  t339 = -t301 * t304 / 0.3e1 + 0.2e1 / 0.9e1 * t184 * t310 - 0.7e1 / 0.27e2 * t106 * t315 - 0.7e1 / 0.27e2 * t26 * t315 + 0.83333333333333333332e-1 * t321 * t304 - 0.16666666666666666666e0 * t200 * t310 - 0.19444444444444444444e0 * t114 * t315 - t38 * t328 * t329 / 0.27e2 - t38 * t205 * t329 / 0.3e1 - 0.2e1 / 0.3e1 * t38 * t36 * t329;
  t340 = t339 * t122;
  t341 = t103 * t340;
  t344 = t220 * t17 * t121;
  t345 = t218 * t213 * t344;
  t347 = t176 * t121;
  t348 = t347 * t122;
  t349 = t218 * t348;
  t351 = t123 * t213;
  t352 = t175 * t351;
  t355 = 0.1e1 / t216 / t39;
  t356 = t15 * t355;
  t358 = t347 * t220 * t17;
  t359 = t356 * t358;
  t362 = 0.1e1 / t216 / t101;
  t363 = t15 * t362;
  t365 = 0.1e1 / t219 / t43;
  t367 = t1 * t1;
  t368 = 0.1e1 / t367;
  t369 = t347 * t365 * t368;
  t370 = t363 * t369;
  t372 = t65 * t300;
  t381 = t72 * t320;
  t388 = t260 * t77;
  t398 = -t372 * t304 / 0.3e1 + 0.2e1 / 0.9e1 * t247 * t310 - 0.7e1 / 0.27e2 * t137 * t315 - 0.7e1 / 0.27e2 * t69 * t315 + 0.83333333333333333332e-1 * t381 * t304 - 0.16666666666666666666e0 * t255 * t310 - 0.19444444444444444444e0 * t143 * t315 - t79 * t388 * t329 / 0.27e2 - t79 * t260 * t329 / 0.3e1 - 0.2e1 / 0.3e1 * t79 * t77 * t329;
  t401 = t133 * t135 * t398 * t152;
  t404 = t94 * t9 * t314 * t44;
  t406 = t163 * t102;
  t408 = t168 * t406 * t123;
  t411 = t168 * t169 * t214;
  t413 = t241 * t149;
  t416 = t133 * t272 * t413 * t152;
  t418 = t341 + 0.3e1 / 0.2e1 * t345 + 0.6e1 * t349 - 0.6e1 * t352 - 0.3e1 * t359 + t370 / 0.2e1 - t401 + 0.14e2 / 0.27e2 * t404 + t408 / 0.3e1 - t411 / 0.4e1 - 0.6e1 * t416;
  t420 = t56 * t63 * t240;
  t421 = t87 * t267;
  t423 = t420 * t234 * t421;
  t426 = 0.1e1 / t271 / t80;
  t428 = t56 * t63 * t426;
  t431 = t428 * t413 * t276 * t278;
  t434 = 0.1e1 / t271 / t134;
  t436 = t56 * t63 * t434;
  t438 = 0.1e1 / t275 / t84;
  t440 = t57 * t57;
  t441 = 0.1e1 / t440;
  t442 = t87 * t441;
  t444 = t436 * t413 * t438 * t442;
  t449 = t127 * t9 * t314 * t85 * t87;
  t451 = t8 * t163;
  t452 = t451 * t135;
  t454 = t231 * t452 * t235;
  t457 = t267 * t151 * t87;
  t459 = t231 * t233 * t457;
  t461 = t96 * t174;
  t463 = t168 * t461 * t177;
  t465 = t96 * t217;
  t467 = t168 * t465 * t222;
  t470 = t278 * t149;
  t472 = t274 * t267 * t276 * t470;
  t475 = t241 * t151;
  t476 = t475 * t87;
  t478 = t231 * t232 * t240 * t476;
  t482 = t56 * t59 * t19 * t8;
  t483 = t96 * t272;
  t485 = t276 * t87;
  t486 = t485 * t64;
  t488 = t482 * t483 * t241 * t486;
  t490 = 0.6e1 * t423 + 0.3e1 * t431 - t444 / 0.2e1 - 0.14e2 / 0.27e2 * t449 - t454 / 0.3e1 + t459 / 0.4e1 + t463 / 0.2e1 - t467 / 0.8e1 - 0.3e1 / 0.2e1 * t472 - t478 / 0.2e1 + t488 / 0.8e1;
  tv3rho30 = -0.2e1 / 0.3e1 * t166 - t171 / 0.2e1 - 0.6e1 * t178 + 0.3e1 * t215 + 0.3e1 / 0.2e1 * t223 + 0.2e1 / 0.3e1 * t228 + t237 / 0.2e1 + 0.6e1 * t244 - 0.3e1 * t270 - 0.3e1 / 0.2e1 * t280 + rho[0] * (t418 + t490);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t494 = t213 * t213;
  t501 = t176 * t176;
  t520 = t216 * t216;
  t523 = t219 * t219;
  t545 = -0.6e1 * t175 * t494 * t122 - 0.6e1 * t15 / t216 / t173 * t501 * t365 * t368 + 0.3e1 / 0.2e1 * t218 * t494 * t220 * t17 + 0.18e2 * t363 * t501 * t220 * t17 + 0.36e2 * t218 * t177 * t213 - 0.8e1 * t175 * t340 * t121 + 0.3e1 / 0.4e1 * t15 / t520 * t501 / t523 / t367 / t1 + 0.3e1 * t363 * t213 * t365 * t368 * t176 + 0.2e1 * t218 * t339 * t344 - 0.18e2 * t356 * t213 * t222 - 0.24e2 * t356 * t501 * t122;
  t549 = 0.1e1 / t22 / t5 / t117 / 0.48e2;
  t552 = t302 * rho[0];
  t556 = 0.1e1 / t10 / t552 * t3 * t9;
  t560 = t5 / t552;
  t565 = t186 / t187 / t302;
  t569 = 0.1e1 / t10 / t302;
  t570 = t9 * t569;
  t575 = pow(t21, -0.25e1);
  t586 = t205 * t205;
  t599 = -0.5e1 / 0.18e2 * t18 * t549 * t5 * t556 + 0.8e1 / 0.3e1 * t301 * t560 - 0.8e2 / 0.81e2 * t184 * t565 + 0.7e2 / 0.81e2 * t106 * t570 + 0.7e2 / 0.81e2 * t26 * t570 + 0.41666666666666666666e-1 * t29 * t575 * t5 * t556 - 0.66666666666666666665e0 * t321 * t560 + 0.74074074074074074072e0 * t200 * t565 + 0.64814814814814814813e0 * t114 * t570 + t38 * t586 * t303 / 0.81e2 + 0.2e1 / 0.9e1 * t38 * t328 * t303 + 0.11e2 / 0.9e1 * t38 * t205 * t303 + 0.2e1 * t38 * t36 * t303;
  t612 = t267 * t267;
  t621 = t241 * t241;
  t626 = t271 * t271;
  t630 = t275 * t275;
  t653 = t398 * t151;
  t658 = t103 * t599 * t122 - t168 * t169 * t340 / 0.3e1 - 0.2e1 * t168 * t465 * t348 - 0.4e1 / 0.3e1 * t168 * t163 * t174 * t177 - 0.3e1 / 0.2e1 * t274 * t612 * t276 * t278 + 0.6e1 * t56 * t63 / t271 / t239 * t621 * t438 * t442 - 0.3e1 / 0.4e1 * t56 * t63 / t626 * t621 / t630 * t87 / t440 / t57 - 0.18e2 * t436 * t621 * t276 * t278 - 0.36e2 * t274 * t475 * t421 - 0.28e2 / 0.27e2 * t168 * t314 * t102 * t123 + 0.2e1 / 0.3e1 * t168 * t406 * t214 + 0.8e1 * t420 * t653 * t87 * t149;
  t682 = t260 * t260;
  t695 = -0.5e1 / 0.18e2 * t65 * t549 * t5 * t556 + 0.8e1 / 0.3e1 * t372 * t560 - 0.8e2 / 0.81e2 * t247 * t565 + 0.7e2 / 0.81e2 * t137 * t570 + 0.7e2 / 0.81e2 * t69 * t570 + 0.41666666666666666666e-1 * t72 * t575 * t5 * t556 - 0.66666666666666666665e0 * t381 * t560 + 0.74074074074074074072e0 * t255 * t565 + 0.64814814814814814813e0 * t143 * t570 + t79 * t682 * t303 / 0.81e2 + 0.2e1 / 0.9e1 * t79 * t388 * t303 + 0.11e2 / 0.9e1 * t79 * t260 * t303 + 0.2e1 * t79 * t77 * t303;
  t745 = -t133 * t135 * t695 * t152 + 0.6e1 * t133 * t240 * t612 * t152 + 0.24e2 * t133 * t426 * t621 * t152 - 0.14e3 / 0.81e2 * t94 * t9 * t569 * t44 + t482 * t483 * t267 * t485 * t64 * t149 / 0.2e1 - t4 * t107 * t217 * t213 * t344 / 0.2e1 + 0.14e3 / 0.81e2 * t127 * t9 * t569 * t85 * t87 + t231 * t233 * t653 * t87 / 0.3e1 + 0.2e1 * t231 * t232 * t272 * t413 * t151 * t87 + 0.28e2 / 0.27e2 * t231 * t8 * t314 * t135 * t235 - 0.2e1 / 0.3e1 * t231 * t452 * t457;
  t798 = 0.4e1 / 0.3e1 * t231 * t451 * t240 * t476 + 0.2e1 * t168 * t461 * t351 + t168 * t96 * t355 * t358 - t168 * t96 * t362 * t369 / 0.6e1 - 0.2e1 * t274 * t398 * t276 * t470 + t168 * t163 * t217 * t222 / 0.3e1 + 0.18e2 * t428 * t277 * t421 * t64 - 0.3e1 * t436 * t241 * t438 * t442 * t267 - 0.2e1 * t482 * t96 * t240 * t149 * t457 - t482 * t96 * t426 * t413 * t486 + t482 * t96 * t434 * t413 * t438 * t87 * t441 / 0.6e1 - t482 * t163 * t272 * t241 * t486 / 0.3e1;
  t810 = 0.4e1 * t341 + rho[0] * (t545 + t658 + t745 + t798) + 0.6e1 * t345 + 0.24e2 * t349 - 0.24e2 * t352 - 0.12e2 * t359 + 0.2e1 * t370 - 0.4e1 * t401 + 0.56e2 / 0.27e2 * t404 + 0.4e1 / 0.3e1 * t408 - t411;
  t822 = -0.24e2 * t416 + 0.24e2 * t423 + 0.12e2 * t431 - 0.2e1 * t444 - 0.56e2 / 0.27e2 * t449 - 0.4e1 / 0.3e1 * t454 + t459 + 0.2e1 * t463 - t467 / 0.2e1 - 0.6e1 * t472 - 0.2e1 * t478 + t488 / 0.2e1;
  tv4rho40 = t810 + t822;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t16, t18, t19;
  double t20, t22, t23, t27, t30, t31, t35, t37;
  double t38, t39, t40, t44, t45, t46, t47, t48;
  double t49, t50, t51, t52, t53, t54, t55, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t68, t69, t70, t73, t74, t75, t76;
  double t77, t80, t82, t83, t87, t90, t95, t96;
  double t97, t98, t102, t103, t105, t106, t107, t110;
  double t112, t113, t117, t120, t125, t126, t127, t128;
  double t132, t133, t134, t135, t138, t139, t140, t143;
  double t145, tzk0;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = rho[0] + rho[1];
  t11 = POW_1_3(t10);
  t12 = 0.1e1 / t11;
  t13 = t9 * t12;
  t16 = 0.1e1 + t4 * t13 / 0.4e1;
  t18 = 0.1e1 / t1;
  t19 = params->beta1[0];
  t20 = t3 * t6;
  t22 = t20 * t8 * t12;
  t23 = sqrt(t22);
  t27 = params->beta2[0] * t3;
  t30 = params->beta3[0];
  t31 = POW_3_2(t22);
  t35 = t22 / 0.4e1;
  t37 = params->pp[0] + 0.1e1;
  t38 = pow(t35, t37);
  t39 = params->beta4[0] * t38;
  t40 = t19 * t23 / 0.2e1 + t27 * t13 / 0.4e1 + 0.125e0 * t30 * t31 + t39;
  t44 = 0.1e1 + t18 / t40 / 0.2e1;
  t45 = log(t44);
  t46 = t1 * t16 * t45;
  t47 = 0.2e1 * t46;
  t48 = rho[0] - rho[1];
  t49 = t48 * t48;
  t50 = t49 * t49;
  t51 = t10 * t10;
  t52 = t51 * t51;
  t53 = 0.1e1 / t52;
  t54 = t50 * t53;
  t55 = 0.1e1 / t10;
  t56 = t48 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t63 = my_piecewise3(t58, t60, t61 * t57);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t60, t66 * t64);
  t69 = t63 + t68 - 0.2e1;
  t70 = M_CBRT2;
  t73 = 0.1e1 / (0.2e1 * t70 - 0.2e1);
  t74 = t69 * t73;
  t75 = params->a[1];
  t76 = params->alpha1[1];
  t77 = t76 * t3;
  t80 = 0.1e1 + t77 * t13 / 0.4e1;
  t82 = 0.1e1 / t75;
  t83 = params->beta1[1];
  t87 = params->beta2[1] * t3;
  t90 = params->beta3[1];
  t95 = params->pp[1] + 0.1e1;
  t96 = pow(t35, t95);
  t97 = params->beta4[1] * t96;
  t98 = t83 * t23 / 0.2e1 + t87 * t13 / 0.4e1 + 0.125e0 * t90 * t31 + t97;
  t102 = 0.1e1 + t82 / t98 / 0.2e1;
  t103 = log(t102);
  t105 = params->a[2];
  t106 = params->alpha1[2];
  t107 = t106 * t3;
  t110 = 0.1e1 + t107 * t13 / 0.4e1;
  t112 = 0.1e1 / t105;
  t113 = params->beta1[2];
  t117 = params->beta2[2] * t3;
  t120 = params->beta3[2];
  t125 = params->pp[2] + 0.1e1;
  t126 = pow(t35, t125);
  t127 = params->beta4[2] * t126;
  t128 = t113 * t23 / 0.2e1 + t117 * t13 / 0.4e1 + 0.125e0 * t120 * t31 + t127;
  t132 = 0.1e1 + t112 / t128 / 0.2e1;
  t133 = log(t132);
  t134 = 0.1e1 / params->fz20;
  t135 = t133 * t134;
  t138 = -0.2e1 * t75 * t80 * t103 - 0.2e1 * t105 * t110 * t135 + 0.2e1 * t46;
  t139 = t74 * t138;
  t140 = t54 * t139;
  t143 = t110 * t133 * t134;
  t145 = 0.2e1 * t74 * t105 * t143;
  tzk0 = -t47 + t140 + t145;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t16, t18, t19;
  double t20, t22, t23, t27, t30, t31, t35, t37;
  double t38, t39, t40, t44, t45, t46, t47, t48;
  double t49, t50, t51, t52, t53, t54, t55, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t68, t69, t70, t73, t74, t75, t76;
  double t77, t80, t82, t83, t87, t90, t95, t96;
  double t97, t98, t102, t103, t105, t106, t107, t110;
  double t112, t113, t117, t120, t125, t126, t127, t128;
  double t132, t133, t134, t135, t138, t139, t140, t143;
  double t145, tzk0;

  double t147, t149, t152, t153, t154, t155, t156, t157;
  double t159, t160, t165, t167, t173, t174, t175, t176;
  double t177, t178, t179, t180, t181, t182, t183, t184;
  double t185, t186, t187, t188, t191, t192, t195, t197;
  double t198, t199, t201, t206, t207, t208, t210, t216;
  double t222, t223, t224, t226, t227, t228, t232, t233;
  double t234, t236, t242, t248, t249, t251, t253, t254;
  double t255, t257, t258, t259, t260, t263, t264, t265;
  double t266, t268, t269, t270, tvrho0, t273, t276, t277;
  double t280, t282, t283, t284, t286, t287, tvrho1;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = rho[0] + rho[1];
  t11 = POW_1_3(t10);
  t12 = 0.1e1 / t11;
  t13 = t9 * t12;
  t16 = 0.1e1 + t4 * t13 / 0.4e1;
  t18 = 0.1e1 / t1;
  t19 = params->beta1[0];
  t20 = t3 * t6;
  t22 = t20 * t8 * t12;
  t23 = sqrt(t22);
  t27 = params->beta2[0] * t3;
  t30 = params->beta3[0];
  t31 = POW_3_2(t22);
  t35 = t22 / 0.4e1;
  t37 = params->pp[0] + 0.1e1;
  t38 = pow(t35, t37);
  t39 = params->beta4[0] * t38;
  t40 = t19 * t23 / 0.2e1 + t27 * t13 / 0.4e1 + 0.125e0 * t30 * t31 + t39;
  t44 = 0.1e1 + t18 / t40 / 0.2e1;
  t45 = log(t44);
  t46 = t1 * t16 * t45;
  t47 = 0.2e1 * t46;
  t48 = rho[0] - rho[1];
  t49 = t48 * t48;
  t50 = t49 * t49;
  t51 = t10 * t10;
  t52 = t51 * t51;
  t53 = 0.1e1 / t52;
  t54 = t50 * t53;
  t55 = 0.1e1 / t10;
  t56 = t48 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t63 = my_piecewise3(t58, t60, t61 * t57);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t60, t66 * t64);
  t69 = t63 + t68 - 0.2e1;
  t70 = M_CBRT2;
  t73 = 0.1e1 / (0.2e1 * t70 - 0.2e1);
  t74 = t69 * t73;
  t75 = params->a[1];
  t76 = params->alpha1[1];
  t77 = t76 * t3;
  t80 = 0.1e1 + t77 * t13 / 0.4e1;
  t82 = 0.1e1 / t75;
  t83 = params->beta1[1];
  t87 = params->beta2[1] * t3;
  t90 = params->beta3[1];
  t95 = params->pp[1] + 0.1e1;
  t96 = pow(t35, t95);
  t97 = params->beta4[1] * t96;
  t98 = t83 * t23 / 0.2e1 + t87 * t13 / 0.4e1 + 0.125e0 * t90 * t31 + t97;
  t102 = 0.1e1 + t82 / t98 / 0.2e1;
  t103 = log(t102);
  t105 = params->a[2];
  t106 = params->alpha1[2];
  t107 = t106 * t3;
  t110 = 0.1e1 + t107 * t13 / 0.4e1;
  t112 = 0.1e1 / t105;
  t113 = params->beta1[2];
  t117 = params->beta2[2] * t3;
  t120 = params->beta3[2];
  t125 = params->pp[2] + 0.1e1;
  t126 = pow(t35, t125);
  t127 = params->beta4[2] * t126;
  t128 = t113 * t23 / 0.2e1 + t117 * t13 / 0.4e1 + 0.125e0 * t120 * t31 + t127;
  t132 = 0.1e1 + t112 / t128 / 0.2e1;
  t133 = log(t132);
  t134 = 0.1e1 / params->fz20;
  t135 = t133 * t134;
  t138 = -0.2e1 * t75 * t80 * t103 - 0.2e1 * t105 * t110 * t135 + 0.2e1 * t46;
  t139 = t74 * t138;
  t140 = t54 * t139;
  t143 = t110 * t133 * t134;
  t145 = 0.2e1 * t74 * t105 * t143;
  tzk0 = -t47 + t140 + t145;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t147 = t1 * t2 * t3;
  t149 = 0.1e1 / t11 / t10;
  t152 = t147 * t9 * t149 * t45;
  t153 = t152 / 0.6e1;
  t154 = t40 * t40;
  t155 = 0.1e1 / t154;
  t156 = t16 * t155;
  t157 = 0.1e1 / t23;
  t159 = t19 * t157 * t3;
  t160 = t9 * t149;
  t165 = sqrt(t22);
  t167 = t30 * t165 * t3;
  t173 = -t159 * t160 / 0.12e2 - t27 * t160 / 0.12e2 - 0.625e-1 * t167 * t160 - t39 * t37 * t55 / 0.3e1;
  t174 = 0.1e1 / t44;
  t175 = t173 * t174;
  t176 = t156 * t175;
  t177 = t49 * t48;
  t178 = t177 * t53;
  t179 = t178 * t139;
  t180 = 0.4e1 * t179;
  t181 = t52 * t10;
  t182 = 0.1e1 / t181;
  t183 = t50 * t182;
  t184 = t183 * t139;
  t185 = 0.4e1 * t184;
  t186 = 0.1e1 / t51;
  t187 = t48 * t186;
  t188 = t55 - t187;
  t191 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t188);
  t192 = -t188;
  t195 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t192);
  t197 = (t191 + t195) * t73;
  t198 = t197 * t138;
  t199 = t54 * t198;
  t201 = t75 * t76 * t3;
  t206 = t98 * t98;
  t207 = 0.1e1 / t206;
  t208 = t80 * t207;
  t210 = t83 * t157 * t3;
  t216 = t90 * t165 * t3;
  t222 = -t210 * t160 / 0.12e2 - t87 * t160 / 0.12e2 - 0.625e-1 * t216 * t160 - t97 * t95 * t55 / 0.3e1;
  t223 = 0.1e1 / t102;
  t224 = t222 * t223;
  t226 = t105 * t106;
  t227 = t226 * t20;
  t228 = t8 * t149;
  t232 = t128 * t128;
  t233 = 0.1e1 / t232;
  t234 = t110 * t233;
  t236 = t113 * t157 * t3;
  t242 = t120 * t165 * t3;
  t248 = -t236 * t160 / 0.12e2 - t117 * t160 / 0.12e2 - 0.625e-1 * t242 * t160 - t127 * t125 * t55 / 0.3e1;
  t249 = 0.1e1 / t132;
  t251 = t248 * t249 * t134;
  t253 = t201 * t9 * t149 * t103 / 0.6e1 + t208 * t224 - t153 - t176 + t227 * t228 * t135 / 0.6e1 + t234 * t251;
  t254 = t74 * t253;
  t255 = t54 * t254;
  t257 = t197 * t105 * t143;
  t258 = 0.2e1 * t257;
  t259 = t226 * t3;
  t260 = t74 * t259;
  t263 = t9 * t149 * t133 * t134;
  t264 = t260 * t263;
  t265 = t264 / 0.6e1;
  t266 = t74 * t110;
  t268 = t249 * t134;
  t269 = t233 * t248 * t268;
  t270 = t266 * t269;
  tvrho0 = -t47 + t140 + t145 + t10 * (t153 + t176 + t180 - t185 + t199 + t255 + t258 - t265 - t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t273 = -t55 - t187;
  t276 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t273);
  t277 = -t273;
  t280 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t277);
  t282 = (t276 + t280) * t73;
  t283 = t282 * t138;
  t284 = t54 * t283;
  t286 = t282 * t105 * t143;
  t287 = 0.2e1 * t286;
  tvrho1 = -t47 + t140 + t145 + t10 * (t153 + t176 - t180 - t185 + t284 + t255 + t287 - t265 - t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t16, t18, t19;
  double t20, t22, t23, t27, t30, t31, t35, t37;
  double t38, t39, t40, t44, t45, t46, t47, t48;
  double t49, t50, t51, t52, t53, t54, t55, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t68, t69, t70, t73, t74, t75, t76;
  double t77, t80, t82, t83, t87, t90, t95, t96;
  double t97, t98, t102, t103, t105, t106, t107, t110;
  double t112, t113, t117, t120, t125, t126, t127, t128;
  double t132, t133, t134, t135, t138, t139, t140, t143;
  double t145, tzk0;

  double t147, t149, t152, t153, t154, t155, t156, t157;
  double t159, t160, t165, t167, t173, t174, t175, t176;
  double t177, t178, t179, t180, t181, t182, t183, t184;
  double t185, t186, t187, t188, t191, t192, t195, t197;
  double t198, t199, t201, t206, t207, t208, t210, t216;
  double t222, t223, t224, t226, t227, t228, t232, t233;
  double t234, t236, t242, t248, t249, t251, t253, t254;
  double t255, t257, t258, t259, t260, t263, t264, t265;
  double t266, t268, t269, t270, tvrho0, t273, t276, t277;
  double t280, t282, t283, t284, t286, t287, tvrho1;

  double t290, t291, t292, t293, t295, t297, t298, t300;
  double t302, t303, t304, t305, t306, t309, t313, t314;
  double t319, t321, t326, t333, t334, t335, t336, t337;
  double t338, t339, t340, t341, t343, t344, t345, t346;
  double t347, t348, t349, t351, t359, t364, t371, t373;
  double t374, t375, t376, t377, t378, t379, t380, t381;
  double t382, t383, t384, t385, t386, t388, t389, t390;
  double t391, t392, t393, t394, t395, t396, t397, t398;
  double t399, t400, t401, t402, t405, t406, t407, t409;
  double t413, t414, t415, t416, t419, t423, t425, t426;
  double t427, t428, t429, t430, t435, t436, t440, t441;
  double t442, t443, t444, t448, t456, t461, t468, t469;
  double t471, t472, t473, t474, t475, t477, t482, t483;
  double t484, t485, t487, t488, t489, t493, t494, t498;
  double t499, t500, t501, t502, t503, t506, t507, t509;
  double t510, t511, t512, t513, t514, t515, t516, t519;
  double t520, t521, t523, t524, t525, t526, t527, t528;
  double t529, t530, t531, t532, t533, t534, t536, t537;
  double t540, t541, t542, t543, t544, t545, t546, t547;
  double t548, t549, tv2rho20, t552, t553, t555, t556, t558;
  double t559, t561, t563, t566, t570, t571, t574, t578;
  double t580, t581, t582, t586, t588, t589, t590, tv2rho21;
  double t595, t599, t603, t604, t607, t611, t613, t614;
  double t615, t617, t618, t619, t620, t621, t622, t623;
  double t624, t625, tv2rho22;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = rho[0] + rho[1];
  t11 = POW_1_3(t10);
  t12 = 0.1e1 / t11;
  t13 = t9 * t12;
  t16 = 0.1e1 + t4 * t13 / 0.4e1;
  t18 = 0.1e1 / t1;
  t19 = params->beta1[0];
  t20 = t3 * t6;
  t22 = t20 * t8 * t12;
  t23 = sqrt(t22);
  t27 = params->beta2[0] * t3;
  t30 = params->beta3[0];
  t31 = POW_3_2(t22);
  t35 = t22 / 0.4e1;
  t37 = params->pp[0] + 0.1e1;
  t38 = pow(t35, t37);
  t39 = params->beta4[0] * t38;
  t40 = t19 * t23 / 0.2e1 + t27 * t13 / 0.4e1 + 0.125e0 * t30 * t31 + t39;
  t44 = 0.1e1 + t18 / t40 / 0.2e1;
  t45 = log(t44);
  t46 = t1 * t16 * t45;
  t47 = 0.2e1 * t46;
  t48 = rho[0] - rho[1];
  t49 = t48 * t48;
  t50 = t49 * t49;
  t51 = t10 * t10;
  t52 = t51 * t51;
  t53 = 0.1e1 / t52;
  t54 = t50 * t53;
  t55 = 0.1e1 / t10;
  t56 = t48 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t63 = my_piecewise3(t58, t60, t61 * t57);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t60, t66 * t64);
  t69 = t63 + t68 - 0.2e1;
  t70 = M_CBRT2;
  t73 = 0.1e1 / (0.2e1 * t70 - 0.2e1);
  t74 = t69 * t73;
  t75 = params->a[1];
  t76 = params->alpha1[1];
  t77 = t76 * t3;
  t80 = 0.1e1 + t77 * t13 / 0.4e1;
  t82 = 0.1e1 / t75;
  t83 = params->beta1[1];
  t87 = params->beta2[1] * t3;
  t90 = params->beta3[1];
  t95 = params->pp[1] + 0.1e1;
  t96 = pow(t35, t95);
  t97 = params->beta4[1] * t96;
  t98 = t83 * t23 / 0.2e1 + t87 * t13 / 0.4e1 + 0.125e0 * t90 * t31 + t97;
  t102 = 0.1e1 + t82 / t98 / 0.2e1;
  t103 = log(t102);
  t105 = params->a[2];
  t106 = params->alpha1[2];
  t107 = t106 * t3;
  t110 = 0.1e1 + t107 * t13 / 0.4e1;
  t112 = 0.1e1 / t105;
  t113 = params->beta1[2];
  t117 = params->beta2[2] * t3;
  t120 = params->beta3[2];
  t125 = params->pp[2] + 0.1e1;
  t126 = pow(t35, t125);
  t127 = params->beta4[2] * t126;
  t128 = t113 * t23 / 0.2e1 + t117 * t13 / 0.4e1 + 0.125e0 * t120 * t31 + t127;
  t132 = 0.1e1 + t112 / t128 / 0.2e1;
  t133 = log(t132);
  t134 = 0.1e1 / params->fz20;
  t135 = t133 * t134;
  t138 = -0.2e1 * t75 * t80 * t103 - 0.2e1 * t105 * t110 * t135 + 0.2e1 * t46;
  t139 = t74 * t138;
  t140 = t54 * t139;
  t143 = t110 * t133 * t134;
  t145 = 0.2e1 * t74 * t105 * t143;
  tzk0 = -t47 + t140 + t145;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t147 = t1 * t2 * t3;
  t149 = 0.1e1 / t11 / t10;
  t152 = t147 * t9 * t149 * t45;
  t153 = t152 / 0.6e1;
  t154 = t40 * t40;
  t155 = 0.1e1 / t154;
  t156 = t16 * t155;
  t157 = 0.1e1 / t23;
  t159 = t19 * t157 * t3;
  t160 = t9 * t149;
  t165 = sqrt(t22);
  t167 = t30 * t165 * t3;
  t173 = -t159 * t160 / 0.12e2 - t27 * t160 / 0.12e2 - 0.625e-1 * t167 * t160 - t39 * t37 * t55 / 0.3e1;
  t174 = 0.1e1 / t44;
  t175 = t173 * t174;
  t176 = t156 * t175;
  t177 = t49 * t48;
  t178 = t177 * t53;
  t179 = t178 * t139;
  t180 = 0.4e1 * t179;
  t181 = t52 * t10;
  t182 = 0.1e1 / t181;
  t183 = t50 * t182;
  t184 = t183 * t139;
  t185 = 0.4e1 * t184;
  t186 = 0.1e1 / t51;
  t187 = t48 * t186;
  t188 = t55 - t187;
  t191 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t188);
  t192 = -t188;
  t195 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t192);
  t197 = (t191 + t195) * t73;
  t198 = t197 * t138;
  t199 = t54 * t198;
  t201 = t75 * t76 * t3;
  t206 = t98 * t98;
  t207 = 0.1e1 / t206;
  t208 = t80 * t207;
  t210 = t83 * t157 * t3;
  t216 = t90 * t165 * t3;
  t222 = -t210 * t160 / 0.12e2 - t87 * t160 / 0.12e2 - 0.625e-1 * t216 * t160 - t97 * t95 * t55 / 0.3e1;
  t223 = 0.1e1 / t102;
  t224 = t222 * t223;
  t226 = t105 * t106;
  t227 = t226 * t20;
  t228 = t8 * t149;
  t232 = t128 * t128;
  t233 = 0.1e1 / t232;
  t234 = t110 * t233;
  t236 = t113 * t157 * t3;
  t242 = t120 * t165 * t3;
  t248 = -t236 * t160 / 0.12e2 - t117 * t160 / 0.12e2 - 0.625e-1 * t242 * t160 - t127 * t125 * t55 / 0.3e1;
  t249 = 0.1e1 / t132;
  t251 = t248 * t249 * t134;
  t253 = t201 * t9 * t149 * t103 / 0.6e1 + t208 * t224 - t153 - t176 + t227 * t228 * t135 / 0.6e1 + t234 * t251;
  t254 = t74 * t253;
  t255 = t54 * t254;
  t257 = t197 * t105 * t143;
  t258 = 0.2e1 * t257;
  t259 = t226 * t3;
  t260 = t74 * t259;
  t263 = t9 * t149 * t133 * t134;
  t264 = t260 * t263;
  t265 = t264 / 0.6e1;
  t266 = t74 * t110;
  t268 = t249 * t134;
  t269 = t233 * t248 * t268;
  t270 = t266 * t269;
  tvrho0 = -t47 + t140 + t145 + t10 * (t153 + t176 + t180 - t185 + t199 + t255 + t258 - t265 - t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t273 = -t55 - t187;
  t276 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t273);
  t277 = -t273;
  t280 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t277);
  t282 = (t276 + t280) * t73;
  t283 = t282 * t138;
  t284 = t54 * t283;
  t286 = t282 * t105 * t143;
  t287 = 0.2e1 * t286;
  tvrho1 = -t47 + t140 + t145 + t10 * (t153 + t176 - t180 - t185 + t284 + t255 + t287 - t265 - t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t290 = t152 / 0.3e1;
  t291 = 0.2e1 * t176;
  t292 = 0.8e1 * t179;
  t293 = 0.8e1 * t184;
  t295 = 0.2e1 * t255;
  t297 = t264 / 0.3e1;
  t298 = 0.2e1 * t270;
  t300 = 0.1e1 / t23 / t22;
  t302 = t3 * t3;
  t303 = t19 * t300 * t302;
  t304 = t6 * t6;
  t305 = t304 * t7;
  t306 = t11 * t11;
  t309 = t305 / t306 / t51;
  t313 = 0.1e1 / t11 / t51;
  t314 = t9 * t313;
  t319 = 0.1e1/sqrt(t22);
  t321 = t30 * t319 * t302;
  t326 = t37 * t37;
  t333 = -t303 * t309 / 0.18e2 + t159 * t314 / 0.9e1 + t27 * t314 / 0.9e1 + 0.41666666666666666666e-1 * t321 * t309 + 0.83333333333333333333e-1 * t167 * t314 + t39 * t326 * t186 / 0.9e1 + t39 * t37 * t186 / 0.3e1;
  t334 = t333 * t174;
  t335 = t156 * t334;
  t336 = t49 * t53;
  t337 = t336 * t139;
  t338 = 0.12e2 * t337;
  t339 = t177 * t182;
  t340 = t339 * t139;
  t341 = 0.32e2 * t340;
  t343 = 0.1e1 / t52 / t51;
  t344 = t50 * t343;
  t345 = t344 * t139;
  t346 = 0.2e2 * t345;
  t347 = t197 * t110;
  t348 = t347 * t269;
  t349 = 0.2e1 * t348;
  t351 = t113 * t300 * t302;
  t359 = t120 * t319 * t302;
  t364 = t125 * t125;
  t371 = -t351 * t309 / 0.18e2 + t236 * t314 / 0.9e1 + t117 * t314 / 0.9e1 + 0.41666666666666666666e-1 * t359 * t309 + 0.83333333333333333333e-1 * t242 * t314 + t127 * t364 * t186 / 0.9e1 + t127 * t125 * t186 / 0.3e1;
  t373 = t233 * t371 * t268;
  t374 = t266 * t373;
  t375 = t154 * t40;
  t376 = 0.1e1 / t375;
  t377 = t16 * t376;
  t378 = t173 * t173;
  t379 = t378 * t174;
  t380 = t377 * t379;
  t381 = 0.2e1 * t380;
  t382 = t154 * t154;
  t383 = 0.1e1 / t382;
  t384 = t16 * t383;
  t385 = t44 * t44;
  t386 = 0.1e1 / t385;
  t388 = t378 * t386 * t18;
  t389 = t384 * t388;
  t390 = t389 / 0.2e1;
  t391 = t178 * t198;
  t392 = 0.8e1 * t391;
  t393 = t178 * t254;
  t394 = 0.8e1 * t393;
  t395 = t183 * t198;
  t396 = 0.8e1 * t395;
  t397 = t335 + t338 - t341 + t346 - t349 - t374 - t381 + t390 + t392 + t394 - t396;
  t398 = t183 * t254;
  t399 = 0.8e1 * t398;
  t400 = t61 * t61;
  t401 = 0.1e1 / t400;
  t402 = t188 * t188;
  t405 = t51 * t10;
  t406 = 0.1e1 / t405;
  t407 = t48 * t406;
  t409 = -0.2e1 * t186 + 0.2e1 * t407;
  t413 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t401 * t402 + 0.4e1 / 0.3e1 * t61 * t409);
  t414 = t66 * t66;
  t415 = 0.1e1 / t414;
  t416 = t192 * t192;
  t419 = -t409;
  t423 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t415 * t416 + 0.4e1 / 0.3e1 * t66 * t419);
  t425 = (t413 + t423) * t73;
  t426 = t425 * t138;
  t427 = t54 * t426;
  t428 = t197 * t253;
  t429 = t54 * t428;
  t430 = 0.2e1 * t429;
  t435 = t77 * t9;
  t436 = t149 * t207;
  t440 = t206 * t98;
  t441 = 0.1e1 / t440;
  t442 = t80 * t441;
  t443 = t222 * t222;
  t444 = t443 * t223;
  t448 = t83 * t300 * t302;
  t456 = t90 * t319 * t302;
  t461 = t95 * t95;
  t468 = -t448 * t309 / 0.18e2 + t210 * t314 / 0.9e1 + t87 * t314 / 0.9e1 + 0.41666666666666666666e-1 * t456 * t309 + 0.83333333333333333333e-1 * t216 * t314 + t97 * t461 * t186 / 0.9e1 + t97 * t95 * t186 / 0.3e1;
  t469 = t468 * t223;
  t471 = t206 * t206;
  t472 = 0.1e1 / t471;
  t473 = t80 * t472;
  t474 = t102 * t102;
  t475 = 0.1e1 / t474;
  t477 = t443 * t475 * t82;
  t482 = t147 * t9 * t313 * t45;
  t483 = 0.2e1 / 0.9e1 * t482;
  t484 = t4 * t9;
  t485 = t149 * t155;
  t487 = t484 * t485 * t175;
  t488 = t487 / 0.6e1;
  t489 = t8 * t313;
  t493 = t107 * t9;
  t494 = t149 * t233;
  t498 = t232 * t128;
  t499 = 0.1e1 / t498;
  t500 = t110 * t499;
  t501 = t248 * t248;
  t502 = t501 * t249;
  t503 = t502 * t134;
  t506 = t371 * t249;
  t507 = t506 * t134;
  t509 = t232 * t232;
  t510 = 0.1e1 / t509;
  t511 = t110 * t510;
  t512 = t511 * t501;
  t513 = t132 * t132;
  t514 = 0.1e1 / t513;
  t515 = t514 * t134;
  t516 = t515 * t112;
  t519 = -0.2e1 / 0.9e1 * t201 * t9 * t313 * t103 - t435 * t436 * t224 / 0.6e1 - 0.2e1 * t442 * t444 + t208 * t469 + t473 * t477 / 0.2e1 + t483 + t488 + t381 - t335 - t390 - 0.2e1 / 0.9e1 * t227 * t489 * t135 - t493 * t494 * t251 / 0.6e1 - 0.2e1 * t500 * t503 + t234 * t507 + t512 * t516 / 0.2e1;
  t520 = t74 * t519;
  t521 = t54 * t520;
  t523 = t499 * t501 * t268;
  t524 = t266 * t523;
  t525 = 0.2e1 * t524;
  t526 = t74 * t511;
  t527 = t501 * t514;
  t528 = t134 * t112;
  t529 = t527 * t528;
  t530 = t526 * t529;
  t531 = t530 / 0.2e1;
  t532 = t197 * t259;
  t533 = t532 * t263;
  t534 = t533 / 0.3e1;
  t536 = t425 * t105 * t143;
  t537 = 0.2e1 * t536;
  t540 = t9 * t313 * t133 * t134;
  t541 = t260 * t540;
  t542 = 0.2e1 / 0.9e1 * t541;
  t543 = t107 * t6;
  t544 = t74 * t543;
  t545 = t228 * t233;
  t546 = t545 * t251;
  t547 = t544 * t546;
  t548 = t547 / 0.6e1;
  t549 = -t399 + t427 + t430 + t521 - t483 - t488 + t525 - t531 - t534 + t537 + t542 + t548;
  tv2rho20 = t290 + t291 + t292 - t293 + 0.2e1 * t199 + t295 + 0.4e1 * t257 - t297 - t298 + t10 * (t397 + t549);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t552 = t282 * t110;
  t553 = t552 * t269;
  t555 = t282 * t259;
  t556 = t555 * t263;
  t558 = t548 - t553 - t483 + t525 - t348 - t374 - t488 - t531 + t335 - t533 / 0.6e1 + t542 - t556 / 0.6e1 - t338;
  t559 = t178 * t283;
  t561 = t183 * t283;
  t563 = t401 * t273;
  t566 = t61 * t48;
  t570 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t563 * t188 + 0.8e1 / 0.3e1 * t566 * t406);
  t571 = t415 * t277;
  t574 = t66 * t48;
  t578 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t571 * t192 - 0.8e1 / 0.3e1 * t574 * t406);
  t580 = (t570 + t578) * t73;
  t581 = t580 * t138;
  t582 = t54 * t581;
  t586 = t580 * t105 * t143;
  t588 = t282 * t253;
  t589 = t54 * t588;
  t590 = t346 + 0.4e1 * t559 - 0.4e1 * t561 + t582 - t381 + t390 - 0.4e1 * t391 - 0.4e1 * t395 - t399 + t429 + t521 + 0.2e1 * t586 + t589;
  tv2rho21 = t290 + t291 - t293 + t199 + t295 + t258 - t297 - t298 + t284 + t287 + t10 * (t558 + t590);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t595 = t273 * t273;
  t599 = 0.2e1 * t186 + 0.2e1 * t407;
  t603 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t401 * t595 + 0.4e1 / 0.3e1 * t61 * t599);
  t604 = t277 * t277;
  t607 = -t599;
  t611 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t415 * t604 + 0.4e1 / 0.3e1 * t66 * t607);
  t613 = (t603 + t611) * t73;
  t614 = t613 * t138;
  t615 = t54 * t614;
  t617 = t613 * t105 * t143;
  t618 = 0.2e1 * t617;
  t619 = t615 + t618 + t335 + t338 + t341 + t346 - t374 - t381 + t390 - t394 - t399;
  t620 = t556 / 0.3e1;
  t621 = 0.8e1 * t559;
  t622 = 0.8e1 * t561;
  t623 = 0.2e1 * t589;
  t624 = 0.2e1 * t553;
  t625 = t521 - t483 - t488 + t525 - t531 - t620 - t621 - t622 + t623 + t542 + t548 - t624;
  tv2rho22 = t290 + t291 - t292 - t293 + 0.2e1 * t284 + t295 + 0.4e1 * t286 - t297 - t298 + t10 * (t619 + t625);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t16, t18, t19;
  double t20, t22, t23, t27, t30, t31, t35, t37;
  double t38, t39, t40, t44, t45, t46, t47, t48;
  double t49, t50, t51, t52, t53, t54, t55, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t68, t69, t70, t73, t74, t75, t76;
  double t77, t80, t82, t83, t87, t90, t95, t96;
  double t97, t98, t102, t103, t105, t106, t107, t110;
  double t112, t113, t117, t120, t125, t126, t127, t128;
  double t132, t133, t134, t135, t138, t139, t140, t143;
  double t145, tzk0;

  double t147, t149, t152, t153, t154, t155, t156, t157;
  double t159, t160, t165, t167, t173, t174, t175, t176;
  double t177, t178, t179, t180, t181, t182, t183, t184;
  double t185, t186, t187, t188, t191, t192, t195, t197;
  double t198, t199, t201, t206, t207, t208, t210, t216;
  double t222, t223, t224, t226, t227, t228, t232, t233;
  double t234, t236, t242, t248, t249, t251, t253, t254;
  double t255, t257, t258, t259, t260, t263, t264, t265;
  double t266, t268, t269, t270, tvrho0, t273, t276, t277;
  double t280, t282, t283, t284, t286, t287, tvrho1;

  double t290, t291, t292, t293, t295, t297, t298, t300;
  double t302, t303, t304, t305, t306, t309, t313, t314;
  double t319, t321, t326, t333, t334, t335, t336, t337;
  double t338, t339, t340, t341, t343, t344, t345, t346;
  double t347, t348, t349, t351, t359, t364, t371, t373;
  double t374, t375, t376, t377, t378, t379, t380, t381;
  double t382, t383, t384, t385, t386, t388, t389, t390;
  double t391, t392, t393, t394, t395, t396, t397, t398;
  double t399, t400, t401, t402, t405, t406, t407, t409;
  double t413, t414, t415, t416, t419, t423, t425, t426;
  double t427, t428, t429, t430, t435, t436, t440, t441;
  double t442, t443, t444, t448, t456, t461, t468, t469;
  double t471, t472, t473, t474, t475, t477, t482, t483;
  double t484, t485, t487, t488, t489, t493, t494, t498;
  double t499, t500, t501, t502, t503, t506, t507, t509;
  double t510, t511, t512, t513, t514, t515, t516, t519;
  double t520, t521, t523, t524, t525, t526, t527, t528;
  double t529, t530, t531, t532, t533, t534, t536, t537;
  double t540, t541, t542, t543, t544, t545, t546, t547;
  double t548, t549, tv2rho20, t552, t553, t555, t556, t558;
  double t559, t561, t563, t566, t570, t571, t574, t578;
  double t580, t581, t582, t586, t588, t589, t590, tv2rho21;
  double t595, t599, t603, t604, t607, t611, t613, t614;
  double t615, t617, t618, t619, t620, t621, t622, t623;
  double t624, t625, tv2rho22;

  double t629, t630, t631, t633, t634, t635, t636, t637;
  double t638, t639, t640, t641, t643, t644, t645, t646;
  double t647, t648, t649, t651, t654, t655, t656, t657;
  double t659, t660, t663, t664, t665, t672, t673, t674;
  double t679, t682, t687, t688, t695, t705, t706, t707;
  double t708, t709, t710, t711, t712, t713, t714, t715;
  double t716, t717, t718, t719, t720, t722, t723, t724;
  double t725, t726, t727, t728, t730, t731, t732, t733;
  double t734, t735, t736, t737, t738, t739, t740, t741;
  double t742, t743, t744, t746, t747, t748, t749, t750;
  double t752, t753, t754, t755, t756, t758, t759, t761;
  double t762, t763, t765, t766, t769, t773, t777, t779;
  double t780, t783, t786, t790, t792, t793, t794, t795;
  double t796, t797, t799, t800, t802, t804, t805, t806;
  double t807, t808, t810, t811, t813, t814, t815, t817;
  double t818, t820, t821, t822, t823, t825, t826, t827;
  double t829, t830, t831, t833, t835, t836, t837, t838;
  double t839, t840, t841, t842, t844, t845, t846, t848;
  double t849, t851, t852, t853, t854, t855, t856, t857;
  double t858, t859, t860, t862, t863, t864, t865, t866;
  double t867, t876, t883, t893, t895, t896, t897, t898;
  double t899, t900, t908, t911, t920, t927, t937, t938;
  double t940, t941, t944, t946, t950, t951, t955, t956;
  double t965, t967, t968, t970, t973, t976, t983, t987;
  double t991, t992, t995, t999, t1000, t1002, t1004, t1005;
  double t1006, t1009, t1013, t1015, t1016, t1017, t1021, t1028;
  double t1029, t1030, t1031, t1033, t1034, t1035, t1036, t1037;
  double t1041, t1042, t1043, t1044, t1046, t1047, t1048, t1050;
  double t1052, t1053, t1056, t1057, t1058, t1059, t1060, t1062;
  double t1063, t1064, tv3rho30, t1065, t1066, t1069, t1071, t1072;
  double t1073, t1076, t1079, t1090, t1091, t1094, t1105, t1107;
  double t1109, t1111, t1113, t1114, t1115, t1117, t1118, t1119;
  double t1120, t1122, t1124, t1126, t1127, t1128, t1129, t1130;
  double t1131, t1132, t1133, t1134, t1135, t1136, t1138, t1139;
  double t1142, t1146, t1148, t1149, t1150, t1151, t1152, t1153;
  double t1154, t1158, t1164, t1165, t1168, t1169, tv3rho31, t1171;
  double t1176, t1181, t1185, t1186, t1191, t1194, t1198, t1200;
  double t1202, t1207, t1208, t1212, t1214, t1215, t1216, t1219;
  double t1227, t1230, t1231, t1232, t1233, t1234, t1236, t1238;
  double t1243, t1246, tv3rho32, t1247, t1248, t1250, t1251, t1252;
  double t1253, t1254, t1255, t1256, t1262, t1266, t1267, t1272;
  double t1276, t1278, t1279, t1280, t1282, t1284, t1285, t1286;
  double t1288, t1289, t1290, t1291, t1295, t1301, t1306, tv3rho33;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = rho[0] + rho[1];
  t11 = POW_1_3(t10);
  t12 = 0.1e1 / t11;
  t13 = t9 * t12;
  t16 = 0.1e1 + t4 * t13 / 0.4e1;
  t18 = 0.1e1 / t1;
  t19 = params->beta1[0];
  t20 = t3 * t6;
  t22 = t20 * t8 * t12;
  t23 = sqrt(t22);
  t27 = params->beta2[0] * t3;
  t30 = params->beta3[0];
  t31 = POW_3_2(t22);
  t35 = t22 / 0.4e1;
  t37 = params->pp[0] + 0.1e1;
  t38 = pow(t35, t37);
  t39 = params->beta4[0] * t38;
  t40 = t19 * t23 / 0.2e1 + t27 * t13 / 0.4e1 + 0.125e0 * t30 * t31 + t39;
  t44 = 0.1e1 + t18 / t40 / 0.2e1;
  t45 = log(t44);
  t46 = t1 * t16 * t45;
  t47 = 0.2e1 * t46;
  t48 = rho[0] - rho[1];
  t49 = t48 * t48;
  t50 = t49 * t49;
  t51 = t10 * t10;
  t52 = t51 * t51;
  t53 = 0.1e1 / t52;
  t54 = t50 * t53;
  t55 = 0.1e1 / t10;
  t56 = t48 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t63 = my_piecewise3(t58, t60, t61 * t57);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t60, t66 * t64);
  t69 = t63 + t68 - 0.2e1;
  t70 = M_CBRT2;
  t73 = 0.1e1 / (0.2e1 * t70 - 0.2e1);
  t74 = t69 * t73;
  t75 = params->a[1];
  t76 = params->alpha1[1];
  t77 = t76 * t3;
  t80 = 0.1e1 + t77 * t13 / 0.4e1;
  t82 = 0.1e1 / t75;
  t83 = params->beta1[1];
  t87 = params->beta2[1] * t3;
  t90 = params->beta3[1];
  t95 = params->pp[1] + 0.1e1;
  t96 = pow(t35, t95);
  t97 = params->beta4[1] * t96;
  t98 = t83 * t23 / 0.2e1 + t87 * t13 / 0.4e1 + 0.125e0 * t90 * t31 + t97;
  t102 = 0.1e1 + t82 / t98 / 0.2e1;
  t103 = log(t102);
  t105 = params->a[2];
  t106 = params->alpha1[2];
  t107 = t106 * t3;
  t110 = 0.1e1 + t107 * t13 / 0.4e1;
  t112 = 0.1e1 / t105;
  t113 = params->beta1[2];
  t117 = params->beta2[2] * t3;
  t120 = params->beta3[2];
  t125 = params->pp[2] + 0.1e1;
  t126 = pow(t35, t125);
  t127 = params->beta4[2] * t126;
  t128 = t113 * t23 / 0.2e1 + t117 * t13 / 0.4e1 + 0.125e0 * t120 * t31 + t127;
  t132 = 0.1e1 + t112 / t128 / 0.2e1;
  t133 = log(t132);
  t134 = 0.1e1 / params->fz20;
  t135 = t133 * t134;
  t138 = -0.2e1 * t75 * t80 * t103 - 0.2e1 * t105 * t110 * t135 + 0.2e1 * t46;
  t139 = t74 * t138;
  t140 = t54 * t139;
  t143 = t110 * t133 * t134;
  t145 = 0.2e1 * t74 * t105 * t143;
  tzk0 = -t47 + t140 + t145;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t147 = t1 * t2 * t3;
  t149 = 0.1e1 / t11 / t10;
  t152 = t147 * t9 * t149 * t45;
  t153 = t152 / 0.6e1;
  t154 = t40 * t40;
  t155 = 0.1e1 / t154;
  t156 = t16 * t155;
  t157 = 0.1e1 / t23;
  t159 = t19 * t157 * t3;
  t160 = t9 * t149;
  t165 = sqrt(t22);
  t167 = t30 * t165 * t3;
  t173 = -t159 * t160 / 0.12e2 - t27 * t160 / 0.12e2 - 0.625e-1 * t167 * t160 - t39 * t37 * t55 / 0.3e1;
  t174 = 0.1e1 / t44;
  t175 = t173 * t174;
  t176 = t156 * t175;
  t177 = t49 * t48;
  t178 = t177 * t53;
  t179 = t178 * t139;
  t180 = 0.4e1 * t179;
  t181 = t52 * t10;
  t182 = 0.1e1 / t181;
  t183 = t50 * t182;
  t184 = t183 * t139;
  t185 = 0.4e1 * t184;
  t186 = 0.1e1 / t51;
  t187 = t48 * t186;
  t188 = t55 - t187;
  t191 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t188);
  t192 = -t188;
  t195 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t192);
  t197 = (t191 + t195) * t73;
  t198 = t197 * t138;
  t199 = t54 * t198;
  t201 = t75 * t76 * t3;
  t206 = t98 * t98;
  t207 = 0.1e1 / t206;
  t208 = t80 * t207;
  t210 = t83 * t157 * t3;
  t216 = t90 * t165 * t3;
  t222 = -t210 * t160 / 0.12e2 - t87 * t160 / 0.12e2 - 0.625e-1 * t216 * t160 - t97 * t95 * t55 / 0.3e1;
  t223 = 0.1e1 / t102;
  t224 = t222 * t223;
  t226 = t105 * t106;
  t227 = t226 * t20;
  t228 = t8 * t149;
  t232 = t128 * t128;
  t233 = 0.1e1 / t232;
  t234 = t110 * t233;
  t236 = t113 * t157 * t3;
  t242 = t120 * t165 * t3;
  t248 = -t236 * t160 / 0.12e2 - t117 * t160 / 0.12e2 - 0.625e-1 * t242 * t160 - t127 * t125 * t55 / 0.3e1;
  t249 = 0.1e1 / t132;
  t251 = t248 * t249 * t134;
  t253 = t201 * t9 * t149 * t103 / 0.6e1 + t208 * t224 - t153 - t176 + t227 * t228 * t135 / 0.6e1 + t234 * t251;
  t254 = t74 * t253;
  t255 = t54 * t254;
  t257 = t197 * t105 * t143;
  t258 = 0.2e1 * t257;
  t259 = t226 * t3;
  t260 = t74 * t259;
  t263 = t9 * t149 * t133 * t134;
  t264 = t260 * t263;
  t265 = t264 / 0.6e1;
  t266 = t74 * t110;
  t268 = t249 * t134;
  t269 = t233 * t248 * t268;
  t270 = t266 * t269;
  tvrho0 = -t47 + t140 + t145 + t10 * (t153 + t176 + t180 - t185 + t199 + t255 + t258 - t265 - t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t273 = -t55 - t187;
  t276 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t273);
  t277 = -t273;
  t280 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t277);
  t282 = (t276 + t280) * t73;
  t283 = t282 * t138;
  t284 = t54 * t283;
  t286 = t282 * t105 * t143;
  t287 = 0.2e1 * t286;
  tvrho1 = -t47 + t140 + t145 + t10 * (t153 + t176 - t180 - t185 + t284 + t255 + t287 - t265 - t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t290 = t152 / 0.3e1;
  t291 = 0.2e1 * t176;
  t292 = 0.8e1 * t179;
  t293 = 0.8e1 * t184;
  t295 = 0.2e1 * t255;
  t297 = t264 / 0.3e1;
  t298 = 0.2e1 * t270;
  t300 = 0.1e1 / t23 / t22;
  t302 = t3 * t3;
  t303 = t19 * t300 * t302;
  t304 = t6 * t6;
  t305 = t304 * t7;
  t306 = t11 * t11;
  t309 = t305 / t306 / t51;
  t313 = 0.1e1 / t11 / t51;
  t314 = t9 * t313;
  t319 = 0.1e1/sqrt(t22);
  t321 = t30 * t319 * t302;
  t326 = t37 * t37;
  t333 = -t303 * t309 / 0.18e2 + t159 * t314 / 0.9e1 + t27 * t314 / 0.9e1 + 0.41666666666666666666e-1 * t321 * t309 + 0.83333333333333333333e-1 * t167 * t314 + t39 * t326 * t186 / 0.9e1 + t39 * t37 * t186 / 0.3e1;
  t334 = t333 * t174;
  t335 = t156 * t334;
  t336 = t49 * t53;
  t337 = t336 * t139;
  t338 = 0.12e2 * t337;
  t339 = t177 * t182;
  t340 = t339 * t139;
  t341 = 0.32e2 * t340;
  t343 = 0.1e1 / t52 / t51;
  t344 = t50 * t343;
  t345 = t344 * t139;
  t346 = 0.2e2 * t345;
  t347 = t197 * t110;
  t348 = t347 * t269;
  t349 = 0.2e1 * t348;
  t351 = t113 * t300 * t302;
  t359 = t120 * t319 * t302;
  t364 = t125 * t125;
  t371 = -t351 * t309 / 0.18e2 + t236 * t314 / 0.9e1 + t117 * t314 / 0.9e1 + 0.41666666666666666666e-1 * t359 * t309 + 0.83333333333333333333e-1 * t242 * t314 + t127 * t364 * t186 / 0.9e1 + t127 * t125 * t186 / 0.3e1;
  t373 = t233 * t371 * t268;
  t374 = t266 * t373;
  t375 = t154 * t40;
  t376 = 0.1e1 / t375;
  t377 = t16 * t376;
  t378 = t173 * t173;
  t379 = t378 * t174;
  t380 = t377 * t379;
  t381 = 0.2e1 * t380;
  t382 = t154 * t154;
  t383 = 0.1e1 / t382;
  t384 = t16 * t383;
  t385 = t44 * t44;
  t386 = 0.1e1 / t385;
  t388 = t378 * t386 * t18;
  t389 = t384 * t388;
  t390 = t389 / 0.2e1;
  t391 = t178 * t198;
  t392 = 0.8e1 * t391;
  t393 = t178 * t254;
  t394 = 0.8e1 * t393;
  t395 = t183 * t198;
  t396 = 0.8e1 * t395;
  t397 = t335 + t338 - t341 + t346 - t349 - t374 - t381 + t390 + t392 + t394 - t396;
  t398 = t183 * t254;
  t399 = 0.8e1 * t398;
  t400 = t61 * t61;
  t401 = 0.1e1 / t400;
  t402 = t188 * t188;
  t405 = t51 * t10;
  t406 = 0.1e1 / t405;
  t407 = t48 * t406;
  t409 = -0.2e1 * t186 + 0.2e1 * t407;
  t413 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t401 * t402 + 0.4e1 / 0.3e1 * t61 * t409);
  t414 = t66 * t66;
  t415 = 0.1e1 / t414;
  t416 = t192 * t192;
  t419 = -t409;
  t423 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t415 * t416 + 0.4e1 / 0.3e1 * t66 * t419);
  t425 = (t413 + t423) * t73;
  t426 = t425 * t138;
  t427 = t54 * t426;
  t428 = t197 * t253;
  t429 = t54 * t428;
  t430 = 0.2e1 * t429;
  t435 = t77 * t9;
  t436 = t149 * t207;
  t440 = t206 * t98;
  t441 = 0.1e1 / t440;
  t442 = t80 * t441;
  t443 = t222 * t222;
  t444 = t443 * t223;
  t448 = t83 * t300 * t302;
  t456 = t90 * t319 * t302;
  t461 = t95 * t95;
  t468 = -t448 * t309 / 0.18e2 + t210 * t314 / 0.9e1 + t87 * t314 / 0.9e1 + 0.41666666666666666666e-1 * t456 * t309 + 0.83333333333333333333e-1 * t216 * t314 + t97 * t461 * t186 / 0.9e1 + t97 * t95 * t186 / 0.3e1;
  t469 = t468 * t223;
  t471 = t206 * t206;
  t472 = 0.1e1 / t471;
  t473 = t80 * t472;
  t474 = t102 * t102;
  t475 = 0.1e1 / t474;
  t477 = t443 * t475 * t82;
  t482 = t147 * t9 * t313 * t45;
  t483 = 0.2e1 / 0.9e1 * t482;
  t484 = t4 * t9;
  t485 = t149 * t155;
  t487 = t484 * t485 * t175;
  t488 = t487 / 0.6e1;
  t489 = t8 * t313;
  t493 = t107 * t9;
  t494 = t149 * t233;
  t498 = t232 * t128;
  t499 = 0.1e1 / t498;
  t500 = t110 * t499;
  t501 = t248 * t248;
  t502 = t501 * t249;
  t503 = t502 * t134;
  t506 = t371 * t249;
  t507 = t506 * t134;
  t509 = t232 * t232;
  t510 = 0.1e1 / t509;
  t511 = t110 * t510;
  t512 = t511 * t501;
  t513 = t132 * t132;
  t514 = 0.1e1 / t513;
  t515 = t514 * t134;
  t516 = t515 * t112;
  t519 = -0.2e1 / 0.9e1 * t201 * t9 * t313 * t103 - t435 * t436 * t224 / 0.6e1 - 0.2e1 * t442 * t444 + t208 * t469 + t473 * t477 / 0.2e1 + t483 + t488 + t381 - t335 - t390 - 0.2e1 / 0.9e1 * t227 * t489 * t135 - t493 * t494 * t251 / 0.6e1 - 0.2e1 * t500 * t503 + t234 * t507 + t512 * t516 / 0.2e1;
  t520 = t74 * t519;
  t521 = t54 * t520;
  t523 = t499 * t501 * t268;
  t524 = t266 * t523;
  t525 = 0.2e1 * t524;
  t526 = t74 * t511;
  t527 = t501 * t514;
  t528 = t134 * t112;
  t529 = t527 * t528;
  t530 = t526 * t529;
  t531 = t530 / 0.2e1;
  t532 = t197 * t259;
  t533 = t532 * t263;
  t534 = t533 / 0.3e1;
  t536 = t425 * t105 * t143;
  t537 = 0.2e1 * t536;
  t540 = t9 * t313 * t133 * t134;
  t541 = t260 * t540;
  t542 = 0.2e1 / 0.9e1 * t541;
  t543 = t107 * t6;
  t544 = t74 * t543;
  t545 = t228 * t233;
  t546 = t545 * t251;
  t547 = t544 * t546;
  t548 = t547 / 0.6e1;
  t549 = -t399 + t427 + t430 + t521 - t483 - t488 + t525 - t531 - t534 + t537 + t542 + t548;
  tv2rho20 = t290 + t291 + t292 - t293 + 0.2e1 * t199 + t295 + 0.4e1 * t257 - t297 - t298 + t10 * (t397 + t549);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t552 = t282 * t110;
  t553 = t552 * t269;
  t555 = t282 * t259;
  t556 = t555 * t263;
  t558 = t548 - t553 - t483 + t525 - t348 - t374 - t488 - t531 + t335 - t533 / 0.6e1 + t542 - t556 / 0.6e1 - t338;
  t559 = t178 * t283;
  t561 = t183 * t283;
  t563 = t401 * t273;
  t566 = t61 * t48;
  t570 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t563 * t188 + 0.8e1 / 0.3e1 * t566 * t406);
  t571 = t415 * t277;
  t574 = t66 * t48;
  t578 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t571 * t192 - 0.8e1 / 0.3e1 * t574 * t406);
  t580 = (t570 + t578) * t73;
  t581 = t580 * t138;
  t582 = t54 * t581;
  t586 = t580 * t105 * t143;
  t588 = t282 * t253;
  t589 = t54 * t588;
  t590 = t346 + 0.4e1 * t559 - 0.4e1 * t561 + t582 - t381 + t390 - 0.4e1 * t391 - 0.4e1 * t395 - t399 + t429 + t521 + 0.2e1 * t586 + t589;
  tv2rho21 = t290 + t291 - t293 + t199 + t295 + t258 - t297 - t298 + t284 + t287 + t10 * (t558 + t590);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t595 = t273 * t273;
  t599 = 0.2e1 * t186 + 0.2e1 * t407;
  t603 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t401 * t595 + 0.4e1 / 0.3e1 * t61 * t599);
  t604 = t277 * t277;
  t607 = -t599;
  t611 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t415 * t604 + 0.4e1 / 0.3e1 * t66 * t607);
  t613 = (t603 + t611) * t73;
  t614 = t613 * t138;
  t615 = t54 * t614;
  t617 = t613 * t105 * t143;
  t618 = 0.2e1 * t617;
  t619 = t615 + t618 + t335 + t338 + t341 + t346 - t374 - t381 + t390 - t394 - t399;
  t620 = t556 / 0.3e1;
  t621 = 0.8e1 * t559;
  t622 = 0.8e1 * t561;
  t623 = 0.2e1 * t589;
  t624 = 0.2e1 * t553;
  t625 = t521 - t483 - t488 + t525 - t531 - t620 - t621 - t622 + t623 + t542 + t548 - t624;
  tv2rho22 = t290 + t291 - t292 - t293 + 0.2e1 * t284 + t295 + 0.4e1 * t286 - t297 - t298 + t10 * (t619 + t625);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t629 = t20 * t8;
  t630 = t74 * t106 * t629;
  t631 = t149 * t510;
  t633 = t631 * t501 * t516;
  t634 = t630 * t633;
  t635 = t634 / 0.8e1;
  t636 = t197 * t543;
  t637 = t636 * t546;
  t638 = t637 / 0.2e1;
  t639 = t545 * t507;
  t640 = t544 * t639;
  t641 = t640 / 0.4e1;
  t643 = t228 * t499 * t503;
  t644 = t544 * t643;
  t645 = t644 / 0.2e1;
  t646 = t489 * t233;
  t647 = t646 * t251;
  t648 = t544 * t647;
  t649 = t648 / 0.3e1;
  t651 = 0.1e1 / t11 / t405;
  t654 = t147 * t9 * t651 * t45;
  t655 = 0.14e2 / 0.27e2 * t654;
  t656 = t425 * t259;
  t657 = t656 * t263;
  t659 = t532 * t540;
  t660 = 0.2e1 / 0.3e1 * t659;
  t663 = t9 * t651 * t133 * t134;
  t664 = t260 * t663;
  t665 = 0.14e2 / 0.27e2 * t664;
  t672 = 0.1e1 / t23 / t302 / t304 / t7 * t306 / 0.4e1;
  t673 = t19 * t672;
  t674 = t5 * t53;
  t679 = t305 / t306 / t405;
  t682 = t9 * t651;
  t687 = 0.1e1/POW_3_2(t22);
  t688 = t30 * t687;
  t695 = t326 * t37;
  t705 = -t673 * t674 / 0.3e1 + 0.2e1 / 0.9e1 * t303 * t679 - 0.7e1 / 0.27e2 * t159 * t682 - 0.7e1 / 0.27e2 * t27 * t682 + 0.83333333333333333332e-1 * t688 * t674 - 0.16666666666666666666e0 * t321 * t679 - 0.19444444444444444444e0 * t167 * t682 - t39 * t695 * t406 / 0.27e2 - t39 * t326 * t406 / 0.3e1 - 0.2e1 / 0.3e1 * t39 * t37 * t406;
  t706 = t705 * t174;
  t707 = t156 * t706;
  t708 = t378 * t173;
  t709 = t708 * t174;
  t710 = t384 * t709;
  t711 = 0.6e1 * t710;
  t712 = t48 * t53;
  t713 = t712 * t139;
  t714 = 0.24e2 * t713;
  t715 = t635 + t638 + t641 - t645 - t649 + t655 - t657 / 0.2e1 + t660 - t665 + t707 + t711 + t714;
  t716 = t49 * t182;
  t717 = t716 * t139;
  t718 = 0.144e3 * t717;
  t719 = t336 * t254;
  t720 = 0.36e2 * t719;
  t722 = 0.1e1 / t52 / t405;
  t723 = t50 * t722;
  t724 = t723 * t139;
  t725 = 0.12e3 * t724;
  t726 = t177 * t343;
  t727 = t726 * t139;
  t728 = 0.24e3 * t727;
  t730 = t386 * t18;
  t731 = t730 * t173;
  t732 = t384 * t333 * t731;
  t733 = 0.3e1 / 0.2e1 * t732;
  t734 = t344 * t254;
  t735 = 0.6e2 * t734;
  t736 = t339 * t198;
  t737 = 0.96e2 * t736;
  t738 = t339 * t254;
  t739 = 0.96e2 * t738;
  t740 = t336 * t198;
  t741 = 0.36e2 * t740;
  t742 = t344 * t198;
  t743 = 0.6e2 * t742;
  t744 = t178 * t426;
  t746 = t178 * t428;
  t747 = 0.24e2 * t746;
  t748 = t178 * t520;
  t749 = 0.12e2 * t748;
  t750 = -t718 + t720 - t725 + t728 + t733 + t735 - t737 - t739 + t741 + t743 + 0.12e2 * t744 + t747 + t749;
  t752 = t183 * t428;
  t753 = 0.24e2 * t752;
  t754 = t183 * t520;
  t755 = 0.12e2 * t754;
  t756 = t183 * t426;
  t758 = t425 * t253;
  t759 = t54 * t758;
  t761 = t197 * t519;
  t762 = t54 * t761;
  t763 = 0.3e1 * t762;
  t765 = 0.1e1 / t400 / t57;
  t766 = t402 * t188;
  t769 = t401 * t188;
  t773 = 0.6e1 * t406 - 0.6e1 * t712;
  t777 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t765 * t766 + 0.4e1 / 0.3e1 * t769 * t409 + 0.4e1 / 0.3e1 * t61 * t773);
  t779 = 0.1e1 / t414 / t64;
  t780 = t416 * t192;
  t783 = t415 * t192;
  t786 = -t773;
  t790 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t779 * t780 + 0.4e1 / 0.3e1 * t783 * t419 + 0.4e1 / 0.3e1 * t66 * t786);
  t792 = (t777 + t790) * t73;
  t793 = t792 * t138;
  t794 = t54 * t793;
  t795 = t334 * t173;
  t796 = t377 * t795;
  t797 = 0.6e1 * t796;
  t799 = 0.1e1 / t382 / t154;
  t800 = t16 * t799;
  t802 = 0.1e1 / t385 / t44;
  t804 = t1 * t1;
  t805 = 0.1e1 / t804;
  t806 = t708 * t802 * t805;
  t807 = t800 * t806;
  t808 = t807 / 0.2e1;
  t810 = 0.1e1 / t382 / t40;
  t811 = t16 * t810;
  t813 = t708 * t386 * t18;
  t814 = t811 * t813;
  t815 = 0.3e1 * t814;
  t817 = t792 * t105 * t143;
  t818 = 0.2e1 * t817;
  t820 = 0.1e1 / t509 / t128;
  t821 = t110 * t820;
  t822 = t74 * t821;
  t823 = t501 * t248;
  t825 = t823 * t514 * t528;
  t826 = t822 * t825;
  t827 = 0.3e1 * t826;
  t829 = 0.1e1 / t509 / t232;
  t830 = t110 * t829;
  t831 = t74 * t830;
  t833 = 0.1e1 / t513 / t132;
  t835 = t105 * t105;
  t836 = 0.1e1 / t835;
  t837 = t134 * t836;
  t838 = t823 * t833 * t837;
  t839 = t831 * t838;
  t840 = t839 / 0.2e1;
  t841 = -t753 - t755 - 0.12e2 * t756 + 0.3e1 * t759 + t763 + t794 - t797 + t808 - t815 + t818 + t827 - t840;
  t842 = t313 * t155;
  t844 = t484 * t842 * t175;
  t845 = t844 / 0.3e1;
  t846 = t149 * t376;
  t848 = t484 * t846 * t379;
  t849 = t848 / 0.2e1;
  t851 = t484 * t485 * t334;
  t852 = t851 / 0.4e1;
  t853 = t197 * t511;
  t854 = t853 * t529;
  t855 = 0.3e1 / 0.2e1 * t854;
  t856 = t74 * t500;
  t857 = t134 * t248;
  t858 = t506 * t857;
  t859 = t856 * t858;
  t860 = 0.6e1 * t859;
  t862 = t510 * t823 * t268;
  t863 = t266 * t862;
  t864 = 0.6e1 * t863;
  t865 = t347 * t523;
  t866 = 0.6e1 * t865;
  t867 = t113 * t672;
  t876 = t120 * t687;
  t883 = t364 * t125;
  t893 = -t867 * t674 / 0.3e1 + 0.2e1 / 0.9e1 * t351 * t679 - 0.7e1 / 0.27e2 * t236 * t682 - 0.7e1 / 0.27e2 * t117 * t682 + 0.83333333333333333332e-1 * t876 * t674 - 0.16666666666666666666e0 * t359 * t679 - 0.19444444444444444444e0 * t242 * t682 - t127 * t883 * t406 / 0.27e2 - t127 * t364 * t406 / 0.3e1 - 0.2e1 / 0.3e1 * t127 * t125 * t406;
  t895 = t233 * t893 * t268;
  t896 = t266 * t895;
  t897 = t347 * t373;
  t898 = 0.3e1 * t897;
  t899 = t425 * t110;
  t900 = t899 * t269;
  t908 = t515 * t112 * t248;
  t911 = t83 * t672;
  t920 = t90 * t687;
  t927 = t461 * t95;
  t937 = -t911 * t674 / 0.3e1 + 0.2e1 / 0.9e1 * t448 * t679 - 0.7e1 / 0.27e2 * t210 * t682 - 0.7e1 / 0.27e2 * t87 * t682 + 0.83333333333333333332e-1 * t920 * t674 - 0.16666666666666666666e0 * t456 * t679 - 0.19444444444444444444e0 * t216 * t682 - t97 * t927 * t406 / 0.27e2 - t97 * t461 * t406 / 0.3e1 - 0.2e1 / 0.3e1 * t97 * t95 * t406;
  t938 = t937 * t223;
  t940 = t443 * t222;
  t941 = t940 * t223;
  t944 = t107 * t160;
  t946 = t510 * t501 * t516;
  t950 = t475 * t82;
  t951 = t950 * t222;
  t955 = t833 * t134;
  t956 = t955 * t836;
  t965 = -t655 + 0.14e2 / 0.27e2 * t201 * t9 * t651 * t103 + 0.3e1 / 0.2e1 * t511 * t371 * t908 + t208 * t938 + 0.6e1 * t473 * t941 - t944 * t946 / 0.8e1 - t707 - t711 - t733 + 0.3e1 / 0.2e1 * t473 * t468 * t951 + t797 - t808 + t815 + t830 * t823 * t956 / 0.2e1 - 0.6e1 * t500 * t248 * t507 - 0.3e1 * t821 * t823 * t516;
  t967 = 0.1e1 / t471 / t98;
  t968 = t80 * t967;
  t970 = t940 * t475 * t82;
  t973 = t224 * t468;
  t976 = t313 * t207;
  t983 = t149 * t441;
  t987 = t8 * t651;
  t991 = t893 * t249;
  t992 = t991 * t134;
  t995 = t823 * t249 * t134;
  t999 = 0.1e1 / t471 / t206;
  t1000 = t80 * t999;
  t1002 = 0.1e1 / t474 / t102;
  t1004 = t75 * t75;
  t1005 = 0.1e1 / t1004;
  t1006 = t940 * t1002 * t1005;
  t1009 = t149 * t499;
  t1013 = t149 * t383;
  t1015 = t484 * t1013 * t388;
  t1016 = t1015 / 0.8e1;
  t1017 = t149 * t472;
  t1021 = t313 * t233;
  t1028 = -0.3e1 * t968 * t970 - 0.6e1 * t442 * t973 - t845 + t435 * t976 * t224 / 0.3e1 - t435 * t436 * t469 / 0.4e1 - t849 + t852 + t435 * t983 * t444 / 0.2e1 + 0.14e2 / 0.27e2 * t227 * t987 * t135 + t234 * t992 + 0.6e1 * t511 * t995 + t1000 * t1006 / 0.2e1 + t493 * t1009 * t503 / 0.2e1 + t1016 - t435 * t1017 * t477 / 0.8e1 + t493 * t1021 * t251 / 0.3e1 - t493 * t494 * t507 / 0.4e1;
  t1029 = t965 + t1028;
  t1030 = t74 * t1029;
  t1031 = t54 * t1030;
  t1033 = t528 * t248;
  t1034 = t371 * t514 * t1033;
  t1035 = t526 * t1034;
  t1036 = 0.3e1 / 0.2e1 * t1035;
  t1037 = t845 + t849 - t852 - t855 + t860 - t864 + t866 - t896 - t898 - 0.3e1 * t900 + t1031 - t1016 - t1036;
  t1041 = 0.3e1 * t335;
  t1042 = 0.36e2 * t337;
  t1043 = 0.96e2 * t340;
  t1044 = 0.6e2 * t345;
  t1046 = 0.3e1 * t374;
  t1047 = 0.6e1 * t380;
  t1048 = 0.3e1 / 0.2e1 * t389;
  t1050 = 0.24e2 * t393;
  t1052 = t10 * (t715 + t750 + t841 + t1037) + t1041 + t1042 - t1043 + t1044 - 0.6e1 * t348 - t1046 - t1047 + t1048 + 0.24e2 * t391 + t1050 - 0.24e2 * t395;
  t1053 = 0.24e2 * t398;
  t1056 = 0.3e1 * t521;
  t1057 = 0.2e1 / 0.3e1 * t482;
  t1058 = t487 / 0.2e1;
  t1059 = 0.6e1 * t524;
  t1060 = 0.3e1 / 0.2e1 * t530;
  t1062 = 0.2e1 / 0.3e1 * t541;
  t1063 = t547 / 0.2e1;
  t1064 = -t1053 + 0.3e1 * t427 + 0.6e1 * t429 + t1056 - t1057 - t1058 + t1059 - t1060 - t533 + 0.6e1 * t536 + t1062 + t1063;
  tv3rho30 = t1052 + t1064;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1065 = t282 * t543;
  t1066 = t1065 * t546;
  t1069 = t555 * t540;
  t1071 = t580 * t259;
  t1072 = t1071 * t263;
  t1073 = t1072 / 0.3e1;
  t1076 = t765 * t273;
  t1079 = t401 * t48;
  t1090 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t1076 * t402 + 0.16e2 / 0.9e1 * t1079 * t406 * t188 + 0.4e1 / 0.9e1 * t563 * t409 + 0.8e1 / 0.3e1 * t61 * t406 - 0.8e1 * t566 * t53);
  t1091 = t779 * t277;
  t1094 = t415 * t48;
  t1105 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1091 * t416 - 0.16e2 / 0.9e1 * t1094 * t406 * t192 + 0.4e1 / 0.9e1 * t571 * t419 - 0.8e1 / 0.3e1 * t66 * t406 + 0.8e1 * t574 * t53);
  t1107 = (t1090 + t1105) * t73;
  t1109 = t1107 * t105 * t143;
  t1111 = t339 * t283;
  t1113 = t178 * t581;
  t1114 = 0.8e1 * t1113;
  t1115 = t178 * t588;
  t1117 = t635 + t1066 / 0.6e1 + t637 / 0.3e1 + t641 - t645 - t649 + t655 + 0.2e1 / 0.9e1 * t1069 - t1073 - t657 / 0.6e1 + 0.4e1 / 0.9e1 * t659 - t665 + 0.2e1 * t1109 - 0.32e2 * t1111 + t1114 + 0.8e1 * t1115;
  t1118 = t183 * t581;
  t1119 = 0.8e1 * t1118;
  t1120 = t183 * t588;
  t1122 = t344 * t283;
  t1124 = t336 * t283;
  t1126 = t1107 * t138;
  t1127 = t54 * t1126;
  t1128 = t580 * t253;
  t1129 = t54 * t1128;
  t1130 = 0.2e1 * t1129;
  t1131 = t282 * t519;
  t1132 = t54 * t1131;
  t1133 = 0.48e2 * t717;
  t1134 = 0.12e2 * t719;
  t1135 = 0.8e2 * t727;
  t1136 = -t1119 - 0.8e1 * t1120 + 0.2e2 * t1122 + 0.12e2 * t1124 + t1127 + t1130 + t1132 + t707 + t711 - t714 + t1133 - t1134 - t725 + t1135 + t733 + t735;
  t1138 = 0.32e2 * t738;
  t1139 = 0.24e2 * t740;
  t1142 = 0.4e1 * t748;
  t1146 = t552 * t523;
  t1148 = t580 * t110;
  t1149 = t1148 * t269;
  t1150 = 0.2e1 * t1149;
  t1151 = t552 * t373;
  t1152 = -t1138 - t1139 + 0.4e2 * t742 - 0.4e1 * t744 + t1142 - 0.16e2 * t752 - t755 - 0.4e1 * t756 + t759 + 0.2e1 * t762 + 0.2e1 * t1146 - t1150 - t1151 - t797 + t808 - t815;
  t1153 = t282 * t511;
  t1154 = t1153 * t529;
  t1158 = t827 - t840 + t845 + t849 - t852 - t854 + t860 - t1154 / 0.2e1 - t864 + 0.4e1 * t865 - t896 - 0.2e1 * t897 - t900 + t1031 - t1016 - t1036;
  t1164 = t10 * (t1117 + t1136 + t1152 + t1158) + t1063 + t537 - t624 - t1057 + t1059 - 0.4e1 * t348 - t1046 - t1058 - t1060 + t1041 - 0.2e1 / 0.3e1 * t533 + t1062 - t620 - t338;
  t1165 = 0.2e1 * t582;
  t1168 = 0.4e1 * t586;
  t1169 = -t341 + t1044 + t621 - t622 + t1165 - t1047 + t1048 + t394 - 0.16e2 * t395 - t1053 + t427 + 0.4e1 * t429 + t1056 + t1168 + t623;
  tv3rho31 = t1164 + t1169;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1171 = t765 * t595;
  t1176 = t401 * t599;
  t1181 = -0.2e1 * t406 - 0.6e1 * t712;
  t1185 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t1171 * t188 + 0.16e2 / 0.9e1 * t563 * t407 + 0.4e1 / 0.9e1 * t1176 * t188 + 0.4e1 / 0.3e1 * t61 * t1181);
  t1186 = t779 * t604;
  t1191 = t415 * t607;
  t1194 = -t1181;
  t1198 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1186 * t192 - 0.16e2 / 0.9e1 * t571 * t407 + 0.4e1 / 0.9e1 * t1191 * t192 + 0.4e1 / 0.3e1 * t66 * t1194);
  t1200 = (t1185 + t1198) * t73;
  t1202 = t1200 * t105 * t143;
  t1207 = t613 * t259;
  t1208 = t1207 * t263;
  t1212 = 0.2e1 * t1202 + t635 + t1066 / 0.3e1 + t637 / 0.6e1 + t641 - t645 - t649 + t655 + 0.4e1 / 0.9e1 * t1069 - t1208 / 0.6e1 - t1073 + 0.2e1 / 0.9e1 * t659 - t665 - t1114 - t1119 - 0.16e2 * t1120;
  t1214 = 0.24e2 * t1124;
  t1215 = t613 * t110;
  t1216 = t1215 * t269;
  t1219 = 0.4e2 * t1122 - t1214 + t1130 - t1216 + 0.2e1 * t1132 + t707 + t711 + t714 + t1133 - t1134 - t725 - t1135 + t733 + t735 + 0.32e2 * t736 + t1138;
  t1227 = 0.12e2 * t740 + 0.2e2 * t742 - 0.8e1 * t746 - t1142 - 0.8e1 * t752 - t755 + t762 + 0.4e1 * t1146 - t1150 - 0.2e1 * t1151 - t797 + t808 - t815 + t827 - t840 + t845;
  t1230 = t1200 * t138;
  t1231 = t54 * t1230;
  t1232 = t613 * t253;
  t1233 = t54 * t1232;
  t1234 = t178 * t614;
  t1236 = t183 * t614;
  t1238 = t849 - t852 - t854 / 0.2e1 + t860 - t1154 - t864 + 0.2e1 * t865 - t896 - t897 + t1231 + t1233 + 0.4e1 * t1234 - 0.4e1 * t1236 + t1031 - t1016 - t1036;
  t1243 = t1063 - 0.4e1 * t553 - t1057 + t1059 - t349 - t1046 - t1058 - t1060 + t1041 + t10 * (t1212 + t1219 + t1227 + t1238) - t534 + t1062 - 0.2e1 / 0.3e1 * t556 - t338 + t341;
  t1246 = t1044 - 0.16e2 * t561 + t1165 - t1047 + t1048 - t392 - t394 - t396 - t1053 + t430 + t1056 + t1168 + 0.4e1 * t589 + t615 + t618;
  tv3rho32 = t1243 + t1246;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1247 = t1066 / 0.2e1;
  t1248 = 0.2e1 / 0.3e1 * t1069;
  t1250 = 0.96e2 * t1111;
  t1251 = 0.24e2 * t1115;
  t1252 = 0.24e2 * t1120;
  t1253 = t635 + t1247 + t641 - t645 - t649 + t655 + t1248 - t1208 / 0.2e1 - t665 + t1250 - t1251 - t1252;
  t1254 = 0.6e2 * t1122;
  t1255 = 0.36e2 * t1124;
  t1256 = t595 * t273;
  t1262 = -0.6e1 * t406 - 0.6e1 * t712;
  t1266 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t765 * t1256 + 0.4e1 / 0.3e1 * t563 * t599 + 0.4e1 / 0.3e1 * t61 * t1262);
  t1267 = t604 * t277;
  t1272 = -t1262;
  t1276 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t779 * t1267 + 0.4e1 / 0.3e1 * t571 * t607 + 0.4e1 / 0.3e1 * t66 * t1272);
  t1278 = (t1266 + t1276) * t73;
  t1279 = t1278 * t138;
  t1280 = t54 * t1279;
  t1282 = 0.3e1 * t1132;
  t1284 = t1278 * t105 * t143;
  t1285 = 0.2e1 * t1284;
  t1286 = t1254 + t1255 + t1280 - 0.3e1 * t1216 + t1282 + t707 + t711 + t1285 - t714 - t718 + t720 - t725 - t728;
  t1288 = 0.6e1 * t1146;
  t1289 = 0.3e1 * t1151;
  t1290 = t733 + t735 + t739 - t749 - t755 + t1288 - t1289 - t797 + t808 - t815 + t827 - t840;
  t1291 = 0.3e1 / 0.2e1 * t1154;
  t1295 = t845 + t849 - t852 + t860 - t1291 - t864 - t896 + 0.3e1 * t1233 - 0.12e2 * t1234 - 0.12e2 * t1236 + t1031 - t1016 - t1036;
  t1301 = t10 * (t1253 + t1286 + t1290 + t1295) + 0.3e1 * t615 + 0.6e1 * t617 + t1041 + t1042 + t1043 + t1044 - t1046 - t1047 + t1048 - t1050 - t1053;
  t1306 = t1056 - t1057 - t1058 + t1059 - t1060 - t556 - 0.24e2 * t559 - 0.24e2 * t561 + 0.6e1 * t589 + t1062 + t1063 - 0.6e1 * t553;
  tv3rho33 = t1301 + t1306;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t7, t8;
  double t9, t10, t11, t12, t13, t16, t18, t19;
  double t20, t22, t23, t27, t30, t31, t35, t37;
  double t38, t39, t40, t44, t45, t46, t47, t48;
  double t49, t50, t51, t52, t53, t54, t55, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t68, t69, t70, t73, t74, t75, t76;
  double t77, t80, t82, t83, t87, t90, t95, t96;
  double t97, t98, t102, t103, t105, t106, t107, t110;
  double t112, t113, t117, t120, t125, t126, t127, t128;
  double t132, t133, t134, t135, t138, t139, t140, t143;
  double t145, tzk0;

  double t147, t149, t152, t153, t154, t155, t156, t157;
  double t159, t160, t165, t167, t173, t174, t175, t176;
  double t177, t178, t179, t180, t181, t182, t183, t184;
  double t185, t186, t187, t188, t191, t192, t195, t197;
  double t198, t199, t201, t206, t207, t208, t210, t216;
  double t222, t223, t224, t226, t227, t228, t232, t233;
  double t234, t236, t242, t248, t249, t251, t253, t254;
  double t255, t257, t258, t259, t260, t263, t264, t265;
  double t266, t268, t269, t270, tvrho0, t273, t276, t277;
  double t280, t282, t283, t284, t286, t287, tvrho1;

  double t290, t291, t292, t293, t295, t297, t298, t300;
  double t302, t303, t304, t305, t306, t309, t313, t314;
  double t319, t321, t326, t333, t334, t335, t336, t337;
  double t338, t339, t340, t341, t343, t344, t345, t346;
  double t347, t348, t349, t351, t359, t364, t371, t373;
  double t374, t375, t376, t377, t378, t379, t380, t381;
  double t382, t383, t384, t385, t386, t388, t389, t390;
  double t391, t392, t393, t394, t395, t396, t397, t398;
  double t399, t400, t401, t402, t405, t406, t407, t409;
  double t413, t414, t415, t416, t419, t423, t425, t426;
  double t427, t428, t429, t430, t435, t436, t440, t441;
  double t442, t443, t444, t448, t456, t461, t468, t469;
  double t471, t472, t473, t474, t475, t477, t482, t483;
  double t484, t485, t487, t488, t489, t493, t494, t498;
  double t499, t500, t501, t502, t503, t506, t507, t509;
  double t510, t511, t512, t513, t514, t515, t516, t519;
  double t520, t521, t523, t524, t525, t526, t527, t528;
  double t529, t530, t531, t532, t533, t534, t536, t537;
  double t540, t541, t542, t543, t544, t545, t546, t547;
  double t548, t549, tv2rho20, t552, t553, t555, t556, t558;
  double t559, t561, t563, t566, t570, t571, t574, t578;
  double t580, t581, t582, t586, t588, t589, t590, tv2rho21;
  double t595, t599, t603, t604, t607, t611, t613, t614;
  double t615, t617, t618, t619, t620, t621, t622, t623;
  double t624, t625, tv2rho22;

  double t629, t630, t631, t633, t634, t635, t636, t637;
  double t638, t639, t640, t641, t643, t644, t645, t646;
  double t647, t648, t649, t651, t654, t655, t656, t657;
  double t659, t660, t663, t664, t665, t672, t673, t674;
  double t679, t682, t687, t688, t695, t705, t706, t707;
  double t708, t709, t710, t711, t712, t713, t714, t715;
  double t716, t717, t718, t719, t720, t722, t723, t724;
  double t725, t726, t727, t728, t730, t731, t732, t733;
  double t734, t735, t736, t737, t738, t739, t740, t741;
  double t742, t743, t744, t746, t747, t748, t749, t750;
  double t752, t753, t754, t755, t756, t758, t759, t761;
  double t762, t763, t765, t766, t769, t773, t777, t779;
  double t780, t783, t786, t790, t792, t793, t794, t795;
  double t796, t797, t799, t800, t802, t804, t805, t806;
  double t807, t808, t810, t811, t813, t814, t815, t817;
  double t818, t820, t821, t822, t823, t825, t826, t827;
  double t829, t830, t831, t833, t835, t836, t837, t838;
  double t839, t840, t841, t842, t844, t845, t846, t848;
  double t849, t851, t852, t853, t854, t855, t856, t857;
  double t858, t859, t860, t862, t863, t864, t865, t866;
  double t867, t876, t883, t893, t895, t896, t897, t898;
  double t899, t900, t908, t911, t920, t927, t937, t938;
  double t940, t941, t944, t946, t950, t951, t955, t956;
  double t965, t967, t968, t970, t973, t976, t983, t987;
  double t991, t992, t995, t999, t1000, t1002, t1004, t1005;
  double t1006, t1009, t1013, t1015, t1016, t1017, t1021, t1028;
  double t1029, t1030, t1031, t1033, t1034, t1035, t1036, t1037;
  double t1041, t1042, t1043, t1044, t1046, t1047, t1048, t1050;
  double t1052, t1053, t1056, t1057, t1058, t1059, t1060, t1062;
  double t1063, t1064, tv3rho30, t1065, t1066, t1069, t1071, t1072;
  double t1073, t1076, t1079, t1090, t1091, t1094, t1105, t1107;
  double t1109, t1111, t1113, t1114, t1115, t1117, t1118, t1119;
  double t1120, t1122, t1124, t1126, t1127, t1128, t1129, t1130;
  double t1131, t1132, t1133, t1134, t1135, t1136, t1138, t1139;
  double t1142, t1146, t1148, t1149, t1150, t1151, t1152, t1153;
  double t1154, t1158, t1164, t1165, t1168, t1169, tv3rho31, t1171;
  double t1176, t1181, t1185, t1186, t1191, t1194, t1198, t1200;
  double t1202, t1207, t1208, t1212, t1214, t1215, t1216, t1219;
  double t1227, t1230, t1231, t1232, t1233, t1234, t1236, t1238;
  double t1243, t1246, tv3rho32, t1247, t1248, t1250, t1251, t1252;
  double t1253, t1254, t1255, t1256, t1262, t1266, t1267, t1272;
  double t1276, t1278, t1279, t1280, t1282, t1284, t1285, t1286;
  double t1288, t1289, t1290, t1291, t1295, t1301, t1306, tv3rho33;

  double t1307, t1309, t1310, t1315, t1319, t1324, t1327, t1332;
  double t1333, t1335, t1336, t1342, t1347, t1349, t1353, t1354;
  double t1356, t1357, t1363, t1372, t1374, t1379, t1383, t1385;
  double t1408, t1411, t1414, t1417, t1419, t1420, t1422, t1423;
  double t1426, t1440, t1456, t1470, t1474, t1498, t1504, t1507;
  double t1512, t1515, t1520, t1531, t1544, t1547, t1551, t1555;
  double t1567, t1584, t1588, t1592, t1593, t1596, t1603, t1607;
  double t1610, t1611, t1615, t1618, t1641, t1654, t1656, t1659;
  double t1664, t1668, t1671, t1674, t1677, t1678, t1695, t1699;
  double t1706, t1713, t1737, t1740, t1770, t1783, t1792, t1796;
  double t1798, t1803, t1804, t1806, t1812, t1813, t1815, t1817;
  double t1822, t1823, t1825, t1827, t1830, t1833, t1838, t1839;
  double t1840, t1842, t1844, t1849, t1850, t1852, t1853, t1854;
  double t1856, t1858, t1860, t1862, t1865, t1867, t1872, t1876;
  double t1877, t1878, t1879, t1881, t1884, t1885, t1887, t1889;
  double t1890, t1892, t1893, t1898, t1900, t1907, t1909, t1914;
  double t1917, t1919, t1922, t1924, t1929, t1933, t1934, t1938;
  double t1939, t1941, t1943, t1944, t1945, t1947, t1948, t1949;
  double t1950, t1952, t1953, t1955, t1956, t1957, t1958, t1962;
  double t1963, t1964, t1968, t1973, t1977, t1980, t1981, t1983;
  double t1987, t1988, t1993, t1994, t1998, t1999, t2004, t2007;
  double t2008, t2009, t2010, t2011, t2012, t2013, t2014, t2015;
  double t2016, t2017, t2019, t2024, t2026, t2028, t2033, t2034;
  double t2035, t2037, t2038, t2039, t2040, t2041, t2043, t2044;
  double t2046, t2049, t2050, t2051, t2052, tv4rho40, t2057, t2058;
  double t2059, t2061, t2064, t2069, t2071, t2072, t2073, t2074;
  double t2076, t2102, t2104, t2129, t2131, t2133, t2136, t2138;
  double t2139, t2141, t2148, t2149, t2151, t2154, t2155, t2156;
  double t2157, t2158, t2159, t2160, t2161, t2163, t2164, t2165;
  double t2166, t2167, t2168, t2169, t2172, t2173, t2182, t2185;
  double t2188, t2189, t2191, t2193, t2196, t2198, t2199, t2204;
  double t2205, t2206, t2207, t2209, t2210, t2212, t2217, t2221;
  double t2223, t2224, t2226, t2227, t2229, t2230, t2231, t2233;
  double t2234, t2235, t2237, t2238, t2239, t2240, t2242, t2247;
  double t2249, t2251, t2254, t2255, t2256, t2261, t2262, t2263;
  double t2264, t2267, t2272, t2273, t2278, tv4rho41, t2287, t2295;
  double t2304, t2310, t2337, t2363, t2365, t2369, t2370, t2372;
  double t2374, t2376, t2379, t2381, t2382, t2384, t2392, t2411;
  double t2417, t2419, t2423, t2425, t2434, t2437, t2439, t2449;
  double t2451, t2463, t2475, t2487, t2497, tv4rho42, t2502, t2527;
  double t2531, t2552, t2554, t2558, t2559, t2566, t2576, t2579;
  double t2581, t2583, t2588, t2596, t2601, t2611, t2622, t2623;
  double t2628, t2632, t2637, tv4rho43, t2645, t2652, t2658, t2666;
  double t2671, t2676, t2682, t2686, t2687, t2692, t2701, t2703;
  double t2710, t2719, t2726, t2728, t2733, t2740, t2745, t2750;
  double tv4rho44;

  lda_c_pw_params *params;

  assert(p->params != NULL);
  params = (lda_c_pw_params * )(p->params);

  t1 = params->a[0];
  t2 = params->alpha1[0];
  t3 = M_CBRT3;
  t4 = t2 * t3;
  t5 = 0.1e1 / M_PI;
  t6 = POW_1_3(t5);
  t7 = M_CBRT4;
  t8 = t7 * t7;
  t9 = t6 * t8;
  t10 = rho[0] + rho[1];
  t11 = POW_1_3(t10);
  t12 = 0.1e1 / t11;
  t13 = t9 * t12;
  t16 = 0.1e1 + t4 * t13 / 0.4e1;
  t18 = 0.1e1 / t1;
  t19 = params->beta1[0];
  t20 = t3 * t6;
  t22 = t20 * t8 * t12;
  t23 = sqrt(t22);
  t27 = params->beta2[0] * t3;
  t30 = params->beta3[0];
  t31 = POW_3_2(t22);
  t35 = t22 / 0.4e1;
  t37 = params->pp[0] + 0.1e1;
  t38 = pow(t35, t37);
  t39 = params->beta4[0] * t38;
  t40 = t19 * t23 / 0.2e1 + t27 * t13 / 0.4e1 + 0.125e0 * t30 * t31 + t39;
  t44 = 0.1e1 + t18 / t40 / 0.2e1;
  t45 = log(t44);
  t46 = t1 * t16 * t45;
  t47 = 0.2e1 * t46;
  t48 = rho[0] - rho[1];
  t49 = t48 * t48;
  t50 = t49 * t49;
  t51 = t10 * t10;
  t52 = t51 * t51;
  t53 = 0.1e1 / t52;
  t54 = t50 * t53;
  t55 = 0.1e1 / t10;
  t56 = t48 * t55;
  t57 = 0.1e1 + t56;
  t58 = t57 <= p->zeta_threshold;
  t59 = POW_1_3(p->zeta_threshold);
  t60 = t59 * p->zeta_threshold;
  t61 = POW_1_3(t57);
  t63 = my_piecewise3(t58, t60, t61 * t57);
  t64 = 0.1e1 - t56;
  t65 = t64 <= p->zeta_threshold;
  t66 = POW_1_3(t64);
  t68 = my_piecewise3(t65, t60, t66 * t64);
  t69 = t63 + t68 - 0.2e1;
  t70 = M_CBRT2;
  t73 = 0.1e1 / (0.2e1 * t70 - 0.2e1);
  t74 = t69 * t73;
  t75 = params->a[1];
  t76 = params->alpha1[1];
  t77 = t76 * t3;
  t80 = 0.1e1 + t77 * t13 / 0.4e1;
  t82 = 0.1e1 / t75;
  t83 = params->beta1[1];
  t87 = params->beta2[1] * t3;
  t90 = params->beta3[1];
  t95 = params->pp[1] + 0.1e1;
  t96 = pow(t35, t95);
  t97 = params->beta4[1] * t96;
  t98 = t83 * t23 / 0.2e1 + t87 * t13 / 0.4e1 + 0.125e0 * t90 * t31 + t97;
  t102 = 0.1e1 + t82 / t98 / 0.2e1;
  t103 = log(t102);
  t105 = params->a[2];
  t106 = params->alpha1[2];
  t107 = t106 * t3;
  t110 = 0.1e1 + t107 * t13 / 0.4e1;
  t112 = 0.1e1 / t105;
  t113 = params->beta1[2];
  t117 = params->beta2[2] * t3;
  t120 = params->beta3[2];
  t125 = params->pp[2] + 0.1e1;
  t126 = pow(t35, t125);
  t127 = params->beta4[2] * t126;
  t128 = t113 * t23 / 0.2e1 + t117 * t13 / 0.4e1 + 0.125e0 * t120 * t31 + t127;
  t132 = 0.1e1 + t112 / t128 / 0.2e1;
  t133 = log(t132);
  t134 = 0.1e1 / params->fz20;
  t135 = t133 * t134;
  t138 = -0.2e1 * t75 * t80 * t103 - 0.2e1 * t105 * t110 * t135 + 0.2e1 * t46;
  t139 = t74 * t138;
  t140 = t54 * t139;
  t143 = t110 * t133 * t134;
  t145 = 0.2e1 * t74 * t105 * t143;
  tzk0 = -t47 + t140 + t145;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t147 = t1 * t2 * t3;
  t149 = 0.1e1 / t11 / t10;
  t152 = t147 * t9 * t149 * t45;
  t153 = t152 / 0.6e1;
  t154 = t40 * t40;
  t155 = 0.1e1 / t154;
  t156 = t16 * t155;
  t157 = 0.1e1 / t23;
  t159 = t19 * t157 * t3;
  t160 = t9 * t149;
  t165 = sqrt(t22);
  t167 = t30 * t165 * t3;
  t173 = -t159 * t160 / 0.12e2 - t27 * t160 / 0.12e2 - 0.625e-1 * t167 * t160 - t39 * t37 * t55 / 0.3e1;
  t174 = 0.1e1 / t44;
  t175 = t173 * t174;
  t176 = t156 * t175;
  t177 = t49 * t48;
  t178 = t177 * t53;
  t179 = t178 * t139;
  t180 = 0.4e1 * t179;
  t181 = t52 * t10;
  t182 = 0.1e1 / t181;
  t183 = t50 * t182;
  t184 = t183 * t139;
  t185 = 0.4e1 * t184;
  t186 = 0.1e1 / t51;
  t187 = t48 * t186;
  t188 = t55 - t187;
  t191 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t188);
  t192 = -t188;
  t195 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t192);
  t197 = (t191 + t195) * t73;
  t198 = t197 * t138;
  t199 = t54 * t198;
  t201 = t75 * t76 * t3;
  t206 = t98 * t98;
  t207 = 0.1e1 / t206;
  t208 = t80 * t207;
  t210 = t83 * t157 * t3;
  t216 = t90 * t165 * t3;
  t222 = -t210 * t160 / 0.12e2 - t87 * t160 / 0.12e2 - 0.625e-1 * t216 * t160 - t97 * t95 * t55 / 0.3e1;
  t223 = 0.1e1 / t102;
  t224 = t222 * t223;
  t226 = t105 * t106;
  t227 = t226 * t20;
  t228 = t8 * t149;
  t232 = t128 * t128;
  t233 = 0.1e1 / t232;
  t234 = t110 * t233;
  t236 = t113 * t157 * t3;
  t242 = t120 * t165 * t3;
  t248 = -t236 * t160 / 0.12e2 - t117 * t160 / 0.12e2 - 0.625e-1 * t242 * t160 - t127 * t125 * t55 / 0.3e1;
  t249 = 0.1e1 / t132;
  t251 = t248 * t249 * t134;
  t253 = t201 * t9 * t149 * t103 / 0.6e1 + t208 * t224 - t153 - t176 + t227 * t228 * t135 / 0.6e1 + t234 * t251;
  t254 = t74 * t253;
  t255 = t54 * t254;
  t257 = t197 * t105 * t143;
  t258 = 0.2e1 * t257;
  t259 = t226 * t3;
  t260 = t74 * t259;
  t263 = t9 * t149 * t133 * t134;
  t264 = t260 * t263;
  t265 = t264 / 0.6e1;
  t266 = t74 * t110;
  t268 = t249 * t134;
  t269 = t233 * t248 * t268;
  t270 = t266 * t269;
  tvrho0 = -t47 + t140 + t145 + t10 * (t153 + t176 + t180 - t185 + t199 + t255 + t258 - t265 - t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t273 = -t55 - t187;
  t276 = my_piecewise3(t58, 0, 0.4e1 / 0.3e1 * t61 * t273);
  t277 = -t273;
  t280 = my_piecewise3(t65, 0, 0.4e1 / 0.3e1 * t66 * t277);
  t282 = (t276 + t280) * t73;
  t283 = t282 * t138;
  t284 = t54 * t283;
  t286 = t282 * t105 * t143;
  t287 = 0.2e1 * t286;
  tvrho1 = -t47 + t140 + t145 + t10 * (t153 + t176 - t180 - t185 + t284 + t255 + t287 - t265 - t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t290 = t152 / 0.3e1;
  t291 = 0.2e1 * t176;
  t292 = 0.8e1 * t179;
  t293 = 0.8e1 * t184;
  t295 = 0.2e1 * t255;
  t297 = t264 / 0.3e1;
  t298 = 0.2e1 * t270;
  t300 = 0.1e1 / t23 / t22;
  t302 = t3 * t3;
  t303 = t19 * t300 * t302;
  t304 = t6 * t6;
  t305 = t304 * t7;
  t306 = t11 * t11;
  t309 = t305 / t306 / t51;
  t313 = 0.1e1 / t11 / t51;
  t314 = t9 * t313;
  t319 = 0.1e1/sqrt(t22);
  t321 = t30 * t319 * t302;
  t326 = t37 * t37;
  t333 = -t303 * t309 / 0.18e2 + t159 * t314 / 0.9e1 + t27 * t314 / 0.9e1 + 0.41666666666666666666e-1 * t321 * t309 + 0.83333333333333333333e-1 * t167 * t314 + t39 * t326 * t186 / 0.9e1 + t39 * t37 * t186 / 0.3e1;
  t334 = t333 * t174;
  t335 = t156 * t334;
  t336 = t49 * t53;
  t337 = t336 * t139;
  t338 = 0.12e2 * t337;
  t339 = t177 * t182;
  t340 = t339 * t139;
  t341 = 0.32e2 * t340;
  t343 = 0.1e1 / t52 / t51;
  t344 = t50 * t343;
  t345 = t344 * t139;
  t346 = 0.2e2 * t345;
  t347 = t197 * t110;
  t348 = t347 * t269;
  t349 = 0.2e1 * t348;
  t351 = t113 * t300 * t302;
  t359 = t120 * t319 * t302;
  t364 = t125 * t125;
  t371 = -t351 * t309 / 0.18e2 + t236 * t314 / 0.9e1 + t117 * t314 / 0.9e1 + 0.41666666666666666666e-1 * t359 * t309 + 0.83333333333333333333e-1 * t242 * t314 + t127 * t364 * t186 / 0.9e1 + t127 * t125 * t186 / 0.3e1;
  t373 = t233 * t371 * t268;
  t374 = t266 * t373;
  t375 = t154 * t40;
  t376 = 0.1e1 / t375;
  t377 = t16 * t376;
  t378 = t173 * t173;
  t379 = t378 * t174;
  t380 = t377 * t379;
  t381 = 0.2e1 * t380;
  t382 = t154 * t154;
  t383 = 0.1e1 / t382;
  t384 = t16 * t383;
  t385 = t44 * t44;
  t386 = 0.1e1 / t385;
  t388 = t378 * t386 * t18;
  t389 = t384 * t388;
  t390 = t389 / 0.2e1;
  t391 = t178 * t198;
  t392 = 0.8e1 * t391;
  t393 = t178 * t254;
  t394 = 0.8e1 * t393;
  t395 = t183 * t198;
  t396 = 0.8e1 * t395;
  t397 = t335 + t338 - t341 + t346 - t349 - t374 - t381 + t390 + t392 + t394 - t396;
  t398 = t183 * t254;
  t399 = 0.8e1 * t398;
  t400 = t61 * t61;
  t401 = 0.1e1 / t400;
  t402 = t188 * t188;
  t405 = t51 * t10;
  t406 = 0.1e1 / t405;
  t407 = t48 * t406;
  t409 = -0.2e1 * t186 + 0.2e1 * t407;
  t413 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t401 * t402 + 0.4e1 / 0.3e1 * t61 * t409);
  t414 = t66 * t66;
  t415 = 0.1e1 / t414;
  t416 = t192 * t192;
  t419 = -t409;
  t423 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t415 * t416 + 0.4e1 / 0.3e1 * t66 * t419);
  t425 = (t413 + t423) * t73;
  t426 = t425 * t138;
  t427 = t54 * t426;
  t428 = t197 * t253;
  t429 = t54 * t428;
  t430 = 0.2e1 * t429;
  t435 = t77 * t9;
  t436 = t149 * t207;
  t440 = t206 * t98;
  t441 = 0.1e1 / t440;
  t442 = t80 * t441;
  t443 = t222 * t222;
  t444 = t443 * t223;
  t448 = t83 * t300 * t302;
  t456 = t90 * t319 * t302;
  t461 = t95 * t95;
  t468 = -t448 * t309 / 0.18e2 + t210 * t314 / 0.9e1 + t87 * t314 / 0.9e1 + 0.41666666666666666666e-1 * t456 * t309 + 0.83333333333333333333e-1 * t216 * t314 + t97 * t461 * t186 / 0.9e1 + t97 * t95 * t186 / 0.3e1;
  t469 = t468 * t223;
  t471 = t206 * t206;
  t472 = 0.1e1 / t471;
  t473 = t80 * t472;
  t474 = t102 * t102;
  t475 = 0.1e1 / t474;
  t477 = t443 * t475 * t82;
  t482 = t147 * t9 * t313 * t45;
  t483 = 0.2e1 / 0.9e1 * t482;
  t484 = t4 * t9;
  t485 = t149 * t155;
  t487 = t484 * t485 * t175;
  t488 = t487 / 0.6e1;
  t489 = t8 * t313;
  t493 = t107 * t9;
  t494 = t149 * t233;
  t498 = t232 * t128;
  t499 = 0.1e1 / t498;
  t500 = t110 * t499;
  t501 = t248 * t248;
  t502 = t501 * t249;
  t503 = t502 * t134;
  t506 = t371 * t249;
  t507 = t506 * t134;
  t509 = t232 * t232;
  t510 = 0.1e1 / t509;
  t511 = t110 * t510;
  t512 = t511 * t501;
  t513 = t132 * t132;
  t514 = 0.1e1 / t513;
  t515 = t514 * t134;
  t516 = t515 * t112;
  t519 = -0.2e1 / 0.9e1 * t201 * t9 * t313 * t103 - t435 * t436 * t224 / 0.6e1 - 0.2e1 * t442 * t444 + t208 * t469 + t473 * t477 / 0.2e1 + t483 + t488 + t381 - t335 - t390 - 0.2e1 / 0.9e1 * t227 * t489 * t135 - t493 * t494 * t251 / 0.6e1 - 0.2e1 * t500 * t503 + t234 * t507 + t512 * t516 / 0.2e1;
  t520 = t74 * t519;
  t521 = t54 * t520;
  t523 = t499 * t501 * t268;
  t524 = t266 * t523;
  t525 = 0.2e1 * t524;
  t526 = t74 * t511;
  t527 = t501 * t514;
  t528 = t134 * t112;
  t529 = t527 * t528;
  t530 = t526 * t529;
  t531 = t530 / 0.2e1;
  t532 = t197 * t259;
  t533 = t532 * t263;
  t534 = t533 / 0.3e1;
  t536 = t425 * t105 * t143;
  t537 = 0.2e1 * t536;
  t540 = t9 * t313 * t133 * t134;
  t541 = t260 * t540;
  t542 = 0.2e1 / 0.9e1 * t541;
  t543 = t107 * t6;
  t544 = t74 * t543;
  t545 = t228 * t233;
  t546 = t545 * t251;
  t547 = t544 * t546;
  t548 = t547 / 0.6e1;
  t549 = -t399 + t427 + t430 + t521 - t483 - t488 + t525 - t531 - t534 + t537 + t542 + t548;
  tv2rho20 = t290 + t291 + t292 - t293 + 0.2e1 * t199 + t295 + 0.4e1 * t257 - t297 - t298 + t10 * (t397 + t549);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t552 = t282 * t110;
  t553 = t552 * t269;
  t555 = t282 * t259;
  t556 = t555 * t263;
  t558 = t548 - t553 - t483 + t525 - t348 - t374 - t488 - t531 + t335 - t533 / 0.6e1 + t542 - t556 / 0.6e1 - t338;
  t559 = t178 * t283;
  t561 = t183 * t283;
  t563 = t401 * t273;
  t566 = t61 * t48;
  t570 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t563 * t188 + 0.8e1 / 0.3e1 * t566 * t406);
  t571 = t415 * t277;
  t574 = t66 * t48;
  t578 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t571 * t192 - 0.8e1 / 0.3e1 * t574 * t406);
  t580 = (t570 + t578) * t73;
  t581 = t580 * t138;
  t582 = t54 * t581;
  t586 = t580 * t105 * t143;
  t588 = t282 * t253;
  t589 = t54 * t588;
  t590 = t346 + 0.4e1 * t559 - 0.4e1 * t561 + t582 - t381 + t390 - 0.4e1 * t391 - 0.4e1 * t395 - t399 + t429 + t521 + 0.2e1 * t586 + t589;
  tv2rho21 = t290 + t291 - t293 + t199 + t295 + t258 - t297 - t298 + t284 + t287 + t10 * (t558 + t590);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t595 = t273 * t273;
  t599 = 0.2e1 * t186 + 0.2e1 * t407;
  t603 = my_piecewise3(t58, 0, 0.4e1 / 0.9e1 * t401 * t595 + 0.4e1 / 0.3e1 * t61 * t599);
  t604 = t277 * t277;
  t607 = -t599;
  t611 = my_piecewise3(t65, 0, 0.4e1 / 0.9e1 * t415 * t604 + 0.4e1 / 0.3e1 * t66 * t607);
  t613 = (t603 + t611) * t73;
  t614 = t613 * t138;
  t615 = t54 * t614;
  t617 = t613 * t105 * t143;
  t618 = 0.2e1 * t617;
  t619 = t615 + t618 + t335 + t338 + t341 + t346 - t374 - t381 + t390 - t394 - t399;
  t620 = t556 / 0.3e1;
  t621 = 0.8e1 * t559;
  t622 = 0.8e1 * t561;
  t623 = 0.2e1 * t589;
  t624 = 0.2e1 * t553;
  t625 = t521 - t483 - t488 + t525 - t531 - t620 - t621 - t622 + t623 + t542 + t548 - t624;
  tv2rho22 = t290 + t291 - t292 - t293 + 0.2e1 * t284 + t295 + 0.4e1 * t286 - t297 - t298 + t10 * (t619 + t625);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t629 = t20 * t8;
  t630 = t74 * t106 * t629;
  t631 = t149 * t510;
  t633 = t631 * t501 * t516;
  t634 = t630 * t633;
  t635 = t634 / 0.8e1;
  t636 = t197 * t543;
  t637 = t636 * t546;
  t638 = t637 / 0.2e1;
  t639 = t545 * t507;
  t640 = t544 * t639;
  t641 = t640 / 0.4e1;
  t643 = t228 * t499 * t503;
  t644 = t544 * t643;
  t645 = t644 / 0.2e1;
  t646 = t489 * t233;
  t647 = t646 * t251;
  t648 = t544 * t647;
  t649 = t648 / 0.3e1;
  t651 = 0.1e1 / t11 / t405;
  t654 = t147 * t9 * t651 * t45;
  t655 = 0.14e2 / 0.27e2 * t654;
  t656 = t425 * t259;
  t657 = t656 * t263;
  t659 = t532 * t540;
  t660 = 0.2e1 / 0.3e1 * t659;
  t663 = t9 * t651 * t133 * t134;
  t664 = t260 * t663;
  t665 = 0.14e2 / 0.27e2 * t664;
  t672 = 0.1e1 / t23 / t302 / t304 / t7 * t306 / 0.4e1;
  t673 = t19 * t672;
  t674 = t5 * t53;
  t679 = t305 / t306 / t405;
  t682 = t9 * t651;
  t687 = 0.1e1/POW_3_2(t22);
  t688 = t30 * t687;
  t695 = t326 * t37;
  t705 = -t673 * t674 / 0.3e1 + 0.2e1 / 0.9e1 * t303 * t679 - 0.7e1 / 0.27e2 * t159 * t682 - 0.7e1 / 0.27e2 * t27 * t682 + 0.83333333333333333332e-1 * t688 * t674 - 0.16666666666666666666e0 * t321 * t679 - 0.19444444444444444444e0 * t167 * t682 - t39 * t695 * t406 / 0.27e2 - t39 * t326 * t406 / 0.3e1 - 0.2e1 / 0.3e1 * t39 * t37 * t406;
  t706 = t705 * t174;
  t707 = t156 * t706;
  t708 = t378 * t173;
  t709 = t708 * t174;
  t710 = t384 * t709;
  t711 = 0.6e1 * t710;
  t712 = t48 * t53;
  t713 = t712 * t139;
  t714 = 0.24e2 * t713;
  t715 = t635 + t638 + t641 - t645 - t649 + t655 - t657 / 0.2e1 + t660 - t665 + t707 + t711 + t714;
  t716 = t49 * t182;
  t717 = t716 * t139;
  t718 = 0.144e3 * t717;
  t719 = t336 * t254;
  t720 = 0.36e2 * t719;
  t722 = 0.1e1 / t52 / t405;
  t723 = t50 * t722;
  t724 = t723 * t139;
  t725 = 0.12e3 * t724;
  t726 = t177 * t343;
  t727 = t726 * t139;
  t728 = 0.24e3 * t727;
  t730 = t386 * t18;
  t731 = t730 * t173;
  t732 = t384 * t333 * t731;
  t733 = 0.3e1 / 0.2e1 * t732;
  t734 = t344 * t254;
  t735 = 0.6e2 * t734;
  t736 = t339 * t198;
  t737 = 0.96e2 * t736;
  t738 = t339 * t254;
  t739 = 0.96e2 * t738;
  t740 = t336 * t198;
  t741 = 0.36e2 * t740;
  t742 = t344 * t198;
  t743 = 0.6e2 * t742;
  t744 = t178 * t426;
  t746 = t178 * t428;
  t747 = 0.24e2 * t746;
  t748 = t178 * t520;
  t749 = 0.12e2 * t748;
  t750 = -t718 + t720 - t725 + t728 + t733 + t735 - t737 - t739 + t741 + t743 + 0.12e2 * t744 + t747 + t749;
  t752 = t183 * t428;
  t753 = 0.24e2 * t752;
  t754 = t183 * t520;
  t755 = 0.12e2 * t754;
  t756 = t183 * t426;
  t758 = t425 * t253;
  t759 = t54 * t758;
  t761 = t197 * t519;
  t762 = t54 * t761;
  t763 = 0.3e1 * t762;
  t765 = 0.1e1 / t400 / t57;
  t766 = t402 * t188;
  t769 = t401 * t188;
  t773 = 0.6e1 * t406 - 0.6e1 * t712;
  t777 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t765 * t766 + 0.4e1 / 0.3e1 * t769 * t409 + 0.4e1 / 0.3e1 * t61 * t773);
  t779 = 0.1e1 / t414 / t64;
  t780 = t416 * t192;
  t783 = t415 * t192;
  t786 = -t773;
  t790 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t779 * t780 + 0.4e1 / 0.3e1 * t783 * t419 + 0.4e1 / 0.3e1 * t66 * t786);
  t792 = (t777 + t790) * t73;
  t793 = t792 * t138;
  t794 = t54 * t793;
  t795 = t334 * t173;
  t796 = t377 * t795;
  t797 = 0.6e1 * t796;
  t799 = 0.1e1 / t382 / t154;
  t800 = t16 * t799;
  t802 = 0.1e1 / t385 / t44;
  t804 = t1 * t1;
  t805 = 0.1e1 / t804;
  t806 = t708 * t802 * t805;
  t807 = t800 * t806;
  t808 = t807 / 0.2e1;
  t810 = 0.1e1 / t382 / t40;
  t811 = t16 * t810;
  t813 = t708 * t386 * t18;
  t814 = t811 * t813;
  t815 = 0.3e1 * t814;
  t817 = t792 * t105 * t143;
  t818 = 0.2e1 * t817;
  t820 = 0.1e1 / t509 / t128;
  t821 = t110 * t820;
  t822 = t74 * t821;
  t823 = t501 * t248;
  t825 = t823 * t514 * t528;
  t826 = t822 * t825;
  t827 = 0.3e1 * t826;
  t829 = 0.1e1 / t509 / t232;
  t830 = t110 * t829;
  t831 = t74 * t830;
  t833 = 0.1e1 / t513 / t132;
  t835 = t105 * t105;
  t836 = 0.1e1 / t835;
  t837 = t134 * t836;
  t838 = t823 * t833 * t837;
  t839 = t831 * t838;
  t840 = t839 / 0.2e1;
  t841 = -t753 - t755 - 0.12e2 * t756 + 0.3e1 * t759 + t763 + t794 - t797 + t808 - t815 + t818 + t827 - t840;
  t842 = t313 * t155;
  t844 = t484 * t842 * t175;
  t845 = t844 / 0.3e1;
  t846 = t149 * t376;
  t848 = t484 * t846 * t379;
  t849 = t848 / 0.2e1;
  t851 = t484 * t485 * t334;
  t852 = t851 / 0.4e1;
  t853 = t197 * t511;
  t854 = t853 * t529;
  t855 = 0.3e1 / 0.2e1 * t854;
  t856 = t74 * t500;
  t857 = t134 * t248;
  t858 = t506 * t857;
  t859 = t856 * t858;
  t860 = 0.6e1 * t859;
  t862 = t510 * t823 * t268;
  t863 = t266 * t862;
  t864 = 0.6e1 * t863;
  t865 = t347 * t523;
  t866 = 0.6e1 * t865;
  t867 = t113 * t672;
  t876 = t120 * t687;
  t883 = t364 * t125;
  t893 = -t867 * t674 / 0.3e1 + 0.2e1 / 0.9e1 * t351 * t679 - 0.7e1 / 0.27e2 * t236 * t682 - 0.7e1 / 0.27e2 * t117 * t682 + 0.83333333333333333332e-1 * t876 * t674 - 0.16666666666666666666e0 * t359 * t679 - 0.19444444444444444444e0 * t242 * t682 - t127 * t883 * t406 / 0.27e2 - t127 * t364 * t406 / 0.3e1 - 0.2e1 / 0.3e1 * t127 * t125 * t406;
  t895 = t233 * t893 * t268;
  t896 = t266 * t895;
  t897 = t347 * t373;
  t898 = 0.3e1 * t897;
  t899 = t425 * t110;
  t900 = t899 * t269;
  t908 = t515 * t112 * t248;
  t911 = t83 * t672;
  t920 = t90 * t687;
  t927 = t461 * t95;
  t937 = -t911 * t674 / 0.3e1 + 0.2e1 / 0.9e1 * t448 * t679 - 0.7e1 / 0.27e2 * t210 * t682 - 0.7e1 / 0.27e2 * t87 * t682 + 0.83333333333333333332e-1 * t920 * t674 - 0.16666666666666666666e0 * t456 * t679 - 0.19444444444444444444e0 * t216 * t682 - t97 * t927 * t406 / 0.27e2 - t97 * t461 * t406 / 0.3e1 - 0.2e1 / 0.3e1 * t97 * t95 * t406;
  t938 = t937 * t223;
  t940 = t443 * t222;
  t941 = t940 * t223;
  t944 = t107 * t160;
  t946 = t510 * t501 * t516;
  t950 = t475 * t82;
  t951 = t950 * t222;
  t955 = t833 * t134;
  t956 = t955 * t836;
  t965 = -t655 + 0.14e2 / 0.27e2 * t201 * t9 * t651 * t103 + 0.3e1 / 0.2e1 * t511 * t371 * t908 + t208 * t938 + 0.6e1 * t473 * t941 - t944 * t946 / 0.8e1 - t707 - t711 - t733 + 0.3e1 / 0.2e1 * t473 * t468 * t951 + t797 - t808 + t815 + t830 * t823 * t956 / 0.2e1 - 0.6e1 * t500 * t248 * t507 - 0.3e1 * t821 * t823 * t516;
  t967 = 0.1e1 / t471 / t98;
  t968 = t80 * t967;
  t970 = t940 * t475 * t82;
  t973 = t224 * t468;
  t976 = t313 * t207;
  t983 = t149 * t441;
  t987 = t8 * t651;
  t991 = t893 * t249;
  t992 = t991 * t134;
  t995 = t823 * t249 * t134;
  t999 = 0.1e1 / t471 / t206;
  t1000 = t80 * t999;
  t1002 = 0.1e1 / t474 / t102;
  t1004 = t75 * t75;
  t1005 = 0.1e1 / t1004;
  t1006 = t940 * t1002 * t1005;
  t1009 = t149 * t499;
  t1013 = t149 * t383;
  t1015 = t484 * t1013 * t388;
  t1016 = t1015 / 0.8e1;
  t1017 = t149 * t472;
  t1021 = t313 * t233;
  t1028 = -0.3e1 * t968 * t970 - 0.6e1 * t442 * t973 - t845 + t435 * t976 * t224 / 0.3e1 - t435 * t436 * t469 / 0.4e1 - t849 + t852 + t435 * t983 * t444 / 0.2e1 + 0.14e2 / 0.27e2 * t227 * t987 * t135 + t234 * t992 + 0.6e1 * t511 * t995 + t1000 * t1006 / 0.2e1 + t493 * t1009 * t503 / 0.2e1 + t1016 - t435 * t1017 * t477 / 0.8e1 + t493 * t1021 * t251 / 0.3e1 - t493 * t494 * t507 / 0.4e1;
  t1029 = t965 + t1028;
  t1030 = t74 * t1029;
  t1031 = t54 * t1030;
  t1033 = t528 * t248;
  t1034 = t371 * t514 * t1033;
  t1035 = t526 * t1034;
  t1036 = 0.3e1 / 0.2e1 * t1035;
  t1037 = t845 + t849 - t852 - t855 + t860 - t864 + t866 - t896 - t898 - 0.3e1 * t900 + t1031 - t1016 - t1036;
  t1041 = 0.3e1 * t335;
  t1042 = 0.36e2 * t337;
  t1043 = 0.96e2 * t340;
  t1044 = 0.6e2 * t345;
  t1046 = 0.3e1 * t374;
  t1047 = 0.6e1 * t380;
  t1048 = 0.3e1 / 0.2e1 * t389;
  t1050 = 0.24e2 * t393;
  t1052 = t10 * (t715 + t750 + t841 + t1037) + t1041 + t1042 - t1043 + t1044 - 0.6e1 * t348 - t1046 - t1047 + t1048 + 0.24e2 * t391 + t1050 - 0.24e2 * t395;
  t1053 = 0.24e2 * t398;
  t1056 = 0.3e1 * t521;
  t1057 = 0.2e1 / 0.3e1 * t482;
  t1058 = t487 / 0.2e1;
  t1059 = 0.6e1 * t524;
  t1060 = 0.3e1 / 0.2e1 * t530;
  t1062 = 0.2e1 / 0.3e1 * t541;
  t1063 = t547 / 0.2e1;
  t1064 = -t1053 + 0.3e1 * t427 + 0.6e1 * t429 + t1056 - t1057 - t1058 + t1059 - t1060 - t533 + 0.6e1 * t536 + t1062 + t1063;
  tv3rho30 = t1052 + t1064;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1065 = t282 * t543;
  t1066 = t1065 * t546;
  t1069 = t555 * t540;
  t1071 = t580 * t259;
  t1072 = t1071 * t263;
  t1073 = t1072 / 0.3e1;
  t1076 = t765 * t273;
  t1079 = t401 * t48;
  t1090 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t1076 * t402 + 0.16e2 / 0.9e1 * t1079 * t406 * t188 + 0.4e1 / 0.9e1 * t563 * t409 + 0.8e1 / 0.3e1 * t61 * t406 - 0.8e1 * t566 * t53);
  t1091 = t779 * t277;
  t1094 = t415 * t48;
  t1105 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1091 * t416 - 0.16e2 / 0.9e1 * t1094 * t406 * t192 + 0.4e1 / 0.9e1 * t571 * t419 - 0.8e1 / 0.3e1 * t66 * t406 + 0.8e1 * t574 * t53);
  t1107 = (t1090 + t1105) * t73;
  t1109 = t1107 * t105 * t143;
  t1111 = t339 * t283;
  t1113 = t178 * t581;
  t1114 = 0.8e1 * t1113;
  t1115 = t178 * t588;
  t1117 = t635 + t1066 / 0.6e1 + t637 / 0.3e1 + t641 - t645 - t649 + t655 + 0.2e1 / 0.9e1 * t1069 - t1073 - t657 / 0.6e1 + 0.4e1 / 0.9e1 * t659 - t665 + 0.2e1 * t1109 - 0.32e2 * t1111 + t1114 + 0.8e1 * t1115;
  t1118 = t183 * t581;
  t1119 = 0.8e1 * t1118;
  t1120 = t183 * t588;
  t1122 = t344 * t283;
  t1124 = t336 * t283;
  t1126 = t1107 * t138;
  t1127 = t54 * t1126;
  t1128 = t580 * t253;
  t1129 = t54 * t1128;
  t1130 = 0.2e1 * t1129;
  t1131 = t282 * t519;
  t1132 = t54 * t1131;
  t1133 = 0.48e2 * t717;
  t1134 = 0.12e2 * t719;
  t1135 = 0.8e2 * t727;
  t1136 = -t1119 - 0.8e1 * t1120 + 0.2e2 * t1122 + 0.12e2 * t1124 + t1127 + t1130 + t1132 + t707 + t711 - t714 + t1133 - t1134 - t725 + t1135 + t733 + t735;
  t1138 = 0.32e2 * t738;
  t1139 = 0.24e2 * t740;
  t1142 = 0.4e1 * t748;
  t1146 = t552 * t523;
  t1148 = t580 * t110;
  t1149 = t1148 * t269;
  t1150 = 0.2e1 * t1149;
  t1151 = t552 * t373;
  t1152 = -t1138 - t1139 + 0.4e2 * t742 - 0.4e1 * t744 + t1142 - 0.16e2 * t752 - t755 - 0.4e1 * t756 + t759 + 0.2e1 * t762 + 0.2e1 * t1146 - t1150 - t1151 - t797 + t808 - t815;
  t1153 = t282 * t511;
  t1154 = t1153 * t529;
  t1158 = t827 - t840 + t845 + t849 - t852 - t854 + t860 - t1154 / 0.2e1 - t864 + 0.4e1 * t865 - t896 - 0.2e1 * t897 - t900 + t1031 - t1016 - t1036;
  t1164 = t10 * (t1117 + t1136 + t1152 + t1158) + t1063 + t537 - t624 - t1057 + t1059 - 0.4e1 * t348 - t1046 - t1058 - t1060 + t1041 - 0.2e1 / 0.3e1 * t533 + t1062 - t620 - t338;
  t1165 = 0.2e1 * t582;
  t1168 = 0.4e1 * t586;
  t1169 = -t341 + t1044 + t621 - t622 + t1165 - t1047 + t1048 + t394 - 0.16e2 * t395 - t1053 + t427 + 0.4e1 * t429 + t1056 + t1168 + t623;
  tv3rho31 = t1164 + t1169;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1171 = t765 * t595;
  t1176 = t401 * t599;
  t1181 = -0.2e1 * t406 - 0.6e1 * t712;
  t1185 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t1171 * t188 + 0.16e2 / 0.9e1 * t563 * t407 + 0.4e1 / 0.9e1 * t1176 * t188 + 0.4e1 / 0.3e1 * t61 * t1181);
  t1186 = t779 * t604;
  t1191 = t415 * t607;
  t1194 = -t1181;
  t1198 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t1186 * t192 - 0.16e2 / 0.9e1 * t571 * t407 + 0.4e1 / 0.9e1 * t1191 * t192 + 0.4e1 / 0.3e1 * t66 * t1194);
  t1200 = (t1185 + t1198) * t73;
  t1202 = t1200 * t105 * t143;
  t1207 = t613 * t259;
  t1208 = t1207 * t263;
  t1212 = 0.2e1 * t1202 + t635 + t1066 / 0.3e1 + t637 / 0.6e1 + t641 - t645 - t649 + t655 + 0.4e1 / 0.9e1 * t1069 - t1208 / 0.6e1 - t1073 + 0.2e1 / 0.9e1 * t659 - t665 - t1114 - t1119 - 0.16e2 * t1120;
  t1214 = 0.24e2 * t1124;
  t1215 = t613 * t110;
  t1216 = t1215 * t269;
  t1219 = 0.4e2 * t1122 - t1214 + t1130 - t1216 + 0.2e1 * t1132 + t707 + t711 + t714 + t1133 - t1134 - t725 - t1135 + t733 + t735 + 0.32e2 * t736 + t1138;
  t1227 = 0.12e2 * t740 + 0.2e2 * t742 - 0.8e1 * t746 - t1142 - 0.8e1 * t752 - t755 + t762 + 0.4e1 * t1146 - t1150 - 0.2e1 * t1151 - t797 + t808 - t815 + t827 - t840 + t845;
  t1230 = t1200 * t138;
  t1231 = t54 * t1230;
  t1232 = t613 * t253;
  t1233 = t54 * t1232;
  t1234 = t178 * t614;
  t1236 = t183 * t614;
  t1238 = t849 - t852 - t854 / 0.2e1 + t860 - t1154 - t864 + 0.2e1 * t865 - t896 - t897 + t1231 + t1233 + 0.4e1 * t1234 - 0.4e1 * t1236 + t1031 - t1016 - t1036;
  t1243 = t1063 - 0.4e1 * t553 - t1057 + t1059 - t349 - t1046 - t1058 - t1060 + t1041 + t10 * (t1212 + t1219 + t1227 + t1238) - t534 + t1062 - 0.2e1 / 0.3e1 * t556 - t338 + t341;
  t1246 = t1044 - 0.16e2 * t561 + t1165 - t1047 + t1048 - t392 - t394 - t396 - t1053 + t430 + t1056 + t1168 + 0.4e1 * t589 + t615 + t618;
  tv3rho32 = t1243 + t1246;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1247 = t1066 / 0.2e1;
  t1248 = 0.2e1 / 0.3e1 * t1069;
  t1250 = 0.96e2 * t1111;
  t1251 = 0.24e2 * t1115;
  t1252 = 0.24e2 * t1120;
  t1253 = t635 + t1247 + t641 - t645 - t649 + t655 + t1248 - t1208 / 0.2e1 - t665 + t1250 - t1251 - t1252;
  t1254 = 0.6e2 * t1122;
  t1255 = 0.36e2 * t1124;
  t1256 = t595 * t273;
  t1262 = -0.6e1 * t406 - 0.6e1 * t712;
  t1266 = my_piecewise3(t58, 0, -0.8e1 / 0.27e2 * t765 * t1256 + 0.4e1 / 0.3e1 * t563 * t599 + 0.4e1 / 0.3e1 * t61 * t1262);
  t1267 = t604 * t277;
  t1272 = -t1262;
  t1276 = my_piecewise3(t65, 0, -0.8e1 / 0.27e2 * t779 * t1267 + 0.4e1 / 0.3e1 * t571 * t607 + 0.4e1 / 0.3e1 * t66 * t1272);
  t1278 = (t1266 + t1276) * t73;
  t1279 = t1278 * t138;
  t1280 = t54 * t1279;
  t1282 = 0.3e1 * t1132;
  t1284 = t1278 * t105 * t143;
  t1285 = 0.2e1 * t1284;
  t1286 = t1254 + t1255 + t1280 - 0.3e1 * t1216 + t1282 + t707 + t711 + t1285 - t714 - t718 + t720 - t725 - t728;
  t1288 = 0.6e1 * t1146;
  t1289 = 0.3e1 * t1151;
  t1290 = t733 + t735 + t739 - t749 - t755 + t1288 - t1289 - t797 + t808 - t815 + t827 - t840;
  t1291 = 0.3e1 / 0.2e1 * t1154;
  t1295 = t845 + t849 - t852 + t860 - t1291 - t864 - t896 + 0.3e1 * t1233 - 0.12e2 * t1234 - 0.12e2 * t1236 + t1031 - t1016 - t1036;
  t1301 = t10 * (t1253 + t1286 + t1290 + t1295) + 0.3e1 * t615 + 0.6e1 * t617 + t1041 + t1042 + t1043 + t1044 - t1046 - t1047 + t1048 - t1050 - t1053;
  t1306 = t1056 - t1057 - t1058 + t1059 - t1060 - t556 - 0.24e2 * t559 - 0.24e2 * t561 + 0.6e1 * t589 + t1062 + t1063 - 0.6e1 * t553;
  tv3rho33 = t1301 + t1306;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1307 = t634 / 0.2e1;
  t1309 = 0.2e1 * t644;
  t1310 = 0.4e1 / 0.3e1 * t648;
  t1315 = t630 * t313 * t510 * t501 * t516 / 0.3e1;
  t1319 = 0.2e1 * t630 * t1009 * t371 * t251;
  t1324 = t630 * t149 * t829 * t823 * t956 / 0.6e1;
  t1327 = t197 * t106 * t629 * t633;
  t1332 = t630 * t149 * t820 * t823 * t516;
  t1333 = t57 * t57;
  t1335 = 0.1e1 / t400 / t1333;
  t1336 = t402 * t402;
  t1342 = t409 * t409;
  t1347 = t48 * t182;
  t1349 = -0.24e2 * t53 + 0.24e2 * t1347;
  t1353 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t1335 * t1336 - 0.16e2 / 0.9e1 * t765 * t402 * t409 + 0.4e1 / 0.3e1 * t401 * t1342 + 0.16e2 / 0.9e1 * t769 * t773 + 0.4e1 / 0.3e1 * t61 * t1349);
  t1354 = t64 * t64;
  t1356 = 0.1e1 / t414 / t1354;
  t1357 = t416 * t416;
  t1363 = t419 * t419;
  t1372 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t1356 * t1357 - 0.16e2 / 0.9e1 * t779 * t416 * t419 + 0.4e1 / 0.3e1 * t415 * t1363 + 0.16e2 / 0.9e1 * t783 * t786 - 0.4e1 / 0.3e1 * t66 * t1349);
  t1374 = (t1353 + t1372) * t73;
  t1379 = 0.1e1 / t11 / t52;
  t1383 = 0.14e3 / 0.81e2 * t147 * t9 * t1379 * t45;
  t1385 = t54 * t197 * t1029;
  t1408 = t484 * t149 * t799 * t806 / 0.6e1;
  t1411 = t484 * t149 * t810 * t813;
  t1414 = t515 * t371 * t112;
  t1417 = t509 * t509;
  t1419 = t110 / t1417;
  t1420 = t501 * t501;
  t1422 = t513 * t513;
  t1423 = 0.1e1 / t1422;
  t1426 = 0.1e1 / t835 / t105;
  t1440 = t110 / t509 / t498;
  t1456 = 0.36e2 * t473 * t444 * t468 + t1383 - 0.14e3 / 0.81e2 * t201 * t9 * t1379 * t103 + 0.2e1 * t511 * t893 * t908 + 0.3e1 * t830 * t501 * t955 * t836 * t371 - 0.8e1 * t442 * t224 * t937 + t1408 - t1411 - 0.18e2 * t821 * t501 * t1414 + 0.3e1 / 0.4e1 * t1419 * t1420 * t1423 * t134 * t1426 - 0.8e1 * t500 * t893 * t251 + 0.18e2 * t830 * t1420 * t516 + 0.36e2 * t512 * t507 - 0.6e1 * t1440 * t1420 * t956 - 0.18e2 * t968 * t443 * t950 * t468 + 0.3e1 * t1000 * t443 * t1002 * t1005 * t468 + 0.2e1 * t473 * t937 * t951;
  t1470 = 0.2e1 * t484 * t846 * t795;
  t1474 = t484 * t313 * t383 * t388 / 0.3e1;
  t1498 = 0.1e1 / t23 / t5 / t55 / 0.48e2;
  t1504 = 0.1e1 / t11 / t181 * t3 * t9;
  t1507 = t5 * t182;
  t1512 = t305 / t306 / t52;
  t1515 = t9 * t1379;
  t1520 = pow(t22, -0.25e1);
  t1531 = t461 * t461;
  t1544 = -0.5e1 / 0.18e2 * t83 * t1498 * t5 * t1504 + 0.8e1 / 0.3e1 * t911 * t1507 - 0.8e2 / 0.81e2 * t448 * t1512 + 0.7e2 / 0.81e2 * t210 * t1515 + 0.7e2 / 0.81e2 * t87 * t1515 + 0.41666666666666666666e-1 * t90 * t1520 * t5 * t1504 - 0.66666666666666666665e0 * t920 * t1507 + 0.74074074074074074072e0 * t456 * t1512 + 0.64814814814814814813e0 * t216 * t1515 + t97 * t1531 * t53 / 0.81e2 + 0.2e1 / 0.9e1 * t97 * t927 * t53 + 0.11e2 / 0.9e1 * t97 * t461 * t53 + 0.2e1 * t97 * t95 * t53;
  t1547 = t468 * t468;
  t1551 = t443 * t443;
  t1555 = t371 * t371;
  t1567 = -0.4e1 / 0.3e1 * t493 * t313 * t499 * t503 - 0.28e2 / 0.27e2 * t493 * t651 * t233 * t251 + 0.2e1 / 0.3e1 * t493 * t1021 * t507 - t1470 - t1474 + t435 * t313 * t472 * t477 / 0.3e1 - t493 * t494 * t992 / 0.3e1 - 0.2e1 * t493 * t631 * t995 - t435 * t149 * t999 * t1006 / 0.6e1 + t435 * t149 * t967 * t970 + 0.2e1 * t435 * t983 * t973 + t208 * t1544 * t223 - 0.6e1 * t442 * t1547 * t223 - 0.24e2 * t968 * t1551 * t223 + 0.3e1 / 0.2e1 * t511 * t1555 * t516 + t107 * t314 * t946 / 0.3e1 - t77 * t160 * t472 * t468 * t951 / 0.2e1;
  t1584 = t4 * t160 * t383 * t333 * t731 / 0.2e1;
  t1588 = t378 * t378;
  t1592 = 0.6e1 * t16 / t382 / t375 * t1588 * t802 * t805;
  t1593 = t382 * t382;
  t1596 = t385 * t385;
  t1603 = 0.3e1 / 0.4e1 * t16 / t1593 * t1588 / t1596 / t804 / t1;
  t1607 = 0.18e2 * t800 * t1588 * t386 * t18;
  t1610 = 0.36e2 * t384 * t379 * t333;
  t1611 = t333 * t333;
  t1615 = 0.3e1 / 0.2e1 * t384 * t1611 * t386 * t18;
  t1618 = 0.8e1 * t377 * t706 * t173;
  t1641 = t326 * t326;
  t1654 = -0.5e1 / 0.18e2 * t19 * t1498 * t5 * t1504 + 0.8e1 / 0.3e1 * t673 * t1507 - 0.8e2 / 0.81e2 * t303 * t1512 + 0.7e2 / 0.81e2 * t159 * t1515 + 0.7e2 / 0.81e2 * t27 * t1515 + 0.41666666666666666666e-1 * t30 * t1520 * t5 * t1504 - 0.66666666666666666665e0 * t688 * t1507 + 0.74074074074074074072e0 * t321 * t1512 + 0.64814814814814814813e0 * t167 * t1515 + t39 * t1641 * t53 / 0.81e2 + 0.2e1 / 0.9e1 * t39 * t695 * t53 + 0.11e2 / 0.9e1 * t39 * t326 * t53 + 0.2e1 * t39 * t37 * t53;
  t1656 = t156 * t1654 * t174;
  t1659 = 0.24e2 * t811 * t1588 * t174;
  t1664 = 0.3e1 * t800 * t378 * t802 * t805 * t333;
  t1668 = 0.18e2 * t811 * t378 * t730 * t333;
  t1671 = 0.2e1 * t384 * t705 * t731;
  t1674 = 0.6e1 * t377 * t1611 * t174;
  t1677 = 0.2e1 / 0.3e1 * t484 * t842 * t334;
  t1678 = t944 * t820 * t823 * t516 - t944 * t829 * t823 * t956 / 0.6e1 + 0.2e1 * t944 * t499 * t248 * t507 + t1584 + t1592 - t1603 - t1607 - t1610 - t1615 + t1618 - t1656 + t1659 - t1664 + t1668 - t1671 + t1674 - t1677;
  t1695 = 0.2e1 * t484 * t1013 * t709;
  t1699 = 0.4e1 / 0.3e1 * t484 * t313 * t376 * t379;
  t1706 = t484 * t485 * t706 / 0.3e1;
  t1713 = 0.28e2 / 0.27e2 * t484 * t651 * t155 * t175;
  t1737 = t471 * t471;
  t1740 = t474 * t474;
  t1770 = t364 * t364;
  t1783 = -0.5e1 / 0.18e2 * t113 * t1498 * t5 * t1504 + 0.8e1 / 0.3e1 * t867 * t1507 - 0.8e2 / 0.81e2 * t351 * t1512 + 0.7e2 / 0.81e2 * t236 * t1515 + 0.7e2 / 0.81e2 * t117 * t1515 + 0.41666666666666666666e-1 * t120 * t1520 * t5 * t1504 - 0.66666666666666666665e0 * t876 * t1507 + 0.74074074074074074072e0 * t359 * t1512 + 0.64814814814814814813e0 * t242 * t1515 + t127 * t1770 * t53 / 0.81e2 + 0.2e1 / 0.9e1 * t127 * t883 * t53 + 0.11e2 / 0.9e1 * t127 * t364 * t53 + 0.2e1 * t127 * t125 * t53;
  t1792 = -0.28e2 / 0.27e2 * t435 * t651 * t207 * t224 - t435 * t436 * t938 / 0.3e1 - 0.2e1 * t435 * t1017 * t941 - 0.14e3 / 0.81e2 * t227 * t8 * t1379 * t135 + t1695 + t1699 - 0.4e1 / 0.3e1 * t435 * t313 * t441 * t444 + t1706 + 0.2e1 / 0.3e1 * t435 * t976 * t469 + t1713 - 0.6e1 * t500 * t1555 * t249 * t134 - 0.6e1 * t80 / t471 / t440 * t1551 * t1002 * t1005 - 0.24e2 * t821 * t1420 * t249 * t134 + 0.3e1 / 0.2e1 * t473 * t1547 * t475 * t82 + 0.18e2 * t1000 * t1551 * t475 * t82 + 0.3e1 / 0.4e1 * t80 / t1737 * t1551 / t1740 / t1004 / t75 + t234 * t1783 * t249 * t134 - t944 * t510 * t371 * t514 * t1033 / 0.2e1;
  t1796 = t54 * t74 * (t1456 + t1567 + t1678 + t1792);
  t1798 = t792 * t110 * t269;
  t1803 = 0.24e2 * t53 * t69 * t73 * t138;
  t1804 = -t1315 - t1319 + t1324 + t1327 / 0.2e1 - t1332 + 0.2e1 * t1374 * t105 * t143 - t1383 + 0.4e1 * t1385 + t1796 - 0.4e1 * t1798 + t1803 - t1408;
  t1806 = t792 * t259 * t263;
  t1812 = 0.14e3 / 0.81e2 * t260 * t9 * t1379 * t133 * t134;
  t1813 = t532 * t663;
  t1815 = t656 * t540;
  t1817 = t853 * t1034;
  t1822 = 0.2e1 * t526 * t893 * t514 * t1033;
  t1823 = t1411 + t1470 + t1474 - 0.2e1 / 0.3e1 * t1806 + t1812 - 0.56e2 / 0.27e2 * t1813 + 0.4e1 / 0.3e1 * t1815 - t1584 - 0.6e1 * t1817 - t1822 - t1592 + t1603 + t1607;
  t1825 = t183 * t761;
  t1827 = t178 * t761;
  t1830 = t54 * t425 * t519;
  t1833 = t54 * t792 * t253;
  t1838 = t630 * t631 * t248 * t1414 / 0.2e1;
  t1839 = t1610 + t1615 - t1618 - 0.48e2 * t1825 + 0.48e2 * t1827 + 0.6e1 * t1830 + t1656 - t1659 + 0.4e1 * t1833 + t1664 - t1668 + t1838;
  t1840 = t183 * t758;
  t1842 = t178 * t793;
  t1844 = t183 * t793;
  t1849 = 0.12e3 * t344 * t520;
  t1850 = t178 * t758;
  t1852 = t339 * t520;
  t1853 = 0.192e3 * t1852;
  t1854 = t339 * t428;
  t1856 = t344 * t428;
  t1858 = t339 * t426;
  t1860 = t344 * t426;
  t1862 = t54 * t1374 * t138 + t1671 - t1674 - 0.48e2 * t1840 + 0.16e2 * t1842 - 0.16e2 * t1844 + t1849 + 0.48e2 * t1850 - t1853 - 0.384e3 * t1854 + 0.24e3 * t1856 - 0.192e3 * t1858 + 0.12e3 * t1860;
  t1865 = t899 * t523;
  t1867 = t347 * t862;
  t1872 = 0.6e1 * t266 * t499 * t1555 * t268;
  t1876 = 0.24e2 * t266 * t820 * t1420 * t268;
  t1877 = t336 * t520;
  t1878 = 0.72e2 * t1877;
  t1879 = t336 * t428;
  t1881 = t336 * t426;
  t1884 = 0.48e3 * t723 * t254;
  t1885 = t726 * t198;
  t1887 = t723 * t198;
  t1889 = t726 * t254;
  t1890 = 0.96e3 * t1889;
  t1892 = 0.16e2 * t183 * t1030;
  t1893 = 0.12e2 * t1865 - 0.24e2 * t1867 + t1872 + t1876 + t1878 + 0.144e3 * t1879 + 0.72e2 * t1881 - t1884 + 0.96e3 * t1885 - 0.48e3 * t1887 + t1890 - t1892;
  t1898 = 0.6e1 * t74 * t1440 * t1420 * t833 * t837;
  t1900 = t197 * t830 * t838;
  t1907 = 0.3e1 / 0.4e1 * t74 * t1419 * t1420 * t1423 * t134 * t1426;
  t1909 = t197 * t821 * t825;
  t1914 = 0.18e2 * t831 * t1420 * t514 * t528;
  t1917 = 0.8e1 * t856 * t991 * t857;
  t1919 = t197 * t500 * t858;
  t1922 = t425 * t511 * t529;
  t1924 = t1898 - 0.2e1 * t1900 - t1907 + 0.12e2 * t1909 - t1914 + t1677 - t1695 - t1699 - t1706 - t1713 + t1917 + 0.24e2 * t1919 - 0.3e1 * t1922;
  t1929 = 0.36e2 * t526 * t502 * t134 * t371;
  t1933 = 0.3e1 / 0.2e1 * t526 * t1555 * t514 * t528;
  t1934 = t347 * t895;
  t1938 = t266 * t233 * t1783 * t268;
  t1939 = t899 * t373;
  t1941 = t716 * t198;
  t1943 = t712 * t254;
  t1944 = 0.96e2 * t1943;
  t1945 = t712 * t198;
  t1947 = t716 * t254;
  t1948 = 0.576e3 * t1947;
  t1949 = t1347 * t139;
  t1950 = 0.384e3 * t1949;
  t1952 = t49 * t343 * t139;
  t1953 = 0.144e4 * t1952;
  t1955 = t177 * t722 * t139;
  t1956 = 0.192e4 * t1955;
  t1957 = -t1929 - t1933 - 0.4e1 * t1934 - t1938 - 0.6e1 * t1939 - 0.576e3 * t1941 + t1944 + 0.96e2 * t1945 - t1948 - t1950 + t1953 - t1956;
  t1958 = t52 * t52;
  t1962 = 0.84e3 * t50 / t1958 * t139;
  t1963 = t178 * t1030;
  t1964 = 0.16e2 * t1963;
  t1968 = 0.18e2 * t822 * t527 * t528 * t371;
  t1973 = 0.3e1 * t831 * t501 * t833 * t837 * t371;
  t1977 = 0.28e2 / 0.27e2 * t544 * t987 * t233 * t251;
  t1980 = t544 * t545 * t992 / 0.3e1;
  t1981 = t636 * t639;
  t1983 = t425 * t543 * t546;
  t1987 = 0.2e1 * t544 * t228 * t510 * t995;
  t1988 = t636 * t643;
  t1993 = 0.4e1 / 0.3e1 * t544 * t489 * t499 * t503;
  t1994 = t636 * t647;
  t1998 = 0.2e1 / 0.3e1 * t544 * t646 * t507;
  t1999 = t1962 + t1964 + t1968 - t1973 + t1977 + t1980 + t1981 + t1983 + t1987 - 0.2e1 * t1988 + t1993 - 0.4e1 / 0.3e1 * t1994 - t1998;
  t2004 = 0.56e2 / 0.27e2 * t654;
  t2007 = 0.56e2 / 0.27e2 * t664;
  t2008 = 0.4e1 * t707;
  t2009 = 0.24e2 * t710;
  t2010 = t1307 + 0.2e1 * t637 + t640 - t1309 - t1310 + t10 * (t1804 + t1823 + t1839 + t1862 + t1893 + t1924 + t1957 + t1999) + t2004 - 0.2e1 * t657 + 0.8e1 / 0.3e1 * t659 - t2007 + t2008 + t2009;
  t2011 = 0.96e2 * t713;
  t2012 = 0.576e3 * t717;
  t2013 = 0.144e3 * t719;
  t2014 = 0.48e3 * t724;
  t2015 = 0.96e3 * t727;
  t2016 = 0.6e1 * t732;
  t2017 = 0.24e3 * t734;
  t2019 = 0.384e3 * t738;
  t2024 = t2011 - t2012 + t2013 - t2014 + t2015 + t2016 + t2017 - 0.384e3 * t736 - t2019 + 0.144e3 * t740 + 0.24e3 * t742 + 0.48e2 * t744 + 0.96e2 * t746;
  t2026 = 0.48e2 * t748;
  t2028 = 0.48e2 * t754;
  t2033 = 0.24e2 * t796;
  t2034 = 0.2e1 * t807;
  t2035 = 0.12e2 * t814;
  t2037 = 0.12e2 * t826;
  t2038 = 0.2e1 * t839;
  t2039 = t2026 - 0.96e2 * t752 - t2028 - 0.48e2 * t756 + 0.12e2 * t759 + 0.12e2 * t762 + 0.4e1 * t794 - t2033 + t2034 - t2035 + 0.8e1 * t817 + t2037 - t2038;
  t2040 = 0.4e1 / 0.3e1 * t844;
  t2041 = 0.2e1 * t848;
  t2043 = 0.24e2 * t859;
  t2044 = 0.24e2 * t863;
  t2046 = 0.4e1 * t896;
  t2049 = 0.4e1 * t1031;
  t2050 = t1015 / 0.2e1;
  t2051 = 0.6e1 * t1035;
  t2052 = t2040 + t2041 - t851 - 0.6e1 * t854 + t2043 - t2044 + 0.24e2 * t865 - t2046 - 0.12e2 * t897 - 0.12e2 * t900 + t2049 - t2050 - t2051;
  tv4rho40 = t2010 + t2024 + t2039 + t2052;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2057 = 0.24e2 * t1113;
  t2058 = t1307 + t1247 + 0.3e1 / 0.2e1 * t637 + t640 - t1309 - t1310 + t2004 + t1248 - t1072 - t657 + 0.2e1 * t659 - t2007 + 0.6e1 * t1109 - t1250 + t2057 + t1251;
  t2059 = 0.24e2 * t1118;
  t2061 = 0.6e1 * t1129;
  t2064 = t282 * t106 * t629 * t633;
  t2069 = t54 * t1107 * t253;
  t2071 = t2064 / 0.8e1 - t1315 - t1319 + t1324 + 0.3e1 / 0.8e1 * t1327 - t1332 - t1383 + 0.3e1 * t1385 + t1796 - t1798 - t1803 - t1408 + t1411 + 0.3e1 * t2069 + t1470 + t1474;
  t2072 = t183 * t1128;
  t2073 = 0.24e2 * t2072;
  t2074 = t178 * t1126;
  t2076 = t183 * t1126;
  t2102 = 0.32e2 * t566 * t182;
  t2104 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t1335 * t273 * t766 - 0.16e2 / 0.9e1 * t765 * t48 * t406 * t402 - 0.8e1 / 0.9e1 * t1076 * t188 * t409 + 0.8e1 / 0.3e1 * t401 * t406 * t188 - 0.8e1 * t1079 * t53 * t188 + 0.8e1 / 0.3e1 * t1079 * t406 * t409 + 0.4e1 / 0.9e1 * t563 * t773 - 0.16e2 * t61 * t53 + t2102);
  t2129 = 0.32e2 * t574 * t182;
  t2131 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t1356 * t277 * t780 + 0.16e2 / 0.9e1 * t779 * t48 * t406 * t416 - 0.8e1 / 0.9e1 * t1091 * t192 * t419 - 0.8e1 / 0.3e1 * t415 * t406 * t192 + 0.8e1 * t1094 * t53 * t192 - 0.8e1 / 0.3e1 * t1094 * t406 * t419 + 0.4e1 / 0.9e1 * t571 * t786 + 0.16e2 * t66 * t53 - t2129);
  t2133 = (t2104 + t2131) * t73;
  t2136 = t555 * t663;
  t2138 = t1071 * t540;
  t2139 = 0.2e1 / 0.3e1 * t2138;
  t2141 = t1107 * t259 * t263;
  t2148 = 0.24e2 * t178 * t1128;
  t2149 = t344 * t588;
  t2151 = -t2073 + 0.12e2 * t2074 - 0.12e2 * t2076 + t54 * t2133 * t138 - 0.14e2 / 0.27e2 * t2136 + t2139 - t2141 / 0.2e1 - t1806 / 0.6e1 + t1812 - 0.14e2 / 0.9e1 * t1813 + 0.2e1 / 0.3e1 * t1815 - t1584 - 0.9e1 / 0.2e1 * t1817 - t1822 + t2148 - t1592 + 0.6e2 * t2149;
  t2154 = 0.96e2 * t339 * t581;
  t2155 = t344 * t581;
  t2156 = 0.6e2 * t2155;
  t2157 = t716 * t283;
  t2158 = 0.144e3 * t2157;
  t2159 = t726 * t283;
  t2160 = 0.24e3 * t2159;
  t2161 = t723 * t283;
  t2163 = t339 * t588;
  t2164 = 0.96e2 * t2163;
  t2165 = t336 * t581;
  t2166 = 0.36e2 * t2165;
  t2167 = t336 * t588;
  t2168 = 0.36e2 * t2167;
  t2169 = t712 * t283;
  t2172 = 0.12e2 * t1827;
  t2173 = -t2154 + t2156 - t2158 + t2160 - 0.12e3 * t2161 - t2164 + t1603 + t2166 + t2168 + 0.24e2 * t2169 + t1607 + t1610 + t1615 - t1618 - 0.36e2 * t1825 + t2172;
  t2182 = t282 * t830 * t838;
  t2185 = t282 * t821 * t825;
  t2188 = t580 * t511 * t529;
  t2189 = 0.3e1 / 0.2e1 * t2188;
  t2191 = t282 * t500 * t858;
  t2193 = 0.3e1 * t1830 + 0.2e1 * t2133 * t105 * t143 + t1656 - t1659 + t1833 + t1664 - t1668 + t1838 - 0.24e2 * t1840 - 0.4e1 * t1842 - 0.4e1 * t1844 + t1849 + t1671 - t2182 / 0.2e1 + 0.3e1 * t2185 - t2189 + 0.6e1 * t2191;
  t2196 = t552 * t862;
  t2198 = 0.96e2 * t1852;
  t2199 = 0.96e2 * t1854;
  t2204 = t1148 * t373;
  t2205 = 0.3e1 * t2204;
  t2206 = t552 * t895;
  t2207 = 0.36e2 * t1879;
  t2209 = 0.24e3 * t1885;
  t2210 = -t1674 - 0.6e1 * t2196 - t2198 - t2199 + 0.18e3 * t1856 + 0.6e2 * t1860 + 0.6e1 * t1865 - 0.18e2 * t1867 - t2205 - t2206 + t1872 + t1876 - t2207 - 0.36e2 * t1881 - t1884 + t2209;
  t2212 = 0.48e3 * t1889;
  t2217 = -0.36e3 * t1887 + t2212 - t1892 + t1898 - 0.3e1 / 0.2e1 * t1900 - t1907 + 0.9e1 * t1909 - t1914 + t1677 - t1695 - t1699 - t1706 - t1713 + t1917 + 0.18e2 * t1919 - 0.3e1 / 0.2e1 * t1922 - t1929;
  t2221 = t1107 * t110 * t269;
  t2223 = t1148 * t523;
  t2224 = 0.6e1 * t2223;
  t2226 = 0.144e3 * t1941;
  t2227 = 0.48e2 * t1943;
  t2229 = 0.192e3 * t1949;
  t2230 = 0.96e3 * t1955;
  t2231 = 0.8e1 * t1963;
  t2233 = t54 * t580 * t519;
  t2234 = 0.3e1 * t2233;
  t2235 = -t1933 - 0.3e1 * t1934 - t1938 - 0.3e1 * t2221 + t2224 - 0.3e1 * t1939 + t2226 - t2227 - 0.72e2 * t1945 + t2229 - t2230 + t1962 + t2231 + t1968 - t1973 + t2234;
  t2237 = t54 * t282 * t1029;
  t2238 = t178 * t1131;
  t2239 = 0.12e2 * t2238;
  t2240 = t183 * t1131;
  t2242 = t1153 * t1034;
  t2247 = t1065 * t647;
  t2249 = t1065 * t639;
  t2251 = t1065 * t643;
  t2254 = t580 * t543 * t546;
  t2255 = t2254 / 0.2e1;
  t2256 = t2237 + t2239 - 0.12e2 * t2240 - 0.3e1 / 0.2e1 * t2242 + t1977 + t1980 + 0.3e1 / 0.4e1 * t1981 + t1983 / 0.2e1 + t1987 - 0.3e1 / 0.2e1 * t1988 + t1993 - t1994 - t1998 - t2247 / 0.3e1 + t2249 / 0.4e1 - t2251 / 0.2e1 + t2255;
  t2261 = 0.48e2 * t713;
  t2262 = 0.48e3 * t727;
  t2263 = 0.192e3 * t738;
  t2264 = -t2059 - t1252 + t1254 + t1255 + 0.3e1 * t1127 + t2061 + t1282 + t2008 + t2009 + t10 * (t2071 + t2151 + t2173 + t2193 + t2210 + t2217 + t2235 + t2256) - t2261 - t2014 + t2262 + t2016 + t2017 - t737 - t2263;
  t2267 = 0.24e2 * t748;
  t2272 = 0.6e1 * t1149;
  t2273 = -t741 + 0.18e3 * t742 + t747 + t2267 - 0.72e2 * t752 - t2028 - 0.24e2 * t756 + 0.6e1 * t759 + 0.9e1 * t762 + t794 + t1288 - t2272 - t1289 - t2033 + t2034 - t2035;
  t2278 = t818 + t2037 - t2038 + t2040 + t2041 - t851 - 0.9e1 / 0.2e1 * t854 + t2043 - t1291 - t2044 + 0.18e2 * t865 - t2046 - 0.9e1 * t897 - 0.6e1 * t900 + t2049 - t2050 - t2051;
  tv4rho41 = t2058 + t2264 + t2273 + t2278;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2287 = t2064 / 0.4e1 - t1315 - t1319 + t1324 + t1327 / 0.4e1 - t1332 - t1383 + 0.2e1 * t1385 + t1796 + t1803 - t1408 + t1411 + 0.2e1 * t2069 + t1470 + t1474 - 0.32e2 * t2072 - 0.8e1 * t2074;
  t2295 = t613 * t511 * t529;
  t2304 = -0.8e1 * t2076 - 0.28e2 / 0.27e2 * t2136 + 0.8e1 / 0.9e1 * t2138 - t2141 / 0.3e1 + t1812 - 0.28e2 / 0.27e2 * t1813 + 0.2e1 / 0.9e1 * t1815 - t1584 - t2295 / 0.2e1 - 0.3e1 * t1817 - t1822 - t1592 + 0.12e3 * t2149 + 0.8e2 * t2155 + 0.96e2 * t2157 + 0.16e3 * t2159 - 0.24e3 * t2161 - 0.64e2 * t2163;
  t2310 = t54 * t1200 * t253;
  t2337 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t1335 * t595 * t402 - 0.64e2 / 0.27e2 * t1076 * t188 * t48 * t406 - 0.8e1 / 0.27e2 * t1171 * t409 + 0.32e2 / 0.9e1 * t401 * t49 * t343 + 0.16e2 / 0.9e1 * t563 * t406 - 0.16e2 / 0.3e1 * t563 * t712 - 0.8e1 / 0.27e2 * t765 * t599 * t402 + 0.8e1 / 0.9e1 * t401 * t1181 * t188 + 0.4e1 / 0.9e1 * t1176 * t409 + t2102);
  t2363 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t1356 * t604 * t416 + 0.64e2 / 0.27e2 * t1091 * t192 * t48 * t406 - 0.8e1 / 0.27e2 * t1186 * t419 + 0.32e2 / 0.9e1 * t415 * t49 * t343 - 0.16e2 / 0.9e1 * t571 * t406 + 0.16e2 / 0.3e1 * t571 * t712 - 0.8e1 / 0.27e2 * t779 * t607 * t416 + 0.8e1 / 0.9e1 * t415 * t1194 * t192 + 0.4e1 / 0.9e1 * t1191 * t419 - t2129);
  t2365 = (t2337 + t2363) * t73;
  t2369 = t54 * t613 * t519;
  t2370 = t183 * t1232;
  t2372 = t178 * t1230;
  t2374 = t183 * t1230;
  t2376 = t178 * t1232;
  t2379 = t344 * t614;
  t2381 = t54 * t2365 * t138 + t1603 + t1607 + t1610 + t1615 - t1618 - 0.24e2 * t1825 - 0.48e2 * t2165 - 0.24e2 * t2167 - 0.48e2 * t2169 + 0.2e1 * t2310 + t2369 - 0.8e1 * t2370 + 0.8e1 * t2372 - 0.8e1 * t2374 + 0.8e1 * t2376 + 0.2e2 * t2379;
  t2382 = t336 * t614;
  t2384 = t339 * t614;
  t2392 = 0.12e2 * t2382 - 0.32e2 * t2384 - 0.8e1 * t1827 + t1830 + t1656 - t1659 + t1664 - t1668 + t1838 - 0.8e1 * t1840 + t1849 - 0.8e1 * t1850 + t1671 - t2182 + 0.6e1 * t2185 - 0.2e1 * t2188 + 0.12e2 * t2191 - t1674;
  t2411 = 0.2e1 * t2365 * t105 * t143 + 0.64e2 * t1854 + 0.12e3 * t1856 + 0.32e2 * t1858 + 0.2e2 * t1860 + 0.2e1 * t1865 - 0.12e2 * t1867 + t1872 + t1876 - 0.24e2 * t1877 - 0.24e2 * t1879 + 0.12e2 * t1881 - t1884 - 0.16e3 * t1885 - 0.12e2 * t2196 - 0.4e1 * t2204 - 0.2e1 * t2206;
  t2417 = -0.24e3 * t1887 - t1892 + t1898 - t1900 - t1907 + 0.6e1 * t1909 - t1914 + t1677 - t1695 - t1699 - t1706 - t1713 + t1917 + 0.12e2 * t1919 - t1922 / 0.2e1 - t1929 - t1933 - 0.2e1 * t1934;
  t2419 = t1215 * t523;
  t2423 = t1215 * t373;
  t2425 = t1200 * t110 * t269;
  t2434 = -t1938 + 0.2e1 * t2419 - 0.2e1 * t2221 + 0.8e1 * t2223 - t1939 - t2423 - 0.2e1 * t2425 + 0.96e2 * t1941 + 0.48e2 * t1945 + 0.192e3 * t1947 - 0.48e3 * t1952 + t1962 + t1968 - t1973 + 0.4e1 * t2233 + 0.2e1 * t2237 + 0.8e1 * t2238;
  t2437 = t1200 * t259 * t263;
  t2439 = t1207 * t540;
  t2449 = t613 * t543 * t546;
  t2451 = -0.24e2 * t2240 - t2437 / 0.3e1 + 0.2e1 / 0.9e1 * t2439 - 0.3e1 * t2242 + t1977 + t1980 + t1981 / 0.2e1 + t1983 / 0.6e1 + t1987 - t1988 + t1993 - 0.2e1 / 0.3e1 * t1994 - t1998 - 0.2e1 / 0.3e1 * t2247 + t2249 / 0.2e1 - t2251 + 0.2e1 / 0.3e1 * t2254 + t2449 / 0.6e1;
  t2463 = 0.4e1 * t1202 + t1307 + t10 * (t2287 + t2304 + t2381 + t2392 + t2411 + t2417 + t2434 + t2451) + t1066 + t637 + t640 - t1309 - t1310 + t2004 + 0.4e1 / 0.3e1 * t1069 - t1208 / 0.3e1 - 0.4e1 / 0.3e1 * t1072 - t657 / 0.3e1 + 0.4e1 / 0.3e1 * t659 - t2007 + 0.4e1 * t1109 - 0.64e2 * t1111;
  t2475 = 0.16e2 * t1115 - 0.32e2 * t1118 - 0.48e2 * t1120 + 0.12e3 * t1122 - t1214 + 0.2e1 * t1127 + 0.8e1 * t1129 - 0.2e1 * t1216 + 0.6e1 * t1132 + t2008 + t2009 + 0.192e3 * t717 - 0.48e2 * t719 - t2014 + t2016 + t2017 + 0.64e2 * t736;
  t2487 = -t1139 + 0.12e3 * t742 - 0.8e1 * t744 - 0.16e2 * t746 - 0.48e2 * t752 - t2028 - 0.8e1 * t756 + 0.2e1 * t759 + 0.6e1 * t762 + 0.12e2 * t1146 - 0.8e1 * t1149 - 0.6e1 * t1151 - t2033 + t2034 - t2035 + t2037 - t2038;
  t2497 = t2040 + t2041 - t851 - 0.3e1 * t854 + t2043 - 0.3e1 * t1154 - t2044 + 0.12e2 * t865 - t2046 - 0.6e1 * t897 - 0.2e1 * t900 + 0.2e1 * t1231 + 0.2e1 * t1233 + 0.8e1 * t1234 - 0.8e1 * t1236 + t2049 - t2050 - t2051;
  tv4rho42 = t2463 + t2475 + t2487 + t2497;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2502 = 0.6e1 * t1202 + t1307 + 0.3e1 / 0.2e1 * t1066 + t638 + t640 - t1309 - t1310 + t2004 + 0.2e1 * t1069 - t1208 - t1072 + t660 - t2007 + t1250 - t2057 - t1251;
  t2527 = 0.12e2 * t53 + 0.24e2 * t1347;
  t2531 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t1335 * t1256 * t188 - 0.16e2 / 0.9e1 * t1171 * t407 - 0.8e1 / 0.9e1 * t1076 * t599 * t188 + 0.8e1 / 0.3e1 * t1079 * t406 * t599 + 0.4e1 / 0.3e1 * t563 * t1181 + 0.4e1 / 0.9e1 * t401 * t1262 * t188 + 0.4e1 / 0.3e1 * t61 * t2527);
  t2552 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t1356 * t1267 * t192 + 0.16e2 / 0.9e1 * t1186 * t407 - 0.8e1 / 0.9e1 * t1091 * t607 * t192 - 0.8e1 / 0.3e1 * t1094 * t406 * t607 + 0.4e1 / 0.3e1 * t571 * t1194 + 0.4e1 / 0.9e1 * t415 * t1272 * t192 - 0.4e1 / 0.3e1 * t66 * t2527);
  t2554 = (t2531 + t2552) * t73;
  t2558 = t54 * t1278 * t253;
  t2559 = 0.3e1 / 0.8e1 * t2064 - t1315 - t1319 + t1324 + t1327 / 0.8e1 - t1332 - t1383 + t54 * t2554 * t138 + t2558 + t1385 + t1796 - t1803 - t1408 + t1411 + t1470 + t1474;
  t2566 = -t2073 - 0.14e2 / 0.9e1 * t2136 + t2139 + t1812 - 0.14e2 / 0.27e2 * t1813 - t1584 - 0.3e1 / 0.2e1 * t2295 - 0.3e1 / 0.2e1 * t1817 - t1822 - t2148 - t1592 + 0.18e3 * t2149 + t2154 + t2156 + t2158 - t2160 - 0.36e3 * t2161;
  t2576 = t2164 + t1603 + t2166 - t2168 + 0.72e2 * t2169 + 0.3e1 * t2310 + t1607 + 0.3e1 * t2369 + t1610 - 0.24e2 * t2370 + t1615 - 0.12e2 * t2372 - 0.12e2 * t2374 - t1618 - 0.12e2 * t1825 + 0.6e2 * t2379;
  t2579 = t1278 * t259 * t263;
  t2581 = t178 * t1279;
  t2583 = t183 * t1279;
  t2588 = -0.36e2 * t2382 - t2172 - t2579 / 0.6e1 + t1656 - t1659 + t1664 - t1668 + t1838 + t1849 + t1671 + 0.4e1 * t2581 - 0.4e1 * t2583 - 0.3e1 / 0.2e1 * t2182 + 0.9e1 * t2185 - t2189 + 0.18e2 * t2191 - t1674;
  t2596 = -0.18e2 * t2196 + t2198 + t2199 + 0.6e2 * t1856 - 0.6e1 * t1867 - t2205 - 0.3e1 * t2206 + t1872 + t1876 + t2207 - t1884 - t2209 - 0.12e3 * t1887 - t2212 - t1892 + t1898;
  t2601 = -t1900 / 0.2e1 - t1907 + 0.3e1 * t1909 - t1914 + t1677 - t1695 - t1699 - t1706 - t1713 + t1917 + 0.6e1 * t1919 - t1929 - t1933 - t1934 - t1938 + 0.6e1 * t2419 + t2224;
  t2611 = 0.2e1 * t2554 * t105 * t143 - 0.24e2 * t1945 + t1962 + t1968 - t1973 - t2226 + t2227 - t2229 + t2230 - t2231 + t2234 + 0.3e1 * t2237 - t2239 - 0.36e2 * t2240 - 0.3e1 * t2423 - 0.3e1 * t2425;
  t2622 = t1278 * t110 * t269;
  t2623 = -t2437 / 0.2e1 + 0.2e1 / 0.3e1 * t2439 - 0.9e1 / 0.2e1 * t2242 + t1977 + t1980 + t1981 / 0.4e1 + t1987 - t1988 / 0.2e1 + t1993 - t1994 / 0.3e1 - t1998 - t2247 + 0.3e1 / 0.4e1 * t2249 - 0.3e1 / 0.2e1 * t2251 + t2255 + t2449 / 0.2e1 - t2622;
  t2628 = -t2059 - 0.72e2 * t1120 + 0.18e3 * t1122 - t1255 + t1280 + t2061 - 0.6e1 * t1216 + 0.9e1 * t1132 + t2008 + t2009 + t1285 + t10 * (t2559 + t2566 + t2576 + t2588 + t2596 + t2601 + t2611 + t2623) + t2261 - t2014 - t2262 + t2016 + t2017;
  t2632 = t737 + t2263 + t741 + t743 - t747 - t2267 - t753 - t2028 + t763 + 0.18e2 * t1146 - t2272 - 0.9e1 * t1151 - t2033 + t2034 - t2035 + t2037;
  t2637 = -t2038 + t2040 + t2041 - t851 - t855 + t2043 - 0.9e1 / 0.2e1 * t1154 - t2044 + t866 - t2046 - t898 + 0.3e1 * t1231 + 0.6e1 * t1233 - 0.24e2 * t1236 + t2049 - t2050 - t2051;
  tv4rho43 = t2502 + t2628 + t2632 + t2637;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2645 = t1307 + 0.2e1 * t1066 + t640 - t1309 - t1310 + t2004 + 0.8e1 / 0.3e1 * t1069 - 0.2e1 * t1208 - t2007 + 0.384e3 * t1111 - 0.96e2 * t1115 - 0.96e2 * t1120;
  t2652 = 0.24e3 * t1122 + 0.144e3 * t1124 + 0.4e1 * t1280 - 0.12e2 * t1216 + 0.12e2 * t1132 + t2008 + t2009 + 0.8e1 * t1284 - t2011 - t2012 + t2013 - t2014 - t2015;
  t2658 = t2064 / 0.2e1 - t1315 - t1319 + t1324 - t1332 - t1383 + 0.4e1 * t2558 + t1796 + t1803 - t1408 + t1411 + t1470;
  t2666 = t1474 - 0.56e2 / 0.27e2 * t2136 + t1812 - t1584 - 0.3e1 * t2295 - t1822 - t1592 + 0.24e3 * t2149 - 0.576e3 * t2157 - 0.96e3 * t2159 - 0.48e3 * t2161 + 0.384e3 * t2163 + t1603;
  t2671 = t595 * t595;
  t2676 = t599 * t599;
  t2682 = 0.24e2 * t53 + 0.24e2 * t1347;
  t2686 = my_piecewise3(t58, 0, 0.4e2 / 0.81e2 * t1335 * t2671 - 0.16e2 / 0.9e1 * t1171 * t599 + 0.4e1 / 0.3e1 * t401 * t2676 + 0.16e2 / 0.9e1 * t563 * t1262 + 0.4e1 / 0.3e1 * t61 * t2682);
  t2687 = t604 * t604;
  t2692 = t607 * t607;
  t2701 = my_piecewise3(t65, 0, 0.4e2 / 0.81e2 * t1356 * t2687 - 0.16e2 / 0.9e1 * t1186 * t607 + 0.4e1 / 0.3e1 * t415 * t2692 + 0.16e2 / 0.9e1 * t571 * t1272 - 0.4e1 / 0.3e1 * t66 * t2682);
  t2703 = (t2686 + t2701) * t73;
  t2710 = t54 * t2703 * t138 + t1607 + t1610 + t1615 - t1618 + 0.144e3 * t2167 - 0.96e2 * t2169 + 0.6e1 * t2369 - 0.48e2 * t2370 - 0.48e2 * t2376 + 0.12e3 * t2379 + 0.72e2 * t2382;
  t2719 = 0.192e3 * t2384 - 0.2e1 / 0.3e1 * t2579 + t1656 - t1659 + t1664 - t1668 + t1838 + t1849 + 0.2e1 * t2703 * t105 * t143 + t1671 - 0.16e2 * t2581 - 0.16e2 * t2583 - 0.2e1 * t2182;
  t2726 = 0.12e2 * t2185 + 0.24e2 * t2191 - t1674 - 0.24e2 * t2196 + t1853 - 0.4e1 * t2206 + t1872 + t1876 + t1878 - t1884 - t1890 - t1892;
  t2728 = t1898 - t1907 - t1914 + t1677 - t1695 - t1699 - t1706 - t1713 + t1917 - t1929 - t1933 - t1938 + 0.12e2 * t2419;
  t2733 = -0.6e1 * t2423 - t1944 - t1948 + t1950 + t1953 + t1956 + t1962 - t1964 + t1968 - t1973 + 0.4e1 * t2237 - 0.48e2 * t2238;
  t2740 = -0.48e2 * t2240 + 0.4e1 / 0.3e1 * t2439 - 0.6e1 * t2242 + t1977 + t1980 + t1987 + t1993 - t1998 - 0.4e1 / 0.3e1 * t2247 + t2249 - 0.2e1 * t2251 + t2449 - 0.4e1 * t2622;
  t2745 = t2016 + t2017 + t2019 - t2026 - t2028 + 0.24e2 * t1146 - 0.12e2 * t1151 - t2033 + t2034 - t2035 + t10 * (t2658 + t2666 + t2710 + t2719 + t2726 + t2728 + t2733 + t2740) + t2037 - t2038;
  t2750 = t2040 + t2041 - t851 + t2043 - 0.6e1 * t1154 - t2044 - t2046 + 0.12e2 * t1233 - 0.48e2 * t1234 - 0.48e2 * t1236 + t2049 - t2050 - t2051;
  tv4rho44 = t2645 + t2652 + t2745 + t2750;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

}

#endif

