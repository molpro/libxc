/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/lda_exc/lda_x_erf.mpl
  Type of functional: lda_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;

  double t153, t154, t163, t166, t172, t173, t201, t206;
  double t207, t212, t214, t215, t216, t219, t227, t235;
  double t236, t247, t250, t254, tv2rho20;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t153 = t15 * t15;
  t154 = 0.1e1 / t153;
  t163 = t93 * t93;
  t166 = rho[0] * rho[0];
  t172 = 0.2e1 / 0.81e2 * t20 * t1 / t15 / t166 * t24;
  t173 = my_piecewise3(t29, t172, 0);
  t201 = 0.1e1 / t52 / t31;
  t206 = t35 * t163 / 0.6e1 - t87 * t173 / 0.18e2 - t38 * t163 / 0.48e2 + t97 * t173 / 0.24e3 + t41 * t163 / 0.64e3 - t101 * t173 / 0.448e4 - t44 * t163 / 0.1152e5 + t105 * t173 / 0.10368e6 + t47 * t163 / 0.258048e6 - t109 * t173 / 0.2838528e7 - t50 * t163 / 0.688128e7 + t113 * t173 / 0.8945664e8 + t53 * t163 / 0.21233664e9 - t117 * t173 / 0.31850496e10 - t201 * t163 / 0.74317824e10 + t121 * t173 / 0.1263403008e12;
  t207 = my_piecewise3(t29, 0, t172);
  t212 = t62 * t62;
  t214 = 0.1e1 / t212 / t56;
  t215 = t125 * t125;
  t216 = t214 * t215;
  t219 = t65 * t132;
  t227 = 0.1e1 / t212;
  t235 = 0.1e1 / t212 / t62;
  t236 = t235 * t215;
  t247 = -0.2e1 * t227 * t215 * t65 + t132 * t207 * t65 / 0.2e1 + t236 * t65 / 0.4e1 - 0.4e1 * t215 * t66 - t63 * t215 * t65 - 0.4e1 * t136 * t207 - t58 * t207 * t65;
  t250 = -t216 * t65 / 0.2e1 + 0.2e1 * t219 * t215 - t127 * t207 + 0.2e1 * t207 * t69 + 0.4e1 * t125 * t141 + 0.2e1 * t56 * t247;
  t254 = my_piecewise3(t28, t206, -0.8e1 / 0.3e1 * t207 * t72 - 0.16e2 / 0.3e1 * t125 * t144 - 0.8e1 / 0.3e1 * t56 * t250);
  tv2rho20 = -t7 * t14 * t154 * t76 / 0.12e2 - t7 * t14 * t15 * t148 / 0.2e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;

  double t153, t154, t163, t166, t172, t173, t201, t206;
  double t207, t212, t214, t215, t216, t219, t227, t235;
  double t236, t247, t250, t254, tv2rho20;

  double t260, t279, t280, t297, t308, t335, t341, t343;
  double t350, t354, t355, t358, t359, t363, t379, t383;
  double t391, t395, t399, t402, t409, t412, t416, tv3rho30;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t153 = t15 * t15;
  t154 = 0.1e1 / t153;
  t163 = t93 * t93;
  t166 = rho[0] * rho[0];
  t172 = 0.2e1 / 0.81e2 * t20 * t1 / t15 / t166 * t24;
  t173 = my_piecewise3(t29, t172, 0);
  t201 = 0.1e1 / t52 / t31;
  t206 = t35 * t163 / 0.6e1 - t87 * t173 / 0.18e2 - t38 * t163 / 0.48e2 + t97 * t173 / 0.24e3 + t41 * t163 / 0.64e3 - t101 * t173 / 0.448e4 - t44 * t163 / 0.1152e5 + t105 * t173 / 0.10368e6 + t47 * t163 / 0.258048e6 - t109 * t173 / 0.2838528e7 - t50 * t163 / 0.688128e7 + t113 * t173 / 0.8945664e8 + t53 * t163 / 0.21233664e9 - t117 * t173 / 0.31850496e10 - t201 * t163 / 0.74317824e10 + t121 * t173 / 0.1263403008e12;
  t207 = my_piecewise3(t29, 0, t172);
  t212 = t62 * t62;
  t214 = 0.1e1 / t212 / t56;
  t215 = t125 * t125;
  t216 = t214 * t215;
  t219 = t65 * t132;
  t227 = 0.1e1 / t212;
  t235 = 0.1e1 / t212 / t62;
  t236 = t235 * t215;
  t247 = -0.2e1 * t227 * t215 * t65 + t132 * t207 * t65 / 0.2e1 + t236 * t65 / 0.4e1 - 0.4e1 * t215 * t66 - t63 * t215 * t65 - 0.4e1 * t136 * t207 - t58 * t207 * t65;
  t250 = -t216 * t65 / 0.2e1 + 0.2e1 * t219 * t215 - t127 * t207 + 0.2e1 * t207 * t69 + 0.4e1 * t125 * t141 + 0.2e1 * t56 * t247;
  t254 = my_piecewise3(t28, t206, -0.8e1 / 0.3e1 * t207 * t72 - 0.16e2 / 0.3e1 * t125 * t144 - 0.8e1 / 0.3e1 * t56 * t250);
  tv2rho20 = -t7 * t14 * t154 * t76 / 0.12e2 - t7 * t14 * t15 * t148 / 0.2e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t260 = 0.1e1 / t153 / rho[0];
  t279 = 0.14e2 / 0.243e3 * t20 * t1 / t15 / t166 / rho[0] * t24;
  t280 = my_piecewise3(t29, -t279, 0);
  t297 = t163 * t93;
  t308 = t97 * t280 / 0.24e3 - t101 * t280 / 0.448e4 + t105 * t280 / 0.10368e6 - t109 * t280 / 0.2838528e7 + t113 * t280 / 0.8945664e8 - t117 * t280 / 0.31850496e10 + t121 * t280 / 0.1263403008e12 - t87 * t280 / 0.18e2 - 0.2e1 / 0.3e1 * t97 * t297 + t35 * t93 * t173 / 0.2e1 + t101 * t297 / 0.8e1 - t38 * t93 * t173 / 0.16e2;
  t335 = 0.1e1 / t52 / t86;
  t341 = -t105 * t297 / 0.8e2 + 0.3e1 / 0.64e3 * t41 * t93 * t173 + t109 * t297 / 0.1152e4 - t44 * t93 * t173 / 0.384e4 - t113 * t297 / 0.21504e5 + t47 * t93 * t173 / 0.86016e5 + t117 * t297 / 0.49152e6 - t50 * t93 * t173 / 0.229376e7 - t121 * t297 / 0.1327104e8 + t53 * t93 * t173 / 0.7077888e8 + t335 * t297 / 0.4128768e9 - t201 * t93 * t173 / 0.24772608e10;
  t343 = my_piecewise3(t29, 0, -t279);
  t350 = t215 * t125;
  t354 = t214 * t125;
  t355 = t65 * t207;
  t358 = t212 * t212;
  t359 = 0.1e1 / t358;
  t363 = t65 * t227;
  t379 = t227 * t125;
  t383 = 0.1e1 / t212 / t131;
  t391 = t125 * t65;
  t395 = 0.1e1 / t358 / t56;
  t399 = t125 * t66;
  t402 = t63 * t125;
  t409 = 0.15e2 / 0.2e1 * t214 * t350 * t65 - 0.6e1 * t379 * t355 - 0.5e1 / 0.2e1 * t383 * t350 * t65 + t132 * t343 * t65 / 0.2e1 + 0.3e1 / 0.4e1 * t235 * t207 * t391 + t395 * t350 * t65 / 0.8e1 - 0.12e2 * t399 * t207 - 0.3e1 * t402 * t355 - 0.4e1 * t136 * t343 - t58 * t343 * t65;
  t412 = 0.7e1 / 0.2e1 * t235 * t350 * t65 - 0.3e1 / 0.2e1 * t354 * t355 - t359 * t350 * t65 / 0.4e1 - 0.6e1 * t363 * t350 + 0.6e1 * t219 * t125 * t207 - t127 * t343 + 0.2e1 * t343 * t69 + 0.6e1 * t207 * t141 + 0.6e1 * t125 * t247 + 0.2e1 * t56 * t409;
  t416 = my_piecewise3(t28, t308 + t341, -0.8e1 / 0.3e1 * t343 * t72 - 0.8e1 * t207 * t144 - 0.8e1 * t125 * t250 - 0.8e1 / 0.3e1 * t56 * t412);
  tv3rho30 = t7 * t14 * t260 * t76 / 0.18e2 - t7 * t14 * t154 * t148 / 0.4e1 - 0.3e1 / 0.4e1 * t7 * t14 * t15 * t254 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t416;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t13, t14, t15, t16, t17, t18, t20;
  double t23, t24, t27, t28, t29, t30, t31, t34;
  double t35, t37, t38, t40, t41, t44, t47, t50;
  double t52, t53, t56, t57, t58, t60, t62, t63;
  double t65, t66, t69, t72, t76, t79, tzk0;

  double t82, t84, t85, t86, t87, t92, t93, t96;
  double t97, t100, t101, t105, t109, t113, t117, t121;
  double t125, t127, t131, t132, t136, t141, t144, t148;
  double tvrho0;

  double t153, t154, t163, t166, t172, t173, t201, t206;
  double t207, t212, t214, t215, t216, t219, t227, t235;
  double t236, t247, t250, t254, tv2rho20;

  double t260, t279, t280, t297, t308, t335, t341, t343;
  double t350, t354, t355, t358, t359, t363, t379, t383;
  double t391, t395, t399, t402, t409, t412, t416, tv3rho30;

  double t438, t441, t447, t448, t465, t488, t547, t549;
  double t558, t575, t584, t612, t656, t660, tv4rho40;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = 0.1e1 <= p->zeta_threshold;
  t11 = POW_1_3(p->zeta_threshold);
  t13 = my_piecewise3(t10, t11 * p->zeta_threshold, 1);
  t14 = t9 * t13;
  t15 = POW_1_3(rho[0]);
  t16 = POW_1_3(0.9e1);
  t17 = t16 * t16;
  t18 = t3 * t3;
  t20 = t17 * t18 * p->cam_omega;
  t23 = my_piecewise3(t10, t11, 1);
  t24 = 0.1e1 / t23;
  t27 = t20 * t1 / t15 * t24 / 0.18e2;
  t28 = 0.135e1 <= t27;
  t29 = 0.135e1 < t27;
  t30 = my_piecewise3(t29, t27, 0.135e1);
  t31 = t30 * t30;
  t34 = t31 * t31;
  t35 = 0.1e1 / t34;
  t37 = t34 * t31;
  t38 = 0.1e1 / t37;
  t40 = t34 * t34;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 / t40 / t31;
  t47 = 0.1e1 / t40 / t34;
  t50 = 0.1e1 / t40 / t37;
  t52 = t40 * t40;
  t53 = 0.1e1 / t52;
  t56 = my_piecewise3(t29, 0.135e1, t27);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t56;
  t60 = erf(t58 / 0.2e1);
  t62 = t56 * t56;
  t63 = 0.1e1 / t62;
  t65 = exp(-t63 / 0.4e1);
  t66 = t65 - 0.1e1;
  t69 = t65 - 0.3e1 / 0.2e1 - 0.2e1 * t62 * t66;
  t72 = 0.2e1 * t56 * t69 + t57 * t60;
  t76 = my_piecewise3(t28, 0.1e1 / t31 / 0.36e2 - t35 / 0.96e3 + t38 / 0.2688e5 - t41 / 0.82944e6 + t44 / 0.2838528e8 - t47 / 0.107347968e10 + t50 / 0.445906944e11 - t53 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t56 * t72);
  t79 = t7 * t14 * t15 * t76;
  tzk0 = -0.3e1 / 0.16e2 * t79;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t15 * rho[0];
  t84 = t82 * t1 * t3;
  t85 = t6 * t9;
  t86 = t31 * t30;
  t87 = 0.1e1 / t86;
  t92 = t20 * t1 / t82 * t24 / 0.54e2;
  t93 = my_piecewise3(t29, -t92, 0);
  t96 = t34 * t30;
  t97 = 0.1e1 / t96;
  t100 = t34 * t86;
  t101 = 0.1e1 / t100;
  t105 = 0.1e1 / t40 / t30;
  t109 = 0.1e1 / t40 / t86;
  t113 = 0.1e1 / t40 / t96;
  t117 = 0.1e1 / t40 / t100;
  t121 = 0.1e1 / t52 / t30;
  t125 = my_piecewise3(t29, 0, -t92);
  t127 = t65 * t63;
  t131 = t62 * t56;
  t132 = 0.1e1 / t131;
  t136 = t56 * t66;
  t141 = t132 * t125 * t65 / 0.2e1 - 0.4e1 * t136 * t125 - t58 * t125 * t65;
  t144 = -t127 * t125 + 0.2e1 * t125 * t69 + 0.2e1 * t56 * t141;
  t148 = my_piecewise3(t28, -t87 * t93 / 0.18e2 + t97 * t93 / 0.24e3 - t101 * t93 / 0.448e4 + t105 * t93 / 0.10368e6 - t109 * t93 / 0.2838528e7 + t113 * t93 / 0.8945664e8 - t117 * t93 / 0.31850496e10 + t121 * t93 / 0.1263403008e12, -0.8e1 / 0.3e1 * t125 * t72 - 0.8e1 / 0.3e1 * t56 * t144);
  tvrho0 = -t79 / 0.4e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t148;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t153 = t15 * t15;
  t154 = 0.1e1 / t153;
  t163 = t93 * t93;
  t166 = rho[0] * rho[0];
  t172 = 0.2e1 / 0.81e2 * t20 * t1 / t15 / t166 * t24;
  t173 = my_piecewise3(t29, t172, 0);
  t201 = 0.1e1 / t52 / t31;
  t206 = t35 * t163 / 0.6e1 - t87 * t173 / 0.18e2 - t38 * t163 / 0.48e2 + t97 * t173 / 0.24e3 + t41 * t163 / 0.64e3 - t101 * t173 / 0.448e4 - t44 * t163 / 0.1152e5 + t105 * t173 / 0.10368e6 + t47 * t163 / 0.258048e6 - t109 * t173 / 0.2838528e7 - t50 * t163 / 0.688128e7 + t113 * t173 / 0.8945664e8 + t53 * t163 / 0.21233664e9 - t117 * t173 / 0.31850496e10 - t201 * t163 / 0.74317824e10 + t121 * t173 / 0.1263403008e12;
  t207 = my_piecewise3(t29, 0, t172);
  t212 = t62 * t62;
  t214 = 0.1e1 / t212 / t56;
  t215 = t125 * t125;
  t216 = t214 * t215;
  t219 = t65 * t132;
  t227 = 0.1e1 / t212;
  t235 = 0.1e1 / t212 / t62;
  t236 = t235 * t215;
  t247 = -0.2e1 * t227 * t215 * t65 + t132 * t207 * t65 / 0.2e1 + t236 * t65 / 0.4e1 - 0.4e1 * t215 * t66 - t63 * t215 * t65 - 0.4e1 * t136 * t207 - t58 * t207 * t65;
  t250 = -t216 * t65 / 0.2e1 + 0.2e1 * t219 * t215 - t127 * t207 + 0.2e1 * t207 * t69 + 0.4e1 * t125 * t141 + 0.2e1 * t56 * t247;
  t254 = my_piecewise3(t28, t206, -0.8e1 / 0.3e1 * t207 * t72 - 0.16e2 / 0.3e1 * t125 * t144 - 0.8e1 / 0.3e1 * t56 * t250);
  tv2rho20 = -t7 * t14 * t154 * t76 / 0.12e2 - t7 * t14 * t15 * t148 / 0.2e1 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t254;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t260 = 0.1e1 / t153 / rho[0];
  t279 = 0.14e2 / 0.243e3 * t20 * t1 / t15 / t166 / rho[0] * t24;
  t280 = my_piecewise3(t29, -t279, 0);
  t297 = t163 * t93;
  t308 = t97 * t280 / 0.24e3 - t101 * t280 / 0.448e4 + t105 * t280 / 0.10368e6 - t109 * t280 / 0.2838528e7 + t113 * t280 / 0.8945664e8 - t117 * t280 / 0.31850496e10 + t121 * t280 / 0.1263403008e12 - t87 * t280 / 0.18e2 - 0.2e1 / 0.3e1 * t97 * t297 + t35 * t93 * t173 / 0.2e1 + t101 * t297 / 0.8e1 - t38 * t93 * t173 / 0.16e2;
  t335 = 0.1e1 / t52 / t86;
  t341 = -t105 * t297 / 0.8e2 + 0.3e1 / 0.64e3 * t41 * t93 * t173 + t109 * t297 / 0.1152e4 - t44 * t93 * t173 / 0.384e4 - t113 * t297 / 0.21504e5 + t47 * t93 * t173 / 0.86016e5 + t117 * t297 / 0.49152e6 - t50 * t93 * t173 / 0.229376e7 - t121 * t297 / 0.1327104e8 + t53 * t93 * t173 / 0.7077888e8 + t335 * t297 / 0.4128768e9 - t201 * t93 * t173 / 0.24772608e10;
  t343 = my_piecewise3(t29, 0, -t279);
  t350 = t215 * t125;
  t354 = t214 * t125;
  t355 = t65 * t207;
  t358 = t212 * t212;
  t359 = 0.1e1 / t358;
  t363 = t65 * t227;
  t379 = t227 * t125;
  t383 = 0.1e1 / t212 / t131;
  t391 = t125 * t65;
  t395 = 0.1e1 / t358 / t56;
  t399 = t125 * t66;
  t402 = t63 * t125;
  t409 = 0.15e2 / 0.2e1 * t214 * t350 * t65 - 0.6e1 * t379 * t355 - 0.5e1 / 0.2e1 * t383 * t350 * t65 + t132 * t343 * t65 / 0.2e1 + 0.3e1 / 0.4e1 * t235 * t207 * t391 + t395 * t350 * t65 / 0.8e1 - 0.12e2 * t399 * t207 - 0.3e1 * t402 * t355 - 0.4e1 * t136 * t343 - t58 * t343 * t65;
  t412 = 0.7e1 / 0.2e1 * t235 * t350 * t65 - 0.3e1 / 0.2e1 * t354 * t355 - t359 * t350 * t65 / 0.4e1 - 0.6e1 * t363 * t350 + 0.6e1 * t219 * t125 * t207 - t127 * t343 + 0.2e1 * t343 * t69 + 0.6e1 * t207 * t141 + 0.6e1 * t125 * t247 + 0.2e1 * t56 * t409;
  t416 = my_piecewise3(t28, t308 + t341, -0.8e1 / 0.3e1 * t343 * t72 - 0.8e1 * t207 * t144 - 0.8e1 * t125 * t250 - 0.8e1 / 0.3e1 * t56 * t412);
  tv3rho30 = t7 * t14 * t260 * t76 / 0.18e2 - t7 * t14 * t154 * t148 / 0.4e1 - 0.3e1 / 0.4e1 * t7 * t14 * t15 * t254 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t416;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t438 = t173 * t173;
  t441 = t166 * t166;
  t447 = 0.14e3 / 0.729e3 * t20 * t1 / t15 / t441 * t24;
  t448 = my_piecewise3(t29, t447, 0);
  t465 = t163 * t163;
  t488 = -t201 * t438 / 0.24772608e10 + t97 * t448 / 0.24e3 - t101 * t448 / 0.448e4 + t105 * t448 / 0.10368e6 - t109 * t448 / 0.2838528e7 + t113 * t448 / 0.8945664e8 - t117 * t448 / 0.31850496e10 + t121 * t448 / 0.1263403008e12 - t87 * t448 / 0.18e2 + 0.1e2 / 0.3e1 * t38 * t465 + t35 * t438 / 0.2e1 - 0.7e1 / 0.8e1 * t41 * t465 - t38 * t438 / 0.16e2 + 0.9e1 / 0.8e2 * t44 * t465 + 0.3e1 / 0.64e3 * t41 * t438 - 0.11e2 / 0.1152e4 * t47 * t465 - t44 * t438 / 0.384e4 + 0.13e2 / 0.21504e5 * t50 * t465 + t47 * t438 / 0.86016e5 - t53 * t465 / 0.32768e5;
  t547 = -t50 * t438 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t201 * t465 + t53 * t438 / 0.7077888e8 - 0.19e2 / 0.4128768e9 / t52 / t34 * t465 - t38 * t280 * t93 / 0.12e2 + t41 * t280 * t93 / 0.16e3 - t44 * t280 * t93 / 0.288e4 + t47 * t280 * t93 / 0.64512e5 - t50 * t280 * t93 / 0.172032e7 + t53 * t280 * t93 / 0.5308416e8 - t201 * t280 * t93 / 0.18579456e10 + 0.2e1 / 0.3e1 * t35 * t280 * t93 - 0.4e1 * t97 * t163 * t173 + 0.3e1 / 0.4e1 * t101 * t163 * t173 - 0.3e1 / 0.4e2 * t105 * t163 * t173 + t109 * t163 * t173 / 0.192e3 - t113 * t163 * t173 / 0.3584e4 + t117 * t163 * t173 / 0.8192e5 - t121 * t163 * t173 / 0.221184e7 + t335 * t163 * t173 / 0.688128e8;
  t549 = my_piecewise3(t29, 0, t447);
  t558 = t215 * t215;
  t575 = t207 * t207;
  t584 = t65 * t343;
  t612 = 0.85e2 / 0.4e1 * t359 * t558 * t65 - 0.19e2 / 0.8e1 / t358 / t62 * t558 * t65 + t132 * t549 * t65 / 0.2e1 + 0.1e1 / t358 / t212 * t558 * t65 / 0.16e2 - 0.12e2 * t575 * t66 - 0.16e2 * t399 * t343 - 0.4e1 * t136 * t549 - t58 * t549 * t65 - 0.8e1 * t379 * t584 - 0.15e2 * t383 * t215 * t355 + t235 * t343 * t391 + 0.3e1 / 0.4e1 * t235 * t575 * t65 + 0.3e1 / 0.4e1 * t395 * t207 * t215 * t65 - 0.3e1 * t63 * t575 * t65 - 0.4e1 * t402 * t584 - 0.75e2 / 0.2e1 * t235 * t558 * t65 + 0.45e2 * t216 * t355 - 0.6e1 * t227 * t575 * t65;
  t656 = 0.2e1 * t56 * t612 - t127 * t549 + 0.15e2 / 0.4e1 * t395 * t558 * t65 - 0.1e1 / t358 / t131 * t558 * t65 / 0.8e1 + 0.24e2 * t65 * t214 * t558 - 0.36e2 * t363 * t215 * t207 + 0.6e1 * t219 * t575 + 0.8e1 * t219 * t125 * t343 - 0.24e2 * t383 * t558 * t65 + 0.21e2 * t236 * t355 - 0.3e1 / 0.2e1 * t214 * t575 * t65 - 0.2e1 * t354 * t584 - 0.3e1 / 0.2e1 * t359 * t215 * t355 + 0.2e1 * t549 * t69 + 0.8e1 * t343 * t141 + 0.12e2 * t207 * t247 + 0.8e1 * t125 * t409;
  t660 = my_piecewise3(t28, t488 + t547, -0.8e1 / 0.3e1 * t549 * t72 - 0.32e2 / 0.3e1 * t343 * t144 - 0.16e2 * t207 * t250 - 0.32e2 / 0.3e1 * t125 * t412 - 0.8e1 / 0.3e1 * t56 * t656);
  tv4rho40 = -0.5e1 / 0.54e2 * t7 * t14 / t153 / t166 * t76 + 0.2e1 / 0.9e1 * t7 * t14 * t260 * t148 - t7 * t14 * t154 * t254 / 0.2e1 - t7 * t14 * t15 * t416 - 0.3e1 / 0.16e2 * t84 * t85 * t13 * t660;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;

  double t459, t462, t464, t467, t468, t469, t471, t475;
  double t476, t478, t479, t481, t482, t484, t485, t487;
  double t488, t490, t491, t492, t494, t495, t496, t500;
  double t501, t504, t506, t509, t510, t511, t516, t517;
  double t522, t523, t527, t528, t556, t561, t562, t567;
  double t569, t570, t571, t574, t582, t590, t591, t602;
  double t605, t609, t610, t612, t613, t614, t617, t621;
  double t622, t624, t625, t627, t628, t630, t631, t632;
  double t634, t635, t636, t638, t639, t640, t645, t647;
  double t650, t651, t652, t657, t658, t663, t664, t668;
  double t669, t697, t702, t703, t708, t710, t711, t712;
  double t715, t723, t731, t732, t743, t746, t750, t751;
  double t753, t754, t755, tv2rho20, t759, t763, t764, t766;
  double t769, t772, t777, t779, t781, t783, t788, t791;
  double t792, t793, t797, t800, t804, t805, t809, t810;
  double t813, t816, t818, t821, t823, t826, t828, t831;
  double t833, t836, t838, t841, t843, t846, t848, t849;
  double t853, t854, t857, t867, t868, t874, t877, t880;
  double t886, t889, t893, t894, t896, t900, t904, t905;
  double t907, t910, t913, t918, t920, t922, t924, t929;
  double t931, t932, t936, t939, t943, t944, t948, t949;
  double t952, t955, t957, t960, t962, t965, t967, t970;
  double t972, t975, t977, t980, t982, t985, t987, t988;
  double t992, t993, t996, t1006, t1007, t1013, t1016, t1019;
  double t1025, t1028, t1032, t1033, t1035, t1037, tv2rho21, t1043;
  double t1047, t1051, t1052, t1054, t1055, t1056, t1058, t1059;
  double t1060, t1061, t1065, t1066, t1070, t1072, t1075, t1076;
  double t1080, t1081, t1084, t1086, t1088, t1090, t1092, t1094;
  double t1096, t1098, t1100, t1102, t1104, t1106, t1108, t1110;
  double t1112, t1113, t1118, t1119, t1135, t1146, t1149, t1153;
  double t1154, t1156, t1157, t1158, t1161, t1165, t1166, t1168;
  double t1169, t1170, t1172, t1173, t1174, t1175, t1179, t1180;
  double t1184, t1186, t1189, t1190, t1194, t1195, t1198, t1200;
  double t1202, t1204, t1206, t1208, t1210, t1212, t1214, t1216;
  double t1218, t1220, t1222, t1224, t1226, t1227, t1232, t1233;
  double t1249, t1260, t1263, t1267, t1268, t1270, t1271, t1272;
  double tv2rho22;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t459 = t167 / 0.16e2;
  t462 = t259 / 0.16e2;
  t464 = t155 * t155;
  t467 = t152 * t11;
  t468 = 0.1e1 / t467;
  t469 = t10 * t468;
  t471 = -0.2e1 * t153 + 0.2e1 * t469;
  t475 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t464 + 0.4e1 / 0.3e1 * t18 * t471);
  t476 = t9 * t475;
  t478 = t7 * t476 * t84;
  t479 = 0.3e1 / 0.32e2 * t478;
  t481 = t7 * t159 * t165;
  t482 = t481 / 0.16e2;
  t484 = t7 * t159 * t245;
  t485 = 0.3e1 / 0.16e2 * t484;
  t487 = 0.1e1 / t163 / t11;
  t488 = t487 * t83;
  t490 = t7 * t21 * t488;
  t491 = t490 / 0.48e2;
  t492 = t164 * t244;
  t494 = t7 * t21 * t492;
  t495 = t494 / 0.16e2;
  t496 = t189 * t189;
  t500 = 0.1e1 / t22 / t152;
  t501 = t1 * t500;
  t504 = 0.2e1 / 0.81e2 * t27 * t501 * t31;
  t506 = t27 * t173 * t184;
  t509 = 0.1e1 / t177 / t30;
  t510 = t183 * t183;
  t511 = t509 * t510;
  t516 = 0.1e1 / t179 / t14;
  t517 = t516 * t464;
  t522 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t517 + t180 * t471 / 0.3e1);
  t523 = t178 * t522;
  t527 = t504 + t506 / 0.27e2 + t27 * t29 * t511 / 0.9e1 - t27 * t29 * t523 / 0.18e2;
  t528 = my_piecewise3(t36, t527, 0);
  t556 = 0.1e1 / t59 / t38;
  t561 = t42 * t496 / 0.6e1 - t170 * t528 / 0.18e2 - t45 * t496 / 0.48e2 + t193 * t528 / 0.24e3 + t48 * t496 / 0.64e3 - t197 * t528 / 0.448e4 - t51 * t496 / 0.1152e5 + t201 * t528 / 0.10368e6 + t54 * t496 / 0.258048e6 - t205 * t528 / 0.2838528e7 - t57 * t496 / 0.688128e7 + t209 * t528 / 0.8945664e8 + t60 * t496 / 0.21233664e9 - t213 * t528 / 0.31850496e10 - t556 * t496 / 0.74317824e10 + t217 * t528 / 0.1263403008e12;
  t562 = my_piecewise3(t36, 0, t527);
  t567 = t69 * t69;
  t569 = 0.1e1 / t567 / t63;
  t570 = t221 * t221;
  t571 = t569 * t570;
  t574 = t72 * t228;
  t582 = 0.1e1 / t567;
  t590 = 0.1e1 / t567 / t69;
  t591 = t590 * t570;
  t602 = -0.2e1 * t582 * t570 * t72 + t228 * t562 * t72 / 0.2e1 + t591 * t72 / 0.4e1 - 0.4e1 * t570 * t73 - t70 * t570 * t72 - 0.4e1 * t232 * t562 - t65 * t562 * t72;
  t605 = -t571 * t72 / 0.2e1 + 0.2e1 * t574 * t570 - t223 * t562 + 0.2e1 * t562 * t76 + 0.4e1 * t221 * t237 + 0.2e1 * t63 * t602;
  t609 = my_piecewise3(t35, t561, -0.8e1 / 0.3e1 * t562 * t79 - 0.16e2 / 0.3e1 * t221 * t240 - 0.8e1 / 0.3e1 * t63 * t605);
  t610 = t22 * t609;
  t612 = t7 * t21 * t610;
  t613 = 0.3e1 / 0.32e2 * t612;
  t614 = t249 * t249;
  t617 = -t471;
  t621 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t614 + 0.4e1 / 0.3e1 * t89 * t617);
  t622 = t9 * t621;
  t624 = t7 * t622 * t146;
  t625 = 0.3e1 / 0.32e2 * t624;
  t627 = t7 * t253 * t257;
  t628 = t627 / 0.16e2;
  t630 = t7 * t253 * t334;
  t631 = 0.3e1 / 0.16e2 * t630;
  t632 = t487 * t145;
  t634 = t7 * t92 * t632;
  t635 = t634 / 0.48e2;
  t636 = t164 * t333;
  t638 = t7 * t92 * t636;
  t639 = t638 / 0.16e2;
  t640 = t278 * t278;
  t645 = 0.2e1 / 0.81e2 * t27 * t501 * t94;
  t647 = t27 * t173 * t273;
  t650 = 0.1e1 / t266 / t93;
  t651 = t272 * t272;
  t652 = t650 * t651;
  t657 = 0.1e1 / t268 / t87;
  t658 = t657 * t614;
  t663 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t658 + t269 * t617 / 0.3e1);
  t664 = t267 * t663;
  t668 = t645 + t647 / 0.27e2 + t27 * t29 * t652 / 0.9e1 - t27 * t29 * t664 / 0.18e2;
  t669 = my_piecewise3(t99, t668, 0);
  t697 = 0.1e1 / t122 / t101;
  t702 = t105 * t640 / 0.6e1 - t262 * t669 / 0.18e2 - t108 * t640 / 0.48e2 + t282 * t669 / 0.24e3 + t111 * t640 / 0.64e3 - t286 * t669 / 0.448e4 - t114 * t640 / 0.1152e5 + t290 * t669 / 0.10368e6 + t117 * t640 / 0.258048e6 - t294 * t669 / 0.2838528e7 - t120 * t640 / 0.688128e7 + t298 * t669 / 0.8945664e8 + t123 * t640 / 0.21233664e9 - t302 * t669 / 0.31850496e10 - t697 * t640 / 0.74317824e10 + t306 * t669 / 0.1263403008e12;
  t703 = my_piecewise3(t99, 0, t668);
  t708 = t131 * t131;
  t710 = 0.1e1 / t708 / t126;
  t711 = t310 * t310;
  t712 = t710 * t711;
  t715 = t134 * t317;
  t723 = 0.1e1 / t708;
  t731 = 0.1e1 / t708 / t131;
  t732 = t731 * t711;
  t743 = -0.2e1 * t723 * t711 * t134 + t317 * t703 * t134 / 0.2e1 + t732 * t134 / 0.4e1 - 0.4e1 * t711 * t135 - t132 * t711 * t134 - 0.4e1 * t321 * t703 - t127 * t703 * t134;
  t746 = -t712 * t134 / 0.2e1 + 0.2e1 * t715 * t711 - t312 * t703 + 0.2e1 * t703 * t138 + 0.4e1 * t310 * t326 + 0.2e1 * t126 * t743;
  t750 = my_piecewise3(t98, t702, -0.8e1 / 0.3e1 * t703 * t141 - 0.16e2 / 0.3e1 * t310 * t329 - 0.8e1 / 0.3e1 * t126 * t746);
  t751 = t22 * t750;
  t753 = t7 * t92 * t751;
  t754 = 0.3e1 / 0.32e2 * t753;
  t755 = -t479 - t482 - t485 + t491 - t495 - t613 - t625 - t628 - t631 + t635 - t639 - t754;
  tv2rho20 = -0.3e1 / 0.16e2 * t161 - t459 - 0.3e1 / 0.16e2 * t247 - 0.3e1 / 0.16e2 * t255 - t462 - 0.3e1 / 0.16e2 * t336 + t11 * t755;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t759 = t18 * t10;
  t763 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t348 * t155 + 0.8e1 / 0.3e1 * t759 * t468);
  t764 = t9 * t763;
  t766 = t7 * t764 * t84;
  t769 = t7 * t344 * t165;
  t772 = t7 * t344 * t245;
  t777 = t7 * t159 * t394;
  t779 = t164 * t393;
  t781 = t7 * t21 * t779;
  t783 = t42 * t356;
  t788 = t27 * t173 * t351;
  t791 = t26 * p->cam_omega * t1;
  t792 = t28 * t509;
  t793 = t350 * t183;
  t797 = t516 * t340;
  t800 = t180 * t10;
  t804 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t797 * t155 + 0.2e1 / 0.3e1 * t800 * t468);
  t805 = t178 * t804;
  t809 = t504 + t506 / 0.54e2 + t788 / 0.54e2 + t791 * t792 * t793 / 0.9e1 - t27 * t29 * t805 / 0.18e2;
  t810 = my_piecewise3(t36, t809, 0);
  t813 = t45 * t356;
  t816 = t193 * t810;
  t818 = t48 * t356;
  t821 = t197 * t810;
  t823 = t51 * t356;
  t826 = t201 * t810;
  t828 = t54 * t356;
  t831 = t205 * t810;
  t833 = t57 * t356;
  t836 = t209 * t810;
  t838 = t60 * t356;
  t841 = t213 * t810;
  t843 = t556 * t356;
  t846 = t217 * t810;
  t848 = t783 * t189 / 0.6e1 - t170 * t810 / 0.18e2 - t813 * t189 / 0.48e2 + t816 / 0.24e3 + t818 * t189 / 0.64e3 - t821 / 0.448e4 - t823 * t189 / 0.1152e5 + t826 / 0.10368e6 + t828 * t189 / 0.258048e6 - t831 / 0.2838528e7 - t833 * t189 / 0.688128e7 + t836 / 0.8945664e8 + t838 * t189 / 0.21233664e9 - t841 / 0.31850496e10 - t843 * t189 / 0.74317824e10 + t846 / 0.1263403008e12;
  t849 = my_piecewise3(t36, 0, t809);
  t853 = t569 * t221;
  t854 = t72 * t374;
  t857 = t374 * t221;
  t867 = t582 * t374;
  t868 = t72 * t221;
  t874 = t590 * t374;
  t877 = t221 * t73;
  t880 = t70 * t221;
  t886 = -0.2e1 * t867 * t868 + t228 * t849 * t72 / 0.2e1 + t874 * t868 / 0.4e1 - 0.4e1 * t877 * t374 - t880 * t854 - 0.4e1 * t232 * t849 - t65 * t849 * t72;
  t889 = -t853 * t854 / 0.2e1 + 0.2e1 * t574 * t857 - t223 * t849 + 0.2e1 * t849 * t76 + 0.2e1 * t374 * t237 + 0.2e1 * t221 * t386 + 0.2e1 * t63 * t886;
  t893 = my_piecewise3(t35, t848, -0.8e1 / 0.3e1 * t221 * t389 - 0.8e1 / 0.3e1 * t374 * t240 - 0.8e1 / 0.3e1 * t63 * t889 - 0.8e1 / 0.3e1 * t849 * t79);
  t894 = t22 * t893;
  t896 = t7 * t21 * t894;
  t900 = t89 * t10;
  t904 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t406 * t249 - 0.8e1 / 0.3e1 * t900 * t468);
  t905 = t9 * t904;
  t907 = t7 * t905 * t146;
  t910 = t7 * t402 * t257;
  t913 = t7 * t402 * t334;
  t918 = t7 * t253 * t452;
  t920 = t164 * t451;
  t922 = t7 * t92 * t920;
  t924 = t105 * t414;
  t929 = t27 * t173 * t409;
  t931 = t28 * t650;
  t932 = t408 * t272;
  t936 = t657 * t398;
  t939 = t269 * t10;
  t943 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t936 * t249 - 0.2e1 / 0.3e1 * t939 * t468);
  t944 = t267 * t943;
  t948 = t645 + t647 / 0.54e2 + t929 / 0.54e2 + t791 * t931 * t932 / 0.9e1 - t27 * t29 * t944 / 0.18e2;
  t949 = my_piecewise3(t99, t948, 0);
  t952 = t108 * t414;
  t955 = t282 * t949;
  t957 = t111 * t414;
  t960 = t286 * t949;
  t962 = t114 * t414;
  t965 = t290 * t949;
  t967 = t117 * t414;
  t970 = t294 * t949;
  t972 = t120 * t414;
  t975 = t298 * t949;
  t977 = t123 * t414;
  t980 = t302 * t949;
  t982 = t697 * t414;
  t985 = t306 * t949;
  t987 = t924 * t278 / 0.6e1 - t262 * t949 / 0.18e2 - t952 * t278 / 0.48e2 + t955 / 0.24e3 + t957 * t278 / 0.64e3 - t960 / 0.448e4 - t962 * t278 / 0.1152e5 + t965 / 0.10368e6 + t967 * t278 / 0.258048e6 - t970 / 0.2838528e7 - t972 * t278 / 0.688128e7 + t975 / 0.8945664e8 + t977 * t278 / 0.21233664e9 - t980 / 0.31850496e10 - t982 * t278 / 0.74317824e10 + t985 / 0.1263403008e12;
  t988 = my_piecewise3(t99, 0, t948);
  t992 = t710 * t310;
  t993 = t134 * t432;
  t996 = t432 * t310;
  t1006 = t723 * t432;
  t1007 = t134 * t310;
  t1013 = t731 * t432;
  t1016 = t310 * t135;
  t1019 = t132 * t310;
  t1025 = -0.2e1 * t1006 * t1007 + t317 * t988 * t134 / 0.2e1 + t1013 * t1007 / 0.4e1 - 0.4e1 * t1016 * t432 - t1019 * t993 - 0.4e1 * t321 * t988 - t127 * t988 * t134;
  t1028 = -t992 * t993 / 0.2e1 + 0.2e1 * t715 * t996 - t312 * t988 + 0.2e1 * t988 * t138 + 0.2e1 * t432 * t326 + 0.2e1 * t310 * t444 + 0.2e1 * t126 * t1025;
  t1032 = my_piecewise3(t98, t987, -0.8e1 / 0.3e1 * t126 * t1028 - 0.8e1 / 0.3e1 * t988 * t141 - 0.8e1 / 0.3e1 * t310 * t447 - 0.8e1 / 0.3e1 * t432 * t329);
  t1033 = t22 * t1032;
  t1035 = t7 * t92 * t1033;
  t1037 = -0.3e1 / 0.32e2 * t766 - t769 / 0.32e2 - 0.3e1 / 0.32e2 * t772 - t481 / 0.32e2 + t491 - t494 / 0.32e2 - 0.3e1 / 0.32e2 * t777 - t781 / 0.32e2 - 0.3e1 / 0.32e2 * t896 - 0.3e1 / 0.32e2 * t907 - t910 / 0.32e2 - 0.3e1 / 0.32e2 * t913 - t627 / 0.32e2 + t635 - t638 / 0.32e2 - 0.3e1 / 0.32e2 * t918 - t922 / 0.32e2 - 0.3e1 / 0.32e2 * t1035;
  tv2rho21 = t11 * t1037 - t162 - t248 - t256 - t337 - t347 - t397 - t405 - t455 - t459 - t462;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1043 = t340 * t340;
  t1047 = 0.2e1 * t153 + 0.2e1 * t469;
  t1051 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t1043 + 0.4e1 / 0.3e1 * t18 * t1047);
  t1052 = t9 * t1051;
  t1054 = t7 * t1052 * t84;
  t1055 = 0.3e1 / 0.32e2 * t1054;
  t1056 = t769 / 0.16e2;
  t1058 = t7 * t344 * t394;
  t1059 = 0.3e1 / 0.16e2 * t1058;
  t1060 = t781 / 0.16e2;
  t1061 = t356 * t356;
  t1065 = t350 * t350;
  t1066 = t509 * t1065;
  t1070 = t516 * t1043;
  t1072 = t180 * t1047;
  t1075 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t1070 + t1072 / 0.3e1);
  t1076 = t178 * t1075;
  t1080 = t504 + t788 / 0.27e2 + t27 * t29 * t1066 / 0.9e1 - t27 * t29 * t1076 / 0.18e2;
  t1081 = my_piecewise3(t36, t1080, 0);
  t1084 = t45 * t1061;
  t1086 = t193 * t1081;
  t1088 = t48 * t1061;
  t1090 = t197 * t1081;
  t1092 = t51 * t1061;
  t1094 = t201 * t1081;
  t1096 = t54 * t1061;
  t1098 = t205 * t1081;
  t1100 = t57 * t1061;
  t1102 = t209 * t1081;
  t1104 = t60 * t1061;
  t1106 = t213 * t1081;
  t1108 = t556 * t1061;
  t1110 = t217 * t1081;
  t1112 = t42 * t1061 / 0.6e1 - t170 * t1081 / 0.18e2 - t1084 / 0.48e2 + t1086 / 0.24e3 + t1088 / 0.64e3 - t1090 / 0.448e4 - t1092 / 0.1152e5 + t1094 / 0.10368e6 + t1096 / 0.258048e6 - t1098 / 0.2838528e7 - t1100 / 0.688128e7 + t1102 / 0.8945664e8 + t1104 / 0.21233664e9 - t1106 / 0.31850496e10 - t1108 / 0.74317824e10 + t1110 / 0.1263403008e12;
  t1113 = my_piecewise3(t36, 0, t1080);
  t1118 = t374 * t374;
  t1119 = t569 * t1118;
  t1135 = t590 * t1118;
  t1146 = -0.2e1 * t582 * t1118 * t72 + t228 * t1113 * t72 / 0.2e1 + t1135 * t72 / 0.4e1 - 0.4e1 * t1118 * t73 - t70 * t1118 * t72 - 0.4e1 * t232 * t1113 - t65 * t1113 * t72;
  t1149 = -t1119 * t72 / 0.2e1 + 0.2e1 * t574 * t1118 - t223 * t1113 + 0.2e1 * t1113 * t76 + 0.4e1 * t374 * t386 + 0.2e1 * t63 * t1146;
  t1153 = my_piecewise3(t35, t1112, -0.8e1 / 0.3e1 * t1113 * t79 - 0.16e2 / 0.3e1 * t374 * t389 - 0.8e1 / 0.3e1 * t63 * t1149);
  t1154 = t22 * t1153;
  t1156 = t7 * t21 * t1154;
  t1157 = 0.3e1 / 0.32e2 * t1156;
  t1158 = t398 * t398;
  t1161 = -t1047;
  t1165 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t1158 + 0.4e1 / 0.3e1 * t89 * t1161);
  t1166 = t9 * t1165;
  t1168 = t7 * t1166 * t146;
  t1169 = 0.3e1 / 0.32e2 * t1168;
  t1170 = t910 / 0.16e2;
  t1172 = t7 * t402 * t452;
  t1173 = 0.3e1 / 0.16e2 * t1172;
  t1174 = t922 / 0.16e2;
  t1175 = t414 * t414;
  t1179 = t408 * t408;
  t1180 = t650 * t1179;
  t1184 = t657 * t1158;
  t1186 = t269 * t1161;
  t1189 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t1184 + t1186 / 0.3e1);
  t1190 = t267 * t1189;
  t1194 = t645 + t929 / 0.27e2 + t27 * t29 * t1180 / 0.9e1 - t27 * t29 * t1190 / 0.18e2;
  t1195 = my_piecewise3(t99, t1194, 0);
  t1198 = t108 * t1175;
  t1200 = t282 * t1195;
  t1202 = t111 * t1175;
  t1204 = t286 * t1195;
  t1206 = t114 * t1175;
  t1208 = t290 * t1195;
  t1210 = t117 * t1175;
  t1212 = t294 * t1195;
  t1214 = t120 * t1175;
  t1216 = t298 * t1195;
  t1218 = t123 * t1175;
  t1220 = t302 * t1195;
  t1222 = t697 * t1175;
  t1224 = t306 * t1195;
  t1226 = t105 * t1175 / 0.6e1 - t262 * t1195 / 0.18e2 - t1198 / 0.48e2 + t1200 / 0.24e3 + t1202 / 0.64e3 - t1204 / 0.448e4 - t1206 / 0.1152e5 + t1208 / 0.10368e6 + t1210 / 0.258048e6 - t1212 / 0.2838528e7 - t1214 / 0.688128e7 + t1216 / 0.8945664e8 + t1218 / 0.21233664e9 - t1220 / 0.31850496e10 - t1222 / 0.74317824e10 + t1224 / 0.1263403008e12;
  t1227 = my_piecewise3(t99, 0, t1194);
  t1232 = t432 * t432;
  t1233 = t710 * t1232;
  t1249 = t731 * t1232;
  t1260 = -0.2e1 * t723 * t1232 * t134 + t317 * t1227 * t134 / 0.2e1 + t1249 * t134 / 0.4e1 - 0.4e1 * t1232 * t135 - t132 * t1232 * t134 - 0.4e1 * t321 * t1227 - t127 * t1227 * t134;
  t1263 = -t1233 * t134 / 0.2e1 + 0.2e1 * t715 * t1232 - t312 * t1227 + 0.2e1 * t1227 * t138 + 0.4e1 * t432 * t444 + 0.2e1 * t126 * t1260;
  t1267 = my_piecewise3(t98, t1226, -0.8e1 / 0.3e1 * t1227 * t141 - 0.16e2 / 0.3e1 * t432 * t447 - 0.8e1 / 0.3e1 * t126 * t1263);
  t1268 = t22 * t1267;
  t1270 = t7 * t92 * t1268;
  t1271 = 0.3e1 / 0.32e2 * t1270;
  t1272 = -t1055 - t1056 - t1059 + t491 - t1060 - t1157 - t1169 - t1170 - t1173 + t635 - t1174 - t1271;
  tv2rho22 = -0.3e1 / 0.16e2 * t346 - t459 - 0.3e1 / 0.16e2 * t396 - 0.3e1 / 0.16e2 * t404 - t462 - 0.3e1 / 0.16e2 * t454 + t11 * t1272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;

  double t459, t462, t464, t467, t468, t469, t471, t475;
  double t476, t478, t479, t481, t482, t484, t485, t487;
  double t488, t490, t491, t492, t494, t495, t496, t500;
  double t501, t504, t506, t509, t510, t511, t516, t517;
  double t522, t523, t527, t528, t556, t561, t562, t567;
  double t569, t570, t571, t574, t582, t590, t591, t602;
  double t605, t609, t610, t612, t613, t614, t617, t621;
  double t622, t624, t625, t627, t628, t630, t631, t632;
  double t634, t635, t636, t638, t639, t640, t645, t647;
  double t650, t651, t652, t657, t658, t663, t664, t668;
  double t669, t697, t702, t703, t708, t710, t711, t712;
  double t715, t723, t731, t732, t743, t746, t750, t751;
  double t753, t754, t755, tv2rho20, t759, t763, t764, t766;
  double t769, t772, t777, t779, t781, t783, t788, t791;
  double t792, t793, t797, t800, t804, t805, t809, t810;
  double t813, t816, t818, t821, t823, t826, t828, t831;
  double t833, t836, t838, t841, t843, t846, t848, t849;
  double t853, t854, t857, t867, t868, t874, t877, t880;
  double t886, t889, t893, t894, t896, t900, t904, t905;
  double t907, t910, t913, t918, t920, t922, t924, t929;
  double t931, t932, t936, t939, t943, t944, t948, t949;
  double t952, t955, t957, t960, t962, t965, t967, t970;
  double t972, t975, t977, t980, t982, t985, t987, t988;
  double t992, t993, t996, t1006, t1007, t1013, t1016, t1019;
  double t1025, t1028, t1032, t1033, t1035, t1037, tv2rho21, t1043;
  double t1047, t1051, t1052, t1054, t1055, t1056, t1058, t1059;
  double t1060, t1061, t1065, t1066, t1070, t1072, t1075, t1076;
  double t1080, t1081, t1084, t1086, t1088, t1090, t1092, t1094;
  double t1096, t1098, t1100, t1102, t1104, t1106, t1108, t1110;
  double t1112, t1113, t1118, t1119, t1135, t1146, t1149, t1153;
  double t1154, t1156, t1157, t1158, t1161, t1165, t1166, t1168;
  double t1169, t1170, t1172, t1173, t1174, t1175, t1179, t1180;
  double t1184, t1186, t1189, t1190, t1194, t1195, t1198, t1200;
  double t1202, t1204, t1206, t1208, t1210, t1212, t1214, t1216;
  double t1218, t1220, t1222, t1224, t1226, t1227, t1232, t1233;
  double t1249, t1260, t1263, t1267, t1268, t1270, t1271, t1272;
  double tv2rho22;

  double t1275, t1276, t1278, t1279, t1281, t1282, t1284, t1287;
  double t1290, t1291, t1292, t1294, t1295, t1296, t1301, t1302;
  double t1303, t1305, t1309, t1310, t1312, t1313, t1315, t1316;
  double t1318, t1321, t1322, t1323, t1325, t1326, t1327, t1329;
  double t1333, t1336, t1338, t1341, t1344, t1346, t1347, t1348;
  double t1349, t1353, t1357, t1359, t1362, t1368, t1369, t1373;
  double t1374, t1391, t1402, t1429, t1435, t1437, t1444, t1448;
  double t1451, t1452, t1456, t1472, t1476, t1477, t1487, t1488;
  double t1499, t1502, t1506, t1507, t1509, t1510, t1511, t1516;
  double t1520, t1521, t1523, t1524, t1526, t1527, t1529, t1532;
  double t1533, t1534, t1536, t1537, t1538, t1540, t1544, t1546;
  double t1549, t1552, t1554, t1555, t1556, t1557, t1561, t1565;
  double t1567, t1570, t1576, t1577, t1581, t1582, t1599, t1610;
  double t1632, t1643, t1645, t1652, t1656, t1659, t1660, t1664;
  double t1667, t1680, t1684, t1685, t1695, t1696, t1707, t1710;
  double t1714, t1715, t1717, t1718, t1719, t1722, t1724, tv3rho30;
  double t1737, t1749, t1750, t1751, t1753, t1756, t1757, t1759;
  double t1762, t1763, t1764, t1766, t1768, t1770, t1771, t1773;
  double t1777, t1787, t1788, t1790, t1793, t1796, t1797, t1799;
  double t1802, t1805, t1807, t1809, t1810, t1811, t1816, t1821;
  double t1826, t1831, t1836, t1841, t1846, t1851, t1866, t1873;
  double t1875, t1878, t1881, t1882, t1883, t1887, t1891, t1895;
  double t1898, t1903, t1908, t1909, t1913, t1914, t1931, t1933;
  double t1946, t1949, t1952, t1974, t1975, t1978, t1981, t1989;
  double t1994, t1997, t2002, t2010, t2013, t2017, t2018, t2020;
  double t2024, t2034, t2035, t2037, t2040, t2043, t2044, t2046;
  double t2049, t2052, t2054, t2056, t2057, t2058, t2063, t2068;
  double t2073, t2078, t2083, t2088, t2093, t2098, t2113, t2120;
  double t2122, t2125, t2128, t2129, t2130, t2134, t2138, t2142;
  double t2145, t2150, t2155, t2156, t2160, t2161, t2178, t2180;
  double t2193, t2196, t2199, t2221, t2222, t2225, t2228, t2236;
  double t2241, t2244, t2249, t2257, t2260, t2264, t2265, t2267;
  double t2269, t2272, t2273, t2274, t2275, t2276, t2277, t2278;
  double t2279, t2280, tv3rho31, t2289, t2290, t2292, t2295, t2298;
  double t2300, t2302, t2305, t2308, t2311, t2313, t2318, t2321;
  double t2326, t2329, t2334, t2337, t2342, t2345, t2350, t2353;
  double t2356, t2359, t2362, t2367, t2370, t2375, t2381, t2383;
  double t2387, t2392, t2394, t2398, t2403, t2408, t2409, t2412;
  double t2413, t2417, t2418, t2435, t2437, t2451, t2460, t2481;
  double t2484, t2490, t2495, t2498, t2501, t2511, t2514, t2518;
  double t2519, t2521, t2529, t2533, t2534, t2536, t2539, t2542;
  double t2545, t2548, t2552, t2555, t2560, t2563, t2568, t2571;
  double t2576, t2579, t2584, t2587, t2592, t2593, t2596, t2601;
  double t2604, t2609, t2612, t2618, t2620, t2624, t2629, t2631;
  double t2635, t2640, t2643, t2646, t2647, t2651, t2652, t2669;
  double t2671, t2685, t2694, t2715, t2718, t2724, t2729, t2732;
  double t2735, t2745, t2748, t2752, t2753, t2755, t2766, t2767;
  double t2769, t2772, t2775, t2778, t2780, t2785, t2788, tv3rho32;
  double t2795, t2801, t2805, t2806, t2808, t2809, t2811, t2812;
  double t2814, t2815, t2819, t2820, t2824, t2828, t2832, t2835;
  double t2836, t2840, t2841, t2858, t2867, t2892, t2894, t2901;
  double t2902, t2907, t2912, t2927, t2935, t2946, t2949, t2953;
  double t2954, t2956, t2957, t2958, t2963, t2967, t2968, t2970;
  double t2971, t2973, t2974, t2976, t2977, t2981, t2982, t2986;
  double t2990, t2994, t2997, t2998, t3002, t3003, t3014, t3029;
  double t3054, t3056, t3063, t3064, t3069, t3074, t3089, t3097;
  double t3108, t3111, t3115, t3116, t3118, t3119, t3120, t3121;
  double t3122, t3123, t3124, tv3rho33;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t459 = t167 / 0.16e2;
  t462 = t259 / 0.16e2;
  t464 = t155 * t155;
  t467 = t152 * t11;
  t468 = 0.1e1 / t467;
  t469 = t10 * t468;
  t471 = -0.2e1 * t153 + 0.2e1 * t469;
  t475 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t464 + 0.4e1 / 0.3e1 * t18 * t471);
  t476 = t9 * t475;
  t478 = t7 * t476 * t84;
  t479 = 0.3e1 / 0.32e2 * t478;
  t481 = t7 * t159 * t165;
  t482 = t481 / 0.16e2;
  t484 = t7 * t159 * t245;
  t485 = 0.3e1 / 0.16e2 * t484;
  t487 = 0.1e1 / t163 / t11;
  t488 = t487 * t83;
  t490 = t7 * t21 * t488;
  t491 = t490 / 0.48e2;
  t492 = t164 * t244;
  t494 = t7 * t21 * t492;
  t495 = t494 / 0.16e2;
  t496 = t189 * t189;
  t500 = 0.1e1 / t22 / t152;
  t501 = t1 * t500;
  t504 = 0.2e1 / 0.81e2 * t27 * t501 * t31;
  t506 = t27 * t173 * t184;
  t509 = 0.1e1 / t177 / t30;
  t510 = t183 * t183;
  t511 = t509 * t510;
  t516 = 0.1e1 / t179 / t14;
  t517 = t516 * t464;
  t522 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t517 + t180 * t471 / 0.3e1);
  t523 = t178 * t522;
  t527 = t504 + t506 / 0.27e2 + t27 * t29 * t511 / 0.9e1 - t27 * t29 * t523 / 0.18e2;
  t528 = my_piecewise3(t36, t527, 0);
  t556 = 0.1e1 / t59 / t38;
  t561 = t42 * t496 / 0.6e1 - t170 * t528 / 0.18e2 - t45 * t496 / 0.48e2 + t193 * t528 / 0.24e3 + t48 * t496 / 0.64e3 - t197 * t528 / 0.448e4 - t51 * t496 / 0.1152e5 + t201 * t528 / 0.10368e6 + t54 * t496 / 0.258048e6 - t205 * t528 / 0.2838528e7 - t57 * t496 / 0.688128e7 + t209 * t528 / 0.8945664e8 + t60 * t496 / 0.21233664e9 - t213 * t528 / 0.31850496e10 - t556 * t496 / 0.74317824e10 + t217 * t528 / 0.1263403008e12;
  t562 = my_piecewise3(t36, 0, t527);
  t567 = t69 * t69;
  t569 = 0.1e1 / t567 / t63;
  t570 = t221 * t221;
  t571 = t569 * t570;
  t574 = t72 * t228;
  t582 = 0.1e1 / t567;
  t590 = 0.1e1 / t567 / t69;
  t591 = t590 * t570;
  t602 = -0.2e1 * t582 * t570 * t72 + t228 * t562 * t72 / 0.2e1 + t591 * t72 / 0.4e1 - 0.4e1 * t570 * t73 - t70 * t570 * t72 - 0.4e1 * t232 * t562 - t65 * t562 * t72;
  t605 = -t571 * t72 / 0.2e1 + 0.2e1 * t574 * t570 - t223 * t562 + 0.2e1 * t562 * t76 + 0.4e1 * t221 * t237 + 0.2e1 * t63 * t602;
  t609 = my_piecewise3(t35, t561, -0.8e1 / 0.3e1 * t562 * t79 - 0.16e2 / 0.3e1 * t221 * t240 - 0.8e1 / 0.3e1 * t63 * t605);
  t610 = t22 * t609;
  t612 = t7 * t21 * t610;
  t613 = 0.3e1 / 0.32e2 * t612;
  t614 = t249 * t249;
  t617 = -t471;
  t621 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t614 + 0.4e1 / 0.3e1 * t89 * t617);
  t622 = t9 * t621;
  t624 = t7 * t622 * t146;
  t625 = 0.3e1 / 0.32e2 * t624;
  t627 = t7 * t253 * t257;
  t628 = t627 / 0.16e2;
  t630 = t7 * t253 * t334;
  t631 = 0.3e1 / 0.16e2 * t630;
  t632 = t487 * t145;
  t634 = t7 * t92 * t632;
  t635 = t634 / 0.48e2;
  t636 = t164 * t333;
  t638 = t7 * t92 * t636;
  t639 = t638 / 0.16e2;
  t640 = t278 * t278;
  t645 = 0.2e1 / 0.81e2 * t27 * t501 * t94;
  t647 = t27 * t173 * t273;
  t650 = 0.1e1 / t266 / t93;
  t651 = t272 * t272;
  t652 = t650 * t651;
  t657 = 0.1e1 / t268 / t87;
  t658 = t657 * t614;
  t663 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t658 + t269 * t617 / 0.3e1);
  t664 = t267 * t663;
  t668 = t645 + t647 / 0.27e2 + t27 * t29 * t652 / 0.9e1 - t27 * t29 * t664 / 0.18e2;
  t669 = my_piecewise3(t99, t668, 0);
  t697 = 0.1e1 / t122 / t101;
  t702 = t105 * t640 / 0.6e1 - t262 * t669 / 0.18e2 - t108 * t640 / 0.48e2 + t282 * t669 / 0.24e3 + t111 * t640 / 0.64e3 - t286 * t669 / 0.448e4 - t114 * t640 / 0.1152e5 + t290 * t669 / 0.10368e6 + t117 * t640 / 0.258048e6 - t294 * t669 / 0.2838528e7 - t120 * t640 / 0.688128e7 + t298 * t669 / 0.8945664e8 + t123 * t640 / 0.21233664e9 - t302 * t669 / 0.31850496e10 - t697 * t640 / 0.74317824e10 + t306 * t669 / 0.1263403008e12;
  t703 = my_piecewise3(t99, 0, t668);
  t708 = t131 * t131;
  t710 = 0.1e1 / t708 / t126;
  t711 = t310 * t310;
  t712 = t710 * t711;
  t715 = t134 * t317;
  t723 = 0.1e1 / t708;
  t731 = 0.1e1 / t708 / t131;
  t732 = t731 * t711;
  t743 = -0.2e1 * t723 * t711 * t134 + t317 * t703 * t134 / 0.2e1 + t732 * t134 / 0.4e1 - 0.4e1 * t711 * t135 - t132 * t711 * t134 - 0.4e1 * t321 * t703 - t127 * t703 * t134;
  t746 = -t712 * t134 / 0.2e1 + 0.2e1 * t715 * t711 - t312 * t703 + 0.2e1 * t703 * t138 + 0.4e1 * t310 * t326 + 0.2e1 * t126 * t743;
  t750 = my_piecewise3(t98, t702, -0.8e1 / 0.3e1 * t703 * t141 - 0.16e2 / 0.3e1 * t310 * t329 - 0.8e1 / 0.3e1 * t126 * t746);
  t751 = t22 * t750;
  t753 = t7 * t92 * t751;
  t754 = 0.3e1 / 0.32e2 * t753;
  t755 = -t479 - t482 - t485 + t491 - t495 - t613 - t625 - t628 - t631 + t635 - t639 - t754;
  tv2rho20 = -0.3e1 / 0.16e2 * t161 - t459 - 0.3e1 / 0.16e2 * t247 - 0.3e1 / 0.16e2 * t255 - t462 - 0.3e1 / 0.16e2 * t336 + t11 * t755;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t759 = t18 * t10;
  t763 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t348 * t155 + 0.8e1 / 0.3e1 * t759 * t468);
  t764 = t9 * t763;
  t766 = t7 * t764 * t84;
  t769 = t7 * t344 * t165;
  t772 = t7 * t344 * t245;
  t777 = t7 * t159 * t394;
  t779 = t164 * t393;
  t781 = t7 * t21 * t779;
  t783 = t42 * t356;
  t788 = t27 * t173 * t351;
  t791 = t26 * p->cam_omega * t1;
  t792 = t28 * t509;
  t793 = t350 * t183;
  t797 = t516 * t340;
  t800 = t180 * t10;
  t804 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t797 * t155 + 0.2e1 / 0.3e1 * t800 * t468);
  t805 = t178 * t804;
  t809 = t504 + t506 / 0.54e2 + t788 / 0.54e2 + t791 * t792 * t793 / 0.9e1 - t27 * t29 * t805 / 0.18e2;
  t810 = my_piecewise3(t36, t809, 0);
  t813 = t45 * t356;
  t816 = t193 * t810;
  t818 = t48 * t356;
  t821 = t197 * t810;
  t823 = t51 * t356;
  t826 = t201 * t810;
  t828 = t54 * t356;
  t831 = t205 * t810;
  t833 = t57 * t356;
  t836 = t209 * t810;
  t838 = t60 * t356;
  t841 = t213 * t810;
  t843 = t556 * t356;
  t846 = t217 * t810;
  t848 = t783 * t189 / 0.6e1 - t170 * t810 / 0.18e2 - t813 * t189 / 0.48e2 + t816 / 0.24e3 + t818 * t189 / 0.64e3 - t821 / 0.448e4 - t823 * t189 / 0.1152e5 + t826 / 0.10368e6 + t828 * t189 / 0.258048e6 - t831 / 0.2838528e7 - t833 * t189 / 0.688128e7 + t836 / 0.8945664e8 + t838 * t189 / 0.21233664e9 - t841 / 0.31850496e10 - t843 * t189 / 0.74317824e10 + t846 / 0.1263403008e12;
  t849 = my_piecewise3(t36, 0, t809);
  t853 = t569 * t221;
  t854 = t72 * t374;
  t857 = t374 * t221;
  t867 = t582 * t374;
  t868 = t72 * t221;
  t874 = t590 * t374;
  t877 = t221 * t73;
  t880 = t70 * t221;
  t886 = -0.2e1 * t867 * t868 + t228 * t849 * t72 / 0.2e1 + t874 * t868 / 0.4e1 - 0.4e1 * t877 * t374 - t880 * t854 - 0.4e1 * t232 * t849 - t65 * t849 * t72;
  t889 = -t853 * t854 / 0.2e1 + 0.2e1 * t574 * t857 - t223 * t849 + 0.2e1 * t849 * t76 + 0.2e1 * t374 * t237 + 0.2e1 * t221 * t386 + 0.2e1 * t63 * t886;
  t893 = my_piecewise3(t35, t848, -0.8e1 / 0.3e1 * t221 * t389 - 0.8e1 / 0.3e1 * t374 * t240 - 0.8e1 / 0.3e1 * t63 * t889 - 0.8e1 / 0.3e1 * t849 * t79);
  t894 = t22 * t893;
  t896 = t7 * t21 * t894;
  t900 = t89 * t10;
  t904 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t406 * t249 - 0.8e1 / 0.3e1 * t900 * t468);
  t905 = t9 * t904;
  t907 = t7 * t905 * t146;
  t910 = t7 * t402 * t257;
  t913 = t7 * t402 * t334;
  t918 = t7 * t253 * t452;
  t920 = t164 * t451;
  t922 = t7 * t92 * t920;
  t924 = t105 * t414;
  t929 = t27 * t173 * t409;
  t931 = t28 * t650;
  t932 = t408 * t272;
  t936 = t657 * t398;
  t939 = t269 * t10;
  t943 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t936 * t249 - 0.2e1 / 0.3e1 * t939 * t468);
  t944 = t267 * t943;
  t948 = t645 + t647 / 0.54e2 + t929 / 0.54e2 + t791 * t931 * t932 / 0.9e1 - t27 * t29 * t944 / 0.18e2;
  t949 = my_piecewise3(t99, t948, 0);
  t952 = t108 * t414;
  t955 = t282 * t949;
  t957 = t111 * t414;
  t960 = t286 * t949;
  t962 = t114 * t414;
  t965 = t290 * t949;
  t967 = t117 * t414;
  t970 = t294 * t949;
  t972 = t120 * t414;
  t975 = t298 * t949;
  t977 = t123 * t414;
  t980 = t302 * t949;
  t982 = t697 * t414;
  t985 = t306 * t949;
  t987 = t924 * t278 / 0.6e1 - t262 * t949 / 0.18e2 - t952 * t278 / 0.48e2 + t955 / 0.24e3 + t957 * t278 / 0.64e3 - t960 / 0.448e4 - t962 * t278 / 0.1152e5 + t965 / 0.10368e6 + t967 * t278 / 0.258048e6 - t970 / 0.2838528e7 - t972 * t278 / 0.688128e7 + t975 / 0.8945664e8 + t977 * t278 / 0.21233664e9 - t980 / 0.31850496e10 - t982 * t278 / 0.74317824e10 + t985 / 0.1263403008e12;
  t988 = my_piecewise3(t99, 0, t948);
  t992 = t710 * t310;
  t993 = t134 * t432;
  t996 = t432 * t310;
  t1006 = t723 * t432;
  t1007 = t134 * t310;
  t1013 = t731 * t432;
  t1016 = t310 * t135;
  t1019 = t132 * t310;
  t1025 = -0.2e1 * t1006 * t1007 + t317 * t988 * t134 / 0.2e1 + t1013 * t1007 / 0.4e1 - 0.4e1 * t1016 * t432 - t1019 * t993 - 0.4e1 * t321 * t988 - t127 * t988 * t134;
  t1028 = -t992 * t993 / 0.2e1 + 0.2e1 * t715 * t996 - t312 * t988 + 0.2e1 * t988 * t138 + 0.2e1 * t432 * t326 + 0.2e1 * t310 * t444 + 0.2e1 * t126 * t1025;
  t1032 = my_piecewise3(t98, t987, -0.8e1 / 0.3e1 * t126 * t1028 - 0.8e1 / 0.3e1 * t988 * t141 - 0.8e1 / 0.3e1 * t310 * t447 - 0.8e1 / 0.3e1 * t432 * t329);
  t1033 = t22 * t1032;
  t1035 = t7 * t92 * t1033;
  t1037 = -0.3e1 / 0.32e2 * t766 - t769 / 0.32e2 - 0.3e1 / 0.32e2 * t772 - t481 / 0.32e2 + t491 - t494 / 0.32e2 - 0.3e1 / 0.32e2 * t777 - t781 / 0.32e2 - 0.3e1 / 0.32e2 * t896 - 0.3e1 / 0.32e2 * t907 - t910 / 0.32e2 - 0.3e1 / 0.32e2 * t913 - t627 / 0.32e2 + t635 - t638 / 0.32e2 - 0.3e1 / 0.32e2 * t918 - t922 / 0.32e2 - 0.3e1 / 0.32e2 * t1035;
  tv2rho21 = t11 * t1037 - t162 - t248 - t256 - t337 - t347 - t397 - t405 - t455 - t459 - t462;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1043 = t340 * t340;
  t1047 = 0.2e1 * t153 + 0.2e1 * t469;
  t1051 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t1043 + 0.4e1 / 0.3e1 * t18 * t1047);
  t1052 = t9 * t1051;
  t1054 = t7 * t1052 * t84;
  t1055 = 0.3e1 / 0.32e2 * t1054;
  t1056 = t769 / 0.16e2;
  t1058 = t7 * t344 * t394;
  t1059 = 0.3e1 / 0.16e2 * t1058;
  t1060 = t781 / 0.16e2;
  t1061 = t356 * t356;
  t1065 = t350 * t350;
  t1066 = t509 * t1065;
  t1070 = t516 * t1043;
  t1072 = t180 * t1047;
  t1075 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t1070 + t1072 / 0.3e1);
  t1076 = t178 * t1075;
  t1080 = t504 + t788 / 0.27e2 + t27 * t29 * t1066 / 0.9e1 - t27 * t29 * t1076 / 0.18e2;
  t1081 = my_piecewise3(t36, t1080, 0);
  t1084 = t45 * t1061;
  t1086 = t193 * t1081;
  t1088 = t48 * t1061;
  t1090 = t197 * t1081;
  t1092 = t51 * t1061;
  t1094 = t201 * t1081;
  t1096 = t54 * t1061;
  t1098 = t205 * t1081;
  t1100 = t57 * t1061;
  t1102 = t209 * t1081;
  t1104 = t60 * t1061;
  t1106 = t213 * t1081;
  t1108 = t556 * t1061;
  t1110 = t217 * t1081;
  t1112 = t42 * t1061 / 0.6e1 - t170 * t1081 / 0.18e2 - t1084 / 0.48e2 + t1086 / 0.24e3 + t1088 / 0.64e3 - t1090 / 0.448e4 - t1092 / 0.1152e5 + t1094 / 0.10368e6 + t1096 / 0.258048e6 - t1098 / 0.2838528e7 - t1100 / 0.688128e7 + t1102 / 0.8945664e8 + t1104 / 0.21233664e9 - t1106 / 0.31850496e10 - t1108 / 0.74317824e10 + t1110 / 0.1263403008e12;
  t1113 = my_piecewise3(t36, 0, t1080);
  t1118 = t374 * t374;
  t1119 = t569 * t1118;
  t1135 = t590 * t1118;
  t1146 = -0.2e1 * t582 * t1118 * t72 + t228 * t1113 * t72 / 0.2e1 + t1135 * t72 / 0.4e1 - 0.4e1 * t1118 * t73 - t70 * t1118 * t72 - 0.4e1 * t232 * t1113 - t65 * t1113 * t72;
  t1149 = -t1119 * t72 / 0.2e1 + 0.2e1 * t574 * t1118 - t223 * t1113 + 0.2e1 * t1113 * t76 + 0.4e1 * t374 * t386 + 0.2e1 * t63 * t1146;
  t1153 = my_piecewise3(t35, t1112, -0.8e1 / 0.3e1 * t1113 * t79 - 0.16e2 / 0.3e1 * t374 * t389 - 0.8e1 / 0.3e1 * t63 * t1149);
  t1154 = t22 * t1153;
  t1156 = t7 * t21 * t1154;
  t1157 = 0.3e1 / 0.32e2 * t1156;
  t1158 = t398 * t398;
  t1161 = -t1047;
  t1165 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t1158 + 0.4e1 / 0.3e1 * t89 * t1161);
  t1166 = t9 * t1165;
  t1168 = t7 * t1166 * t146;
  t1169 = 0.3e1 / 0.32e2 * t1168;
  t1170 = t910 / 0.16e2;
  t1172 = t7 * t402 * t452;
  t1173 = 0.3e1 / 0.16e2 * t1172;
  t1174 = t922 / 0.16e2;
  t1175 = t414 * t414;
  t1179 = t408 * t408;
  t1180 = t650 * t1179;
  t1184 = t657 * t1158;
  t1186 = t269 * t1161;
  t1189 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t1184 + t1186 / 0.3e1);
  t1190 = t267 * t1189;
  t1194 = t645 + t929 / 0.27e2 + t27 * t29 * t1180 / 0.9e1 - t27 * t29 * t1190 / 0.18e2;
  t1195 = my_piecewise3(t99, t1194, 0);
  t1198 = t108 * t1175;
  t1200 = t282 * t1195;
  t1202 = t111 * t1175;
  t1204 = t286 * t1195;
  t1206 = t114 * t1175;
  t1208 = t290 * t1195;
  t1210 = t117 * t1175;
  t1212 = t294 * t1195;
  t1214 = t120 * t1175;
  t1216 = t298 * t1195;
  t1218 = t123 * t1175;
  t1220 = t302 * t1195;
  t1222 = t697 * t1175;
  t1224 = t306 * t1195;
  t1226 = t105 * t1175 / 0.6e1 - t262 * t1195 / 0.18e2 - t1198 / 0.48e2 + t1200 / 0.24e3 + t1202 / 0.64e3 - t1204 / 0.448e4 - t1206 / 0.1152e5 + t1208 / 0.10368e6 + t1210 / 0.258048e6 - t1212 / 0.2838528e7 - t1214 / 0.688128e7 + t1216 / 0.8945664e8 + t1218 / 0.21233664e9 - t1220 / 0.31850496e10 - t1222 / 0.74317824e10 + t1224 / 0.1263403008e12;
  t1227 = my_piecewise3(t99, 0, t1194);
  t1232 = t432 * t432;
  t1233 = t710 * t1232;
  t1249 = t731 * t1232;
  t1260 = -0.2e1 * t723 * t1232 * t134 + t317 * t1227 * t134 / 0.2e1 + t1249 * t134 / 0.4e1 - 0.4e1 * t1232 * t135 - t132 * t1232 * t134 - 0.4e1 * t321 * t1227 - t127 * t1227 * t134;
  t1263 = -t1233 * t134 / 0.2e1 + 0.2e1 * t715 * t1232 - t312 * t1227 + 0.2e1 * t1227 * t138 + 0.4e1 * t432 * t444 + 0.2e1 * t126 * t1260;
  t1267 = my_piecewise3(t98, t1226, -0.8e1 / 0.3e1 * t1227 * t141 - 0.16e2 / 0.3e1 * t432 * t447 - 0.8e1 / 0.3e1 * t126 * t1263);
  t1268 = t22 * t1267;
  t1270 = t7 * t92 * t1268;
  t1271 = 0.3e1 / 0.32e2 * t1270;
  t1272 = -t1055 - t1056 - t1059 + t491 - t1060 - t1157 - t1169 - t1170 - t1173 + t635 - t1174 - t1271;
  tv2rho22 = -0.3e1 / 0.16e2 * t346 - t459 - 0.3e1 / 0.16e2 * t396 - 0.3e1 / 0.16e2 * t404 - t462 - 0.3e1 / 0.16e2 * t454 + t11 * t1272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1275 = t7 * t253 * t632;
  t1276 = t1275 / 0.16e2;
  t1278 = 0.1e1 / t163 / t152;
  t1279 = t1278 * t145;
  t1281 = t7 * t92 * t1279;
  t1282 = 0.5e1 / 0.144e3 * t1281;
  t1284 = t7 * t622 * t257;
  t1287 = t7 * t476 * t165;
  t1290 = t7 * t159 * t488;
  t1291 = t1290 / 0.16e2;
  t1292 = t1278 * t83;
  t1294 = t7 * t21 * t1292;
  t1295 = 0.5e1 / 0.144e3 * t1294;
  t1296 = t464 * t155;
  t1301 = t152 * t152;
  t1302 = 0.1e1 / t1301;
  t1303 = t10 * t1302;
  t1305 = 0.6e1 * t468 - 0.6e1 * t1303;
  t1309 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t1296 + 0.4e1 / 0.3e1 * t181 * t471 + 0.4e1 / 0.3e1 * t18 * t1305);
  t1310 = t9 * t1309;
  t1312 = t7 * t1310 * t84;
  t1313 = 0.3e1 / 0.32e2 * t1312;
  t1315 = t7 * t476 * t245;
  t1316 = 0.9e1 / 0.32e2 * t1315;
  t1318 = t7 * t159 * t492;
  t1321 = t7 * t159 * t610;
  t1322 = 0.9e1 / 0.32e2 * t1321;
  t1323 = t487 * t244;
  t1325 = t7 * t21 * t1323;
  t1326 = t1325 / 0.16e2;
  t1327 = t164 * t609;
  t1329 = t7 * t21 * t1327;
  t1333 = t1 / t22 / t467;
  t1336 = 0.14e2 / 0.243e3 * t27 * t1333 * t31;
  t1338 = t27 * t501 * t184;
  t1341 = t27 * t173 * t511;
  t1344 = t27 * t173 * t523;
  t1346 = t177 * t177;
  t1347 = 0.1e1 / t1346;
  t1348 = t510 * t183;
  t1349 = t1347 * t1348;
  t1353 = t183 * t522;
  t1357 = t14 * t14;
  t1359 = 0.1e1 / t179 / t1357;
  t1362 = t516 * t155;
  t1368 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1359 * t1296 - 0.2e1 / 0.3e1 * t1362 * t471 + t180 * t1305 / 0.3e1);
  t1369 = t178 * t1368;
  t1373 = -t1336 - 0.2e1 / 0.27e2 * t1338 - t1341 / 0.9e1 + t1344 / 0.18e2 - t27 * t29 * t1349 / 0.3e1 + t791 * t792 * t1353 / 0.3e1 - t27 * t29 * t1369 / 0.18e2;
  t1374 = my_piecewise3(t36, t1373, 0);
  t1391 = t496 * t189;
  t1402 = t209 * t1374 / 0.8945664e8 - t213 * t1374 / 0.31850496e10 + t217 * t1374 / 0.1263403008e12 - t170 * t1374 / 0.18e2 + t193 * t1374 / 0.24e3 - t197 * t1374 / 0.448e4 + t201 * t1374 / 0.10368e6 - t205 * t1374 / 0.2838528e7 - 0.2e1 / 0.3e1 * t193 * t1391 + t42 * t189 * t528 / 0.2e1 + t197 * t1391 / 0.8e1 - t45 * t189 * t528 / 0.16e2;
  t1429 = 0.1e1 / t59 / t169;
  t1435 = -t201 * t1391 / 0.8e2 + 0.3e1 / 0.64e3 * t48 * t189 * t528 + t205 * t1391 / 0.1152e4 - t51 * t189 * t528 / 0.384e4 - t209 * t1391 / 0.21504e5 + t54 * t189 * t528 / 0.86016e5 + t213 * t1391 / 0.49152e6 - t57 * t189 * t528 / 0.229376e7 - t217 * t1391 / 0.1327104e8 + t60 * t189 * t528 / 0.7077888e8 + t1429 * t1391 / 0.4128768e9 - t556 * t189 * t528 / 0.24772608e10;
  t1437 = my_piecewise3(t36, 0, t1373);
  t1444 = t570 * t221;
  t1448 = t72 * t562;
  t1451 = t567 * t567;
  t1452 = 0.1e1 / t1451;
  t1456 = t72 * t582;
  t1472 = t582 * t221;
  t1476 = 0.1e1 / t567 / t227;
  t1477 = t1476 * t1444;
  t1487 = 0.1e1 / t1451 / t63;
  t1488 = t1487 * t1444;
  t1499 = 0.15e2 / 0.2e1 * t569 * t1444 * t72 - 0.6e1 * t1472 * t1448 - 0.5e1 / 0.2e1 * t1477 * t72 + t228 * t1437 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t590 * t562 * t868 + t1488 * t72 / 0.8e1 - 0.12e2 * t877 * t562 - 0.3e1 * t880 * t1448 - 0.4e1 * t232 * t1437 - t65 * t1437 * t72;
  t1502 = 0.7e1 / 0.2e1 * t590 * t1444 * t72 - 0.3e1 / 0.2e1 * t853 * t1448 - t1452 * t1444 * t72 / 0.4e1 - 0.6e1 * t1456 * t1444 + 0.6e1 * t574 * t221 * t562 - t223 * t1437 + 0.2e1 * t1437 * t76 + 0.6e1 * t562 * t237 + 0.6e1 * t221 * t602 + 0.2e1 * t63 * t1499;
  t1506 = my_piecewise3(t35, t1402 + t1435, -0.8e1 / 0.3e1 * t1437 * t79 - 0.8e1 * t562 * t240 - 0.8e1 * t221 * t605 - 0.8e1 / 0.3e1 * t63 * t1502);
  t1507 = t22 * t1506;
  t1509 = t7 * t21 * t1507;
  t1510 = 0.3e1 / 0.32e2 * t1509;
  t1511 = t614 * t249;
  t1516 = -t1305;
  t1520 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t1511 + 0.4e1 / 0.3e1 * t270 * t617 + 0.4e1 / 0.3e1 * t89 * t1516);
  t1521 = t9 * t1520;
  t1523 = t7 * t1521 * t146;
  t1524 = 0.3e1 / 0.32e2 * t1523;
  t1526 = t7 * t622 * t334;
  t1527 = 0.9e1 / 0.32e2 * t1526;
  t1529 = t7 * t253 * t636;
  t1532 = t7 * t253 * t751;
  t1533 = 0.9e1 / 0.32e2 * t1532;
  t1534 = t487 * t333;
  t1536 = t7 * t92 * t1534;
  t1537 = t1536 / 0.16e2;
  t1538 = t164 * t750;
  t1540 = t7 * t92 * t1538;
  t1544 = 0.14e2 / 0.243e3 * t27 * t1333 * t94;
  t1546 = t27 * t501 * t273;
  t1549 = t27 * t173 * t652;
  t1552 = t27 * t173 * t664;
  t1554 = t266 * t266;
  t1555 = 0.1e1 / t1554;
  t1556 = t651 * t272;
  t1557 = t1555 * t1556;
  t1561 = t272 * t663;
  t1565 = t87 * t87;
  t1567 = 0.1e1 / t268 / t1565;
  t1570 = t657 * t249;
  t1576 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t1567 * t1511 - 0.2e1 / 0.3e1 * t1570 * t617 + t269 * t1516 / 0.3e1);
  t1577 = t267 * t1576;
  t1581 = -t1544 - 0.2e1 / 0.27e2 * t1546 - t1549 / 0.9e1 + t1552 / 0.18e2 - t27 * t29 * t1557 / 0.3e1 + t791 * t931 * t1561 / 0.3e1 - t27 * t29 * t1577 / 0.18e2;
  t1582 = my_piecewise3(t99, t1581, 0);
  t1599 = t640 * t278;
  t1610 = t306 * t1582 / 0.1263403008e12 - t262 * t1582 / 0.18e2 + t282 * t1582 / 0.24e3 - t286 * t1582 / 0.448e4 + t290 * t1582 / 0.10368e6 - t294 * t1582 / 0.2838528e7 + t298 * t1582 / 0.8945664e8 - t302 * t1582 / 0.31850496e10 + t286 * t1599 / 0.8e1 - t108 * t278 * t669 / 0.16e2 - t290 * t1599 / 0.8e2 + 0.3e1 / 0.64e3 * t111 * t278 * t669;
  t1632 = 0.1e1 / t122 / t261;
  t1643 = t294 * t1599 / 0.1152e4 - t114 * t278 * t669 / 0.384e4 - t298 * t1599 / 0.21504e5 + t117 * t278 * t669 / 0.86016e5 + t302 * t1599 / 0.49152e6 - t120 * t278 * t669 / 0.229376e7 - t306 * t1599 / 0.1327104e8 + t123 * t278 * t669 / 0.7077888e8 + t1632 * t1599 / 0.4128768e9 - t697 * t278 * t669 / 0.24772608e10 - 0.2e1 / 0.3e1 * t282 * t1599 + t105 * t278 * t669 / 0.2e1;
  t1645 = my_piecewise3(t99, 0, t1581);
  t1652 = t711 * t310;
  t1656 = t134 * t703;
  t1659 = t708 * t708;
  t1660 = 0.1e1 / t1659;
  t1664 = t134 * t723;
  t1667 = t310 * t703;
  t1680 = t723 * t310;
  t1684 = 0.1e1 / t708 / t316;
  t1685 = t1684 * t1652;
  t1695 = 0.1e1 / t1659 / t126;
  t1696 = t1695 * t1652;
  t1707 = 0.15e2 / 0.2e1 * t710 * t1652 * t134 - 0.6e1 * t1680 * t1656 - 0.5e1 / 0.2e1 * t1685 * t134 + t317 * t1645 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t731 * t703 * t1007 + t1696 * t134 / 0.8e1 - 0.12e2 * t1016 * t703 - 0.3e1 * t1019 * t1656 - 0.4e1 * t321 * t1645 - t127 * t1645 * t134;
  t1710 = 0.7e1 / 0.2e1 * t731 * t1652 * t134 - 0.3e1 / 0.2e1 * t992 * t1656 - t1660 * t1652 * t134 / 0.4e1 - 0.6e1 * t1664 * t1652 + 0.6e1 * t715 * t1667 - t312 * t1645 + 0.2e1 * t1645 * t138 + 0.6e1 * t703 * t326 + 0.6e1 * t310 * t743 + 0.2e1 * t126 * t1707;
  t1714 = my_piecewise3(t98, t1610 + t1643, -0.8e1 / 0.3e1 * t1645 * t141 - 0.8e1 * t703 * t329 - 0.8e1 * t310 * t746 - 0.8e1 / 0.3e1 * t126 * t1710);
  t1715 = t22 * t1714;
  t1717 = t7 * t92 * t1715;
  t1718 = 0.3e1 / 0.32e2 * t1717;
  t1719 = t1276 - t1282 - 0.3e1 / 0.32e2 * t1284 - 0.3e1 / 0.32e2 * t1287 + t1291 - t1295 - t1313 - t1316 - 0.3e1 / 0.16e2 * t1318 - t1322 + t1326 - 0.3e1 / 0.32e2 * t1329 - t1510 - t1524 - t1527 - 0.3e1 / 0.16e2 * t1529 - t1533 + t1537 - 0.3e1 / 0.32e2 * t1540 - t1718;
  t1722 = t490 / 0.16e2;
  t1724 = t634 / 0.16e2;
  tv3rho30 = t11 * t1719 - 0.3e1 / 0.16e2 * t481 + t1722 - 0.3e1 / 0.16e2 * t627 + t1724 - 0.9e1 / 0.32e2 * t478 - 0.9e1 / 0.16e2 * t484 - 0.3e1 / 0.16e2 * t494 - 0.9e1 / 0.32e2 * t612 - 0.9e1 / 0.32e2 * t624 - 0.9e1 / 0.16e2 * t630 - 0.3e1 / 0.16e2 * t638 - 0.9e1 / 0.32e2 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1737 = -t479 - t481 / 0.8e1 - t485 + t1722 - t494 / 0.8e1 - t613 - t625 - t627 / 0.8e1 - t631 + t1724 - t638 / 0.8e1 - t754;
  t1749 = t7 * t253 * t920;
  t1750 = t1749 / 0.16e2;
  t1751 = t487 * t451;
  t1753 = t7 * t92 * t1751;
  t1756 = t7 * t905 * t257;
  t1757 = t1756 / 0.16e2;
  t1759 = t7 * t402 * t632;
  t1762 = t7 * t159 * t779;
  t1763 = t1762 / 0.16e2;
  t1764 = t487 * t393;
  t1766 = t7 * t21 * t1764;
  t1768 = t1275 / 0.24e2 - t1282 - t1284 / 0.32e2 - t1287 / 0.32e2 + t1290 / 0.24e2 - t1295 - t1318 / 0.16e2 + t1325 / 0.24e2 - t1329 / 0.32e2 - t1529 / 0.16e2 + t1536 / 0.24e2 - t1540 / 0.32e2 - t1750 + t1753 / 0.48e2 - t1757 + t1759 / 0.48e2 - t1763 + t1766 / 0.48e2;
  t1770 = t7 * t764 * t165;
  t1771 = t1770 / 0.16e2;
  t1773 = t7 * t344 * t488;
  t1777 = t468 * t155;
  t1787 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t797 * t464 + 0.16e2 / 0.9e1 * t800 * t1777 + 0.4e1 / 0.9e1 * t348 * t471 + 0.8e1 / 0.3e1 * t18 * t468 - 0.8e1 * t759 * t1302);
  t1788 = t9 * t1787;
  t1790 = t7 * t1788 * t84;
  t1793 = t7 * t764 * t245;
  t1796 = t7 * t344 * t492;
  t1797 = t1796 / 0.16e2;
  t1799 = t7 * t344 * t610;
  t1802 = t7 * t476 * t394;
  t1805 = t7 * t159 * t894;
  t1807 = t164 * t893;
  t1809 = t7 * t21 * t1807;
  t1810 = t1809 / 0.16e2;
  t1811 = t556 * t810;
  t1816 = t42 * t810;
  t1821 = t45 * t810;
  t1826 = t48 * t810;
  t1831 = t51 * t810;
  t1836 = t54 * t810;
  t1841 = t57 * t810;
  t1846 = t60 * t810;
  t1851 = -t1811 * t189 / 0.37158912e10 - t843 * t528 / 0.74317824e10 + t1816 * t189 / 0.3e1 + t783 * t528 / 0.6e1 - t1821 * t189 / 0.24e2 - t813 * t528 / 0.48e2 + t1826 * t189 / 0.32e3 + t818 * t528 / 0.64e3 - t1831 * t189 / 0.576e4 - t823 * t528 / 0.1152e5 + t1836 * t189 / 0.129024e6 + t828 * t528 / 0.258048e6 - t1841 * t189 / 0.344064e7 - t833 * t528 / 0.688128e7 + t1846 * t189 / 0.10616832e9 + t838 * t528 / 0.21233664e9;
  t1866 = t1429 * t356;
  t1873 = t27 * t501 * t351;
  t1875 = t172 * t509;
  t1878 = 0.2e1 / 0.27e2 * t791 * t1875 * t793;
  t1881 = t27 * t173 * t805 / 0.27e2;
  t1882 = t28 * t1347;
  t1883 = t350 * t510;
  t1887 = t804 * t183;
  t1891 = t350 * t522;
  t1895 = t1359 * t340;
  t1898 = t516 * t10;
  t1903 = t180 * t468;
  t1908 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1895 * t464 - 0.8e1 / 0.9e1 * t1898 * t1777 - 0.2e1 / 0.9e1 * t797 * t471 + 0.2e1 / 0.3e1 * t1903 - 0.2e1 * t800 * t1302);
  t1909 = t178 * t1908;
  t1913 = -t1336 - 0.4e1 / 0.81e2 * t1338 - t1341 / 0.27e2 + t1344 / 0.54e2 - 0.2e1 / 0.81e2 * t1873 - t1878 + t1881 - t791 * t1882 * t1883 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t1887 + t791 * t792 * t1891 / 0.9e1 - t27 * t29 * t1909 / 0.18e2;
  t1914 = my_piecewise3(t36, t1913, 0);
  t1931 = -0.2e1 / 0.3e1 * t359 * t496 + t361 * t496 / 0.8e1 - t363 * t496 / 0.8e2 + t365 * t496 / 0.1152e4 - t367 * t496 / 0.21504e5 + t369 * t496 / 0.49152e6 - t371 * t496 / 0.1327104e8 + t1866 * t496 / 0.4128768e9 + t209 * t1914 / 0.8945664e8 - t213 * t1914 / 0.31850496e10 + t217 * t1914 / 0.1263403008e12 - t170 * t1914 / 0.18e2 + t193 * t1914 / 0.24e3 - t197 * t1914 / 0.448e4 + t201 * t1914 / 0.10368e6 - t205 * t1914 / 0.2838528e7;
  t1933 = my_piecewise3(t36, 0, t1913);
  t1946 = t569 * t562;
  t1949 = t1452 * t570;
  t1952 = t72 * t849;
  t1974 = t569 * t374;
  t1975 = t72 * t570;
  t1978 = t582 * t849;
  t1981 = t1476 * t374;
  t1989 = t590 * t849;
  t1994 = t1487 * t374;
  t1997 = t562 * t73;
  t2002 = t70 * t562;
  t2010 = 0.15e2 / 0.2e1 * t1974 * t1975 - 0.4e1 * t1978 * t868 - 0.5e1 / 0.2e1 * t1981 * t1975 - 0.2e1 * t867 * t1448 + t228 * t1933 * t72 / 0.2e1 + t1989 * t868 / 0.2e1 + t874 * t1448 / 0.4e1 + t1994 * t1975 / 0.8e1 - 0.4e1 * t1997 * t374 - 0.8e1 * t877 * t849 - t2002 * t854 - 0.2e1 * t880 * t1952 - 0.4e1 * t232 * t1933 - t65 * t1933 * t72;
  t2013 = 0.7e1 / 0.2e1 * t591 * t854 - t1946 * t854 / 0.2e1 - t1949 * t854 / 0.4e1 - t853 * t1952 - 0.6e1 * t1456 * t374 * t570 + 0.4e1 * t574 * t849 * t221 + 0.2e1 * t574 * t374 * t562 - t223 * t1933 + 0.2e1 * t1933 * t76 + 0.4e1 * t849 * t237 + 0.2e1 * t374 * t602 + 0.2e1 * t562 * t386 + 0.4e1 * t221 * t886 + 0.2e1 * t63 * t2010;
  t2017 = my_piecewise3(t35, t1851 + t1931, -0.8e1 / 0.3e1 * t1933 * t79 - 0.16e2 / 0.3e1 * t849 * t240 - 0.8e1 / 0.3e1 * t374 * t605 - 0.8e1 / 0.3e1 * t562 * t389 - 0.16e2 / 0.3e1 * t221 * t889 - 0.8e1 / 0.3e1 * t63 * t2013);
  t2018 = t22 * t2017;
  t2020 = t7 * t21 * t2018;
  t2024 = t468 * t249;
  t2034 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t936 * t614 - 0.16e2 / 0.9e1 * t939 * t2024 + 0.4e1 / 0.9e1 * t406 * t617 - 0.8e1 / 0.3e1 * t89 * t468 + 0.8e1 * t900 * t1302);
  t2035 = t9 * t2034;
  t2037 = t7 * t2035 * t146;
  t2040 = t7 * t905 * t334;
  t2043 = t7 * t402 * t636;
  t2044 = t2043 / 0.16e2;
  t2046 = t7 * t402 * t751;
  t2049 = t7 * t622 * t452;
  t2052 = t7 * t253 * t1033;
  t2054 = t164 * t1032;
  t2056 = t7 * t92 * t2054;
  t2057 = t2056 / 0.16e2;
  t2058 = t105 * t949;
  t2063 = t108 * t949;
  t2068 = t111 * t949;
  t2073 = t114 * t949;
  t2078 = t117 * t949;
  t2083 = t120 * t949;
  t2088 = t123 * t949;
  t2093 = t697 * t949;
  t2098 = t2058 * t278 / 0.3e1 + t924 * t669 / 0.6e1 - t2063 * t278 / 0.24e2 - t952 * t669 / 0.48e2 + t2068 * t278 / 0.32e3 + t957 * t669 / 0.64e3 - t2073 * t278 / 0.576e4 - t962 * t669 / 0.1152e5 + t2078 * t278 / 0.129024e6 + t967 * t669 / 0.258048e6 - t2083 * t278 / 0.344064e7 - t972 * t669 / 0.688128e7 + t2088 * t278 / 0.10616832e9 + t977 * t669 / 0.21233664e9 - t2093 * t278 / 0.37158912e10 - t982 * t669 / 0.74317824e10;
  t2113 = t1632 * t414;
  t2120 = t27 * t501 * t409;
  t2122 = t172 * t650;
  t2125 = 0.2e1 / 0.27e2 * t791 * t2122 * t932;
  t2128 = t27 * t173 * t944 / 0.27e2;
  t2129 = t28 * t1555;
  t2130 = t408 * t651;
  t2134 = t943 * t272;
  t2138 = t408 * t663;
  t2142 = t1567 * t398;
  t2145 = t657 * t10;
  t2150 = t269 * t468;
  t2155 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2142 * t614 + 0.8e1 / 0.9e1 * t2145 * t2024 - 0.2e1 / 0.9e1 * t936 * t617 - 0.2e1 / 0.3e1 * t2150 + 0.2e1 * t939 * t1302);
  t2156 = t267 * t2155;
  t2160 = -t1544 - 0.4e1 / 0.81e2 * t1546 - t1549 / 0.27e2 + t1552 / 0.54e2 - 0.2e1 / 0.81e2 * t2120 - t2125 + t2128 - t791 * t2129 * t2130 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2134 + t791 * t931 * t2138 / 0.9e1 - t27 * t29 * t2156 / 0.18e2;
  t2161 = my_piecewise3(t99, t2160, 0);
  t2178 = -0.2e1 / 0.3e1 * t417 * t640 + t419 * t640 / 0.8e1 - t421 * t640 / 0.8e2 + t423 * t640 / 0.1152e4 - t425 * t640 / 0.21504e5 + t427 * t640 / 0.49152e6 - t429 * t640 / 0.1327104e8 + t2113 * t640 / 0.4128768e9 - t262 * t2161 / 0.18e2 + t282 * t2161 / 0.24e3 - t286 * t2161 / 0.448e4 + t290 * t2161 / 0.10368e6 - t294 * t2161 / 0.2838528e7 + t298 * t2161 / 0.8945664e8 - t302 * t2161 / 0.31850496e10 + t306 * t2161 / 0.1263403008e12;
  t2180 = my_piecewise3(t99, 0, t2160);
  t2193 = t710 * t703;
  t2196 = t1660 * t711;
  t2199 = t134 * t988;
  t2221 = t710 * t432;
  t2222 = t134 * t711;
  t2225 = t723 * t988;
  t2228 = t1684 * t432;
  t2236 = t731 * t988;
  t2241 = t1695 * t432;
  t2244 = t703 * t135;
  t2249 = t132 * t703;
  t2257 = 0.15e2 / 0.2e1 * t2221 * t2222 - 0.4e1 * t2225 * t1007 - 0.5e1 / 0.2e1 * t2228 * t2222 - 0.2e1 * t1006 * t1656 + t317 * t2180 * t134 / 0.2e1 + t2236 * t1007 / 0.2e1 + t1013 * t1656 / 0.4e1 + t2241 * t2222 / 0.8e1 - 0.4e1 * t2244 * t432 - 0.8e1 * t1016 * t988 - t2249 * t993 - 0.2e1 * t1019 * t2199 - 0.4e1 * t321 * t2180 - t127 * t2180 * t134;
  t2260 = 0.7e1 / 0.2e1 * t732 * t993 - t2193 * t993 / 0.2e1 - t2196 * t993 / 0.4e1 - t992 * t2199 - 0.6e1 * t1664 * t432 * t711 + 0.4e1 * t715 * t988 * t310 + 0.2e1 * t715 * t432 * t703 - t312 * t2180 + 0.2e1 * t2180 * t138 + 0.4e1 * t988 * t326 + 0.2e1 * t432 * t743 + 0.2e1 * t703 * t444 + 0.4e1 * t310 * t1025 + 0.2e1 * t126 * t2257;
  t2264 = my_piecewise3(t98, t2098 + t2178, -0.8e1 / 0.3e1 * t2180 * t141 - 0.16e2 / 0.3e1 * t988 * t329 - 0.8e1 / 0.3e1 * t432 * t746 - 0.8e1 / 0.3e1 * t703 * t447 - 0.16e2 / 0.3e1 * t310 * t1028 - 0.8e1 / 0.3e1 * t126 * t2260);
  t2265 = t22 * t2264;
  t2267 = t7 * t92 * t2265;
  t2269 = -t1771 + t1773 / 0.48e2 - 0.3e1 / 0.32e2 * t1790 - 0.3e1 / 0.16e2 * t1793 - t1797 - 0.3e1 / 0.32e2 * t1799 - 0.3e1 / 0.32e2 * t1802 - 0.3e1 / 0.16e2 * t1805 - t1810 - 0.3e1 / 0.32e2 * t2020 - 0.3e1 / 0.32e2 * t2037 - 0.3e1 / 0.16e2 * t2040 - t2044 - 0.3e1 / 0.32e2 * t2046 - 0.3e1 / 0.32e2 * t2049 - 0.3e1 / 0.16e2 * t2052 - t2057 - 0.3e1 / 0.32e2 * t2267;
  t2272 = 0.3e1 / 0.16e2 * t766;
  t2273 = 0.3e1 / 0.16e2 * t772;
  t2274 = 0.3e1 / 0.16e2 * t777;
  t2275 = 0.3e1 / 0.16e2 * t896;
  t2276 = 0.3e1 / 0.16e2 * t907;
  t2277 = 0.3e1 / 0.16e2 * t913;
  t2278 = 0.3e1 / 0.16e2 * t918;
  t2279 = 0.3e1 / 0.16e2 * t1035;
  t2280 = t11 * (t1768 + t2269) - t2272 - t1056 - t2273 - t2274 - t1060 - t2275 - t2276 - t1170 - t2277 - t2278 - t1174 - t2279;
  tv3rho31 = t1737 + t2280;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2289 = t1275 / 0.48e2 - t1282 + t1290 / 0.48e2 - t1295 + t1325 / 0.48e2 + t1536 / 0.48e2 - t1750 + t1753 / 0.24e2 - t1757 + t1759 / 0.24e2 - t1763 + t1766 / 0.24e2 - t1771 + t1773 / 0.24e2 - t1797 - t1810 - t2044 - t2057;
  t2290 = t164 * t1267;
  t2292 = t7 * t92 * t2290;
  t2295 = t7 * t1166 * t257;
  t2298 = t7 * t402 * t920;
  t2300 = t164 * t1153;
  t2302 = t7 * t21 * t2300;
  t2305 = t7 * t1052 * t165;
  t2308 = t7 * t344 * t779;
  t2311 = t7 * t159 * t1154;
  t2313 = t201 * t1061;
  t2318 = t48 * t1081;
  t2321 = t205 * t1061;
  t2326 = t51 * t1081;
  t2329 = t209 * t1061;
  t2334 = t54 * t1081;
  t2337 = t213 * t1061;
  t2342 = t57 * t1081;
  t2345 = t217 * t1061;
  t2350 = t60 * t1081;
  t2353 = t1429 * t1061;
  t2356 = -t2313 * t189 / 0.8e2 + t818 * t810 / 0.32e3 + t2318 * t189 / 0.64e3 + t2321 * t189 / 0.1152e4 - t823 * t810 / 0.576e4 - t2326 * t189 / 0.1152e5 - t2329 * t189 / 0.21504e5 + t828 * t810 / 0.129024e6 + t2334 * t189 / 0.258048e6 + t2337 * t189 / 0.49152e6 - t833 * t810 / 0.344064e7 - t2342 * t189 / 0.688128e7 - t2345 * t189 / 0.1327104e8 + t838 * t810 / 0.10616832e9 + t2350 * t189 / 0.21233664e9 + t2353 * t189 / 0.4128768e9;
  t2359 = t556 * t1081;
  t2362 = t193 * t1061;
  t2367 = t42 * t1081;
  t2370 = t197 * t1061;
  t2375 = t45 * t1081;
  t2381 = t27 * t173 * t1066;
  t2383 = t1065 * t183;
  t2387 = t350 * t804;
  t2392 = t27 * t173 * t1076;
  t2394 = t1075 * t183;
  t2398 = t1359 * t1043;
  t2403 = t516 * t1047;
  t2408 = -0.2e1 * t468 - 0.6e1 * t1303;
  t2409 = t180 * t2408;
  t2412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t2398 * t155 - 0.8e1 / 0.9e1 * t797 * t469 - 0.2e1 / 0.9e1 * t2403 * t155 + t2409 / 0.3e1);
  t2413 = t178 * t2412;
  t2417 = -t1336 - 0.2e1 / 0.81e2 * t1338 - 0.4e1 / 0.81e2 * t1873 - t1878 + t1881 - t2381 / 0.27e2 - t791 * t1882 * t2383 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t2387 + t2392 / 0.54e2 + t791 * t792 * t2394 / 0.9e1 - t27 * t29 * t2413 / 0.18e2;
  t2418 = my_piecewise3(t36, t2417, 0);
  t2435 = -t843 * t810 / 0.37158912e10 - t2359 * t189 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2362 * t189 + t783 * t810 / 0.3e1 + t2367 * t189 / 0.6e1 + t2370 * t189 / 0.8e1 - t813 * t810 / 0.24e2 - t2375 * t189 / 0.48e2 - t170 * t2418 / 0.18e2 + t193 * t2418 / 0.24e3 - t197 * t2418 / 0.448e4 + t201 * t2418 / 0.10368e6 - t205 * t2418 / 0.2838528e7 + t209 * t2418 / 0.8945664e8 - t213 * t2418 / 0.31850496e10 + t217 * t2418 / 0.1263403008e12;
  t2437 = my_piecewise3(t36, 0, t2417);
  t2451 = t1452 * t1118;
  t2460 = t72 * t1113;
  t2481 = t1476 * t1118;
  t2484 = t582 * t1113;
  t2490 = t590 * t1113;
  t2495 = t1487 * t1118;
  t2498 = t374 * t73;
  t2501 = t70 * t374;
  t2511 = 0.15e2 / 0.2e1 * t1119 * t868 - 0.4e1 * t867 * t1952 - 0.5e1 / 0.2e1 * t2481 * t868 - 0.2e1 * t2484 * t868 + t228 * t2437 * t72 / 0.2e1 + t2490 * t868 / 0.4e1 + t874 * t1952 / 0.2e1 + t2495 * t868 / 0.8e1 - 0.8e1 * t2498 * t849 - 0.2e1 * t2501 * t1952 - 0.4e1 * t877 * t1113 - t880 * t2460 - 0.4e1 * t232 * t2437 - t65 * t2437 * t72;
  t2514 = 0.7e1 / 0.2e1 * t1135 * t868 - t1974 * t1952 - t2451 * t868 / 0.4e1 - 0.6e1 * t1456 * t1118 * t221 + 0.4e1 * t574 * t374 * t849 - t853 * t2460 / 0.2e1 + 0.2e1 * t574 * t1113 * t221 - t223 * t2437 + 0.2e1 * t2437 * t76 + 0.2e1 * t1113 * t237 + 0.4e1 * t849 * t386 + 0.4e1 * t374 * t886 + 0.2e1 * t221 * t1146 + 0.2e1 * t63 * t2511;
  t2518 = my_piecewise3(t35, t2356 + t2435, -0.8e1 / 0.3e1 * t2437 * t79 - 0.8e1 / 0.3e1 * t1113 * t240 - 0.16e2 / 0.3e1 * t849 * t389 - 0.16e2 / 0.3e1 * t374 * t889 - 0.8e1 / 0.3e1 * t221 * t1149 - 0.8e1 / 0.3e1 * t63 * t2514);
  t2519 = t22 * t2518;
  t2521 = t7 * t21 * t2519;
  t2529 = -t2408;
  t2533 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1184 * t249 - 0.16e2 / 0.9e1 * t406 * t469 + 0.4e1 / 0.9e1 * t1186 * t249 + 0.4e1 / 0.3e1 * t89 * t2529);
  t2534 = t9 * t2533;
  t2536 = t7 * t2534 * t146;
  t2539 = t7 * t1166 * t334;
  t2542 = t7 * t905 * t452;
  t2545 = t7 * t402 * t1033;
  t2548 = t7 * t253 * t1268;
  t2552 = t105 * t1195;
  t2555 = t286 * t1175;
  t2560 = t108 * t1195;
  t2563 = t290 * t1175;
  t2568 = t111 * t1195;
  t2571 = t294 * t1175;
  t2576 = t114 * t1195;
  t2579 = t298 * t1175;
  t2584 = t117 * t1195;
  t2587 = t302 * t1175;
  t2592 = t924 * t949 / 0.3e1 + t2552 * t278 / 0.6e1 + t2555 * t278 / 0.8e1 - t952 * t949 / 0.24e2 - t2560 * t278 / 0.48e2 - t2563 * t278 / 0.8e2 + t957 * t949 / 0.32e3 + t2568 * t278 / 0.64e3 + t2571 * t278 / 0.1152e4 - t962 * t949 / 0.576e4 - t2576 * t278 / 0.1152e5 - t2579 * t278 / 0.21504e5 + t967 * t949 / 0.129024e6 + t2584 * t278 / 0.258048e6 + t2587 * t278 / 0.49152e6 - t972 * t949 / 0.344064e7;
  t2593 = t120 * t1195;
  t2596 = t306 * t1175;
  t2601 = t123 * t1195;
  t2604 = t1632 * t1175;
  t2609 = t697 * t1195;
  t2612 = t282 * t1175;
  t2618 = t27 * t173 * t1180;
  t2620 = t1179 * t272;
  t2624 = t408 * t943;
  t2629 = t27 * t173 * t1190;
  t2631 = t1189 * t272;
  t2635 = t1567 * t1158;
  t2640 = t657 * t1161;
  t2643 = t269 * t2529;
  t2646 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2635 * t249 + 0.8e1 / 0.9e1 * t936 * t469 - 0.2e1 / 0.9e1 * t2640 * t249 + t2643 / 0.3e1);
  t2647 = t267 * t2646;
  t2651 = -t1544 - 0.2e1 / 0.81e2 * t1546 - 0.4e1 / 0.81e2 * t2120 - t2125 + t2128 - t2618 / 0.27e2 - t791 * t2129 * t2620 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2624 + t2629 / 0.54e2 + t791 * t931 * t2631 / 0.9e1 - t27 * t29 * t2647 / 0.18e2;
  t2652 = my_piecewise3(t99, t2651, 0);
  t2669 = -t2593 * t278 / 0.688128e7 - t2596 * t278 / 0.1327104e8 + t977 * t949 / 0.10616832e9 + t2601 * t278 / 0.21233664e9 + t2604 * t278 / 0.4128768e9 - t982 * t949 / 0.37158912e10 - t2609 * t278 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2612 * t278 + t282 * t2652 / 0.24e3 - t286 * t2652 / 0.448e4 + t290 * t2652 / 0.10368e6 - t294 * t2652 / 0.2838528e7 + t298 * t2652 / 0.8945664e8 - t302 * t2652 / 0.31850496e10 + t306 * t2652 / 0.1263403008e12 - t262 * t2652 / 0.18e2;
  t2671 = my_piecewise3(t99, 0, t2651);
  t2685 = t1660 * t1232;
  t2694 = t134 * t1227;
  t2715 = t1684 * t1232;
  t2718 = t723 * t1227;
  t2724 = t731 * t1227;
  t2729 = t1695 * t1232;
  t2732 = t432 * t135;
  t2735 = t132 * t432;
  t2745 = 0.15e2 / 0.2e1 * t1233 * t1007 - 0.4e1 * t1006 * t2199 - 0.5e1 / 0.2e1 * t2715 * t1007 - 0.2e1 * t2718 * t1007 + t317 * t2671 * t134 / 0.2e1 + t2724 * t1007 / 0.4e1 + t1013 * t2199 / 0.2e1 + t2729 * t1007 / 0.8e1 - 0.8e1 * t2732 * t988 - 0.2e1 * t2735 * t2199 - 0.4e1 * t1016 * t1227 - t1019 * t2694 - 0.4e1 * t321 * t2671 - t127 * t2671 * t134;
  t2748 = 0.7e1 / 0.2e1 * t1249 * t1007 - t2221 * t2199 - t2685 * t1007 / 0.4e1 - 0.6e1 * t1664 * t1232 * t310 + 0.4e1 * t715 * t432 * t988 - t992 * t2694 / 0.2e1 + 0.2e1 * t715 * t1227 * t310 - t312 * t2671 + 0.2e1 * t2671 * t138 + 0.2e1 * t1227 * t326 + 0.4e1 * t988 * t444 + 0.4e1 * t432 * t1025 + 0.2e1 * t310 * t1260 + 0.2e1 * t126 * t2745;
  t2752 = my_piecewise3(t98, t2592 + t2669, -0.8e1 / 0.3e1 * t2671 * t141 - 0.8e1 / 0.3e1 * t1227 * t329 - 0.16e2 / 0.3e1 * t988 * t447 - 0.16e2 / 0.3e1 * t432 * t1028 - 0.8e1 / 0.3e1 * t310 * t1263 - 0.8e1 / 0.3e1 * t126 * t2748);
  t2753 = t22 * t2752;
  t2755 = t7 * t92 * t2753;
  t2766 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t1070 * t155 + 0.16e2 / 0.9e1 * t348 * t469 + 0.4e1 / 0.9e1 * t1072 * t155 + 0.4e1 / 0.3e1 * t18 * t2408);
  t2767 = t9 * t2766;
  t2769 = t7 * t2767 * t84;
  t2772 = t7 * t1052 * t245;
  t2775 = t7 * t764 * t394;
  t2778 = t7 * t344 * t894;
  t2780 = -t2292 / 0.32e2 - t2295 / 0.32e2 - t2298 / 0.16e2 - t2302 / 0.32e2 - t2305 / 0.32e2 - t2308 / 0.16e2 - 0.3e1 / 0.32e2 * t2311 - 0.3e1 / 0.32e2 * t2521 - 0.3e1 / 0.32e2 * t2536 - 0.3e1 / 0.32e2 * t2539 - 0.3e1 / 0.16e2 * t2542 - 0.3e1 / 0.16e2 * t2545 - 0.3e1 / 0.32e2 * t2548 - 0.3e1 / 0.32e2 * t2755 - 0.3e1 / 0.32e2 * t2769 - 0.3e1 / 0.32e2 * t2772 - 0.3e1 / 0.16e2 * t2775 - 0.3e1 / 0.16e2 * t2778;
  t2785 = -t482 + t1722 - t495 - t628 + t1724 - t639 + t11 * (t2289 + t2780) - t2272 - t769 / 0.8e1 - t2273 - t2274 - t781 / 0.8e1;
  t2788 = -t2275 - t2276 - t910 / 0.8e1 - t2277 - t2278 - t922 / 0.8e1 - t2279 - t1055 - t1059 - t1157 - t1169 - t1173 - t1271;
  tv3rho32 = t2785 + t2788;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2795 = t1158 * t398;
  t2801 = 0.6e1 * t468 + 0.6e1 * t1303;
  t2805 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t2795 + 0.4e1 / 0.3e1 * t406 * t1161 + 0.4e1 / 0.3e1 * t89 * t2801);
  t2806 = t9 * t2805;
  t2808 = t7 * t2806 * t146;
  t2809 = 0.3e1 / 0.32e2 * t2808;
  t2811 = t7 * t1166 * t452;
  t2812 = 0.9e1 / 0.32e2 * t2811;
  t2814 = t7 * t402 * t1268;
  t2815 = 0.9e1 / 0.32e2 * t2814;
  t2819 = t1179 * t408;
  t2820 = t1555 * t2819;
  t2824 = t408 * t1189;
  t2828 = t1567 * t2795;
  t2832 = t269 * t2801;
  t2835 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2828 - 0.2e1 / 0.3e1 * t936 * t1161 + t2832 / 0.3e1);
  t2836 = t267 * t2835;
  t2840 = -t1544 - 0.2e1 / 0.27e2 * t2120 - t2618 / 0.9e1 + t2629 / 0.18e2 - t27 * t29 * t2820 / 0.3e1 + t791 * t931 * t2824 / 0.3e1 - t27 * t29 * t2836 / 0.18e2;
  t2841 = my_piecewise3(t99, t2840, 0);
  t2858 = t1175 * t414;
  t2867 = t298 * t2841 / 0.8945664e8 - t302 * t2841 / 0.31850496e10 + t306 * t2841 / 0.1263403008e12 - t262 * t2841 / 0.18e2 + t282 * t2841 / 0.24e3 - t286 * t2841 / 0.448e4 + t290 * t2841 / 0.10368e6 - t294 * t2841 / 0.2838528e7 - 0.2e1 / 0.3e1 * t282 * t2858 + t924 * t1195 / 0.2e1 + t286 * t2858 / 0.8e1 - t952 * t1195 / 0.16e2;
  t2892 = -t290 * t2858 / 0.8e2 + 0.3e1 / 0.64e3 * t957 * t1195 + t294 * t2858 / 0.1152e4 - t962 * t1195 / 0.384e4 - t298 * t2858 / 0.21504e5 + t967 * t1195 / 0.86016e5 + t302 * t2858 / 0.49152e6 - t972 * t1195 / 0.229376e7 - t306 * t2858 / 0.1327104e8 + t977 * t1195 / 0.7077888e8 + t1632 * t2858 / 0.4128768e9 - t982 * t1195 / 0.24772608e10;
  t2894 = my_piecewise3(t99, 0, t2840);
  t2901 = t1232 * t432;
  t2902 = t731 * t2901;
  t2907 = t1660 * t2901;
  t2912 = t432 * t1227;
  t2927 = t1684 * t2901;
  t2935 = t1695 * t2901;
  t2946 = 0.15e2 / 0.2e1 * t710 * t2901 * t134 - 0.6e1 * t1006 * t2694 - 0.5e1 / 0.2e1 * t2927 * t134 + t317 * t2894 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t2724 * t993 + t2935 * t134 / 0.8e1 - 0.12e2 * t2732 * t1227 - 0.3e1 * t2735 * t2694 - 0.4e1 * t321 * t2894 - t127 * t2894 * t134;
  t2949 = 0.7e1 / 0.2e1 * t2902 * t134 - 0.3e1 / 0.2e1 * t2221 * t2694 - t2907 * t134 / 0.4e1 - 0.6e1 * t1664 * t2901 + 0.6e1 * t715 * t2912 - t312 * t2894 + 0.2e1 * t2894 * t138 + 0.6e1 * t1227 * t444 + 0.6e1 * t432 * t1260 + 0.2e1 * t126 * t2946;
  t2953 = my_piecewise3(t98, t2867 + t2892, -0.8e1 / 0.3e1 * t2894 * t141 - 0.8e1 * t1227 * t447 - 0.8e1 * t432 * t1263 - 0.8e1 / 0.3e1 * t126 * t2949);
  t2954 = t22 * t2953;
  t2956 = t7 * t92 * t2954;
  t2957 = 0.3e1 / 0.32e2 * t2956;
  t2958 = t1043 * t340;
  t2963 = -t2801;
  t2967 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t2958 + 0.4e1 / 0.3e1 * t348 * t1047 + 0.4e1 / 0.3e1 * t18 * t2963);
  t2968 = t9 * t2967;
  t2970 = t7 * t2968 * t84;
  t2971 = 0.3e1 / 0.32e2 * t2970;
  t2973 = t7 * t1052 * t394;
  t2974 = 0.9e1 / 0.32e2 * t2973;
  t2976 = t7 * t344 * t1154;
  t2977 = 0.9e1 / 0.32e2 * t2976;
  t2981 = t1065 * t350;
  t2982 = t1347 * t2981;
  t2986 = t350 * t1075;
  t2990 = t1359 * t2958;
  t2994 = t180 * t2963;
  t2997 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t2990 - 0.2e1 / 0.3e1 * t797 * t1047 + t2994 / 0.3e1);
  t2998 = t178 * t2997;
  t3002 = -t1336 - 0.2e1 / 0.27e2 * t1873 - t2381 / 0.9e1 + t2392 / 0.18e2 - t27 * t29 * t2982 / 0.3e1 + t791 * t792 * t2986 / 0.3e1 - t27 * t29 * t2998 / 0.18e2;
  t3003 = my_piecewise3(t36, t3002, 0);
  t3014 = t1061 * t356;
  t3029 = t201 * t3003 / 0.10368e6 - t205 * t3003 / 0.2838528e7 + t209 * t3003 / 0.8945664e8 - t213 * t3003 / 0.31850496e10 + t217 * t3003 / 0.1263403008e12 - 0.2e1 / 0.3e1 * t193 * t3014 + t783 * t1081 / 0.2e1 + t197 * t3014 / 0.8e1 - t813 * t1081 / 0.16e2 - t201 * t3014 / 0.8e2 + 0.3e1 / 0.64e3 * t818 * t1081 + t205 * t3014 / 0.1152e4;
  t3054 = -t823 * t1081 / 0.384e4 - t209 * t3014 / 0.21504e5 + t828 * t1081 / 0.86016e5 + t213 * t3014 / 0.49152e6 - t833 * t1081 / 0.229376e7 - t217 * t3014 / 0.1327104e8 + t838 * t1081 / 0.7077888e8 + t1429 * t3014 / 0.4128768e9 - t843 * t1081 / 0.24772608e10 - t170 * t3003 / 0.18e2 + t193 * t3003 / 0.24e3 - t197 * t3003 / 0.448e4;
  t3056 = my_piecewise3(t36, 0, t3002);
  t3063 = t1118 * t374;
  t3064 = t590 * t3063;
  t3069 = t1452 * t3063;
  t3074 = t374 * t1113;
  t3089 = t1476 * t3063;
  t3097 = t1487 * t3063;
  t3108 = 0.15e2 / 0.2e1 * t569 * t3063 * t72 - 0.6e1 * t867 * t2460 - 0.5e1 / 0.2e1 * t3089 * t72 + t228 * t3056 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t2490 * t854 + t3097 * t72 / 0.8e1 - 0.12e2 * t2498 * t1113 - 0.3e1 * t2501 * t2460 - 0.4e1 * t232 * t3056 - t65 * t3056 * t72;
  t3111 = 0.7e1 / 0.2e1 * t3064 * t72 - 0.3e1 / 0.2e1 * t1974 * t2460 - t3069 * t72 / 0.4e1 - 0.6e1 * t1456 * t3063 + 0.6e1 * t574 * t3074 - t223 * t3056 + 0.2e1 * t3056 * t76 + 0.6e1 * t1113 * t386 + 0.6e1 * t374 * t1146 + 0.2e1 * t63 * t3108;
  t3115 = my_piecewise3(t35, t3029 + t3054, -0.8e1 / 0.3e1 * t3056 * t79 - 0.8e1 * t1113 * t389 - 0.8e1 * t374 * t1149 - 0.8e1 / 0.3e1 * t63 * t3111);
  t3116 = t22 * t3115;
  t3118 = t7 * t21 * t3116;
  t3119 = 0.3e1 / 0.32e2 * t3118;
  t3120 = t1753 / 0.16e2;
  t3121 = t1759 / 0.16e2;
  t3122 = t1766 / 0.16e2;
  t3123 = t1773 / 0.16e2;
  t3124 = -0.3e1 / 0.32e2 * t2292 - 0.3e1 / 0.32e2 * t2295 - 0.3e1 / 0.16e2 * t2298 - 0.3e1 / 0.32e2 * t2302 - 0.3e1 / 0.32e2 * t2305 - 0.3e1 / 0.16e2 * t2308 - t2809 - t2812 - t2815 - t2957 - t2971 - t2974 - t2977 - t3119 + t3120 + t3121 + t3122 + t3123 - t1282 - t1295;
  tv3rho33 = t11 * t3124 + t1722 + t1724 - 0.3e1 / 0.16e2 * t769 - 0.3e1 / 0.16e2 * t781 - 0.3e1 / 0.16e2 * t910 - 0.3e1 / 0.16e2 * t922 - 0.9e1 / 0.32e2 * t1054 - 0.9e1 / 0.16e2 * t1058 - 0.9e1 / 0.32e2 * t1156 - 0.9e1 / 0.32e2 * t1168 - 0.9e1 / 0.16e2 * t1172 - 0.9e1 / 0.32e2 * t1270;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, xc_lda_out_params *out)
{
  double t1, t3, t5, t6, t7, t8, t9, t10;
  double t11, t12, t13, t14, t15, t16, t17, t18;
  double t20, t21, t22, t23, t24, t25, t26, t27;
  double t28, t29, t30, t31, t34, t35, t36, t37;
  double t38, t41, t42, t44, t45, t47, t48, t51;
  double t54, t57, t59, t60, t63, t64, t65, t67;
  double t69, t70, t72, t73, t76, t79, t83, t84;
  double t86, t87, t88, t89, t91, t92, t93, t94;
  double t97, t98, t99, t100, t101, t104, t105, t107;
  double t108, t110, t111, t114, t117, t120, t122, t123;
  double t126, t127, t129, t131, t132, t134, t135, t138;
  double t141, t145, t146, t148, tzk0;

  double t150, t151, t152, t153, t154, t155, t158, t159;
  double t161, t162, t163, t164, t165, t167, t168, t169;
  double t170, t172, t173, t176, t177, t178, t179, t180;
  double t181, t183, t184, t188, t189, t192, t193, t196;
  double t197, t201, t205, t209, t213, t217, t221, t223;
  double t227, t228, t232, t237, t240, t244, t245, t247;
  double t248, t249, t252, t253, t255, t256, t257, t259;
  double t260, t261, t262, t265, t266, t267, t268, t269;
  double t270, t272, t273, t277, t278, t281, t282, t285;
  double t286, t290, t294, t298, t302, t306, t310, t312;
  double t316, t317, t321, t326, t329, t333, t334, t336;
  double t337, tvrho0, t340, t343, t344, t346, t347, t348;
  double t350, t351, t355, t356, t359, t361, t363, t365;
  double t367, t369, t371, t374, t386, t389, t393, t394;
  double t396, t397, t398, t401, t402, t404, t405, t406;
  double t408, t409, t413, t414, t417, t419, t421, t423;
  double t425, t427, t429, t432, t444, t447, t451, t452;
  double t454, t455, tvrho1;

  double t459, t462, t464, t467, t468, t469, t471, t475;
  double t476, t478, t479, t481, t482, t484, t485, t487;
  double t488, t490, t491, t492, t494, t495, t496, t500;
  double t501, t504, t506, t509, t510, t511, t516, t517;
  double t522, t523, t527, t528, t556, t561, t562, t567;
  double t569, t570, t571, t574, t582, t590, t591, t602;
  double t605, t609, t610, t612, t613, t614, t617, t621;
  double t622, t624, t625, t627, t628, t630, t631, t632;
  double t634, t635, t636, t638, t639, t640, t645, t647;
  double t650, t651, t652, t657, t658, t663, t664, t668;
  double t669, t697, t702, t703, t708, t710, t711, t712;
  double t715, t723, t731, t732, t743, t746, t750, t751;
  double t753, t754, t755, tv2rho20, t759, t763, t764, t766;
  double t769, t772, t777, t779, t781, t783, t788, t791;
  double t792, t793, t797, t800, t804, t805, t809, t810;
  double t813, t816, t818, t821, t823, t826, t828, t831;
  double t833, t836, t838, t841, t843, t846, t848, t849;
  double t853, t854, t857, t867, t868, t874, t877, t880;
  double t886, t889, t893, t894, t896, t900, t904, t905;
  double t907, t910, t913, t918, t920, t922, t924, t929;
  double t931, t932, t936, t939, t943, t944, t948, t949;
  double t952, t955, t957, t960, t962, t965, t967, t970;
  double t972, t975, t977, t980, t982, t985, t987, t988;
  double t992, t993, t996, t1006, t1007, t1013, t1016, t1019;
  double t1025, t1028, t1032, t1033, t1035, t1037, tv2rho21, t1043;
  double t1047, t1051, t1052, t1054, t1055, t1056, t1058, t1059;
  double t1060, t1061, t1065, t1066, t1070, t1072, t1075, t1076;
  double t1080, t1081, t1084, t1086, t1088, t1090, t1092, t1094;
  double t1096, t1098, t1100, t1102, t1104, t1106, t1108, t1110;
  double t1112, t1113, t1118, t1119, t1135, t1146, t1149, t1153;
  double t1154, t1156, t1157, t1158, t1161, t1165, t1166, t1168;
  double t1169, t1170, t1172, t1173, t1174, t1175, t1179, t1180;
  double t1184, t1186, t1189, t1190, t1194, t1195, t1198, t1200;
  double t1202, t1204, t1206, t1208, t1210, t1212, t1214, t1216;
  double t1218, t1220, t1222, t1224, t1226, t1227, t1232, t1233;
  double t1249, t1260, t1263, t1267, t1268, t1270, t1271, t1272;
  double tv2rho22;

  double t1275, t1276, t1278, t1279, t1281, t1282, t1284, t1287;
  double t1290, t1291, t1292, t1294, t1295, t1296, t1301, t1302;
  double t1303, t1305, t1309, t1310, t1312, t1313, t1315, t1316;
  double t1318, t1321, t1322, t1323, t1325, t1326, t1327, t1329;
  double t1333, t1336, t1338, t1341, t1344, t1346, t1347, t1348;
  double t1349, t1353, t1357, t1359, t1362, t1368, t1369, t1373;
  double t1374, t1391, t1402, t1429, t1435, t1437, t1444, t1448;
  double t1451, t1452, t1456, t1472, t1476, t1477, t1487, t1488;
  double t1499, t1502, t1506, t1507, t1509, t1510, t1511, t1516;
  double t1520, t1521, t1523, t1524, t1526, t1527, t1529, t1532;
  double t1533, t1534, t1536, t1537, t1538, t1540, t1544, t1546;
  double t1549, t1552, t1554, t1555, t1556, t1557, t1561, t1565;
  double t1567, t1570, t1576, t1577, t1581, t1582, t1599, t1610;
  double t1632, t1643, t1645, t1652, t1656, t1659, t1660, t1664;
  double t1667, t1680, t1684, t1685, t1695, t1696, t1707, t1710;
  double t1714, t1715, t1717, t1718, t1719, t1722, t1724, tv3rho30;
  double t1737, t1749, t1750, t1751, t1753, t1756, t1757, t1759;
  double t1762, t1763, t1764, t1766, t1768, t1770, t1771, t1773;
  double t1777, t1787, t1788, t1790, t1793, t1796, t1797, t1799;
  double t1802, t1805, t1807, t1809, t1810, t1811, t1816, t1821;
  double t1826, t1831, t1836, t1841, t1846, t1851, t1866, t1873;
  double t1875, t1878, t1881, t1882, t1883, t1887, t1891, t1895;
  double t1898, t1903, t1908, t1909, t1913, t1914, t1931, t1933;
  double t1946, t1949, t1952, t1974, t1975, t1978, t1981, t1989;
  double t1994, t1997, t2002, t2010, t2013, t2017, t2018, t2020;
  double t2024, t2034, t2035, t2037, t2040, t2043, t2044, t2046;
  double t2049, t2052, t2054, t2056, t2057, t2058, t2063, t2068;
  double t2073, t2078, t2083, t2088, t2093, t2098, t2113, t2120;
  double t2122, t2125, t2128, t2129, t2130, t2134, t2138, t2142;
  double t2145, t2150, t2155, t2156, t2160, t2161, t2178, t2180;
  double t2193, t2196, t2199, t2221, t2222, t2225, t2228, t2236;
  double t2241, t2244, t2249, t2257, t2260, t2264, t2265, t2267;
  double t2269, t2272, t2273, t2274, t2275, t2276, t2277, t2278;
  double t2279, t2280, tv3rho31, t2289, t2290, t2292, t2295, t2298;
  double t2300, t2302, t2305, t2308, t2311, t2313, t2318, t2321;
  double t2326, t2329, t2334, t2337, t2342, t2345, t2350, t2353;
  double t2356, t2359, t2362, t2367, t2370, t2375, t2381, t2383;
  double t2387, t2392, t2394, t2398, t2403, t2408, t2409, t2412;
  double t2413, t2417, t2418, t2435, t2437, t2451, t2460, t2481;
  double t2484, t2490, t2495, t2498, t2501, t2511, t2514, t2518;
  double t2519, t2521, t2529, t2533, t2534, t2536, t2539, t2542;
  double t2545, t2548, t2552, t2555, t2560, t2563, t2568, t2571;
  double t2576, t2579, t2584, t2587, t2592, t2593, t2596, t2601;
  double t2604, t2609, t2612, t2618, t2620, t2624, t2629, t2631;
  double t2635, t2640, t2643, t2646, t2647, t2651, t2652, t2669;
  double t2671, t2685, t2694, t2715, t2718, t2724, t2729, t2732;
  double t2735, t2745, t2748, t2752, t2753, t2755, t2766, t2767;
  double t2769, t2772, t2775, t2778, t2780, t2785, t2788, tv3rho32;
  double t2795, t2801, t2805, t2806, t2808, t2809, t2811, t2812;
  double t2814, t2815, t2819, t2820, t2824, t2828, t2832, t2835;
  double t2836, t2840, t2841, t2858, t2867, t2892, t2894, t2901;
  double t2902, t2907, t2912, t2927, t2935, t2946, t2949, t2953;
  double t2954, t2956, t2957, t2958, t2963, t2967, t2968, t2970;
  double t2971, t2973, t2974, t2976, t2977, t2981, t2982, t2986;
  double t2990, t2994, t2997, t2998, t3002, t3003, t3014, t3029;
  double t3054, t3056, t3063, t3064, t3069, t3074, t3089, t3097;
  double t3108, t3111, t3115, t3116, t3118, t3119, t3120, t3121;
  double t3122, t3123, t3124, tv3rho33;

  double t3138, t3141, t3143, t3146, t3149, t3152, t3155, t3158;
  double t3161, t3162, t3171, t3182, t3183, t3189, t3195, t3196;
  double t3198, t3202, t3207, t3208, t3225, t3228, t3240, t3253;
  double t3310, t3312, t3321, t3326, t3334, t3338, t3350, t3374;
  double t3389, t3406, t3417, t3421, t3427, t3430, t3434, t3437;
  double t3440, t3443, t3446, t3449, t3453, t3466, t3478, t3483;
  double t3488, t3495, t3499, t3502, t3506, t3508, t3513, t3515;
  double t3519, t3523, t3527, t3529, t3532, t3535, t3538, t3541;
  double t3544, t3547, t3548, t3557, t3568, t3569, t3575, t3580;
  double t3584, t3589, t3590, t3607, t3610, t3633, t3635, t3692;
  double t3694, t3703, t3708, t3709, t3715, t3733, t3774, t3782;
  double t3788, t3799, t3803, t3819, t3828, t3830, t3834, t3838;
  double t3854, tv4rho40, t3856, t3859, t3860, t3861, t3891, t3895;
  double t3896, t3898, t3901, t3906, t3908, t3910, t3920, t3921;
  double t3923, t3929, t3932, t3938, t3941, t3949, t3951, t3962;
  double t3963, t3964, t3977, t4014, t4044, t4075, t4078, t4101;
  double t4125, t4136, t4139, t4140, t4169, t4178, t4199, t4214;
  double t4221, t4226, t4248, t4250, t4262, t4277, t4278, t4280;
  double t4283, t4287, t4288, t4289, t4291, t4294, t4297, t4298;
  double t4300, t4303, t4307, t4308, t4310, t4312, t4330, t4334;
  double t4335, t4337, t4340, t4357, t4366, t4368, t4371, t4372;
  double t4374, t4380, t4383, t4389, t4392, t4400, t4402, t4413;
  double t4414, t4415, t4428, t4461, t4495, t4526, t4529, t4558;
  double t4575, t4581, t4584, t4585, t4614, t4637, t4644, t4666;
  double t4672, t4677, t4686, t4702, t4704, t4723, t4725, t4735;
  double t4738, t4739, t4741, t4745, t4748, t4749, t4751, t4754;
  double t4755, t4758, t4765, t4779, t4788, t4794, t4795, t4797;
  double t4798, t4799, t4802, t4804, t4807, t4811, t4815, t4817;
  double tv4rho41, t4819, t4841, t4844, t4846, t4852, t4858, t4863;
  double t4866, t4882, t4893, t4903, t4914, t4917, t4931, t4932;
  double t4933, t4950, t4955, t4995, t5037, t5077, t5080, t5097;
  double t5122, t5132, t5175, t5180, t5181, t5194, t5219, t5244;
  double t5249, t5255, t5259, t5262, t5265, t5267, t5288, t5294;
  double t5297, t5300, t5306, t5327, t5338, t5360, t5371, t5374;
  double t5376, t5377, t5378, t5395, t5400, t5439, t5481, t5522;
  double t5525, t5560, t5578, t5614, t5619, t5620, t5628, t5631;
  double t5660, t5689, t5694, t5719, t5731, t5734, t5737, t5741;
  double t5744, t5747, t5750, t5753, t5758, t5769, t5773, t5776;
  double t5779, t5783, t5786, t5820, t5837, t5857, t5874, t5888;
  double t5903, t5919, t5934, tv4rho42, t5936, t5963, t5973, t5987;
  double t5998, t6001, t6011, t6015, t6020, t6021, t6022, t6035;
  double t6067, t6100, t6103, t6106, t6109, t6112, t6115, t6118;
  double t6121, t6124, t6139, t6142, t6187, t6188, t6191, t6217;
  double t6226, t6256, t6275, t6280, t6289, t6292, t6299, t6303;
  double t6315, t6319, t6322, t6325, t6328, t6331, t6334, t6338;
  double t6355, t6366, t6373, t6400, t6410, t6424, t6447, t6452;
  double t6453, t6454, t6467, t6472, t6475, t6478, t6481, t6484;
  double t6503, t6537, t6571, t6574, t6592, t6606, t6619, t6649;
  double t6661, t6690, t6707, t6712, t6741, t6755, t6764, t6768;
  double t6773, t6784, t6794, tv4rho43, t6802, t6811, t6820, t6825;
  double t6831, t6835, t6840, t6841, t6858, t6861, t6884, t6925;
  double t6927, t6938, t6951, t6982, t7022, t7026, t7031, t7036;
  double t7041, t7045, t7064, t7078, t7081, t7102, t7111, t7131;
  double t7136, t7137, t7162, t7203, t7205, t7216, t7229, t7262;
  double t7300, t7304, t7320, t7334, t7356, tv4rho44;


  t1 = M_CBRT3;
  t3 = POW_1_3(0.1e1 / M_PI);
  t5 = M_CBRT4;
  t6 = t5 * t5;
  t7 = t1 * t3 * t6;
  t8 = M_CBRT2;
  t9 = t8 * t8;
  t10 = rho[0] - rho[1];
  t11 = rho[0] + rho[1];
  t12 = 0.1e1 / t11;
  t13 = t10 * t12;
  t14 = 0.1e1 + t13;
  t15 = t14 <= p->zeta_threshold;
  t16 = POW_1_3(p->zeta_threshold);
  t17 = t16 * p->zeta_threshold;
  t18 = POW_1_3(t14);
  t20 = my_piecewise3(t15, t17, t18 * t14);
  t21 = t9 * t20;
  t22 = POW_1_3(t11);
  t23 = POW_1_3(0.9e1);
  t24 = t23 * t23;
  t25 = t3 * t3;
  t26 = t24 * t25;
  t27 = t26 * p->cam_omega;
  t28 = 0.1e1 / t22;
  t29 = t1 * t28;
  t30 = my_piecewise3(t15, t16, t18);
  t31 = 0.1e1 / t30;
  t34 = t27 * t29 * t31 / 0.18e2;
  t35 = 0.135e1 <= t34;
  t36 = 0.135e1 < t34;
  t37 = my_piecewise3(t36, t34, 0.135e1);
  t38 = t37 * t37;
  t41 = t38 * t38;
  t42 = 0.1e1 / t41;
  t44 = t41 * t38;
  t45 = 0.1e1 / t44;
  t47 = t41 * t41;
  t48 = 0.1e1 / t47;
  t51 = 0.1e1 / t47 / t38;
  t54 = 0.1e1 / t47 / t41;
  t57 = 0.1e1 / t47 / t44;
  t59 = t47 * t47;
  t60 = 0.1e1 / t59;
  t63 = my_piecewise3(t36, 0.135e1, t34);
  t64 = sqrt(M_PI);
  t65 = 0.1e1 / t63;
  t67 = erf(t65 / 0.2e1);
  t69 = t63 * t63;
  t70 = 0.1e1 / t69;
  t72 = exp(-t70 / 0.4e1);
  t73 = t72 - 0.1e1;
  t76 = t72 - 0.3e1 / 0.2e1 - 0.2e1 * t69 * t73;
  t79 = 0.2e1 * t63 * t76 + t64 * t67;
  t83 = my_piecewise3(t35, 0.1e1 / t38 / 0.36e2 - t42 / 0.96e3 + t45 / 0.2688e5 - t48 / 0.82944e6 + t51 / 0.2838528e8 - t54 / 0.107347968e10 + t57 / 0.445906944e11 - t60 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t63 * t79);
  t84 = t22 * t83;
  t86 = t7 * t21 * t84;
  t87 = 0.1e1 - t13;
  t88 = t87 <= p->zeta_threshold;
  t89 = POW_1_3(t87);
  t91 = my_piecewise3(t88, t17, t89 * t87);
  t92 = t9 * t91;
  t93 = my_piecewise3(t88, t16, t89);
  t94 = 0.1e1 / t93;
  t97 = t27 * t29 * t94 / 0.18e2;
  t98 = 0.135e1 <= t97;
  t99 = 0.135e1 < t97;
  t100 = my_piecewise3(t99, t97, 0.135e1);
  t101 = t100 * t100;
  t104 = t101 * t101;
  t105 = 0.1e1 / t104;
  t107 = t104 * t101;
  t108 = 0.1e1 / t107;
  t110 = t104 * t104;
  t111 = 0.1e1 / t110;
  t114 = 0.1e1 / t110 / t101;
  t117 = 0.1e1 / t110 / t104;
  t120 = 0.1e1 / t110 / t107;
  t122 = t110 * t110;
  t123 = 0.1e1 / t122;
  t126 = my_piecewise3(t99, 0.135e1, t97);
  t127 = 0.1e1 / t126;
  t129 = erf(t127 / 0.2e1);
  t131 = t126 * t126;
  t132 = 0.1e1 / t131;
  t134 = exp(-t132 / 0.4e1);
  t135 = t134 - 0.1e1;
  t138 = t134 - 0.3e1 / 0.2e1 - 0.2e1 * t131 * t135;
  t141 = 0.2e1 * t126 * t138 + t64 * t129;
  t145 = my_piecewise3(t98, 0.1e1 / t101 / 0.36e2 - t105 / 0.96e3 + t108 / 0.2688e5 - t111 / 0.82944e6 + t114 / 0.2838528e8 - t117 / 0.107347968e10 + t120 / 0.445906944e11 - t123 / 0.20214448128e13, 0.1e1 - 0.8e1 / 0.3e1 * t126 * t141);
  t146 = t22 * t145;
  t148 = t7 * t92 * t146;
  tzk0 = -0.3e1 / 0.32e2 * t86 - 0.3e1 / 0.32e2 * t148;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t150 = 0.3e1 / 0.32e2 * t86;
  t151 = 0.3e1 / 0.32e2 * t148;
  t152 = t11 * t11;
  t153 = 0.1e1 / t152;
  t154 = t10 * t153;
  t155 = t12 - t154;
  t158 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t155);
  t159 = t9 * t158;
  t161 = t7 * t159 * t84;
  t162 = 0.3e1 / 0.32e2 * t161;
  t163 = t22 * t22;
  t164 = 0.1e1 / t163;
  t165 = t164 * t83;
  t167 = t7 * t21 * t165;
  t168 = t167 / 0.32e2;
  t169 = t38 * t37;
  t170 = 0.1e1 / t169;
  t172 = 0.1e1 / t22 / t11;
  t173 = t1 * t172;
  t176 = t27 * t173 * t31 / 0.54e2;
  t177 = t30 * t30;
  t178 = 0.1e1 / t177;
  t179 = t18 * t18;
  t180 = 0.1e1 / t179;
  t181 = t180 * t155;
  t183 = my_piecewise3(t15, 0, t181 / 0.3e1);
  t184 = t178 * t183;
  t188 = -t176 - t27 * t29 * t184 / 0.18e2;
  t189 = my_piecewise3(t36, t188, 0);
  t192 = t41 * t37;
  t193 = 0.1e1 / t192;
  t196 = t41 * t169;
  t197 = 0.1e1 / t196;
  t201 = 0.1e1 / t47 / t37;
  t205 = 0.1e1 / t47 / t169;
  t209 = 0.1e1 / t47 / t192;
  t213 = 0.1e1 / t47 / t196;
  t217 = 0.1e1 / t59 / t37;
  t221 = my_piecewise3(t36, 0, t188);
  t223 = t72 * t70;
  t227 = t69 * t63;
  t228 = 0.1e1 / t227;
  t232 = t63 * t73;
  t237 = t228 * t221 * t72 / 0.2e1 - 0.4e1 * t232 * t221 - t65 * t221 * t72;
  t240 = -t223 * t221 + 0.2e1 * t221 * t76 + 0.2e1 * t63 * t237;
  t244 = my_piecewise3(t35, -t170 * t189 / 0.18e2 + t193 * t189 / 0.24e3 - t197 * t189 / 0.448e4 + t201 * t189 / 0.10368e6 - t205 * t189 / 0.2838528e7 + t209 * t189 / 0.8945664e8 - t213 * t189 / 0.31850496e10 + t217 * t189 / 0.1263403008e12, -0.8e1 / 0.3e1 * t221 * t79 - 0.8e1 / 0.3e1 * t63 * t240);
  t245 = t22 * t244;
  t247 = t7 * t21 * t245;
  t248 = 0.3e1 / 0.32e2 * t247;
  t249 = -t155;
  t252 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t249);
  t253 = t9 * t252;
  t255 = t7 * t253 * t146;
  t256 = 0.3e1 / 0.32e2 * t255;
  t257 = t164 * t145;
  t259 = t7 * t92 * t257;
  t260 = t259 / 0.32e2;
  t261 = t101 * t100;
  t262 = 0.1e1 / t261;
  t265 = t27 * t173 * t94 / 0.54e2;
  t266 = t93 * t93;
  t267 = 0.1e1 / t266;
  t268 = t89 * t89;
  t269 = 0.1e1 / t268;
  t270 = t269 * t249;
  t272 = my_piecewise3(t88, 0, t270 / 0.3e1);
  t273 = t267 * t272;
  t277 = -t265 - t27 * t29 * t273 / 0.18e2;
  t278 = my_piecewise3(t99, t277, 0);
  t281 = t104 * t100;
  t282 = 0.1e1 / t281;
  t285 = t104 * t261;
  t286 = 0.1e1 / t285;
  t290 = 0.1e1 / t110 / t100;
  t294 = 0.1e1 / t110 / t261;
  t298 = 0.1e1 / t110 / t281;
  t302 = 0.1e1 / t110 / t285;
  t306 = 0.1e1 / t122 / t100;
  t310 = my_piecewise3(t99, 0, t277);
  t312 = t134 * t132;
  t316 = t131 * t126;
  t317 = 0.1e1 / t316;
  t321 = t126 * t135;
  t326 = t317 * t310 * t134 / 0.2e1 - 0.4e1 * t321 * t310 - t127 * t310 * t134;
  t329 = 0.2e1 * t126 * t326 + 0.2e1 * t310 * t138 - t312 * t310;
  t333 = my_piecewise3(t98, -t262 * t278 / 0.18e2 + t282 * t278 / 0.24e3 - t286 * t278 / 0.448e4 + t290 * t278 / 0.10368e6 - t294 * t278 / 0.2838528e7 + t298 * t278 / 0.8945664e8 - t302 * t278 / 0.31850496e10 + t306 * t278 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t329 - 0.8e1 / 0.3e1 * t310 * t141);
  t334 = t22 * t333;
  t336 = t7 * t92 * t334;
  t337 = 0.3e1 / 0.32e2 * t336;
  tvrho0 = -t150 - t151 + t11 * (-t162 - t168 - t248 - t256 - t260 - t337);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t340 = -t12 - t154;
  t343 = my_piecewise3(t15, 0, 0.4e1 / 0.3e1 * t18 * t340);
  t344 = t9 * t343;
  t346 = t7 * t344 * t84;
  t347 = 0.3e1 / 0.32e2 * t346;
  t348 = t180 * t340;
  t350 = my_piecewise3(t15, 0, t348 / 0.3e1);
  t351 = t178 * t350;
  t355 = -t176 - t27 * t29 * t351 / 0.18e2;
  t356 = my_piecewise3(t36, t355, 0);
  t359 = t193 * t356;
  t361 = t197 * t356;
  t363 = t201 * t356;
  t365 = t205 * t356;
  t367 = t209 * t356;
  t369 = t213 * t356;
  t371 = t217 * t356;
  t374 = my_piecewise3(t36, 0, t355);
  t386 = t228 * t374 * t72 / 0.2e1 - 0.4e1 * t232 * t374 - t65 * t374 * t72;
  t389 = -t223 * t374 + 0.2e1 * t374 * t76 + 0.2e1 * t63 * t386;
  t393 = my_piecewise3(t35, -t170 * t356 / 0.18e2 + t359 / 0.24e3 - t361 / 0.448e4 + t363 / 0.10368e6 - t365 / 0.2838528e7 + t367 / 0.8945664e8 - t369 / 0.31850496e10 + t371 / 0.1263403008e12, -0.8e1 / 0.3e1 * t374 * t79 - 0.8e1 / 0.3e1 * t63 * t389);
  t394 = t22 * t393;
  t396 = t7 * t21 * t394;
  t397 = 0.3e1 / 0.32e2 * t396;
  t398 = -t340;
  t401 = my_piecewise3(t88, 0, 0.4e1 / 0.3e1 * t89 * t398);
  t402 = t9 * t401;
  t404 = t7 * t402 * t146;
  t405 = 0.3e1 / 0.32e2 * t404;
  t406 = t269 * t398;
  t408 = my_piecewise3(t88, 0, t406 / 0.3e1);
  t409 = t267 * t408;
  t413 = -t265 - t27 * t29 * t409 / 0.18e2;
  t414 = my_piecewise3(t99, t413, 0);
  t417 = t282 * t414;
  t419 = t286 * t414;
  t421 = t290 * t414;
  t423 = t294 * t414;
  t425 = t298 * t414;
  t427 = t302 * t414;
  t429 = t306 * t414;
  t432 = my_piecewise3(t99, 0, t413);
  t444 = t317 * t432 * t134 / 0.2e1 - 0.4e1 * t321 * t432 - t127 * t432 * t134;
  t447 = 0.2e1 * t126 * t444 + 0.2e1 * t432 * t138 - t312 * t432;
  t451 = my_piecewise3(t98, -t262 * t414 / 0.18e2 + t417 / 0.24e3 - t419 / 0.448e4 + t421 / 0.10368e6 - t423 / 0.2838528e7 + t425 / 0.8945664e8 - t427 / 0.31850496e10 + t429 / 0.1263403008e12, -0.8e1 / 0.3e1 * t126 * t447 - 0.8e1 / 0.3e1 * t432 * t141);
  t452 = t22 * t451;
  t454 = t7 * t92 * t452;
  t455 = 0.3e1 / 0.32e2 * t454;
  tvrho1 = -t150 - t151 + t11 * (-t347 - t168 - t397 - t405 - t260 - t455);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t459 = t167 / 0.16e2;
  t462 = t259 / 0.16e2;
  t464 = t155 * t155;
  t467 = t152 * t11;
  t468 = 0.1e1 / t467;
  t469 = t10 * t468;
  t471 = -0.2e1 * t153 + 0.2e1 * t469;
  t475 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t464 + 0.4e1 / 0.3e1 * t18 * t471);
  t476 = t9 * t475;
  t478 = t7 * t476 * t84;
  t479 = 0.3e1 / 0.32e2 * t478;
  t481 = t7 * t159 * t165;
  t482 = t481 / 0.16e2;
  t484 = t7 * t159 * t245;
  t485 = 0.3e1 / 0.16e2 * t484;
  t487 = 0.1e1 / t163 / t11;
  t488 = t487 * t83;
  t490 = t7 * t21 * t488;
  t491 = t490 / 0.48e2;
  t492 = t164 * t244;
  t494 = t7 * t21 * t492;
  t495 = t494 / 0.16e2;
  t496 = t189 * t189;
  t500 = 0.1e1 / t22 / t152;
  t501 = t1 * t500;
  t504 = 0.2e1 / 0.81e2 * t27 * t501 * t31;
  t506 = t27 * t173 * t184;
  t509 = 0.1e1 / t177 / t30;
  t510 = t183 * t183;
  t511 = t509 * t510;
  t516 = 0.1e1 / t179 / t14;
  t517 = t516 * t464;
  t522 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t517 + t180 * t471 / 0.3e1);
  t523 = t178 * t522;
  t527 = t504 + t506 / 0.27e2 + t27 * t29 * t511 / 0.9e1 - t27 * t29 * t523 / 0.18e2;
  t528 = my_piecewise3(t36, t527, 0);
  t556 = 0.1e1 / t59 / t38;
  t561 = t42 * t496 / 0.6e1 - t170 * t528 / 0.18e2 - t45 * t496 / 0.48e2 + t193 * t528 / 0.24e3 + t48 * t496 / 0.64e3 - t197 * t528 / 0.448e4 - t51 * t496 / 0.1152e5 + t201 * t528 / 0.10368e6 + t54 * t496 / 0.258048e6 - t205 * t528 / 0.2838528e7 - t57 * t496 / 0.688128e7 + t209 * t528 / 0.8945664e8 + t60 * t496 / 0.21233664e9 - t213 * t528 / 0.31850496e10 - t556 * t496 / 0.74317824e10 + t217 * t528 / 0.1263403008e12;
  t562 = my_piecewise3(t36, 0, t527);
  t567 = t69 * t69;
  t569 = 0.1e1 / t567 / t63;
  t570 = t221 * t221;
  t571 = t569 * t570;
  t574 = t72 * t228;
  t582 = 0.1e1 / t567;
  t590 = 0.1e1 / t567 / t69;
  t591 = t590 * t570;
  t602 = -0.2e1 * t582 * t570 * t72 + t228 * t562 * t72 / 0.2e1 + t591 * t72 / 0.4e1 - 0.4e1 * t570 * t73 - t70 * t570 * t72 - 0.4e1 * t232 * t562 - t65 * t562 * t72;
  t605 = -t571 * t72 / 0.2e1 + 0.2e1 * t574 * t570 - t223 * t562 + 0.2e1 * t562 * t76 + 0.4e1 * t221 * t237 + 0.2e1 * t63 * t602;
  t609 = my_piecewise3(t35, t561, -0.8e1 / 0.3e1 * t562 * t79 - 0.16e2 / 0.3e1 * t221 * t240 - 0.8e1 / 0.3e1 * t63 * t605);
  t610 = t22 * t609;
  t612 = t7 * t21 * t610;
  t613 = 0.3e1 / 0.32e2 * t612;
  t614 = t249 * t249;
  t617 = -t471;
  t621 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t614 + 0.4e1 / 0.3e1 * t89 * t617);
  t622 = t9 * t621;
  t624 = t7 * t622 * t146;
  t625 = 0.3e1 / 0.32e2 * t624;
  t627 = t7 * t253 * t257;
  t628 = t627 / 0.16e2;
  t630 = t7 * t253 * t334;
  t631 = 0.3e1 / 0.16e2 * t630;
  t632 = t487 * t145;
  t634 = t7 * t92 * t632;
  t635 = t634 / 0.48e2;
  t636 = t164 * t333;
  t638 = t7 * t92 * t636;
  t639 = t638 / 0.16e2;
  t640 = t278 * t278;
  t645 = 0.2e1 / 0.81e2 * t27 * t501 * t94;
  t647 = t27 * t173 * t273;
  t650 = 0.1e1 / t266 / t93;
  t651 = t272 * t272;
  t652 = t650 * t651;
  t657 = 0.1e1 / t268 / t87;
  t658 = t657 * t614;
  t663 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t658 + t269 * t617 / 0.3e1);
  t664 = t267 * t663;
  t668 = t645 + t647 / 0.27e2 + t27 * t29 * t652 / 0.9e1 - t27 * t29 * t664 / 0.18e2;
  t669 = my_piecewise3(t99, t668, 0);
  t697 = 0.1e1 / t122 / t101;
  t702 = t105 * t640 / 0.6e1 - t262 * t669 / 0.18e2 - t108 * t640 / 0.48e2 + t282 * t669 / 0.24e3 + t111 * t640 / 0.64e3 - t286 * t669 / 0.448e4 - t114 * t640 / 0.1152e5 + t290 * t669 / 0.10368e6 + t117 * t640 / 0.258048e6 - t294 * t669 / 0.2838528e7 - t120 * t640 / 0.688128e7 + t298 * t669 / 0.8945664e8 + t123 * t640 / 0.21233664e9 - t302 * t669 / 0.31850496e10 - t697 * t640 / 0.74317824e10 + t306 * t669 / 0.1263403008e12;
  t703 = my_piecewise3(t99, 0, t668);
  t708 = t131 * t131;
  t710 = 0.1e1 / t708 / t126;
  t711 = t310 * t310;
  t712 = t710 * t711;
  t715 = t134 * t317;
  t723 = 0.1e1 / t708;
  t731 = 0.1e1 / t708 / t131;
  t732 = t731 * t711;
  t743 = -0.2e1 * t723 * t711 * t134 + t317 * t703 * t134 / 0.2e1 + t732 * t134 / 0.4e1 - 0.4e1 * t711 * t135 - t132 * t711 * t134 - 0.4e1 * t321 * t703 - t127 * t703 * t134;
  t746 = -t712 * t134 / 0.2e1 + 0.2e1 * t715 * t711 - t312 * t703 + 0.2e1 * t703 * t138 + 0.4e1 * t310 * t326 + 0.2e1 * t126 * t743;
  t750 = my_piecewise3(t98, t702, -0.8e1 / 0.3e1 * t703 * t141 - 0.16e2 / 0.3e1 * t310 * t329 - 0.8e1 / 0.3e1 * t126 * t746);
  t751 = t22 * t750;
  t753 = t7 * t92 * t751;
  t754 = 0.3e1 / 0.32e2 * t753;
  t755 = -t479 - t482 - t485 + t491 - t495 - t613 - t625 - t628 - t631 + t635 - t639 - t754;
  tv2rho20 = -0.3e1 / 0.16e2 * t161 - t459 - 0.3e1 / 0.16e2 * t247 - 0.3e1 / 0.16e2 * t255 - t462 - 0.3e1 / 0.16e2 * t336 + t11 * t755;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t759 = t18 * t10;
  t763 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t348 * t155 + 0.8e1 / 0.3e1 * t759 * t468);
  t764 = t9 * t763;
  t766 = t7 * t764 * t84;
  t769 = t7 * t344 * t165;
  t772 = t7 * t344 * t245;
  t777 = t7 * t159 * t394;
  t779 = t164 * t393;
  t781 = t7 * t21 * t779;
  t783 = t42 * t356;
  t788 = t27 * t173 * t351;
  t791 = t26 * p->cam_omega * t1;
  t792 = t28 * t509;
  t793 = t350 * t183;
  t797 = t516 * t340;
  t800 = t180 * t10;
  t804 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t797 * t155 + 0.2e1 / 0.3e1 * t800 * t468);
  t805 = t178 * t804;
  t809 = t504 + t506 / 0.54e2 + t788 / 0.54e2 + t791 * t792 * t793 / 0.9e1 - t27 * t29 * t805 / 0.18e2;
  t810 = my_piecewise3(t36, t809, 0);
  t813 = t45 * t356;
  t816 = t193 * t810;
  t818 = t48 * t356;
  t821 = t197 * t810;
  t823 = t51 * t356;
  t826 = t201 * t810;
  t828 = t54 * t356;
  t831 = t205 * t810;
  t833 = t57 * t356;
  t836 = t209 * t810;
  t838 = t60 * t356;
  t841 = t213 * t810;
  t843 = t556 * t356;
  t846 = t217 * t810;
  t848 = t783 * t189 / 0.6e1 - t170 * t810 / 0.18e2 - t813 * t189 / 0.48e2 + t816 / 0.24e3 + t818 * t189 / 0.64e3 - t821 / 0.448e4 - t823 * t189 / 0.1152e5 + t826 / 0.10368e6 + t828 * t189 / 0.258048e6 - t831 / 0.2838528e7 - t833 * t189 / 0.688128e7 + t836 / 0.8945664e8 + t838 * t189 / 0.21233664e9 - t841 / 0.31850496e10 - t843 * t189 / 0.74317824e10 + t846 / 0.1263403008e12;
  t849 = my_piecewise3(t36, 0, t809);
  t853 = t569 * t221;
  t854 = t72 * t374;
  t857 = t374 * t221;
  t867 = t582 * t374;
  t868 = t72 * t221;
  t874 = t590 * t374;
  t877 = t221 * t73;
  t880 = t70 * t221;
  t886 = -0.2e1 * t867 * t868 + t228 * t849 * t72 / 0.2e1 + t874 * t868 / 0.4e1 - 0.4e1 * t877 * t374 - t880 * t854 - 0.4e1 * t232 * t849 - t65 * t849 * t72;
  t889 = -t853 * t854 / 0.2e1 + 0.2e1 * t574 * t857 - t223 * t849 + 0.2e1 * t849 * t76 + 0.2e1 * t374 * t237 + 0.2e1 * t221 * t386 + 0.2e1 * t63 * t886;
  t893 = my_piecewise3(t35, t848, -0.8e1 / 0.3e1 * t221 * t389 - 0.8e1 / 0.3e1 * t374 * t240 - 0.8e1 / 0.3e1 * t63 * t889 - 0.8e1 / 0.3e1 * t849 * t79);
  t894 = t22 * t893;
  t896 = t7 * t21 * t894;
  t900 = t89 * t10;
  t904 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t406 * t249 - 0.8e1 / 0.3e1 * t900 * t468);
  t905 = t9 * t904;
  t907 = t7 * t905 * t146;
  t910 = t7 * t402 * t257;
  t913 = t7 * t402 * t334;
  t918 = t7 * t253 * t452;
  t920 = t164 * t451;
  t922 = t7 * t92 * t920;
  t924 = t105 * t414;
  t929 = t27 * t173 * t409;
  t931 = t28 * t650;
  t932 = t408 * t272;
  t936 = t657 * t398;
  t939 = t269 * t10;
  t943 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t936 * t249 - 0.2e1 / 0.3e1 * t939 * t468);
  t944 = t267 * t943;
  t948 = t645 + t647 / 0.54e2 + t929 / 0.54e2 + t791 * t931 * t932 / 0.9e1 - t27 * t29 * t944 / 0.18e2;
  t949 = my_piecewise3(t99, t948, 0);
  t952 = t108 * t414;
  t955 = t282 * t949;
  t957 = t111 * t414;
  t960 = t286 * t949;
  t962 = t114 * t414;
  t965 = t290 * t949;
  t967 = t117 * t414;
  t970 = t294 * t949;
  t972 = t120 * t414;
  t975 = t298 * t949;
  t977 = t123 * t414;
  t980 = t302 * t949;
  t982 = t697 * t414;
  t985 = t306 * t949;
  t987 = t924 * t278 / 0.6e1 - t262 * t949 / 0.18e2 - t952 * t278 / 0.48e2 + t955 / 0.24e3 + t957 * t278 / 0.64e3 - t960 / 0.448e4 - t962 * t278 / 0.1152e5 + t965 / 0.10368e6 + t967 * t278 / 0.258048e6 - t970 / 0.2838528e7 - t972 * t278 / 0.688128e7 + t975 / 0.8945664e8 + t977 * t278 / 0.21233664e9 - t980 / 0.31850496e10 - t982 * t278 / 0.74317824e10 + t985 / 0.1263403008e12;
  t988 = my_piecewise3(t99, 0, t948);
  t992 = t710 * t310;
  t993 = t134 * t432;
  t996 = t432 * t310;
  t1006 = t723 * t432;
  t1007 = t134 * t310;
  t1013 = t731 * t432;
  t1016 = t310 * t135;
  t1019 = t132 * t310;
  t1025 = -0.2e1 * t1006 * t1007 + t317 * t988 * t134 / 0.2e1 + t1013 * t1007 / 0.4e1 - 0.4e1 * t1016 * t432 - t1019 * t993 - 0.4e1 * t321 * t988 - t127 * t988 * t134;
  t1028 = -t992 * t993 / 0.2e1 + 0.2e1 * t715 * t996 - t312 * t988 + 0.2e1 * t988 * t138 + 0.2e1 * t432 * t326 + 0.2e1 * t310 * t444 + 0.2e1 * t126 * t1025;
  t1032 = my_piecewise3(t98, t987, -0.8e1 / 0.3e1 * t126 * t1028 - 0.8e1 / 0.3e1 * t988 * t141 - 0.8e1 / 0.3e1 * t310 * t447 - 0.8e1 / 0.3e1 * t432 * t329);
  t1033 = t22 * t1032;
  t1035 = t7 * t92 * t1033;
  t1037 = -0.3e1 / 0.32e2 * t766 - t769 / 0.32e2 - 0.3e1 / 0.32e2 * t772 - t481 / 0.32e2 + t491 - t494 / 0.32e2 - 0.3e1 / 0.32e2 * t777 - t781 / 0.32e2 - 0.3e1 / 0.32e2 * t896 - 0.3e1 / 0.32e2 * t907 - t910 / 0.32e2 - 0.3e1 / 0.32e2 * t913 - t627 / 0.32e2 + t635 - t638 / 0.32e2 - 0.3e1 / 0.32e2 * t918 - t922 / 0.32e2 - 0.3e1 / 0.32e2 * t1035;
  tv2rho21 = t11 * t1037 - t162 - t248 - t256 - t337 - t347 - t397 - t405 - t455 - t459 - t462;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1043 = t340 * t340;
  t1047 = 0.2e1 * t153 + 0.2e1 * t469;
  t1051 = my_piecewise3(t15, 0, 0.4e1 / 0.9e1 * t180 * t1043 + 0.4e1 / 0.3e1 * t18 * t1047);
  t1052 = t9 * t1051;
  t1054 = t7 * t1052 * t84;
  t1055 = 0.3e1 / 0.32e2 * t1054;
  t1056 = t769 / 0.16e2;
  t1058 = t7 * t344 * t394;
  t1059 = 0.3e1 / 0.16e2 * t1058;
  t1060 = t781 / 0.16e2;
  t1061 = t356 * t356;
  t1065 = t350 * t350;
  t1066 = t509 * t1065;
  t1070 = t516 * t1043;
  t1072 = t180 * t1047;
  t1075 = my_piecewise3(t15, 0, -0.2e1 / 0.9e1 * t1070 + t1072 / 0.3e1);
  t1076 = t178 * t1075;
  t1080 = t504 + t788 / 0.27e2 + t27 * t29 * t1066 / 0.9e1 - t27 * t29 * t1076 / 0.18e2;
  t1081 = my_piecewise3(t36, t1080, 0);
  t1084 = t45 * t1061;
  t1086 = t193 * t1081;
  t1088 = t48 * t1061;
  t1090 = t197 * t1081;
  t1092 = t51 * t1061;
  t1094 = t201 * t1081;
  t1096 = t54 * t1061;
  t1098 = t205 * t1081;
  t1100 = t57 * t1061;
  t1102 = t209 * t1081;
  t1104 = t60 * t1061;
  t1106 = t213 * t1081;
  t1108 = t556 * t1061;
  t1110 = t217 * t1081;
  t1112 = t42 * t1061 / 0.6e1 - t170 * t1081 / 0.18e2 - t1084 / 0.48e2 + t1086 / 0.24e3 + t1088 / 0.64e3 - t1090 / 0.448e4 - t1092 / 0.1152e5 + t1094 / 0.10368e6 + t1096 / 0.258048e6 - t1098 / 0.2838528e7 - t1100 / 0.688128e7 + t1102 / 0.8945664e8 + t1104 / 0.21233664e9 - t1106 / 0.31850496e10 - t1108 / 0.74317824e10 + t1110 / 0.1263403008e12;
  t1113 = my_piecewise3(t36, 0, t1080);
  t1118 = t374 * t374;
  t1119 = t569 * t1118;
  t1135 = t590 * t1118;
  t1146 = -0.2e1 * t582 * t1118 * t72 + t228 * t1113 * t72 / 0.2e1 + t1135 * t72 / 0.4e1 - 0.4e1 * t1118 * t73 - t70 * t1118 * t72 - 0.4e1 * t232 * t1113 - t65 * t1113 * t72;
  t1149 = -t1119 * t72 / 0.2e1 + 0.2e1 * t574 * t1118 - t223 * t1113 + 0.2e1 * t1113 * t76 + 0.4e1 * t374 * t386 + 0.2e1 * t63 * t1146;
  t1153 = my_piecewise3(t35, t1112, -0.8e1 / 0.3e1 * t1113 * t79 - 0.16e2 / 0.3e1 * t374 * t389 - 0.8e1 / 0.3e1 * t63 * t1149);
  t1154 = t22 * t1153;
  t1156 = t7 * t21 * t1154;
  t1157 = 0.3e1 / 0.32e2 * t1156;
  t1158 = t398 * t398;
  t1161 = -t1047;
  t1165 = my_piecewise3(t88, 0, 0.4e1 / 0.9e1 * t269 * t1158 + 0.4e1 / 0.3e1 * t89 * t1161);
  t1166 = t9 * t1165;
  t1168 = t7 * t1166 * t146;
  t1169 = 0.3e1 / 0.32e2 * t1168;
  t1170 = t910 / 0.16e2;
  t1172 = t7 * t402 * t452;
  t1173 = 0.3e1 / 0.16e2 * t1172;
  t1174 = t922 / 0.16e2;
  t1175 = t414 * t414;
  t1179 = t408 * t408;
  t1180 = t650 * t1179;
  t1184 = t657 * t1158;
  t1186 = t269 * t1161;
  t1189 = my_piecewise3(t88, 0, -0.2e1 / 0.9e1 * t1184 + t1186 / 0.3e1);
  t1190 = t267 * t1189;
  t1194 = t645 + t929 / 0.27e2 + t27 * t29 * t1180 / 0.9e1 - t27 * t29 * t1190 / 0.18e2;
  t1195 = my_piecewise3(t99, t1194, 0);
  t1198 = t108 * t1175;
  t1200 = t282 * t1195;
  t1202 = t111 * t1175;
  t1204 = t286 * t1195;
  t1206 = t114 * t1175;
  t1208 = t290 * t1195;
  t1210 = t117 * t1175;
  t1212 = t294 * t1195;
  t1214 = t120 * t1175;
  t1216 = t298 * t1195;
  t1218 = t123 * t1175;
  t1220 = t302 * t1195;
  t1222 = t697 * t1175;
  t1224 = t306 * t1195;
  t1226 = t105 * t1175 / 0.6e1 - t262 * t1195 / 0.18e2 - t1198 / 0.48e2 + t1200 / 0.24e3 + t1202 / 0.64e3 - t1204 / 0.448e4 - t1206 / 0.1152e5 + t1208 / 0.10368e6 + t1210 / 0.258048e6 - t1212 / 0.2838528e7 - t1214 / 0.688128e7 + t1216 / 0.8945664e8 + t1218 / 0.21233664e9 - t1220 / 0.31850496e10 - t1222 / 0.74317824e10 + t1224 / 0.1263403008e12;
  t1227 = my_piecewise3(t99, 0, t1194);
  t1232 = t432 * t432;
  t1233 = t710 * t1232;
  t1249 = t731 * t1232;
  t1260 = -0.2e1 * t723 * t1232 * t134 + t317 * t1227 * t134 / 0.2e1 + t1249 * t134 / 0.4e1 - 0.4e1 * t1232 * t135 - t132 * t1232 * t134 - 0.4e1 * t321 * t1227 - t127 * t1227 * t134;
  t1263 = -t1233 * t134 / 0.2e1 + 0.2e1 * t715 * t1232 - t312 * t1227 + 0.2e1 * t1227 * t138 + 0.4e1 * t432 * t444 + 0.2e1 * t126 * t1260;
  t1267 = my_piecewise3(t98, t1226, -0.8e1 / 0.3e1 * t1227 * t141 - 0.16e2 / 0.3e1 * t432 * t447 - 0.8e1 / 0.3e1 * t126 * t1263);
  t1268 = t22 * t1267;
  t1270 = t7 * t92 * t1268;
  t1271 = 0.3e1 / 0.32e2 * t1270;
  t1272 = -t1055 - t1056 - t1059 + t491 - t1060 - t1157 - t1169 - t1170 - t1173 + t635 - t1174 - t1271;
  tv2rho22 = -0.3e1 / 0.16e2 * t346 - t459 - 0.3e1 / 0.16e2 * t396 - 0.3e1 / 0.16e2 * t404 - t462 - 0.3e1 / 0.16e2 * t454 + t11 * t1272;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1275 = t7 * t253 * t632;
  t1276 = t1275 / 0.16e2;
  t1278 = 0.1e1 / t163 / t152;
  t1279 = t1278 * t145;
  t1281 = t7 * t92 * t1279;
  t1282 = 0.5e1 / 0.144e3 * t1281;
  t1284 = t7 * t622 * t257;
  t1287 = t7 * t476 * t165;
  t1290 = t7 * t159 * t488;
  t1291 = t1290 / 0.16e2;
  t1292 = t1278 * t83;
  t1294 = t7 * t21 * t1292;
  t1295 = 0.5e1 / 0.144e3 * t1294;
  t1296 = t464 * t155;
  t1301 = t152 * t152;
  t1302 = 0.1e1 / t1301;
  t1303 = t10 * t1302;
  t1305 = 0.6e1 * t468 - 0.6e1 * t1303;
  t1309 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t1296 + 0.4e1 / 0.3e1 * t181 * t471 + 0.4e1 / 0.3e1 * t18 * t1305);
  t1310 = t9 * t1309;
  t1312 = t7 * t1310 * t84;
  t1313 = 0.3e1 / 0.32e2 * t1312;
  t1315 = t7 * t476 * t245;
  t1316 = 0.9e1 / 0.32e2 * t1315;
  t1318 = t7 * t159 * t492;
  t1321 = t7 * t159 * t610;
  t1322 = 0.9e1 / 0.32e2 * t1321;
  t1323 = t487 * t244;
  t1325 = t7 * t21 * t1323;
  t1326 = t1325 / 0.16e2;
  t1327 = t164 * t609;
  t1329 = t7 * t21 * t1327;
  t1333 = t1 / t22 / t467;
  t1336 = 0.14e2 / 0.243e3 * t27 * t1333 * t31;
  t1338 = t27 * t501 * t184;
  t1341 = t27 * t173 * t511;
  t1344 = t27 * t173 * t523;
  t1346 = t177 * t177;
  t1347 = 0.1e1 / t1346;
  t1348 = t510 * t183;
  t1349 = t1347 * t1348;
  t1353 = t183 * t522;
  t1357 = t14 * t14;
  t1359 = 0.1e1 / t179 / t1357;
  t1362 = t516 * t155;
  t1368 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1359 * t1296 - 0.2e1 / 0.3e1 * t1362 * t471 + t180 * t1305 / 0.3e1);
  t1369 = t178 * t1368;
  t1373 = -t1336 - 0.2e1 / 0.27e2 * t1338 - t1341 / 0.9e1 + t1344 / 0.18e2 - t27 * t29 * t1349 / 0.3e1 + t791 * t792 * t1353 / 0.3e1 - t27 * t29 * t1369 / 0.18e2;
  t1374 = my_piecewise3(t36, t1373, 0);
  t1391 = t496 * t189;
  t1402 = t209 * t1374 / 0.8945664e8 - t213 * t1374 / 0.31850496e10 + t217 * t1374 / 0.1263403008e12 - t170 * t1374 / 0.18e2 + t193 * t1374 / 0.24e3 - t197 * t1374 / 0.448e4 + t201 * t1374 / 0.10368e6 - t205 * t1374 / 0.2838528e7 - 0.2e1 / 0.3e1 * t193 * t1391 + t42 * t189 * t528 / 0.2e1 + t197 * t1391 / 0.8e1 - t45 * t189 * t528 / 0.16e2;
  t1429 = 0.1e1 / t59 / t169;
  t1435 = -t201 * t1391 / 0.8e2 + 0.3e1 / 0.64e3 * t48 * t189 * t528 + t205 * t1391 / 0.1152e4 - t51 * t189 * t528 / 0.384e4 - t209 * t1391 / 0.21504e5 + t54 * t189 * t528 / 0.86016e5 + t213 * t1391 / 0.49152e6 - t57 * t189 * t528 / 0.229376e7 - t217 * t1391 / 0.1327104e8 + t60 * t189 * t528 / 0.7077888e8 + t1429 * t1391 / 0.4128768e9 - t556 * t189 * t528 / 0.24772608e10;
  t1437 = my_piecewise3(t36, 0, t1373);
  t1444 = t570 * t221;
  t1448 = t72 * t562;
  t1451 = t567 * t567;
  t1452 = 0.1e1 / t1451;
  t1456 = t72 * t582;
  t1472 = t582 * t221;
  t1476 = 0.1e1 / t567 / t227;
  t1477 = t1476 * t1444;
  t1487 = 0.1e1 / t1451 / t63;
  t1488 = t1487 * t1444;
  t1499 = 0.15e2 / 0.2e1 * t569 * t1444 * t72 - 0.6e1 * t1472 * t1448 - 0.5e1 / 0.2e1 * t1477 * t72 + t228 * t1437 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t590 * t562 * t868 + t1488 * t72 / 0.8e1 - 0.12e2 * t877 * t562 - 0.3e1 * t880 * t1448 - 0.4e1 * t232 * t1437 - t65 * t1437 * t72;
  t1502 = 0.7e1 / 0.2e1 * t590 * t1444 * t72 - 0.3e1 / 0.2e1 * t853 * t1448 - t1452 * t1444 * t72 / 0.4e1 - 0.6e1 * t1456 * t1444 + 0.6e1 * t574 * t221 * t562 - t223 * t1437 + 0.2e1 * t1437 * t76 + 0.6e1 * t562 * t237 + 0.6e1 * t221 * t602 + 0.2e1 * t63 * t1499;
  t1506 = my_piecewise3(t35, t1402 + t1435, -0.8e1 / 0.3e1 * t1437 * t79 - 0.8e1 * t562 * t240 - 0.8e1 * t221 * t605 - 0.8e1 / 0.3e1 * t63 * t1502);
  t1507 = t22 * t1506;
  t1509 = t7 * t21 * t1507;
  t1510 = 0.3e1 / 0.32e2 * t1509;
  t1511 = t614 * t249;
  t1516 = -t1305;
  t1520 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t1511 + 0.4e1 / 0.3e1 * t270 * t617 + 0.4e1 / 0.3e1 * t89 * t1516);
  t1521 = t9 * t1520;
  t1523 = t7 * t1521 * t146;
  t1524 = 0.3e1 / 0.32e2 * t1523;
  t1526 = t7 * t622 * t334;
  t1527 = 0.9e1 / 0.32e2 * t1526;
  t1529 = t7 * t253 * t636;
  t1532 = t7 * t253 * t751;
  t1533 = 0.9e1 / 0.32e2 * t1532;
  t1534 = t487 * t333;
  t1536 = t7 * t92 * t1534;
  t1537 = t1536 / 0.16e2;
  t1538 = t164 * t750;
  t1540 = t7 * t92 * t1538;
  t1544 = 0.14e2 / 0.243e3 * t27 * t1333 * t94;
  t1546 = t27 * t501 * t273;
  t1549 = t27 * t173 * t652;
  t1552 = t27 * t173 * t664;
  t1554 = t266 * t266;
  t1555 = 0.1e1 / t1554;
  t1556 = t651 * t272;
  t1557 = t1555 * t1556;
  t1561 = t272 * t663;
  t1565 = t87 * t87;
  t1567 = 0.1e1 / t268 / t1565;
  t1570 = t657 * t249;
  t1576 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t1567 * t1511 - 0.2e1 / 0.3e1 * t1570 * t617 + t269 * t1516 / 0.3e1);
  t1577 = t267 * t1576;
  t1581 = -t1544 - 0.2e1 / 0.27e2 * t1546 - t1549 / 0.9e1 + t1552 / 0.18e2 - t27 * t29 * t1557 / 0.3e1 + t791 * t931 * t1561 / 0.3e1 - t27 * t29 * t1577 / 0.18e2;
  t1582 = my_piecewise3(t99, t1581, 0);
  t1599 = t640 * t278;
  t1610 = t306 * t1582 / 0.1263403008e12 - t262 * t1582 / 0.18e2 + t282 * t1582 / 0.24e3 - t286 * t1582 / 0.448e4 + t290 * t1582 / 0.10368e6 - t294 * t1582 / 0.2838528e7 + t298 * t1582 / 0.8945664e8 - t302 * t1582 / 0.31850496e10 + t286 * t1599 / 0.8e1 - t108 * t278 * t669 / 0.16e2 - t290 * t1599 / 0.8e2 + 0.3e1 / 0.64e3 * t111 * t278 * t669;
  t1632 = 0.1e1 / t122 / t261;
  t1643 = t294 * t1599 / 0.1152e4 - t114 * t278 * t669 / 0.384e4 - t298 * t1599 / 0.21504e5 + t117 * t278 * t669 / 0.86016e5 + t302 * t1599 / 0.49152e6 - t120 * t278 * t669 / 0.229376e7 - t306 * t1599 / 0.1327104e8 + t123 * t278 * t669 / 0.7077888e8 + t1632 * t1599 / 0.4128768e9 - t697 * t278 * t669 / 0.24772608e10 - 0.2e1 / 0.3e1 * t282 * t1599 + t105 * t278 * t669 / 0.2e1;
  t1645 = my_piecewise3(t99, 0, t1581);
  t1652 = t711 * t310;
  t1656 = t134 * t703;
  t1659 = t708 * t708;
  t1660 = 0.1e1 / t1659;
  t1664 = t134 * t723;
  t1667 = t310 * t703;
  t1680 = t723 * t310;
  t1684 = 0.1e1 / t708 / t316;
  t1685 = t1684 * t1652;
  t1695 = 0.1e1 / t1659 / t126;
  t1696 = t1695 * t1652;
  t1707 = 0.15e2 / 0.2e1 * t710 * t1652 * t134 - 0.6e1 * t1680 * t1656 - 0.5e1 / 0.2e1 * t1685 * t134 + t317 * t1645 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t731 * t703 * t1007 + t1696 * t134 / 0.8e1 - 0.12e2 * t1016 * t703 - 0.3e1 * t1019 * t1656 - 0.4e1 * t321 * t1645 - t127 * t1645 * t134;
  t1710 = 0.7e1 / 0.2e1 * t731 * t1652 * t134 - 0.3e1 / 0.2e1 * t992 * t1656 - t1660 * t1652 * t134 / 0.4e1 - 0.6e1 * t1664 * t1652 + 0.6e1 * t715 * t1667 - t312 * t1645 + 0.2e1 * t1645 * t138 + 0.6e1 * t703 * t326 + 0.6e1 * t310 * t743 + 0.2e1 * t126 * t1707;
  t1714 = my_piecewise3(t98, t1610 + t1643, -0.8e1 / 0.3e1 * t1645 * t141 - 0.8e1 * t703 * t329 - 0.8e1 * t310 * t746 - 0.8e1 / 0.3e1 * t126 * t1710);
  t1715 = t22 * t1714;
  t1717 = t7 * t92 * t1715;
  t1718 = 0.3e1 / 0.32e2 * t1717;
  t1719 = t1276 - t1282 - 0.3e1 / 0.32e2 * t1284 - 0.3e1 / 0.32e2 * t1287 + t1291 - t1295 - t1313 - t1316 - 0.3e1 / 0.16e2 * t1318 - t1322 + t1326 - 0.3e1 / 0.32e2 * t1329 - t1510 - t1524 - t1527 - 0.3e1 / 0.16e2 * t1529 - t1533 + t1537 - 0.3e1 / 0.32e2 * t1540 - t1718;
  t1722 = t490 / 0.16e2;
  t1724 = t634 / 0.16e2;
  tv3rho30 = t11 * t1719 - 0.3e1 / 0.16e2 * t481 + t1722 - 0.3e1 / 0.16e2 * t627 + t1724 - 0.9e1 / 0.32e2 * t478 - 0.9e1 / 0.16e2 * t484 - 0.3e1 / 0.16e2 * t494 - 0.9e1 / 0.32e2 * t612 - 0.9e1 / 0.32e2 * t624 - 0.9e1 / 0.16e2 * t630 - 0.3e1 / 0.16e2 * t638 - 0.9e1 / 0.32e2 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1737 = -t479 - t481 / 0.8e1 - t485 + t1722 - t494 / 0.8e1 - t613 - t625 - t627 / 0.8e1 - t631 + t1724 - t638 / 0.8e1 - t754;
  t1749 = t7 * t253 * t920;
  t1750 = t1749 / 0.16e2;
  t1751 = t487 * t451;
  t1753 = t7 * t92 * t1751;
  t1756 = t7 * t905 * t257;
  t1757 = t1756 / 0.16e2;
  t1759 = t7 * t402 * t632;
  t1762 = t7 * t159 * t779;
  t1763 = t1762 / 0.16e2;
  t1764 = t487 * t393;
  t1766 = t7 * t21 * t1764;
  t1768 = t1275 / 0.24e2 - t1282 - t1284 / 0.32e2 - t1287 / 0.32e2 + t1290 / 0.24e2 - t1295 - t1318 / 0.16e2 + t1325 / 0.24e2 - t1329 / 0.32e2 - t1529 / 0.16e2 + t1536 / 0.24e2 - t1540 / 0.32e2 - t1750 + t1753 / 0.48e2 - t1757 + t1759 / 0.48e2 - t1763 + t1766 / 0.48e2;
  t1770 = t7 * t764 * t165;
  t1771 = t1770 / 0.16e2;
  t1773 = t7 * t344 * t488;
  t1777 = t468 * t155;
  t1787 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t797 * t464 + 0.16e2 / 0.9e1 * t800 * t1777 + 0.4e1 / 0.9e1 * t348 * t471 + 0.8e1 / 0.3e1 * t18 * t468 - 0.8e1 * t759 * t1302);
  t1788 = t9 * t1787;
  t1790 = t7 * t1788 * t84;
  t1793 = t7 * t764 * t245;
  t1796 = t7 * t344 * t492;
  t1797 = t1796 / 0.16e2;
  t1799 = t7 * t344 * t610;
  t1802 = t7 * t476 * t394;
  t1805 = t7 * t159 * t894;
  t1807 = t164 * t893;
  t1809 = t7 * t21 * t1807;
  t1810 = t1809 / 0.16e2;
  t1811 = t556 * t810;
  t1816 = t42 * t810;
  t1821 = t45 * t810;
  t1826 = t48 * t810;
  t1831 = t51 * t810;
  t1836 = t54 * t810;
  t1841 = t57 * t810;
  t1846 = t60 * t810;
  t1851 = -t1811 * t189 / 0.37158912e10 - t843 * t528 / 0.74317824e10 + t1816 * t189 / 0.3e1 + t783 * t528 / 0.6e1 - t1821 * t189 / 0.24e2 - t813 * t528 / 0.48e2 + t1826 * t189 / 0.32e3 + t818 * t528 / 0.64e3 - t1831 * t189 / 0.576e4 - t823 * t528 / 0.1152e5 + t1836 * t189 / 0.129024e6 + t828 * t528 / 0.258048e6 - t1841 * t189 / 0.344064e7 - t833 * t528 / 0.688128e7 + t1846 * t189 / 0.10616832e9 + t838 * t528 / 0.21233664e9;
  t1866 = t1429 * t356;
  t1873 = t27 * t501 * t351;
  t1875 = t172 * t509;
  t1878 = 0.2e1 / 0.27e2 * t791 * t1875 * t793;
  t1881 = t27 * t173 * t805 / 0.27e2;
  t1882 = t28 * t1347;
  t1883 = t350 * t510;
  t1887 = t804 * t183;
  t1891 = t350 * t522;
  t1895 = t1359 * t340;
  t1898 = t516 * t10;
  t1903 = t180 * t468;
  t1908 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t1895 * t464 - 0.8e1 / 0.9e1 * t1898 * t1777 - 0.2e1 / 0.9e1 * t797 * t471 + 0.2e1 / 0.3e1 * t1903 - 0.2e1 * t800 * t1302);
  t1909 = t178 * t1908;
  t1913 = -t1336 - 0.4e1 / 0.81e2 * t1338 - t1341 / 0.27e2 + t1344 / 0.54e2 - 0.2e1 / 0.81e2 * t1873 - t1878 + t1881 - t791 * t1882 * t1883 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t1887 + t791 * t792 * t1891 / 0.9e1 - t27 * t29 * t1909 / 0.18e2;
  t1914 = my_piecewise3(t36, t1913, 0);
  t1931 = -0.2e1 / 0.3e1 * t359 * t496 + t361 * t496 / 0.8e1 - t363 * t496 / 0.8e2 + t365 * t496 / 0.1152e4 - t367 * t496 / 0.21504e5 + t369 * t496 / 0.49152e6 - t371 * t496 / 0.1327104e8 + t1866 * t496 / 0.4128768e9 + t209 * t1914 / 0.8945664e8 - t213 * t1914 / 0.31850496e10 + t217 * t1914 / 0.1263403008e12 - t170 * t1914 / 0.18e2 + t193 * t1914 / 0.24e3 - t197 * t1914 / 0.448e4 + t201 * t1914 / 0.10368e6 - t205 * t1914 / 0.2838528e7;
  t1933 = my_piecewise3(t36, 0, t1913);
  t1946 = t569 * t562;
  t1949 = t1452 * t570;
  t1952 = t72 * t849;
  t1974 = t569 * t374;
  t1975 = t72 * t570;
  t1978 = t582 * t849;
  t1981 = t1476 * t374;
  t1989 = t590 * t849;
  t1994 = t1487 * t374;
  t1997 = t562 * t73;
  t2002 = t70 * t562;
  t2010 = 0.15e2 / 0.2e1 * t1974 * t1975 - 0.4e1 * t1978 * t868 - 0.5e1 / 0.2e1 * t1981 * t1975 - 0.2e1 * t867 * t1448 + t228 * t1933 * t72 / 0.2e1 + t1989 * t868 / 0.2e1 + t874 * t1448 / 0.4e1 + t1994 * t1975 / 0.8e1 - 0.4e1 * t1997 * t374 - 0.8e1 * t877 * t849 - t2002 * t854 - 0.2e1 * t880 * t1952 - 0.4e1 * t232 * t1933 - t65 * t1933 * t72;
  t2013 = 0.7e1 / 0.2e1 * t591 * t854 - t1946 * t854 / 0.2e1 - t1949 * t854 / 0.4e1 - t853 * t1952 - 0.6e1 * t1456 * t374 * t570 + 0.4e1 * t574 * t849 * t221 + 0.2e1 * t574 * t374 * t562 - t223 * t1933 + 0.2e1 * t1933 * t76 + 0.4e1 * t849 * t237 + 0.2e1 * t374 * t602 + 0.2e1 * t562 * t386 + 0.4e1 * t221 * t886 + 0.2e1 * t63 * t2010;
  t2017 = my_piecewise3(t35, t1851 + t1931, -0.8e1 / 0.3e1 * t1933 * t79 - 0.16e2 / 0.3e1 * t849 * t240 - 0.8e1 / 0.3e1 * t374 * t605 - 0.8e1 / 0.3e1 * t562 * t389 - 0.16e2 / 0.3e1 * t221 * t889 - 0.8e1 / 0.3e1 * t63 * t2013);
  t2018 = t22 * t2017;
  t2020 = t7 * t21 * t2018;
  t2024 = t468 * t249;
  t2034 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t936 * t614 - 0.16e2 / 0.9e1 * t939 * t2024 + 0.4e1 / 0.9e1 * t406 * t617 - 0.8e1 / 0.3e1 * t89 * t468 + 0.8e1 * t900 * t1302);
  t2035 = t9 * t2034;
  t2037 = t7 * t2035 * t146;
  t2040 = t7 * t905 * t334;
  t2043 = t7 * t402 * t636;
  t2044 = t2043 / 0.16e2;
  t2046 = t7 * t402 * t751;
  t2049 = t7 * t622 * t452;
  t2052 = t7 * t253 * t1033;
  t2054 = t164 * t1032;
  t2056 = t7 * t92 * t2054;
  t2057 = t2056 / 0.16e2;
  t2058 = t105 * t949;
  t2063 = t108 * t949;
  t2068 = t111 * t949;
  t2073 = t114 * t949;
  t2078 = t117 * t949;
  t2083 = t120 * t949;
  t2088 = t123 * t949;
  t2093 = t697 * t949;
  t2098 = t2058 * t278 / 0.3e1 + t924 * t669 / 0.6e1 - t2063 * t278 / 0.24e2 - t952 * t669 / 0.48e2 + t2068 * t278 / 0.32e3 + t957 * t669 / 0.64e3 - t2073 * t278 / 0.576e4 - t962 * t669 / 0.1152e5 + t2078 * t278 / 0.129024e6 + t967 * t669 / 0.258048e6 - t2083 * t278 / 0.344064e7 - t972 * t669 / 0.688128e7 + t2088 * t278 / 0.10616832e9 + t977 * t669 / 0.21233664e9 - t2093 * t278 / 0.37158912e10 - t982 * t669 / 0.74317824e10;
  t2113 = t1632 * t414;
  t2120 = t27 * t501 * t409;
  t2122 = t172 * t650;
  t2125 = 0.2e1 / 0.27e2 * t791 * t2122 * t932;
  t2128 = t27 * t173 * t944 / 0.27e2;
  t2129 = t28 * t1555;
  t2130 = t408 * t651;
  t2134 = t943 * t272;
  t2138 = t408 * t663;
  t2142 = t1567 * t398;
  t2145 = t657 * t10;
  t2150 = t269 * t468;
  t2155 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2142 * t614 + 0.8e1 / 0.9e1 * t2145 * t2024 - 0.2e1 / 0.9e1 * t936 * t617 - 0.2e1 / 0.3e1 * t2150 + 0.2e1 * t939 * t1302);
  t2156 = t267 * t2155;
  t2160 = -t1544 - 0.4e1 / 0.81e2 * t1546 - t1549 / 0.27e2 + t1552 / 0.54e2 - 0.2e1 / 0.81e2 * t2120 - t2125 + t2128 - t791 * t2129 * t2130 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2134 + t791 * t931 * t2138 / 0.9e1 - t27 * t29 * t2156 / 0.18e2;
  t2161 = my_piecewise3(t99, t2160, 0);
  t2178 = -0.2e1 / 0.3e1 * t417 * t640 + t419 * t640 / 0.8e1 - t421 * t640 / 0.8e2 + t423 * t640 / 0.1152e4 - t425 * t640 / 0.21504e5 + t427 * t640 / 0.49152e6 - t429 * t640 / 0.1327104e8 + t2113 * t640 / 0.4128768e9 - t262 * t2161 / 0.18e2 + t282 * t2161 / 0.24e3 - t286 * t2161 / 0.448e4 + t290 * t2161 / 0.10368e6 - t294 * t2161 / 0.2838528e7 + t298 * t2161 / 0.8945664e8 - t302 * t2161 / 0.31850496e10 + t306 * t2161 / 0.1263403008e12;
  t2180 = my_piecewise3(t99, 0, t2160);
  t2193 = t710 * t703;
  t2196 = t1660 * t711;
  t2199 = t134 * t988;
  t2221 = t710 * t432;
  t2222 = t134 * t711;
  t2225 = t723 * t988;
  t2228 = t1684 * t432;
  t2236 = t731 * t988;
  t2241 = t1695 * t432;
  t2244 = t703 * t135;
  t2249 = t132 * t703;
  t2257 = 0.15e2 / 0.2e1 * t2221 * t2222 - 0.4e1 * t2225 * t1007 - 0.5e1 / 0.2e1 * t2228 * t2222 - 0.2e1 * t1006 * t1656 + t317 * t2180 * t134 / 0.2e1 + t2236 * t1007 / 0.2e1 + t1013 * t1656 / 0.4e1 + t2241 * t2222 / 0.8e1 - 0.4e1 * t2244 * t432 - 0.8e1 * t1016 * t988 - t2249 * t993 - 0.2e1 * t1019 * t2199 - 0.4e1 * t321 * t2180 - t127 * t2180 * t134;
  t2260 = 0.7e1 / 0.2e1 * t732 * t993 - t2193 * t993 / 0.2e1 - t2196 * t993 / 0.4e1 - t992 * t2199 - 0.6e1 * t1664 * t432 * t711 + 0.4e1 * t715 * t988 * t310 + 0.2e1 * t715 * t432 * t703 - t312 * t2180 + 0.2e1 * t2180 * t138 + 0.4e1 * t988 * t326 + 0.2e1 * t432 * t743 + 0.2e1 * t703 * t444 + 0.4e1 * t310 * t1025 + 0.2e1 * t126 * t2257;
  t2264 = my_piecewise3(t98, t2098 + t2178, -0.8e1 / 0.3e1 * t2180 * t141 - 0.16e2 / 0.3e1 * t988 * t329 - 0.8e1 / 0.3e1 * t432 * t746 - 0.8e1 / 0.3e1 * t703 * t447 - 0.16e2 / 0.3e1 * t310 * t1028 - 0.8e1 / 0.3e1 * t126 * t2260);
  t2265 = t22 * t2264;
  t2267 = t7 * t92 * t2265;
  t2269 = -t1771 + t1773 / 0.48e2 - 0.3e1 / 0.32e2 * t1790 - 0.3e1 / 0.16e2 * t1793 - t1797 - 0.3e1 / 0.32e2 * t1799 - 0.3e1 / 0.32e2 * t1802 - 0.3e1 / 0.16e2 * t1805 - t1810 - 0.3e1 / 0.32e2 * t2020 - 0.3e1 / 0.32e2 * t2037 - 0.3e1 / 0.16e2 * t2040 - t2044 - 0.3e1 / 0.32e2 * t2046 - 0.3e1 / 0.32e2 * t2049 - 0.3e1 / 0.16e2 * t2052 - t2057 - 0.3e1 / 0.32e2 * t2267;
  t2272 = 0.3e1 / 0.16e2 * t766;
  t2273 = 0.3e1 / 0.16e2 * t772;
  t2274 = 0.3e1 / 0.16e2 * t777;
  t2275 = 0.3e1 / 0.16e2 * t896;
  t2276 = 0.3e1 / 0.16e2 * t907;
  t2277 = 0.3e1 / 0.16e2 * t913;
  t2278 = 0.3e1 / 0.16e2 * t918;
  t2279 = 0.3e1 / 0.16e2 * t1035;
  t2280 = t11 * (t1768 + t2269) - t2272 - t1056 - t2273 - t2274 - t1060 - t2275 - t2276 - t1170 - t2277 - t2278 - t1174 - t2279;
  tv3rho31 = t1737 + t2280;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2289 = t1275 / 0.48e2 - t1282 + t1290 / 0.48e2 - t1295 + t1325 / 0.48e2 + t1536 / 0.48e2 - t1750 + t1753 / 0.24e2 - t1757 + t1759 / 0.24e2 - t1763 + t1766 / 0.24e2 - t1771 + t1773 / 0.24e2 - t1797 - t1810 - t2044 - t2057;
  t2290 = t164 * t1267;
  t2292 = t7 * t92 * t2290;
  t2295 = t7 * t1166 * t257;
  t2298 = t7 * t402 * t920;
  t2300 = t164 * t1153;
  t2302 = t7 * t21 * t2300;
  t2305 = t7 * t1052 * t165;
  t2308 = t7 * t344 * t779;
  t2311 = t7 * t159 * t1154;
  t2313 = t201 * t1061;
  t2318 = t48 * t1081;
  t2321 = t205 * t1061;
  t2326 = t51 * t1081;
  t2329 = t209 * t1061;
  t2334 = t54 * t1081;
  t2337 = t213 * t1061;
  t2342 = t57 * t1081;
  t2345 = t217 * t1061;
  t2350 = t60 * t1081;
  t2353 = t1429 * t1061;
  t2356 = -t2313 * t189 / 0.8e2 + t818 * t810 / 0.32e3 + t2318 * t189 / 0.64e3 + t2321 * t189 / 0.1152e4 - t823 * t810 / 0.576e4 - t2326 * t189 / 0.1152e5 - t2329 * t189 / 0.21504e5 + t828 * t810 / 0.129024e6 + t2334 * t189 / 0.258048e6 + t2337 * t189 / 0.49152e6 - t833 * t810 / 0.344064e7 - t2342 * t189 / 0.688128e7 - t2345 * t189 / 0.1327104e8 + t838 * t810 / 0.10616832e9 + t2350 * t189 / 0.21233664e9 + t2353 * t189 / 0.4128768e9;
  t2359 = t556 * t1081;
  t2362 = t193 * t1061;
  t2367 = t42 * t1081;
  t2370 = t197 * t1061;
  t2375 = t45 * t1081;
  t2381 = t27 * t173 * t1066;
  t2383 = t1065 * t183;
  t2387 = t350 * t804;
  t2392 = t27 * t173 * t1076;
  t2394 = t1075 * t183;
  t2398 = t1359 * t1043;
  t2403 = t516 * t1047;
  t2408 = -0.2e1 * t468 - 0.6e1 * t1303;
  t2409 = t180 * t2408;
  t2412 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t2398 * t155 - 0.8e1 / 0.9e1 * t797 * t469 - 0.2e1 / 0.9e1 * t2403 * t155 + t2409 / 0.3e1);
  t2413 = t178 * t2412;
  t2417 = -t1336 - 0.2e1 / 0.81e2 * t1338 - 0.4e1 / 0.81e2 * t1873 - t1878 + t1881 - t2381 / 0.27e2 - t791 * t1882 * t2383 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t2387 + t2392 / 0.54e2 + t791 * t792 * t2394 / 0.9e1 - t27 * t29 * t2413 / 0.18e2;
  t2418 = my_piecewise3(t36, t2417, 0);
  t2435 = -t843 * t810 / 0.37158912e10 - t2359 * t189 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2362 * t189 + t783 * t810 / 0.3e1 + t2367 * t189 / 0.6e1 + t2370 * t189 / 0.8e1 - t813 * t810 / 0.24e2 - t2375 * t189 / 0.48e2 - t170 * t2418 / 0.18e2 + t193 * t2418 / 0.24e3 - t197 * t2418 / 0.448e4 + t201 * t2418 / 0.10368e6 - t205 * t2418 / 0.2838528e7 + t209 * t2418 / 0.8945664e8 - t213 * t2418 / 0.31850496e10 + t217 * t2418 / 0.1263403008e12;
  t2437 = my_piecewise3(t36, 0, t2417);
  t2451 = t1452 * t1118;
  t2460 = t72 * t1113;
  t2481 = t1476 * t1118;
  t2484 = t582 * t1113;
  t2490 = t590 * t1113;
  t2495 = t1487 * t1118;
  t2498 = t374 * t73;
  t2501 = t70 * t374;
  t2511 = 0.15e2 / 0.2e1 * t1119 * t868 - 0.4e1 * t867 * t1952 - 0.5e1 / 0.2e1 * t2481 * t868 - 0.2e1 * t2484 * t868 + t228 * t2437 * t72 / 0.2e1 + t2490 * t868 / 0.4e1 + t874 * t1952 / 0.2e1 + t2495 * t868 / 0.8e1 - 0.8e1 * t2498 * t849 - 0.2e1 * t2501 * t1952 - 0.4e1 * t877 * t1113 - t880 * t2460 - 0.4e1 * t232 * t2437 - t65 * t2437 * t72;
  t2514 = 0.7e1 / 0.2e1 * t1135 * t868 - t1974 * t1952 - t2451 * t868 / 0.4e1 - 0.6e1 * t1456 * t1118 * t221 + 0.4e1 * t574 * t374 * t849 - t853 * t2460 / 0.2e1 + 0.2e1 * t574 * t1113 * t221 - t223 * t2437 + 0.2e1 * t2437 * t76 + 0.2e1 * t1113 * t237 + 0.4e1 * t849 * t386 + 0.4e1 * t374 * t886 + 0.2e1 * t221 * t1146 + 0.2e1 * t63 * t2511;
  t2518 = my_piecewise3(t35, t2356 + t2435, -0.8e1 / 0.3e1 * t2437 * t79 - 0.8e1 / 0.3e1 * t1113 * t240 - 0.16e2 / 0.3e1 * t849 * t389 - 0.16e2 / 0.3e1 * t374 * t889 - 0.8e1 / 0.3e1 * t221 * t1149 - 0.8e1 / 0.3e1 * t63 * t2514);
  t2519 = t22 * t2518;
  t2521 = t7 * t21 * t2519;
  t2529 = -t2408;
  t2533 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t1184 * t249 - 0.16e2 / 0.9e1 * t406 * t469 + 0.4e1 / 0.9e1 * t1186 * t249 + 0.4e1 / 0.3e1 * t89 * t2529);
  t2534 = t9 * t2533;
  t2536 = t7 * t2534 * t146;
  t2539 = t7 * t1166 * t334;
  t2542 = t7 * t905 * t452;
  t2545 = t7 * t402 * t1033;
  t2548 = t7 * t253 * t1268;
  t2552 = t105 * t1195;
  t2555 = t286 * t1175;
  t2560 = t108 * t1195;
  t2563 = t290 * t1175;
  t2568 = t111 * t1195;
  t2571 = t294 * t1175;
  t2576 = t114 * t1195;
  t2579 = t298 * t1175;
  t2584 = t117 * t1195;
  t2587 = t302 * t1175;
  t2592 = t924 * t949 / 0.3e1 + t2552 * t278 / 0.6e1 + t2555 * t278 / 0.8e1 - t952 * t949 / 0.24e2 - t2560 * t278 / 0.48e2 - t2563 * t278 / 0.8e2 + t957 * t949 / 0.32e3 + t2568 * t278 / 0.64e3 + t2571 * t278 / 0.1152e4 - t962 * t949 / 0.576e4 - t2576 * t278 / 0.1152e5 - t2579 * t278 / 0.21504e5 + t967 * t949 / 0.129024e6 + t2584 * t278 / 0.258048e6 + t2587 * t278 / 0.49152e6 - t972 * t949 / 0.344064e7;
  t2593 = t120 * t1195;
  t2596 = t306 * t1175;
  t2601 = t123 * t1195;
  t2604 = t1632 * t1175;
  t2609 = t697 * t1195;
  t2612 = t282 * t1175;
  t2618 = t27 * t173 * t1180;
  t2620 = t1179 * t272;
  t2624 = t408 * t943;
  t2629 = t27 * t173 * t1190;
  t2631 = t1189 * t272;
  t2635 = t1567 * t1158;
  t2640 = t657 * t1161;
  t2643 = t269 * t2529;
  t2646 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2635 * t249 + 0.8e1 / 0.9e1 * t936 * t469 - 0.2e1 / 0.9e1 * t2640 * t249 + t2643 / 0.3e1);
  t2647 = t267 * t2646;
  t2651 = -t1544 - 0.2e1 / 0.81e2 * t1546 - 0.4e1 / 0.81e2 * t2120 - t2125 + t2128 - t2618 / 0.27e2 - t791 * t2129 * t2620 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t2624 + t2629 / 0.54e2 + t791 * t931 * t2631 / 0.9e1 - t27 * t29 * t2647 / 0.18e2;
  t2652 = my_piecewise3(t99, t2651, 0);
  t2669 = -t2593 * t278 / 0.688128e7 - t2596 * t278 / 0.1327104e8 + t977 * t949 / 0.10616832e9 + t2601 * t278 / 0.21233664e9 + t2604 * t278 / 0.4128768e9 - t982 * t949 / 0.37158912e10 - t2609 * t278 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2612 * t278 + t282 * t2652 / 0.24e3 - t286 * t2652 / 0.448e4 + t290 * t2652 / 0.10368e6 - t294 * t2652 / 0.2838528e7 + t298 * t2652 / 0.8945664e8 - t302 * t2652 / 0.31850496e10 + t306 * t2652 / 0.1263403008e12 - t262 * t2652 / 0.18e2;
  t2671 = my_piecewise3(t99, 0, t2651);
  t2685 = t1660 * t1232;
  t2694 = t134 * t1227;
  t2715 = t1684 * t1232;
  t2718 = t723 * t1227;
  t2724 = t731 * t1227;
  t2729 = t1695 * t1232;
  t2732 = t432 * t135;
  t2735 = t132 * t432;
  t2745 = 0.15e2 / 0.2e1 * t1233 * t1007 - 0.4e1 * t1006 * t2199 - 0.5e1 / 0.2e1 * t2715 * t1007 - 0.2e1 * t2718 * t1007 + t317 * t2671 * t134 / 0.2e1 + t2724 * t1007 / 0.4e1 + t1013 * t2199 / 0.2e1 + t2729 * t1007 / 0.8e1 - 0.8e1 * t2732 * t988 - 0.2e1 * t2735 * t2199 - 0.4e1 * t1016 * t1227 - t1019 * t2694 - 0.4e1 * t321 * t2671 - t127 * t2671 * t134;
  t2748 = 0.7e1 / 0.2e1 * t1249 * t1007 - t2221 * t2199 - t2685 * t1007 / 0.4e1 - 0.6e1 * t1664 * t1232 * t310 + 0.4e1 * t715 * t432 * t988 - t992 * t2694 / 0.2e1 + 0.2e1 * t715 * t1227 * t310 - t312 * t2671 + 0.2e1 * t2671 * t138 + 0.2e1 * t1227 * t326 + 0.4e1 * t988 * t444 + 0.4e1 * t432 * t1025 + 0.2e1 * t310 * t1260 + 0.2e1 * t126 * t2745;
  t2752 = my_piecewise3(t98, t2592 + t2669, -0.8e1 / 0.3e1 * t2671 * t141 - 0.8e1 / 0.3e1 * t1227 * t329 - 0.16e2 / 0.3e1 * t988 * t447 - 0.16e2 / 0.3e1 * t432 * t1028 - 0.8e1 / 0.3e1 * t310 * t1263 - 0.8e1 / 0.3e1 * t126 * t2748);
  t2753 = t22 * t2752;
  t2755 = t7 * t92 * t2753;
  t2766 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t1070 * t155 + 0.16e2 / 0.9e1 * t348 * t469 + 0.4e1 / 0.9e1 * t1072 * t155 + 0.4e1 / 0.3e1 * t18 * t2408);
  t2767 = t9 * t2766;
  t2769 = t7 * t2767 * t84;
  t2772 = t7 * t1052 * t245;
  t2775 = t7 * t764 * t394;
  t2778 = t7 * t344 * t894;
  t2780 = -t2292 / 0.32e2 - t2295 / 0.32e2 - t2298 / 0.16e2 - t2302 / 0.32e2 - t2305 / 0.32e2 - t2308 / 0.16e2 - 0.3e1 / 0.32e2 * t2311 - 0.3e1 / 0.32e2 * t2521 - 0.3e1 / 0.32e2 * t2536 - 0.3e1 / 0.32e2 * t2539 - 0.3e1 / 0.16e2 * t2542 - 0.3e1 / 0.16e2 * t2545 - 0.3e1 / 0.32e2 * t2548 - 0.3e1 / 0.32e2 * t2755 - 0.3e1 / 0.32e2 * t2769 - 0.3e1 / 0.32e2 * t2772 - 0.3e1 / 0.16e2 * t2775 - 0.3e1 / 0.16e2 * t2778;
  t2785 = -t482 + t1722 - t495 - t628 + t1724 - t639 + t11 * (t2289 + t2780) - t2272 - t769 / 0.8e1 - t2273 - t2274 - t781 / 0.8e1;
  t2788 = -t2275 - t2276 - t910 / 0.8e1 - t2277 - t2278 - t922 / 0.8e1 - t2279 - t1055 - t1059 - t1157 - t1169 - t1173 - t1271;
  tv3rho32 = t2785 + t2788;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2795 = t1158 * t398;
  t2801 = 0.6e1 * t468 + 0.6e1 * t1303;
  t2805 = my_piecewise3(t88, 0, -0.8e1 / 0.27e2 * t657 * t2795 + 0.4e1 / 0.3e1 * t406 * t1161 + 0.4e1 / 0.3e1 * t89 * t2801);
  t2806 = t9 * t2805;
  t2808 = t7 * t2806 * t146;
  t2809 = 0.3e1 / 0.32e2 * t2808;
  t2811 = t7 * t1166 * t452;
  t2812 = 0.9e1 / 0.32e2 * t2811;
  t2814 = t7 * t402 * t1268;
  t2815 = 0.9e1 / 0.32e2 * t2814;
  t2819 = t1179 * t408;
  t2820 = t1555 * t2819;
  t2824 = t408 * t1189;
  t2828 = t1567 * t2795;
  t2832 = t269 * t2801;
  t2835 = my_piecewise3(t88, 0, 0.1e2 / 0.27e2 * t2828 - 0.2e1 / 0.3e1 * t936 * t1161 + t2832 / 0.3e1);
  t2836 = t267 * t2835;
  t2840 = -t1544 - 0.2e1 / 0.27e2 * t2120 - t2618 / 0.9e1 + t2629 / 0.18e2 - t27 * t29 * t2820 / 0.3e1 + t791 * t931 * t2824 / 0.3e1 - t27 * t29 * t2836 / 0.18e2;
  t2841 = my_piecewise3(t99, t2840, 0);
  t2858 = t1175 * t414;
  t2867 = t298 * t2841 / 0.8945664e8 - t302 * t2841 / 0.31850496e10 + t306 * t2841 / 0.1263403008e12 - t262 * t2841 / 0.18e2 + t282 * t2841 / 0.24e3 - t286 * t2841 / 0.448e4 + t290 * t2841 / 0.10368e6 - t294 * t2841 / 0.2838528e7 - 0.2e1 / 0.3e1 * t282 * t2858 + t924 * t1195 / 0.2e1 + t286 * t2858 / 0.8e1 - t952 * t1195 / 0.16e2;
  t2892 = -t290 * t2858 / 0.8e2 + 0.3e1 / 0.64e3 * t957 * t1195 + t294 * t2858 / 0.1152e4 - t962 * t1195 / 0.384e4 - t298 * t2858 / 0.21504e5 + t967 * t1195 / 0.86016e5 + t302 * t2858 / 0.49152e6 - t972 * t1195 / 0.229376e7 - t306 * t2858 / 0.1327104e8 + t977 * t1195 / 0.7077888e8 + t1632 * t2858 / 0.4128768e9 - t982 * t1195 / 0.24772608e10;
  t2894 = my_piecewise3(t99, 0, t2840);
  t2901 = t1232 * t432;
  t2902 = t731 * t2901;
  t2907 = t1660 * t2901;
  t2912 = t432 * t1227;
  t2927 = t1684 * t2901;
  t2935 = t1695 * t2901;
  t2946 = 0.15e2 / 0.2e1 * t710 * t2901 * t134 - 0.6e1 * t1006 * t2694 - 0.5e1 / 0.2e1 * t2927 * t134 + t317 * t2894 * t134 / 0.2e1 + 0.3e1 / 0.4e1 * t2724 * t993 + t2935 * t134 / 0.8e1 - 0.12e2 * t2732 * t1227 - 0.3e1 * t2735 * t2694 - 0.4e1 * t321 * t2894 - t127 * t2894 * t134;
  t2949 = 0.7e1 / 0.2e1 * t2902 * t134 - 0.3e1 / 0.2e1 * t2221 * t2694 - t2907 * t134 / 0.4e1 - 0.6e1 * t1664 * t2901 + 0.6e1 * t715 * t2912 - t312 * t2894 + 0.2e1 * t2894 * t138 + 0.6e1 * t1227 * t444 + 0.6e1 * t432 * t1260 + 0.2e1 * t126 * t2946;
  t2953 = my_piecewise3(t98, t2867 + t2892, -0.8e1 / 0.3e1 * t2894 * t141 - 0.8e1 * t1227 * t447 - 0.8e1 * t432 * t1263 - 0.8e1 / 0.3e1 * t126 * t2949);
  t2954 = t22 * t2953;
  t2956 = t7 * t92 * t2954;
  t2957 = 0.3e1 / 0.32e2 * t2956;
  t2958 = t1043 * t340;
  t2963 = -t2801;
  t2967 = my_piecewise3(t15, 0, -0.8e1 / 0.27e2 * t516 * t2958 + 0.4e1 / 0.3e1 * t348 * t1047 + 0.4e1 / 0.3e1 * t18 * t2963);
  t2968 = t9 * t2967;
  t2970 = t7 * t2968 * t84;
  t2971 = 0.3e1 / 0.32e2 * t2970;
  t2973 = t7 * t1052 * t394;
  t2974 = 0.9e1 / 0.32e2 * t2973;
  t2976 = t7 * t344 * t1154;
  t2977 = 0.9e1 / 0.32e2 * t2976;
  t2981 = t1065 * t350;
  t2982 = t1347 * t2981;
  t2986 = t350 * t1075;
  t2990 = t1359 * t2958;
  t2994 = t180 * t2963;
  t2997 = my_piecewise3(t15, 0, 0.1e2 / 0.27e2 * t2990 - 0.2e1 / 0.3e1 * t797 * t1047 + t2994 / 0.3e1);
  t2998 = t178 * t2997;
  t3002 = -t1336 - 0.2e1 / 0.27e2 * t1873 - t2381 / 0.9e1 + t2392 / 0.18e2 - t27 * t29 * t2982 / 0.3e1 + t791 * t792 * t2986 / 0.3e1 - t27 * t29 * t2998 / 0.18e2;
  t3003 = my_piecewise3(t36, t3002, 0);
  t3014 = t1061 * t356;
  t3029 = t201 * t3003 / 0.10368e6 - t205 * t3003 / 0.2838528e7 + t209 * t3003 / 0.8945664e8 - t213 * t3003 / 0.31850496e10 + t217 * t3003 / 0.1263403008e12 - 0.2e1 / 0.3e1 * t193 * t3014 + t783 * t1081 / 0.2e1 + t197 * t3014 / 0.8e1 - t813 * t1081 / 0.16e2 - t201 * t3014 / 0.8e2 + 0.3e1 / 0.64e3 * t818 * t1081 + t205 * t3014 / 0.1152e4;
  t3054 = -t823 * t1081 / 0.384e4 - t209 * t3014 / 0.21504e5 + t828 * t1081 / 0.86016e5 + t213 * t3014 / 0.49152e6 - t833 * t1081 / 0.229376e7 - t217 * t3014 / 0.1327104e8 + t838 * t1081 / 0.7077888e8 + t1429 * t3014 / 0.4128768e9 - t843 * t1081 / 0.24772608e10 - t170 * t3003 / 0.18e2 + t193 * t3003 / 0.24e3 - t197 * t3003 / 0.448e4;
  t3056 = my_piecewise3(t36, 0, t3002);
  t3063 = t1118 * t374;
  t3064 = t590 * t3063;
  t3069 = t1452 * t3063;
  t3074 = t374 * t1113;
  t3089 = t1476 * t3063;
  t3097 = t1487 * t3063;
  t3108 = 0.15e2 / 0.2e1 * t569 * t3063 * t72 - 0.6e1 * t867 * t2460 - 0.5e1 / 0.2e1 * t3089 * t72 + t228 * t3056 * t72 / 0.2e1 + 0.3e1 / 0.4e1 * t2490 * t854 + t3097 * t72 / 0.8e1 - 0.12e2 * t2498 * t1113 - 0.3e1 * t2501 * t2460 - 0.4e1 * t232 * t3056 - t65 * t3056 * t72;
  t3111 = 0.7e1 / 0.2e1 * t3064 * t72 - 0.3e1 / 0.2e1 * t1974 * t2460 - t3069 * t72 / 0.4e1 - 0.6e1 * t1456 * t3063 + 0.6e1 * t574 * t3074 - t223 * t3056 + 0.2e1 * t3056 * t76 + 0.6e1 * t1113 * t386 + 0.6e1 * t374 * t1146 + 0.2e1 * t63 * t3108;
  t3115 = my_piecewise3(t35, t3029 + t3054, -0.8e1 / 0.3e1 * t3056 * t79 - 0.8e1 * t1113 * t389 - 0.8e1 * t374 * t1149 - 0.8e1 / 0.3e1 * t63 * t3111);
  t3116 = t22 * t3115;
  t3118 = t7 * t21 * t3116;
  t3119 = 0.3e1 / 0.32e2 * t3118;
  t3120 = t1753 / 0.16e2;
  t3121 = t1759 / 0.16e2;
  t3122 = t1766 / 0.16e2;
  t3123 = t1773 / 0.16e2;
  t3124 = -0.3e1 / 0.32e2 * t2292 - 0.3e1 / 0.32e2 * t2295 - 0.3e1 / 0.16e2 * t2298 - 0.3e1 / 0.32e2 * t2302 - 0.3e1 / 0.32e2 * t2305 - 0.3e1 / 0.16e2 * t2308 - t2809 - t2812 - t2815 - t2957 - t2971 - t2974 - t2977 - t3119 + t3120 + t3121 + t3122 + t3123 - t1282 - t1295;
  tv3rho33 = t11 * t3124 + t1722 + t1724 - 0.3e1 / 0.16e2 * t769 - 0.3e1 / 0.16e2 * t781 - 0.3e1 / 0.16e2 * t910 - 0.3e1 / 0.16e2 * t922 - 0.9e1 / 0.32e2 * t1054 - 0.9e1 / 0.16e2 * t1058 - 0.9e1 / 0.32e2 * t1156 - 0.9e1 / 0.32e2 * t1168 - 0.9e1 / 0.16e2 * t1172 - 0.9e1 / 0.32e2 * t1270;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t3138 = t1 / t22 / t1301;
  t3141 = 0.14e3 / 0.729e3 * t27 * t3138 * t31;
  t3143 = t27 * t1333 * t184;
  t3146 = t27 * t501 * t511;
  t3149 = t27 * t501 * t523;
  t3152 = t27 * t173 * t1349;
  t3155 = t791 * t1875 * t1353;
  t3158 = t27 * t173 * t1369;
  t3161 = 0.1e1 / t1346 / t30;
  t3162 = t510 * t510;
  t3171 = t522 * t522;
  t3182 = 0.1e1 / t179 / t1357 / t14;
  t3183 = t464 * t464;
  t3189 = t471 * t471;
  t3195 = 0.1e1 / t1301 / t11;
  t3196 = t10 * t3195;
  t3198 = -0.24e2 * t1302 + 0.24e2 * t3196;
  t3202 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3182 * t3183 + 0.2e2 / 0.9e1 * t1359 * t464 * t471 - 0.2e1 / 0.3e1 * t516 * t3189 - 0.8e1 / 0.9e1 * t1362 * t1305 + t180 * t3198 / 0.3e1);
  t3207 = t3141 + 0.56e2 / 0.243e3 * t3143 + 0.8e1 / 0.27e2 * t3146 - 0.4e1 / 0.27e2 * t3149 + 0.4e1 / 0.9e1 * t3152 - 0.4e1 / 0.9e1 * t3155 + 0.2e1 / 0.27e2 * t3158 + 0.4e1 / 0.3e1 * t27 * t29 * t3161 * t3162 - 0.2e1 * t791 * t1882 * t510 * t522 + t27 * t29 * t509 * t3171 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t792 * t183 * t1368 - t27 * t29 * t178 * t3202 / 0.18e2;
  t3208 = my_piecewise3(t36, t3207, 0);
  t3225 = t496 * t496;
  t3228 = t528 * t528;
  t3240 = 0.1e1 / t59 / t41;
  t3253 = -t170 * t3208 / 0.18e2 + t193 * t3208 / 0.24e3 - t197 * t3208 / 0.448e4 + t201 * t3208 / 0.10368e6 - t205 * t3208 / 0.2838528e7 + t209 * t3208 / 0.8945664e8 - t213 * t3208 / 0.31850496e10 + t217 * t3208 / 0.1263403008e12 + 0.13e2 / 0.21504e5 * t57 * t3225 + t54 * t3228 / 0.86016e5 - t60 * t3225 / 0.32768e5 - t57 * t3228 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t556 * t3225 + t60 * t3228 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3240 * t3225 - t556 * t3228 / 0.24772608e10 + 0.1e2 / 0.3e1 * t45 * t3225 + t42 * t3228 / 0.2e1 - 0.7e1 / 0.8e1 * t48 * t3225 - t45 * t3228 / 0.16e2;
  t3310 = 0.9e1 / 0.8e2 * t51 * t3225 + 0.3e1 / 0.64e3 * t48 * t3228 - 0.11e2 / 0.1152e4 * t54 * t3225 - t51 * t3228 / 0.384e4 - t209 * t496 * t528 / 0.3584e4 + t213 * t496 * t528 / 0.8192e5 - t217 * t496 * t528 / 0.221184e7 + t1429 * t496 * t528 / 0.688128e8 - t57 * t1374 * t189 / 0.172032e7 + t60 * t1374 * t189 / 0.5308416e8 - t556 * t1374 * t189 / 0.18579456e10 + 0.2e1 / 0.3e1 * t42 * t1374 * t189 - t45 * t1374 * t189 / 0.12e2 + t48 * t1374 * t189 / 0.16e3 - t51 * t1374 * t189 / 0.288e4 + t54 * t1374 * t189 / 0.64512e5 - 0.4e1 * t193 * t496 * t528 + 0.3e1 / 0.4e1 * t197 * t496 * t528 - 0.3e1 / 0.4e2 * t201 * t496 * t528 + t205 * t496 * t528 / 0.192e3;
  t3312 = my_piecewise3(t36, 0, t3207);
  t3321 = t570 * t570;
  t3326 = 0.1e1 / t1451 / t69;
  t3334 = 0.1e1 / t1451 / t567;
  t3338 = t562 * t562;
  t3350 = t72 * t1437;
  t3374 = 0.85e2 / 0.4e1 * t1452 * t3321 * t72 - 0.19e2 / 0.8e1 * t3326 * t3321 * t72 + t228 * t3312 * t72 / 0.2e1 + t3334 * t3321 * t72 / 0.16e2 - 0.12e2 * t3338 * t73 - 0.16e2 * t877 * t1437 - 0.4e1 * t232 * t3312 - t65 * t3312 * t72 - 0.3e1 * t70 * t3338 * t72 - 0.4e1 * t880 * t3350 - 0.75e2 / 0.2e1 * t590 * t3321 * t72 + 0.45e2 * t571 * t1448 - 0.6e1 * t582 * t3338 * t72 - 0.8e1 * t1472 * t3350 - 0.15e2 * t1476 * t570 * t1448 + t590 * t1437 * t868 + 0.3e1 / 0.4e1 * t590 * t3338 * t72 + 0.3e1 / 0.4e1 * t1487 * t562 * t1975;
  t3389 = 0.1e1 / t1451 / t227;
  t3406 = t72 * t569;
  t3417 = 0.2e1 * t63 * t3374 + 0.2e1 * t3312 * t76 + 0.8e1 * t1437 * t237 + 0.12e2 * t562 * t602 + 0.8e1 * t221 * t1499 + 0.15e2 / 0.4e1 * t1487 * t3321 * t72 - t3389 * t3321 * t72 / 0.8e1 - t223 * t3312 - 0.24e2 * t1476 * t3321 * t72 + 0.21e2 * t591 * t1448 - 0.3e1 / 0.2e1 * t569 * t3338 * t72 - 0.2e1 * t853 * t3350 - 0.3e1 / 0.2e1 * t1949 * t1448 + 0.24e2 * t3406 * t3321 - 0.36e2 * t1456 * t570 * t562 + 0.6e1 * t574 * t3338 + 0.8e1 * t574 * t221 * t1437;
  t3421 = my_piecewise3(t35, t3253 + t3310, -0.8e1 / 0.3e1 * t3312 * t79 - 0.32e2 / 0.3e1 * t1437 * t240 - 0.16e2 * t562 * t605 - 0.32e2 / 0.3e1 * t221 * t1502 - 0.8e1 / 0.3e1 * t63 * t3417);
  t3427 = t7 * t622 * t632;
  t3430 = t7 * t253 * t1534;
  t3434 = t7 * t92 * t1278 * t333;
  t3437 = t7 * t1521 * t257;
  t3440 = t7 * t622 * t636;
  t3443 = t7 * t1310 * t165;
  t3446 = t7 * t476 * t492;
  t3449 = t7 * t159 * t1323;
  t3453 = t7 * t21 * t1278 * t244;
  t3466 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t1359 * t3183 - 0.16e2 / 0.9e1 * t517 * t471 + 0.4e1 / 0.3e1 * t180 * t3189 + 0.16e2 / 0.9e1 * t181 * t1305 + 0.4e1 / 0.3e1 * t18 * t3198);
  t3478 = t7 * t253 * t1538;
  t3483 = -0.3e1 / 0.32e2 * t7 * t21 * t22 * t3421 + t3427 / 0.8e1 + t3430 / 0.4e1 - 0.5e1 / 0.36e2 * t3434 - t3437 / 0.8e1 - 0.3e1 / 0.8e1 * t3440 - t3443 / 0.8e1 - 0.3e1 / 0.8e1 * t3446 + t3449 / 0.4e1 - 0.5e1 / 0.36e2 * t3453 - 0.3e1 / 0.32e2 * t7 * t9 * t3466 * t84 - 0.3e1 / 0.8e1 * t7 * t1310 * t245 - 0.9e1 / 0.16e2 * t7 * t622 * t751 - 0.3e1 / 0.8e1 * t3478 - 0.3e1 / 0.8e1 * t7 * t253 * t1715;
  t3488 = t7 * t159 * t1327;
  t3495 = t7 * t21 * t487 * t609;
  t3499 = t7 * t21 * t164 * t1506;
  t3502 = 0.1e1 / t163 / t467;
  t3506 = 0.5e1 / 0.54e2 * t7 * t21 * t3502 * t83;
  t3508 = t7 * t253 * t1279;
  t3513 = 0.5e1 / 0.54e2 * t7 * t92 * t3502 * t145;
  t3515 = t7 * t476 * t488;
  t3519 = t7 * t92 * t487 * t750;
  t3523 = t7 * t92 * t164 * t1714;
  t3527 = 0.14e3 / 0.729e3 * t27 * t3138 * t94;
  t3529 = t27 * t1333 * t273;
  t3532 = t27 * t501 * t652;
  t3535 = t27 * t501 * t664;
  t3538 = t27 * t173 * t1557;
  t3541 = t791 * t2122 * t1561;
  t3544 = t27 * t173 * t1577;
  t3547 = 0.1e1 / t1554 / t93;
  t3548 = t651 * t651;
  t3557 = t663 * t663;
  t3568 = 0.1e1 / t268 / t1565 / t87;
  t3569 = t614 * t614;
  t3575 = t617 * t617;
  t3580 = -t3198;
  t3584 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3568 * t3569 + 0.2e2 / 0.9e1 * t1567 * t614 * t617 - 0.2e1 / 0.3e1 * t657 * t3575 - 0.8e1 / 0.9e1 * t1570 * t1516 + t269 * t3580 / 0.3e1);
  t3589 = t3527 + 0.56e2 / 0.243e3 * t3529 + 0.8e1 / 0.27e2 * t3532 - 0.4e1 / 0.27e2 * t3535 + 0.4e1 / 0.9e1 * t3538 - 0.4e1 / 0.9e1 * t3541 + 0.2e1 / 0.27e2 * t3544 + 0.4e1 / 0.3e1 * t27 * t29 * t3547 * t3548 - 0.2e1 * t791 * t2129 * t651 * t663 + t27 * t29 * t650 * t3557 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t931 * t272 * t1576 - t27 * t29 * t267 * t3584 / 0.18e2;
  t3590 = my_piecewise3(t99, t3589, 0);
  t3607 = t640 * t640;
  t3610 = t669 * t669;
  t3633 = t306 * t3590 / 0.1263403008e12 - t262 * t3590 / 0.18e2 + t282 * t3590 / 0.24e3 - t286 * t3590 / 0.448e4 + t290 * t3590 / 0.10368e6 - t294 * t3590 / 0.2838528e7 + t298 * t3590 / 0.8945664e8 - t302 * t3590 / 0.31850496e10 - 0.7e1 / 0.8e1 * t111 * t3607 - t108 * t3610 / 0.16e2 + 0.9e1 / 0.8e2 * t114 * t3607 + 0.3e1 / 0.64e3 * t111 * t3610 - 0.11e2 / 0.1152e4 * t117 * t3607 - t114 * t3610 / 0.384e4 + 0.13e2 / 0.21504e5 * t120 * t3607 + t117 * t3610 / 0.86016e5 - t123 * t3607 / 0.32768e5 - t120 * t3610 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t697 * t3607 + t123 * t3610 / 0.7077888e8;
  t3635 = 0.1e1 / t122 / t104;
  t3692 = -0.19e2 / 0.4128768e9 * t3635 * t3607 - t697 * t3610 / 0.24772608e10 + 0.1e2 / 0.3e1 * t108 * t3607 + t105 * t3610 / 0.2e1 + 0.2e1 / 0.3e1 * t105 * t1582 * t278 - t108 * t1582 * t278 / 0.12e2 + t111 * t1582 * t278 / 0.16e3 - t114 * t1582 * t278 / 0.288e4 + t117 * t1582 * t278 / 0.64512e5 - t120 * t1582 * t278 / 0.172032e7 + t123 * t1582 * t278 / 0.5308416e8 + 0.3e1 / 0.4e1 * t286 * t640 * t669 - 0.3e1 / 0.4e2 * t290 * t640 * t669 + t294 * t640 * t669 / 0.192e3 - t298 * t640 * t669 / 0.3584e4 + t302 * t640 * t669 / 0.8192e5 - t306 * t640 * t669 / 0.221184e7 + t1632 * t640 * t669 / 0.688128e8 - 0.4e1 * t282 * t640 * t669 - t697 * t1582 * t278 / 0.18579456e10;
  t3694 = my_piecewise3(t99, 0, t3589);
  t3703 = t134 * t1645;
  t3708 = t134 * t710;
  t3709 = t711 * t711;
  t3715 = t703 * t703;
  t3733 = 0.1e1 / t1659 / t316;
  t3774 = 0.1e1 / t1659 / t131;
  t3782 = 0.1e1 / t1659 / t708;
  t3788 = 0.45e2 * t712 * t1656 - 0.6e1 * t723 * t3715 * t134 - 0.8e1 * t1680 * t3703 - 0.15e2 * t1684 * t711 * t1656 + t731 * t1645 * t1007 + 0.3e1 / 0.4e1 * t731 * t3715 * t134 + 0.3e1 / 0.4e1 * t1695 * t703 * t2222 - 0.3e1 * t132 * t3715 * t134 - 0.4e1 * t1019 * t3703 - 0.75e2 / 0.2e1 * t731 * t3709 * t134 - 0.16e2 * t1016 * t1645 - 0.4e1 * t321 * t3694 - t127 * t3694 * t134 + 0.85e2 / 0.4e1 * t1660 * t3709 * t134 - 0.19e2 / 0.8e1 * t3774 * t3709 * t134 + t317 * t3694 * t134 / 0.2e1 + t3782 * t3709 * t134 / 0.16e2 - 0.12e2 * t3715 * t135;
  t3799 = -0.2e1 * t992 * t3703 - 0.3e1 / 0.2e1 * t2196 * t1656 + 0.24e2 * t3708 * t3709 - 0.36e2 * t1664 * t711 * t703 + 0.6e1 * t715 * t3715 + 0.8e1 * t715 * t310 * t1645 - 0.24e2 * t1684 * t3709 * t134 + 0.21e2 * t732 * t1656 - 0.3e1 / 0.2e1 * t710 * t3715 * t134 + 0.15e2 / 0.4e1 * t1695 * t3709 * t134 - t3733 * t3709 * t134 / 0.8e1 - t312 * t3694 + 0.2e1 * t126 * t3788 + 0.8e1 * t1645 * t326 + 0.12e2 * t703 * t743 + 0.8e1 * t310 * t1707 + 0.2e1 * t3694 * t138;
  t3803 = my_piecewise3(t98, t3633 + t3692, -0.8e1 / 0.3e1 * t3694 * t141 - 0.32e2 / 0.3e1 * t1645 * t329 - 0.16e2 * t703 * t746 - 0.32e2 / 0.3e1 * t310 * t1710 - 0.8e1 / 0.3e1 * t126 * t3799);
  t3819 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t1567 * t3569 - 0.16e2 / 0.9e1 * t658 * t617 + 0.4e1 / 0.3e1 * t269 * t3575 + 0.16e2 / 0.9e1 * t270 * t1516 + 0.4e1 / 0.3e1 * t89 * t3580);
  t3828 = t7 * t159 * t1292;
  t3830 = -0.9e1 / 0.16e2 * t7 * t476 * t610 - 0.3e1 / 0.8e1 * t3488 - 0.3e1 / 0.8e1 * t7 * t159 * t1507 + t3495 / 0.8e1 - t3499 / 0.8e1 + t3506 - 0.5e1 / 0.36e2 * t3508 + t3513 + t3515 / 0.8e1 + t3519 / 0.8e1 - t3523 / 0.8e1 - 0.3e1 / 0.32e2 * t7 * t92 * t22 * t3803 - 0.3e1 / 0.32e2 * t7 * t9 * t3819 * t146 - 0.3e1 / 0.8e1 * t7 * t1521 * t334 - 0.5e1 / 0.36e2 * t3828;
  t3834 = 0.5e1 / 0.36e2 * t1281;
  t3838 = 0.5e1 / 0.36e2 * t1294;
  t3854 = -0.9e1 / 0.8e1 * t1321 + t1325 / 0.4e1 - 0.3e1 / 0.8e1 * t1329 - 0.3e1 / 0.8e1 * t1509 - 0.3e1 / 0.8e1 * t1523 - 0.9e1 / 0.8e1 * t1526 - 0.3e1 / 0.4e1 * t1529 - 0.9e1 / 0.8e1 * t1532 + t1536 / 0.4e1 - 0.3e1 / 0.8e1 * t1540 - 0.3e1 / 0.8e1 * t1717;
  tv4rho40 = t11 * (t3483 + t3830) + t1275 / 0.4e1 - t3834 - 0.3e1 / 0.8e1 * t1284 - 0.3e1 / 0.8e1 * t1287 + t1290 / 0.4e1 - t3838 - 0.3e1 / 0.8e1 * t1312 - 0.9e1 / 0.8e1 * t1315 - 0.3e1 / 0.4e1 * t1318 + t3854;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3856 = t7 * t764 * t492;
  t3859 = t7 * t253 * t1751;
  t3860 = t3859 / 0.16e2;
  t3861 = t528 * t189;
  t3891 = t27 * t1333 * t351;
  t3895 = t791 * t500 * t509 * t793;
  t3896 = 0.4e1 / 0.27e2 * t3895;
  t3898 = t791 * t1875 * t1887;
  t3901 = t791 * t1875 * t1891;
  t3906 = t172 * t1347;
  t3908 = t791 * t3906 * t1883;
  t3910 = t28 * t3161;
  t3920 = t27 * t501 * t805;
  t3921 = 0.2e1 / 0.27e2 * t3920;
  t3923 = t27 * t173 * t1909;
  t3929 = t468 * t464;
  t3932 = t155 * t471;
  t3938 = t1302 * t155;
  t3941 = t468 * t471;
  t3949 = 0.8e1 * t800 * t3195;
  t3951 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3182 * t340 * t1296 + 0.2e2 / 0.9e1 * t1359 * t10 * t3929 + 0.1e2 / 0.9e1 * t1895 * t3932 - 0.4e1 / 0.3e1 * t516 * t468 * t155 + 0.4e1 * t1898 * t3938 - 0.4e1 / 0.3e1 * t1898 * t3941 - 0.2e1 / 0.9e1 * t797 * t1305 - 0.4e1 * t180 * t1302 + t3949);
  t3962 = -t791 * t1882 * t793 * t522 - t3921 + t3923 / 0.18e2 - t27 * t29 * t178 * t3951 / 0.18e2 + t3152 / 0.9e1 - t3155 / 0.9e1 + 0.4e1 / 0.27e2 * t3146 + t3158 / 0.54e2 + t3141 + 0.14e2 / 0.81e2 * t3143 - 0.2e1 / 0.27e2 * t3149;
  t3963 = t791 * t792 * t1908 * t183 / 0.3e1 + t791 * t792 * t804 * t522 / 0.3e1 + t791 * t792 * t350 * t1368 / 0.9e1 + 0.14e2 / 0.243e3 * t3891 + t3896 - 0.2e1 / 0.9e1 * t3898 - t3901 / 0.9e1 - t791 * t1882 * t804 * t510 + t3908 / 0.3e1 + 0.4e1 / 0.3e1 * t791 * t3910 * t350 * t1348 + t3962;
  t3964 = my_piecewise3(t36, t3963, 0);
  t3977 = t1866 * t3861 / 0.1376256e9 - 0.2e1 * t359 * t3861 + 0.3e1 / 0.8e1 * t361 * t3861 - 0.3e1 / 0.8e2 * t363 * t3861 + t365 * t3861 / 0.384e3 - t367 * t3861 / 0.7168e4 + t369 * t3861 / 0.16384e6 - t371 * t3861 / 0.442368e7 + t209 * t3964 / 0.8945664e8 - t213 * t3964 / 0.31850496e10 + t217 * t3964 / 0.1263403008e12 - t170 * t3964 / 0.18e2 + t193 * t3964 / 0.24e3 - t197 * t3964 / 0.448e4;
  t4014 = t201 * t3964 / 0.10368e6 - t205 * t3964 / 0.2838528e7 - t833 * t1374 / 0.688128e7 + t1846 * t528 / 0.7077888e8 + t838 * t1374 / 0.21233664e9 - t57 * t1914 * t189 / 0.229376e7 + t60 * t1914 * t189 / 0.7077888e8 - t556 * t1914 * t189 / 0.24772608e10 + t42 * t1914 * t189 / 0.2e1 - t45 * t1914 * t189 / 0.16e2 + 0.3e1 / 0.64e3 * t48 * t1914 * t189 - t51 * t1914 * t189 / 0.384e4 + t54 * t1914 * t189 / 0.86016e5 - t1811 * t528 / 0.24772608e10;
  t4044 = -t843 * t1374 / 0.74317824e10 + t1816 * t528 / 0.2e1 + t783 * t1374 / 0.6e1 - t1821 * t528 / 0.16e2 - t813 * t1374 / 0.48e2 + 0.3e1 / 0.64e3 * t1826 * t528 + t818 * t1374 / 0.64e3 - t1831 * t528 / 0.384e4 - t823 * t1374 / 0.1152e5 + t1836 * t528 / 0.86016e5 + t828 * t1374 / 0.258048e6 - t1841 * t528 / 0.229376e7 + 0.9e1 / 0.8e2 * t823 * t1391 - 0.11e2 / 0.1152e4 * t828 * t1391;
  t4075 = 0.13e2 / 0.21504e5 * t833 * t1391 - t838 * t1391 / 0.32768e5 + 0.17e2 / 0.1327104e8 * t843 * t1391 - 0.19e2 / 0.4128768e9 * t3240 * t356 * t1391 + t1429 * t810 * t496 / 0.1376256e9 - 0.2e1 * t816 * t496 + 0.3e1 / 0.8e1 * t821 * t496 - 0.3e1 / 0.8e2 * t826 * t496 + t831 * t496 / 0.384e3 - t836 * t496 / 0.7168e4 + t841 * t496 / 0.16384e6 - t846 * t496 / 0.442368e7 + 0.1e2 / 0.3e1 * t813 * t1391 - 0.7e1 / 0.8e1 * t818 * t1391;
  t4078 = my_piecewise3(t36, 0, t3963);
  t4101 = t72 * t1933;
  t4125 = -0.24e2 * t1477 * t854 + 0.24e2 * t3406 * t374 * t1444 - t3389 * t1444 * t854 / 0.8e1 - 0.3e1 / 0.2e1 * t853 * t4101 - 0.18e2 * t1456 * t849 * t570 + 0.6e1 * t574 * t1933 * t221 + 0.6e1 * t574 * t849 * t562 + 0.2e1 * t574 * t374 * t1437 + 0.21e2 / 0.2e1 * t591 * t1952 + 0.15e2 / 0.4e1 * t1488 * t854 - t569 * t1437 * t854 / 0.2e1 - 0.3e1 / 0.2e1 * t1946 * t1952;
  t4136 = t569 * t849;
  t4139 = t1452 * t374;
  t4140 = t1444 * t72;
  t4169 = 0.45e2 / 0.2e1 * t4136 * t1975 + 0.85e2 / 0.4e1 * t4139 * t4140 - 0.6e1 * t582 * t1933 * t868 - 0.6e1 * t1978 * t1448 - 0.15e2 / 0.2e1 * t1476 * t849 * t1975 - 0.19e2 / 0.8e1 * t3326 * t374 * t4140 - 0.2e1 * t867 * t3350 + 0.3e1 / 0.4e1 * t590 * t1933 * t868 + 0.3e1 / 0.4e1 * t1989 * t1448 + 0.3e1 / 0.8e1 * t1487 * t849 * t1975 + t874 * t3350 / 0.4e1 + t3334 * t374 * t4140 / 0.16e2;
  t4178 = t868 * t562;
  t4199 = -t70 * t1437 * t854 - 0.3e1 * t2002 * t1952 - 0.3e1 * t880 * t4101 - 0.75e2 / 0.2e1 * t874 * t4140 + 0.45e2 / 0.2e1 * t1974 * t4178 - 0.15e2 / 0.2e1 * t1981 * t4178 + 0.3e1 / 0.8e1 * t1994 * t4178 - 0.4e1 * t232 * t4078 - t65 * t4078 * t72 + t228 * t4078 * t72 / 0.2e1 - 0.4e1 * t1437 * t73 * t374 - 0.12e2 * t1997 * t849 - 0.12e2 * t877 * t1933;
  t4214 = t868 * t374;
  t4221 = -0.3e1 / 0.4e1 * t1949 * t1952 + 0.2e1 * t4078 * t76 + 0.6e1 * t1933 * t237 + 0.6e1 * t849 * t602 + 0.6e1 * t221 * t2010 + 0.2e1 * t63 * (t4169 + t4199) + 0.2e1 * t374 * t1499 + 0.2e1 * t1437 * t386 + 0.6e1 * t562 * t886 + 0.21e2 / 0.2e1 * t590 * t221 * t854 * t562 - 0.3e1 / 0.4e1 * t1452 * t562 * t4214 - 0.18e2 * t1456 * t857 * t562 - t223 * t4078;
  t4226 = my_piecewise3(t35, t3977 + t4014 + t4044 + t4075, -0.8e1 / 0.3e1 * t4078 * t79 - 0.8e1 * t1933 * t240 - 0.8e1 * t849 * t605 - 0.8e1 / 0.3e1 * t374 * t1502 - 0.8e1 / 0.3e1 * t1437 * t389 - 0.8e1 * t562 * t889 - 0.8e1 * t221 * t2013 - 0.8e1 / 0.3e1 * t63 * (t4125 + t4221));
  t4248 = 0.32e2 * t759 * t3195;
  t4250 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t1895 * t1296 - 0.16e2 / 0.9e1 * t1898 * t3929 - 0.8e1 / 0.9e1 * t797 * t3932 + 0.8e1 / 0.3e1 * t1903 * t155 - 0.8e1 * t800 * t3938 + 0.8e1 / 0.3e1 * t800 * t3941 + 0.4e1 / 0.9e1 * t348 * t1305 - 0.16e2 * t18 * t1302 + t4248);
  t4262 = t7 * t344 * t1327;
  t4277 = t7 * t344 * t1323;
  t4278 = t4277 / 0.16e2;
  t4280 = t7 * t622 * t920;
  t4283 = t7 * t253 * t2054;
  t4287 = t7 * t92 * t487 * t1032;
  t4288 = t4287 / 0.16e2;
  t4289 = -0.3e1 / 0.16e2 * t3856 + t3860 - 0.3e1 / 0.32e2 * t7 * t21 * t22 * t4226 - 0.3e1 / 0.32e2 * t7 * t9 * t4250 * t84 - 0.9e1 / 0.32e2 * t7 * t1788 * t245 - 0.9e1 / 0.32e2 * t7 * t764 * t610 - 0.3e1 / 0.32e2 * t4262 - 0.3e1 / 0.32e2 * t7 * t344 * t1507 - 0.3e1 / 0.32e2 * t7 * t1310 * t394 - 0.9e1 / 0.32e2 * t7 * t476 * t894 - 0.9e1 / 0.32e2 * t7 * t159 * t2018 + t4278 - 0.3e1 / 0.32e2 * t4280 - 0.3e1 / 0.16e2 * t4283 + t4288;
  t4291 = t7 * t2035 * t257;
  t4294 = t7 * t905 * t636;
  t4297 = t7 * t402 * t1534;
  t4298 = t4297 / 0.16e2;
  t4300 = t7 * t476 * t779;
  t4303 = t7 * t159 * t1807;
  t4307 = t7 * t21 * t487 * t893;
  t4308 = t4307 / 0.16e2;
  t4310 = t7 * t1788 * t165;
  t4312 = t669 * t278;
  t4330 = t27 * t1333 * t409;
  t4334 = t791 * t500 * t650 * t932;
  t4335 = 0.4e1 / 0.27e2 * t4334;
  t4337 = t791 * t2122 * t2134;
  t4340 = t791 * t2122 * t2138;
  t4357 = t28 * t3547;
  t4366 = t172 * t1555;
  t4368 = t791 * t4366 * t2130;
  t4371 = t27 * t501 * t944;
  t4372 = 0.2e1 / 0.27e2 * t4371;
  t4374 = t27 * t173 * t2156;
  t4380 = t468 * t614;
  t4383 = t249 * t617;
  t4389 = t1302 * t249;
  t4392 = t468 * t617;
  t4400 = 0.8e1 * t939 * t3195;
  t4402 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3568 * t398 * t1511 - 0.2e2 / 0.9e1 * t1567 * t10 * t4380 + 0.1e2 / 0.9e1 * t2142 * t4383 + 0.4e1 / 0.3e1 * t657 * t468 * t249 - 0.4e1 * t2145 * t4389 + 0.4e1 / 0.3e1 * t2145 * t4392 - 0.2e1 / 0.9e1 * t936 * t1516 + 0.4e1 * t269 * t1302 - t4400);
  t4413 = t4368 / 0.3e1 - t4372 + t4374 / 0.18e2 - t27 * t29 * t267 * t4402 / 0.18e2 + 0.4e1 / 0.27e2 * t3532 + t3538 / 0.9e1 - t3541 / 0.9e1 + t3527 + 0.14e2 / 0.81e2 * t3529 - 0.2e1 / 0.27e2 * t3535 + t3544 / 0.54e2;
  t4414 = 0.14e2 / 0.243e3 * t4330 + t4335 - 0.2e1 / 0.9e1 * t4337 - t4340 / 0.9e1 - t791 * t2129 * t943 * t651 + t791 * t931 * t2155 * t272 / 0.3e1 + t791 * t931 * t943 * t663 / 0.3e1 + t791 * t931 * t408 * t1576 / 0.9e1 + 0.4e1 / 0.3e1 * t791 * t4357 * t408 * t1556 - t791 * t2129 * t932 * t663 + t4413;
  t4415 = my_piecewise3(t99, t4414, 0);
  t4428 = -0.2e1 * t417 * t4312 + 0.3e1 / 0.8e1 * t419 * t4312 - 0.3e1 / 0.8e2 * t421 * t4312 + t423 * t4312 / 0.384e3 - t425 * t4312 / 0.7168e4 + t427 * t4312 / 0.16384e6 - t429 * t4312 / 0.442368e7 + t2113 * t4312 / 0.1376256e9 - t286 * t4415 / 0.448e4 + t290 * t4415 / 0.10368e6 - t294 * t4415 / 0.2838528e7 + t298 * t4415 / 0.8945664e8 - t302 * t4415 / 0.31850496e10 + t306 * t4415 / 0.1263403008e12;
  t4461 = -t262 * t4415 / 0.18e2 + t282 * t4415 / 0.24e3 + t105 * t2161 * t278 / 0.2e1 + t2058 * t669 / 0.2e1 + t924 * t1582 / 0.6e1 - t108 * t2161 * t278 / 0.16e2 - t2063 * t669 / 0.16e2 - t952 * t1582 / 0.48e2 + 0.3e1 / 0.64e3 * t111 * t2161 * t278 + 0.3e1 / 0.64e3 * t2068 * t669 + t957 * t1582 / 0.64e3 - t114 * t2161 * t278 / 0.384e4 - t2073 * t669 / 0.384e4 - t962 * t1582 / 0.1152e5;
  t4495 = t117 * t2161 * t278 / 0.86016e5 + t2078 * t669 / 0.86016e5 + t967 * t1582 / 0.258048e6 - t120 * t2161 * t278 / 0.229376e7 - t2083 * t669 / 0.229376e7 - t972 * t1582 / 0.688128e7 + t123 * t2161 * t278 / 0.7077888e8 + t2088 * t669 / 0.7077888e8 + t977 * t1582 / 0.21233664e9 - t697 * t2161 * t278 / 0.24772608e10 - t2093 * t669 / 0.24772608e10 - t982 * t1582 / 0.74317824e10 + 0.1e2 / 0.3e1 * t952 * t1599 - 0.7e1 / 0.8e1 * t957 * t1599;
  t4526 = 0.9e1 / 0.8e2 * t962 * t1599 - 0.11e2 / 0.1152e4 * t967 * t1599 + 0.13e2 / 0.21504e5 * t972 * t1599 - t977 * t1599 / 0.32768e5 + 0.17e2 / 0.1327104e8 * t982 * t1599 - 0.19e2 / 0.4128768e9 * t3635 * t414 * t1599 - 0.2e1 * t955 * t640 + 0.3e1 / 0.8e1 * t960 * t640 - 0.3e1 / 0.8e2 * t965 * t640 + t970 * t640 / 0.384e3 - t975 * t640 / 0.7168e4 + t980 * t640 / 0.16384e6 - t985 * t640 / 0.442368e7 + t1632 * t949 * t640 / 0.1376256e9;
  t4529 = my_piecewise3(t99, 0, t4414);
  t4558 = t134 * t2180;
  t4575 = 0.21e2 / 0.2e1 * t732 * t2199 + 0.15e2 / 0.4e1 * t1696 * t993 - t710 * t1645 * t993 / 0.2e1 - 0.3e1 / 0.2e1 * t2193 * t2199 - 0.3e1 / 0.4e1 * t2196 * t2199 - t3733 * t1652 * t993 / 0.8e1 - 0.3e1 / 0.2e1 * t992 * t4558 - 0.18e2 * t1664 * t988 * t711 + 0.6e1 * t715 * t2180 * t310 + 0.6e1 * t715 * t988 * t703 + 0.2e1 * t715 * t432 * t1645 - 0.24e2 * t1685 * t993;
  t4581 = t710 * t988;
  t4584 = t1660 * t432;
  t4585 = t1652 * t134;
  t4614 = 0.45e2 / 0.2e1 * t4581 * t2222 + 0.85e2 / 0.4e1 * t4584 * t4585 - 0.6e1 * t723 * t2180 * t1007 - 0.6e1 * t2225 * t1656 - 0.15e2 / 0.2e1 * t1684 * t988 * t2222 - 0.19e2 / 0.8e1 * t3774 * t432 * t4585 - 0.2e1 * t1006 * t3703 + 0.3e1 / 0.4e1 * t731 * t2180 * t1007 + 0.3e1 / 0.4e1 * t2236 * t1656 + 0.3e1 / 0.8e1 * t1695 * t988 * t2222 + t1013 * t3703 / 0.4e1 + t3782 * t432 * t4585 / 0.16e2;
  t4637 = t1667 * t134;
  t4644 = -t132 * t1645 * t993 - 0.75e2 / 0.2e1 * t1013 * t4585 - 0.3e1 * t2249 * t2199 - 0.3e1 * t1019 * t4558 - 0.4e1 * t321 * t4529 - t127 * t4529 * t134 + t317 * t4529 * t134 / 0.2e1 - 0.4e1 * t1645 * t135 * t432 - 0.12e2 * t2244 * t988 - 0.12e2 * t1016 * t2180 + 0.3e1 / 0.8e1 * t2241 * t4637 + 0.45e2 / 0.2e1 * t2221 * t4637 - 0.15e2 / 0.2e1 * t2228 * t4637;
  t4666 = t1007 * t432;
  t4672 = 0.24e2 * t3708 * t432 * t1652 + 0.6e1 * t310 * t2257 + 0.2e1 * t126 * (t4614 + t4644) + 0.2e1 * t432 * t1707 + 0.2e1 * t1645 * t444 + 0.6e1 * t703 * t1025 + 0.2e1 * t4529 * t138 + 0.6e1 * t2180 * t326 + 0.6e1 * t988 * t743 - t312 * t4529 + 0.21e2 / 0.2e1 * t731 * t310 * t993 * t703 - 0.3e1 / 0.4e1 * t1660 * t703 * t4666 - 0.18e2 * t1664 * t996 * t703;
  t4677 = my_piecewise3(t98, t4428 + t4461 + t4495 + t4526, -0.8e1 / 0.3e1 * t4529 * t141 - 0.8e1 * t2180 * t329 - 0.8e1 * t988 * t746 - 0.8e1 / 0.3e1 * t432 * t1710 - 0.8e1 / 0.3e1 * t1645 * t447 - 0.8e1 * t703 * t1028 - 0.8e1 * t310 * t2260 - 0.8e1 / 0.3e1 * t126 * (t4575 + t4672));
  t4686 = t7 * t402 * t1538;
  t4702 = t7 * t92 * t164 * t2264;
  t4704 = -0.3e1 / 0.32e2 * t4291 - 0.3e1 / 0.16e2 * t4294 + t4298 - 0.3e1 / 0.32e2 * t4300 - 0.3e1 / 0.16e2 * t4303 + t4308 - 0.3e1 / 0.32e2 * t4310 - 0.3e1 / 0.32e2 * t7 * t92 * t22 * t4677 - 0.9e1 / 0.32e2 * t7 * t905 * t751 - 0.3e1 / 0.32e2 * t4686 - 0.3e1 / 0.32e2 * t7 * t402 * t1715 - 0.3e1 / 0.32e2 * t7 * t1521 * t452 - 0.9e1 / 0.32e2 * t7 * t622 * t1033 - 0.9e1 / 0.32e2 * t7 * t253 * t2265 - 0.3e1 / 0.32e2 * t4702;
  t4723 = 0.32e2 * t900 * t3195;
  t4725 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2142 * t1511 + 0.16e2 / 0.9e1 * t2145 * t4380 - 0.8e1 / 0.9e1 * t936 * t4383 - 0.8e1 / 0.3e1 * t2150 * t249 + 0.8e1 * t939 * t4389 - 0.8e1 / 0.3e1 * t939 * t4392 + 0.4e1 / 0.9e1 * t406 * t1516 + 0.16e2 * t89 * t1302 - t4723);
  t4735 = t7 * t21 * t164 * t2017;
  t4738 = t7 * t764 * t488;
  t4739 = t4738 / 0.16e2;
  t4741 = t7 * t344 * t1292;
  t4745 = t7 * t92 * t1278 * t451;
  t4748 = t7 * t905 * t632;
  t4749 = t4748 / 0.16e2;
  t4751 = t7 * t402 * t1279;
  t4754 = t7 * t159 * t1764;
  t4755 = t4754 / 0.16e2;
  t4758 = t7 * t21 * t1278 * t393;
  t4765 = -0.3e1 / 0.32e2 * t7 * t9 * t4725 * t146 - 0.9e1 / 0.32e2 * t7 * t2035 * t334 - 0.3e1 / 0.32e2 * t4735 + t4739 - 0.5e1 / 0.144e3 * t4741 - 0.5e1 / 0.144e3 * t4745 + t4749 - 0.5e1 / 0.144e3 * t4751 + t4755 - 0.5e1 / 0.144e3 * t4758 + t3427 / 0.16e2 + t3430 / 0.8e1 - 0.5e1 / 0.48e2 * t3434 - t3437 / 0.32e2 - 0.3e1 / 0.32e2 * t3440;
  t4779 = -t3443 / 0.32e2 - 0.3e1 / 0.32e2 * t3446 + t3449 / 0.8e1 - 0.5e1 / 0.48e2 * t3453 - 0.3e1 / 0.32e2 * t3478 - 0.3e1 / 0.32e2 * t3488 + t3495 / 0.16e2 - t3499 / 0.32e2 + t3506 - 0.5e1 / 0.48e2 * t3508 + t3513 + t3515 / 0.16e2 + t3519 / 0.16e2 - t3523 / 0.32e2 - 0.5e1 / 0.48e2 * t3828;
  t4788 = t11 * (t4289 + t4704 + t4765 + t4779) + 0.3e1 / 0.16e2 * t1275 - t3834 - 0.3e1 / 0.16e2 * t1284 - 0.3e1 / 0.16e2 * t1287 + 0.3e1 / 0.16e2 * t1290 - t3838 - t1313 - t1316 - 0.3e1 / 0.8e1 * t1318 - t1322;
  t4794 = 0.3e1 / 0.16e2 * t1749;
  t4795 = 0.3e1 / 0.16e2 * t1325 - 0.3e1 / 0.16e2 * t1329 - t1510 - t1524 - t1527 - 0.3e1 / 0.8e1 * t1529 - t1533 + 0.3e1 / 0.16e2 * t1536 - 0.3e1 / 0.16e2 * t1540 - t1718 - t4794;
  t4797 = 0.3e1 / 0.16e2 * t1756;
  t4798 = 0.3e1 / 0.16e2 * t1762;
  t4799 = 0.3e1 / 0.16e2 * t1770;
  t4802 = 0.3e1 / 0.16e2 * t1796;
  t4804 = t3120 - t4797 + t3121 - t4798 + t3122 - t4799 + t3123 - 0.9e1 / 0.32e2 * t1790 - 0.9e1 / 0.16e2 * t1793 - t4802 - 0.9e1 / 0.32e2 * t1799;
  t4807 = 0.3e1 / 0.16e2 * t1809;
  t4811 = 0.3e1 / 0.16e2 * t2043;
  t4815 = 0.3e1 / 0.16e2 * t2056;
  t4817 = -0.9e1 / 0.32e2 * t1802 - 0.9e1 / 0.16e2 * t1805 - t4807 - 0.9e1 / 0.32e2 * t2020 - 0.9e1 / 0.32e2 * t2037 - 0.9e1 / 0.16e2 * t2040 - t4811 - 0.9e1 / 0.32e2 * t2046 - 0.9e1 / 0.32e2 * t2049 - 0.9e1 / 0.16e2 * t2052 - t4815 - 0.9e1 / 0.32e2 * t2267;
  tv4rho41 = t4788 + t4795 + t4804 + t4817;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t4819 = t189 * t810;
  t4841 = t27 * t501 * t1076;
  t4844 = t27 * t501 * t1066;
  t4846 = t804 * t804;
  t4852 = t27 * t173 * t2413;
  t4858 = t155 * t10 * t468;
  t4863 = t10 * t10;
  t4866 = 0.1e1 / t1301 / t152;
  t4882 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3182 * t1043 * t464 + 0.8e2 / 0.27e2 * t1895 * t4858 + 0.1e2 / 0.27e2 * t2398 * t471 - 0.16e2 / 0.9e1 * t516 * t4863 * t4866 - 0.8e1 / 0.9e1 * t797 * t468 + 0.8e1 / 0.3e1 * t797 * t1303 + 0.1e2 / 0.27e2 * t1359 * t1047 * t464 - 0.4e1 / 0.9e1 * t516 * t2408 * t155 - 0.2e1 / 0.9e1 * t2403 * t471 + t3949);
  t4893 = t3141 - 0.4e1 / 0.3e1 * t791 * t1882 * t793 * t804 - 0.2e1 / 0.81e2 * t4841 + 0.4e1 / 0.81e2 * t4844 + 0.2e1 / 0.9e1 * t27 * t29 * t509 * t4846 + t4852 / 0.27e2 - t27 * t29 * t178 * t4882 / 0.18e2 + 0.28e2 / 0.243e3 * t3891 - 0.8e1 / 0.81e2 * t3920 + t3923 / 0.27e2 + 0.28e2 / 0.243e3 * t3143 + 0.4e1 / 0.81e2 * t3146 - 0.2e1 / 0.81e2 * t3149;
  t4903 = t791 * t1875 * t2394;
  t4914 = t791 * t3906 * t2383;
  t4917 = t791 * t1875 * t2387;
  t4931 = 0.4e1 / 0.3e1 * t791 * t3910 * t1065 * t510 - t791 * t1882 * t1075 * t510 / 0.3e1 - 0.2e1 / 0.27e2 * t4903 + 0.2e1 / 0.9e1 * t791 * t792 * t2412 * t183 + t791 * t792 * t1075 * t522 / 0.9e1 + 0.2e1 / 0.9e1 * t4914 - 0.4e1 / 0.27e2 * t4917 - t791 * t1882 * t1065 * t522 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t792 * t350 * t1908 + 0.16e2 / 0.81e2 * t3895 - 0.4e1 / 0.27e2 * t3898 - 0.2e1 / 0.27e2 * t3901 + 0.2e1 / 0.9e1 * t3908;
  t4932 = t4893 + t4931;
  t4933 = my_piecewise3(t36, t4932, 0);
  t4950 = t810 * t810;
  t4955 = -t367 * t4819 / 0.5376e4 + t369 * t4819 / 0.12288e6 - t371 * t4819 / 0.331776e7 + t1866 * t4819 / 0.1032192e9 - 0.8e1 / 0.3e1 * t359 * t4819 + t361 * t4819 / 0.2e1 - t363 * t4819 / 0.2e2 + t365 * t4819 / 0.288e3 - t213 * t4933 / 0.31850496e10 + t217 * t4933 / 0.1263403008e12 - t170 * t4933 / 0.18e2 + t193 * t4933 / 0.24e3 - t197 * t4933 / 0.448e4 + t201 * t4933 / 0.10368e6 - t205 * t4933 / 0.2838528e7 + t209 * t4933 / 0.8945664e8 - t45 * t4950 / 0.24e2 + t48 * t4950 / 0.32e3;
  t4995 = -t51 * t4950 / 0.576e4 + t54 * t4950 / 0.129024e6 - t57 * t4950 / 0.344064e7 + t60 * t4950 / 0.10616832e9 - t556 * t4950 / 0.37158912e10 + t42 * t4950 / 0.3e1 + t2370 * t528 / 0.8e1 - t813 * t1914 / 0.24e2 - t45 * t2418 * t189 / 0.24e2 - t2375 * t528 / 0.48e2 - t2313 * t528 / 0.8e2 + t818 * t1914 / 0.32e3 + t48 * t2418 * t189 / 0.32e3 + t2318 * t528 / 0.64e3 + t2321 * t528 / 0.1152e4 - t823 * t1914 / 0.576e4 - t51 * t2418 * t189 / 0.576e4 - t2326 * t528 / 0.1152e5;
  t5037 = -t2329 * t528 / 0.21504e5 + t828 * t1914 / 0.129024e6 + t54 * t2418 * t189 / 0.129024e6 + t2334 * t528 / 0.258048e6 + t2337 * t528 / 0.49152e6 - t833 * t1914 / 0.344064e7 - t57 * t2418 * t189 / 0.344064e7 - t2342 * t528 / 0.688128e7 - t2345 * t528 / 0.1327104e8 + t838 * t1914 / 0.10616832e9 + t60 * t2418 * t189 / 0.10616832e9 + t2350 * t528 / 0.21233664e9 + t2353 * t528 / 0.4128768e9 - t843 * t1914 / 0.37158912e10 - t556 * t2418 * t189 / 0.37158912e10 - t2359 * t528 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2362 * t528 + t783 * t1914 / 0.3e1;
  t5077 = t42 * t2418 * t189 / 0.3e1 + t2367 * t528 / 0.6e1 - 0.2e1 / 0.3e1 * t1086 * t496 - 0.7e1 / 0.8e1 * t1088 * t496 + t1090 * t496 / 0.8e1 + 0.9e1 / 0.8e2 * t1092 * t496 - t1094 * t496 / 0.8e2 - 0.11e2 / 0.1152e4 * t1096 * t496 + t1098 * t496 / 0.1152e4 + 0.13e2 / 0.21504e5 * t1100 * t496 - t1102 * t496 / 0.21504e5 - t1104 * t496 / 0.32768e5 + t1106 * t496 / 0.49152e6 + 0.17e2 / 0.1327104e8 * t1108 * t496 - t1110 * t496 / 0.1327104e8 - 0.19e2 / 0.4128768e9 * t3240 * t1061 * t496 + t1429 * t1081 * t496 / 0.4128768e9 + 0.1e2 / 0.3e1 * t1084 * t496;
  t5080 = my_piecewise3(t36, 0, t4932);
  t5097 = t868 * t849;
  t5122 = t72 * t2437;
  t5132 = -t4139 * t5097 - 0.24e2 * t1456 * t857 * t849 + 0.14e2 * t874 * t5097 + 0.7e1 / 0.2e1 * t1135 * t1448 + 0.15e2 / 0.4e1 * t2495 * t1975 - t1974 * t4101 - t2451 * t1448 / 0.4e1 - t3389 * t1118 * t1975 / 0.8e1 - 0.6e1 * t1456 * t1118 * t562 + 0.4e1 * t574 * t374 * t1933 - t1946 * t2460 / 0.2e1 - t853 * t5122 - t1949 * t2460 / 0.4e1 + 0.4e1 * t574 * t2437 * t221 + 0.2e1 * t574 * t1113 * t562;
  t5175 = t590 * t2437;
  t5180 = 0.3e2 * t1974 * t5097 - 0.1e2 * t1981 * t5097 + t1994 * t5097 / 0.2e1 - 0.2e1 * t880 * t5122 - 0.75e2 / 0.2e1 * t1135 * t1975 + 0.15e2 / 0.2e1 * t569 * t1113 * t1975 + 0.15e2 / 0.2e1 * t1119 * t1448 + 0.85e2 / 0.4e1 * t2451 * t1975 - 0.4e1 * t867 * t4101 - 0.5e1 / 0.2e1 * t2481 * t1448 - 0.19e2 / 0.8e1 * t3326 * t1118 * t1975 - 0.4e1 * t582 * t2437 * t868 - 0.2e1 * t2484 * t1448 - 0.5e1 / 0.2e1 * t1476 * t1113 * t1975 + t5175 * t868 / 0.2e1 + t2490 * t1448 / 0.4e1;
  t5181 = t1487 * t1113;
  t5194 = t849 * t849;
  t5219 = t5181 * t1975 / 0.8e1 + t874 * t4101 / 0.2e1 + t2495 * t1448 / 0.8e1 + t3334 * t1118 * t1975 / 0.16e2 - 0.2e1 * t2501 * t4101 - t2002 * t2460 - 0.8e1 * t5194 * t73 - 0.2e1 * t70 * t5194 * t72 + t228 * t5080 * t72 / 0.2e1 - 0.8e1 * t2498 * t1933 - 0.4e1 * t1997 * t1113 - 0.8e1 * t877 * t2437 - 0.4e1 * t232 * t5080 - t65 * t5080 * t72 - 0.4e1 * t582 * t5194 * t72 + t590 * t5194 * t72 / 0.2e1;
  t5244 = 0.24e2 * t3406 * t1118 * t570 + 0.7e1 / 0.2e1 * t591 * t2460 - 0.6e1 * t1456 * t1113 * t570 - 0.24e2 * t2481 * t1975 + 0.2e1 * t63 * (t5180 + t5219) + 0.4e1 * t374 * t2010 + 0.2e1 * t562 * t1146 + 0.4e1 * t221 * t2511 + 0.2e1 * t5080 * t76 + 0.4e1 * t2437 * t237 + 0.2e1 * t1113 * t602 + 0.4e1 * t1933 * t386 + 0.8e1 * t849 * t886 - t223 * t5080 - t569 * t5194 * t72 + 0.4e1 * t574 * t5194;
  t5249 = my_piecewise3(t35, t4955 + t4995 + t5037 + t5077, -0.8e1 / 0.3e1 * t5080 * t79 - 0.16e2 / 0.3e1 * t2437 * t240 - 0.8e1 / 0.3e1 * t1113 * t605 - 0.16e2 / 0.3e1 * t1933 * t389 - 0.32e2 / 0.3e1 * t849 * t889 - 0.16e2 / 0.3e1 * t374 * t2013 - 0.8e1 / 0.3e1 * t562 * t1149 - 0.16e2 / 0.3e1 * t221 * t2514 - 0.8e1 / 0.3e1 * t63 * (t5132 + t5244));
  t5255 = t7 * t253 * t2290;
  t5259 = t7 * t92 * t164 * t2752;
  t5262 = t7 * t2534 * t257;
  t5265 = t7 * t1166 * t636;
  t5267 = t278 * t949;
  t5288 = t943 * t943;
  t5294 = t27 * t501 * t1190;
  t5297 = t27 * t501 * t1180;
  t5300 = t27 * t173 * t2647;
  t5306 = t249 * t10 * t468;
  t5327 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3568 * t1158 * t614 - 0.8e2 / 0.27e2 * t2142 * t5306 + 0.1e2 / 0.27e2 * t2635 * t617 - 0.16e2 / 0.9e1 * t657 * t4863 * t4866 + 0.8e1 / 0.9e1 * t936 * t468 - 0.8e1 / 0.3e1 * t936 * t1303 + 0.1e2 / 0.27e2 * t1567 * t1161 * t614 - 0.4e1 / 0.9e1 * t657 * t2529 * t249 - 0.2e1 / 0.9e1 * t2640 * t617 - t4400);
  t5338 = t3527 - 0.4e1 / 0.3e1 * t791 * t2129 * t932 * t943 + 0.2e1 / 0.9e1 * t27 * t29 * t650 * t5288 - 0.2e1 / 0.81e2 * t5294 + 0.4e1 / 0.81e2 * t5297 + t5300 / 0.27e2 - t27 * t29 * t267 * t5327 / 0.18e2 + 0.28e2 / 0.243e3 * t4330 - 0.8e1 / 0.81e2 * t4371 + t4374 / 0.27e2 + 0.28e2 / 0.243e3 * t3529 + 0.4e1 / 0.81e2 * t3532 - 0.2e1 / 0.81e2 * t3535;
  t5360 = t791 * t2122 * t2631;
  t5371 = t791 * t4366 * t2620;
  t5374 = t791 * t2122 * t2624;
  t5376 = 0.16e2 / 0.81e2 * t4334 - 0.4e1 / 0.27e2 * t4337 - 0.2e1 / 0.27e2 * t4340 + 0.2e1 / 0.9e1 * t4368 + 0.4e1 / 0.3e1 * t791 * t4357 * t1179 * t651 - t791 * t2129 * t1189 * t651 / 0.3e1 - t791 * t2129 * t1179 * t663 / 0.3e1 + 0.2e1 / 0.9e1 * t791 * t931 * t408 * t2155 - 0.2e1 / 0.27e2 * t5360 + 0.2e1 / 0.9e1 * t791 * t931 * t2646 * t272 + t791 * t931 * t1189 * t663 / 0.9e1 + 0.2e1 / 0.9e1 * t5371 - 0.4e1 / 0.27e2 * t5374;
  t5377 = t5338 + t5376;
  t5378 = my_piecewise3(t99, t5377, 0);
  t5395 = t949 * t949;
  t5400 = -t429 * t5267 / 0.331776e7 + t2113 * t5267 / 0.1032192e9 - 0.8e1 / 0.3e1 * t417 * t5267 + t419 * t5267 / 0.2e1 - t421 * t5267 / 0.2e2 + t423 * t5267 / 0.288e3 - t425 * t5267 / 0.5376e4 + t427 * t5267 / 0.12288e6 - t286 * t5378 / 0.448e4 + t290 * t5378 / 0.10368e6 - t294 * t5378 / 0.2838528e7 + t298 * t5378 / 0.8945664e8 - t302 * t5378 / 0.31850496e10 + t306 * t5378 / 0.1263403008e12 - t262 * t5378 / 0.18e2 + t282 * t5378 / 0.24e3 - t120 * t5395 / 0.344064e7 + t123 * t5395 / 0.10616832e9;
  t5439 = -t697 * t5395 / 0.37158912e10 + t105 * t5395 / 0.3e1 - t108 * t5395 / 0.24e2 + t111 * t5395 / 0.32e3 - t114 * t5395 / 0.576e4 + t117 * t5395 / 0.129024e6 - t1216 * t640 / 0.21504e5 - t1218 * t640 / 0.32768e5 + t1220 * t640 / 0.49152e6 + 0.17e2 / 0.1327104e8 * t1222 * t640 - t1224 * t640 / 0.1327104e8 - 0.19e2 / 0.4128768e9 * t3635 * t1175 * t640 + t1632 * t1195 * t640 / 0.4128768e9 + 0.1e2 / 0.3e1 * t1198 * t640 - 0.2e1 / 0.3e1 * t1200 * t640 - 0.7e1 / 0.8e1 * t1202 * t640 + t1204 * t640 / 0.8e1 + 0.9e1 / 0.8e2 * t1206 * t640;
  t5481 = -t1208 * t640 / 0.8e2 - 0.11e2 / 0.1152e4 * t1210 * t640 + t1212 * t640 / 0.1152e4 + 0.13e2 / 0.21504e5 * t1214 * t640 - t972 * t2161 / 0.344064e7 - t120 * t2652 * t278 / 0.344064e7 - t2593 * t669 / 0.688128e7 - t2596 * t669 / 0.1327104e8 + t977 * t2161 / 0.10616832e9 + t123 * t2652 * t278 / 0.10616832e9 + t2601 * t669 / 0.21233664e9 + t2604 * t669 / 0.4128768e9 - t982 * t2161 / 0.37158912e10 - t697 * t2652 * t278 / 0.37158912e10 - t2609 * t669 / 0.74317824e10 - 0.2e1 / 0.3e1 * t2612 * t669 + t924 * t2161 / 0.3e1 + t105 * t2652 * t278 / 0.3e1;
  t5522 = t2552 * t669 / 0.6e1 + t2555 * t669 / 0.8e1 - t952 * t2161 / 0.24e2 - t108 * t2652 * t278 / 0.24e2 - t2560 * t669 / 0.48e2 - t2563 * t669 / 0.8e2 + t957 * t2161 / 0.32e3 + t111 * t2652 * t278 / 0.32e3 + t2568 * t669 / 0.64e3 + t2571 * t669 / 0.1152e4 - t962 * t2161 / 0.576e4 - t114 * t2652 * t278 / 0.576e4 - t2576 * t669 / 0.1152e5 - t2579 * t669 / 0.21504e5 + t967 * t2161 / 0.129024e6 + t117 * t2652 * t278 / 0.129024e6 + t2584 * t669 / 0.258048e6 + t2587 * t669 / 0.49152e6;
  t5525 = my_piecewise3(t99, 0, t5377);
  t5560 = t134 * t2671;
  t5578 = 0.7e1 / 0.2e1 * t1249 * t1656 + 0.15e2 / 0.4e1 * t2729 * t2222 - t2221 * t4558 - t2685 * t1656 / 0.4e1 - t3733 * t1232 * t2222 / 0.8e1 - 0.6e1 * t1664 * t1232 * t703 + 0.4e1 * t715 * t432 * t2180 - t2193 * t2694 / 0.2e1 - t992 * t5560 - t2196 * t2694 / 0.4e1 + 0.4e1 * t715 * t2671 * t310 + 0.2e1 * t715 * t1227 * t703 + 0.24e2 * t3708 * t1232 * t711 + 0.7e1 / 0.2e1 * t732 * t2694 - 0.6e1 * t1664 * t1227 * t711;
  t5614 = t731 * t2671;
  t5619 = t1013 * t4558 / 0.2e1 + t2729 * t1656 / 0.8e1 + t3782 * t1232 * t2222 / 0.16e2 - 0.2e1 * t2735 * t4558 - t2249 * t2694 - 0.2e1 * t1019 * t5560 + 0.15e2 / 0.2e1 * t1233 * t1656 + 0.85e2 / 0.4e1 * t2685 * t2222 - 0.4e1 * t1006 * t4558 - 0.5e1 / 0.2e1 * t2715 * t1656 - 0.19e2 / 0.8e1 * t3774 * t1232 * t2222 - 0.4e1 * t723 * t2671 * t1007 - 0.2e1 * t2718 * t1656 - 0.5e1 / 0.2e1 * t1684 * t1227 * t2222 + t5614 * t1007 / 0.2e1 + t2724 * t1656 / 0.4e1;
  t5620 = t1695 * t1227;
  t5628 = t988 * t988;
  t5631 = t1007 * t988;
  t5660 = t5620 * t2222 / 0.8e1 - 0.75e2 / 0.2e1 * t1249 * t2222 + 0.15e2 / 0.2e1 * t710 * t1227 * t2222 - 0.8e1 * t5628 * t135 + 0.3e2 * t2221 * t5631 - 0.1e2 * t2228 * t5631 + t2241 * t5631 / 0.2e1 - 0.4e1 * t321 * t5525 - t127 * t5525 * t134 + t317 * t5525 * t134 / 0.2e1 - 0.8e1 * t2732 * t2180 - 0.4e1 * t2244 * t1227 - 0.8e1 * t1016 * t2671 - 0.2e1 * t132 * t5628 * t134 - 0.4e1 * t723 * t5628 * t134 + t731 * t5628 * t134 / 0.2e1;
  t5689 = -0.24e2 * t2715 * t2222 + 0.4e1 * t310 * t2745 + 0.2e1 * t126 * (t5619 + t5660) + 0.4e1 * t2180 * t444 + 0.8e1 * t988 * t1025 + 0.4e1 * t432 * t2257 + 0.2e1 * t703 * t1260 + 0.2e1 * t5525 * t138 + 0.4e1 * t2671 * t326 + 0.2e1 * t1227 * t743 - 0.24e2 * t1664 * t996 * t988 + 0.14e2 * t1013 * t5631 - t4584 * t5631 - t312 * t5525 - t710 * t5628 * t134 + 0.4e1 * t715 * t5628;
  t5694 = my_piecewise3(t98, t5400 + t5439 + t5481 + t5522, -0.8e1 / 0.3e1 * t5525 * t141 - 0.16e2 / 0.3e1 * t2671 * t329 - 0.8e1 / 0.3e1 * t1227 * t746 - 0.16e2 / 0.3e1 * t2180 * t447 - 0.32e2 / 0.3e1 * t988 * t1028 - 0.16e2 / 0.3e1 * t432 * t2260 - 0.8e1 / 0.3e1 * t703 * t1263 - 0.16e2 / 0.3e1 * t310 * t2748 - 0.8e1 / 0.3e1 * t126 * (t5578 + t5689));
  t5719 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2635 * t614 + 0.64e2 / 0.27e2 * t936 * t5306 - 0.8e1 / 0.27e2 * t1184 * t617 + 0.32e2 / 0.9e1 * t269 * t4863 * t4866 - 0.16e2 / 0.9e1 * t406 * t468 + 0.16e2 / 0.3e1 * t406 * t1303 - 0.8e1 / 0.27e2 * t2640 * t614 + 0.8e1 / 0.9e1 * t2643 * t249 + 0.4e1 / 0.9e1 * t1186 * t617 - t4723);
  t5731 = t7 * t905 * t920;
  t5734 = t7 * t402 * t2054;
  t5737 = t7 * t159 * t2300;
  t5741 = t7 * t21 * t164 * t2518;
  t5744 = t7 * t2767 * t165;
  t5747 = t7 * t1052 * t492;
  t5750 = t7 * t764 * t779;
  t5753 = t7 * t344 * t1807;
  t5758 = -0.3e1 / 0.32e2 * t7 * t21 * t22 * t5249 - t5255 / 0.16e2 - t5259 / 0.16e2 - t5262 / 0.16e2 - t5265 / 0.16e2 - 0.3e1 / 0.32e2 * t7 * t92 * t22 * t5694 - 0.3e1 / 0.32e2 * t7 * t9 * t5719 * t146 - 0.3e1 / 0.16e2 * t7 * t2534 * t334 - 0.3e1 / 0.32e2 * t7 * t1166 * t751 - t5731 / 0.8e1 - t5734 / 0.8e1 - t5737 / 0.16e2 - t5741 / 0.16e2 - t5744 / 0.16e2 - t5747 / 0.16e2 - t5750 / 0.8e1 - t5753 / 0.8e1 - 0.3e1 / 0.32e2 * t7 * t476 * t1154;
  t5769 = t7 * t344 * t1764;
  t5773 = t7 * t92 * t487 * t1267;
  t5776 = t7 * t1166 * t632;
  t5779 = t7 * t402 * t1751;
  t5783 = t7 * t21 * t487 * t1153;
  t5786 = t7 * t1052 * t488;
  t5820 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t2398 * t464 - 0.64e2 / 0.27e2 * t797 * t4858 - 0.8e1 / 0.27e2 * t1070 * t471 + 0.32e2 / 0.9e1 * t180 * t4863 * t4866 + 0.16e2 / 0.9e1 * t348 * t468 - 0.16e2 / 0.3e1 * t348 * t1303 - 0.8e1 / 0.27e2 * t2403 * t464 + 0.8e1 / 0.9e1 * t2409 * t155 + 0.4e1 / 0.9e1 * t1072 * t471 + t4248);
  t5837 = -0.3e1 / 0.16e2 * t7 * t159 * t2519 - 0.3e1 / 0.32e2 * t7 * t622 * t1268 - 0.3e1 / 0.16e2 * t7 * t253 * t2753 + t5769 / 0.24e2 + t5773 / 0.48e2 + t5776 / 0.48e2 + t5779 / 0.24e2 + t5783 / 0.48e2 + t5786 / 0.48e2 - 0.3e1 / 0.32e2 * t7 * t1052 * t610 - 0.3e1 / 0.16e2 * t7 * t1788 * t394 - 0.3e1 / 0.8e1 * t7 * t764 * t894 - 0.3e1 / 0.16e2 * t7 * t344 * t2018 - 0.3e1 / 0.32e2 * t7 * t9 * t5820 * t84 - 0.3e1 / 0.16e2 * t7 * t2767 * t245 - 0.3e1 / 0.16e2 * t7 * t2035 * t452 - 0.3e1 / 0.8e1 * t7 * t905 * t1033 - 0.3e1 / 0.16e2 * t7 * t402 * t2265;
  t5857 = -t3856 / 0.8e1 + t3859 / 0.12e2 - t4262 / 0.16e2 + t4277 / 0.12e2 - t4280 / 0.16e2 - t4283 / 0.8e1 + t4287 / 0.12e2 - t4291 / 0.16e2 - t4294 / 0.8e1 + t4297 / 0.12e2 - t4300 / 0.16e2 - t4303 / 0.8e1 + t4307 / 0.12e2 - t4310 / 0.16e2 - t4686 / 0.16e2 - t4702 / 0.16e2 - t4735 / 0.16e2 + t4738 / 0.12e2;
  t5874 = -0.5e1 / 0.72e2 * t4741 - 0.5e1 / 0.72e2 * t4745 + t4748 / 0.12e2 - 0.5e1 / 0.72e2 * t4751 + t4754 / 0.12e2 - 0.5e1 / 0.72e2 * t4758 + t3427 / 0.48e2 + t3430 / 0.24e2 - 0.5e1 / 0.72e2 * t3434 + t3449 / 0.24e2 - 0.5e1 / 0.72e2 * t3453 + t3495 / 0.48e2 + t3506 - 0.5e1 / 0.72e2 * t3508 + t3513 + t3515 / 0.48e2 + t3519 / 0.48e2 - 0.5e1 / 0.72e2 * t3828;
  t5888 = t11 * (t5758 + t5837 + t5857 + t5874) + t1275 / 0.8e1 - t3834 - t1284 / 0.16e2 - t1287 / 0.16e2 + t1290 / 0.8e1 - t3838 - t1318 / 0.8e1 + t1325 / 0.8e1 - t1329 / 0.16e2 - t1529 / 0.8e1 + t1536 / 0.8e1 - t1540 / 0.16e2;
  t5903 = -t1749 / 0.4e1 + t1753 / 0.8e1 - t1756 / 0.4e1 + t1759 / 0.8e1 - t1762 / 0.4e1 + t1766 / 0.8e1 - t1770 / 0.4e1 + t1773 / 0.8e1 - 0.3e1 / 0.16e2 * t1790 - 0.3e1 / 0.8e1 * t1793 - t1796 / 0.4e1 - 0.3e1 / 0.16e2 * t1799 - 0.3e1 / 0.16e2 * t1802 - 0.3e1 / 0.8e1 * t1805;
  t5919 = -t1809 / 0.4e1 - 0.3e1 / 0.16e2 * t2020 - 0.3e1 / 0.16e2 * t2037 - 0.3e1 / 0.8e1 * t2040 - t2043 / 0.4e1 - 0.3e1 / 0.16e2 * t2046 - 0.3e1 / 0.16e2 * t2049 - 0.3e1 / 0.8e1 * t2052 - t2056 / 0.4e1 - 0.3e1 / 0.16e2 * t2267 - t2292 / 0.16e2 - t2295 / 0.16e2 - t2298 / 0.8e1 - t2302 / 0.16e2;
  t5934 = -t2305 / 0.16e2 - t2308 / 0.8e1 - 0.3e1 / 0.16e2 * t2311 - 0.3e1 / 0.16e2 * t2521 - 0.3e1 / 0.16e2 * t2536 - 0.3e1 / 0.16e2 * t2539 - 0.3e1 / 0.8e1 * t2542 - 0.3e1 / 0.8e1 * t2545 - 0.3e1 / 0.16e2 * t2548 - 0.3e1 / 0.16e2 * t2755 - 0.3e1 / 0.16e2 * t2769 - 0.3e1 / 0.16e2 * t2772 - 0.3e1 / 0.8e1 * t2775 - 0.3e1 / 0.8e1 * t2778;
  tv4rho42 = t5888 + t5903 + t5919 + t5934;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t5936 = t1195 * t278;
  t5963 = t27 * t173 * t2820;
  t5973 = t791 * t2122 * t2824;
  t5987 = t27 * t173 * t2836;
  t5998 = t1161 * t249;
  t6001 = t468 * t1161;
  t6011 = -0.12e2 * t1302 - 0.24e2 * t3196;
  t6015 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3568 * t2795 * t249 - 0.2e2 / 0.9e1 * t2635 * t469 + 0.1e2 / 0.9e1 * t2142 * t5998 + 0.4e1 / 0.3e1 * t2145 * t6001 - 0.2e1 / 0.3e1 * t936 * t2529 - 0.2e1 / 0.9e1 * t657 * t2801 * t249 + t269 * t6011 / 0.3e1);
  t6020 = t5300 / 0.18e2 + t5963 / 0.9e1 + 0.4e1 / 0.3e1 * t791 * t4357 * t2819 * t272 - t791 * t2129 * t1179 * t943 - t5973 / 0.9e1 - t791 * t2129 * t2824 * t272 + t791 * t931 * t943 * t1189 / 0.3e1 + t791 * t931 * t408 * t2646 / 0.3e1 + t5987 / 0.54e2 + t791 * t931 * t2835 * t272 / 0.9e1 - t27 * t29 * t267 * t6015 / 0.18e2;
  t6021 = t3527 + 0.14e2 / 0.243e3 * t3529 + 0.14e2 / 0.81e2 * t4330 + t4335 - t4372 + 0.4e1 / 0.27e2 * t5297 + t5371 / 0.3e1 - 0.2e1 / 0.9e1 * t5374 - 0.2e1 / 0.27e2 * t5294 - t5360 / 0.9e1 + t6020;
  t6022 = my_piecewise3(t99, t6021, 0);
  t6035 = -0.2e1 * t417 * t5936 + 0.3e1 / 0.8e1 * t419 * t5936 - 0.3e1 / 0.8e2 * t421 * t5936 + t423 * t5936 / 0.384e3 - t425 * t5936 / 0.7168e4 + t427 * t5936 / 0.16384e6 - t429 * t5936 / 0.442368e7 + t2113 * t5936 / 0.1376256e9 + t298 * t6022 / 0.8945664e8 - t302 * t6022 / 0.31850496e10 + t306 * t6022 / 0.1263403008e12 - t262 * t6022 / 0.18e2 + t282 * t6022 / 0.24e3 - t286 * t6022 / 0.448e4;
  t6067 = t290 * t6022 / 0.10368e6 - t294 * t6022 / 0.2838528e7 + 0.3e1 / 0.8e1 * t2555 * t949 - t2063 * t1195 / 0.16e2 - t952 * t2652 / 0.16e2 + 0.9e1 / 0.8e2 * t114 * t2858 * t278 - 0.3e1 / 0.8e2 * t2563 * t949 + 0.3e1 / 0.64e3 * t2068 * t1195 + 0.3e1 / 0.64e3 * t957 * t2652 - 0.11e2 / 0.1152e4 * t117 * t2858 * t278 + t2571 * t949 / 0.384e3 - t2073 * t1195 / 0.384e4 - t962 * t2652 / 0.384e4 + 0.13e2 / 0.21504e5 * t120 * t2858 * t278;
  t6100 = -t2579 * t949 / 0.7168e4 + t2078 * t1195 / 0.86016e5 + t967 * t2652 / 0.86016e5 - t123 * t2858 * t278 / 0.32768e5 + t2587 * t949 / 0.16384e6 - t2083 * t1195 / 0.229376e7 - t972 * t2652 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t697 * t2858 * t278 - t2596 * t949 / 0.442368e7 + t2088 * t1195 / 0.7077888e8 + t977 * t2652 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3635 * t2858 * t278 + t2604 * t949 / 0.1376256e9 - t2093 * t1195 / 0.24772608e10;
  t6103 = t120 * t2841;
  t6106 = t123 * t2841;
  t6109 = t697 * t2841;
  t6112 = t105 * t2841;
  t6115 = t108 * t2841;
  t6118 = t111 * t2841;
  t6121 = t114 * t2841;
  t6124 = t117 * t2841;
  t6139 = -t982 * t2652 / 0.24772608e10 - t6103 * t278 / 0.688128e7 + t6106 * t278 / 0.21233664e9 - t6109 * t278 / 0.74317824e10 + t6112 * t278 / 0.6e1 - t6115 * t278 / 0.48e2 + t6118 * t278 / 0.64e3 - t6121 * t278 / 0.1152e5 + t6124 * t278 / 0.258048e6 + 0.1e2 / 0.3e1 * t108 * t2858 * t278 - 0.2e1 * t2612 * t949 + t2058 * t1195 / 0.2e1 + t924 * t2652 / 0.2e1 - 0.7e1 / 0.8e1 * t111 * t2858 * t278;
  t6142 = my_piecewise3(t99, 0, t6021);
  t6187 = -0.24e2 * t2927 * t1007 + 0.21e2 / 0.2e1 * t1249 * t2199 + 0.15e2 / 0.4e1 * t2935 * t1007 - 0.3e1 / 0.2e1 * t4581 * t2694 - 0.3e1 / 0.2e1 * t2221 * t5560 - 0.3e1 / 0.4e1 * t2685 * t2199 - t3733 * t2901 * t1007 / 0.8e1 + 0.24e2 * t3708 * t2901 * t310 - 0.18e2 * t1664 * t1232 * t988 + 0.6e1 * t715 * t988 * t1227 + 0.6e1 * t715 * t432 * t2671 + 0.2e1 * t715 * t2894 * t310;
  t6188 = t134 * t2894;
  t6191 = t2694 * t310;
  t6217 = t731 * t2894;
  t6226 = -0.75e2 / 0.2e1 * t2902 * t1007 + 0.45e2 / 0.2e1 * t1233 * t2199 + 0.85e2 / 0.4e1 * t2907 * t1007 - 0.6e1 * t2225 * t2694 - 0.6e1 * t1006 * t5560 - 0.15e2 / 0.2e1 * t2715 * t2199 - 0.19e2 / 0.8e1 * t3774 * t2901 * t1007 - 0.2e1 * t723 * t2894 * t1007 + t6217 * t1007 / 0.4e1 + 0.3e1 / 0.4e1 * t5614 * t993 + 0.3e1 / 0.4e1 * t2724 * t2199 + 0.3e1 / 0.8e1 * t2729 * t2199;
  t6256 = t3782 * t2901 * t1007 / 0.16e2 - 0.3e1 * t132 * t988 * t2694 - 0.3e1 * t2735 * t5560 - t1019 * t6188 + 0.3e1 / 0.8e1 * t5620 * t4666 + 0.45e2 / 0.2e1 * t2221 * t6191 - 0.15e2 / 0.2e1 * t2228 * t6191 - 0.4e1 * t1016 * t2894 - 0.4e1 * t321 * t6142 - t127 * t6142 * t134 + t317 * t6142 * t134 / 0.2e1 - 0.12e2 * t988 * t135 * t1227 - 0.12e2 * t2732 * t2671;
  t6275 = -t992 * t6188 / 0.2e1 + 0.21e2 / 0.2e1 * t1013 * t6191 - 0.3e1 / 0.4e1 * t4584 * t6191 - 0.18e2 * t1664 * t2912 * t310 + 0.2e1 * t126 * (t6226 + t6256) + 0.2e1 * t6142 * t138 + 0.2e1 * t2894 * t326 + 0.6e1 * t2671 * t444 + 0.6e1 * t1227 * t1025 + 0.6e1 * t988 * t1260 + 0.6e1 * t432 * t2745 + 0.2e1 * t310 * t2946 - t312 * t6142;
  t6280 = my_piecewise3(t98, t6035 + t6067 + t6100 + t6139, -0.8e1 / 0.3e1 * t6142 * t141 - 0.8e1 / 0.3e1 * t2894 * t329 - 0.8e1 * t2671 * t447 - 0.8e1 * t1227 * t1028 - 0.8e1 * t988 * t1263 - 0.8e1 * t432 * t2748 - 0.8e1 / 0.3e1 * t310 * t2949 - 0.8e1 / 0.3e1 * t126 * (t6187 + t6275));
  t6289 = t1047 * t155;
  t6292 = t468 * t1047;
  t6299 = -t6011;
  t6303 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t2990 * t155 - 0.16e2 / 0.9e1 * t1070 * t469 - 0.8e1 / 0.9e1 * t797 * t6289 + 0.8e1 / 0.3e1 * t800 * t6292 + 0.4e1 / 0.3e1 * t348 * t2408 + 0.4e1 / 0.9e1 * t2994 * t155 + 0.4e1 / 0.3e1 * t18 * t6299);
  t6315 = t7 * t344 * t2300;
  t6319 = t7 * t21 * t164 * t3115;
  t6322 = t7 * t2968 * t165;
  t6325 = t7 * t1052 * t779;
  t6328 = t7 * t2806 * t257;
  t6331 = t7 * t1166 * t920;
  t6334 = t7 * t402 * t2290;
  t6338 = t7 * t92 * t164 * t2953;
  t6355 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t2828 * t249 + 0.16e2 / 0.9e1 * t1184 * t469 - 0.8e1 / 0.9e1 * t936 * t5998 - 0.8e1 / 0.3e1 * t939 * t6001 + 0.4e1 / 0.3e1 * t406 * t2529 + 0.4e1 / 0.9e1 * t2832 * t249 + 0.4e1 / 0.3e1 * t89 * t6011);
  t6366 = -0.3e1 / 0.32e2 * t7 * t92 * t22 * t6280 - 0.3e1 / 0.32e2 * t7 * t9 * t6303 * t84 - 0.3e1 / 0.32e2 * t7 * t2968 * t245 - 0.9e1 / 0.32e2 * t7 * t2767 * t394 - 0.3e1 / 0.32e2 * t6315 - t6319 / 0.32e2 - t6322 / 0.32e2 - 0.3e1 / 0.32e2 * t6325 - t6328 / 0.32e2 - 0.3e1 / 0.32e2 * t6331 - 0.3e1 / 0.32e2 * t6334 - t6338 / 0.32e2 - 0.3e1 / 0.32e2 * t7 * t9 * t6355 * t146 - 0.9e1 / 0.32e2 * t7 * t1166 * t1033 - 0.9e1 / 0.32e2 * t7 * t905 * t1268;
  t6373 = t1081 * t189;
  t6400 = t27 * t173 * t2982;
  t6410 = t791 * t1875 * t2986;
  t6424 = t27 * t173 * t2998;
  t6447 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3182 * t2958 * t155 + 0.2e2 / 0.9e1 * t2398 * t469 + 0.1e2 / 0.9e1 * t1895 * t6289 - 0.4e1 / 0.3e1 * t1898 * t6292 - 0.2e1 / 0.3e1 * t797 * t2408 - 0.2e1 / 0.9e1 * t516 * t2963 * t155 + t180 * t6299 / 0.3e1);
  t6452 = t4852 / 0.18e2 + t6400 / 0.9e1 + 0.4e1 / 0.3e1 * t791 * t3910 * t2981 * t183 - t791 * t1882 * t1065 * t804 - t6410 / 0.9e1 - t791 * t1882 * t2986 * t183 + t791 * t792 * t804 * t1075 / 0.3e1 + t791 * t792 * t350 * t2412 / 0.3e1 + t6424 / 0.54e2 + t791 * t792 * t2997 * t183 / 0.9e1 - t27 * t29 * t178 * t6447 / 0.18e2;
  t6453 = t3141 + 0.14e2 / 0.243e3 * t3143 + 0.14e2 / 0.81e2 * t3891 + t3896 - t3921 + 0.4e1 / 0.27e2 * t4844 + t4914 / 0.3e1 - 0.2e1 / 0.9e1 * t4917 - 0.2e1 / 0.27e2 * t4841 - t4903 / 0.9e1 + t6452;
  t6454 = my_piecewise3(t36, t6453, 0);
  t6467 = -t367 * t6373 / 0.7168e4 + t369 * t6373 / 0.16384e6 - t371 * t6373 / 0.442368e7 + t1866 * t6373 / 0.1376256e9 - 0.2e1 * t359 * t6373 + 0.3e1 / 0.8e1 * t361 * t6373 - 0.3e1 / 0.8e2 * t363 * t6373 + t365 * t6373 / 0.384e3 + t201 * t6454 / 0.10368e6 - t205 * t6454 / 0.2838528e7 + t209 * t6454 / 0.8945664e8 - t213 * t6454 / 0.31850496e10 + t217 * t6454 / 0.1263403008e12 - t170 * t6454 / 0.18e2;
  t6472 = t51 * t3003;
  t6475 = t54 * t3003;
  t6478 = t57 * t3003;
  t6481 = t60 * t3003;
  t6484 = t556 * t3003;
  t6503 = t193 * t6454 / 0.24e3 - t197 * t6454 / 0.448e4 - t6472 * t189 / 0.1152e5 + t6475 * t189 / 0.258048e6 - t6478 * t189 / 0.688128e7 + t6481 * t189 / 0.21233664e9 - t6484 * t189 / 0.74317824e10 + 0.1e2 / 0.3e1 * t45 * t3014 * t189 - 0.2e1 * t2362 * t810 + t1816 * t1081 / 0.2e1 + t783 * t2418 / 0.2e1 - 0.7e1 / 0.8e1 * t48 * t3014 * t189 + 0.3e1 / 0.8e1 * t2370 * t810 - t1821 * t1081 / 0.16e2;
  t6537 = -t813 * t2418 / 0.16e2 + 0.9e1 / 0.8e2 * t51 * t3014 * t189 - 0.3e1 / 0.8e2 * t2313 * t810 + 0.3e1 / 0.64e3 * t1826 * t1081 + 0.3e1 / 0.64e3 * t818 * t2418 - 0.11e2 / 0.1152e4 * t54 * t3014 * t189 + t2321 * t810 / 0.384e3 - t1831 * t1081 / 0.384e4 - t823 * t2418 / 0.384e4 + 0.13e2 / 0.21504e5 * t57 * t3014 * t189 - t2329 * t810 / 0.7168e4 + t1836 * t1081 / 0.86016e5 + t828 * t2418 / 0.86016e5 - t60 * t3014 * t189 / 0.32768e5;
  t6571 = t2337 * t810 / 0.16384e6 - t1841 * t1081 / 0.229376e7 - t833 * t2418 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t556 * t3014 * t189 - t2345 * t810 / 0.442368e7 + t1846 * t1081 / 0.7077888e8 + t838 * t2418 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3240 * t3014 * t189 + t2353 * t810 / 0.1376256e9 - t1811 * t1081 / 0.24772608e10 - t843 * t2418 / 0.24772608e10 + t42 * t3003 * t189 / 0.6e1 - t45 * t3003 * t189 / 0.48e2 + t48 * t3003 * t189 / 0.64e3;
  t6574 = my_piecewise3(t36, 0, t6453);
  t6592 = t2460 * t221;
  t6606 = t72 * t3056;
  t6619 = -0.18e2 * t1456 * t3074 * t221 + 0.21e2 / 0.2e1 * t874 * t6592 - 0.3e1 / 0.4e1 * t4139 * t6592 + 0.6e1 * t574 * t849 * t1113 + 0.6e1 * t574 * t374 * t2437 + 0.2e1 * t574 * t3056 * t221 - t853 * t6606 / 0.2e1 - 0.24e2 * t3089 * t868 + 0.21e2 / 0.2e1 * t1135 * t1952 + 0.15e2 / 0.4e1 * t3097 * t868 - 0.3e1 / 0.2e1 * t4136 * t2460 - 0.3e1 / 0.2e1 * t1974 * t5122;
  t6649 = t590 * t3056;
  t6661 = 0.45e2 / 0.2e1 * t1974 * t6592 - 0.15e2 / 0.2e1 * t1981 * t6592 + 0.3e1 / 0.8e1 * t5181 * t4214 - 0.6e1 * t867 * t5122 - 0.15e2 / 0.2e1 * t2481 * t1952 - 0.19e2 / 0.8e1 * t3326 * t3063 * t868 - 0.2e1 * t582 * t3056 * t868 + t6649 * t868 / 0.4e1 + 0.3e1 / 0.4e1 * t5175 * t854 + 0.3e1 / 0.4e1 * t2490 * t1952 + 0.3e1 / 0.8e1 * t2495 * t1952 + t3334 * t3063 * t868 / 0.16e2;
  t6690 = -0.3e1 * t70 * t849 * t2460 - 0.3e1 * t2501 * t5122 - t880 * t6606 - 0.75e2 / 0.2e1 * t3064 * t868 + 0.45e2 / 0.2e1 * t1119 * t1952 + 0.85e2 / 0.4e1 * t3069 * t868 - 0.6e1 * t1978 * t2460 - 0.4e1 * t877 * t3056 - 0.4e1 * t232 * t6574 - t65 * t6574 * t72 + t228 * t6574 * t72 / 0.2e1 - 0.12e2 * t849 * t73 * t1113 - 0.12e2 * t2498 * t2437;
  t6707 = -0.3e1 / 0.4e1 * t2451 * t1952 - t3389 * t3063 * t868 / 0.8e1 + 0.24e2 * t3406 * t3063 * t221 - 0.18e2 * t1456 * t1118 * t849 + 0.2e1 * t221 * t3108 + 0.2e1 * t63 * (t6661 + t6690) + 0.2e1 * t6574 * t76 + 0.2e1 * t3056 * t237 + 0.6e1 * t2437 * t386 + 0.6e1 * t1113 * t886 + 0.6e1 * t849 * t1146 + 0.6e1 * t374 * t2511 - t223 * t6574;
  t6712 = my_piecewise3(t35, t6467 + t6503 + t6537 + t6571, -0.8e1 / 0.3e1 * t6574 * t79 - 0.8e1 / 0.3e1 * t3056 * t240 - 0.8e1 * t2437 * t389 - 0.8e1 * t1113 * t889 - 0.8e1 * t849 * t1149 - 0.8e1 * t374 * t2514 - 0.8e1 / 0.3e1 * t221 * t3111 - 0.8e1 / 0.3e1 * t63 * (t6619 + t6707));
  t6741 = -0.9e1 / 0.32e2 * t7 * t402 * t2753 - 0.3e1 / 0.32e2 * t7 * t253 * t2954 - 0.3e1 / 0.32e2 * t7 * t21 * t22 * t6712 - 0.3e1 / 0.32e2 * t7 * t2806 * t334 - 0.9e1 / 0.32e2 * t7 * t2534 * t452 - 0.9e1 / 0.32e2 * t7 * t1052 * t894 - 0.9e1 / 0.32e2 * t7 * t764 * t1154 - 0.9e1 / 0.32e2 * t7 * t344 * t2519 - 0.3e1 / 0.32e2 * t7 * t159 * t3116 - 0.3e1 / 0.32e2 * t5255 - 0.3e1 / 0.32e2 * t5259 - 0.3e1 / 0.32e2 * t5262 - 0.3e1 / 0.32e2 * t5265 - 0.3e1 / 0.16e2 * t5731 - 0.3e1 / 0.16e2 * t5734;
  t6755 = -0.3e1 / 0.32e2 * t5737 - 0.3e1 / 0.32e2 * t5741 - 0.3e1 / 0.32e2 * t5744 - 0.3e1 / 0.32e2 * t5747 - 0.3e1 / 0.16e2 * t5750 - 0.3e1 / 0.16e2 * t5753 + t5769 / 0.8e1 + t5773 / 0.16e2 + t5776 / 0.16e2 + t5779 / 0.8e1 + t5783 / 0.16e2 + t5786 / 0.16e2 + t3860 + t4278 + t4288;
  t6764 = t4298 + t4308 + t4739 - 0.5e1 / 0.48e2 * t4741 - 0.5e1 / 0.48e2 * t4745 + t4749 - 0.5e1 / 0.48e2 * t4751 + t4755 - 0.5e1 / 0.48e2 * t4758 - 0.5e1 / 0.144e3 * t3434 - 0.5e1 / 0.144e3 * t3453 + t3506 - 0.5e1 / 0.144e3 * t3508 + t3513 - 0.5e1 / 0.144e3 * t3828;
  t6768 = t11 * (t6366 + t6741 + t6755 + t6764) - t3119 - t2957 - t2971 - t2974 - t2977 + t1276 - t3834 + t1291 - t3838 + t1326;
  t6773 = t1537 - t4794 + 0.3e1 / 0.16e2 * t1753 - t4797 + 0.3e1 / 0.16e2 * t1759 - t4798 + 0.3e1 / 0.16e2 * t1766 - t4799 + 0.3e1 / 0.16e2 * t1773 - t4802 - t4807;
  t6784 = -t4811 - t4815 - 0.3e1 / 0.16e2 * t2292 - 0.3e1 / 0.16e2 * t2295 - 0.3e1 / 0.8e1 * t2298 - 0.3e1 / 0.16e2 * t2302 - 0.3e1 / 0.16e2 * t2305 - 0.3e1 / 0.8e1 * t2308 - 0.9e1 / 0.32e2 * t2311 - 0.9e1 / 0.32e2 * t2521 - 0.9e1 / 0.32e2 * t2536;
  t6794 = -0.9e1 / 0.32e2 * t2539 - 0.9e1 / 0.16e2 * t2542 - 0.9e1 / 0.16e2 * t2545 - 0.9e1 / 0.32e2 * t2548 - 0.9e1 / 0.32e2 * t2755 - 0.9e1 / 0.32e2 * t2769 - 0.9e1 / 0.32e2 * t2772 - 0.9e1 / 0.16e2 * t2775 - 0.9e1 / 0.16e2 * t2778 - t2809 - t2812 - t2815;
  tv4rho43 = t6768 + t6773 + t6784 + t6794;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t6802 = t1179 * t1179;
  t6811 = t1189 * t1189;
  t6820 = t1158 * t1158;
  t6825 = t1161 * t1161;
  t6831 = -0.24e2 * t1302 - 0.24e2 * t3196;
  t6835 = my_piecewise3(t88, 0, -0.8e2 / 0.81e2 * t3568 * t6820 + 0.2e2 / 0.9e1 * t2635 * t1161 - 0.2e1 / 0.3e1 * t657 * t6825 - 0.8e1 / 0.9e1 * t936 * t2801 + t269 * t6831 / 0.3e1);
  t6840 = t3527 + 0.56e2 / 0.243e3 * t4330 + 0.8e1 / 0.27e2 * t5297 - 0.4e1 / 0.27e2 * t5294 + 0.4e1 / 0.9e1 * t5963 - 0.4e1 / 0.9e1 * t5973 + 0.2e1 / 0.27e2 * t5987 + 0.4e1 / 0.3e1 * t27 * t29 * t3547 * t6802 - 0.2e1 * t791 * t2129 * t1179 * t1189 + t27 * t29 * t650 * t6811 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t931 * t408 * t2835 - t27 * t29 * t267 * t6835 / 0.18e2;
  t6841 = my_piecewise3(t99, t6840, 0);
  t6858 = t1195 * t1195;
  t6861 = t1175 * t1175;
  t6884 = -t294 * t6841 / 0.2838528e7 + t298 * t6841 / 0.8945664e8 - t302 * t6841 / 0.31850496e10 + t306 * t6841 / 0.1263403008e12 - t262 * t6841 / 0.18e2 + t282 * t6841 / 0.24e3 - t286 * t6841 / 0.448e4 + t290 * t6841 / 0.10368e6 - t108 * t6858 / 0.16e2 + 0.9e1 / 0.8e2 * t114 * t6861 + 0.3e1 / 0.64e3 * t111 * t6858 - 0.11e2 / 0.1152e4 * t117 * t6861 - t114 * t6858 / 0.384e4 + 0.13e2 / 0.21504e5 * t120 * t6861 + t117 * t6858 / 0.86016e5 - t123 * t6861 / 0.32768e5 - t120 * t6858 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t697 * t6861 + t123 * t6858 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3635 * t6861;
  t6925 = -t697 * t6858 / 0.24772608e10 + 0.1e2 / 0.3e1 * t108 * t6861 + t105 * t6858 / 0.2e1 - 0.7e1 / 0.8e1 * t111 * t6861 + 0.3e1 / 0.4e1 * t2555 * t1195 - 0.3e1 / 0.4e2 * t2563 * t1195 + t2571 * t1195 / 0.192e3 - t2579 * t1195 / 0.3584e4 + t2587 * t1195 / 0.8192e5 - t2596 * t1195 / 0.221184e7 + t2604 * t1195 / 0.688128e8 - t6103 * t414 / 0.172032e7 + t6106 * t414 / 0.5308416e8 - t6109 * t414 / 0.18579456e10 + 0.2e1 / 0.3e1 * t6112 * t414 - t6115 * t414 / 0.12e2 + t6118 * t414 / 0.16e3 - t6121 * t414 / 0.288e4 + t6124 * t414 / 0.64512e5 - 0.4e1 * t2612 * t1195;
  t6927 = my_piecewise3(t99, 0, t6840);
  t6938 = t1232 * t1232;
  t6951 = t1227 * t1227;
  t6982 = -t127 * t6927 * t134 + 0.85e2 / 0.4e1 * t1660 * t6938 * t134 - 0.19e2 / 0.8e1 * t3774 * t6938 * t134 + t317 * t6927 * t134 / 0.2e1 + t3782 * t6938 * t134 / 0.16e2 - 0.12e2 * t6951 * t135 - 0.16e2 * t2732 * t2894 - 0.4e1 * t321 * t6927 - 0.75e2 / 0.2e1 * t731 * t6938 * t134 + 0.45e2 * t1233 * t2694 - 0.6e1 * t723 * t6951 * t134 - 0.8e1 * t1006 * t6188 - 0.15e2 * t2715 * t2694 + t6217 * t993 + 0.3e1 / 0.4e1 * t731 * t6951 * t134 + 0.3e1 / 0.4e1 * t5620 * t1232 * t134 - 0.3e1 * t132 * t6951 * t134 - 0.4e1 * t2735 * t6188;
  t7022 = 0.2e1 * t126 * t6982 + 0.2e1 * t6927 * t138 + 0.8e1 * t2894 * t444 + 0.12e2 * t1227 * t1260 + 0.8e1 * t432 * t2946 + 0.15e2 / 0.4e1 * t1695 * t6938 * t134 - t3733 * t6938 * t134 / 0.8e1 - t312 * t6927 - 0.24e2 * t1684 * t6938 * t134 + 0.21e2 * t1249 * t2694 - 0.3e1 / 0.2e1 * t710 * t6951 * t134 - 0.2e1 * t2221 * t6188 - 0.3e1 / 0.2e1 * t2685 * t2694 + 0.24e2 * t3708 * t6938 - 0.36e2 * t1664 * t1232 * t1227 + 0.6e1 * t715 * t6951 + 0.8e1 * t715 * t432 * t2894;
  t7026 = my_piecewise3(t98, t6884 + t6925, -0.8e1 / 0.3e1 * t6927 * t141 - 0.32e2 / 0.3e1 * t2894 * t447 - 0.16e2 * t1227 * t1263 - 0.32e2 / 0.3e1 * t432 * t2949 - 0.8e1 / 0.3e1 * t126 * t7022);
  t7031 = t1043 * t1043;
  t7036 = t1047 * t1047;
  t7041 = -t6831;
  t7045 = my_piecewise3(t15, 0, 0.4e2 / 0.81e2 * t1359 * t7031 - 0.16e2 / 0.9e1 * t1070 * t1047 + 0.4e1 / 0.3e1 * t180 * t7036 + 0.16e2 / 0.9e1 * t348 * t2963 + 0.4e1 / 0.3e1 * t18 * t7041);
  t7064 = my_piecewise3(t88, 0, 0.4e2 / 0.81e2 * t1567 * t6820 - 0.16e2 / 0.9e1 * t1184 * t1161 + 0.4e1 / 0.3e1 * t269 * t6825 + 0.16e2 / 0.9e1 * t406 * t2801 + 0.4e1 / 0.3e1 * t89 * t6831);
  t7078 = t1061 * t1061;
  t7081 = t1081 * t1081;
  t7102 = t1065 * t1065;
  t7111 = t1075 * t1075;
  t7131 = my_piecewise3(t15, 0, -0.8e2 / 0.81e2 * t3182 * t7031 + 0.2e2 / 0.9e1 * t2398 * t1047 - 0.2e1 / 0.3e1 * t516 * t7036 - 0.8e1 / 0.9e1 * t797 * t2963 + t180 * t7041 / 0.3e1);
  t7136 = t3141 + 0.56e2 / 0.243e3 * t3891 + 0.8e1 / 0.27e2 * t4844 - 0.4e1 / 0.27e2 * t4841 + 0.4e1 / 0.9e1 * t6400 - 0.4e1 / 0.9e1 * t6410 + 0.2e1 / 0.27e2 * t6424 + 0.4e1 / 0.3e1 * t27 * t29 * t3161 * t7102 - 0.2e1 * t791 * t1882 * t1065 * t1075 + t27 * t29 * t509 * t7111 / 0.3e1 + 0.4e1 / 0.9e1 * t791 * t792 * t350 * t2997 - t27 * t29 * t178 * t7131 / 0.18e2;
  t7137 = my_piecewise3(t36, t7136, 0);
  t7162 = 0.13e2 / 0.21504e5 * t57 * t7078 + t54 * t7081 / 0.86016e5 - t60 * t7078 / 0.32768e5 - t57 * t7081 / 0.229376e7 + 0.17e2 / 0.1327104e8 * t556 * t7078 + t60 * t7081 / 0.7077888e8 - 0.19e2 / 0.4128768e9 * t3240 * t7078 - t556 * t7081 / 0.24772608e10 - t205 * t7137 / 0.2838528e7 + t209 * t7137 / 0.8945664e8 - t213 * t7137 / 0.31850496e10 + t217 * t7137 / 0.1263403008e12 - t170 * t7137 / 0.18e2 + t193 * t7137 / 0.24e3 - t197 * t7137 / 0.448e4 + t201 * t7137 / 0.10368e6 + 0.1e2 / 0.3e1 * t45 * t7078 + t42 * t7081 / 0.2e1 - 0.7e1 / 0.8e1 * t48 * t7078 - t45 * t7081 / 0.16e2;
  t7203 = 0.9e1 / 0.8e2 * t51 * t7078 + 0.3e1 / 0.64e3 * t48 * t7081 - 0.11e2 / 0.1152e4 * t54 * t7078 - t51 * t7081 / 0.384e4 - t6472 * t356 / 0.288e4 + t6475 * t356 / 0.64512e5 - t6478 * t356 / 0.172032e7 + t6481 * t356 / 0.5308416e8 - t6484 * t356 / 0.18579456e10 - 0.4e1 * t2362 * t1081 + 0.2e1 / 0.3e1 * t783 * t3003 + 0.3e1 / 0.4e1 * t2370 * t1081 - t813 * t3003 / 0.12e2 - 0.3e1 / 0.4e2 * t2313 * t1081 + t818 * t3003 / 0.16e3 + t2321 * t1081 / 0.192e3 - t2329 * t1081 / 0.3584e4 + t2337 * t1081 / 0.8192e5 - t2345 * t1081 / 0.221184e7 + t2353 * t1081 / 0.688128e8;
  t7205 = my_piecewise3(t36, 0, t7136);
  t7216 = t1118 * t1118;
  t7229 = t1113 * t1113;
  t7262 = 0.85e2 / 0.4e1 * t1452 * t7216 * t72 - 0.19e2 / 0.8e1 * t3326 * t7216 * t72 + t228 * t7205 * t72 / 0.2e1 + t3334 * t7216 * t72 / 0.16e2 - 0.12e2 * t7229 * t73 - 0.16e2 * t2498 * t3056 - 0.4e1 * t232 * t7205 - t65 * t7205 * t72 - 0.75e2 / 0.2e1 * t590 * t7216 * t72 + 0.45e2 * t1119 * t2460 - 0.6e1 * t582 * t7229 * t72 - 0.8e1 * t867 * t6606 - 0.15e2 * t2481 * t2460 + t6649 * t854 + 0.3e1 / 0.4e1 * t590 * t7229 * t72 + 0.3e1 / 0.4e1 * t5181 * t1118 * t72 - 0.3e1 * t70 * t7229 * t72 - 0.4e1 * t2501 * t6606;
  t7300 = 0.8e1 * t374 * t3108 + 0.2e1 * t63 * t7262 - t223 * t7205 + 0.15e2 / 0.4e1 * t1487 * t7216 * t72 - t3389 * t7216 * t72 / 0.8e1 + 0.2e1 * t7205 * t76 + 0.8e1 * t3056 * t386 + 0.12e2 * t1113 * t1146 - 0.3e1 / 0.2e1 * t569 * t7229 * t72 - 0.2e1 * t1974 * t6606 - 0.3e1 / 0.2e1 * t2451 * t2460 + 0.24e2 * t3406 * t7216 - 0.36e2 * t1456 * t1118 * t1113 + 0.6e1 * t574 * t7229 + 0.8e1 * t574 * t374 * t3056 - 0.24e2 * t1476 * t7216 * t72 + 0.21e2 * t1135 * t2460;
  t7304 = my_piecewise3(t35, t7162 + t7203, -0.8e1 / 0.3e1 * t7205 * t79 - 0.32e2 / 0.3e1 * t3056 * t389 - 0.16e2 * t1113 * t1149 - 0.32e2 / 0.3e1 * t374 * t3111 - 0.8e1 / 0.3e1 * t63 * t7300);
  t7320 = -0.3e1 / 0.32e2 * t7 * t92 * t22 * t7026 - 0.3e1 / 0.32e2 * t7 * t9 * t7045 * t84 - 0.3e1 / 0.8e1 * t7 * t2968 * t394 - 0.3e1 / 0.32e2 * t7 * t9 * t7064 * t146 - 0.3e1 / 0.8e1 * t7 * t2806 * t452 - 0.9e1 / 0.16e2 * t7 * t1166 * t1268 - 0.3e1 / 0.8e1 * t7 * t402 * t2954 - 0.3e1 / 0.32e2 * t7 * t21 * t22 * t7304 - 0.9e1 / 0.16e2 * t7 * t1052 * t1154 - 0.3e1 / 0.8e1 * t7 * t344 * t3116 - 0.3e1 / 0.8e1 * t6315 - t6319 / 0.8e1 - t6322 / 0.8e1 - 0.3e1 / 0.8e1 * t6325 - t6328 / 0.8e1;
  t7334 = -0.3e1 / 0.8e1 * t6331 - 0.3e1 / 0.8e1 * t6334 - t6338 / 0.8e1 + t5769 / 0.4e1 + t5773 / 0.8e1 + t5776 / 0.8e1 + t5779 / 0.4e1 + t5783 / 0.8e1 + t5786 / 0.8e1 - 0.5e1 / 0.36e2 * t4741 - 0.5e1 / 0.36e2 * t4745 - 0.5e1 / 0.36e2 * t4751 - 0.5e1 / 0.36e2 * t4758 + t3506 + t3513;
  t7356 = -0.3e1 / 0.8e1 * t2956 - 0.3e1 / 0.8e1 * t2970 - 0.9e1 / 0.8e1 * t2973 - 0.9e1 / 0.8e1 * t2976 - 0.3e1 / 0.8e1 * t3118 + t1753 / 0.4e1 + t1759 / 0.4e1 + t1766 / 0.4e1 + t1773 / 0.4e1 - t3834 - t3838;
  tv4rho44 = t11 * (t7320 + t7334) - 0.3e1 / 0.8e1 * t2292 - 0.3e1 / 0.8e1 * t2295 - 0.3e1 / 0.4e1 * t2298 - 0.3e1 / 0.8e1 * t2302 - 0.3e1 / 0.8e1 * t2305 - 0.3e1 / 0.4e1 * t2308 - 0.3e1 / 0.8e1 * t2808 - 0.9e1 / 0.8e1 * t2811 - 0.9e1 / 0.8e1 * t2814 + t7356;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

}

#endif

