/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_chachiyo.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;

  double t124, t134, t135, t140, t142, t143, t147, t153;
  double t154, t155, t159, t164, t170, t171, t173, t174;
  double t175, t177, t180, t181, t182, t183, t184, t187;
  double t188, t190, t193, t194, t197, t200, t201, tv2rho20;
  double t217, t222, t229, t232, t235, t238, t241, t248;
  double t250, t254, t257, t258, tv2rhosigma0, t261, t262, t267;
  double t272, t277, t282, t283, t285, t288, t289, t290;
  double t293, t296, t297, t298, t302, t305, t309, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t124 = 0.1e1 / t23 / rho[0];
  t134 = t17 / t57;
  t135 = t134 * t41;
  t140 = t22 * t22;
  t142 = 0.1e1 / t23 / t140;
  t143 = sigma[0] * t142;
  t147 = 0.1e1 / t19 / t57;
  t153 = t20 * t29 * t3;
  t154 = t38 * t38;
  t155 = 0.1e1 / t154;
  t159 = 0.352e3 / 0.729e3 * t21 * t143 + 0.56e2 / 0.243e3 * t64 * t32 * t147 * t68 - 0.64e2 / 0.2187e4 * t153 * t143 * t155;
  t164 = t78 * t72;
  t170 = 0.1e1 / t19 / t140;
  t171 = t17 * t170;
  t173 = 0.1e1 / t80 / t44;
  t174 = t41 * t173;
  t175 = t171 * t174;
  t177 = t46 * sigma[0] * t31;
  t180 = t41 * t81;
  t181 = t171 * t180;
  t182 = t87 * sigma[0];
  t183 = t31 * t68;
  t184 = t182 * t183;
  t187 = t41 * t45;
  t188 = t171 * t187;
  t190 = 0.1e1 / t86 / t39;
  t193 = t155 * t30 * t4;
  t194 = t190 * sigma[0] * t193;
  t197 = t182 * t193;
  t200 = t18 * t124 * t41 * t47 / 0.12e2 - t18 * t52 * t72 * t47 / 0.4e1 + 0.5e1 / 0.9e1 * t135 * t83 + 0.5e1 / 0.27e2 * t135 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t159 * t47 - 0.2e1 / 0.3e1 * t164 * t83 - 0.2e1 / 0.9e1 * t164 * t90 - 0.16e2 / 0.81e2 * t175 * t177 - 0.16e2 / 0.243e3 * t181 * t184 - 0.16e2 / 0.729e3 * t188 * t194 - 0.8e1 / 0.729e3 * t188 * t197;
  t201 = my_piecewise3(t2, 0, t200);
  tv2rho20 = 0.2e1 * rho[0] * t201 + 0.4e1 * t94;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t217 = -0.32e2 / 0.243e3 * t21 * t59 - 0.4e1 / 0.81e2 * t64 * t99 * t66 * t68 + 0.8e1 / 0.729e3 * t153 * t59 * t155;
  t222 = t78 * t104;
  t229 = t110 * t72;
  t232 = t17 * t147;
  t235 = t173 * t46 * t31;
  t238 = t232 * t180;
  t241 = t87 * t30 * t4 * t68;
  t248 = t232 * t187;
  t250 = t190 * t155 * t31;
  t254 = t87 * t155 * t31;
  t257 = -t18 * t52 * t104 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t217 * t47 - t222 * t83 / 0.3e1 - t222 * t90 / 0.9e1 - t79 * t112 / 0.8e1 + t229 * t112 / 0.8e1 + 0.2e1 / 0.27e2 * t232 * t41 * t235 + 0.2e1 / 0.81e2 * t238 * t241 - t79 * t116 / 0.24e2 + t229 * t116 / 0.24e2 + 0.2e1 / 0.243e3 * t248 * t250 + t248 * t254 / 0.243e3;
  t258 = my_piecewise3(t2, 0, t257);
  tv2rhosigma0 = 0.2e1 * rho[0] * t258 + 0.2e1 * t120;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t261 = t32 * sigma[0];
  t262 = 0.1e1 / t261;
  t267 = 0.1e1 / sigma[0];
  t272 = -t64 * t262 * t34 * t68 / 0.54e2 - t153 * t267 * t25 * t155 / 0.243e3;
  t277 = t110 * t104;
  t282 = t17 * t66;
  t283 = t282 * t174;
  t285 = t46 * t267 * t31;
  t288 = t282 * t180;
  t289 = t87 * t267;
  t290 = t289 * t183;
  t293 = t82 * t262;
  t296 = t282 * t187;
  t297 = t190 * t267;
  t298 = t297 * t193;
  t302 = t88 * t262 * t68;
  t305 = t289 * t193;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t272 * t47 + t277 * t112 / 0.4e1 + t277 * t116 / 0.12e2 - t283 * t285 / 0.36e2 - t288 * t290 / 0.108e3 - t111 * t293 / 0.16e2 - t296 * t298 / 0.324e3 - t111 * t302 / 0.48e2 - t296 * t305 / 0.648e3);
  tv2sigma20 = 0.2e1 * rho[0] * t309;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;

  double t124, t134, t135, t140, t142, t143, t147, t153;
  double t154, t155, t159, t164, t170, t171, t173, t174;
  double t175, t177, t180, t181, t182, t183, t184, t187;
  double t188, t190, t193, t194, t197, t200, t201, tv2rho20;
  double t217, t222, t229, t232, t235, t238, t241, t248;
  double t250, t254, t257, t258, tv2rhosigma0, t261, t262, t267;
  double t272, t277, t282, t283, t285, t288, t289, t290;
  double t293, t296, t297, t298, t302, t305, t309, tv2sigma20;

  double t312, t314, t315, t319, t323, t325, t326, t327;
  double t328, t329, t330, t332, t335, t338, t343, t344;
  double t347, t348, t353, t354, t355, t356, t359, t360;
  double t361, t362, t365, t368, t369, t370, t371, t374;
  double t376, t377, t380, t383, t386, t387, t388, t395;
  double t399, t400, t410, t411, t412, t413, t417, t422;
  double t438, t440, tv3rho30, t446, t449, t450, t452, t453;
  double t460, t465, t469, t470, t473, t474, t479, t480;
  double t482, t485, t488, t489, t492, t495, t497, t498;
  double t502, t505, t507, t524, t531, t543, t545, t548;
  double t553, t566, t568, tv3rho2sigma0, t571, t574, t579, t582;
  double t587, t590, t591, t593, t596, t599, t600, t601;
  double t606, t609, t610, t617, t618, t619, t622, t625;
  double t626, t629, t635, t654, t655, t659, t677, t679;
  double tv3rhosigma20, t682, t685, t686, t688, t691, t693, t695;
  double t698, t707, t713, t716, t725, t728, t729, t732;
  double t733, t736, t737, t740, t746, t749, t750, t751;
  double t754, t755, t756, t759, t762, t764, t767, t770;
  double t773, t776, t778, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t124 = 0.1e1 / t23 / rho[0];
  t134 = t17 / t57;
  t135 = t134 * t41;
  t140 = t22 * t22;
  t142 = 0.1e1 / t23 / t140;
  t143 = sigma[0] * t142;
  t147 = 0.1e1 / t19 / t57;
  t153 = t20 * t29 * t3;
  t154 = t38 * t38;
  t155 = 0.1e1 / t154;
  t159 = 0.352e3 / 0.729e3 * t21 * t143 + 0.56e2 / 0.243e3 * t64 * t32 * t147 * t68 - 0.64e2 / 0.2187e4 * t153 * t143 * t155;
  t164 = t78 * t72;
  t170 = 0.1e1 / t19 / t140;
  t171 = t17 * t170;
  t173 = 0.1e1 / t80 / t44;
  t174 = t41 * t173;
  t175 = t171 * t174;
  t177 = t46 * sigma[0] * t31;
  t180 = t41 * t81;
  t181 = t171 * t180;
  t182 = t87 * sigma[0];
  t183 = t31 * t68;
  t184 = t182 * t183;
  t187 = t41 * t45;
  t188 = t171 * t187;
  t190 = 0.1e1 / t86 / t39;
  t193 = t155 * t30 * t4;
  t194 = t190 * sigma[0] * t193;
  t197 = t182 * t193;
  t200 = t18 * t124 * t41 * t47 / 0.12e2 - t18 * t52 * t72 * t47 / 0.4e1 + 0.5e1 / 0.9e1 * t135 * t83 + 0.5e1 / 0.27e2 * t135 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t159 * t47 - 0.2e1 / 0.3e1 * t164 * t83 - 0.2e1 / 0.9e1 * t164 * t90 - 0.16e2 / 0.81e2 * t175 * t177 - 0.16e2 / 0.243e3 * t181 * t184 - 0.16e2 / 0.729e3 * t188 * t194 - 0.8e1 / 0.729e3 * t188 * t197;
  t201 = my_piecewise3(t2, 0, t200);
  tv2rho20 = 0.2e1 * rho[0] * t201 + 0.4e1 * t94;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t217 = -0.32e2 / 0.243e3 * t21 * t59 - 0.4e1 / 0.81e2 * t64 * t99 * t66 * t68 + 0.8e1 / 0.729e3 * t153 * t59 * t155;
  t222 = t78 * t104;
  t229 = t110 * t72;
  t232 = t17 * t147;
  t235 = t173 * t46 * t31;
  t238 = t232 * t180;
  t241 = t87 * t30 * t4 * t68;
  t248 = t232 * t187;
  t250 = t190 * t155 * t31;
  t254 = t87 * t155 * t31;
  t257 = -t18 * t52 * t104 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t217 * t47 - t222 * t83 / 0.3e1 - t222 * t90 / 0.9e1 - t79 * t112 / 0.8e1 + t229 * t112 / 0.8e1 + 0.2e1 / 0.27e2 * t232 * t41 * t235 + 0.2e1 / 0.81e2 * t238 * t241 - t79 * t116 / 0.24e2 + t229 * t116 / 0.24e2 + 0.2e1 / 0.243e3 * t248 * t250 + t248 * t254 / 0.243e3;
  t258 = my_piecewise3(t2, 0, t257);
  tv2rhosigma0 = 0.2e1 * rho[0] * t258 + 0.2e1 * t120;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t261 = t32 * sigma[0];
  t262 = 0.1e1 / t261;
  t267 = 0.1e1 / sigma[0];
  t272 = -t64 * t262 * t34 * t68 / 0.54e2 - t153 * t267 * t25 * t155 / 0.243e3;
  t277 = t110 * t104;
  t282 = t17 * t66;
  t283 = t282 * t174;
  t285 = t46 * t267 * t31;
  t288 = t282 * t180;
  t289 = t87 * t267;
  t290 = t289 * t183;
  t293 = t82 * t262;
  t296 = t282 * t187;
  t297 = t190 * t267;
  t298 = t297 * t193;
  t302 = t88 * t262 * t68;
  t305 = t289 * t193;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t272 * t47 + t277 * t112 / 0.4e1 + t277 * t116 / 0.12e2 - t283 * t285 / 0.36e2 - t288 * t290 / 0.108e3 - t111 * t293 / 0.16e2 - t296 * t298 / 0.324e3 - t111 * t302 / 0.48e2 - t296 * t305 / 0.648e3);
  tv2sigma20 = 0.2e1 * rho[0] * t309;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t312 = t140 * rho[0];
  t314 = 0.1e1 / t19 / t312;
  t315 = t17 * t314;
  t319 = t72 * t173;
  t323 = t140 * t22;
  t325 = 0.1e1 / t23 / t323;
  t326 = t17 * t325;
  t327 = t80 * t80;
  t328 = 0.1e1 / t327;
  t329 = t41 * t328;
  t330 = t326 * t329;
  t332 = t46 * t261 * t21;
  t335 = t315 * t180;
  t338 = t315 * t187;
  t343 = t72 * t81;
  t344 = t171 * t343;
  t347 = t72 * t45;
  t348 = t171 * t347;
  t353 = t326 * t174;
  t354 = t87 * t261;
  t355 = t21 * t68;
  t356 = t354 * t355;
  t359 = t326 * t180;
  t360 = t190 * t261;
  t361 = t21 * t155;
  t362 = t360 * t361;
  t365 = t354 * t361;
  t368 = 0.32e2 / 0.27e2 * t315 * t174 * t177 - 0.16e2 / 0.27e2 * t171 * t319 * t177 - 0.128e3 / 0.243e3 * t330 * t332 + 0.32e2 / 0.81e2 * t335 * t184 + 0.32e2 / 0.243e3 * t338 * t194 + 0.16e2 / 0.243e3 * t338 * t197 - 0.16e2 / 0.81e2 * t344 * t184 - 0.16e2 / 0.243e3 * t348 * t194 - 0.8e1 / 0.243e3 * t348 * t197 - 0.128e3 / 0.729e3 * t353 * t356 - 0.128e3 / 0.2187e4 * t359 * t362 - 0.64e2 / 0.2187e4 * t359 * t365;
  t369 = t326 * t187;
  t370 = t86 * t86;
  t371 = 0.1e1 / t370;
  t374 = 0.1e1 / t154 / t38;
  t376 = t374 * t3 * t20;
  t377 = t371 * t261 * t376;
  t380 = t360 * t376;
  t383 = t354 * t376;
  t386 = 0.1e1 / t140;
  t387 = t17 * t386;
  t388 = t387 * t41;
  t395 = t134 * t72;
  t399 = 0.1e1 / t23 / t312;
  t400 = sigma[0] * t399;
  t410 = t29 * M_PI;
  t411 = t410 * t261;
  t412 = t140 * t57;
  t413 = 0.1e1 / t412;
  t417 = -0.4928e4 / 0.2187e4 * t21 * t400 - 0.56e3 / 0.729e3 * t64 * t32 * t170 * t68 + 0.448e3 / 0.2187e4 * t153 * t400 * t155 - 0.1024e4 / 0.59049e5 * t411 * t413 * t374;
  t422 = t78 * t159;
  t438 = -0.128e3 / 0.6561e4 * t369 * t377 - 0.128e3 / 0.6561e4 * t369 * t380 - 0.128e3 / 0.19683e5 * t369 * t383 - 0.43e2 / 0.81e2 * t388 * t90 - 0.3e1 / 0.8e1 * t18 * t52 * t159 * t47 + 0.5e1 / 0.9e1 * t395 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t417 * t47 - t422 * t90 / 0.3e1 - 0.5e1 / 0.36e2 * t18 * t25 * t41 * t47 + t18 * t124 * t72 * t47 / 0.4e1 - 0.43e2 / 0.27e2 * t388 * t83 + 0.5e1 / 0.3e1 * t395 * t83 - t422 * t83;
  t440 = my_piecewise3(t2, 0, t368 + t438);
  tv3rho30 = 0.2e1 * rho[0] * t440 + 0.6e1 * t201;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t446 = t232 * t343;
  t449 = t17 * t399;
  t450 = t449 * t329;
  t452 = t20 * t32;
  t453 = t46 * t3 * t452;
  t460 = t232 * t347;
  t465 = t104 * t173;
  t469 = t104 * t81;
  t470 = t171 * t469;
  t473 = t104 * t45;
  t474 = t171 * t473;
  t479 = t449 * t174;
  t480 = t87 * t3;
  t482 = t480 * t452 * t68;
  t485 = t449 * t180;
  t488 = t20 * t155 * t32;
  t489 = t190 * t3 * t488;
  t492 = t480 * t488;
  t495 = t449 * t187;
  t497 = t21 * t32;
  t498 = t371 * t374 * t497;
  t502 = t190 * t374 * t497;
  t505 = -0.26e2 / 0.243e3 * t181 * t241 + 0.4e1 / 0.81e2 * t446 * t241 + 0.16e2 / 0.81e2 * t450 * t453 - 0.26e2 / 0.729e3 * t188 * t250 - 0.13e2 / 0.729e3 * t188 * t254 + 0.4e1 / 0.243e3 * t460 * t250 + 0.2e1 / 0.243e3 * t460 * t254 - 0.16e2 / 0.81e2 * t171 * t465 * t177 - 0.16e2 / 0.243e3 * t470 * t184 - 0.16e2 / 0.729e3 * t474 * t194 - 0.8e1 / 0.729e3 * t474 * t197 + 0.16e2 / 0.243e3 * t479 * t482 + 0.16e2 / 0.729e3 * t485 * t489 + 0.8e1 / 0.729e3 * t485 * t492 + 0.16e2 / 0.2187e4 * t495 * t498 + 0.16e2 / 0.2187e4 * t495 * t502;
  t507 = t87 * t374 * t497;
  t524 = t110 * t159;
  t531 = t134 * t104;
  t543 = 0.1e1 / t323;
  t545 = t374 * t32;
  t548 = 0.352e3 / 0.729e3 * t21 * t142 + 0.28e2 / 0.243e3 * t64 * t99 * t147 * t68 - 0.4e2 / 0.729e3 * t153 * t142 * t155 + 0.128e3 / 0.19683e5 * t410 * t543 * t545;
  t553 = t78 * t217;
  t566 = 0.16e2 / 0.6561e4 * t495 * t507 + t135 * t116 / 0.12e2 + t18 * t124 * t104 * t47 / 0.12e2 - 0.26e2 / 0.81e2 * t171 * t41 * t235 + 0.4e1 / 0.27e2 * t232 * t72 * t235 - t164 * t116 / 0.12e2 + t524 * t116 / 0.24e2 - t18 * t52 * t217 * t47 / 0.4e1 + 0.5e1 / 0.27e2 * t531 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t548 * t47 - 0.2e1 / 0.9e1 * t553 * t90 + t135 * t112 / 0.4e1 + 0.5e1 / 0.9e1 * t531 * t83 - 0.2e1 / 0.3e1 * t553 * t83 - t164 * t112 / 0.4e1 + t524 * t112 / 0.8e1;
  t568 = my_piecewise3(t2, 0, t505 + t566);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t568 + 0.4e1 * t258;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t571 = t78 * t272;
  t574 = t110 * t217;
  t579 = t232 * t469;
  t582 = t232 * t473;
  t587 = t282 * t319;
  t590 = t17 * t142;
  t591 = t590 * t329;
  t593 = t46 * t99 * t21;
  t596 = t232 * t174;
  t599 = t590 * t187;
  t600 = t190 * t99;
  t601 = t600 * t376;
  t606 = t282 * t347;
  t609 = t87 * t99;
  t610 = t609 * t376;
  t617 = -t571 * t83 / 0.3e1 + t574 * t112 / 0.4e1 - t229 * t293 / 0.16e2 + 0.4e1 / 0.81e2 * t579 * t241 + 0.4e1 / 0.243e3 * t582 * t250 + 0.2e1 / 0.243e3 * t582 * t254 - t587 * t285 / 0.36e2 - 0.2e1 / 0.27e2 * t591 * t593 + t596 * t285 / 0.36e2 - 0.2e1 / 0.729e3 * t599 * t601 + t248 * t305 / 0.648e3 - t606 * t305 / 0.648e3 - 0.2e1 / 0.2187e4 * t599 * t610 + t238 * t290 / 0.108e3 + t248 * t298 / 0.324e3;
  t618 = t590 * t174;
  t619 = t609 * t355;
  t622 = t282 * t343;
  t625 = t590 * t180;
  t626 = t600 * t361;
  t629 = t609 * t361;
  t635 = t371 * t99 * t376;
  t654 = t410 * t99;
  t655 = 0.1e1 / t312;
  t659 = 0.2e1 / 0.81e2 * t64 * t262 * t66 * t68 + 0.4e1 / 0.729e3 * t153 * t267 * t59 * t155 - 0.16e2 / 0.6561e4 * t654 * t655 * t374;
  t677 = -0.2e1 / 0.81e2 * t618 * t619 - t622 * t290 / 0.108e3 - 0.2e1 / 0.243e3 * t625 * t626 - t625 * t629 / 0.243e3 - t606 * t298 / 0.324e3 - 0.2e1 / 0.729e3 * t599 * t635 - t18 * t52 * t272 * t47 / 0.8e1 - t222 * t116 / 0.12e2 + t79 * t302 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * t659 * t47 - t571 * t90 / 0.9e1 + 0.4e1 / 0.27e2 * t232 * t104 * t235 + t574 * t116 / 0.12e2 - t229 * t302 / 0.48e2 - t222 * t112 / 0.4e1 + t79 * t293 / 0.16e2;
  t679 = my_piecewise3(t2, 0, t617 + t677);
  tv3rhosigma20 = 0.2e1 * rho[0] * t679 + 0.2e1 * t309;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t682 = t110 * t272;
  t685 = t17 * t59;
  t686 = t685 * t329;
  t688 = t46 * t262 * t21;
  t691 = sigma[0] * sigma[0];
  t693 = 0.1e1 / t32 / t691;
  t695 = t88 * t693 * t68;
  t698 = t282 * t465;
  t707 = 0.1e1 / t691;
  t713 = t386 * t374;
  t716 = t64 * t693 * t34 * t68 / 0.36e2 + t153 * t707 * t25 * t155 / 0.162e3 + 0.2e1 / 0.2187e4 * t410 * t262 * t713;
  t725 = t82 * t693;
  t728 = t87 * t707;
  t729 = t728 * t183;
  t732 = t190 * t707;
  t733 = t732 * t193;
  t736 = 0.3e1 / 0.8e1 * t682 * t112 + t686 * t688 / 0.36e2 + t111 * t695 / 0.32e2 - t698 * t285 / 0.12e2 - t277 * t302 / 0.16e2 - 0.3e1 / 0.8e1 * t18 * t19 * t716 * t47 + t682 * t116 / 0.8e1 - 0.3e1 / 0.16e2 * t277 * t293 + 0.3e1 / 0.32e2 * t111 * t725 + t288 * t729 / 0.72e2 + t296 * t733 / 0.216e3;
  t737 = t282 * t469;
  t740 = t282 * t473;
  t746 = t46 * t707 * t31;
  t749 = t685 * t174;
  t750 = t87 * t262;
  t751 = t750 * t355;
  t754 = t685 * t180;
  t755 = t190 * t262;
  t756 = t755 * t361;
  t759 = t750 * t361;
  t762 = t685 * t187;
  t764 = t371 * t262 * t376;
  t767 = t755 * t376;
  t770 = t728 * t193;
  t773 = t750 * t376;
  t776 = -t737 * t290 / 0.36e2 - t740 * t298 / 0.108e3 - t740 * t305 / 0.216e3 + t283 * t746 / 0.24e2 + t749 * t751 / 0.108e3 + t754 * t756 / 0.324e3 + t754 * t759 / 0.648e3 + t762 * t764 / 0.972e3 + t762 * t767 / 0.972e3 + t296 * t770 / 0.432e3 + t762 * t773 / 0.2916e4;
  t778 = my_piecewise3(t2, 0, t736 + t776);
  tv3sigma30 = 0.2e1 * rho[0] * t778;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t25, t29, t30, t31, t32, t34, t36, t38;
  double t39, t41, t44, t45, t46, t47, t51, tzk0;

  double t52, t57, t59, t64, t66, t68, t72, t78;
  double t79, t80, t81, t82, t83, t86, t87, t88;
  double t90, t94, tvrho0, t99, t104, t110, t111, t112;
  double t116, t120, tvsigma0;

  double t124, t134, t135, t140, t142, t143, t147, t153;
  double t154, t155, t159, t164, t170, t171, t173, t174;
  double t175, t177, t180, t181, t182, t183, t184, t187;
  double t188, t190, t193, t194, t197, t200, t201, tv2rho20;
  double t217, t222, t229, t232, t235, t238, t241, t248;
  double t250, t254, t257, t258, tv2rhosigma0, t261, t262, t267;
  double t272, t277, t282, t283, t285, t288, t289, t290;
  double t293, t296, t297, t298, t302, t305, t309, tv2sigma20;

  double t312, t314, t315, t319, t323, t325, t326, t327;
  double t328, t329, t330, t332, t335, t338, t343, t344;
  double t347, t348, t353, t354, t355, t356, t359, t360;
  double t361, t362, t365, t368, t369, t370, t371, t374;
  double t376, t377, t380, t383, t386, t387, t388, t395;
  double t399, t400, t410, t411, t412, t413, t417, t422;
  double t438, t440, tv3rho30, t446, t449, t450, t452, t453;
  double t460, t465, t469, t470, t473, t474, t479, t480;
  double t482, t485, t488, t489, t492, t495, t497, t498;
  double t502, t505, t507, t524, t531, t543, t545, t548;
  double t553, t566, t568, tv3rho2sigma0, t571, t574, t579, t582;
  double t587, t590, t591, t593, t596, t599, t600, t601;
  double t606, t609, t610, t617, t618, t619, t622, t625;
  double t626, t629, t635, t654, t655, t659, t677, t679;
  double tv3rhosigma20, t682, t685, t686, t688, t691, t693, t695;
  double t698, t707, t713, t716, t725, t728, t729, t732;
  double t733, t736, t737, t740, t746, t749, t750, t751;
  double t754, t755, t756, t759, t762, t764, t767, t770;
  double t773, t776, t778, tv3sigma30;

  double t781, t784, t787, t790, t791, t794, t795, t797;
  double t798, t799, t800, t804, t805, t806, t810, t817;
  double t819, t821, t822, t823, t835, t839, t840, t845;
  double t846, t856, t861, t868, t872, t873, t878, t881;
  double t886, t897, t905, t910, t917, t920, t937, t947;
  double t951, t969, t986, t989, tv4rho40, t993, t996, t999;
  double t1005, t1010, t1011, t1012, t1013, t1028, t1033, t1037;
  double t1041, t1051, t1063, t1065, t1075, t1077, t1102, t1113;
  double t1118, t1119, t1122, t1127, t1137, t1142, t1148, t1149;
  double t1219, t1222, tv4rho3sigma0, t1235, t1239, t1240, t1245, t1255;
  double t1260, t1265, t1273, t1274, t1301, t1306, t1310, t1314;
  double t1319, t1327, t1341, t1369, t1451, t1454, tv4rho2sigma20, t1476;
  double t1481, t1484, t1496, t1507, t1515, t1530, t1535, t1539;
  double t1547, t1558, t1572, t1579, t1580, t1587, t1591, t1652;
  double t1655, tv4rhosigma30, t1658, t1669, t1673, t1678, t1690, t1695;
  double t1709, t1710, t1711, t1726, t1729, t1733, t1746, t1757;
  double t1764, t1765, t1769, t1824, t1827, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = t10 + 0.1e1;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t4 * t4;
  t21 = t3 * t20;
  t22 = rho[0] * rho[0];
  t23 = t19 * t19;
  t25 = 0.1e1 / t23 / t22;
  t29 = M_PI * M_PI;
  t30 = t3 * t3;
  t31 = t30 * t4;
  t32 = sqrt(sigma[0]);
  t34 = 0.1e1 / t19 / rho[0];
  t36 = t31 * t32 * t34;
  t38 = 0.2e1 / 0.27e2 * t36 + 0.1e1;
  t39 = log(t38);
  t41 = 0.4e1 / 0.81e2 * t21 * sigma[0] * t25 + t29 * t39;
  t44 = 0.2e1 / 0.9e1 * t36 + t29;
  t45 = 0.1e1 / t44;
  t46 = 0.1e1 / t39;
  t47 = t45 * t46;
  t51 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t41 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t23;
  t57 = t22 * rho[0];
  t59 = 0.1e1 / t23 / t57;
  t64 = t4 * t29 * t30;
  t66 = 0.1e1 / t19 / t22;
  t68 = 0.1e1 / t38;
  t72 = -0.32e2 / 0.243e3 * t21 * sigma[0] * t59 - 0.8e1 / 0.81e2 * t64 * t32 * t66 * t68;
  t78 = t17 / t22;
  t79 = t78 * t41;
  t80 = t44 * t44;
  t81 = 0.1e1 / t80;
  t82 = t81 * t46;
  t83 = t82 * t32;
  t86 = t39 * t39;
  t87 = 0.1e1 / t86;
  t88 = t45 * t87;
  t90 = t88 * t32 * t68;
  t94 = my_piecewise3(t2, 0, -t18 * t52 * t41 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t72 * t47 - t79 * t83 / 0.3e1 - t79 * t90 / 0.9e1);
  tvrho0 = 0.2e1 * rho[0] * t94 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t99 = 0.1e1 / t32;
  t104 = 0.4e1 / 0.81e2 * t21 * t25 + t64 * t99 * t34 * t68 / 0.27e2;
  t110 = t17 / rho[0];
  t111 = t110 * t41;
  t112 = t82 * t99;
  t116 = t88 * t99 * t68;
  t120 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t104 * t47 + t111 * t112 / 0.8e1 + t111 * t116 / 0.24e2);
  tvsigma0 = 0.2e1 * rho[0] * t120;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t124 = 0.1e1 / t23 / rho[0];
  t134 = t17 / t57;
  t135 = t134 * t41;
  t140 = t22 * t22;
  t142 = 0.1e1 / t23 / t140;
  t143 = sigma[0] * t142;
  t147 = 0.1e1 / t19 / t57;
  t153 = t20 * t29 * t3;
  t154 = t38 * t38;
  t155 = 0.1e1 / t154;
  t159 = 0.352e3 / 0.729e3 * t21 * t143 + 0.56e2 / 0.243e3 * t64 * t32 * t147 * t68 - 0.64e2 / 0.2187e4 * t153 * t143 * t155;
  t164 = t78 * t72;
  t170 = 0.1e1 / t19 / t140;
  t171 = t17 * t170;
  t173 = 0.1e1 / t80 / t44;
  t174 = t41 * t173;
  t175 = t171 * t174;
  t177 = t46 * sigma[0] * t31;
  t180 = t41 * t81;
  t181 = t171 * t180;
  t182 = t87 * sigma[0];
  t183 = t31 * t68;
  t184 = t182 * t183;
  t187 = t41 * t45;
  t188 = t171 * t187;
  t190 = 0.1e1 / t86 / t39;
  t193 = t155 * t30 * t4;
  t194 = t190 * sigma[0] * t193;
  t197 = t182 * t193;
  t200 = t18 * t124 * t41 * t47 / 0.12e2 - t18 * t52 * t72 * t47 / 0.4e1 + 0.5e1 / 0.9e1 * t135 * t83 + 0.5e1 / 0.27e2 * t135 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t159 * t47 - 0.2e1 / 0.3e1 * t164 * t83 - 0.2e1 / 0.9e1 * t164 * t90 - 0.16e2 / 0.81e2 * t175 * t177 - 0.16e2 / 0.243e3 * t181 * t184 - 0.16e2 / 0.729e3 * t188 * t194 - 0.8e1 / 0.729e3 * t188 * t197;
  t201 = my_piecewise3(t2, 0, t200);
  tv2rho20 = 0.2e1 * rho[0] * t201 + 0.4e1 * t94;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t217 = -0.32e2 / 0.243e3 * t21 * t59 - 0.4e1 / 0.81e2 * t64 * t99 * t66 * t68 + 0.8e1 / 0.729e3 * t153 * t59 * t155;
  t222 = t78 * t104;
  t229 = t110 * t72;
  t232 = t17 * t147;
  t235 = t173 * t46 * t31;
  t238 = t232 * t180;
  t241 = t87 * t30 * t4 * t68;
  t248 = t232 * t187;
  t250 = t190 * t155 * t31;
  t254 = t87 * t155 * t31;
  t257 = -t18 * t52 * t104 * t47 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t217 * t47 - t222 * t83 / 0.3e1 - t222 * t90 / 0.9e1 - t79 * t112 / 0.8e1 + t229 * t112 / 0.8e1 + 0.2e1 / 0.27e2 * t232 * t41 * t235 + 0.2e1 / 0.81e2 * t238 * t241 - t79 * t116 / 0.24e2 + t229 * t116 / 0.24e2 + 0.2e1 / 0.243e3 * t248 * t250 + t248 * t254 / 0.243e3;
  t258 = my_piecewise3(t2, 0, t257);
  tv2rhosigma0 = 0.2e1 * rho[0] * t258 + 0.2e1 * t120;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t261 = t32 * sigma[0];
  t262 = 0.1e1 / t261;
  t267 = 0.1e1 / sigma[0];
  t272 = -t64 * t262 * t34 * t68 / 0.54e2 - t153 * t267 * t25 * t155 / 0.243e3;
  t277 = t110 * t104;
  t282 = t17 * t66;
  t283 = t282 * t174;
  t285 = t46 * t267 * t31;
  t288 = t282 * t180;
  t289 = t87 * t267;
  t290 = t289 * t183;
  t293 = t82 * t262;
  t296 = t282 * t187;
  t297 = t190 * t267;
  t298 = t297 * t193;
  t302 = t88 * t262 * t68;
  t305 = t289 * t193;
  t309 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t272 * t47 + t277 * t112 / 0.4e1 + t277 * t116 / 0.12e2 - t283 * t285 / 0.36e2 - t288 * t290 / 0.108e3 - t111 * t293 / 0.16e2 - t296 * t298 / 0.324e3 - t111 * t302 / 0.48e2 - t296 * t305 / 0.648e3);
  tv2sigma20 = 0.2e1 * rho[0] * t309;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t312 = t140 * rho[0];
  t314 = 0.1e1 / t19 / t312;
  t315 = t17 * t314;
  t319 = t72 * t173;
  t323 = t140 * t22;
  t325 = 0.1e1 / t23 / t323;
  t326 = t17 * t325;
  t327 = t80 * t80;
  t328 = 0.1e1 / t327;
  t329 = t41 * t328;
  t330 = t326 * t329;
  t332 = t46 * t261 * t21;
  t335 = t315 * t180;
  t338 = t315 * t187;
  t343 = t72 * t81;
  t344 = t171 * t343;
  t347 = t72 * t45;
  t348 = t171 * t347;
  t353 = t326 * t174;
  t354 = t87 * t261;
  t355 = t21 * t68;
  t356 = t354 * t355;
  t359 = t326 * t180;
  t360 = t190 * t261;
  t361 = t21 * t155;
  t362 = t360 * t361;
  t365 = t354 * t361;
  t368 = 0.32e2 / 0.27e2 * t315 * t174 * t177 - 0.16e2 / 0.27e2 * t171 * t319 * t177 - 0.128e3 / 0.243e3 * t330 * t332 + 0.32e2 / 0.81e2 * t335 * t184 + 0.32e2 / 0.243e3 * t338 * t194 + 0.16e2 / 0.243e3 * t338 * t197 - 0.16e2 / 0.81e2 * t344 * t184 - 0.16e2 / 0.243e3 * t348 * t194 - 0.8e1 / 0.243e3 * t348 * t197 - 0.128e3 / 0.729e3 * t353 * t356 - 0.128e3 / 0.2187e4 * t359 * t362 - 0.64e2 / 0.2187e4 * t359 * t365;
  t369 = t326 * t187;
  t370 = t86 * t86;
  t371 = 0.1e1 / t370;
  t374 = 0.1e1 / t154 / t38;
  t376 = t374 * t3 * t20;
  t377 = t371 * t261 * t376;
  t380 = t360 * t376;
  t383 = t354 * t376;
  t386 = 0.1e1 / t140;
  t387 = t17 * t386;
  t388 = t387 * t41;
  t395 = t134 * t72;
  t399 = 0.1e1 / t23 / t312;
  t400 = sigma[0] * t399;
  t410 = t29 * M_PI;
  t411 = t410 * t261;
  t412 = t140 * t57;
  t413 = 0.1e1 / t412;
  t417 = -0.4928e4 / 0.2187e4 * t21 * t400 - 0.56e3 / 0.729e3 * t64 * t32 * t170 * t68 + 0.448e3 / 0.2187e4 * t153 * t400 * t155 - 0.1024e4 / 0.59049e5 * t411 * t413 * t374;
  t422 = t78 * t159;
  t438 = -0.128e3 / 0.6561e4 * t369 * t377 - 0.128e3 / 0.6561e4 * t369 * t380 - 0.128e3 / 0.19683e5 * t369 * t383 - 0.43e2 / 0.81e2 * t388 * t90 - 0.3e1 / 0.8e1 * t18 * t52 * t159 * t47 + 0.5e1 / 0.9e1 * t395 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t417 * t47 - t422 * t90 / 0.3e1 - 0.5e1 / 0.36e2 * t18 * t25 * t41 * t47 + t18 * t124 * t72 * t47 / 0.4e1 - 0.43e2 / 0.27e2 * t388 * t83 + 0.5e1 / 0.3e1 * t395 * t83 - t422 * t83;
  t440 = my_piecewise3(t2, 0, t368 + t438);
  tv3rho30 = 0.2e1 * rho[0] * t440 + 0.6e1 * t201;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t446 = t232 * t343;
  t449 = t17 * t399;
  t450 = t449 * t329;
  t452 = t20 * t32;
  t453 = t46 * t3 * t452;
  t460 = t232 * t347;
  t465 = t104 * t173;
  t469 = t104 * t81;
  t470 = t171 * t469;
  t473 = t104 * t45;
  t474 = t171 * t473;
  t479 = t449 * t174;
  t480 = t87 * t3;
  t482 = t480 * t452 * t68;
  t485 = t449 * t180;
  t488 = t20 * t155 * t32;
  t489 = t190 * t3 * t488;
  t492 = t480 * t488;
  t495 = t449 * t187;
  t497 = t21 * t32;
  t498 = t371 * t374 * t497;
  t502 = t190 * t374 * t497;
  t505 = -0.26e2 / 0.243e3 * t181 * t241 + 0.4e1 / 0.81e2 * t446 * t241 + 0.16e2 / 0.81e2 * t450 * t453 - 0.26e2 / 0.729e3 * t188 * t250 - 0.13e2 / 0.729e3 * t188 * t254 + 0.4e1 / 0.243e3 * t460 * t250 + 0.2e1 / 0.243e3 * t460 * t254 - 0.16e2 / 0.81e2 * t171 * t465 * t177 - 0.16e2 / 0.243e3 * t470 * t184 - 0.16e2 / 0.729e3 * t474 * t194 - 0.8e1 / 0.729e3 * t474 * t197 + 0.16e2 / 0.243e3 * t479 * t482 + 0.16e2 / 0.729e3 * t485 * t489 + 0.8e1 / 0.729e3 * t485 * t492 + 0.16e2 / 0.2187e4 * t495 * t498 + 0.16e2 / 0.2187e4 * t495 * t502;
  t507 = t87 * t374 * t497;
  t524 = t110 * t159;
  t531 = t134 * t104;
  t543 = 0.1e1 / t323;
  t545 = t374 * t32;
  t548 = 0.352e3 / 0.729e3 * t21 * t142 + 0.28e2 / 0.243e3 * t64 * t99 * t147 * t68 - 0.4e2 / 0.729e3 * t153 * t142 * t155 + 0.128e3 / 0.19683e5 * t410 * t543 * t545;
  t553 = t78 * t217;
  t566 = 0.16e2 / 0.6561e4 * t495 * t507 + t135 * t116 / 0.12e2 + t18 * t124 * t104 * t47 / 0.12e2 - 0.26e2 / 0.81e2 * t171 * t41 * t235 + 0.4e1 / 0.27e2 * t232 * t72 * t235 - t164 * t116 / 0.12e2 + t524 * t116 / 0.24e2 - t18 * t52 * t217 * t47 / 0.4e1 + 0.5e1 / 0.27e2 * t531 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * t548 * t47 - 0.2e1 / 0.9e1 * t553 * t90 + t135 * t112 / 0.4e1 + 0.5e1 / 0.9e1 * t531 * t83 - 0.2e1 / 0.3e1 * t553 * t83 - t164 * t112 / 0.4e1 + t524 * t112 / 0.8e1;
  t568 = my_piecewise3(t2, 0, t505 + t566);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t568 + 0.4e1 * t258;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t571 = t78 * t272;
  t574 = t110 * t217;
  t579 = t232 * t469;
  t582 = t232 * t473;
  t587 = t282 * t319;
  t590 = t17 * t142;
  t591 = t590 * t329;
  t593 = t46 * t99 * t21;
  t596 = t232 * t174;
  t599 = t590 * t187;
  t600 = t190 * t99;
  t601 = t600 * t376;
  t606 = t282 * t347;
  t609 = t87 * t99;
  t610 = t609 * t376;
  t617 = -t571 * t83 / 0.3e1 + t574 * t112 / 0.4e1 - t229 * t293 / 0.16e2 + 0.4e1 / 0.81e2 * t579 * t241 + 0.4e1 / 0.243e3 * t582 * t250 + 0.2e1 / 0.243e3 * t582 * t254 - t587 * t285 / 0.36e2 - 0.2e1 / 0.27e2 * t591 * t593 + t596 * t285 / 0.36e2 - 0.2e1 / 0.729e3 * t599 * t601 + t248 * t305 / 0.648e3 - t606 * t305 / 0.648e3 - 0.2e1 / 0.2187e4 * t599 * t610 + t238 * t290 / 0.108e3 + t248 * t298 / 0.324e3;
  t618 = t590 * t174;
  t619 = t609 * t355;
  t622 = t282 * t343;
  t625 = t590 * t180;
  t626 = t600 * t361;
  t629 = t609 * t361;
  t635 = t371 * t99 * t376;
  t654 = t410 * t99;
  t655 = 0.1e1 / t312;
  t659 = 0.2e1 / 0.81e2 * t64 * t262 * t66 * t68 + 0.4e1 / 0.729e3 * t153 * t267 * t59 * t155 - 0.16e2 / 0.6561e4 * t654 * t655 * t374;
  t677 = -0.2e1 / 0.81e2 * t618 * t619 - t622 * t290 / 0.108e3 - 0.2e1 / 0.243e3 * t625 * t626 - t625 * t629 / 0.243e3 - t606 * t298 / 0.324e3 - 0.2e1 / 0.729e3 * t599 * t635 - t18 * t52 * t272 * t47 / 0.8e1 - t222 * t116 / 0.12e2 + t79 * t302 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * t659 * t47 - t571 * t90 / 0.9e1 + 0.4e1 / 0.27e2 * t232 * t104 * t235 + t574 * t116 / 0.12e2 - t229 * t302 / 0.48e2 - t222 * t112 / 0.4e1 + t79 * t293 / 0.16e2;
  t679 = my_piecewise3(t2, 0, t617 + t677);
  tv3rhosigma20 = 0.2e1 * rho[0] * t679 + 0.2e1 * t309;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t682 = t110 * t272;
  t685 = t17 * t59;
  t686 = t685 * t329;
  t688 = t46 * t262 * t21;
  t691 = sigma[0] * sigma[0];
  t693 = 0.1e1 / t32 / t691;
  t695 = t88 * t693 * t68;
  t698 = t282 * t465;
  t707 = 0.1e1 / t691;
  t713 = t386 * t374;
  t716 = t64 * t693 * t34 * t68 / 0.36e2 + t153 * t707 * t25 * t155 / 0.162e3 + 0.2e1 / 0.2187e4 * t410 * t262 * t713;
  t725 = t82 * t693;
  t728 = t87 * t707;
  t729 = t728 * t183;
  t732 = t190 * t707;
  t733 = t732 * t193;
  t736 = 0.3e1 / 0.8e1 * t682 * t112 + t686 * t688 / 0.36e2 + t111 * t695 / 0.32e2 - t698 * t285 / 0.12e2 - t277 * t302 / 0.16e2 - 0.3e1 / 0.8e1 * t18 * t19 * t716 * t47 + t682 * t116 / 0.8e1 - 0.3e1 / 0.16e2 * t277 * t293 + 0.3e1 / 0.32e2 * t111 * t725 + t288 * t729 / 0.72e2 + t296 * t733 / 0.216e3;
  t737 = t282 * t469;
  t740 = t282 * t473;
  t746 = t46 * t707 * t31;
  t749 = t685 * t174;
  t750 = t87 * t262;
  t751 = t750 * t355;
  t754 = t685 * t180;
  t755 = t190 * t262;
  t756 = t755 * t361;
  t759 = t750 * t361;
  t762 = t685 * t187;
  t764 = t371 * t262 * t376;
  t767 = t755 * t376;
  t770 = t728 * t193;
  t773 = t750 * t376;
  t776 = -t737 * t290 / 0.36e2 - t740 * t298 / 0.108e3 - t740 * t305 / 0.216e3 + t283 * t746 / 0.24e2 + t749 * t751 / 0.108e3 + t754 * t756 / 0.324e3 + t754 * t759 / 0.648e3 + t762 * t764 / 0.972e3 + t762 * t767 / 0.972e3 + t296 * t770 / 0.432e3 + t762 * t773 / 0.2916e4;
  t778 = my_piecewise3(t2, 0, t736 + t776);
  tv3sigma30 = 0.2e1 * rho[0] * t778;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t781 = t387 * t72;
  t784 = t134 * t159;
  t787 = t78 * t417;
  t790 = t17 * t655;
  t791 = t790 * t41;
  t794 = t140 * t140;
  t795 = t794 * rho[0];
  t797 = t17 / t795;
  t798 = t797 * t174;
  t799 = t87 * t691;
  t800 = M_PI * t155;
  t804 = t797 * t180;
  t805 = t371 * t691;
  t806 = M_PI * t374;
  t810 = t190 * t691;
  t817 = t797 * t187;
  t819 = 0.1e1 / t370 / t39;
  t821 = t154 * t154;
  t822 = 0.1e1 / t821;
  t823 = t822 * M_PI;
  t835 = t17 / t23 / t412;
  t839 = -0.172e3 / 0.27e2 * t781 * t83 + 0.1e2 / 0.3e1 * t784 * t83 - 0.4e1 / 0.3e1 * t787 * t83 + 0.506e3 / 0.81e2 * t791 * t83 - 0.2048e4 / 0.19683e5 * t798 * t799 * t800 - 0.4096e4 / 0.59049e5 * t804 * t805 * t806 - 0.4096e4 / 0.59049e5 * t804 * t810 * t806 - 0.4096e4 / 0.177147e6 * t804 * t799 * t806 - 0.4096e4 / 0.177147e6 * t817 * t819 * t691 * t823 - 0.2048e4 / 0.59049e5 * t817 * t805 * t823 + 0.128e3 / 0.27e2 * t315 * t319 * t177 + 0.4864e4 / 0.729e3 * t835 * t329 * t332;
  t840 = t159 * t173;
  t845 = 0.1e1 / t19 / t323;
  t846 = t17 * t845;
  t856 = t72 * t328;
  t861 = M_PI * t68;
  t868 = t159 * t81;
  t872 = t159 * t45;
  t873 = t171 * t872;
  t878 = t835 * t187;
  t881 = t326 * t343;
  t886 = -0.32e2 / 0.27e2 * t171 * t840 * t177 - 0.5296e4 / 0.729e3 * t846 * t174 * t177 - 0.11264e5 / 0.531441e6 * t817 * t810 * t823 - 0.1024e4 / 0.177147e6 * t817 * t799 * t823 - 0.512e3 / 0.243e3 * t326 * t856 * t332 - 0.4096e4 / 0.6561e4 * t797 * t329 * t799 * t861 - 0.4096e4 / 0.19683e5 * t798 * t810 * t800 - 0.32e2 / 0.81e2 * t171 * t868 * t184 - 0.32e2 / 0.243e3 * t873 * t194 - 0.16e2 / 0.243e3 * t873 * t197 + 0.4864e4 / 0.59049e5 * t878 * t383 - 0.512e3 / 0.2187e4 * t881 * t362 - 0.256e3 / 0.2187e4 * t881 * t365;
  t897 = t846 * t187;
  t905 = t315 * t347;
  t910 = t326 * t347;
  t917 = t835 * t180;
  t920 = 0.4864e4 / 0.2187e4 * t835 * t174 * t356 - 0.512e3 / 0.729e3 * t326 * t319 * t356 - 0.5296e4 / 0.2187e4 * t846 * t180 * t184 - 0.5296e4 / 0.6561e4 * t897 * t194 - 0.2648e4 / 0.6561e4 * t897 * t197 + 0.128e3 / 0.81e2 * t315 * t343 * t184 + 0.128e3 / 0.243e3 * t905 * t194 + 0.64e2 / 0.243e3 * t905 * t197 - 0.512e3 / 0.6561e4 * t910 * t377 - 0.512e3 / 0.6561e4 * t910 * t380 - 0.512e3 / 0.19683e5 * t910 * t383 + 0.4864e4 / 0.6561e4 * t917 * t362;
  t937 = sigma[0] * t325;
  t947 = 0.1e1 / t794;
  t951 = t4 * t410;
  t969 = 0.1e1 / t327 / t44 * t46;
  t986 = 0.2432e4 / 0.6561e4 * t917 * t365 + 0.4864e4 / 0.19683e5 * t878 * t377 + 0.4864e4 / 0.19683e5 * t878 * t380 + 0.1e2 / 0.27e2 * t18 * t59 * t41 * t47 - 0.5e1 / 0.9e1 * t18 * t25 * t72 * t47 + 0.506e3 / 0.243e3 * t791 * t90 - 0.3e1 / 0.8e1 * t18 * t19 * (0.83776e5 / 0.6561e4 * t21 * t937 + 0.728e4 / 0.2187e4 * t64 * t32 * t314 * t68 - 0.27328e5 / 0.19683e5 * t153 * t937 * t155 + 0.14336e5 / 0.59049e5 * t411 * t947 * t374 - 0.8192e4 / 0.1594323e7 * t951 * t691 / t19 / t795 * t822 * t30) * t47 - 0.4e1 / 0.9e1 * t787 * t90 - 0.4096e4 / 0.2187e4 * t797 * t41 * t969 * t691 * M_PI + t18 * t124 * t159 * t47 / 0.2e1 - 0.172e3 / 0.81e2 * t781 * t90 - t18 * t52 * t417 * t47 / 0.2e1 + 0.1e2 / 0.9e1 * t784 * t90;
  t989 = my_piecewise3(t2, 0, t839 + t886 + t920 + t986);
  tv4rho40 = 0.2e1 * rho[0] * t989 + 0.8e1 * t440;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t993 = t387 * t104;
  t996 = t134 * t217;
  t999 = t78 * t548;
  t1005 = t110 * t417;
  t1010 = t17 * t947;
  t1011 = t1010 * t174;
  t1012 = t190 * M_PI;
  t1013 = sigma[0] * t155;
  t1028 = t232 * t872;
  t1033 = t217 * t173;
  t1037 = t104 * t328;
  t1041 = -0.43e2 / 0.27e2 * t993 * t83 + 0.5e1 / 0.3e1 * t996 * t83 - t999 * t83 + 0.3e1 / 0.4e1 * t395 * t112 - 0.3e1 / 0.8e1 * t422 * t112 + t1005 * t112 / 0.8e1 - 0.3e1 / 0.4e1 * t388 * t112 + 0.512e3 / 0.6561e4 * t1011 * t1012 * t1013 + 0.32e2 / 0.27e2 * t315 * t465 * t177 + 0.374e3 / 0.729e3 * t335 * t241 - 0.16e3 / 0.81e2 * t330 * t453 - 0.26e2 / 0.243e3 * t348 * t250 - 0.13e2 / 0.243e3 * t348 * t254 + 0.2e1 / 0.81e2 * t1028 * t250 + t1028 * t254 / 0.81e2 - 0.16e2 / 0.27e2 * t171 * t1033 * t177 - 0.128e3 / 0.243e3 * t326 * t1037 * t332;
  t1051 = t87 * M_PI;
  t1063 = t1010 * t180;
  t1065 = t374 * sigma[0];
  t1075 = t1010 * t187;
  t1077 = M_PI * sigma[0];
  t1102 = -0.26e2 / 0.81e2 * t344 * t241 + 0.2e1 / 0.27e2 * t232 * t868 * t241 + 0.16e2 / 0.27e2 * t449 * t856 * t453 + 0.512e3 / 0.2187e4 * t1010 * t329 * t1051 * sigma[0] * t68 + 0.374e3 / 0.2187e4 * t338 * t250 + 0.187e3 / 0.2187e4 * t338 * t254 + 0.256e3 / 0.6561e4 * t1011 * t1051 * t1013 + 0.512e3 / 0.19683e5 * t1063 * t371 * M_PI * t1065 + 0.512e3 / 0.19683e5 * t1063 * t1012 * t1065 + 0.512e3 / 0.59049e5 * t1063 * t1051 * t1065 + 0.512e3 / 0.59049e5 * t1075 * t819 * t822 * t1077 + 0.256e3 / 0.19683e5 * t1075 * t371 * t822 * t1077 + 0.1408e4 / 0.177147e6 * t1075 * t190 * t822 * t1077 + 0.128e3 / 0.59049e5 * t1075 * t87 * t822 * t1077 - 0.128e3 / 0.729e3 * t326 * t465 * t356 - 0.16e3 / 0.2187e4 * t369 * t498 - 0.16e3 / 0.2187e4 * t369 * t502 - 0.16e3 / 0.6561e4 * t369 * t507;
  t1113 = t449 * t343;
  t1118 = t217 * t45;
  t1119 = t171 * t1118;
  t1122 = t326 * t469;
  t1127 = t326 * t473;
  t1137 = t315 * t473;
  t1142 = t217 * t81;
  t1148 = -0.16e3 / 0.243e3 * t353 * t482 - 0.16e3 / 0.729e3 * t359 * t489 - 0.8e2 / 0.729e3 * t359 * t492 + 0.16e2 / 0.81e2 * t449 * t319 * t482 + 0.16e2 / 0.243e3 * t1113 * t489 + 0.8e1 / 0.243e3 * t1113 * t492 - 0.8e1 / 0.243e3 * t1119 * t197 - 0.128e3 / 0.2187e4 * t1122 * t362 - 0.64e2 / 0.2187e4 * t1122 * t365 - 0.128e3 / 0.6561e4 * t1127 * t377 - 0.128e3 / 0.6561e4 * t1127 * t380 - 0.128e3 / 0.19683e5 * t1127 * t383 + 0.32e2 / 0.81e2 * t315 * t469 * t184 + 0.32e2 / 0.243e3 * t1137 * t194 + 0.16e2 / 0.243e3 * t1137 * t197 - 0.16e2 / 0.81e2 * t171 * t1142 * t184 - 0.16e2 / 0.243e3 * t1119 * t194;
  t1149 = t449 * t347;
  t1219 = 0.16e2 / 0.729e3 * t1149 * t498 + 0.16e2 / 0.729e3 * t1149 * t502 + 0.16e2 / 0.2187e4 * t1149 * t507 - t999 * t90 / 0.3e1 + 0.512e3 / 0.729e3 * t1010 * t41 * t969 * t1077 + t395 * t116 / 0.4e1 + t18 * t124 * t217 * t47 / 0.4e1 - 0.43e2 / 0.81e2 * t993 * t90 - 0.26e2 / 0.27e2 * t171 * t72 * t235 + 0.2e1 / 0.9e1 * t232 * t159 * t235 - t422 * t116 / 0.8e1 + t1005 * t116 / 0.24e2 - 0.3e1 / 0.8e1 * t18 * t52 * t548 * t47 + 0.5e1 / 0.9e1 * t996 * t90 - 0.5e1 / 0.36e2 * t18 * t25 * t104 * t47 + 0.374e3 / 0.243e3 * t315 * t41 * t235 - t388 * t116 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t19 * (-0.4928e4 / 0.2187e4 * t21 * t399 - 0.28e3 / 0.729e3 * t64 * t99 * t170 * t68 + 0.1904e4 / 0.6561e4 * t153 * t399 * t155 - 0.1408e4 / 0.19683e5 * t410 * t413 * t545 + 0.1024e4 / 0.531441e6 * t951 / t19 / t794 * t822 * sigma[0] * t30) * t47;
  t1222 = my_piecewise3(t2, 0, t1041 + t1102 + t1148 + t1219);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1222 + 0.6e1 * t568;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1235 = t272 * t81;
  t1239 = t272 * t45;
  t1240 = t171 * t1239;
  t1245 = t449 * t473;
  t1255 = t449 * t469;
  t1260 = t590 * t347;
  t1265 = t282 * t872;
  t1273 = -0.4e1 / 0.81e2 * t590 * t319 * t619 - t181 * t290 / 0.54e2 - t188 * t298 / 0.162e3 - t188 * t305 / 0.324e3 - 0.16e2 / 0.243e3 * t171 * t1235 * t184 - 0.16e2 / 0.729e3 * t1240 * t194 - 0.8e1 / 0.729e3 * t1240 * t197 + 0.32e2 / 0.2187e4 * t1245 * t498 + 0.32e2 / 0.2187e4 * t1245 * t502 + 0.32e2 / 0.6561e4 * t1245 * t507 + 0.32e2 / 0.243e3 * t449 * t465 * t482 + 0.32e2 / 0.729e3 * t1255 * t489 + 0.16e2 / 0.729e3 * t1255 * t492 - 0.4e1 / 0.729e3 * t1260 * t601 + 0.34e2 / 0.6561e4 * t495 * t610 - t1265 * t305 / 0.648e3 - 0.4e1 / 0.2187e4 * t1260 * t610 - t282 * t868 * t290 / 0.108e3;
  t1274 = t590 * t343;
  t1301 = t110 * t548;
  t1306 = t134 * t272;
  t1310 = t17 * t413 * t41;
  t1314 = t78 * t659;
  t1319 = -0.4e1 / 0.243e3 * t1274 * t626 - 0.2e1 / 0.243e3 * t1274 * t629 - t1265 * t298 / 0.324e3 - 0.4e1 / 0.729e3 * t1260 * t635 + t446 * t290 / 0.54e2 + t460 * t298 / 0.162e3 + t460 * t305 / 0.324e3 + 0.34e2 / 0.243e3 * t479 * t619 + 0.34e2 / 0.729e3 * t485 * t626 + 0.17e2 / 0.729e3 * t485 * t629 + 0.34e2 / 0.2187e4 * t495 * t635 + 0.34e2 / 0.2187e4 * t495 * t601 - t135 * t293 / 0.8e1 + t1301 * t112 / 0.4e1 - t524 * t293 / 0.16e2 + 0.5e1 / 0.9e1 * t1306 * t83 - 0.64e2 / 0.243e3 * t1310 * t969 * M_PI - 0.2e1 / 0.3e1 * t1314 * t83 - t553 * t112 / 0.2e1;
  t1327 = t272 * t173;
  t1341 = t232 * t1118;
  t1369 = t164 * t293 / 0.8e1 + t531 * t112 / 0.2e1 - t175 * t285 / 0.18e2 - 0.16e2 / 0.81e2 * t171 * t1327 * t177 + 0.32e2 / 0.81e2 * t449 * t1037 * t453 + 0.8e1 / 0.81e2 * t232 * t1142 * t241 - 0.52e2 / 0.729e3 * t474 * t250 - 0.26e2 / 0.729e3 * t474 * t254 + 0.8e1 / 0.243e3 * t1341 * t250 + 0.4e1 / 0.243e3 * t1341 * t254 - t282 * t840 * t285 / 0.36e2 - 0.4e1 / 0.27e2 * t590 * t856 * t593 + 0.34e2 / 0.81e2 * t450 * t593 + t232 * t319 * t285 / 0.18e2 - 0.52e2 / 0.243e3 * t470 * t241 - 0.52e2 / 0.81e2 * t171 * t104 * t235 + 0.8e1 / 0.27e2 * t232 * t217 * t235 + t1301 * t116 / 0.12e2 - t524 * t302 / 0.48e2;
  t1451 = -t18 * t52 * t659 * t47 / 0.4e1 + 0.5e1 / 0.27e2 * t1306 * t90 - t553 * t116 / 0.6e1 - 0.64e2 / 0.729e3 * t1310 * t328 * t87 * t861 - t135 * t302 / 0.24e2 + t18 * t124 * t272 * t47 / 0.12e2 + t531 * t116 / 0.6e1 - 0.64e2 / 0.2187e4 * t1310 * t173 * t190 * t800 - 0.32e2 / 0.2187e4 * t1310 * t173 * t87 * t800 - 0.64e2 / 0.6561e4 * t1310 * t81 * t371 * t806 - 0.64e2 / 0.6561e4 * t1310 * t81 * t190 * t806 - 0.64e2 / 0.19683e5 * t1310 * t81 * t87 * t806 - 0.64e2 / 0.19683e5 * t1310 * t45 * t819 * t823 - 0.32e2 / 0.6561e4 * t1310 * t45 * t371 * t823 - 0.176e3 / 0.59049e5 * t1310 * t45 * t190 * t823 - 0.16e2 / 0.19683e5 * t1310 * t88 * t823 + t164 * t302 / 0.24e2 - 0.3e1 / 0.8e1 * t18 * t19 * (-0.14e2 / 0.243e3 * t64 * t262 * t147 * t68 - 0.28e2 / 0.2187e4 * t153 * t267 * t142 * t155 + 0.304e3 / 0.19683e5 * t654 * t543 * t374 - 0.128e3 / 0.177147e6 * t951 / t19 / t412 * t822 * t30) * t47 - 0.2e1 / 0.9e1 * t1314 * t90;
  t1454 = my_piecewise3(t2, 0, t1273 + t1319 + t1369 + t1451);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1454 + 0.4e1 * t679;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1476 = t590 * t469;
  t1481 = t282 * t1118;
  t1484 = t590 * t473;
  t1496 = -t238 * t729 / 0.72e2 - t248 * t733 / 0.216e3 + t618 * t751 / 0.324e3 + t625 * t756 / 0.972e3 + t625 * t759 / 0.1944e4 + t606 * t733 / 0.216e3 + t599 * t764 / 0.2916e4 + t599 * t767 / 0.2916e4 - t282 * t1142 * t290 / 0.36e2 - 0.2e1 / 0.81e2 * t1476 * t626 - t1476 * t629 / 0.81e2 - t1481 * t298 / 0.108e3 - 0.2e1 / 0.243e3 * t1484 * t635 - 0.2e1 / 0.243e3 * t1484 * t601 - t1481 * t305 / 0.216e3 - t248 * t770 / 0.432e3 - 0.2e1 / 0.27e2 * t590 * t465 * t619;
  t1507 = t685 * t347;
  t1515 = t685 * t343;
  t1530 = t78 * t716;
  t1535 = t579 * t290 / 0.36e2 + t582 * t298 / 0.108e3 + t582 * t305 / 0.216e3 + t606 * t770 / 0.432e3 + t599 * t773 / 0.8748e4 + t1507 * t773 / 0.2916e4 - 0.2e1 / 0.729e3 * t1484 * t610 + t685 * t319 * t751 / 0.108e3 + t1515 * t756 / 0.324e3 + t1515 * t759 / 0.648e3 + t1507 * t764 / 0.972e3 + t1507 * t767 / 0.972e3 + t622 * t729 / 0.72e2 + 0.3e1 / 0.16e2 * t222 * t293 - 0.3e1 / 0.32e2 * t79 * t725 - t1530 * t83 / 0.3e1 - 0.3e1 / 0.16e2 * t574 * t293;
  t1539 = t110 * t659;
  t1547 = t232 * t1239;
  t1558 = t17 * t543;
  t1572 = t1558 * t174;
  t1579 = t1558 * t180;
  t1580 = t371 * t267;
  t1587 = 0.3e1 / 0.32e2 * t229 * t725 + 0.3e1 / 0.8e1 * t1539 * t112 - 0.3e1 / 0.8e1 * t571 * t112 - 0.2e1 / 0.9e1 * t590 * t1037 * t593 + 0.2e1 / 0.81e2 * t1547 * t250 + t1547 * t254 / 0.81e2 + 0.2e1 / 0.27e2 * t232 * t1235 * t241 + t685 * t856 * t688 / 0.36e2 + 0.8e1 / 0.243e3 * t1558 * t329 * t289 * t861 + t591 * t688 / 0.108e3 + t232 * t465 * t285 / 0.12e2 - t596 * t746 / 0.24e2 + t587 * t746 / 0.24e2 + 0.8e1 / 0.729e3 * t1572 * t297 * t800 + 0.4e1 / 0.729e3 * t1572 * t289 * t800 + 0.8e1 / 0.2187e4 * t1579 * t1580 * t806 + 0.8e1 / 0.2187e4 * t1579 * t297 * t806;
  t1591 = t1558 * t187;
  t1652 = 0.8e1 / 0.6561e4 * t1579 * t289 * t806 + 0.8e1 / 0.6561e4 * t1591 * t819 * t267 * t823 + 0.4e1 / 0.2187e4 * t1591 * t1580 * t823 + 0.22e2 / 0.19683e5 * t1591 * t297 * t823 + 0.2e1 / 0.6561e4 * t1591 * t289 * t823 - t282 * t1033 * t285 / 0.12e2 + 0.2e1 / 0.9e1 * t232 * t272 * t235 + 0.8e1 / 0.81e2 * t1558 * t41 * t969 * t267 * M_PI + t229 * t695 / 0.32e2 - t574 * t302 / 0.16e2 - 0.3e1 / 0.8e1 * t18 * t19 * (-t64 * t693 * t66 * t68 / 0.27e2 - 0.2e1 / 0.243e3 * t153 * t707 * t59 * t155 + 0.16e2 / 0.59049e5 * t951 * t267 * t845 * t822 * t30) * t47 - t1530 * t90 / 0.9e1 + t1539 * t116 / 0.8e1 + t222 * t302 / 0.16e2 - t18 * t52 * t716 * t47 / 0.8e1 - t571 * t116 / 0.8e1 - t79 * t695 / 0.32e2;
  t1655 = my_piecewise3(t2, 0, t1496 + t1535 + t1587 + t1652);
  tv4rhosigma30 = 0.2e1 * rho[0] * t1655 + 0.2e1 * t778;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1658 = t87 * t693;
  t1669 = t190 * t693;
  t1673 = t685 * t469;
  t1678 = t685 * t473;
  t1690 = -t762 * t1658 * t376 / 0.972e3 - t754 * t1658 * t361 / 0.216e3 - t762 * t371 * t693 * t376 / 0.324e3 - t762 * t1669 * t376 / 0.324e3 + t1673 * t756 / 0.81e2 + t1673 * t759 / 0.162e3 + t1678 * t764 / 0.243e3 + t1678 * t767 / 0.243e3 + t1678 * t773 / 0.729e3 + t685 * t465 * t751 / 0.27e2 + t737 * t729 / 0.18e2;
  t1695 = t282 * t1239;
  t1709 = t691 * sigma[0];
  t1710 = 0.1e1 / t1709;
  t1711 = t87 * t1710;
  t1726 = t740 * t733 / 0.54e2 + t740 * t770 / 0.108e3 - t1695 * t298 / 0.54e2 - t1695 * t305 / 0.108e3 - t749 * t1658 * t355 / 0.36e2 - t754 * t1669 * t361 / 0.108e3 - t282 * t1235 * t290 / 0.18e2 - 0.5e1 / 0.144e3 * t288 * t1711 * t183 - 0.5e1 / 0.432e3 * t296 * t190 * t1710 * t193 - 0.5e1 / 0.864e3 * t296 * t1711 * t193 - 0.3e1 / 0.8e1 * t682 * t293 + 0.3e1 / 0.8e1 * t277 * t725;
  t1729 = 0.1e1 / t32 / t1709;
  t1733 = t110 * t716;
  t1746 = t790 * t187;
  t1757 = t790 * t174;
  t1764 = t790 * t180;
  t1765 = t371 * t707;
  t1769 = -0.15e2 / 0.64e2 * t111 * t82 * t1729 + t1733 * t112 / 0.2e1 - t790 * t329 * t728 * t861 / 0.81e2 - t686 * t46 * t693 * t21 / 0.12e2 + t698 * t746 / 0.6e1 - 0.11e2 / 0.26244e5 * t1746 * t732 * t823 - t1746 * t728 * t823 / 0.8748e4 - 0.5e1 / 0.48e2 * t283 * t46 * t1710 * t31 - t1757 * t732 * t800 / 0.243e3 - t1757 * t728 * t800 / 0.486e3 - t1764 * t1765 * t806 / 0.729e3;
  t1824 = -t1764 * t732 * t806 / 0.729e3 - t1764 * t728 * t806 / 0.2187e4 - t1746 * t819 * t707 * t823 / 0.2187e4 - t1746 * t1765 * t823 / 0.1458e4 - t282 * t1327 * t285 / 0.6e1 + t685 * t1037 * t688 / 0.9e1 + t1733 * t116 / 0.6e1 - 0.5e1 / 0.64e2 * t111 * t88 * t1729 * t68 - t791 * t969 * t707 * M_PI / 0.27e2 + t277 * t695 / 0.8e1 - t682 * t302 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * (-0.5e1 / 0.72e2 * t64 * t1729 * t34 * t68 - 0.5e1 / 0.324e3 * t153 * t1710 * t25 * t155 - 0.2e1 / 0.729e3 * t410 * t693 * t713 - 0.2e1 / 0.19683e5 * t951 * t707 * t314 * t822 * t30) * t47;
  t1827 = my_piecewise3(t2, 0, t1690 + t1726 + t1769 + t1824);
  tv4sigma40 = 0.2e1 * rho[0] * t1827;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;

  double t280, t281, t284, t286, t287, t291, t293, t295;
  double t296, t297, t298, t300, t301, t302, t304, t305;
  double t306, t307, t311, t312, t313, t314, t315, t317;
  double t318, t321, t322, t328, t329, t330, t334, t335;
  double t340, t342, t345, t346, t347, t350, t351, t352;
  double t355, t359, t360, t366, t367, t370, t371, t372;
  double t373, t375, t376, t379, t382, t385, t386, t388;
  double t389, t392, t395, t396, t397, t398, t399, t402;
  double t405, t409, t410, t413, t416, t418, t420, tv2rho20;
  double t423, t427, t431, t432, t435, t439, t440, t443;
  double t451, t452, t456, t460, t461, t464, t470, t471;
  double t473, t474, t477, t478, t479, t481, t484, t485;
  double t488, tv2rho21, t493, t498, t502, t503, t508, t509;
  double t510, t513, t514, t520, t521, t522, t523, t525;
  double t526, t527, t528, t530, t531, t534, t535, t538;
  double t539, t540, t541, t544, t549, t553, t554, t562;
  double t563, t564, t571, t573, t578, t579, t580, t581;
  double t583, t584, t587, t591, t594, t595, t598, t601;
  double t602, tv2rho22, t608, t610, t611, t614, t615, t621;
  double t623, t626, t627, t630, t631, t637, t640, t641;
  double t643, t644, t647, t650, t656, t659, t662, t667;
  double t668, tv2rhosigma0, tv2rhosigma1, t673, t675, t679, t683, t685;
  double tv2rhosigma2, t694, tv2rhosigma3, tv2rhosigma4, t698, t701, t702, t708;
  double t710, t713, t714, t717, t718, t725, t726, t728;
  double t729, t732, t735, t742, t745, t750, t751, tv2rhosigma5;
  double t753, t754, t755, t756, t759, t764, t766, t773;
  double t775, t776, t779, t780, t783, t786, t789, t795;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t796, t797, t798;
  double t799, t802, t807, t809, t816, t818, t819, t822;
  double t823, t826, t829, t832, t838, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t280 = t138 * t145;
  t281 = t143 * t280;
  t284 = t113 * t119;
  t286 = t112 * t27;
  t287 = t286 * t146;
  t291 = 0.1e1 / t116 / t6;
  t293 = t291 * t54 * t60;
  t295 = t26 * t293 / 0.12e2;
  t296 = t25 * t117;
  t297 = t296 * t146;
  t298 = t297 * t149;
  t300 = t146 * t155;
  t301 = t143 * t300;
  t302 = t32 * t32;
  t304 = 0.1e1 / t34 / t302;
  t305 = t31 * t304;
  t306 = t42 * t134;
  t307 = t305 * t306;
  t311 = 0.1e1 / t154 / t52;
  t312 = t152 * t311;
  t313 = t143 * t312;
  t314 = t51 * t51;
  t315 = 0.1e1 / t314;
  t317 = t315 * t41 * t3;
  t318 = t305 * t317;
  t321 = t152 * t155;
  t322 = t143 * t321;
  t328 = 0.1e1 / t33 / t122;
  t329 = t44 * t328;
  t330 = t329 * t134;
  t334 = t28 * t40 * t2;
  t335 = t334 * t30;
  t340 = 0.176e3 / 0.729e3 * t29 * t305 + 0.28e2 / 0.243e3 * t130 * t330 - 0.32e2 / 0.2187e4 * t335 * sigma[0] * t304 * t315;
  t342 = t27 * t340 * t60;
  t345 = t23 * t23;
  t346 = 0.1e1 / t345;
  t347 = t109 * t109;
  t350 = t105 * t6;
  t351 = 0.1e1 / t350;
  t352 = t16 * t351;
  t355 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t106 + 0.2e1 * t352);
  t359 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t346 * t347 + 0.4e1 / 0.3e1 * t23 * t355);
  t360 = t5 * t359;
  t366 = t117 * t138 * t60;
  t367 = t26 * t366;
  t370 = 0.1e1 / t144 / t57;
  t371 = t54 * t370;
  t372 = t371 * t59;
  t373 = t143 * t372;
  t375 = t304 * t41 * t3;
  t376 = t31 * t375;
  t379 = t156 * t330;
  t382 = t286 * t152;
  t385 = t296 * t152;
  t386 = t385 * t157;
  t388 = t138 * t58;
  t389 = t143 * t388;
  t392 = t148 * t329;
  t395 = -t281 * t149 / 0.3e1 - t284 / 0.4e1 - t287 * t149 / 0.3e1 + t295 - t298 / 0.9e1 - 0.8e1 / 0.243e3 * t301 * t307 - 0.8e1 / 0.729e3 * t313 * t318 - 0.4e1 / 0.729e3 * t322 * t318 - 0.3e1 / 0.8e1 * t26 * t342 - 0.3e1 / 0.8e1 * t360 * t61 - 0.3e1 / 0.4e1 * t113 * t140 - t367 / 0.4e1 - 0.8e1 / 0.81e2 * t373 * t376 + 0.7e1 / 0.54e2 * t153 * t379 - t382 * t157 / 0.9e1 - t386 / 0.27e2 - t389 * t157 / 0.9e1 + 0.7e1 / 0.18e2 * t147 * t392;
  t396 = my_piecewise3(t1, 0, t395);
  t397 = t71 * t71;
  t398 = 0.1e1 / t397;
  t399 = t164 * t164;
  t402 = t66 * t351;
  t405 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t106 + 0.2e1 * t402);
  t409 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t399 + 0.4e1 / 0.3e1 * t71 * t405);
  t410 = t5 * t409;
  t413 = t168 * t172;
  t416 = t291 * t94 * t100;
  t418 = t74 * t416 / 0.12e2;
  t420 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t101 - t413 / 0.4e1 + t418);
  tv2rho20 = 0.2e1 * t161 + 0.2e1 * t176 + t6 * (t396 + t420);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t423 = t346 * t180;
  t427 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t352);
  t431 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t423 * t109 + 0.4e1 / 0.3e1 * t23 * t427);
  t432 = t5 * t431;
  t435 = t184 * t119;
  t439 = t183 * t27;
  t440 = t439 * t146;
  t443 = t439 * t152;
  t451 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t432 * t61 - t435 / 0.8e1 - 0.3e1 / 0.8e1 * t184 * t140 - t440 * t149 / 0.6e1 - t443 * t157 / 0.18e2 - t284 / 0.8e1 + t295 - t367 / 0.8e1 - t298 / 0.18e2 - t386 / 0.54e2);
  t452 = t398 * t190;
  t456 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t402);
  t460 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t452 * t164 + 0.4e1 / 0.3e1 * t71 * t456);
  t461 = t5 * t460;
  t464 = t194 * t172;
  t470 = t117 * t210 * t100;
  t471 = t74 * t470;
  t473 = t167 * t27;
  t474 = t473 * t218;
  t477 = t73 * t117;
  t478 = t477 * t218;
  t479 = t478 * t221;
  t481 = t473 * t224;
  t484 = t477 * t224;
  t485 = t484 * t229;
  t488 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t461 * t101 - t464 / 0.8e1 - t413 / 0.8e1 + t418 - 0.3e1 / 0.8e1 * t168 * t212 - t471 / 0.8e1 - t474 * t221 / 0.6e1 - t479 / 0.18e2 - t481 * t229 / 0.18e2 - t485 / 0.54e2);
  tv2rho21 = t161 + t176 + t188 + t233 + t6 * (t451 + t488);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t493 = t180 * t180;
  t498 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t106 + 0.2e1 * t352);
  t502 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t346 * t493 + 0.4e1 / 0.3e1 * t23 * t498);
  t503 = t5 * t502;
  t508 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t61 - t435 / 0.4e1 + t295);
  t509 = t193 * t27;
  t510 = t509 * t218;
  t513 = t210 * t217;
  t514 = t215 * t513;
  t520 = 0.1e1 / t226 / t92;
  t521 = t224 * t520;
  t522 = t215 * t521;
  t523 = t76 * t76;
  t525 = 0.1e1 / t78 / t523;
  t526 = t75 * t525;
  t527 = t91 * t91;
  t528 = 0.1e1 / t527;
  t530 = t528 * t41 * t3;
  t531 = t526 * t530;
  t534 = t224 * t227;
  t535 = t215 * t534;
  t538 = t218 * t227;
  t539 = t215 * t538;
  t540 = t42 * t206;
  t541 = t526 * t540;
  t544 = t190 * t190;
  t549 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t106 + 0.2e1 * t402);
  t553 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t544 + 0.4e1 / 0.3e1 * t71 * t549);
  t554 = t5 * t553;
  t562 = 0.1e1 / t77 / t197;
  t563 = t84 * t562;
  t564 = t563 * t206;
  t571 = 0.176e3 / 0.729e3 * t29 * t526 + 0.28e2 / 0.243e3 * t130 * t564 - 0.32e2 / 0.2187e4 * t335 * sigma[2] * t525 * t528;
  t573 = t27 * t571 * t100;
  t578 = 0.1e1 / t216 / t97;
  t579 = t94 * t578;
  t580 = t579 * t99;
  t581 = t215 * t580;
  t583 = t525 * t41 * t3;
  t584 = t75 * t583;
  t587 = t228 * t564;
  t591 = t509 * t224;
  t594 = t210 * t98;
  t595 = t215 * t594;
  t598 = t220 * t563;
  t601 = -t510 * t221 / 0.3e1 - t514 * t221 / 0.3e1 - t464 / 0.4e1 - t471 / 0.4e1 + t418 - 0.8e1 / 0.729e3 * t522 * t531 - 0.4e1 / 0.729e3 * t535 * t531 - 0.8e1 / 0.243e3 * t539 * t541 - 0.3e1 / 0.8e1 * t554 * t101 - 0.3e1 / 0.4e1 * t194 * t212 - 0.3e1 / 0.8e1 * t74 * t573 - t485 / 0.27e2 - 0.8e1 / 0.81e2 * t581 * t584 + 0.7e1 / 0.54e2 * t225 * t587 - t479 / 0.9e1 - t591 * t229 / 0.9e1 - t595 * t229 / 0.9e1 + 0.7e1 / 0.18e2 * t219 * t598;
  t602 = my_piecewise3(t65, 0, t601);
  tv2rho22 = 0.2e1 * t188 + 0.2e1 * t233 + t6 * (t508 + t602);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t608 = t117 * t244 * t60;
  t610 = t26 * t608 / 0.8e1;
  t611 = t30 * t124;
  t614 = t239 * t132;
  t615 = t614 * t134;
  t621 = -0.16e2 / 0.243e3 * t29 * t611 - 0.2e1 / 0.81e2 * t130 * t615 + 0.4e1 / 0.729e3 * t334 * t611 * t315;
  t623 = t27 * t621 * t60;
  t626 = t244 * t145;
  t627 = t143 * t626;
  t630 = t244 * t58;
  t631 = t143 * t630;
  t637 = t297 * t249 / 0.48e2;
  t640 = t143 * t371;
  t641 = t59 * t30;
  t643 = t124 * t41 * t3;
  t644 = t641 * t643;
  t647 = t611 * t306;
  t650 = t148 * t614;
  t656 = t385 * t252 / 0.144e3;
  t659 = t611 * t317;
  t662 = t156 * t615;
  t667 = -0.3e1 / 0.8e1 * t113 * t246 - t610 - 0.3e1 / 0.8e1 * t26 * t623 - t627 * t149 / 0.6e1 - t631 * t157 / 0.18e2 + t287 * t249 / 0.16e2 + t637 + t281 * t249 / 0.16e2 + t640 * t644 / 0.27e2 + t301 * t647 / 0.81e2 - t147 * t650 / 0.12e2 + t382 * t252 / 0.48e2 + t656 + t389 * t252 / 0.48e2 + t313 * t659 / 0.243e3 - t153 * t662 / 0.36e2 + t322 * t659 / 0.486e3;
  t668 = my_piecewise3(t1, 0, t667);
  tv2rhosigma0 = t6 * t668 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t673 = t117 * t265 * t100;
  t675 = t74 * t673 / 0.8e1;
  t679 = t478 * t270 / 0.48e2;
  t683 = t484 * t273 / 0.144e3;
  t685 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t267 - t675 + t474 * t270 / 0.16e2 + t679 + t481 * t273 / 0.48e2 + t683);
  tv2rhosigma2 = t6 * t685 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t694 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t246 - t610 + t440 * t249 / 0.16e2 + t637 + t443 * t252 / 0.48e2 + t656);
  tv2rhosigma3 = t6 * t694 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t30 * t199;
  t701 = t260 * t204;
  t702 = t701 * t206;
  t708 = -0.16e2 / 0.243e3 * t29 * t698 - 0.2e1 / 0.81e2 * t130 * t702 + 0.4e1 / 0.729e3 * t334 * t698 * t528;
  t710 = t27 * t708 * t100;
  t713 = t265 * t217;
  t714 = t215 * t713;
  t717 = t265 * t98;
  t718 = t215 * t717;
  t725 = t215 * t579;
  t726 = t99 * t30;
  t728 = t199 * t41 * t3;
  t729 = t726 * t728;
  t732 = t698 * t540;
  t735 = t220 * t701;
  t742 = t698 * t530;
  t745 = t228 * t702;
  t750 = -0.3e1 / 0.8e1 * t194 * t267 - t675 - 0.3e1 / 0.8e1 * t74 * t710 - t714 * t221 / 0.6e1 - t718 * t229 / 0.18e2 + t510 * t270 / 0.16e2 + t679 + t514 * t270 / 0.16e2 + t725 * t729 / 0.27e2 + t539 * t732 / 0.81e2 - t219 * t735 / 0.12e2 + t591 * t273 / 0.48e2 + t683 + t595 * t273 / 0.48e2 + t522 * t742 / 0.243e3 - t225 * t745 / 0.36e2 + t535 * t742 / 0.486e3;
  t751 = my_piecewise3(t65, 0, t750);
  tv2rhosigma5 = t6 * t751 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t753 = t44 * sigma[0];
  t754 = 0.1e1 / t753;
  t755 = t754 * t47;
  t756 = t755 * t134;
  t759 = 0.1e1 / sigma[0];
  t764 = -t130 * t756 / 0.108e3 - t335 * t759 * t36 * t315 / 0.486e3;
  t766 = t27 * t764 * t60;
  t773 = t30 * t759;
  t775 = t36 * t41 * t3;
  t776 = t773 * t775;
  t779 = t773 * t36;
  t780 = t779 * t306;
  t783 = t148 * t755;
  t786 = t779 * t317;
  t789 = t156 * t756;
  t795 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t766 + t627 * t249 / 0.8e1 + t631 * t252 / 0.24e2 - t373 * t776 / 0.72e2 - t301 * t780 / 0.216e3 - t147 * t783 / 0.32e2 - t313 * t786 / 0.648e3 - t153 * t789 / 0.96e2 - t322 * t786 / 0.1296e4);
  tv2sigma20 = t6 * t795;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t796 = t84 * sigma[2];
  t797 = 0.1e1 / t796;
  t798 = t797 * t87;
  t799 = t798 * t206;
  t802 = 0.1e1 / sigma[2];
  t807 = -t130 * t799 / 0.108e3 - t335 * t802 * t80 * t528 / 0.486e3;
  t809 = t27 * t807 * t100;
  t816 = t30 * t802;
  t818 = t80 * t41 * t3;
  t819 = t816 * t818;
  t822 = t816 * t80;
  t823 = t822 * t540;
  t826 = t220 * t798;
  t829 = t822 * t530;
  t832 = t228 * t799;
  t838 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t809 + t714 * t270 / 0.8e1 + t718 * t273 / 0.24e2 - t581 * t819 / 0.72e2 - t539 * t823 / 0.216e3 - t219 * t826 / 0.32e2 - t522 * t829 / 0.648e3 - t225 * t832 / 0.96e2 - t535 * t829 / 0.1296e4);
  tv2sigma25 = t6 * t838;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;

  double t280, t281, t284, t286, t287, t291, t293, t295;
  double t296, t297, t298, t300, t301, t302, t304, t305;
  double t306, t307, t311, t312, t313, t314, t315, t317;
  double t318, t321, t322, t328, t329, t330, t334, t335;
  double t340, t342, t345, t346, t347, t350, t351, t352;
  double t355, t359, t360, t366, t367, t370, t371, t372;
  double t373, t375, t376, t379, t382, t385, t386, t388;
  double t389, t392, t395, t396, t397, t398, t399, t402;
  double t405, t409, t410, t413, t416, t418, t420, tv2rho20;
  double t423, t427, t431, t432, t435, t439, t440, t443;
  double t451, t452, t456, t460, t461, t464, t470, t471;
  double t473, t474, t477, t478, t479, t481, t484, t485;
  double t488, tv2rho21, t493, t498, t502, t503, t508, t509;
  double t510, t513, t514, t520, t521, t522, t523, t525;
  double t526, t527, t528, t530, t531, t534, t535, t538;
  double t539, t540, t541, t544, t549, t553, t554, t562;
  double t563, t564, t571, t573, t578, t579, t580, t581;
  double t583, t584, t587, t591, t594, t595, t598, t601;
  double t602, tv2rho22, t608, t610, t611, t614, t615, t621;
  double t623, t626, t627, t630, t631, t637, t640, t641;
  double t643, t644, t647, t650, t656, t659, t662, t667;
  double t668, tv2rhosigma0, tv2rhosigma1, t673, t675, t679, t683, t685;
  double tv2rhosigma2, t694, tv2rhosigma3, tv2rhosigma4, t698, t701, t702, t708;
  double t710, t713, t714, t717, t718, t725, t726, t728;
  double t729, t732, t735, t742, t745, t750, t751, tv2rhosigma5;
  double t753, t754, t755, t756, t759, t764, t766, t773;
  double t775, t776, t779, t780, t783, t786, t789, t795;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t796, t797, t798;
  double t799, t802, t807, t809, t816, t818, t819, t822;
  double t823, t826, t829, t832, t838, tv2sigma25;

  double t841, t844, t845, t847, t848, t849, t850, t851;
  double t852, t853, t856, t857, t858, t859, t864, t865;
  double t866, t867, t869, t871, t872, t879, t880, t881;
  double t883, t884, t890, t892, t894, t895, t896, t899;
  double t901, t902, t905, t906, t907, t909, t910, t913;
  double t915, t916, t919, t926, t927, t928, t931, t933;
  double t937, t938, t940, t943, t945, t947, t949, t950;
  double t953, t956, t957, t958, t961, t965, t966, t971;
  double t973, t975, t978, t979, t983, t985, t988, t989;
  double t991, t992, t994, t995, t998, t1001, t1004, t1005;
  double t1007, t1008, t1009, t1010, t1011, t1012, t1014, t1021;
  double t1022, t1025, t1026, t1028, t1031, t1034, t1037, t1038;
  double t1042, t1043, t1045, t1046, t1049, t1052, t1053, t1056;
  double t1057, t1061, t1062, t1065, t1066, t1067, t1070, t1073;
  double t1075, t1076, t1079, t1082, t1085, t1089, t1090, t1093;
  double t1095, t1098, t1100, t1102, tv3rho30, t1105, t1106, t1110;
  double t1116, t1117, t1120, t1121, t1123, t1124, t1129, t1130;
  double t1132, t1135, t1140, t1141, t1143, t1147, t1148, t1154;
  double t1159, t1165, t1168, t1170, t1171, t1179, t1182, t1185;
  double t1190, t1192, t1193, t1196, t1201, t1203, t1207, t1208;
  double t1212, t1213, t1220, t1222, t1223, t1225, t1226, t1229;
  double t1230, t1232, t1233, t1234, t1235, t1237, t1240, t1242;
  double t1243, t1244, t1246, t1247, tv3rho31, t1250, t1255, t1259;
  double t1263, t1264, t1267, t1271, t1272, t1275, t1283, t1284;
  double t1287, t1288, t1291, t1294, t1295, t1296, t1298, t1299;
  double t1301, t1304, t1305, t1307, t1311, t1312, t1314, t1319;
  double t1323, t1327, t1328, t1337, t1338, t1340, t1343, t1345;
  double t1346, t1348, t1349, t1353, t1356, t1360, t1361, t1363;
  double t1366, t1369, t1372, t1373, t1375, t1376, t1378, t1380;
  double tv3rho32, t1385, t1392, t1396, t1397, t1403, t1405, t1406;
  double t1407, t1410, t1411, t1414, t1416, t1417, t1428, t1430;
  double t1432, t1433, t1436, t1439, t1440, t1441, t1444, t1445;
  double t1446, t1447, t1448, t1449, t1451, t1452, t1455, t1456;
  double t1457, t1458, t1460, t1462, t1463, t1472, t1473, t1474;
  double t1475, t1479, t1486, t1490, t1491, t1498, t1501, t1508;
  double t1509, t1512, t1514, t1519, t1524, t1530, t1533, t1536;
  double t1537, t1540, t1541, t1542, t1543, t1544, t1545, t1547;
  double t1552, t1557, t1560, t1565, t1566, t1569, t1572, t1573;
  double t1576, t1579, t1580, t1583, t1588, t1591, tv3rho33, t1597;
  double t1601, t1604, t1608, t1609, t1614, t1619, t1620, t1621;
  double t1623, t1624, t1631, t1634, t1635, t1636, t1637, t1638;
  double t1643, t1644, t1651, t1654, t1655, t1656, t1661, t1665;
  double t1667, t1668, t1673, t1680, t1684, t1686, t1688, t1691;
  double t1693, t1695, t1696, t1700, t1707, t1710, t1712, t1719;
  double t1722, t1727, t1730, t1734, t1736, t1737, t1741, t1744;
  double t1748, t1749, t1751, t1755, t1762, t1763, t1765, t1766;
  double t1769, t1770, t1773, t1774, t1777, t1778, t1781, t1784;
  double tv3rho2sigma0, tv3rho2sigma1, t1789, t1792, t1794, t1797, t1800, t1803;
  double t1806, t1808, tv3rho2sigma2, t1811, t1815, t1834, t1836, t1847;
  double t1850, t1855, t1862, t1864, tv3rho2sigma3, tv3rho2sigma4, t1866, t1868;
  double t1870, t1871, t1873, t1875, t1891, t1893, t1895, t1899;
  double t1903, t1904, t1906, t1909, t1911, t1912, t1914, t1915;
  double t1917, t1926, t1930, t1932, t1934, t1936, tv3rho2sigma5, t1949;
  double tv3rho2sigma6, tv3rho2sigma7, t1952, t1953, t1956, t1957, t1960, t1961;
  double t1966, t1969, t1970, t1981, t1982, t1989, t1992, t1993;
  double t1996, t2001, t2002, t2003, t2004, t2005, t2024, t2026;
  double t2027, t2030, t2033, t2034, t2039, t2040, t2041, t2053;
  double t2060, t2063, t2065, t2072, t2077, t2078, t2089, t2092;
  double t2096, t2099, t2102, t2103, t2111, t2114, tv3rho2sigma8, t2117;
  double t2118, t2119, t2123, t2125, t2126, t2143, t2145, t2149;
  double t2150, t2151, t2154, t2155, t2166, t2167, t2168, t2175;
  double t2180, t2181, t2188, t2191, t2201, t2203, t2206, t2207;
  double t2214, t2218, t2220, t2224, t2225, t2229, t2232, t2239;
  double t2242, t2249, t2250, t2253, t2256, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22;
  double tv3rhosigma23, tv3rhosigma24, t2261, t2263, t2267, t2271, t2275, t2279;
  double t2283, t2287, t2291, t2295, t2296, t2297, tv3rhosigma25, t2317;
  double t2318, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2320, t2321;
  double t2324, t2341, t2344, t2345, t2354, t2355, t2360, t2363;
  double t2364, t2365, t2370, t2378, t2381, t2394, t2401, t2405;
  double t2407, t2410, t2411, t2416, t2417, t2420, t2427, t2430;
  double t2437, t2440, tv3rhosigma211, t2442, t2443, t2444, t2445, t2446;
  double t2453, t2458, t2459, t2460, t2466, t2467, t2468, t2469;
  double t2478, t2479, t2482, t2493, t2494, t2497, t2502, t2514;
  double t2517, t2519, t2522, t2524, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2525, t2527, t2528;
  double t2529, t2537, t2539, t2540, t2543, t2544, t2545, t2546;
  double t2555, t2558, t2559, t2564, t2565, t2570, t2571, t2580;
  double t2585, t2597, t2600, t2602, t2605, t2607, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t280 = t138 * t145;
  t281 = t143 * t280;
  t284 = t113 * t119;
  t286 = t112 * t27;
  t287 = t286 * t146;
  t291 = 0.1e1 / t116 / t6;
  t293 = t291 * t54 * t60;
  t295 = t26 * t293 / 0.12e2;
  t296 = t25 * t117;
  t297 = t296 * t146;
  t298 = t297 * t149;
  t300 = t146 * t155;
  t301 = t143 * t300;
  t302 = t32 * t32;
  t304 = 0.1e1 / t34 / t302;
  t305 = t31 * t304;
  t306 = t42 * t134;
  t307 = t305 * t306;
  t311 = 0.1e1 / t154 / t52;
  t312 = t152 * t311;
  t313 = t143 * t312;
  t314 = t51 * t51;
  t315 = 0.1e1 / t314;
  t317 = t315 * t41 * t3;
  t318 = t305 * t317;
  t321 = t152 * t155;
  t322 = t143 * t321;
  t328 = 0.1e1 / t33 / t122;
  t329 = t44 * t328;
  t330 = t329 * t134;
  t334 = t28 * t40 * t2;
  t335 = t334 * t30;
  t340 = 0.176e3 / 0.729e3 * t29 * t305 + 0.28e2 / 0.243e3 * t130 * t330 - 0.32e2 / 0.2187e4 * t335 * sigma[0] * t304 * t315;
  t342 = t27 * t340 * t60;
  t345 = t23 * t23;
  t346 = 0.1e1 / t345;
  t347 = t109 * t109;
  t350 = t105 * t6;
  t351 = 0.1e1 / t350;
  t352 = t16 * t351;
  t355 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t106 + 0.2e1 * t352);
  t359 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t346 * t347 + 0.4e1 / 0.3e1 * t23 * t355);
  t360 = t5 * t359;
  t366 = t117 * t138 * t60;
  t367 = t26 * t366;
  t370 = 0.1e1 / t144 / t57;
  t371 = t54 * t370;
  t372 = t371 * t59;
  t373 = t143 * t372;
  t375 = t304 * t41 * t3;
  t376 = t31 * t375;
  t379 = t156 * t330;
  t382 = t286 * t152;
  t385 = t296 * t152;
  t386 = t385 * t157;
  t388 = t138 * t58;
  t389 = t143 * t388;
  t392 = t148 * t329;
  t395 = -t281 * t149 / 0.3e1 - t284 / 0.4e1 - t287 * t149 / 0.3e1 + t295 - t298 / 0.9e1 - 0.8e1 / 0.243e3 * t301 * t307 - 0.8e1 / 0.729e3 * t313 * t318 - 0.4e1 / 0.729e3 * t322 * t318 - 0.3e1 / 0.8e1 * t26 * t342 - 0.3e1 / 0.8e1 * t360 * t61 - 0.3e1 / 0.4e1 * t113 * t140 - t367 / 0.4e1 - 0.8e1 / 0.81e2 * t373 * t376 + 0.7e1 / 0.54e2 * t153 * t379 - t382 * t157 / 0.9e1 - t386 / 0.27e2 - t389 * t157 / 0.9e1 + 0.7e1 / 0.18e2 * t147 * t392;
  t396 = my_piecewise3(t1, 0, t395);
  t397 = t71 * t71;
  t398 = 0.1e1 / t397;
  t399 = t164 * t164;
  t402 = t66 * t351;
  t405 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t106 + 0.2e1 * t402);
  t409 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t399 + 0.4e1 / 0.3e1 * t71 * t405);
  t410 = t5 * t409;
  t413 = t168 * t172;
  t416 = t291 * t94 * t100;
  t418 = t74 * t416 / 0.12e2;
  t420 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t101 - t413 / 0.4e1 + t418);
  tv2rho20 = 0.2e1 * t161 + 0.2e1 * t176 + t6 * (t396 + t420);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t423 = t346 * t180;
  t427 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t352);
  t431 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t423 * t109 + 0.4e1 / 0.3e1 * t23 * t427);
  t432 = t5 * t431;
  t435 = t184 * t119;
  t439 = t183 * t27;
  t440 = t439 * t146;
  t443 = t439 * t152;
  t451 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t432 * t61 - t435 / 0.8e1 - 0.3e1 / 0.8e1 * t184 * t140 - t440 * t149 / 0.6e1 - t443 * t157 / 0.18e2 - t284 / 0.8e1 + t295 - t367 / 0.8e1 - t298 / 0.18e2 - t386 / 0.54e2);
  t452 = t398 * t190;
  t456 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t402);
  t460 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t452 * t164 + 0.4e1 / 0.3e1 * t71 * t456);
  t461 = t5 * t460;
  t464 = t194 * t172;
  t470 = t117 * t210 * t100;
  t471 = t74 * t470;
  t473 = t167 * t27;
  t474 = t473 * t218;
  t477 = t73 * t117;
  t478 = t477 * t218;
  t479 = t478 * t221;
  t481 = t473 * t224;
  t484 = t477 * t224;
  t485 = t484 * t229;
  t488 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t461 * t101 - t464 / 0.8e1 - t413 / 0.8e1 + t418 - 0.3e1 / 0.8e1 * t168 * t212 - t471 / 0.8e1 - t474 * t221 / 0.6e1 - t479 / 0.18e2 - t481 * t229 / 0.18e2 - t485 / 0.54e2);
  tv2rho21 = t161 + t176 + t188 + t233 + t6 * (t451 + t488);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t493 = t180 * t180;
  t498 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t106 + 0.2e1 * t352);
  t502 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t346 * t493 + 0.4e1 / 0.3e1 * t23 * t498);
  t503 = t5 * t502;
  t508 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t61 - t435 / 0.4e1 + t295);
  t509 = t193 * t27;
  t510 = t509 * t218;
  t513 = t210 * t217;
  t514 = t215 * t513;
  t520 = 0.1e1 / t226 / t92;
  t521 = t224 * t520;
  t522 = t215 * t521;
  t523 = t76 * t76;
  t525 = 0.1e1 / t78 / t523;
  t526 = t75 * t525;
  t527 = t91 * t91;
  t528 = 0.1e1 / t527;
  t530 = t528 * t41 * t3;
  t531 = t526 * t530;
  t534 = t224 * t227;
  t535 = t215 * t534;
  t538 = t218 * t227;
  t539 = t215 * t538;
  t540 = t42 * t206;
  t541 = t526 * t540;
  t544 = t190 * t190;
  t549 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t106 + 0.2e1 * t402);
  t553 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t544 + 0.4e1 / 0.3e1 * t71 * t549);
  t554 = t5 * t553;
  t562 = 0.1e1 / t77 / t197;
  t563 = t84 * t562;
  t564 = t563 * t206;
  t571 = 0.176e3 / 0.729e3 * t29 * t526 + 0.28e2 / 0.243e3 * t130 * t564 - 0.32e2 / 0.2187e4 * t335 * sigma[2] * t525 * t528;
  t573 = t27 * t571 * t100;
  t578 = 0.1e1 / t216 / t97;
  t579 = t94 * t578;
  t580 = t579 * t99;
  t581 = t215 * t580;
  t583 = t525 * t41 * t3;
  t584 = t75 * t583;
  t587 = t228 * t564;
  t591 = t509 * t224;
  t594 = t210 * t98;
  t595 = t215 * t594;
  t598 = t220 * t563;
  t601 = -t510 * t221 / 0.3e1 - t514 * t221 / 0.3e1 - t464 / 0.4e1 - t471 / 0.4e1 + t418 - 0.8e1 / 0.729e3 * t522 * t531 - 0.4e1 / 0.729e3 * t535 * t531 - 0.8e1 / 0.243e3 * t539 * t541 - 0.3e1 / 0.8e1 * t554 * t101 - 0.3e1 / 0.4e1 * t194 * t212 - 0.3e1 / 0.8e1 * t74 * t573 - t485 / 0.27e2 - 0.8e1 / 0.81e2 * t581 * t584 + 0.7e1 / 0.54e2 * t225 * t587 - t479 / 0.9e1 - t591 * t229 / 0.9e1 - t595 * t229 / 0.9e1 + 0.7e1 / 0.18e2 * t219 * t598;
  t602 = my_piecewise3(t65, 0, t601);
  tv2rho22 = 0.2e1 * t188 + 0.2e1 * t233 + t6 * (t508 + t602);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t608 = t117 * t244 * t60;
  t610 = t26 * t608 / 0.8e1;
  t611 = t30 * t124;
  t614 = t239 * t132;
  t615 = t614 * t134;
  t621 = -0.16e2 / 0.243e3 * t29 * t611 - 0.2e1 / 0.81e2 * t130 * t615 + 0.4e1 / 0.729e3 * t334 * t611 * t315;
  t623 = t27 * t621 * t60;
  t626 = t244 * t145;
  t627 = t143 * t626;
  t630 = t244 * t58;
  t631 = t143 * t630;
  t637 = t297 * t249 / 0.48e2;
  t640 = t143 * t371;
  t641 = t59 * t30;
  t643 = t124 * t41 * t3;
  t644 = t641 * t643;
  t647 = t611 * t306;
  t650 = t148 * t614;
  t656 = t385 * t252 / 0.144e3;
  t659 = t611 * t317;
  t662 = t156 * t615;
  t667 = -0.3e1 / 0.8e1 * t113 * t246 - t610 - 0.3e1 / 0.8e1 * t26 * t623 - t627 * t149 / 0.6e1 - t631 * t157 / 0.18e2 + t287 * t249 / 0.16e2 + t637 + t281 * t249 / 0.16e2 + t640 * t644 / 0.27e2 + t301 * t647 / 0.81e2 - t147 * t650 / 0.12e2 + t382 * t252 / 0.48e2 + t656 + t389 * t252 / 0.48e2 + t313 * t659 / 0.243e3 - t153 * t662 / 0.36e2 + t322 * t659 / 0.486e3;
  t668 = my_piecewise3(t1, 0, t667);
  tv2rhosigma0 = t6 * t668 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t673 = t117 * t265 * t100;
  t675 = t74 * t673 / 0.8e1;
  t679 = t478 * t270 / 0.48e2;
  t683 = t484 * t273 / 0.144e3;
  t685 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t267 - t675 + t474 * t270 / 0.16e2 + t679 + t481 * t273 / 0.48e2 + t683);
  tv2rhosigma2 = t6 * t685 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t694 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t246 - t610 + t440 * t249 / 0.16e2 + t637 + t443 * t252 / 0.48e2 + t656);
  tv2rhosigma3 = t6 * t694 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t30 * t199;
  t701 = t260 * t204;
  t702 = t701 * t206;
  t708 = -0.16e2 / 0.243e3 * t29 * t698 - 0.2e1 / 0.81e2 * t130 * t702 + 0.4e1 / 0.729e3 * t334 * t698 * t528;
  t710 = t27 * t708 * t100;
  t713 = t265 * t217;
  t714 = t215 * t713;
  t717 = t265 * t98;
  t718 = t215 * t717;
  t725 = t215 * t579;
  t726 = t99 * t30;
  t728 = t199 * t41 * t3;
  t729 = t726 * t728;
  t732 = t698 * t540;
  t735 = t220 * t701;
  t742 = t698 * t530;
  t745 = t228 * t702;
  t750 = -0.3e1 / 0.8e1 * t194 * t267 - t675 - 0.3e1 / 0.8e1 * t74 * t710 - t714 * t221 / 0.6e1 - t718 * t229 / 0.18e2 + t510 * t270 / 0.16e2 + t679 + t514 * t270 / 0.16e2 + t725 * t729 / 0.27e2 + t539 * t732 / 0.81e2 - t219 * t735 / 0.12e2 + t591 * t273 / 0.48e2 + t683 + t595 * t273 / 0.48e2 + t522 * t742 / 0.243e3 - t225 * t745 / 0.36e2 + t535 * t742 / 0.486e3;
  t751 = my_piecewise3(t65, 0, t750);
  tv2rhosigma5 = t6 * t751 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t753 = t44 * sigma[0];
  t754 = 0.1e1 / t753;
  t755 = t754 * t47;
  t756 = t755 * t134;
  t759 = 0.1e1 / sigma[0];
  t764 = -t130 * t756 / 0.108e3 - t335 * t759 * t36 * t315 / 0.486e3;
  t766 = t27 * t764 * t60;
  t773 = t30 * t759;
  t775 = t36 * t41 * t3;
  t776 = t773 * t775;
  t779 = t773 * t36;
  t780 = t779 * t306;
  t783 = t148 * t755;
  t786 = t779 * t317;
  t789 = t156 * t756;
  t795 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t766 + t627 * t249 / 0.8e1 + t631 * t252 / 0.24e2 - t373 * t776 / 0.72e2 - t301 * t780 / 0.216e3 - t147 * t783 / 0.32e2 - t313 * t786 / 0.648e3 - t153 * t789 / 0.96e2 - t322 * t786 / 0.1296e4);
  tv2sigma20 = t6 * t795;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t796 = t84 * sigma[2];
  t797 = 0.1e1 / t796;
  t798 = t797 * t87;
  t799 = t798 * t206;
  t802 = 0.1e1 / sigma[2];
  t807 = -t130 * t799 / 0.108e3 - t335 * t802 * t80 * t528 / 0.486e3;
  t809 = t27 * t807 * t100;
  t816 = t30 * t802;
  t818 = t80 * t41 * t3;
  t819 = t816 * t818;
  t822 = t816 * t80;
  t823 = t822 * t540;
  t826 = t220 * t798;
  t829 = t822 * t530;
  t832 = t228 * t799;
  t838 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t809 + t714 * t270 / 0.8e1 + t718 * t273 / 0.24e2 - t581 * t819 / 0.72e2 - t539 * t823 / 0.216e3 - t219 * t826 / 0.32e2 - t522 * t829 / 0.648e3 - t225 * t832 / 0.96e2 - t535 * t829 / 0.1296e4);
  tv2sigma25 = t6 * t838;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t841 = t286 * t372;
  t844 = t296 * t372;
  t845 = t844 * t376;
  t847 = t371 * t155;
  t848 = t143 * t847;
  t849 = t302 * t122;
  t850 = 0.1e1 / t849;
  t851 = t753 * t850;
  t852 = t29 * t134;
  t853 = t851 * t852;
  t856 = t146 * t311;
  t857 = t143 * t856;
  t858 = t29 * t315;
  t859 = t851 * t858;
  t864 = t154 * t154;
  t865 = 0.1e1 / t864;
  t866 = t152 * t865;
  t867 = t143 * t866;
  t869 = 0.1e1 / t314 / t51;
  t871 = t869 * t2 * t28;
  t872 = t851 * t871;
  t879 = t25 * t291;
  t880 = t879 * t146;
  t881 = t880 * t149;
  t883 = t296 * t280;
  t884 = t883 * t149;
  t890 = t297 * t392;
  t892 = -0.8e1 / 0.27e2 * t841 * t376 - 0.8e1 / 0.81e2 * t845 - 0.64e2 / 0.729e3 * t848 * t853 - 0.64e2 / 0.2187e4 * t857 * t859 - 0.32e2 / 0.2187e4 * t301 * t859 - 0.64e2 / 0.6561e4 * t867 * t872 - 0.64e2 / 0.6561e4 * t313 * t872 - 0.64e2 / 0.19683e5 * t322 * t872 + t881 / 0.9e1 - t884 / 0.3e1 + 0.7e1 / 0.6e1 * t281 * t392 + 0.7e1 / 0.6e1 * t287 * t392 + 0.7e1 / 0.18e2 * t890;
  t894 = 0.1e1 / t33 / t302;
  t895 = t44 * t894;
  t896 = t148 * t895;
  t899 = t286 * t280;
  t901 = t340 * t145;
  t902 = t143 * t901;
  t905 = t112 * t117;
  t906 = t905 * t146;
  t907 = t906 * t149;
  t909 = t359 * t27;
  t910 = t909 * t146;
  t913 = t302 * rho[0];
  t915 = 0.1e1 / t34 / t913;
  t916 = t31 * t915;
  t919 = t895 * t134;
  t926 = t40 * M_PI;
  t927 = t926 * t753;
  t928 = t850 * t869;
  t931 = -0.2464e4 / 0.2187e4 * t29 * t916 - 0.28e3 / 0.729e3 * t130 * t919 + 0.224e3 / 0.2187e4 * t335 * sigma[0] * t915 * t315 - 0.512e3 / 0.59049e5 * t927 * t928;
  t933 = t27 * t931 * t60;
  t937 = t117 * t340 * t60;
  t938 = t26 * t937;
  t940 = t113 * t293;
  t943 = 0.1e1 / t116 / t105;
  t945 = t943 * t54 * t60;
  t947 = 0.5e1 / 0.36e2 * t26 * t945;
  t949 = 0.1e1 / t345 / t19;
  t950 = t347 * t109;
  t953 = t346 * t109;
  t956 = t105 * t105;
  t957 = 0.1e1 / t956;
  t958 = t16 * t957;
  t961 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t351 - 0.6e1 * t958);
  t965 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t949 * t950 + 0.4e1 / 0.3e1 * t953 * t355 + 0.4e1 / 0.3e1 * t23 * t961);
  t966 = t5 * t965;
  t971 = t360 * t119;
  t973 = t113 * t366;
  t975 = -0.35e2 / 0.27e2 * t147 * t896 - t899 * t149 - t902 * t149 / 0.2e1 - t907 / 0.3e1 - t910 * t149 / 0.2e1 - 0.3e1 / 0.8e1 * t26 * t933 - 0.3e1 / 0.8e1 * t938 + t940 / 0.4e1 - t947 - 0.3e1 / 0.8e1 * t966 * t61 - 0.9e1 / 0.8e1 * t360 * t140 - 0.3e1 / 0.8e1 * t971 - 0.3e1 / 0.4e1 * t973;
  t978 = t291 * t138 * t60;
  t979 = t26 * t978;
  t983 = t385 * t379;
  t985 = t156 * t919;
  t988 = t905 * t152;
  t989 = t988 * t157;
  t991 = t879 * t152;
  t992 = t991 * t157;
  t994 = t340 * t58;
  t995 = t143 * t994;
  t998 = t909 * t152;
  t1001 = t286 * t388;
  t1004 = t296 * t388;
  t1005 = t1004 * t157;
  t1007 = t144 * t144;
  t1008 = 0.1e1 / t1007;
  t1009 = t54 * t1008;
  t1010 = t143 * t1009;
  t1011 = t59 * t753;
  t1012 = t850 * t2;
  t1014 = t1011 * t1012 * t28;
  t1021 = t979 / 0.4e1 - 0.9e1 / 0.8e1 * t113 * t342 + 0.7e1 / 0.54e2 * t983 - 0.35e2 / 0.81e2 * t153 * t985 - t989 / 0.9e1 + t992 / 0.27e2 - t995 * t157 / 0.6e1 - t998 * t157 / 0.6e1 - t1001 * t157 / 0.3e1 - t1005 / 0.9e1 - 0.64e2 / 0.243e3 * t1010 * t1014 + 0.7e1 / 0.18e2 * t382 * t379 + 0.7e1 / 0.18e2 * t389 * t379;
  t1022 = t286 * t300;
  t1025 = t296 * t300;
  t1026 = t1025 * t307;
  t1028 = t286 * t312;
  t1031 = t916 * t317;
  t1034 = t916 * t306;
  t1037 = t296 * t312;
  t1038 = t1037 * t318;
  t1042 = t296 * t321;
  t1043 = t1042 * t318;
  t1045 = t388 * t311;
  t1046 = t143 * t1045;
  t1049 = t286 * t321;
  t1052 = t388 * t155;
  t1053 = t143 * t1052;
  t1056 = t280 * t155;
  t1057 = t143 * t1056;
  t1061 = t915 * t41 * t3;
  t1062 = t31 * t1061;
  t1065 = t138 * t370;
  t1066 = t1065 * t59;
  t1067 = t143 * t1066;
  t1070 = -0.8e1 / 0.81e2 * t1022 * t307 - 0.8e1 / 0.243e3 * t1026 - 0.8e1 / 0.243e3 * t1028 * t318 + 0.28e2 / 0.729e3 * t322 * t1031 + 0.56e2 / 0.243e3 * t301 * t1034 - 0.8e1 / 0.729e3 * t1038 + 0.56e2 / 0.729e3 * t313 * t1031 - 0.4e1 / 0.729e3 * t1043 - 0.8e1 / 0.243e3 * t1046 * t318 - 0.4e1 / 0.243e3 * t1049 * t318 - 0.4e1 / 0.243e3 * t1053 * t318 - 0.8e1 / 0.81e2 * t1057 * t307 + 0.56e2 / 0.81e2 * t373 * t1062 - 0.8e1 / 0.27e2 * t1067 * t376;
  t1073 = my_piecewise3(t1, 0, t892 + t975 + t1021 + t1070);
  t1075 = 0.1e1 / t397 / t69;
  t1076 = t399 * t164;
  t1079 = t398 * t164;
  t1082 = t66 * t957;
  t1085 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t351 - 0.6e1 * t1082);
  t1089 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1075 * t1076 + 0.4e1 / 0.3e1 * t1079 * t405 + 0.4e1 / 0.3e1 * t71 * t1085);
  t1090 = t5 * t1089;
  t1093 = t410 * t172;
  t1095 = t168 * t416;
  t1098 = t943 * t94 * t100;
  t1100 = 0.5e1 / 0.36e2 * t74 * t1098;
  t1102 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t1090 * t101 - 0.3e1 / 0.8e1 * t1093 + t1095 / 0.4e1 - t1100);
  tv3rho30 = 0.3e1 * t396 + 0.3e1 * t420 + t6 * (t1073 + t1102);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1105 = 0.2e1 * t451;
  t1106 = 0.2e1 * t488;
  t1110 = t439 * t372;
  t1116 = t431 * t27;
  t1117 = t1116 * t146;
  t1120 = t183 * t117;
  t1121 = t1120 * t146;
  t1123 = t1121 * t149 / 0.9e1;
  t1124 = t439 * t280;
  t1129 = t432 * t119 / 0.4e1;
  t1130 = t184 * t293;
  t1132 = t949 * t180;
  t1135 = t346 * t427;
  t1140 = 0.2e1 * t351;
  t1141 = 0.6e1 * t958;
  t1143 = my_piecewise5(t10, 0, t14, 0, t1140 - t1141);
  t1147 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1132 * t347 + 0.8e1 / 0.9e1 * t1135 * t109 + 0.4e1 / 0.9e1 * t423 * t355 + 0.4e1 / 0.3e1 * t23 * t1143);
  t1148 = t5 * t1147;
  t1154 = t184 * t366 / 0.4e1;
  t1159 = 0.7e1 / 0.18e2 * t440 * t392 - 0.8e1 / 0.243e3 * t845 - 0.8e1 / 0.81e2 * t1110 * t376 + 0.2e1 / 0.27e2 * t881 - t884 / 0.9e1 + 0.7e1 / 0.54e2 * t890 - t1117 * t149 / 0.3e1 - t1123 - t1124 * t149 / 0.3e1 - t907 / 0.9e1 - t1129 + t1130 / 0.12e2 - 0.3e1 / 0.8e1 * t1148 * t61 - 0.3e1 / 0.4e1 * t432 * t140 - t1154 - 0.3e1 / 0.8e1 * t184 * t342 - t938 / 0.8e1 + t940 / 0.6e1;
  t1165 = t1116 * t152;
  t1168 = t1120 * t152;
  t1170 = t1168 * t157 / 0.27e2;
  t1171 = t439 * t388;
  t1179 = t439 * t300;
  t1182 = t439 * t312;
  t1185 = t439 * t321;
  t1190 = -t947 - t971 / 0.8e1 - t973 / 0.4e1 + t979 / 0.6e1 + 0.7e1 / 0.54e2 * t443 * t379 - t1165 * t157 / 0.9e1 - t1170 - t1171 * t157 / 0.9e1 + 0.7e1 / 0.162e3 * t983 - t989 / 0.27e2 + 0.2e1 / 0.81e2 * t992 - t1005 / 0.27e2 - 0.8e1 / 0.729e3 * t1026 - 0.8e1 / 0.243e3 * t1179 * t307 - 0.8e1 / 0.729e3 * t1182 * t318 - 0.4e1 / 0.729e3 * t1185 * t318 - 0.8e1 / 0.2187e4 * t1038 - 0.4e1 / 0.2187e4 * t1043;
  t1192 = my_piecewise3(t1, 0, t1159 + t1190);
  t1193 = t1075 * t190;
  t1196 = t398 * t456;
  t1201 = 0.6e1 * t1082;
  t1203 = my_piecewise5(t14, 0, t10, 0, -t1140 - t1201);
  t1207 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1193 * t399 + 0.8e1 / 0.9e1 * t1196 * t164 + 0.4e1 / 0.9e1 * t452 * t405 + 0.4e1 / 0.3e1 * t71 * t1203);
  t1208 = t5 * t1207;
  t1212 = t461 * t172 / 0.4e1;
  t1213 = t194 * t416;
  t1220 = t168 * t470 / 0.4e1;
  t1222 = t291 * t210 * t100;
  t1223 = t74 * t1222;
  t1225 = t409 * t27;
  t1226 = t1225 * t218;
  t1229 = t167 * t117;
  t1230 = t1229 * t218;
  t1232 = t1230 * t221 / 0.9e1;
  t1233 = t73 * t291;
  t1234 = t1233 * t218;
  t1235 = t1234 * t221;
  t1237 = t1225 * t224;
  t1240 = t1229 * t224;
  t1242 = t1240 * t229 / 0.27e2;
  t1243 = t1233 * t224;
  t1244 = t1243 * t229;
  t1246 = -0.3e1 / 0.8e1 * t1208 * t101 - t1212 + t1213 / 0.12e2 - t1093 / 0.8e1 + t1095 / 0.6e1 - t1100 - 0.3e1 / 0.8e1 * t410 * t212 - t1220 + t1223 / 0.12e2 - t1226 * t221 / 0.6e1 - t1232 + t1235 / 0.27e2 - t1237 * t229 / 0.18e2 - t1242 + t1244 / 0.81e2;
  t1247 = my_piecewise3(t65, 0, t1246);
  tv3rho31 = t396 + t420 + t1105 + t1106 + t6 * (t1192 + t1247);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1250 = t949 * t493;
  t1255 = t346 * t498;
  t1259 = my_piecewise5(t10, 0, t14, 0, -t1140 - t1141);
  t1263 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1250 * t109 + 0.8e1 / 0.9e1 * t423 * t427 + 0.4e1 / 0.9e1 * t1255 * t109 + 0.4e1 / 0.3e1 * t23 * t1259);
  t1264 = t5 * t1263;
  t1267 = t503 * t119;
  t1271 = t502 * t27;
  t1272 = t1271 * t146;
  t1275 = t1271 * t152;
  t1283 = -0.3e1 / 0.8e1 * t1264 * t61 - t1267 / 0.8e1 - 0.3e1 / 0.8e1 * t503 * t140 - t1272 * t149 / 0.6e1 - t1275 * t157 / 0.18e2 - t1129 + t1130 / 0.6e1 - t1154 - t1123 - t1170 + t940 / 0.12e2 - t947 + t979 / 0.12e2 + t881 / 0.27e2 + t992 / 0.81e2;
  t1284 = my_piecewise3(t1, 0, t1283);
  t1287 = t460 * t27;
  t1288 = t1287 * t218;
  t1291 = t473 * t513;
  t1294 = t193 * t117;
  t1295 = t1294 * t218;
  t1296 = t1295 * t221;
  t1298 = t477 * t513;
  t1299 = t1298 * t221;
  t1301 = t478 * t598;
  t1304 = t477 * t580;
  t1305 = t1304 * t584;
  t1307 = t473 * t580;
  t1311 = t117 * t571 * t100;
  t1312 = t74 * t1311;
  t1314 = t1075 * t544;
  t1319 = t398 * t549;
  t1323 = my_piecewise5(t14, 0, t10, 0, t1140 - t1201);
  t1327 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1314 * t164 + 0.8e1 / 0.9e1 * t452 * t456 + 0.4e1 / 0.9e1 * t1319 * t164 + 0.4e1 / 0.3e1 * t71 * t1323);
  t1328 = t5 * t1327;
  t1337 = 0.7e1 / 0.18e2 * t474 * t598 - t1288 * t221 / 0.3e1 - t1291 * t221 / 0.3e1 - t1296 / 0.9e1 - t1299 / 0.9e1 + 0.7e1 / 0.54e2 * t1301 - t1232 + 0.2e1 / 0.27e2 * t1235 - 0.8e1 / 0.243e3 * t1305 - 0.8e1 / 0.81e2 * t1307 * t584 - t1312 / 0.8e1 - 0.3e1 / 0.8e1 * t1328 * t101 - 0.3e1 / 0.4e1 * t461 * t212 - 0.3e1 / 0.8e1 * t168 * t573 - t1212 + t1213 / 0.6e1 - t1220 + t1223 / 0.6e1;
  t1338 = t554 * t172;
  t1340 = t194 * t470;
  t1343 = t484 * t587;
  t1345 = t1294 * t224;
  t1346 = t1345 * t229;
  t1348 = t477 * t594;
  t1349 = t1348 * t229;
  t1353 = t1287 * t224;
  t1356 = t473 * t594;
  t1360 = t477 * t521;
  t1361 = t1360 * t531;
  t1363 = t473 * t521;
  t1366 = t473 * t534;
  t1369 = t473 * t538;
  t1372 = t477 * t534;
  t1373 = t1372 * t531;
  t1375 = t477 * t538;
  t1376 = t1375 * t541;
  t1378 = -t1338 / 0.8e1 - t1340 / 0.4e1 + t1095 / 0.12e2 - t1100 + 0.7e1 / 0.162e3 * t1343 - t1346 / 0.27e2 - t1349 / 0.27e2 + 0.7e1 / 0.54e2 * t481 * t587 - t1353 * t229 / 0.9e1 - t1356 * t229 / 0.9e1 - t1242 + 0.2e1 / 0.81e2 * t1244 - 0.8e1 / 0.2187e4 * t1361 - 0.8e1 / 0.729e3 * t1363 * t531 - 0.4e1 / 0.729e3 * t1366 * t531 - 0.8e1 / 0.243e3 * t1369 * t541 - 0.4e1 / 0.2187e4 * t1373 - 0.8e1 / 0.729e3 * t1376;
  t1380 = my_piecewise3(t65, 0, t1337 + t1378);
  tv3rho32 = t1105 + t1106 + t508 + t602 + t6 * (t1284 + t1380);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1385 = t493 * t180;
  t1392 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t351 - 0.6e1 * t958);
  t1396 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t949 * t1385 + 0.4e1 / 0.3e1 * t423 * t498 + 0.4e1 / 0.3e1 * t23 * t1392);
  t1397 = t5 * t1396;
  t1403 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1397 * t61 - 0.3e1 / 0.8e1 * t1267 + t1130 / 0.4e1 - t947);
  t1405 = 0.1e1 / t77 / t523;
  t1406 = t84 * t1405;
  t1407 = t220 * t1406;
  t1410 = t553 * t27;
  t1411 = t1410 * t218;
  t1414 = t509 * t513;
  t1416 = t571 * t217;
  t1417 = t215 * t1416;
  t1428 = t523 * rho[1];
  t1430 = 0.1e1 / t78 / t1428;
  t1432 = t1430 * t41 * t3;
  t1433 = t75 * t1432;
  t1436 = t509 * t580;
  t1439 = t210 * t578;
  t1440 = t1439 * t99;
  t1441 = t215 * t1440;
  t1444 = -0.35e2 / 0.27e2 * t219 * t1407 - t1411 * t221 / 0.2e1 - t1414 * t221 - t1417 * t221 / 0.2e1 + 0.7e1 / 0.6e1 * t510 * t598 + 0.7e1 / 0.6e1 * t514 * t598 - t1296 / 0.3e1 - t1299 / 0.3e1 + 0.7e1 / 0.18e2 * t1301 + t1235 / 0.9e1 + 0.56e2 / 0.81e2 * t581 * t1433 - 0.8e1 / 0.27e2 * t1436 * t584 - 0.8e1 / 0.27e2 * t1441 * t584;
  t1445 = t218 * t520;
  t1446 = t215 * t1445;
  t1447 = t523 * t197;
  t1448 = 0.1e1 / t1447;
  t1449 = t796 * t1448;
  t1451 = t528 * t2 * t28;
  t1452 = t1449 * t1451;
  t1455 = t226 * t226;
  t1456 = 0.1e1 / t1455;
  t1457 = t224 * t1456;
  t1458 = t215 * t1457;
  t1460 = 0.1e1 / t527 / t91;
  t1462 = t1460 * t2 * t28;
  t1463 = t1449 * t1462;
  t1472 = t579 * t227;
  t1473 = t215 * t1472;
  t1474 = t29 * t206;
  t1475 = t1449 * t1474;
  t1479 = t544 * t190;
  t1486 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t351 - 0.6e1 * t1082);
  t1490 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1075 * t1479 + 0.4e1 / 0.3e1 * t452 * t549 + 0.4e1 / 0.3e1 * t71 * t1486);
  t1491 = t5 * t1490;
  t1498 = t75 * t1430;
  t1501 = t1406 * t206;
  t1508 = t926 * t796;
  t1509 = t1448 * t1460;
  t1512 = -0.2464e4 / 0.2187e4 * t29 * t1498 - 0.28e3 / 0.729e3 * t130 * t1501 + 0.224e3 / 0.2187e4 * t335 * sigma[2] * t1430 * t528 - 0.512e3 / 0.59049e5 * t1508 * t1509;
  t1514 = t27 * t1512 * t100;
  t1519 = -0.64e2 / 0.2187e4 * t1446 * t1452 - 0.64e2 / 0.6561e4 * t1458 * t1463 - 0.64e2 / 0.6561e4 * t522 * t1463 - 0.32e2 / 0.2187e4 * t539 * t1452 - 0.64e2 / 0.19683e5 * t535 * t1463 - 0.64e2 / 0.729e3 * t1473 * t1475 - 0.8e1 / 0.81e2 * t1305 - 0.3e1 / 0.8e1 * t1491 * t101 - 0.9e1 / 0.8e1 * t554 * t212 - 0.9e1 / 0.8e1 * t194 * t573 - 0.3e1 / 0.8e1 * t74 * t1514 - 0.3e1 / 0.8e1 * t1312 + t1213 / 0.4e1;
  t1524 = t228 * t1501;
  t1530 = t1410 * t224;
  t1533 = t509 * t594;
  t1536 = t571 * t98;
  t1537 = t215 * t1536;
  t1540 = t216 * t216;
  t1541 = 0.1e1 / t1540;
  t1542 = t94 * t1541;
  t1543 = t215 * t1542;
  t1544 = t99 * t796;
  t1545 = t1448 * t2;
  t1547 = t1544 * t1545 * t28;
  t1552 = t1223 / 0.4e1 - 0.3e1 / 0.8e1 * t1338 - 0.3e1 / 0.4e1 * t1340 - t1100 - 0.35e2 / 0.81e2 * t225 * t1524 + 0.7e1 / 0.54e2 * t1343 - t1346 / 0.9e1 - t1349 / 0.9e1 - t1530 * t229 / 0.6e1 - t1533 * t229 / 0.3e1 - t1537 * t229 / 0.6e1 - 0.64e2 / 0.243e3 * t1543 * t1547 + 0.7e1 / 0.18e2 * t591 * t587;
  t1557 = t1498 * t540;
  t1560 = t1498 * t530;
  t1565 = t594 * t227;
  t1566 = t215 * t1565;
  t1569 = t509 * t538;
  t1572 = t513 * t227;
  t1573 = t215 * t1572;
  t1576 = t509 * t521;
  t1579 = t594 * t520;
  t1580 = t215 * t1579;
  t1583 = t509 * t534;
  t1588 = 0.7e1 / 0.18e2 * t595 * t587 + t1244 / 0.27e2 - 0.8e1 / 0.729e3 * t1361 + 0.56e2 / 0.243e3 * t539 * t1557 + 0.56e2 / 0.729e3 * t522 * t1560 + 0.28e2 / 0.729e3 * t535 * t1560 - 0.4e1 / 0.243e3 * t1566 * t531 - 0.8e1 / 0.81e2 * t1569 * t541 - 0.8e1 / 0.81e2 * t1573 * t541 - 0.8e1 / 0.243e3 * t1576 * t531 - 0.8e1 / 0.243e3 * t1580 * t531 - 0.4e1 / 0.243e3 * t1583 * t531 - 0.4e1 / 0.729e3 * t1373 - 0.8e1 / 0.243e3 * t1376;
  t1591 = my_piecewise3(t65, 0, t1444 + t1519 + t1552 + t1588);
  tv3rho33 = 0.3e1 * t508 + 0.3e1 * t602 + t6 * (t1403 + t1591);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1597 = t883 * t249;
  t1601 = t286 * t626;
  t1604 = t297 * t650;
  t1608 = t239 * t328;
  t1609 = t148 * t1608;
  t1614 = t906 * t249;
  t1619 = t880 * t249 / 0.72e2;
  t1620 = t296 * t626;
  t1621 = t1620 * t149;
  t1623 = t621 * t145;
  t1624 = t143 * t1623;
  t1631 = t899 * t249 / 0.8e1 + t1597 / 0.24e2 + t902 * t249 / 0.16e2 - t1601 * t149 / 0.3e1 - t1604 / 0.18e2 - t281 * t650 / 0.6e1 + 0.7e1 / 0.36e2 * t147 * t1609 + 0.7e1 / 0.18e2 * t627 * t392 + t1614 / 0.24e2 - t287 * t650 / 0.6e1 - t1619 - t1621 / 0.9e1 - t1624 * t149 / 0.3e1 + t910 * t249 / 0.16e2 + 0.2e1 / 0.243e3 * t1046 * t659;
  t1634 = t302 * t32;
  t1635 = 0.1e1 / t1634;
  t1636 = t1635 * t869;
  t1637 = t29 * t44;
  t1638 = t1636 * t1637;
  t1643 = t30 * t304;
  t1644 = t1643 * t317;
  t1651 = t1643 * t306;
  t1654 = t244 * t370;
  t1655 = t1654 * t59;
  t1656 = t143 * t1655;
  t1661 = t1025 * t647;
  t1665 = t1635 * t2;
  t1667 = t28 * t44 * t134;
  t1668 = t1665 * t1667;
  t1673 = t1665 * t28 * t315 * t44;
  t1680 = t1053 * t659 / 0.243e3 + 0.8e1 / 0.2187e4 * t867 * t1638 + 0.8e1 / 0.2187e4 * t313 * t1638 - 0.5e1 / 0.486e3 * t322 * t1644 + 0.8e1 / 0.6561e4 * t322 * t1638 - 0.5e1 / 0.243e3 * t313 * t1644 - 0.5e1 / 0.81e2 * t301 * t1651 - 0.8e1 / 0.81e2 * t1656 * t376 + 0.2e1 / 0.81e2 * t1022 * t647 + 0.2e1 / 0.243e3 * t1661 + 0.2e1 / 0.81e2 * t1057 * t647 + 0.8e1 / 0.243e3 * t848 * t1668 + 0.8e1 / 0.729e3 * t857 * t1673 + 0.4e1 / 0.729e3 * t301 * t1673 + 0.2e1 / 0.243e3 * t1028 * t659;
  t1684 = t1037 * t659;
  t1686 = t1042 * t659;
  t1688 = t113 * t608;
  t1691 = t291 * t244 * t60;
  t1693 = t26 * t1691 / 0.12e2;
  t1695 = t117 * t621 * t60;
  t1696 = t26 * t1695;
  t1700 = t1608 * t134;
  t1707 = t869 * t44;
  t1710 = 0.176e3 / 0.729e3 * t29 * t1643 + 0.14e2 / 0.243e3 * t130 * t1700 - 0.2e2 / 0.729e3 * t334 * t1643 * t315 + 0.64e2 / 0.19683e5 * t926 * t1635 * t1707;
  t1712 = t27 * t1710 * t60;
  t1719 = t286 * t371;
  t1722 = t286 * t630;
  t1727 = t641 * t375;
  t1730 = t988 * t252;
  t1734 = t1049 * t659 / 0.243e3 + 0.2e1 / 0.729e3 * t1684 + t1686 / 0.729e3 - t1688 / 0.4e1 + t1693 - t1696 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t1712 - 0.3e1 / 0.8e1 * t360 * t246 - 0.3e1 / 0.4e1 * t113 * t623 + 0.2e1 / 0.27e2 * t1719 * t644 - t1722 * t157 / 0.9e1 + 0.7e1 / 0.54e2 * t631 * t379 - 0.5e1 / 0.27e2 * t640 * t1727 + t1730 / 0.72e2 - t382 * t662 / 0.18e2;
  t1736 = t991 * t252 / 0.216e3;
  t1737 = t385 * t662;
  t1741 = t156 * t1700;
  t1744 = t1004 * t252;
  t1748 = t296 * t371;
  t1749 = t1748 * t644;
  t1751 = t143 * t1065;
  t1755 = t59 * t1635 * t1637;
  t1762 = t296 * t630;
  t1763 = t1762 * t157;
  t1765 = t621 * t58;
  t1766 = t143 * t1765;
  t1769 = t626 * t155;
  t1770 = t143 * t1769;
  t1773 = t630 * t311;
  t1774 = t143 * t1773;
  t1777 = t630 * t155;
  t1778 = t143 * t1777;
  t1781 = -t1736 - t1737 / 0.54e2 - t389 * t662 / 0.18e2 + 0.7e1 / 0.108e3 * t153 * t1741 + t1744 / 0.72e2 + t995 * t252 / 0.48e2 + 0.2e1 / 0.81e2 * t1749 + 0.2e1 / 0.27e2 * t1751 * t644 + 0.8e1 / 0.81e2 * t1010 * t1755 + t998 * t252 / 0.48e2 + t1001 * t252 / 0.24e2 - t1763 / 0.27e2 - t1766 * t157 / 0.9e1 - 0.8e1 / 0.243e3 * t1770 * t307 - 0.8e1 / 0.729e3 * t1774 * t318 - 0.4e1 / 0.729e3 * t1778 * t318;
  t1784 = my_piecewise3(t1, 0, t1631 + t1680 + t1734 + t1781);
  tv3rho2sigma0 = t6 * t1784 + 0.2e1 * t668;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1789 = t168 * t673;
  t1792 = t291 * t265 * t100;
  t1794 = t74 * t1792 / 0.12e2;
  t1797 = t1230 * t270;
  t1800 = t1234 * t270 / 0.72e2;
  t1803 = t1240 * t273;
  t1806 = t1243 * t273 / 0.216e3;
  t1808 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t267 - t1789 / 0.4e1 + t1794 + t1226 * t270 / 0.16e2 + t1797 / 0.24e2 - t1800 + t1237 * t273 / 0.48e2 + t1803 / 0.72e2 - t1806);
  tv3rho2sigma2 = t6 * t1808 + 0.2e1 * t685;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1811 = t1121 * t249;
  t1815 = t439 * t626;
  t1834 = t184 * t608;
  t1836 = t1597 / 0.48e2 + t1811 / 0.48e2 - t440 * t650 / 0.12e2 - t1815 * t149 / 0.6e1 + t1117 * t249 / 0.16e2 + t1124 * t249 / 0.16e2 - t1604 / 0.36e2 + t1614 / 0.48e2 - t1619 - t1621 / 0.18e2 + t1179 * t647 / 0.81e2 + t1182 * t659 / 0.243e3 + t1185 * t659 / 0.486e3 + t1661 / 0.243e3 + t1684 / 0.729e3 + t1686 / 0.1458e4 - t1834 / 0.8e1;
  t1847 = t439 * t630;
  t1850 = t439 * t371;
  t1855 = t1168 * t252;
  t1862 = -0.3e1 / 0.8e1 * t432 * t246 - 0.3e1 / 0.8e1 * t184 * t623 - t1688 / 0.8e1 + t1693 - t1696 / 0.8e1 - t443 * t662 / 0.36e2 + t1171 * t252 / 0.48e2 - t1847 * t157 / 0.18e2 + t1850 * t644 / 0.27e2 + t1165 * t252 / 0.48e2 + t1855 / 0.144e3 + t1730 / 0.144e3 - t1736 - t1737 / 0.108e3 + t1744 / 0.144e3 + t1749 / 0.81e2 - t1763 / 0.54e2;
  t1864 = my_piecewise3(t1, 0, t1836 + t1862);
  tv3rho2sigma3 = t6 * t1864 + t668 + t694;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1866 = t1298 * t270;
  t1868 = t478 * t735;
  t1870 = t477 * t713;
  t1871 = t1870 * t221;
  t1873 = t1295 * t270;
  t1875 = t473 * t713;
  t1891 = t1372 * t742;
  t1893 = t1375 * t732;
  t1895 = t1360 * t742;
  t1899 = t1866 / 0.48e2 - t1868 / 0.36e2 - t1871 / 0.18e2 + t1873 / 0.48e2 - t1875 * t221 / 0.6e1 + t1288 * t270 / 0.16e2 + t1291 * t270 / 0.16e2 - t474 * t735 / 0.12e2 + t1797 / 0.48e2 - t1800 + t1363 * t742 / 0.243e3 + t1366 * t742 / 0.486e3 + t1369 * t732 / 0.81e2 + t1891 / 0.1458e4 + t1893 / 0.243e3 + t1895 / 0.729e3 - 0.3e1 / 0.8e1 * t461 * t267;
  t1903 = t117 * t708 * t100;
  t1904 = t74 * t1903;
  t1906 = t194 * t673;
  t1909 = t1348 * t273;
  t1911 = t477 * t717;
  t1912 = t1911 * t229;
  t1914 = t477 * t579;
  t1915 = t1914 * t729;
  t1917 = t473 * t579;
  t1926 = t473 * t717;
  t1930 = t484 * t745;
  t1932 = t1345 * t273;
  t1934 = -0.3e1 / 0.8e1 * t168 * t710 - t1904 / 0.8e1 - t1906 / 0.8e1 - t1789 / 0.8e1 + t1794 + t1909 / 0.144e3 - t1912 / 0.54e2 + t1915 / 0.81e2 + t1917 * t729 / 0.27e2 + t1353 * t273 / 0.48e2 + t1356 * t273 / 0.48e2 - t481 * t745 / 0.36e2 - t1926 * t229 / 0.18e2 + t1803 / 0.144e3 - t1806 - t1930 / 0.108e3 + t1932 / 0.144e3;
  t1936 = my_piecewise3(t65, 0, t1899 + t1934);
  tv3rho2sigma5 = t6 * t1936 + t685 + t751;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1949 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t246 - t1834 / 0.4e1 + t1693 + t1272 * t249 / 0.16e2 + t1811 / 0.24e2 - t1619 + t1275 * t252 / 0.48e2 + t1855 / 0.72e2 - t1736);
  tv3rho2sigma6 = t6 * t1949 + 0.2e1 * t694;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1952 = t717 * t520;
  t1953 = t215 * t1952;
  t1956 = t717 * t227;
  t1957 = t215 * t1956;
  t1960 = t713 * t227;
  t1961 = t215 * t1960;
  t1966 = t509 * t713;
  t1969 = t708 * t217;
  t1970 = t215 * t1969;
  t1981 = t260 * t562;
  t1982 = t220 * t1981;
  t1989 = -0.8e1 / 0.729e3 * t1953 * t531 - 0.4e1 / 0.729e3 * t1957 * t531 - 0.8e1 / 0.243e3 * t1961 * t541 + t1417 * t270 / 0.16e2 - t1966 * t221 / 0.3e1 - t1970 * t221 / 0.3e1 + t1411 * t270 / 0.16e2 + t1414 * t270 / 0.8e1 + t1866 / 0.24e2 - t1868 / 0.18e2 - t1871 / 0.9e1 + t1873 / 0.24e2 + 0.7e1 / 0.36e2 * t219 * t1982 - t510 * t735 / 0.6e1 - t514 * t735 / 0.6e1;
  t1992 = t30 * t525;
  t1993 = t1992 * t530;
  t1996 = t1992 * t540;
  t2001 = t523 * t76;
  t2002 = 0.1e1 / t2001;
  t2003 = t2002 * t1460;
  t2004 = t29 * t84;
  t2005 = t2003 * t2004;
  t2024 = t2002 * t2;
  t2026 = t28 * t84 * t206;
  t2027 = t2024 * t2026;
  t2030 = 0.7e1 / 0.18e2 * t714 * t598 - t1800 - 0.5e1 / 0.243e3 * t522 * t1993 - 0.5e1 / 0.81e2 * t539 * t1996 - 0.5e1 / 0.486e3 * t535 * t1993 + 0.8e1 / 0.6561e4 * t535 * t2005 + 0.2e1 / 0.243e3 * t1580 * t742 + t1566 * t742 / 0.243e3 + 0.8e1 / 0.2187e4 * t1458 * t2005 + 0.8e1 / 0.2187e4 * t522 * t2005 + 0.2e1 / 0.243e3 * t1576 * t742 + t1583 * t742 / 0.243e3 + 0.2e1 / 0.81e2 * t1569 * t732 + 0.2e1 / 0.81e2 * t1573 * t732 + 0.8e1 / 0.243e3 * t1473 * t2027;
  t2033 = t28 * t528 * t84;
  t2034 = t2024 * t2033;
  t2039 = t265 * t578;
  t2040 = t2039 * t99;
  t2041 = t215 * t2040;
  t2053 = t1981 * t206;
  t2060 = t1460 * t84;
  t2063 = 0.176e3 / 0.729e3 * t29 * t1992 + 0.14e2 / 0.243e3 * t130 * t2053 - 0.2e2 / 0.729e3 * t334 * t1992 * t528 + 0.64e2 / 0.19683e5 * t926 * t2002 * t2060;
  t2065 = t27 * t2063 * t100;
  t2072 = t228 * t2053;
  t2077 = 0.8e1 / 0.729e3 * t1446 * t2034 + 0.4e1 / 0.729e3 * t539 * t2034 - 0.8e1 / 0.81e2 * t2041 * t584 + t1891 / 0.729e3 + 0.2e1 / 0.243e3 * t1893 + 0.2e1 / 0.729e3 * t1895 - 0.3e1 / 0.8e1 * t554 * t267 - 0.3e1 / 0.4e1 * t194 * t710 - 0.3e1 / 0.8e1 * t74 * t2065 - t1904 / 0.4e1 - t1906 / 0.4e1 + t1794 - t595 * t745 / 0.18e2 + 0.7e1 / 0.108e3 * t225 * t2072 - t591 * t745 / 0.18e2;
  t2078 = t726 * t583;
  t2089 = t509 * t579;
  t2092 = t215 * t1439;
  t2096 = t99 * t2002 * t2004;
  t2099 = t509 * t717;
  t2102 = t708 * t98;
  t2103 = t215 * t2102;
  t2111 = -0.5e1 / 0.27e2 * t725 * t2078 + 0.7e1 / 0.54e2 * t718 * t587 + t1530 * t273 / 0.48e2 + t1533 * t273 / 0.24e2 + t1537 * t273 / 0.48e2 + 0.2e1 / 0.27e2 * t2089 * t729 + 0.2e1 / 0.27e2 * t2092 * t729 + 0.8e1 / 0.81e2 * t1543 * t2096 - t2099 * t229 / 0.9e1 - t2103 * t229 / 0.9e1 + t1909 / 0.72e2 - t1912 / 0.27e2 + 0.2e1 / 0.81e2 * t1915 - t1806 - t1930 / 0.54e2 + t1932 / 0.72e2;
  t2114 = my_piecewise3(t65, 0, t1989 + t2030 + t2077 + t2111);
  tv3rho2sigma8 = t6 * t2114 + 0.2e1 * t751;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2117 = t1037 * t786 / 0.1944e4;
  t2118 = t773 * t124;
  t2119 = t2118 * t317;
  t2123 = t1042 * t786 / 0.3888e4;
  t2125 = t1025 * t780 / 0.648e3;
  t2126 = t2118 * t306;
  t2143 = -t2117 + t313 * t2119 / 0.486e3 - t2123 - t2125 + t301 * t2126 / 0.162e3 - t1022 * t780 / 0.216e3 - t1057 * t780 / 0.216e3 - t1028 * t786 / 0.648e3 - t1046 * t786 / 0.648e3 + t322 * t2119 / 0.972e3 - t1049 * t786 / 0.1296e4 - t1053 * t786 / 0.1296e4;
  t2145 = t1620 * t249 / 0.24e2;
  t2149 = t297 * t783 / 0.96e2;
  t2150 = t754 * t132;
  t2151 = t148 * t2150;
  t2154 = t764 * t145;
  t2155 = t143 * t2154;
  t2166 = 0.1e1 / t913;
  t2167 = t239 * t2166;
  t2168 = t2167 * t871;
  t2175 = t2145 - t627 * t650 / 0.6e1 - t2149 + t147 * t2151 / 0.24e2 - t2155 * t149 / 0.6e1 + t1601 * t249 / 0.8e1 + t1624 * t249 / 0.8e1 - t287 * t783 / 0.32e2 - t281 * t783 / 0.32e2 - t322 * t2168 / 0.2187e4 + 0.2e1 / 0.81e2 * t1770 * t647 + 0.2e1 / 0.243e3 * t1774 * t659;
  t2180 = t844 * t776 / 0.216e3;
  t2181 = t773 * t643;
  t2188 = t2167 * t852;
  t2191 = t2167 * t858;
  t2201 = t117 * t764 * t60;
  t2203 = t26 * t2201 / 0.8e1;
  t2206 = t1778 * t659 / 0.243e3 - t2180 + t373 * t2181 / 0.54e2 - t841 * t776 / 0.72e2 - t1067 * t776 / 0.72e2 - t848 * t2188 / 0.81e2 - t857 * t2191 / 0.243e3 - t301 * t2191 / 0.486e3 - t867 * t2168 / 0.729e3 - t313 * t2168 / 0.729e3 - t2203 - 0.3e1 / 0.8e1 * t113 * t766;
  t2207 = t2150 * t134;
  t2214 = t926 * t239;
  t2218 = t130 * t2207 / 0.81e2 + 0.2e1 / 0.729e3 * t335 * t759 * t124 * t315 - 0.8e1 / 0.6561e4 * t2214 * t2166 * t869;
  t2220 = t27 * t2218 * t60;
  t2224 = t385 * t789 / 0.288e3;
  t2225 = t156 * t2207;
  t2229 = t1762 * t252 / 0.72e2;
  t2232 = t143 * t1654;
  t2239 = t59 * t239;
  t2242 = t2239 * t2166 * t2 * t28;
  t2249 = t764 * t58;
  t2250 = t143 * t2249;
  t2253 = -0.3e1 / 0.8e1 * t26 * t2220 - t2224 + t153 * t2225 / 0.72e2 + t2229 - t631 * t662 / 0.18e2 + 0.2e1 / 0.27e2 * t2232 * t644 + t1722 * t252 / 0.24e2 + t1766 * t252 / 0.24e2 - t1010 * t2242 / 0.27e2 - t382 * t789 / 0.96e2 - t389 * t789 / 0.96e2 - t2250 * t157 / 0.18e2;
  t2256 = my_piecewise3(t1, 0, t2143 + t2175 + t2206 + t2253);
  tv3rhosigma20 = t6 * t2256 + t795;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2261 = t117 * t807 * t100;
  t2263 = t74 * t2261 / 0.8e1;
  t2267 = t1870 * t270 / 0.24e2;
  t2271 = t1911 * t273 / 0.72e2;
  t2275 = t1304 * t819 / 0.216e3;
  t2279 = t1375 * t823 / 0.648e3;
  t2283 = t478 * t826 / 0.96e2;
  t2287 = t1360 * t829 / 0.1944e4;
  t2291 = t484 * t832 / 0.288e3;
  t2295 = t1372 * t829 / 0.3888e4;
  t2296 = -0.3e1 / 0.8e1 * t168 * t809 - t2263 + t1875 * t270 / 0.8e1 + t2267 + t1926 * t273 / 0.24e2 + t2271 - t1307 * t819 / 0.72e2 - t2275 - t1369 * t823 / 0.216e3 - t2279 - t474 * t826 / 0.32e2 - t2283 - t1363 * t829 / 0.648e3 - t2287 - t481 * t832 / 0.96e2 - t2291 - t1366 * t829 / 0.1296e4 - t2295;
  t2297 = my_piecewise3(t65, 0, t2296);
  tv3rhosigma25 = t6 * t2297 + t838;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2317 = -0.3e1 / 0.8e1 * t184 * t766 - t2203 + t1815 * t249 / 0.8e1 + t2145 + t1847 * t252 / 0.24e2 + t2229 - t1110 * t776 / 0.72e2 - t2180 - t1179 * t780 / 0.216e3 - t2125 - t440 * t783 / 0.32e2 - t2149 - t1182 * t786 / 0.648e3 - t2117 - t443 * t789 / 0.96e2 - t2224 - t1185 * t786 / 0.1296e4 - t2123;
  t2318 = my_piecewise3(t1, 0, t2317);
  tv3rhosigma26 = t6 * t2318 + t795;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2320 = t816 * t199;
  t2321 = t2320 * t530;
  t2324 = t2320 * t540;
  t2341 = t522 * t2321 / 0.486e3 + t539 * t2324 / 0.162e3 - t2279 - t2287 - t2295 - t1569 * t823 / 0.216e3 - t1573 * t823 / 0.216e3 - t1576 * t829 / 0.648e3 - t1580 * t829 / 0.648e3 + t535 * t2321 / 0.972e3 - t1583 * t829 / 0.1296e4 - t1566 * t829 / 0.1296e4;
  t2344 = t797 * t204;
  t2345 = t220 * t2344;
  t2354 = t807 * t217;
  t2355 = t215 * t2354;
  t2360 = t816 * t728;
  t2363 = 0.1e1 / t1428;
  t2364 = t260 * t2363;
  t2365 = t2364 * t1462;
  t2370 = t2267 - t2283 - t714 * t735 / 0.6e1 + t219 * t2345 / 0.24e2 + t1970 * t270 / 0.8e1 - t510 * t826 / 0.32e2 - t514 * t826 / 0.32e2 - t2355 * t221 / 0.6e1 + t1966 * t270 / 0.8e1 + t581 * t2360 / 0.54e2 - t535 * t2365 / 0.2187e4 + 0.2e1 / 0.243e3 * t1953 * t742;
  t2378 = t2364 * t1474;
  t2381 = t2364 * t1451;
  t2394 = t2344 * t206;
  t2401 = t926 * t260;
  t2405 = t130 * t2394 / 0.81e2 + 0.2e1 / 0.729e3 * t335 * t802 * t199 * t528 - 0.8e1 / 0.6561e4 * t2401 * t2363 * t1460;
  t2407 = t27 * t2405 * t100;
  t2410 = t1957 * t742 / 0.243e3 - t1436 * t819 / 0.72e2 - t1441 * t819 / 0.72e2 - t1473 * t2378 / 0.81e2 - t1446 * t2381 / 0.243e3 - t539 * t2381 / 0.486e3 - t1458 * t2365 / 0.729e3 - t522 * t2365 / 0.729e3 + 0.2e1 / 0.81e2 * t1961 * t732 - t2275 - 0.3e1 / 0.8e1 * t194 * t809 - 0.3e1 / 0.8e1 * t74 * t2407;
  t2411 = t228 * t2394;
  t2416 = t807 * t98;
  t2417 = t215 * t2416;
  t2420 = t215 * t2039;
  t2427 = t99 * t260;
  t2430 = t2427 * t2363 * t2 * t28;
  t2437 = -t2263 + t2271 - t2291 + t225 * t2411 / 0.72e2 - t718 * t745 / 0.18e2 - t2417 * t229 / 0.18e2 + 0.2e1 / 0.27e2 * t2420 * t729 + t2099 * t273 / 0.24e2 + t2103 * t273 / 0.24e2 - t1543 * t2430 / 0.27e2 - t591 * t832 / 0.96e2 - t595 * t832 / 0.96e2;
  t2440 = my_piecewise3(t65, 0, t2341 + t2370 + t2410 + t2437);
  tv3rhosigma211 = t6 * t2440 + t838;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2442 = sigma[0] * sigma[0];
  t2443 = 0.1e1 / t2442;
  t2444 = t30 * t2443;
  t2445 = t2444 * t36;
  t2446 = t2445 * t317;
  t2453 = t2444 * t775;
  t2458 = 0.1e1 / t302;
  t2459 = t754 * t2458;
  t2460 = t2459 * t871;
  t2466 = 0.1e1 / t44 / t2442;
  t2467 = t2466 * t47;
  t2468 = t2467 * t134;
  t2469 = t156 * t2468;
  t2478 = t322 * t2446 / 0.864e3 - t1774 * t786 / 0.216e3 - t1778 * t786 / 0.432e3 + t373 * t2453 / 0.48e2 - t1770 * t780 / 0.72e2 + t867 * t2460 / 0.1944e4 + t313 * t2460 / 0.1944e4 + t153 * t2469 / 0.64e2 + t322 * t2460 / 0.5832e4 - t1656 * t776 / 0.24e2 - t631 * t789 / 0.32e2;
  t2479 = t2459 * t852;
  t2482 = t2459 * t858;
  t2493 = t2458 * t2 * t28;
  t2494 = t59 * t754 * t2493;
  t2497 = t148 * t2467;
  t2502 = t2445 * t306;
  t2514 = t2458 * t869;
  t2517 = t130 * t2468 / 0.72e2 + t335 * t2443 * t36 * t315 / 0.324e3 + t926 * t754 * t2514 / 0.2187e4;
  t2519 = t27 * t2517 * t60;
  t2522 = t848 * t2479 / 0.216e3 + t857 * t2482 / 0.648e3 + t301 * t2482 / 0.1296e4 + t2250 * t252 / 0.16e2 - 0.3e1 / 0.32e2 * t627 * t783 + t1010 * t2494 / 0.72e2 + 0.3e1 / 0.64e2 * t147 * t2497 + 0.3e1 / 0.16e2 * t2155 * t249 + t301 * t2502 / 0.144e3 + t313 * t2446 / 0.432e3 - 0.3e1 / 0.8e1 * t26 * t2519;
  t2524 = my_piecewise3(t1, 0, t2478 + t2522);
  tv3sigma30 = t6 * t2524;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2525 = sigma[2] * sigma[2];
  t2527 = 0.1e1 / t84 / t2525;
  t2528 = t2527 * t87;
  t2529 = t220 * t2528;
  t2537 = 0.1e1 / t523;
  t2539 = t2537 * t2 * t28;
  t2540 = t99 * t797 * t2539;
  t2543 = 0.1e1 / t2525;
  t2544 = t30 * t2543;
  t2545 = t2544 * t80;
  t2546 = t2545 * t530;
  t2555 = t2544 * t818;
  t2558 = t797 * t2537;
  t2559 = t2558 * t1451;
  t2564 = 0.3e1 / 0.64e2 * t219 * t2529 + t2417 * t273 / 0.16e2 - 0.3e1 / 0.32e2 * t714 * t826 + t1543 * t2540 / 0.72e2 + t535 * t2546 / 0.864e3 - t1961 * t823 / 0.72e2 - t1953 * t829 / 0.216e3 - t1957 * t829 / 0.432e3 + t581 * t2555 / 0.48e2 + t1446 * t2559 / 0.648e3 + t539 * t2559 / 0.1296e4;
  t2565 = t2558 * t1462;
  t2570 = t2528 * t206;
  t2571 = t228 * t2570;
  t2580 = t2558 * t1474;
  t2585 = t2545 * t540;
  t2597 = t2537 * t1460;
  t2600 = t130 * t2570 / 0.72e2 + t335 * t2543 * t80 * t528 / 0.324e3 + t926 * t797 * t2597 / 0.2187e4;
  t2602 = t27 * t2600 * t100;
  t2605 = t1458 * t2565 / 0.1944e4 + t522 * t2565 / 0.1944e4 + t225 * t2571 / 0.64e2 + t535 * t2565 / 0.5832e4 - t2041 * t819 / 0.24e2 - t718 * t832 / 0.32e2 + t1473 * t2580 / 0.216e3 + 0.3e1 / 0.16e2 * t2355 * t270 + t539 * t2585 / 0.144e3 + t522 * t2546 / 0.432e3 - 0.3e1 / 0.8e1 * t74 * t2602;
  t2607 = my_piecewise3(t65, 0, t2564 + t2605);
  tv3sigma39 = t6 * t2607;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t40, t41, t42, t43;
  double t44, t47, t49, t51, t52, t54, t57, t58;
  double t59, t60, t61, t64, t65, t66, t68, t69;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t80, t84, t87, t89, t91, t92, t94, t97;
  double t98, t99, t100, t101, t104, tzk0;

  double t105, t106, t107, t109, t112, t113, t116, t117;
  double t119, t121, t122, t124, t130, t132, t133, t134;
  double t135, t138, t140, t143, t144, t145, t146, t147;
  double t148, t149, t152, t153, t154, t155, t156, t157;
  double t161, t162, t164, t167, t168, t172, t174, t176;
  double tvrho0, t180, t183, t184, t188, t190, t193, t194;
  double t197, t199, t204, t205, t206, t207, t210, t212;
  double t215, t216, t217, t218, t219, t220, t221, t224;
  double t225, t226, t227, t228, t229, t233, tvrho1, t239;
  double t240, t241, t244, t246, t249, t252, t256, tvsigma0;
  double tvsigma1, t260, t261, t262, t265, t267, t270, t273;
  double t277, tvsigma2;

  double t280, t281, t284, t286, t287, t291, t293, t295;
  double t296, t297, t298, t300, t301, t302, t304, t305;
  double t306, t307, t311, t312, t313, t314, t315, t317;
  double t318, t321, t322, t328, t329, t330, t334, t335;
  double t340, t342, t345, t346, t347, t350, t351, t352;
  double t355, t359, t360, t366, t367, t370, t371, t372;
  double t373, t375, t376, t379, t382, t385, t386, t388;
  double t389, t392, t395, t396, t397, t398, t399, t402;
  double t405, t409, t410, t413, t416, t418, t420, tv2rho20;
  double t423, t427, t431, t432, t435, t439, t440, t443;
  double t451, t452, t456, t460, t461, t464, t470, t471;
  double t473, t474, t477, t478, t479, t481, t484, t485;
  double t488, tv2rho21, t493, t498, t502, t503, t508, t509;
  double t510, t513, t514, t520, t521, t522, t523, t525;
  double t526, t527, t528, t530, t531, t534, t535, t538;
  double t539, t540, t541, t544, t549, t553, t554, t562;
  double t563, t564, t571, t573, t578, t579, t580, t581;
  double t583, t584, t587, t591, t594, t595, t598, t601;
  double t602, tv2rho22, t608, t610, t611, t614, t615, t621;
  double t623, t626, t627, t630, t631, t637, t640, t641;
  double t643, t644, t647, t650, t656, t659, t662, t667;
  double t668, tv2rhosigma0, tv2rhosigma1, t673, t675, t679, t683, t685;
  double tv2rhosigma2, t694, tv2rhosigma3, tv2rhosigma4, t698, t701, t702, t708;
  double t710, t713, t714, t717, t718, t725, t726, t728;
  double t729, t732, t735, t742, t745, t750, t751, tv2rhosigma5;
  double t753, t754, t755, t756, t759, t764, t766, t773;
  double t775, t776, t779, t780, t783, t786, t789, t795;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t796, t797, t798;
  double t799, t802, t807, t809, t816, t818, t819, t822;
  double t823, t826, t829, t832, t838, tv2sigma25;

  double t841, t844, t845, t847, t848, t849, t850, t851;
  double t852, t853, t856, t857, t858, t859, t864, t865;
  double t866, t867, t869, t871, t872, t879, t880, t881;
  double t883, t884, t890, t892, t894, t895, t896, t899;
  double t901, t902, t905, t906, t907, t909, t910, t913;
  double t915, t916, t919, t926, t927, t928, t931, t933;
  double t937, t938, t940, t943, t945, t947, t949, t950;
  double t953, t956, t957, t958, t961, t965, t966, t971;
  double t973, t975, t978, t979, t983, t985, t988, t989;
  double t991, t992, t994, t995, t998, t1001, t1004, t1005;
  double t1007, t1008, t1009, t1010, t1011, t1012, t1014, t1021;
  double t1022, t1025, t1026, t1028, t1031, t1034, t1037, t1038;
  double t1042, t1043, t1045, t1046, t1049, t1052, t1053, t1056;
  double t1057, t1061, t1062, t1065, t1066, t1067, t1070, t1073;
  double t1075, t1076, t1079, t1082, t1085, t1089, t1090, t1093;
  double t1095, t1098, t1100, t1102, tv3rho30, t1105, t1106, t1110;
  double t1116, t1117, t1120, t1121, t1123, t1124, t1129, t1130;
  double t1132, t1135, t1140, t1141, t1143, t1147, t1148, t1154;
  double t1159, t1165, t1168, t1170, t1171, t1179, t1182, t1185;
  double t1190, t1192, t1193, t1196, t1201, t1203, t1207, t1208;
  double t1212, t1213, t1220, t1222, t1223, t1225, t1226, t1229;
  double t1230, t1232, t1233, t1234, t1235, t1237, t1240, t1242;
  double t1243, t1244, t1246, t1247, tv3rho31, t1250, t1255, t1259;
  double t1263, t1264, t1267, t1271, t1272, t1275, t1283, t1284;
  double t1287, t1288, t1291, t1294, t1295, t1296, t1298, t1299;
  double t1301, t1304, t1305, t1307, t1311, t1312, t1314, t1319;
  double t1323, t1327, t1328, t1337, t1338, t1340, t1343, t1345;
  double t1346, t1348, t1349, t1353, t1356, t1360, t1361, t1363;
  double t1366, t1369, t1372, t1373, t1375, t1376, t1378, t1380;
  double tv3rho32, t1385, t1392, t1396, t1397, t1403, t1405, t1406;
  double t1407, t1410, t1411, t1414, t1416, t1417, t1428, t1430;
  double t1432, t1433, t1436, t1439, t1440, t1441, t1444, t1445;
  double t1446, t1447, t1448, t1449, t1451, t1452, t1455, t1456;
  double t1457, t1458, t1460, t1462, t1463, t1472, t1473, t1474;
  double t1475, t1479, t1486, t1490, t1491, t1498, t1501, t1508;
  double t1509, t1512, t1514, t1519, t1524, t1530, t1533, t1536;
  double t1537, t1540, t1541, t1542, t1543, t1544, t1545, t1547;
  double t1552, t1557, t1560, t1565, t1566, t1569, t1572, t1573;
  double t1576, t1579, t1580, t1583, t1588, t1591, tv3rho33, t1597;
  double t1601, t1604, t1608, t1609, t1614, t1619, t1620, t1621;
  double t1623, t1624, t1631, t1634, t1635, t1636, t1637, t1638;
  double t1643, t1644, t1651, t1654, t1655, t1656, t1661, t1665;
  double t1667, t1668, t1673, t1680, t1684, t1686, t1688, t1691;
  double t1693, t1695, t1696, t1700, t1707, t1710, t1712, t1719;
  double t1722, t1727, t1730, t1734, t1736, t1737, t1741, t1744;
  double t1748, t1749, t1751, t1755, t1762, t1763, t1765, t1766;
  double t1769, t1770, t1773, t1774, t1777, t1778, t1781, t1784;
  double tv3rho2sigma0, tv3rho2sigma1, t1789, t1792, t1794, t1797, t1800, t1803;
  double t1806, t1808, tv3rho2sigma2, t1811, t1815, t1834, t1836, t1847;
  double t1850, t1855, t1862, t1864, tv3rho2sigma3, tv3rho2sigma4, t1866, t1868;
  double t1870, t1871, t1873, t1875, t1891, t1893, t1895, t1899;
  double t1903, t1904, t1906, t1909, t1911, t1912, t1914, t1915;
  double t1917, t1926, t1930, t1932, t1934, t1936, tv3rho2sigma5, t1949;
  double tv3rho2sigma6, tv3rho2sigma7, t1952, t1953, t1956, t1957, t1960, t1961;
  double t1966, t1969, t1970, t1981, t1982, t1989, t1992, t1993;
  double t1996, t2001, t2002, t2003, t2004, t2005, t2024, t2026;
  double t2027, t2030, t2033, t2034, t2039, t2040, t2041, t2053;
  double t2060, t2063, t2065, t2072, t2077, t2078, t2089, t2092;
  double t2096, t2099, t2102, t2103, t2111, t2114, tv3rho2sigma8, t2117;
  double t2118, t2119, t2123, t2125, t2126, t2143, t2145, t2149;
  double t2150, t2151, t2154, t2155, t2166, t2167, t2168, t2175;
  double t2180, t2181, t2188, t2191, t2201, t2203, t2206, t2207;
  double t2214, t2218, t2220, t2224, t2225, t2229, t2232, t2239;
  double t2242, t2249, t2250, t2253, t2256, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22;
  double tv3rhosigma23, tv3rhosigma24, t2261, t2263, t2267, t2271, t2275, t2279;
  double t2283, t2287, t2291, t2295, t2296, t2297, tv3rhosigma25, t2317;
  double t2318, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2320, t2321;
  double t2324, t2341, t2344, t2345, t2354, t2355, t2360, t2363;
  double t2364, t2365, t2370, t2378, t2381, t2394, t2401, t2405;
  double t2407, t2410, t2411, t2416, t2417, t2420, t2427, t2430;
  double t2437, t2440, tv3rhosigma211, t2442, t2443, t2444, t2445, t2446;
  double t2453, t2458, t2459, t2460, t2466, t2467, t2468, t2469;
  double t2478, t2479, t2482, t2493, t2494, t2497, t2502, t2514;
  double t2517, t2519, t2522, t2524, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2525, t2527, t2528;
  double t2529, t2537, t2539, t2540, t2543, t2544, t2545, t2546;
  double t2555, t2558, t2559, t2564, t2565, t2570, t2571, t2580;
  double t2585, t2597, t2600, t2602, t2605, t2607, tv3sigma39;

  double t2610, t2611, t2613, t2614, t2616, t2619, t2620, t2621;
  double t2624, t2625, t2627, t2631, t2636, t2640, t2643, t2644;
  double t2646, t2649, t2650, t2652, t2657, t2660, t2664, t2667;
  double t2670, t2674, t2681, t2682, t2684, t2685, t2691, t2692;
  double t2694, t2695, t2701, t2703, t2705, t2707, t2711, t2715;
  double t2716, t2720, t2721, t2723, t2726, t2730, t2733, t2734;
  double t2735, t2737, t2738, t2739, t2741, t2742, t2745, t2746;
  double t2747, t2749, t2750, t2753, t2754, t2758, t2759, t2760;
  double t2761, t2762, t2766, t2770, t2790, t2798, t2801, t2802;
  double t2804, t2805, t2807, t2810, t2814, t2816, t2818, t2821;
  double t2823, t2826, t2827, t2831, t2832, t2834, t2842, t2845;
  double t2846, t2848, t2853, t2855, t2856, t2862, t2864, t2865;
  double t2870, t2873, t2876, t2879, t2880, t2882, t2885, t2888;
  double t2889, t2892, t2894, t2895, t2896, t2898, t2899, t2910;
  double t2914, t2916, t2918, t2919, t2925, t2931, t2932, t2935;
  double t2939, t2947, t2949, t2951, t2953, t2956, t2960, t2965;
  double t2975, t2979, t2987, t2991, t2993, t2995, t3005, t3007;
  double t3012, t3019, t3022, t3024, t3028, t3031, t3034, t3035;
  double t3037, t3039, t3050, t3053, t3056, t3057, t3059, t3060;
  double t3062, t3063, t3065, t3066, t3068, t3069, t3071, t3072;
  double t3074, t3078, t3079, t3081, t3082, t3088, t3093, t3096;
  double t3100, t3104, t3106, t3108, t3113, t3115, tv4rho40, t3122;
  double t3125, t3126, t3128, t3131, t3134, t3137, t3140, t3148;
  double t3150, t3151, t3155, t3156, t3170, t3174, t3182, t3185;
  double t3186, t3187, t3189, t3190, t3193, t3195, t3196, t3197;
  double t3198, t3199, t3200, t3201, t3209, t3210, t3212, t3215;
  double t3218, t3223, t3230, t3233, t3246, t3250, t3251, t3252;
  double t3253, t3255, t3257, t3259, t3260, t3277, t3278, t3280;
  double t3284, t3297, t3311, t3317, t3319, t3322, t3325, t3326;
  double t3328, t3331, t3338, t3339, t3341, t3342, t3343, t3344;
  double t3348, t3349, t3350, t3351, t3353, t3354, t3355, t3356;
  double t3357, t3358, t3359, t3363, t3365, t3366, t3369, t3371;
  double t3372, t3373, t3375, t3377, t3378, t3398, t3400, t3404;
  double t3410, t3411, t3413, t3416, t3417, t3419, t3420, t3421;
  double t3422, t3423, tv4rho41, t3430, t3433, t3436, t3447, t3450;
  double t3451, t3454, t3455, t3456, t3458, t3467, t3472, t3474;
  double t3484, t3497, t3501, t3505, t3509, t3522, t3535, t3538;
  double t3539, t3541, t3544, t3547, t3548, t3549, t3551, t3552;
  double t3554, t3555, t3557, t3560, t3563, t3566, t3567, t3569;
  double t3570, t3572, t3573, t3575, t3576, t3578, t3580, t3581;
  double t3582, t3584, t3585, t3587, t3588, t3589, t3590, t3592;
  double t3594, t3599, t3600, t3606, t3607, t3609, t3612, t3613;
  double t3615, t3617, t3619, t3621, t3631, t3644, t3648, t3656;
  double t3658, t3662, t3671, t3676, t3678, t3679, t3681, t3682;
  double t3686, t3689, t3692, t3694, t3695, t3697, t3698, t3700;
  double t3703, tv4rho42, t3724, t3728, t3732, t3736, t3737, t3740;
  double t3753, t3754, t3755, t3760, t3763, t3770, t3771, t3773;
  double t3774, t3776, t3777, t3779, t3781, t3783, t3785, t3788;
  double t3789, t3792, t3801, t3802, t3804, t3805, t3807, t3808;
  double t3810, t3812, t3814, t3816, t3817, t3818, t3820, t3821;
  double t3823, t3824, t3826, t3834, t3835, t3838, t3840, t3846;
  double t3851, t3852, t3854, t3856, t3862, t3863, t3865, t3867;
  double t3869, t3871, t3874, t3875, t3877, t3878, t3880, t3881;
  double t3887, t3892, t3895, t3898, t3918, t3922, t3928, t3933;
  double t3935, t3939, t3941, t3950, t3961, t3962, t3964, t3965;
  double t3967, t3969, t3971, t3972, t3974, t3975, t3977, t3978;
  double t3986, t3989, t3992, t3995, t3998, t4002, tv4rho43, t4007;
  double t4012, t4019, t4023, t4031, t4034, t4037, t4040, t4044;
  double t4048, t4052, t4060, t4061, t4065, t4068, t4071, t4074;
  double t4081, t4104, t4107, t4108, t4119, t4126, t4127, t4130;
  double t4133, t4140, t4145, t4148, t4154, t4158, t4161, t4167;
  double t4170, t4171, t4172, t4173, t4176, t4179, t4182, t4184;
  double t4188, t4191, t4192, t4193, t4194, t4201, t4204, t4215;
  double t4216, t4218, t4219, t4223, t4224, t4228, t4230, t4238;
  double t4239, t4245, t4249, t4256, t4269, t4274, t4281, t4285;
  double t4297, t4310, t4320, t4341, t4363, t4366, t4369, t4373;
  double t4376, t4380, t4386, t4393, t4397, tv4rho44, t4403, t4406;
  double t4409, t4412, t4413, t4415, t4416, t4418, t4419, t4422;
  double t4426, t4430, t4439, t4448, t4452, t4456, t4457, t4458;
  double t4460, t4462, t4466, t4470, t4474, t4476, t4478, t4480;
  double t4486, t4493, t4495, t4499, t4501, t4502, t4504, t4510;
  double t4513, t4515, t4519, t4523, t4527, t4530, t4540, t4552;
  double t4557, t4558, t4559, t4563, t4564, t4570, t4573, t4588;
  double t4590, t4592, t4594, t4596, t4604, t4606, t4608, t4611;
  double t4614, t4616, t4620, t4625, t4638, t4640, t4645, t4648;
  double t4657, t4661, t4667, t4680, t4689, t4691, t4692, t4694;
  double t4696, t4701, t4707, t4731, t4733, t4735, t4742, t4744;
  double t4746, t4748, t4757, t4759, t4763, t4764, t4766, t4768;
  double t4776, t4780, t4787, t4788, t4797, t4799, t4801, t4804;
  double t4812, t4814, t4819, t4820, t4822, t4823, t4825, t4829;
  double t4833, t4835, t4845, t4859, t4861, t4867, t4870, t4872;
  double t4877, tv4rho3sigma0, tv4rho3sigma1, t4882, t4884, t4889, t4892, t4894;
  double t4897, t4900, t4902, t4905, t4906, t4907, tv4rho3sigma2, t4909;
  double t4913, t4916, t4919, t4930, t4936, t4938, t4945, t4953;
  double t4973, t4976, t4981, t4986, t4988, t4990, t4995, t4997;
  double t4998, t5001, t5010, t5013, t5019, t5037, t5039, t5043;
  double t5045, t5047, t5068, t5089, t5099, t5102, t5104, t5105;
  double t5107, t5111, t5114, t5118, tv4rho3sigma3, tv4rho3sigma4, t5120, t5122;
  double t5124, t5131, t5133, t5137, t5141, t5143, t5144, t5145;
  double t5147, t5150, t5155, t5156, t5158, t5160, t5161, t5164;
  double t5166, t5175, t5179, t5180, t5182, t5184, t5185, t5195;
  double t5196, t5197, t5199, t5201, t5203, t5204, t5212, t5214;
  double t5216, t5219, t5221, t5223, t5226, t5229, tv4rho3sigma5, t5239;
  double t5243, t5244, t5254, t5260, t5262, t5269, t5278, t5289;
  double t5292, tv4rho3sigma6, tv4rho3sigma7, t5300, t5304, t5306, t5318, t5329;
  double t5331, t5332, t5334, t5335, t5337, t5340, t5343, t5345;
  double t5347, t5349, t5351, t5353, t5355, t5357, t5359, t5361;
  double t5364, t5376, t5380, t5381, t5383, t5386, t5389, t5392;
  double t5393, t5395, t5396, t5400, t5406, t5408, t5410, t5412;
  double t5414, t5415, t5417, t5418, t5420, t5422, t5424, t5432;
  double t5441, t5444, t5454, t5457, t5485, t5487, t5489, t5490;
  double t5492, t5494, t5495, t5497, t5499, t5501, t5503, t5505;
  double t5507, t5509, t5511, t5513, t5515, t5517, t5520, t5524;
  double tv4rho3sigma8, t5539, t5540, tv4rho3sigma9, tv4rho3sigma10, t5549, t5552, t5553;
  double t5563, t5581, t5586, t5589, t5606, t5622, t5623, t5627;
  double t5636, t5660, t5663, t5666, t5669, t5672, t5674, t5678;
  double t5722, t5748, t5760, t5774, t5777, t5780, t5785, t5808;
  double t5812, t5815, t5823, t5826, t5829, t5834, t5839, t5851;
  double t5865, t5868, t5871, t5896, t5909, t5916, t5920, t5929;
  double t5934, tv4rho3sigma11, t5937, t5941, t5947, t5948, t5958, t5970;
  double t5999, t6024, t6026, t6032, t6033, t6036, t6040, t6042;
  double t6044, t6048, t6052, t6057, t6059, t6062, t6070, t6071;
  double t6073, t6076, t6082, t6086, t6088, t6092, t6093, t6095;
  double t6102, t6111, t6118, t6138, t6142, t6147, t6170, t6172;
  double t6178, t6179, t6183, t6190, t6191, t6196, t6197, t6198;
  double t6204, t6206, t6208, t6209, t6211, t6213, t6215, t6238;
  double t6242, t6245, t6248, t6251, t6253, t6259, t6272, t6274;
  double t6276, t6278, t6280, t6285, t6286, t6292, t6294, t6296;
  double t6297, t6299, t6301, t6311, t6313, t6319, t6323, t6338;
  double t6342, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t6348, t6349;
  double t6354, t6355, t6362, t6363, t6366, t6367, t6373, t6374;
  double t6377, t6378, t6381, t6382, t6385, t6391, t6392, t6395;
  double t6396, t6402, t6404, tv4rho2sigma25, t6406, t6426, t6437, t6446;
  double t6464, t6469, t6472, t6476, t6485, t6492, t6494, t6498;
  double t6504, t6520, t6532, t6542, t6546, t6548, t6555, t6559;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t6563, t6565, t6576;
  double t6579, t6581, t6583, t6585, t6586, t6588, t6589, t6592;
  double t6594, t6605, t6607, t6609, t6611, t6613, t6615, t6617;
  double t6619, t6621, t6623, t6625, t6627, t6629, t6631, t6633;
  double t6635, t6637, t6639, t6640, t6642, t6644, t6646, t6664;
  double t6676, t6678, t6682, t6697, t6704, t6718, t6725, t6730;
  double t6732, t6734, t6735, t6737, t6739, t6741, t6743, t6745;
  double t6749, tv4rho2sigma211, t6768, t6780, t6782, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214;
  double tv4rho2sigma215, tv4rho2sigma216, t6792, t6793, t6797, t6804, t6830, t6834;
  double t6837, t6873, t6874, t6883, t6913, t6914, t6922, t6926;
  double t6929, t6931, t6955, t6956, t6959, t6968, t7012, t7018;
  double t7020, t7048, t7079, t7106, t7110, t7122, t7126, tv4rho2sigma217;
  double t7151, t7152, t7153, t7156, t7159, t7173, t7187, t7189;
  double t7211, t7213, t7215, t7216, t7220, t7222, t7224, t7226;
  double t7237, t7246, t7267, t7269, t7273, t7274, t7275, t7280;
  double t7283, t7285, t7287, t7289, t7293, t7297, t7298, t7299;
  double t7303, t7313, t7355, t7356, t7370, t7374, t7378, t7383;
  double t7386, t7390, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35;
  double tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t7393, t7395, t7397, t7414, t7416;
  double t7418, t7420, t7422, t7424, t7426, t7428, t7430, t7432;
  double t7437, t7452, t7454, t7456, t7458, t7460, t7461, t7463;
  double t7471, t7481, t7483, t7485, t7486, t7489, tv4rhosigma39, t7507;
  double t7516, t7530, t7539, t7542, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313;
  double tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t7548, t7549, t7573;
  double t7577, t7578, t7579, t7582, t7599, t7606, t7635, t7639;
  double t7648, t7651, t7652, t7681, t7705, t7732, t7741, t7756;
  double t7760, tv4rhosigma319, t7768, t7769, t7770, t7771, t7772, t7790;
  double t7797, t7803, t7804, t7807, t7812, t7815, t7824, t7826;
  double t7849, t7852, t7853, t7902, t7905, tv4sigma40, tv4sigma41, tv4sigma42;
  double tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410;
  double tv4sigma411, tv4sigma412, tv4sigma413, t7908, t7909, t7910, t7911, t7912;
  double t7935, t7936, t7937, t7940, t7949, t7959, t7960, t7963;
  double t7968, t7993, t7996, t7997, t8046, t8049, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = t18 + 0.1e1;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t3 * t3;
  t29 = t2 * t28;
  t30 = M_CBRT2;
  t31 = t30 * sigma[0];
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t40 = M_PI * M_PI;
  t41 = t2 * t2;
  t42 = t41 * t3;
  t43 = t30 * t30;
  t44 = sqrt(sigma[0]);
  t47 = 0.1e1 / t33 / rho[0];
  t49 = t42 * t43 * t44 * t47;
  t51 = t49 / 0.27e2 + 0.1e1;
  t52 = log(t51);
  t54 = 0.2e1 / 0.81e2 * t29 * t31 * t36 + t40 * t52;
  t57 = t49 / 0.9e1 + t40;
  t58 = 0.1e1 / t57;
  t59 = 0.1e1 / t52;
  t60 = t58 * t59;
  t61 = t27 * t54 * t60;
  t64 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t61);
  t65 = rho[1] <= p->dens_threshold;
  t66 = -t16;
  t68 = my_piecewise5(t14, t11, t10, t15, t66 * t7);
  t69 = t68 + 0.1e1;
  t70 = t69 <= p->zeta_threshold;
  t71 = POW_1_3(t69);
  t73 = my_piecewise3(t70, t22, t71 * t69);
  t74 = t5 * t73;
  t75 = t30 * sigma[2];
  t76 = rho[1] * rho[1];
  t77 = POW_1_3(rho[1]);
  t78 = t77 * t77;
  t80 = 0.1e1 / t78 / t76;
  t84 = sqrt(sigma[2]);
  t87 = 0.1e1 / t77 / rho[1];
  t89 = t42 * t43 * t84 * t87;
  t91 = t89 / 0.27e2 + 0.1e1;
  t92 = log(t91);
  t94 = 0.2e1 / 0.81e2 * t29 * t75 * t80 + t40 * t92;
  t97 = t89 / 0.9e1 + t40;
  t98 = 0.1e1 / t97;
  t99 = 0.1e1 / t92;
  t100 = t98 * t99;
  t101 = t27 * t94 * t100;
  t104 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t101);
  tzk0 = t64 + t104;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t105 = t6 * t6;
  t106 = 0.1e1 / t105;
  t107 = t16 * t106;
  t109 = my_piecewise5(t10, 0, t14, 0, t7 - t107);
  t112 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t109);
  t113 = t5 * t112;
  t116 = t27 * t27;
  t117 = 0.1e1 / t116;
  t119 = t117 * t54 * t60;
  t121 = t26 * t119 / 0.8e1;
  t122 = t32 * rho[0];
  t124 = 0.1e1 / t34 / t122;
  t130 = t3 * t40 * t41 * t43;
  t132 = 0.1e1 / t33 / t32;
  t133 = t44 * t132;
  t134 = 0.1e1 / t51;
  t135 = t133 * t134;
  t138 = -0.16e2 / 0.243e3 * t29 * t31 * t124 - 0.4e1 / 0.81e2 * t130 * t135;
  t140 = t27 * t138 * t60;
  t143 = t25 * t27;
  t144 = t57 * t57;
  t145 = 0.1e1 / t144;
  t146 = t54 * t145;
  t147 = t143 * t146;
  t148 = t59 * t43;
  t149 = t148 * t133;
  t152 = t54 * t58;
  t153 = t143 * t152;
  t154 = t52 * t52;
  t155 = 0.1e1 / t154;
  t156 = t155 * t43;
  t157 = t156 * t135;
  t161 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t113 * t61 - t121 - 0.3e1 / 0.8e1 * t26 * t140 - t147 * t149 / 0.6e1 - t153 * t157 / 0.18e2);
  t162 = t66 * t106;
  t164 = my_piecewise5(t14, 0, t10, 0, -t7 - t162);
  t167 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t164);
  t168 = t5 * t167;
  t172 = t117 * t94 * t100;
  t174 = t74 * t172 / 0.8e1;
  t176 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t101 - t174);
  tvrho0 = t64 + t104 + t6 * (t161 + t176);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t180 = my_piecewise5(t10, 0, t14, 0, -t7 - t107);
  t183 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t180);
  t184 = t5 * t183;
  t188 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t61 - t121);
  t190 = my_piecewise5(t14, 0, t10, 0, t7 - t162);
  t193 = my_piecewise3(t70, 0, 0.4e1 / 0.3e1 * t71 * t190);
  t194 = t5 * t193;
  t197 = t76 * rho[1];
  t199 = 0.1e1 / t78 / t197;
  t204 = 0.1e1 / t77 / t76;
  t205 = t84 * t204;
  t206 = 0.1e1 / t91;
  t207 = t205 * t206;
  t210 = -0.16e2 / 0.243e3 * t29 * t75 * t199 - 0.4e1 / 0.81e2 * t130 * t207;
  t212 = t27 * t210 * t100;
  t215 = t73 * t27;
  t216 = t97 * t97;
  t217 = 0.1e1 / t216;
  t218 = t94 * t217;
  t219 = t215 * t218;
  t220 = t99 * t43;
  t221 = t220 * t205;
  t224 = t94 * t98;
  t225 = t215 * t224;
  t226 = t92 * t92;
  t227 = 0.1e1 / t226;
  t228 = t227 * t43;
  t229 = t228 * t207;
  t233 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t194 * t101 - t174 - 0.3e1 / 0.8e1 * t74 * t212 - t219 * t221 / 0.6e1 - t225 * t229 / 0.18e2);
  tvrho1 = t64 + t104 + t6 * (t188 + t233);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t239 = 0.1e1 / t44;
  t240 = t239 * t47;
  t241 = t240 * t134;
  t244 = 0.2e1 / 0.81e2 * t29 * t30 * t36 + t130 * t241 / 0.54e2;
  t246 = t27 * t244 * t60;
  t249 = t148 * t240;
  t252 = t156 * t241;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t246 + t147 * t249 / 0.16e2 + t153 * t252 / 0.48e2);
  tvsigma0 = t6 * t256;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t260 = 0.1e1 / t84;
  t261 = t260 * t87;
  t262 = t261 * t206;
  t265 = 0.2e1 / 0.81e2 * t29 * t30 * t80 + t130 * t262 / 0.54e2;
  t267 = t27 * t265 * t100;
  t270 = t220 * t261;
  t273 = t228 * t262;
  t277 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t267 + t219 * t270 / 0.16e2 + t225 * t273 / 0.48e2);
  tvsigma2 = t6 * t277;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t280 = t138 * t145;
  t281 = t143 * t280;
  t284 = t113 * t119;
  t286 = t112 * t27;
  t287 = t286 * t146;
  t291 = 0.1e1 / t116 / t6;
  t293 = t291 * t54 * t60;
  t295 = t26 * t293 / 0.12e2;
  t296 = t25 * t117;
  t297 = t296 * t146;
  t298 = t297 * t149;
  t300 = t146 * t155;
  t301 = t143 * t300;
  t302 = t32 * t32;
  t304 = 0.1e1 / t34 / t302;
  t305 = t31 * t304;
  t306 = t42 * t134;
  t307 = t305 * t306;
  t311 = 0.1e1 / t154 / t52;
  t312 = t152 * t311;
  t313 = t143 * t312;
  t314 = t51 * t51;
  t315 = 0.1e1 / t314;
  t317 = t315 * t41 * t3;
  t318 = t305 * t317;
  t321 = t152 * t155;
  t322 = t143 * t321;
  t328 = 0.1e1 / t33 / t122;
  t329 = t44 * t328;
  t330 = t329 * t134;
  t334 = t28 * t40 * t2;
  t335 = t334 * t30;
  t340 = 0.176e3 / 0.729e3 * t29 * t305 + 0.28e2 / 0.243e3 * t130 * t330 - 0.32e2 / 0.2187e4 * t335 * sigma[0] * t304 * t315;
  t342 = t27 * t340 * t60;
  t345 = t23 * t23;
  t346 = 0.1e1 / t345;
  t347 = t109 * t109;
  t350 = t105 * t6;
  t351 = 0.1e1 / t350;
  t352 = t16 * t351;
  t355 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t106 + 0.2e1 * t352);
  t359 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t346 * t347 + 0.4e1 / 0.3e1 * t23 * t355);
  t360 = t5 * t359;
  t366 = t117 * t138 * t60;
  t367 = t26 * t366;
  t370 = 0.1e1 / t144 / t57;
  t371 = t54 * t370;
  t372 = t371 * t59;
  t373 = t143 * t372;
  t375 = t304 * t41 * t3;
  t376 = t31 * t375;
  t379 = t156 * t330;
  t382 = t286 * t152;
  t385 = t296 * t152;
  t386 = t385 * t157;
  t388 = t138 * t58;
  t389 = t143 * t388;
  t392 = t148 * t329;
  t395 = -t281 * t149 / 0.3e1 - t284 / 0.4e1 - t287 * t149 / 0.3e1 + t295 - t298 / 0.9e1 - 0.8e1 / 0.243e3 * t301 * t307 - 0.8e1 / 0.729e3 * t313 * t318 - 0.4e1 / 0.729e3 * t322 * t318 - 0.3e1 / 0.8e1 * t26 * t342 - 0.3e1 / 0.8e1 * t360 * t61 - 0.3e1 / 0.4e1 * t113 * t140 - t367 / 0.4e1 - 0.8e1 / 0.81e2 * t373 * t376 + 0.7e1 / 0.54e2 * t153 * t379 - t382 * t157 / 0.9e1 - t386 / 0.27e2 - t389 * t157 / 0.9e1 + 0.7e1 / 0.18e2 * t147 * t392;
  t396 = my_piecewise3(t1, 0, t395);
  t397 = t71 * t71;
  t398 = 0.1e1 / t397;
  t399 = t164 * t164;
  t402 = t66 * t351;
  t405 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t106 + 0.2e1 * t402);
  t409 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t399 + 0.4e1 / 0.3e1 * t71 * t405);
  t410 = t5 * t409;
  t413 = t168 * t172;
  t416 = t291 * t94 * t100;
  t418 = t74 * t416 / 0.12e2;
  t420 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t101 - t413 / 0.4e1 + t418);
  tv2rho20 = 0.2e1 * t161 + 0.2e1 * t176 + t6 * (t396 + t420);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t423 = t346 * t180;
  t427 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t352);
  t431 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t423 * t109 + 0.4e1 / 0.3e1 * t23 * t427);
  t432 = t5 * t431;
  t435 = t184 * t119;
  t439 = t183 * t27;
  t440 = t439 * t146;
  t443 = t439 * t152;
  t451 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t432 * t61 - t435 / 0.8e1 - 0.3e1 / 0.8e1 * t184 * t140 - t440 * t149 / 0.6e1 - t443 * t157 / 0.18e2 - t284 / 0.8e1 + t295 - t367 / 0.8e1 - t298 / 0.18e2 - t386 / 0.54e2);
  t452 = t398 * t190;
  t456 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t402);
  t460 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t452 * t164 + 0.4e1 / 0.3e1 * t71 * t456);
  t461 = t5 * t460;
  t464 = t194 * t172;
  t470 = t117 * t210 * t100;
  t471 = t74 * t470;
  t473 = t167 * t27;
  t474 = t473 * t218;
  t477 = t73 * t117;
  t478 = t477 * t218;
  t479 = t478 * t221;
  t481 = t473 * t224;
  t484 = t477 * t224;
  t485 = t484 * t229;
  t488 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t461 * t101 - t464 / 0.8e1 - t413 / 0.8e1 + t418 - 0.3e1 / 0.8e1 * t168 * t212 - t471 / 0.8e1 - t474 * t221 / 0.6e1 - t479 / 0.18e2 - t481 * t229 / 0.18e2 - t485 / 0.54e2);
  tv2rho21 = t161 + t176 + t188 + t233 + t6 * (t451 + t488);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t493 = t180 * t180;
  t498 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t106 + 0.2e1 * t352);
  t502 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t346 * t493 + 0.4e1 / 0.3e1 * t23 * t498);
  t503 = t5 * t502;
  t508 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t61 - t435 / 0.4e1 + t295);
  t509 = t193 * t27;
  t510 = t509 * t218;
  t513 = t210 * t217;
  t514 = t215 * t513;
  t520 = 0.1e1 / t226 / t92;
  t521 = t224 * t520;
  t522 = t215 * t521;
  t523 = t76 * t76;
  t525 = 0.1e1 / t78 / t523;
  t526 = t75 * t525;
  t527 = t91 * t91;
  t528 = 0.1e1 / t527;
  t530 = t528 * t41 * t3;
  t531 = t526 * t530;
  t534 = t224 * t227;
  t535 = t215 * t534;
  t538 = t218 * t227;
  t539 = t215 * t538;
  t540 = t42 * t206;
  t541 = t526 * t540;
  t544 = t190 * t190;
  t549 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t106 + 0.2e1 * t402);
  t553 = my_piecewise3(t70, 0, 0.4e1 / 0.9e1 * t398 * t544 + 0.4e1 / 0.3e1 * t71 * t549);
  t554 = t5 * t553;
  t562 = 0.1e1 / t77 / t197;
  t563 = t84 * t562;
  t564 = t563 * t206;
  t571 = 0.176e3 / 0.729e3 * t29 * t526 + 0.28e2 / 0.243e3 * t130 * t564 - 0.32e2 / 0.2187e4 * t335 * sigma[2] * t525 * t528;
  t573 = t27 * t571 * t100;
  t578 = 0.1e1 / t216 / t97;
  t579 = t94 * t578;
  t580 = t579 * t99;
  t581 = t215 * t580;
  t583 = t525 * t41 * t3;
  t584 = t75 * t583;
  t587 = t228 * t564;
  t591 = t509 * t224;
  t594 = t210 * t98;
  t595 = t215 * t594;
  t598 = t220 * t563;
  t601 = -t510 * t221 / 0.3e1 - t514 * t221 / 0.3e1 - t464 / 0.4e1 - t471 / 0.4e1 + t418 - 0.8e1 / 0.729e3 * t522 * t531 - 0.4e1 / 0.729e3 * t535 * t531 - 0.8e1 / 0.243e3 * t539 * t541 - 0.3e1 / 0.8e1 * t554 * t101 - 0.3e1 / 0.4e1 * t194 * t212 - 0.3e1 / 0.8e1 * t74 * t573 - t485 / 0.27e2 - 0.8e1 / 0.81e2 * t581 * t584 + 0.7e1 / 0.54e2 * t225 * t587 - t479 / 0.9e1 - t591 * t229 / 0.9e1 - t595 * t229 / 0.9e1 + 0.7e1 / 0.18e2 * t219 * t598;
  t602 = my_piecewise3(t65, 0, t601);
  tv2rho22 = 0.2e1 * t188 + 0.2e1 * t233 + t6 * (t508 + t602);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t608 = t117 * t244 * t60;
  t610 = t26 * t608 / 0.8e1;
  t611 = t30 * t124;
  t614 = t239 * t132;
  t615 = t614 * t134;
  t621 = -0.16e2 / 0.243e3 * t29 * t611 - 0.2e1 / 0.81e2 * t130 * t615 + 0.4e1 / 0.729e3 * t334 * t611 * t315;
  t623 = t27 * t621 * t60;
  t626 = t244 * t145;
  t627 = t143 * t626;
  t630 = t244 * t58;
  t631 = t143 * t630;
  t637 = t297 * t249 / 0.48e2;
  t640 = t143 * t371;
  t641 = t59 * t30;
  t643 = t124 * t41 * t3;
  t644 = t641 * t643;
  t647 = t611 * t306;
  t650 = t148 * t614;
  t656 = t385 * t252 / 0.144e3;
  t659 = t611 * t317;
  t662 = t156 * t615;
  t667 = -0.3e1 / 0.8e1 * t113 * t246 - t610 - 0.3e1 / 0.8e1 * t26 * t623 - t627 * t149 / 0.6e1 - t631 * t157 / 0.18e2 + t287 * t249 / 0.16e2 + t637 + t281 * t249 / 0.16e2 + t640 * t644 / 0.27e2 + t301 * t647 / 0.81e2 - t147 * t650 / 0.12e2 + t382 * t252 / 0.48e2 + t656 + t389 * t252 / 0.48e2 + t313 * t659 / 0.243e3 - t153 * t662 / 0.36e2 + t322 * t659 / 0.486e3;
  t668 = my_piecewise3(t1, 0, t667);
  tv2rhosigma0 = t6 * t668 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t673 = t117 * t265 * t100;
  t675 = t74 * t673 / 0.8e1;
  t679 = t478 * t270 / 0.48e2;
  t683 = t484 * t273 / 0.144e3;
  t685 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t168 * t267 - t675 + t474 * t270 / 0.16e2 + t679 + t481 * t273 / 0.48e2 + t683);
  tv2rhosigma2 = t6 * t685 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t694 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t184 * t246 - t610 + t440 * t249 / 0.16e2 + t637 + t443 * t252 / 0.48e2 + t656);
  tv2rhosigma3 = t6 * t694 + t256;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t30 * t199;
  t701 = t260 * t204;
  t702 = t701 * t206;
  t708 = -0.16e2 / 0.243e3 * t29 * t698 - 0.2e1 / 0.81e2 * t130 * t702 + 0.4e1 / 0.729e3 * t334 * t698 * t528;
  t710 = t27 * t708 * t100;
  t713 = t265 * t217;
  t714 = t215 * t713;
  t717 = t265 * t98;
  t718 = t215 * t717;
  t725 = t215 * t579;
  t726 = t99 * t30;
  t728 = t199 * t41 * t3;
  t729 = t726 * t728;
  t732 = t698 * t540;
  t735 = t220 * t701;
  t742 = t698 * t530;
  t745 = t228 * t702;
  t750 = -0.3e1 / 0.8e1 * t194 * t267 - t675 - 0.3e1 / 0.8e1 * t74 * t710 - t714 * t221 / 0.6e1 - t718 * t229 / 0.18e2 + t510 * t270 / 0.16e2 + t679 + t514 * t270 / 0.16e2 + t725 * t729 / 0.27e2 + t539 * t732 / 0.81e2 - t219 * t735 / 0.12e2 + t591 * t273 / 0.48e2 + t683 + t595 * t273 / 0.48e2 + t522 * t742 / 0.243e3 - t225 * t745 / 0.36e2 + t535 * t742 / 0.486e3;
  t751 = my_piecewise3(t65, 0, t750);
  tv2rhosigma5 = t6 * t751 + t277;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t753 = t44 * sigma[0];
  t754 = 0.1e1 / t753;
  t755 = t754 * t47;
  t756 = t755 * t134;
  t759 = 0.1e1 / sigma[0];
  t764 = -t130 * t756 / 0.108e3 - t335 * t759 * t36 * t315 / 0.486e3;
  t766 = t27 * t764 * t60;
  t773 = t30 * t759;
  t775 = t36 * t41 * t3;
  t776 = t773 * t775;
  t779 = t773 * t36;
  t780 = t779 * t306;
  t783 = t148 * t755;
  t786 = t779 * t317;
  t789 = t156 * t756;
  t795 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t766 + t627 * t249 / 0.8e1 + t631 * t252 / 0.24e2 - t373 * t776 / 0.72e2 - t301 * t780 / 0.216e3 - t147 * t783 / 0.32e2 - t313 * t786 / 0.648e3 - t153 * t789 / 0.96e2 - t322 * t786 / 0.1296e4);
  tv2sigma20 = t6 * t795;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t796 = t84 * sigma[2];
  t797 = 0.1e1 / t796;
  t798 = t797 * t87;
  t799 = t798 * t206;
  t802 = 0.1e1 / sigma[2];
  t807 = -t130 * t799 / 0.108e3 - t335 * t802 * t80 * t528 / 0.486e3;
  t809 = t27 * t807 * t100;
  t816 = t30 * t802;
  t818 = t80 * t41 * t3;
  t819 = t816 * t818;
  t822 = t816 * t80;
  t823 = t822 * t540;
  t826 = t220 * t798;
  t829 = t822 * t530;
  t832 = t228 * t799;
  t838 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t74 * t809 + t714 * t270 / 0.8e1 + t718 * t273 / 0.24e2 - t581 * t819 / 0.72e2 - t539 * t823 / 0.216e3 - t219 * t826 / 0.32e2 - t522 * t829 / 0.648e3 - t225 * t832 / 0.96e2 - t535 * t829 / 0.1296e4);
  tv2sigma25 = t6 * t838;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t841 = t286 * t372;
  t844 = t296 * t372;
  t845 = t844 * t376;
  t847 = t371 * t155;
  t848 = t143 * t847;
  t849 = t302 * t122;
  t850 = 0.1e1 / t849;
  t851 = t753 * t850;
  t852 = t29 * t134;
  t853 = t851 * t852;
  t856 = t146 * t311;
  t857 = t143 * t856;
  t858 = t29 * t315;
  t859 = t851 * t858;
  t864 = t154 * t154;
  t865 = 0.1e1 / t864;
  t866 = t152 * t865;
  t867 = t143 * t866;
  t869 = 0.1e1 / t314 / t51;
  t871 = t869 * t2 * t28;
  t872 = t851 * t871;
  t879 = t25 * t291;
  t880 = t879 * t146;
  t881 = t880 * t149;
  t883 = t296 * t280;
  t884 = t883 * t149;
  t890 = t297 * t392;
  t892 = -0.8e1 / 0.27e2 * t841 * t376 - 0.8e1 / 0.81e2 * t845 - 0.64e2 / 0.729e3 * t848 * t853 - 0.64e2 / 0.2187e4 * t857 * t859 - 0.32e2 / 0.2187e4 * t301 * t859 - 0.64e2 / 0.6561e4 * t867 * t872 - 0.64e2 / 0.6561e4 * t313 * t872 - 0.64e2 / 0.19683e5 * t322 * t872 + t881 / 0.9e1 - t884 / 0.3e1 + 0.7e1 / 0.6e1 * t281 * t392 + 0.7e1 / 0.6e1 * t287 * t392 + 0.7e1 / 0.18e2 * t890;
  t894 = 0.1e1 / t33 / t302;
  t895 = t44 * t894;
  t896 = t148 * t895;
  t899 = t286 * t280;
  t901 = t340 * t145;
  t902 = t143 * t901;
  t905 = t112 * t117;
  t906 = t905 * t146;
  t907 = t906 * t149;
  t909 = t359 * t27;
  t910 = t909 * t146;
  t913 = t302 * rho[0];
  t915 = 0.1e1 / t34 / t913;
  t916 = t31 * t915;
  t919 = t895 * t134;
  t926 = t40 * M_PI;
  t927 = t926 * t753;
  t928 = t850 * t869;
  t931 = -0.2464e4 / 0.2187e4 * t29 * t916 - 0.28e3 / 0.729e3 * t130 * t919 + 0.224e3 / 0.2187e4 * t335 * sigma[0] * t915 * t315 - 0.512e3 / 0.59049e5 * t927 * t928;
  t933 = t27 * t931 * t60;
  t937 = t117 * t340 * t60;
  t938 = t26 * t937;
  t940 = t113 * t293;
  t943 = 0.1e1 / t116 / t105;
  t945 = t943 * t54 * t60;
  t947 = 0.5e1 / 0.36e2 * t26 * t945;
  t949 = 0.1e1 / t345 / t19;
  t950 = t347 * t109;
  t953 = t346 * t109;
  t956 = t105 * t105;
  t957 = 0.1e1 / t956;
  t958 = t16 * t957;
  t961 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t351 - 0.6e1 * t958);
  t965 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t949 * t950 + 0.4e1 / 0.3e1 * t953 * t355 + 0.4e1 / 0.3e1 * t23 * t961);
  t966 = t5 * t965;
  t971 = t360 * t119;
  t973 = t113 * t366;
  t975 = -0.35e2 / 0.27e2 * t147 * t896 - t899 * t149 - t902 * t149 / 0.2e1 - t907 / 0.3e1 - t910 * t149 / 0.2e1 - 0.3e1 / 0.8e1 * t26 * t933 - 0.3e1 / 0.8e1 * t938 + t940 / 0.4e1 - t947 - 0.3e1 / 0.8e1 * t966 * t61 - 0.9e1 / 0.8e1 * t360 * t140 - 0.3e1 / 0.8e1 * t971 - 0.3e1 / 0.4e1 * t973;
  t978 = t291 * t138 * t60;
  t979 = t26 * t978;
  t983 = t385 * t379;
  t985 = t156 * t919;
  t988 = t905 * t152;
  t989 = t988 * t157;
  t991 = t879 * t152;
  t992 = t991 * t157;
  t994 = t340 * t58;
  t995 = t143 * t994;
  t998 = t909 * t152;
  t1001 = t286 * t388;
  t1004 = t296 * t388;
  t1005 = t1004 * t157;
  t1007 = t144 * t144;
  t1008 = 0.1e1 / t1007;
  t1009 = t54 * t1008;
  t1010 = t143 * t1009;
  t1011 = t59 * t753;
  t1012 = t850 * t2;
  t1014 = t1011 * t1012 * t28;
  t1021 = t979 / 0.4e1 - 0.9e1 / 0.8e1 * t113 * t342 + 0.7e1 / 0.54e2 * t983 - 0.35e2 / 0.81e2 * t153 * t985 - t989 / 0.9e1 + t992 / 0.27e2 - t995 * t157 / 0.6e1 - t998 * t157 / 0.6e1 - t1001 * t157 / 0.3e1 - t1005 / 0.9e1 - 0.64e2 / 0.243e3 * t1010 * t1014 + 0.7e1 / 0.18e2 * t382 * t379 + 0.7e1 / 0.18e2 * t389 * t379;
  t1022 = t286 * t300;
  t1025 = t296 * t300;
  t1026 = t1025 * t307;
  t1028 = t286 * t312;
  t1031 = t916 * t317;
  t1034 = t916 * t306;
  t1037 = t296 * t312;
  t1038 = t1037 * t318;
  t1042 = t296 * t321;
  t1043 = t1042 * t318;
  t1045 = t388 * t311;
  t1046 = t143 * t1045;
  t1049 = t286 * t321;
  t1052 = t388 * t155;
  t1053 = t143 * t1052;
  t1056 = t280 * t155;
  t1057 = t143 * t1056;
  t1061 = t915 * t41 * t3;
  t1062 = t31 * t1061;
  t1065 = t138 * t370;
  t1066 = t1065 * t59;
  t1067 = t143 * t1066;
  t1070 = -0.8e1 / 0.81e2 * t1022 * t307 - 0.8e1 / 0.243e3 * t1026 - 0.8e1 / 0.243e3 * t1028 * t318 + 0.28e2 / 0.729e3 * t322 * t1031 + 0.56e2 / 0.243e3 * t301 * t1034 - 0.8e1 / 0.729e3 * t1038 + 0.56e2 / 0.729e3 * t313 * t1031 - 0.4e1 / 0.729e3 * t1043 - 0.8e1 / 0.243e3 * t1046 * t318 - 0.4e1 / 0.243e3 * t1049 * t318 - 0.4e1 / 0.243e3 * t1053 * t318 - 0.8e1 / 0.81e2 * t1057 * t307 + 0.56e2 / 0.81e2 * t373 * t1062 - 0.8e1 / 0.27e2 * t1067 * t376;
  t1073 = my_piecewise3(t1, 0, t892 + t975 + t1021 + t1070);
  t1075 = 0.1e1 / t397 / t69;
  t1076 = t399 * t164;
  t1079 = t398 * t164;
  t1082 = t66 * t957;
  t1085 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t351 - 0.6e1 * t1082);
  t1089 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1075 * t1076 + 0.4e1 / 0.3e1 * t1079 * t405 + 0.4e1 / 0.3e1 * t71 * t1085);
  t1090 = t5 * t1089;
  t1093 = t410 * t172;
  t1095 = t168 * t416;
  t1098 = t943 * t94 * t100;
  t1100 = 0.5e1 / 0.36e2 * t74 * t1098;
  t1102 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t1090 * t101 - 0.3e1 / 0.8e1 * t1093 + t1095 / 0.4e1 - t1100);
  tv3rho30 = 0.3e1 * t396 + 0.3e1 * t420 + t6 * (t1073 + t1102);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1105 = 0.2e1 * t451;
  t1106 = 0.2e1 * t488;
  t1110 = t439 * t372;
  t1116 = t431 * t27;
  t1117 = t1116 * t146;
  t1120 = t183 * t117;
  t1121 = t1120 * t146;
  t1123 = t1121 * t149 / 0.9e1;
  t1124 = t439 * t280;
  t1129 = t432 * t119 / 0.4e1;
  t1130 = t184 * t293;
  t1132 = t949 * t180;
  t1135 = t346 * t427;
  t1140 = 0.2e1 * t351;
  t1141 = 0.6e1 * t958;
  t1143 = my_piecewise5(t10, 0, t14, 0, t1140 - t1141);
  t1147 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1132 * t347 + 0.8e1 / 0.9e1 * t1135 * t109 + 0.4e1 / 0.9e1 * t423 * t355 + 0.4e1 / 0.3e1 * t23 * t1143);
  t1148 = t5 * t1147;
  t1154 = t184 * t366 / 0.4e1;
  t1159 = 0.7e1 / 0.18e2 * t440 * t392 - 0.8e1 / 0.243e3 * t845 - 0.8e1 / 0.81e2 * t1110 * t376 + 0.2e1 / 0.27e2 * t881 - t884 / 0.9e1 + 0.7e1 / 0.54e2 * t890 - t1117 * t149 / 0.3e1 - t1123 - t1124 * t149 / 0.3e1 - t907 / 0.9e1 - t1129 + t1130 / 0.12e2 - 0.3e1 / 0.8e1 * t1148 * t61 - 0.3e1 / 0.4e1 * t432 * t140 - t1154 - 0.3e1 / 0.8e1 * t184 * t342 - t938 / 0.8e1 + t940 / 0.6e1;
  t1165 = t1116 * t152;
  t1168 = t1120 * t152;
  t1170 = t1168 * t157 / 0.27e2;
  t1171 = t439 * t388;
  t1179 = t439 * t300;
  t1182 = t439 * t312;
  t1185 = t439 * t321;
  t1190 = -t947 - t971 / 0.8e1 - t973 / 0.4e1 + t979 / 0.6e1 + 0.7e1 / 0.54e2 * t443 * t379 - t1165 * t157 / 0.9e1 - t1170 - t1171 * t157 / 0.9e1 + 0.7e1 / 0.162e3 * t983 - t989 / 0.27e2 + 0.2e1 / 0.81e2 * t992 - t1005 / 0.27e2 - 0.8e1 / 0.729e3 * t1026 - 0.8e1 / 0.243e3 * t1179 * t307 - 0.8e1 / 0.729e3 * t1182 * t318 - 0.4e1 / 0.729e3 * t1185 * t318 - 0.8e1 / 0.2187e4 * t1038 - 0.4e1 / 0.2187e4 * t1043;
  t1192 = my_piecewise3(t1, 0, t1159 + t1190);
  t1193 = t1075 * t190;
  t1196 = t398 * t456;
  t1201 = 0.6e1 * t1082;
  t1203 = my_piecewise5(t14, 0, t10, 0, -t1140 - t1201);
  t1207 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1193 * t399 + 0.8e1 / 0.9e1 * t1196 * t164 + 0.4e1 / 0.9e1 * t452 * t405 + 0.4e1 / 0.3e1 * t71 * t1203);
  t1208 = t5 * t1207;
  t1212 = t461 * t172 / 0.4e1;
  t1213 = t194 * t416;
  t1220 = t168 * t470 / 0.4e1;
  t1222 = t291 * t210 * t100;
  t1223 = t74 * t1222;
  t1225 = t409 * t27;
  t1226 = t1225 * t218;
  t1229 = t167 * t117;
  t1230 = t1229 * t218;
  t1232 = t1230 * t221 / 0.9e1;
  t1233 = t73 * t291;
  t1234 = t1233 * t218;
  t1235 = t1234 * t221;
  t1237 = t1225 * t224;
  t1240 = t1229 * t224;
  t1242 = t1240 * t229 / 0.27e2;
  t1243 = t1233 * t224;
  t1244 = t1243 * t229;
  t1246 = -0.3e1 / 0.8e1 * t1208 * t101 - t1212 + t1213 / 0.12e2 - t1093 / 0.8e1 + t1095 / 0.6e1 - t1100 - 0.3e1 / 0.8e1 * t410 * t212 - t1220 + t1223 / 0.12e2 - t1226 * t221 / 0.6e1 - t1232 + t1235 / 0.27e2 - t1237 * t229 / 0.18e2 - t1242 + t1244 / 0.81e2;
  t1247 = my_piecewise3(t65, 0, t1246);
  tv3rho31 = t396 + t420 + t1105 + t1106 + t6 * (t1192 + t1247);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1250 = t949 * t493;
  t1255 = t346 * t498;
  t1259 = my_piecewise5(t10, 0, t14, 0, -t1140 - t1141);
  t1263 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1250 * t109 + 0.8e1 / 0.9e1 * t423 * t427 + 0.4e1 / 0.9e1 * t1255 * t109 + 0.4e1 / 0.3e1 * t23 * t1259);
  t1264 = t5 * t1263;
  t1267 = t503 * t119;
  t1271 = t502 * t27;
  t1272 = t1271 * t146;
  t1275 = t1271 * t152;
  t1283 = -0.3e1 / 0.8e1 * t1264 * t61 - t1267 / 0.8e1 - 0.3e1 / 0.8e1 * t503 * t140 - t1272 * t149 / 0.6e1 - t1275 * t157 / 0.18e2 - t1129 + t1130 / 0.6e1 - t1154 - t1123 - t1170 + t940 / 0.12e2 - t947 + t979 / 0.12e2 + t881 / 0.27e2 + t992 / 0.81e2;
  t1284 = my_piecewise3(t1, 0, t1283);
  t1287 = t460 * t27;
  t1288 = t1287 * t218;
  t1291 = t473 * t513;
  t1294 = t193 * t117;
  t1295 = t1294 * t218;
  t1296 = t1295 * t221;
  t1298 = t477 * t513;
  t1299 = t1298 * t221;
  t1301 = t478 * t598;
  t1304 = t477 * t580;
  t1305 = t1304 * t584;
  t1307 = t473 * t580;
  t1311 = t117 * t571 * t100;
  t1312 = t74 * t1311;
  t1314 = t1075 * t544;
  t1319 = t398 * t549;
  t1323 = my_piecewise5(t14, 0, t10, 0, t1140 - t1201);
  t1327 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1314 * t164 + 0.8e1 / 0.9e1 * t452 * t456 + 0.4e1 / 0.9e1 * t1319 * t164 + 0.4e1 / 0.3e1 * t71 * t1323);
  t1328 = t5 * t1327;
  t1337 = 0.7e1 / 0.18e2 * t474 * t598 - t1288 * t221 / 0.3e1 - t1291 * t221 / 0.3e1 - t1296 / 0.9e1 - t1299 / 0.9e1 + 0.7e1 / 0.54e2 * t1301 - t1232 + 0.2e1 / 0.27e2 * t1235 - 0.8e1 / 0.243e3 * t1305 - 0.8e1 / 0.81e2 * t1307 * t584 - t1312 / 0.8e1 - 0.3e1 / 0.8e1 * t1328 * t101 - 0.3e1 / 0.4e1 * t461 * t212 - 0.3e1 / 0.8e1 * t168 * t573 - t1212 + t1213 / 0.6e1 - t1220 + t1223 / 0.6e1;
  t1338 = t554 * t172;
  t1340 = t194 * t470;
  t1343 = t484 * t587;
  t1345 = t1294 * t224;
  t1346 = t1345 * t229;
  t1348 = t477 * t594;
  t1349 = t1348 * t229;
  t1353 = t1287 * t224;
  t1356 = t473 * t594;
  t1360 = t477 * t521;
  t1361 = t1360 * t531;
  t1363 = t473 * t521;
  t1366 = t473 * t534;
  t1369 = t473 * t538;
  t1372 = t477 * t534;
  t1373 = t1372 * t531;
  t1375 = t477 * t538;
  t1376 = t1375 * t541;
  t1378 = -t1338 / 0.8e1 - t1340 / 0.4e1 + t1095 / 0.12e2 - t1100 + 0.7e1 / 0.162e3 * t1343 - t1346 / 0.27e2 - t1349 / 0.27e2 + 0.7e1 / 0.54e2 * t481 * t587 - t1353 * t229 / 0.9e1 - t1356 * t229 / 0.9e1 - t1242 + 0.2e1 / 0.81e2 * t1244 - 0.8e1 / 0.2187e4 * t1361 - 0.8e1 / 0.729e3 * t1363 * t531 - 0.4e1 / 0.729e3 * t1366 * t531 - 0.8e1 / 0.243e3 * t1369 * t541 - 0.4e1 / 0.2187e4 * t1373 - 0.8e1 / 0.729e3 * t1376;
  t1380 = my_piecewise3(t65, 0, t1337 + t1378);
  tv3rho32 = t1105 + t1106 + t508 + t602 + t6 * (t1284 + t1380);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1385 = t493 * t180;
  t1392 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t351 - 0.6e1 * t958);
  t1396 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t949 * t1385 + 0.4e1 / 0.3e1 * t423 * t498 + 0.4e1 / 0.3e1 * t23 * t1392);
  t1397 = t5 * t1396;
  t1403 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1397 * t61 - 0.3e1 / 0.8e1 * t1267 + t1130 / 0.4e1 - t947);
  t1405 = 0.1e1 / t77 / t523;
  t1406 = t84 * t1405;
  t1407 = t220 * t1406;
  t1410 = t553 * t27;
  t1411 = t1410 * t218;
  t1414 = t509 * t513;
  t1416 = t571 * t217;
  t1417 = t215 * t1416;
  t1428 = t523 * rho[1];
  t1430 = 0.1e1 / t78 / t1428;
  t1432 = t1430 * t41 * t3;
  t1433 = t75 * t1432;
  t1436 = t509 * t580;
  t1439 = t210 * t578;
  t1440 = t1439 * t99;
  t1441 = t215 * t1440;
  t1444 = -0.35e2 / 0.27e2 * t219 * t1407 - t1411 * t221 / 0.2e1 - t1414 * t221 - t1417 * t221 / 0.2e1 + 0.7e1 / 0.6e1 * t510 * t598 + 0.7e1 / 0.6e1 * t514 * t598 - t1296 / 0.3e1 - t1299 / 0.3e1 + 0.7e1 / 0.18e2 * t1301 + t1235 / 0.9e1 + 0.56e2 / 0.81e2 * t581 * t1433 - 0.8e1 / 0.27e2 * t1436 * t584 - 0.8e1 / 0.27e2 * t1441 * t584;
  t1445 = t218 * t520;
  t1446 = t215 * t1445;
  t1447 = t523 * t197;
  t1448 = 0.1e1 / t1447;
  t1449 = t796 * t1448;
  t1451 = t528 * t2 * t28;
  t1452 = t1449 * t1451;
  t1455 = t226 * t226;
  t1456 = 0.1e1 / t1455;
  t1457 = t224 * t1456;
  t1458 = t215 * t1457;
  t1460 = 0.1e1 / t527 / t91;
  t1462 = t1460 * t2 * t28;
  t1463 = t1449 * t1462;
  t1472 = t579 * t227;
  t1473 = t215 * t1472;
  t1474 = t29 * t206;
  t1475 = t1449 * t1474;
  t1479 = t544 * t190;
  t1486 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t351 - 0.6e1 * t1082);
  t1490 = my_piecewise3(t70, 0, -0.8e1 / 0.27e2 * t1075 * t1479 + 0.4e1 / 0.3e1 * t452 * t549 + 0.4e1 / 0.3e1 * t71 * t1486);
  t1491 = t5 * t1490;
  t1498 = t75 * t1430;
  t1501 = t1406 * t206;
  t1508 = t926 * t796;
  t1509 = t1448 * t1460;
  t1512 = -0.2464e4 / 0.2187e4 * t29 * t1498 - 0.28e3 / 0.729e3 * t130 * t1501 + 0.224e3 / 0.2187e4 * t335 * sigma[2] * t1430 * t528 - 0.512e3 / 0.59049e5 * t1508 * t1509;
  t1514 = t27 * t1512 * t100;
  t1519 = -0.64e2 / 0.2187e4 * t1446 * t1452 - 0.64e2 / 0.6561e4 * t1458 * t1463 - 0.64e2 / 0.6561e4 * t522 * t1463 - 0.32e2 / 0.2187e4 * t539 * t1452 - 0.64e2 / 0.19683e5 * t535 * t1463 - 0.64e2 / 0.729e3 * t1473 * t1475 - 0.8e1 / 0.81e2 * t1305 - 0.3e1 / 0.8e1 * t1491 * t101 - 0.9e1 / 0.8e1 * t554 * t212 - 0.9e1 / 0.8e1 * t194 * t573 - 0.3e1 / 0.8e1 * t74 * t1514 - 0.3e1 / 0.8e1 * t1312 + t1213 / 0.4e1;
  t1524 = t228 * t1501;
  t1530 = t1410 * t224;
  t1533 = t509 * t594;
  t1536 = t571 * t98;
  t1537 = t215 * t1536;
  t1540 = t216 * t216;
  t1541 = 0.1e1 / t1540;
  t1542 = t94 * t1541;
  t1543 = t215 * t1542;
  t1544 = t99 * t796;
  t1545 = t1448 * t2;
  t1547 = t1544 * t1545 * t28;
  t1552 = t1223 / 0.4e1 - 0.3e1 / 0.8e1 * t1338 - 0.3e1 / 0.4e1 * t1340 - t1100 - 0.35e2 / 0.81e2 * t225 * t1524 + 0.7e1 / 0.54e2 * t1343 - t1346 / 0.9e1 - t1349 / 0.9e1 - t1530 * t229 / 0.6e1 - t1533 * t229 / 0.3e1 - t1537 * t229 / 0.6e1 - 0.64e2 / 0.243e3 * t1543 * t1547 + 0.7e1 / 0.18e2 * t591 * t587;
  t1557 = t1498 * t540;
  t1560 = t1498 * t530;
  t1565 = t594 * t227;
  t1566 = t215 * t1565;
  t1569 = t509 * t538;
  t1572 = t513 * t227;
  t1573 = t215 * t1572;
  t1576 = t509 * t521;
  t1579 = t594 * t520;
  t1580 = t215 * t1579;
  t1583 = t509 * t534;
  t1588 = 0.7e1 / 0.18e2 * t595 * t587 + t1244 / 0.27e2 - 0.8e1 / 0.729e3 * t1361 + 0.56e2 / 0.243e3 * t539 * t1557 + 0.56e2 / 0.729e3 * t522 * t1560 + 0.28e2 / 0.729e3 * t535 * t1560 - 0.4e1 / 0.243e3 * t1566 * t531 - 0.8e1 / 0.81e2 * t1569 * t541 - 0.8e1 / 0.81e2 * t1573 * t541 - 0.8e1 / 0.243e3 * t1576 * t531 - 0.8e1 / 0.243e3 * t1580 * t531 - 0.4e1 / 0.243e3 * t1583 * t531 - 0.4e1 / 0.729e3 * t1373 - 0.8e1 / 0.243e3 * t1376;
  t1591 = my_piecewise3(t65, 0, t1444 + t1519 + t1552 + t1588);
  tv3rho33 = 0.3e1 * t508 + 0.3e1 * t602 + t6 * (t1403 + t1591);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1597 = t883 * t249;
  t1601 = t286 * t626;
  t1604 = t297 * t650;
  t1608 = t239 * t328;
  t1609 = t148 * t1608;
  t1614 = t906 * t249;
  t1619 = t880 * t249 / 0.72e2;
  t1620 = t296 * t626;
  t1621 = t1620 * t149;
  t1623 = t621 * t145;
  t1624 = t143 * t1623;
  t1631 = t899 * t249 / 0.8e1 + t1597 / 0.24e2 + t902 * t249 / 0.16e2 - t1601 * t149 / 0.3e1 - t1604 / 0.18e2 - t281 * t650 / 0.6e1 + 0.7e1 / 0.36e2 * t147 * t1609 + 0.7e1 / 0.18e2 * t627 * t392 + t1614 / 0.24e2 - t287 * t650 / 0.6e1 - t1619 - t1621 / 0.9e1 - t1624 * t149 / 0.3e1 + t910 * t249 / 0.16e2 + 0.2e1 / 0.243e3 * t1046 * t659;
  t1634 = t302 * t32;
  t1635 = 0.1e1 / t1634;
  t1636 = t1635 * t869;
  t1637 = t29 * t44;
  t1638 = t1636 * t1637;
  t1643 = t30 * t304;
  t1644 = t1643 * t317;
  t1651 = t1643 * t306;
  t1654 = t244 * t370;
  t1655 = t1654 * t59;
  t1656 = t143 * t1655;
  t1661 = t1025 * t647;
  t1665 = t1635 * t2;
  t1667 = t28 * t44 * t134;
  t1668 = t1665 * t1667;
  t1673 = t1665 * t28 * t315 * t44;
  t1680 = t1053 * t659 / 0.243e3 + 0.8e1 / 0.2187e4 * t867 * t1638 + 0.8e1 / 0.2187e4 * t313 * t1638 - 0.5e1 / 0.486e3 * t322 * t1644 + 0.8e1 / 0.6561e4 * t322 * t1638 - 0.5e1 / 0.243e3 * t313 * t1644 - 0.5e1 / 0.81e2 * t301 * t1651 - 0.8e1 / 0.81e2 * t1656 * t376 + 0.2e1 / 0.81e2 * t1022 * t647 + 0.2e1 / 0.243e3 * t1661 + 0.2e1 / 0.81e2 * t1057 * t647 + 0.8e1 / 0.243e3 * t848 * t1668 + 0.8e1 / 0.729e3 * t857 * t1673 + 0.4e1 / 0.729e3 * t301 * t1673 + 0.2e1 / 0.243e3 * t1028 * t659;
  t1684 = t1037 * t659;
  t1686 = t1042 * t659;
  t1688 = t113 * t608;
  t1691 = t291 * t244 * t60;
  t1693 = t26 * t1691 / 0.12e2;
  t1695 = t117 * t621 * t60;
  t1696 = t26 * t1695;
  t1700 = t1608 * t134;
  t1707 = t869 * t44;
  t1710 = 0.176e3 / 0.729e3 * t29 * t1643 + 0.14e2 / 0.243e3 * t130 * t1700 - 0.2e2 / 0.729e3 * t334 * t1643 * t315 + 0.64e2 / 0.19683e5 * t926 * t1635 * t1707;
  t1712 = t27 * t1710 * t60;
  t1719 = t286 * t371;
  t1722 = t286 * t630;
  t1727 = t641 * t375;
  t1730 = t988 * t252;
  t1734 = t1049 * t659 / 0.243e3 + 0.2e1 / 0.729e3 * t1684 + t1686 / 0.729e3 - t1688 / 0.4e1 + t1693 - t1696 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t1712 - 0.3e1 / 0.8e1 * t360 * t246 - 0.3e1 / 0.4e1 * t113 * t623 + 0.2e1 / 0.27e2 * t1719 * t644 - t1722 * t157 / 0.9e1 + 0.7e1 / 0.54e2 * t631 * t379 - 0.5e1 / 0.27e2 * t640 * t1727 + t1730 / 0.72e2 - t382 * t662 / 0.18e2;
  t1736 = t991 * t252 / 0.216e3;
  t1737 = t385 * t662;
  t1741 = t156 * t1700;
  t1744 = t1004 * t252;
  t1748 = t296 * t371;
  t1749 = t1748 * t644;
  t1751 = t143 * t1065;
  t1755 = t59 * t1635 * t1637;
  t1762 = t296 * t630;
  t1763 = t1762 * t157;
  t1765 = t621 * t58;
  t1766 = t143 * t1765;
  t1769 = t626 * t155;
  t1770 = t143 * t1769;
  t1773 = t630 * t311;
  t1774 = t143 * t1773;
  t1777 = t630 * t155;
  t1778 = t143 * t1777;
  t1781 = -t1736 - t1737 / 0.54e2 - t389 * t662 / 0.18e2 + 0.7e1 / 0.108e3 * t153 * t1741 + t1744 / 0.72e2 + t995 * t252 / 0.48e2 + 0.2e1 / 0.81e2 * t1749 + 0.2e1 / 0.27e2 * t1751 * t644 + 0.8e1 / 0.81e2 * t1010 * t1755 + t998 * t252 / 0.48e2 + t1001 * t252 / 0.24e2 - t1763 / 0.27e2 - t1766 * t157 / 0.9e1 - 0.8e1 / 0.243e3 * t1770 * t307 - 0.8e1 / 0.729e3 * t1774 * t318 - 0.4e1 / 0.729e3 * t1778 * t318;
  t1784 = my_piecewise3(t1, 0, t1631 + t1680 + t1734 + t1781);
  tv3rho2sigma0 = t6 * t1784 + 0.2e1 * t668;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1789 = t168 * t673;
  t1792 = t291 * t265 * t100;
  t1794 = t74 * t1792 / 0.12e2;
  t1797 = t1230 * t270;
  t1800 = t1234 * t270 / 0.72e2;
  t1803 = t1240 * t273;
  t1806 = t1243 * t273 / 0.216e3;
  t1808 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t410 * t267 - t1789 / 0.4e1 + t1794 + t1226 * t270 / 0.16e2 + t1797 / 0.24e2 - t1800 + t1237 * t273 / 0.48e2 + t1803 / 0.72e2 - t1806);
  tv3rho2sigma2 = t6 * t1808 + 0.2e1 * t685;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1811 = t1121 * t249;
  t1815 = t439 * t626;
  t1834 = t184 * t608;
  t1836 = t1597 / 0.48e2 + t1811 / 0.48e2 - t440 * t650 / 0.12e2 - t1815 * t149 / 0.6e1 + t1117 * t249 / 0.16e2 + t1124 * t249 / 0.16e2 - t1604 / 0.36e2 + t1614 / 0.48e2 - t1619 - t1621 / 0.18e2 + t1179 * t647 / 0.81e2 + t1182 * t659 / 0.243e3 + t1185 * t659 / 0.486e3 + t1661 / 0.243e3 + t1684 / 0.729e3 + t1686 / 0.1458e4 - t1834 / 0.8e1;
  t1847 = t439 * t630;
  t1850 = t439 * t371;
  t1855 = t1168 * t252;
  t1862 = -0.3e1 / 0.8e1 * t432 * t246 - 0.3e1 / 0.8e1 * t184 * t623 - t1688 / 0.8e1 + t1693 - t1696 / 0.8e1 - t443 * t662 / 0.36e2 + t1171 * t252 / 0.48e2 - t1847 * t157 / 0.18e2 + t1850 * t644 / 0.27e2 + t1165 * t252 / 0.48e2 + t1855 / 0.144e3 + t1730 / 0.144e3 - t1736 - t1737 / 0.108e3 + t1744 / 0.144e3 + t1749 / 0.81e2 - t1763 / 0.54e2;
  t1864 = my_piecewise3(t1, 0, t1836 + t1862);
  tv3rho2sigma3 = t6 * t1864 + t668 + t694;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1866 = t1298 * t270;
  t1868 = t478 * t735;
  t1870 = t477 * t713;
  t1871 = t1870 * t221;
  t1873 = t1295 * t270;
  t1875 = t473 * t713;
  t1891 = t1372 * t742;
  t1893 = t1375 * t732;
  t1895 = t1360 * t742;
  t1899 = t1866 / 0.48e2 - t1868 / 0.36e2 - t1871 / 0.18e2 + t1873 / 0.48e2 - t1875 * t221 / 0.6e1 + t1288 * t270 / 0.16e2 + t1291 * t270 / 0.16e2 - t474 * t735 / 0.12e2 + t1797 / 0.48e2 - t1800 + t1363 * t742 / 0.243e3 + t1366 * t742 / 0.486e3 + t1369 * t732 / 0.81e2 + t1891 / 0.1458e4 + t1893 / 0.243e3 + t1895 / 0.729e3 - 0.3e1 / 0.8e1 * t461 * t267;
  t1903 = t117 * t708 * t100;
  t1904 = t74 * t1903;
  t1906 = t194 * t673;
  t1909 = t1348 * t273;
  t1911 = t477 * t717;
  t1912 = t1911 * t229;
  t1914 = t477 * t579;
  t1915 = t1914 * t729;
  t1917 = t473 * t579;
  t1926 = t473 * t717;
  t1930 = t484 * t745;
  t1932 = t1345 * t273;
  t1934 = -0.3e1 / 0.8e1 * t168 * t710 - t1904 / 0.8e1 - t1906 / 0.8e1 - t1789 / 0.8e1 + t1794 + t1909 / 0.144e3 - t1912 / 0.54e2 + t1915 / 0.81e2 + t1917 * t729 / 0.27e2 + t1353 * t273 / 0.48e2 + t1356 * t273 / 0.48e2 - t481 * t745 / 0.36e2 - t1926 * t229 / 0.18e2 + t1803 / 0.144e3 - t1806 - t1930 / 0.108e3 + t1932 / 0.144e3;
  t1936 = my_piecewise3(t65, 0, t1899 + t1934);
  tv3rho2sigma5 = t6 * t1936 + t685 + t751;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1949 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t503 * t246 - t1834 / 0.4e1 + t1693 + t1272 * t249 / 0.16e2 + t1811 / 0.24e2 - t1619 + t1275 * t252 / 0.48e2 + t1855 / 0.72e2 - t1736);
  tv3rho2sigma6 = t6 * t1949 + 0.2e1 * t694;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1952 = t717 * t520;
  t1953 = t215 * t1952;
  t1956 = t717 * t227;
  t1957 = t215 * t1956;
  t1960 = t713 * t227;
  t1961 = t215 * t1960;
  t1966 = t509 * t713;
  t1969 = t708 * t217;
  t1970 = t215 * t1969;
  t1981 = t260 * t562;
  t1982 = t220 * t1981;
  t1989 = -0.8e1 / 0.729e3 * t1953 * t531 - 0.4e1 / 0.729e3 * t1957 * t531 - 0.8e1 / 0.243e3 * t1961 * t541 + t1417 * t270 / 0.16e2 - t1966 * t221 / 0.3e1 - t1970 * t221 / 0.3e1 + t1411 * t270 / 0.16e2 + t1414 * t270 / 0.8e1 + t1866 / 0.24e2 - t1868 / 0.18e2 - t1871 / 0.9e1 + t1873 / 0.24e2 + 0.7e1 / 0.36e2 * t219 * t1982 - t510 * t735 / 0.6e1 - t514 * t735 / 0.6e1;
  t1992 = t30 * t525;
  t1993 = t1992 * t530;
  t1996 = t1992 * t540;
  t2001 = t523 * t76;
  t2002 = 0.1e1 / t2001;
  t2003 = t2002 * t1460;
  t2004 = t29 * t84;
  t2005 = t2003 * t2004;
  t2024 = t2002 * t2;
  t2026 = t28 * t84 * t206;
  t2027 = t2024 * t2026;
  t2030 = 0.7e1 / 0.18e2 * t714 * t598 - t1800 - 0.5e1 / 0.243e3 * t522 * t1993 - 0.5e1 / 0.81e2 * t539 * t1996 - 0.5e1 / 0.486e3 * t535 * t1993 + 0.8e1 / 0.6561e4 * t535 * t2005 + 0.2e1 / 0.243e3 * t1580 * t742 + t1566 * t742 / 0.243e3 + 0.8e1 / 0.2187e4 * t1458 * t2005 + 0.8e1 / 0.2187e4 * t522 * t2005 + 0.2e1 / 0.243e3 * t1576 * t742 + t1583 * t742 / 0.243e3 + 0.2e1 / 0.81e2 * t1569 * t732 + 0.2e1 / 0.81e2 * t1573 * t732 + 0.8e1 / 0.243e3 * t1473 * t2027;
  t2033 = t28 * t528 * t84;
  t2034 = t2024 * t2033;
  t2039 = t265 * t578;
  t2040 = t2039 * t99;
  t2041 = t215 * t2040;
  t2053 = t1981 * t206;
  t2060 = t1460 * t84;
  t2063 = 0.176e3 / 0.729e3 * t29 * t1992 + 0.14e2 / 0.243e3 * t130 * t2053 - 0.2e2 / 0.729e3 * t334 * t1992 * t528 + 0.64e2 / 0.19683e5 * t926 * t2002 * t2060;
  t2065 = t27 * t2063 * t100;
  t2072 = t228 * t2053;
  t2077 = 0.8e1 / 0.729e3 * t1446 * t2034 + 0.4e1 / 0.729e3 * t539 * t2034 - 0.8e1 / 0.81e2 * t2041 * t584 + t1891 / 0.729e3 + 0.2e1 / 0.243e3 * t1893 + 0.2e1 / 0.729e3 * t1895 - 0.3e1 / 0.8e1 * t554 * t267 - 0.3e1 / 0.4e1 * t194 * t710 - 0.3e1 / 0.8e1 * t74 * t2065 - t1904 / 0.4e1 - t1906 / 0.4e1 + t1794 - t595 * t745 / 0.18e2 + 0.7e1 / 0.108e3 * t225 * t2072 - t591 * t745 / 0.18e2;
  t2078 = t726 * t583;
  t2089 = t509 * t579;
  t2092 = t215 * t1439;
  t2096 = t99 * t2002 * t2004;
  t2099 = t509 * t717;
  t2102 = t708 * t98;
  t2103 = t215 * t2102;
  t2111 = -0.5e1 / 0.27e2 * t725 * t2078 + 0.7e1 / 0.54e2 * t718 * t587 + t1530 * t273 / 0.48e2 + t1533 * t273 / 0.24e2 + t1537 * t273 / 0.48e2 + 0.2e1 / 0.27e2 * t2089 * t729 + 0.2e1 / 0.27e2 * t2092 * t729 + 0.8e1 / 0.81e2 * t1543 * t2096 - t2099 * t229 / 0.9e1 - t2103 * t229 / 0.9e1 + t1909 / 0.72e2 - t1912 / 0.27e2 + 0.2e1 / 0.81e2 * t1915 - t1806 - t1930 / 0.54e2 + t1932 / 0.72e2;
  t2114 = my_piecewise3(t65, 0, t1989 + t2030 + t2077 + t2111);
  tv3rho2sigma8 = t6 * t2114 + 0.2e1 * t751;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2117 = t1037 * t786 / 0.1944e4;
  t2118 = t773 * t124;
  t2119 = t2118 * t317;
  t2123 = t1042 * t786 / 0.3888e4;
  t2125 = t1025 * t780 / 0.648e3;
  t2126 = t2118 * t306;
  t2143 = -t2117 + t313 * t2119 / 0.486e3 - t2123 - t2125 + t301 * t2126 / 0.162e3 - t1022 * t780 / 0.216e3 - t1057 * t780 / 0.216e3 - t1028 * t786 / 0.648e3 - t1046 * t786 / 0.648e3 + t322 * t2119 / 0.972e3 - t1049 * t786 / 0.1296e4 - t1053 * t786 / 0.1296e4;
  t2145 = t1620 * t249 / 0.24e2;
  t2149 = t297 * t783 / 0.96e2;
  t2150 = t754 * t132;
  t2151 = t148 * t2150;
  t2154 = t764 * t145;
  t2155 = t143 * t2154;
  t2166 = 0.1e1 / t913;
  t2167 = t239 * t2166;
  t2168 = t2167 * t871;
  t2175 = t2145 - t627 * t650 / 0.6e1 - t2149 + t147 * t2151 / 0.24e2 - t2155 * t149 / 0.6e1 + t1601 * t249 / 0.8e1 + t1624 * t249 / 0.8e1 - t287 * t783 / 0.32e2 - t281 * t783 / 0.32e2 - t322 * t2168 / 0.2187e4 + 0.2e1 / 0.81e2 * t1770 * t647 + 0.2e1 / 0.243e3 * t1774 * t659;
  t2180 = t844 * t776 / 0.216e3;
  t2181 = t773 * t643;
  t2188 = t2167 * t852;
  t2191 = t2167 * t858;
  t2201 = t117 * t764 * t60;
  t2203 = t26 * t2201 / 0.8e1;
  t2206 = t1778 * t659 / 0.243e3 - t2180 + t373 * t2181 / 0.54e2 - t841 * t776 / 0.72e2 - t1067 * t776 / 0.72e2 - t848 * t2188 / 0.81e2 - t857 * t2191 / 0.243e3 - t301 * t2191 / 0.486e3 - t867 * t2168 / 0.729e3 - t313 * t2168 / 0.729e3 - t2203 - 0.3e1 / 0.8e1 * t113 * t766;
  t2207 = t2150 * t134;
  t2214 = t926 * t239;
  t2218 = t130 * t2207 / 0.81e2 + 0.2e1 / 0.729e3 * t335 * t759 * t124 * t315 - 0.8e1 / 0.6561e4 * t2214 * t2166 * t869;
  t2220 = t27 * t2218 * t60;
  t2224 = t385 * t789 / 0.288e3;
  t2225 = t156 * t2207;
  t2229 = t1762 * t252 / 0.72e2;
  t2232 = t143 * t1654;
  t2239 = t59 * t239;
  t2242 = t2239 * t2166 * t2 * t28;
  t2249 = t764 * t58;
  t2250 = t143 * t2249;
  t2253 = -0.3e1 / 0.8e1 * t26 * t2220 - t2224 + t153 * t2225 / 0.72e2 + t2229 - t631 * t662 / 0.18e2 + 0.2e1 / 0.27e2 * t2232 * t644 + t1722 * t252 / 0.24e2 + t1766 * t252 / 0.24e2 - t1010 * t2242 / 0.27e2 - t382 * t789 / 0.96e2 - t389 * t789 / 0.96e2 - t2250 * t157 / 0.18e2;
  t2256 = my_piecewise3(t1, 0, t2143 + t2175 + t2206 + t2253);
  tv3rhosigma20 = t6 * t2256 + t795;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2261 = t117 * t807 * t100;
  t2263 = t74 * t2261 / 0.8e1;
  t2267 = t1870 * t270 / 0.24e2;
  t2271 = t1911 * t273 / 0.72e2;
  t2275 = t1304 * t819 / 0.216e3;
  t2279 = t1375 * t823 / 0.648e3;
  t2283 = t478 * t826 / 0.96e2;
  t2287 = t1360 * t829 / 0.1944e4;
  t2291 = t484 * t832 / 0.288e3;
  t2295 = t1372 * t829 / 0.3888e4;
  t2296 = -0.3e1 / 0.8e1 * t168 * t809 - t2263 + t1875 * t270 / 0.8e1 + t2267 + t1926 * t273 / 0.24e2 + t2271 - t1307 * t819 / 0.72e2 - t2275 - t1369 * t823 / 0.216e3 - t2279 - t474 * t826 / 0.32e2 - t2283 - t1363 * t829 / 0.648e3 - t2287 - t481 * t832 / 0.96e2 - t2291 - t1366 * t829 / 0.1296e4 - t2295;
  t2297 = my_piecewise3(t65, 0, t2296);
  tv3rhosigma25 = t6 * t2297 + t838;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2317 = -0.3e1 / 0.8e1 * t184 * t766 - t2203 + t1815 * t249 / 0.8e1 + t2145 + t1847 * t252 / 0.24e2 + t2229 - t1110 * t776 / 0.72e2 - t2180 - t1179 * t780 / 0.216e3 - t2125 - t440 * t783 / 0.32e2 - t2149 - t1182 * t786 / 0.648e3 - t2117 - t443 * t789 / 0.96e2 - t2224 - t1185 * t786 / 0.1296e4 - t2123;
  t2318 = my_piecewise3(t1, 0, t2317);
  tv3rhosigma26 = t6 * t2318 + t795;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2320 = t816 * t199;
  t2321 = t2320 * t530;
  t2324 = t2320 * t540;
  t2341 = t522 * t2321 / 0.486e3 + t539 * t2324 / 0.162e3 - t2279 - t2287 - t2295 - t1569 * t823 / 0.216e3 - t1573 * t823 / 0.216e3 - t1576 * t829 / 0.648e3 - t1580 * t829 / 0.648e3 + t535 * t2321 / 0.972e3 - t1583 * t829 / 0.1296e4 - t1566 * t829 / 0.1296e4;
  t2344 = t797 * t204;
  t2345 = t220 * t2344;
  t2354 = t807 * t217;
  t2355 = t215 * t2354;
  t2360 = t816 * t728;
  t2363 = 0.1e1 / t1428;
  t2364 = t260 * t2363;
  t2365 = t2364 * t1462;
  t2370 = t2267 - t2283 - t714 * t735 / 0.6e1 + t219 * t2345 / 0.24e2 + t1970 * t270 / 0.8e1 - t510 * t826 / 0.32e2 - t514 * t826 / 0.32e2 - t2355 * t221 / 0.6e1 + t1966 * t270 / 0.8e1 + t581 * t2360 / 0.54e2 - t535 * t2365 / 0.2187e4 + 0.2e1 / 0.243e3 * t1953 * t742;
  t2378 = t2364 * t1474;
  t2381 = t2364 * t1451;
  t2394 = t2344 * t206;
  t2401 = t926 * t260;
  t2405 = t130 * t2394 / 0.81e2 + 0.2e1 / 0.729e3 * t335 * t802 * t199 * t528 - 0.8e1 / 0.6561e4 * t2401 * t2363 * t1460;
  t2407 = t27 * t2405 * t100;
  t2410 = t1957 * t742 / 0.243e3 - t1436 * t819 / 0.72e2 - t1441 * t819 / 0.72e2 - t1473 * t2378 / 0.81e2 - t1446 * t2381 / 0.243e3 - t539 * t2381 / 0.486e3 - t1458 * t2365 / 0.729e3 - t522 * t2365 / 0.729e3 + 0.2e1 / 0.81e2 * t1961 * t732 - t2275 - 0.3e1 / 0.8e1 * t194 * t809 - 0.3e1 / 0.8e1 * t74 * t2407;
  t2411 = t228 * t2394;
  t2416 = t807 * t98;
  t2417 = t215 * t2416;
  t2420 = t215 * t2039;
  t2427 = t99 * t260;
  t2430 = t2427 * t2363 * t2 * t28;
  t2437 = -t2263 + t2271 - t2291 + t225 * t2411 / 0.72e2 - t718 * t745 / 0.18e2 - t2417 * t229 / 0.18e2 + 0.2e1 / 0.27e2 * t2420 * t729 + t2099 * t273 / 0.24e2 + t2103 * t273 / 0.24e2 - t1543 * t2430 / 0.27e2 - t591 * t832 / 0.96e2 - t595 * t832 / 0.96e2;
  t2440 = my_piecewise3(t65, 0, t2341 + t2370 + t2410 + t2437);
  tv3rhosigma211 = t6 * t2440 + t838;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2442 = sigma[0] * sigma[0];
  t2443 = 0.1e1 / t2442;
  t2444 = t30 * t2443;
  t2445 = t2444 * t36;
  t2446 = t2445 * t317;
  t2453 = t2444 * t775;
  t2458 = 0.1e1 / t302;
  t2459 = t754 * t2458;
  t2460 = t2459 * t871;
  t2466 = 0.1e1 / t44 / t2442;
  t2467 = t2466 * t47;
  t2468 = t2467 * t134;
  t2469 = t156 * t2468;
  t2478 = t322 * t2446 / 0.864e3 - t1774 * t786 / 0.216e3 - t1778 * t786 / 0.432e3 + t373 * t2453 / 0.48e2 - t1770 * t780 / 0.72e2 + t867 * t2460 / 0.1944e4 + t313 * t2460 / 0.1944e4 + t153 * t2469 / 0.64e2 + t322 * t2460 / 0.5832e4 - t1656 * t776 / 0.24e2 - t631 * t789 / 0.32e2;
  t2479 = t2459 * t852;
  t2482 = t2459 * t858;
  t2493 = t2458 * t2 * t28;
  t2494 = t59 * t754 * t2493;
  t2497 = t148 * t2467;
  t2502 = t2445 * t306;
  t2514 = t2458 * t869;
  t2517 = t130 * t2468 / 0.72e2 + t335 * t2443 * t36 * t315 / 0.324e3 + t926 * t754 * t2514 / 0.2187e4;
  t2519 = t27 * t2517 * t60;
  t2522 = t848 * t2479 / 0.216e3 + t857 * t2482 / 0.648e3 + t301 * t2482 / 0.1296e4 + t2250 * t252 / 0.16e2 - 0.3e1 / 0.32e2 * t627 * t783 + t1010 * t2494 / 0.72e2 + 0.3e1 / 0.64e2 * t147 * t2497 + 0.3e1 / 0.16e2 * t2155 * t249 + t301 * t2502 / 0.144e3 + t313 * t2446 / 0.432e3 - 0.3e1 / 0.8e1 * t26 * t2519;
  t2524 = my_piecewise3(t1, 0, t2478 + t2522);
  tv3sigma30 = t6 * t2524;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2525 = sigma[2] * sigma[2];
  t2527 = 0.1e1 / t84 / t2525;
  t2528 = t2527 * t87;
  t2529 = t220 * t2528;
  t2537 = 0.1e1 / t523;
  t2539 = t2537 * t2 * t28;
  t2540 = t99 * t797 * t2539;
  t2543 = 0.1e1 / t2525;
  t2544 = t30 * t2543;
  t2545 = t2544 * t80;
  t2546 = t2545 * t530;
  t2555 = t2544 * t818;
  t2558 = t797 * t2537;
  t2559 = t2558 * t1451;
  t2564 = 0.3e1 / 0.64e2 * t219 * t2529 + t2417 * t273 / 0.16e2 - 0.3e1 / 0.32e2 * t714 * t826 + t1543 * t2540 / 0.72e2 + t535 * t2546 / 0.864e3 - t1961 * t823 / 0.72e2 - t1953 * t829 / 0.216e3 - t1957 * t829 / 0.432e3 + t581 * t2555 / 0.48e2 + t1446 * t2559 / 0.648e3 + t539 * t2559 / 0.1296e4;
  t2565 = t2558 * t1462;
  t2570 = t2528 * t206;
  t2571 = t228 * t2570;
  t2580 = t2558 * t1474;
  t2585 = t2545 * t540;
  t2597 = t2537 * t1460;
  t2600 = t130 * t2570 / 0.72e2 + t335 * t2543 * t80 * t528 / 0.324e3 + t926 * t797 * t2597 / 0.2187e4;
  t2602 = t27 * t2600 * t100;
  t2605 = t1458 * t2565 / 0.1944e4 + t522 * t2565 / 0.1944e4 + t225 * t2571 / 0.64e2 + t535 * t2565 / 0.5832e4 - t2041 * t819 / 0.24e2 - t718 * t832 / 0.32e2 + t1473 * t2580 / 0.216e3 + 0.3e1 / 0.16e2 * t2355 * t270 + t539 * t2585 / 0.144e3 + t522 * t2546 / 0.432e3 - 0.3e1 / 0.8e1 * t74 * t2602;
  t2607 = my_piecewise3(t65, 0, t2564 + t2605);
  tv3sigma39 = t6 * t2607;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2610 = t296 * t1056;
  t2611 = t2610 * t307;
  t2613 = t879 * t312;
  t2614 = t2613 * t318;
  t2616 = t1037 * t1031;
  t2619 = 0.1e1 / t34 / t1634;
  t2620 = t31 * t2619;
  t2621 = t2620 * t317;
  t2624 = t879 * t321;
  t2625 = t2624 * t318;
  t2627 = t1042 * t1031;
  t2631 = t1025 * t1034;
  t2636 = t286 * t1056;
  t2640 = t143 * t901 * t155;
  t2643 = t905 * t300;
  t2644 = t2643 * t307;
  t2646 = t909 * t300;
  t2649 = t879 * t300;
  t2650 = t2649 * t307;
  t2652 = t286 * t1045;
  t2657 = -0.32e2 / 0.243e3 * t2611 + 0.32e2 / 0.2187e4 * t2614 + 0.224e3 / 0.2187e4 * t2616 - 0.3416e4 / 0.6561e4 * t313 * t2621 + 0.16e2 / 0.2187e4 * t2625 + 0.112e3 / 0.2187e4 * t2627 - 0.1708e4 / 0.6561e4 * t322 * t2621 + 0.224e3 / 0.729e3 * t2631 - 0.3416e4 / 0.2187e4 * t301 * t2620 * t306 - 0.32e2 / 0.81e2 * t2636 * t307 - 0.16e2 / 0.81e2 * t2640 * t307 - 0.32e2 / 0.243e3 * t2644 - 0.16e2 / 0.81e2 * t2646 * t307 + 0.32e2 / 0.729e3 * t2650 - 0.32e2 / 0.243e3 * t2652 * t318 + 0.112e3 / 0.729e3 * t1049 * t1031;
  t2660 = t909 * t312;
  t2664 = t143 * t994 * t311;
  t2667 = t909 * t321;
  t2670 = t286 * t1052;
  t2674 = t143 * t994 * t155;
  t2681 = t905 * t312;
  t2682 = t2681 * t318;
  t2684 = t296 * t1045;
  t2685 = t2684 * t318;
  t2691 = t905 * t321;
  t2692 = t2691 * t318;
  t2694 = t296 * t1052;
  t2695 = t2694 * t318;
  t2701 = t297 * t896;
  t2703 = 0.112e3 / 0.729e3 * t1053 * t1031 - 0.16e2 / 0.243e3 * t2660 * t318 - 0.16e2 / 0.243e3 * t2664 * t318 - 0.8e1 / 0.243e3 * t2667 * t318 - 0.16e2 / 0.243e3 * t2670 * t318 - 0.8e1 / 0.243e3 * t2674 * t318 + 0.224e3 / 0.243e3 * t1022 * t1034 + 0.224e3 / 0.243e3 * t1057 * t1034 - 0.32e2 / 0.729e3 * t2682 - 0.32e2 / 0.729e3 * t2685 + 0.224e3 / 0.729e3 * t1028 * t1031 + 0.224e3 / 0.729e3 * t1046 * t1031 - 0.16e2 / 0.729e3 * t2692 - 0.16e2 / 0.729e3 * t2695 - 0.14e3 / 0.27e2 * t281 * t896 - 0.14e3 / 0.27e2 * t287 * t896 - 0.14e3 / 0.81e2 * t2701;
  t2705 = t883 * t392;
  t2707 = t880 * t392;
  t2711 = t906 * t392;
  t2715 = t905 * t280;
  t2716 = t2715 * t149;
  t2720 = t296 * t901;
  t2721 = t2720 * t149;
  t2723 = t909 * t280;
  t2726 = t286 * t901;
  t2730 = t143 * t931 * t145;
  t2733 = t112 * t291;
  t2734 = t2733 * t146;
  t2735 = t2734 * t149;
  t2737 = t359 * t117;
  t2738 = t2737 * t146;
  t2739 = t2738 * t149;
  t2741 = t965 * t27;
  t2742 = t2741 * t146;
  t2745 = t25 * t943;
  t2746 = t2745 * t146;
  t2747 = t2746 * t149;
  t2749 = t879 * t280;
  t2750 = t2749 * t149;
  t2753 = 0.1e1 / t33 / t913;
  t2754 = t44 * t2753;
  t2758 = 0.14e2 / 0.9e1 * t2705 - 0.14e2 / 0.27e2 * t2707 + 0.7e1 / 0.3e1 * t902 * t392 + 0.14e2 / 0.9e1 * t2711 + 0.7e1 / 0.3e1 * t910 * t392 - 0.4e1 / 0.3e1 * t2716 + 0.14e2 / 0.3e1 * t899 * t392 - 0.2e1 / 0.3e1 * t2721 - 0.2e1 * t2723 * t149 - 0.2e1 * t2726 * t149 - 0.2e1 / 0.3e1 * t2730 * t149 + 0.4e1 / 0.9e1 * t2735 - 0.2e1 / 0.3e1 * t2739 - 0.2e1 / 0.3e1 * t2742 * t149 - 0.2e2 / 0.81e2 * t2747 + 0.4e1 / 0.9e1 * t2750 + 0.455e3 / 0.81e2 * t147 * t148 * t2754;
  t2759 = t302 * t302;
  t2760 = 0.1e1 / t2759;
  t2761 = t753 * t2760;
  t2762 = t2761 * t871;
  t2766 = t143 * t280 * t311;
  t2770 = t143 * t388 * t865;
  t2790 = t143 * t1065 * t155;
  t2798 = t2761 * t858;
  t2801 = t296 * t856;
  t2802 = t2801 * t859;
  t2804 = t296 * t866;
  t2805 = t2804 * t872;
  t2807 = 0.896e3 / 0.6561e4 * t313 * t2762 - 0.256e3 / 0.2187e4 * t2766 * t859 - 0.256e3 / 0.6561e4 * t2770 * t872 - 0.256e3 / 0.6561e4 * t1046 * t872 - 0.128e3 / 0.2187e4 * t1022 * t859 - 0.256e3 / 0.6561e4 * t1028 * t872 - 0.256e3 / 0.19683e5 * t1049 * t872 - 0.128e3 / 0.2187e4 * t1057 * t859 - 0.256e3 / 0.19683e5 * t1053 * t872 + 0.224e3 / 0.81e2 * t841 * t1062 + 0.224e3 / 0.81e2 * t1067 * t1062 - 0.256e3 / 0.729e3 * t2790 * t853 + 0.896e3 / 0.19683e5 * t322 * t2762 + 0.896e3 / 0.729e3 * t848 * t2761 * t852 + 0.896e3 / 0.2187e4 * t857 * t2798 - 0.256e3 / 0.6561e4 * t2802 - 0.256e3 / 0.19683e5 * t2805;
  t2810 = t1037 * t872;
  t2814 = t1025 * t859;
  t2816 = t1042 * t872;
  t2818 = t286 * t1066;
  t2821 = t340 * t370;
  t2823 = t143 * t2821 * t59;
  t2826 = t905 * t372;
  t2827 = t2826 * t376;
  t2831 = t296 * t1066;
  t2832 = t2831 * t376;
  t2834 = t844 * t1062;
  t2842 = t143 * t1009 * t155;
  t2845 = 0.1e1 / t33 / t2759 / rho[0];
  t2846 = t2442 * t2845;
  t2848 = M_PI * t134 * t43;
  t2853 = t143 * t371 * t311;
  t2855 = M_PI * t315 * t43;
  t2856 = t2846 * t2855;
  t2862 = t143 * t146 * t865;
  t2864 = M_PI * t869 * t43;
  t2865 = t2846 * t2864;
  t2870 = -0.256e3 / 0.19683e5 * t2810 + 0.896e3 / 0.6561e4 * t867 * t2762 - 0.128e3 / 0.6561e4 * t2814 - 0.256e3 / 0.59049e5 * t2816 - 0.32e2 / 0.27e2 * t2818 * t376 - 0.16e2 / 0.27e2 * t2823 * t376 - 0.32e2 / 0.81e2 * t2827 + 0.448e3 / 0.2187e4 * t301 * t2798 - 0.32e2 / 0.81e2 * t2832 + 0.224e3 / 0.243e3 * t2834 - 0.3416e4 / 0.729e3 * t373 * t31 * t2619 * t41 * t3 - 0.1024e4 / 0.6561e4 * t2842 * t2846 * t2848 - 0.1024e4 / 0.19683e5 * t2853 * t2856 - 0.512e3 / 0.19683e5 * t848 * t2856 - 0.1024e4 / 0.59049e5 * t2862 * t2865 - 0.1024e4 / 0.59049e5 * t857 * t2865;
  t2873 = t286 * t847;
  t2876 = t286 * t856;
  t2879 = t296 * t847;
  t2880 = t2879 * t853;
  t2882 = t286 * t866;
  t2885 = t909 * t372;
  t2888 = t879 * t372;
  t2889 = t2888 * t376;
  t2892 = 0.1e1 / t864 / t52;
  t2894 = t143 * t152 * t2892;
  t2895 = t314 * t314;
  t2896 = 0.1e1 / t2895;
  t2898 = t2896 * M_PI * t43;
  t2899 = t2846 * t2898;
  t2910 = t26 * t291 * t340 * t60;
  t2914 = t26 * t943 * t138 * t60;
  t2916 = t19 * t19;
  t2918 = 0.1e1 / t345 / t2916;
  t2919 = t347 * t347;
  t2925 = t355 * t355;
  t2931 = 0.1e1 / t956 / t6;
  t2932 = t16 * t2931;
  t2935 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t957 + 0.24e2 * t2932);
  t2939 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2918 * t2919 - 0.16e2 / 0.9e1 * t949 * t347 * t355 + 0.4e1 / 0.3e1 * t346 * t2925 + 0.16e2 / 0.9e1 * t953 * t961 + 0.4e1 / 0.3e1 * t23 * t2935);
  t2947 = t966 * t119;
  t2949 = -0.1024e4 / 0.177147e6 * t301 * t2865 - 0.256e3 / 0.729e3 * t2873 * t853 - 0.256e3 / 0.2187e4 * t2876 * t859 - 0.256e3 / 0.2187e4 * t2880 - 0.256e3 / 0.6561e4 * t2882 * t872 - 0.16e2 / 0.27e2 * t2885 * t376 + 0.32e2 / 0.243e3 * t2889 - 0.1024e4 / 0.177147e6 * t2894 * t2899 - 0.512e3 / 0.59049e5 * t867 * t2899 - 0.2816e4 / 0.531441e6 * t313 * t2899 - 0.256e3 / 0.177147e6 * t322 * t2899 + t2910 / 0.2e1 - 0.5e1 / 0.9e1 * t2914 - 0.3e1 / 0.8e1 * t5 * t2939 * t61 - 0.3e1 / 0.2e1 * t966 * t140 - 0.9e1 / 0.4e1 * t360 * t342 - t2947 / 0.2e1;
  t2951 = t360 * t366;
  t2953 = t113 * t945;
  t2956 = 0.1e1 / t116 / t350;
  t2960 = 0.1e2 / 0.27e2 * t26 * t2956 * t54 * t60;
  t2965 = t2754 * t134;
  t2975 = t3 * t926;
  t2979 = t2896 * t41 * t43;
  t2987 = t113 * t937;
  t2991 = t26 * t117 * t931 * t60;
  t2993 = t360 * t293;
  t2995 = t113 * t978;
  t3005 = t991 * t379;
  t3007 = t385 * t985;
  t3012 = t143 * t54 / t1007 / t57;
  t3019 = t286 * t994;
  t3022 = -0.3e1 / 0.2e1 * t2951 - 0.5e1 / 0.9e1 * t2953 + t2960 - 0.3e1 / 0.2e1 * t113 * t933 - 0.3e1 / 0.8e1 * t26 * t27 * (0.41888e5 / 0.6561e4 * t29 * t2620 + 0.364e4 / 0.2187e4 * t130 * t2965 - 0.13664e5 / 0.19683e5 * t335 * sigma[0] * t2619 * t315 + 0.7168e4 / 0.59049e5 * t927 * t2760 * t869 - 0.2048e4 / 0.1594323e7 * t2975 * t2442 * t2845 * t2979) * t60 - 0.3e1 / 0.2e1 * t2987 - t2991 / 0.2e1 + t2993 / 0.2e1 + t2995 + 0.14e2 / 0.9e1 * t1001 * t379 + 0.7e1 / 0.9e1 * t995 * t379 + 0.7e1 / 0.9e1 * t998 * t379 + 0.455e3 / 0.243e3 * t153 * t156 * t2965 - 0.14e2 / 0.81e2 * t3005 - 0.14e3 / 0.243e3 * t3007 - 0.1024e4 / 0.2187e4 * t3012 * t59 * t2442 * t2845 * M_PI * t43 - 0.2e1 / 0.3e1 * t3019 * t157;
  t3024 = t143 * t931 * t58;
  t3028 = t143 * t138 * t1008;
  t3031 = t286 * t1009;
  t3034 = t296 * t1009;
  t3035 = t3034 * t1014;
  t3037 = t988 * t379;
  t3039 = t1004 * t379;
  t3050 = t2741 * t152;
  t3053 = t909 * t388;
  t3056 = t2737 * t152;
  t3057 = t3056 * t157;
  t3059 = t905 * t388;
  t3060 = t3059 * t157;
  t3062 = t879 * t388;
  t3063 = t3062 * t157;
  t3065 = t2733 * t152;
  t3066 = t3065 * t157;
  t3068 = t2745 * t152;
  t3069 = t3068 * t157;
  t3071 = t296 * t994;
  t3072 = t3071 * t157;
  t3074 = -0.2e1 / 0.9e1 * t3024 * t157 - 0.256e3 / 0.243e3 * t3028 * t1014 - 0.256e3 / 0.243e3 * t3031 * t1014 - 0.256e3 / 0.729e3 * t3035 + 0.14e2 / 0.27e2 * t3037 + 0.14e2 / 0.27e2 * t3039 - 0.14e3 / 0.81e2 * t382 * t985 - 0.14e3 / 0.81e2 * t389 * t985 + 0.896e3 / 0.243e3 * t1010 * t1011 * t2760 * t2 * t28 - 0.2e1 / 0.9e1 * t3050 * t157 - 0.2e1 / 0.3e1 * t3053 * t157 - 0.2e1 / 0.9e1 * t3057 - 0.4e1 / 0.9e1 * t3060 + 0.4e1 / 0.27e2 * t3063 + 0.4e1 / 0.27e2 * t3066 - 0.2e2 / 0.243e3 * t3069 - 0.2e1 / 0.9e1 * t3072;
  t3078 = my_piecewise3(t1, 0, t2657 + t2703 + t2758 + t2807 + t2870 + t2949 + t3022 + t3074);
  t3079 = t69 * t69;
  t3081 = 0.1e1 / t397 / t3079;
  t3082 = t399 * t399;
  t3088 = t405 * t405;
  t3093 = t66 * t2931;
  t3096 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t957 + 0.24e2 * t3093);
  t3100 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t3082 - 0.16e2 / 0.9e1 * t1075 * t399 * t405 + 0.4e1 / 0.3e1 * t398 * t3088 + 0.16e2 / 0.9e1 * t1079 * t1085 + 0.4e1 / 0.3e1 * t71 * t3096);
  t3104 = t1090 * t172;
  t3106 = t410 * t416;
  t3108 = t168 * t1098;
  t3113 = 0.1e2 / 0.27e2 * t74 * t2956 * t94 * t100;
  t3115 = my_piecewise3(t65, 0, -0.3e1 / 0.8e1 * t5 * t3100 * t101 - t3104 / 0.2e1 + t3106 / 0.2e1 - 0.5e1 / 0.9e1 * t3108 + t3113);
  tv4rho40 = 0.4e1 * t1073 + 0.4e1 * t1102 + t6 * (t3078 + t3115);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3122 = t1116 * t300;
  t3125 = t1120 * t300;
  t3126 = t3125 * t307;
  t3128 = t439 * t1056;
  t3131 = t1116 * t312;
  t3134 = t439 * t1045;
  t3137 = t1116 * t321;
  t3140 = t439 * t1052;
  t3148 = 0.56e2 / 0.243e3 * t1179 * t1034 - 0.8e1 / 0.81e2 * t3122 * t307 - 0.8e1 / 0.243e3 * t3126 - 0.8e1 / 0.81e2 * t3128 * t307 - 0.8e1 / 0.243e3 * t3131 * t318 - 0.8e1 / 0.243e3 * t3134 * t318 - 0.4e1 / 0.243e3 * t3137 * t318 - 0.4e1 / 0.243e3 * t3140 * t318 - 0.8e1 / 0.243e3 * t2611 + 0.16e2 / 0.2187e4 * t2614 + 0.56e2 / 0.2187e4 * t2616 + 0.8e1 / 0.2187e4 * t2625 + 0.28e2 / 0.2187e4 * t2627;
  t3150 = t1120 * t312;
  t3151 = t3150 * t318;
  t3155 = t1120 * t321;
  t3156 = t3155 * t318;
  t3170 = 0.56e2 / 0.729e3 * t2631 - 0.8e1 / 0.729e3 * t3151 + 0.56e2 / 0.729e3 * t1182 * t1031 - 0.4e1 / 0.729e3 * t3156 + 0.28e2 / 0.729e3 * t1185 * t1031 - 0.8e1 / 0.243e3 * t2644 + 0.16e2 / 0.729e3 * t2650 - 0.8e1 / 0.729e3 * t2682 - 0.8e1 / 0.729e3 * t2685 - 0.4e1 / 0.729e3 * t2692 - 0.4e1 / 0.729e3 * t2695 - 0.35e2 / 0.27e2 * t440 * t896 + 0.7e1 / 0.6e1 * t1124 * t392;
  t3174 = t1121 * t392;
  t3182 = t439 * t901;
  t3185 = t431 * t117;
  t3186 = t3185 * t146;
  t3187 = t3186 * t149;
  t3189 = t1147 * t27;
  t3190 = t3189 * t146;
  t3193 = t1116 * t280;
  t3195 = t183 * t291;
  t3196 = t3195 * t146;
  t3197 = t3196 * t149;
  t3198 = t3197 / 0.9e1;
  t3199 = 0.7e1 / 0.6e1 * t1117 * t392 + 0.7e1 / 0.18e2 * t3174 - 0.35e2 / 0.81e2 * t2701 + 0.7e1 / 0.18e2 * t2705 - 0.7e1 / 0.27e2 * t2707 + 0.7e1 / 0.18e2 * t2711 - t2716 / 0.3e1 - t2721 / 0.6e1 - t3182 * t149 / 0.2e1 - t3187 / 0.3e1 - t3190 * t149 / 0.2e1 - t3193 * t149 + t3198;
  t3200 = t1120 * t280;
  t3201 = t3200 * t149;
  t3209 = t1120 * t372;
  t3210 = t3209 * t376;
  t3212 = t439 * t1066;
  t3215 = t439 * t847;
  t3218 = t439 * t856;
  t3223 = t439 * t866;
  t3230 = -t3201 / 0.3e1 + 0.2e1 / 0.9e1 * t2735 - t2739 / 0.6e1 - 0.5e1 / 0.27e2 * t2747 + 0.2e1 / 0.9e1 * t2750 + 0.56e2 / 0.81e2 * t1110 * t1062 - 0.8e1 / 0.81e2 * t3210 - 0.8e1 / 0.27e2 * t3212 * t376 - 0.64e2 / 0.729e3 * t3215 * t853 - 0.64e2 / 0.2187e4 * t3218 * t859 - 0.32e2 / 0.2187e4 * t1179 * t859 - 0.64e2 / 0.6561e4 * t3223 * t872 - 0.64e2 / 0.6561e4 * t1182 * t872 - 0.64e2 / 0.19683e5 * t1185 * t872;
  t3233 = t1116 * t372;
  t3246 = t184 * t937;
  t3250 = -0.8e1 / 0.27e2 * t3233 * t376 - 0.64e2 / 0.6561e4 * t2802 - 0.64e2 / 0.19683e5 * t2805 - 0.64e2 / 0.19683e5 * t2810 - 0.32e2 / 0.6561e4 * t2814 - 0.64e2 / 0.59049e5 * t2816 - 0.8e1 / 0.81e2 * t2827 - 0.8e1 / 0.81e2 * t2832 + 0.56e2 / 0.243e3 * t2834 - 0.64e2 / 0.2187e4 * t2880 + 0.16e2 / 0.243e3 * t2889 - 0.3e1 / 0.8e1 * t3246 - 0.3e1 / 0.8e1 * t184 * t933;
  t3251 = t432 * t293;
  t3252 = t3251 / 0.4e1;
  t3253 = t184 * t945;
  t3255 = t1148 * t119;
  t3257 = t432 * t366;
  t3259 = t184 * t978;
  t3260 = t3259 / 0.4e1;
  t3277 = 0.12e2 * t957;
  t3278 = 0.24e2 * t2932;
  t3280 = my_piecewise5(t10, 0, t14, 0, -t3277 + t3278);
  t3284 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2918 * t180 * t950 - 0.8e1 / 0.9e1 * t949 * t427 * t347 - 0.8e1 / 0.9e1 * t1132 * t109 * t355 + 0.4e1 / 0.3e1 * t346 * t1143 * t109 + 0.4e1 / 0.3e1 * t1135 * t355 + 0.4e1 / 0.9e1 * t423 * t961 + 0.4e1 / 0.3e1 * t23 * t3280);
  t3297 = t3252 - 0.5e1 / 0.36e2 * t3253 - 0.3e1 / 0.8e1 * t3255 - 0.3e1 / 0.4e1 * t3257 + t3260 - 0.3e1 / 0.8e1 * t5 * t3284 * t61 - 0.9e1 / 0.8e1 * t1148 * t140 - 0.9e1 / 0.8e1 * t432 * t342 + t2910 / 0.4e1 - 0.5e1 / 0.12e2 * t2914 - t2947 / 0.8e1 - 0.3e1 / 0.8e1 * t2951 - 0.5e1 / 0.12e2 * t2953;
  t3311 = t2960 - 0.3e1 / 0.8e1 * t2987 - t2991 / 0.8e1 + t2993 / 0.4e1 + t2995 / 0.2e1 - 0.7e1 / 0.81e2 * t3005 - 0.35e2 / 0.243e3 * t3007 - 0.64e2 / 0.729e3 * t3035 + 0.7e1 / 0.54e2 * t3037 + 0.7e1 / 0.54e2 * t3039 - t3057 / 0.18e2 - t3060 / 0.9e1 + 0.2e1 / 0.27e2 * t3063;
  t3317 = t1168 * t379;
  t3319 = t3189 * t152;
  t3322 = t1116 * t388;
  t3325 = t1120 * t388;
  t3326 = t3325 * t157;
  t3328 = t439 * t994;
  t3331 = t439 * t1009;
  t3338 = t3185 * t152;
  t3339 = t3338 * t157;
  t3341 = t3195 * t152;
  t3342 = t3341 * t157;
  t3343 = t3342 / 0.27e2;
  t3344 = 0.2e1 / 0.27e2 * t3066 - 0.5e1 / 0.81e2 * t3069 - t3072 / 0.18e2 - 0.35e2 / 0.81e2 * t443 * t985 + 0.7e1 / 0.54e2 * t3317 - t3319 * t157 / 0.6e1 - t3322 * t157 / 0.3e1 - t3326 / 0.9e1 - t3328 * t157 / 0.6e1 - 0.64e2 / 0.243e3 * t3331 * t1014 + 0.7e1 / 0.18e2 * t1165 * t379 + 0.7e1 / 0.18e2 * t1171 * t379 - t3339 / 0.9e1 + t3343;
  t3348 = my_piecewise3(t1, 0, t3148 + t3170 + t3199 + t3230 + t3250 + t3297 + t3311 + t3344);
  t3349 = t409 * t117;
  t3350 = t3349 * t224;
  t3351 = t3350 * t229;
  t3353 = t167 * t291;
  t3354 = t3353 * t224;
  t3355 = t3354 * t229;
  t3356 = t3355 / 0.27e2;
  t3357 = t73 * t943;
  t3358 = t3357 * t224;
  t3359 = t3358 * t229;
  t3363 = t74 * t943 * t210 * t100;
  t3365 = t1089 * t27;
  t3366 = t3365 * t218;
  t3369 = t1208 * t172;
  t3371 = t461 * t416;
  t3372 = t3371 / 0.4e1;
  t3373 = t194 * t1098;
  t3375 = t410 * t470;
  t3377 = t168 * t1222;
  t3378 = t3377 / 0.4e1;
  t3398 = 0.24e2 * t3093;
  t3400 = my_piecewise5(t14, 0, t10, 0, t3277 + t3398);
  t3404 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t190 * t1076 - 0.8e1 / 0.9e1 * t1075 * t456 * t399 - 0.8e1 / 0.9e1 * t1193 * t164 * t405 + 0.4e1 / 0.3e1 * t398 * t1203 * t164 + 0.4e1 / 0.3e1 * t1196 * t405 + 0.4e1 / 0.9e1 * t452 * t1085 + 0.4e1 / 0.3e1 * t71 * t3400);
  t3410 = t3357 * t218;
  t3411 = t3410 * t221;
  t3413 = t3365 * t224;
  t3416 = t3349 * t218;
  t3417 = t3416 * t221;
  t3419 = t3353 * t218;
  t3420 = t3419 * t221;
  t3421 = t3420 / 0.9e1;
  t3422 = -t3351 / 0.18e2 + t3356 - 0.5e1 / 0.243e3 * t3359 - 0.5e1 / 0.36e2 * t3363 - t3366 * t221 / 0.6e1 - 0.3e1 / 0.8e1 * t3369 + t3372 - 0.5e1 / 0.36e2 * t3373 - 0.3e1 / 0.8e1 * t3375 + t3378 - t3104 / 0.8e1 + t3106 / 0.4e1 - 0.5e1 / 0.12e2 * t3108 + t3113 - 0.3e1 / 0.8e1 * t5 * t3404 * t101 - 0.3e1 / 0.8e1 * t1090 * t212 - 0.5e1 / 0.81e2 * t3411 - t3413 * t229 / 0.18e2 - t3417 / 0.6e1 + t3421;
  t3423 = my_piecewise3(t65, 0, t3422);
  tv4rho41 = t1073 + t1102 + 0.3e1 * t1192 + 0.3e1 * t1247 + t6 * (t3348 + t3423);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t3430 = t1271 * t312;
  t3433 = t1271 * t321;
  t3436 = t1271 * t300;
  t3447 = t1271 * t280;
  t3450 = t1263 * t27;
  t3451 = t3450 * t146;
  t3454 = t502 * t117;
  t3455 = t3454 * t146;
  t3456 = t3455 * t149;
  t3458 = -0.8e1 / 0.729e3 * t3430 * t318 - 0.4e1 / 0.729e3 * t3433 * t318 - 0.8e1 / 0.243e3 * t3436 * t307 - 0.16e2 / 0.729e3 * t3126 + 0.16e2 / 0.6561e4 * t2614 + 0.8e1 / 0.6561e4 * t2625 - 0.16e2 / 0.2187e4 * t3151 - 0.8e1 / 0.2187e4 * t3156 + 0.16e2 / 0.2187e4 * t2650 + 0.7e1 / 0.18e2 * t1272 * t392 - t3447 * t149 / 0.3e1 - t3451 * t149 / 0.3e1 - t3456 / 0.9e1;
  t3467 = t1271 * t372;
  t3472 = t1264 * t119;
  t3474 = t503 * t293;
  t3484 = t427 * t427;
  t3497 = my_piecewise5(t10, 0, t14, 0, t3278);
  t3501 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2918 * t493 * t347 - 0.32e2 / 0.27e2 * t1132 * t109 * t427 - 0.8e1 / 0.27e2 * t1250 * t355 + 0.8e1 / 0.9e1 * t346 * t3484 + 0.8e1 / 0.9e1 * t423 * t1143 - 0.8e1 / 0.27e2 * t949 * t498 * t347 + 0.8e1 / 0.9e1 * t346 * t1259 * t109 + 0.4e1 / 0.9e1 * t1255 * t355 + 0.4e1 / 0.3e1 * t23 * t3497);
  t3505 = 0.7e1 / 0.27e2 * t3174 - 0.7e1 / 0.81e2 * t2707 - 0.2e1 / 0.9e1 * t3187 + 0.4e1 / 0.27e2 * t3197 - 0.2e1 / 0.9e1 * t3201 + 0.2e1 / 0.27e2 * t2735 - 0.1e2 / 0.81e2 * t2747 + 0.2e1 / 0.27e2 * t2750 - 0.8e1 / 0.81e2 * t3467 * t376 - 0.16e2 / 0.243e3 * t3210 + 0.16e2 / 0.729e3 * t2889 - t3472 / 0.4e1 + t3474 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t3501 * t61;
  t3509 = t503 * t366;
  t3522 = -0.3e1 / 0.4e1 * t1264 * t140 - t3509 / 0.4e1 - 0.3e1 / 0.8e1 * t503 * t342 - t3246 / 0.4e1 + t3251 / 0.3e1 - 0.5e1 / 0.18e2 * t3253 - t3255 / 0.4e1 - t3257 / 0.2e1 + t3259 / 0.3e1 + t2910 / 0.12e2 - 0.5e1 / 0.18e2 * t2914 - 0.5e1 / 0.18e2 * t2953 + t2960;
  t3535 = t3450 * t152;
  t3538 = t3454 * t152;
  t3539 = t3538 * t157;
  t3541 = t1271 * t388;
  t3544 = t2993 / 0.12e2 + t2995 / 0.6e1 - 0.7e1 / 0.243e3 * t3005 + 0.2e1 / 0.81e2 * t3063 + 0.2e1 / 0.81e2 * t3066 - 0.1e2 / 0.243e3 * t3069 + 0.7e1 / 0.81e2 * t3317 - 0.2e1 / 0.27e2 * t3326 - 0.2e1 / 0.27e2 * t3339 + 0.4e1 / 0.81e2 * t3342 + 0.7e1 / 0.54e2 * t1275 * t379 - t3535 * t157 / 0.9e1 - t3539 / 0.27e2 - t3541 * t157 / 0.9e1;
  t3547 = my_piecewise3(t1, 0, t3458 + t3505 + t3522 + t3544);
  t3548 = t1233 * t521;
  t3549 = t3548 * t531;
  t3551 = t1233 * t534;
  t3552 = t3551 * t531;
  t3554 = t1233 * t538;
  t3555 = t3554 * t541;
  t3557 = t1225 * t521;
  t3560 = t1225 * t534;
  t3563 = t1225 * t538;
  t3566 = t1229 * t534;
  t3567 = t3566 * t531;
  t3569 = t1229 * t538;
  t3570 = t3569 * t541;
  t3572 = t1229 * t521;
  t3573 = t3572 * t531;
  t3575 = t1233 * t513;
  t3576 = t3575 * t221;
  t3578 = t1234 * t598;
  t3580 = t460 * t117;
  t3581 = t3580 * t218;
  t3582 = t3581 * t221;
  t3584 = t1229 * t513;
  t3585 = t3584 * t221;
  t3587 = 0.16e2 / 0.6561e4 * t3549 + 0.8e1 / 0.6561e4 * t3552 + 0.16e2 / 0.2187e4 * t3555 - 0.8e1 / 0.729e3 * t3557 * t531 - 0.4e1 / 0.729e3 * t3560 * t531 - 0.8e1 / 0.243e3 * t3563 * t541 - 0.8e1 / 0.2187e4 * t3567 - 0.16e2 / 0.729e3 * t3570 - 0.16e2 / 0.2187e4 * t3573 + 0.2e1 / 0.27e2 * t3576 - 0.7e1 / 0.81e2 * t3578 - 0.2e1 / 0.9e1 * t3582 - 0.2e1 / 0.9e1 * t3585;
  t3588 = t193 * t291;
  t3589 = t3588 * t218;
  t3590 = t3589 * t221;
  t3592 = t1230 * t598;
  t3594 = t1225 * t513;
  t3599 = t1207 * t27;
  t3600 = t3599 * t218;
  t3606 = t1233 * t580;
  t3607 = t3606 * t584;
  t3609 = t1225 * t580;
  t3612 = t1229 * t580;
  t3613 = t3612 * t584;
  t3615 = t1328 * t172;
  t3617 = t461 * t470;
  t3619 = t168 * t1311;
  t3621 = 0.2e1 / 0.27e2 * t3590 + 0.7e1 / 0.27e2 * t3592 - t3594 * t221 / 0.3e1 + 0.7e1 / 0.18e2 * t1226 * t598 - t3600 * t221 / 0.3e1 - 0.1e2 / 0.81e2 * t3411 - t3417 / 0.9e1 + 0.4e1 / 0.27e2 * t3420 + 0.16e2 / 0.729e3 * t3607 - 0.8e1 / 0.81e2 * t3609 * t584 - 0.16e2 / 0.243e3 * t3613 - t3615 / 0.4e1 - t3617 / 0.2e1 - t3619 / 0.4e1;
  t3631 = t456 * t456;
  t3644 = my_piecewise5(t14, 0, t10, 0, t3398);
  t3648 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t544 * t399 - 0.32e2 / 0.27e2 * t1193 * t164 * t456 - 0.8e1 / 0.27e2 * t1314 * t405 + 0.8e1 / 0.9e1 * t398 * t3631 + 0.8e1 / 0.9e1 * t452 * t1203 - 0.8e1 / 0.27e2 * t1075 * t549 * t399 + 0.8e1 / 0.9e1 * t398 * t1323 * t164 + 0.4e1 / 0.9e1 * t1319 * t405 + 0.4e1 / 0.3e1 * t71 * t3644);
  t3656 = t554 * t416;
  t3658 = t194 * t1222;
  t3662 = t74 * t291 * t571 * t100;
  t3671 = -0.3e1 / 0.8e1 * t5 * t3648 * t101 - 0.3e1 / 0.4e1 * t1208 * t212 - 0.3e1 / 0.8e1 * t410 * t573 + t3656 / 0.12e2 + t3658 / 0.6e1 + t3662 / 0.12e2 - 0.5e1 / 0.18e2 * t3363 - t3369 / 0.4e1 + t3371 / 0.3e1 - 0.5e1 / 0.18e2 * t3373 - t3375 / 0.4e1 + t3377 / 0.3e1 + t3106 / 0.12e2;
  t3676 = t1243 * t587;
  t3678 = t3588 * t224;
  t3679 = t3678 * t229;
  t3681 = t1233 * t594;
  t3682 = t3681 * t229;
  t3686 = t3599 * t224;
  t3689 = t1225 * t594;
  t3692 = t1240 * t587;
  t3694 = t3580 * t224;
  t3695 = t3694 * t229;
  t3697 = t1229 * t594;
  t3698 = t3697 * t229;
  t3700 = -0.5e1 / 0.18e2 * t3108 + t3113 - t3351 / 0.27e2 + 0.4e1 / 0.81e2 * t3355 - 0.1e2 / 0.243e3 * t3359 - 0.7e1 / 0.243e3 * t3676 + 0.2e1 / 0.81e2 * t3679 + 0.2e1 / 0.81e2 * t3682 + 0.7e1 / 0.54e2 * t1237 * t587 - t3686 * t229 / 0.9e1 - t3689 * t229 / 0.9e1 + 0.7e1 / 0.81e2 * t3692 - 0.2e1 / 0.27e2 * t3695 - 0.2e1 / 0.27e2 * t3698;
  t3703 = my_piecewise3(t65, 0, t3587 + t3621 + t3671 + t3700);
  tv4rho42 = 0.2e1 * t1192 + 0.2e1 * t1247 + 0.2e1 * t1284 + 0.2e1 * t1380 + t6 * (t3547 + t3703);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t3724 = my_piecewise5(t10, 0, t14, 0, t3277 + t3278);
  t3728 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2918 * t1385 * t109 - 0.8e1 / 0.9e1 * t1250 * t427 - 0.8e1 / 0.9e1 * t1132 * t498 * t109 + 0.4e1 / 0.3e1 * t1135 * t498 + 0.4e1 / 0.3e1 * t423 * t1259 + 0.4e1 / 0.9e1 * t346 * t1392 * t109 + 0.4e1 / 0.3e1 * t23 * t3724);
  t3732 = t1397 * t119;
  t3736 = t1396 * t27;
  t3737 = t3736 * t146;
  t3740 = t3736 * t152;
  t3753 = -0.3e1 / 0.8e1 * t5 * t3728 * t61 - t3732 / 0.8e1 - 0.3e1 / 0.8e1 * t1397 * t140 - t3737 * t149 / 0.6e1 - t3740 * t157 / 0.18e2 - 0.3e1 / 0.8e1 * t3472 + t3474 / 0.4e1 - 0.3e1 / 0.8e1 * t3509 - t3456 / 0.6e1 - t3539 / 0.18e2 + t3252 - 0.5e1 / 0.12e2 * t3253 + t3260 + t3198 + t3343 - 0.5e1 / 0.36e2 * t2953 + t2960 - 0.5e1 / 0.36e2 * t2914 - 0.5e1 / 0.81e2 * t2747 - 0.5e1 / 0.243e3 * t3069;
  t3754 = my_piecewise3(t1, 0, t3753);
  t3755 = t1287 * t534;
  t3760 = t473 * t1565;
  t3763 = t1287 * t538;
  t3770 = t477 * t1565;
  t3771 = t3770 * t531;
  t3773 = t1294 * t538;
  t3774 = t3773 * t541;
  t3776 = t477 * t1572;
  t3777 = t3776 * t541;
  t3779 = t1360 * t1560;
  t3781 = t1372 * t1560;
  t3783 = t1375 * t1557;
  t3785 = t473 * t1572;
  t3788 = -0.4e1 / 0.243e3 * t3755 * t531 + 0.28e2 / 0.729e3 * t1366 * t1560 - 0.4e1 / 0.243e3 * t3760 * t531 - 0.8e1 / 0.81e2 * t3763 * t541 + 0.56e2 / 0.243e3 * t1369 * t1557 + 0.56e2 / 0.729e3 * t1363 * t1560 - 0.4e1 / 0.729e3 * t3771 - 0.8e1 / 0.243e3 * t3774 - 0.8e1 / 0.243e3 * t3777 + 0.56e2 / 0.2187e4 * t3779 + 0.28e2 / 0.2187e4 * t3781 + 0.56e2 / 0.729e3 * t3783 - 0.8e1 / 0.81e2 * t3785 * t541;
  t3789 = t1287 * t521;
  t3792 = t473 * t1579;
  t3801 = t1294 * t534;
  t3802 = t3801 * t531;
  t3804 = t1294 * t521;
  t3805 = t3804 * t531;
  t3807 = t477 * t1579;
  t3808 = t3807 * t531;
  t3810 = t1295 * t598;
  t3812 = t1298 * t598;
  t3814 = -0.8e1 / 0.243e3 * t3789 * t531 - 0.8e1 / 0.243e3 * t3792 * t531 + 0.16e2 / 0.2187e4 * t3549 + 0.8e1 / 0.2187e4 * t3552 + 0.16e2 / 0.729e3 * t3555 - 0.4e1 / 0.729e3 * t3567 - 0.8e1 / 0.243e3 * t3570 - 0.8e1 / 0.729e3 * t3573 - 0.4e1 / 0.729e3 * t3802 - 0.8e1 / 0.729e3 * t3805 - 0.8e1 / 0.729e3 * t3808 + 0.7e1 / 0.18e2 * t3810 + 0.7e1 / 0.18e2 * t3812;
  t3816 = t553 * t117;
  t3817 = t3816 * t218;
  t3818 = t3817 * t221;
  t3820 = t1294 * t513;
  t3821 = t3820 * t221;
  t3823 = t477 * t1416;
  t3824 = t3823 * t221;
  t3826 = t478 * t1407;
  t3834 = t1327 * t27;
  t3835 = t3834 * t218;
  t3838 = t1287 * t513;
  t3840 = t473 * t1416;
  t3846 = -t3818 / 0.6e1 - t3821 / 0.3e1 - t3824 / 0.6e1 - 0.35e2 / 0.81e2 * t3826 + 0.7e1 / 0.6e1 * t1288 * t598 + 0.7e1 / 0.6e1 * t1291 * t598 - 0.35e2 / 0.27e2 * t474 * t1407 - t3835 * t221 / 0.2e1 - t3838 * t221 - t3840 * t221 / 0.2e1 + 0.2e1 / 0.9e1 * t3576 - 0.7e1 / 0.27e2 * t3578 - t3582 / 0.3e1;
  t3851 = t1294 * t580;
  t3852 = t3851 * t584;
  t3854 = t1304 * t1433;
  t3856 = t473 * t1457;
  t3862 = t477 * t1472;
  t3863 = t3862 * t1475;
  t3865 = t1360 * t1463;
  t3867 = t1375 * t1452;
  t3869 = t1372 * t1463;
  t3871 = -t3585 / 0.3e1 + 0.2e1 / 0.9e1 * t3590 + 0.7e1 / 0.18e2 * t3592 - 0.5e1 / 0.27e2 * t3411 + t3421 - 0.8e1 / 0.81e2 * t3852 + 0.56e2 / 0.243e3 * t3854 - 0.64e2 / 0.6561e4 * t3856 * t1463 - 0.64e2 / 0.6561e4 * t1363 * t1463 + 0.16e2 / 0.243e3 * t3607 - 0.64e2 / 0.2187e4 * t3863 - 0.64e2 / 0.19683e5 * t3865 - 0.32e2 / 0.6561e4 * t3867 - 0.64e2 / 0.59049e5 * t3869;
  t3874 = t477 * t1440;
  t3875 = t3874 * t584;
  t3877 = t477 * t1445;
  t3878 = t3877 * t1452;
  t3880 = t477 * t1457;
  t3881 = t3880 * t1463;
  t3887 = t473 * t1472;
  t3892 = t1287 * t580;
  t3895 = t473 * t1440;
  t3898 = t473 * t1445;
  t3918 = my_piecewise5(t14, 0, t10, 0, -t3277 + t3398);
  t3922 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t1479 * t164 - 0.8e1 / 0.9e1 * t1314 * t456 - 0.8e1 / 0.9e1 * t1193 * t549 * t164 + 0.4e1 / 0.3e1 * t1196 * t549 + 0.4e1 / 0.3e1 * t452 * t1323 + 0.4e1 / 0.9e1 * t398 * t1486 * t164 + 0.4e1 / 0.3e1 * t71 * t3918);
  t3928 = -0.8e1 / 0.81e2 * t3875 - 0.64e2 / 0.6561e4 * t3878 - 0.64e2 / 0.19683e5 * t3881 - 0.32e2 / 0.2187e4 * t1369 * t1452 - 0.64e2 / 0.19683e5 * t1366 * t1463 - 0.64e2 / 0.729e3 * t3887 * t1475 + 0.56e2 / 0.81e2 * t1307 * t1433 - 0.8e1 / 0.27e2 * t3892 * t584 - 0.8e1 / 0.27e2 * t3895 * t584 - 0.64e2 / 0.2187e4 * t3898 * t1452 - 0.8e1 / 0.81e2 * t3613 - 0.3e1 / 0.8e1 * t5 * t3922 * t101 - 0.9e1 / 0.8e1 * t1328 * t212;
  t3933 = t554 * t470;
  t3935 = t194 * t1311;
  t3939 = t74 * t117 * t1512 * t100;
  t3941 = t1491 * t172;
  t3950 = -0.9e1 / 0.8e1 * t461 * t573 - 0.3e1 / 0.8e1 * t168 * t1514 - 0.3e1 / 0.8e1 * t3933 - 0.3e1 / 0.8e1 * t3935 - t3939 / 0.8e1 - t3941 / 0.8e1 - 0.3e1 / 0.8e1 * t3615 - 0.3e1 / 0.4e1 * t3617 - 0.3e1 / 0.8e1 * t3619 + t3656 / 0.4e1 + t3658 / 0.2e1 + t3662 / 0.4e1 - 0.5e1 / 0.12e2 * t3363;
  t3961 = t3372 - 0.5e1 / 0.12e2 * t3373 + t3378 - 0.5e1 / 0.36e2 * t3108 + t3113 + t3356 - 0.5e1 / 0.81e2 * t3359 - 0.7e1 / 0.81e2 * t3676 + 0.2e1 / 0.27e2 * t3679 + 0.2e1 / 0.27e2 * t3682 + 0.7e1 / 0.54e2 * t3692 - t3695 / 0.9e1 - t3698 / 0.9e1;
  t3962 = t484 * t1524;
  t3964 = t477 * t1542;
  t3965 = t3964 * t1547;
  t3967 = t1345 * t587;
  t3969 = t1348 * t587;
  t3971 = t3816 * t224;
  t3972 = t3971 * t229;
  t3974 = t1294 * t594;
  t3975 = t3974 * t229;
  t3977 = t477 * t1536;
  t3978 = t3977 * t229;
  t3986 = t3834 * t224;
  t3989 = t1287 * t594;
  t3992 = t473 * t1536;
  t3995 = t473 * t1542;
  t3998 = -0.35e2 / 0.243e3 * t3962 - 0.64e2 / 0.729e3 * t3965 + 0.7e1 / 0.54e2 * t3967 + 0.7e1 / 0.54e2 * t3969 - t3972 / 0.18e2 - t3975 / 0.9e1 - t3978 / 0.18e2 - 0.35e2 / 0.81e2 * t481 * t1524 + 0.7e1 / 0.18e2 * t1353 * t587 + 0.7e1 / 0.18e2 * t1356 * t587 - t3986 * t229 / 0.6e1 - t3989 * t229 / 0.3e1 - t3992 * t229 / 0.6e1 - 0.64e2 / 0.243e3 * t3995 * t1547;
  t4002 = my_piecewise3(t65, 0, t3788 + t3814 + t3846 + t3871 + t3928 + t3950 + t3961 + t3998);
  tv4rho43 = 0.3e1 * t1284 + 0.3e1 * t1380 + t1403 + t1591 + t6 * (t3754 + t4002);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t4007 = t493 * t493;
  t4012 = t498 * t498;
  t4019 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t957 + 0.24e2 * t2932);
  t4023 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2918 * t4007 - 0.16e2 / 0.9e1 * t1250 * t498 + 0.4e1 / 0.3e1 * t346 * t4012 + 0.16e2 / 0.9e1 * t423 * t1392 + 0.4e1 / 0.3e1 * t23 * t4019);
  t4031 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t4023 * t61 - t3732 / 0.2e1 + t3474 / 0.2e1 - 0.5e1 / 0.9e1 * t3253 + t2960);
  t4034 = t509 * t1572;
  t4037 = t509 * t1579;
  t4040 = t509 * t1565;
  t4044 = t215 * t1416 * t227;
  t4048 = t215 * t1536 * t520;
  t4052 = t215 * t1536 * t227;
  t4060 = 0.1e1 / t78 / t2001;
  t4061 = t75 * t4060;
  t4065 = t1410 * t538;
  t4068 = t1410 * t521;
  t4071 = t1410 * t534;
  t4074 = t4061 * t530;
  t4081 = 0.112e3 / 0.729e3 * t1566 * t1560 - 0.32e2 / 0.81e2 * t4034 * t541 - 0.32e2 / 0.243e3 * t4037 * t531 - 0.16e2 / 0.243e3 * t4040 * t531 - 0.16e2 / 0.81e2 * t4044 * t541 - 0.16e2 / 0.243e3 * t4048 * t531 - 0.8e1 / 0.243e3 * t4052 * t531 + 0.224e3 / 0.243e3 * t1569 * t1557 + 0.224e3 / 0.729e3 * t1576 * t1560 - 0.3416e4 / 0.2187e4 * t539 * t4061 * t540 - 0.16e2 / 0.81e2 * t4065 * t541 - 0.16e2 / 0.243e3 * t4068 * t531 - 0.8e1 / 0.243e3 * t4071 * t531 - 0.1708e4 / 0.6561e4 * t535 * t4074 - 0.3416e4 / 0.6561e4 * t522 * t4074 + 0.112e3 / 0.729e3 * t1583 * t1560;
  t4104 = 0.224e3 / 0.243e3 * t1573 * t1557 + 0.224e3 / 0.729e3 * t1580 * t1560 - 0.16e2 / 0.729e3 * t3771 - 0.32e2 / 0.243e3 * t3774 - 0.32e2 / 0.243e3 * t3777 + 0.224e3 / 0.2187e4 * t3779 + 0.112e3 / 0.2187e4 * t3781 + 0.224e3 / 0.729e3 * t3783 + 0.32e2 / 0.2187e4 * t3549 + 0.16e2 / 0.2187e4 * t3552 + 0.32e2 / 0.729e3 * t3555 - 0.16e2 / 0.729e3 * t3802 - 0.32e2 / 0.729e3 * t3805 - 0.32e2 / 0.729e3 * t3808 + 0.7e1 / 0.3e1 * t1411 * t598 + 0.14e2 / 0.3e1 * t1414 * t598 + 0.7e1 / 0.3e1 * t1417 * t598;
  t4107 = 0.1e1 / t77 / t1428;
  t4108 = t84 * t4107;
  t4119 = t215 * t1512 * t217;
  t4126 = t1490 * t27;
  t4127 = t4126 * t218;
  t4130 = t1410 * t513;
  t4133 = t509 * t1416;
  t4140 = 0.455e3 / 0.81e2 * t219 * t220 * t4108 + 0.14e2 / 0.9e1 * t3810 + 0.14e2 / 0.9e1 * t3812 - 0.2e1 / 0.3e1 * t3818 - 0.4e1 / 0.3e1 * t3821 - 0.2e1 / 0.3e1 * t3824 - 0.14e3 / 0.81e2 * t3826 - 0.2e1 / 0.3e1 * t4119 * t221 - 0.14e3 / 0.27e2 * t510 * t1407 - 0.14e3 / 0.27e2 * t514 * t1407 - 0.2e1 / 0.3e1 * t4127 * t221 - 0.2e1 * t4130 * t221 - 0.2e1 * t4133 * t221 + 0.4e1 / 0.9e1 * t3576 - 0.14e2 / 0.27e2 * t3578 + 0.4e1 / 0.9e1 * t3590 - 0.2e2 / 0.81e2 * t3411;
  t4145 = t509 * t1472;
  t4148 = t509 * t1445;
  t4154 = t215 * t1439 * t227;
  t4158 = t215 * t513 * t520;
  t4161 = t509 * t1457;
  t4167 = t215 * t594 * t1456;
  t4170 = t523 * t523;
  t4171 = 0.1e1 / t4170;
  t4172 = t796 * t4171;
  t4173 = t4172 * t1462;
  t4176 = t1410 * t580;
  t4179 = t509 * t1440;
  t4182 = t571 * t578;
  t4184 = t215 * t4182 * t99;
  t4188 = t215 * t1542 * t227;
  t4191 = 0.1e1 / t77 / t4170 / rho[1];
  t4192 = t2525 * t4191;
  t4193 = M_PI * t43;
  t4194 = t4193 * t206;
  t4201 = t4172 * t1451;
  t4204 = 0.224e3 / 0.81e2 * t1436 * t1433 + 0.224e3 / 0.81e2 * t1441 * t1433 - 0.256e3 / 0.729e3 * t4145 * t1475 - 0.256e3 / 0.2187e4 * t4148 * t1452 - 0.128e3 / 0.2187e4 * t1569 * t1452 - 0.256e3 / 0.729e3 * t4154 * t1475 - 0.256e3 / 0.2187e4 * t4158 * t1452 - 0.256e3 / 0.6561e4 * t4161 * t1463 - 0.256e3 / 0.6561e4 * t1576 * t1463 - 0.256e3 / 0.6561e4 * t4167 * t1463 + 0.896e3 / 0.19683e5 * t535 * t4173 - 0.16e2 / 0.27e2 * t4176 * t584 - 0.32e2 / 0.27e2 * t4179 * t584 - 0.16e2 / 0.27e2 * t4184 * t584 - 0.1024e4 / 0.6561e4 * t4188 * t4192 * t4194 + 0.896e3 / 0.729e3 * t1473 * t4172 * t1474 + 0.896e3 / 0.2187e4 * t1446 * t4201;
  t4215 = t527 * t527;
  t4216 = 0.1e1 / t4215;
  t4218 = t4216 * M_PI * t43;
  t4219 = t4192 * t4218;
  t4223 = t1460 * M_PI * t43;
  t4224 = t4192 * t4223;
  t4228 = 0.1e1 / t1455 / t92;
  t4230 = t215 * t224 * t4228;
  t4238 = t528 * M_PI * t43;
  t4239 = t4192 * t4238;
  t4245 = t215 * t579 * t520;
  t4249 = t215 * t218 * t1456;
  t4256 = 0.448e3 / 0.2187e4 * t539 * t4201 + 0.896e3 / 0.6561e4 * t1458 * t4173 + 0.896e3 / 0.6561e4 * t522 * t4173 - 0.32e2 / 0.81e2 * t3852 + 0.224e3 / 0.243e3 * t3854 - 0.256e3 / 0.177147e6 * t535 * t4219 - 0.1024e4 / 0.59049e5 * t1446 * t4224 - 0.1024e4 / 0.177147e6 * t4230 * t4219 - 0.512e3 / 0.59049e5 * t1458 * t4219 - 0.2816e4 / 0.531441e6 * t522 * t4219 - 0.512e3 / 0.19683e5 * t1473 * t4239 - 0.1024e4 / 0.177147e6 * t539 * t4224 - 0.1024e4 / 0.19683e5 * t4245 * t4239 - 0.1024e4 / 0.59049e5 * t4249 * t4224 - 0.256e3 / 0.19683e5 * t1583 * t1463 - 0.128e3 / 0.2187e4 * t1573 * t1452;
  t4269 = t544 * t544;
  t4274 = t549 * t549;
  t4281 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t957 + 0.24e2 * t3093);
  t4285 = my_piecewise3(t70, 0, 0.4e2 / 0.81e2 * t3081 * t4269 - 0.16e2 / 0.9e1 * t1314 * t549 + 0.4e1 / 0.3e1 * t398 * t4274 + 0.16e2 / 0.9e1 * t452 * t1486 + 0.4e1 / 0.3e1 * t71 * t4281);
  t4297 = t4108 * t206;
  t4310 = t4216 * t41 * t43;
  t4320 = -0.256e3 / 0.6561e4 * t1580 * t1463 - 0.256e3 / 0.19683e5 * t1566 * t1463 + 0.32e2 / 0.243e3 * t3607 - 0.256e3 / 0.2187e4 * t3863 - 0.256e3 / 0.19683e5 * t3865 - 0.128e3 / 0.6561e4 * t3867 - 0.256e3 / 0.59049e5 * t3869 - 0.32e2 / 0.81e2 * t3875 - 0.256e3 / 0.6561e4 * t3878 - 0.256e3 / 0.19683e5 * t3881 - 0.3e1 / 0.8e1 * t5 * t4285 * t101 - 0.3e1 / 0.2e1 * t1491 * t212 - 0.9e1 / 0.4e1 * t554 * t573 - 0.3e1 / 0.2e1 * t194 * t1514 - 0.3e1 / 0.8e1 * t74 * t27 * (0.41888e5 / 0.6561e4 * t29 * t4061 + 0.364e4 / 0.2187e4 * t130 * t4297 - 0.13664e5 / 0.19683e5 * t335 * sigma[2] * t4060 * t528 + 0.7168e4 / 0.59049e5 * t1508 * t4171 * t1460 - 0.2048e4 / 0.1594323e7 * t2975 * t2525 * t4191 * t4310) * t100 - 0.3e1 / 0.2e1 * t3933 - 0.3e1 / 0.2e1 * t3935;
  t4341 = -t3939 / 0.2e1 - t3941 / 0.2e1 + t3656 / 0.2e1 + t3658 + t3662 / 0.2e1 - 0.5e1 / 0.9e1 * t3363 - 0.5e1 / 0.9e1 * t3373 + t3113 - 0.3416e4 / 0.729e3 * t581 * t75 * t4060 * t41 * t3 - 0.2e2 / 0.243e3 * t3359 - 0.14e2 / 0.81e2 * t3676 + 0.4e1 / 0.27e2 * t3679 + 0.4e1 / 0.27e2 * t3682 - 0.14e3 / 0.243e3 * t3962 - 0.256e3 / 0.729e3 * t3965 + 0.14e2 / 0.27e2 * t3967 + 0.14e2 / 0.27e2 * t3969;
  t4363 = t4126 * t224;
  t4366 = t1410 * t594;
  t4369 = t509 * t1536;
  t4373 = t215 * t1512 * t98;
  t4376 = t509 * t1542;
  t4380 = t215 * t210 * t1541;
  t4386 = t215 * t94 / t1540 / t97;
  t4393 = -0.2e1 / 0.9e1 * t3972 - 0.4e1 / 0.9e1 * t3975 - 0.2e1 / 0.9e1 * t3978 + 0.455e3 / 0.243e3 * t225 * t228 * t4297 + 0.896e3 / 0.243e3 * t1543 * t1544 * t4171 * t2 * t28 - 0.14e3 / 0.81e2 * t591 * t1524 - 0.14e3 / 0.81e2 * t595 * t1524 + 0.7e1 / 0.9e1 * t1530 * t587 + 0.14e2 / 0.9e1 * t1533 * t587 + 0.7e1 / 0.9e1 * t1537 * t587 - 0.2e1 / 0.9e1 * t4363 * t229 - 0.2e1 / 0.3e1 * t4366 * t229 - 0.2e1 / 0.3e1 * t4369 * t229 - 0.2e1 / 0.9e1 * t4373 * t229 - 0.256e3 / 0.243e3 * t4376 * t1547 - 0.256e3 / 0.243e3 * t4380 * t1547 - 0.1024e4 / 0.2187e4 * t4386 * t99 * t2525 * t4191 * M_PI * t43;
  t4397 = my_piecewise3(t65, 0, t4081 + t4104 + t4140 + t4204 + t4256 + t4320 + t4341 + t4393);
  tv4rho44 = 0.4e1 * t1403 + 0.4e1 * t1591 + t6 * (t4031 + t4397);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4403 = t286 * t1769;
  t4406 = t286 * t1773;
  t4409 = t286 * t1777;
  t4412 = t296 * t1769;
  t4413 = t4412 * t307;
  t4415 = t296 * t1773;
  t4416 = t4415 * t318;
  t4418 = t296 * t1777;
  t4419 = t4418 * t318;
  t4422 = t143 * t1623 * t155;
  t4426 = t143 * t1765 * t311;
  t4430 = t143 * t1765 * t155;
  t4439 = t143 * t1710 * t145;
  t4448 = t2720 * t249;
  t4452 = t909 * t626;
  t4456 = 0.5e1 / 0.216e3 * t2746 * t249;
  t4457 = t879 * t626;
  t4458 = t4457 * t149;
  t4460 = 0.56e2 / 0.729e3 * t1774 * t1031 + 0.28e2 / 0.729e3 * t1778 * t1031 - t4439 * t149 / 0.2e1 + t2742 * t249 / 0.16e2 + 0.3e1 / 0.16e2 * t2723 * t249 + 0.3e1 / 0.16e2 * t2726 * t249 + t4448 / 0.16e2 + t2730 * t249 / 0.16e2 - t4452 * t149 / 0.2e1 + t4456 + t4458 / 0.9e1;
  t4462 = t1620 * t392;
  t4466 = t2734 * t249;
  t4470 = t239 * t894;
  t4474 = t880 * t650;
  t4476 = t297 * t1609;
  t4478 = t906 * t650;
  t4480 = t883 * t650;
  t4486 = 0.7e1 / 0.18e2 * t4462 - 0.35e2 / 0.27e2 * t627 * t896 - t4466 / 0.24e2 + 0.7e1 / 0.12e2 * t281 * t1609 - 0.35e2 / 0.54e2 * t147 * t148 * t4470 + t4474 / 0.18e2 + 0.7e1 / 0.36e2 * t4476 - t4478 / 0.6e1 - t4480 / 0.6e1 - t899 * t650 / 0.2e1 - t902 * t650 / 0.4e1;
  t4493 = t2738 * t249;
  t4495 = t2715 * t249;
  t4499 = t2749 * t249;
  t4501 = t905 * t626;
  t4502 = t4501 * t149;
  t4504 = t286 * t1623;
  t4510 = 0.7e1 / 0.12e2 * t287 * t1609 + 0.7e1 / 0.6e1 * t1601 * t392 + 0.7e1 / 0.6e1 * t1624 * t392 + t4493 / 0.16e2 + t4495 / 0.8e1 - t910 * t650 / 0.4e1 - t4499 / 0.24e2 - t4502 / 0.3e1 - t4504 * t149 - 0.3e1 / 0.8e1 * t966 * t246 - 0.9e1 / 0.8e1 * t360 * t623;
  t4513 = t360 * t608;
  t4515 = t113 * t1695;
  t4519 = t26 * t291 * t621 * t60;
  t4523 = t26 * t117 * t1710 * t60;
  t4527 = t30 * t915;
  t4530 = t4470 * t134;
  t4540 = 0.1e1 / t33 / t2759;
  t4552 = t113 * t1691;
  t4557 = 0.5e1 / 0.36e2 * t26 * t943 * t244 * t60;
  t4558 = t296 * t1623;
  t4559 = t4558 * t149;
  t4563 = M_PI * sigma[0] * t43;
  t4564 = t4540 * t2896 * t4563;
  t4570 = t4527 * t317;
  t4573 = t928 * t1637;
  t4588 = t1042 * t1644;
  t4590 = t2804 * t1638;
  t4592 = 0.352e3 / 0.177147e6 * t313 * t4564 + 0.119e3 / 0.2187e4 * t322 * t4570 - 0.88e2 / 0.6561e4 * t322 * t4573 - 0.5e1 / 0.162e3 * t1053 * t1644 + 0.8e1 / 0.729e3 * t2770 * t1638 + 0.8e1 / 0.729e3 * t1046 * t1638 + 0.8e1 / 0.2187e4 * t1053 * t1638 + 0.128e3 / 0.59049e5 * t2894 * t4564 + 0.64e2 / 0.19683e5 * t867 * t4564 - 0.5e1 / 0.486e3 * t4588 + 0.8e1 / 0.2187e4 * t4590;
  t4594 = t1037 * t1638;
  t4596 = t1042 * t1638;
  t4604 = t2613 * t659;
  t4606 = t2624 * t659;
  t4608 = t4540 * M_PI;
  t4611 = t4608 * t869 * sigma[0] * t43;
  t4614 = t2681 * t659;
  t4616 = t2691 * t659;
  t4620 = 0.8e1 / 0.2187e4 * t4594 + 0.8e1 / 0.6561e4 * t4596 + 0.8e1 / 0.729e3 * t2882 * t1638 + 0.8e1 / 0.729e3 * t1028 * t1638 + 0.8e1 / 0.2187e4 * t1049 * t1638 - 0.2e1 / 0.729e3 * t4604 - t4606 / 0.729e3 + 0.128e3 / 0.59049e5 * t301 * t4611 + 0.2e1 / 0.243e3 * t4614 + t4616 / 0.243e3 - 0.5e1 / 0.162e3 * t1049 * t1644;
  t4625 = t4608 * sigma[0] * t315 * t43;
  t4638 = t2801 * t1673;
  t4640 = t1025 * t1673;
  t4645 = t850 * t315 * t1637;
  t4648 = 0.4e1 / 0.243e3 * t1057 * t1673 + 0.128e3 / 0.6561e4 * t2853 * t4625 + 0.64e2 / 0.6561e4 * t848 * t4625 + 0.128e3 / 0.19683e5 * t2862 * t4611 + 0.128e3 / 0.19683e5 * t857 * t4611 + 0.8e1 / 0.243e3 * t2876 * t1673 + 0.4e1 / 0.243e3 * t1022 * t1673 + 0.8e1 / 0.729e3 * t4638 + 0.4e1 / 0.729e3 * t4640 + 0.8e1 / 0.243e3 * t2766 * t1673 - 0.88e2 / 0.729e3 * t857 * t4645;
  t4657 = t143 * t1654 * t155;
  t4661 = t143 * t626 * t311;
  t4667 = t143 * t630 * t865;
  t4680 = t286 * t1655;
  t4689 = t2649 * t647;
  t4691 = t296 * t1655;
  t4692 = t4691 * t376;
  t4694 = t621 * t370;
  t4696 = t143 * t4694 * t59;
  t4701 = t2643 * t647;
  t4707 = -0.8e1 / 0.27e2 * t4680 * t376 - 0.5e1 / 0.81e2 * t1028 * t1644 - 0.5e1 / 0.81e2 * t1046 * t1644 + 0.8e1 / 0.81e2 * t2873 * t1668 - 0.2e1 / 0.243e3 * t4689 - 0.8e1 / 0.81e2 * t4692 - 0.8e1 / 0.27e2 * t4696 * t376 + 0.56e2 / 0.81e2 * t1656 * t1062 + 0.2e1 / 0.81e2 * t4701 - 0.5e1 / 0.27e2 * t1022 * t1651 + t2646 * t647 / 0.27e2;
  t4731 = t2684 * t659;
  t4733 = t2694 * t659;
  t4735 = t2660 * t659 / 0.81e2 + t2667 * t659 / 0.162e3 + 0.2e1 / 0.27e2 * t2636 * t647 + 0.2e1 / 0.81e2 * t2652 * t659 + t2670 * t659 / 0.81e2 - 0.5e1 / 0.27e2 * t1057 * t1651 + 0.8e1 / 0.81e2 * t2790 * t1668 + 0.128e3 / 0.2187e4 * t2842 * t4608 * sigma[0] * t43 * t134 + 0.238e3 / 0.729e3 * t301 * t4527 * t306 + 0.2e1 / 0.243e3 * t4731 + t4733 / 0.243e3;
  t4742 = t1025 * t1651;
  t4744 = t2879 * t1668;
  t4746 = t2610 * t647;
  t4748 = t1037 * t1644;
  t4757 = t385 * t1741;
  t4759 = t2640 * t647 / 0.27e2 + t2664 * t659 / 0.81e2 + t2674 * t659 / 0.162e3 - 0.5e1 / 0.81e2 * t4742 + 0.8e1 / 0.243e3 * t4744 + 0.2e1 / 0.81e2 * t4746 - 0.5e1 / 0.243e3 * t4748 + 0.238e3 / 0.2187e4 * t313 * t4570 - 0.35e2 / 0.162e3 * t153 * t156 * t4530 + 0.7e1 / 0.36e2 * t389 * t1741 + 0.7e1 / 0.108e3 * t4757;
  t4763 = 0.5e1 / 0.648e3 * t3068 * t252;
  t4764 = t991 * t662;
  t4766 = t3065 * t252;
  t4768 = t988 * t662;
  t4776 = t1762 * t379;
  t4780 = t3056 * t252;
  t4787 = t879 * t630;
  t4788 = t4787 * t157;
  t4797 = t879 * t371 * t644;
  t4799 = t3062 * t252;
  t4801 = t1004 * t662;
  t4804 = t143 * t244 * t1008;
  t4812 = -t998 * t662 / 0.12e2 - t1001 * t662 / 0.6e1 + t4788 / 0.27e2 - 0.88e2 / 0.81e2 * t1010 * t59 * t850 * t1637 - t995 * t662 / 0.12e2 - 0.2e1 / 0.81e2 * t4797 - t4799 / 0.72e2 - t4801 / 0.18e2 - 0.64e2 / 0.243e3 * t4804 * t1014 - 0.5e1 / 0.9e1 * t1719 * t1727 + t909 * t371 * t644 / 0.9e1;
  t4814 = t909 * t630;
  t4819 = t905 * t630;
  t4820 = t4819 * t157;
  t4822 = t296 * t1765;
  t4823 = t4822 * t157;
  t4825 = t286 * t1765;
  t4829 = t143 * t1710 * t58;
  t4833 = t296 * t1065 * t644;
  t4835 = t3034 * t1755;
  t4845 = -t4814 * t157 / 0.6e1 + t3053 * t252 / 0.16e2 - t4820 / 0.9e1 - t4823 / 0.9e1 - t4825 * t157 / 0.3e1 - t4829 * t157 / 0.6e1 + 0.2e1 / 0.27e2 * t4833 + 0.8e1 / 0.81e2 * t4835 - 0.5e1 / 0.9e1 * t1751 * t1727 + 0.2e1 / 0.9e1 * t286 * t1065 * t644 + t143 * t2821 * t644 / 0.9e1;
  t4859 = t3059 * t252;
  t4861 = t3071 * t252;
  t4867 = t1748 * t1727;
  t4870 = t905 * t371 * t644;
  t4872 = 0.8e1 / 0.27e2 * t3028 * t1755 + 0.8e1 / 0.27e2 * t3031 * t1755 + 0.128e3 / 0.729e3 * t3012 * t59 * t4540 * t4563 + 0.238e3 / 0.243e3 * t640 * t641 * t1061 + t3050 * t252 / 0.48e2 + t4859 / 0.24e2 + t4861 / 0.48e2 + t3019 * t252 / 0.16e2 + t3024 * t252 / 0.48e2 - 0.5e1 / 0.27e2 * t4867 + 0.2e1 / 0.27e2 * t4870;
  t4877 = my_piecewise3(t1, 0, -0.4e1 / 0.729e3 * t4419 - 0.8e1 / 0.729e3 * t4416 - 0.64e2 / 0.2187e4 * t4661 * t859 - 0.32e2 / 0.2187e4 * t1770 * t859 - 0.64e2 / 0.6561e4 * t4667 * t872 - 0.64e2 / 0.6561e4 * t1774 * t872 - 0.64e2 / 0.19683e5 * t1778 * t872 - 0.44e2 / 0.729e3 * t301 * t4645 + 0.7e1 / 0.36e2 * t382 * t1741 - 0.35e2 / 0.81e2 * t631 * t985 + 0.7e1 / 0.18e2 * t1722 * t379 + 0.7e1 / 0.18e2 * t1766 * t379 - 0.8e1 / 0.81e2 * t4422 * t307 - 0.8e1 / 0.243e3 * t4426 * t318 - 0.4e1 / 0.243e3 * t4430 * t318 + 0.56e2 / 0.243e3 * t1770 * t1034 - 0.8e1 / 0.81e2 * t4403 * t307 - 0.8e1 / 0.243e3 * t4406 * t318 - 0.4e1 / 0.243e3 * t4409 * t318 - 0.9e1 / 0.8e1 * t113 * t1712 + 0.32e2 / 0.59049e5 * t322 * t4564 - 0.88e2 / 0.2187e4 * t867 * t4573 - 0.88e2 / 0.2187e4 * t313 * t4573 - 0.64e2 / 0.729e3 * t4657 * t853 - 0.8e1 / 0.243e3 * t4413 - 0.3e1 / 0.8e1 * t26 * t27 * (-0.2464e4 / 0.2187e4 * t29 * t4527 - 0.14e3 / 0.729e3 * t130 * t4530 + 0.952e3 / 0.6561e4 * t334 * t4527 * t315 - 0.704e3 / 0.19683e5 * t926 * t850 * t1707 + 0.256e3 / 0.531441e6 * t2975 * t4540 * t2896 * sigma[0] * t41 * t43) * t60 + t4872 + t4845 + t4812 + t4780 / 0.48e2 + 0.7e1 / 0.54e2 * t4776 - t4768 / 0.18e2 + t4763 + t4764 / 0.54e2 - t4766 / 0.72e2 + t4759 + t4735 + t4707 + t4460 + t4486 - 0.88e2 / 0.243e3 * t848 * t1012 * t1667 + t4510 - 0.3e1 / 0.8e1 * t4513 - 0.3e1 / 0.4e1 * t4515 + t4519 / 0.4e1 - 0.3e1 / 0.8e1 * t4523 + t4552 / 0.4e1 - t4557 - t4559 / 0.3e1 + t4592 + t4620 + t4648);
  tv4rho3sigma0 = t6 * t4877 + 0.3e1 * t1784;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t4882 = t410 * t673;
  t4884 = t168 * t1792;
  t4889 = 0.5e1 / 0.36e2 * t74 * t943 * t265 * t100;
  t4892 = t3416 * t270;
  t4894 = t3419 * t270;
  t4897 = 0.5e1 / 0.216e3 * t3410 * t270;
  t4900 = t3350 * t273;
  t4902 = t3354 * t273;
  t4905 = 0.5e1 / 0.648e3 * t3358 * t273;
  t4906 = -0.3e1 / 0.8e1 * t1090 * t267 - 0.3e1 / 0.8e1 * t4882 + t4884 / 0.4e1 - t4889 + t3366 * t270 / 0.16e2 + t4892 / 0.16e2 - t4894 / 0.24e2 + t4897 + t3413 * t273 / 0.48e2 + t4900 / 0.48e2 - t4902 / 0.72e2 + t4905;
  t4907 = my_piecewise3(t65, 0, t4906);
  tv4rho3sigma2 = t6 * t4907 + 0.3e1 * t1808;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t4909 = 0.2e1 * t1864;
  t4913 = t439 * t1769;
  t4916 = t439 * t1773;
  t4919 = t439 * t1777;
  t4930 = -0.8e1 / 0.729e3 * t4413 - 0.8e1 / 0.2187e4 * t4416 - 0.4e1 / 0.2187e4 * t4419 - 0.8e1 / 0.243e3 * t4913 * t307 - 0.8e1 / 0.729e3 * t4916 * t318 - 0.4e1 / 0.729e3 * t4919 * t318 + t4448 / 0.48e2 + t4456 + 0.2e1 / 0.27e2 * t4458 + 0.7e1 / 0.54e2 * t4462 - t4466 / 0.36e2 + t4474 / 0.27e2 + 0.7e1 / 0.108e3 * t4476 - t4478 / 0.18e2 - t4480 / 0.18e2;
  t4936 = t432 * t608 / 0.4e1;
  t4938 = t184 * t1695 / 0.4e1;
  t4945 = t184 * t1691;
  t4953 = t4493 / 0.48e2 + t4495 / 0.24e2 - t4499 / 0.36e2 - t4502 / 0.9e1 - t4936 - t4938 - 0.3e1 / 0.8e1 * t1148 * t246 - 0.3e1 / 0.4e1 * t432 * t623 - 0.3e1 / 0.8e1 * t184 * t1712 + t4945 / 0.12e2 - t4513 / 0.8e1 - t4515 / 0.4e1 + t4519 / 0.6e1 - t4523 / 0.8e1 - 0.5e1 / 0.27e2 * t1850 * t1727;
  t4973 = t1116 * t630;
  t4976 = t439 * t1765;
  t4981 = 0.2e1 / 0.81e2 * t1120 * t371 * t644;
  t4986 = 0.2e1 / 0.27e2 * t1116 * t371 * t644 + 0.2e1 / 0.27e2 * t439 * t1065 * t644 + 0.8e1 / 0.81e2 * t3331 * t1755 + t3319 * t252 / 0.48e2 - t1165 * t662 / 0.18e2 - t1171 * t662 / 0.18e2 + t3322 * t252 / 0.24e2 + t3328 * t252 / 0.48e2 - t4973 * t157 / 0.9e1 - t4976 * t157 / 0.9e1 + t4981 + t4552 / 0.6e1 - t4557 - t4559 / 0.9e1 + t3182 * t249 / 0.16e2;
  t4988 = t3186 * t249 / 0.24e2;
  t4990 = t3200 * t249 / 0.24e2;
  t4995 = t1120 * t626;
  t4997 = t4995 * t149 / 0.9e1;
  t4998 = t1116 * t626;
  t5001 = t439 * t1623;
  t5010 = t3196 * t249;
  t5013 = t1121 * t650 / 0.18e2;
  t5019 = t4988 + t4990 - t1117 * t650 / 0.6e1 - t1124 * t650 / 0.6e1 - t4997 - t4998 * t149 / 0.3e1 - t5001 * t149 / 0.3e1 + t3190 * t249 / 0.16e2 + t3193 * t249 / 0.8e1 + 0.7e1 / 0.18e2 * t1815 * t392 - t5010 / 0.72e2 - t5013 + 0.7e1 / 0.36e2 * t440 * t1609 - 0.5e1 / 0.1458e4 * t4588 + 0.8e1 / 0.6561e4 * t4590 + 0.8e1 / 0.6561e4 * t4594;
  t5037 = 0.8e1 / 0.19683e5 * t4596 - 0.4e1 / 0.2187e4 * t4604 - 0.2e1 / 0.2187e4 * t4606 + 0.2e1 / 0.729e3 * t4614 + t4616 / 0.729e3 + 0.8e1 / 0.2187e4 * t4638 + 0.4e1 / 0.2187e4 * t4640 - 0.4e1 / 0.729e3 * t4689 - 0.8e1 / 0.243e3 * t4692 + 0.2e1 / 0.243e3 * t4701 + 0.2e1 / 0.729e3 * t4731 + t4733 / 0.729e3 - 0.5e1 / 0.243e3 * t4742 + 0.8e1 / 0.729e3 * t4744 + 0.2e1 / 0.243e3 * t4746;
  t5039 = t439 * t1655;
  t5043 = 0.2e1 / 0.729e3 * t3150 * t659;
  t5045 = t3155 * t659 / 0.729e3;
  t5047 = 0.2e1 / 0.243e3 * t3125 * t647;
  t5068 = -0.5e1 / 0.729e3 * t4748 - 0.8e1 / 0.81e2 * t5039 * t376 + t5043 + t5045 + t5047 + 0.8e1 / 0.243e3 * t3215 * t1668 + 0.2e1 / 0.81e2 * t3122 * t647 + 0.8e1 / 0.2187e4 * t1182 * t1638 + t3137 * t659 / 0.243e3 + t3140 * t659 / 0.243e3 + 0.4e1 / 0.729e3 * t1179 * t1673 + 0.8e1 / 0.6561e4 * t1185 * t1638 + 0.2e1 / 0.81e2 * t3128 * t647 - 0.5e1 / 0.81e2 * t1179 * t1651 - 0.5e1 / 0.243e3 * t1182 * t1644;
  t5089 = -0.5e1 / 0.486e3 * t1185 * t1644 + 0.2e1 / 0.243e3 * t3131 * t659 + 0.2e1 / 0.243e3 * t3134 * t659 + 0.8e1 / 0.729e3 * t3218 * t1673 + 0.8e1 / 0.2187e4 * t3223 * t1638 + 0.7e1 / 0.324e3 * t4757 + t4763 + t4764 / 0.81e2 - t4766 / 0.108e3 - t4768 / 0.54e2 + 0.7e1 / 0.162e3 * t4776 + t4780 / 0.144e3 + 0.2e1 / 0.81e2 * t4788 - 0.4e1 / 0.243e3 * t4797 - t4799 / 0.108e3;
  t5099 = t3341 * t252;
  t5102 = t3338 * t252 / 0.72e2;
  t5104 = t3325 * t252 / 0.72e2;
  t5105 = t1120 * t630;
  t5107 = t5105 * t157 / 0.27e2;
  t5111 = t1168 * t662 / 0.54e2;
  t5114 = -t4801 / 0.54e2 - t4820 / 0.27e2 - t4823 / 0.27e2 + 0.2e1 / 0.81e2 * t4833 + 0.8e1 / 0.243e3 * t4835 + t4859 / 0.72e2 + t4861 / 0.144e3 - 0.5e1 / 0.81e2 * t4867 + 0.2e1 / 0.81e2 * t4870 - t5099 / 0.216e3 + t5102 + t5104 - t5107 + 0.7e1 / 0.54e2 * t1847 * t379 - t5111 + 0.7e1 / 0.108e3 * t443 * t1741;
  t5118 = my_piecewise3(t1, 0, t4930 + t4953 + t4986 + t5019 + t5037 + t5068 + t5089 + t5114);
  tv4rho3sigma3 = t6 * t5118 + t1784 + t4909;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t5120 = 0.2e1 * t1936;
  t5122 = t168 * t1903 / 0.4e1;
  t5124 = t461 * t673 / 0.4e1;
  t5131 = t74 * t291 * t708 * t100;
  t5133 = t194 * t1792;
  t5137 = t1225 * t717;
  t5141 = t3694 * t273 / 0.72e2;
  t5143 = t3697 * t273 / 0.72e2;
  t5144 = -t5122 - t5124 - 0.3e1 / 0.8e1 * t1208 * t267 - 0.3e1 / 0.8e1 * t410 * t710 + t5131 / 0.12e2 + t5133 / 0.12e2 + t4884 / 0.6e1 - t4889 - t4882 / 0.8e1 - t5137 * t229 / 0.18e2 + t5141 + t5143;
  t5145 = t1229 * t717;
  t5147 = t5145 * t229 / 0.27e2;
  t5150 = 0.2e1 / 0.81e2 * t1229 * t579 * t729;
  t5155 = t1240 * t745 / 0.54e2;
  t5156 = t3678 * t273;
  t5158 = t3681 * t273;
  t5160 = t1233 * t717;
  t5161 = t5160 * t229;
  t5164 = t1233 * t579 * t729;
  t5166 = t1243 * t745;
  t5175 = -t5147 + t5150 + t1225 * t579 * t729 / 0.27e2 - t5155 - t5156 / 0.216e3 - t5158 / 0.216e3 + t5161 / 0.81e2 - 0.2e1 / 0.243e3 * t5164 + t5166 / 0.162e3 + t3686 * t273 / 0.48e2 + t3689 * t273 / 0.48e2 - t1237 * t745 / 0.36e2 + t4892 / 0.48e2;
  t5179 = t1230 * t735 / 0.18e2;
  t5180 = t1229 * t713;
  t5182 = t5180 * t221 / 0.9e1;
  t5184 = t3581 * t270 / 0.24e2;
  t5185 = t1225 * t713;
  t5195 = t3584 * t270 / 0.24e2;
  t5196 = t1233 * t713;
  t5197 = t5196 * t221;
  t5199 = t3589 * t270;
  t5201 = t3575 * t270;
  t5203 = -t4894 / 0.36e2 + t4897 - t5179 - t5182 + t5184 - t5185 * t221 / 0.6e1 + t3600 * t270 / 0.16e2 + t3594 * t270 / 0.16e2 - t1226 * t735 / 0.12e2 + t5195 + t5197 / 0.27e2 - t5199 / 0.72e2 - t5201 / 0.72e2;
  t5204 = t1234 * t735;
  t5212 = t3548 * t742;
  t5214 = t3551 * t742;
  t5216 = t3554 * t732;
  t5219 = t3566 * t742 / 0.729e3;
  t5221 = 0.2e1 / 0.243e3 * t3569 * t732;
  t5223 = 0.2e1 / 0.729e3 * t3572 * t742;
  t5226 = t5204 / 0.54e2 + t3563 * t732 / 0.81e2 + t3557 * t742 / 0.243e3 + t3560 * t742 / 0.486e3 - 0.2e1 / 0.2187e4 * t5212 - t5214 / 0.2187e4 - 0.2e1 / 0.729e3 * t5216 + t5219 + t5221 + t5223 + t4900 / 0.144e3 - t4902 / 0.108e3 + t4905;
  t5229 = my_piecewise3(t65, 0, t5144 + t5175 + t5203 + t5226);
  tv4rho3sigma5 = t6 * t5229 + t1808 + t5120;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t5239 = t503 * t608;
  t5243 = t4456 + t4458 / 0.27e2 - t4466 / 0.72e2 + t4474 / 0.54e2 - t4499 / 0.72e2 - 0.3e1 / 0.8e1 * t1264 * t246 - 0.3e1 / 0.8e1 * t503 * t623 - t5239 / 0.8e1 - t4936 - t4938 + t4945 / 0.6e1 + t4519 / 0.12e2;
  t5244 = t1271 * t630;
  t5254 = t3538 * t252;
  t5260 = -t5244 * t157 / 0.18e2 + t1271 * t371 * t644 / 0.27e2 + t3535 * t252 / 0.48e2 + t3541 * t252 / 0.48e2 + t5254 / 0.144e3 - t1275 * t662 / 0.36e2 + t4981 + t4552 / 0.12e2 - t4557 + t4988 + t4990 - t4997 - t5010 / 0.36e2;
  t5262 = t1271 * t626;
  t5269 = t3455 * t249;
  t5278 = -t5013 - t5262 * t149 / 0.6e1 + t3451 * t249 / 0.16e2 + t3447 * t249 / 0.16e2 + t5269 / 0.48e2 - t1272 * t650 / 0.12e2 - 0.2e1 / 0.2187e4 * t4604 - t4606 / 0.2187e4 - 0.2e1 / 0.729e3 * t4689 + t5043 + t5045 + t5047 + t3430 * t659 / 0.243e3;
  t5289 = t3433 * t659 / 0.486e3 + t3436 * t647 / 0.81e2 + t4763 + t4764 / 0.162e3 - t4766 / 0.216e3 + t4788 / 0.81e2 - 0.2e1 / 0.243e3 * t4797 - t4799 / 0.216e3 - t5099 / 0.108e3 + t5102 + t5104 - t5107 - t5111;
  t5292 = my_piecewise3(t1, 0, t5243 + t5260 + t5278 + t5289);
  tv4rho3sigma6 = t6 * t5292 + t1949 + t4909;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t5300 = t194 * t1903;
  t5304 = t74 * t117 * t2063 * t100;
  t5306 = t554 * t673;
  t5318 = -0.3e1 / 0.8e1 * t1328 * t267 - 0.3e1 / 0.4e1 * t461 * t710 - 0.3e1 / 0.8e1 * t168 * t2065 - t5300 / 0.4e1 - t5304 / 0.8e1 - t5306 / 0.8e1 - t5122 - t5124 + t5131 / 0.6e1 + t5133 / 0.6e1 + t4884 / 0.12e2 - t4889 + 0.2e1 / 0.27e2 * t473 * t1439 * t729 + 0.8e1 / 0.81e2 * t3995 * t2096 - t1356 * t745 / 0.18e2;
  t5329 = t3964 * t2096;
  t5331 = t1294 * t717;
  t5332 = t5331 * t229;
  t5334 = t477 * t2102;
  t5335 = t5334 * t229;
  t5337 = t3977 * t273;
  t5340 = t1294 * t579 * t729;
  t5343 = t477 * t1439 * t729;
  t5345 = t1911 * t587;
  t5347 = t3971 * t273;
  t5349 = t3974 * t273;
  t5351 = t1914 * t2078;
  t5353 = 0.7e1 / 0.108e3 * t481 * t2072 - t1353 * t745 / 0.18e2 - 0.5e1 / 0.27e2 * t1917 * t2078 + 0.7e1 / 0.54e2 * t1926 * t587 + t3986 * t273 / 0.48e2 + 0.8e1 / 0.243e3 * t5329 - t5332 / 0.27e2 - t5335 / 0.27e2 + t5337 / 0.144e3 + 0.2e1 / 0.81e2 * t5340 + 0.2e1 / 0.81e2 * t5343 + 0.7e1 / 0.162e3 * t5345 + t5347 / 0.144e3 + t5349 / 0.72e2 - 0.5e1 / 0.81e2 * t5351;
  t5355 = t484 * t2072;
  t5357 = t1345 * t745;
  t5359 = t1348 * t745;
  t5361 = t1287 * t717;
  t5364 = t473 * t2102;
  t5376 = 0.7e1 / 0.324e3 * t5355 - t5357 / 0.54e2 - t5359 / 0.54e2 - t5361 * t229 / 0.9e1 - t5364 * t229 / 0.9e1 + t3989 * t273 / 0.24e2 + t3992 * t273 / 0.48e2 + 0.2e1 / 0.27e2 * t1287 * t579 * t729 + t5141 + t5143 - t5147 + t5150 - t5155 - t5156 / 0.108e3 - t5158 / 0.108e3;
  t5380 = t477 * t1952;
  t5381 = t5380 * t531;
  t5383 = t473 * t1952;
  t5386 = t473 * t1956;
  t5389 = t473 * t1960;
  t5392 = t477 * t1956;
  t5393 = t5392 * t531;
  t5395 = t477 * t1960;
  t5396 = t5395 * t541;
  t5400 = 0.2e1 / 0.81e2 * t5161 - 0.4e1 / 0.243e3 * t5164 + t5166 / 0.81e2 - 0.8e1 / 0.2187e4 * t5381 - 0.8e1 / 0.729e3 * t5383 * t531 - 0.4e1 / 0.729e3 * t5386 * t531 - 0.8e1 / 0.243e3 * t5389 * t541 - 0.4e1 / 0.2187e4 * t5393 - 0.8e1 / 0.729e3 * t5396 - t4894 / 0.72e2 + t4897 - t5179 - t5182 + t5184 + t5195 + 0.2e1 / 0.27e2 * t5197;
  t5406 = t3817 * t270;
  t5408 = t3820 * t270;
  t5410 = t1870 * t598;
  t5412 = t3823 * t270;
  t5414 = t1294 * t713;
  t5415 = t5414 * t221;
  t5417 = t477 * t1969;
  t5418 = t5417 * t221;
  t5420 = t1295 * t735;
  t5422 = t1298 * t735;
  t5424 = t478 * t1982;
  t5432 = -t5199 / 0.36e2 - t5201 / 0.36e2 + t5204 / 0.27e2 + t5406 / 0.48e2 + t5408 / 0.24e2 + 0.7e1 / 0.54e2 * t5410 + t5412 / 0.48e2 - t5415 / 0.9e1 - t5418 / 0.9e1 - t5420 / 0.18e2 - t5422 / 0.18e2 + 0.7e1 / 0.108e3 * t5424 + t3835 * t270 / 0.16e2 + t3838 * t270 / 0.8e1 + 0.7e1 / 0.36e2 * t474 * t1982;
  t5441 = t1287 * t713;
  t5444 = t473 * t1969;
  t5454 = t473 * t2040;
  t5457 = -t1288 * t735 / 0.6e1 - t1291 * t735 / 0.6e1 + 0.7e1 / 0.18e2 * t1875 * t598 + t3840 * t270 / 0.16e2 - t5441 * t221 / 0.3e1 - t5444 * t221 / 0.3e1 - 0.4e1 / 0.2187e4 * t5212 - 0.2e1 / 0.2187e4 * t5214 - 0.4e1 / 0.729e3 * t5216 + t5219 + t5221 + t5223 - 0.5e1 / 0.243e3 * t1363 * t1993 - 0.5e1 / 0.81e2 * t1369 * t1996 - 0.8e1 / 0.81e2 * t5454 * t584;
  t5485 = t1375 * t1996;
  t5487 = t1360 * t1993;
  t5489 = t3755 * t742 / 0.243e3 + 0.2e1 / 0.81e2 * t3763 * t732 + 0.2e1 / 0.81e2 * t3785 * t732 + 0.8e1 / 0.243e3 * t3887 * t2027 + 0.8e1 / 0.729e3 * t3898 * t2034 + 0.4e1 / 0.729e3 * t1369 * t2034 + 0.8e1 / 0.2187e4 * t3856 * t2005 + 0.8e1 / 0.2187e4 * t1363 * t2005 + 0.2e1 / 0.243e3 * t3789 * t742 - 0.5e1 / 0.486e3 * t1366 * t1993 + 0.8e1 / 0.6561e4 * t1366 * t2005 + 0.2e1 / 0.243e3 * t3792 * t742 + t3760 * t742 / 0.243e3 - 0.5e1 / 0.243e3 * t5485 - 0.5e1 / 0.729e3 * t5487;
  t5490 = t3877 * t2034;
  t5492 = t1375 * t2034;
  t5494 = t477 * t2040;
  t5495 = t5494 * t584;
  t5497 = t3776 * t732;
  t5499 = t3862 * t2027;
  t5501 = t3804 * t742;
  t5503 = t3801 * t742;
  t5505 = t3773 * t732;
  t5507 = t3770 * t742;
  t5509 = t3880 * t2005;
  t5511 = t1360 * t2005;
  t5513 = t1372 * t2005;
  t5515 = t3807 * t742;
  t5517 = t1372 * t1993;
  t5520 = 0.8e1 / 0.2187e4 * t5490 + 0.4e1 / 0.2187e4 * t5492 - 0.8e1 / 0.243e3 * t5495 + 0.2e1 / 0.243e3 * t5497 + 0.8e1 / 0.729e3 * t5499 + 0.2e1 / 0.729e3 * t5501 + t5503 / 0.729e3 + 0.2e1 / 0.243e3 * t5505 + t5507 / 0.729e3 + 0.8e1 / 0.6561e4 * t5509 + 0.8e1 / 0.6561e4 * t5511 + 0.8e1 / 0.19683e5 * t5513 + 0.2e1 / 0.729e3 * t5515 - 0.5e1 / 0.1458e4 * t5517 - t4902 / 0.216e3 + t4905;
  t5524 = my_piecewise3(t65, 0, t5318 + t5353 + t5376 + t5400 + t5432 + t5457 + t5489 + t5520);
  tv4rho3sigma8 = t6 * t5524 + t2114 + t5120;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t5539 = -0.3e1 / 0.8e1 * t1397 * t246 - 0.3e1 / 0.8e1 * t5239 + t4945 / 0.4e1 - t4557 + t3737 * t249 / 0.16e2 + t5269 / 0.16e2 - t5010 / 0.24e2 + t4456 + t3740 * t252 / 0.48e2 + t5254 / 0.48e2 - t5099 / 0.72e2 + t4763;
  t5540 = my_piecewise3(t1, 0, t5539);
  tv4rho3sigma9 = t6 * t5540 + 0.3e1 * t1949;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t5549 = t30 * t1430;
  t5552 = t260 * t1405;
  t5553 = t5552 * t206;
  t5563 = 0.1e1 / t77 / t4170;
  t5581 = t1545 * t2033;
  t5586 = t1509 * t2004;
  t5589 = t5549 * t530;
  t5606 = -0.88e2 / 0.729e3 * t1446 * t5581 + 0.56e2 / 0.81e2 * t2041 * t1433 - 0.88e2 / 0.2187e4 * t1458 * t5586 + 0.119e3 / 0.2187e4 * t535 * t5589 + 0.8e1 / 0.243e3 * t4158 * t2034 + 0.8e1 / 0.729e3 * t4167 * t2005 + 0.8e1 / 0.729e3 * t1580 * t2005 + t4040 * t742 / 0.81e2 + t4052 * t742 / 0.162e3 - 0.5e1 / 0.162e3 * t1583 * t1993 - 0.5e1 / 0.162e3 * t1566 * t1993;
  t5622 = M_PI * sigma[2] * t43;
  t5623 = t5563 * t1460 * t5622;
  t5627 = t5563 * t4216 * t5622;
  t5636 = -0.44e2 / 0.729e3 * t539 * t5581 - 0.88e2 / 0.2187e4 * t522 * t5586 - 0.88e2 / 0.6561e4 * t535 * t5586 + 0.4e1 / 0.243e3 * t1569 * t2034 + 0.4e1 / 0.243e3 * t1573 * t2034 + 0.8e1 / 0.729e3 * t4161 * t2005 + 0.128e3 / 0.19683e5 * t4249 * t5623 + 0.128e3 / 0.59049e5 * t4230 * t5627 + 0.64e2 / 0.19683e5 * t1458 * t5627 + 0.8e1 / 0.729e3 * t1576 * t2005 + 0.128e3 / 0.19683e5 * t1446 * t5623;
  t5660 = 0.238e3 / 0.729e3 * t539 * t5549 * t540 + 0.238e3 / 0.2187e4 * t522 * t5589 + 0.8e1 / 0.2187e4 * t1583 * t2005 + 0.8e1 / 0.2187e4 * t1566 * t2005 + 0.128e3 / 0.59049e5 * t539 * t5623 + 0.352e3 / 0.177147e6 * t522 * t5627 + 0.32e2 / 0.59049e5 * t535 * t5627 - 0.5e1 / 0.27e2 * t1573 * t1996 - 0.5e1 / 0.81e2 * t1580 * t1993 + 0.2e1 / 0.81e2 * t4037 * t742 + t4048 * t742 / 0.81e2;
  t5663 = t5563 * M_PI;
  t5666 = t5663 * sigma[2] * t528 * t43;
  t5669 = t509 * t2040;
  t5672 = t708 * t578;
  t5674 = t215 * t5672 * t99;
  t5678 = t215 * t2039 * t227;
  t5722 = 0.128e3 / 0.2187e4 * t4188 * t5663 * sigma[2] * t206 * t43 + 0.128e3 / 0.6561e4 * t4245 * t5666 - 0.5e1 / 0.27e2 * t1569 * t1996 - 0.5e1 / 0.81e2 * t1576 * t1993 + t4068 * t742 / 0.81e2 + 0.8e1 / 0.243e3 * t4148 * t2034 + t4071 * t742 / 0.162e3 - 0.35e2 / 0.81e2 * t718 * t1524 + 0.238e3 / 0.243e3 * t725 * t726 * t1432 - 0.35e2 / 0.162e3 * t225 * t228 * t5553 + 0.7e1 / 0.36e2 * t595 * t2072;
  t5748 = t4366 * t273 / 0.16e2 + t4369 * t273 / 0.16e2 + t4373 * t273 / 0.48e2 + t1410 * t579 * t729 / 0.9e1 + 0.2e1 / 0.9e1 * t509 * t1439 * t729 + 0.8e1 / 0.27e2 * t4376 * t2096 + 0.7e1 / 0.18e2 * t2103 * t587 + t4363 * t273 / 0.48e2 - t1533 * t745 / 0.6e1 - t1537 * t745 / 0.12e2 + 0.7e1 / 0.36e2 * t591 * t2072;
  t5760 = t215 * t265 * t1541;
  t5774 = t1410 * t717;
  t5777 = t509 * t2102;
  t5780 = -t1530 * t745 / 0.12e2 - 0.5e1 / 0.9e1 * t2089 * t2078 - 0.5e1 / 0.9e1 * t2092 * t2078 - 0.88e2 / 0.81e2 * t1543 * t99 * t1448 * t2004 - 0.64e2 / 0.243e3 * t5760 * t1547 + 0.7e1 / 0.18e2 * t2099 * t587 + t215 * t4182 * t729 / 0.9e1 + 0.8e1 / 0.27e2 * t4380 * t2096 + 0.128e3 / 0.729e3 * t4386 * t99 * t5563 * t5622 - t5774 * t229 / 0.6e1 - t5777 * t229 / 0.3e1;
  t5785 = t215 * t2063 * t98;
  t5808 = t215 * t1969 * t227;
  t5812 = t215 * t2102 * t520;
  t5815 = -0.5e1 / 0.27e2 * t5351 + 0.7e1 / 0.108e3 * t5355 - t5357 / 0.18e2 - t5359 / 0.18e2 - t5156 / 0.72e2 - t5158 / 0.72e2 + t5161 / 0.27e2 - 0.2e1 / 0.81e2 * t5164 + t5166 / 0.54e2 - 0.8e1 / 0.81e2 * t5808 * t541 - 0.8e1 / 0.243e3 * t5812 * t531;
  t5823 = t509 * t1960;
  t5826 = t509 * t1952;
  t5829 = t509 * t1956;
  t5834 = t215 * t2102 * t227;
  t5839 = 0.56e2 / 0.243e3 * t1961 * t1557 + 0.56e2 / 0.729e3 * t1953 * t1560 + 0.28e2 / 0.729e3 * t1957 * t1560 - 0.8e1 / 0.81e2 * t5823 * t541 - 0.8e1 / 0.243e3 * t5826 * t531 - 0.4e1 / 0.243e3 * t5829 * t531 - 0.8e1 / 0.729e3 * t5381 - 0.4e1 / 0.243e3 * t5834 * t531 - 0.4e1 / 0.729e3 * t5393 - 0.8e1 / 0.243e3 * t5396 + t4897;
  t5851 = t5197 / 0.9e1 - t5199 / 0.24e2 - t5201 / 0.24e2 + t5204 / 0.18e2 + t5406 / 0.16e2 + t5408 / 0.8e1 + 0.7e1 / 0.18e2 * t5410 + t5412 / 0.16e2 - t5415 / 0.3e1 - t5418 / 0.3e1 - t5420 / 0.6e1;
  t5865 = t1410 * t713;
  t5868 = t509 * t1969;
  t5871 = t215 * t2063 * t217;
  t5896 = 0.3e1 / 0.16e2 * t4130 * t270 + 0.7e1 / 0.12e2 * t510 * t1982 + 0.7e1 / 0.12e2 * t514 * t1982 - t1411 * t735 / 0.4e1 - t1414 * t735 / 0.2e1 - t1417 * t735 / 0.4e1 + 0.7e1 / 0.6e1 * t1966 * t598 + 0.7e1 / 0.6e1 * t1970 * t598 - 0.2e1 / 0.729e3 * t5212 - t5214 / 0.729e3 - 0.2e1 / 0.243e3 * t5216;
  t5909 = -0.5e1 / 0.81e2 * t5485 - 0.5e1 / 0.243e3 * t5487 + 0.8e1 / 0.729e3 * t5490 + 0.4e1 / 0.729e3 * t5492 - 0.8e1 / 0.81e2 * t5495 + 0.2e1 / 0.81e2 * t5497 + 0.8e1 / 0.243e3 * t5499 + 0.2e1 / 0.243e3 * t5501 + t5503 / 0.243e3 + 0.2e1 / 0.81e2 * t5505 + t5507 / 0.243e3;
  t5916 = t215 * t713 * t520;
  t5920 = t215 * t717 * t1456;
  t5929 = 0.8e1 / 0.2187e4 * t5509 + 0.8e1 / 0.2187e4 * t5511 + 0.8e1 / 0.6561e4 * t5513 + 0.2e1 / 0.243e3 * t5515 - 0.5e1 / 0.486e3 * t5517 - 0.64e2 / 0.2187e4 * t5916 * t1452 - 0.64e2 / 0.6561e4 * t5920 * t1463 - 0.64e2 / 0.6561e4 * t1953 * t1463 - 0.32e2 / 0.2187e4 * t1961 * t1452 - 0.64e2 / 0.19683e5 * t1957 * t1463 + t4905;
  t5934 = my_piecewise3(t65, 0, t5929 + t5722 + 0.7e1 / 0.54e2 * t5345 + t5347 / 0.48e2 + t5349 / 0.24e2 + t5815 + t5780 + 0.2e1 / 0.27e2 * t5343 + t5337 / 0.48e2 + 0.2e1 / 0.27e2 * t5340 - t5332 / 0.9e1 - t5335 / 0.9e1 + t5660 + 0.8e1 / 0.81e2 * t5329 - 0.3e1 / 0.8e1 * t5304 - 0.3e1 / 0.8e1 * t5306 - 0.3e1 / 0.4e1 * t5300 + t5748 + t5636 + t5606 - t5871 * t221 / 0.2e1 + t4127 * t270 / 0.16e2 - 0.35e2 / 0.27e2 * t714 * t1407 + 0.3e1 / 0.16e2 * t4133 * t270 + t4119 * t270 / 0.16e2 - t5865 * t221 / 0.2e1 - t5785 * t229 / 0.6e1 - 0.8e1 / 0.27e2 * t5674 * t584 - 0.64e2 / 0.729e3 * t5678 * t1475 + t4065 * t732 / 0.27e2 + 0.2e1 / 0.27e2 * t4034 * t732 + 0.8e1 / 0.81e2 * t4145 * t2027 + t4044 * t732 / 0.27e2 + 0.8e1 / 0.81e2 * t4154 * t2027 + 0.64e2 / 0.6561e4 * t1473 * t5666 - 0.8e1 / 0.27e2 * t5669 * t584 - 0.3e1 / 0.8e1 * t1491 * t267 - 0.9e1 / 0.8e1 * t554 * t710 - 0.9e1 / 0.8e1 * t194 * t2065 - t5868 * t221 + t5839 + t5851 - t5422 / 0.6e1 + 0.7e1 / 0.36e2 * t5424 + t5896 + t5909 + t5131 / 0.4e1 + t5133 / 0.4e1 - 0.3e1 / 0.8e1 * t74 * t27 * (-0.2464e4 / 0.2187e4 * t29 * t5549 - 0.14e3 / 0.729e3 * t130 * t5553 + 0.952e3 / 0.6561e4 * t334 * t5549 * t528 - 0.704e3 / 0.19683e5 * t926 * t1448 * t2060 + 0.256e3 / 0.531441e6 * t2975 * t5563 * t4216 * sigma[2] * t41 * t43) * t100 - t4889 - 0.35e2 / 0.54e2 * t219 * t220 * t5552 - 0.88e2 / 0.243e3 * t1473 * t1545 * t2026);
  tv4rho3sigma11 = t6 * t5934 + 0.3e1 * t2114;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t5937 = t113 * t2201;
  t5941 = t26 * t117 * t2218 * t60;
  t5947 = t754 * t328;
  t5948 = t5947 * t134;
  t5958 = 0.1e1 / t33 / t849;
  t5970 = t26 * t291 * t764 * t60 / 0.12e2;
  t5999 = -t5937 / 0.4e1 - t5941 / 0.4e1 - 0.3e1 / 0.8e1 * t360 * t766 - 0.3e1 / 0.4e1 * t113 * t2220 - 0.3e1 / 0.8e1 * t26 * t27 * (-0.7e1 / 0.243e3 * t130 * t5948 - 0.14e2 / 0.2187e4 * t335 * t759 * t304 * t315 + 0.152e3 / 0.19683e5 * t2214 * t1636 - 0.32e2 / 0.177147e6 * t2975 * t5958 * t2979) * t60 + t5970 - 0.2e1 / 0.81e2 * t2790 * t2188 - 0.2e1 / 0.243e3 * t2876 * t2191 - 0.2e1 / 0.243e3 * t2766 * t2191 - t1022 * t2191 / 0.243e3 - t1057 * t2191 / 0.243e3 - 0.2e1 / 0.729e3 * t2882 * t2168 - 0.2e1 / 0.729e3 * t2770 * t2168 - 0.2e1 / 0.729e3 * t1028 * t2168 - 0.2e1 / 0.729e3 * t1046 * t2168 - 0.2e1 / 0.2187e4 * t1049 * t2168 - 0.2e1 / 0.2187e4 * t1053 * t2168 + 0.4e1 / 0.81e2 * t4403 * t647 - t2885 * t776 / 0.72e2 - t2818 * t776 / 0.36e2;
  t6024 = t4415 * t659;
  t6026 = t4418 * t659;
  t6032 = t239 * t1635;
  t6033 = t6032 * t858;
  t6036 = t1025 * t2191;
  t6040 = t2804 * t2168;
  t6042 = -0.2e1 / 0.81e2 * t2873 * t2188 - t2823 * t776 / 0.72e2 + 0.4e1 / 0.243e3 * t4426 * t659 + 0.16e2 / 0.2187e4 * t4667 * t1638 + 0.16e2 / 0.2187e4 * t1774 * t1638 + 0.2e1 / 0.243e3 * t4409 * t659 + 0.2e1 / 0.243e3 * t4430 * t659 + 0.16e2 / 0.6561e4 * t1778 * t1638 + 0.4e1 / 0.81e2 * t4422 * t647 + 0.16e2 / 0.243e3 * t4657 * t1668 + 0.16e2 / 0.729e3 * t4661 * t1673 + 0.8e1 / 0.729e3 * t1770 * t1673 + 0.4e1 / 0.729e3 * t6024 + 0.2e1 / 0.729e3 * t6026 - 0.1e2 / 0.243e3 * t1774 * t1644 - 0.5e1 / 0.243e3 * t1778 * t1644 + 0.19e2 / 0.729e3 * t857 * t6033 - t6036 / 0.729e3 + 0.19e2 / 0.1458e4 * t301 * t6033 - 0.2e1 / 0.2187e4 * t6040;
  t6044 = t2826 * t776;
  t6048 = t2831 * t776;
  t6052 = t2879 * t2188;
  t6057 = t764 * t370;
  t6059 = t143 * t6057 * t59;
  t6062 = t844 * t2181;
  t6070 = t2888 * t776 / 0.324e3;
  t6071 = t1042 * t2168;
  t6073 = t6032 * t871;
  t6076 = t4412 * t647;
  t6082 = t1037 * t2168;
  t6086 = t2801 * t2191;
  t6088 = t155 * t5958;
  t6092 = -t6044 / 0.108e3 + t841 * t2181 / 0.27e2 - t6048 / 0.108e3 + t1067 * t2181 / 0.27e2 - 0.2e1 / 0.243e3 * t6052 + 0.19e2 / 0.243e3 * t848 * t6032 * t852 - 0.8e1 / 0.81e2 * t6059 * t376 + t6062 / 0.81e2 - 0.7e1 / 0.162e3 * t373 * t773 * t375 + 0.4e1 / 0.243e3 * t4406 * t659 + t6070 - 0.2e1 / 0.6561e4 * t6071 + 0.19e2 / 0.6561e4 * t322 * t6073 + 0.4e1 / 0.243e3 * t6076 - 0.1e2 / 0.81e2 * t1770 * t1651 + 0.19e2 / 0.2187e4 * t867 * t6073 - 0.2e1 / 0.2187e4 * t6082 + 0.19e2 / 0.2187e4 * t313 * t6073 - 0.2e1 / 0.729e3 * t6086 - 0.4e1 / 0.19683e5 * t153 * t6088 * t2898;
  t6093 = t4819 * t252;
  t6095 = t4822 * t252;
  t6102 = t296 * t1654 * t644;
  t6111 = t311 * t5958;
  t6118 = t865 * t5958;
  t6138 = t286 * t2249;
  t6142 = t143 * t2218 * t58;
  t6147 = t6093 / 0.36e2 + t6095 / 0.36e2 - t1722 * t662 / 0.9e1 - t1766 * t662 / 0.9e1 + 0.4e1 / 0.81e2 * t6102 - 0.2e1 / 0.27e2 * t3031 * t2242 - 0.2e1 / 0.27e2 * t3028 * t2242 - 0.16e2 / 0.729e3 * t1010 * t6088 * t2848 - 0.16e2 / 0.2187e4 * t640 * t6111 * t2855 - 0.8e1 / 0.2187e4 * t640 * t6088 * t2855 - 0.16e2 / 0.6561e4 * t147 * t6118 * t2864 - 0.16e2 / 0.6561e4 * t147 * t6111 * t2864 - 0.16e2 / 0.19683e5 * t147 * t6088 * t2864 - 0.16e2 / 0.19683e5 * t153 * t2892 * t5958 * t2898 - t998 * t789 / 0.96e2 - t1001 * t789 / 0.48e2 - t995 * t789 / 0.96e2 - t6138 * t157 / 0.9e1 - t6142 * t157 / 0.9e1 - 0.1e2 / 0.27e2 * t2232 * t1727;
  t6170 = t988 * t789;
  t6172 = t1004 * t789;
  t6178 = t296 * t2249;
  t6179 = t6178 * t157;
  t6183 = t3034 * t2242;
  t6190 = t4787 * t252 / 0.108e3;
  t6191 = t1762 * t662;
  t6196 = t991 * t789 / 0.432e3;
  t6197 = 0.4e1 / 0.27e2 * t286 * t1654 * t644 + 0.4e1 / 0.27e2 * t143 * t4694 * t644 + 0.16e2 / 0.81e2 * t4804 * t1755 + t4814 * t252 / 0.24e2 + t4825 * t252 / 0.12e2 + t4829 * t252 / 0.24e2 - 0.8e1 / 0.6561e4 * t153 * t6118 * t2898 - 0.44e2 / 0.59049e5 * t153 * t6111 * t2898 - t6170 / 0.144e3 - t6172 / 0.144e3 + t382 * t2225 / 0.36e2 + t389 * t2225 / 0.36e2 - t6179 / 0.27e2 + 0.7e1 / 0.54e2 * t2250 * t379 - 0.2e1 / 0.81e2 * t6183 + 0.19e2 / 0.81e2 * t1010 * t2239 * t1665 * t28 - t6190 - t6191 / 0.27e2 + 0.7e1 / 0.54e2 * t631 * t1741 + t6196;
  t6198 = t385 * t2225;
  t6204 = t2624 * t786 / 0.5832e4;
  t6206 = t2649 * t780 / 0.972e3;
  t6208 = t2613 * t786 / 0.2916e4;
  t6209 = t1025 * t2126;
  t6211 = t1037 * t2119;
  t6213 = t1042 * t2119;
  t6215 = t773 * t304;
  t6238 = t143 * t2154 * t155;
  t6242 = t143 * t2249 * t311;
  t6245 = t6198 / 0.108e3 - 0.7e1 / 0.216e3 * t153 * t156 * t5948 + t6204 + t6206 + t6208 + t6209 / 0.243e3 + t6211 / 0.729e3 + t6213 / 0.1458e4 - 0.7e1 / 0.486e3 * t301 * t6215 * t306 - t2646 * t780 / 0.216e3 - t2636 * t780 / 0.108e3 - t2640 * t780 / 0.216e3 - t2660 * t786 / 0.648e3 - t2652 * t786 / 0.324e3 + t1049 * t2119 / 0.486e3 + t1057 * t2126 / 0.81e2 + t1046 * t2119 / 0.243e3 + t1053 * t2119 / 0.486e3 - 0.8e1 / 0.243e3 * t6238 * t307 - 0.8e1 / 0.729e3 * t6242 * t318;
  t6248 = t143 * t2249 * t155;
  t6251 = t2681 * t786;
  t6253 = t2684 * t786;
  t6259 = t6215 * t317;
  t6272 = t2691 * t786;
  t6274 = t2694 * t786;
  t6276 = t2643 * t780;
  t6278 = t2610 * t780;
  t6280 = t297 * t2151;
  t6285 = t296 * t2154;
  t6286 = t6285 * t149;
  t6292 = -0.4e1 / 0.729e3 * t6248 * t318 - t6251 / 0.972e3 - t6253 / 0.972e3 + t1022 * t2126 / 0.81e2 + t1028 * t2119 / 0.243e3 - 0.7e1 / 0.1458e4 * t313 * t6259 - 0.7e1 / 0.2916e4 * t322 * t6259 - t2664 * t786 / 0.648e3 - t2667 * t786 / 0.1296e4 - t2670 * t786 / 0.648e3 - t2674 * t786 / 0.1296e4 - t6272 / 0.1944e4 - t6274 / 0.1944e4 - t6276 / 0.324e3 - t6278 / 0.324e3 + t6280 / 0.36e2 - 0.7e1 / 0.72e2 * t147 * t148 * t5947 - t6286 / 0.9e1 + 0.7e1 / 0.18e2 * t2155 * t392 + 0.7e1 / 0.18e2 * t627 * t1609;
  t6294 = t880 * t783 / 0.144e3;
  t6296 = t4457 * t249 / 0.36e2;
  t6297 = t1620 * t650;
  t6299 = t4501 * t249;
  t6301 = t4558 * t249;
  t6311 = t906 * t783;
  t6313 = t883 * t783;
  t6319 = t286 * t2154;
  t6323 = t143 * t2218 * t145;
  t6338 = t6294 - t6296 - t6297 / 0.9e1 + t6299 / 0.12e2 + t6301 / 0.12e2 - t1601 * t650 / 0.3e1 - t1624 * t650 / 0.3e1 - 0.16e2 / 0.243e3 * t3012 * t59 * t5958 * t4193 - t6311 / 0.48e2 - t6313 / 0.48e2 + t287 * t2151 / 0.12e2 + t281 * t2151 / 0.12e2 - t6319 * t149 / 0.3e1 - t6323 * t149 / 0.3e1 + t4452 * t249 / 0.8e1 + t4504 * t249 / 0.4e1 + t4439 * t249 / 0.8e1 - t910 * t783 / 0.32e2 - t899 * t783 / 0.16e2 - t902 * t783 / 0.32e2;
  t6342 = my_piecewise3(t1, 0, t5999 + t6042 + t6092 + t6147 + t6197 + t6245 + t6292 + t6338);
  tv4rho2sigma20 = t6 * t6342 + 0.2e1 * t2256;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t6348 = t74 * t291 * t807 * t100 / 0.12e2;
  t6349 = t168 * t2261;
  t6354 = t3606 * t819 / 0.324e3;
  t6355 = t3612 * t819;
  t6362 = t5160 * t273 / 0.108e3;
  t6363 = t1240 * t832;
  t6366 = t1243 * t832 / 0.432e3;
  t6367 = t5145 * t273;
  t6373 = t6348 - t6349 / 0.4e1 - 0.3e1 / 0.8e1 * t410 * t809 + t6354 - t6355 / 0.108e3 - t3609 * t819 / 0.72e2 - t1237 * t832 / 0.96e2 - t6362 - t6363 / 0.144e3 + t6366 + t6367 / 0.36e2 + t5137 * t273 / 0.24e2 - t3557 * t829 / 0.648e3;
  t6374 = t3566 * t829;
  t6377 = t3551 * t829 / 0.5832e4;
  t6378 = t3572 * t829;
  t6381 = t3548 * t829 / 0.2916e4;
  t6382 = t3569 * t823;
  t6385 = t3554 * t823 / 0.972e3;
  t6391 = t1234 * t826 / 0.144e3;
  t6392 = t5180 * t270;
  t6395 = t5196 * t270 / 0.36e2;
  t6396 = t1230 * t826;
  t6402 = -t6374 / 0.1944e4 + t6377 - t6378 / 0.972e3 + t6381 - t6382 / 0.324e3 + t6385 - t3560 * t829 / 0.1296e4 - t3563 * t823 / 0.216e3 + t6391 + t6392 / 0.12e2 - t6395 - t6396 / 0.48e2 + t5185 * t270 / 0.8e1 - t1226 * t826 / 0.32e2;
  t6404 = my_piecewise3(t65, 0, t6373 + t6402);
  tv4rho2sigma25 = t6 * t6404 + 0.2e1 * t2297;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6406 = t184 * t2201;
  t6426 = -t6406 / 0.8e1 - 0.3e1 / 0.8e1 * t432 * t766 - 0.3e1 / 0.8e1 * t184 * t2220 - t5937 / 0.8e1 - t5941 / 0.8e1 + t5970 - t3212 * t776 / 0.72e2 - t3215 * t2188 / 0.81e2 - t3218 * t2191 / 0.243e3 - t1179 * t2191 / 0.486e3 - t3223 * t2168 / 0.729e3 - t1182 * t2168 / 0.729e3;
  t6437 = t3209 * t776;
  t6446 = -t1185 * t2168 / 0.2187e4 + 0.2e1 / 0.81e2 * t4913 * t647 + 0.2e1 / 0.243e3 * t4916 * t659 + t4919 * t659 / 0.243e3 - t3233 * t776 / 0.72e2 - t6437 / 0.216e3 + t1110 * t2181 / 0.54e2 + 0.2e1 / 0.729e3 * t6024 + t6026 / 0.729e3 - t6036 / 0.1458e4 - t6040 / 0.2187e4 - t6044 / 0.216e3;
  t6464 = -t6048 / 0.216e3 - t6052 / 0.243e3 + t6062 / 0.162e3 + t6070 - t6071 / 0.6561e4 + 0.2e1 / 0.243e3 * t6076 - t6082 / 0.2187e4 - t6086 / 0.729e3 + 0.2e1 / 0.27e2 * t439 * t1654 * t644 + t4973 * t252 / 0.24e2 + t4976 * t252 / 0.24e2 - t3331 * t2242 / 0.27e2;
  t6469 = t439 * t2249;
  t6472 = t1168 * t789;
  t6476 = t5105 * t252;
  t6485 = -t1165 * t789 / 0.96e2 - t1171 * t789 / 0.96e2 - t6469 * t157 / 0.18e2 - t6472 / 0.288e3 + t443 * t2225 / 0.72e2 + t6476 / 0.72e2 - t1847 * t662 / 0.18e2 + t6093 / 0.72e2 + t6095 / 0.72e2 + 0.2e1 / 0.81e2 * t6102 - t6170 / 0.288e3 - t6172 / 0.288e3;
  t6492 = t3155 * t786;
  t6494 = t3125 * t780;
  t6498 = t3150 * t786;
  t6504 = -t6179 / 0.54e2 - t6183 / 0.81e2 - t6190 - t6191 / 0.54e2 + t6196 + t6198 / 0.216e3 - t6492 / 0.3888e4 - t6494 / 0.648e3 + t1179 * t2126 / 0.162e3 - t6498 / 0.1944e4 + t1182 * t2119 / 0.486e3 - t3122 * t780 / 0.216e3;
  t6520 = -t3128 * t780 / 0.216e3 - t3131 * t786 / 0.648e3 - t3134 * t786 / 0.648e3 + t1185 * t2119 / 0.972e3 - t3137 * t786 / 0.1296e4 - t3140 * t786 / 0.1296e4 + t6204 + t6206 + t6208 + t6209 / 0.486e3 + t6211 / 0.1458e4 + t6213 / 0.2916e4;
  t6532 = -t6251 / 0.1944e4 - t6253 / 0.1944e4 - t6272 / 0.3888e4 - t6274 / 0.3888e4 - t6276 / 0.648e3 - t6278 / 0.648e3 + t6280 / 0.72e2 - t6286 / 0.18e2 + t6294 - t6296 - t6297 / 0.18e2 + t6299 / 0.24e2;
  t6542 = t1121 * t783;
  t6546 = t4995 * t249;
  t6548 = t439 * t2154;
  t6555 = t6301 / 0.24e2 - t6311 / 0.96e2 - t6313 / 0.96e2 - t1117 * t783 / 0.32e2 - t1124 * t783 / 0.32e2 - t1815 * t650 / 0.6e1 - t6542 / 0.96e2 + t440 * t2151 / 0.24e2 + t6546 / 0.24e2 - t6548 * t149 / 0.6e1 + t4998 * t249 / 0.8e1 + t5001 * t249 / 0.8e1;
  t6559 = my_piecewise3(t1, 0, t6426 + t6446 + t6464 + t6485 + t6504 + t6520 + t6532 + t6555);
  tv4rho2sigma26 = t6 * t6559 + t2256 + t2318;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t6563 = t74 * t117 * t2405 * t100;
  t6565 = t194 * t2261;
  t6576 = t473 * t2416;
  t6579 = t5334 * t273;
  t6581 = t3964 * t2430;
  t6583 = t1345 * t832;
  t6585 = -t6563 / 0.8e1 - t6565 / 0.8e1 + t6348 - t6349 / 0.8e1 - t1353 * t832 / 0.96e2 - t1356 * t832 / 0.96e2 + t481 * t2411 / 0.72e2 - t1926 * t745 / 0.18e2 - t6576 * t229 / 0.18e2 + t6579 / 0.72e2 - t6581 / 0.81e2 - t6583 / 0.288e3;
  t6586 = t1911 * t745;
  t6588 = t477 * t2416;
  t6589 = t6588 * t229;
  t6592 = t477 * t2039 * t729;
  t6594 = t484 * t2411;
  t6605 = t1360 * t2321;
  t6607 = t3770 * t829;
  t6609 = t1372 * t2321;
  t6611 = t3801 * t829;
  t6613 = -t6586 / 0.54e2 - t6589 / 0.54e2 + 0.2e1 / 0.81e2 * t6592 + t6594 / 0.216e3 + 0.2e1 / 0.27e2 * t473 * t2039 * t729 + t5361 * t273 / 0.24e2 + t5364 * t273 / 0.24e2 - t3995 * t2430 / 0.27e2 + t6605 / 0.1458e4 - t6607 / 0.3888e4 + t6609 / 0.2916e4 - t6611 / 0.3888e4;
  t6615 = t3776 * t823;
  t6617 = t3804 * t829;
  t6619 = t3807 * t829;
  t6621 = t3773 * t823;
  t6623 = t5395 * t732;
  t6625 = t1375 * t2381;
  t6627 = t3880 * t2365;
  t6629 = t1360 * t2365;
  t6631 = t3874 * t819;
  t6633 = t3862 * t2378;
  t6635 = t3877 * t2381;
  t6637 = t5392 * t742;
  t6639 = -t6615 / 0.648e3 - t6617 / 0.1944e4 - t6619 / 0.1944e4 - t6621 / 0.648e3 + 0.2e1 / 0.243e3 * t6623 - t6625 / 0.1458e4 - t6627 / 0.2187e4 - t6629 / 0.2187e4 - t6631 / 0.216e3 - t6633 / 0.243e3 - t6635 / 0.729e3 + t6637 / 0.729e3;
  t6640 = t3851 * t819;
  t6642 = t1304 * t2360;
  t6644 = t1372 * t2365;
  t6646 = t5380 * t742;
  t6664 = -t6640 / 0.216e3 + t6642 / 0.162e3 - t6644 / 0.6561e4 + 0.2e1 / 0.729e3 * t6646 + t1307 * t2360 / 0.54e2 - t1366 * t2365 / 0.2187e4 + 0.2e1 / 0.243e3 * t5383 * t742 + t5386 * t742 / 0.243e3 - t3892 * t819 / 0.72e2 - t3895 * t819 / 0.72e2 + 0.2e1 / 0.81e2 * t5389 * t732 - t3887 * t2378 / 0.81e2;
  t6676 = t1348 * t832;
  t6678 = t5331 * t273;
  t6682 = -t3898 * t2381 / 0.243e3 - t1369 * t2381 / 0.486e3 - t3856 * t2365 / 0.729e3 - t1363 * t2365 / 0.729e3 + t6354 - t6355 / 0.216e3 - t6676 / 0.288e3 + t6678 / 0.72e2 - t6362 - t6363 / 0.288e3 + t6366 + t6367 / 0.72e2;
  t6697 = t1375 * t2324;
  t6704 = -t3755 * t829 / 0.1296e4 - t3760 * t829 / 0.1296e4 - t3763 * t823 / 0.216e3 - t3785 * t823 / 0.216e3 - t3789 * t829 / 0.648e3 - t3792 * t829 / 0.648e3 + t1366 * t2321 / 0.972e3 + t6697 / 0.486e3 + t1363 * t2321 / 0.486e3 + t1369 * t2324 / 0.162e3 - t6374 / 0.3888e4 + t6377;
  t6718 = -t6378 / 0.1944e4 + t6381 - t6382 / 0.648e3 + t6385 - 0.3e1 / 0.8e1 * t168 * t2407 - 0.3e1 / 0.8e1 * t461 * t809 + t6391 + t6392 / 0.24e2 - t6395 - t6396 / 0.96e2 - t1875 * t735 / 0.6e1 + t474 * t2345 / 0.24e2;
  t6725 = t473 * t2354;
  t6730 = t1295 * t826;
  t6732 = t1298 * t826;
  t6734 = t477 * t2354;
  t6735 = t6734 * t221;
  t6737 = t5414 * t270;
  t6739 = t478 * t2345;
  t6741 = t5417 * t270;
  t6743 = t1870 * t735;
  t6745 = t5444 * t270 / 0.8e1 - t1288 * t826 / 0.32e2 - t1291 * t826 / 0.32e2 - t6725 * t221 / 0.6e1 + t5441 * t270 / 0.8e1 - t6730 / 0.96e2 - t6732 / 0.96e2 - t6735 / 0.18e2 + t6737 / 0.24e2 + t6739 / 0.72e2 + t6741 / 0.24e2 - t6743 / 0.18e2;
  t6749 = my_piecewise3(t65, 0, t6585 + t6613 + t6639 + t6664 + t6682 + t6704 + t6718 + t6745);
  tv4rho2sigma211 = t6 * t6749 + t2297 + t2440;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t6768 = -t6406 / 0.4e1 + t5970 - t1275 * t789 / 0.96e2 + t5244 * t252 / 0.24e2 - t3436 * t780 / 0.216e3 - t3430 * t786 / 0.648e3 - t3433 * t786 / 0.1296e4 - t3467 * t776 / 0.72e2 - t6437 / 0.108e3 + t6070 - t6472 / 0.144e3 + t6476 / 0.36e2 - t6190;
  t6780 = t6196 - t6492 / 0.1944e4 - t6494 / 0.324e3 - t6498 / 0.972e3 + t6204 + t6206 + t6208 - 0.3e1 / 0.8e1 * t503 * t766 + t6294 - t6296 - t6542 / 0.48e2 + t6546 / 0.12e2 + t5262 * t249 / 0.8e1 - t1272 * t783 / 0.32e2;
  t6782 = my_piecewise3(t1, 0, t6768 + t6780);
  tv4rho2sigma212 = t6 * t6782 + 0.2e1 * t2318;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t6792 = 0.1e1 / t77 / t1447;
  t6793 = t227 * t6792;
  t6797 = t520 * t6792;
  t6804 = t1456 * t6792;
  t6830 = t509 * t2416;
  t6834 = t215 * t2405 * t98;
  t6837 = -t6563 / 0.4e1 - t6565 / 0.4e1 + t6348 - 0.2e1 / 0.27e2 * t4376 * t2430 - 0.2e1 / 0.27e2 * t4380 * t2430 - 0.16e2 / 0.729e3 * t1543 * t6793 * t4194 - 0.16e2 / 0.2187e4 * t725 * t6797 * t4238 - 0.8e1 / 0.2187e4 * t725 * t6793 * t4238 - 0.16e2 / 0.6561e4 * t219 * t6804 * t4223 + t5777 * t273 / 0.12e2 + t5785 * t273 / 0.24e2 - 0.16e2 / 0.6561e4 * t219 * t6797 * t4223 - 0.16e2 / 0.19683e5 * t225 * t4228 * t6792 * t4218 - 0.8e1 / 0.6561e4 * t225 * t6804 * t4218 + t591 * t2411 / 0.36e2 + t595 * t2411 / 0.36e2 - t2099 * t745 / 0.9e1 - t2103 * t745 / 0.9e1 - t6830 * t229 / 0.9e1 - t6834 * t229 / 0.9e1;
  t6873 = t797 * t562;
  t6874 = t6873 * t206;
  t6883 = 0.19e2 / 0.81e2 * t1543 * t2427 * t2024 * t28 - 0.16e2 / 0.19683e5 * t219 * t6793 * t4223 - 0.44e2 / 0.59049e5 * t225 * t6797 * t4218 - 0.4e1 / 0.19683e5 * t225 * t6793 * t4218 - t1530 * t832 / 0.96e2 - t1533 * t832 / 0.48e2 - t1537 * t832 / 0.96e2 - 0.1e2 / 0.27e2 * t2420 * t2078 + 0.4e1 / 0.27e2 * t509 * t2039 * t729 + 0.4e1 / 0.27e2 * t215 * t5672 * t729 + 0.16e2 / 0.81e2 * t5760 * t2096 + t5774 * t273 / 0.24e2 + 0.7e1 / 0.54e2 * t2417 * t587 + 0.7e1 / 0.54e2 * t718 * t2072 - 0.7e1 / 0.216e3 * t225 * t228 * t6874 + t6579 / 0.36e2 - 0.2e1 / 0.81e2 * t6581 - t6583 / 0.144e3 - t6586 / 0.27e2 - t6589 / 0.27e2;
  t6913 = t816 * t525;
  t6914 = t6913 * t530;
  t6922 = t215 * t2416 * t520;
  t6926 = t215 * t2416 * t227;
  t6929 = 0.4e1 / 0.81e2 * t6592 + t6594 / 0.108e3 + t1569 * t2324 / 0.81e2 - t4048 * t829 / 0.648e3 + t1583 * t2321 / 0.486e3 + t1566 * t2321 / 0.486e3 - t4071 * t829 / 0.1296e4 - t4040 * t829 / 0.648e3 - t4052 * t829 / 0.1296e4 - t4065 * t823 / 0.216e3 - t4034 * t823 / 0.108e3 - t4044 * t823 / 0.216e3 - t4068 * t829 / 0.648e3 - t4037 * t829 / 0.324e3 + t1580 * t2321 / 0.243e3 - 0.7e1 / 0.2916e4 * t535 * t6914 + t1573 * t2324 / 0.81e2 + t1576 * t2321 / 0.243e3 - 0.8e1 / 0.729e3 * t6922 * t531 - 0.4e1 / 0.729e3 * t6926 * t531;
  t6931 = t215 * t2354 * t227;
  t6955 = t260 * t2002;
  t6956 = t6955 * t1451;
  t6959 = t6955 * t1462;
  t6968 = -0.8e1 / 0.243e3 * t6931 * t541 - 0.7e1 / 0.486e3 * t539 * t6913 * t540 - 0.7e1 / 0.1458e4 * t522 * t6914 + t6605 / 0.729e3 - t6607 / 0.1944e4 + t6609 / 0.1458e4 - t6611 / 0.1944e4 - t6615 / 0.324e3 - t6617 / 0.972e3 - t6619 / 0.972e3 - t6621 / 0.324e3 - 0.2e1 / 0.729e3 * t4161 * t2365 - 0.2e1 / 0.729e3 * t1576 * t2365 - 0.2e1 / 0.729e3 * t4167 * t2365 - 0.2e1 / 0.729e3 * t1580 * t2365 + 0.19e2 / 0.1458e4 * t539 * t6956 + 0.19e2 / 0.2187e4 * t522 * t6959 + 0.19e2 / 0.6561e4 * t535 * t6959 - 0.2e1 / 0.2187e4 * t1583 * t2365 - 0.2e1 / 0.2187e4 * t1566 * t2365;
  t7012 = t1436 * t2360 / 0.27e2 + t1441 * t2360 / 0.27e2 + 0.19e2 / 0.243e3 * t1473 * t6955 * t1474 - 0.2e1 / 0.81e2 * t4145 * t2378 - 0.2e1 / 0.243e3 * t4148 * t2381 - t1569 * t2381 / 0.243e3 - 0.2e1 / 0.81e2 * t4154 * t2378 - 0.2e1 / 0.243e3 * t4158 * t2381 + 0.16e2 / 0.729e3 * t5916 * t2034 + 0.16e2 / 0.2187e4 * t5920 * t2005 + 0.16e2 / 0.2187e4 * t1953 * t2005 + 0.2e1 / 0.243e3 * t5829 * t742 + 0.2e1 / 0.243e3 * t5834 * t742 + 0.8e1 / 0.729e3 * t1961 * t2034 + 0.16e2 / 0.6561e4 * t1957 * t2005 - t4176 * t819 / 0.72e2 - t4179 * t819 / 0.36e2 - t4184 * t819 / 0.72e2 - t1573 * t2381 / 0.243e3 - 0.1e2 / 0.243e3 * t1953 * t1993;
  t7018 = t807 * t578;
  t7020 = t215 * t7018 * t99;
  t7048 = -0.5e1 / 0.243e3 * t1957 * t1993 - 0.7e1 / 0.162e3 * t581 * t816 * t583 - 0.8e1 / 0.81e2 * t7020 * t584 + 0.4e1 / 0.81e2 * t5823 * t732 + 0.4e1 / 0.81e2 * t5808 * t732 + 0.16e2 / 0.243e3 * t5678 * t2027 + 0.4e1 / 0.243e3 * t5826 * t742 + 0.4e1 / 0.243e3 * t5812 * t742 - 0.1e2 / 0.81e2 * t1961 * t1996 + 0.19e2 / 0.2187e4 * t1458 * t6959 + 0.19e2 / 0.729e3 * t1446 * t6956 + 0.4e1 / 0.243e3 * t6623 - t6625 / 0.729e3 - 0.2e1 / 0.2187e4 * t6627 - 0.2e1 / 0.2187e4 * t6629 - t6631 / 0.108e3 - 0.2e1 / 0.243e3 * t6633 - 0.2e1 / 0.729e3 * t6635 + 0.2e1 / 0.729e3 * t6637 - t6640 / 0.108e3;
  t7079 = t6642 / 0.81e2 - 0.2e1 / 0.6561e4 * t6644 + 0.4e1 / 0.729e3 * t6646 + t6354 - t6676 / 0.144e3 + t6678 / 0.36e2 - t6362 + t6366 + t6697 / 0.243e3 + t6377 + t6381 + t6385 - 0.3e1 / 0.8e1 * t554 * t809 - 0.3e1 / 0.4e1 * t194 * t2407 - 0.3e1 / 0.8e1 * t74 * t27 * (-0.7e1 / 0.243e3 * t130 * t6874 - 0.14e2 / 0.2187e4 * t335 * t802 * t525 * t528 + 0.152e3 / 0.19683e5 * t2401 * t2003 - 0.32e2 / 0.177147e6 * t2975 * t6792 * t4310) * t100 + t6391 - t6395 - t6730 / 0.48e2 - t6732 / 0.48e2 - t6735 / 0.9e1;
  t7106 = t509 * t2354;
  t7110 = t215 * t2405 * t217;
  t7122 = t6737 / 0.12e2 + t6739 / 0.36e2 + t6741 / 0.12e2 - t6743 / 0.9e1 - t1966 * t735 / 0.3e1 - t1970 * t735 / 0.3e1 - 0.16e2 / 0.243e3 * t4386 * t99 * t6792 * t4193 + t510 * t2345 / 0.12e2 + t514 * t2345 / 0.12e2 + t5868 * t270 / 0.4e1 + t5871 * t270 / 0.8e1 - t1411 * t826 / 0.32e2 - t1414 * t826 / 0.16e2 - t1417 * t826 / 0.32e2 - t7106 * t221 / 0.3e1 - t7110 * t221 / 0.3e1 + t5865 * t270 / 0.8e1 + 0.7e1 / 0.18e2 * t2355 * t598 + 0.7e1 / 0.18e2 * t714 * t1982 - 0.7e1 / 0.72e2 * t219 * t220 * t6873;
  t7126 = my_piecewise3(t65, 0, t6837 + t6883 + t6929 + t6968 + t7012 + t7048 + t7079 + t7122);
  tv4rho2sigma217 = t6 * t7126 + 0.2e1 * t2440;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t7151 = 0.1e1 / t33 / t1634;
  t7152 = t759 * t7151;
  t7153 = t7152 * t2864;
  t7156 = t7152 * t2898;
  t7159 = -t4680 * t776 / 0.24e2 - t4696 * t776 / 0.24e2 - t4667 * t2168 / 0.243e3 - t1774 * t2168 / 0.243e3 - t1770 * t2191 / 0.162e3 - t1778 * t2168 / 0.729e3 + t841 * t2453 / 0.48e2 + t1067 * t2453 / 0.48e2 - t4657 * t2188 / 0.27e2 + t2882 * t2460 / 0.1944e4 + t2770 * t2460 / 0.1944e4 + 0.2e1 / 0.2187e4 * t2862 * t7153 + 0.2e1 / 0.6561e4 * t2894 * t7156;
  t7173 = t2804 * t2460 / 0.5832e4;
  t7187 = t867 * t7156 / 0.2187e4 + t1028 * t2460 / 0.1944e4 + t1046 * t2460 / 0.1944e4 + 0.2e1 / 0.2187e4 * t857 * t7153 + 0.11e2 / 0.39366e5 * t313 * t7156 - t4661 * t2191 / 0.81e2 + t7173 + t6238 * t647 / 0.27e2 + t6242 * t659 / 0.81e2 + t6248 * t659 / 0.162e3 + t2873 * t2479 / 0.216e3 + t2790 * t2479 / 0.216e3 + 0.2e1 / 0.243e3 * t2842 * t7152 * t2848;
  t7189 = t7152 * t2855;
  t7211 = t2801 * t2482 / 0.1944e4;
  t7213 = t1025 * t2482 / 0.3888e4;
  t7215 = t4691 * t776 / 0.72e2;
  t7216 = 0.2e1 / 0.729e3 * t2853 * t7189 + t848 * t7189 / 0.729e3 + t2876 * t2482 / 0.648e3 + t2766 * t2482 / 0.648e3 + t1022 * t2482 / 0.1296e4 + t1057 * t2482 / 0.1296e4 + t1049 * t2460 / 0.5832e4 + t1053 * t2460 / 0.5832e4 + 0.2e1 / 0.6561e4 * t301 * t7153 + t322 * t7156 / 0.13122e5 + t7211 + t7213 - t7215;
  t7220 = t2879 * t2479 / 0.648e3;
  t7222 = t1037 * t2460 / 0.5832e4;
  t7224 = t1042 * t2460 / 0.17496e5;
  t7226 = t844 * t2453 / 0.144e3;
  t7237 = t143 * t2517 * t58;
  t7246 = t1656 * t2181 / 0.18e2 + t7220 + t7222 + t7224 + t7226 - t373 * t2444 * t643 / 0.36e2 - t1766 * t789 / 0.32e2 + t6138 * t252 / 0.16e2 + t631 * t2225 / 0.24e2 - t7237 * t157 / 0.18e2 + t6142 * t252 / 0.16e2 + t3031 * t2494 / 0.72e2 + t3028 * t2494 / 0.72e2;
  t7267 = t3034 * t2494 / 0.216e3;
  t7269 = t6178 * t252 / 0.48e2;
  t7273 = t385 * t2469 / 0.192e3;
  t7274 = t2466 * t132;
  t7275 = t7274 * t134;
  t7280 = t1762 * t789 / 0.96e2;
  t7283 = 0.2e1 / 0.81e2 * t3012 * t59 * t759 * t7151 * M_PI * t43 + t143 * t6057 * t644 / 0.9e1 + t382 * t2469 / 0.64e2 + t389 * t2469 / 0.64e2 - t4804 * t2242 / 0.9e1 - t1722 * t789 / 0.32e2 + t7267 + t7269 - t2250 * t662 / 0.12e2 + t7273 - t153 * t156 * t7275 / 0.48e2 - t7280 + t1049 * t2446 / 0.864e3;
  t7285 = t1037 * t2446 / 0.1296e4;
  t7287 = t1025 * t2502 / 0.432e3;
  t7289 = t4418 * t786 / 0.1296e4;
  t7293 = t4412 * t780 / 0.216e3;
  t7297 = t1042 * t2446 / 0.2592e4;
  t7298 = t2444 * t124;
  t7299 = t7298 * t317;
  t7303 = t4415 * t786 / 0.648e3;
  t7313 = t7285 + t7287 - t7289 + t1778 * t2119 / 0.324e3 - t7293 + t1770 * t2126 / 0.54e2 + t7297 - t322 * t7299 / 0.648e3 - t7303 + t1774 * t2119 / 0.162e3 - t301 * t7298 * t306 / 0.108e3 - t313 * t7299 / 0.324e3 + t1053 * t2446 / 0.864e3;
  t7355 = t26 * t117 * t2517 * t60 / 0.8e1;
  t7356 = -t4406 * t786 / 0.216e3 - t4426 * t786 / 0.216e3 - t4409 * t786 / 0.432e3 - t4430 * t786 / 0.432e3 - t4403 * t780 / 0.72e2 - t4422 * t780 / 0.72e2 + t1022 * t2502 / 0.144e3 + t1057 * t2502 / 0.144e3 + t1028 * t2446 / 0.432e3 + t1046 * t2446 / 0.432e3 - 0.3e1 / 0.8e1 * t113 * t2519 - 0.3e1 / 0.8e1 * t26 * t27 * (-t130 * t7275 / 0.54e2 - t335 * t2443 * t124 * t315 / 0.243e3 + 0.4e1 / 0.59049e5 * t2975 * t759 * t7151 * t2979) * t60 - t7355;
  t7370 = t143 * t2517 * t145;
  t7374 = t1620 * t783 / 0.32e2;
  t7378 = t297 * t2497 / 0.64e2;
  t7383 = t6285 * t249 / 0.16e2;
  t7386 = -0.3e1 / 0.32e2 * t1601 * t783 - 0.3e1 / 0.32e2 * t1624 * t783 + 0.3e1 / 0.64e2 * t287 * t2497 + 0.3e1 / 0.64e2 * t281 * t2497 + 0.3e1 / 0.16e2 * t6319 * t249 + 0.3e1 / 0.16e2 * t6323 * t249 - t7370 * t149 / 0.6e1 - t7374 + t627 * t2151 / 0.8e1 + t7378 - t147 * t148 * t7274 / 0.16e2 + t7383 - t2155 * t650 / 0.4e1;
  t7390 = my_piecewise3(t1, 0, t7159 + t7187 + t7216 + t7246 + t7283 + t7313 + t7356 + t7386);
  tv4rhosigma30 = t6 * t7390 + t2524;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t7393 = t1304 * t2555 / 0.144e3;
  t7395 = t3877 * t2559 / 0.1944e4;
  t7397 = t1375 * t2559 / 0.3888e4;
  t7414 = t7393 + t7395 + t7397 + t1307 * t2555 / 0.48e2 + t3898 * t2559 / 0.648e3 + t3887 * t2580 / 0.216e3 + t1369 * t2559 / 0.1296e4 + t3856 * t2565 / 0.1944e4 + t1363 * t2565 / 0.1944e4 + t1366 * t2565 / 0.5832e4 - t5454 * t819 / 0.24e2;
  t7416 = t1372 * t2565 / 0.17496e5;
  t7418 = t5494 * t819 / 0.72e2;
  t7420 = t3862 * t2580 / 0.648e3;
  t7422 = t3880 * t2565 / 0.5832e4;
  t7424 = t1360 * t2565 / 0.5832e4;
  t7426 = t484 * t2571 / 0.192e3;
  t7428 = t1911 * t832 / 0.96e2;
  t7430 = t6588 * t273 / 0.48e2;
  t7432 = t3964 * t2540 / 0.216e3;
  t7437 = t7416 - t7418 + t7420 + t7422 + t7424 + t7426 - t7428 + t7430 + t7432 + t3995 * t2540 / 0.72e2 + t481 * t2571 / 0.64e2;
  t7452 = t1360 * t2546 / 0.1296e4;
  t7454 = t5392 * t829 / 0.1296e4;
  t7456 = t1375 * t2585 / 0.432e3;
  t7458 = t5395 * t823 / 0.216e3;
  t7460 = t5380 * t829 / 0.648e3;
  t7461 = -t1926 * t832 / 0.32e2 + t6576 * t273 / 0.16e2 - t5386 * t829 / 0.432e3 + t1366 * t2546 / 0.864e3 - t5389 * t823 / 0.72e2 - t5383 * t829 / 0.216e3 + t7452 - t7454 + t7456 - t7458 - t7460;
  t7463 = t1372 * t2546 / 0.2592e4;
  t7471 = t74 * t117 * t2600 * t100 / 0.8e1;
  t7481 = t6734 * t270 / 0.16e2;
  t7483 = t478 * t2529 / 0.64e2;
  t7485 = t1870 * t826 / 0.32e2;
  t7486 = t7463 + t1369 * t2585 / 0.144e3 + t1363 * t2546 / 0.432e3 - t7471 - 0.3e1 / 0.8e1 * t168 * t2602 + 0.3e1 / 0.64e2 * t474 * t2529 - 0.3e1 / 0.32e2 * t1875 * t826 + 0.3e1 / 0.16e2 * t6725 * t270 + t7481 + t7483 - t7485;
  t7489 = my_piecewise3(t65, 0, t7414 + t7437 + t7461 + t7486);
  tv4rhosigma39 = t6 * t7489 + t2607;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t7507 = t1179 * t2482 / 0.1296e4 + t1110 * t2453 / 0.48e2 + t3223 * t2460 / 0.1944e4 + t1182 * t2460 / 0.1944e4 + t1185 * t2460 / 0.5832e4 - t5039 * t776 / 0.24e2 + t3215 * t2479 / 0.216e3 + t3218 * t2482 / 0.648e3 + t7173 + t7211 + t7213;
  t7516 = -t7215 + t7220 + t7222 + t7224 + t7226 + t6469 * t252 / 0.16e2 + t3331 * t2494 / 0.72e2 + t443 * t2469 / 0.64e2 - t1847 * t789 / 0.32e2 + t7267 + t7269;
  t7530 = t7273 - t7280 + t1179 * t2502 / 0.144e3 + t1182 * t2446 / 0.432e3 - t4913 * t780 / 0.72e2 + t1185 * t2446 / 0.864e3 - t4916 * t786 / 0.216e3 - t4919 * t786 / 0.432e3 + t7285 + t7287 - t7289;
  t7539 = -t7293 + t7297 - t7303 - 0.3e1 / 0.8e1 * t184 * t2519 - t7355 - t7374 + t7378 + t7383 - 0.3e1 / 0.32e2 * t1815 * t783 + 0.3e1 / 0.64e2 * t440 * t2497 + 0.3e1 / 0.16e2 * t6548 * t249;
  t7542 = my_piecewise3(t1, 0, t7507 + t7516 + t7530 + t7539);
  tv4rhosigma310 = t6 * t7542 + t2524;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t7548 = t2544 * t199;
  t7549 = t7548 * t530;
  t7573 = t1953 * t2321 / 0.162e3 + t1957 * t2321 / 0.324e3 - t535 * t7549 / 0.648e3 - t1961 * t2381 / 0.162e3 - t5920 * t2365 / 0.243e3 - t1953 * t2365 / 0.243e3 - t581 * t2544 * t728 / 0.36e2 + t6931 * t732 / 0.27e2 + t6922 * t742 / 0.81e2 - t1957 * t2365 / 0.729e3 + t1436 * t2555 / 0.48e2 + t1441 * t2555 / 0.48e2 + t4148 * t2559 / 0.648e3;
  t7577 = 0.1e1 / t77 / t2001;
  t7578 = t802 * t7577;
  t7579 = t7578 * t4238;
  t7582 = t7578 * t4223;
  t7599 = t7578 * t4218;
  t7606 = t4158 * t2559 / 0.648e3 + 0.2e1 / 0.729e3 * t4245 * t7579 + 0.2e1 / 0.2187e4 * t4249 * t7582 + 0.2e1 / 0.2187e4 * t1446 * t7582 + t1569 * t2559 / 0.1296e4 + t1573 * t2559 / 0.1296e4 + t1473 * t7579 / 0.729e3 + 0.2e1 / 0.6561e4 * t539 * t7582 + t4161 * t2565 / 0.1944e4 + t4167 * t2565 / 0.1944e4 + 0.2e1 / 0.6561e4 * t4230 * t7599 + t1458 * t7599 / 0.2187e4 + t6926 * t742 / 0.162e3;
  t7635 = t2041 * t2360 / 0.18e2 + 0.2e1 / 0.243e3 * t4188 * t7578 * t4194 - t5678 * t2378 / 0.27e2 - t5916 * t2381 / 0.81e2 + t4145 * t2580 / 0.216e3 + t4154 * t2580 / 0.216e3 + t1576 * t2565 / 0.1944e4 + t1580 * t2565 / 0.1944e4 + 0.11e2 / 0.39366e5 * t522 * t7599 + t1583 * t2565 / 0.5832e4 + t1566 * t2565 / 0.5832e4 + t535 * t7599 / 0.13122e5 - t5669 * t819 / 0.24e2;
  t7639 = t215 * t2600 * t98;
  t7648 = -t5674 * t819 / 0.24e2 + t7393 + t7395 + t7397 + t7416 - t7418 + t7420 + t7422 + t7424 - t7639 * t229 / 0.18e2 + t6830 * t273 / 0.16e2 + t6834 * t273 / 0.16e2 + t718 * t2411 / 0.24e2;
  t7651 = t2527 * t204;
  t7652 = t7651 * t206;
  t7681 = -t225 * t228 * t7652 / 0.48e2 - t2417 * t745 / 0.12e2 + t4376 * t2540 / 0.72e2 + t4380 * t2540 / 0.72e2 + 0.2e1 / 0.81e2 * t4386 * t99 * t802 * t7577 * M_PI * t43 + t591 * t2571 / 0.64e2 + t595 * t2571 / 0.64e2 - t5760 * t2430 / 0.9e1 - t2099 * t832 / 0.32e2 - t2103 * t832 / 0.32e2 + t215 * t7018 * t729 / 0.9e1 + t7426 - t7428;
  t7705 = t7430 + t7432 - t5812 * t829 / 0.216e3 - t5829 * t829 / 0.432e3 - t5834 * t829 / 0.432e3 - t539 * t7548 * t540 / 0.108e3 + t1961 * t2324 / 0.54e2 + t1583 * t2546 / 0.864e3 + t1566 * t2546 / 0.864e3 - t5823 * t823 / 0.72e2 - t5808 * t823 / 0.72e2 - t5826 * t829 / 0.216e3 + t1569 * t2585 / 0.144e3;
  t7732 = t1573 * t2585 / 0.144e3 + t1576 * t2546 / 0.432e3 + t1580 * t2546 / 0.432e3 - t522 * t7549 / 0.324e3 + t7452 - t7454 + t7456 - t7458 - t7460 + t7463 - 0.3e1 / 0.8e1 * t194 * t2602 - 0.3e1 / 0.8e1 * t74 * t27 * (-t130 * t7652 / 0.54e2 - t335 * t2543 * t199 * t528 / 0.243e3 + 0.4e1 / 0.59049e5 * t2975 * t802 * t7577 * t4310) * t100 - t7471;
  t7741 = t215 * t2600 * t217;
  t7756 = t7481 + t7483 - t7485 - t2355 * t735 / 0.4e1 - t219 * t220 * t7651 / 0.16e2 + t714 * t2345 / 0.8e1 - t7741 * t221 / 0.6e1 + 0.3e1 / 0.64e2 * t510 * t2529 + 0.3e1 / 0.64e2 * t514 * t2529 - 0.3e1 / 0.32e2 * t1966 * t826 - 0.3e1 / 0.32e2 * t1970 * t826 + 0.3e1 / 0.16e2 * t7106 * t270 + 0.3e1 / 0.16e2 * t7110 * t270;
  t7760 = my_piecewise3(t65, 0, t7573 + t7606 + t7635 + t7648 + t7681 + t7705 + t7732 + t7756);
  tv4rhosigma319 = t6 * t7760 + t2607;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t7768 = t2442 * sigma[0];
  t7769 = 0.1e1 / t7768;
  t7770 = t30 * t7769;
  t7771 = t7770 * t36;
  t7772 = t7771 * t317;
  t7790 = -t6238 * t780 / 0.36e2 + t1770 * t2502 / 0.36e2 + t1774 * t2446 / 0.108e3 - 0.5e1 / 0.1728e4 * t322 * t7772 - 0.5e1 / 0.288e3 * t301 * t7771 * t306 - 0.5e1 / 0.864e3 * t313 * t7772 + t1778 * t2446 / 0.216e3 - t6242 * t786 / 0.108e3 - t6248 * t786 / 0.216e3 + t4667 * t2460 / 0.486e3 + t1774 * t2460 / 0.486e3;
  t7797 = t2466 * t2458;
  t7803 = t2443 * t2753;
  t7804 = t7803 * t2864;
  t7807 = t7803 * t2898;
  t7812 = t7797 * t858;
  t7815 = t7797 * t871;
  t7824 = t1770 * t2482 / 0.324e3 + t1778 * t2460 / 0.1458e4 + t1656 * t2453 / 0.12e2 - t848 * t7797 * t852 / 0.72e2 + t4657 * t2479 / 0.54e2 - t2862 * t7804 / 0.2916e4 - t2894 * t7807 / 0.8748e4 - t867 * t7807 / 0.5832e4 - t857 * t7812 / 0.216e3 - t867 * t7815 / 0.648e3 - 0.5e1 / 0.96e2 * t373 * t7770 * t775 - t2842 * t7803 * t2848 / 0.324e3;
  t7826 = t7803 * t2855;
  t7849 = -t2853 * t7826 / 0.972e3 - t848 * t7826 / 0.1944e4 - t857 * t7804 / 0.2916e4 - 0.11e2 / 0.104976e6 * t313 * t7807 - t301 * t7804 / 0.8748e4 - t322 * t7807 / 0.34992e5 - t6059 * t776 / 0.12e2 - t301 * t7812 / 0.432e3 - t313 * t7815 / 0.648e3 - t322 * t7815 / 0.1944e4 + t4661 * t2482 / 0.162e3;
  t7852 = 0.1e1 / t44 / t7768 * t47;
  t7853 = t7852 * t134;
  t7902 = -0.3e1 / 0.8e1 * t26 * t27 * (-0.5e1 / 0.144e3 * t130 * t7853 - 0.5e1 / 0.648e3 * t335 * t7769 * t36 * t315 - t926 * t2466 * t2514 / 0.729e3 - t2975 * t2443 * t2753 * t2979 / 0.39366e5) * t60 + t631 * t2469 / 0.16e2 + t4804 * t2494 / 0.18e2 - t2250 * t789 / 0.16e2 + t7237 * t252 / 0.12e2 - t3012 * t59 * t2443 * t2753 * M_PI * t43 / 0.108e3 - 0.5e1 / 0.128e3 * t153 * t156 * t7853 - t1010 * t59 * t2466 * t2493 / 0.24e2 + 0.3e1 / 0.16e2 * t627 * t2497 - 0.15e2 / 0.128e3 * t147 * t148 * t7852 - 0.3e1 / 0.16e2 * t2155 * t783 + t7370 * t249 / 0.4e1;
  t7905 = my_piecewise3(t1, 0, t7790 + t7824 + t7849 + t7902);
  tv4sigma40 = t6 * t7905;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t7908 = t2525 * sigma[2];
  t7909 = 0.1e1 / t7908;
  t7910 = t30 * t7909;
  t7911 = t7910 * t80;
  t7912 = t7911 * t530;
  t7935 = t1953 * t2546 / 0.108e3 - 0.5e1 / 0.1728e4 * t535 * t7912 - 0.5e1 / 0.864e3 * t522 * t7912 - 0.5e1 / 0.288e3 * t539 * t7911 * t540 - t6931 * t823 / 0.36e2 - t6922 * t829 / 0.108e3 - t6926 * t829 / 0.216e3 + t1961 * t2585 / 0.36e2 + t1957 * t2546 / 0.216e3 + t1957 * t2565 / 0.1458e4 - 0.5e1 / 0.96e2 * t581 * t7910 * t818;
  t7936 = t2543 * t4107;
  t7937 = t7936 * t4238;
  t7940 = t7936 * t4223;
  t7949 = t7936 * t4218;
  t7959 = t2527 * t2537;
  t7960 = t7959 * t1451;
  t7963 = t7959 * t1462;
  t7968 = -t4245 * t7937 / 0.972e3 - t4249 * t7940 / 0.2916e4 - t1446 * t7940 / 0.2916e4 - t1473 * t7937 / 0.1944e4 - t539 * t7940 / 0.8748e4 - t4230 * t7949 / 0.8748e4 - t1458 * t7949 / 0.5832e4 + t2041 * t2555 / 0.12e2 - t4188 * t7936 * t4194 / 0.324e3 - t539 * t7960 / 0.432e3 - t522 * t7963 / 0.648e3 - t535 * t7963 / 0.1944e4;
  t7993 = t5678 * t2580 / 0.54e2 + t5916 * t2559 / 0.162e3 + t1961 * t2559 / 0.324e3 + t5920 * t2565 / 0.486e3 + t1953 * t2565 / 0.486e3 - t1458 * t7963 / 0.648e3 - t1446 * t7960 / 0.216e3 - 0.11e2 / 0.104976e6 * t522 * t7949 - t535 * t7949 / 0.34992e5 - t7020 * t819 / 0.12e2 - t1473 * t7959 * t1474 / 0.72e2;
  t7996 = 0.1e1 / t84 / t7908 * t87;
  t7997 = t7996 * t206;
  t8046 = -0.3e1 / 0.8e1 * t74 * t27 * (-0.5e1 / 0.144e3 * t130 * t7997 - 0.5e1 / 0.648e3 * t335 * t7909 * t80 * t528 - t926 * t2527 * t2597 / 0.729e3 - t2975 * t2543 * t4107 * t4310 / 0.39366e5) * t100 + t5760 * t2540 / 0.18e2 - t4386 * t99 * t2543 * t4107 * M_PI * t43 / 0.108e3 + t718 * t2571 / 0.16e2 + t7639 * t273 / 0.12e2 - 0.5e1 / 0.128e3 * t225 * t228 * t7997 - t1543 * t99 * t2527 * t2539 / 0.24e2 - t2417 * t832 / 0.16e2 - 0.15e2 / 0.128e3 * t219 * t220 * t7996 + 0.3e1 / 0.16e2 * t714 * t2529 - 0.3e1 / 0.16e2 * t2355 * t826 + t7741 * t270 / 0.4e1;
  t8049 = my_piecewise3(t65, 0, t7935 + t7968 + t7993 + t8046);
  tv4sigma414 = t6 * t8049;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

