/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_sogga11.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t40, t41, t43;
  double t45, t46, t48, t49, t51, t52, t54, t58;
  double t59, t60, t62, t63, t65, t66, t68, t69;
  double t71, t74, t78, tzk0;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t21 = params->a[1];
  t22 = M_CBRT6;
  t23 = params->mu * t22;
  t24 = M_PI * M_PI;
  t25 = POW_1_3(t24);
  t26 = t25 * t25;
  t27 = 0.1e1 / t26;
  t28 = t23 * t27;
  t29 = 0.1e1 / params->kappa;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = t32 * t36;
  t40 = t28 * t30 * t37 / 0.24e2;
  t41 = 0.1e1 + t40;
  t43 = 0.1e1 - 0.1e1 / t41;
  t45 = params->a[2];
  t46 = t43 * t43;
  t48 = params->a[3];
  t49 = t46 * t43;
  t51 = params->a[4];
  t52 = t46 * t46;
  t54 = params->a[5];
  t58 = params->b[1];
  t59 = exp(-t40);
  t60 = 0.1e1 - t59;
  t62 = params->b[2];
  t63 = t60 * t60;
  t65 = params->b[3];
  t66 = t63 * t60;
  t68 = params->b[4];
  t69 = t63 * t63;
  t71 = params->b[5];
  t74 = t54 * t52 * t43 + t71 * t69 * t60 + t21 * t43 + t45 * t46 + t48 * t49 + t51 * t52 + t58 * t60 + t62 * t63 + t65 * t66 + t68 * t69 + params->a[0] + params->b[0];
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t40, t41, t43;
  double t45, t46, t48, t49, t51, t52, t54, t58;
  double t59, t60, t62, t63, t65, t66, t68, t69;
  double t71, t74, t78, tzk0;

  double t80, t84, t85, t87, t88, t89, t90, t92;
  double t94, t97, t98, t99, t100, t103, t104, t107;
  double t108, t111, t112, t116, t117, t118, t119, t120;
  double t123, t124, t127, t128, t131, t132, t135, t136;
  double t139, t144, tvrho0, t150, t151, t153, t156, t159;
  double t162, t169, t171, t174, t177, t180, t183, t187;
  double tvsigma0;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t21 = params->a[1];
  t22 = M_CBRT6;
  t23 = params->mu * t22;
  t24 = M_PI * M_PI;
  t25 = POW_1_3(t24);
  t26 = t25 * t25;
  t27 = 0.1e1 / t26;
  t28 = t23 * t27;
  t29 = 0.1e1 / params->kappa;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = t32 * t36;
  t40 = t28 * t30 * t37 / 0.24e2;
  t41 = 0.1e1 + t40;
  t43 = 0.1e1 - 0.1e1 / t41;
  t45 = params->a[2];
  t46 = t43 * t43;
  t48 = params->a[3];
  t49 = t46 * t43;
  t51 = params->a[4];
  t52 = t46 * t46;
  t54 = params->a[5];
  t58 = params->b[1];
  t59 = exp(-t40);
  t60 = 0.1e1 - t59;
  t62 = params->b[2];
  t63 = t60 * t60;
  t65 = params->b[3];
  t66 = t63 * t60;
  t68 = params->b[4];
  t69 = t63 * t63;
  t71 = params->b[5];
  t74 = t54 * t52 * t43 + t71 * t69 * t60 + t21 * t43 + t45 * t46 + t48 * t49 + t51 * t52 + t58 * t60 + t62 * t63 + t65 * t66 + t68 * t69 + params->a[0] + params->b[0];
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t34;
  t84 = t41 * t41;
  t85 = 0.1e1 / t84;
  t87 = t21 * t85 * t23;
  t88 = t27 * t29;
  t89 = sigma[0] * t32;
  t90 = t33 * rho[0];
  t92 = 0.1e1 / t34 / t90;
  t94 = t88 * t89 * t92;
  t97 = t45 * t43;
  t98 = t85 * params->mu;
  t99 = t98 * t22;
  t100 = t97 * t99;
  t103 = t48 * t46;
  t104 = t103 * t99;
  t107 = t51 * t49;
  t108 = t107 * t99;
  t111 = t54 * t52;
  t112 = t111 * t99;
  t116 = t22 * t27;
  t117 = t58 * params->mu * t116;
  t118 = t32 * t92;
  t119 = t118 * t59;
  t120 = t30 * t119;
  t123 = t62 * t60;
  t124 = t123 * t28;
  t127 = t65 * t63;
  t128 = t127 * t28;
  t131 = t68 * t66;
  t132 = t131 * t28;
  t135 = t71 * t69;
  t136 = t135 * t28;
  t139 = -t87 * t94 / 0.9e1 - 0.2e1 / 0.9e1 * t100 * t94 - t104 * t94 / 0.3e1 - 0.4e1 / 0.9e1 * t108 * t94 - 0.5e1 / 0.9e1 * t112 * t94 - t117 * t120 / 0.9e1 - 0.2e1 / 0.9e1 * t124 * t120 - t128 * t120 / 0.3e1 - 0.4e1 / 0.9e1 * t132 * t120 - 0.5e1 / 0.9e1 * t136 * t120;
  t144 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t139);
  tvrho0 = 0.2e1 * rho[0] * t144 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t150 = t97 * t98;
  t151 = t29 * t32;
  t153 = t116 * t151 * t36;
  t156 = t103 * t98;
  t159 = t107 * t98;
  t162 = t111 * t98;
  t169 = t123 * t23;
  t171 = t88 * t37 * t59;
  t174 = t127 * t23;
  t177 = t131 * t23;
  t180 = t135 * t23;
  t183 = t87 * t88 * t37 / 0.24e2 + t150 * t153 / 0.12e2 + t156 * t153 / 0.8e1 + t159 * t153 / 0.6e1 + 0.5e1 / 0.24e2 * t162 * t153 + t117 * t151 * t36 * t59 / 0.24e2 + t169 * t171 / 0.12e2 + t174 * t171 / 0.8e1 + t177 * t171 / 0.6e1 + 0.5e1 / 0.24e2 * t180 * t171;
  t187 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t183);
  tvsigma0 = 0.2e1 * rho[0] * t187;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t40, t41, t43;
  double t45, t46, t48, t49, t51, t52, t54, t58;
  double t59, t60, t62, t63, t65, t66, t68, t69;
  double t71, t74, t78, tzk0;

  double t80, t84, t85, t87, t88, t89, t90, t92;
  double t94, t97, t98, t99, t100, t103, t104, t107;
  double t108, t111, t112, t116, t117, t118, t119, t120;
  double t123, t124, t127, t128, t131, t132, t135, t136;
  double t139, t144, tvrho0, t150, t151, t153, t156, t159;
  double t162, t169, t171, t174, t177, t180, t183, t187;
  double tvsigma0;

  double t192, t199, t200, t201, t202, t203, t204, t205;
  double t207, t208, t209, t210, t211, t212, t213, t216;
  double t218, t221, t222, t223, t224, t225, t226, t229;
  double t232, t233, t236, t239, t240, t243, t246, t247;
  double t248, t249, t250, t251, t252, t255, t256, t257;
  double t258, t259, t262, t265, t266, t269, t272, t273;
  double t276, t279, t281, t282, t283, t284, t292, t308;
  double t312, t316, t317, t321, t324, t325, t330, tv2rho20;
  double t343, t344, t346, t347, t349, t354, t357, t359;
  double t380, t386, t395, t412, t413, t418, tv2rhosigma0, t421;
  double t423, t424, t425, t430, t432, t435, t438, t441;
  double t444, t447, t450, t461, t463, t466, t468, t471;
  double t474, t477, t480, t483, t486, t490, tv2sigma20;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t21 = params->a[1];
  t22 = M_CBRT6;
  t23 = params->mu * t22;
  t24 = M_PI * M_PI;
  t25 = POW_1_3(t24);
  t26 = t25 * t25;
  t27 = 0.1e1 / t26;
  t28 = t23 * t27;
  t29 = 0.1e1 / params->kappa;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = t32 * t36;
  t40 = t28 * t30 * t37 / 0.24e2;
  t41 = 0.1e1 + t40;
  t43 = 0.1e1 - 0.1e1 / t41;
  t45 = params->a[2];
  t46 = t43 * t43;
  t48 = params->a[3];
  t49 = t46 * t43;
  t51 = params->a[4];
  t52 = t46 * t46;
  t54 = params->a[5];
  t58 = params->b[1];
  t59 = exp(-t40);
  t60 = 0.1e1 - t59;
  t62 = params->b[2];
  t63 = t60 * t60;
  t65 = params->b[3];
  t66 = t63 * t60;
  t68 = params->b[4];
  t69 = t63 * t63;
  t71 = params->b[5];
  t74 = t54 * t52 * t43 + t71 * t69 * t60 + t21 * t43 + t45 * t46 + t48 * t49 + t51 * t52 + t58 * t60 + t62 * t63 + t65 * t66 + t68 * t69 + params->a[0] + params->b[0];
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t34;
  t84 = t41 * t41;
  t85 = 0.1e1 / t84;
  t87 = t21 * t85 * t23;
  t88 = t27 * t29;
  t89 = sigma[0] * t32;
  t90 = t33 * rho[0];
  t92 = 0.1e1 / t34 / t90;
  t94 = t88 * t89 * t92;
  t97 = t45 * t43;
  t98 = t85 * params->mu;
  t99 = t98 * t22;
  t100 = t97 * t99;
  t103 = t48 * t46;
  t104 = t103 * t99;
  t107 = t51 * t49;
  t108 = t107 * t99;
  t111 = t54 * t52;
  t112 = t111 * t99;
  t116 = t22 * t27;
  t117 = t58 * params->mu * t116;
  t118 = t32 * t92;
  t119 = t118 * t59;
  t120 = t30 * t119;
  t123 = t62 * t60;
  t124 = t123 * t28;
  t127 = t65 * t63;
  t128 = t127 * t28;
  t131 = t68 * t66;
  t132 = t131 * t28;
  t135 = t71 * t69;
  t136 = t135 * t28;
  t139 = -t87 * t94 / 0.9e1 - 0.2e1 / 0.9e1 * t100 * t94 - t104 * t94 / 0.3e1 - 0.4e1 / 0.9e1 * t108 * t94 - 0.5e1 / 0.9e1 * t112 * t94 - t117 * t120 / 0.9e1 - 0.2e1 / 0.9e1 * t124 * t120 - t128 * t120 / 0.3e1 - 0.4e1 / 0.9e1 * t132 * t120 - 0.5e1 / 0.9e1 * t136 * t120;
  t144 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t139);
  tvrho0 = 0.2e1 * rho[0] * t144 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t150 = t97 * t98;
  t151 = t29 * t32;
  t153 = t116 * t151 * t36;
  t156 = t103 * t98;
  t159 = t107 * t98;
  t162 = t111 * t98;
  t169 = t123 * t23;
  t171 = t88 * t37 * t59;
  t174 = t127 * t23;
  t177 = t131 * t23;
  t180 = t135 * t23;
  t183 = t87 * t88 * t37 / 0.24e2 + t150 * t153 / 0.12e2 + t156 * t153 / 0.8e1 + t159 * t153 / 0.6e1 + 0.5e1 / 0.24e2 * t162 * t153 + t117 * t151 * t36 * t59 / 0.24e2 + t169 * t171 / 0.12e2 + t174 * t171 / 0.8e1 + t177 * t171 / 0.6e1 + 0.5e1 / 0.24e2 * t180 * t171;
  t187 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t183);
  tvsigma0 = 0.2e1 * rho[0] * t187;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t192 = t17 / t34 / rho[0];
  t199 = t84 * t41;
  t200 = 0.1e1 / t199;
  t201 = params->mu * params->mu;
  t202 = t200 * t201;
  t203 = t22 * t22;
  t204 = t202 * t203;
  t205 = t97 * t204;
  t207 = 0.1e1 / t25 / t24;
  t208 = params->kappa * params->kappa;
  t209 = 0.1e1 / t208;
  t210 = t207 * t209;
  t211 = sigma[0] * sigma[0];
  t212 = t211 * t31;
  t213 = t33 * t33;
  t216 = 0.1e1 / t18 / t213 / t90;
  t218 = t210 * t212 * t216;
  t221 = t48 * t43;
  t222 = t84 * t84;
  t223 = 0.1e1 / t222;
  t224 = t223 * t201;
  t225 = t224 * t203;
  t226 = t221 * t225;
  t229 = t103 * t204;
  t232 = t51 * t46;
  t233 = t232 * t225;
  t236 = t107 * t204;
  t239 = t54 * t49;
  t240 = t239 * t225;
  t243 = t111 * t204;
  t246 = t201 * t203;
  t247 = t246 * t207;
  t248 = t123 * t247;
  t249 = t209 * t211;
  t250 = t31 * t216;
  t251 = t250 * t59;
  t252 = t249 * t251;
  t255 = t65 * t60;
  t256 = t255 * t247;
  t257 = t59 * t59;
  t258 = t250 * t257;
  t259 = t249 * t258;
  t262 = t127 * t247;
  t265 = t68 * t63;
  t266 = t265 * t247;
  t269 = t131 * t247;
  t272 = t71 * t66;
  t273 = t272 * t247;
  t276 = t135 * t247;
  t279 = -0.8e1 / 0.81e2 * t205 * t218 + 0.4e1 / 0.27e2 * t226 * t218 - 0.4e1 / 0.27e2 * t229 * t218 + 0.8e1 / 0.27e2 * t233 * t218 - 0.16e2 / 0.81e2 * t236 * t218 + 0.4e2 / 0.81e2 * t240 * t218 - 0.2e2 / 0.81e2 * t243 * t218 - 0.4e1 / 0.81e2 * t248 * t252 + 0.4e1 / 0.27e2 * t256 * t259 - 0.2e1 / 0.27e2 * t262 * t252 + 0.8e1 / 0.27e2 * t266 * t259 - 0.8e1 / 0.81e2 * t269 * t252 + 0.4e2 / 0.81e2 * t273 * t259 - 0.1e2 / 0.81e2 * t276 * t252;
  t281 = 0.1e1 / t34 / t213;
  t282 = t32 * t281;
  t283 = t282 * t59;
  t284 = t30 * t283;
  t292 = t88 * t89 * t281;
  t308 = t21 * t200 * t246;
  t312 = t45 * t223 * t246;
  t316 = t203 * t207;
  t317 = t58 * t201 * t316;
  t321 = t62 * t201 * t316;
  t324 = 0.11e2 / 0.9e1 * t128 * t284 + 0.44e2 / 0.27e2 * t132 * t284 + 0.55e2 / 0.27e2 * t136 * t284 + 0.44e2 / 0.27e2 * t108 * t292 + 0.55e2 / 0.27e2 * t112 * t292 + 0.22e2 / 0.27e2 * t124 * t284 + 0.22e2 / 0.27e2 * t100 * t292 + 0.11e2 / 0.9e1 * t104 * t292 + 0.11e2 / 0.27e2 * t87 * t292 + 0.11e2 / 0.27e2 * t117 * t284 - 0.4e1 / 0.81e2 * t308 * t218 + 0.4e1 / 0.81e2 * t312 * t218 - 0.2e1 / 0.81e2 * t317 * t252 + 0.4e1 / 0.81e2 * t321 * t259;
  t325 = t279 + t324;
  t330 = my_piecewise3(t2, 0, t6 * t192 * t74 / 0.12e2 - t6 * t80 * t139 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t325);
  tv2rho20 = 0.2e1 * rho[0] * t330 + 0.4e1 * t144;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t343 = t209 * t31;
  t344 = t213 * t33;
  t346 = 0.1e1 / t18 / t344;
  t347 = t346 * t257;
  t349 = t343 * t347 * sigma[0];
  t354 = t343 * t346 * sigma[0] * t59;
  t357 = t31 * t346;
  t359 = t210 * t357 * sigma[0];
  t380 = -t87 * t88 * t118 / 0.9e1 - t117 * t151 * t92 * t59 / 0.9e1 - 0.5e1 / 0.27e2 * t273 * t349 + 0.5e1 / 0.108e3 * t276 * t354 + t205 * t359 / 0.27e2 - t226 * t359 / 0.18e2 + t229 * t359 / 0.18e2 - t233 * t359 / 0.9e1 + 0.2e1 / 0.27e2 * t236 * t359 - 0.5e1 / 0.27e2 * t240 * t359 + 0.5e1 / 0.54e2 * t243 * t359 + t248 * t354 / 0.54e2 - t256 * t349 / 0.18e2 + t262 * t354 / 0.36e2;
  t386 = t116 * t151 * t92;
  t395 = t88 * t119;
  t412 = -t266 * t349 / 0.9e1 + t269 * t354 / 0.27e2 - 0.2e1 / 0.9e1 * t150 * t386 - t156 * t386 / 0.3e1 - 0.4e1 / 0.9e1 * t159 * t386 - 0.5e1 / 0.9e1 * t162 * t386 - 0.2e1 / 0.9e1 * t169 * t395 - t174 * t395 / 0.3e1 - 0.4e1 / 0.9e1 * t177 * t395 - 0.5e1 / 0.9e1 * t180 * t395 + t308 * t359 / 0.54e2 - t312 * t359 / 0.54e2 + t317 * t354 / 0.108e3 - t321 * t349 / 0.54e2;
  t413 = t380 + t412;
  t418 = my_piecewise3(t2, 0, -t6 * t80 * t183 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t413);
  tv2rhosigma0 = 0.2e1 * rho[0] * t418 + 0.2e1 * t187;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t421 = t213 * rho[0];
  t423 = 0.1e1 / t18 / t421;
  t424 = t31 * t423;
  t425 = t210 * t424;
  t430 = t97 * t202;
  t432 = t316 * t343 * t423;
  t435 = t221 * t224;
  t438 = t103 * t202;
  t441 = t232 * t224;
  t444 = t107 * t202;
  t447 = t239 * t224;
  t450 = t111 * t202;
  t461 = t123 * t246;
  t463 = t210 * t424 * t59;
  t466 = t255 * t246;
  t468 = t210 * t424 * t257;
  t471 = t127 * t246;
  t474 = t265 * t246;
  t477 = t131 * t246;
  t480 = t272 * t246;
  t483 = t135 * t246;
  t486 = -t308 * t425 / 0.144e3 + t312 * t425 / 0.144e3 - t430 * t432 / 0.72e2 + t435 * t432 / 0.48e2 - t438 * t432 / 0.48e2 + t441 * t432 / 0.24e2 - t444 * t432 / 0.36e2 + 0.5e1 / 0.72e2 * t447 * t432 - 0.5e1 / 0.144e3 * t450 * t432 - t317 * t343 * t423 * t59 / 0.288e3 + t321 * t343 * t423 * t257 / 0.144e3 - t461 * t463 / 0.144e3 + t466 * t468 / 0.48e2 - t471 * t463 / 0.96e2 + t474 * t468 / 0.24e2 - t477 * t463 / 0.72e2 + 0.5e1 / 0.72e2 * t480 * t468 - 0.5e1 / 0.288e3 * t483 * t463;
  t490 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t486);
  tv2sigma20 = 0.2e1 * rho[0] * t490;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t40, t41, t43;
  double t45, t46, t48, t49, t51, t52, t54, t58;
  double t59, t60, t62, t63, t65, t66, t68, t69;
  double t71, t74, t78, tzk0;

  double t80, t84, t85, t87, t88, t89, t90, t92;
  double t94, t97, t98, t99, t100, t103, t104, t107;
  double t108, t111, t112, t116, t117, t118, t119, t120;
  double t123, t124, t127, t128, t131, t132, t135, t136;
  double t139, t144, tvrho0, t150, t151, t153, t156, t159;
  double t162, t169, t171, t174, t177, t180, t183, t187;
  double tvsigma0;

  double t192, t199, t200, t201, t202, t203, t204, t205;
  double t207, t208, t209, t210, t211, t212, t213, t216;
  double t218, t221, t222, t223, t224, t225, t226, t229;
  double t232, t233, t236, t239, t240, t243, t246, t247;
  double t248, t249, t250, t251, t252, t255, t256, t257;
  double t258, t259, t262, t265, t266, t269, t272, t273;
  double t276, t279, t281, t282, t283, t284, t292, t308;
  double t312, t316, t317, t321, t324, t325, t330, tv2rho20;
  double t343, t344, t346, t347, t349, t354, t357, t359;
  double t380, t386, t395, t412, t413, t418, tv2rhosigma0, t421;
  double t423, t424, t425, t430, t432, t435, t438, t441;
  double t444, t447, t450, t461, t463, t466, t468, t471;
  double t474, t477, t480, t483, t486, t490, tv2sigma20;

  double t493, t504, t505, t506, t507, t508, t509, t511;
  double t512, t513, t514, t515, t516, t518, t521, t522;
  double t525, t526, t527, t529, t532, t534, t537, t540;
  double t541, t542, t544, t547, t550, t553, t554, t557;
  double t560, t563, t566, t569, t570, t573, t575, t576;
  double t577, t580, t583, t586, t587, t591, t593, t596;
  double t597, t598, t602, t603, t605, t609, t615, t619;
  double t623, t626, t629, t633, t637, t641, t662, t689;
  double t691, t696, tv3rho30, t713, t714, t716, t723, t724;
  double t725, t728, t729, t734, t735, t746, t761, t767;
  double t776, t782, t786, t793, t812, t837, t839, t844;
  double tv3rho2sigma0, t850, t851, t853, t860, t876, t877, t878;
  double t882, t883, t888, t889, t908, t913, t917, t931;
  double t959, t961, t966, tv3rhosigma20, t969, t970, t971, t972;
  double t975, t978, t981, t984, t987, t990, t993, t996;
  double t999, t1001, t1004, t1006, t1009, t1012, t1013, t1015;
  double t1018, t1021, t1024, t1027, t1030, t1033, t1049, t1050;
  double t1054, tv3sigma30;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t21 = params->a[1];
  t22 = M_CBRT6;
  t23 = params->mu * t22;
  t24 = M_PI * M_PI;
  t25 = POW_1_3(t24);
  t26 = t25 * t25;
  t27 = 0.1e1 / t26;
  t28 = t23 * t27;
  t29 = 0.1e1 / params->kappa;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = t32 * t36;
  t40 = t28 * t30 * t37 / 0.24e2;
  t41 = 0.1e1 + t40;
  t43 = 0.1e1 - 0.1e1 / t41;
  t45 = params->a[2];
  t46 = t43 * t43;
  t48 = params->a[3];
  t49 = t46 * t43;
  t51 = params->a[4];
  t52 = t46 * t46;
  t54 = params->a[5];
  t58 = params->b[1];
  t59 = exp(-t40);
  t60 = 0.1e1 - t59;
  t62 = params->b[2];
  t63 = t60 * t60;
  t65 = params->b[3];
  t66 = t63 * t60;
  t68 = params->b[4];
  t69 = t63 * t63;
  t71 = params->b[5];
  t74 = t54 * t52 * t43 + t71 * t69 * t60 + t21 * t43 + t45 * t46 + t48 * t49 + t51 * t52 + t58 * t60 + t62 * t63 + t65 * t66 + t68 * t69 + params->a[0] + params->b[0];
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t34;
  t84 = t41 * t41;
  t85 = 0.1e1 / t84;
  t87 = t21 * t85 * t23;
  t88 = t27 * t29;
  t89 = sigma[0] * t32;
  t90 = t33 * rho[0];
  t92 = 0.1e1 / t34 / t90;
  t94 = t88 * t89 * t92;
  t97 = t45 * t43;
  t98 = t85 * params->mu;
  t99 = t98 * t22;
  t100 = t97 * t99;
  t103 = t48 * t46;
  t104 = t103 * t99;
  t107 = t51 * t49;
  t108 = t107 * t99;
  t111 = t54 * t52;
  t112 = t111 * t99;
  t116 = t22 * t27;
  t117 = t58 * params->mu * t116;
  t118 = t32 * t92;
  t119 = t118 * t59;
  t120 = t30 * t119;
  t123 = t62 * t60;
  t124 = t123 * t28;
  t127 = t65 * t63;
  t128 = t127 * t28;
  t131 = t68 * t66;
  t132 = t131 * t28;
  t135 = t71 * t69;
  t136 = t135 * t28;
  t139 = -t87 * t94 / 0.9e1 - 0.2e1 / 0.9e1 * t100 * t94 - t104 * t94 / 0.3e1 - 0.4e1 / 0.9e1 * t108 * t94 - 0.5e1 / 0.9e1 * t112 * t94 - t117 * t120 / 0.9e1 - 0.2e1 / 0.9e1 * t124 * t120 - t128 * t120 / 0.3e1 - 0.4e1 / 0.9e1 * t132 * t120 - 0.5e1 / 0.9e1 * t136 * t120;
  t144 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t139);
  tvrho0 = 0.2e1 * rho[0] * t144 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t150 = t97 * t98;
  t151 = t29 * t32;
  t153 = t116 * t151 * t36;
  t156 = t103 * t98;
  t159 = t107 * t98;
  t162 = t111 * t98;
  t169 = t123 * t23;
  t171 = t88 * t37 * t59;
  t174 = t127 * t23;
  t177 = t131 * t23;
  t180 = t135 * t23;
  t183 = t87 * t88 * t37 / 0.24e2 + t150 * t153 / 0.12e2 + t156 * t153 / 0.8e1 + t159 * t153 / 0.6e1 + 0.5e1 / 0.24e2 * t162 * t153 + t117 * t151 * t36 * t59 / 0.24e2 + t169 * t171 / 0.12e2 + t174 * t171 / 0.8e1 + t177 * t171 / 0.6e1 + 0.5e1 / 0.24e2 * t180 * t171;
  t187 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t183);
  tvsigma0 = 0.2e1 * rho[0] * t187;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t192 = t17 / t34 / rho[0];
  t199 = t84 * t41;
  t200 = 0.1e1 / t199;
  t201 = params->mu * params->mu;
  t202 = t200 * t201;
  t203 = t22 * t22;
  t204 = t202 * t203;
  t205 = t97 * t204;
  t207 = 0.1e1 / t25 / t24;
  t208 = params->kappa * params->kappa;
  t209 = 0.1e1 / t208;
  t210 = t207 * t209;
  t211 = sigma[0] * sigma[0];
  t212 = t211 * t31;
  t213 = t33 * t33;
  t216 = 0.1e1 / t18 / t213 / t90;
  t218 = t210 * t212 * t216;
  t221 = t48 * t43;
  t222 = t84 * t84;
  t223 = 0.1e1 / t222;
  t224 = t223 * t201;
  t225 = t224 * t203;
  t226 = t221 * t225;
  t229 = t103 * t204;
  t232 = t51 * t46;
  t233 = t232 * t225;
  t236 = t107 * t204;
  t239 = t54 * t49;
  t240 = t239 * t225;
  t243 = t111 * t204;
  t246 = t201 * t203;
  t247 = t246 * t207;
  t248 = t123 * t247;
  t249 = t209 * t211;
  t250 = t31 * t216;
  t251 = t250 * t59;
  t252 = t249 * t251;
  t255 = t65 * t60;
  t256 = t255 * t247;
  t257 = t59 * t59;
  t258 = t250 * t257;
  t259 = t249 * t258;
  t262 = t127 * t247;
  t265 = t68 * t63;
  t266 = t265 * t247;
  t269 = t131 * t247;
  t272 = t71 * t66;
  t273 = t272 * t247;
  t276 = t135 * t247;
  t279 = -0.8e1 / 0.81e2 * t205 * t218 + 0.4e1 / 0.27e2 * t226 * t218 - 0.4e1 / 0.27e2 * t229 * t218 + 0.8e1 / 0.27e2 * t233 * t218 - 0.16e2 / 0.81e2 * t236 * t218 + 0.4e2 / 0.81e2 * t240 * t218 - 0.2e2 / 0.81e2 * t243 * t218 - 0.4e1 / 0.81e2 * t248 * t252 + 0.4e1 / 0.27e2 * t256 * t259 - 0.2e1 / 0.27e2 * t262 * t252 + 0.8e1 / 0.27e2 * t266 * t259 - 0.8e1 / 0.81e2 * t269 * t252 + 0.4e2 / 0.81e2 * t273 * t259 - 0.1e2 / 0.81e2 * t276 * t252;
  t281 = 0.1e1 / t34 / t213;
  t282 = t32 * t281;
  t283 = t282 * t59;
  t284 = t30 * t283;
  t292 = t88 * t89 * t281;
  t308 = t21 * t200 * t246;
  t312 = t45 * t223 * t246;
  t316 = t203 * t207;
  t317 = t58 * t201 * t316;
  t321 = t62 * t201 * t316;
  t324 = 0.11e2 / 0.9e1 * t128 * t284 + 0.44e2 / 0.27e2 * t132 * t284 + 0.55e2 / 0.27e2 * t136 * t284 + 0.44e2 / 0.27e2 * t108 * t292 + 0.55e2 / 0.27e2 * t112 * t292 + 0.22e2 / 0.27e2 * t124 * t284 + 0.22e2 / 0.27e2 * t100 * t292 + 0.11e2 / 0.9e1 * t104 * t292 + 0.11e2 / 0.27e2 * t87 * t292 + 0.11e2 / 0.27e2 * t117 * t284 - 0.4e1 / 0.81e2 * t308 * t218 + 0.4e1 / 0.81e2 * t312 * t218 - 0.2e1 / 0.81e2 * t317 * t252 + 0.4e1 / 0.81e2 * t321 * t259;
  t325 = t279 + t324;
  t330 = my_piecewise3(t2, 0, t6 * t192 * t74 / 0.12e2 - t6 * t80 * t139 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t325);
  tv2rho20 = 0.2e1 * rho[0] * t330 + 0.4e1 * t144;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t343 = t209 * t31;
  t344 = t213 * t33;
  t346 = 0.1e1 / t18 / t344;
  t347 = t346 * t257;
  t349 = t343 * t347 * sigma[0];
  t354 = t343 * t346 * sigma[0] * t59;
  t357 = t31 * t346;
  t359 = t210 * t357 * sigma[0];
  t380 = -t87 * t88 * t118 / 0.9e1 - t117 * t151 * t92 * t59 / 0.9e1 - 0.5e1 / 0.27e2 * t273 * t349 + 0.5e1 / 0.108e3 * t276 * t354 + t205 * t359 / 0.27e2 - t226 * t359 / 0.18e2 + t229 * t359 / 0.18e2 - t233 * t359 / 0.9e1 + 0.2e1 / 0.27e2 * t236 * t359 - 0.5e1 / 0.27e2 * t240 * t359 + 0.5e1 / 0.54e2 * t243 * t359 + t248 * t354 / 0.54e2 - t256 * t349 / 0.18e2 + t262 * t354 / 0.36e2;
  t386 = t116 * t151 * t92;
  t395 = t88 * t119;
  t412 = -t266 * t349 / 0.9e1 + t269 * t354 / 0.27e2 - 0.2e1 / 0.9e1 * t150 * t386 - t156 * t386 / 0.3e1 - 0.4e1 / 0.9e1 * t159 * t386 - 0.5e1 / 0.9e1 * t162 * t386 - 0.2e1 / 0.9e1 * t169 * t395 - t174 * t395 / 0.3e1 - 0.4e1 / 0.9e1 * t177 * t395 - 0.5e1 / 0.9e1 * t180 * t395 + t308 * t359 / 0.54e2 - t312 * t359 / 0.54e2 + t317 * t354 / 0.108e3 - t321 * t349 / 0.54e2;
  t413 = t380 + t412;
  t418 = my_piecewise3(t2, 0, -t6 * t80 * t183 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t413);
  tv2rhosigma0 = 0.2e1 * rho[0] * t418 + 0.2e1 * t187;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t421 = t213 * rho[0];
  t423 = 0.1e1 / t18 / t421;
  t424 = t31 * t423;
  t425 = t210 * t424;
  t430 = t97 * t202;
  t432 = t316 * t343 * t423;
  t435 = t221 * t224;
  t438 = t103 * t202;
  t441 = t232 * t224;
  t444 = t107 * t202;
  t447 = t239 * t224;
  t450 = t111 * t202;
  t461 = t123 * t246;
  t463 = t210 * t424 * t59;
  t466 = t255 * t246;
  t468 = t210 * t424 * t257;
  t471 = t127 * t246;
  t474 = t265 * t246;
  t477 = t131 * t246;
  t480 = t272 * t246;
  t483 = t135 * t246;
  t486 = -t308 * t425 / 0.144e3 + t312 * t425 / 0.144e3 - t430 * t432 / 0.72e2 + t435 * t432 / 0.48e2 - t438 * t432 / 0.48e2 + t441 * t432 / 0.24e2 - t444 * t432 / 0.36e2 + 0.5e1 / 0.72e2 * t447 * t432 - 0.5e1 / 0.144e3 * t450 * t432 - t317 * t343 * t423 * t59 / 0.288e3 + t321 * t343 * t423 * t257 / 0.144e3 - t461 * t463 / 0.144e3 + t466 * t468 / 0.48e2 - t471 * t463 / 0.96e2 + t474 * t468 / 0.24e2 - t477 * t463 / 0.72e2 + 0.5e1 / 0.72e2 * t480 * t468 - 0.5e1 / 0.288e3 * t483 * t463;
  t490 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t486);
  tv2sigma20 = 0.2e1 * rho[0] * t490;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t493 = t17 * t36;
  t504 = 0.1e1 / t222 / t41;
  t505 = t201 * params->mu;
  t506 = t504 * t505;
  t507 = t239 * t506;
  t508 = t24 * t24;
  t509 = 0.1e1 / t508;
  t511 = 0.1e1 / t208 / params->kappa;
  t512 = t509 * t511;
  t513 = t211 * sigma[0];
  t514 = t213 * t213;
  t515 = t514 * t90;
  t516 = 0.1e1 / t515;
  t518 = t512 * t513 * t516;
  t521 = t223 * t505;
  t522 = t111 * t521;
  t525 = t505 * t509;
  t526 = t123 * t525;
  t527 = t511 * t513;
  t529 = t527 * t516 * t59;
  t532 = t255 * t525;
  t534 = t527 * t516 * t257;
  t537 = t127 * t525;
  t540 = t68 * t60;
  t541 = t540 * t525;
  t542 = t257 * t59;
  t544 = t527 * t516 * t542;
  t547 = t265 * t525;
  t550 = t131 * t525;
  t553 = t71 * t63;
  t554 = t553 * t525;
  t557 = t272 * t525;
  t560 = t135 * t525;
  t563 = t97 * t521;
  t566 = t221 * t506;
  t569 = 0.32e3 / 0.81e2 * t507 * t518 - 0.8e2 / 0.81e2 * t522 * t518 - 0.16e2 / 0.243e3 * t526 * t529 + 0.16e2 / 0.27e2 * t532 * t534 - 0.8e1 / 0.81e2 * t537 * t529 - 0.64e2 / 0.81e2 * t541 * t544 + 0.32e2 / 0.27e2 * t547 * t534 - 0.32e2 / 0.243e3 * t550 * t529 - 0.16e3 / 0.81e2 * t554 * t544 + 0.16e3 / 0.81e2 * t557 * t534 - 0.4e2 / 0.243e3 * t560 * t529 - 0.32e2 / 0.81e2 * t563 * t518 + 0.32e2 / 0.27e2 * t566 * t518;
  t570 = t103 * t521;
  t573 = t51 * t43;
  t575 = 0.1e1 / t222 / t84;
  t576 = t575 * t505;
  t577 = t573 * t576;
  t580 = t232 * t506;
  t583 = t107 * t521;
  t586 = t54 * t46;
  t587 = t586 * t576;
  t591 = 0.1e1 / t34 / t421;
  t593 = t88 * t89 * t591;
  t596 = t32 * t591;
  t597 = t596 * t59;
  t598 = t30 * t597;
  t602 = 0.1e1 / t18 / t514;
  t603 = t31 * t602;
  t605 = t249 * t603 * t257;
  t609 = t210 * t212 * t602;
  t615 = t249 * t603 * t59;
  t619 = t21 * t223 * t505;
  t623 = t58 * t505 * t509;
  t626 = -0.16e2 / 0.27e2 * t570 * t518 - 0.64e2 / 0.81e2 * t577 * t518 + 0.64e2 / 0.27e2 * t580 * t518 - 0.64e2 / 0.81e2 * t583 * t518 - 0.16e3 / 0.81e2 * t587 * t518 - 0.154e3 / 0.81e2 * t87 * t593 - 0.154e3 / 0.81e2 * t117 * t598 - 0.44e2 / 0.81e2 * t321 * t605 - 0.44e2 / 0.81e2 * t312 * t609 + 0.44e2 / 0.81e2 * t308 * t609 + 0.22e2 / 0.81e2 * t317 * t615 - 0.16e2 / 0.81e2 * t619 * t518 - 0.8e1 / 0.243e3 * t623 * t529;
  t629 = t45 * t504 * t505;
  t633 = t48 * t575 * t505;
  t637 = t62 * t505 * t509;
  t641 = t65 * t505 * t509;
  t662 = 0.32e2 / 0.81e2 * t629 * t518 - 0.16e2 / 0.81e2 * t633 * t518 + 0.16e2 / 0.81e2 * t637 * t534 - 0.16e2 / 0.81e2 * t641 * t544 - 0.44e3 / 0.81e2 * t273 * t605 + 0.11e3 / 0.81e2 * t276 * t615 - 0.88e2 / 0.27e2 * t233 * t609 + 0.176e3 / 0.81e2 * t236 * t609 - 0.44e3 / 0.81e2 * t240 * t609 + 0.22e3 / 0.81e2 * t243 * t609 + 0.44e2 / 0.81e2 * t248 * t615 + 0.88e2 / 0.81e2 * t205 * t609 - 0.44e2 / 0.27e2 * t226 * t609;
  t689 = 0.44e2 / 0.27e2 * t229 * t609 - 0.308e3 / 0.81e2 * t124 * t598 - 0.308e3 / 0.81e2 * t100 * t593 - 0.154e3 / 0.27e2 * t104 * t593 - 0.77e3 / 0.81e2 * t136 * t598 - 0.616e3 / 0.81e2 * t108 * t593 - 0.77e3 / 0.81e2 * t112 * t593 - 0.154e3 / 0.27e2 * t128 * t598 - 0.616e3 / 0.81e2 * t132 * t598 - 0.44e2 / 0.27e2 * t256 * t605 + 0.22e2 / 0.27e2 * t262 * t615 - 0.88e2 / 0.27e2 * t266 * t605 + 0.88e2 / 0.81e2 * t269 * t615;
  t691 = t569 + t626 + t662 + t689;
  t696 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t493 * t74 + t6 * t192 * t139 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t80 * t325 - 0.3e1 / 0.8e1 * t6 * t19 * t691);
  tv3rho30 = 0.2e1 * rho[0] * t696 + 0.6e1 * t330;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t713 = t514 * t33;
  t714 = 0.1e1 / t713;
  t716 = t512 * t714 * t211;
  t723 = t511 * t714;
  t724 = t211 * t59;
  t725 = t723 * t724;
  t728 = t257 * t211;
  t729 = t723 * t728;
  t734 = t542 * t211;
  t735 = t723 * t734;
  t746 = 0.11e2 / 0.27e2 * t87 * t88 * t282 + 0.11e2 / 0.27e2 * t117 * t151 * t281 * t59 + 0.2e2 / 0.27e2 * t587 * t716 - 0.4e2 / 0.27e2 * t507 * t716 + 0.1e2 / 0.27e2 * t522 * t716 + 0.2e1 / 0.81e2 * t526 * t725 - 0.2e1 / 0.9e1 * t532 * t729 + t537 * t725 / 0.27e2 + 0.8e1 / 0.27e2 * t541 * t735 - 0.4e1 / 0.9e1 * t547 * t729 + 0.4e1 / 0.81e2 * t550 * t725 + 0.2e2 / 0.27e2 * t554 * t735 - 0.2e2 / 0.27e2 * t557 * t729;
  t761 = t88 * t283;
  t767 = t116 * t151 * t281;
  t776 = 0.5e1 / 0.81e2 * t560 * t725 + 0.4e1 / 0.27e2 * t563 * t716 - 0.4e1 / 0.9e1 * t566 * t716 + 0.2e1 / 0.9e1 * t570 * t716 + 0.8e1 / 0.27e2 * t577 * t716 - 0.8e1 / 0.9e1 * t580 * t716 + 0.8e1 / 0.27e2 * t583 * t716 + 0.11e2 / 0.9e1 * t174 * t761 + 0.44e2 / 0.27e2 * t177 * t761 + 0.22e2 / 0.27e2 * t150 * t767 + 0.11e2 / 0.9e1 * t156 * t767 + 0.44e2 / 0.27e2 * t159 * t767 + 0.55e2 / 0.27e2 * t162 * t767;
  t782 = t210 * sigma[0] * t31 * t216;
  t786 = t209 * sigma[0] * t258;
  t793 = t343 * t216 * sigma[0] * t59;
  t812 = 0.22e2 / 0.27e2 * t169 * t761 + t312 * t782 / 0.6e1 + t321 * t786 / 0.6e1 - t308 * t782 / 0.6e1 - t317 * t793 / 0.12e2 + 0.55e2 / 0.27e2 * t180 * t761 + 0.2e1 / 0.27e2 * t641 * t735 + 0.2e1 / 0.27e2 * t619 * t716 + t623 * t725 / 0.81e2 - 0.4e1 / 0.27e2 * t629 * t716 + 0.2e1 / 0.27e2 * t633 * t716 - 0.2e1 / 0.27e2 * t637 * t729 - t248 * t793 / 0.6e1;
  t837 = 0.5e1 / 0.3e1 * t273 * t786 - 0.5e1 / 0.12e2 * t276 * t793 + t256 * t786 / 0.2e1 - t262 * t793 / 0.4e1 + t266 * t786 - t269 * t793 / 0.3e1 - t205 * t782 / 0.3e1 + t226 * t782 / 0.2e1 - t229 * t782 / 0.2e1 + t233 * t782 - 0.2e1 / 0.3e1 * t236 * t782 + 0.5e1 / 0.3e1 * t240 * t782 - 0.5e1 / 0.6e1 * t243 * t782;
  t839 = t746 + t776 + t812 + t837;
  t844 = my_piecewise3(t2, 0, t6 * t192 * t183 / 0.12e2 - t6 * t80 * t413 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t839);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t844 + 0.4e1 * t418;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t850 = t514 * rho[0];
  t851 = 0.1e1 / t850;
  t853 = t512 * t851 * sigma[0];
  t860 = t210 * t357;
  t876 = t511 * t851;
  t877 = sigma[0] * t59;
  t878 = t876 * t877;
  t882 = t257 * sigma[0];
  t883 = t876 * t882;
  t888 = t542 * sigma[0];
  t889 = t876 * t888;
  t908 = t532 * t883 / 0.12e2 - t537 * t878 / 0.72e2 - t541 * t889 / 0.9e1 + t547 * t883 / 0.6e1 - t550 * t878 / 0.54e2 - 0.5e1 / 0.18e2 * t554 * t889 + 0.5e1 / 0.18e2 * t557 * t883 - 0.5e1 / 0.216e3 * t560 * t878 - t563 * t853 / 0.18e2 + t566 * t853 / 0.6e1 - t570 * t853 / 0.12e2;
  t913 = t210 * t357 * t59;
  t917 = t316 * t343 * t346;
  t931 = t210 * t357 * t257;
  t959 = -0.1e2 / 0.27e2 * t480 * t931 - t466 * t931 / 0.9e1 + t471 * t913 / 0.18e2 - 0.1e2 / 0.27e2 * t447 * t917 + 0.5e1 / 0.27e2 * t450 * t917 - t619 * t853 / 0.36e2 + t629 * t853 / 0.18e2 - t633 * t853 / 0.36e2 - t623 * t878 / 0.216e3 + t637 * t883 / 0.36e2 - t641 * t889 / 0.36e2;
  t961 = t580 * t853 / 0.3e1 - t583 * t853 / 0.9e1 - 0.5e1 / 0.18e2 * t587 * t853 + t308 * t860 / 0.27e2 - t312 * t860 / 0.27e2 + t317 * t343 * t346 * t59 / 0.54e2 - t321 * t343 * t347 / 0.27e2 + 0.5e1 / 0.9e1 * t507 * t853 - 0.5e1 / 0.36e2 * t522 * t853 - t526 * t878 / 0.108e3 + t908 - t577 * t853 / 0.9e1 + t461 * t913 / 0.27e2 + t438 * t917 / 0.9e1 - 0.2e1 / 0.9e1 * t441 * t917 + 0.4e1 / 0.27e2 * t444 * t917 + 0.2e1 / 0.27e2 * t430 * t917 - t435 * t917 / 0.9e1 + 0.5e1 / 0.54e2 * t483 * t913 - 0.2e1 / 0.9e1 * t474 * t931 + 0.2e1 / 0.27e2 * t477 * t913 + t959;
  t966 = my_piecewise3(t2, 0, -t6 * t80 * t486 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t961);
  tv3rhosigma20 = 0.2e1 * rho[0] * t966 + 0.2e1 * t490;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t969 = t97 * t223;
  t970 = 0.1e1 / t514;
  t971 = t511 * t970;
  t972 = t525 * t971;
  t975 = t221 * t504;
  t978 = t103 * t223;
  t981 = t573 * t575;
  t984 = t232 * t504;
  t987 = t107 * t223;
  t990 = t586 * t575;
  t993 = t239 * t504;
  t996 = t111 * t223;
  t999 = t123 * t505;
  t1001 = t512 * t970 * t59;
  t1004 = t255 * t505;
  t1006 = t512 * t970 * t257;
  t1009 = t127 * t505;
  t1012 = t969 * t972 / 0.48e2 - t975 * t972 / 0.16e2 + t978 * t972 / 0.32e2 + t981 * t972 / 0.24e2 - t984 * t972 / 0.8e1 + t987 * t972 / 0.24e2 + 0.5e1 / 0.48e2 * t990 * t972 - 0.5e1 / 0.24e2 * t993 * t972 + 0.5e1 / 0.96e2 * t996 * t972 + t999 * t1001 / 0.288e3 - t1004 * t1006 / 0.32e2 + t1009 * t1001 / 0.192e3;
  t1013 = t540 * t505;
  t1015 = t512 * t970 * t542;
  t1018 = t265 * t505;
  t1021 = t131 * t505;
  t1024 = t553 * t505;
  t1027 = t272 * t505;
  t1030 = t135 * t505;
  t1033 = t512 * t970;
  t1049 = t1013 * t1015 / 0.24e2 - t1018 * t1006 / 0.16e2 + t1021 * t1001 / 0.144e3 + 0.5e1 / 0.48e2 * t1024 * t1015 - 0.5e1 / 0.48e2 * t1027 * t1006 + 0.5e1 / 0.576e3 * t1030 * t1001 + t619 * t1033 / 0.96e2 - t629 * t1033 / 0.48e2 + t633 * t1033 / 0.96e2 + t623 * t971 * t59 / 0.576e3 - t637 * t971 * t257 / 0.96e2 + t641 * t971 * t542 / 0.96e2;
  t1050 = t1012 + t1049;
  t1054 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1050);
  tv3sigma30 = 0.2e1 * rho[0] * t1054;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t36, t37, t40, t41, t43;
  double t45, t46, t48, t49, t51, t52, t54, t58;
  double t59, t60, t62, t63, t65, t66, t68, t69;
  double t71, t74, t78, tzk0;

  double t80, t84, t85, t87, t88, t89, t90, t92;
  double t94, t97, t98, t99, t100, t103, t104, t107;
  double t108, t111, t112, t116, t117, t118, t119, t120;
  double t123, t124, t127, t128, t131, t132, t135, t136;
  double t139, t144, tvrho0, t150, t151, t153, t156, t159;
  double t162, t169, t171, t174, t177, t180, t183, t187;
  double tvsigma0;

  double t192, t199, t200, t201, t202, t203, t204, t205;
  double t207, t208, t209, t210, t211, t212, t213, t216;
  double t218, t221, t222, t223, t224, t225, t226, t229;
  double t232, t233, t236, t239, t240, t243, t246, t247;
  double t248, t249, t250, t251, t252, t255, t256, t257;
  double t258, t259, t262, t265, t266, t269, t272, t273;
  double t276, t279, t281, t282, t283, t284, t292, t308;
  double t312, t316, t317, t321, t324, t325, t330, tv2rho20;
  double t343, t344, t346, t347, t349, t354, t357, t359;
  double t380, t386, t395, t412, t413, t418, tv2rhosigma0, t421;
  double t423, t424, t425, t430, t432, t435, t438, t441;
  double t444, t447, t450, t461, t463, t466, t468, t471;
  double t474, t477, t480, t483, t486, t490, tv2sigma20;

  double t493, t504, t505, t506, t507, t508, t509, t511;
  double t512, t513, t514, t515, t516, t518, t521, t522;
  double t525, t526, t527, t529, t532, t534, t537, t540;
  double t541, t542, t544, t547, t550, t553, t554, t557;
  double t560, t563, t566, t569, t570, t573, t575, t576;
  double t577, t580, t583, t586, t587, t591, t593, t596;
  double t597, t598, t602, t603, t605, t609, t615, t619;
  double t623, t626, t629, t633, t637, t641, t662, t689;
  double t691, t696, tv3rho30, t713, t714, t716, t723, t724;
  double t725, t728, t729, t734, t735, t746, t761, t767;
  double t776, t782, t786, t793, t812, t837, t839, t844;
  double tv3rho2sigma0, t850, t851, t853, t860, t876, t877, t878;
  double t882, t883, t888, t889, t908, t913, t917, t931;
  double t959, t961, t966, tv3rhosigma20, t969, t970, t971, t972;
  double t975, t978, t981, t984, t987, t990, t993, t996;
  double t999, t1001, t1004, t1006, t1009, t1012, t1013, t1015;
  double t1018, t1021, t1024, t1027, t1030, t1033, t1049, t1050;
  double t1054, tv3sigma30;

  double t1070, t1071, t1073, t1079, t1083, t1087, t1092, t1094;
  double t1095, t1096, t1097, t1098, t1099, t1102, t1104, t1105;
  double t1108, t1109, t1110, t1111, t1114, t1115, t1118, t1120;
  double t1123, t1126, t1128, t1131, t1134, t1137, t1140, t1143;
  double t1147, t1148, t1152, t1153, t1158, t1161, t1164, t1166;
  double t1168, t1169, t1172, t1175, t1179, t1180, t1183, t1186;
  double t1189, t1220, t1231, t1233, t1238, t1242, t1243, t1245;
  double t1249, t1253, t1260, t1261, t1262, t1268, t1270, t1273;
  double t1277, t1283, t1289, t1290, t1293, t1294, t1295, t1296;
  double t1306, t1345, t1346, t1347, t1354, t1361, tv4rho40, t1374;
  double t1378, t1381, t1384, t1387, t1399, t1400, t1401, t1406;
  double t1407, t1412, t1419, t1424, t1428, t1437, t1438, t1441;
  double t1444, t1453, t1490, t1498, t1502, t1505, t1511, t1545;
  double t1548, t1553, t1565, t1596, t1603, tv4rho3sigma0, t1613, t1615;
  double t1616, t1621, t1626, t1634, t1641, t1651, t1655, t1668;
  double t1673, t1674, t1697, t1716, t1722, t1728, t1732, t1738;
  double t1763, t1772, t1775, t1779, t1804, t1811, tv4rho2sigma20, t1818;
  double t1819, t1821, t1827, t1834, t1841, t1846, t1851, t1857;
  double t1861, t1865, t1868, t1873, t1899, t1902, t1910, t1914;
  double t1921, t1938, t1959, t1969, t1976, tv4rhosigma30, t1980, t1982;
  double t1987, t1988, t1992, t2015, t2018, t2019, t2026, t2033;
  double t2048, t2067, t2072, tv4sigma40;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t21 = params->a[1];
  t22 = M_CBRT6;
  t23 = params->mu * t22;
  t24 = M_PI * M_PI;
  t25 = POW_1_3(t24);
  t26 = t25 * t25;
  t27 = 0.1e1 / t26;
  t28 = t23 * t27;
  t29 = 0.1e1 / params->kappa;
  t30 = t29 * sigma[0];
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t33 = rho[0] * rho[0];
  t34 = t18 * t18;
  t36 = 0.1e1 / t34 / t33;
  t37 = t32 * t36;
  t40 = t28 * t30 * t37 / 0.24e2;
  t41 = 0.1e1 + t40;
  t43 = 0.1e1 - 0.1e1 / t41;
  t45 = params->a[2];
  t46 = t43 * t43;
  t48 = params->a[3];
  t49 = t46 * t43;
  t51 = params->a[4];
  t52 = t46 * t46;
  t54 = params->a[5];
  t58 = params->b[1];
  t59 = exp(-t40);
  t60 = 0.1e1 - t59;
  t62 = params->b[2];
  t63 = t60 * t60;
  t65 = params->b[3];
  t66 = t63 * t60;
  t68 = params->b[4];
  t69 = t63 * t63;
  t71 = params->b[5];
  t74 = t54 * t52 * t43 + t71 * t69 * t60 + t21 * t43 + t45 * t46 + t48 * t49 + t51 * t52 + t58 * t60 + t62 * t63 + t65 * t66 + t68 * t69 + params->a[0] + params->b[0];
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t34;
  t84 = t41 * t41;
  t85 = 0.1e1 / t84;
  t87 = t21 * t85 * t23;
  t88 = t27 * t29;
  t89 = sigma[0] * t32;
  t90 = t33 * rho[0];
  t92 = 0.1e1 / t34 / t90;
  t94 = t88 * t89 * t92;
  t97 = t45 * t43;
  t98 = t85 * params->mu;
  t99 = t98 * t22;
  t100 = t97 * t99;
  t103 = t48 * t46;
  t104 = t103 * t99;
  t107 = t51 * t49;
  t108 = t107 * t99;
  t111 = t54 * t52;
  t112 = t111 * t99;
  t116 = t22 * t27;
  t117 = t58 * params->mu * t116;
  t118 = t32 * t92;
  t119 = t118 * t59;
  t120 = t30 * t119;
  t123 = t62 * t60;
  t124 = t123 * t28;
  t127 = t65 * t63;
  t128 = t127 * t28;
  t131 = t68 * t66;
  t132 = t131 * t28;
  t135 = t71 * t69;
  t136 = t135 * t28;
  t139 = -t87 * t94 / 0.9e1 - 0.2e1 / 0.9e1 * t100 * t94 - t104 * t94 / 0.3e1 - 0.4e1 / 0.9e1 * t108 * t94 - 0.5e1 / 0.9e1 * t112 * t94 - t117 * t120 / 0.9e1 - 0.2e1 / 0.9e1 * t124 * t120 - t128 * t120 / 0.3e1 - 0.4e1 / 0.9e1 * t132 * t120 - 0.5e1 / 0.9e1 * t136 * t120;
  t144 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t139);
  tvrho0 = 0.2e1 * rho[0] * t144 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t150 = t97 * t98;
  t151 = t29 * t32;
  t153 = t116 * t151 * t36;
  t156 = t103 * t98;
  t159 = t107 * t98;
  t162 = t111 * t98;
  t169 = t123 * t23;
  t171 = t88 * t37 * t59;
  t174 = t127 * t23;
  t177 = t131 * t23;
  t180 = t135 * t23;
  t183 = t87 * t88 * t37 / 0.24e2 + t150 * t153 / 0.12e2 + t156 * t153 / 0.8e1 + t159 * t153 / 0.6e1 + 0.5e1 / 0.24e2 * t162 * t153 + t117 * t151 * t36 * t59 / 0.24e2 + t169 * t171 / 0.12e2 + t174 * t171 / 0.8e1 + t177 * t171 / 0.6e1 + 0.5e1 / 0.24e2 * t180 * t171;
  t187 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t183);
  tvsigma0 = 0.2e1 * rho[0] * t187;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t192 = t17 / t34 / rho[0];
  t199 = t84 * t41;
  t200 = 0.1e1 / t199;
  t201 = params->mu * params->mu;
  t202 = t200 * t201;
  t203 = t22 * t22;
  t204 = t202 * t203;
  t205 = t97 * t204;
  t207 = 0.1e1 / t25 / t24;
  t208 = params->kappa * params->kappa;
  t209 = 0.1e1 / t208;
  t210 = t207 * t209;
  t211 = sigma[0] * sigma[0];
  t212 = t211 * t31;
  t213 = t33 * t33;
  t216 = 0.1e1 / t18 / t213 / t90;
  t218 = t210 * t212 * t216;
  t221 = t48 * t43;
  t222 = t84 * t84;
  t223 = 0.1e1 / t222;
  t224 = t223 * t201;
  t225 = t224 * t203;
  t226 = t221 * t225;
  t229 = t103 * t204;
  t232 = t51 * t46;
  t233 = t232 * t225;
  t236 = t107 * t204;
  t239 = t54 * t49;
  t240 = t239 * t225;
  t243 = t111 * t204;
  t246 = t201 * t203;
  t247 = t246 * t207;
  t248 = t123 * t247;
  t249 = t209 * t211;
  t250 = t31 * t216;
  t251 = t250 * t59;
  t252 = t249 * t251;
  t255 = t65 * t60;
  t256 = t255 * t247;
  t257 = t59 * t59;
  t258 = t250 * t257;
  t259 = t249 * t258;
  t262 = t127 * t247;
  t265 = t68 * t63;
  t266 = t265 * t247;
  t269 = t131 * t247;
  t272 = t71 * t66;
  t273 = t272 * t247;
  t276 = t135 * t247;
  t279 = -0.8e1 / 0.81e2 * t205 * t218 + 0.4e1 / 0.27e2 * t226 * t218 - 0.4e1 / 0.27e2 * t229 * t218 + 0.8e1 / 0.27e2 * t233 * t218 - 0.16e2 / 0.81e2 * t236 * t218 + 0.4e2 / 0.81e2 * t240 * t218 - 0.2e2 / 0.81e2 * t243 * t218 - 0.4e1 / 0.81e2 * t248 * t252 + 0.4e1 / 0.27e2 * t256 * t259 - 0.2e1 / 0.27e2 * t262 * t252 + 0.8e1 / 0.27e2 * t266 * t259 - 0.8e1 / 0.81e2 * t269 * t252 + 0.4e2 / 0.81e2 * t273 * t259 - 0.1e2 / 0.81e2 * t276 * t252;
  t281 = 0.1e1 / t34 / t213;
  t282 = t32 * t281;
  t283 = t282 * t59;
  t284 = t30 * t283;
  t292 = t88 * t89 * t281;
  t308 = t21 * t200 * t246;
  t312 = t45 * t223 * t246;
  t316 = t203 * t207;
  t317 = t58 * t201 * t316;
  t321 = t62 * t201 * t316;
  t324 = 0.11e2 / 0.9e1 * t128 * t284 + 0.44e2 / 0.27e2 * t132 * t284 + 0.55e2 / 0.27e2 * t136 * t284 + 0.44e2 / 0.27e2 * t108 * t292 + 0.55e2 / 0.27e2 * t112 * t292 + 0.22e2 / 0.27e2 * t124 * t284 + 0.22e2 / 0.27e2 * t100 * t292 + 0.11e2 / 0.9e1 * t104 * t292 + 0.11e2 / 0.27e2 * t87 * t292 + 0.11e2 / 0.27e2 * t117 * t284 - 0.4e1 / 0.81e2 * t308 * t218 + 0.4e1 / 0.81e2 * t312 * t218 - 0.2e1 / 0.81e2 * t317 * t252 + 0.4e1 / 0.81e2 * t321 * t259;
  t325 = t279 + t324;
  t330 = my_piecewise3(t2, 0, t6 * t192 * t74 / 0.12e2 - t6 * t80 * t139 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t325);
  tv2rho20 = 0.2e1 * rho[0] * t330 + 0.4e1 * t144;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t343 = t209 * t31;
  t344 = t213 * t33;
  t346 = 0.1e1 / t18 / t344;
  t347 = t346 * t257;
  t349 = t343 * t347 * sigma[0];
  t354 = t343 * t346 * sigma[0] * t59;
  t357 = t31 * t346;
  t359 = t210 * t357 * sigma[0];
  t380 = -t87 * t88 * t118 / 0.9e1 - t117 * t151 * t92 * t59 / 0.9e1 - 0.5e1 / 0.27e2 * t273 * t349 + 0.5e1 / 0.108e3 * t276 * t354 + t205 * t359 / 0.27e2 - t226 * t359 / 0.18e2 + t229 * t359 / 0.18e2 - t233 * t359 / 0.9e1 + 0.2e1 / 0.27e2 * t236 * t359 - 0.5e1 / 0.27e2 * t240 * t359 + 0.5e1 / 0.54e2 * t243 * t359 + t248 * t354 / 0.54e2 - t256 * t349 / 0.18e2 + t262 * t354 / 0.36e2;
  t386 = t116 * t151 * t92;
  t395 = t88 * t119;
  t412 = -t266 * t349 / 0.9e1 + t269 * t354 / 0.27e2 - 0.2e1 / 0.9e1 * t150 * t386 - t156 * t386 / 0.3e1 - 0.4e1 / 0.9e1 * t159 * t386 - 0.5e1 / 0.9e1 * t162 * t386 - 0.2e1 / 0.9e1 * t169 * t395 - t174 * t395 / 0.3e1 - 0.4e1 / 0.9e1 * t177 * t395 - 0.5e1 / 0.9e1 * t180 * t395 + t308 * t359 / 0.54e2 - t312 * t359 / 0.54e2 + t317 * t354 / 0.108e3 - t321 * t349 / 0.54e2;
  t413 = t380 + t412;
  t418 = my_piecewise3(t2, 0, -t6 * t80 * t183 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t413);
  tv2rhosigma0 = 0.2e1 * rho[0] * t418 + 0.2e1 * t187;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t421 = t213 * rho[0];
  t423 = 0.1e1 / t18 / t421;
  t424 = t31 * t423;
  t425 = t210 * t424;
  t430 = t97 * t202;
  t432 = t316 * t343 * t423;
  t435 = t221 * t224;
  t438 = t103 * t202;
  t441 = t232 * t224;
  t444 = t107 * t202;
  t447 = t239 * t224;
  t450 = t111 * t202;
  t461 = t123 * t246;
  t463 = t210 * t424 * t59;
  t466 = t255 * t246;
  t468 = t210 * t424 * t257;
  t471 = t127 * t246;
  t474 = t265 * t246;
  t477 = t131 * t246;
  t480 = t272 * t246;
  t483 = t135 * t246;
  t486 = -t308 * t425 / 0.144e3 + t312 * t425 / 0.144e3 - t430 * t432 / 0.72e2 + t435 * t432 / 0.48e2 - t438 * t432 / 0.48e2 + t441 * t432 / 0.24e2 - t444 * t432 / 0.36e2 + 0.5e1 / 0.72e2 * t447 * t432 - 0.5e1 / 0.144e3 * t450 * t432 - t317 * t343 * t423 * t59 / 0.288e3 + t321 * t343 * t423 * t257 / 0.144e3 - t461 * t463 / 0.144e3 + t466 * t468 / 0.48e2 - t471 * t463 / 0.96e2 + t474 * t468 / 0.24e2 - t477 * t463 / 0.72e2 + 0.5e1 / 0.72e2 * t480 * t468 - 0.5e1 / 0.288e3 * t483 * t463;
  t490 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t486);
  tv2sigma20 = 0.2e1 * rho[0] * t490;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t493 = t17 * t36;
  t504 = 0.1e1 / t222 / t41;
  t505 = t201 * params->mu;
  t506 = t504 * t505;
  t507 = t239 * t506;
  t508 = t24 * t24;
  t509 = 0.1e1 / t508;
  t511 = 0.1e1 / t208 / params->kappa;
  t512 = t509 * t511;
  t513 = t211 * sigma[0];
  t514 = t213 * t213;
  t515 = t514 * t90;
  t516 = 0.1e1 / t515;
  t518 = t512 * t513 * t516;
  t521 = t223 * t505;
  t522 = t111 * t521;
  t525 = t505 * t509;
  t526 = t123 * t525;
  t527 = t511 * t513;
  t529 = t527 * t516 * t59;
  t532 = t255 * t525;
  t534 = t527 * t516 * t257;
  t537 = t127 * t525;
  t540 = t68 * t60;
  t541 = t540 * t525;
  t542 = t257 * t59;
  t544 = t527 * t516 * t542;
  t547 = t265 * t525;
  t550 = t131 * t525;
  t553 = t71 * t63;
  t554 = t553 * t525;
  t557 = t272 * t525;
  t560 = t135 * t525;
  t563 = t97 * t521;
  t566 = t221 * t506;
  t569 = 0.32e3 / 0.81e2 * t507 * t518 - 0.8e2 / 0.81e2 * t522 * t518 - 0.16e2 / 0.243e3 * t526 * t529 + 0.16e2 / 0.27e2 * t532 * t534 - 0.8e1 / 0.81e2 * t537 * t529 - 0.64e2 / 0.81e2 * t541 * t544 + 0.32e2 / 0.27e2 * t547 * t534 - 0.32e2 / 0.243e3 * t550 * t529 - 0.16e3 / 0.81e2 * t554 * t544 + 0.16e3 / 0.81e2 * t557 * t534 - 0.4e2 / 0.243e3 * t560 * t529 - 0.32e2 / 0.81e2 * t563 * t518 + 0.32e2 / 0.27e2 * t566 * t518;
  t570 = t103 * t521;
  t573 = t51 * t43;
  t575 = 0.1e1 / t222 / t84;
  t576 = t575 * t505;
  t577 = t573 * t576;
  t580 = t232 * t506;
  t583 = t107 * t521;
  t586 = t54 * t46;
  t587 = t586 * t576;
  t591 = 0.1e1 / t34 / t421;
  t593 = t88 * t89 * t591;
  t596 = t32 * t591;
  t597 = t596 * t59;
  t598 = t30 * t597;
  t602 = 0.1e1 / t18 / t514;
  t603 = t31 * t602;
  t605 = t249 * t603 * t257;
  t609 = t210 * t212 * t602;
  t615 = t249 * t603 * t59;
  t619 = t21 * t223 * t505;
  t623 = t58 * t505 * t509;
  t626 = -0.16e2 / 0.27e2 * t570 * t518 - 0.64e2 / 0.81e2 * t577 * t518 + 0.64e2 / 0.27e2 * t580 * t518 - 0.64e2 / 0.81e2 * t583 * t518 - 0.16e3 / 0.81e2 * t587 * t518 - 0.154e3 / 0.81e2 * t87 * t593 - 0.154e3 / 0.81e2 * t117 * t598 - 0.44e2 / 0.81e2 * t321 * t605 - 0.44e2 / 0.81e2 * t312 * t609 + 0.44e2 / 0.81e2 * t308 * t609 + 0.22e2 / 0.81e2 * t317 * t615 - 0.16e2 / 0.81e2 * t619 * t518 - 0.8e1 / 0.243e3 * t623 * t529;
  t629 = t45 * t504 * t505;
  t633 = t48 * t575 * t505;
  t637 = t62 * t505 * t509;
  t641 = t65 * t505 * t509;
  t662 = 0.32e2 / 0.81e2 * t629 * t518 - 0.16e2 / 0.81e2 * t633 * t518 + 0.16e2 / 0.81e2 * t637 * t534 - 0.16e2 / 0.81e2 * t641 * t544 - 0.44e3 / 0.81e2 * t273 * t605 + 0.11e3 / 0.81e2 * t276 * t615 - 0.88e2 / 0.27e2 * t233 * t609 + 0.176e3 / 0.81e2 * t236 * t609 - 0.44e3 / 0.81e2 * t240 * t609 + 0.22e3 / 0.81e2 * t243 * t609 + 0.44e2 / 0.81e2 * t248 * t615 + 0.88e2 / 0.81e2 * t205 * t609 - 0.44e2 / 0.27e2 * t226 * t609;
  t689 = 0.44e2 / 0.27e2 * t229 * t609 - 0.308e3 / 0.81e2 * t124 * t598 - 0.308e3 / 0.81e2 * t100 * t593 - 0.154e3 / 0.27e2 * t104 * t593 - 0.77e3 / 0.81e2 * t136 * t598 - 0.616e3 / 0.81e2 * t108 * t593 - 0.77e3 / 0.81e2 * t112 * t593 - 0.154e3 / 0.27e2 * t128 * t598 - 0.616e3 / 0.81e2 * t132 * t598 - 0.44e2 / 0.27e2 * t256 * t605 + 0.22e2 / 0.27e2 * t262 * t615 - 0.88e2 / 0.27e2 * t266 * t605 + 0.88e2 / 0.81e2 * t269 * t615;
  t691 = t569 + t626 + t662 + t689;
  t696 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t493 * t74 + t6 * t192 * t139 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t80 * t325 - 0.3e1 / 0.8e1 * t6 * t19 * t691);
  tv3rho30 = 0.2e1 * rho[0] * t696 + 0.6e1 * t330;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t713 = t514 * t33;
  t714 = 0.1e1 / t713;
  t716 = t512 * t714 * t211;
  t723 = t511 * t714;
  t724 = t211 * t59;
  t725 = t723 * t724;
  t728 = t257 * t211;
  t729 = t723 * t728;
  t734 = t542 * t211;
  t735 = t723 * t734;
  t746 = 0.11e2 / 0.27e2 * t87 * t88 * t282 + 0.11e2 / 0.27e2 * t117 * t151 * t281 * t59 + 0.2e2 / 0.27e2 * t587 * t716 - 0.4e2 / 0.27e2 * t507 * t716 + 0.1e2 / 0.27e2 * t522 * t716 + 0.2e1 / 0.81e2 * t526 * t725 - 0.2e1 / 0.9e1 * t532 * t729 + t537 * t725 / 0.27e2 + 0.8e1 / 0.27e2 * t541 * t735 - 0.4e1 / 0.9e1 * t547 * t729 + 0.4e1 / 0.81e2 * t550 * t725 + 0.2e2 / 0.27e2 * t554 * t735 - 0.2e2 / 0.27e2 * t557 * t729;
  t761 = t88 * t283;
  t767 = t116 * t151 * t281;
  t776 = 0.5e1 / 0.81e2 * t560 * t725 + 0.4e1 / 0.27e2 * t563 * t716 - 0.4e1 / 0.9e1 * t566 * t716 + 0.2e1 / 0.9e1 * t570 * t716 + 0.8e1 / 0.27e2 * t577 * t716 - 0.8e1 / 0.9e1 * t580 * t716 + 0.8e1 / 0.27e2 * t583 * t716 + 0.11e2 / 0.9e1 * t174 * t761 + 0.44e2 / 0.27e2 * t177 * t761 + 0.22e2 / 0.27e2 * t150 * t767 + 0.11e2 / 0.9e1 * t156 * t767 + 0.44e2 / 0.27e2 * t159 * t767 + 0.55e2 / 0.27e2 * t162 * t767;
  t782 = t210 * sigma[0] * t31 * t216;
  t786 = t209 * sigma[0] * t258;
  t793 = t343 * t216 * sigma[0] * t59;
  t812 = 0.22e2 / 0.27e2 * t169 * t761 + t312 * t782 / 0.6e1 + t321 * t786 / 0.6e1 - t308 * t782 / 0.6e1 - t317 * t793 / 0.12e2 + 0.55e2 / 0.27e2 * t180 * t761 + 0.2e1 / 0.27e2 * t641 * t735 + 0.2e1 / 0.27e2 * t619 * t716 + t623 * t725 / 0.81e2 - 0.4e1 / 0.27e2 * t629 * t716 + 0.2e1 / 0.27e2 * t633 * t716 - 0.2e1 / 0.27e2 * t637 * t729 - t248 * t793 / 0.6e1;
  t837 = 0.5e1 / 0.3e1 * t273 * t786 - 0.5e1 / 0.12e2 * t276 * t793 + t256 * t786 / 0.2e1 - t262 * t793 / 0.4e1 + t266 * t786 - t269 * t793 / 0.3e1 - t205 * t782 / 0.3e1 + t226 * t782 / 0.2e1 - t229 * t782 / 0.2e1 + t233 * t782 - 0.2e1 / 0.3e1 * t236 * t782 + 0.5e1 / 0.3e1 * t240 * t782 - 0.5e1 / 0.6e1 * t243 * t782;
  t839 = t746 + t776 + t812 + t837;
  t844 = my_piecewise3(t2, 0, t6 * t192 * t183 / 0.12e2 - t6 * t80 * t413 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t839);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t844 + 0.4e1 * t418;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t850 = t514 * rho[0];
  t851 = 0.1e1 / t850;
  t853 = t512 * t851 * sigma[0];
  t860 = t210 * t357;
  t876 = t511 * t851;
  t877 = sigma[0] * t59;
  t878 = t876 * t877;
  t882 = t257 * sigma[0];
  t883 = t876 * t882;
  t888 = t542 * sigma[0];
  t889 = t876 * t888;
  t908 = t532 * t883 / 0.12e2 - t537 * t878 / 0.72e2 - t541 * t889 / 0.9e1 + t547 * t883 / 0.6e1 - t550 * t878 / 0.54e2 - 0.5e1 / 0.18e2 * t554 * t889 + 0.5e1 / 0.18e2 * t557 * t883 - 0.5e1 / 0.216e3 * t560 * t878 - t563 * t853 / 0.18e2 + t566 * t853 / 0.6e1 - t570 * t853 / 0.12e2;
  t913 = t210 * t357 * t59;
  t917 = t316 * t343 * t346;
  t931 = t210 * t357 * t257;
  t959 = -0.1e2 / 0.27e2 * t480 * t931 - t466 * t931 / 0.9e1 + t471 * t913 / 0.18e2 - 0.1e2 / 0.27e2 * t447 * t917 + 0.5e1 / 0.27e2 * t450 * t917 - t619 * t853 / 0.36e2 + t629 * t853 / 0.18e2 - t633 * t853 / 0.36e2 - t623 * t878 / 0.216e3 + t637 * t883 / 0.36e2 - t641 * t889 / 0.36e2;
  t961 = t580 * t853 / 0.3e1 - t583 * t853 / 0.9e1 - 0.5e1 / 0.18e2 * t587 * t853 + t308 * t860 / 0.27e2 - t312 * t860 / 0.27e2 + t317 * t343 * t346 * t59 / 0.54e2 - t321 * t343 * t347 / 0.27e2 + 0.5e1 / 0.9e1 * t507 * t853 - 0.5e1 / 0.36e2 * t522 * t853 - t526 * t878 / 0.108e3 + t908 - t577 * t853 / 0.9e1 + t461 * t913 / 0.27e2 + t438 * t917 / 0.9e1 - 0.2e1 / 0.9e1 * t441 * t917 + 0.4e1 / 0.27e2 * t444 * t917 + 0.2e1 / 0.27e2 * t430 * t917 - t435 * t917 / 0.9e1 + 0.5e1 / 0.54e2 * t483 * t913 - 0.2e1 / 0.9e1 * t474 * t931 + 0.2e1 / 0.27e2 * t477 * t913 + t959;
  t966 = my_piecewise3(t2, 0, -t6 * t80 * t486 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t961);
  tv3rhosigma20 = 0.2e1 * rho[0] * t966 + 0.2e1 * t490;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t969 = t97 * t223;
  t970 = 0.1e1 / t514;
  t971 = t511 * t970;
  t972 = t525 * t971;
  t975 = t221 * t504;
  t978 = t103 * t223;
  t981 = t573 * t575;
  t984 = t232 * t504;
  t987 = t107 * t223;
  t990 = t586 * t575;
  t993 = t239 * t504;
  t996 = t111 * t223;
  t999 = t123 * t505;
  t1001 = t512 * t970 * t59;
  t1004 = t255 * t505;
  t1006 = t512 * t970 * t257;
  t1009 = t127 * t505;
  t1012 = t969 * t972 / 0.48e2 - t975 * t972 / 0.16e2 + t978 * t972 / 0.32e2 + t981 * t972 / 0.24e2 - t984 * t972 / 0.8e1 + t987 * t972 / 0.24e2 + 0.5e1 / 0.48e2 * t990 * t972 - 0.5e1 / 0.24e2 * t993 * t972 + 0.5e1 / 0.96e2 * t996 * t972 + t999 * t1001 / 0.288e3 - t1004 * t1006 / 0.32e2 + t1009 * t1001 / 0.192e3;
  t1013 = t540 * t505;
  t1015 = t512 * t970 * t542;
  t1018 = t265 * t505;
  t1021 = t131 * t505;
  t1024 = t553 * t505;
  t1027 = t272 * t505;
  t1030 = t135 * t505;
  t1033 = t512 * t970;
  t1049 = t1013 * t1015 / 0.24e2 - t1018 * t1006 / 0.16e2 + t1021 * t1001 / 0.144e3 + 0.5e1 / 0.48e2 * t1024 * t1015 - 0.5e1 / 0.48e2 * t1027 * t1006 + 0.5e1 / 0.576e3 * t1030 * t1001 + t619 * t1033 / 0.96e2 - t629 * t1033 / 0.48e2 + t633 * t1033 / 0.96e2 + t623 * t971 * t59 / 0.576e3 - t637 * t971 * t257 / 0.96e2 + t641 * t971 * t542 / 0.96e2;
  t1050 = t1012 + t1049;
  t1054 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1050);
  tv3sigma30 = 0.2e1 * rho[0] * t1054;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1070 = t514 * t213;
  t1071 = 0.1e1 / t1070;
  t1073 = t512 * t513 * t1071;
  t1079 = t527 * t1071 * t257;
  t1083 = t527 * t1071 * t542;
  t1087 = t527 * t1071 * t59;
  t1092 = t201 * t201;
  t1094 = t504 * t1092 * t509;
  t1095 = t111 * t1094;
  t1096 = t208 * t208;
  t1097 = 0.1e1 / t1096;
  t1098 = t211 * t211;
  t1099 = t1097 * t1098;
  t1102 = 0.1e1 / t34 / t514 / t344;
  t1104 = t116 * t32;
  t1105 = t1099 * t1102 * t1104;
  t1108 = t1092 * t509;
  t1109 = t1108 * t1097;
  t1110 = t123 * t1109;
  t1111 = t1098 * t1102;
  t1114 = t27 * t32 * t59;
  t1115 = t1111 * t22 * t1114;
  t1118 = t255 * t1109;
  t1120 = t1111 * t257 * t1104;
  t1123 = t127 * t1109;
  t1126 = t540 * t1109;
  t1128 = t1111 * t542 * t1104;
  t1131 = t265 * t1109;
  t1134 = t131 * t1109;
  t1137 = t272 * t1109;
  t1140 = t135 * t1109;
  t1143 = t97 * t1094;
  t1147 = t575 * t1092 * t509;
  t1148 = t221 * t1147;
  t1152 = t71 * t60 * t1109;
  t1153 = t257 * t257;
  t1158 = t553 * t1109;
  t1161 = t103 * t1094;
  t1164 = -0.704e3 / 0.81e2 * t629 * t1073 + 0.352e3 / 0.81e2 * t633 * t1073 - 0.352e3 / 0.81e2 * t637 * t1079 + 0.352e3 / 0.81e2 * t641 * t1083 + 0.176e3 / 0.243e3 * t623 * t1087 + 0.352e3 / 0.81e2 * t619 * t1073 - 0.32e3 / 0.729e3 * t1095 * t1105 - 0.16e2 / 0.2187e4 * t1110 * t1115 + 0.112e3 / 0.729e3 * t1118 * t1120 - 0.8e1 / 0.729e3 * t1123 * t1115 - 0.128e3 / 0.243e3 * t1126 * t1128 + 0.224e3 / 0.729e3 * t1131 * t1120 - 0.32e2 / 0.2187e4 * t1134 * t1115 + 0.112e4 / 0.2187e4 * t1137 * t1120 - 0.4e2 / 0.2187e4 * t1140 * t1115 - 0.128e3 / 0.729e3 * t1143 * t1105 + 0.64e2 / 0.81e2 * t1148 * t1105 + 0.32e3 / 0.729e3 * t1152 * t1111 * t1153 * t1104 - 0.32e3 / 0.243e3 * t1158 * t1128 - 0.64e2 / 0.243e3 * t1161 * t1105;
  t1166 = 0.1e1 / t222 / t199;
  t1168 = t1166 * t1092 * t509;
  t1169 = t573 * t1168;
  t1172 = t232 * t1147;
  t1175 = t107 * t1094;
  t1179 = t222 * t222;
  t1180 = 0.1e1 / t1179;
  t1183 = t54 * t43 * t1180 * t1092 * t509;
  t1186 = t586 * t1168;
  t1189 = t239 * t1147;
  t1220 = -0.256e3 / 0.243e3 * t1169 * t1105 + 0.128e3 / 0.81e2 * t1172 * t1105 - 0.256e3 / 0.729e3 * t1175 * t1105 + 0.32e3 / 0.729e3 * t1183 * t1105 - 0.64e3 / 0.243e3 * t1186 * t1105 + 0.64e3 / 0.243e3 * t1189 * t1105 - 0.704e3 / 0.27e2 * t566 * t1073 + 0.352e3 / 0.27e2 * t570 * t1073 - 0.352e3 / 0.27e2 * t532 * t1079 + 0.176e3 / 0.81e2 * t537 * t1087 + 0.1408e4 / 0.81e2 * t541 * t1083 - 0.704e3 / 0.27e2 * t547 * t1079 + 0.352e4 / 0.81e2 * t587 * t1073 - 0.704e4 / 0.81e2 * t507 * t1073 + 0.176e4 / 0.81e2 * t522 * t1073 + 0.352e3 / 0.243e3 * t526 * t1087 + 0.1408e4 / 0.81e2 * t577 * t1073 - 0.1408e4 / 0.27e2 * t580 * t1073 + 0.1408e4 / 0.81e2 * t583 * t1073 + 0.88e3 / 0.243e3 * t560 * t1087;
  t1231 = 0.1e1 / t34 / t344;
  t1233 = t88 * t89 * t1231;
  t1238 = t30 * t32 * t1231 * t59;
  t1242 = 0.1e1 / t18 / t850;
  t1243 = t31 * t1242;
  t1245 = t249 * t1243 * t59;
  t1249 = t249 * t1243 * t257;
  t1253 = t210 * t212 * t1242;
  t1260 = t58 * t1092;
  t1261 = t509 * t1097;
  t1262 = t1261 * t1098;
  t1268 = t45 * t575;
  t1270 = t1111 * t1104;
  t1273 = t48 * t1166;
  t1277 = t62 * t1092;
  t1283 = t65 * t1092;
  t1289 = t21 * t504;
  t1290 = t1289 * t1109;
  t1293 = t51 * t1180;
  t1294 = t1092 * t22;
  t1295 = t1294 * t27;
  t1296 = t1293 * t1295;
  t1306 = 0.704e3 / 0.81e2 * t563 * t1073 + 0.704e3 / 0.243e3 * t550 * t1087 + 0.352e4 / 0.81e2 * t554 * t1083 - 0.352e4 / 0.81e2 * t557 * t1079 + 0.2618e4 / 0.243e3 * t87 * t1233 + 0.2618e4 / 0.243e3 * t117 * t1238 - 0.1958e4 / 0.729e3 * t317 * t1245 + 0.3916e4 / 0.729e3 * t321 * t1249 + 0.3916e4 / 0.729e3 * t312 * t1253 - 0.3916e4 / 0.729e3 * t308 * t1253 - 0.3916e4 / 0.729e3 * t248 * t1245 - 0.8e1 / 0.2187e4 * t1260 * t1262 * t1102 * t22 * t1114 + 0.64e2 / 0.243e3 * t1268 * t1109 * t1270 - 0.64e2 / 0.243e3 * t1273 * t1109 * t1270 + 0.112e3 / 0.2187e4 * t1277 * t1262 * t1102 * t257 * t1104 - 0.32e2 / 0.243e3 * t1283 * t1262 * t1102 * t542 * t1104 - 0.64e2 / 0.729e3 * t1290 * t1270 + 0.64e2 / 0.729e3 * t1296 * t1099 * t32 * t1102 * t509 + 0.1309e5 / 0.243e3 * t112 * t1233 + 0.2618e4 / 0.81e2 * t128 * t1238;
  t1345 = t68 * t1092;
  t1346 = t116 * t1097;
  t1347 = t1345 * t1346;
  t1354 = 0.10472e5 / 0.243e3 * t132 * t1238 + 0.2618e4 / 0.81e2 * t104 * t1233 + 0.1309e5 / 0.243e3 * t136 * t1238 + 0.10472e5 / 0.243e3 * t108 * t1233 + 0.5236e4 / 0.243e3 * t124 * t1238 + 0.5236e4 / 0.243e3 * t100 * t1233 + 0.3916e5 / 0.729e3 * t240 * t1253 - 0.1958e5 / 0.729e3 * t243 * t1253 + 0.3916e4 / 0.243e3 * t256 * t1249 - 0.1958e4 / 0.243e3 * t262 * t1245 + 0.7832e4 / 0.243e3 * t266 * t1249 - 0.7832e4 / 0.729e3 * t269 * t1245 - 0.7832e4 / 0.729e3 * t205 * t1253 + 0.3916e4 / 0.243e3 * t226 * t1253 - 0.3916e4 / 0.243e3 * t229 * t1253 + 0.3916e5 / 0.729e3 * t273 * t1249 - 0.979e4 / 0.729e3 * t276 * t1245 + 0.7832e4 / 0.243e3 * t233 * t1253 - 0.15664e5 / 0.729e3 * t236 * t1253 + 0.64e2 / 0.729e3 * t1347 * t1098 * t32 * t1102 * t1153 * t509;
  t1361 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t92 * t74 - 0.5e1 / 0.9e1 * t6 * t493 * t139 + t6 * t192 * t325 / 0.2e1 - t6 * t80 * t691 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1164 + t1220 + t1306 + t1354));
  tv4rho40 = 0.2e1 * rho[0] * t1361 + 0.8e1 * t696;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1374 = t1268 * t1295;
  t1378 = 0.1e1 / t34 / t514 / t421;
  t1381 = t1097 * t513 * t32 * t1378 * t509;
  t1384 = t1273 * t1295;
  t1387 = t1378 * t513;
  t1399 = t1277 * t1346;
  t1400 = t513 * t32;
  t1401 = t1378 * t257;
  t1406 = t1283 * t1346;
  t1407 = t1378 * t542;
  t1412 = t1378 * t1153;
  t1419 = t343 * t602 * t257 * sigma[0];
  t1424 = t343 * t602 * sigma[0] * t59;
  t1428 = t512 * t516 * t211;
  t1437 = t511 * t516;
  t1438 = t1437 * t724;
  t1441 = t1437 * t734;
  t1444 = t1437 * t728;
  t1453 = -0.8e1 / 0.81e2 * t1374 * t1381 + 0.8e1 / 0.81e2 * t1384 * t1381 + 0.8e1 / 0.243e3 * t1290 * t1387 * t1104 + t1260 * t1261 * t1378 * t513 * t22 * t1114 / 0.729e3 - 0.8e1 / 0.243e3 * t1296 * t1381 - 0.14e2 / 0.729e3 * t1399 * t1400 * t1401 * t509 + 0.4e1 / 0.81e2 * t1406 * t1400 * t1407 * t509 - 0.8e1 / 0.243e3 * t1347 * t1400 * t1412 * t509 - 0.341e4 / 0.243e3 * t273 * t1419 + 0.1705e4 / 0.486e3 * t276 * t1424 - 0.38e2 / 0.9e1 * t570 * t1428 - 0.152e3 / 0.27e2 * t577 * t1428 + 0.76e2 / 0.9e1 * t566 * t1428 - 0.76e2 / 0.27e2 * t563 * t1428 - 0.19e2 / 0.27e2 * t537 * t1438 - 0.152e3 / 0.27e2 * t541 * t1441 + 0.76e2 / 0.9e1 * t547 * t1444 - 0.76e2 / 0.81e2 * t550 * t1438 + 0.76e3 / 0.27e2 * t507 * t1428 - 0.19e3 / 0.27e2 * t522 * t1428;
  t1490 = t1387 * t22 * t1114;
  t1498 = t1407 * t513 * t1104;
  t1502 = t1401 * t513 * t1104;
  t1505 = -0.38e2 / 0.81e2 * t526 * t1438 + 0.38e2 / 0.9e1 * t532 * t1444 + 0.152e3 / 0.9e1 * t580 * t1428 - 0.152e3 / 0.27e2 * t583 * t1428 - 0.38e3 / 0.27e2 * t587 * t1428 - 0.38e3 / 0.27e2 * t554 * t1441 + 0.38e3 / 0.27e2 * t557 * t1444 - 0.95e2 / 0.81e2 * t560 * t1438 - 0.154e3 / 0.81e2 * t87 * t88 * t596 - 0.154e3 / 0.81e2 * t117 * t151 * t591 * t59 - 0.38e2 / 0.27e2 * t633 * t1428 + 0.38e2 / 0.27e2 * t637 * t1444 - 0.38e2 / 0.27e2 * t641 * t1441 - 0.38e2 / 0.27e2 * t619 * t1428 - 0.19e2 / 0.81e2 * t623 * t1438 + 0.76e2 / 0.27e2 * t629 * t1428 + 0.4e1 / 0.729e3 * t1134 * t1490 - 0.4e2 / 0.243e3 * t1152 * t1412 * t513 * t1104 + 0.4e2 / 0.81e2 * t1158 * t1498 - 0.14e3 / 0.729e3 * t1137 * t1502;
  t1511 = t1097 * t1378 * t513 * t1104;
  t1545 = t116 * t151 * t591;
  t1548 = t88 * t597;
  t1553 = 0.5e1 / 0.729e3 * t1140 * t1490 + 0.16e2 / 0.243e3 * t1143 * t1511 - 0.8e1 / 0.27e2 * t1148 * t1511 + 0.8e1 / 0.81e2 * t1161 * t1511 + 0.32e2 / 0.81e2 * t1169 * t1511 - 0.16e2 / 0.27e2 * t1172 * t1511 + 0.32e2 / 0.243e3 * t1175 * t1511 - 0.4e2 / 0.243e3 * t1183 * t1511 + 0.8e2 / 0.81e2 * t1186 * t1511 - 0.8e2 / 0.81e2 * t1189 * t1511 + 0.4e2 / 0.243e3 * t1095 * t1511 + 0.2e1 / 0.729e3 * t1110 * t1490 - 0.14e2 / 0.243e3 * t1118 * t1502 + t1123 * t1490 / 0.243e3 + 0.16e2 / 0.81e2 * t1126 * t1498 - 0.28e2 / 0.243e3 * t1131 * t1502 - 0.341e3 / 0.243e3 * t321 * t1419 - 0.77e3 / 0.81e2 * t162 * t1545 - 0.308e3 / 0.81e2 * t169 * t1548 - 0.616e3 / 0.81e2 * t159 * t1545;
  t1565 = t210 * t603 * sigma[0];
  t1596 = -0.308e3 / 0.81e2 * t150 * t1545 - 0.154e3 / 0.27e2 * t156 * t1545 - 0.154e3 / 0.27e2 * t174 * t1548 - 0.616e3 / 0.81e2 * t177 * t1548 - 0.77e3 / 0.81e2 * t180 * t1548 + 0.341e3 / 0.243e3 * t308 * t1565 + 0.341e3 / 0.486e3 * t317 * t1424 - 0.341e3 / 0.243e3 * t312 * t1565 - 0.341e4 / 0.243e3 * t240 * t1565 + 0.1705e4 / 0.243e3 * t243 * t1565 + 0.341e3 / 0.243e3 * t248 * t1424 + 0.341e3 / 0.81e2 * t229 * t1565 - 0.682e3 / 0.81e2 * t233 * t1565 + 0.1364e4 / 0.243e3 * t236 * t1565 + 0.682e3 / 0.243e3 * t205 * t1565 - 0.341e3 / 0.81e2 * t226 * t1565 - 0.341e3 / 0.81e2 * t256 * t1419 + 0.341e3 / 0.162e3 * t262 * t1424 - 0.682e3 / 0.81e2 * t266 * t1419 + 0.682e3 / 0.243e3 * t269 * t1424;
  t1603 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t493 * t183 + t6 * t192 * t413 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t80 * t839 - 0.3e1 / 0.8e1 * t6 * t19 * (t1453 + t1505 + t1553 + t1596));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1603 + 0.6e1 * t844;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1613 = t211 * t32;
  t1615 = 0.1e1 / t34 / t1070;
  t1616 = t1615 * t257;
  t1621 = t1615 * t542;
  t1626 = t1615 * t1153;
  t1634 = t1097 * t211 * t32 * t1615 * t509;
  t1641 = t1615 * t211;
  t1651 = t723 * t877;
  t1655 = t512 * t714 * sigma[0];
  t1668 = t723 * t882;
  t1673 = 0.7e1 / 0.972e3 * t1399 * t1613 * t1616 * t509 - t1406 * t1613 * t1621 * t509 / 0.54e2 + t1347 * t1613 * t1626 * t509 / 0.81e2 + t1374 * t1634 / 0.27e2 - t1384 * t1634 / 0.27e2 + t1296 * t1634 / 0.81e2 - t1290 * t1641 * t1104 / 0.81e2 - t1260 * t1261 * t1615 * t211 * t22 * t1114 / 0.1944e4 + 0.43e2 / 0.324e3 * t526 * t1651 - 0.43e2 / 0.18e2 * t566 * t1655 + 0.43e2 / 0.36e2 * t570 * t1655 + 0.43e2 / 0.27e2 * t577 * t1655 - 0.43e2 / 0.9e1 * t580 * t1655 + 0.43e2 / 0.27e2 * t583 * t1655 + 0.43e2 / 0.54e2 * t563 * t1655 - 0.215e3 / 0.54e2 * t557 * t1668 + 0.215e3 / 0.648e3 * t560 * t1651;
  t1674 = t723 * t888;
  t1697 = t210 * t250;
  t1716 = 0.43e2 / 0.27e2 * t541 * t1674 - 0.43e2 / 0.18e2 * t547 * t1668 + 0.43e2 / 0.162e3 * t550 * t1651 + 0.215e3 / 0.54e2 * t554 * t1674 - 0.43e2 / 0.36e2 * t532 * t1668 + 0.43e2 / 0.216e3 * t537 * t1651 + 0.215e3 / 0.54e2 * t587 * t1655 - 0.215e3 / 0.27e2 * t507 * t1655 + 0.215e3 / 0.108e3 * t522 * t1655 + 0.19e2 / 0.81e2 * t321 * t343 * t216 * t257 - 0.19e2 / 0.81e2 * t308 * t1697 + 0.19e2 / 0.81e2 * t312 * t1697 - 0.19e2 / 0.162e3 * t317 * t343 * t216 * t59 + 0.43e2 / 0.108e3 * t641 * t1674 - 0.43e2 / 0.108e3 * t637 * t1668 - 0.43e2 / 0.54e2 * t629 * t1655 + 0.43e2 / 0.108e3 * t633 * t1655 + 0.43e2 / 0.648e3 * t623 * t1651;
  t1722 = t1097 * t1615 * t211 * t1104;
  t1728 = t1641 * t22 * t1114;
  t1732 = t1616 * t211 * t1104;
  t1738 = t1621 * t211 * t1104;
  t1763 = 0.43e2 / 0.108e3 * t619 * t1655 + 0.1e2 / 0.27e2 * t1189 * t1722 - 0.5e1 / 0.81e2 * t1095 * t1722 - t1110 * t1728 / 0.972e3 + 0.7e1 / 0.324e3 * t1118 * t1732 - t1123 * t1728 / 0.648e3 - 0.2e1 / 0.27e2 * t1126 * t1738 + 0.7e1 / 0.162e3 * t1131 * t1732 - t1134 * t1728 / 0.486e3 + 0.5e1 / 0.81e2 * t1152 * t1626 * t211 * t1104 - 0.5e1 / 0.27e2 * t1158 * t1738 + 0.35e2 / 0.486e3 * t1137 * t1732 - 0.5e1 / 0.1944e4 * t1140 * t1728 - 0.2e1 / 0.81e2 * t1143 * t1722 + t1148 * t1722 / 0.9e1 - t1161 * t1722 / 0.27e2 - 0.4e1 / 0.27e2 * t1169 * t1722;
  t1772 = t210 * t258;
  t1775 = t210 * t251;
  t1779 = t316 * t343 * t216;
  t1804 = 0.2e1 / 0.9e1 * t1172 * t1722 - 0.4e1 / 0.81e2 * t1175 * t1722 + 0.5e1 / 0.81e2 * t1183 * t1722 - 0.1e2 / 0.27e2 * t1186 * t1722 + 0.19e3 / 0.81e2 * t480 * t1772 - 0.95e2 / 0.162e3 * t483 * t1775 + 0.19e2 / 0.27e2 * t435 * t1779 + 0.38e2 / 0.27e2 * t441 * t1779 - 0.76e2 / 0.81e2 * t444 * t1779 - 0.38e2 / 0.81e2 * t430 * t1779 - 0.95e2 / 0.81e2 * t450 * t1779 - 0.19e2 / 0.81e2 * t461 * t1775 - 0.19e2 / 0.27e2 * t438 * t1779 + 0.19e2 / 0.27e2 * t466 * t1772 - 0.19e2 / 0.54e2 * t471 * t1775 + 0.19e3 / 0.81e2 * t447 * t1779 + 0.38e2 / 0.27e2 * t474 * t1772 - 0.38e2 / 0.81e2 * t477 * t1775;
  t1811 = my_piecewise3(t2, 0, t6 * t192 * t486 / 0.12e2 - t6 * t80 * t961 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1673 + t1716 + t1763 + t1804));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1811 + 0.4e1 * t966;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1818 = 0.1e1 / t34 / t515;
  t1819 = t1818 * t22;
  t1821 = t27 * sigma[0] * t32;
  t1827 = t89 * t59;
  t1834 = t1097 * sigma[0] * t32 * t1818 * t509;
  t1841 = t1818 * t257;
  t1846 = t1818 * t542;
  t1851 = t1818 * t1153;
  t1857 = t512 * t851 * t542;
  t1861 = t512 * t851 * t257;
  t1865 = t512 * t851 * t59;
  t1868 = t525 * t876;
  t1873 = t1290 * t1819 * t1821 / 0.216e3 + t1260 * t1261 * t1818 * t116 * t1827 / 0.5184e4 - t1374 * t1834 / 0.72e2 + t1384 * t1834 / 0.72e2 - t1296 * t1834 / 0.216e3 - 0.7e1 / 0.2592e4 * t1399 * t89 * t1841 * t509 + t1406 * t89 * t1846 * t509 / 0.144e3 - t1347 * t89 * t1851 * t509 / 0.216e3 - t1013 * t1857 / 0.3e1 + t1018 * t1861 / 0.2e1 - t1021 * t1865 / 0.18e2 - t987 * t1868 / 0.3e1 - 0.5e1 / 0.6e1 * t990 * t1868;
  t1899 = 0.5e1 / 0.3e1 * t993 * t1868 - 0.5e1 / 0.12e2 * t996 * t1868 - t999 * t1865 / 0.36e2 + t1004 * t1861 / 0.4e1 + t975 * t1868 / 0.2e1 - t978 * t1868 / 0.4e1 - t981 * t1868 / 0.3e1 + t984 * t1868 - t969 * t1868 / 0.6e1 - 0.5e1 / 0.6e1 * t1024 * t1857 + 0.5e1 / 0.6e1 * t1027 * t1861 - 0.5e1 / 0.72e2 * t1030 * t1865 - t1009 * t1865 / 0.24e2;
  t1902 = t1819 * t27 * t1827;
  t1910 = t1846 * t22 * t1821;
  t1914 = t1841 * t22 * t1821;
  t1921 = t1097 * t1818 * t22 * t1821;
  t1938 = t1134 * t1902 / 0.1296e4 - 0.5e1 / 0.216e3 * t1152 * t1851 * t22 * t1821 + 0.5e1 / 0.72e2 * t1158 * t1910 - 0.35e2 / 0.1296e4 * t1137 * t1914 + 0.5e1 / 0.5184e4 * t1140 * t1902 + t1143 * t1921 / 0.108e3 - t1148 * t1921 / 0.24e2 + t1161 * t1921 / 0.72e2 + t1169 * t1921 / 0.18e2 - t1172 * t1921 / 0.12e2 + t1175 * t1921 / 0.54e2 - 0.5e1 / 0.216e3 * t1183 * t1921 + 0.5e1 / 0.36e2 * t1186 * t1921;
  t1959 = t512 * t851;
  t1969 = -0.5e1 / 0.36e2 * t1189 * t1921 + 0.5e1 / 0.216e3 * t1095 * t1921 + t1110 * t1902 / 0.2592e4 - 0.7e1 / 0.864e3 * t1118 * t1914 + t1123 * t1902 / 0.1728e4 + t1126 * t1910 / 0.36e2 - 0.7e1 / 0.432e3 * t1131 * t1914 + t637 * t876 * t257 / 0.12e2 - t641 * t876 * t542 / 0.12e2 - t619 * t1959 / 0.12e2 + t629 * t1959 / 0.6e1 - t633 * t1959 / 0.12e2 - t623 * t876 * t59 / 0.72e2;
  t1976 = my_piecewise3(t2, 0, -t6 * t80 * t1050 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1873 + t1899 + t1938 + t1969));
  tv4rhosigma30 = 0.2e1 * rho[0] * t1976 + 0.2e1 * t1054;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1980 = 0.1e1 / t34 / t713;
  t1982 = t1097 * t1980 * t1104;
  t1987 = t1980 * t257;
  t1988 = t1987 * t1104;
  t1992 = t1980 * t22 * t1114;
  t2015 = -t1143 * t1982 / 0.288e3 + t1148 * t1982 / 0.64e2 + 0.35e2 / 0.3456e4 * t1137 * t1988 - 0.5e1 / 0.13824e5 * t1140 * t1992 - t1161 * t1982 / 0.192e3 - t1169 * t1982 / 0.48e2 + t1172 * t1982 / 0.32e2 - t1175 * t1982 / 0.144e3 + 0.5e1 / 0.576e3 * t1183 * t1982 - 0.5e1 / 0.96e2 * t1186 * t1982 + 0.5e1 / 0.96e2 * t1189 * t1982 - 0.5e1 / 0.576e3 * t1095 * t1982 - t1110 * t1992 / 0.6912e4 + 0.7e1 / 0.2304e4 * t1118 * t1988;
  t2018 = t1980 * t542;
  t2019 = t2018 * t1104;
  t2026 = t1980 * t1153;
  t2033 = t1097 * t32;
  t2048 = t27 * t1097 * t32 * t1980 * t509;
  t2067 = -t1123 * t1992 / 0.4608e4 - t1126 * t2019 / 0.96e2 + 0.7e1 / 0.1152e4 * t1131 * t1988 - t1134 * t1992 / 0.3456e4 + 0.5e1 / 0.576e3 * t1152 * t2026 * t1104 - 0.5e1 / 0.192e3 * t1158 * t2019 + t1345 * t116 * t2033 * t2026 * t509 / 0.576e3 - t1289 * t1108 * t1982 / 0.576e3 - t1260 * t1261 * t1992 / 0.13824e5 + t1268 * t1294 * t2048 / 0.192e3 - t1273 * t1294 * t2048 / 0.192e3 + t1293 * t1294 * t2048 / 0.576e3 + 0.7e1 / 0.6912e4 * t1277 * t116 * t2033 * t1987 * t509 - t1283 * t116 * t2033 * t2018 * t509 / 0.384e3;
  t2072 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (t2015 + t2067));
  tv4sigma40 = 0.2e1 * rho[0] * t2072;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t43, t46, t47, t49, t51, t52;
  double t54, t55, t57, t58, t60, t63, t64, t65;
  double t66, t68, t69, t71, t72, t74, t75, t77;
  double t80, t84, t85, t86, t88, t89, t90, t91;
  double t93, t94, t95, t96, t97, t98, t100, t103;
  double t104, t106, t108, t110, t112, t116, t117, t119;
  double t121, t123, t127, t131, tzk0;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->a[0];
  t29 = params->a[1];
  t30 = M_CBRT6;
  t31 = params->mu * t30;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = 0.1e1 / params->kappa;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = t36 * t38 * t43 / 0.24e2;
  t47 = 0.1e1 + t46;
  t49 = 0.1e1 - 0.1e1 / t47;
  t51 = params->a[2];
  t52 = t49 * t49;
  t54 = params->a[3];
  t55 = t52 * t49;
  t57 = params->a[4];
  t58 = t52 * t52;
  t60 = params->a[5];
  t63 = params->b[0];
  t64 = params->b[1];
  t65 = exp(-t46);
  t66 = 0.1e1 - t65;
  t68 = params->b[2];
  t69 = t66 * t66;
  t71 = params->b[3];
  t72 = t69 * t66;
  t74 = params->b[4];
  t75 = t69 * t69;
  t77 = params->b[5];
  t80 = t60 * t58 * t49 + t77 * t75 * t66 + t29 * t49 + t51 * t52 + t54 * t55 + t57 * t58 + t64 * t66 + t68 * t69 + t71 * t72 + t74 * t75 + t28 + t63;
  t84 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t80);
  t85 = rho[1] <= p->dens_threshold;
  t86 = -t16;
  t88 = my_piecewise5(t14, t11, t10, t15, t86 * t7);
  t89 = 0.1e1 + t88;
  t90 = t89 <= p->zeta_threshold;
  t91 = POW_1_3(t89);
  t93 = my_piecewise3(t90, t22, t91 * t89);
  t94 = t93 * t26;
  t95 = t37 * sigma[2];
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t103 = t36 * t95 * t100 / 0.24e2;
  t104 = 0.1e1 + t103;
  t106 = 0.1e1 - 0.1e1 / t104;
  t108 = t106 * t106;
  t110 = t108 * t106;
  t112 = t108 * t108;
  t116 = exp(-t103);
  t117 = 0.1e1 - t116;
  t119 = t117 * t117;
  t121 = t119 * t117;
  t123 = t119 * t119;
  t127 = t60 * t112 * t106 + t77 * t123 * t117 + t29 * t106 + t51 * t108 + t54 * t110 + t57 * t112 + t64 * t117 + t68 * t119 + t71 * t121 + t74 * t123 + t28 + t63;
  t131 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t127);
  tzk0 = t84 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t43, t46, t47, t49, t51, t52;
  double t54, t55, t57, t58, t60, t63, t64, t65;
  double t66, t68, t69, t71, t72, t74, t75, t77;
  double t80, t84, t85, t86, t88, t89, t90, t91;
  double t93, t94, t95, t96, t97, t98, t100, t103;
  double t104, t106, t108, t110, t112, t116, t117, t119;
  double t121, t123, t127, t131, tzk0;

  double t132, t133, t134, t136, t139, t140, t144, t145;
  double t146, t149, t150, t151, t152, t153, t154, t155;
  double t157, t158, t162, t163, t164, t165, t167, t170;
  double t171, t174, t175, t178, t179, t182, t183, t184;
  double t188, t189, t191, t194, t195, t198, t199, t202;
  double t203, t206, t211, t212, t214, t217, t218, t222;
  double t225, t227, tvrho0, t231, t234, t235, t240, t242;
  double t245, t246, t250, t251, t252, t253, t254, t256;
  double t257, t261, t262, t263, t265, t268, t269, t272;
  double t273, t276, t277, t280, t284, t285, t287, t290;
  double t291, t294, t295, t298, t299, t302, t307, tvrho1;
  double t310, t312, t323, t325, t336, t340, tvsigma0, tvsigma1;
  double t341, t343, t355, t366, t370, tvsigma2;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->a[0];
  t29 = params->a[1];
  t30 = M_CBRT6;
  t31 = params->mu * t30;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = 0.1e1 / params->kappa;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = t36 * t38 * t43 / 0.24e2;
  t47 = 0.1e1 + t46;
  t49 = 0.1e1 - 0.1e1 / t47;
  t51 = params->a[2];
  t52 = t49 * t49;
  t54 = params->a[3];
  t55 = t52 * t49;
  t57 = params->a[4];
  t58 = t52 * t52;
  t60 = params->a[5];
  t63 = params->b[0];
  t64 = params->b[1];
  t65 = exp(-t46);
  t66 = 0.1e1 - t65;
  t68 = params->b[2];
  t69 = t66 * t66;
  t71 = params->b[3];
  t72 = t69 * t66;
  t74 = params->b[4];
  t75 = t69 * t69;
  t77 = params->b[5];
  t80 = t60 * t58 * t49 + t77 * t75 * t66 + t29 * t49 + t51 * t52 + t54 * t55 + t57 * t58 + t64 * t66 + t68 * t69 + t71 * t72 + t74 * t75 + t28 + t63;
  t84 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t80);
  t85 = rho[1] <= p->dens_threshold;
  t86 = -t16;
  t88 = my_piecewise5(t14, t11, t10, t15, t86 * t7);
  t89 = 0.1e1 + t88;
  t90 = t89 <= p->zeta_threshold;
  t91 = POW_1_3(t89);
  t93 = my_piecewise3(t90, t22, t91 * t89);
  t94 = t93 * t26;
  t95 = t37 * sigma[2];
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t103 = t36 * t95 * t100 / 0.24e2;
  t104 = 0.1e1 + t103;
  t106 = 0.1e1 - 0.1e1 / t104;
  t108 = t106 * t106;
  t110 = t108 * t106;
  t112 = t108 * t108;
  t116 = exp(-t103);
  t117 = 0.1e1 - t116;
  t119 = t117 * t117;
  t121 = t119 * t117;
  t123 = t119 * t119;
  t127 = t60 * t112 * t106 + t77 * t123 * t117 + t29 * t106 + t51 * t108 + t54 * t110 + t57 * t112 + t64 * t117 + t68 * t119 + t71 * t121 + t74 * t123 + t28 + t63;
  t131 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t127);
  tzk0 = t84 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t132 = t6 * t6;
  t133 = 0.1e1 / t132;
  t134 = t16 * t133;
  t136 = my_piecewise5(t10, 0, t14, 0, t7 - t134);
  t139 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t136);
  t140 = t139 * t26;
  t144 = t26 * t26;
  t145 = 0.1e1 / t144;
  t146 = t25 * t145;
  t149 = t5 * t146 * t80 / 0.8e1;
  t150 = t47 * t47;
  t151 = 0.1e1 / t150;
  t152 = t29 * t151;
  t153 = t152 * t31;
  t154 = t35 * t37;
  t155 = t39 * rho[0];
  t157 = 0.1e1 / t41 / t155;
  t158 = sigma[0] * t157;
  t162 = t51 * t49;
  t163 = t151 * params->mu;
  t164 = t162 * t163;
  t165 = t30 * t35;
  t167 = t165 * t38 * t157;
  t170 = t54 * t52;
  t171 = t170 * t163;
  t174 = t57 * t55;
  t175 = t174 * t163;
  t178 = t60 * t58;
  t179 = t178 * t163;
  t182 = t64 * params->mu;
  t183 = t182 * t165;
  t184 = t157 * t65;
  t188 = t68 * t66;
  t189 = t188 * t31;
  t191 = t154 * t158 * t65;
  t194 = t71 * t69;
  t195 = t194 * t31;
  t198 = t74 * t72;
  t199 = t198 * t31;
  t202 = t77 * t75;
  t203 = t202 * t31;
  t206 = -t153 * t154 * t158 / 0.9e1 - 0.2e1 / 0.9e1 * t164 * t167 - t171 * t167 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t167 - 0.5e1 / 0.9e1 * t179 * t167 - t183 * t38 * t184 / 0.9e1 - 0.2e1 / 0.9e1 * t189 * t191 - t195 * t191 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t191 - 0.5e1 / 0.9e1 * t203 * t191;
  t211 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t80 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t206);
  t212 = t86 * t133;
  t214 = my_piecewise5(t14, 0, t10, 0, -t7 - t212);
  t217 = my_piecewise3(t90, 0, 0.4e1 / 0.3e1 * t91 * t214);
  t218 = t217 * t26;
  t222 = t93 * t145;
  t225 = t5 * t222 * t127 / 0.8e1;
  t227 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t127 - t225);
  tvrho0 = t84 + t131 + t6 * (t211 + t227);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t231 = my_piecewise5(t10, 0, t14, 0, -t7 - t134);
  t234 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t231);
  t235 = t234 * t26;
  t240 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t80 - t149);
  t242 = my_piecewise5(t14, 0, t10, 0, t7 - t212);
  t245 = my_piecewise3(t90, 0, 0.4e1 / 0.3e1 * t91 * t242);
  t246 = t245 * t26;
  t250 = t104 * t104;
  t251 = 0.1e1 / t250;
  t252 = t29 * t251;
  t253 = t252 * t31;
  t254 = t96 * rho[1];
  t256 = 0.1e1 / t98 / t254;
  t257 = sigma[2] * t256;
  t261 = t51 * t106;
  t262 = t251 * params->mu;
  t263 = t261 * t262;
  t265 = t165 * t95 * t256;
  t268 = t54 * t108;
  t269 = t268 * t262;
  t272 = t57 * t110;
  t273 = t272 * t262;
  t276 = t60 * t112;
  t277 = t276 * t262;
  t280 = t256 * t116;
  t284 = t68 * t117;
  t285 = t284 * t31;
  t287 = t154 * t257 * t116;
  t290 = t71 * t119;
  t291 = t290 * t31;
  t294 = t74 * t121;
  t295 = t294 * t31;
  t298 = t77 * t123;
  t299 = t298 * t31;
  t302 = -t253 * t154 * t257 / 0.9e1 - 0.2e1 / 0.9e1 * t263 * t265 - t269 * t265 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t265 - 0.5e1 / 0.9e1 * t277 * t265 - t183 * t95 * t280 / 0.9e1 - 0.2e1 / 0.9e1 * t285 * t287 - t291 * t287 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t287 - 0.5e1 / 0.9e1 * t299 * t287;
  t307 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t127 - t225 - 0.3e1 / 0.8e1 * t5 * t94 * t302);
  tvrho1 = t84 + t131 + t6 * (t240 + t307);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t310 = t152 * params->mu;
  t312 = t165 * t37 * t43;
  t323 = t182 * t30;
  t325 = t154 * t43 * t65;
  t336 = t310 * t312 / 0.24e2 + t164 * t312 / 0.12e2 + t171 * t312 / 0.8e1 + t175 * t312 / 0.6e1 + 0.5e1 / 0.24e2 * t179 * t312 + t323 * t325 / 0.24e2 + t189 * t325 / 0.12e2 + t195 * t325 / 0.8e1 + t199 * t325 / 0.6e1 + 0.5e1 / 0.24e2 * t203 * t325;
  t340 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t336);
  tvsigma0 = t6 * t340;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t341 = t252 * params->mu;
  t343 = t165 * t37 * t100;
  t355 = t154 * t100 * t116;
  t366 = t341 * t343 / 0.24e2 + t263 * t343 / 0.12e2 + t269 * t343 / 0.8e1 + t273 * t343 / 0.6e1 + 0.5e1 / 0.24e2 * t277 * t343 + t323 * t355 / 0.24e2 + t285 * t355 / 0.12e2 + t291 * t355 / 0.8e1 + t295 * t355 / 0.6e1 + 0.5e1 / 0.24e2 * t299 * t355;
  t370 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t366);
  tvsigma2 = t6 * t370;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t43, t46, t47, t49, t51, t52;
  double t54, t55, t57, t58, t60, t63, t64, t65;
  double t66, t68, t69, t71, t72, t74, t75, t77;
  double t80, t84, t85, t86, t88, t89, t90, t91;
  double t93, t94, t95, t96, t97, t98, t100, t103;
  double t104, t106, t108, t110, t112, t116, t117, t119;
  double t121, t123, t127, t131, tzk0;

  double t132, t133, t134, t136, t139, t140, t144, t145;
  double t146, t149, t150, t151, t152, t153, t154, t155;
  double t157, t158, t162, t163, t164, t165, t167, t170;
  double t171, t174, t175, t178, t179, t182, t183, t184;
  double t188, t189, t191, t194, t195, t198, t199, t202;
  double t203, t206, t211, t212, t214, t217, t218, t222;
  double t225, t227, tvrho0, t231, t234, t235, t240, t242;
  double t245, t246, t250, t251, t252, t253, t254, t256;
  double t257, t261, t262, t263, t265, t268, t269, t272;
  double t273, t276, t277, t280, t284, t285, t287, t290;
  double t291, t294, t295, t298, t299, t302, t307, tvrho1;
  double t310, t312, t323, t325, t336, t340, tvsigma0, tvsigma1;
  double t341, t343, t355, t366, t370, tvsigma2;

  double t373, t374, t375, t378, t379, t380, t383, t387;
  double t388, t392, t394, t400, t401, t404, t406, t408;
  double t409, t410, t411, t412, t413, t414, t416, t417;
  double t418, t419, t420, t421, t424, t425, t426, t429;
  double t430, t431, t432, t435, t436, t437, t438, t439;
  double t443, t444, t445, t446, t451, t452, t456, t460;
  double t461, t463, t466, t467, t468, t471, t474, t475;
  double t478, t481, t482, t485, t488, t490, t493, t494;
  double t495, t497, t500, t503, t504, t507, t510, t511;
  double t514, t518, t528, t537, t538, t543, t544, t545;
  double t546, t549, t552, t556, t557, t561, t563, t565;
  double t568, t570, tv2rho20, t573, t577, t581, t582, t586;
  double t588, t596, t597, t601, t605, t606, t610, t612;
  double t619, t622, tv2rho21, t627, t632, t636, t637, t643;
  double t644, t649, t653, t654, t663, t664, t665, t666;
  double t667, t668, t671, t672, t673, t676, t677, t678;
  double t679, t682, t683, t687, t688, t693, t694, t698;
  double t703, t713, t722, t723, t724, t726, t729, t730;
  double t731, t734, t737, t738, t741, t744, t745, t748;
  double t751, t753, t756, t757, t759, t762, t765, t766;
  double t769, t772, t773, t776, t779, t780, t785, tv2rho22;
  double t793, t794, t796, t797, t798, t801, t802, t806;
  double t807, t812, t821, t836, t838, t846, t850, t871;
  double t872, t877, tv2rhosigma0, tv2rhosigma1, t884, t886, tv2rhosigma2, t892;
  double tv2rhosigma3, tv2rhosigma4, t897, t899, t900, t902, t905, t907;
  double t920, t922, t937, t938, t942, t945, t949, t953;
  double t974, t975, t980, tv2rhosigma5, t982, t983, t985, t987;
  double t990, t1007, t1009, t1012, t1014, t1031, t1035, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1036, t1037, t1039, t1041;
  double t1044, t1062, t1066, t1083, t1087, tv2sigma25;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->a[0];
  t29 = params->a[1];
  t30 = M_CBRT6;
  t31 = params->mu * t30;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = 0.1e1 / params->kappa;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = t36 * t38 * t43 / 0.24e2;
  t47 = 0.1e1 + t46;
  t49 = 0.1e1 - 0.1e1 / t47;
  t51 = params->a[2];
  t52 = t49 * t49;
  t54 = params->a[3];
  t55 = t52 * t49;
  t57 = params->a[4];
  t58 = t52 * t52;
  t60 = params->a[5];
  t63 = params->b[0];
  t64 = params->b[1];
  t65 = exp(-t46);
  t66 = 0.1e1 - t65;
  t68 = params->b[2];
  t69 = t66 * t66;
  t71 = params->b[3];
  t72 = t69 * t66;
  t74 = params->b[4];
  t75 = t69 * t69;
  t77 = params->b[5];
  t80 = t60 * t58 * t49 + t77 * t75 * t66 + t29 * t49 + t51 * t52 + t54 * t55 + t57 * t58 + t64 * t66 + t68 * t69 + t71 * t72 + t74 * t75 + t28 + t63;
  t84 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t80);
  t85 = rho[1] <= p->dens_threshold;
  t86 = -t16;
  t88 = my_piecewise5(t14, t11, t10, t15, t86 * t7);
  t89 = 0.1e1 + t88;
  t90 = t89 <= p->zeta_threshold;
  t91 = POW_1_3(t89);
  t93 = my_piecewise3(t90, t22, t91 * t89);
  t94 = t93 * t26;
  t95 = t37 * sigma[2];
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t103 = t36 * t95 * t100 / 0.24e2;
  t104 = 0.1e1 + t103;
  t106 = 0.1e1 - 0.1e1 / t104;
  t108 = t106 * t106;
  t110 = t108 * t106;
  t112 = t108 * t108;
  t116 = exp(-t103);
  t117 = 0.1e1 - t116;
  t119 = t117 * t117;
  t121 = t119 * t117;
  t123 = t119 * t119;
  t127 = t60 * t112 * t106 + t77 * t123 * t117 + t29 * t106 + t51 * t108 + t54 * t110 + t57 * t112 + t64 * t117 + t68 * t119 + t71 * t121 + t74 * t123 + t28 + t63;
  t131 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t127);
  tzk0 = t84 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t132 = t6 * t6;
  t133 = 0.1e1 / t132;
  t134 = t16 * t133;
  t136 = my_piecewise5(t10, 0, t14, 0, t7 - t134);
  t139 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t136);
  t140 = t139 * t26;
  t144 = t26 * t26;
  t145 = 0.1e1 / t144;
  t146 = t25 * t145;
  t149 = t5 * t146 * t80 / 0.8e1;
  t150 = t47 * t47;
  t151 = 0.1e1 / t150;
  t152 = t29 * t151;
  t153 = t152 * t31;
  t154 = t35 * t37;
  t155 = t39 * rho[0];
  t157 = 0.1e1 / t41 / t155;
  t158 = sigma[0] * t157;
  t162 = t51 * t49;
  t163 = t151 * params->mu;
  t164 = t162 * t163;
  t165 = t30 * t35;
  t167 = t165 * t38 * t157;
  t170 = t54 * t52;
  t171 = t170 * t163;
  t174 = t57 * t55;
  t175 = t174 * t163;
  t178 = t60 * t58;
  t179 = t178 * t163;
  t182 = t64 * params->mu;
  t183 = t182 * t165;
  t184 = t157 * t65;
  t188 = t68 * t66;
  t189 = t188 * t31;
  t191 = t154 * t158 * t65;
  t194 = t71 * t69;
  t195 = t194 * t31;
  t198 = t74 * t72;
  t199 = t198 * t31;
  t202 = t77 * t75;
  t203 = t202 * t31;
  t206 = -t153 * t154 * t158 / 0.9e1 - 0.2e1 / 0.9e1 * t164 * t167 - t171 * t167 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t167 - 0.5e1 / 0.9e1 * t179 * t167 - t183 * t38 * t184 / 0.9e1 - 0.2e1 / 0.9e1 * t189 * t191 - t195 * t191 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t191 - 0.5e1 / 0.9e1 * t203 * t191;
  t211 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t80 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t206);
  t212 = t86 * t133;
  t214 = my_piecewise5(t14, 0, t10, 0, -t7 - t212);
  t217 = my_piecewise3(t90, 0, 0.4e1 / 0.3e1 * t91 * t214);
  t218 = t217 * t26;
  t222 = t93 * t145;
  t225 = t5 * t222 * t127 / 0.8e1;
  t227 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t127 - t225);
  tvrho0 = t84 + t131 + t6 * (t211 + t227);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t231 = my_piecewise5(t10, 0, t14, 0, -t7 - t134);
  t234 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t231);
  t235 = t234 * t26;
  t240 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t80 - t149);
  t242 = my_piecewise5(t14, 0, t10, 0, t7 - t212);
  t245 = my_piecewise3(t90, 0, 0.4e1 / 0.3e1 * t91 * t242);
  t246 = t245 * t26;
  t250 = t104 * t104;
  t251 = 0.1e1 / t250;
  t252 = t29 * t251;
  t253 = t252 * t31;
  t254 = t96 * rho[1];
  t256 = 0.1e1 / t98 / t254;
  t257 = sigma[2] * t256;
  t261 = t51 * t106;
  t262 = t251 * params->mu;
  t263 = t261 * t262;
  t265 = t165 * t95 * t256;
  t268 = t54 * t108;
  t269 = t268 * t262;
  t272 = t57 * t110;
  t273 = t272 * t262;
  t276 = t60 * t112;
  t277 = t276 * t262;
  t280 = t256 * t116;
  t284 = t68 * t117;
  t285 = t284 * t31;
  t287 = t154 * t257 * t116;
  t290 = t71 * t119;
  t291 = t290 * t31;
  t294 = t74 * t121;
  t295 = t294 * t31;
  t298 = t77 * t123;
  t299 = t298 * t31;
  t302 = -t253 * t154 * t257 / 0.9e1 - 0.2e1 / 0.9e1 * t263 * t265 - t269 * t265 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t265 - 0.5e1 / 0.9e1 * t277 * t265 - t183 * t95 * t280 / 0.9e1 - 0.2e1 / 0.9e1 * t285 * t287 - t291 * t287 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t287 - 0.5e1 / 0.9e1 * t299 * t287;
  t307 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t127 - t225 - 0.3e1 / 0.8e1 * t5 * t94 * t302);
  tvrho1 = t84 + t131 + t6 * (t240 + t307);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t310 = t152 * params->mu;
  t312 = t165 * t37 * t43;
  t323 = t182 * t30;
  t325 = t154 * t43 * t65;
  t336 = t310 * t312 / 0.24e2 + t164 * t312 / 0.12e2 + t171 * t312 / 0.8e1 + t175 * t312 / 0.6e1 + 0.5e1 / 0.24e2 * t179 * t312 + t323 * t325 / 0.24e2 + t189 * t325 / 0.12e2 + t195 * t325 / 0.8e1 + t199 * t325 / 0.6e1 + 0.5e1 / 0.24e2 * t203 * t325;
  t340 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t336);
  tvsigma0 = t6 * t340;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t341 = t252 * params->mu;
  t343 = t165 * t37 * t100;
  t355 = t154 * t100 * t116;
  t366 = t341 * t343 / 0.24e2 + t263 * t343 / 0.12e2 + t269 * t343 / 0.8e1 + t273 * t343 / 0.6e1 + 0.5e1 / 0.24e2 * t277 * t343 + t323 * t355 / 0.24e2 + t285 * t355 / 0.12e2 + t291 * t355 / 0.8e1 + t295 * t355 / 0.6e1 + 0.5e1 / 0.24e2 * t299 * t355;
  t370 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t366);
  tvsigma2 = t6 * t370;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t373 = t23 * t23;
  t374 = 0.1e1 / t373;
  t375 = t136 * t136;
  t378 = t132 * t6;
  t379 = 0.1e1 / t378;
  t380 = t16 * t379;
  t383 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t133 + 0.2e1 * t380);
  t387 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t374 * t375 + 0.4e1 / 0.3e1 * t23 * t383);
  t388 = t387 * t26;
  t392 = t139 * t145;
  t394 = t5 * t392 * t80;
  t400 = 0.1e1 / t144 / t6;
  t401 = t25 * t400;
  t404 = t5 * t401 * t80 / 0.12e2;
  t406 = t5 * t146 * t206;
  t408 = t150 * t47;
  t409 = 0.1e1 / t408;
  t410 = t29 * t409;
  t411 = params->mu * params->mu;
  t412 = t30 * t30;
  t413 = t411 * t412;
  t414 = t410 * t413;
  t416 = 0.1e1 / t33 / t32;
  t417 = params->kappa * params->kappa;
  t418 = 0.1e1 / t417;
  t419 = t416 * t418;
  t420 = sigma[0] * sigma[0];
  t421 = t39 * t39;
  t424 = 0.1e1 / t40 / t421 / t155;
  t425 = t420 * t424;
  t426 = t419 * t425;
  t429 = t150 * t150;
  t430 = 0.1e1 / t429;
  t431 = t51 * t430;
  t432 = t431 * t413;
  t435 = t64 * t411;
  t436 = t412 * t416;
  t437 = t435 * t436;
  t438 = t418 * t420;
  t439 = t424 * t65;
  t443 = t68 * t411;
  t444 = t443 * t436;
  t445 = t65 * t65;
  t446 = t424 * t445;
  t451 = 0.1e1 / t41 / t421;
  t452 = sigma[0] * t451;
  t456 = t451 * t65;
  t460 = t409 * t411;
  t461 = t162 * t460;
  t463 = t436 * t438 * t424;
  t466 = t54 * t49;
  t467 = t430 * t411;
  t468 = t466 * t467;
  t471 = t170 * t460;
  t474 = t57 * t52;
  t475 = t474 * t467;
  t478 = t174 * t460;
  t481 = t60 * t55;
  t482 = t481 * t467;
  t485 = t178 * t460;
  t488 = t188 * t413;
  t490 = t419 * t425 * t65;
  t493 = -0.2e1 / 0.81e2 * t414 * t426 + 0.2e1 / 0.81e2 * t432 * t426 - t437 * t438 * t439 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t438 * t446 + 0.11e2 / 0.27e2 * t153 * t154 * t452 + 0.11e2 / 0.27e2 * t183 * t38 * t456 - 0.4e1 / 0.81e2 * t461 * t463 + 0.2e1 / 0.27e2 * t468 * t463 - 0.2e1 / 0.27e2 * t471 * t463 + 0.4e1 / 0.27e2 * t475 * t463 - 0.8e1 / 0.81e2 * t478 * t463 + 0.2e2 / 0.81e2 * t482 * t463 - 0.1e2 / 0.81e2 * t485 * t463 - 0.2e1 / 0.81e2 * t488 * t490;
  t494 = t71 * t66;
  t495 = t494 * t413;
  t497 = t419 * t425 * t445;
  t500 = t194 * t413;
  t503 = t74 * t69;
  t504 = t503 * t413;
  t507 = t198 * t413;
  t510 = t77 * t72;
  t511 = t510 * t413;
  t514 = t202 * t413;
  t518 = t165 * t38 * t451;
  t528 = t154 * t452 * t65;
  t537 = 0.2e1 / 0.27e2 * t495 * t497 - t500 * t490 / 0.27e2 + 0.4e1 / 0.27e2 * t504 * t497 - 0.4e1 / 0.81e2 * t507 * t490 + 0.2e2 / 0.81e2 * t511 * t497 - 0.5e1 / 0.81e2 * t514 * t490 + 0.22e2 / 0.27e2 * t164 * t518 + 0.11e2 / 0.9e1 * t171 * t518 + 0.44e2 / 0.27e2 * t175 * t518 + 0.55e2 / 0.27e2 * t179 * t518 + 0.22e2 / 0.27e2 * t189 * t528 + 0.11e2 / 0.9e1 * t195 * t528 + 0.44e2 / 0.27e2 * t199 * t528 + 0.55e2 / 0.27e2 * t203 * t528;
  t538 = t493 + t537;
  t543 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t388 * t80 - t394 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t206 + t404 - t406 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t538);
  t544 = t91 * t91;
  t545 = 0.1e1 / t544;
  t546 = t214 * t214;
  t549 = t86 * t379;
  t552 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t133 + 0.2e1 * t549);
  t556 = my_piecewise3(t90, 0, 0.4e1 / 0.9e1 * t545 * t546 + 0.4e1 / 0.3e1 * t91 * t552);
  t557 = t556 * t26;
  t561 = t217 * t145;
  t563 = t5 * t561 * t127;
  t565 = t93 * t400;
  t568 = t5 * t565 * t127 / 0.12e2;
  t570 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t557 * t127 - t563 / 0.4e1 + t568);
  tv2rho20 = 0.2e1 * t211 + 0.2e1 * t227 + t6 * (t543 + t570);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t573 = t374 * t231;
  t577 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t380);
  t581 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t573 * t136 + 0.4e1 / 0.3e1 * t23 * t577);
  t582 = t581 * t26;
  t586 = t234 * t145;
  t588 = t5 * t586 * t80;
  t596 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t582 * t80 - t588 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t235 * t206 - t394 / 0.8e1 + t404 - t406 / 0.8e1);
  t597 = t545 * t242;
  t601 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t549);
  t605 = my_piecewise3(t90, 0, 0.4e1 / 0.9e1 * t597 * t214 + 0.4e1 / 0.3e1 * t91 * t601);
  t606 = t605 * t26;
  t610 = t245 * t145;
  t612 = t5 * t610 * t127;
  t619 = t5 * t222 * t302;
  t622 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t606 * t127 - t612 / 0.8e1 - t563 / 0.8e1 + t568 - 0.3e1 / 0.8e1 * t5 * t218 * t302 - t619 / 0.8e1);
  tv2rho21 = t211 + t227 + t240 + t307 + t6 * (t596 + t622);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t627 = t231 * t231;
  t632 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t133 + 0.2e1 * t380);
  t636 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t374 * t627 + 0.4e1 / 0.3e1 * t23 * t632);
  t637 = t636 * t26;
  t643 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t637 * t80 - t588 / 0.4e1 + t404);
  t644 = t242 * t242;
  t649 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t133 + 0.2e1 * t549);
  t653 = my_piecewise3(t90, 0, 0.4e1 / 0.9e1 * t545 * t644 + 0.4e1 / 0.3e1 * t91 * t649);
  t654 = t653 * t26;
  t663 = t250 * t104;
  t664 = 0.1e1 / t663;
  t665 = t29 * t664;
  t666 = t665 * t413;
  t667 = sigma[2] * sigma[2];
  t668 = t96 * t96;
  t671 = 0.1e1 / t97 / t668 / t254;
  t672 = t667 * t671;
  t673 = t419 * t672;
  t676 = t250 * t250;
  t677 = 0.1e1 / t676;
  t678 = t51 * t677;
  t679 = t678 * t413;
  t682 = t418 * t667;
  t683 = t671 * t116;
  t687 = t116 * t116;
  t688 = t671 * t687;
  t693 = 0.1e1 / t98 / t668;
  t694 = sigma[2] * t693;
  t698 = t693 * t116;
  t703 = t165 * t95 * t693;
  t713 = t154 * t694 * t116;
  t722 = -0.2e1 / 0.81e2 * t666 * t673 + 0.2e1 / 0.81e2 * t679 * t673 - t437 * t682 * t683 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t682 * t688 + 0.11e2 / 0.27e2 * t253 * t154 * t694 + 0.11e2 / 0.27e2 * t183 * t95 * t698 + 0.22e2 / 0.27e2 * t263 * t703 + 0.11e2 / 0.9e1 * t269 * t703 + 0.44e2 / 0.27e2 * t273 * t703 + 0.55e2 / 0.27e2 * t277 * t703 + 0.22e2 / 0.27e2 * t285 * t713 + 0.11e2 / 0.9e1 * t291 * t713 + 0.44e2 / 0.27e2 * t295 * t713 + 0.55e2 / 0.27e2 * t299 * t713;
  t723 = t664 * t411;
  t724 = t261 * t723;
  t726 = t436 * t682 * t671;
  t729 = t54 * t106;
  t730 = t677 * t411;
  t731 = t729 * t730;
  t734 = t268 * t723;
  t737 = t57 * t108;
  t738 = t737 * t730;
  t741 = t272 * t723;
  t744 = t60 * t110;
  t745 = t744 * t730;
  t748 = t276 * t723;
  t751 = t284 * t413;
  t753 = t419 * t672 * t116;
  t756 = t71 * t117;
  t757 = t756 * t413;
  t759 = t419 * t672 * t687;
  t762 = t290 * t413;
  t765 = t74 * t119;
  t766 = t765 * t413;
  t769 = t294 * t413;
  t772 = t77 * t121;
  t773 = t772 * t413;
  t776 = t298 * t413;
  t779 = -0.4e1 / 0.81e2 * t724 * t726 + 0.2e1 / 0.27e2 * t731 * t726 - 0.2e1 / 0.27e2 * t734 * t726 + 0.4e1 / 0.27e2 * t738 * t726 - 0.8e1 / 0.81e2 * t741 * t726 + 0.2e2 / 0.81e2 * t745 * t726 - 0.1e2 / 0.81e2 * t748 * t726 - 0.2e1 / 0.81e2 * t751 * t753 + 0.2e1 / 0.27e2 * t757 * t759 - t762 * t753 / 0.27e2 + 0.4e1 / 0.27e2 * t766 * t759 - 0.4e1 / 0.81e2 * t769 * t753 + 0.2e2 / 0.81e2 * t773 * t759 - 0.5e1 / 0.81e2 * t776 * t753;
  t780 = t722 + t779;
  t785 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t654 * t127 - t612 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t246 * t302 + t568 - t619 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t94 * t780);
  tv2rho22 = 0.2e1 * t240 + 0.2e1 * t307 + t6 * (t643 + t785);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t793 = t5 * t146 * t336 / 0.8e1;
  t794 = t421 * t39;
  t796 = 0.1e1 / t40 / t794;
  t797 = sigma[0] * t796;
  t798 = t419 * t797;
  t801 = t418 * t796;
  t802 = sigma[0] * t65;
  t806 = t418 * sigma[0];
  t807 = t796 * t445;
  t812 = t165 * t37 * t157;
  t821 = t154 * t184;
  t836 = -t432 * t798 / 0.108e3 + t437 * t801 * t802 / 0.216e3 - t444 * t806 * t807 / 0.108e3 - 0.2e1 / 0.9e1 * t164 * t812 - t171 * t812 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t812 - 0.5e1 / 0.9e1 * t179 * t812 - 0.2e1 / 0.9e1 * t189 * t821 - t195 * t821 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t821 - 0.5e1 / 0.9e1 * t203 * t821 + t414 * t798 / 0.108e3 - t323 * t821 / 0.9e1 - t310 * t812 / 0.9e1;
  t838 = t436 * t801 * sigma[0];
  t846 = t419 * t797 * t65;
  t850 = t419 * t807 * sigma[0];
  t871 = t478 * t838 / 0.27e2 - 0.5e1 / 0.54e2 * t482 * t838 + 0.5e1 / 0.108e3 * t485 * t838 + t488 * t846 / 0.108e3 - t495 * t850 / 0.36e2 + t500 * t846 / 0.72e2 - t504 * t850 / 0.18e2 + t507 * t846 / 0.54e2 - 0.5e1 / 0.54e2 * t511 * t850 + 0.5e1 / 0.216e3 * t514 * t846 + t461 * t838 / 0.54e2 - t468 * t838 / 0.36e2 + t471 * t838 / 0.36e2 - t475 * t838 / 0.18e2;
  t872 = t836 + t871;
  t877 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t336 - t793 - 0.3e1 / 0.8e1 * t5 * t27 * t872);
  tv2rhosigma0 = t6 * t877 + t340;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t884 = t5 * t222 * t366 / 0.8e1;
  t886 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t366 - t884);
  tv2rhosigma2 = t6 * t886 + t370;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t892 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t336 - t793);
  tv2rhosigma3 = t6 * t892 + t340;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t897 = t668 * t96;
  t899 = 0.1e1 / t97 / t897;
  t900 = t899 * sigma[2];
  t902 = t419 * t900 * t116;
  t905 = t899 * t687;
  t907 = t419 * t905 * sigma[2];
  t920 = t418 * t899;
  t922 = t436 * t920 * sigma[2];
  t937 = t751 * t902 / 0.108e3 - t757 * t907 / 0.36e2 + t762 * t902 / 0.72e2 - t766 * t907 / 0.18e2 + t769 * t902 / 0.54e2 - 0.5e1 / 0.54e2 * t773 * t907 + 0.5e1 / 0.216e3 * t776 * t902 + t724 * t922 / 0.54e2 - t731 * t922 / 0.36e2 + t734 * t922 / 0.36e2 - t738 * t922 / 0.18e2 + t741 * t922 / 0.27e2 - 0.5e1 / 0.54e2 * t745 * t922 + 0.5e1 / 0.108e3 * t748 * t922;
  t938 = t154 * t280;
  t942 = t165 * t37 * t256;
  t945 = sigma[2] * t116;
  t949 = t418 * sigma[2];
  t953 = t419 * t900;
  t974 = -t323 * t938 / 0.9e1 - t341 * t942 / 0.9e1 + t437 * t920 * t945 / 0.216e3 - t444 * t949 * t905 / 0.108e3 + t666 * t953 / 0.108e3 - t679 * t953 / 0.108e3 - 0.2e1 / 0.9e1 * t263 * t942 - t269 * t942 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t942 - 0.5e1 / 0.9e1 * t277 * t942 - 0.2e1 / 0.9e1 * t285 * t938 - t291 * t938 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t938 - 0.5e1 / 0.9e1 * t299 * t938;
  t975 = t937 + t974;
  t980 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t366 - t884 - 0.3e1 / 0.8e1 * t5 * t94 * t975);
  tv2rhosigma5 = t6 * t980 + t370;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t982 = t410 * t411;
  t983 = t421 * rho[0];
  t985 = 0.1e1 / t40 / t983;
  t987 = t436 * t418 * t985;
  t990 = t431 * t411;
  t1007 = t435 * t412;
  t1009 = t419 * t985 * t65;
  t1012 = t443 * t412;
  t1014 = t419 * t985 * t445;
  t1031 = -t982 * t987 / 0.288e3 + t990 * t987 / 0.288e3 - t461 * t987 / 0.144e3 + t468 * t987 / 0.96e2 - t471 * t987 / 0.96e2 + t475 * t987 / 0.48e2 - t478 * t987 / 0.72e2 + 0.5e1 / 0.144e3 * t482 * t987 - 0.5e1 / 0.288e3 * t485 * t987 - t1007 * t1009 / 0.576e3 + t1012 * t1014 / 0.288e3 - t488 * t1009 / 0.288e3 + t495 * t1014 / 0.96e2 - t500 * t1009 / 0.192e3 + t504 * t1014 / 0.48e2 - t507 * t1009 / 0.144e3 + 0.5e1 / 0.144e3 * t511 * t1014 - 0.5e1 / 0.576e3 * t514 * t1009;
  t1035 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1031);
  tv2sigma20 = t6 * t1035;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1036 = t665 * t411;
  t1037 = t668 * rho[1];
  t1039 = 0.1e1 / t97 / t1037;
  t1041 = t436 * t418 * t1039;
  t1044 = t678 * t411;
  t1062 = t419 * t1039 * t116;
  t1066 = t419 * t1039 * t687;
  t1083 = -t1036 * t1041 / 0.288e3 + t1044 * t1041 / 0.288e3 - t724 * t1041 / 0.144e3 + t731 * t1041 / 0.96e2 - t734 * t1041 / 0.96e2 + t738 * t1041 / 0.48e2 - t741 * t1041 / 0.72e2 + 0.5e1 / 0.144e3 * t745 * t1041 - 0.5e1 / 0.288e3 * t748 * t1041 - t1007 * t1062 / 0.576e3 + t1012 * t1066 / 0.288e3 - t751 * t1062 / 0.288e3 + t757 * t1066 / 0.96e2 - t762 * t1062 / 0.192e3 + t766 * t1066 / 0.48e2 - t769 * t1062 / 0.144e3 + 0.5e1 / 0.144e3 * t773 * t1066 - 0.5e1 / 0.576e3 * t776 * t1062;
  t1087 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t1083);
  tv2sigma25 = t6 * t1087;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t43, t46, t47, t49, t51, t52;
  double t54, t55, t57, t58, t60, t63, t64, t65;
  double t66, t68, t69, t71, t72, t74, t75, t77;
  double t80, t84, t85, t86, t88, t89, t90, t91;
  double t93, t94, t95, t96, t97, t98, t100, t103;
  double t104, t106, t108, t110, t112, t116, t117, t119;
  double t121, t123, t127, t131, tzk0;

  double t132, t133, t134, t136, t139, t140, t144, t145;
  double t146, t149, t150, t151, t152, t153, t154, t155;
  double t157, t158, t162, t163, t164, t165, t167, t170;
  double t171, t174, t175, t178, t179, t182, t183, t184;
  double t188, t189, t191, t194, t195, t198, t199, t202;
  double t203, t206, t211, t212, t214, t217, t218, t222;
  double t225, t227, tvrho0, t231, t234, t235, t240, t242;
  double t245, t246, t250, t251, t252, t253, t254, t256;
  double t257, t261, t262, t263, t265, t268, t269, t272;
  double t273, t276, t277, t280, t284, t285, t287, t290;
  double t291, t294, t295, t298, t299, t302, t307, tvrho1;
  double t310, t312, t323, t325, t336, t340, tvsigma0, tvsigma1;
  double t341, t343, t355, t366, t370, tvsigma2;

  double t373, t374, t375, t378, t379, t380, t383, t387;
  double t388, t392, t394, t400, t401, t404, t406, t408;
  double t409, t410, t411, t412, t413, t414, t416, t417;
  double t418, t419, t420, t421, t424, t425, t426, t429;
  double t430, t431, t432, t435, t436, t437, t438, t439;
  double t443, t444, t445, t446, t451, t452, t456, t460;
  double t461, t463, t466, t467, t468, t471, t474, t475;
  double t478, t481, t482, t485, t488, t490, t493, t494;
  double t495, t497, t500, t503, t504, t507, t510, t511;
  double t514, t518, t528, t537, t538, t543, t544, t545;
  double t546, t549, t552, t556, t557, t561, t563, t565;
  double t568, t570, tv2rho20, t573, t577, t581, t582, t586;
  double t588, t596, t597, t601, t605, t606, t610, t612;
  double t619, t622, tv2rho21, t627, t632, t636, t637, t643;
  double t644, t649, t653, t654, t663, t664, t665, t666;
  double t667, t668, t671, t672, t673, t676, t677, t678;
  double t679, t682, t683, t687, t688, t693, t694, t698;
  double t703, t713, t722, t723, t724, t726, t729, t730;
  double t731, t734, t737, t738, t741, t744, t745, t748;
  double t751, t753, t756, t757, t759, t762, t765, t766;
  double t769, t772, t773, t776, t779, t780, t785, tv2rho22;
  double t793, t794, t796, t797, t798, t801, t802, t806;
  double t807, t812, t821, t836, t838, t846, t850, t871;
  double t872, t877, tv2rhosigma0, tv2rhosigma1, t884, t886, tv2rhosigma2, t892;
  double tv2rhosigma3, tv2rhosigma4, t897, t899, t900, t902, t905, t907;
  double t920, t922, t937, t938, t942, t945, t949, t953;
  double t974, t975, t980, tv2rhosigma5, t982, t983, t985, t987;
  double t990, t1007, t1009, t1012, t1014, t1031, t1035, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1036, t1037, t1039, t1041;
  double t1044, t1062, t1066, t1083, t1087, tv2sigma25;

  double t1091, t1092, t1095, t1098, t1099, t1100, t1103, t1107;
  double t1108, t1112, t1114, t1119, t1121, t1124, t1130, t1131;
  double t1134, t1136, t1139, t1142, t1144, t1153, t1155, t1164;
  double t1166, t1167, t1169, t1173, t1177, t1184, t1203, t1205;
  double t1206, t1207, t1209, t1210, t1211, t1212, t1213, t1215;
  double t1219, t1221, t1225, t1227, t1228, t1230, t1234, t1235;
  double t1237, t1240, t1243, t1247, t1249, t1252, t1253, t1256;
  double t1259, t1262, t1263, t1266, t1269, t1272, t1273, t1276;
  double t1279, t1282, t1283, t1286, t1287, t1290, t1291, t1294;
  double t1295, t1296, t1299, t1302, t1305, t1306, t1309, t1312;
  double t1315, t1322, t1329, t1335, t1337, t1342, t1344, t1345;
  double t1348, t1351, t1354, t1358, t1359, t1363, t1365, t1367;
  double t1369, t1371, t1374, t1376, tv3rho30, t1379, t1380, t1381;
  double t1384, t1389, t1390, t1392, t1396, t1397, t1401, t1404;
  double t1408, t1410, t1414, t1423, t1424, t1425, t1428, t1433;
  double t1435, t1439, t1440, t1444, t1447, t1448, t1450, t1459;
  double t1461, t1464, tv3rho31, t1467, t1472, t1476, t1480, t1481;
  double t1485, t1487, t1496, t1497, t1502, t1506, t1510, t1511;
  double t1515, t1517, t1524, t1532, t1534, t1535, tv3rho32, t1540;
  double t1547, t1551, t1552, t1559, t1560, t1567, t1571, t1572;
  double t1587, t1588, t1589, t1590, t1591, t1592, t1594, t1598;
  double t1599, t1600, t1603, t1606, t1608, t1609, t1610, t1613;
  double t1616, t1619, t1620, t1623, t1626, t1630, t1631, t1635;
  double t1640, t1641, t1645, t1646, t1649, t1656, t1657, t1659;
  double t1662, t1663, t1664, t1667, t1670, t1671, t1672, t1673;
  double t1674, t1677, t1680, t1683, t1684, t1687, t1690, t1694;
  double t1699, t1702, t1706, t1714, t1718, t1728, t1732, t1739;
  double t1747, t1768, t1770, t1775, tv3rho33, t1783, t1790, t1792;
  double t1794, t1795, t1796, t1797, t1798, t1801, t1802, t1805;
  double t1806, t1815, t1825, t1832, t1835, t1836, t1849, t1864;
  double t1882, t1893, t1896, t1898, t1912, t1927, t1929, t1934;
  double tv3rho2sigma0, tv3rho2sigma1, t1941, t1945, t1947, tv3rho2sigma2, t1953, t1961;
  double tv3rho2sigma3, tv3rho2sigma4, t1967, t1974, t1977, tv3rho2sigma5, t1985, tv3rho2sigma6;
  double tv3rho2sigma7, t1997, t2000, t2003, t2004, t2006, t2009, t2010;
  double t2011, t2014, t2015, t2016, t2020, t2027, t2029, t2033;
  double t2036, t2038, t2045, t2072, t2083, t2102, t2130, t2132;
  double t2137, tv3rho2sigma8, t2144, t2145, t2148, t2149, t2150, t2151;
  double t2154, t2155, t2158, t2159, t2160, t2164, t2167, t2173;
  double t2203, t2248, t2250, t2255, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t2262, t2264, tv3rhosigma25, t2270, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t2276, t2279, t2282, t2287, t2288, t2290;
  double t2297, t2298, t2301, t2302, t2305, t2306, t2307, t2333;
  double t2378, t2380, t2385, tv3rhosigma211, t2387, t2388, t2390, t2393;
  double t2395, t2398, t2401, t2403, t2406, t2409, t2412, t2415;
  double t2418, t2421, t2428, t2429, t2439, t2440, t2443, t2446;
  double t2449, t2452, t2455, t2458, t2461, t2464, t2467, t2468;
  double t2472, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t2473, t2474, t2477, t2491, t2492, t2495;
  double t2498, t2501, t2504, t2507, t2510, t2511, t2514, t2516;
  double t2519, t2521, t2524, t2527, t2529, t2532, t2535, t2538;
  double t2541, t2544, t2547, t2550, t2553, t2554, t2558, tv3sigma39;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->a[0];
  t29 = params->a[1];
  t30 = M_CBRT6;
  t31 = params->mu * t30;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = 0.1e1 / params->kappa;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = t36 * t38 * t43 / 0.24e2;
  t47 = 0.1e1 + t46;
  t49 = 0.1e1 - 0.1e1 / t47;
  t51 = params->a[2];
  t52 = t49 * t49;
  t54 = params->a[3];
  t55 = t52 * t49;
  t57 = params->a[4];
  t58 = t52 * t52;
  t60 = params->a[5];
  t63 = params->b[0];
  t64 = params->b[1];
  t65 = exp(-t46);
  t66 = 0.1e1 - t65;
  t68 = params->b[2];
  t69 = t66 * t66;
  t71 = params->b[3];
  t72 = t69 * t66;
  t74 = params->b[4];
  t75 = t69 * t69;
  t77 = params->b[5];
  t80 = t60 * t58 * t49 + t77 * t75 * t66 + t29 * t49 + t51 * t52 + t54 * t55 + t57 * t58 + t64 * t66 + t68 * t69 + t71 * t72 + t74 * t75 + t28 + t63;
  t84 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t80);
  t85 = rho[1] <= p->dens_threshold;
  t86 = -t16;
  t88 = my_piecewise5(t14, t11, t10, t15, t86 * t7);
  t89 = 0.1e1 + t88;
  t90 = t89 <= p->zeta_threshold;
  t91 = POW_1_3(t89);
  t93 = my_piecewise3(t90, t22, t91 * t89);
  t94 = t93 * t26;
  t95 = t37 * sigma[2];
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t103 = t36 * t95 * t100 / 0.24e2;
  t104 = 0.1e1 + t103;
  t106 = 0.1e1 - 0.1e1 / t104;
  t108 = t106 * t106;
  t110 = t108 * t106;
  t112 = t108 * t108;
  t116 = exp(-t103);
  t117 = 0.1e1 - t116;
  t119 = t117 * t117;
  t121 = t119 * t117;
  t123 = t119 * t119;
  t127 = t60 * t112 * t106 + t77 * t123 * t117 + t29 * t106 + t51 * t108 + t54 * t110 + t57 * t112 + t64 * t117 + t68 * t119 + t71 * t121 + t74 * t123 + t28 + t63;
  t131 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t127);
  tzk0 = t84 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t132 = t6 * t6;
  t133 = 0.1e1 / t132;
  t134 = t16 * t133;
  t136 = my_piecewise5(t10, 0, t14, 0, t7 - t134);
  t139 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t136);
  t140 = t139 * t26;
  t144 = t26 * t26;
  t145 = 0.1e1 / t144;
  t146 = t25 * t145;
  t149 = t5 * t146 * t80 / 0.8e1;
  t150 = t47 * t47;
  t151 = 0.1e1 / t150;
  t152 = t29 * t151;
  t153 = t152 * t31;
  t154 = t35 * t37;
  t155 = t39 * rho[0];
  t157 = 0.1e1 / t41 / t155;
  t158 = sigma[0] * t157;
  t162 = t51 * t49;
  t163 = t151 * params->mu;
  t164 = t162 * t163;
  t165 = t30 * t35;
  t167 = t165 * t38 * t157;
  t170 = t54 * t52;
  t171 = t170 * t163;
  t174 = t57 * t55;
  t175 = t174 * t163;
  t178 = t60 * t58;
  t179 = t178 * t163;
  t182 = t64 * params->mu;
  t183 = t182 * t165;
  t184 = t157 * t65;
  t188 = t68 * t66;
  t189 = t188 * t31;
  t191 = t154 * t158 * t65;
  t194 = t71 * t69;
  t195 = t194 * t31;
  t198 = t74 * t72;
  t199 = t198 * t31;
  t202 = t77 * t75;
  t203 = t202 * t31;
  t206 = -t153 * t154 * t158 / 0.9e1 - 0.2e1 / 0.9e1 * t164 * t167 - t171 * t167 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t167 - 0.5e1 / 0.9e1 * t179 * t167 - t183 * t38 * t184 / 0.9e1 - 0.2e1 / 0.9e1 * t189 * t191 - t195 * t191 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t191 - 0.5e1 / 0.9e1 * t203 * t191;
  t211 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t80 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t206);
  t212 = t86 * t133;
  t214 = my_piecewise5(t14, 0, t10, 0, -t7 - t212);
  t217 = my_piecewise3(t90, 0, 0.4e1 / 0.3e1 * t91 * t214);
  t218 = t217 * t26;
  t222 = t93 * t145;
  t225 = t5 * t222 * t127 / 0.8e1;
  t227 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t127 - t225);
  tvrho0 = t84 + t131 + t6 * (t211 + t227);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t231 = my_piecewise5(t10, 0, t14, 0, -t7 - t134);
  t234 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t231);
  t235 = t234 * t26;
  t240 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t80 - t149);
  t242 = my_piecewise5(t14, 0, t10, 0, t7 - t212);
  t245 = my_piecewise3(t90, 0, 0.4e1 / 0.3e1 * t91 * t242);
  t246 = t245 * t26;
  t250 = t104 * t104;
  t251 = 0.1e1 / t250;
  t252 = t29 * t251;
  t253 = t252 * t31;
  t254 = t96 * rho[1];
  t256 = 0.1e1 / t98 / t254;
  t257 = sigma[2] * t256;
  t261 = t51 * t106;
  t262 = t251 * params->mu;
  t263 = t261 * t262;
  t265 = t165 * t95 * t256;
  t268 = t54 * t108;
  t269 = t268 * t262;
  t272 = t57 * t110;
  t273 = t272 * t262;
  t276 = t60 * t112;
  t277 = t276 * t262;
  t280 = t256 * t116;
  t284 = t68 * t117;
  t285 = t284 * t31;
  t287 = t154 * t257 * t116;
  t290 = t71 * t119;
  t291 = t290 * t31;
  t294 = t74 * t121;
  t295 = t294 * t31;
  t298 = t77 * t123;
  t299 = t298 * t31;
  t302 = -t253 * t154 * t257 / 0.9e1 - 0.2e1 / 0.9e1 * t263 * t265 - t269 * t265 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t265 - 0.5e1 / 0.9e1 * t277 * t265 - t183 * t95 * t280 / 0.9e1 - 0.2e1 / 0.9e1 * t285 * t287 - t291 * t287 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t287 - 0.5e1 / 0.9e1 * t299 * t287;
  t307 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t127 - t225 - 0.3e1 / 0.8e1 * t5 * t94 * t302);
  tvrho1 = t84 + t131 + t6 * (t240 + t307);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t310 = t152 * params->mu;
  t312 = t165 * t37 * t43;
  t323 = t182 * t30;
  t325 = t154 * t43 * t65;
  t336 = t310 * t312 / 0.24e2 + t164 * t312 / 0.12e2 + t171 * t312 / 0.8e1 + t175 * t312 / 0.6e1 + 0.5e1 / 0.24e2 * t179 * t312 + t323 * t325 / 0.24e2 + t189 * t325 / 0.12e2 + t195 * t325 / 0.8e1 + t199 * t325 / 0.6e1 + 0.5e1 / 0.24e2 * t203 * t325;
  t340 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t336);
  tvsigma0 = t6 * t340;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t341 = t252 * params->mu;
  t343 = t165 * t37 * t100;
  t355 = t154 * t100 * t116;
  t366 = t341 * t343 / 0.24e2 + t263 * t343 / 0.12e2 + t269 * t343 / 0.8e1 + t273 * t343 / 0.6e1 + 0.5e1 / 0.24e2 * t277 * t343 + t323 * t355 / 0.24e2 + t285 * t355 / 0.12e2 + t291 * t355 / 0.8e1 + t295 * t355 / 0.6e1 + 0.5e1 / 0.24e2 * t299 * t355;
  t370 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t366);
  tvsigma2 = t6 * t370;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t373 = t23 * t23;
  t374 = 0.1e1 / t373;
  t375 = t136 * t136;
  t378 = t132 * t6;
  t379 = 0.1e1 / t378;
  t380 = t16 * t379;
  t383 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t133 + 0.2e1 * t380);
  t387 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t374 * t375 + 0.4e1 / 0.3e1 * t23 * t383);
  t388 = t387 * t26;
  t392 = t139 * t145;
  t394 = t5 * t392 * t80;
  t400 = 0.1e1 / t144 / t6;
  t401 = t25 * t400;
  t404 = t5 * t401 * t80 / 0.12e2;
  t406 = t5 * t146 * t206;
  t408 = t150 * t47;
  t409 = 0.1e1 / t408;
  t410 = t29 * t409;
  t411 = params->mu * params->mu;
  t412 = t30 * t30;
  t413 = t411 * t412;
  t414 = t410 * t413;
  t416 = 0.1e1 / t33 / t32;
  t417 = params->kappa * params->kappa;
  t418 = 0.1e1 / t417;
  t419 = t416 * t418;
  t420 = sigma[0] * sigma[0];
  t421 = t39 * t39;
  t424 = 0.1e1 / t40 / t421 / t155;
  t425 = t420 * t424;
  t426 = t419 * t425;
  t429 = t150 * t150;
  t430 = 0.1e1 / t429;
  t431 = t51 * t430;
  t432 = t431 * t413;
  t435 = t64 * t411;
  t436 = t412 * t416;
  t437 = t435 * t436;
  t438 = t418 * t420;
  t439 = t424 * t65;
  t443 = t68 * t411;
  t444 = t443 * t436;
  t445 = t65 * t65;
  t446 = t424 * t445;
  t451 = 0.1e1 / t41 / t421;
  t452 = sigma[0] * t451;
  t456 = t451 * t65;
  t460 = t409 * t411;
  t461 = t162 * t460;
  t463 = t436 * t438 * t424;
  t466 = t54 * t49;
  t467 = t430 * t411;
  t468 = t466 * t467;
  t471 = t170 * t460;
  t474 = t57 * t52;
  t475 = t474 * t467;
  t478 = t174 * t460;
  t481 = t60 * t55;
  t482 = t481 * t467;
  t485 = t178 * t460;
  t488 = t188 * t413;
  t490 = t419 * t425 * t65;
  t493 = -0.2e1 / 0.81e2 * t414 * t426 + 0.2e1 / 0.81e2 * t432 * t426 - t437 * t438 * t439 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t438 * t446 + 0.11e2 / 0.27e2 * t153 * t154 * t452 + 0.11e2 / 0.27e2 * t183 * t38 * t456 - 0.4e1 / 0.81e2 * t461 * t463 + 0.2e1 / 0.27e2 * t468 * t463 - 0.2e1 / 0.27e2 * t471 * t463 + 0.4e1 / 0.27e2 * t475 * t463 - 0.8e1 / 0.81e2 * t478 * t463 + 0.2e2 / 0.81e2 * t482 * t463 - 0.1e2 / 0.81e2 * t485 * t463 - 0.2e1 / 0.81e2 * t488 * t490;
  t494 = t71 * t66;
  t495 = t494 * t413;
  t497 = t419 * t425 * t445;
  t500 = t194 * t413;
  t503 = t74 * t69;
  t504 = t503 * t413;
  t507 = t198 * t413;
  t510 = t77 * t72;
  t511 = t510 * t413;
  t514 = t202 * t413;
  t518 = t165 * t38 * t451;
  t528 = t154 * t452 * t65;
  t537 = 0.2e1 / 0.27e2 * t495 * t497 - t500 * t490 / 0.27e2 + 0.4e1 / 0.27e2 * t504 * t497 - 0.4e1 / 0.81e2 * t507 * t490 + 0.2e2 / 0.81e2 * t511 * t497 - 0.5e1 / 0.81e2 * t514 * t490 + 0.22e2 / 0.27e2 * t164 * t518 + 0.11e2 / 0.9e1 * t171 * t518 + 0.44e2 / 0.27e2 * t175 * t518 + 0.55e2 / 0.27e2 * t179 * t518 + 0.22e2 / 0.27e2 * t189 * t528 + 0.11e2 / 0.9e1 * t195 * t528 + 0.44e2 / 0.27e2 * t199 * t528 + 0.55e2 / 0.27e2 * t203 * t528;
  t538 = t493 + t537;
  t543 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t388 * t80 - t394 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t206 + t404 - t406 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t538);
  t544 = t91 * t91;
  t545 = 0.1e1 / t544;
  t546 = t214 * t214;
  t549 = t86 * t379;
  t552 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t133 + 0.2e1 * t549);
  t556 = my_piecewise3(t90, 0, 0.4e1 / 0.9e1 * t545 * t546 + 0.4e1 / 0.3e1 * t91 * t552);
  t557 = t556 * t26;
  t561 = t217 * t145;
  t563 = t5 * t561 * t127;
  t565 = t93 * t400;
  t568 = t5 * t565 * t127 / 0.12e2;
  t570 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t557 * t127 - t563 / 0.4e1 + t568);
  tv2rho20 = 0.2e1 * t211 + 0.2e1 * t227 + t6 * (t543 + t570);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t573 = t374 * t231;
  t577 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t380);
  t581 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t573 * t136 + 0.4e1 / 0.3e1 * t23 * t577);
  t582 = t581 * t26;
  t586 = t234 * t145;
  t588 = t5 * t586 * t80;
  t596 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t582 * t80 - t588 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t235 * t206 - t394 / 0.8e1 + t404 - t406 / 0.8e1);
  t597 = t545 * t242;
  t601 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t549);
  t605 = my_piecewise3(t90, 0, 0.4e1 / 0.9e1 * t597 * t214 + 0.4e1 / 0.3e1 * t91 * t601);
  t606 = t605 * t26;
  t610 = t245 * t145;
  t612 = t5 * t610 * t127;
  t619 = t5 * t222 * t302;
  t622 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t606 * t127 - t612 / 0.8e1 - t563 / 0.8e1 + t568 - 0.3e1 / 0.8e1 * t5 * t218 * t302 - t619 / 0.8e1);
  tv2rho21 = t211 + t227 + t240 + t307 + t6 * (t596 + t622);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t627 = t231 * t231;
  t632 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t133 + 0.2e1 * t380);
  t636 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t374 * t627 + 0.4e1 / 0.3e1 * t23 * t632);
  t637 = t636 * t26;
  t643 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t637 * t80 - t588 / 0.4e1 + t404);
  t644 = t242 * t242;
  t649 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t133 + 0.2e1 * t549);
  t653 = my_piecewise3(t90, 0, 0.4e1 / 0.9e1 * t545 * t644 + 0.4e1 / 0.3e1 * t91 * t649);
  t654 = t653 * t26;
  t663 = t250 * t104;
  t664 = 0.1e1 / t663;
  t665 = t29 * t664;
  t666 = t665 * t413;
  t667 = sigma[2] * sigma[2];
  t668 = t96 * t96;
  t671 = 0.1e1 / t97 / t668 / t254;
  t672 = t667 * t671;
  t673 = t419 * t672;
  t676 = t250 * t250;
  t677 = 0.1e1 / t676;
  t678 = t51 * t677;
  t679 = t678 * t413;
  t682 = t418 * t667;
  t683 = t671 * t116;
  t687 = t116 * t116;
  t688 = t671 * t687;
  t693 = 0.1e1 / t98 / t668;
  t694 = sigma[2] * t693;
  t698 = t693 * t116;
  t703 = t165 * t95 * t693;
  t713 = t154 * t694 * t116;
  t722 = -0.2e1 / 0.81e2 * t666 * t673 + 0.2e1 / 0.81e2 * t679 * t673 - t437 * t682 * t683 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t682 * t688 + 0.11e2 / 0.27e2 * t253 * t154 * t694 + 0.11e2 / 0.27e2 * t183 * t95 * t698 + 0.22e2 / 0.27e2 * t263 * t703 + 0.11e2 / 0.9e1 * t269 * t703 + 0.44e2 / 0.27e2 * t273 * t703 + 0.55e2 / 0.27e2 * t277 * t703 + 0.22e2 / 0.27e2 * t285 * t713 + 0.11e2 / 0.9e1 * t291 * t713 + 0.44e2 / 0.27e2 * t295 * t713 + 0.55e2 / 0.27e2 * t299 * t713;
  t723 = t664 * t411;
  t724 = t261 * t723;
  t726 = t436 * t682 * t671;
  t729 = t54 * t106;
  t730 = t677 * t411;
  t731 = t729 * t730;
  t734 = t268 * t723;
  t737 = t57 * t108;
  t738 = t737 * t730;
  t741 = t272 * t723;
  t744 = t60 * t110;
  t745 = t744 * t730;
  t748 = t276 * t723;
  t751 = t284 * t413;
  t753 = t419 * t672 * t116;
  t756 = t71 * t117;
  t757 = t756 * t413;
  t759 = t419 * t672 * t687;
  t762 = t290 * t413;
  t765 = t74 * t119;
  t766 = t765 * t413;
  t769 = t294 * t413;
  t772 = t77 * t121;
  t773 = t772 * t413;
  t776 = t298 * t413;
  t779 = -0.4e1 / 0.81e2 * t724 * t726 + 0.2e1 / 0.27e2 * t731 * t726 - 0.2e1 / 0.27e2 * t734 * t726 + 0.4e1 / 0.27e2 * t738 * t726 - 0.8e1 / 0.81e2 * t741 * t726 + 0.2e2 / 0.81e2 * t745 * t726 - 0.1e2 / 0.81e2 * t748 * t726 - 0.2e1 / 0.81e2 * t751 * t753 + 0.2e1 / 0.27e2 * t757 * t759 - t762 * t753 / 0.27e2 + 0.4e1 / 0.27e2 * t766 * t759 - 0.4e1 / 0.81e2 * t769 * t753 + 0.2e2 / 0.81e2 * t773 * t759 - 0.5e1 / 0.81e2 * t776 * t753;
  t780 = t722 + t779;
  t785 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t654 * t127 - t612 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t246 * t302 + t568 - t619 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t94 * t780);
  tv2rho22 = 0.2e1 * t240 + 0.2e1 * t307 + t6 * (t643 + t785);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t793 = t5 * t146 * t336 / 0.8e1;
  t794 = t421 * t39;
  t796 = 0.1e1 / t40 / t794;
  t797 = sigma[0] * t796;
  t798 = t419 * t797;
  t801 = t418 * t796;
  t802 = sigma[0] * t65;
  t806 = t418 * sigma[0];
  t807 = t796 * t445;
  t812 = t165 * t37 * t157;
  t821 = t154 * t184;
  t836 = -t432 * t798 / 0.108e3 + t437 * t801 * t802 / 0.216e3 - t444 * t806 * t807 / 0.108e3 - 0.2e1 / 0.9e1 * t164 * t812 - t171 * t812 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t812 - 0.5e1 / 0.9e1 * t179 * t812 - 0.2e1 / 0.9e1 * t189 * t821 - t195 * t821 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t821 - 0.5e1 / 0.9e1 * t203 * t821 + t414 * t798 / 0.108e3 - t323 * t821 / 0.9e1 - t310 * t812 / 0.9e1;
  t838 = t436 * t801 * sigma[0];
  t846 = t419 * t797 * t65;
  t850 = t419 * t807 * sigma[0];
  t871 = t478 * t838 / 0.27e2 - 0.5e1 / 0.54e2 * t482 * t838 + 0.5e1 / 0.108e3 * t485 * t838 + t488 * t846 / 0.108e3 - t495 * t850 / 0.36e2 + t500 * t846 / 0.72e2 - t504 * t850 / 0.18e2 + t507 * t846 / 0.54e2 - 0.5e1 / 0.54e2 * t511 * t850 + 0.5e1 / 0.216e3 * t514 * t846 + t461 * t838 / 0.54e2 - t468 * t838 / 0.36e2 + t471 * t838 / 0.36e2 - t475 * t838 / 0.18e2;
  t872 = t836 + t871;
  t877 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t336 - t793 - 0.3e1 / 0.8e1 * t5 * t27 * t872);
  tv2rhosigma0 = t6 * t877 + t340;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t884 = t5 * t222 * t366 / 0.8e1;
  t886 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t366 - t884);
  tv2rhosigma2 = t6 * t886 + t370;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t892 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t336 - t793);
  tv2rhosigma3 = t6 * t892 + t340;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t897 = t668 * t96;
  t899 = 0.1e1 / t97 / t897;
  t900 = t899 * sigma[2];
  t902 = t419 * t900 * t116;
  t905 = t899 * t687;
  t907 = t419 * t905 * sigma[2];
  t920 = t418 * t899;
  t922 = t436 * t920 * sigma[2];
  t937 = t751 * t902 / 0.108e3 - t757 * t907 / 0.36e2 + t762 * t902 / 0.72e2 - t766 * t907 / 0.18e2 + t769 * t902 / 0.54e2 - 0.5e1 / 0.54e2 * t773 * t907 + 0.5e1 / 0.216e3 * t776 * t902 + t724 * t922 / 0.54e2 - t731 * t922 / 0.36e2 + t734 * t922 / 0.36e2 - t738 * t922 / 0.18e2 + t741 * t922 / 0.27e2 - 0.5e1 / 0.54e2 * t745 * t922 + 0.5e1 / 0.108e3 * t748 * t922;
  t938 = t154 * t280;
  t942 = t165 * t37 * t256;
  t945 = sigma[2] * t116;
  t949 = t418 * sigma[2];
  t953 = t419 * t900;
  t974 = -t323 * t938 / 0.9e1 - t341 * t942 / 0.9e1 + t437 * t920 * t945 / 0.216e3 - t444 * t949 * t905 / 0.108e3 + t666 * t953 / 0.108e3 - t679 * t953 / 0.108e3 - 0.2e1 / 0.9e1 * t263 * t942 - t269 * t942 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t942 - 0.5e1 / 0.9e1 * t277 * t942 - 0.2e1 / 0.9e1 * t285 * t938 - t291 * t938 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t938 - 0.5e1 / 0.9e1 * t299 * t938;
  t975 = t937 + t974;
  t980 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t366 - t884 - 0.3e1 / 0.8e1 * t5 * t94 * t975);
  tv2rhosigma5 = t6 * t980 + t370;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t982 = t410 * t411;
  t983 = t421 * rho[0];
  t985 = 0.1e1 / t40 / t983;
  t987 = t436 * t418 * t985;
  t990 = t431 * t411;
  t1007 = t435 * t412;
  t1009 = t419 * t985 * t65;
  t1012 = t443 * t412;
  t1014 = t419 * t985 * t445;
  t1031 = -t982 * t987 / 0.288e3 + t990 * t987 / 0.288e3 - t461 * t987 / 0.144e3 + t468 * t987 / 0.96e2 - t471 * t987 / 0.96e2 + t475 * t987 / 0.48e2 - t478 * t987 / 0.72e2 + 0.5e1 / 0.144e3 * t482 * t987 - 0.5e1 / 0.288e3 * t485 * t987 - t1007 * t1009 / 0.576e3 + t1012 * t1014 / 0.288e3 - t488 * t1009 / 0.288e3 + t495 * t1014 / 0.96e2 - t500 * t1009 / 0.192e3 + t504 * t1014 / 0.48e2 - t507 * t1009 / 0.144e3 + 0.5e1 / 0.144e3 * t511 * t1014 - 0.5e1 / 0.576e3 * t514 * t1009;
  t1035 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1031);
  tv2sigma20 = t6 * t1035;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1036 = t665 * t411;
  t1037 = t668 * rho[1];
  t1039 = 0.1e1 / t97 / t1037;
  t1041 = t436 * t418 * t1039;
  t1044 = t678 * t411;
  t1062 = t419 * t1039 * t116;
  t1066 = t419 * t1039 * t687;
  t1083 = -t1036 * t1041 / 0.288e3 + t1044 * t1041 / 0.288e3 - t724 * t1041 / 0.144e3 + t731 * t1041 / 0.96e2 - t734 * t1041 / 0.96e2 + t738 * t1041 / 0.48e2 - t741 * t1041 / 0.72e2 + 0.5e1 / 0.144e3 * t745 * t1041 - 0.5e1 / 0.288e3 * t748 * t1041 - t1007 * t1062 / 0.576e3 + t1012 * t1066 / 0.288e3 - t751 * t1062 / 0.288e3 + t757 * t1066 / 0.96e2 - t762 * t1062 / 0.192e3 + t766 * t1066 / 0.48e2 - t769 * t1062 / 0.144e3 + 0.5e1 / 0.144e3 * t773 * t1066 - 0.5e1 / 0.576e3 * t776 * t1062;
  t1087 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t1083);
  tv2sigma25 = t6 * t1087;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1091 = 0.1e1 / t373 / t19;
  t1092 = t375 * t136;
  t1095 = t374 * t136;
  t1098 = t132 * t132;
  t1099 = 0.1e1 / t1098;
  t1100 = t16 * t1099;
  t1103 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t379 - 0.6e1 * t1100);
  t1107 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1091 * t1092 + 0.4e1 / 0.3e1 * t1095 * t383 + 0.4e1 / 0.3e1 * t23 * t1103);
  t1108 = t1107 * t26;
  t1112 = t387 * t145;
  t1114 = t5 * t1112 * t80;
  t1119 = t139 * t400;
  t1121 = t5 * t1119 * t80;
  t1124 = t5 * t392 * t206;
  t1130 = 0.1e1 / t144 / t132;
  t1131 = t25 * t1130;
  t1134 = 0.5e1 / 0.36e2 * t5 * t1131 * t80;
  t1136 = t5 * t401 * t206;
  t1139 = t5 * t146 * t538;
  t1142 = 0.1e1 / t41 / t983;
  t1144 = t165 * t38 * t1142;
  t1153 = sigma[0] * t1142;
  t1155 = t154 * t1153 * t65;
  t1164 = t421 * t421;
  t1166 = 0.1e1 / t40 / t1164;
  t1167 = t420 * t1166;
  t1169 = t419 * t1167 * t445;
  t1173 = t419 * t1167 * t65;
  t1177 = t436 * t438 * t1166;
  t1184 = -0.308e3 / 0.81e2 * t164 * t1144 - 0.154e3 / 0.27e2 * t171 * t1144 - 0.616e3 / 0.81e2 * t175 * t1144 - 0.77e3 / 0.81e2 * t179 * t1144 - 0.308e3 / 0.81e2 * t189 * t1155 - 0.154e3 / 0.27e2 * t195 * t1155 - 0.616e3 / 0.81e2 * t199 * t1155 - 0.77e3 / 0.81e2 * t203 * t1155 - 0.22e3 / 0.81e2 * t511 * t1169 + 0.55e2 / 0.81e2 * t514 * t1173 - 0.22e2 / 0.27e2 * t468 * t1177 + 0.22e2 / 0.27e2 * t471 * t1177 - 0.44e2 / 0.27e2 * t475 * t1177;
  t1203 = t411 * params->mu;
  t1205 = t32 * t32;
  t1206 = 0.1e1 / t1205;
  t1207 = t64 * t1203 * t1206;
  t1209 = 0.1e1 / t417 / params->kappa;
  t1210 = t420 * sigma[0];
  t1211 = t1209 * t1210;
  t1212 = t1164 * t155;
  t1213 = 0.1e1 / t1212;
  t1215 = t1211 * t1213 * t65;
  t1219 = t68 * t1203 * t1206;
  t1221 = t1211 * t1213 * t445;
  t1225 = 0.1e1 / t429 / t150;
  t1227 = t54 * t1225 * t1203;
  t1228 = t1206 * t1209;
  t1230 = t1228 * t1210 * t1213;
  t1234 = t71 * t1203 * t1206;
  t1235 = t445 * t65;
  t1237 = t1211 * t1213 * t1235;
  t1240 = 0.88e2 / 0.81e2 * t478 * t1177 - 0.22e3 / 0.81e2 * t482 * t1177 + 0.11e3 / 0.81e2 * t485 * t1177 + 0.22e2 / 0.81e2 * t488 * t1173 + 0.44e2 / 0.81e2 * t461 * t1177 - 0.22e2 / 0.27e2 * t495 * t1169 + 0.11e2 / 0.27e2 * t500 * t1173 - 0.44e2 / 0.27e2 * t504 * t1169 + 0.44e2 / 0.81e2 * t507 * t1173 - 0.2e1 / 0.243e3 * t1207 * t1215 + 0.4e1 / 0.81e2 * t1219 * t1221 - 0.4e1 / 0.81e2 * t1227 * t1230 - 0.4e1 / 0.81e2 * t1234 * t1237;
  t1243 = t29 * t430 * t1203;
  t1247 = 0.1e1 / t429 / t47;
  t1249 = t51 * t1247 * t1203;
  t1252 = t1203 * t1206;
  t1253 = t188 * t1252;
  t1256 = t494 * t1252;
  t1259 = t194 * t1252;
  t1262 = t74 * t66;
  t1263 = t1262 * t1252;
  t1266 = t503 * t1252;
  t1269 = t198 * t1252;
  t1272 = t77 * t69;
  t1273 = t1272 * t1252;
  t1276 = t510 * t1252;
  t1279 = t202 * t1252;
  t1282 = t430 * t1203;
  t1283 = t162 * t1282;
  t1286 = t1247 * t1203;
  t1287 = t466 * t1286;
  t1290 = -0.4e1 / 0.81e2 * t1243 * t1230 + 0.8e1 / 0.81e2 * t1249 * t1230 - 0.4e1 / 0.243e3 * t1253 * t1215 + 0.4e1 / 0.27e2 * t1256 * t1221 - 0.2e1 / 0.81e2 * t1259 * t1215 - 0.16e2 / 0.81e2 * t1263 * t1237 + 0.8e1 / 0.27e2 * t1266 * t1221 - 0.8e1 / 0.243e3 * t1269 * t1215 - 0.4e2 / 0.81e2 * t1273 * t1237 + 0.4e2 / 0.81e2 * t1276 * t1221 - 0.1e2 / 0.243e3 * t1279 * t1215 - 0.8e1 / 0.81e2 * t1283 * t1230 + 0.8e1 / 0.27e2 * t1287 * t1230;
  t1291 = t170 * t1282;
  t1294 = t57 * t49;
  t1295 = t1225 * t1203;
  t1296 = t1294 * t1295;
  t1299 = t474 * t1286;
  t1302 = t174 * t1282;
  t1305 = t60 * t52;
  t1306 = t1305 * t1295;
  t1309 = t481 * t1286;
  t1312 = t178 * t1282;
  t1315 = t1142 * t65;
  t1322 = t419 * t1167;
  t1329 = t1166 * t445;
  t1335 = -0.4e1 / 0.27e2 * t1291 * t1230 - 0.16e2 / 0.81e2 * t1296 * t1230 + 0.16e2 / 0.27e2 * t1299 * t1230 - 0.16e2 / 0.81e2 * t1302 * t1230 - 0.4e2 / 0.81e2 * t1306 * t1230 + 0.8e2 / 0.81e2 * t1309 * t1230 - 0.2e2 / 0.81e2 * t1312 * t1230 - 0.154e3 / 0.81e2 * t183 * t38 * t1315 - 0.154e3 / 0.81e2 * t153 * t154 * t1153 - 0.22e2 / 0.81e2 * t432 * t1322 + 0.11e2 / 0.81e2 * t437 * t438 * t1166 * t65 - 0.22e2 / 0.81e2 * t444 * t438 * t1329 + 0.22e2 / 0.81e2 * t414 * t1322;
  t1337 = t1184 + t1240 + t1290 + t1335;
  t1342 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1108 * t80 - 0.3e1 / 0.8e1 * t1114 - 0.9e1 / 0.8e1 * t5 * t388 * t206 + t1121 / 0.4e1 - 0.3e1 / 0.4e1 * t1124 - 0.9e1 / 0.8e1 * t5 * t140 * t538 - t1134 + t1136 / 0.4e1 - 0.3e1 / 0.8e1 * t1139 - 0.3e1 / 0.8e1 * t5 * t27 * t1337);
  t1344 = 0.1e1 / t544 / t89;
  t1345 = t546 * t214;
  t1348 = t545 * t214;
  t1351 = t86 * t1099;
  t1354 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t379 - 0.6e1 * t1351);
  t1358 = my_piecewise3(t90, 0, -0.8e1 / 0.27e2 * t1344 * t1345 + 0.4e1 / 0.3e1 * t1348 * t552 + 0.4e1 / 0.3e1 * t91 * t1354);
  t1359 = t1358 * t26;
  t1363 = t556 * t145;
  t1365 = t5 * t1363 * t127;
  t1367 = t217 * t400;
  t1369 = t5 * t1367 * t127;
  t1371 = t93 * t1130;
  t1374 = 0.5e1 / 0.36e2 * t5 * t1371 * t127;
  t1376 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t1359 * t127 - 0.3e1 / 0.8e1 * t1365 + t1369 / 0.4e1 - t1374);
  tv3rho30 = 0.3e1 * t543 + 0.3e1 * t570 + t6 * (t1342 + t1376);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1379 = 0.2e1 * t596;
  t1380 = 0.2e1 * t622;
  t1381 = t1091 * t231;
  t1384 = t374 * t577;
  t1389 = 0.2e1 * t379;
  t1390 = 0.6e1 * t1100;
  t1392 = my_piecewise5(t10, 0, t14, 0, t1389 - t1390);
  t1396 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1381 * t375 + 0.8e1 / 0.9e1 * t1384 * t136 + 0.4e1 / 0.9e1 * t573 * t383 + 0.4e1 / 0.3e1 * t23 * t1392);
  t1397 = t1396 * t26;
  t1401 = t581 * t145;
  t1404 = t5 * t1401 * t80 / 0.4e1;
  t1408 = t234 * t400;
  t1410 = t5 * t1408 * t80;
  t1414 = t5 * t586 * t206 / 0.4e1;
  t1423 = -0.3e1 / 0.8e1 * t5 * t1397 * t80 - t1404 - 0.3e1 / 0.4e1 * t5 * t582 * t206 + t1410 / 0.12e2 - t1414 - 0.3e1 / 0.8e1 * t5 * t235 * t538 - t1114 / 0.8e1 + t1121 / 0.6e1 - t1124 / 0.4e1 - t1134 + t1136 / 0.6e1 - t1139 / 0.8e1;
  t1424 = my_piecewise3(t1, 0, t1423);
  t1425 = t1344 * t242;
  t1428 = t545 * t601;
  t1433 = 0.6e1 * t1351;
  t1435 = my_piecewise5(t14, 0, t10, 0, -t1389 - t1433);
  t1439 = my_piecewise3(t90, 0, -0.8e1 / 0.27e2 * t1425 * t546 + 0.8e1 / 0.9e1 * t1428 * t214 + 0.4e1 / 0.9e1 * t597 * t552 + 0.4e1 / 0.3e1 * t91 * t1435);
  t1440 = t1439 * t26;
  t1444 = t605 * t145;
  t1447 = t5 * t1444 * t127 / 0.4e1;
  t1448 = t245 * t400;
  t1450 = t5 * t1448 * t127;
  t1459 = t5 * t561 * t302 / 0.4e1;
  t1461 = t5 * t565 * t302;
  t1464 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t1440 * t127 - t1447 + t1450 / 0.12e2 - t1365 / 0.8e1 + t1369 / 0.6e1 - t1374 - 0.3e1 / 0.8e1 * t5 * t557 * t302 - t1459 + t1461 / 0.12e2);
  tv3rho31 = t543 + t570 + t1379 + t1380 + t6 * (t1424 + t1464);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1467 = t1091 * t627;
  t1472 = t374 * t632;
  t1476 = my_piecewise5(t10, 0, t14, 0, -t1389 - t1390);
  t1480 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1467 * t136 + 0.8e1 / 0.9e1 * t573 * t577 + 0.4e1 / 0.9e1 * t1472 * t136 + 0.4e1 / 0.3e1 * t23 * t1476);
  t1481 = t1480 * t26;
  t1485 = t636 * t145;
  t1487 = t5 * t1485 * t80;
  t1496 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1481 * t80 - t1487 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t637 * t206 - t1404 + t1410 / 0.6e1 - t1414 + t1121 / 0.12e2 - t1134 + t1136 / 0.12e2);
  t1497 = t1344 * t644;
  t1502 = t545 * t649;
  t1506 = my_piecewise5(t14, 0, t10, 0, t1389 - t1433);
  t1510 = my_piecewise3(t90, 0, -0.8e1 / 0.27e2 * t1497 * t214 + 0.8e1 / 0.9e1 * t597 * t601 + 0.4e1 / 0.9e1 * t1502 * t214 + 0.4e1 / 0.3e1 * t91 * t1506);
  t1511 = t1510 * t26;
  t1515 = t653 * t145;
  t1517 = t5 * t1515 * t127;
  t1524 = t5 * t610 * t302;
  t1532 = t5 * t222 * t780;
  t1534 = -0.3e1 / 0.8e1 * t5 * t1511 * t127 - t1517 / 0.8e1 - t1447 + t1450 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t606 * t302 - t1524 / 0.4e1 + t1369 / 0.12e2 - t1374 - t1459 + t1461 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t218 * t780 - t1532 / 0.8e1;
  t1535 = my_piecewise3(t85, 0, t1534);
  tv3rho32 = t1379 + t1380 + t643 + t785 + t6 * (t1496 + t1535);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1540 = t627 * t231;
  t1547 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t379 - 0.6e1 * t1100);
  t1551 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1091 * t1540 + 0.4e1 / 0.3e1 * t573 * t632 + 0.4e1 / 0.3e1 * t23 * t1547);
  t1552 = t1551 * t26;
  t1559 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1552 * t80 - 0.3e1 / 0.8e1 * t1487 + t1410 / 0.4e1 - t1134);
  t1560 = t644 * t242;
  t1567 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t379 - 0.6e1 * t1351);
  t1571 = my_piecewise3(t90, 0, -0.8e1 / 0.27e2 * t1344 * t1560 + 0.4e1 / 0.3e1 * t597 * t649 + 0.4e1 / 0.3e1 * t91 * t1567);
  t1572 = t1571 * t26;
  t1587 = t677 * t1203;
  t1588 = t261 * t1587;
  t1589 = t667 * sigma[2];
  t1590 = t668 * t668;
  t1591 = t1590 * t254;
  t1592 = 0.1e1 / t1591;
  t1594 = t1228 * t1589 * t1592;
  t1598 = 0.1e1 / t676 / t104;
  t1599 = t1598 * t1203;
  t1600 = t729 * t1599;
  t1603 = t268 * t1587;
  t1606 = t57 * t106;
  t1608 = 0.1e1 / t676 / t250;
  t1609 = t1608 * t1203;
  t1610 = t1606 * t1609;
  t1613 = t737 * t1599;
  t1616 = t272 * t1587;
  t1619 = t60 * t108;
  t1620 = t1619 * t1609;
  t1623 = t744 * t1599;
  t1626 = t276 * t1587;
  t1630 = 0.1e1 / t98 / t1037;
  t1631 = t1630 * t116;
  t1635 = sigma[2] * t1630;
  t1640 = 0.1e1 / t97 / t1590;
  t1641 = t1640 * t687;
  t1645 = t667 * t1640;
  t1646 = t419 * t1645;
  t1649 = -0.8e1 / 0.81e2 * t1588 * t1594 + 0.8e1 / 0.27e2 * t1600 * t1594 - 0.4e1 / 0.27e2 * t1603 * t1594 - 0.16e2 / 0.81e2 * t1610 * t1594 + 0.16e2 / 0.27e2 * t1613 * t1594 - 0.16e2 / 0.81e2 * t1616 * t1594 - 0.4e2 / 0.81e2 * t1620 * t1594 + 0.8e2 / 0.81e2 * t1623 * t1594 - 0.2e2 / 0.81e2 * t1626 * t1594 - 0.154e3 / 0.81e2 * t183 * t95 * t1631 - 0.154e3 / 0.81e2 * t253 * t154 * t1635 - 0.22e2 / 0.81e2 * t444 * t682 * t1641 + 0.22e2 / 0.81e2 * t666 * t1646;
  t1656 = t284 * t1252;
  t1657 = t1209 * t1589;
  t1659 = t1657 * t1592 * t116;
  t1662 = t756 * t1252;
  t1663 = t1592 * t687;
  t1664 = t1657 * t1663;
  t1667 = t290 * t1252;
  t1670 = t74 * t117;
  t1671 = t1670 * t1252;
  t1672 = t687 * t116;
  t1673 = t1592 * t1672;
  t1674 = t1657 * t1673;
  t1677 = t765 * t1252;
  t1680 = t294 * t1252;
  t1683 = t77 * t119;
  t1684 = t1683 * t1252;
  t1687 = t772 * t1252;
  t1690 = t298 * t1252;
  t1694 = t54 * t1608 * t1203;
  t1699 = -0.22e2 / 0.81e2 * t679 * t1646 + 0.11e2 / 0.81e2 * t437 * t682 * t1640 * t116 - 0.4e1 / 0.243e3 * t1656 * t1659 + 0.4e1 / 0.27e2 * t1662 * t1664 - 0.2e1 / 0.81e2 * t1667 * t1659 - 0.16e2 / 0.81e2 * t1671 * t1674 + 0.8e1 / 0.27e2 * t1677 * t1664 - 0.8e1 / 0.243e3 * t1680 * t1659 - 0.4e2 / 0.81e2 * t1684 * t1674 + 0.4e2 / 0.81e2 * t1687 * t1664 - 0.1e2 / 0.243e3 * t1690 * t1659 - 0.4e1 / 0.81e2 * t1694 * t1594 - 0.4e1 / 0.81e2 * t1234 * t1674;
  t1702 = t29 * t677 * t1203;
  t1706 = t51 * t1598 * t1203;
  t1714 = t154 * t1635 * t116;
  t1718 = t165 * t95 * t1630;
  t1728 = t419 * t1645 * t687;
  t1732 = t419 * t1645 * t116;
  t1739 = -0.4e1 / 0.81e2 * t1702 * t1594 + 0.8e1 / 0.81e2 * t1706 * t1594 - 0.2e1 / 0.243e3 * t1207 * t1659 + 0.4e1 / 0.81e2 * t1219 * t1664 - 0.77e3 / 0.81e2 * t299 * t1714 - 0.77e3 / 0.81e2 * t277 * t1718 - 0.308e3 / 0.81e2 * t285 * t1714 - 0.154e3 / 0.27e2 * t291 * t1714 - 0.616e3 / 0.81e2 * t295 * t1714 - 0.22e3 / 0.81e2 * t773 * t1728 + 0.55e2 / 0.81e2 * t776 * t1732 + 0.22e2 / 0.81e2 * t751 * t1732 - 0.22e2 / 0.27e2 * t757 * t1728;
  t1747 = t436 * t682 * t1640;
  t1768 = 0.11e2 / 0.27e2 * t762 * t1732 - 0.44e2 / 0.27e2 * t766 * t1728 + 0.44e2 / 0.81e2 * t769 * t1732 + 0.44e2 / 0.81e2 * t724 * t1747 - 0.22e2 / 0.27e2 * t731 * t1747 + 0.22e2 / 0.27e2 * t734 * t1747 - 0.44e2 / 0.27e2 * t738 * t1747 + 0.88e2 / 0.81e2 * t741 * t1747 - 0.22e3 / 0.81e2 * t745 * t1747 + 0.11e3 / 0.81e2 * t748 * t1747 - 0.308e3 / 0.81e2 * t263 * t1718 - 0.154e3 / 0.27e2 * t269 * t1718 - 0.616e3 / 0.81e2 * t273 * t1718;
  t1770 = t1649 + t1699 + t1739 + t1768;
  t1775 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t1572 * t127 - 0.3e1 / 0.8e1 * t1517 - 0.9e1 / 0.8e1 * t5 * t654 * t302 + t1450 / 0.4e1 - 0.3e1 / 0.4e1 * t1524 - 0.9e1 / 0.8e1 * t5 * t246 * t780 - t1374 + t1461 / 0.4e1 - 0.3e1 / 0.8e1 * t1532 - 0.3e1 / 0.8e1 * t5 * t94 * t1770);
  tv3rho33 = 0.3e1 * t643 + 0.3e1 * t785 + t6 * (t1559 + t1775);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1783 = t5 * t392 * t336;
  t1790 = t5 * t401 * t336 / 0.12e2;
  t1792 = t5 * t146 * t872;
  t1794 = t1164 * t39;
  t1795 = 0.1e1 / t1794;
  t1796 = t1209 * t1795;
  t1797 = t1235 * t420;
  t1798 = t1796 * t1797;
  t1801 = t445 * t420;
  t1802 = t1796 * t1801;
  t1805 = t420 * t65;
  t1806 = t1796 * t1805;
  t1815 = t154 * t456;
  t1825 = t165 * t37 * t451;
  t1832 = 0.2e1 / 0.27e2 * t1263 * t1798 - t1266 * t1802 / 0.9e1 + t1269 * t1806 / 0.81e2 + 0.5e1 / 0.27e2 * t1273 * t1798 - 0.5e1 / 0.27e2 * t1276 * t1802 + 0.5e1 / 0.324e3 * t1279 * t1806 + 0.44e2 / 0.27e2 * t199 * t1815 + 0.55e2 / 0.27e2 * t203 * t1815 + 0.22e2 / 0.27e2 * t189 * t1815 + 0.11e2 / 0.9e1 * t195 * t1815 + 0.44e2 / 0.27e2 * t175 * t1825 + 0.55e2 / 0.27e2 * t179 * t1825 + 0.22e2 / 0.27e2 * t164 * t1825;
  t1835 = t424 * sigma[0];
  t1836 = t419 * t1835;
  t1849 = t1228 * t420 * t1795;
  t1864 = 0.11e2 / 0.9e1 * t171 * t1825 - t414 * t1836 / 0.12e2 + t432 * t1836 / 0.12e2 + t444 * t806 * t446 / 0.12e2 + 0.11e2 / 0.27e2 * t310 * t1825 + 0.11e2 / 0.27e2 * t323 * t1815 + t1227 * t1849 / 0.54e2 + t1234 * t1798 / 0.54e2 + t1243 * t1849 / 0.54e2 - t1249 * t1849 / 0.27e2 + t1207 * t1806 / 0.324e3 - t1219 * t1802 / 0.54e2 + 0.2e1 / 0.27e2 * t1296 * t1849;
  t1882 = t418 * t424;
  t1893 = t419 * t1835 * t65;
  t1896 = -0.2e1 / 0.9e1 * t1299 * t1849 + 0.2e1 / 0.27e2 * t1302 * t1849 + 0.5e1 / 0.27e2 * t1306 * t1849 - 0.1e2 / 0.27e2 * t1309 * t1849 + 0.5e1 / 0.54e2 * t1312 * t1849 + t1253 * t1806 / 0.162e3 - t1256 * t1802 / 0.18e2 + t1259 * t1806 / 0.108e3 - t437 * t1882 * t802 / 0.24e2 + t1283 * t1849 / 0.27e2 - t1287 * t1849 / 0.9e1 + t1291 * t1849 / 0.18e2 - 0.5e1 / 0.24e2 * t514 * t1893;
  t1898 = t419 * t446 * sigma[0];
  t1912 = t436 * t1882 * sigma[0];
  t1927 = t504 * t1898 / 0.2e1 - t507 * t1893 / 0.6e1 + 0.5e1 / 0.6e1 * t511 * t1898 - t488 * t1893 / 0.12e2 + t495 * t1898 / 0.4e1 - t500 * t1893 / 0.8e1 + t475 * t1912 / 0.2e1 - t478 * t1912 / 0.3e1 + 0.5e1 / 0.6e1 * t482 * t1912 - 0.5e1 / 0.12e2 * t485 * t1912 - t461 * t1912 / 0.6e1 + t468 * t1912 / 0.4e1 - t471 * t1912 / 0.4e1;
  t1929 = t1832 + t1864 + t1896 + t1927;
  t1934 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t388 * t336 - t1783 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t872 + t1790 - t1792 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1929);
  tv3rho2sigma0 = t6 * t1934 + 0.2e1 * t877;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1941 = t5 * t561 * t366;
  t1945 = t5 * t565 * t366 / 0.12e2;
  t1947 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t557 * t366 - t1941 / 0.4e1 + t1945);
  tv3rho2sigma2 = t6 * t1947 + 0.2e1 * t886;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1953 = t5 * t586 * t336;
  t1961 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t582 * t336 - t1953 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t235 * t872 - t1783 / 0.8e1 + t1790 - t1792 / 0.8e1);
  tv3rho2sigma3 = t6 * t1961 + t877 + t892;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1967 = t5 * t610 * t366;
  t1974 = t5 * t222 * t975;
  t1977 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t606 * t366 - t1967 / 0.8e1 - t1941 / 0.8e1 + t1945 - 0.3e1 / 0.8e1 * t5 * t218 * t975 - t1974 / 0.8e1);
  tv3rho2sigma5 = t6 * t1977 + t886 + t980;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1985 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t637 * t336 - t1953 / 0.4e1 + t1790);
  tv3rho2sigma6 = t6 * t1985 + 0.2e1 * t892;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1997 = t165 * t37 * t693;
  t2000 = t154 * t698;
  t2003 = t1590 * t96;
  t2004 = 0.1e1 / t2003;
  t2006 = t1228 * t667 * t2004;
  t2009 = t1209 * t667;
  t2010 = t2004 * t1672;
  t2011 = t2009 * t2010;
  t2014 = t1209 * t2004;
  t2015 = t667 * t116;
  t2016 = t2014 * t2015;
  t2020 = t2009 * t2004 * t687;
  t2027 = t418 * t671;
  t2029 = t436 * t2027 * sigma[2];
  t2033 = t419 * t688 * sigma[2];
  t2036 = t671 * sigma[2];
  t2038 = t419 * t2036 * t116;
  t2045 = 0.11e2 / 0.27e2 * t341 * t1997 + 0.11e2 / 0.27e2 * t323 * t2000 + t1694 * t2006 / 0.54e2 + t1234 * t2011 / 0.54e2 + t1207 * t2016 / 0.324e3 - t1219 * t2020 / 0.54e2 + t1702 * t2006 / 0.54e2 - t1706 * t2006 / 0.27e2 - t724 * t2029 / 0.6e1 + t766 * t2033 / 0.2e1 - t769 * t2038 / 0.6e1 + 0.5e1 / 0.6e1 * t773 * t2033 - 0.5e1 / 0.24e2 * t776 * t2038;
  t2072 = t757 * t2033 / 0.4e1 - t762 * t2038 / 0.8e1 + 0.5e1 / 0.6e1 * t745 * t2029 - 0.5e1 / 0.12e2 * t748 * t2029 - t751 * t2038 / 0.12e2 + t731 * t2029 / 0.4e1 - t734 * t2029 / 0.4e1 + t738 * t2029 / 0.2e1 - t741 * t2029 / 0.3e1 + 0.55e2 / 0.27e2 * t299 * t2000 + 0.11e2 / 0.9e1 * t291 * t2000 + 0.44e2 / 0.27e2 * t295 * t2000 + 0.55e2 / 0.27e2 * t277 * t1997;
  t2083 = t419 * t2036;
  t2102 = 0.22e2 / 0.27e2 * t285 * t2000 + 0.11e2 / 0.9e1 * t269 * t1997 + 0.44e2 / 0.27e2 * t273 * t1997 + t444 * t949 * t688 / 0.12e2 + t679 * t2083 / 0.12e2 + 0.22e2 / 0.27e2 * t263 * t1997 + 0.2e1 / 0.27e2 * t1671 * t2011 - t1677 * t2020 / 0.9e1 + t1680 * t2016 / 0.81e2 + 0.5e1 / 0.27e2 * t1684 * t2011 - 0.5e1 / 0.27e2 * t1687 * t2020 + 0.5e1 / 0.324e3 * t1690 * t2016 + 0.2e1 / 0.27e2 * t1610 * t2006;
  t2130 = -0.2e1 / 0.9e1 * t1613 * t2006 + 0.2e1 / 0.27e2 * t1616 * t2006 + 0.5e1 / 0.27e2 * t1620 * t2006 - 0.1e2 / 0.27e2 * t1623 * t2006 + 0.5e1 / 0.54e2 * t1626 * t2006 + t1656 * t2016 / 0.162e3 - t1662 * t2020 / 0.18e2 + t1667 * t2016 / 0.108e3 - t666 * t2083 / 0.12e2 + t1588 * t2006 / 0.27e2 - t1600 * t2006 / 0.9e1 + t1603 * t2006 / 0.18e2 - t437 * t2027 * t945 / 0.24e2;
  t2132 = t2045 + t2072 + t2102 + t2130;
  t2137 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t654 * t366 - t1967 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t246 * t975 + t1945 - t1974 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t94 * t2132);
  tv3rho2sigma8 = t6 * t2137 + 0.2e1 * t980;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2144 = t5 * t146 * t1031 / 0.8e1;
  t2145 = t436 * t801;
  t2148 = t1164 * rho[0];
  t2149 = 0.1e1 / t2148;
  t2150 = t1209 * t2149;
  t2151 = t2150 * t802;
  t2154 = t445 * sigma[0];
  t2155 = t2150 * t2154;
  t2158 = t1209 * sigma[0];
  t2159 = t2149 * t1235;
  t2160 = t2158 * t2159;
  t2164 = t419 * t796 * t65;
  t2167 = t419 * t807;
  t2173 = t1228 * t2149 * sigma[0];
  t2203 = 0.5e1 / 0.108e3 * t514 * t2164 + t500 * t2164 / 0.36e2 - t504 * t2167 / 0.9e1 + t507 * t2164 / 0.27e2 - 0.5e1 / 0.27e2 * t511 * t2167 + 0.5e1 / 0.54e2 * t485 * t2145 + t488 * t2164 / 0.54e2 - t495 * t2167 / 0.18e2 + t471 * t2145 / 0.18e2 - t475 * t2145 / 0.9e1 + 0.2e1 / 0.27e2 * t478 * t2145;
  t2248 = -t1253 * t2151 / 0.432e3 + t1256 * t2155 / 0.48e2 - t1259 * t2151 / 0.288e3 - t1283 * t2173 / 0.72e2 + t1287 * t2173 / 0.24e2 - t1291 * t2173 / 0.48e2 - t1296 * t2173 / 0.36e2 + t1299 * t2173 / 0.12e2 - t1302 * t2173 / 0.36e2 - 0.5e1 / 0.72e2 * t1306 * t2173 + 0.5e1 / 0.36e2 * t1309 * t2173;
  t2250 = t982 * t2145 / 0.54e2 - t1207 * t2151 / 0.864e3 + t1219 * t2155 / 0.144e3 - t1234 * t2160 / 0.144e3 + t1007 * t2164 / 0.108e3 - t1012 * t2167 / 0.54e2 - t990 * t2145 / 0.54e2 - t1243 * t2173 / 0.144e3 + t1249 * t2173 / 0.72e2 - t1227 * t2173 / 0.144e3 + t2203 - 0.5e1 / 0.27e2 * t482 * t2145 + t461 * t2145 / 0.27e2 - t468 * t2145 / 0.18e2 - t1263 * t2160 / 0.36e2 + t1266 * t2155 / 0.24e2 - t1269 * t2151 / 0.216e3 - 0.5e1 / 0.72e2 * t1273 * t2160 + 0.5e1 / 0.72e2 * t1276 * t2155 - 0.5e1 / 0.864e3 * t1279 * t2151 - 0.5e1 / 0.144e3 * t1312 * t2173 + t2248;
  t2255 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t1031 - t2144 - 0.3e1 / 0.8e1 * t5 * t27 * t2250);
  tv3rhosigma20 = t6 * t2255 + t1035;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2262 = t5 * t222 * t1083 / 0.8e1;
  t2264 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t1083 - t2262);
  tv3rhosigma25 = t6 * t2264 + t1087;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2270 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t1031 - t2144);
  tv3rhosigma26 = t6 * t2270 + t1035;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2276 = t419 * t899 * t116;
  t2279 = t419 * t905;
  t2282 = t436 * t920;
  t2287 = t1590 * rho[1];
  t2288 = 0.1e1 / t2287;
  t2290 = t1228 * t2288 * sigma[2];
  t2297 = t1209 * t2288;
  t2298 = t2297 * t945;
  t2301 = t687 * sigma[2];
  t2302 = t2297 * t2301;
  t2305 = t1209 * sigma[2];
  t2306 = t2288 * t1672;
  t2307 = t2305 * t2306;
  t2333 = -t1588 * t2290 / 0.72e2 + t1600 * t2290 / 0.24e2 - t1603 * t2290 / 0.48e2 + 0.2e1 / 0.27e2 * t741 * t2282 - 0.5e1 / 0.27e2 * t745 * t2282 + 0.5e1 / 0.54e2 * t748 * t2282 + t724 * t2282 / 0.27e2 - t731 * t2282 / 0.18e2 + t734 * t2282 / 0.18e2 - t1656 * t2298 / 0.432e3 + t1662 * t2302 / 0.48e2;
  t2378 = -0.5e1 / 0.72e2 * t1620 * t2290 + 0.5e1 / 0.36e2 * t1623 * t2290 - 0.5e1 / 0.144e3 * t1626 * t2290 - t766 * t2279 / 0.9e1 + t769 * t2276 / 0.27e2 - 0.5e1 / 0.27e2 * t773 * t2279 + 0.5e1 / 0.108e3 * t776 * t2276 + t751 * t2276 / 0.54e2 - t757 * t2279 / 0.18e2 + t762 * t2276 / 0.36e2 - t738 * t2282 / 0.9e1;
  t2380 = t1007 * t2276 / 0.108e3 - t1012 * t2279 / 0.54e2 + t1036 * t2282 / 0.54e2 - t1044 * t2282 / 0.54e2 - t1702 * t2290 / 0.144e3 + t1706 * t2290 / 0.72e2 - t1694 * t2290 / 0.144e3 - t1207 * t2298 / 0.864e3 + t1219 * t2302 / 0.144e3 - t1234 * t2307 / 0.144e3 + t2333 - t1667 * t2298 / 0.288e3 - t1671 * t2307 / 0.36e2 + t1677 * t2302 / 0.24e2 - t1680 * t2298 / 0.216e3 - 0.5e1 / 0.72e2 * t1684 * t2307 + 0.5e1 / 0.72e2 * t1687 * t2302 - 0.5e1 / 0.864e3 * t1690 * t2298 - t1610 * t2290 / 0.36e2 + t1613 * t2290 / 0.12e2 - t1616 * t2290 / 0.36e2 + t2378;
  t2385 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t1083 - t2262 - 0.3e1 / 0.8e1 * t5 * t94 * t2380);
  tv3rhosigma211 = t6 * t2385 + t1087;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2387 = t188 * t1203;
  t2388 = 0.1e1 / t1164;
  t2390 = t1228 * t2388 * t65;
  t2393 = t494 * t1203;
  t2395 = t1228 * t2388 * t445;
  t2398 = t194 * t1203;
  t2401 = t1262 * t1203;
  t2403 = t1228 * t2388 * t1235;
  t2406 = t503 * t1203;
  t2409 = t198 * t1203;
  t2412 = t1272 * t1203;
  t2415 = t510 * t1203;
  t2418 = t202 * t1203;
  t2421 = t1228 * t2388;
  t2428 = t2387 * t2390 / 0.1152e4 - t2393 * t2395 / 0.128e3 + t2398 * t2390 / 0.768e3 + t2401 * t2403 / 0.96e2 - t2406 * t2395 / 0.64e2 + t2409 * t2390 / 0.576e3 + 0.5e1 / 0.192e3 * t2412 * t2403 - 0.5e1 / 0.192e3 * t2415 * t2395 + 0.5e1 / 0.2304e4 * t2418 * t2390 + t1243 * t2421 / 0.384e3 - t1249 * t2421 / 0.192e3 + t1227 * t2421 / 0.384e3;
  t2429 = t1209 * t2388;
  t2439 = t162 * t430;
  t2440 = t1252 * t2429;
  t2443 = t466 * t1247;
  t2446 = t170 * t430;
  t2449 = t1294 * t1225;
  t2452 = t474 * t1247;
  t2455 = t174 * t430;
  t2458 = t1305 * t1225;
  t2461 = t481 * t1247;
  t2464 = t178 * t430;
  t2467 = t1207 * t2429 * t65 / 0.2304e4 - t1219 * t2429 * t445 / 0.384e3 + t1234 * t2429 * t1235 / 0.384e3 + t2439 * t2440 / 0.192e3 - t2443 * t2440 / 0.64e2 + t2446 * t2440 / 0.128e3 + t2449 * t2440 / 0.96e2 - t2452 * t2440 / 0.32e2 + t2455 * t2440 / 0.96e2 + 0.5e1 / 0.192e3 * t2458 * t2440 - 0.5e1 / 0.96e2 * t2461 * t2440 + 0.5e1 / 0.384e3 * t2464 * t2440;
  t2468 = t2428 + t2467;
  t2472 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2468);
  tv3sigma30 = t6 * t2472;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2473 = 0.1e1 / t1590;
  t2474 = t1228 * t2473;
  t2477 = t1209 * t2473;
  t2491 = t268 * t677;
  t2492 = t1252 * t2477;
  t2495 = t1606 * t1608;
  t2498 = t737 * t1598;
  t2501 = t272 * t677;
  t2504 = t1619 * t1608;
  t2507 = t744 * t1598;
  t2510 = t1694 * t2474 / 0.384e3 + t1207 * t2477 * t116 / 0.2304e4 - t1219 * t2477 * t687 / 0.384e3 + t1234 * t2477 * t1672 / 0.384e3 + t1702 * t2474 / 0.384e3 - t1706 * t2474 / 0.192e3 + t2491 * t2492 / 0.128e3 + t2495 * t2492 / 0.96e2 - t2498 * t2492 / 0.32e2 + t2501 * t2492 / 0.96e2 + 0.5e1 / 0.192e3 * t2504 * t2492 - 0.5e1 / 0.96e2 * t2507 * t2492;
  t2511 = t276 * t677;
  t2514 = t284 * t1203;
  t2516 = t1228 * t2473 * t116;
  t2519 = t756 * t1203;
  t2521 = t1228 * t2473 * t687;
  t2524 = t290 * t1203;
  t2527 = t1670 * t1203;
  t2529 = t1228 * t2473 * t1672;
  t2532 = t765 * t1203;
  t2535 = t294 * t1203;
  t2538 = t1683 * t1203;
  t2541 = t772 * t1203;
  t2544 = t298 * t1203;
  t2547 = t261 * t677;
  t2550 = t729 * t1598;
  t2553 = 0.5e1 / 0.384e3 * t2511 * t2492 + t2514 * t2516 / 0.1152e4 - t2519 * t2521 / 0.128e3 + t2524 * t2516 / 0.768e3 + t2527 * t2529 / 0.96e2 - t2532 * t2521 / 0.64e2 + t2535 * t2516 / 0.576e3 + 0.5e1 / 0.192e3 * t2538 * t2529 - 0.5e1 / 0.192e3 * t2541 * t2521 + 0.5e1 / 0.2304e4 * t2544 * t2516 + t2547 * t2492 / 0.192e3 - t2550 * t2492 / 0.64e2;
  t2554 = t2510 + t2553;
  t2558 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t2554);
  tv3sigma39 = t6 * t2558;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t43, t46, t47, t49, t51, t52;
  double t54, t55, t57, t58, t60, t63, t64, t65;
  double t66, t68, t69, t71, t72, t74, t75, t77;
  double t80, t84, t85, t86, t88, t89, t90, t91;
  double t93, t94, t95, t96, t97, t98, t100, t103;
  double t104, t106, t108, t110, t112, t116, t117, t119;
  double t121, t123, t127, t131, tzk0;

  double t132, t133, t134, t136, t139, t140, t144, t145;
  double t146, t149, t150, t151, t152, t153, t154, t155;
  double t157, t158, t162, t163, t164, t165, t167, t170;
  double t171, t174, t175, t178, t179, t182, t183, t184;
  double t188, t189, t191, t194, t195, t198, t199, t202;
  double t203, t206, t211, t212, t214, t217, t218, t222;
  double t225, t227, tvrho0, t231, t234, t235, t240, t242;
  double t245, t246, t250, t251, t252, t253, t254, t256;
  double t257, t261, t262, t263, t265, t268, t269, t272;
  double t273, t276, t277, t280, t284, t285, t287, t290;
  double t291, t294, t295, t298, t299, t302, t307, tvrho1;
  double t310, t312, t323, t325, t336, t340, tvsigma0, tvsigma1;
  double t341, t343, t355, t366, t370, tvsigma2;

  double t373, t374, t375, t378, t379, t380, t383, t387;
  double t388, t392, t394, t400, t401, t404, t406, t408;
  double t409, t410, t411, t412, t413, t414, t416, t417;
  double t418, t419, t420, t421, t424, t425, t426, t429;
  double t430, t431, t432, t435, t436, t437, t438, t439;
  double t443, t444, t445, t446, t451, t452, t456, t460;
  double t461, t463, t466, t467, t468, t471, t474, t475;
  double t478, t481, t482, t485, t488, t490, t493, t494;
  double t495, t497, t500, t503, t504, t507, t510, t511;
  double t514, t518, t528, t537, t538, t543, t544, t545;
  double t546, t549, t552, t556, t557, t561, t563, t565;
  double t568, t570, tv2rho20, t573, t577, t581, t582, t586;
  double t588, t596, t597, t601, t605, t606, t610, t612;
  double t619, t622, tv2rho21, t627, t632, t636, t637, t643;
  double t644, t649, t653, t654, t663, t664, t665, t666;
  double t667, t668, t671, t672, t673, t676, t677, t678;
  double t679, t682, t683, t687, t688, t693, t694, t698;
  double t703, t713, t722, t723, t724, t726, t729, t730;
  double t731, t734, t737, t738, t741, t744, t745, t748;
  double t751, t753, t756, t757, t759, t762, t765, t766;
  double t769, t772, t773, t776, t779, t780, t785, tv2rho22;
  double t793, t794, t796, t797, t798, t801, t802, t806;
  double t807, t812, t821, t836, t838, t846, t850, t871;
  double t872, t877, tv2rhosigma0, tv2rhosigma1, t884, t886, tv2rhosigma2, t892;
  double tv2rhosigma3, tv2rhosigma4, t897, t899, t900, t902, t905, t907;
  double t920, t922, t937, t938, t942, t945, t949, t953;
  double t974, t975, t980, tv2rhosigma5, t982, t983, t985, t987;
  double t990, t1007, t1009, t1012, t1014, t1031, t1035, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1036, t1037, t1039, t1041;
  double t1044, t1062, t1066, t1083, t1087, tv2sigma25;

  double t1091, t1092, t1095, t1098, t1099, t1100, t1103, t1107;
  double t1108, t1112, t1114, t1119, t1121, t1124, t1130, t1131;
  double t1134, t1136, t1139, t1142, t1144, t1153, t1155, t1164;
  double t1166, t1167, t1169, t1173, t1177, t1184, t1203, t1205;
  double t1206, t1207, t1209, t1210, t1211, t1212, t1213, t1215;
  double t1219, t1221, t1225, t1227, t1228, t1230, t1234, t1235;
  double t1237, t1240, t1243, t1247, t1249, t1252, t1253, t1256;
  double t1259, t1262, t1263, t1266, t1269, t1272, t1273, t1276;
  double t1279, t1282, t1283, t1286, t1287, t1290, t1291, t1294;
  double t1295, t1296, t1299, t1302, t1305, t1306, t1309, t1312;
  double t1315, t1322, t1329, t1335, t1337, t1342, t1344, t1345;
  double t1348, t1351, t1354, t1358, t1359, t1363, t1365, t1367;
  double t1369, t1371, t1374, t1376, tv3rho30, t1379, t1380, t1381;
  double t1384, t1389, t1390, t1392, t1396, t1397, t1401, t1404;
  double t1408, t1410, t1414, t1423, t1424, t1425, t1428, t1433;
  double t1435, t1439, t1440, t1444, t1447, t1448, t1450, t1459;
  double t1461, t1464, tv3rho31, t1467, t1472, t1476, t1480, t1481;
  double t1485, t1487, t1496, t1497, t1502, t1506, t1510, t1511;
  double t1515, t1517, t1524, t1532, t1534, t1535, tv3rho32, t1540;
  double t1547, t1551, t1552, t1559, t1560, t1567, t1571, t1572;
  double t1587, t1588, t1589, t1590, t1591, t1592, t1594, t1598;
  double t1599, t1600, t1603, t1606, t1608, t1609, t1610, t1613;
  double t1616, t1619, t1620, t1623, t1626, t1630, t1631, t1635;
  double t1640, t1641, t1645, t1646, t1649, t1656, t1657, t1659;
  double t1662, t1663, t1664, t1667, t1670, t1671, t1672, t1673;
  double t1674, t1677, t1680, t1683, t1684, t1687, t1690, t1694;
  double t1699, t1702, t1706, t1714, t1718, t1728, t1732, t1739;
  double t1747, t1768, t1770, t1775, tv3rho33, t1783, t1790, t1792;
  double t1794, t1795, t1796, t1797, t1798, t1801, t1802, t1805;
  double t1806, t1815, t1825, t1832, t1835, t1836, t1849, t1864;
  double t1882, t1893, t1896, t1898, t1912, t1927, t1929, t1934;
  double tv3rho2sigma0, tv3rho2sigma1, t1941, t1945, t1947, tv3rho2sigma2, t1953, t1961;
  double tv3rho2sigma3, tv3rho2sigma4, t1967, t1974, t1977, tv3rho2sigma5, t1985, tv3rho2sigma6;
  double tv3rho2sigma7, t1997, t2000, t2003, t2004, t2006, t2009, t2010;
  double t2011, t2014, t2015, t2016, t2020, t2027, t2029, t2033;
  double t2036, t2038, t2045, t2072, t2083, t2102, t2130, t2132;
  double t2137, tv3rho2sigma8, t2144, t2145, t2148, t2149, t2150, t2151;
  double t2154, t2155, t2158, t2159, t2160, t2164, t2167, t2173;
  double t2203, t2248, t2250, t2255, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t2262, t2264, tv3rhosigma25, t2270, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t2276, t2279, t2282, t2287, t2288, t2290;
  double t2297, t2298, t2301, t2302, t2305, t2306, t2307, t2333;
  double t2378, t2380, t2385, tv3rhosigma211, t2387, t2388, t2390, t2393;
  double t2395, t2398, t2401, t2403, t2406, t2409, t2412, t2415;
  double t2418, t2421, t2428, t2429, t2439, t2440, t2443, t2446;
  double t2449, t2452, t2455, t2458, t2461, t2464, t2467, t2468;
  double t2472, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t2473, t2474, t2477, t2491, t2492, t2495;
  double t2498, t2501, t2504, t2507, t2510, t2511, t2514, t2516;
  double t2519, t2521, t2524, t2527, t2529, t2532, t2535, t2538;
  double t2541, t2544, t2547, t2550, t2553, t2554, t2558, tv3sigma39;

  double t2563, t2567, t2571, t2574, t2578, t2583, t2586, t2589;
  double t2591, t2592, t2594, t2598, t2604, t2610, t2614, t2616;
  double t2620, t2621, t2623, t2627, t2645, t2654, t2657, t2658;
  double t2660, t2661, t2662, t2663, t2664, t2665, t2666, t2669;
  double t2670, t2676, t2677, t2678, t2685, t2686, t2689, t2693;
  double t2697, t2698, t2699, t2700, t2703, t2704, t2706, t2707;
  double t2711, t2713, t2716, t2717, t2719, t2720, t2723, t2725;
  double t2748, t2751, t2798, t2799, t2800, t2801, t2804, t2805;
  double t2806, t2809, t2812, t2813, t2814, t2817, t2820, t2823;
  double t2824, t2826, t2829, t2832, t2835, t2836, t2839, t2842;
  double t2845, t2848, t2849, t2851, t2855, t2858, t2861, t2864;
  double t2867, t2870, t2873, t2879, t2881, t2882, t2888, t2894;
  double t2895, t2898, t2902, t2911, t2917, t2919, t2921, t2922;
  double t2923, t2925, t2926, t2932, t2937, t2940, t2944, t2951;
  double t2955, t2959, t2964, t2966, tv4rho40, t2973, t2977, t2978;
  double t2981, t3002, t3003, t3005, t3009, t3018, t3024, t3025;
  double t3027, t3038, t3039, t3056, t3058, t3062, t3069, t3073;
  double t3074, t3077, t3086, t3089, t3090, t3092, t3094, t3095;
  double tv4rho41, t3104, t3108, t3123, t3136, t3140, t3149, t3160;
  double t3161, t3170, t3183, t3187, t3194, t3198, t3207, t3210;
  double t3221, t3224, t3226, t3227, tv4rho42, t3248, t3252, t3259;
  double t3270, t3271, t3288, t3292, t3299, t3307, t3316, t3326;
  double t3328, t3329, tv4rho43, t3334, t3339, t3346, t3350, t3359;
  double t3360, t3361, t3363, t3367, t3371, t3379, t3382, t3383;
  double t3386, t3387, t3388, t3389, t3392, t3394, t3395, t3398;
  double t3401, t3403, t3404, t3407, t3410, t3413, t3414, t3415;
  double t3417, t3421, t3424, t3425, t3426, t3427, t3430, t3433;
  double t3434, t3435, t3438, t3442, t3443, t3444, t3445, t3448;
  double t3451, t3454, t3455, t3456, t3457, t3458, t3460, t3463;
  double t3466, t3469, t3472, t3475, t3479, t3481, t3487, t3489;
  double t3492, t3494, t3507, t3509, t3513, t3522, t3535, t3546;
  double t3554, t3560, t3581, t3584, t3626, t3632, t3637, t3644;
  double t3648, t3670, t3671, tv4rho44, t3679, t3685, t3688, t3695;
  double t3697, t3700, t3702, t3704, t3708, t3719, t3722, t3723;
  double t3728, t3729, t3732, t3741, t3744, t3746, t3763, t3766;
  double t3772, t3776, t3781, t3790, t3791, t3794, t3797, t3810;
  double t3817, t3861, t3905, t3912, tv4rho3sigma0, tv4rho3sigma1, t3919, t3922;
  double t3926, t3928, tv4rho3sigma2, t3930, t3936, t3941, t3945, t3954;
  double t3955, tv4rho3sigma3, tv4rho3sigma4, t3957, t3963, t3965, t3974, t3976;
  double t3979, tv4rho3sigma5, t3985, t3994, tv4rho3sigma6, tv4rho3sigma7, t4000, t4007;
  double t4015, t4017, t4018, tv4rho3sigma8, t4027, tv4rho3sigma9, tv4rho3sigma10, t4044;
  double t4048, t4051, t4055, t4060, t4064, t4093, t4106, t4107;
  double t4116, t4137, t4140, t4141, t4144, t4145, t4148, t4151;
  double t4158, t4163, t4193, t4198, t4204, t4208, t4248, t4255;
  double tv4rho3sigma11, t4262, t4269, t4271, t4274, t4277, t4280, t4284;
  double t4291, t4296, t4299, t4316, t4353, t4370, t4371, t4372;
  double t4377, t4378, t4384, t4392, t4396, t4405, t4445, t4452;
  double tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t4459, t4463, t4465;
  double tv4rho2sigma25, t4471, t4479, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210;
  double t4485, t4492, t4495, tv4rho2sigma211, t4503, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214;
  double tv4rho2sigma215, tv4rho2sigma216, t4515, t4518, t4519, t4526, t4527, t4531;
  double t4534, t4542, t4566, t4590, t4595, t4598, t4601, t4606;
  double t4609, t4613, t4616, t4647, t4684, t4691, tv4rho2sigma217, t4698;
  double t4700, t4702, t4703, t4711, t4719, t4720, t4721, t4726;
  double t4727, t4732, t4749, t4760, t4765, t4779, t4786, t4789;
  double t4793, t4796, t4813, t4828, t4844, t4851, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t4858;
  double t4860, tv4rhosigma39, t4866, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314;
  double tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t4872, t4874, t4875, t4879;
  double t4883, t4894, t4904, t4917, t4945, t4952, t4955, t4959;
  double t4964, t4979, t4997, t5010, t5017, tv4rhosigma319, t5021, t5022;
  double t5024, t5040, t5045, t5049, t5053, t5072, t5073, t5117;
  double t5122, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46;
  double tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t5124;
  double t5125, t5126, t5141, t5155, t5159, t5163, t5176, t5182;
  double t5221, t5226, tv4sigma414;

  gga_x_sogga11_params *params;

  assert(p->params != NULL);
  params = (gga_x_sogga11_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->a[0];
  t29 = params->a[1];
  t30 = M_CBRT6;
  t31 = params->mu * t30;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = 0.1e1 / params->kappa;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t46 = t36 * t38 * t43 / 0.24e2;
  t47 = 0.1e1 + t46;
  t49 = 0.1e1 - 0.1e1 / t47;
  t51 = params->a[2];
  t52 = t49 * t49;
  t54 = params->a[3];
  t55 = t52 * t49;
  t57 = params->a[4];
  t58 = t52 * t52;
  t60 = params->a[5];
  t63 = params->b[0];
  t64 = params->b[1];
  t65 = exp(-t46);
  t66 = 0.1e1 - t65;
  t68 = params->b[2];
  t69 = t66 * t66;
  t71 = params->b[3];
  t72 = t69 * t66;
  t74 = params->b[4];
  t75 = t69 * t69;
  t77 = params->b[5];
  t80 = t60 * t58 * t49 + t77 * t75 * t66 + t29 * t49 + t51 * t52 + t54 * t55 + t57 * t58 + t64 * t66 + t68 * t69 + t71 * t72 + t74 * t75 + t28 + t63;
  t84 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t80);
  t85 = rho[1] <= p->dens_threshold;
  t86 = -t16;
  t88 = my_piecewise5(t14, t11, t10, t15, t86 * t7);
  t89 = 0.1e1 + t88;
  t90 = t89 <= p->zeta_threshold;
  t91 = POW_1_3(t89);
  t93 = my_piecewise3(t90, t22, t91 * t89);
  t94 = t93 * t26;
  t95 = t37 * sigma[2];
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t103 = t36 * t95 * t100 / 0.24e2;
  t104 = 0.1e1 + t103;
  t106 = 0.1e1 - 0.1e1 / t104;
  t108 = t106 * t106;
  t110 = t108 * t106;
  t112 = t108 * t108;
  t116 = exp(-t103);
  t117 = 0.1e1 - t116;
  t119 = t117 * t117;
  t121 = t119 * t117;
  t123 = t119 * t119;
  t127 = t60 * t112 * t106 + t77 * t123 * t117 + t29 * t106 + t51 * t108 + t54 * t110 + t57 * t112 + t64 * t117 + t68 * t119 + t71 * t121 + t74 * t123 + t28 + t63;
  t131 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t127);
  tzk0 = t84 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t132 = t6 * t6;
  t133 = 0.1e1 / t132;
  t134 = t16 * t133;
  t136 = my_piecewise5(t10, 0, t14, 0, t7 - t134);
  t139 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t136);
  t140 = t139 * t26;
  t144 = t26 * t26;
  t145 = 0.1e1 / t144;
  t146 = t25 * t145;
  t149 = t5 * t146 * t80 / 0.8e1;
  t150 = t47 * t47;
  t151 = 0.1e1 / t150;
  t152 = t29 * t151;
  t153 = t152 * t31;
  t154 = t35 * t37;
  t155 = t39 * rho[0];
  t157 = 0.1e1 / t41 / t155;
  t158 = sigma[0] * t157;
  t162 = t51 * t49;
  t163 = t151 * params->mu;
  t164 = t162 * t163;
  t165 = t30 * t35;
  t167 = t165 * t38 * t157;
  t170 = t54 * t52;
  t171 = t170 * t163;
  t174 = t57 * t55;
  t175 = t174 * t163;
  t178 = t60 * t58;
  t179 = t178 * t163;
  t182 = t64 * params->mu;
  t183 = t182 * t165;
  t184 = t157 * t65;
  t188 = t68 * t66;
  t189 = t188 * t31;
  t191 = t154 * t158 * t65;
  t194 = t71 * t69;
  t195 = t194 * t31;
  t198 = t74 * t72;
  t199 = t198 * t31;
  t202 = t77 * t75;
  t203 = t202 * t31;
  t206 = -t153 * t154 * t158 / 0.9e1 - 0.2e1 / 0.9e1 * t164 * t167 - t171 * t167 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t167 - 0.5e1 / 0.9e1 * t179 * t167 - t183 * t38 * t184 / 0.9e1 - 0.2e1 / 0.9e1 * t189 * t191 - t195 * t191 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t191 - 0.5e1 / 0.9e1 * t203 * t191;
  t211 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t80 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t206);
  t212 = t86 * t133;
  t214 = my_piecewise5(t14, 0, t10, 0, -t7 - t212);
  t217 = my_piecewise3(t90, 0, 0.4e1 / 0.3e1 * t91 * t214);
  t218 = t217 * t26;
  t222 = t93 * t145;
  t225 = t5 * t222 * t127 / 0.8e1;
  t227 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t127 - t225);
  tvrho0 = t84 + t131 + t6 * (t211 + t227);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t231 = my_piecewise5(t10, 0, t14, 0, -t7 - t134);
  t234 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t231);
  t235 = t234 * t26;
  t240 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t80 - t149);
  t242 = my_piecewise5(t14, 0, t10, 0, t7 - t212);
  t245 = my_piecewise3(t90, 0, 0.4e1 / 0.3e1 * t91 * t242);
  t246 = t245 * t26;
  t250 = t104 * t104;
  t251 = 0.1e1 / t250;
  t252 = t29 * t251;
  t253 = t252 * t31;
  t254 = t96 * rho[1];
  t256 = 0.1e1 / t98 / t254;
  t257 = sigma[2] * t256;
  t261 = t51 * t106;
  t262 = t251 * params->mu;
  t263 = t261 * t262;
  t265 = t165 * t95 * t256;
  t268 = t54 * t108;
  t269 = t268 * t262;
  t272 = t57 * t110;
  t273 = t272 * t262;
  t276 = t60 * t112;
  t277 = t276 * t262;
  t280 = t256 * t116;
  t284 = t68 * t117;
  t285 = t284 * t31;
  t287 = t154 * t257 * t116;
  t290 = t71 * t119;
  t291 = t290 * t31;
  t294 = t74 * t121;
  t295 = t294 * t31;
  t298 = t77 * t123;
  t299 = t298 * t31;
  t302 = -t253 * t154 * t257 / 0.9e1 - 0.2e1 / 0.9e1 * t263 * t265 - t269 * t265 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t265 - 0.5e1 / 0.9e1 * t277 * t265 - t183 * t95 * t280 / 0.9e1 - 0.2e1 / 0.9e1 * t285 * t287 - t291 * t287 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t287 - 0.5e1 / 0.9e1 * t299 * t287;
  t307 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t127 - t225 - 0.3e1 / 0.8e1 * t5 * t94 * t302);
  tvrho1 = t84 + t131 + t6 * (t240 + t307);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t310 = t152 * params->mu;
  t312 = t165 * t37 * t43;
  t323 = t182 * t30;
  t325 = t154 * t43 * t65;
  t336 = t310 * t312 / 0.24e2 + t164 * t312 / 0.12e2 + t171 * t312 / 0.8e1 + t175 * t312 / 0.6e1 + 0.5e1 / 0.24e2 * t179 * t312 + t323 * t325 / 0.24e2 + t189 * t325 / 0.12e2 + t195 * t325 / 0.8e1 + t199 * t325 / 0.6e1 + 0.5e1 / 0.24e2 * t203 * t325;
  t340 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t336);
  tvsigma0 = t6 * t340;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t341 = t252 * params->mu;
  t343 = t165 * t37 * t100;
  t355 = t154 * t100 * t116;
  t366 = t341 * t343 / 0.24e2 + t263 * t343 / 0.12e2 + t269 * t343 / 0.8e1 + t273 * t343 / 0.6e1 + 0.5e1 / 0.24e2 * t277 * t343 + t323 * t355 / 0.24e2 + t285 * t355 / 0.12e2 + t291 * t355 / 0.8e1 + t295 * t355 / 0.6e1 + 0.5e1 / 0.24e2 * t299 * t355;
  t370 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t366);
  tvsigma2 = t6 * t370;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t373 = t23 * t23;
  t374 = 0.1e1 / t373;
  t375 = t136 * t136;
  t378 = t132 * t6;
  t379 = 0.1e1 / t378;
  t380 = t16 * t379;
  t383 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t133 + 0.2e1 * t380);
  t387 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t374 * t375 + 0.4e1 / 0.3e1 * t23 * t383);
  t388 = t387 * t26;
  t392 = t139 * t145;
  t394 = t5 * t392 * t80;
  t400 = 0.1e1 / t144 / t6;
  t401 = t25 * t400;
  t404 = t5 * t401 * t80 / 0.12e2;
  t406 = t5 * t146 * t206;
  t408 = t150 * t47;
  t409 = 0.1e1 / t408;
  t410 = t29 * t409;
  t411 = params->mu * params->mu;
  t412 = t30 * t30;
  t413 = t411 * t412;
  t414 = t410 * t413;
  t416 = 0.1e1 / t33 / t32;
  t417 = params->kappa * params->kappa;
  t418 = 0.1e1 / t417;
  t419 = t416 * t418;
  t420 = sigma[0] * sigma[0];
  t421 = t39 * t39;
  t424 = 0.1e1 / t40 / t421 / t155;
  t425 = t420 * t424;
  t426 = t419 * t425;
  t429 = t150 * t150;
  t430 = 0.1e1 / t429;
  t431 = t51 * t430;
  t432 = t431 * t413;
  t435 = t64 * t411;
  t436 = t412 * t416;
  t437 = t435 * t436;
  t438 = t418 * t420;
  t439 = t424 * t65;
  t443 = t68 * t411;
  t444 = t443 * t436;
  t445 = t65 * t65;
  t446 = t424 * t445;
  t451 = 0.1e1 / t41 / t421;
  t452 = sigma[0] * t451;
  t456 = t451 * t65;
  t460 = t409 * t411;
  t461 = t162 * t460;
  t463 = t436 * t438 * t424;
  t466 = t54 * t49;
  t467 = t430 * t411;
  t468 = t466 * t467;
  t471 = t170 * t460;
  t474 = t57 * t52;
  t475 = t474 * t467;
  t478 = t174 * t460;
  t481 = t60 * t55;
  t482 = t481 * t467;
  t485 = t178 * t460;
  t488 = t188 * t413;
  t490 = t419 * t425 * t65;
  t493 = -0.2e1 / 0.81e2 * t414 * t426 + 0.2e1 / 0.81e2 * t432 * t426 - t437 * t438 * t439 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t438 * t446 + 0.11e2 / 0.27e2 * t153 * t154 * t452 + 0.11e2 / 0.27e2 * t183 * t38 * t456 - 0.4e1 / 0.81e2 * t461 * t463 + 0.2e1 / 0.27e2 * t468 * t463 - 0.2e1 / 0.27e2 * t471 * t463 + 0.4e1 / 0.27e2 * t475 * t463 - 0.8e1 / 0.81e2 * t478 * t463 + 0.2e2 / 0.81e2 * t482 * t463 - 0.1e2 / 0.81e2 * t485 * t463 - 0.2e1 / 0.81e2 * t488 * t490;
  t494 = t71 * t66;
  t495 = t494 * t413;
  t497 = t419 * t425 * t445;
  t500 = t194 * t413;
  t503 = t74 * t69;
  t504 = t503 * t413;
  t507 = t198 * t413;
  t510 = t77 * t72;
  t511 = t510 * t413;
  t514 = t202 * t413;
  t518 = t165 * t38 * t451;
  t528 = t154 * t452 * t65;
  t537 = 0.2e1 / 0.27e2 * t495 * t497 - t500 * t490 / 0.27e2 + 0.4e1 / 0.27e2 * t504 * t497 - 0.4e1 / 0.81e2 * t507 * t490 + 0.2e2 / 0.81e2 * t511 * t497 - 0.5e1 / 0.81e2 * t514 * t490 + 0.22e2 / 0.27e2 * t164 * t518 + 0.11e2 / 0.9e1 * t171 * t518 + 0.44e2 / 0.27e2 * t175 * t518 + 0.55e2 / 0.27e2 * t179 * t518 + 0.22e2 / 0.27e2 * t189 * t528 + 0.11e2 / 0.9e1 * t195 * t528 + 0.44e2 / 0.27e2 * t199 * t528 + 0.55e2 / 0.27e2 * t203 * t528;
  t538 = t493 + t537;
  t543 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t388 * t80 - t394 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t206 + t404 - t406 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t538);
  t544 = t91 * t91;
  t545 = 0.1e1 / t544;
  t546 = t214 * t214;
  t549 = t86 * t379;
  t552 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t133 + 0.2e1 * t549);
  t556 = my_piecewise3(t90, 0, 0.4e1 / 0.9e1 * t545 * t546 + 0.4e1 / 0.3e1 * t91 * t552);
  t557 = t556 * t26;
  t561 = t217 * t145;
  t563 = t5 * t561 * t127;
  t565 = t93 * t400;
  t568 = t5 * t565 * t127 / 0.12e2;
  t570 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t557 * t127 - t563 / 0.4e1 + t568);
  tv2rho20 = 0.2e1 * t211 + 0.2e1 * t227 + t6 * (t543 + t570);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t573 = t374 * t231;
  t577 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t380);
  t581 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t573 * t136 + 0.4e1 / 0.3e1 * t23 * t577);
  t582 = t581 * t26;
  t586 = t234 * t145;
  t588 = t5 * t586 * t80;
  t596 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t582 * t80 - t588 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t235 * t206 - t394 / 0.8e1 + t404 - t406 / 0.8e1);
  t597 = t545 * t242;
  t601 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t549);
  t605 = my_piecewise3(t90, 0, 0.4e1 / 0.9e1 * t597 * t214 + 0.4e1 / 0.3e1 * t91 * t601);
  t606 = t605 * t26;
  t610 = t245 * t145;
  t612 = t5 * t610 * t127;
  t619 = t5 * t222 * t302;
  t622 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t606 * t127 - t612 / 0.8e1 - t563 / 0.8e1 + t568 - 0.3e1 / 0.8e1 * t5 * t218 * t302 - t619 / 0.8e1);
  tv2rho21 = t211 + t227 + t240 + t307 + t6 * (t596 + t622);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t627 = t231 * t231;
  t632 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t133 + 0.2e1 * t380);
  t636 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t374 * t627 + 0.4e1 / 0.3e1 * t23 * t632);
  t637 = t636 * t26;
  t643 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t637 * t80 - t588 / 0.4e1 + t404);
  t644 = t242 * t242;
  t649 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t133 + 0.2e1 * t549);
  t653 = my_piecewise3(t90, 0, 0.4e1 / 0.9e1 * t545 * t644 + 0.4e1 / 0.3e1 * t91 * t649);
  t654 = t653 * t26;
  t663 = t250 * t104;
  t664 = 0.1e1 / t663;
  t665 = t29 * t664;
  t666 = t665 * t413;
  t667 = sigma[2] * sigma[2];
  t668 = t96 * t96;
  t671 = 0.1e1 / t97 / t668 / t254;
  t672 = t667 * t671;
  t673 = t419 * t672;
  t676 = t250 * t250;
  t677 = 0.1e1 / t676;
  t678 = t51 * t677;
  t679 = t678 * t413;
  t682 = t418 * t667;
  t683 = t671 * t116;
  t687 = t116 * t116;
  t688 = t671 * t687;
  t693 = 0.1e1 / t98 / t668;
  t694 = sigma[2] * t693;
  t698 = t693 * t116;
  t703 = t165 * t95 * t693;
  t713 = t154 * t694 * t116;
  t722 = -0.2e1 / 0.81e2 * t666 * t673 + 0.2e1 / 0.81e2 * t679 * t673 - t437 * t682 * t683 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t682 * t688 + 0.11e2 / 0.27e2 * t253 * t154 * t694 + 0.11e2 / 0.27e2 * t183 * t95 * t698 + 0.22e2 / 0.27e2 * t263 * t703 + 0.11e2 / 0.9e1 * t269 * t703 + 0.44e2 / 0.27e2 * t273 * t703 + 0.55e2 / 0.27e2 * t277 * t703 + 0.22e2 / 0.27e2 * t285 * t713 + 0.11e2 / 0.9e1 * t291 * t713 + 0.44e2 / 0.27e2 * t295 * t713 + 0.55e2 / 0.27e2 * t299 * t713;
  t723 = t664 * t411;
  t724 = t261 * t723;
  t726 = t436 * t682 * t671;
  t729 = t54 * t106;
  t730 = t677 * t411;
  t731 = t729 * t730;
  t734 = t268 * t723;
  t737 = t57 * t108;
  t738 = t737 * t730;
  t741 = t272 * t723;
  t744 = t60 * t110;
  t745 = t744 * t730;
  t748 = t276 * t723;
  t751 = t284 * t413;
  t753 = t419 * t672 * t116;
  t756 = t71 * t117;
  t757 = t756 * t413;
  t759 = t419 * t672 * t687;
  t762 = t290 * t413;
  t765 = t74 * t119;
  t766 = t765 * t413;
  t769 = t294 * t413;
  t772 = t77 * t121;
  t773 = t772 * t413;
  t776 = t298 * t413;
  t779 = -0.4e1 / 0.81e2 * t724 * t726 + 0.2e1 / 0.27e2 * t731 * t726 - 0.2e1 / 0.27e2 * t734 * t726 + 0.4e1 / 0.27e2 * t738 * t726 - 0.8e1 / 0.81e2 * t741 * t726 + 0.2e2 / 0.81e2 * t745 * t726 - 0.1e2 / 0.81e2 * t748 * t726 - 0.2e1 / 0.81e2 * t751 * t753 + 0.2e1 / 0.27e2 * t757 * t759 - t762 * t753 / 0.27e2 + 0.4e1 / 0.27e2 * t766 * t759 - 0.4e1 / 0.81e2 * t769 * t753 + 0.2e2 / 0.81e2 * t773 * t759 - 0.5e1 / 0.81e2 * t776 * t753;
  t780 = t722 + t779;
  t785 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t654 * t127 - t612 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t246 * t302 + t568 - t619 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t94 * t780);
  tv2rho22 = 0.2e1 * t240 + 0.2e1 * t307 + t6 * (t643 + t785);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t793 = t5 * t146 * t336 / 0.8e1;
  t794 = t421 * t39;
  t796 = 0.1e1 / t40 / t794;
  t797 = sigma[0] * t796;
  t798 = t419 * t797;
  t801 = t418 * t796;
  t802 = sigma[0] * t65;
  t806 = t418 * sigma[0];
  t807 = t796 * t445;
  t812 = t165 * t37 * t157;
  t821 = t154 * t184;
  t836 = -t432 * t798 / 0.108e3 + t437 * t801 * t802 / 0.216e3 - t444 * t806 * t807 / 0.108e3 - 0.2e1 / 0.9e1 * t164 * t812 - t171 * t812 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t812 - 0.5e1 / 0.9e1 * t179 * t812 - 0.2e1 / 0.9e1 * t189 * t821 - t195 * t821 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t821 - 0.5e1 / 0.9e1 * t203 * t821 + t414 * t798 / 0.108e3 - t323 * t821 / 0.9e1 - t310 * t812 / 0.9e1;
  t838 = t436 * t801 * sigma[0];
  t846 = t419 * t797 * t65;
  t850 = t419 * t807 * sigma[0];
  t871 = t478 * t838 / 0.27e2 - 0.5e1 / 0.54e2 * t482 * t838 + 0.5e1 / 0.108e3 * t485 * t838 + t488 * t846 / 0.108e3 - t495 * t850 / 0.36e2 + t500 * t846 / 0.72e2 - t504 * t850 / 0.18e2 + t507 * t846 / 0.54e2 - 0.5e1 / 0.54e2 * t511 * t850 + 0.5e1 / 0.216e3 * t514 * t846 + t461 * t838 / 0.54e2 - t468 * t838 / 0.36e2 + t471 * t838 / 0.36e2 - t475 * t838 / 0.18e2;
  t872 = t836 + t871;
  t877 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t336 - t793 - 0.3e1 / 0.8e1 * t5 * t27 * t872);
  tv2rhosigma0 = t6 * t877 + t340;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t884 = t5 * t222 * t366 / 0.8e1;
  t886 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t366 - t884);
  tv2rhosigma2 = t6 * t886 + t370;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t892 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t336 - t793);
  tv2rhosigma3 = t6 * t892 + t340;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t897 = t668 * t96;
  t899 = 0.1e1 / t97 / t897;
  t900 = t899 * sigma[2];
  t902 = t419 * t900 * t116;
  t905 = t899 * t687;
  t907 = t419 * t905 * sigma[2];
  t920 = t418 * t899;
  t922 = t436 * t920 * sigma[2];
  t937 = t751 * t902 / 0.108e3 - t757 * t907 / 0.36e2 + t762 * t902 / 0.72e2 - t766 * t907 / 0.18e2 + t769 * t902 / 0.54e2 - 0.5e1 / 0.54e2 * t773 * t907 + 0.5e1 / 0.216e3 * t776 * t902 + t724 * t922 / 0.54e2 - t731 * t922 / 0.36e2 + t734 * t922 / 0.36e2 - t738 * t922 / 0.18e2 + t741 * t922 / 0.27e2 - 0.5e1 / 0.54e2 * t745 * t922 + 0.5e1 / 0.108e3 * t748 * t922;
  t938 = t154 * t280;
  t942 = t165 * t37 * t256;
  t945 = sigma[2] * t116;
  t949 = t418 * sigma[2];
  t953 = t419 * t900;
  t974 = -t323 * t938 / 0.9e1 - t341 * t942 / 0.9e1 + t437 * t920 * t945 / 0.216e3 - t444 * t949 * t905 / 0.108e3 + t666 * t953 / 0.108e3 - t679 * t953 / 0.108e3 - 0.2e1 / 0.9e1 * t263 * t942 - t269 * t942 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t942 - 0.5e1 / 0.9e1 * t277 * t942 - 0.2e1 / 0.9e1 * t285 * t938 - t291 * t938 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t938 - 0.5e1 / 0.9e1 * t299 * t938;
  t975 = t937 + t974;
  t980 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t366 - t884 - 0.3e1 / 0.8e1 * t5 * t94 * t975);
  tv2rhosigma5 = t6 * t980 + t370;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t982 = t410 * t411;
  t983 = t421 * rho[0];
  t985 = 0.1e1 / t40 / t983;
  t987 = t436 * t418 * t985;
  t990 = t431 * t411;
  t1007 = t435 * t412;
  t1009 = t419 * t985 * t65;
  t1012 = t443 * t412;
  t1014 = t419 * t985 * t445;
  t1031 = -t982 * t987 / 0.288e3 + t990 * t987 / 0.288e3 - t461 * t987 / 0.144e3 + t468 * t987 / 0.96e2 - t471 * t987 / 0.96e2 + t475 * t987 / 0.48e2 - t478 * t987 / 0.72e2 + 0.5e1 / 0.144e3 * t482 * t987 - 0.5e1 / 0.288e3 * t485 * t987 - t1007 * t1009 / 0.576e3 + t1012 * t1014 / 0.288e3 - t488 * t1009 / 0.288e3 + t495 * t1014 / 0.96e2 - t500 * t1009 / 0.192e3 + t504 * t1014 / 0.48e2 - t507 * t1009 / 0.144e3 + 0.5e1 / 0.144e3 * t511 * t1014 - 0.5e1 / 0.576e3 * t514 * t1009;
  t1035 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1031);
  tv2sigma20 = t6 * t1035;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1036 = t665 * t411;
  t1037 = t668 * rho[1];
  t1039 = 0.1e1 / t97 / t1037;
  t1041 = t436 * t418 * t1039;
  t1044 = t678 * t411;
  t1062 = t419 * t1039 * t116;
  t1066 = t419 * t1039 * t687;
  t1083 = -t1036 * t1041 / 0.288e3 + t1044 * t1041 / 0.288e3 - t724 * t1041 / 0.144e3 + t731 * t1041 / 0.96e2 - t734 * t1041 / 0.96e2 + t738 * t1041 / 0.48e2 - t741 * t1041 / 0.72e2 + 0.5e1 / 0.144e3 * t745 * t1041 - 0.5e1 / 0.288e3 * t748 * t1041 - t1007 * t1062 / 0.576e3 + t1012 * t1066 / 0.288e3 - t751 * t1062 / 0.288e3 + t757 * t1066 / 0.96e2 - t762 * t1062 / 0.192e3 + t766 * t1066 / 0.48e2 - t769 * t1062 / 0.144e3 + 0.5e1 / 0.144e3 * t773 * t1066 - 0.5e1 / 0.576e3 * t776 * t1062;
  t1087 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t1083);
  tv2sigma25 = t6 * t1087;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1091 = 0.1e1 / t373 / t19;
  t1092 = t375 * t136;
  t1095 = t374 * t136;
  t1098 = t132 * t132;
  t1099 = 0.1e1 / t1098;
  t1100 = t16 * t1099;
  t1103 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t379 - 0.6e1 * t1100);
  t1107 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1091 * t1092 + 0.4e1 / 0.3e1 * t1095 * t383 + 0.4e1 / 0.3e1 * t23 * t1103);
  t1108 = t1107 * t26;
  t1112 = t387 * t145;
  t1114 = t5 * t1112 * t80;
  t1119 = t139 * t400;
  t1121 = t5 * t1119 * t80;
  t1124 = t5 * t392 * t206;
  t1130 = 0.1e1 / t144 / t132;
  t1131 = t25 * t1130;
  t1134 = 0.5e1 / 0.36e2 * t5 * t1131 * t80;
  t1136 = t5 * t401 * t206;
  t1139 = t5 * t146 * t538;
  t1142 = 0.1e1 / t41 / t983;
  t1144 = t165 * t38 * t1142;
  t1153 = sigma[0] * t1142;
  t1155 = t154 * t1153 * t65;
  t1164 = t421 * t421;
  t1166 = 0.1e1 / t40 / t1164;
  t1167 = t420 * t1166;
  t1169 = t419 * t1167 * t445;
  t1173 = t419 * t1167 * t65;
  t1177 = t436 * t438 * t1166;
  t1184 = -0.308e3 / 0.81e2 * t164 * t1144 - 0.154e3 / 0.27e2 * t171 * t1144 - 0.616e3 / 0.81e2 * t175 * t1144 - 0.77e3 / 0.81e2 * t179 * t1144 - 0.308e3 / 0.81e2 * t189 * t1155 - 0.154e3 / 0.27e2 * t195 * t1155 - 0.616e3 / 0.81e2 * t199 * t1155 - 0.77e3 / 0.81e2 * t203 * t1155 - 0.22e3 / 0.81e2 * t511 * t1169 + 0.55e2 / 0.81e2 * t514 * t1173 - 0.22e2 / 0.27e2 * t468 * t1177 + 0.22e2 / 0.27e2 * t471 * t1177 - 0.44e2 / 0.27e2 * t475 * t1177;
  t1203 = t411 * params->mu;
  t1205 = t32 * t32;
  t1206 = 0.1e1 / t1205;
  t1207 = t64 * t1203 * t1206;
  t1209 = 0.1e1 / t417 / params->kappa;
  t1210 = t420 * sigma[0];
  t1211 = t1209 * t1210;
  t1212 = t1164 * t155;
  t1213 = 0.1e1 / t1212;
  t1215 = t1211 * t1213 * t65;
  t1219 = t68 * t1203 * t1206;
  t1221 = t1211 * t1213 * t445;
  t1225 = 0.1e1 / t429 / t150;
  t1227 = t54 * t1225 * t1203;
  t1228 = t1206 * t1209;
  t1230 = t1228 * t1210 * t1213;
  t1234 = t71 * t1203 * t1206;
  t1235 = t445 * t65;
  t1237 = t1211 * t1213 * t1235;
  t1240 = 0.88e2 / 0.81e2 * t478 * t1177 - 0.22e3 / 0.81e2 * t482 * t1177 + 0.11e3 / 0.81e2 * t485 * t1177 + 0.22e2 / 0.81e2 * t488 * t1173 + 0.44e2 / 0.81e2 * t461 * t1177 - 0.22e2 / 0.27e2 * t495 * t1169 + 0.11e2 / 0.27e2 * t500 * t1173 - 0.44e2 / 0.27e2 * t504 * t1169 + 0.44e2 / 0.81e2 * t507 * t1173 - 0.2e1 / 0.243e3 * t1207 * t1215 + 0.4e1 / 0.81e2 * t1219 * t1221 - 0.4e1 / 0.81e2 * t1227 * t1230 - 0.4e1 / 0.81e2 * t1234 * t1237;
  t1243 = t29 * t430 * t1203;
  t1247 = 0.1e1 / t429 / t47;
  t1249 = t51 * t1247 * t1203;
  t1252 = t1203 * t1206;
  t1253 = t188 * t1252;
  t1256 = t494 * t1252;
  t1259 = t194 * t1252;
  t1262 = t74 * t66;
  t1263 = t1262 * t1252;
  t1266 = t503 * t1252;
  t1269 = t198 * t1252;
  t1272 = t77 * t69;
  t1273 = t1272 * t1252;
  t1276 = t510 * t1252;
  t1279 = t202 * t1252;
  t1282 = t430 * t1203;
  t1283 = t162 * t1282;
  t1286 = t1247 * t1203;
  t1287 = t466 * t1286;
  t1290 = -0.4e1 / 0.81e2 * t1243 * t1230 + 0.8e1 / 0.81e2 * t1249 * t1230 - 0.4e1 / 0.243e3 * t1253 * t1215 + 0.4e1 / 0.27e2 * t1256 * t1221 - 0.2e1 / 0.81e2 * t1259 * t1215 - 0.16e2 / 0.81e2 * t1263 * t1237 + 0.8e1 / 0.27e2 * t1266 * t1221 - 0.8e1 / 0.243e3 * t1269 * t1215 - 0.4e2 / 0.81e2 * t1273 * t1237 + 0.4e2 / 0.81e2 * t1276 * t1221 - 0.1e2 / 0.243e3 * t1279 * t1215 - 0.8e1 / 0.81e2 * t1283 * t1230 + 0.8e1 / 0.27e2 * t1287 * t1230;
  t1291 = t170 * t1282;
  t1294 = t57 * t49;
  t1295 = t1225 * t1203;
  t1296 = t1294 * t1295;
  t1299 = t474 * t1286;
  t1302 = t174 * t1282;
  t1305 = t60 * t52;
  t1306 = t1305 * t1295;
  t1309 = t481 * t1286;
  t1312 = t178 * t1282;
  t1315 = t1142 * t65;
  t1322 = t419 * t1167;
  t1329 = t1166 * t445;
  t1335 = -0.4e1 / 0.27e2 * t1291 * t1230 - 0.16e2 / 0.81e2 * t1296 * t1230 + 0.16e2 / 0.27e2 * t1299 * t1230 - 0.16e2 / 0.81e2 * t1302 * t1230 - 0.4e2 / 0.81e2 * t1306 * t1230 + 0.8e2 / 0.81e2 * t1309 * t1230 - 0.2e2 / 0.81e2 * t1312 * t1230 - 0.154e3 / 0.81e2 * t183 * t38 * t1315 - 0.154e3 / 0.81e2 * t153 * t154 * t1153 - 0.22e2 / 0.81e2 * t432 * t1322 + 0.11e2 / 0.81e2 * t437 * t438 * t1166 * t65 - 0.22e2 / 0.81e2 * t444 * t438 * t1329 + 0.22e2 / 0.81e2 * t414 * t1322;
  t1337 = t1184 + t1240 + t1290 + t1335;
  t1342 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1108 * t80 - 0.3e1 / 0.8e1 * t1114 - 0.9e1 / 0.8e1 * t5 * t388 * t206 + t1121 / 0.4e1 - 0.3e1 / 0.4e1 * t1124 - 0.9e1 / 0.8e1 * t5 * t140 * t538 - t1134 + t1136 / 0.4e1 - 0.3e1 / 0.8e1 * t1139 - 0.3e1 / 0.8e1 * t5 * t27 * t1337);
  t1344 = 0.1e1 / t544 / t89;
  t1345 = t546 * t214;
  t1348 = t545 * t214;
  t1351 = t86 * t1099;
  t1354 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t379 - 0.6e1 * t1351);
  t1358 = my_piecewise3(t90, 0, -0.8e1 / 0.27e2 * t1344 * t1345 + 0.4e1 / 0.3e1 * t1348 * t552 + 0.4e1 / 0.3e1 * t91 * t1354);
  t1359 = t1358 * t26;
  t1363 = t556 * t145;
  t1365 = t5 * t1363 * t127;
  t1367 = t217 * t400;
  t1369 = t5 * t1367 * t127;
  t1371 = t93 * t1130;
  t1374 = 0.5e1 / 0.36e2 * t5 * t1371 * t127;
  t1376 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t1359 * t127 - 0.3e1 / 0.8e1 * t1365 + t1369 / 0.4e1 - t1374);
  tv3rho30 = 0.3e1 * t543 + 0.3e1 * t570 + t6 * (t1342 + t1376);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1379 = 0.2e1 * t596;
  t1380 = 0.2e1 * t622;
  t1381 = t1091 * t231;
  t1384 = t374 * t577;
  t1389 = 0.2e1 * t379;
  t1390 = 0.6e1 * t1100;
  t1392 = my_piecewise5(t10, 0, t14, 0, t1389 - t1390);
  t1396 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1381 * t375 + 0.8e1 / 0.9e1 * t1384 * t136 + 0.4e1 / 0.9e1 * t573 * t383 + 0.4e1 / 0.3e1 * t23 * t1392);
  t1397 = t1396 * t26;
  t1401 = t581 * t145;
  t1404 = t5 * t1401 * t80 / 0.4e1;
  t1408 = t234 * t400;
  t1410 = t5 * t1408 * t80;
  t1414 = t5 * t586 * t206 / 0.4e1;
  t1423 = -0.3e1 / 0.8e1 * t5 * t1397 * t80 - t1404 - 0.3e1 / 0.4e1 * t5 * t582 * t206 + t1410 / 0.12e2 - t1414 - 0.3e1 / 0.8e1 * t5 * t235 * t538 - t1114 / 0.8e1 + t1121 / 0.6e1 - t1124 / 0.4e1 - t1134 + t1136 / 0.6e1 - t1139 / 0.8e1;
  t1424 = my_piecewise3(t1, 0, t1423);
  t1425 = t1344 * t242;
  t1428 = t545 * t601;
  t1433 = 0.6e1 * t1351;
  t1435 = my_piecewise5(t14, 0, t10, 0, -t1389 - t1433);
  t1439 = my_piecewise3(t90, 0, -0.8e1 / 0.27e2 * t1425 * t546 + 0.8e1 / 0.9e1 * t1428 * t214 + 0.4e1 / 0.9e1 * t597 * t552 + 0.4e1 / 0.3e1 * t91 * t1435);
  t1440 = t1439 * t26;
  t1444 = t605 * t145;
  t1447 = t5 * t1444 * t127 / 0.4e1;
  t1448 = t245 * t400;
  t1450 = t5 * t1448 * t127;
  t1459 = t5 * t561 * t302 / 0.4e1;
  t1461 = t5 * t565 * t302;
  t1464 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t1440 * t127 - t1447 + t1450 / 0.12e2 - t1365 / 0.8e1 + t1369 / 0.6e1 - t1374 - 0.3e1 / 0.8e1 * t5 * t557 * t302 - t1459 + t1461 / 0.12e2);
  tv3rho31 = t543 + t570 + t1379 + t1380 + t6 * (t1424 + t1464);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1467 = t1091 * t627;
  t1472 = t374 * t632;
  t1476 = my_piecewise5(t10, 0, t14, 0, -t1389 - t1390);
  t1480 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1467 * t136 + 0.8e1 / 0.9e1 * t573 * t577 + 0.4e1 / 0.9e1 * t1472 * t136 + 0.4e1 / 0.3e1 * t23 * t1476);
  t1481 = t1480 * t26;
  t1485 = t636 * t145;
  t1487 = t5 * t1485 * t80;
  t1496 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1481 * t80 - t1487 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t637 * t206 - t1404 + t1410 / 0.6e1 - t1414 + t1121 / 0.12e2 - t1134 + t1136 / 0.12e2);
  t1497 = t1344 * t644;
  t1502 = t545 * t649;
  t1506 = my_piecewise5(t14, 0, t10, 0, t1389 - t1433);
  t1510 = my_piecewise3(t90, 0, -0.8e1 / 0.27e2 * t1497 * t214 + 0.8e1 / 0.9e1 * t597 * t601 + 0.4e1 / 0.9e1 * t1502 * t214 + 0.4e1 / 0.3e1 * t91 * t1506);
  t1511 = t1510 * t26;
  t1515 = t653 * t145;
  t1517 = t5 * t1515 * t127;
  t1524 = t5 * t610 * t302;
  t1532 = t5 * t222 * t780;
  t1534 = -0.3e1 / 0.8e1 * t5 * t1511 * t127 - t1517 / 0.8e1 - t1447 + t1450 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t606 * t302 - t1524 / 0.4e1 + t1369 / 0.12e2 - t1374 - t1459 + t1461 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t218 * t780 - t1532 / 0.8e1;
  t1535 = my_piecewise3(t85, 0, t1534);
  tv3rho32 = t1379 + t1380 + t643 + t785 + t6 * (t1496 + t1535);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1540 = t627 * t231;
  t1547 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t379 - 0.6e1 * t1100);
  t1551 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1091 * t1540 + 0.4e1 / 0.3e1 * t573 * t632 + 0.4e1 / 0.3e1 * t23 * t1547);
  t1552 = t1551 * t26;
  t1559 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1552 * t80 - 0.3e1 / 0.8e1 * t1487 + t1410 / 0.4e1 - t1134);
  t1560 = t644 * t242;
  t1567 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t379 - 0.6e1 * t1351);
  t1571 = my_piecewise3(t90, 0, -0.8e1 / 0.27e2 * t1344 * t1560 + 0.4e1 / 0.3e1 * t597 * t649 + 0.4e1 / 0.3e1 * t91 * t1567);
  t1572 = t1571 * t26;
  t1587 = t677 * t1203;
  t1588 = t261 * t1587;
  t1589 = t667 * sigma[2];
  t1590 = t668 * t668;
  t1591 = t1590 * t254;
  t1592 = 0.1e1 / t1591;
  t1594 = t1228 * t1589 * t1592;
  t1598 = 0.1e1 / t676 / t104;
  t1599 = t1598 * t1203;
  t1600 = t729 * t1599;
  t1603 = t268 * t1587;
  t1606 = t57 * t106;
  t1608 = 0.1e1 / t676 / t250;
  t1609 = t1608 * t1203;
  t1610 = t1606 * t1609;
  t1613 = t737 * t1599;
  t1616 = t272 * t1587;
  t1619 = t60 * t108;
  t1620 = t1619 * t1609;
  t1623 = t744 * t1599;
  t1626 = t276 * t1587;
  t1630 = 0.1e1 / t98 / t1037;
  t1631 = t1630 * t116;
  t1635 = sigma[2] * t1630;
  t1640 = 0.1e1 / t97 / t1590;
  t1641 = t1640 * t687;
  t1645 = t667 * t1640;
  t1646 = t419 * t1645;
  t1649 = -0.8e1 / 0.81e2 * t1588 * t1594 + 0.8e1 / 0.27e2 * t1600 * t1594 - 0.4e1 / 0.27e2 * t1603 * t1594 - 0.16e2 / 0.81e2 * t1610 * t1594 + 0.16e2 / 0.27e2 * t1613 * t1594 - 0.16e2 / 0.81e2 * t1616 * t1594 - 0.4e2 / 0.81e2 * t1620 * t1594 + 0.8e2 / 0.81e2 * t1623 * t1594 - 0.2e2 / 0.81e2 * t1626 * t1594 - 0.154e3 / 0.81e2 * t183 * t95 * t1631 - 0.154e3 / 0.81e2 * t253 * t154 * t1635 - 0.22e2 / 0.81e2 * t444 * t682 * t1641 + 0.22e2 / 0.81e2 * t666 * t1646;
  t1656 = t284 * t1252;
  t1657 = t1209 * t1589;
  t1659 = t1657 * t1592 * t116;
  t1662 = t756 * t1252;
  t1663 = t1592 * t687;
  t1664 = t1657 * t1663;
  t1667 = t290 * t1252;
  t1670 = t74 * t117;
  t1671 = t1670 * t1252;
  t1672 = t687 * t116;
  t1673 = t1592 * t1672;
  t1674 = t1657 * t1673;
  t1677 = t765 * t1252;
  t1680 = t294 * t1252;
  t1683 = t77 * t119;
  t1684 = t1683 * t1252;
  t1687 = t772 * t1252;
  t1690 = t298 * t1252;
  t1694 = t54 * t1608 * t1203;
  t1699 = -0.22e2 / 0.81e2 * t679 * t1646 + 0.11e2 / 0.81e2 * t437 * t682 * t1640 * t116 - 0.4e1 / 0.243e3 * t1656 * t1659 + 0.4e1 / 0.27e2 * t1662 * t1664 - 0.2e1 / 0.81e2 * t1667 * t1659 - 0.16e2 / 0.81e2 * t1671 * t1674 + 0.8e1 / 0.27e2 * t1677 * t1664 - 0.8e1 / 0.243e3 * t1680 * t1659 - 0.4e2 / 0.81e2 * t1684 * t1674 + 0.4e2 / 0.81e2 * t1687 * t1664 - 0.1e2 / 0.243e3 * t1690 * t1659 - 0.4e1 / 0.81e2 * t1694 * t1594 - 0.4e1 / 0.81e2 * t1234 * t1674;
  t1702 = t29 * t677 * t1203;
  t1706 = t51 * t1598 * t1203;
  t1714 = t154 * t1635 * t116;
  t1718 = t165 * t95 * t1630;
  t1728 = t419 * t1645 * t687;
  t1732 = t419 * t1645 * t116;
  t1739 = -0.4e1 / 0.81e2 * t1702 * t1594 + 0.8e1 / 0.81e2 * t1706 * t1594 - 0.2e1 / 0.243e3 * t1207 * t1659 + 0.4e1 / 0.81e2 * t1219 * t1664 - 0.77e3 / 0.81e2 * t299 * t1714 - 0.77e3 / 0.81e2 * t277 * t1718 - 0.308e3 / 0.81e2 * t285 * t1714 - 0.154e3 / 0.27e2 * t291 * t1714 - 0.616e3 / 0.81e2 * t295 * t1714 - 0.22e3 / 0.81e2 * t773 * t1728 + 0.55e2 / 0.81e2 * t776 * t1732 + 0.22e2 / 0.81e2 * t751 * t1732 - 0.22e2 / 0.27e2 * t757 * t1728;
  t1747 = t436 * t682 * t1640;
  t1768 = 0.11e2 / 0.27e2 * t762 * t1732 - 0.44e2 / 0.27e2 * t766 * t1728 + 0.44e2 / 0.81e2 * t769 * t1732 + 0.44e2 / 0.81e2 * t724 * t1747 - 0.22e2 / 0.27e2 * t731 * t1747 + 0.22e2 / 0.27e2 * t734 * t1747 - 0.44e2 / 0.27e2 * t738 * t1747 + 0.88e2 / 0.81e2 * t741 * t1747 - 0.22e3 / 0.81e2 * t745 * t1747 + 0.11e3 / 0.81e2 * t748 * t1747 - 0.308e3 / 0.81e2 * t263 * t1718 - 0.154e3 / 0.27e2 * t269 * t1718 - 0.616e3 / 0.81e2 * t273 * t1718;
  t1770 = t1649 + t1699 + t1739 + t1768;
  t1775 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t1572 * t127 - 0.3e1 / 0.8e1 * t1517 - 0.9e1 / 0.8e1 * t5 * t654 * t302 + t1450 / 0.4e1 - 0.3e1 / 0.4e1 * t1524 - 0.9e1 / 0.8e1 * t5 * t246 * t780 - t1374 + t1461 / 0.4e1 - 0.3e1 / 0.8e1 * t1532 - 0.3e1 / 0.8e1 * t5 * t94 * t1770);
  tv3rho33 = 0.3e1 * t643 + 0.3e1 * t785 + t6 * (t1559 + t1775);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1783 = t5 * t392 * t336;
  t1790 = t5 * t401 * t336 / 0.12e2;
  t1792 = t5 * t146 * t872;
  t1794 = t1164 * t39;
  t1795 = 0.1e1 / t1794;
  t1796 = t1209 * t1795;
  t1797 = t1235 * t420;
  t1798 = t1796 * t1797;
  t1801 = t445 * t420;
  t1802 = t1796 * t1801;
  t1805 = t420 * t65;
  t1806 = t1796 * t1805;
  t1815 = t154 * t456;
  t1825 = t165 * t37 * t451;
  t1832 = 0.2e1 / 0.27e2 * t1263 * t1798 - t1266 * t1802 / 0.9e1 + t1269 * t1806 / 0.81e2 + 0.5e1 / 0.27e2 * t1273 * t1798 - 0.5e1 / 0.27e2 * t1276 * t1802 + 0.5e1 / 0.324e3 * t1279 * t1806 + 0.44e2 / 0.27e2 * t199 * t1815 + 0.55e2 / 0.27e2 * t203 * t1815 + 0.22e2 / 0.27e2 * t189 * t1815 + 0.11e2 / 0.9e1 * t195 * t1815 + 0.44e2 / 0.27e2 * t175 * t1825 + 0.55e2 / 0.27e2 * t179 * t1825 + 0.22e2 / 0.27e2 * t164 * t1825;
  t1835 = t424 * sigma[0];
  t1836 = t419 * t1835;
  t1849 = t1228 * t420 * t1795;
  t1864 = 0.11e2 / 0.9e1 * t171 * t1825 - t414 * t1836 / 0.12e2 + t432 * t1836 / 0.12e2 + t444 * t806 * t446 / 0.12e2 + 0.11e2 / 0.27e2 * t310 * t1825 + 0.11e2 / 0.27e2 * t323 * t1815 + t1227 * t1849 / 0.54e2 + t1234 * t1798 / 0.54e2 + t1243 * t1849 / 0.54e2 - t1249 * t1849 / 0.27e2 + t1207 * t1806 / 0.324e3 - t1219 * t1802 / 0.54e2 + 0.2e1 / 0.27e2 * t1296 * t1849;
  t1882 = t418 * t424;
  t1893 = t419 * t1835 * t65;
  t1896 = -0.2e1 / 0.9e1 * t1299 * t1849 + 0.2e1 / 0.27e2 * t1302 * t1849 + 0.5e1 / 0.27e2 * t1306 * t1849 - 0.1e2 / 0.27e2 * t1309 * t1849 + 0.5e1 / 0.54e2 * t1312 * t1849 + t1253 * t1806 / 0.162e3 - t1256 * t1802 / 0.18e2 + t1259 * t1806 / 0.108e3 - t437 * t1882 * t802 / 0.24e2 + t1283 * t1849 / 0.27e2 - t1287 * t1849 / 0.9e1 + t1291 * t1849 / 0.18e2 - 0.5e1 / 0.24e2 * t514 * t1893;
  t1898 = t419 * t446 * sigma[0];
  t1912 = t436 * t1882 * sigma[0];
  t1927 = t504 * t1898 / 0.2e1 - t507 * t1893 / 0.6e1 + 0.5e1 / 0.6e1 * t511 * t1898 - t488 * t1893 / 0.12e2 + t495 * t1898 / 0.4e1 - t500 * t1893 / 0.8e1 + t475 * t1912 / 0.2e1 - t478 * t1912 / 0.3e1 + 0.5e1 / 0.6e1 * t482 * t1912 - 0.5e1 / 0.12e2 * t485 * t1912 - t461 * t1912 / 0.6e1 + t468 * t1912 / 0.4e1 - t471 * t1912 / 0.4e1;
  t1929 = t1832 + t1864 + t1896 + t1927;
  t1934 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t388 * t336 - t1783 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t872 + t1790 - t1792 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1929);
  tv3rho2sigma0 = t6 * t1934 + 0.2e1 * t877;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1941 = t5 * t561 * t366;
  t1945 = t5 * t565 * t366 / 0.12e2;
  t1947 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t557 * t366 - t1941 / 0.4e1 + t1945);
  tv3rho2sigma2 = t6 * t1947 + 0.2e1 * t886;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1953 = t5 * t586 * t336;
  t1961 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t582 * t336 - t1953 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t235 * t872 - t1783 / 0.8e1 + t1790 - t1792 / 0.8e1);
  tv3rho2sigma3 = t6 * t1961 + t877 + t892;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1967 = t5 * t610 * t366;
  t1974 = t5 * t222 * t975;
  t1977 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t606 * t366 - t1967 / 0.8e1 - t1941 / 0.8e1 + t1945 - 0.3e1 / 0.8e1 * t5 * t218 * t975 - t1974 / 0.8e1);
  tv3rho2sigma5 = t6 * t1977 + t886 + t980;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1985 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t637 * t336 - t1953 / 0.4e1 + t1790);
  tv3rho2sigma6 = t6 * t1985 + 0.2e1 * t892;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1997 = t165 * t37 * t693;
  t2000 = t154 * t698;
  t2003 = t1590 * t96;
  t2004 = 0.1e1 / t2003;
  t2006 = t1228 * t667 * t2004;
  t2009 = t1209 * t667;
  t2010 = t2004 * t1672;
  t2011 = t2009 * t2010;
  t2014 = t1209 * t2004;
  t2015 = t667 * t116;
  t2016 = t2014 * t2015;
  t2020 = t2009 * t2004 * t687;
  t2027 = t418 * t671;
  t2029 = t436 * t2027 * sigma[2];
  t2033 = t419 * t688 * sigma[2];
  t2036 = t671 * sigma[2];
  t2038 = t419 * t2036 * t116;
  t2045 = 0.11e2 / 0.27e2 * t341 * t1997 + 0.11e2 / 0.27e2 * t323 * t2000 + t1694 * t2006 / 0.54e2 + t1234 * t2011 / 0.54e2 + t1207 * t2016 / 0.324e3 - t1219 * t2020 / 0.54e2 + t1702 * t2006 / 0.54e2 - t1706 * t2006 / 0.27e2 - t724 * t2029 / 0.6e1 + t766 * t2033 / 0.2e1 - t769 * t2038 / 0.6e1 + 0.5e1 / 0.6e1 * t773 * t2033 - 0.5e1 / 0.24e2 * t776 * t2038;
  t2072 = t757 * t2033 / 0.4e1 - t762 * t2038 / 0.8e1 + 0.5e1 / 0.6e1 * t745 * t2029 - 0.5e1 / 0.12e2 * t748 * t2029 - t751 * t2038 / 0.12e2 + t731 * t2029 / 0.4e1 - t734 * t2029 / 0.4e1 + t738 * t2029 / 0.2e1 - t741 * t2029 / 0.3e1 + 0.55e2 / 0.27e2 * t299 * t2000 + 0.11e2 / 0.9e1 * t291 * t2000 + 0.44e2 / 0.27e2 * t295 * t2000 + 0.55e2 / 0.27e2 * t277 * t1997;
  t2083 = t419 * t2036;
  t2102 = 0.22e2 / 0.27e2 * t285 * t2000 + 0.11e2 / 0.9e1 * t269 * t1997 + 0.44e2 / 0.27e2 * t273 * t1997 + t444 * t949 * t688 / 0.12e2 + t679 * t2083 / 0.12e2 + 0.22e2 / 0.27e2 * t263 * t1997 + 0.2e1 / 0.27e2 * t1671 * t2011 - t1677 * t2020 / 0.9e1 + t1680 * t2016 / 0.81e2 + 0.5e1 / 0.27e2 * t1684 * t2011 - 0.5e1 / 0.27e2 * t1687 * t2020 + 0.5e1 / 0.324e3 * t1690 * t2016 + 0.2e1 / 0.27e2 * t1610 * t2006;
  t2130 = -0.2e1 / 0.9e1 * t1613 * t2006 + 0.2e1 / 0.27e2 * t1616 * t2006 + 0.5e1 / 0.27e2 * t1620 * t2006 - 0.1e2 / 0.27e2 * t1623 * t2006 + 0.5e1 / 0.54e2 * t1626 * t2006 + t1656 * t2016 / 0.162e3 - t1662 * t2020 / 0.18e2 + t1667 * t2016 / 0.108e3 - t666 * t2083 / 0.12e2 + t1588 * t2006 / 0.27e2 - t1600 * t2006 / 0.9e1 + t1603 * t2006 / 0.18e2 - t437 * t2027 * t945 / 0.24e2;
  t2132 = t2045 + t2072 + t2102 + t2130;
  t2137 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t654 * t366 - t1967 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t246 * t975 + t1945 - t1974 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t94 * t2132);
  tv3rho2sigma8 = t6 * t2137 + 0.2e1 * t980;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2144 = t5 * t146 * t1031 / 0.8e1;
  t2145 = t436 * t801;
  t2148 = t1164 * rho[0];
  t2149 = 0.1e1 / t2148;
  t2150 = t1209 * t2149;
  t2151 = t2150 * t802;
  t2154 = t445 * sigma[0];
  t2155 = t2150 * t2154;
  t2158 = t1209 * sigma[0];
  t2159 = t2149 * t1235;
  t2160 = t2158 * t2159;
  t2164 = t419 * t796 * t65;
  t2167 = t419 * t807;
  t2173 = t1228 * t2149 * sigma[0];
  t2203 = 0.5e1 / 0.108e3 * t514 * t2164 + t500 * t2164 / 0.36e2 - t504 * t2167 / 0.9e1 + t507 * t2164 / 0.27e2 - 0.5e1 / 0.27e2 * t511 * t2167 + 0.5e1 / 0.54e2 * t485 * t2145 + t488 * t2164 / 0.54e2 - t495 * t2167 / 0.18e2 + t471 * t2145 / 0.18e2 - t475 * t2145 / 0.9e1 + 0.2e1 / 0.27e2 * t478 * t2145;
  t2248 = -t1253 * t2151 / 0.432e3 + t1256 * t2155 / 0.48e2 - t1259 * t2151 / 0.288e3 - t1283 * t2173 / 0.72e2 + t1287 * t2173 / 0.24e2 - t1291 * t2173 / 0.48e2 - t1296 * t2173 / 0.36e2 + t1299 * t2173 / 0.12e2 - t1302 * t2173 / 0.36e2 - 0.5e1 / 0.72e2 * t1306 * t2173 + 0.5e1 / 0.36e2 * t1309 * t2173;
  t2250 = t982 * t2145 / 0.54e2 - t1207 * t2151 / 0.864e3 + t1219 * t2155 / 0.144e3 - t1234 * t2160 / 0.144e3 + t1007 * t2164 / 0.108e3 - t1012 * t2167 / 0.54e2 - t990 * t2145 / 0.54e2 - t1243 * t2173 / 0.144e3 + t1249 * t2173 / 0.72e2 - t1227 * t2173 / 0.144e3 + t2203 - 0.5e1 / 0.27e2 * t482 * t2145 + t461 * t2145 / 0.27e2 - t468 * t2145 / 0.18e2 - t1263 * t2160 / 0.36e2 + t1266 * t2155 / 0.24e2 - t1269 * t2151 / 0.216e3 - 0.5e1 / 0.72e2 * t1273 * t2160 + 0.5e1 / 0.72e2 * t1276 * t2155 - 0.5e1 / 0.864e3 * t1279 * t2151 - 0.5e1 / 0.144e3 * t1312 * t2173 + t2248;
  t2255 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t1031 - t2144 - 0.3e1 / 0.8e1 * t5 * t27 * t2250);
  tv3rhosigma20 = t6 * t2255 + t1035;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2262 = t5 * t222 * t1083 / 0.8e1;
  t2264 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t1083 - t2262);
  tv3rhosigma25 = t6 * t2264 + t1087;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2270 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t1031 - t2144);
  tv3rhosigma26 = t6 * t2270 + t1035;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2276 = t419 * t899 * t116;
  t2279 = t419 * t905;
  t2282 = t436 * t920;
  t2287 = t1590 * rho[1];
  t2288 = 0.1e1 / t2287;
  t2290 = t1228 * t2288 * sigma[2];
  t2297 = t1209 * t2288;
  t2298 = t2297 * t945;
  t2301 = t687 * sigma[2];
  t2302 = t2297 * t2301;
  t2305 = t1209 * sigma[2];
  t2306 = t2288 * t1672;
  t2307 = t2305 * t2306;
  t2333 = -t1588 * t2290 / 0.72e2 + t1600 * t2290 / 0.24e2 - t1603 * t2290 / 0.48e2 + 0.2e1 / 0.27e2 * t741 * t2282 - 0.5e1 / 0.27e2 * t745 * t2282 + 0.5e1 / 0.54e2 * t748 * t2282 + t724 * t2282 / 0.27e2 - t731 * t2282 / 0.18e2 + t734 * t2282 / 0.18e2 - t1656 * t2298 / 0.432e3 + t1662 * t2302 / 0.48e2;
  t2378 = -0.5e1 / 0.72e2 * t1620 * t2290 + 0.5e1 / 0.36e2 * t1623 * t2290 - 0.5e1 / 0.144e3 * t1626 * t2290 - t766 * t2279 / 0.9e1 + t769 * t2276 / 0.27e2 - 0.5e1 / 0.27e2 * t773 * t2279 + 0.5e1 / 0.108e3 * t776 * t2276 + t751 * t2276 / 0.54e2 - t757 * t2279 / 0.18e2 + t762 * t2276 / 0.36e2 - t738 * t2282 / 0.9e1;
  t2380 = t1007 * t2276 / 0.108e3 - t1012 * t2279 / 0.54e2 + t1036 * t2282 / 0.54e2 - t1044 * t2282 / 0.54e2 - t1702 * t2290 / 0.144e3 + t1706 * t2290 / 0.72e2 - t1694 * t2290 / 0.144e3 - t1207 * t2298 / 0.864e3 + t1219 * t2302 / 0.144e3 - t1234 * t2307 / 0.144e3 + t2333 - t1667 * t2298 / 0.288e3 - t1671 * t2307 / 0.36e2 + t1677 * t2302 / 0.24e2 - t1680 * t2298 / 0.216e3 - 0.5e1 / 0.72e2 * t1684 * t2307 + 0.5e1 / 0.72e2 * t1687 * t2302 - 0.5e1 / 0.864e3 * t1690 * t2298 - t1610 * t2290 / 0.36e2 + t1613 * t2290 / 0.12e2 - t1616 * t2290 / 0.36e2 + t2378;
  t2385 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t1083 - t2262 - 0.3e1 / 0.8e1 * t5 * t94 * t2380);
  tv3rhosigma211 = t6 * t2385 + t1087;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2387 = t188 * t1203;
  t2388 = 0.1e1 / t1164;
  t2390 = t1228 * t2388 * t65;
  t2393 = t494 * t1203;
  t2395 = t1228 * t2388 * t445;
  t2398 = t194 * t1203;
  t2401 = t1262 * t1203;
  t2403 = t1228 * t2388 * t1235;
  t2406 = t503 * t1203;
  t2409 = t198 * t1203;
  t2412 = t1272 * t1203;
  t2415 = t510 * t1203;
  t2418 = t202 * t1203;
  t2421 = t1228 * t2388;
  t2428 = t2387 * t2390 / 0.1152e4 - t2393 * t2395 / 0.128e3 + t2398 * t2390 / 0.768e3 + t2401 * t2403 / 0.96e2 - t2406 * t2395 / 0.64e2 + t2409 * t2390 / 0.576e3 + 0.5e1 / 0.192e3 * t2412 * t2403 - 0.5e1 / 0.192e3 * t2415 * t2395 + 0.5e1 / 0.2304e4 * t2418 * t2390 + t1243 * t2421 / 0.384e3 - t1249 * t2421 / 0.192e3 + t1227 * t2421 / 0.384e3;
  t2429 = t1209 * t2388;
  t2439 = t162 * t430;
  t2440 = t1252 * t2429;
  t2443 = t466 * t1247;
  t2446 = t170 * t430;
  t2449 = t1294 * t1225;
  t2452 = t474 * t1247;
  t2455 = t174 * t430;
  t2458 = t1305 * t1225;
  t2461 = t481 * t1247;
  t2464 = t178 * t430;
  t2467 = t1207 * t2429 * t65 / 0.2304e4 - t1219 * t2429 * t445 / 0.384e3 + t1234 * t2429 * t1235 / 0.384e3 + t2439 * t2440 / 0.192e3 - t2443 * t2440 / 0.64e2 + t2446 * t2440 / 0.128e3 + t2449 * t2440 / 0.96e2 - t2452 * t2440 / 0.32e2 + t2455 * t2440 / 0.96e2 + 0.5e1 / 0.192e3 * t2458 * t2440 - 0.5e1 / 0.96e2 * t2461 * t2440 + 0.5e1 / 0.384e3 * t2464 * t2440;
  t2468 = t2428 + t2467;
  t2472 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2468);
  tv3sigma30 = t6 * t2472;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2473 = 0.1e1 / t1590;
  t2474 = t1228 * t2473;
  t2477 = t1209 * t2473;
  t2491 = t268 * t677;
  t2492 = t1252 * t2477;
  t2495 = t1606 * t1608;
  t2498 = t737 * t1598;
  t2501 = t272 * t677;
  t2504 = t1619 * t1608;
  t2507 = t744 * t1598;
  t2510 = t1694 * t2474 / 0.384e3 + t1207 * t2477 * t116 / 0.2304e4 - t1219 * t2477 * t687 / 0.384e3 + t1234 * t2477 * t1672 / 0.384e3 + t1702 * t2474 / 0.384e3 - t1706 * t2474 / 0.192e3 + t2491 * t2492 / 0.128e3 + t2495 * t2492 / 0.96e2 - t2498 * t2492 / 0.32e2 + t2501 * t2492 / 0.96e2 + 0.5e1 / 0.192e3 * t2504 * t2492 - 0.5e1 / 0.96e2 * t2507 * t2492;
  t2511 = t276 * t677;
  t2514 = t284 * t1203;
  t2516 = t1228 * t2473 * t116;
  t2519 = t756 * t1203;
  t2521 = t1228 * t2473 * t687;
  t2524 = t290 * t1203;
  t2527 = t1670 * t1203;
  t2529 = t1228 * t2473 * t1672;
  t2532 = t765 * t1203;
  t2535 = t294 * t1203;
  t2538 = t1683 * t1203;
  t2541 = t772 * t1203;
  t2544 = t298 * t1203;
  t2547 = t261 * t677;
  t2550 = t729 * t1598;
  t2553 = 0.5e1 / 0.384e3 * t2511 * t2492 + t2514 * t2516 / 0.1152e4 - t2519 * t2521 / 0.128e3 + t2524 * t2516 / 0.768e3 + t2527 * t2529 / 0.96e2 - t2532 * t2521 / 0.64e2 + t2535 * t2516 / 0.576e3 + 0.5e1 / 0.192e3 * t2538 * t2529 - 0.5e1 / 0.192e3 * t2541 * t2521 + 0.5e1 / 0.2304e4 * t2544 * t2516 + t2547 * t2492 / 0.192e3 - t2550 * t2492 / 0.64e2;
  t2554 = t2510 + t2553;
  t2558 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * t2554);
  tv3sigma39 = t6 * t2558;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2563 = t5 * t1107 * t145 * t80;
  t2567 = t5 * t387 * t400 * t80;
  t2571 = t5 * t139 * t1130 * t80;
  t2574 = 0.1e1 / t144 / t378;
  t2578 = 0.1e2 / 0.27e2 * t5 * t25 * t2574 * t80;
  t2583 = t5 * t1131 * t206;
  t2586 = t5 * t401 * t538;
  t2589 = t5 * t146 * t1337;
  t2591 = t1164 * t421;
  t2592 = 0.1e1 / t2591;
  t2594 = t1228 * t1210 * t2592;
  t2598 = t1211 * t2592 * t65;
  t2604 = t1211 * t2592 * t1235;
  t2610 = t1211 * t2592 * t445;
  t2614 = 0.1e1 / t41 / t794;
  t2616 = t165 * t38 * t2614;
  t2620 = 0.1e1 / t40 / t2148;
  t2621 = t420 * t2620;
  t2623 = t419 * t2621 * t65;
  t2627 = t436 * t438 * t2620;
  t2645 = t419 * t2621 * t445;
  t2654 = -0.176e3 / 0.81e2 * t1249 * t2594 + 0.44e2 / 0.243e3 * t1207 * t2598 + 0.88e2 / 0.81e2 * t1243 * t2594 + 0.88e2 / 0.81e2 * t1234 * t2604 + 0.88e2 / 0.81e2 * t1227 * t2594 - 0.88e2 / 0.81e2 * t1219 * t2610 + 0.10472e5 / 0.243e3 * t175 * t2616 - 0.1958e4 / 0.729e3 * t488 * t2623 - 0.3916e4 / 0.729e3 * t461 * t2627 - 0.7832e4 / 0.729e3 * t478 * t2627 + 0.1958e5 / 0.729e3 * t482 * t2627 - 0.979e4 / 0.729e3 * t485 * t2627 + 0.1958e4 / 0.243e3 * t468 * t2627 - 0.1958e4 / 0.243e3 * t471 * t2627 + 0.3916e4 / 0.243e3 * t475 * t2627 - 0.3916e4 / 0.729e3 * t507 * t2623 + 0.1958e5 / 0.729e3 * t511 * t2645 - 0.4895e4 / 0.729e3 * t514 * t2623 - 0.979e3 / 0.243e3 * t500 * t2623 + 0.3916e4 / 0.243e3 * t504 * t2645;
  t2657 = t429 * t429;
  t2658 = 0.1e1 / t2657;
  t2660 = t411 * t411;
  t2661 = t2660 * t30;
  t2662 = t57 * t2658 * t2661;
  t2663 = t417 * t417;
  t2664 = 0.1e1 / t2663;
  t2665 = t35 * t2664;
  t2666 = t420 * t420;
  t2669 = 0.1e1 / t41 / t1164 / t794;
  t2670 = t2666 * t2669;
  t2676 = t74 * t2660 * t165;
  t2677 = t2664 * t2666;
  t2678 = t445 * t445;
  t2685 = t2660 * t1206;
  t2686 = t29 * t1247 * t2685;
  t2689 = t2677 * t2669 * t30 * t35;
  t2693 = t51 * t1225 * t2685;
  t2697 = t1206 * t2664;
  t2698 = t64 * t2660 * t2697;
  t2699 = t165 * t65;
  t2700 = t2670 * t2699;
  t2703 = t68 * t2660;
  t2704 = t2703 * t2697;
  t2706 = t445 * t30 * t35;
  t2707 = t2670 * t2706;
  t2711 = 0.1e1 / t429 / t408;
  t2713 = t54 * t2711 * t2685;
  t2716 = t71 * t2660;
  t2717 = t2716 * t2697;
  t2719 = t1235 * t30 * t35;
  t2720 = t2670 * t2719;
  t2723 = sigma[0] * t2614;
  t2725 = t154 * t2723 * t65;
  t2748 = t419 * t2621;
  t2751 = 0.1958e4 / 0.243e3 * t495 * t2645 + 0.16e2 / 0.729e3 * t2662 * t2665 * t2670 * t1206 + 0.16e2 / 0.729e3 * t2676 * t2677 * t2669 * t2678 * t1206 - 0.16e2 / 0.729e3 * t2686 * t2689 + 0.16e2 / 0.243e3 * t2693 * t2689 - 0.2e1 / 0.2187e4 * t2698 * t2700 + 0.28e2 / 0.2187e4 * t2704 * t2707 - 0.16e2 / 0.243e3 * t2713 * t2689 - 0.8e1 / 0.243e3 * t2717 * t2720 + 0.1309e5 / 0.243e3 * t203 * t2725 + 0.1309e5 / 0.243e3 * t179 * t2616 + 0.5236e4 / 0.243e3 * t189 * t2725 + 0.2618e4 / 0.81e2 * t195 * t2725 + 0.10472e5 / 0.243e3 * t199 * t2725 + 0.5236e4 / 0.243e3 * t164 * t2616 + 0.2618e4 / 0.81e2 * t171 * t2616 + 0.176e3 / 0.243e3 * t1269 * t2598 + 0.88e3 / 0.81e2 * t1273 * t2604 + 0.1958e4 / 0.729e3 * t444 * t438 * t2620 * t445 + 0.1958e4 / 0.729e3 * t432 * t2748;
  t2798 = 0.2618e4 / 0.243e3 * t153 * t154 * t2723 + 0.2618e4 / 0.243e3 * t183 * t38 * t2614 * t65 - 0.88e3 / 0.81e2 * t1276 * t2610 + 0.22e3 / 0.243e3 * t1279 * t2598 - 0.1958e4 / 0.729e3 * t414 * t2748 - 0.176e3 / 0.27e2 * t1287 * t2594 + 0.88e2 / 0.27e2 * t1291 * t2594 + 0.352e3 / 0.81e2 * t1296 * t2594 - 0.352e3 / 0.27e2 * t1299 * t2594 + 0.352e3 / 0.81e2 * t1302 * t2594 + 0.88e3 / 0.81e2 * t1306 * t2594 - 0.176e4 / 0.81e2 * t1309 * t2594 + 0.44e3 / 0.81e2 * t1312 * t2594 + 0.88e2 / 0.243e3 * t1253 * t2598 + 0.176e3 / 0.81e2 * t1283 * t2594 - 0.979e3 / 0.729e3 * t437 * t438 * t2620 * t65 - 0.88e2 / 0.27e2 * t1256 * t2610 + 0.44e2 / 0.81e2 * t1259 * t2598 + 0.352e3 / 0.81e2 * t1263 * t2604 - 0.176e3 / 0.27e2 * t1266 * t2610;
  t2799 = t1247 * t2660;
  t2800 = t2799 * t1206;
  t2801 = t178 * t2800;
  t2804 = t1225 * t2660;
  t2805 = t2804 * t1206;
  t2806 = t466 * t2805;
  t2809 = t170 * t2800;
  t2812 = t2711 * t2660;
  t2813 = t2812 * t1206;
  t2814 = t1294 * t2813;
  t2817 = t474 * t2805;
  t2820 = t174 * t2800;
  t2823 = t60 * t49;
  t2824 = t2658 * t2660;
  t2826 = t2823 * t2824 * t1206;
  t2829 = t1305 * t2813;
  t2832 = t481 * t2805;
  t2835 = t2685 * t2664;
  t2836 = t194 * t2835;
  t2839 = t1262 * t2835;
  t2842 = t503 * t2835;
  t2845 = t198 * t2835;
  t2848 = t77 * t66;
  t2849 = t2848 * t2835;
  t2851 = t2678 * t30 * t35;
  t2855 = t1272 * t2835;
  t2858 = t510 * t2835;
  t2861 = t202 * t2835;
  t2864 = t162 * t2800;
  t2867 = t188 * t2835;
  t2870 = t494 * t2835;
  t2873 = -0.8e2 / 0.729e3 * t2801 * t2689 + 0.16e2 / 0.81e2 * t2806 * t2689 - 0.16e2 / 0.243e3 * t2809 * t2689 - 0.64e2 / 0.243e3 * t2814 * t2689 + 0.32e2 / 0.81e2 * t2817 * t2689 - 0.64e2 / 0.729e3 * t2820 * t2689 + 0.8e2 / 0.729e3 * t2826 * t2689 - 0.16e3 / 0.243e3 * t2829 * t2689 + 0.16e3 / 0.243e3 * t2832 * t2689 - 0.2e1 / 0.729e3 * t2836 * t2700 - 0.32e2 / 0.243e3 * t2839 * t2720 + 0.56e2 / 0.729e3 * t2842 * t2707 - 0.8e1 / 0.2187e4 * t2845 * t2700 + 0.8e2 / 0.729e3 * t2849 * t2670 * t2851 - 0.8e2 / 0.243e3 * t2855 * t2720 + 0.28e3 / 0.2187e4 * t2858 * t2707 - 0.1e2 / 0.2187e4 * t2861 * t2700 - 0.32e2 / 0.729e3 * t2864 * t2689 - 0.4e1 / 0.2187e4 * t2867 * t2700 + 0.28e2 / 0.729e3 * t2870 * t2707;
  t2879 = t19 * t19;
  t2881 = 0.1e1 / t373 / t2879;
  t2882 = t375 * t375;
  t2888 = t383 * t383;
  t2894 = 0.1e1 / t1098 / t6;
  t2895 = t16 * t2894;
  t2898 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t1099 + 0.24e2 * t2895);
  t2902 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2881 * t2882 - 0.16e2 / 0.9e1 * t1091 * t375 * t383 + 0.4e1 / 0.3e1 * t374 * t2888 + 0.16e2 / 0.9e1 * t1095 * t1103 + 0.4e1 / 0.3e1 * t23 * t2898);
  t2911 = t5 * t1112 * t206;
  t2917 = t5 * t1119 * t206;
  t2919 = t5 * t392 * t538;
  t2921 = -t2563 / 0.2e1 + t2567 / 0.2e1 - 0.5e1 / 0.9e1 * t2571 + t2578 - 0.3e1 / 0.2e1 * t5 * t140 * t1337 - 0.5e1 / 0.9e1 * t2583 + t2586 / 0.2e1 - t2589 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t2654 + t2751 + t2798 + t2873) - 0.3e1 / 0.8e1 * t5 * t2902 * t26 * t80 - 0.3e1 / 0.2e1 * t5 * t1108 * t206 - 0.3e1 / 0.2e1 * t2911 - 0.9e1 / 0.4e1 * t5 * t388 * t538 + t2917 - 0.3e1 / 0.2e1 * t2919;
  t2922 = my_piecewise3(t1, 0, t2921);
  t2923 = t89 * t89;
  t2925 = 0.1e1 / t544 / t2923;
  t2926 = t546 * t546;
  t2932 = t552 * t552;
  t2937 = t86 * t2894;
  t2940 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t1099 + 0.24e2 * t2937);
  t2944 = my_piecewise3(t90, 0, 0.4e2 / 0.81e2 * t2925 * t2926 - 0.16e2 / 0.9e1 * t1344 * t546 * t552 + 0.4e1 / 0.3e1 * t545 * t2932 + 0.16e2 / 0.9e1 * t1348 * t1354 + 0.4e1 / 0.3e1 * t91 * t2940);
  t2951 = t5 * t1358 * t145 * t127;
  t2955 = t5 * t556 * t400 * t127;
  t2959 = t5 * t217 * t1130 * t127;
  t2964 = 0.1e2 / 0.27e2 * t5 * t93 * t2574 * t127;
  t2966 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t2944 * t26 * t127 - t2951 / 0.2e1 + t2955 / 0.2e1 - 0.5e1 / 0.9e1 * t2959 + t2964);
  tv4rho40 = 0.4e1 * t1342 + 0.4e1 * t1376 + t6 * (t2922 + t2966);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2973 = t5 * t1396 * t145 * t80;
  t2977 = t5 * t581 * t400 * t80;
  t2978 = t2977 / 0.4e1;
  t2981 = t5 * t234 * t1130 * t80;
  t3002 = 0.12e2 * t1099;
  t3003 = 0.24e2 * t2895;
  t3005 = my_piecewise5(t10, 0, t14, 0, -t3002 + t3003);
  t3009 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2881 * t231 * t1092 - 0.8e1 / 0.9e1 * t1091 * t577 * t375 - 0.8e1 / 0.9e1 * t1381 * t136 * t383 + 0.4e1 / 0.3e1 * t374 * t1392 * t136 + 0.4e1 / 0.3e1 * t1384 * t383 + 0.4e1 / 0.9e1 * t573 * t1103 + 0.4e1 / 0.3e1 * t23 * t3005);
  t3018 = t5 * t1401 * t206;
  t3024 = t5 * t1408 * t206;
  t3025 = t3024 / 0.4e1;
  t3027 = t5 * t586 * t538;
  t3038 = -0.3e1 / 0.8e1 * t2973 + t2978 - 0.5e1 / 0.36e2 * t2981 - t2563 / 0.8e1 + t2567 / 0.4e1 - 0.5e1 / 0.12e2 * t2571 + t2578 - 0.3e1 / 0.8e1 * t5 * t3009 * t26 * t80 - 0.9e1 / 0.8e1 * t5 * t1397 * t206 - 0.3e1 / 0.4e1 * t3018 - 0.9e1 / 0.8e1 * t5 * t582 * t538 + t3025 - 0.3e1 / 0.8e1 * t3027 - 0.3e1 / 0.8e1 * t5 * t235 * t1337 - 0.5e1 / 0.12e2 * t2583 + t2586 / 0.4e1 - t2589 / 0.8e1 - 0.3e1 / 0.8e1 * t2911 + t2917 / 0.2e1 - 0.3e1 / 0.8e1 * t2919;
  t3039 = my_piecewise3(t1, 0, t3038);
  t3056 = 0.24e2 * t2937;
  t3058 = my_piecewise5(t14, 0, t10, 0, t3002 + t3056);
  t3062 = my_piecewise3(t90, 0, 0.4e2 / 0.81e2 * t2925 * t242 * t1345 - 0.8e1 / 0.9e1 * t1344 * t601 * t546 - 0.8e1 / 0.9e1 * t1425 * t214 * t552 + 0.4e1 / 0.3e1 * t545 * t1435 * t214 + 0.4e1 / 0.3e1 * t1428 * t552 + 0.4e1 / 0.9e1 * t597 * t1354 + 0.4e1 / 0.3e1 * t91 * t3058);
  t3069 = t5 * t1439 * t145 * t127;
  t3073 = t5 * t605 * t400 * t127;
  t3074 = t3073 / 0.4e1;
  t3077 = t5 * t245 * t1130 * t127;
  t3086 = t5 * t1363 * t302;
  t3089 = t5 * t1367 * t302;
  t3090 = t3089 / 0.4e1;
  t3092 = t5 * t1371 * t302;
  t3094 = -0.3e1 / 0.8e1 * t5 * t3062 * t26 * t127 - 0.3e1 / 0.8e1 * t3069 + t3074 - 0.5e1 / 0.36e2 * t3077 - t2951 / 0.8e1 + t2955 / 0.4e1 - 0.5e1 / 0.12e2 * t2959 + t2964 - 0.3e1 / 0.8e1 * t5 * t1359 * t302 - 0.3e1 / 0.8e1 * t3086 + t3090 - 0.5e1 / 0.36e2 * t3092;
  t3095 = my_piecewise3(t85, 0, t3094);
  tv4rho41 = t1342 + t1376 + 0.3e1 * t1424 + 0.3e1 * t1464 + t6 * (t3039 + t3095);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t3104 = t5 * t1480 * t145 * t80;
  t3108 = t5 * t636 * t400 * t80;
  t3123 = t577 * t577;
  t3136 = my_piecewise5(t10, 0, t14, 0, t3003);
  t3140 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2881 * t627 * t375 - 0.32e2 / 0.27e2 * t1381 * t136 * t577 - 0.8e1 / 0.27e2 * t1467 * t383 + 0.8e1 / 0.9e1 * t374 * t3123 + 0.8e1 / 0.9e1 * t573 * t1392 - 0.8e1 / 0.27e2 * t1091 * t632 * t375 + 0.8e1 / 0.9e1 * t374 * t1476 * t136 + 0.4e1 / 0.9e1 * t1472 * t383 + 0.4e1 / 0.3e1 * t23 * t3136);
  t3149 = t5 * t1485 * t206;
  t3160 = -t3104 / 0.4e1 + t3108 / 0.12e2 - t2973 / 0.4e1 + t2977 / 0.3e1 - 0.5e1 / 0.18e2 * t2981 + t2567 / 0.12e2 - 0.5e1 / 0.18e2 * t2571 + t2578 - 0.3e1 / 0.8e1 * t5 * t3140 * t26 * t80 - 0.3e1 / 0.4e1 * t5 * t1481 * t206 - t3149 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t637 * t538 - t3018 / 0.2e1 + t3024 / 0.3e1 - t3027 / 0.4e1 - 0.5e1 / 0.18e2 * t2583 + t2586 / 0.12e2 + t2917 / 0.6e1;
  t3161 = my_piecewise3(t1, 0, t3160);
  t3170 = t601 * t601;
  t3183 = my_piecewise5(t14, 0, t10, 0, t3056);
  t3187 = my_piecewise3(t90, 0, 0.4e2 / 0.81e2 * t2925 * t644 * t546 - 0.32e2 / 0.27e2 * t1425 * t214 * t601 - 0.8e1 / 0.27e2 * t1497 * t552 + 0.8e1 / 0.9e1 * t545 * t3170 + 0.8e1 / 0.9e1 * t597 * t1435 - 0.8e1 / 0.27e2 * t1344 * t649 * t546 + 0.8e1 / 0.9e1 * t545 * t1506 * t214 + 0.4e1 / 0.9e1 * t1502 * t552 + 0.4e1 / 0.3e1 * t91 * t3183);
  t3194 = t5 * t1510 * t145 * t127;
  t3198 = t5 * t653 * t400 * t127;
  t3207 = t5 * t1444 * t302;
  t3210 = t5 * t1448 * t302;
  t3221 = t5 * t561 * t780;
  t3224 = t5 * t565 * t780;
  t3226 = -0.3e1 / 0.8e1 * t5 * t3187 * t26 * t127 - t3194 / 0.4e1 + t3198 / 0.12e2 - t3069 / 0.4e1 + t3073 / 0.3e1 - 0.5e1 / 0.18e2 * t3077 - 0.3e1 / 0.4e1 * t5 * t1440 * t302 - t3207 / 0.2e1 + t3210 / 0.6e1 + t2955 / 0.12e2 - 0.5e1 / 0.18e2 * t2959 + t2964 - t3086 / 0.4e1 + t3089 / 0.3e1 - 0.5e1 / 0.18e2 * t3092 - 0.3e1 / 0.8e1 * t5 * t557 * t780 - t3221 / 0.4e1 + t3224 / 0.12e2;
  t3227 = my_piecewise3(t85, 0, t3226);
  tv4rho42 = 0.2e1 * t1424 + 0.2e1 * t1464 + 0.2e1 * t1496 + 0.2e1 * t1535 + t6 * (t3161 + t3227);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t3248 = my_piecewise5(t10, 0, t14, 0, t3002 + t3003);
  t3252 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2881 * t1540 * t136 - 0.8e1 / 0.9e1 * t1467 * t577 - 0.8e1 / 0.9e1 * t1381 * t632 * t136 + 0.4e1 / 0.3e1 * t1384 * t632 + 0.4e1 / 0.3e1 * t573 * t1476 + 0.4e1 / 0.9e1 * t374 * t1547 * t136 + 0.4e1 / 0.3e1 * t23 * t3248);
  t3259 = t5 * t1551 * t145 * t80;
  t3270 = -0.3e1 / 0.8e1 * t5 * t3252 * t26 * t80 - t3259 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1552 * t206 - 0.3e1 / 0.8e1 * t3104 + t3108 / 0.4e1 - 0.3e1 / 0.8e1 * t3149 + t2978 - 0.5e1 / 0.12e2 * t2981 + t3025 - 0.5e1 / 0.36e2 * t2571 + t2578 - 0.5e1 / 0.36e2 * t2583;
  t3271 = my_piecewise3(t1, 0, t3270);
  t3288 = my_piecewise5(t14, 0, t10, 0, -t3002 + t3056);
  t3292 = my_piecewise3(t90, 0, 0.4e2 / 0.81e2 * t2925 * t1560 * t214 - 0.8e1 / 0.9e1 * t1497 * t601 - 0.8e1 / 0.9e1 * t1425 * t649 * t214 + 0.4e1 / 0.3e1 * t1428 * t649 + 0.4e1 / 0.3e1 * t597 * t1506 + 0.4e1 / 0.9e1 * t545 * t1567 * t214 + 0.4e1 / 0.3e1 * t91 * t3288);
  t3299 = t5 * t1571 * t145 * t127;
  t3307 = t5 * t1515 * t302;
  t3316 = t5 * t610 * t780;
  t3326 = t5 * t222 * t1770;
  t3328 = -0.3e1 / 0.8e1 * t5 * t3292 * t26 * t127 - t3299 / 0.8e1 - 0.3e1 / 0.8e1 * t3194 + t3198 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1511 * t302 - 0.3e1 / 0.8e1 * t3307 + t3074 - 0.5e1 / 0.12e2 * t3077 - 0.3e1 / 0.4e1 * t3207 + t3210 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t606 * t780 - 0.3e1 / 0.8e1 * t3316 - 0.5e1 / 0.36e2 * t2959 + t2964 + t3090 - 0.5e1 / 0.12e2 * t3092 - 0.3e1 / 0.8e1 * t3221 + t3224 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t218 * t1770 - t3326 / 0.8e1;
  t3329 = my_piecewise3(t85, 0, t3328);
  tv4rho43 = 0.3e1 * t1496 + 0.3e1 * t1535 + t1559 + t1775 + t6 * (t3271 + t3329);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3334 = t627 * t627;
  t3339 = t632 * t632;
  t3346 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t1099 + 0.24e2 * t2895);
  t3350 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2881 * t3334 - 0.16e2 / 0.9e1 * t1467 * t632 + 0.4e1 / 0.3e1 * t374 * t3339 + 0.16e2 / 0.9e1 * t573 * t1547 + 0.4e1 / 0.3e1 * t23 * t3346);
  t3359 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t3350 * t26 * t80 - t3259 / 0.2e1 + t3108 / 0.2e1 - 0.5e1 / 0.9e1 * t2981 + t2578);
  t3360 = t1590 * t668;
  t3361 = 0.1e1 / t3360;
  t3363 = t1657 * t3361 * t687;
  t3367 = t1657 * t3361 * t1672;
  t3371 = t1228 * t1589 * t3361;
  t3379 = t1657 * t3361 * t116;
  t3382 = t284 * t2835;
  t3383 = t667 * t667;
  t3386 = 0.1e1 / t98 / t1590 / t897;
  t3387 = t3383 * t3386;
  t3388 = t165 * t116;
  t3389 = t3387 * t3388;
  t3392 = t756 * t2835;
  t3394 = t687 * t30 * t35;
  t3395 = t3387 * t3394;
  t3398 = t290 * t2835;
  t3401 = t1670 * t2835;
  t3403 = t1672 * t30 * t35;
  t3404 = t3387 * t3403;
  t3407 = t765 * t2835;
  t3410 = t294 * t2835;
  t3413 = t77 * t117;
  t3414 = t3413 * t2835;
  t3415 = t687 * t687;
  t3417 = t3415 * t30 * t35;
  t3421 = t1683 * t2835;
  t3424 = t1598 * t2660;
  t3425 = t3424 * t1206;
  t3426 = t261 * t3425;
  t3427 = t2664 * t3383;
  t3430 = t3427 * t3386 * t30 * t35;
  t3433 = t1608 * t2660;
  t3434 = t3433 * t1206;
  t3435 = t729 * t3434;
  t3438 = t268 * t3425;
  t3442 = 0.1e1 / t676 / t663;
  t3443 = t3442 * t2660;
  t3444 = t3443 * t1206;
  t3445 = t1606 * t3444;
  t3448 = t737 * t3434;
  t3451 = t272 * t3425;
  t3454 = -0.88e2 / 0.81e2 * t1219 * t3363 + 0.88e2 / 0.81e2 * t1234 * t3367 - 0.176e3 / 0.81e2 * t1706 * t3371 + 0.88e2 / 0.81e2 * t1694 * t3371 + 0.88e2 / 0.81e2 * t1702 * t3371 + 0.44e2 / 0.243e3 * t1207 * t3379 - 0.4e1 / 0.2187e4 * t3382 * t3389 + 0.28e2 / 0.729e3 * t3392 * t3395 - 0.2e1 / 0.729e3 * t3398 * t3389 - 0.32e2 / 0.243e3 * t3401 * t3404 + 0.56e2 / 0.729e3 * t3407 * t3395 - 0.8e1 / 0.2187e4 * t3410 * t3389 + 0.8e2 / 0.729e3 * t3414 * t3387 * t3417 - 0.8e2 / 0.243e3 * t3421 * t3404 - 0.32e2 / 0.729e3 * t3426 * t3430 + 0.16e2 / 0.81e2 * t3435 * t3430 - 0.16e2 / 0.243e3 * t3438 * t3430 - 0.64e2 / 0.243e3 * t3445 * t3430 + 0.32e2 / 0.81e2 * t3448 * t3430 - 0.64e2 / 0.729e3 * t3451 * t3430;
  t3455 = t60 * t106;
  t3456 = t676 * t676;
  t3457 = 0.1e1 / t3456;
  t3458 = t3457 * t2660;
  t3460 = t3455 * t3458 * t1206;
  t3463 = t1619 * t3444;
  t3466 = t744 * t3434;
  t3469 = t276 * t3425;
  t3472 = t772 * t2835;
  t3475 = t298 * t2835;
  t3479 = 0.1e1 / t97 / t2287;
  t3481 = t436 * t682 * t3479;
  t3487 = 0.1e1 / t98 / t897;
  t3489 = t165 * t95 * t3487;
  t3492 = sigma[2] * t3487;
  t3494 = t154 * t3492 * t116;
  t3507 = t667 * t3479;
  t3509 = t419 * t3507 * t116;
  t3513 = t419 * t3507 * t687;
  t3522 = 0.8e2 / 0.729e3 * t3460 * t3430 - 0.16e3 / 0.243e3 * t3463 * t3430 + 0.16e3 / 0.243e3 * t3466 * t3430 - 0.8e2 / 0.729e3 * t3469 * t3430 + 0.28e3 / 0.2187e4 * t3472 * t3395 - 0.1e2 / 0.2187e4 * t3475 * t3389 + 0.3916e4 / 0.243e3 * t738 * t3481 - 0.3916e4 / 0.729e3 * t724 * t3481 + 0.1309e5 / 0.243e3 * t277 * t3489 + 0.5236e4 / 0.243e3 * t285 * t3494 + 0.2618e4 / 0.81e2 * t291 * t3494 + 0.10472e5 / 0.243e3 * t295 * t3494 + 0.1309e5 / 0.243e3 * t299 * t3494 + 0.1958e5 / 0.729e3 * t745 * t3481 - 0.979e4 / 0.729e3 * t748 * t3481 - 0.1958e4 / 0.729e3 * t751 * t3509 + 0.1958e4 / 0.243e3 * t757 * t3513 - 0.979e3 / 0.243e3 * t762 * t3509 + 0.3916e4 / 0.243e3 * t766 * t3513 + 0.1958e5 / 0.729e3 * t773 * t3513;
  t3535 = t57 * t3457 * t2661;
  t3546 = t51 * t1608 * t2685;
  t3554 = t54 * t3442 * t2685;
  t3560 = t29 * t1598 * t2685;
  t3581 = -0.4895e4 / 0.729e3 * t776 * t3509 - 0.7832e4 / 0.729e3 * t741 * t3481 + 0.1958e4 / 0.243e3 * t731 * t3481 - 0.1958e4 / 0.243e3 * t734 * t3481 + 0.2618e4 / 0.81e2 * t269 * t3489 + 0.16e2 / 0.729e3 * t3535 * t2665 * t3387 * t1206 + 0.16e2 / 0.729e3 * t2676 * t3427 * t3386 * t3415 * t1206 + 0.16e2 / 0.243e3 * t3546 * t3430 - 0.2e1 / 0.2187e4 * t2698 * t3389 + 0.28e2 / 0.2187e4 * t2704 * t3395 - 0.16e2 / 0.243e3 * t3554 * t3430 - 0.8e1 / 0.243e3 * t2717 * t3404 - 0.16e2 / 0.729e3 * t3560 * t3430 - 0.3916e4 / 0.729e3 * t769 * t3509 + 0.10472e5 / 0.243e3 * t273 * t3489 + 0.5236e4 / 0.243e3 * t263 * t3489 + 0.1958e4 / 0.729e3 * t444 * t682 * t3479 * t687 - 0.979e3 / 0.729e3 * t437 * t682 * t3479 * t116 + 0.88e3 / 0.81e2 * t1684 * t3367 - 0.88e3 / 0.81e2 * t1687 * t3363;
  t3584 = t419 * t3507;
  t3626 = 0.22e3 / 0.243e3 * t1690 * t3379 + 0.1958e4 / 0.729e3 * t679 * t3584 + 0.2618e4 / 0.243e3 * t183 * t95 * t3487 * t116 + 0.2618e4 / 0.243e3 * t253 * t154 * t3492 - 0.1958e4 / 0.729e3 * t666 * t3584 + 0.88e2 / 0.243e3 * t1656 * t3379 - 0.88e2 / 0.27e2 * t1662 * t3363 + 0.44e2 / 0.81e2 * t1667 * t3379 + 0.352e3 / 0.81e2 * t1671 * t3367 - 0.176e3 / 0.27e2 * t1677 * t3363 + 0.176e3 / 0.243e3 * t1680 * t3379 + 0.176e3 / 0.81e2 * t1588 * t3371 - 0.176e3 / 0.27e2 * t1600 * t3371 + 0.88e2 / 0.27e2 * t1603 * t3371 + 0.352e3 / 0.81e2 * t1610 * t3371 - 0.352e3 / 0.27e2 * t1613 * t3371 + 0.352e3 / 0.81e2 * t1616 * t3371 + 0.88e3 / 0.81e2 * t1620 * t3371 - 0.176e4 / 0.81e2 * t1623 * t3371 + 0.44e3 / 0.81e2 * t1626 * t3371;
  t3632 = t644 * t644;
  t3637 = t649 * t649;
  t3644 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t1099 + 0.24e2 * t2937);
  t3648 = my_piecewise3(t90, 0, 0.4e2 / 0.81e2 * t2925 * t3632 - 0.16e2 / 0.9e1 * t1497 * t649 + 0.4e1 / 0.3e1 * t545 * t3637 + 0.16e2 / 0.9e1 * t597 * t1567 + 0.4e1 / 0.3e1 * t91 * t3644);
  t3670 = -0.3e1 / 0.8e1 * t5 * t94 * (t3454 + t3522 + t3581 + t3626) - 0.3e1 / 0.8e1 * t5 * t3648 * t26 * t127 - 0.3e1 / 0.2e1 * t5 * t1572 * t302 - 0.9e1 / 0.4e1 * t5 * t654 * t780 - 0.3e1 / 0.2e1 * t5 * t246 * t1770 - t3299 / 0.2e1 - 0.3e1 / 0.2e1 * t3307 - 0.3e1 / 0.2e1 * t3316 - t3326 / 0.2e1 + t3224 / 0.2e1 + t3198 / 0.2e1 + t3210 - 0.5e1 / 0.9e1 * t3077 - 0.5e1 / 0.9e1 * t3092 + t2964;
  t3671 = my_piecewise3(t85, 0, t3670);
  tv4rho44 = 0.4e1 * t1559 + 0.4e1 * t1775 + t6 * (t3359 + t3671);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t3679 = t5 * t1112 * t336;
  t3685 = t5 * t1119 * t336;
  t3688 = t5 * t392 * t872;
  t3695 = 0.5e1 / 0.36e2 * t5 * t1131 * t336;
  t3697 = t5 * t401 * t872;
  t3700 = t5 * t146 * t1929;
  t3702 = t1166 * sigma[0];
  t3704 = t419 * t3702 * t65;
  t3708 = t419 * t1329 * sigma[0];
  t3719 = t2664 * t1210;
  t3722 = 0.1e1 / t41 / t1164 / t983;
  t3723 = t3722 * t2678;
  t3728 = t3722 * t1210;
  t3729 = t3728 * t2699;
  t3732 = t3728 * t2706;
  t3741 = t3719 * t3722 * t30 * t35;
  t3744 = t418 * t1166;
  t3746 = t436 * t3744 * sigma[0];
  t3763 = t3728 * t2719;
  t3766 = 0.341e3 / 0.486e3 * t488 * t3704 - 0.341e3 / 0.162e3 * t495 * t3708 + 0.341e3 / 0.324e3 * t500 * t3704 - 0.341e3 / 0.81e2 * t504 * t3708 + 0.341e3 / 0.243e3 * t507 * t3704 - 0.1705e4 / 0.243e3 * t511 * t3708 - 0.2e1 / 0.243e3 * t2676 * t3719 * t3723 * t1206 + t2698 * t3729 / 0.2916e4 - 0.7e1 / 0.1458e4 * t2704 * t3732 - 0.2e1 / 0.243e3 * t2662 * t2665 * t3728 * t1206 + 0.2e1 / 0.81e2 * t2713 * t3741 + 0.341e3 / 0.243e3 * t461 * t3746 - 0.341e3 / 0.162e3 * t468 * t3746 + 0.341e3 / 0.162e3 * t471 * t3746 - 0.341e3 / 0.81e2 * t475 * t3746 + 0.682e3 / 0.243e3 * t478 * t3746 - 0.1705e4 / 0.243e3 * t482 * t3746 + 0.1705e4 / 0.486e3 * t485 * t3746 + 0.1705e4 / 0.972e3 * t514 * t3704 + t2717 * t3763 / 0.81e2;
  t3772 = t1228 * t1213 * t420;
  t3776 = t165 * t37 * t1142;
  t3781 = t154 * t1315;
  t3790 = t1209 * t1213;
  t3791 = t3790 * t1797;
  t3794 = t3790 * t1801;
  t3797 = t3790 * t1805;
  t3810 = t419 * t3702;
  t3817 = 0.2e1 / 0.243e3 * t2686 * t3741 - 0.2e1 / 0.81e2 * t2693 * t3741 - 0.95e2 / 0.27e2 * t1306 * t3772 - 0.616e3 / 0.81e2 * t175 * t3776 - 0.77e3 / 0.81e2 * t179 * t3776 - 0.308e3 / 0.81e2 * t189 * t3781 - 0.154e3 / 0.27e2 * t195 * t3781 - 0.616e3 / 0.81e2 * t199 * t3781 - 0.77e3 / 0.81e2 * t203 * t3781 - 0.95e2 / 0.27e2 * t1273 * t3791 + 0.95e2 / 0.27e2 * t1276 * t3794 - 0.95e2 / 0.324e3 * t1279 * t3797 - 0.38e2 / 0.27e2 * t1263 * t3791 + 0.19e2 / 0.9e1 * t1266 * t3794 - 0.19e2 / 0.81e2 * t1269 * t3797 + 0.19e3 / 0.27e2 * t1309 * t3772 - 0.95e2 / 0.54e2 * t1312 * t3772 - 0.341e3 / 0.486e3 * t432 * t3810 - 0.19e2 / 0.27e2 * t1283 * t3772 + 0.19e2 / 0.9e1 * t1287 * t3772;
  t3861 = -0.19e2 / 0.18e2 * t1291 * t3772 - 0.341e3 / 0.486e3 * t444 * t806 * t1329 - 0.19e2 / 0.162e3 * t1253 * t3797 + 0.19e2 / 0.18e2 * t1256 * t3794 - 0.19e2 / 0.108e3 * t1259 * t3797 - 0.38e2 / 0.27e2 * t1296 * t3772 + 0.38e2 / 0.9e1 * t1299 * t3772 - 0.38e2 / 0.27e2 * t1302 * t3772 + 0.341e3 / 0.972e3 * t437 * t3744 * t802 + 0.341e3 / 0.486e3 * t414 * t3810 - 0.308e3 / 0.81e2 * t164 * t3776 - 0.154e3 / 0.27e2 * t171 * t3776 - 0.154e3 / 0.81e2 * t310 * t3776 - 0.154e3 / 0.81e2 * t323 * t3781 - 0.19e2 / 0.324e3 * t1207 * t3797 + 0.19e2 / 0.54e2 * t1219 * t3794 - 0.19e2 / 0.54e2 * t1234 * t3791 + 0.19e2 / 0.27e2 * t1249 * t3772 - 0.19e2 / 0.54e2 * t1227 * t3772 - 0.19e2 / 0.54e2 * t1243 * t3772;
  t3905 = 0.1e2 / 0.243e3 * t2801 * t3741 + t2867 * t3729 / 0.1458e4 - 0.7e1 / 0.486e3 * t2870 * t3732 + t2836 * t3729 / 0.972e3 + 0.4e1 / 0.243e3 * t2864 * t3741 - 0.2e1 / 0.27e2 * t2806 * t3741 + 0.2e1 / 0.81e2 * t2809 * t3741 + 0.8e1 / 0.81e2 * t2814 * t3741 - 0.4e1 / 0.27e2 * t2817 * t3741 + 0.8e1 / 0.243e3 * t2820 * t3741 - 0.1e2 / 0.243e3 * t2826 * t3741 + 0.2e2 / 0.81e2 * t2829 * t3741 - 0.2e2 / 0.81e2 * t2832 * t3741 + 0.5e1 / 0.2916e4 * t2861 * t3729 + 0.4e1 / 0.81e2 * t2839 * t3763 - 0.7e1 / 0.243e3 * t2842 * t3732 + t2845 * t3729 / 0.729e3 - 0.1e2 / 0.243e3 * t2849 * t3723 * t1210 * t30 * t35 + 0.1e2 / 0.81e2 * t2855 * t3763 - 0.35e2 / 0.729e3 * t2858 * t3732;
  t3912 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1108 * t336 - 0.3e1 / 0.8e1 * t3679 - 0.9e1 / 0.8e1 * t5 * t388 * t872 + t3685 / 0.4e1 - 0.3e1 / 0.4e1 * t3688 - 0.9e1 / 0.8e1 * t5 * t140 * t1929 - t3695 + t3697 / 0.4e1 - 0.3e1 / 0.8e1 * t3700 - 0.3e1 / 0.8e1 * t5 * t27 * (t3766 + t3817 + t3861 + t3905));
  tv4rho3sigma0 = t6 * t3912 + 0.3e1 * t1934;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t3919 = t5 * t1363 * t366;
  t3922 = t5 * t1367 * t366;
  t3926 = 0.5e1 / 0.36e2 * t5 * t1371 * t366;
  t3928 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t1359 * t366 - 0.3e1 / 0.8e1 * t3919 + t3922 / 0.4e1 - t3926);
  tv4rho3sigma2 = t6 * t3928 + 0.3e1 * t1947;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t3930 = 0.2e1 * t1961;
  t3936 = t5 * t1401 * t336 / 0.4e1;
  t3941 = t5 * t1408 * t336;
  t3945 = t5 * t586 * t872 / 0.4e1;
  t3954 = -0.3e1 / 0.8e1 * t5 * t1397 * t336 - t3936 - 0.3e1 / 0.4e1 * t5 * t582 * t872 + t3941 / 0.12e2 - t3945 - 0.3e1 / 0.8e1 * t5 * t235 * t1929 - t3679 / 0.8e1 + t3685 / 0.6e1 - t3688 / 0.4e1 - t3695 + t3697 / 0.6e1 - t3700 / 0.8e1;
  t3955 = my_piecewise3(t1, 0, t3954);
  tv4rho3sigma3 = t6 * t3955 + t1934 + t3930;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t3957 = 0.2e1 * t1977;
  t3963 = t5 * t1444 * t366 / 0.4e1;
  t3965 = t5 * t1448 * t366;
  t3974 = t5 * t561 * t975 / 0.4e1;
  t3976 = t5 * t565 * t975;
  t3979 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t1440 * t366 - t3963 + t3965 / 0.12e2 - t3919 / 0.8e1 + t3922 / 0.6e1 - t3926 - 0.3e1 / 0.8e1 * t5 * t557 * t975 - t3974 + t3976 / 0.12e2);
  tv4rho3sigma5 = t6 * t3979 + t1947 + t3957;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t3985 = t5 * t1485 * t336;
  t3994 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1481 * t336 - t3985 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t637 * t872 - t3936 + t3941 / 0.6e1 - t3945 + t3685 / 0.12e2 - t3695 + t3697 / 0.12e2);
  tv4rho3sigma6 = t6 * t3994 + t1985 + t3930;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t4000 = t5 * t1515 * t366;
  t4007 = t5 * t610 * t975;
  t4015 = t5 * t222 * t2132;
  t4017 = -0.3e1 / 0.8e1 * t5 * t1511 * t366 - t4000 / 0.8e1 - t3963 + t3965 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t606 * t975 - t4007 / 0.4e1 + t3922 / 0.12e2 - t3926 - t3974 + t3976 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t218 * t2132 - t4015 / 0.8e1;
  t4018 = my_piecewise3(t85, 0, t4017);
  tv4rho3sigma8 = t6 * t4018 + t2137 + t3957;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t4027 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1552 * t336 - 0.3e1 / 0.8e1 * t3985 + t3941 / 0.4e1 - t3695);
  tv4rho3sigma9 = t6 * t4027 + 0.3e1 * t1985;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t4044 = t2009 * t1673;
  t4048 = t1209 * t1592 * t2015;
  t4051 = t2009 * t1663;
  t4055 = t1228 * t1592 * t667;
  t4060 = t154 * t1631;
  t4064 = t165 * t37 * t1630;
  t4093 = -0.19e2 / 0.54e2 * t1234 * t4044 - 0.19e2 / 0.324e3 * t1207 * t4048 + 0.19e2 / 0.54e2 * t1219 * t4051 - 0.19e2 / 0.54e2 * t1702 * t4055 + 0.19e2 / 0.27e2 * t1706 * t4055 - 0.154e3 / 0.81e2 * t323 * t4060 - 0.154e3 / 0.81e2 * t341 * t4064 - 0.19e2 / 0.54e2 * t1694 * t4055 - 0.77e3 / 0.81e2 * t277 * t4064 - 0.308e3 / 0.81e2 * t285 * t4060 - 0.154e3 / 0.27e2 * t291 * t4060 - 0.616e3 / 0.81e2 * t295 * t4060 - 0.77e3 / 0.81e2 * t299 * t4060 + 0.19e2 / 0.9e1 * t1600 * t4055 - 0.19e2 / 0.18e2 * t1603 * t4055 - 0.38e2 / 0.27e2 * t1610 * t4055 + 0.38e2 / 0.9e1 * t1613 * t4055 - 0.38e2 / 0.27e2 * t1616 * t4055 - 0.38e2 / 0.27e2 * t1671 * t4044 + 0.19e2 / 0.9e1 * t1677 * t4051;
  t4106 = sigma[2] * t1640;
  t4107 = t419 * t4106;
  t4116 = t418 * t1640;
  t4137 = 0.1e1 / t98 / t1590 / t1037;
  t4140 = t1589 * t30 * t35;
  t4141 = t4137 * t687 * t4140;
  t4144 = t4137 * t1589;
  t4145 = t4144 * t3388;
  t4148 = -0.19e2 / 0.81e2 * t1680 * t4048 - 0.95e2 / 0.27e2 * t1684 * t4044 + 0.95e2 / 0.27e2 * t1687 * t4051 - 0.95e2 / 0.324e3 * t1690 * t4048 + 0.19e2 / 0.18e2 * t1662 * t4051 - 0.19e2 / 0.108e3 * t1667 * t4048 - 0.341e3 / 0.486e3 * t679 * t4107 - 0.308e3 / 0.81e2 * t263 * t4064 - 0.154e3 / 0.27e2 * t269 * t4064 - 0.616e3 / 0.81e2 * t273 * t4064 + 0.341e3 / 0.972e3 * t437 * t4116 * t945 + 0.341e3 / 0.486e3 * t666 * t4107 - 0.19e2 / 0.27e2 * t1588 * t4055 - 0.95e2 / 0.27e2 * t1620 * t4055 + 0.19e3 / 0.27e2 * t1623 * t4055 - 0.95e2 / 0.54e2 * t1626 * t4055 - 0.341e3 / 0.486e3 * t444 * t949 * t1641 - 0.19e2 / 0.162e3 * t1656 * t4048 - 0.7e1 / 0.486e3 * t3392 * t4141 + t3398 * t4145 / 0.972e3;
  t4151 = t2664 * t4137 * t4140;
  t4158 = t4137 * t3415;
  t4163 = t4137 * t1672 * t4140;
  t4193 = t436 * t4116 * sigma[2];
  t4198 = 0.4e1 / 0.243e3 * t3426 * t4151 - 0.2e1 / 0.27e2 * t3435 * t4151 + t3410 * t4145 / 0.729e3 - 0.1e2 / 0.243e3 * t3414 * t4158 * t4140 + 0.1e2 / 0.81e2 * t3421 * t4163 - 0.35e2 / 0.729e3 * t3472 * t4141 + 0.5e1 / 0.2916e4 * t3475 * t4145 + 0.8e1 / 0.81e2 * t3445 * t4151 - 0.4e1 / 0.27e2 * t3448 * t4151 + 0.8e1 / 0.243e3 * t3451 * t4151 + 0.4e1 / 0.81e2 * t3401 * t4163 - 0.7e1 / 0.243e3 * t3407 * t4141 + 0.2e1 / 0.81e2 * t3438 * t4151 - 0.1e2 / 0.243e3 * t3460 * t4151 + 0.2e2 / 0.81e2 * t3463 * t4151 - 0.2e2 / 0.81e2 * t3466 * t4151 + 0.1e2 / 0.243e3 * t3469 * t4151 + t3382 * t4145 / 0.1458e4 - 0.341e3 / 0.81e2 * t738 * t4193 + 0.682e3 / 0.243e3 * t741 * t4193;
  t4204 = t419 * t4106 * t116;
  t4208 = t419 * t1641 * sigma[2];
  t4248 = -0.1705e4 / 0.243e3 * t745 * t4193 + 0.1705e4 / 0.486e3 * t748 * t4193 + 0.341e3 / 0.486e3 * t751 * t4204 - 0.341e3 / 0.162e3 * t757 * t4208 + 0.341e3 / 0.324e3 * t762 * t4204 + 0.2e1 / 0.243e3 * t3560 * t4151 - 0.2e1 / 0.81e2 * t3546 * t4151 + 0.2e1 / 0.81e2 * t3554 * t4151 + t2717 * t4163 / 0.81e2 - 0.1705e4 / 0.243e3 * t773 * t4208 + 0.1705e4 / 0.972e3 * t776 * t4204 + t2698 * t4145 / 0.2916e4 - 0.7e1 / 0.1458e4 * t2704 * t4141 + 0.341e3 / 0.243e3 * t769 * t4204 - 0.341e3 / 0.81e2 * t766 * t4208 - 0.2e1 / 0.243e3 * t3535 * t2665 * t4144 * t1206 - 0.2e1 / 0.243e3 * t2676 * t2664 * t1589 * t4158 * t1206 + 0.341e3 / 0.243e3 * t724 * t4193 - 0.341e3 / 0.162e3 * t731 * t4193 + 0.341e3 / 0.162e3 * t734 * t4193;
  t4255 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t1572 * t366 - 0.3e1 / 0.8e1 * t4000 - 0.9e1 / 0.8e1 * t5 * t654 * t975 + t3965 / 0.4e1 - 0.3e1 / 0.4e1 * t4007 - 0.9e1 / 0.8e1 * t5 * t246 * t2132 - t3926 + t3976 / 0.4e1 - 0.3e1 / 0.8e1 * t4015 - 0.3e1 / 0.8e1 * t5 * t94 * (t4093 + t4148 + t4198 + t4248));
  tv4rho3sigma11 = t6 * t4255 + 0.3e1 * t2137;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t4262 = t5 * t392 * t1031;
  t4269 = t5 * t401 * t1031 / 0.12e2;
  t4271 = t5 * t146 * t2250;
  t4274 = t1228 * sigma[0] * t1795;
  t4277 = t1796 * t802;
  t4280 = t1796 * t2154;
  t4284 = t2158 * t1795 * t1235;
  t4291 = t436 * t1882;
  t4296 = t419 * t439;
  t4299 = t419 * t446;
  t4316 = 0.43e2 / 0.432e3 * t1227 * t4274 + 0.43e2 / 0.2592e4 * t1207 * t4277 - 0.43e2 / 0.432e3 * t1219 * t4280 + 0.43e2 / 0.432e3 * t1234 * t4284 + 0.43e2 / 0.432e3 * t1243 * t4274 - 0.43e2 / 0.216e3 * t1249 * t4274 - 0.19e2 / 0.162e3 * t982 * t4291 + 0.19e2 / 0.162e3 * t990 * t4291 - 0.19e2 / 0.324e3 * t1007 * t4296 + 0.19e2 / 0.162e3 * t1012 * t4299 + 0.95e2 / 0.81e2 * t511 * t4299 - 0.95e2 / 0.162e3 * t485 * t4291 - 0.95e2 / 0.324e3 * t514 * t4296 - 0.19e2 / 0.108e3 * t500 * t4296 + 0.19e2 / 0.54e2 * t468 * t4291 - 0.38e2 / 0.81e2 * t478 * t4291 + 0.95e2 / 0.81e2 * t482 * t4291;
  t4353 = -0.19e2 / 0.81e2 * t461 * t4291 - 0.19e2 / 0.162e3 * t488 * t4296 + 0.19e2 / 0.54e2 * t495 * t4299 - 0.19e2 / 0.54e2 * t471 * t4291 + 0.19e2 / 0.27e2 * t475 * t4291 + 0.19e2 / 0.27e2 * t504 * t4299 - 0.19e2 / 0.81e2 * t507 * t4296 + 0.43e2 / 0.108e3 * t1263 * t4284 - 0.43e2 / 0.72e2 * t1266 * t4280 + 0.43e2 / 0.648e3 * t1269 * t4277 + 0.215e3 / 0.216e3 * t1273 * t4284 - 0.215e3 / 0.108e3 * t1309 * t4274 + 0.215e3 / 0.432e3 * t1312 * t4274 + 0.43e2 / 0.1296e4 * t1253 * t4277 - 0.43e2 / 0.72e2 * t1287 * t4274 + 0.43e2 / 0.144e3 * t1291 * t4274 - 0.215e3 / 0.216e3 * t1276 * t4280 + 0.215e3 / 0.2592e4 * t1279 * t4277;
  t4370 = 0.1e1 / t41 / t2591;
  t4371 = t4370 * t420;
  t4372 = t4371 * t2699;
  t4377 = t420 * t30 * t35;
  t4378 = t4370 * t445 * t4377;
  t4384 = t4370 * t1235 * t4377;
  t4392 = t2664 * t4370 * t4377;
  t4396 = t4370 * t2678;
  t4405 = -0.43e2 / 0.144e3 * t1256 * t4280 + 0.43e2 / 0.864e3 * t1259 * t4277 + 0.43e2 / 0.108e3 * t1296 * t4274 - 0.43e2 / 0.36e2 * t1299 * t4274 + 0.43e2 / 0.108e3 * t1302 * t4274 + 0.215e3 / 0.216e3 * t1306 * t4274 + 0.43e2 / 0.216e3 * t1283 * t4274 - t2867 * t4372 / 0.3888e4 + 0.7e1 / 0.1296e4 * t2870 * t4378 - t2836 * t4372 / 0.2592e4 - t2839 * t4384 / 0.54e2 + 0.7e1 / 0.648e3 * t2842 * t4378 - t2717 * t4384 / 0.216e3 - t2686 * t4392 / 0.324e3 + t2676 * t2664 * t420 * t4396 * t1206 / 0.324e3 + t2693 * t4392 / 0.108e3 - t2713 * t4392 / 0.108e3;
  t4445 = -t2698 * t4372 / 0.7776e4 + 0.7e1 / 0.3888e4 * t2704 * t4378 + t2662 * t2665 * t4371 * t1206 / 0.324e3 - 0.5e1 / 0.54e2 * t2829 * t4392 - t2845 * t4372 / 0.1944e4 + 0.5e1 / 0.324e3 * t2849 * t4396 * t4377 - 0.5e1 / 0.108e3 * t2855 * t4384 + 0.35e2 / 0.1944e4 * t2858 * t4378 - 0.5e1 / 0.7776e4 * t2861 * t4372 + 0.5e1 / 0.54e2 * t2832 * t4392 - 0.5e1 / 0.324e3 * t2801 * t4392 - t2864 * t4392 / 0.162e3 + t2806 * t4392 / 0.36e2 - t2809 * t4392 / 0.108e3 - t2814 * t4392 / 0.27e2 + t2817 * t4392 / 0.18e2 - t2820 * t4392 / 0.81e2 + 0.5e1 / 0.324e3 * t2826 * t4392;
  t4452 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t388 * t1031 - t4262 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t2250 + t4269 - t4271 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t4316 + t4353 + t4405 + t4445));
  tv4rho2sigma20 = t6 * t4452 + 0.2e1 * t2255;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t4459 = t5 * t561 * t1083;
  t4463 = t5 * t565 * t1083 / 0.12e2;
  t4465 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t557 * t1083 - t4459 / 0.4e1 + t4463);
  tv4rho2sigma25 = t6 * t4465 + 0.2e1 * t2264;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t4471 = t5 * t586 * t1031;
  t4479 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t582 * t1031 - t4471 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t235 * t2250 - t4262 / 0.8e1 + t4269 - t4271 / 0.8e1);
  tv4rho2sigma26 = t6 * t4479 + t2255 + t2270;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t4485 = t5 * t610 * t1083;
  t4492 = t5 * t222 * t2380;
  t4495 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t606 * t1083 - t4485 / 0.8e1 - t4459 / 0.8e1 + t4463 - 0.3e1 / 0.8e1 * t5 * t218 * t2380 - t4492 / 0.8e1);
  tv4rho2sigma211 = t6 * t4495 + t2264 + t2385;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t4503 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t637 * t1031 - t4471 / 0.4e1 + t4269);
  tv4rho2sigma212 = t6 * t4503 + 0.2e1 * t2270;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t4515 = 0.1e1 / t98 / t3360;
  t4518 = t667 * t30 * t35;
  t4519 = t2664 * t4515 * t4518;
  t4526 = t4515 * t667;
  t4527 = t4526 * t3388;
  t4531 = t4515 * t687 * t4518;
  t4534 = t4526 * t3403;
  t4542 = t4515 * t3415;
  t4566 = -t3560 * t4519 / 0.324e3 + t3546 * t4519 / 0.108e3 - t3554 * t4519 / 0.108e3 - t2698 * t4527 / 0.7776e4 + 0.7e1 / 0.3888e4 * t2704 * t4531 - t2717 * t4534 / 0.216e3 + t3535 * t2665 * t4526 * t1206 / 0.324e3 + t2676 * t2664 * t667 * t4542 * t1206 / 0.324e3 - t3398 * t4527 / 0.2592e4 - t3401 * t4534 / 0.54e2 + 0.7e1 / 0.648e3 * t3407 * t4531 - t3410 * t4527 / 0.1944e4 + 0.5e1 / 0.324e3 * t3414 * t4542 * t4518 - 0.5e1 / 0.108e3 * t3421 * t4534 + 0.35e2 / 0.1944e4 * t3472 * t4531 - 0.5e1 / 0.7776e4 * t3475 * t4527 - t3382 * t4527 / 0.3888e4;
  t4590 = t1228 * t2004 * sigma[2];
  t4595 = t2014 * t945;
  t4598 = t2014 * t2301;
  t4601 = t2305 * t2010;
  t4606 = t436 * t2027;
  t4609 = 0.7e1 / 0.1296e4 * t3392 * t4531 + t3435 * t4519 / 0.36e2 - t3438 * t4519 / 0.108e3 - t3445 * t4519 / 0.27e2 + t3448 * t4519 / 0.18e2 - t3451 * t4519 / 0.81e2 + 0.5e1 / 0.324e3 * t3460 * t4519 - 0.5e1 / 0.54e2 * t3463 * t4519 + 0.5e1 / 0.54e2 * t3466 * t4519 - 0.5e1 / 0.324e3 * t3469 * t4519 - t3426 * t4519 / 0.162e3 - 0.43e2 / 0.216e3 * t1706 * t4590 + 0.43e2 / 0.432e3 * t1694 * t4590 + 0.43e2 / 0.2592e4 * t1207 * t4595 - 0.43e2 / 0.432e3 * t1219 * t4598 + 0.43e2 / 0.432e3 * t1234 * t4601 + 0.43e2 / 0.432e3 * t1702 * t4590 - 0.19e2 / 0.162e3 * t1036 * t4606;
  t4613 = t419 * t683;
  t4616 = t419 * t688;
  t4647 = 0.19e2 / 0.162e3 * t1044 * t4606 - 0.19e2 / 0.324e3 * t1007 * t4613 + 0.19e2 / 0.162e3 * t1012 * t4616 - 0.43e2 / 0.72e2 * t1677 * t4598 + 0.215e3 / 0.216e3 * t1620 * t4590 - 0.215e3 / 0.108e3 * t1623 * t4590 + 0.215e3 / 0.432e3 * t1626 * t4590 + 0.43e2 / 0.216e3 * t1588 * t4590 - 0.43e2 / 0.72e2 * t1600 * t4590 + 0.43e2 / 0.144e3 * t1603 * t4590 + 0.43e2 / 0.648e3 * t1680 * t4595 + 0.215e3 / 0.216e3 * t1684 * t4601 - 0.215e3 / 0.216e3 * t1687 * t4598 + 0.215e3 / 0.2592e4 * t1690 * t4595 + 0.43e2 / 0.1296e4 * t1656 * t4595 - 0.43e2 / 0.144e3 * t1662 * t4598 + 0.43e2 / 0.864e3 * t1667 * t4595;
  t4684 = 0.43e2 / 0.108e3 * t1610 * t4590 + 0.43e2 / 0.108e3 * t1671 * t4601 + 0.19e2 / 0.54e2 * t731 * t4606 - 0.19e2 / 0.54e2 * t734 * t4606 - 0.38e2 / 0.81e2 * t741 * t4606 + 0.95e2 / 0.81e2 * t745 * t4606 - 0.95e2 / 0.162e3 * t748 * t4606 - 0.19e2 / 0.81e2 * t724 * t4606 - 0.19e2 / 0.162e3 * t751 * t4613 + 0.19e2 / 0.54e2 * t757 * t4616 - 0.19e2 / 0.108e3 * t762 * t4613 + 0.19e2 / 0.27e2 * t738 * t4606 + 0.19e2 / 0.27e2 * t766 * t4616 - 0.19e2 / 0.81e2 * t769 * t4613 + 0.95e2 / 0.81e2 * t773 * t4616 - 0.95e2 / 0.324e3 * t776 * t4613 - 0.43e2 / 0.36e2 * t1613 * t4590 + 0.43e2 / 0.108e3 * t1616 * t4590;
  t4691 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t654 * t1083 - t4485 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t246 * t2380 + t4463 - t4492 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t94 * (t4566 + t4609 + t4647 + t4684));
  tv4rho2sigma217 = t6 * t4691 + 0.2e1 * t2385;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t4698 = t5 * t146 * t2468 / 0.8e1;
  t4700 = 0.1e1 / t41 / t1212;
  t4702 = t165 * sigma[0];
  t4703 = t2664 * t4700 * t4702;
  t4711 = t4700 * t30 * t35 * sigma[0] * t65;
  t4719 = t2703 * t165;
  t4720 = t2664 * sigma[0];
  t4721 = t4700 * t445;
  t4726 = t2716 * t165;
  t4727 = t4700 * t1235;
  t4732 = t4700 * t2678;
  t4749 = -t2693 * t4703 / 0.288e3 + t2713 * t4703 / 0.288e3 + t2698 * t4711 / 0.20736e5 - t2662 * t2665 * sigma[0] * t4700 * t1206 / 0.864e3 - 0.7e1 / 0.10368e5 * t4719 * t4720 * t4721 * t1206 + t4726 * t4720 * t4727 * t1206 / 0.576e3 - t2676 * t4720 * t4732 * t1206 / 0.864e3 + t2686 * t4703 / 0.864e3 + t2864 * t4703 / 0.432e3 - t2806 * t4703 / 0.96e2 + t2814 * t4703 / 0.72e2 - t2817 * t4703 / 0.48e2 + t2820 * t4703 / 0.216e3;
  t4760 = t4721 * t4702;
  t4765 = t4727 * t4702;
  t4779 = -0.5e1 / 0.864e3 * t2826 * t4703 + 0.5e1 / 0.144e3 * t2829 * t4703 - 0.5e1 / 0.144e3 * t2832 * t4703 + 0.5e1 / 0.864e3 * t2801 * t4703 + t2867 * t4711 / 0.10368e5 - 0.7e1 / 0.3456e4 * t2870 * t4760 + t2836 * t4711 / 0.6912e4 + t2839 * t4765 / 0.144e3 - 0.7e1 / 0.1728e4 * t2842 * t4760 + t2845 * t4711 / 0.5184e4 - 0.5e1 / 0.864e3 * t2849 * t4732 * t4702 + 0.5e1 / 0.288e3 * t2855 * t4765 - 0.35e2 / 0.5184e4 * t2858 * t4760;
  t4786 = t1228 * t2149 * t65;
  t4789 = t1228 * t2159;
  t4793 = t1228 * t2149 * t445;
  t4796 = t1252 * t2150;
  t4813 = 0.5e1 / 0.20736e5 * t2861 * t4711 + t2809 * t4703 / 0.288e3 - t2398 * t4786 / 0.96e2 - t2401 * t4789 / 0.12e2 + t2406 * t4793 / 0.8e1 - 0.5e1 / 0.24e2 * t2458 * t4796 + 0.5e1 / 0.12e2 * t2461 * t4796 - 0.5e1 / 0.48e2 * t2464 * t4796 - t2439 * t4796 / 0.24e2 + t2443 * t4796 / 0.8e1 - t2446 * t4796 / 0.16e2 - t2449 * t4796 / 0.12e2 + t2452 * t4796 / 0.4e1;
  t4828 = t1228 * t2149;
  t4844 = -t2409 * t4786 / 0.72e2 - 0.5e1 / 0.24e2 * t2412 * t4789 + 0.5e1 / 0.24e2 * t2415 * t4793 - 0.5e1 / 0.288e3 * t2418 * t4786 - t2387 * t4786 / 0.144e3 + t2393 * t4793 / 0.16e2 - t2455 * t4796 / 0.12e2 - t1243 * t4828 / 0.48e2 + t1249 * t4828 / 0.24e2 - t1227 * t4828 / 0.48e2 - t1207 * t2150 * t65 / 0.288e3 + t1219 * t2150 * t445 / 0.48e2 - t1234 * t2150 * t1235 / 0.48e2;
  t4851 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t2468 - t4698 - 0.3e1 / 0.8e1 * t5 * t27 * (t4749 + t4779 + t4813 + t4844));
  tv4rhosigma30 = t6 * t4851 + t2472;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t4858 = t5 * t222 * t2554 / 0.8e1;
  t4860 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t218 * t2554 - t4858);
  tv4rhosigma39 = t6 * t4860 + t2558;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t4866 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t235 * t2468 - t4698);
  tv4rhosigma310 = t6 * t4866 + t2472;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t4872 = 0.1e1 / t98 / t1591;
  t4874 = t165 * sigma[2];
  t4875 = t4872 * t687 * t4874;
  t4879 = t4872 * t1672 * t4874;
  t4883 = t2664 * t4872 * t4874;
  t4894 = t4872 * t3415;
  t4904 = t4872 * t30 * t35 * sigma[2] * t116;
  t4917 = -0.7e1 / 0.10368e5 * t2704 * t4875 + t2717 * t4879 / 0.576e3 + t3560 * t4883 / 0.864e3 - t3546 * t4883 / 0.288e3 - t3535 * t2665 * sigma[2] * t4872 * t1206 / 0.864e3 - t2676 * t2664 * sigma[2] * t4894 * t1206 / 0.864e3 + t3554 * t4883 / 0.288e3 + t2698 * t4904 / 0.20736e5 + 0.5e1 / 0.20736e5 * t3475 * t4904 + t3426 * t4883 / 0.432e3 - t3435 * t4883 / 0.96e2 + t3438 * t4883 / 0.288e3 + t3445 * t4883 / 0.72e2;
  t4945 = -t3448 * t4883 / 0.48e2 + t3451 * t4883 / 0.216e3 - 0.5e1 / 0.864e3 * t3460 * t4883 + 0.5e1 / 0.144e3 * t3463 * t4883 - 0.5e1 / 0.144e3 * t3466 * t4883 + 0.5e1 / 0.864e3 * t3469 * t4883 + t3382 * t4904 / 0.10368e5 - 0.7e1 / 0.3456e4 * t3392 * t4875 + t3398 * t4904 / 0.6912e4 + t3401 * t4879 / 0.144e3 - 0.7e1 / 0.1728e4 * t3407 * t4875 + t3410 * t4904 / 0.5184e4 - 0.5e1 / 0.864e3 * t3414 * t4894 * t4874;
  t4952 = t1228 * t2288 * t116;
  t4955 = t1228 * t2306;
  t4959 = t1228 * t2288 * t687;
  t4964 = t1252 * t2297;
  t4979 = 0.5e1 / 0.288e3 * t3421 * t4879 - 0.35e2 / 0.5184e4 * t3472 * t4875 - t2524 * t4952 / 0.96e2 - t2527 * t4955 / 0.12e2 + t2532 * t4959 / 0.8e1 - t2535 * t4952 / 0.72e2 - t2501 * t4964 / 0.12e2 - 0.5e1 / 0.24e2 * t2504 * t4964 + 0.5e1 / 0.12e2 * t2507 * t4964 - 0.5e1 / 0.48e2 * t2511 * t4964 - t2514 * t4952 / 0.144e3 - t2491 * t4964 / 0.16e2 - t2495 * t4964 / 0.12e2;
  t4997 = t1228 * t2288;
  t5010 = t2498 * t4964 / 0.4e1 - 0.5e1 / 0.24e2 * t2538 * t4955 + 0.5e1 / 0.24e2 * t2541 * t4959 - 0.5e1 / 0.288e3 * t2544 * t4952 - t2547 * t4964 / 0.24e2 + t2550 * t4964 / 0.8e1 + t2519 * t4959 / 0.16e2 - t1234 * t2297 * t1672 / 0.48e2 - t1702 * t4997 / 0.48e2 + t1706 * t4997 / 0.24e2 - t1694 * t4997 / 0.48e2 - t1207 * t2297 * t116 / 0.288e3 + t1219 * t2297 * t687 / 0.48e2;
  t5017 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t246 * t2554 - t4858 - 0.3e1 / 0.8e1 * t5 * t94 * (t4917 + t4945 + t4979 + t5010));
  tv4rhosigma319 = t6 * t5017 + t2558;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t5021 = 0.1e1 / t41 / t1794;
  t5022 = t5021 * t30;
  t5024 = t2697 * t5022 * t35;
  t5040 = t2664 * t5021;
  t5045 = t5040 * t2719;
  t5049 = t5040 * t2706;
  t5053 = t5040 * t2699;
  t5072 = -t174 * t2799 * t5024 / 0.576e3 + 0.5e1 / 0.2304e4 * t2823 * t2824 * t5024 - 0.5e1 / 0.384e3 * t1305 * t2812 * t5024 + 0.5e1 / 0.384e3 * t481 * t2804 * t5024 - 0.5e1 / 0.2304e4 * t178 * t2799 * t5024 + 0.5e1 / 0.2304e4 * t2848 * t2685 * t5040 * t2851 - 0.5e1 / 0.768e3 * t1272 * t2685 * t5045 + 0.35e2 / 0.13824e5 * t510 * t2685 * t5049 - 0.5e1 / 0.55296e5 * t202 * t2685 * t5053 - t162 * t2799 * t5024 / 0.1152e4 + t466 * t2804 * t5024 / 0.256e3 - t170 * t2799 * t5024 / 0.768e3 - t1294 * t2812 * t5024 / 0.192e3 + t2662 * t2665 * t5021 * t1206 / 0.2304e4;
  t5073 = t5040 * t165;
  t5117 = -t2686 * t5073 / 0.2304e4 + t2693 * t5073 / 0.768e3 - t2713 * t5073 / 0.768e3 - t2698 * t5022 * t35 * t65 / 0.55296e5 + 0.7e1 / 0.27648e5 * t4719 * t5040 * t445 * t1206 - t4726 * t5040 * t1235 * t1206 / 0.1536e4 + t2676 * t5040 * t2678 * t1206 / 0.2304e4 + t474 * t2804 * t5024 / 0.128e3 - t188 * t2685 * t5053 / 0.27648e5 + 0.7e1 / 0.9216e4 * t494 * t2685 * t5049 - t194 * t2685 * t5053 / 0.18432e5 - t1262 * t2685 * t5045 / 0.384e3 + 0.7e1 / 0.4608e4 * t503 * t2685 * t5049 - t198 * t2685 * t5053 / 0.13824e5;
  t5122 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (t5072 + t5117));
  tv4sigma40 = t6 * t5122;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t5124 = 0.1e1 / t98 / t2003;
  t5125 = t2664 * t5124;
  t5126 = t5125 * t165;
  t5141 = t5124 * t30;
  t5155 = t5125 * t3403;
  t5159 = t5125 * t3394;
  t5163 = t5125 * t3388;
  t5176 = -t3560 * t5126 / 0.2304e4 + t3546 * t5126 / 0.768e3 + t3535 * t2665 * t5124 * t1206 / 0.2304e4 + t2676 * t5125 * t3415 * t1206 / 0.2304e4 - t3554 * t5126 / 0.768e3 - t2698 * t5141 * t35 * t116 / 0.55296e5 + 0.7e1 / 0.27648e5 * t2704 * t5124 * t687 * t165 - t2717 * t5124 * t1672 * t165 / 0.1536e4 - t1670 * t2685 * t5155 / 0.384e3 + 0.7e1 / 0.4608e4 * t765 * t2685 * t5159 - t294 * t2685 * t5163 / 0.13824e5 + 0.5e1 / 0.2304e4 * t3413 * t2685 * t5125 * t3417 - 0.5e1 / 0.768e3 * t1683 * t2685 * t5155 + 0.35e2 / 0.13824e5 * t772 * t2685 * t5159;
  t5182 = t2697 * t5141 * t35;
  t5221 = -0.5e1 / 0.55296e5 * t298 * t2685 * t5163 - t261 * t3424 * t5182 / 0.1152e4 + t737 * t3433 * t5182 / 0.128e3 - t272 * t3424 * t5182 / 0.576e3 + 0.5e1 / 0.2304e4 * t3455 * t3458 * t5182 - 0.5e1 / 0.384e3 * t1619 * t3443 * t5182 + 0.5e1 / 0.384e3 * t744 * t3433 * t5182 - 0.5e1 / 0.2304e4 * t276 * t3424 * t5182 - t284 * t2685 * t5163 / 0.27648e5 + 0.7e1 / 0.9216e4 * t756 * t2685 * t5159 - t290 * t2685 * t5163 / 0.18432e5 + t729 * t3433 * t5182 / 0.256e3 - t268 * t3424 * t5182 / 0.768e3 - t1606 * t3443 * t5182 / 0.192e3;
  t5226 = my_piecewise3(t85, 0, -0.3e1 / 0.8e1 * t5 * t94 * (t5176 + t5221));
  tv4sigma414 = t6 * t5226;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

