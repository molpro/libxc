/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_ncap.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t42, t46, t51, t52, t53, t55, t56, t57;
  double t59, t63, tzk0;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t33 = t25 * t31 / 0.12e2;
  t34 = tanh(t33);
  t35 = params->mu * t34;
  t36 = log(t33 + sqrt(t33 * t33 + 0.1e1));
  t37 = 0.1e1 - params->zeta;
  t39 = t37 * t21 * t24;
  t40 = 0.1e1 + t33;
  t41 = log(t40);
  t42 = t30 * t41;
  t46 = params->zeta * t21 * t24;
  t51 = 0.1e1 + params->alpha * (t39 * t28 * t42 / 0.12e2 + t46 * t31 / 0.12e2);
  t52 = t36 * t51;
  t53 = params->beta * t34;
  t55 = t53 * t36 + 0.1e1;
  t56 = 0.1e1 / t55;
  t57 = t52 * t56;
  t59 = t35 * t57 + 0.1e1;
  t63 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t59);
  tzk0 = 0.2e1 * t63;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t42, t46, t51, t52, t53, t55, t56, t57;
  double t59, t63, tzk0;

  double t64, t66, t70, t71, t72, t73, t74, t76;
  double t77, t78, t79, t80, t84, t85, t86, t87;
  double t88, t89, t90, t92, t96, t97, t98, t100;
  double t101, t104, t105, t110, t111, t113, t114, t115;
  double t119, t122, t123, t124, t126, t127, t128, t129;
  double t130, t131, t132, t135, t136, t140, t141, t143;
  double t148, tvrho0, t151, t152, t153, t154, t155, t156;
  double t160, t161, t162, t165, t169, t173, t176, t177;
  double t178, t180, t181, t184, t188, t189, t191, t195;
  double tvsigma0;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t33 = t25 * t31 / 0.12e2;
  t34 = tanh(t33);
  t35 = params->mu * t34;
  t36 = log(t33 + sqrt(t33 * t33 + 0.1e1));
  t37 = 0.1e1 - params->zeta;
  t39 = t37 * t21 * t24;
  t40 = 0.1e1 + t33;
  t41 = log(t40);
  t42 = t30 * t41;
  t46 = params->zeta * t21 * t24;
  t51 = 0.1e1 + params->alpha * (t39 * t28 * t42 / 0.12e2 + t46 * t31 / 0.12e2);
  t52 = t36 * t51;
  t53 = params->beta * t34;
  t55 = t53 * t36 + 0.1e1;
  t56 = 0.1e1 / t55;
  t57 = t52 * t56;
  t59 = t35 * t57 + 0.1e1;
  t63 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t59);
  tzk0 = 0.2e1 * t63;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t64 = t18 * t18;
  t66 = t17 / t64;
  t70 = params->mu * t21;
  t71 = t24 * t26;
  t72 = t71 * t27;
  t73 = t70 * t72;
  t74 = rho[0] * rho[0];
  t76 = 0.1e1 / t18 / t74;
  t77 = t34 * t34;
  t78 = 0.1e1 - t77;
  t79 = t76 * t78;
  t80 = t79 * t57;
  t84 = t35 * t25 * t26;
  t85 = t27 * t76;
  t86 = t23 * t23;
  t87 = 0.1e1 / t86;
  t88 = t20 * t87;
  t89 = t27 * t27;
  t90 = sigma[0] * t89;
  t92 = 0.1e1 / t64 / t74;
  t96 = 0.6e1 * t88 * t90 * t92 + 0.144e3;
  t97 = sqrt(t96);
  t98 = 0.1e1 / t97;
  t100 = t98 * t51 * t56;
  t101 = t85 * t100;
  t104 = t35 * t36;
  t105 = t76 * t41;
  t110 = t37 * t20 * t87;
  t111 = t74 * rho[0];
  t113 = 0.1e1 / t64 / t111;
  t114 = 0.1e1 / t40;
  t115 = t113 * t114;
  t119 = t28 * t76;
  t122 = -t39 * t28 * t105 / 0.9e1 - t110 * t90 * t115 / 0.18e2 - t46 * t119 / 0.9e1;
  t123 = params->alpha * t122;
  t124 = t123 * t56;
  t126 = t55 * t55;
  t127 = 0.1e1 / t126;
  t128 = t51 * t127;
  t129 = params->beta * t21;
  t130 = t129 * t71;
  t131 = t78 * t36;
  t132 = t85 * t131;
  t135 = t53 * t25;
  t136 = t76 * t98;
  t140 = -t130 * t132 / 0.9e1 - 0.4e1 / 0.3e1 * t135 * t28 * t136;
  t141 = t128 * t140;
  t143 = -t73 * t80 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t101 + t104 * t124 - t104 * t141;
  t148 = my_piecewise3(t2, 0, -t6 * t66 * t59 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t143);
  tvrho0 = 0.2e1 * rho[0] * t148 + 0.2e1 * t63;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t151 = 0.1e1 / t26;
  t152 = t24 * t151;
  t153 = t152 * t27;
  t154 = t70 * t153;
  t155 = t30 * t78;
  t156 = t155 * t57;
  t160 = t35 * t25 * t151;
  t161 = t27 * t30;
  t162 = t161 * t100;
  t165 = t151 * t27;
  t169 = t89 * t92;
  t173 = t165 * t30;
  t176 = t39 * t165 * t42 / 0.24e2 + t110 * t169 * t114 / 0.48e2 + t46 * t173 / 0.24e2;
  t177 = params->alpha * t176;
  t178 = t177 * t56;
  t180 = t129 * t152;
  t181 = t161 * t131;
  t184 = t30 * t98;
  t188 = t180 * t181 / 0.24e2 + t135 * t165 * t184 / 0.2e1;
  t189 = t128 * t188;
  t191 = t154 * t156 / 0.24e2 + t160 * t162 / 0.2e1 + t104 * t178 - t104 * t189;
  t195 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t191);
  tvsigma0 = 0.2e1 * rho[0] * t195;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t42, t46, t51, t52, t53, t55, t56, t57;
  double t59, t63, tzk0;

  double t64, t66, t70, t71, t72, t73, t74, t76;
  double t77, t78, t79, t80, t84, t85, t86, t87;
  double t88, t89, t90, t92, t96, t97, t98, t100;
  double t101, t104, t105, t110, t111, t113, t114, t115;
  double t119, t122, t123, t124, t126, t127, t128, t129;
  double t130, t131, t132, t135, t136, t140, t141, t143;
  double t148, tvrho0, t151, t152, t153, t154, t155, t156;
  double t160, t161, t162, t165, t169, t173, t176, t177;
  double t178, t180, t181, t184, t188, t189, t191, t195;
  double tvsigma0;

  double t200, t208, t209, t210, t213, t214, t216, t217;
  double t219, t220, t222, t225, t226, t229, t230, t233;
  double t236, t237, t240, t241, t242, t243, t244, t245;
  double t247, t248, t249, t250, t253, t254, t257, t260;
  double t264, t268, t269, t270, t271, t275, t278, t279;
  double t280, t282, t283, t287, t288, t289, t290, t293;
  double t296, t297, t298, t299, t300, t301, t304, t305;
  double t308, t312, t316, t317, t319, t324, tv2rho20, t332;
  double t334, t335, t338, t339, t340, t343, t344, t347;
  double t352, t353, t354, t355, t356, t357, t360, t361;
  double t364, t367, t370, t376, t384, t387, t388, t389;
  double t391, t393, t396, t399, t400, t402, t403, t408;
  double t409, t413, t414, t424, t425, t427, t432, tv2rhosigma0;
  double t435, t436, t437, t438, t441, t442, t444, t447;
  double t450, t451, t454, t457, t461, t464, t465, t466;
  double t467, t468, t471, t473, t475, t479, t480, t488;
  double t491, t492, t493, t495, t498, t499, t502, t505;
  double t506, t509, t519, t520, t522, t526, tv2sigma20;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t33 = t25 * t31 / 0.12e2;
  t34 = tanh(t33);
  t35 = params->mu * t34;
  t36 = log(t33 + sqrt(t33 * t33 + 0.1e1));
  t37 = 0.1e1 - params->zeta;
  t39 = t37 * t21 * t24;
  t40 = 0.1e1 + t33;
  t41 = log(t40);
  t42 = t30 * t41;
  t46 = params->zeta * t21 * t24;
  t51 = 0.1e1 + params->alpha * (t39 * t28 * t42 / 0.12e2 + t46 * t31 / 0.12e2);
  t52 = t36 * t51;
  t53 = params->beta * t34;
  t55 = t53 * t36 + 0.1e1;
  t56 = 0.1e1 / t55;
  t57 = t52 * t56;
  t59 = t35 * t57 + 0.1e1;
  t63 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t59);
  tzk0 = 0.2e1 * t63;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t64 = t18 * t18;
  t66 = t17 / t64;
  t70 = params->mu * t21;
  t71 = t24 * t26;
  t72 = t71 * t27;
  t73 = t70 * t72;
  t74 = rho[0] * rho[0];
  t76 = 0.1e1 / t18 / t74;
  t77 = t34 * t34;
  t78 = 0.1e1 - t77;
  t79 = t76 * t78;
  t80 = t79 * t57;
  t84 = t35 * t25 * t26;
  t85 = t27 * t76;
  t86 = t23 * t23;
  t87 = 0.1e1 / t86;
  t88 = t20 * t87;
  t89 = t27 * t27;
  t90 = sigma[0] * t89;
  t92 = 0.1e1 / t64 / t74;
  t96 = 0.6e1 * t88 * t90 * t92 + 0.144e3;
  t97 = sqrt(t96);
  t98 = 0.1e1 / t97;
  t100 = t98 * t51 * t56;
  t101 = t85 * t100;
  t104 = t35 * t36;
  t105 = t76 * t41;
  t110 = t37 * t20 * t87;
  t111 = t74 * rho[0];
  t113 = 0.1e1 / t64 / t111;
  t114 = 0.1e1 / t40;
  t115 = t113 * t114;
  t119 = t28 * t76;
  t122 = -t39 * t28 * t105 / 0.9e1 - t110 * t90 * t115 / 0.18e2 - t46 * t119 / 0.9e1;
  t123 = params->alpha * t122;
  t124 = t123 * t56;
  t126 = t55 * t55;
  t127 = 0.1e1 / t126;
  t128 = t51 * t127;
  t129 = params->beta * t21;
  t130 = t129 * t71;
  t131 = t78 * t36;
  t132 = t85 * t131;
  t135 = t53 * t25;
  t136 = t76 * t98;
  t140 = -t130 * t132 / 0.9e1 - 0.4e1 / 0.3e1 * t135 * t28 * t136;
  t141 = t128 * t140;
  t143 = -t73 * t80 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t101 + t104 * t124 - t104 * t141;
  t148 = my_piecewise3(t2, 0, -t6 * t66 * t59 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t143);
  tvrho0 = 0.2e1 * rho[0] * t148 + 0.2e1 * t63;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t151 = 0.1e1 / t26;
  t152 = t24 * t151;
  t153 = t152 * t27;
  t154 = t70 * t153;
  t155 = t30 * t78;
  t156 = t155 * t57;
  t160 = t35 * t25 * t151;
  t161 = t27 * t30;
  t162 = t161 * t100;
  t165 = t151 * t27;
  t169 = t89 * t92;
  t173 = t165 * t30;
  t176 = t39 * t165 * t42 / 0.24e2 + t110 * t169 * t114 / 0.48e2 + t46 * t173 / 0.24e2;
  t177 = params->alpha * t176;
  t178 = t177 * t56;
  t180 = t129 * t152;
  t181 = t161 * t131;
  t184 = t30 * t98;
  t188 = t180 * t181 / 0.24e2 + t135 * t165 * t184 / 0.2e1;
  t189 = t128 * t188;
  t191 = t154 * t156 / 0.24e2 + t160 * t162 / 0.2e1 + t104 * t178 - t104 * t189;
  t195 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t191);
  tvsigma0 = 0.2e1 * rho[0] * t195;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t200 = t17 / t64 / rho[0];
  t208 = 0.1e1 / t18 / t111;
  t209 = t208 * t78;
  t210 = t209 * t57;
  t213 = params->mu * t20;
  t214 = t87 * sigma[0];
  t216 = t213 * t214 * t89;
  t217 = t74 * t74;
  t219 = 0.1e1 / t64 / t217;
  t220 = t219 * t34;
  t222 = t220 * t78 * t57;
  t225 = t219 * t78;
  t226 = t225 * t100;
  t229 = t79 * t36;
  t230 = t229 * t124;
  t233 = t229 * t141;
  t236 = t27 * t208;
  t237 = t236 * t100;
  t240 = 0.1e1 / t22;
  t241 = t26 * sigma[0];
  t242 = t240 * t241;
  t243 = t35 * t242;
  t244 = t217 * t74;
  t245 = 0.1e1 / t244;
  t247 = 0.1e1 / t97 / t96;
  t248 = t245 * t247;
  t249 = t51 * t56;
  t250 = t248 * t249;
  t253 = t85 * t98;
  t254 = t253 * t124;
  t257 = t253 * t141;
  t260 = t208 * t41;
  t264 = t219 * t114;
  t268 = t37 * t240;
  t269 = t241 * t245;
  t270 = t40 * t40;
  t271 = 0.1e1 / t270;
  t275 = t28 * t208;
  t278 = 0.7e1 / 0.27e2 * t39 * t28 * t260 + 0.5e1 / 0.18e2 * t110 * t90 * t264 - 0.2e1 / 0.27e2 * t268 * t269 * t271 + 0.7e1 / 0.27e2 * t46 * t275;
  t279 = params->alpha * t278;
  t280 = t279 * t56;
  t282 = t127 * t140;
  t283 = t123 * t282;
  t287 = 0.1e1 / t126 / t55;
  t288 = t51 * t287;
  t289 = t140 * t140;
  t290 = t288 * t289;
  t293 = t236 * t131;
  t296 = params->beta * t20;
  t297 = t296 * t214;
  t298 = t89 * t219;
  t299 = t34 * t78;
  t300 = t299 * t36;
  t301 = t298 * t300;
  t304 = t78 * t98;
  t305 = t298 * t304;
  t308 = t208 * t98;
  t312 = t53 * t240;
  t316 = 0.7e1 / 0.27e2 * t130 * t293 - 0.4e1 / 0.27e2 * t297 * t301 + 0.16e2 / 0.9e1 * t297 * t305 + 0.28e2 / 0.9e1 * t135 * t28 * t308 - 0.128e3 * t312 * t269 * t247;
  t317 = t128 * t316;
  t319 = 0.7e1 / 0.27e2 * t73 * t210 - 0.4e1 / 0.27e2 * t216 * t222 + 0.16e2 / 0.9e1 * t216 * t226 - 0.2e1 / 0.9e1 * t73 * t230 + 0.2e1 / 0.9e1 * t73 * t233 + 0.28e2 / 0.9e1 * t84 * t237 - 0.128e3 * t243 * t250 - 0.8e1 / 0.3e1 * t84 * t254 + 0.8e1 / 0.3e1 * t84 * t257 + t104 * t280 - 0.2e1 * t104 * t283 + 0.2e1 * t104 * t290 - t104 * t317;
  t324 = my_piecewise3(t2, 0, t6 * t200 * t59 / 0.12e2 - t6 * t66 * t143 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t319);
  tv2rho20 = 0.2e1 * rho[0] * t324 + 0.4e1 * t148;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t332 = t87 * t89;
  t334 = t213 * t332 * t113;
  t335 = t299 * t57;
  t338 = t213 * t332;
  t339 = t113 * t78;
  t340 = t339 * t100;
  t343 = t155 * t36;
  t344 = t343 * t124;
  t347 = t343 * t141;
  t352 = t240 * t26;
  t353 = t35 * t352;
  t354 = t217 * rho[0];
  t355 = 0.1e1 / t354;
  t356 = t355 * t247;
  t357 = t356 * t249;
  t360 = t161 * t98;
  t361 = t360 * t124;
  t364 = t360 * t141;
  t367 = t229 * t178;
  t370 = t253 * t178;
  t376 = t89 * t113;
  t384 = t165 * t76;
  t387 = -t39 * t165 * t105 / 0.18e2 - t110 * t376 * t114 / 0.12e2 + t268 * t355 * t271 * t26 / 0.36e2 - t46 * t384 / 0.18e2;
  t388 = params->alpha * t387;
  t389 = t388 * t56;
  t391 = t177 * t282;
  t393 = t229 * t189;
  t396 = t253 * t189;
  t399 = t127 * t188;
  t400 = t123 * t399;
  t402 = t188 * t140;
  t403 = t288 * t402;
  t408 = t296 * t332;
  t409 = t113 * t34;
  t413 = t296 * t87;
  t414 = t376 * t304;
  t424 = -t180 * t132 / 0.18e2 + t408 * t409 * t131 / 0.18e2 - 0.2e1 / 0.3e1 * t413 * t414 - 0.2e1 / 0.3e1 * t135 * t165 * t136 + 0.48e2 * t312 * t26 * t355 * t247;
  t425 = t128 * t424;
  t427 = -t154 * t80 / 0.18e2 + t334 * t335 / 0.18e2 - 0.2e1 / 0.3e1 * t338 * t340 + t154 * t344 / 0.24e2 - t154 * t347 / 0.24e2 - 0.2e1 / 0.3e1 * t160 * t101 + 0.48e2 * t353 * t357 + t160 * t361 / 0.2e1 - t160 * t364 / 0.2e1 - t73 * t367 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t370 + t104 * t389 - t104 * t391 + t73 * t393 / 0.9e1 + 0.4e1 / 0.3e1 * t84 * t396 - t104 * t400 + 0.2e1 * t104 * t403 - t104 * t425;
  t432 = my_piecewise3(t2, 0, -t6 * t66 * t191 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t427);
  tv2rhosigma0 = 0.2e1 * rho[0] * t432 + 0.2e1 * t195;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t435 = 0.1e1 / t241;
  t436 = t24 * t435;
  t437 = t436 * t27;
  t438 = t70 * t437;
  t441 = 0.1e1 / sigma[0];
  t442 = t87 * t441;
  t444 = t213 * t442 * t89;
  t447 = t92 * t34 * t78 * t57;
  t450 = t92 * t78;
  t451 = t450 * t100;
  t454 = t343 * t178;
  t457 = t343 * t189;
  t461 = t35 * t25 * t435;
  t464 = t240 * t151;
  t465 = t35 * t464;
  t466 = 0.1e1 / t217;
  t467 = t466 * t247;
  t468 = t467 * t249;
  t471 = t360 * t178;
  t473 = t360 * t189;
  t475 = t435 * t27;
  t479 = t441 * t89;
  t480 = t92 * t114;
  t488 = t475 * t30;
  t491 = -t39 * t475 * t42 / 0.48e2 + t110 * t479 * t480 / 0.96e2 - t268 * t466 * t271 * t151 / 0.96e2 - t46 * t488 / 0.48e2;
  t492 = params->alpha * t491;
  t493 = t492 * t56;
  t495 = t177 * t399;
  t498 = t188 * t188;
  t499 = t288 * t498;
  t502 = t129 * t436;
  t505 = t296 * t442;
  t506 = t169 * t300;
  t509 = t169 * t304;
  t519 = -t502 * t181 / 0.48e2 - t505 * t506 / 0.48e2 + t505 * t509 / 0.4e1 - t135 * t475 * t184 / 0.4e1 - 0.18e2 * t312 * t151 * t466 * t247;
  t520 = t128 * t519;
  t522 = -t438 * t156 / 0.48e2 - t444 * t447 / 0.48e2 + t444 * t451 / 0.4e1 + t154 * t454 / 0.12e2 - t154 * t457 / 0.12e2 - t461 * t162 / 0.4e1 - 0.18e2 * t465 * t468 + t160 * t471 - t160 * t473 + t104 * t493 - 0.2e1 * t104 * t495 + 0.2e1 * t104 * t499 - t104 * t520;
  t526 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t522);
  tv2sigma20 = 0.2e1 * rho[0] * t526;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t42, t46, t51, t52, t53, t55, t56, t57;
  double t59, t63, tzk0;

  double t64, t66, t70, t71, t72, t73, t74, t76;
  double t77, t78, t79, t80, t84, t85, t86, t87;
  double t88, t89, t90, t92, t96, t97, t98, t100;
  double t101, t104, t105, t110, t111, t113, t114, t115;
  double t119, t122, t123, t124, t126, t127, t128, t129;
  double t130, t131, t132, t135, t136, t140, t141, t143;
  double t148, tvrho0, t151, t152, t153, t154, t155, t156;
  double t160, t161, t162, t165, t169, t173, t176, t177;
  double t178, t180, t181, t184, t188, t189, t191, t195;
  double tvsigma0;

  double t200, t208, t209, t210, t213, t214, t216, t217;
  double t219, t220, t222, t225, t226, t229, t230, t233;
  double t236, t237, t240, t241, t242, t243, t244, t245;
  double t247, t248, t249, t250, t253, t254, t257, t260;
  double t264, t268, t269, t270, t271, t275, t278, t279;
  double t280, t282, t283, t287, t288, t289, t290, t293;
  double t296, t297, t298, t299, t300, t301, t304, t305;
  double t308, t312, t316, t317, t319, t324, tv2rho20, t332;
  double t334, t335, t338, t339, t340, t343, t344, t347;
  double t352, t353, t354, t355, t356, t357, t360, t361;
  double t364, t367, t370, t376, t384, t387, t388, t389;
  double t391, t393, t396, t399, t400, t402, t403, t408;
  double t409, t413, t414, t424, t425, t427, t432, tv2rhosigma0;
  double t435, t436, t437, t438, t441, t442, t444, t447;
  double t450, t451, t454, t457, t461, t464, t465, t466;
  double t467, t468, t471, t473, t475, t479, t480, t488;
  double t491, t492, t493, t495, t498, t499, t502, t505;
  double t506, t509, t519, t520, t522, t526, tv2sigma20;

  double t529, t540, t541, t546, t551, t552, t553, t557;
  double t558, t560, t564, t566, t567, t574, t575, t577;
  double t578, t581, t585, t588, t589, t590, t595, t599;
  double t604, t605, t606, t607, t608, t612, t619, t620;
  double t621, t622, t623, t626, t627, t628, t629, t631;
  double t632, t634, t636, t637, t640, t641, t643, t644;
  double t645, t646, t647, t650, t651, t652, t653, t656;
  double t657, t660, t663, t664, t667, t668, t672, t673;
  double t674, t675, t679, t682, t683, t686, t691, t694;
  double t697, t700, t703, t706, t707, t710, t711, t715;
  double t717, t724, t727, t730, t737, t738, t739, t740;
  double t741, t742, t745, t747, t748, t751, t754, t755;
  double t756, t757, t760, t767, t771, t776, t779, t782;
  double t785, t788, t789, t794, tv3rho30, t804, t808, t812;
  double t820, t821, t822, t825, t827, t828, t831, t833;
  double t836, t839, t842, t845, t861, t865, t872, t873;
  double t882, t884, t888, t891, t892, t895, t896, t897;
  double t898, t905, t909, t910, t911, t915, t917, t919;
  double t922, t923, t925, t928, t936, t939, t943, t945;
  double t948, t957, t960, t962, t965, t968, t971, t973;
  double t976, t982, t988, t997, t1000, t1003, t1009, t1012;
  double t1019, t1020, t1023, t1024, t1025, t1028, t1029, t1030;
  double t1032, t1035, t1036, t1037, t1038, t1041, t1042, t1045;
  double t1046, t1049, t1052, t1055, t1058, t1064, t1072, t1074;
  double t1079, tv3rho2sigma0, t1091, t1096, t1104, t1105, t1109, t1114;
  double t1126, t1127, t1128, t1137, t1138, t1139, t1143, t1145;
  double t1147, t1150, t1151, t1161, t1165, t1169, t1173, t1177;
  double t1180, t1185, t1186, t1192, t1193, t1194, t1197, t1200;
  double t1203, t1206, t1215, t1218, t1222, t1223, t1232, t1234;
  double t1236, t1238, t1241, t1244, t1247, t1250, t1253, t1254;
  double t1257, t1262, t1272, t1277, t1280, t1289, t1292, t1293;
  double t1296, t1298, t1299, t1302, t1309, t1312, t1319, t1321;
  double t1326, tv3rhosigma20, t1329, t1330, t1333, t1334, t1335, t1338;
  double t1339, t1340, t1345, t1347, t1351, t1355, t1358, t1359;
  double t1361, t1362, t1363, t1366, t1370, t1374, t1375, t1376;
  double t1379, t1381, t1383, t1386, t1387, t1392, t1397, t1399;
  double t1406, t1407, t1415, t1422, t1425, t1426, t1429, t1432;
  double t1440, t1444, t1448, t1452, t1453, t1454, t1457, t1460;
  double t1461, t1469, t1471, t1478, t1481, t1484, t1487, t1490;
  double t1493, t1502, t1511, t1512, t1516, tv3sigma30;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t33 = t25 * t31 / 0.12e2;
  t34 = tanh(t33);
  t35 = params->mu * t34;
  t36 = log(t33 + sqrt(t33 * t33 + 0.1e1));
  t37 = 0.1e1 - params->zeta;
  t39 = t37 * t21 * t24;
  t40 = 0.1e1 + t33;
  t41 = log(t40);
  t42 = t30 * t41;
  t46 = params->zeta * t21 * t24;
  t51 = 0.1e1 + params->alpha * (t39 * t28 * t42 / 0.12e2 + t46 * t31 / 0.12e2);
  t52 = t36 * t51;
  t53 = params->beta * t34;
  t55 = t53 * t36 + 0.1e1;
  t56 = 0.1e1 / t55;
  t57 = t52 * t56;
  t59 = t35 * t57 + 0.1e1;
  t63 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t59);
  tzk0 = 0.2e1 * t63;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t64 = t18 * t18;
  t66 = t17 / t64;
  t70 = params->mu * t21;
  t71 = t24 * t26;
  t72 = t71 * t27;
  t73 = t70 * t72;
  t74 = rho[0] * rho[0];
  t76 = 0.1e1 / t18 / t74;
  t77 = t34 * t34;
  t78 = 0.1e1 - t77;
  t79 = t76 * t78;
  t80 = t79 * t57;
  t84 = t35 * t25 * t26;
  t85 = t27 * t76;
  t86 = t23 * t23;
  t87 = 0.1e1 / t86;
  t88 = t20 * t87;
  t89 = t27 * t27;
  t90 = sigma[0] * t89;
  t92 = 0.1e1 / t64 / t74;
  t96 = 0.6e1 * t88 * t90 * t92 + 0.144e3;
  t97 = sqrt(t96);
  t98 = 0.1e1 / t97;
  t100 = t98 * t51 * t56;
  t101 = t85 * t100;
  t104 = t35 * t36;
  t105 = t76 * t41;
  t110 = t37 * t20 * t87;
  t111 = t74 * rho[0];
  t113 = 0.1e1 / t64 / t111;
  t114 = 0.1e1 / t40;
  t115 = t113 * t114;
  t119 = t28 * t76;
  t122 = -t39 * t28 * t105 / 0.9e1 - t110 * t90 * t115 / 0.18e2 - t46 * t119 / 0.9e1;
  t123 = params->alpha * t122;
  t124 = t123 * t56;
  t126 = t55 * t55;
  t127 = 0.1e1 / t126;
  t128 = t51 * t127;
  t129 = params->beta * t21;
  t130 = t129 * t71;
  t131 = t78 * t36;
  t132 = t85 * t131;
  t135 = t53 * t25;
  t136 = t76 * t98;
  t140 = -t130 * t132 / 0.9e1 - 0.4e1 / 0.3e1 * t135 * t28 * t136;
  t141 = t128 * t140;
  t143 = -t73 * t80 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t101 + t104 * t124 - t104 * t141;
  t148 = my_piecewise3(t2, 0, -t6 * t66 * t59 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t143);
  tvrho0 = 0.2e1 * rho[0] * t148 + 0.2e1 * t63;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t151 = 0.1e1 / t26;
  t152 = t24 * t151;
  t153 = t152 * t27;
  t154 = t70 * t153;
  t155 = t30 * t78;
  t156 = t155 * t57;
  t160 = t35 * t25 * t151;
  t161 = t27 * t30;
  t162 = t161 * t100;
  t165 = t151 * t27;
  t169 = t89 * t92;
  t173 = t165 * t30;
  t176 = t39 * t165 * t42 / 0.24e2 + t110 * t169 * t114 / 0.48e2 + t46 * t173 / 0.24e2;
  t177 = params->alpha * t176;
  t178 = t177 * t56;
  t180 = t129 * t152;
  t181 = t161 * t131;
  t184 = t30 * t98;
  t188 = t180 * t181 / 0.24e2 + t135 * t165 * t184 / 0.2e1;
  t189 = t128 * t188;
  t191 = t154 * t156 / 0.24e2 + t160 * t162 / 0.2e1 + t104 * t178 - t104 * t189;
  t195 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t191);
  tvsigma0 = 0.2e1 * rho[0] * t195;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t200 = t17 / t64 / rho[0];
  t208 = 0.1e1 / t18 / t111;
  t209 = t208 * t78;
  t210 = t209 * t57;
  t213 = params->mu * t20;
  t214 = t87 * sigma[0];
  t216 = t213 * t214 * t89;
  t217 = t74 * t74;
  t219 = 0.1e1 / t64 / t217;
  t220 = t219 * t34;
  t222 = t220 * t78 * t57;
  t225 = t219 * t78;
  t226 = t225 * t100;
  t229 = t79 * t36;
  t230 = t229 * t124;
  t233 = t229 * t141;
  t236 = t27 * t208;
  t237 = t236 * t100;
  t240 = 0.1e1 / t22;
  t241 = t26 * sigma[0];
  t242 = t240 * t241;
  t243 = t35 * t242;
  t244 = t217 * t74;
  t245 = 0.1e1 / t244;
  t247 = 0.1e1 / t97 / t96;
  t248 = t245 * t247;
  t249 = t51 * t56;
  t250 = t248 * t249;
  t253 = t85 * t98;
  t254 = t253 * t124;
  t257 = t253 * t141;
  t260 = t208 * t41;
  t264 = t219 * t114;
  t268 = t37 * t240;
  t269 = t241 * t245;
  t270 = t40 * t40;
  t271 = 0.1e1 / t270;
  t275 = t28 * t208;
  t278 = 0.7e1 / 0.27e2 * t39 * t28 * t260 + 0.5e1 / 0.18e2 * t110 * t90 * t264 - 0.2e1 / 0.27e2 * t268 * t269 * t271 + 0.7e1 / 0.27e2 * t46 * t275;
  t279 = params->alpha * t278;
  t280 = t279 * t56;
  t282 = t127 * t140;
  t283 = t123 * t282;
  t287 = 0.1e1 / t126 / t55;
  t288 = t51 * t287;
  t289 = t140 * t140;
  t290 = t288 * t289;
  t293 = t236 * t131;
  t296 = params->beta * t20;
  t297 = t296 * t214;
  t298 = t89 * t219;
  t299 = t34 * t78;
  t300 = t299 * t36;
  t301 = t298 * t300;
  t304 = t78 * t98;
  t305 = t298 * t304;
  t308 = t208 * t98;
  t312 = t53 * t240;
  t316 = 0.7e1 / 0.27e2 * t130 * t293 - 0.4e1 / 0.27e2 * t297 * t301 + 0.16e2 / 0.9e1 * t297 * t305 + 0.28e2 / 0.9e1 * t135 * t28 * t308 - 0.128e3 * t312 * t269 * t247;
  t317 = t128 * t316;
  t319 = 0.7e1 / 0.27e2 * t73 * t210 - 0.4e1 / 0.27e2 * t216 * t222 + 0.16e2 / 0.9e1 * t216 * t226 - 0.2e1 / 0.9e1 * t73 * t230 + 0.2e1 / 0.9e1 * t73 * t233 + 0.28e2 / 0.9e1 * t84 * t237 - 0.128e3 * t243 * t250 - 0.8e1 / 0.3e1 * t84 * t254 + 0.8e1 / 0.3e1 * t84 * t257 + t104 * t280 - 0.2e1 * t104 * t283 + 0.2e1 * t104 * t290 - t104 * t317;
  t324 = my_piecewise3(t2, 0, t6 * t200 * t59 / 0.12e2 - t6 * t66 * t143 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t319);
  tv2rho20 = 0.2e1 * rho[0] * t324 + 0.4e1 * t148;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t332 = t87 * t89;
  t334 = t213 * t332 * t113;
  t335 = t299 * t57;
  t338 = t213 * t332;
  t339 = t113 * t78;
  t340 = t339 * t100;
  t343 = t155 * t36;
  t344 = t343 * t124;
  t347 = t343 * t141;
  t352 = t240 * t26;
  t353 = t35 * t352;
  t354 = t217 * rho[0];
  t355 = 0.1e1 / t354;
  t356 = t355 * t247;
  t357 = t356 * t249;
  t360 = t161 * t98;
  t361 = t360 * t124;
  t364 = t360 * t141;
  t367 = t229 * t178;
  t370 = t253 * t178;
  t376 = t89 * t113;
  t384 = t165 * t76;
  t387 = -t39 * t165 * t105 / 0.18e2 - t110 * t376 * t114 / 0.12e2 + t268 * t355 * t271 * t26 / 0.36e2 - t46 * t384 / 0.18e2;
  t388 = params->alpha * t387;
  t389 = t388 * t56;
  t391 = t177 * t282;
  t393 = t229 * t189;
  t396 = t253 * t189;
  t399 = t127 * t188;
  t400 = t123 * t399;
  t402 = t188 * t140;
  t403 = t288 * t402;
  t408 = t296 * t332;
  t409 = t113 * t34;
  t413 = t296 * t87;
  t414 = t376 * t304;
  t424 = -t180 * t132 / 0.18e2 + t408 * t409 * t131 / 0.18e2 - 0.2e1 / 0.3e1 * t413 * t414 - 0.2e1 / 0.3e1 * t135 * t165 * t136 + 0.48e2 * t312 * t26 * t355 * t247;
  t425 = t128 * t424;
  t427 = -t154 * t80 / 0.18e2 + t334 * t335 / 0.18e2 - 0.2e1 / 0.3e1 * t338 * t340 + t154 * t344 / 0.24e2 - t154 * t347 / 0.24e2 - 0.2e1 / 0.3e1 * t160 * t101 + 0.48e2 * t353 * t357 + t160 * t361 / 0.2e1 - t160 * t364 / 0.2e1 - t73 * t367 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t370 + t104 * t389 - t104 * t391 + t73 * t393 / 0.9e1 + 0.4e1 / 0.3e1 * t84 * t396 - t104 * t400 + 0.2e1 * t104 * t403 - t104 * t425;
  t432 = my_piecewise3(t2, 0, -t6 * t66 * t191 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t427);
  tv2rhosigma0 = 0.2e1 * rho[0] * t432 + 0.2e1 * t195;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t435 = 0.1e1 / t241;
  t436 = t24 * t435;
  t437 = t436 * t27;
  t438 = t70 * t437;
  t441 = 0.1e1 / sigma[0];
  t442 = t87 * t441;
  t444 = t213 * t442 * t89;
  t447 = t92 * t34 * t78 * t57;
  t450 = t92 * t78;
  t451 = t450 * t100;
  t454 = t343 * t178;
  t457 = t343 * t189;
  t461 = t35 * t25 * t435;
  t464 = t240 * t151;
  t465 = t35 * t464;
  t466 = 0.1e1 / t217;
  t467 = t466 * t247;
  t468 = t467 * t249;
  t471 = t360 * t178;
  t473 = t360 * t189;
  t475 = t435 * t27;
  t479 = t441 * t89;
  t480 = t92 * t114;
  t488 = t475 * t30;
  t491 = -t39 * t475 * t42 / 0.48e2 + t110 * t479 * t480 / 0.96e2 - t268 * t466 * t271 * t151 / 0.96e2 - t46 * t488 / 0.48e2;
  t492 = params->alpha * t491;
  t493 = t492 * t56;
  t495 = t177 * t399;
  t498 = t188 * t188;
  t499 = t288 * t498;
  t502 = t129 * t436;
  t505 = t296 * t442;
  t506 = t169 * t300;
  t509 = t169 * t304;
  t519 = -t502 * t181 / 0.48e2 - t505 * t506 / 0.48e2 + t505 * t509 / 0.4e1 - t135 * t475 * t184 / 0.4e1 - 0.18e2 * t312 * t151 * t466 * t247;
  t520 = t128 * t519;
  t522 = -t438 * t156 / 0.48e2 - t444 * t447 / 0.48e2 + t444 * t451 / 0.4e1 + t154 * t454 / 0.12e2 - t154 * t457 / 0.12e2 - t461 * t162 / 0.4e1 - 0.18e2 * t465 * t468 + t160 * t471 - t160 * t473 + t104 * t493 - 0.2e1 * t104 * t495 + 0.2e1 * t104 * t499 - t104 * t520;
  t526 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t522);
  tv2sigma20 = 0.2e1 * rho[0] * t526;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t529 = t17 * t92;
  t540 = 0.1e1 / t18 / t217;
  t541 = t540 * t41;
  t546 = 0.1e1 / t64 / t354;
  t551 = t217 * t111;
  t552 = 0.1e1 / t551;
  t553 = t241 * t552;
  t557 = sigma[0] * sigma[0];
  t558 = t217 * t217;
  t560 = 0.1e1 / t18 / t558;
  t564 = 0.1e1 / t270 / t40;
  t566 = t24 * t27;
  t567 = t564 * t21 * t566;
  t574 = params->alpha * (-0.7e2 / 0.81e2 * t39 * t28 * t541 - 0.119e3 / 0.81e2 * t110 * t90 * t546 * t114 + 0.22e2 / 0.27e2 * t268 * t553 * t271 - 0.4e1 / 0.243e3 * t268 * t557 * t560 * t567 - 0.7e2 / 0.81e2 * t46 * t28 * t540);
  t575 = t574 * t56;
  t577 = t27 * t540;
  t578 = t577 * t131;
  t581 = t89 * t546;
  t585 = t581 * t304;
  t588 = params->beta * t240;
  t589 = t588 * t241;
  t590 = t78 * t78;
  t595 = t552 * t77;
  t599 = t552 * t34;
  t604 = 0.1e1 / t23 / t22;
  t605 = t604 * t557;
  t606 = t129 * t605;
  t607 = t27 * t560;
  t608 = t78 * t247;
  t612 = t540 * t98;
  t619 = t24 * t557;
  t620 = t129 * t619;
  t621 = t78 * t240;
  t622 = t621 * t247;
  t623 = t607 * t622;
  t626 = t26 * t557;
  t627 = t240 * t626;
  t628 = t53 * t627;
  t629 = t558 * rho[0];
  t631 = 0.1e1 / t64 / t629;
  t632 = t96 * t96;
  t634 = 0.1e1 / t97 / t632;
  t636 = t88 * t89;
  t637 = t631 * t634 * t636;
  t640 = -0.7e2 / 0.81e2 * t130 * t578 + 0.28e2 / 0.27e2 * t297 * t581 * t300 - 0.112e3 / 0.9e1 * t297 * t585 + 0.16e2 / 0.81e2 * t589 * t552 * t590 * t36 - 0.32e2 / 0.81e2 * t589 * t595 * t131 + 0.64e2 / 0.9e1 * t589 * t599 * t304 + 0.256e3 / 0.9e1 * t606 * t607 * t608 - 0.28e3 / 0.27e2 * t135 * t28 * t612 + 0.32e4 / 0.3e1 * t312 * t553 * t247 + 0.128e3 / 0.9e1 * t620 * t623 - 0.3072e4 * t628 * t637;
  t641 = t128 * t640;
  t643 = t126 * t126;
  t644 = 0.1e1 / t643;
  t645 = t51 * t644;
  t646 = t289 * t140;
  t647 = t645 * t646;
  t650 = params->mu * t240;
  t651 = t650 * t553;
  t652 = t590 * t36;
  t653 = t652 * t249;
  t656 = t552 * t247;
  t657 = t656 * t249;
  t660 = t577 * t100;
  t663 = t540 * t78;
  t664 = t663 * t57;
  t667 = t546 * t78;
  t668 = t667 * t100;
  t672 = t70 * t605 * t27;
  t673 = t560 * t78;
  t674 = t247 * t51;
  t675 = t674 * t56;
  t679 = t229 * t280;
  t682 = t209 * t36;
  t683 = t682 * t141;
  t686 = t546 * t34;
  t691 = t682 * t124;
  t694 = t253 * t290;
  t697 = t229 * t290;
  t700 = t253 * t317;
  t703 = t229 * t317;
  t706 = t236 * t98;
  t707 = t706 * t141;
  t710 = t104 * t575 - t104 * t641 - 0.6e1 * t104 * t647 + 0.16e2 / 0.81e2 * t651 * t653 + 0.32e4 / 0.3e1 * t243 * t657 - 0.28e3 / 0.27e2 * t84 * t660 - 0.7e2 / 0.81e2 * t73 * t664 - 0.112e3 / 0.9e1 * t216 * t668 + 0.256e3 / 0.9e1 * t672 * t673 * t675 - t73 * t679 / 0.3e1 - 0.7e1 / 0.9e1 * t73 * t683 + 0.28e2 / 0.27e2 * t216 * t686 * t78 * t57 + 0.7e1 / 0.9e1 * t73 * t691 - 0.8e1 * t84 * t694 - 0.2e1 / 0.3e1 * t73 * t697 + 0.4e1 * t84 * t700 + t73 * t703 / 0.3e1 - 0.28e2 / 0.3e1 * t84 * t707;
  t711 = t706 * t124;
  t715 = t70 * t619 * t27;
  t717 = t673 * t240 * t675;
  t724 = t634 * t51 * t56 * t636;
  t727 = t253 * t280;
  t730 = t225 * t98;
  t737 = t35 * t21;
  t738 = t737 * t72;
  t739 = t136 * params->alpha;
  t740 = t122 * t127;
  t741 = t740 * t140;
  t742 = t739 * t741;
  t745 = t213 * t87;
  t747 = t745 * t90 * t219;
  t748 = t300 * t141;
  t751 = t300 * t124;
  t754 = t70 * t24;
  t755 = t754 * t119;
  t756 = t131 * params->alpha;
  t757 = t756 * t741;
  t760 = t287 * t289;
  t767 = t127 * t316;
  t771 = t140 * t316;
  t776 = t77 * t78 * t57;
  t779 = t299 * t100;
  t782 = t248 * t141;
  t785 = t248 * t124;
  t788 = 0.28e2 / 0.3e1 * t84 * t711 + 0.128e3 / 0.9e1 * t715 * t717 - 0.3072e4 * t35 * t627 * t631 * t724 - 0.4e1 * t84 * t727 - 0.16e2 / 0.3e1 * t216 * t730 * t141 + 0.16e2 / 0.3e1 * t216 * t730 * t124 + 0.8e1 * t738 * t742 + 0.4e1 / 0.9e1 * t747 * t748 - 0.4e1 / 0.9e1 * t747 * t751 + 0.2e1 / 0.3e1 * t755 * t757 + 0.6e1 * t104 * t123 * t760 - 0.3e1 * t104 * t279 * t282 - 0.3e1 * t104 * t123 * t767 + 0.6e1 * t104 * t288 * t771 - 0.32e2 / 0.81e2 * t651 * t776 + 0.64e2 / 0.9e1 * t651 * t779 + 0.384e3 * t243 * t782 - 0.384e3 * t243 * t785;
  t789 = t710 + t788;
  t794 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t529 * t59 + t6 * t200 * t143 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t66 * t319 - 0.3e1 / 0.8e1 * t6 * t19 * t789);
  tv3rho30 = 0.2e1 * rho[0] * t794 + 0.6e1 * t324;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t804 = t127 * t424;
  t808 = t424 * t140;
  t812 = t188 * t316;
  t820 = t35 * t36 * params->alpha;
  t821 = t122 * t287;
  t822 = t821 * t402;
  t825 = t245 * t77;
  t827 = t26 * t78;
  t828 = t827 * t57;
  t831 = t245 * t34;
  t833 = t827 * t100;
  t836 = t356 * t141;
  t839 = t356 * t124;
  t842 = t248 * t178;
  t845 = t248 * t189;
  t861 = 0.1e1 / t18 / t551;
  t865 = sigma[0] * t21 * t566;
  t872 = params->alpha * (0.7e1 / 0.54e2 * t39 * t165 * t260 + 0.37e2 / 0.108e3 * t110 * t298 * t114 - t268 * t245 * t271 * t26 / 0.4e1 + t268 * t861 * t564 * t865 / 0.162e3 + 0.7e1 / 0.54e2 * t46 * t165 * t208);
  t873 = t872 * t56;
  t882 = t588 * t245;
  t884 = t26 * t590 * t36;
  t888 = t77 * t26 * t131;
  t891 = t26 * t98;
  t892 = t299 * t891;
  t895 = t604 * t27;
  t896 = t129 * t895;
  t897 = t861 * t78;
  t898 = t247 * sigma[0];
  t905 = t26 * t245;
  t909 = t24 * sigma[0];
  t910 = t129 * t909;
  t911 = t27 * t861;
  t915 = t53 * t242;
  t917 = 0.1e1 / t64 / t558;
  t919 = t917 * t634 * t636;
  t922 = 0.7e1 / 0.54e2 * t180 * t293 - 0.5e1 / 0.18e2 * t408 * t220 * t131 + 0.1e2 / 0.3e1 * t413 * t305 - 0.2e1 / 0.27e2 * t882 * t884 + 0.4e1 / 0.27e2 * t882 * t888 - 0.8e1 / 0.3e1 * t882 * t892 - 0.32e2 / 0.3e1 * t896 * t897 * t898 + 0.14e2 / 0.9e1 * t135 * t165 * t308 - 0.304e3 * t312 * t905 * t247 - 0.16e2 / 0.3e1 * t910 * t911 * t622 + 0.1152e4 * t915 * t919;
  t923 = t128 * t922;
  t925 = t650 * t905;
  t928 = -0.2e1 * t104 * t123 * t804 + 0.4e1 * t104 * t288 * t808 + 0.2e1 * t104 * t288 * t812 - 0.2e1 * t104 * t388 * t282 + 0.4e1 * t820 * t822 + 0.4e1 / 0.27e2 * t650 * t825 * t828 - 0.8e1 / 0.3e1 * t650 * t831 * t833 - 0.96e2 * t353 * t836 + 0.96e2 * t353 * t839 - 0.128e3 * t243 * t842 + 0.128e3 * t243 * t845 + 0.1e2 / 0.3e1 * t338 * t226 + t104 * t873 - t104 * t923 - 0.2e1 / 0.27e2 * t925 * t653;
  t936 = t213 * t332 * t219;
  t939 = t304 * t141;
  t943 = t70 * t895 * t861;
  t945 = t608 * t249 * sigma[0];
  t948 = t304 * t124;
  t957 = t706 * t189;
  t960 = t360 * t290;
  t962 = t682 * t178;
  t965 = t706 * t178;
  t968 = t343 * t290;
  t971 = -0.304e3 * t353 * t250 + 0.14e2 / 0.9e1 * t160 * t237 + 0.7e1 / 0.54e2 * t154 * t210 - 0.5e1 / 0.18e2 * t936 * t335 + 0.4e1 / 0.3e1 * t334 * t939 - 0.32e2 / 0.3e1 * t943 * t945 - 0.4e1 / 0.3e1 * t334 * t948 - t154 * t230 / 0.9e1 - t334 * t748 / 0.9e1 + t334 * t751 / 0.9e1 - 0.28e2 / 0.9e1 * t84 * t957 + t160 * t960 + 0.7e1 / 0.27e2 * t73 * t962 + 0.28e2 / 0.9e1 * t84 * t965 + t154 * t968 / 0.12e2;
  t973 = t253 * t389;
  t976 = t229 * t425;
  t982 = t253 * t425;
  t988 = t70 * t909 * t27;
  t997 = t360 * t280;
  t1000 = t360 * t317;
  t1003 = t229 * t389;
  t1009 = t343 * t280;
  t1012 = t343 * t317;
  t1019 = -0.8e1 / 0.3e1 * t84 * t973 + 0.2e1 / 0.9e1 * t73 * t976 - 0.16e2 / 0.9e1 * t216 * t730 * t189 + 0.8e1 / 0.3e1 * t84 * t982 - 0.4e1 / 0.3e1 * t160 * t254 - 0.16e2 / 0.3e1 * t988 * t897 * t240 * t675 + 0.1152e4 * t35 * t242 * t917 * t724 + t160 * t997 / 0.2e1 - t160 * t1000 / 0.2e1 - 0.2e1 / 0.9e1 * t73 * t1003 + 0.16e2 / 0.9e1 * t216 * t730 * t178 + t154 * t1009 / 0.24e2 - t154 * t1012 / 0.24e2 + 0.4e1 / 0.3e1 * t160 * t257 + t154 * t233 / 0.9e1;
  t1020 = t682 * t189;
  t1023 = t176 * t127;
  t1024 = t1023 * t140;
  t1025 = t739 * t1024;
  t1028 = t737 * t153;
  t1029 = t184 * params->alpha;
  t1030 = t1029 * t741;
  t1032 = t754 * t173;
  t1035 = t136 * t51;
  t1036 = t287 * t188;
  t1037 = t1036 * t140;
  t1038 = t1035 * t1037;
  t1041 = t740 * t188;
  t1042 = t739 * t1041;
  t1045 = t131 * t51;
  t1046 = t1045 * t1037;
  t1049 = t300 * t189;
  t1052 = t756 * t1041;
  t1055 = t756 * t1024;
  t1058 = t300 * t178;
  t1064 = t188 * t289;
  t1072 = -0.7e1 / 0.27e2 * t73 * t1020 + 0.8e1 / 0.3e1 * t738 * t1025 - t1028 * t1030 - t1032 * t757 / 0.12e2 - 0.16e2 / 0.3e1 * t738 * t1038 + 0.8e1 / 0.3e1 * t738 * t1042 - 0.4e1 / 0.9e1 * t755 * t1046 + 0.4e1 / 0.27e2 * t747 * t1049 + 0.2e1 / 0.9e1 * t755 * t1052 + 0.2e1 / 0.9e1 * t755 * t1055 - 0.4e1 / 0.27e2 * t747 * t1058 + 0.2e1 * t104 * t177 * t760 - 0.6e1 * t104 * t645 * t1064 - t104 * t177 * t767 - t104 * t279 * t399;
  t1074 = t928 + t971 + t1019 + t1072;
  t1079 = my_piecewise3(t2, 0, t6 * t200 * t191 / 0.12e2 - t6 * t66 * t427 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1074);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t1079 + 0.4e1 * t432;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1091 = t151 * t355;
  t1096 = 0.1e1 / t18 / t244;
  t1104 = params->alpha * (t39 * t475 * t105 / 0.36e2 - t110 * t479 * t115 / 0.72e2 + t268 * t1091 * t271 / 0.18e2 - t268 * t1096 * t567 / 0.432e3 + t46 * t475 * t76 / 0.36e2);
  t1105 = t1104 * t56;
  t1109 = t376 * t300;
  t1114 = t588 * t151;
  t1126 = t129 * t604;
  t1127 = t27 * t1096;
  t1128 = t1127 * t608;
  t1137 = t129 * t566;
  t1138 = t1096 * t78;
  t1139 = t240 * t247;
  t1143 = t53 * t352;
  t1145 = 0.1e1 / t64 / t551;
  t1147 = t1145 * t634 * t636;
  t1150 = t502 * t132 / 0.36e2 + t505 * t1109 / 0.36e2 - t505 * t414 / 0.3e1 + t1114 * t355 * t590 * t36 / 0.36e2 - t1114 * t355 * t77 * t131 / 0.18e2 + t1114 * t355 * t34 * t304 + 0.4e1 * t1126 * t1128 + t135 * t475 * t136 / 0.3e1 + 0.48e2 * t312 * t1091 * t247 + 0.2e1 * t1137 * t1138 * t1139 - 0.432e3 * t1143 * t1147;
  t1151 = t128 * t1150;
  t1161 = t498 * t140;
  t1165 = t188 * t424;
  t1169 = t287 * t498;
  t1173 = t519 * t140;
  t1177 = t127 * t519;
  t1180 = t650 * t1091;
  t1185 = t176 * t287;
  t1186 = t1185 * t402;
  t1192 = t104 * t1105 - t104 * t1151 - t104 * t492 * t282 - 0.2e1 * t104 * t388 * t399 - 0.2e1 * t104 * t177 * t804 - 0.6e1 * t104 * t645 * t1161 + 0.4e1 * t104 * t288 * t1165 + 0.2e1 * t104 * t123 * t1169 + 0.2e1 * t104 * t288 * t1173 - t104 * t123 * t1177 + t1180 * t653 / 0.36e2 + 0.48e2 * t465 * t357 + 0.4e1 * t820 * t1186 - t1180 * t776 / 0.18e2 + t1180 * t779;
  t1193 = t70 * t895;
  t1194 = t1138 * t675;
  t1197 = t467 * t141;
  t1200 = t467 * t124;
  t1203 = t356 * t178;
  t1206 = t356 * t189;
  t1215 = t304 * t178;
  t1218 = t304 * t189;
  t1222 = t70 * t566 * t1096;
  t1223 = t621 * t675;
  t1232 = t360 * t389;
  t1234 = t360 * t425;
  t1236 = 0.4e1 * t1193 * t1194 + 0.18e2 * t465 * t1197 - 0.18e2 * t465 * t1200 + 0.96e2 * t353 * t1203 - 0.96e2 * t353 * t1206 + t461 * t101 / 0.3e1 + t438 * t80 / 0.36e2 - t444 * t340 / 0.3e1 - 0.4e1 / 0.3e1 * t334 * t1215 + 0.4e1 / 0.3e1 * t334 * t1218 + 0.2e1 * t1222 * t1223 - t461 * t361 / 0.4e1 - 0.432e3 * t35 * t352 * t1145 * t724 + t160 * t1232 - t160 * t1234;
  t1238 = t229 * t493;
  t1241 = t253 * t493;
  t1244 = t229 * t499;
  t1247 = t253 * t499;
  t1250 = t229 * t520;
  t1253 = t450 * t98;
  t1254 = t1253 * t124;
  t1257 = t343 * t389;
  t1262 = t343 * t425;
  t1272 = t409 * t78 * t57;
  t1277 = t1253 * t141;
  t1280 = -t73 * t1238 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t1241 - 0.2e1 / 0.9e1 * t73 * t1244 - 0.8e1 / 0.3e1 * t84 * t1247 + t73 * t1250 / 0.9e1 + t444 * t1254 / 0.4e1 + t154 * t1257 / 0.12e2 + t334 * t1058 / 0.9e1 - t154 * t1262 / 0.12e2 - t334 * t1049 / 0.9e1 + t461 * t364 / 0.4e1 + t438 * t347 / 0.48e2 + t444 * t1272 / 0.36e2 - t438 * t344 / 0.48e2 - t444 * t1277 / 0.4e1;
  t1289 = t253 * t520;
  t1292 = t184 * t51;
  t1293 = t1292 * t1037;
  t1296 = t1029 * t1041;
  t1298 = t1023 * t188;
  t1299 = t756 * t1298;
  t1302 = t739 * t1298;
  t1309 = t1029 * t1024;
  t1312 = t745 * t479 * t92;
  t1319 = 0.4e1 / 0.3e1 * t160 * t396 + t154 * t393 / 0.9e1 - 0.4e1 / 0.3e1 * t160 * t370 - t154 * t367 / 0.9e1 + 0.4e1 / 0.3e1 * t84 * t1289 + 0.2e1 * t1028 * t1293 - t1028 * t1296 + 0.2e1 / 0.9e1 * t755 * t1299 + 0.8e1 / 0.3e1 * t738 * t1302 + t1032 * t1046 / 0.6e1 - t1032 * t1052 / 0.12e2 - t1028 * t1309 + t1312 * t748 / 0.48e2 - t1312 * t751 / 0.48e2 - t1032 * t1055 / 0.12e2;
  t1321 = t1192 + t1236 + t1280 + t1319;
  t1326 = my_piecewise3(t2, 0, -t6 * t66 * t522 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1321);
  tv3rhosigma20 = 0.2e1 * rho[0] * t1326 + 0.2e1 * t526;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1329 = t498 * t188;
  t1330 = t645 * t1329;
  t1333 = 0.1e1 / t626;
  t1334 = t24 * t1333;
  t1335 = t129 * t1334;
  t1338 = 0.1e1 / t557;
  t1339 = t87 * t1338;
  t1340 = t296 * t1339;
  t1345 = t588 * t435;
  t1347 = t466 * t590 * t36;
  t1351 = t466 * t77 * t131;
  t1355 = t466 * t34 * t304;
  t1358 = t604 * t441;
  t1359 = t129 * t1358;
  t1361 = 0.1e1 / t18 / t354;
  t1362 = t27 * t1361;
  t1363 = t1362 * t608;
  t1366 = t1333 * t27;
  t1370 = t435 * t466;
  t1374 = t24 * t441;
  t1375 = t129 * t1374;
  t1376 = t1362 * t622;
  t1379 = t53 * t464;
  t1381 = 0.1e1 / t64 / t244;
  t1383 = t1381 * t634 * t636;
  t1386 = t1335 * t181 / 0.32e2 + t1340 * t506 / 0.32e2 - 0.3e1 / 0.8e1 * t1340 * t509 - t1345 * t1347 / 0.96e2 + t1345 * t1351 / 0.48e2 - 0.3e1 / 0.8e1 * t1345 * t1355 - 0.3e1 / 0.2e1 * t1359 * t1363 + 0.3e1 / 0.8e1 * t135 * t1366 * t184 + 0.18e2 * t312 * t1370 * t247 - 0.3e1 / 0.4e1 * t1375 * t1376 + 0.162e3 * t1379 * t1383;
  t1387 = t128 * t1386;
  t1392 = t1338 * t89;
  t1397 = t268 * t1361 * t564;
  t1399 = t441 * t21 * t566;
  t1406 = params->alpha * (t39 * t1366 * t42 / 0.32e2 - t110 * t1392 * t480 / 0.64e2 + t1397 * t1399 / 0.1152e4 + t46 * t1366 * t30 / 0.32e2);
  t1407 = t1406 * t56;
  t1415 = t188 * t519;
  t1422 = t650 * t1370;
  t1425 = t240 * t435;
  t1426 = t35 * t1425;
  t1429 = t467 * t189;
  t1432 = t467 * t178;
  t1440 = t35 * t25 * t1333;
  t1444 = t70 * t1334 * t27;
  t1448 = t213 * t1339 * t89;
  t1452 = t70 * t1358 * t27;
  t1453 = t1361 * t78;
  t1454 = t1453 * t675;
  t1457 = t360 * t499;
  t1460 = -0.6e1 * t104 * t1330 - t104 * t1387 + t104 * t1407 + 0.6e1 * t104 * t177 * t1169 - 0.3e1 * t104 * t177 * t1177 + 0.6e1 * t104 * t288 * t1415 - 0.3e1 * t104 * t492 * t399 - t1422 * t653 / 0.96e2 + 0.18e2 * t1426 * t468 + 0.54e2 * t465 * t1429 - 0.54e2 * t465 * t1432 + t1422 * t776 / 0.48e2 - 0.3e1 / 0.8e1 * t1422 * t779 + 0.3e1 / 0.8e1 * t1440 * t162 + t1444 * t156 / 0.32e2 - 0.3e1 / 0.8e1 * t1448 * t451 - 0.3e1 / 0.2e1 * t1452 * t1454 + 0.3e1 * t160 * t1457;
  t1461 = t343 * t499;
  t1469 = t70 * t1374 * t27;
  t1471 = t1453 * t240 * t675;
  t1478 = t360 * t493;
  t1481 = t360 * t520;
  t1484 = t1253 * t189;
  t1487 = t1253 * t178;
  t1490 = t343 * t493;
  t1493 = t343 * t520;
  t1502 = t1029 * t1298;
  t1511 = t154 * t1461 / 0.4e1 + 0.3e1 / 0.4e1 * t461 * t473 - 0.3e1 / 0.4e1 * t461 * t471 - 0.3e1 / 0.4e1 * t1469 * t1471 + 0.162e3 * t35 * t464 * t1381 * t724 + 0.3e1 / 0.2e1 * t160 * t1478 - 0.3e1 / 0.2e1 * t160 * t1481 - 0.3e1 / 0.4e1 * t444 * t1484 + 0.3e1 / 0.4e1 * t444 * t1487 + t154 * t1490 / 0.8e1 - t154 * t1493 / 0.8e1 + t438 * t457 / 0.16e2 + t1448 * t447 / 0.32e2 - t438 * t454 / 0.16e2 - 0.3e1 * t1028 * t1502 + t1312 * t1049 / 0.16e2 - t1312 * t1058 / 0.16e2 - t1032 * t1299 / 0.4e1;
  t1512 = t1460 + t1511;
  t1516 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1512);
  tv3sigma30 = 0.2e1 * rho[0] * t1516;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t42, t46, t51, t52, t53, t55, t56, t57;
  double t59, t63, tzk0;

  double t64, t66, t70, t71, t72, t73, t74, t76;
  double t77, t78, t79, t80, t84, t85, t86, t87;
  double t88, t89, t90, t92, t96, t97, t98, t100;
  double t101, t104, t105, t110, t111, t113, t114, t115;
  double t119, t122, t123, t124, t126, t127, t128, t129;
  double t130, t131, t132, t135, t136, t140, t141, t143;
  double t148, tvrho0, t151, t152, t153, t154, t155, t156;
  double t160, t161, t162, t165, t169, t173, t176, t177;
  double t178, t180, t181, t184, t188, t189, t191, t195;
  double tvsigma0;

  double t200, t208, t209, t210, t213, t214, t216, t217;
  double t219, t220, t222, t225, t226, t229, t230, t233;
  double t236, t237, t240, t241, t242, t243, t244, t245;
  double t247, t248, t249, t250, t253, t254, t257, t260;
  double t264, t268, t269, t270, t271, t275, t278, t279;
  double t280, t282, t283, t287, t288, t289, t290, t293;
  double t296, t297, t298, t299, t300, t301, t304, t305;
  double t308, t312, t316, t317, t319, t324, tv2rho20, t332;
  double t334, t335, t338, t339, t340, t343, t344, t347;
  double t352, t353, t354, t355, t356, t357, t360, t361;
  double t364, t367, t370, t376, t384, t387, t388, t389;
  double t391, t393, t396, t399, t400, t402, t403, t408;
  double t409, t413, t414, t424, t425, t427, t432, tv2rhosigma0;
  double t435, t436, t437, t438, t441, t442, t444, t447;
  double t450, t451, t454, t457, t461, t464, t465, t466;
  double t467, t468, t471, t473, t475, t479, t480, t488;
  double t491, t492, t493, t495, t498, t499, t502, t505;
  double t506, t509, t519, t520, t522, t526, tv2sigma20;

  double t529, t540, t541, t546, t551, t552, t553, t557;
  double t558, t560, t564, t566, t567, t574, t575, t577;
  double t578, t581, t585, t588, t589, t590, t595, t599;
  double t604, t605, t606, t607, t608, t612, t619, t620;
  double t621, t622, t623, t626, t627, t628, t629, t631;
  double t632, t634, t636, t637, t640, t641, t643, t644;
  double t645, t646, t647, t650, t651, t652, t653, t656;
  double t657, t660, t663, t664, t667, t668, t672, t673;
  double t674, t675, t679, t682, t683, t686, t691, t694;
  double t697, t700, t703, t706, t707, t710, t711, t715;
  double t717, t724, t727, t730, t737, t738, t739, t740;
  double t741, t742, t745, t747, t748, t751, t754, t755;
  double t756, t757, t760, t767, t771, t776, t779, t782;
  double t785, t788, t789, t794, tv3rho30, t804, t808, t812;
  double t820, t821, t822, t825, t827, t828, t831, t833;
  double t836, t839, t842, t845, t861, t865, t872, t873;
  double t882, t884, t888, t891, t892, t895, t896, t897;
  double t898, t905, t909, t910, t911, t915, t917, t919;
  double t922, t923, t925, t928, t936, t939, t943, t945;
  double t948, t957, t960, t962, t965, t968, t971, t973;
  double t976, t982, t988, t997, t1000, t1003, t1009, t1012;
  double t1019, t1020, t1023, t1024, t1025, t1028, t1029, t1030;
  double t1032, t1035, t1036, t1037, t1038, t1041, t1042, t1045;
  double t1046, t1049, t1052, t1055, t1058, t1064, t1072, t1074;
  double t1079, tv3rho2sigma0, t1091, t1096, t1104, t1105, t1109, t1114;
  double t1126, t1127, t1128, t1137, t1138, t1139, t1143, t1145;
  double t1147, t1150, t1151, t1161, t1165, t1169, t1173, t1177;
  double t1180, t1185, t1186, t1192, t1193, t1194, t1197, t1200;
  double t1203, t1206, t1215, t1218, t1222, t1223, t1232, t1234;
  double t1236, t1238, t1241, t1244, t1247, t1250, t1253, t1254;
  double t1257, t1262, t1272, t1277, t1280, t1289, t1292, t1293;
  double t1296, t1298, t1299, t1302, t1309, t1312, t1319, t1321;
  double t1326, tv3rhosigma20, t1329, t1330, t1333, t1334, t1335, t1338;
  double t1339, t1340, t1345, t1347, t1351, t1355, t1358, t1359;
  double t1361, t1362, t1363, t1366, t1370, t1374, t1375, t1376;
  double t1379, t1381, t1383, t1386, t1387, t1392, t1397, t1399;
  double t1406, t1407, t1415, t1422, t1425, t1426, t1429, t1432;
  double t1440, t1444, t1448, t1452, t1453, t1454, t1457, t1460;
  double t1461, t1469, t1471, t1478, t1481, t1484, t1487, t1490;
  double t1493, t1502, t1511, t1512, t1516, tv3sigma30;

  double t1534, t1535, t1539, t1544, t1545, t1547, t1549, t1551;
  double t1560, t1561, t1569, t1570, t1571, t1575, t1578, t1581;
  double t1588, t1592, t1595, t1596, t1599, t1604, t1605, t1606;
  double t1608, t1609, t1614, t1632, t1635, t1636, t1639, t1644;
  double t1650, t1653, t1656, t1659, t1662, t1670, t1692, t1695;
  double t1696, t1699, t1720, t1721, t1734, t1735, t1736, t1740;
  double t1741, t1745, t1748, t1757, t1759, t1769, t1778, t1786;
  double t1798, t1799, t1839, t1843, t1849, t1854, t1867, t1880;
  double t1881, t1882, t1885, t1889, t1893, t1897, t1900, t1903;
  double t1907, t1910, t1913, t1919, t1921, t1926, t1931, t1932;
  double t1939, t1942, t1945, t1948, t1951, t1954, t1957, t1960;
  double t1961, t1962, t1965, t1966, t1975, t1980, t1991, t1994;
  double t2013, t2021, tv4rho40, t2067, t2070, t2071, t2076, t2086;
  double t2087, t2088, t2102, t2109, t2113, t2133, t2157, t2161;
  double t2174, t2177, t2180, t2188, t2191, t2194, t2198, t2207;
  double t2213, t2216, t2219, t2253, t2313, t2322, t2334, t2363;
  double t2369, t2374, t2377, t2384, t2385, t2386, t2396, t2400;
  double t2410, t2411, t2414, t2415, t2425, t2428, t2434, t2435;
  double t2439, t2447, t2448, t2451, t2454, t2463, t2466, t2467;
  double t2470, t2476, t2480, t2485, t2497, t2502, t2518, t2522;
  double t2537, t2540, t2566, t2593, t2598, t2615, t2636, t2645;
  double t2655, t2664, tv4rho3sigma0, t2684, t2685, t2694, t2699, t2713;
  double t2720, t2724, t2742, t2745, t2784, t2788, t2796, t2802;
  double t2807, t2815, t2819, t2838, t2845, t2864, t2873, t2874;
  double t2909, t2912, t2946, t2950, t2993, t3021, t3063, t3092;
  double t3093, t3096, t3097, t3098, t3101, t3114, t3115, t3121;
  double t3122, t3123, t3130, t3131, t3137, t3139, t3140, t3146;
  double t3147, t3167, t3172, t3174, t3197, t3198, t3204, t3209;
  double t3231, t3236, t3239, t3242, t3245, t3280, t3309, t3347;
  double t3356, tv4rho2sigma20, t3407, t3420, t3442, t3447, t3451, t3469;
  double t3474, t3498, t3532, t3533, t3539, t3541, t3547, t3548;
  double t3554, t3555, t3561, t3562, t3595, t3605, t3608, t3634;
  double t3650, t3664, t3683, t3722, t3776, t3794, t3825, t3831;
  double t3834, t3890, t3899, tv4rhosigma30, t3902, t3908, t3912, t3913;
  double t3914, t3917, t3925, t3933, t3937, t3942, t3943, t3947;
  double t3954, t3960, t3981, t3984, t4017, t4057, t4081, t4091;
  double t4126, t4160, t4170, t4188, t4225, t4251, t4258, tv4sigma40;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t33 = t25 * t31 / 0.12e2;
  t34 = tanh(t33);
  t35 = params->mu * t34;
  t36 = log(t33 + sqrt(t33 * t33 + 0.1e1));
  t37 = 0.1e1 - params->zeta;
  t39 = t37 * t21 * t24;
  t40 = 0.1e1 + t33;
  t41 = log(t40);
  t42 = t30 * t41;
  t46 = params->zeta * t21 * t24;
  t51 = 0.1e1 + params->alpha * (t39 * t28 * t42 / 0.12e2 + t46 * t31 / 0.12e2);
  t52 = t36 * t51;
  t53 = params->beta * t34;
  t55 = t53 * t36 + 0.1e1;
  t56 = 0.1e1 / t55;
  t57 = t52 * t56;
  t59 = t35 * t57 + 0.1e1;
  t63 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t59);
  tzk0 = 0.2e1 * t63;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t64 = t18 * t18;
  t66 = t17 / t64;
  t70 = params->mu * t21;
  t71 = t24 * t26;
  t72 = t71 * t27;
  t73 = t70 * t72;
  t74 = rho[0] * rho[0];
  t76 = 0.1e1 / t18 / t74;
  t77 = t34 * t34;
  t78 = 0.1e1 - t77;
  t79 = t76 * t78;
  t80 = t79 * t57;
  t84 = t35 * t25 * t26;
  t85 = t27 * t76;
  t86 = t23 * t23;
  t87 = 0.1e1 / t86;
  t88 = t20 * t87;
  t89 = t27 * t27;
  t90 = sigma[0] * t89;
  t92 = 0.1e1 / t64 / t74;
  t96 = 0.6e1 * t88 * t90 * t92 + 0.144e3;
  t97 = sqrt(t96);
  t98 = 0.1e1 / t97;
  t100 = t98 * t51 * t56;
  t101 = t85 * t100;
  t104 = t35 * t36;
  t105 = t76 * t41;
  t110 = t37 * t20 * t87;
  t111 = t74 * rho[0];
  t113 = 0.1e1 / t64 / t111;
  t114 = 0.1e1 / t40;
  t115 = t113 * t114;
  t119 = t28 * t76;
  t122 = -t39 * t28 * t105 / 0.9e1 - t110 * t90 * t115 / 0.18e2 - t46 * t119 / 0.9e1;
  t123 = params->alpha * t122;
  t124 = t123 * t56;
  t126 = t55 * t55;
  t127 = 0.1e1 / t126;
  t128 = t51 * t127;
  t129 = params->beta * t21;
  t130 = t129 * t71;
  t131 = t78 * t36;
  t132 = t85 * t131;
  t135 = t53 * t25;
  t136 = t76 * t98;
  t140 = -t130 * t132 / 0.9e1 - 0.4e1 / 0.3e1 * t135 * t28 * t136;
  t141 = t128 * t140;
  t143 = -t73 * t80 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t101 + t104 * t124 - t104 * t141;
  t148 = my_piecewise3(t2, 0, -t6 * t66 * t59 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t143);
  tvrho0 = 0.2e1 * rho[0] * t148 + 0.2e1 * t63;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t151 = 0.1e1 / t26;
  t152 = t24 * t151;
  t153 = t152 * t27;
  t154 = t70 * t153;
  t155 = t30 * t78;
  t156 = t155 * t57;
  t160 = t35 * t25 * t151;
  t161 = t27 * t30;
  t162 = t161 * t100;
  t165 = t151 * t27;
  t169 = t89 * t92;
  t173 = t165 * t30;
  t176 = t39 * t165 * t42 / 0.24e2 + t110 * t169 * t114 / 0.48e2 + t46 * t173 / 0.24e2;
  t177 = params->alpha * t176;
  t178 = t177 * t56;
  t180 = t129 * t152;
  t181 = t161 * t131;
  t184 = t30 * t98;
  t188 = t180 * t181 / 0.24e2 + t135 * t165 * t184 / 0.2e1;
  t189 = t128 * t188;
  t191 = t154 * t156 / 0.24e2 + t160 * t162 / 0.2e1 + t104 * t178 - t104 * t189;
  t195 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t191);
  tvsigma0 = 0.2e1 * rho[0] * t195;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t200 = t17 / t64 / rho[0];
  t208 = 0.1e1 / t18 / t111;
  t209 = t208 * t78;
  t210 = t209 * t57;
  t213 = params->mu * t20;
  t214 = t87 * sigma[0];
  t216 = t213 * t214 * t89;
  t217 = t74 * t74;
  t219 = 0.1e1 / t64 / t217;
  t220 = t219 * t34;
  t222 = t220 * t78 * t57;
  t225 = t219 * t78;
  t226 = t225 * t100;
  t229 = t79 * t36;
  t230 = t229 * t124;
  t233 = t229 * t141;
  t236 = t27 * t208;
  t237 = t236 * t100;
  t240 = 0.1e1 / t22;
  t241 = t26 * sigma[0];
  t242 = t240 * t241;
  t243 = t35 * t242;
  t244 = t217 * t74;
  t245 = 0.1e1 / t244;
  t247 = 0.1e1 / t97 / t96;
  t248 = t245 * t247;
  t249 = t51 * t56;
  t250 = t248 * t249;
  t253 = t85 * t98;
  t254 = t253 * t124;
  t257 = t253 * t141;
  t260 = t208 * t41;
  t264 = t219 * t114;
  t268 = t37 * t240;
  t269 = t241 * t245;
  t270 = t40 * t40;
  t271 = 0.1e1 / t270;
  t275 = t28 * t208;
  t278 = 0.7e1 / 0.27e2 * t39 * t28 * t260 + 0.5e1 / 0.18e2 * t110 * t90 * t264 - 0.2e1 / 0.27e2 * t268 * t269 * t271 + 0.7e1 / 0.27e2 * t46 * t275;
  t279 = params->alpha * t278;
  t280 = t279 * t56;
  t282 = t127 * t140;
  t283 = t123 * t282;
  t287 = 0.1e1 / t126 / t55;
  t288 = t51 * t287;
  t289 = t140 * t140;
  t290 = t288 * t289;
  t293 = t236 * t131;
  t296 = params->beta * t20;
  t297 = t296 * t214;
  t298 = t89 * t219;
  t299 = t34 * t78;
  t300 = t299 * t36;
  t301 = t298 * t300;
  t304 = t78 * t98;
  t305 = t298 * t304;
  t308 = t208 * t98;
  t312 = t53 * t240;
  t316 = 0.7e1 / 0.27e2 * t130 * t293 - 0.4e1 / 0.27e2 * t297 * t301 + 0.16e2 / 0.9e1 * t297 * t305 + 0.28e2 / 0.9e1 * t135 * t28 * t308 - 0.128e3 * t312 * t269 * t247;
  t317 = t128 * t316;
  t319 = 0.7e1 / 0.27e2 * t73 * t210 - 0.4e1 / 0.27e2 * t216 * t222 + 0.16e2 / 0.9e1 * t216 * t226 - 0.2e1 / 0.9e1 * t73 * t230 + 0.2e1 / 0.9e1 * t73 * t233 + 0.28e2 / 0.9e1 * t84 * t237 - 0.128e3 * t243 * t250 - 0.8e1 / 0.3e1 * t84 * t254 + 0.8e1 / 0.3e1 * t84 * t257 + t104 * t280 - 0.2e1 * t104 * t283 + 0.2e1 * t104 * t290 - t104 * t317;
  t324 = my_piecewise3(t2, 0, t6 * t200 * t59 / 0.12e2 - t6 * t66 * t143 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t319);
  tv2rho20 = 0.2e1 * rho[0] * t324 + 0.4e1 * t148;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t332 = t87 * t89;
  t334 = t213 * t332 * t113;
  t335 = t299 * t57;
  t338 = t213 * t332;
  t339 = t113 * t78;
  t340 = t339 * t100;
  t343 = t155 * t36;
  t344 = t343 * t124;
  t347 = t343 * t141;
  t352 = t240 * t26;
  t353 = t35 * t352;
  t354 = t217 * rho[0];
  t355 = 0.1e1 / t354;
  t356 = t355 * t247;
  t357 = t356 * t249;
  t360 = t161 * t98;
  t361 = t360 * t124;
  t364 = t360 * t141;
  t367 = t229 * t178;
  t370 = t253 * t178;
  t376 = t89 * t113;
  t384 = t165 * t76;
  t387 = -t39 * t165 * t105 / 0.18e2 - t110 * t376 * t114 / 0.12e2 + t268 * t355 * t271 * t26 / 0.36e2 - t46 * t384 / 0.18e2;
  t388 = params->alpha * t387;
  t389 = t388 * t56;
  t391 = t177 * t282;
  t393 = t229 * t189;
  t396 = t253 * t189;
  t399 = t127 * t188;
  t400 = t123 * t399;
  t402 = t188 * t140;
  t403 = t288 * t402;
  t408 = t296 * t332;
  t409 = t113 * t34;
  t413 = t296 * t87;
  t414 = t376 * t304;
  t424 = -t180 * t132 / 0.18e2 + t408 * t409 * t131 / 0.18e2 - 0.2e1 / 0.3e1 * t413 * t414 - 0.2e1 / 0.3e1 * t135 * t165 * t136 + 0.48e2 * t312 * t26 * t355 * t247;
  t425 = t128 * t424;
  t427 = -t154 * t80 / 0.18e2 + t334 * t335 / 0.18e2 - 0.2e1 / 0.3e1 * t338 * t340 + t154 * t344 / 0.24e2 - t154 * t347 / 0.24e2 - 0.2e1 / 0.3e1 * t160 * t101 + 0.48e2 * t353 * t357 + t160 * t361 / 0.2e1 - t160 * t364 / 0.2e1 - t73 * t367 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t370 + t104 * t389 - t104 * t391 + t73 * t393 / 0.9e1 + 0.4e1 / 0.3e1 * t84 * t396 - t104 * t400 + 0.2e1 * t104 * t403 - t104 * t425;
  t432 = my_piecewise3(t2, 0, -t6 * t66 * t191 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t427);
  tv2rhosigma0 = 0.2e1 * rho[0] * t432 + 0.2e1 * t195;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t435 = 0.1e1 / t241;
  t436 = t24 * t435;
  t437 = t436 * t27;
  t438 = t70 * t437;
  t441 = 0.1e1 / sigma[0];
  t442 = t87 * t441;
  t444 = t213 * t442 * t89;
  t447 = t92 * t34 * t78 * t57;
  t450 = t92 * t78;
  t451 = t450 * t100;
  t454 = t343 * t178;
  t457 = t343 * t189;
  t461 = t35 * t25 * t435;
  t464 = t240 * t151;
  t465 = t35 * t464;
  t466 = 0.1e1 / t217;
  t467 = t466 * t247;
  t468 = t467 * t249;
  t471 = t360 * t178;
  t473 = t360 * t189;
  t475 = t435 * t27;
  t479 = t441 * t89;
  t480 = t92 * t114;
  t488 = t475 * t30;
  t491 = -t39 * t475 * t42 / 0.48e2 + t110 * t479 * t480 / 0.96e2 - t268 * t466 * t271 * t151 / 0.96e2 - t46 * t488 / 0.48e2;
  t492 = params->alpha * t491;
  t493 = t492 * t56;
  t495 = t177 * t399;
  t498 = t188 * t188;
  t499 = t288 * t498;
  t502 = t129 * t436;
  t505 = t296 * t442;
  t506 = t169 * t300;
  t509 = t169 * t304;
  t519 = -t502 * t181 / 0.48e2 - t505 * t506 / 0.48e2 + t505 * t509 / 0.4e1 - t135 * t475 * t184 / 0.4e1 - 0.18e2 * t312 * t151 * t466 * t247;
  t520 = t128 * t519;
  t522 = -t438 * t156 / 0.48e2 - t444 * t447 / 0.48e2 + t444 * t451 / 0.4e1 + t154 * t454 / 0.12e2 - t154 * t457 / 0.12e2 - t461 * t162 / 0.4e1 - 0.18e2 * t465 * t468 + t160 * t471 - t160 * t473 + t104 * t493 - 0.2e1 * t104 * t495 + 0.2e1 * t104 * t499 - t104 * t520;
  t526 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t522);
  tv2sigma20 = 0.2e1 * rho[0] * t526;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t529 = t17 * t92;
  t540 = 0.1e1 / t18 / t217;
  t541 = t540 * t41;
  t546 = 0.1e1 / t64 / t354;
  t551 = t217 * t111;
  t552 = 0.1e1 / t551;
  t553 = t241 * t552;
  t557 = sigma[0] * sigma[0];
  t558 = t217 * t217;
  t560 = 0.1e1 / t18 / t558;
  t564 = 0.1e1 / t270 / t40;
  t566 = t24 * t27;
  t567 = t564 * t21 * t566;
  t574 = params->alpha * (-0.7e2 / 0.81e2 * t39 * t28 * t541 - 0.119e3 / 0.81e2 * t110 * t90 * t546 * t114 + 0.22e2 / 0.27e2 * t268 * t553 * t271 - 0.4e1 / 0.243e3 * t268 * t557 * t560 * t567 - 0.7e2 / 0.81e2 * t46 * t28 * t540);
  t575 = t574 * t56;
  t577 = t27 * t540;
  t578 = t577 * t131;
  t581 = t89 * t546;
  t585 = t581 * t304;
  t588 = params->beta * t240;
  t589 = t588 * t241;
  t590 = t78 * t78;
  t595 = t552 * t77;
  t599 = t552 * t34;
  t604 = 0.1e1 / t23 / t22;
  t605 = t604 * t557;
  t606 = t129 * t605;
  t607 = t27 * t560;
  t608 = t78 * t247;
  t612 = t540 * t98;
  t619 = t24 * t557;
  t620 = t129 * t619;
  t621 = t78 * t240;
  t622 = t621 * t247;
  t623 = t607 * t622;
  t626 = t26 * t557;
  t627 = t240 * t626;
  t628 = t53 * t627;
  t629 = t558 * rho[0];
  t631 = 0.1e1 / t64 / t629;
  t632 = t96 * t96;
  t634 = 0.1e1 / t97 / t632;
  t636 = t88 * t89;
  t637 = t631 * t634 * t636;
  t640 = -0.7e2 / 0.81e2 * t130 * t578 + 0.28e2 / 0.27e2 * t297 * t581 * t300 - 0.112e3 / 0.9e1 * t297 * t585 + 0.16e2 / 0.81e2 * t589 * t552 * t590 * t36 - 0.32e2 / 0.81e2 * t589 * t595 * t131 + 0.64e2 / 0.9e1 * t589 * t599 * t304 + 0.256e3 / 0.9e1 * t606 * t607 * t608 - 0.28e3 / 0.27e2 * t135 * t28 * t612 + 0.32e4 / 0.3e1 * t312 * t553 * t247 + 0.128e3 / 0.9e1 * t620 * t623 - 0.3072e4 * t628 * t637;
  t641 = t128 * t640;
  t643 = t126 * t126;
  t644 = 0.1e1 / t643;
  t645 = t51 * t644;
  t646 = t289 * t140;
  t647 = t645 * t646;
  t650 = params->mu * t240;
  t651 = t650 * t553;
  t652 = t590 * t36;
  t653 = t652 * t249;
  t656 = t552 * t247;
  t657 = t656 * t249;
  t660 = t577 * t100;
  t663 = t540 * t78;
  t664 = t663 * t57;
  t667 = t546 * t78;
  t668 = t667 * t100;
  t672 = t70 * t605 * t27;
  t673 = t560 * t78;
  t674 = t247 * t51;
  t675 = t674 * t56;
  t679 = t229 * t280;
  t682 = t209 * t36;
  t683 = t682 * t141;
  t686 = t546 * t34;
  t691 = t682 * t124;
  t694 = t253 * t290;
  t697 = t229 * t290;
  t700 = t253 * t317;
  t703 = t229 * t317;
  t706 = t236 * t98;
  t707 = t706 * t141;
  t710 = t104 * t575 - t104 * t641 - 0.6e1 * t104 * t647 + 0.16e2 / 0.81e2 * t651 * t653 + 0.32e4 / 0.3e1 * t243 * t657 - 0.28e3 / 0.27e2 * t84 * t660 - 0.7e2 / 0.81e2 * t73 * t664 - 0.112e3 / 0.9e1 * t216 * t668 + 0.256e3 / 0.9e1 * t672 * t673 * t675 - t73 * t679 / 0.3e1 - 0.7e1 / 0.9e1 * t73 * t683 + 0.28e2 / 0.27e2 * t216 * t686 * t78 * t57 + 0.7e1 / 0.9e1 * t73 * t691 - 0.8e1 * t84 * t694 - 0.2e1 / 0.3e1 * t73 * t697 + 0.4e1 * t84 * t700 + t73 * t703 / 0.3e1 - 0.28e2 / 0.3e1 * t84 * t707;
  t711 = t706 * t124;
  t715 = t70 * t619 * t27;
  t717 = t673 * t240 * t675;
  t724 = t634 * t51 * t56 * t636;
  t727 = t253 * t280;
  t730 = t225 * t98;
  t737 = t35 * t21;
  t738 = t737 * t72;
  t739 = t136 * params->alpha;
  t740 = t122 * t127;
  t741 = t740 * t140;
  t742 = t739 * t741;
  t745 = t213 * t87;
  t747 = t745 * t90 * t219;
  t748 = t300 * t141;
  t751 = t300 * t124;
  t754 = t70 * t24;
  t755 = t754 * t119;
  t756 = t131 * params->alpha;
  t757 = t756 * t741;
  t760 = t287 * t289;
  t767 = t127 * t316;
  t771 = t140 * t316;
  t776 = t77 * t78 * t57;
  t779 = t299 * t100;
  t782 = t248 * t141;
  t785 = t248 * t124;
  t788 = 0.28e2 / 0.3e1 * t84 * t711 + 0.128e3 / 0.9e1 * t715 * t717 - 0.3072e4 * t35 * t627 * t631 * t724 - 0.4e1 * t84 * t727 - 0.16e2 / 0.3e1 * t216 * t730 * t141 + 0.16e2 / 0.3e1 * t216 * t730 * t124 + 0.8e1 * t738 * t742 + 0.4e1 / 0.9e1 * t747 * t748 - 0.4e1 / 0.9e1 * t747 * t751 + 0.2e1 / 0.3e1 * t755 * t757 + 0.6e1 * t104 * t123 * t760 - 0.3e1 * t104 * t279 * t282 - 0.3e1 * t104 * t123 * t767 + 0.6e1 * t104 * t288 * t771 - 0.32e2 / 0.81e2 * t651 * t776 + 0.64e2 / 0.9e1 * t651 * t779 + 0.384e3 * t243 * t782 - 0.384e3 * t243 * t785;
  t789 = t710 + t788;
  t794 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t529 * t59 + t6 * t200 * t143 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t66 * t319 - 0.3e1 / 0.8e1 * t6 * t19 * t789);
  tv3rho30 = 0.2e1 * rho[0] * t794 + 0.6e1 * t324;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t804 = t127 * t424;
  t808 = t424 * t140;
  t812 = t188 * t316;
  t820 = t35 * t36 * params->alpha;
  t821 = t122 * t287;
  t822 = t821 * t402;
  t825 = t245 * t77;
  t827 = t26 * t78;
  t828 = t827 * t57;
  t831 = t245 * t34;
  t833 = t827 * t100;
  t836 = t356 * t141;
  t839 = t356 * t124;
  t842 = t248 * t178;
  t845 = t248 * t189;
  t861 = 0.1e1 / t18 / t551;
  t865 = sigma[0] * t21 * t566;
  t872 = params->alpha * (0.7e1 / 0.54e2 * t39 * t165 * t260 + 0.37e2 / 0.108e3 * t110 * t298 * t114 - t268 * t245 * t271 * t26 / 0.4e1 + t268 * t861 * t564 * t865 / 0.162e3 + 0.7e1 / 0.54e2 * t46 * t165 * t208);
  t873 = t872 * t56;
  t882 = t588 * t245;
  t884 = t26 * t590 * t36;
  t888 = t77 * t26 * t131;
  t891 = t26 * t98;
  t892 = t299 * t891;
  t895 = t604 * t27;
  t896 = t129 * t895;
  t897 = t861 * t78;
  t898 = t247 * sigma[0];
  t905 = t26 * t245;
  t909 = t24 * sigma[0];
  t910 = t129 * t909;
  t911 = t27 * t861;
  t915 = t53 * t242;
  t917 = 0.1e1 / t64 / t558;
  t919 = t917 * t634 * t636;
  t922 = 0.7e1 / 0.54e2 * t180 * t293 - 0.5e1 / 0.18e2 * t408 * t220 * t131 + 0.1e2 / 0.3e1 * t413 * t305 - 0.2e1 / 0.27e2 * t882 * t884 + 0.4e1 / 0.27e2 * t882 * t888 - 0.8e1 / 0.3e1 * t882 * t892 - 0.32e2 / 0.3e1 * t896 * t897 * t898 + 0.14e2 / 0.9e1 * t135 * t165 * t308 - 0.304e3 * t312 * t905 * t247 - 0.16e2 / 0.3e1 * t910 * t911 * t622 + 0.1152e4 * t915 * t919;
  t923 = t128 * t922;
  t925 = t650 * t905;
  t928 = -0.2e1 * t104 * t123 * t804 + 0.4e1 * t104 * t288 * t808 + 0.2e1 * t104 * t288 * t812 - 0.2e1 * t104 * t388 * t282 + 0.4e1 * t820 * t822 + 0.4e1 / 0.27e2 * t650 * t825 * t828 - 0.8e1 / 0.3e1 * t650 * t831 * t833 - 0.96e2 * t353 * t836 + 0.96e2 * t353 * t839 - 0.128e3 * t243 * t842 + 0.128e3 * t243 * t845 + 0.1e2 / 0.3e1 * t338 * t226 + t104 * t873 - t104 * t923 - 0.2e1 / 0.27e2 * t925 * t653;
  t936 = t213 * t332 * t219;
  t939 = t304 * t141;
  t943 = t70 * t895 * t861;
  t945 = t608 * t249 * sigma[0];
  t948 = t304 * t124;
  t957 = t706 * t189;
  t960 = t360 * t290;
  t962 = t682 * t178;
  t965 = t706 * t178;
  t968 = t343 * t290;
  t971 = -0.304e3 * t353 * t250 + 0.14e2 / 0.9e1 * t160 * t237 + 0.7e1 / 0.54e2 * t154 * t210 - 0.5e1 / 0.18e2 * t936 * t335 + 0.4e1 / 0.3e1 * t334 * t939 - 0.32e2 / 0.3e1 * t943 * t945 - 0.4e1 / 0.3e1 * t334 * t948 - t154 * t230 / 0.9e1 - t334 * t748 / 0.9e1 + t334 * t751 / 0.9e1 - 0.28e2 / 0.9e1 * t84 * t957 + t160 * t960 + 0.7e1 / 0.27e2 * t73 * t962 + 0.28e2 / 0.9e1 * t84 * t965 + t154 * t968 / 0.12e2;
  t973 = t253 * t389;
  t976 = t229 * t425;
  t982 = t253 * t425;
  t988 = t70 * t909 * t27;
  t997 = t360 * t280;
  t1000 = t360 * t317;
  t1003 = t229 * t389;
  t1009 = t343 * t280;
  t1012 = t343 * t317;
  t1019 = -0.8e1 / 0.3e1 * t84 * t973 + 0.2e1 / 0.9e1 * t73 * t976 - 0.16e2 / 0.9e1 * t216 * t730 * t189 + 0.8e1 / 0.3e1 * t84 * t982 - 0.4e1 / 0.3e1 * t160 * t254 - 0.16e2 / 0.3e1 * t988 * t897 * t240 * t675 + 0.1152e4 * t35 * t242 * t917 * t724 + t160 * t997 / 0.2e1 - t160 * t1000 / 0.2e1 - 0.2e1 / 0.9e1 * t73 * t1003 + 0.16e2 / 0.9e1 * t216 * t730 * t178 + t154 * t1009 / 0.24e2 - t154 * t1012 / 0.24e2 + 0.4e1 / 0.3e1 * t160 * t257 + t154 * t233 / 0.9e1;
  t1020 = t682 * t189;
  t1023 = t176 * t127;
  t1024 = t1023 * t140;
  t1025 = t739 * t1024;
  t1028 = t737 * t153;
  t1029 = t184 * params->alpha;
  t1030 = t1029 * t741;
  t1032 = t754 * t173;
  t1035 = t136 * t51;
  t1036 = t287 * t188;
  t1037 = t1036 * t140;
  t1038 = t1035 * t1037;
  t1041 = t740 * t188;
  t1042 = t739 * t1041;
  t1045 = t131 * t51;
  t1046 = t1045 * t1037;
  t1049 = t300 * t189;
  t1052 = t756 * t1041;
  t1055 = t756 * t1024;
  t1058 = t300 * t178;
  t1064 = t188 * t289;
  t1072 = -0.7e1 / 0.27e2 * t73 * t1020 + 0.8e1 / 0.3e1 * t738 * t1025 - t1028 * t1030 - t1032 * t757 / 0.12e2 - 0.16e2 / 0.3e1 * t738 * t1038 + 0.8e1 / 0.3e1 * t738 * t1042 - 0.4e1 / 0.9e1 * t755 * t1046 + 0.4e1 / 0.27e2 * t747 * t1049 + 0.2e1 / 0.9e1 * t755 * t1052 + 0.2e1 / 0.9e1 * t755 * t1055 - 0.4e1 / 0.27e2 * t747 * t1058 + 0.2e1 * t104 * t177 * t760 - 0.6e1 * t104 * t645 * t1064 - t104 * t177 * t767 - t104 * t279 * t399;
  t1074 = t928 + t971 + t1019 + t1072;
  t1079 = my_piecewise3(t2, 0, t6 * t200 * t191 / 0.12e2 - t6 * t66 * t427 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1074);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t1079 + 0.4e1 * t432;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1091 = t151 * t355;
  t1096 = 0.1e1 / t18 / t244;
  t1104 = params->alpha * (t39 * t475 * t105 / 0.36e2 - t110 * t479 * t115 / 0.72e2 + t268 * t1091 * t271 / 0.18e2 - t268 * t1096 * t567 / 0.432e3 + t46 * t475 * t76 / 0.36e2);
  t1105 = t1104 * t56;
  t1109 = t376 * t300;
  t1114 = t588 * t151;
  t1126 = t129 * t604;
  t1127 = t27 * t1096;
  t1128 = t1127 * t608;
  t1137 = t129 * t566;
  t1138 = t1096 * t78;
  t1139 = t240 * t247;
  t1143 = t53 * t352;
  t1145 = 0.1e1 / t64 / t551;
  t1147 = t1145 * t634 * t636;
  t1150 = t502 * t132 / 0.36e2 + t505 * t1109 / 0.36e2 - t505 * t414 / 0.3e1 + t1114 * t355 * t590 * t36 / 0.36e2 - t1114 * t355 * t77 * t131 / 0.18e2 + t1114 * t355 * t34 * t304 + 0.4e1 * t1126 * t1128 + t135 * t475 * t136 / 0.3e1 + 0.48e2 * t312 * t1091 * t247 + 0.2e1 * t1137 * t1138 * t1139 - 0.432e3 * t1143 * t1147;
  t1151 = t128 * t1150;
  t1161 = t498 * t140;
  t1165 = t188 * t424;
  t1169 = t287 * t498;
  t1173 = t519 * t140;
  t1177 = t127 * t519;
  t1180 = t650 * t1091;
  t1185 = t176 * t287;
  t1186 = t1185 * t402;
  t1192 = t104 * t1105 - t104 * t1151 - t104 * t492 * t282 - 0.2e1 * t104 * t388 * t399 - 0.2e1 * t104 * t177 * t804 - 0.6e1 * t104 * t645 * t1161 + 0.4e1 * t104 * t288 * t1165 + 0.2e1 * t104 * t123 * t1169 + 0.2e1 * t104 * t288 * t1173 - t104 * t123 * t1177 + t1180 * t653 / 0.36e2 + 0.48e2 * t465 * t357 + 0.4e1 * t820 * t1186 - t1180 * t776 / 0.18e2 + t1180 * t779;
  t1193 = t70 * t895;
  t1194 = t1138 * t675;
  t1197 = t467 * t141;
  t1200 = t467 * t124;
  t1203 = t356 * t178;
  t1206 = t356 * t189;
  t1215 = t304 * t178;
  t1218 = t304 * t189;
  t1222 = t70 * t566 * t1096;
  t1223 = t621 * t675;
  t1232 = t360 * t389;
  t1234 = t360 * t425;
  t1236 = 0.4e1 * t1193 * t1194 + 0.18e2 * t465 * t1197 - 0.18e2 * t465 * t1200 + 0.96e2 * t353 * t1203 - 0.96e2 * t353 * t1206 + t461 * t101 / 0.3e1 + t438 * t80 / 0.36e2 - t444 * t340 / 0.3e1 - 0.4e1 / 0.3e1 * t334 * t1215 + 0.4e1 / 0.3e1 * t334 * t1218 + 0.2e1 * t1222 * t1223 - t461 * t361 / 0.4e1 - 0.432e3 * t35 * t352 * t1145 * t724 + t160 * t1232 - t160 * t1234;
  t1238 = t229 * t493;
  t1241 = t253 * t493;
  t1244 = t229 * t499;
  t1247 = t253 * t499;
  t1250 = t229 * t520;
  t1253 = t450 * t98;
  t1254 = t1253 * t124;
  t1257 = t343 * t389;
  t1262 = t343 * t425;
  t1272 = t409 * t78 * t57;
  t1277 = t1253 * t141;
  t1280 = -t73 * t1238 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t1241 - 0.2e1 / 0.9e1 * t73 * t1244 - 0.8e1 / 0.3e1 * t84 * t1247 + t73 * t1250 / 0.9e1 + t444 * t1254 / 0.4e1 + t154 * t1257 / 0.12e2 + t334 * t1058 / 0.9e1 - t154 * t1262 / 0.12e2 - t334 * t1049 / 0.9e1 + t461 * t364 / 0.4e1 + t438 * t347 / 0.48e2 + t444 * t1272 / 0.36e2 - t438 * t344 / 0.48e2 - t444 * t1277 / 0.4e1;
  t1289 = t253 * t520;
  t1292 = t184 * t51;
  t1293 = t1292 * t1037;
  t1296 = t1029 * t1041;
  t1298 = t1023 * t188;
  t1299 = t756 * t1298;
  t1302 = t739 * t1298;
  t1309 = t1029 * t1024;
  t1312 = t745 * t479 * t92;
  t1319 = 0.4e1 / 0.3e1 * t160 * t396 + t154 * t393 / 0.9e1 - 0.4e1 / 0.3e1 * t160 * t370 - t154 * t367 / 0.9e1 + 0.4e1 / 0.3e1 * t84 * t1289 + 0.2e1 * t1028 * t1293 - t1028 * t1296 + 0.2e1 / 0.9e1 * t755 * t1299 + 0.8e1 / 0.3e1 * t738 * t1302 + t1032 * t1046 / 0.6e1 - t1032 * t1052 / 0.12e2 - t1028 * t1309 + t1312 * t748 / 0.48e2 - t1312 * t751 / 0.48e2 - t1032 * t1055 / 0.12e2;
  t1321 = t1192 + t1236 + t1280 + t1319;
  t1326 = my_piecewise3(t2, 0, -t6 * t66 * t522 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1321);
  tv3rhosigma20 = 0.2e1 * rho[0] * t1326 + 0.2e1 * t526;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1329 = t498 * t188;
  t1330 = t645 * t1329;
  t1333 = 0.1e1 / t626;
  t1334 = t24 * t1333;
  t1335 = t129 * t1334;
  t1338 = 0.1e1 / t557;
  t1339 = t87 * t1338;
  t1340 = t296 * t1339;
  t1345 = t588 * t435;
  t1347 = t466 * t590 * t36;
  t1351 = t466 * t77 * t131;
  t1355 = t466 * t34 * t304;
  t1358 = t604 * t441;
  t1359 = t129 * t1358;
  t1361 = 0.1e1 / t18 / t354;
  t1362 = t27 * t1361;
  t1363 = t1362 * t608;
  t1366 = t1333 * t27;
  t1370 = t435 * t466;
  t1374 = t24 * t441;
  t1375 = t129 * t1374;
  t1376 = t1362 * t622;
  t1379 = t53 * t464;
  t1381 = 0.1e1 / t64 / t244;
  t1383 = t1381 * t634 * t636;
  t1386 = t1335 * t181 / 0.32e2 + t1340 * t506 / 0.32e2 - 0.3e1 / 0.8e1 * t1340 * t509 - t1345 * t1347 / 0.96e2 + t1345 * t1351 / 0.48e2 - 0.3e1 / 0.8e1 * t1345 * t1355 - 0.3e1 / 0.2e1 * t1359 * t1363 + 0.3e1 / 0.8e1 * t135 * t1366 * t184 + 0.18e2 * t312 * t1370 * t247 - 0.3e1 / 0.4e1 * t1375 * t1376 + 0.162e3 * t1379 * t1383;
  t1387 = t128 * t1386;
  t1392 = t1338 * t89;
  t1397 = t268 * t1361 * t564;
  t1399 = t441 * t21 * t566;
  t1406 = params->alpha * (t39 * t1366 * t42 / 0.32e2 - t110 * t1392 * t480 / 0.64e2 + t1397 * t1399 / 0.1152e4 + t46 * t1366 * t30 / 0.32e2);
  t1407 = t1406 * t56;
  t1415 = t188 * t519;
  t1422 = t650 * t1370;
  t1425 = t240 * t435;
  t1426 = t35 * t1425;
  t1429 = t467 * t189;
  t1432 = t467 * t178;
  t1440 = t35 * t25 * t1333;
  t1444 = t70 * t1334 * t27;
  t1448 = t213 * t1339 * t89;
  t1452 = t70 * t1358 * t27;
  t1453 = t1361 * t78;
  t1454 = t1453 * t675;
  t1457 = t360 * t499;
  t1460 = -0.6e1 * t104 * t1330 - t104 * t1387 + t104 * t1407 + 0.6e1 * t104 * t177 * t1169 - 0.3e1 * t104 * t177 * t1177 + 0.6e1 * t104 * t288 * t1415 - 0.3e1 * t104 * t492 * t399 - t1422 * t653 / 0.96e2 + 0.18e2 * t1426 * t468 + 0.54e2 * t465 * t1429 - 0.54e2 * t465 * t1432 + t1422 * t776 / 0.48e2 - 0.3e1 / 0.8e1 * t1422 * t779 + 0.3e1 / 0.8e1 * t1440 * t162 + t1444 * t156 / 0.32e2 - 0.3e1 / 0.8e1 * t1448 * t451 - 0.3e1 / 0.2e1 * t1452 * t1454 + 0.3e1 * t160 * t1457;
  t1461 = t343 * t499;
  t1469 = t70 * t1374 * t27;
  t1471 = t1453 * t240 * t675;
  t1478 = t360 * t493;
  t1481 = t360 * t520;
  t1484 = t1253 * t189;
  t1487 = t1253 * t178;
  t1490 = t343 * t493;
  t1493 = t343 * t520;
  t1502 = t1029 * t1298;
  t1511 = t154 * t1461 / 0.4e1 + 0.3e1 / 0.4e1 * t461 * t473 - 0.3e1 / 0.4e1 * t461 * t471 - 0.3e1 / 0.4e1 * t1469 * t1471 + 0.162e3 * t35 * t464 * t1381 * t724 + 0.3e1 / 0.2e1 * t160 * t1478 - 0.3e1 / 0.2e1 * t160 * t1481 - 0.3e1 / 0.4e1 * t444 * t1484 + 0.3e1 / 0.4e1 * t444 * t1487 + t154 * t1490 / 0.8e1 - t154 * t1493 / 0.8e1 + t438 * t457 / 0.16e2 + t1448 * t447 / 0.32e2 - t438 * t454 / 0.16e2 - 0.3e1 * t1028 * t1502 + t1312 * t1049 / 0.16e2 - t1312 * t1058 / 0.16e2 - t1032 * t1299 / 0.4e1;
  t1512 = t1460 + t1511;
  t1516 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1512);
  tv3sigma30 = 0.2e1 * rho[0] * t1516;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1534 = t51 / t643 / t55;
  t1535 = t289 * t289;
  t1539 = t316 * t316;
  t1544 = 0.1e1 / t86 / t22;
  t1545 = t1544 * t626;
  t1547 = t558 * t74;
  t1549 = 0.1e1 / t64 / t1547;
  t1551 = t299 * t247;
  t1560 = 0.1e1 / t18 / t629;
  t1561 = t27 * t1560;
  t1569 = t557 * sigma[0];
  t1570 = t26 * t1569;
  t1571 = t240 * t1570;
  t1575 = 0.1e1 / t18 / t558 / t354;
  t1578 = 0.1e1 / t97 / t632 / t96;
  t1581 = t21 * t604 * t27;
  t1588 = t89 * t1381;
  t1592 = t557 * t1560;
  t1595 = t566 * t98;
  t1596 = t590 * t21 * t1595;
  t1599 = 0.1e1 / t558;
  t1604 = t22 * t22;
  t1605 = 0.1e1 / t1604;
  t1606 = params->beta * t1605;
  t1608 = t558 * t217;
  t1609 = 0.1e1 / t1608;
  t1614 = t241 * t1599;
  t1632 = t1592 * t590;
  t1635 = t25 * t27;
  t1636 = t36 * t34 * t1635;
  t1639 = t77 * t34;
  t1644 = t25 * t27 * t78 * t36;
  t1650 = t78 * t21 * t1595;
  t1653 = t626 * t1549;
  t1656 = t608 * t636;
  t1659 = 0.1024e4 / 0.27e2 * t296 * t1545 * t89 * t1549 * t1551 + 0.364e4 / 0.81e2 * t135 * t28 * t1361 * t98 - 0.64e4 / 0.27e2 * t620 * t1561 * t622 + 0.55296e5 * t628 * t1549 * t634 * t636 - 0.24576e6 * t53 * t1571 * t1575 * t1578 * t1581 + 0.91e3 / 0.243e3 * t130 * t1362 * t131 - 0.1708e4 / 0.243e3 * t297 * t1588 * t300 - 0.256e3 / 0.243e3 * t588 * t1592 * t1596 - 0.224e3 / 0.81e2 * t589 * t1599 * t590 * t36 + 0.16384e5 * t1606 * t1569 * t1609 * t78 * t634 - 0.7616e5 / 0.9e1 * t312 * t1614 * t247 + 0.6832e4 / 0.81e2 * t297 * t1588 * t304 - 0.11776e5 / 0.27e2 * t606 * t1561 * t608 + 0.448e3 / 0.81e2 * t589 * t1599 * t77 * t131 - 0.896e3 / 0.9e1 * t589 * t1599 * t34 * t304 + 0.128e3 / 0.729e3 * t588 * t1632 * t1636 - 0.64e2 / 0.729e3 * t588 * t1592 * t1639 * t1644 + 0.512e3 / 0.243e3 * t588 * t1592 * t77 * t1650 + 0.2048e4 / 0.27e2 * t588 * t1653 * t34 * t1656;
  t1662 = t127 * t640;
  t1670 = t644 * t646;
  t1692 = params->mu * t1605;
  t1695 = t78 * t634;
  t1696 = t1695 * t249;
  t1699 = t650 * t1614;
  t1720 = t270 * t270;
  t1721 = 0.1e1 / t1720;
  t1734 = t35 * t242 * t245;
  t1735 = t247 * params->alpha;
  t1736 = t1735 * t741;
  t1740 = t650 * t553 * t77;
  t1741 = t131 * t141;
  t1745 = t650 * t553 * t34;
  t1748 = t131 * t124;
  t1757 = -0.7616e5 / 0.9e1 * t243 * t1599 * t247 * t249 + 0.16384e5 * t1692 * t1569 * t1609 * t1696 - 0.224e3 / 0.81e2 * t1699 * t653 + 0.24e2 * t820 * t821 * t771 + t104 * params->alpha * (0.91e3 / 0.243e3 * t39 * t28 * t1361 * t41 + 0.721e3 / 0.81e2 * t110 * t90 * t1381 * t114 - 0.1862e4 / 0.243e3 * t268 * t1614 * t271 + 0.232e3 / 0.729e3 * t268 * t1592 * t567 - 0.8e1 / 0.243e3 * t268 * t1653 * t1721 * t20 * t332 + 0.91e3 / 0.243e3 * t46 * t28 * t1361) * t56 + 0.1536e4 * t1734 * t1736 + 0.128e3 / 0.81e2 * t1740 * t1741 - 0.256e3 / 0.9e1 * t1745 * t939 - 0.128e3 / 0.81e2 * t1740 * t1748 + 0.256e3 / 0.9e1 * t1745 * t948 + 0.6832e4 / 0.81e2 * t216 * t1381 * t78 * t100;
  t1759 = t1560 * t78;
  t1769 = t300 * t283;
  t1778 = t667 * t98;
  t1786 = t1578 * t51 * t56 * t1581;
  t1798 = -0.11776e5 / 0.27e2 * t672 * t1759 * t675 + 0.91e3 / 0.243e3 * t73 * t1453 * t57 + 0.364e4 / 0.81e2 * t84 * t1362 * t100 + 0.16e2 / 0.9e1 * t747 * t1769 + 0.28e2 / 0.9e1 * t73 * t682 * t290 + 0.8e1 / 0.3e1 * t73 * t229 * t647 - 0.448e3 / 0.9e1 * t216 * t1778 * t124 - 0.24576e6 * t35 * t1571 * t1575 * t1786 + 0.16e2 / 0.3e1 * t84 * t253 * t641 - 0.32e2 / 0.3e1 * t216 * t730 * t317 + 0.4e1 / 0.9e1 * t73 * t229 * t641;
  t1799 = t577 * t98;
  t1839 = 0.112e4 / 0.27e2 * t84 * t1799 * t141 - 0.112e4 / 0.27e2 * t84 * t1799 * t124 + 0.64e2 / 0.3e1 * t216 * t730 * t290 + 0.14e2 / 0.9e1 * t73 * t682 * t280 - 0.64e4 / 0.27e2 * t715 * t1759 * t240 * t675 + 0.55296e5 * t35 * t627 * t1549 * t724 - 0.56e2 / 0.3e1 * t84 * t706 * t317 - 0.14e2 / 0.9e1 * t73 * t682 * t317 + 0.112e3 / 0.3e1 * t84 * t706 * t290 + 0.32e2 * t84 * t253 * t647 + 0.1024e4 / 0.27e2 * t213 * t1545 * t89 * t1549 * t34 * t78 * t675;
  t1843 = t1635 * t100;
  t1849 = t663 * t36;
  t1854 = t1381 * t34 * t78;
  t1867 = t673 * t247;
  t1880 = -0.256e3 / 0.243e3 * t650 * t1632 * t1843 - 0.4e1 / 0.9e1 * t73 * t229 * t575 + 0.28e3 / 0.81e2 * t73 * t1849 * t141 - 0.1708e4 / 0.243e3 * t216 * t1854 * t57 - 0.28e3 / 0.81e2 * t73 * t1849 * t124 - 0.16e2 / 0.3e1 * t84 * t253 * t575 + 0.32e2 / 0.3e1 * t216 * t730 * t280 - 0.1024e4 / 0.9e1 * t672 * t1867 * t141 + 0.1024e4 / 0.9e1 * t672 * t1867 * t124 + 0.448e3 / 0.9e1 * t216 * t1778 * t141 + 0.56e2 / 0.3e1 * t84 * t706 * t280;
  t1881 = t304 * params->alpha;
  t1882 = t1881 * t741;
  t1885 = t300 * t317;
  t1889 = t287 * t140 * t316;
  t1893 = t821 * t289;
  t1897 = t1045 * t1889;
  t1900 = t300 * t290;
  t1903 = t756 * t1893;
  t1907 = t745 * t90 * t546;
  t1910 = t754 * t275;
  t1913 = t308 * params->alpha;
  t1919 = -0.64e2 / 0.3e1 * t747 * t1882 + 0.8e1 / 0.9e1 * t747 * t1885 - 0.32e2 * t738 * t1035 * t1889 - 0.32e2 * t738 * t739 * t1893 - 0.8e1 / 0.3e1 * t755 * t1897 - 0.16e2 / 0.9e1 * t747 * t1900 - 0.8e1 / 0.3e1 * t755 * t1903 + 0.112e3 / 0.27e2 * t1907 * t751 - 0.28e2 / 0.9e1 * t1910 * t757 - 0.112e3 / 0.3e1 * t738 * t1913 * t741 - 0.112e3 / 0.27e2 * t1907 * t748;
  t1921 = t650 * t557;
  t1926 = t249 * t34 * t1635;
  t1931 = t754 * t557 * t27 * t560;
  t1932 = t622 * t141;
  t1939 = t299 * t240 * t675;
  t1942 = t622 * t124;
  t1945 = t35 * t240;
  t1948 = t1945 * t626 * t631 * t634;
  t1951 = t128 * t20 * t332 * t140;
  t1954 = t124 * t636;
  t1957 = t300 * t280;
  t1960 = t278 * t127;
  t1961 = t1960 * t140;
  t1962 = t756 * t1961;
  t1965 = t740 * t316;
  t1966 = t756 * t1965;
  t1975 = 0.128e3 / 0.729e3 * t1921 * t1560 * t590 * t36 * t1926 - 0.512e3 / 0.9e1 * t1931 * t1932 + 0.2048e4 / 0.27e2 * t745 * t626 * t89 * t1549 * t1939 + 0.512e3 / 0.9e1 * t1931 * t1942 + 0.12288e5 * t1948 * t1951 - 0.12288e5 * t1948 * t1954 - 0.8e1 / 0.9e1 * t747 * t1957 + 0.4e1 / 0.3e1 * t755 * t1962 + 0.4e1 / 0.3e1 * t755 * t1966 + 0.16e2 * t738 * t739 * t1961 + 0.16e2 * t738 * t739 * t1965;
  t1980 = t566 * t78 * t57;
  t1991 = t652 * t141;
  t1994 = t652 * t124;
  t2013 = -0.64e2 / 0.729e3 * t1921 * t1560 * t1639 * t21 * t1980 + 0.512e3 / 0.243e3 * t1921 * t1560 * t77 * t78 * t1843 - 0.1536e4 * t243 * t248 * t290 - 0.64e2 / 0.81e2 * t651 * t1991 + 0.64e2 / 0.81e2 * t651 * t1994 + 0.768e3 * t243 * t248 * t317 - 0.128e5 / 0.3e1 * t243 * t656 * t141 + 0.128e5 / 0.3e1 * t243 * t656 * t124 - 0.768e3 * t243 * t248 * t280 + 0.448e3 / 0.81e2 * t1699 * t776 - 0.896e3 / 0.9e1 * t1699 * t779;
  t2021 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t113 * t59 - 0.5e1 / 0.9e1 * t6 * t529 * t143 + t6 * t200 * t319 / 0.2e1 - t6 * t66 * t789 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (0.8e1 * t104 * t288 * t140 * t640 - 0.36e2 * t104 * t645 * t289 * t316 - 0.4e1 * t104 * t123 * t1662 - 0.24e2 * t104 * t123 * t1670 - t104 * t128 * t1659 + 0.24e2 * t104 * t1534 * t1535 + 0.6e1 * t104 * t288 * t1539 + 0.12e2 * t104 * t279 * t760 - 0.6e1 * t104 * t279 * t767 - 0.4e1 * t104 * t574 * t282 + t1757 + t1798 + t1839 + t1880 + t1919 + t1975 + t2013));
  tv4rho40 = 0.2e1 * rho[0] * t2021 + 0.8e1 * t794;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2067 = t588 * t552;
  t2070 = t558 * t111;
  t2071 = 0.1e1 / t2070;
  t2076 = t26 * t552;
  t2086 = t1544 * t89;
  t2087 = t296 * t2086;
  t2088 = t631 * t34;
  t2102 = 0.1e1 / t18 / t1608;
  t2109 = t560 * sigma[0];
  t2113 = t2109 * t590;
  t2133 = 0.1184e4 / 0.9e1 * t896 * t673 * t898 + 0.119e3 / 0.81e2 * t408 * t686 * t131 + 0.22e2 / 0.27e2 * t2067 * t884 - 0.6144e4 * t1606 * t2071 * t1695 * t557 + 0.592e4 / 0.3e1 * t312 * t2076 * t247 - 0.476e3 / 0.27e2 * t413 * t585 - 0.44e2 / 0.27e2 * t2067 * t888 + 0.88e2 / 0.3e1 * t2067 * t892 - 0.128e3 / 0.9e1 * t2087 * t2088 * t241 * t78 * t247 - 0.14e3 / 0.27e2 * t135 * t165 * t612 + 0.656e3 / 0.9e1 * t910 * t623 - 0.1728e5 * t915 * t637 + 0.9216e5 * t628 * t2102 * t1578 * t1581 - 0.35e2 / 0.81e2 * t180 * t578 + 0.32e2 / 0.81e2 * t588 * t2109 * t1596 - 0.16e2 / 0.243e3 * t588 * t2113 * t1636 + 0.8e1 / 0.243e3 * t588 * t560 * t1639 * sigma[0] * t1644 - 0.64e2 / 0.81e2 * t588 * t560 * t77 * sigma[0] * t1650 - 0.256e3 / 0.9e1 * t588 * t2088 * t78 * t241 * t247 * t636;
  t2157 = t650 * t825 * t26;
  t2161 = t650 * t831 * t78;
  t2174 = t674 * t1037;
  t2177 = t1735 * t1041;
  t2180 = t131 * t189;
  t2188 = t131 * t178;
  t2191 = t104 * params->alpha * (-0.35e2 / 0.81e2 * t39 * t165 * t541 - 0.91e2 / 0.54e2 * t110 * t581 * t114 + 0.317e3 / 0.162e3 * t268 * t552 * t271 * t26 - 0.49e2 / 0.486e3 * t268 * t560 * t564 * t865 + t268 * t631 * t1721 * t241 * t20 * t332 / 0.81e2 - 0.35e2 / 0.81e2 * t46 * t165 * t540) * t56 - t104 * t128 * t2133 + 0.24e2 * t104 * t1534 * t188 * t646 + 0.2e1 * t104 * t288 * t188 * t640 - 0.2e1 * t334 * t304 * t280 + 0.2e1 * t334 * t304 * t317 - 0.1e2 * t936 * t939 + 0.119e3 / 0.81e2 * t213 * t332 * t546 * t335 - 0.4e1 / 0.9e1 * t2157 * t1741 + 0.8e1 * t2161 * t891 * t141 + 0.4e1 / 0.9e1 * t2157 * t1748 - 0.8e1 * t2161 * t891 * t124 - 0.35e2 / 0.81e2 * t154 * t664 - 0.14e3 / 0.27e2 * t160 * t660 - 0.768e3 * t1734 * t2174 + 0.384e3 * t1734 * t2177 + 0.32e2 / 0.81e2 * t1740 * t2180 - 0.64e2 / 0.9e1 * t1745 * t1218 - 0.4e1 * t334 * t304 * t290 - 0.32e2 / 0.81e2 * t1740 * t2188;
  t2194 = t1735 * t1024;
  t2198 = t35 * t352 * t355;
  t2207 = t300 * t403;
  t2213 = t300 * t391;
  t2216 = t756 * t822;
  t2219 = t300 * t400;
  t2253 = t334 * t1900 / 0.3e1 + 0.32e2 / 0.81e2 * t650 * t2113 * t1843 + 0.656e3 / 0.9e1 * t988 * t717 - 0.1728e5 * t35 * t242 * t631 * t724 - 0.7e1 / 0.9e1 * t73 * t682 * t425 + 0.112e3 / 0.9e1 * t216 * t1778 * t189 - 0.28e2 / 0.3e1 * t84 * t706 * t425 - t334 * t1885 / 0.6e1 - 0.14e2 / 0.3e1 * t160 * t707 - t160 * t360 * t641 / 0.2e1 - t73 * t229 * t873 / 0.3e1;
  t2313 = 0.256e3 / 0.9e1 * t672 * t1867 * t178 - 0.2e1 * t160 * t727 + 0.9216e5 * t35 * t627 * t2102 * t1786 + t160 * t360 * t575 / 0.2e1 - 0.4e1 * t84 * t253 * t873 + 0.16e2 / 0.3e1 * t216 * t730 * t389 + t73 * t229 * t923 / 0.3e1 - 0.16e2 / 0.3e1 * t216 * t730 * t425 - 0.256e3 / 0.9e1 * t672 * t1867 * t189 + 0.4e1 * t84 * t253 * t923 + 0.7e1 / 0.9e1 * t73 * t682 * t389 - 0.112e3 / 0.9e1 * t216 * t1778 * t178 + 0.28e2 / 0.3e1 * t84 * t706 * t389 + 0.4e1 * t334 * t1882 + 0.14e2 / 0.3e1 * t160 * t711 - t154 * t697 / 0.3e1 - t154 * t343 * t647 / 0.4e1 - 0.28e3 / 0.27e2 * t84 * t1799 * t178 - 0.7e2 / 0.81e2 * t73 * t1849 * t178 + 0.28e3 / 0.27e2 * t84 * t1799 * t189;
  t2322 = t608 * t51;
  t2334 = t608 * params->alpha;
  t2363 = t1185 * t289;
  t2369 = t754 * t384;
  t2374 = t756 * t2363;
  t2377 = t154 * t343 * t575 / 0.24e2 + t334 * t1957 / 0.6e1 - t154 * t343 * t641 / 0.24e2 + t154 * t703 / 0.6e1 - t154 * t679 / 0.6e1 + 0.2e1 * t160 * t700 - 0.8e1 * t738 * t739 * t2363 + 0.4e1 * t1028 * t742 + t2369 * t757 / 0.3e1 + t1032 * t1903 / 0.4e1 - 0.2e1 / 0.3e1 * t755 * t2374;
  t2384 = t644 * t188;
  t2385 = t2384 * t289;
  t2386 = t1045 * t2385;
  t2396 = t740 * t424;
  t2400 = t1881 * t1041;
  t2410 = t287 * t424 * t140;
  t2411 = t1045 * t2410;
  t2414 = t1036 * t316;
  t2415 = t1045 * t2414;
  t2425 = t304 * t51 * t1037;
  t2428 = t300 * t389;
  t2434 = t387 * t127;
  t2435 = t2434 * t140;
  t2439 = t1023 * t316;
  t2447 = -0.28e2 / 0.3e1 * t738 * t1913 * t1041 + 0.2e1 * t755 * t2386 + 0.56e2 / 0.3e1 * t738 * t308 * t51 * t1037 + 0.24e2 * t738 * t1035 * t2385 + 0.8e1 * t738 * t739 * t2396 - 0.16e2 / 0.3e1 * t747 * t2400 + 0.14e2 / 0.9e1 * t1910 * t1046 - 0.28e2 / 0.27e2 * t1907 * t1049 - 0.7e1 / 0.9e1 * t1910 * t1052 - 0.4e1 / 0.3e1 * t755 * t2411 - 0.2e1 / 0.3e1 * t755 * t2415 - 0.16e2 * t738 * t1035 * t2410 - 0.8e1 * t738 * t1035 * t2414 + 0.32e2 / 0.3e1 * t747 * t2425 - 0.4e1 / 0.9e1 * t747 * t2428 - 0.28e2 / 0.3e1 * t738 * t1913 * t1024 + 0.8e1 * t738 * t739 * t2435 + 0.4e1 * t738 * t739 * t2439 - 0.7e1 / 0.9e1 * t1910 * t1055 + 0.28e2 / 0.27e2 * t1907 * t1058;
  t2448 = t756 * t2435;
  t2451 = t756 * t2439;
  t2454 = t1881 * t1024;
  t2463 = t300 * t425;
  t2466 = t1960 * t188;
  t2467 = t756 * t2466;
  t2470 = t756 * t2396;
  t2476 = t622 * t189;
  t2480 = t189 * t636;
  t2485 = t754 * sigma[0] * t27 * t861;
  t2497 = t1945 * t241 * t917 * t634;
  t2502 = t650 * t560;
  t2518 = 0.3072e4 * t1948 * t2480 + 0.16e2 * t2485 * t1932 - 0.256e3 / 0.9e1 * t745 * t241 * t89 * t631 * t1939 - 0.16e2 * t2485 * t1942 - 0.3456e4 * t2497 * t1951 + 0.3456e4 * t2497 * t1954 - 0.16e2 / 0.243e3 * t2502 * sigma[0] * t590 * t36 * t1926 - 0.3e1 / 0.2e1 * t1028 * t1029 * t1961 - 0.3e1 / 0.2e1 * t1028 * t1029 * t1965 - t1032 * t1962 / 0.8e1 - t1032 * t1966 / 0.8e1;
  t2522 = t745 * t376 * t34;
  t2537 = t622 * t178;
  t2540 = t178 * t636;
  t2566 = t127 * t922;
  t2593 = 0.6e1 * t104 * t288 * t922 * t140 - 0.18e2 * t104 * t645 * t424 * t289 - 0.6144e4 * t1692 * t557 * t2071 * t1696 + 0.6e1 * t820 * t278 * t287 * t402 - 0.3e1 * t104 * t123 * t2566 - t104 * t177 * t1662 - 0.3e1 * t104 * t279 * t804 - 0.3e1 * t104 * t872 * t282 - 0.3e1 * t104 * t388 * t767 - t104 * t574 * t399 + 0.12e2 * t820 * t821 * t808;
  t2598 = t35 * t52;
  t2615 = t122 * t644;
  t2636 = t652 * t189;
  t2645 = t652 * t178;
  t2655 = -0.144e3 * t353 * t356 * t317 - 0.476e3 / 0.27e2 * t338 * t668 - 0.44e2 / 0.27e2 * t650 * t595 * t828 + 0.88e2 / 0.3e1 * t650 * t599 * t833 - 0.16e2 / 0.81e2 * t651 * t2636 - 0.32e4 / 0.3e1 * t243 * t656 * t189 + 0.288e3 * t353 * t356 * t290 + 0.16e2 / 0.81e2 * t651 * t2645 + 0.32e4 / 0.3e1 * t243 * t656 * t178 + 0.2e1 / 0.9e1 * t925 * t1991 - 0.2e1 / 0.9e1 * t925 * t1994;
  t2664 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t529 * t191 + t6 * t200 * t427 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t66 * t1074 - 0.3e1 / 0.8e1 * t6 * t19 * (t2518 + t2447 + t2377 + t2313 + t2253 - 0.128e3 / 0.9e1 * t213 * t2086 * t631 * t34 * t241 * t78 * t675 + t2655 + t2191 + 0.1184e4 / 0.9e1 * t70 * t895 * t560 * t945 + 0.32e2 * t943 * t2322 * t282 * sigma[0] + 0.6e1 * t104 * t288 * t424 * t316 + t2593 - 0.32e2 * t943 * t2334 * t122 * t56 * sigma[0] + 0.8e1 / 0.243e3 * t2502 * t1639 * sigma[0] * t21 * t1980 - 0.64e2 / 0.81e2 * t2502 * t77 * sigma[0] * t78 * t1843 - 0.8e1 / 0.9e1 * t747 * t2207 + 0.4e1 / 0.9e1 * t747 * t2213 - 0.4e1 / 0.3e1 * t755 * t2216 + 0.4e1 / 0.9e1 * t747 * t2219 + 0.64e2 / 0.9e1 * t1745 * t1215 + 0.384e3 * t1734 * t2194 - 0.288e3 * t2198 * t1736 + 0.1e2 * t936 * t948 + 0.592e4 / 0.3e1 * t353 * t657 + 0.912e3 * t353 * t782 - 0.912e3 * t353 * t785 - t2522 * t757 / 0.3e1 + t1032 * t1897 / 0.4e1 + 0.128e3 / 0.9e1 * t1931 * t2537 - 0.3072e4 * t1948 * t2540 + 0.2e1 / 0.3e1 * t755 * t2448 + t755 * t2451 / 0.3e1 - 0.16e2 / 0.3e1 * t747 * t2454 + 0.4e1 / 0.9e1 * t747 * t2463 + t755 * t2467 / 0.3e1 + 0.2e1 / 0.3e1 * t755 * t2470 - 0.128e3 / 0.9e1 * t1931 * t2476 - 0.5e1 / 0.6e1 * t936 * t751 - 0.7e1 / 0.18e2 * t154 * t683 + 0.7e1 / 0.18e2 * t154 * t691 + 0.5e1 / 0.6e1 * t936 * t748 - 0.4e1 * t160 * t694 - 0.16e2 * t738 * t739 * t822 - 0.3e1 * t160 * t360 * t647 + 0.7e2 / 0.81e2 * t73 * t1849 * t189 + 0.3e1 * t1028 * t1292 * t1889 + 0.3e1 * t1028 * t1029 * t1893 + 0.4e1 * t738 * t739 * t2466 + 0.6e1 * t820 * t1185 * t771 - 0.6e1 * t104 * t177 * t1670 + 0.6e1 * t104 * t388 * t760 + 0.6e1 * t820 * t821 * t812 - 0.18e2 * t2598 * t2384 * t771 - 0.384e3 * t243 * t248 * t389 + 0.384e3 * t243 * t248 * t425 + 0.144e3 * t353 * t356 * t280 - 0.18e2 * t820 * t2615 * t1064 + 0.22e2 / 0.27e2 * t650 * t2076 * t653));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t2664 + 0.6e1 * t1079;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t2684 = t861 * t590;
  t2685 = t588 * t2684;
  t2694 = 0.1e1 / t1547;
  t2699 = t151 * t245;
  t2713 = 0.1e1 / t18 / t2070;
  t2720 = t861 * t1639;
  t2724 = t861 * t77;
  t2742 = 0.32e2 / 0.3e1 * t588 * t26 * t917 * t34 * t1656 - 0.18e2 * t1137 * t897 * t1139 + 0.7e1 / 0.9e1 * t505 * t305 - 0.4e1 / 0.27e2 * t2685 * t25 * t27 * t98 - 0.19e2 / 0.108e3 * t1114 * t245 * t590 * t36 + 0.2304e4 * t1606 * t2694 * t1695 * sigma[0] - 0.208e3 * t312 * t2699 * t247 + 0.19e2 / 0.54e2 * t1114 * t825 * t131 - 0.19e2 / 0.3e1 * t1114 * t831 * t304 - 0.92e2 / 0.3e1 * t1126 * t911 * t608 - 0.3456e5 * t915 * t2713 * t1578 * t1581 + 0.2e1 / 0.81e2 * t2685 * t1636 - t588 * t2720 * t1644 / 0.81e2 + 0.8e1 / 0.27e2 * t588 * t2724 * t1650 + 0.16e2 / 0.3e1 * t2087 * t917 * t34 * t827 * t247 - 0.7e1 / 0.9e1 * t135 * t475 * t308 + 0.4464e4 * t1143 * t919 - 0.7e1 / 0.108e3 * t502 * t293 - 0.7e1 / 0.108e3 * t505 * t301;
  t2745 = t424 * t424;
  t2784 = t176 * t644;
  t2788 = t650 * t2699;
  t2796 = t70 * t895 * t1096;
  t2802 = -t104 * t128 * t2742 + 0.4e1 * t104 * t288 * t2745 + t104 * params->alpha * (-0.7e1 / 0.108e3 * t39 * t475 * t260 + 0.7e1 / 0.216e3 * t110 * t479 * t264 - 0.8e1 / 0.27e2 * t268 * t2699 * t271 + 0.35e2 / 0.1296e4 * t268 * t861 * t567 - t268 * t917 * t1721 * t88 * t89 * t26 / 0.216e3 - 0.7e1 / 0.108e3 * t46 * t475 * t208) * t56 - 0.2e1 * t104 * t177 * t2566 - 0.2e1 * t104 * t1104 * t282 + 0.4e1 * t104 * t288 * t1150 * t140 - 0.12e2 * t820 * t2784 * t1064 - 0.19e2 / 0.108e3 * t2788 * t653 - 0.208e3 * t465 * t250 + 0.7e1 / 0.9e1 * t444 * t226 - 0.8e1 * t2796 * t608 * t141 - 0.2e2 / 0.3e1 * t936 * t1218;
  t2807 = t1735 * t1298;
  t2815 = t650 * t1091 * t77;
  t2819 = t650 * t1091 * t34;
  t2838 = 0.384e3 * t2198 * t2174 - 0.192e3 * t2198 * t2177 + 0.256e3 * t1734 * t2807 + 0.2e2 / 0.3e1 * t936 * t1215 - 0.192e3 * t2198 * t2194 + t2815 * t1741 / 0.9e1 - 0.2e1 * t2819 * t939 - t2815 * t1748 / 0.9e1 + 0.2e1 * t2819 * t948 - 0.4e1 / 0.27e2 * t650 * t2684 * t21 * t566 * t100 - 0.18e2 * t70 * t566 * t861 * t1223 - 0.8e1 / 0.3e1 * t334 * t304 * t389;
  t2845 = t35 * t464 * t466;
  t2864 = t300 * t495;
  t2873 = -0.7e1 / 0.9e1 * t461 * t237 - 0.7e1 / 0.108e3 * t438 * t210 + 0.36e2 * t2845 * t1736 + 0.8e1 / 0.3e1 * t334 * t304 * t425 + 0.8e1 * t2796 * t608 * t124 + 0.8e1 / 0.27e2 * t2157 * t2188 - 0.16e2 / 0.3e1 * t2161 * t891 * t178 - 0.8e1 / 0.27e2 * t2157 * t2180 + 0.16e2 / 0.3e1 * t2161 * t891 * t189 + 0.8e1 / 0.27e2 * t747 * t2864 - 0.32e2 / 0.3e1 * t738 * t739 * t1186 + 0.4e1 * t1028 * t1029 * t822;
  t2874 = t756 * t1186;
  t2909 = -0.8e1 / 0.9e1 * t755 * t2874 + t1312 * t1769 / 0.24e2 + t1032 * t2216 / 0.3e1 - 0.4e1 * t1222 * t1932 + 0.4e1 * t1222 * t1942 - t650 * t2720 * t21 * t1980 / 0.81e2 + 0.8e1 / 0.27e2 * t650 * t2724 * t78 * t1843 - t444 * t1253 * t317 / 0.4e1 - 0.64e2 / 0.3e1 * t943 * t2334 * t176 * t56 * sigma[0] + t438 * t1012 / 0.48e2 - t438 * t1009 / 0.48e2 - 0.2e1 / 0.3e1 * t461 * t257 + t461 * t1000 / 0.4e1;
  t2912 = t339 * t98;
  t2946 = t127 * t1150;
  t2950 = 0.2e1 / 0.3e1 * t444 * t2912 * t141 - t438 * t233 / 0.18e2 - 0.7e1 / 0.108e3 * t444 * t222 + t438 * t230 / 0.18e2 - t154 * t343 * t923 / 0.12e2 - 0.2e1 / 0.9e1 * t334 * t2463 + t444 * t1253 * t280 / 0.4e1 + t154 * t343 * t873 / 0.12e2 + 0.2e1 / 0.9e1 * t334 * t2428 + 0.16e2 / 0.3e1 * t213 * t2086 * t917 * t34 * t26 * t78 * t675 + 0.64e2 / 0.3e1 * t943 * t2322 * t399 * sigma[0] - 0.2e1 * t104 * t123 * t2946;
  t2993 = 0.24e2 * t104 * t1534 * t498 * t289 + 0.4e1 * t104 * t288 * t188 * t922 + 0.2e1 * t104 * t288 * t519 * t316 - 0.6e1 * t104 * t645 * t519 * t289 - 0.6e1 * t104 * t645 * t498 * t316 + 0.2e1 * t104 * t279 * t1169 - t104 * t279 * t1177 - 0.4e1 * t104 * t388 * t804 - 0.2e1 * t104 * t872 * t399 + 0.2e1 * t104 * t492 * t760 - t104 * t492 * t767 - 0.24e2 * t2598 * t2384 * t808 - 0.128e3 * t243 * t248 * t493;
  t3021 = -0.256e3 * t243 * t248 * t499 - 0.4e1 / 0.27e2 * t925 * t2645 + 0.4e1 / 0.27e2 * t925 * t2636 + 0.19e2 / 0.54e2 * t2788 * t776 - 0.19e2 / 0.3e1 * t2788 * t779 - 0.92e2 / 0.3e1 * t1193 * t897 * t675 + 0.608e3 * t353 * t845 - 0.608e3 * t353 * t842 - t1180 * t1991 / 0.18e2 + t1180 * t1994 / 0.18e2 - 0.96e2 * t465 * t836 + 0.96e2 * t465 * t839;
  t3063 = 0.2304e4 * t1692 * sigma[0] * t2694 * t1696 + 0.8e1 * t820 * t387 * t287 * t402 + 0.4e1 * t1028 * t1292 * t2410 - 0.12e2 * t820 * t2615 * t1161 + 0.8e1 * t820 * t821 * t1165 + 0.4e1 * t820 * t821 * t1173 + 0.8e1 * t820 * t1185 * t808 + 0.4e1 * t820 * t1185 * t812 + 0.128e3 * t243 * t248 * t520 - 0.18e2 * t465 * t467 * t280 + 0.18e2 * t465 * t467 * t317 + 0.192e3 * t353 * t356 * t389 - 0.192e3 * t353 * t356 * t425;
  t3092 = t2434 * t188;
  t3093 = t756 * t3092;
  t3096 = 0.2e1 * t1028 * t1292 * t2414 - 0.2e1 * t1028 * t1029 * t2435 - t1028 * t1029 * t2439 - 0.4e1 / 0.9e1 * t2369 * t1046 + 0.2e1 / 0.9e1 * t2369 * t1052 + t1032 * t2411 / 0.3e1 + t1032 * t2415 / 0.6e1 + 0.4e1 / 0.9e1 * t2522 * t1046 - t1032 * t2467 / 0.12e2 - t1028 * t1029 * t2466 - 0.2e1 * t1028 * t1029 * t2396 + 0.4e1 / 0.9e1 * t755 * t3093;
  t3097 = t1023 * t424;
  t3098 = t756 * t3097;
  t3101 = t1881 * t1298;
  t3114 = t740 * t519;
  t3115 = t756 * t3114;
  t3121 = t491 * t127;
  t3122 = t3121 * t140;
  t3123 = t756 * t3122;
  t3130 = t644 * t498 * t140;
  t3131 = t1045 * t3130;
  t3137 = 0.4e1 / 0.9e1 * t755 * t3098 - 0.32e2 / 0.9e1 * t747 * t3101 + 0.16e2 / 0.3e1 * t738 * t739 * t3092 + 0.16e2 / 0.3e1 * t738 * t739 * t3097 - 0.16e2 / 0.3e1 * t1028 * t1038 + 0.8e1 / 0.3e1 * t1028 * t1042 + 0.2e1 / 0.9e1 * t755 * t3115 + 0.8e1 / 0.3e1 * t738 * t739 * t3114 + 0.2e1 / 0.9e1 * t755 * t3123 + 0.8e1 / 0.3e1 * t738 * t739 * t3122 + 0.4e1 / 0.3e1 * t755 * t3131 + 0.16e2 * t738 * t1035 * t3130;
  t3139 = t1036 * t424;
  t3140 = t1045 * t3139;
  t3146 = t821 * t498;
  t3147 = t756 * t3146;
  t3167 = t1945 * t26 * t1145 * t634;
  t3172 = -0.8e1 / 0.9e1 * t755 * t3140 - 0.32e2 / 0.3e1 * t738 * t1035 * t3139 - 0.4e1 / 0.9e1 * t755 * t3147 - 0.16e2 / 0.3e1 * t738 * t739 * t3146 + t1312 * t1885 / 0.48e2 - t1312 * t1957 / 0.48e2 + 0.2e1 / 0.9e1 * t2369 * t1055 - t1032 * t2470 / 0.6e1 - 0.2e1 / 0.9e1 * t2522 * t1052 + 0.8e1 / 0.3e1 * t1028 * t1025 + 0.864e3 * t3167 * t1951 - 0.864e3 * t3167 * t1954;
  t3174 = t745 * t479 * t113;
  t3197 = t287 * t519 * t140;
  t3198 = t1045 * t3197;
  t3204 = t737 * t437;
  t3209 = t3174 * t751 / 0.18e2 + t1032 * t2374 / 0.6e1 + 0.2e1 * t1028 * t1029 * t2363 - t3174 * t748 / 0.18e2 - t1312 * t1900 / 0.24e2 - t1032 * t2386 / 0.2e1 - 0.56e2 / 0.9e1 * t738 * t1913 * t1298 - 0.6e1 * t1028 * t1292 * t2385 - 0.14e2 / 0.27e2 * t1910 * t1299 - 0.4e1 / 0.9e1 * t755 * t3198 - 0.16e2 / 0.3e1 * t738 * t1035 * t3197 + t3204 * t1030 / 0.2e1 - t1032 * t2448 / 0.6e1;
  t3231 = t754 * t488;
  t3236 = t300 * t520;
  t3239 = t300 * t499;
  t3242 = t300 * t493;
  t3245 = -t1032 * t2451 / 0.12e2 - 0.2e1 / 0.9e1 * t2522 * t1055 + 0.32e2 / 0.3e1 * t745 * t89 * t917 * t34 * t827 * t240 * t675 - 0.32e2 / 0.3e1 * t2485 * t2537 + 0.2304e4 * t2497 * t2540 + 0.32e2 / 0.3e1 * t2485 * t2476 - 0.2304e4 * t2497 * t2480 + t3231 * t757 / 0.24e2 - t1312 * t1882 / 0.2e1 + 0.4e1 / 0.27e2 * t747 * t3236 - 0.8e1 / 0.27e2 * t747 * t3239 - 0.4e1 / 0.27e2 * t747 * t3242;
  t3280 = 0.2e1 / 0.9e1 * t154 * t976 + 0.5e1 / 0.9e1 * t936 * t1049 - 0.2e1 / 0.9e1 * t73 * t229 * t1105 - 0.8e1 / 0.3e1 * t84 * t253 * t1105 - t160 * t360 * t923 - 0.8e1 / 0.3e1 * t160 * t973 + 0.8e1 / 0.3e1 * t334 * t2454 - 0.2e1 / 0.9e1 * t154 * t1003 - 0.5e1 / 0.9e1 * t936 * t1058 + 0.2e1 / 0.81e2 * t650 * t2684 * t36 * t1926 + 0.4464e4 * t35 * t352 * t917 * t724 - 0.16e2 / 0.9e1 * t216 * t730 * t520 + 0.2e1 / 0.9e1 * t73 * t229 * t1151;
  t3309 = 0.8e1 / 0.3e1 * t84 * t253 * t1151 + 0.8e1 / 0.3e1 * t160 * t982 - 0.16e2 / 0.3e1 * t334 * t2425 + 0.8e1 / 0.3e1 * t334 * t2400 - 0.28e2 / 0.9e1 * t84 * t706 * t520 + 0.2e1 / 0.3e1 * t461 * t254 + 0.7e1 / 0.27e2 * t154 * t962 + 0.28e2 / 0.9e1 * t160 * t965 - 0.7e1 / 0.27e2 * t154 * t1020 - 0.28e2 / 0.9e1 * t160 * t957 - t461 * t997 / 0.4e1 - 0.2e1 / 0.3e1 * t444 * t2912 * t124;
  t3347 = -0.3456e5 * t35 * t242 * t2713 * t1786 + t160 * t360 * t873 + 0.16e2 / 0.9e1 * t216 * t730 * t493 + 0.32e2 / 0.9e1 * t216 * t730 * t499 + t444 * t1253 * t290 / 0.2e1 - t461 * t960 / 0.2e1 - t438 * t968 / 0.24e2 - 0.7e1 / 0.27e2 * t73 * t682 * t520 + 0.14e2 / 0.27e2 * t73 * t682 * t499 + 0.56e2 / 0.9e1 * t84 * t706 * t499 + 0.7e1 / 0.27e2 * t73 * t682 * t493 + 0.28e2 / 0.9e1 * t84 * t706 * t493 - 0.36e2 * t465 * t467 * t290;
  t3356 = my_piecewise3(t2, 0, t6 * t200 * t522 / 0.12e2 - t6 * t66 * t1321 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t2802 + t2838 + t2873 + t2909 + t2950 + t2993 + t3021 + t3063 + t3096 + t3137 + t3172 + t3209 + t3245 + t3280 + t3309 + t3347));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t3356 + 0.4e1 * t1326;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t3407 = -0.36e2 * t1426 * t357 + 0.6e1 * t104 * t388 * t1169 - t1444 * t80 / 0.24e2 - t1440 * t101 / 0.2e1 + t1312 * t2219 / 0.16e2 + t1312 * t2213 / 0.16e2 + t1032 * t2874 / 0.2e1 + 0.6e1 * t1028 * t1029 * t1186 - t1312 * t2207 / 0.8e1 - 0.144e3 * t353 * t356 * t520 - 0.54e2 * t465 * t467 * t389 + 0.288e3 * t353 * t356 * t499 - t1180 * t2636 / 0.12e2 + t1180 * t2645 / 0.12e2 + t1422 * t1991 / 0.96e2 - t1422 * t1994 / 0.96e2 - 0.18e2 * t1426 * t1197 + 0.18e2 * t1426 * t1200 - 0.144e3 * t465 * t1206 + 0.144e3 * t465 * t1203;
  t3420 = t435 * t355;
  t3442 = 0.1e1 / t18 / t1547;
  t3447 = t441 * t1096;
  t3451 = t1544 * t151;
  t3469 = 0.1e1 / t629;
  t3474 = t3447 * t590;
  t3498 = 0.1296e5 * t1143 * t3442 * t1578 * t1581 + t588 * t3447 * t1596 / 0.18e2 - 0.2e1 * t296 * t3451 * t89 * t1145 * t1551 - t135 * t1366 * t136 / 0.2e1 + 0.2e1 * t1375 * t1127 * t622 - 0.648e3 * t1379 * t1147 - t1335 * t132 / 0.24e2 - t1340 * t1109 / 0.24e2 - 0.864e3 * t1606 * t3469 * t78 * t634 - t588 * t3474 * t1636 / 0.108e3 + t588 * t3447 * t1639 * t1644 / 0.216e3 - t588 * t3447 * t77 * t1650 / 0.9e1 - 0.4e1 * t588 * t151 * t1145 * t34 * t1656 + t1340 * t414 / 0.2e1 + 0.2e1 * t1359 * t1128 - 0.36e2 * t312 * t3420 * t247;
  t3532 = t1185 * t498;
  t3533 = t756 * t3532;
  t3539 = 0.144e3 * t353 * t356 * t493 + 0.54e2 * t465 * t467 * t425 + t104 * params->alpha * (-t39 * t1366 * t105 / 0.24e2 + t110 * t1392 * t115 / 0.48e2 - t268 * t3420 * t271 / 0.48e2 - t268 * t1096 * t564 * t1399 / 0.216e3 + t268 * t1145 * t1721 * t151 * t20 * t332 / 0.576e3 - t46 * t1366 * t76 / 0.24e2) * t56 - t104 * t128 * t3498 - 0.9e1 * t1028 * t1292 * t3130 + 0.6e1 * t1028 * t1292 * t3139 + 0.3e1 * t1028 * t1029 * t3146 - 0.3e1 / 0.4e1 * t1032 * t3131 + t1032 * t3140 / 0.2e1 + t1032 * t3147 / 0.4e1 + t3174 * t1058 / 0.12e2 + t2369 * t1299 / 0.3e1 + 0.4e1 * t1028 * t1302 - t3174 * t1049 / 0.12e2 + 0.3e1 / 0.4e1 * t3204 * t1309 - t1032 * t3093 / 0.4e1 - t1032 * t3098 / 0.4e1 - t2522 * t1299 / 0.3e1 - 0.2e1 / 0.3e1 * t755 * t3533 - 0.8e1 * t738 * t739 * t3532;
  t3541 = t650 * t441;
  t3547 = t1023 * t519;
  t3548 = t756 * t3547;
  t3554 = t1036 * t519;
  t3555 = t1045 * t3554;
  t3561 = t3121 * t188;
  t3562 = t756 * t3561;
  t3595 = t754 * t441 * t27 * t1361;
  t3605 = -t3541 * t1096 * t590 * t36 * t1926 / 0.108e3 + t755 * t3548 / 0.3e1 + 0.4e1 * t738 * t739 * t3547 - 0.2e1 / 0.3e1 * t755 * t3555 - 0.8e1 * t738 * t1035 * t3554 + t755 * t3562 / 0.3e1 + 0.4e1 * t738 * t739 * t3561 - 0.3e1 * t1028 * t1029 * t3092 - 0.3e1 * t1028 * t1029 * t3097 + t1312 * t2463 / 0.16e2 - t1312 * t2428 / 0.16e2 - 0.3e1 / 0.4e1 * t1312 * t2400 - 0.3e1 / 0.4e1 * t1312 * t2454 - t1032 * t3123 / 0.8e1 - 0.3e1 / 0.2e1 * t1028 * t1029 * t3122 + 0.3e1 * t1028 * t1292 * t3197 - 0.3e1 / 0.2e1 * t1028 * t1029 * t3114 + 0.3e1 / 0.4e1 * t3595 * t1932 - 0.4e1 * t745 * t151 * t89 * t1145 * t1939 - 0.3e1 / 0.4e1 * t3595 * t1942;
  t3608 = t1945 * t151 * t1381 * t634;
  t3634 = t745 * t1392 * t92;
  t3650 = t127 * t1386;
  t3664 = t3634 * t751 / 0.32e2 + t3231 * t1055 / 0.16e2 + t1032 * t3198 / 0.4e1 - t1032 * t3115 / 0.8e1 - t3231 * t1046 / 0.8e1 + 0.3e1 / 0.2e1 * t1312 * t2425 - t104 * t123 * t3650 - 0.3e1 * t104 * t1104 * t399 - 0.3e1 * t104 * t492 * t804 - 0.864e3 * t1692 * t3469 * t1696 - t104 * t1406 * t282;
  t3683 = t644 * t1329;
  t3722 = 0.2e1 * t104 * t288 * t1386 * t140 - 0.3e1 * t104 * t177 * t2946 + 0.24e2 * t104 * t1534 * t1329 * t140 - 0.18e2 * t104 * t645 * t498 * t424 - 0.6e1 * t104 * t123 * t3683 + 0.6e1 * t104 * t288 * t424 * t519 + 0.6e1 * t104 * t288 * t188 * t1150 + t438 * t367 / 0.12e2 + t154 * t1250 / 0.6e1 - t438 * t393 / 0.12e2 - t154 * t1238 / 0.6e1 - 0.2e1 * t160 * t1241 + 0.2e1 * t160 * t1289 - t461 * t396 + t461 * t370 - 0.4e1 * t160 * t1247 - t154 * t1244 / 0.3e1 + 0.4e1 * t334 * t3101 + t650 * t3474 * t1843 / 0.18e2 + 0.2e1 * t1469 * t1138 * t240 * t675;
  t3776 = -0.648e3 * t35 * t464 * t1145 * t724 + 0.2e1 / 0.3e1 * t73 * t229 * t1330 + 0.8e1 * t84 * t253 * t1330 - 0.3e1 / 0.8e1 * t1440 * t364 + 0.3e1 / 0.8e1 * t1440 * t361 - t73 * t229 * t1407 / 0.9e1 - 0.4e1 / 0.3e1 * t84 * t253 * t1407 + t73 * t229 * t1387 / 0.9e1 + 0.4e1 / 0.3e1 * t84 * t253 * t1387 + t334 * t3242 / 0.6e1 - t154 * t343 * t1151 / 0.8e1 - t334 * t3236 / 0.6e1 - t1444 * t347 / 0.32e2 - t1448 * t1272 / 0.24e2 + t1444 * t344 / 0.32e2 + 0.3e1 / 0.2e1 * t160 * t360 * t1105 - 0.3e1 / 0.2e1 * t160 * t360 * t1151 - 0.3e1 / 0.4e1 * t444 * t1253 * t425 + 0.3e1 / 0.4e1 * t444 * t1253 * t389 + 0.3e1 / 0.4e1 * t461 * t1234;
  t3794 = t1453 * t247;
  t3825 = t650 * t1370 * t77;
  t3831 = t650 * t1370 * t34;
  t3834 = t444 * t2912 * t189 - 0.3e1 / 0.4e1 * t461 * t1232 - t444 * t2912 * t178 + 0.1296e5 * t35 * t352 * t3442 * t1786 + t334 * t3239 / 0.3e1 + 0.3e1 / 0.8e1 * t1448 * t1277 - 0.3e1 / 0.8e1 * t1448 * t1254 + 0.3e1 / 0.2e1 * t1452 * t3794 * t141 - 0.2e1 * t213 * t3451 * t89 * t1145 * t34 * t78 * t675 - 0.3e1 / 0.2e1 * t1452 * t3794 * t124 - 0.6e1 * t1222 * t2476 + 0.6e1 * t1222 * t2537 + t438 * t1262 / 0.16e2 - t438 * t1257 / 0.16e2 + t154 * t343 * t1105 / 0.8e1 - 0.3e1 * t104 * t388 * t1177 + 0.54e2 * t2845 * t2194 - t3825 * t1741 / 0.48e2 + t3825 * t1748 / 0.48e2 + 0.3e1 / 0.8e1 * t3831 * t939;
  t3890 = 0.6e1 * t820 * t821 * t1415 + 0.6e1 * t820 * t491 * t287 * t402 + 0.2e1 * t1452 * t1194 - 0.4e1 * t334 * t304 * t499 - 0.288e3 * t2198 * t2807 + t2815 * t2180 / 0.6e1 - 0.3e1 * t2819 * t1218 - t2815 * t2188 / 0.6e1 + 0.3e1 * t2819 * t1215 + t1448 * t340 / 0.2e1 - 0.2e1 * t334 * t304 * t493;
  t3899 = my_piecewise3(t2, 0, -t6 * t66 * t1512 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t3722 + t3664 + t3605 + t3539 - 0.3e1 / 0.8e1 * t3831 * t948 - 0.108e3 * t2845 * t2174 + 0.54e2 * t2845 * t2177 - 0.162e3 * t3608 * t1951 + 0.162e3 * t3608 * t1954 - 0.3e1 / 0.2e1 * t3204 * t1293 + 0.3e1 / 0.4e1 * t3204 * t1296 + 0.1296e4 * t3167 * t2480 - 0.1296e4 * t3167 * t2540 + t3231 * t1052 / 0.16e2 - t3634 * t748 / 0.32e2 + t3407 + t3541 * t1096 * t1639 * t21 * t1980 / 0.216e3 - t3541 * t1096 * t77 * t78 * t1843 / 0.9e1 + t3890 + t3834 + t3776 + 0.2e1 * t334 * t304 * t520 - 0.12e2 * t2796 * t608 * t189 + 0.12e2 * t2796 * t608 * t178 - 0.18e2 * t820 * t2784 * t1161 + 0.12e2 * t820 * t1185 * t1165 + 0.6e1 * t820 * t1185 * t1173 - 0.18e2 * t2598 * t2384 * t1173));
  tv4rhosigma30 = 0.2e1 * rho[0] * t3899 + 0.2e1 * t1516;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t3902 = t498 * t498;
  t3908 = t604 * t1338;
  t3912 = 0.1e1 / t1569;
  t3913 = t87 * t3912;
  t3914 = t296 * t3913;
  t3917 = t588 * t1333;
  t3925 = t1333 * t466;
  t3933 = t1338 * t1361;
  t3937 = t1544 * t435;
  t3942 = 0.1e1 / t1570;
  t3943 = t3942 * t27;
  t3947 = t24 * t1338;
  t3954 = t24 * t3942;
  t3960 = t3933 * t590;
  t3981 = 0.15e2 / 0.4e1 * t129 * t3908 * t1363 + 0.15e2 / 0.16e2 * t3914 * t509 + t3917 * t1347 / 0.32e2 + 0.324e3 * t1606 * t441 * t1599 * t78 * t634 - 0.81e2 / 0.2e1 * t312 * t3925 * t247 - 0.486e4 * t1379 * t1560 * t1578 * t1581 - t588 * t3933 * t1596 / 0.48e2 + 0.3e1 / 0.4e1 * t296 * t3937 * t1588 * t1551 - 0.15e2 / 0.16e2 * t135 * t3943 * t184 + 0.3e1 / 0.2e1 * t129 * t3947 * t1376 - 0.243e3 * t53 * t1425 * t1383 - 0.5e1 / 0.64e2 * t129 * t3954 * t181 - 0.5e1 / 0.64e2 * t3914 * t506 + t588 * t3960 * t1636 / 0.288e3 - t588 * t3933 * t1639 * t1644 / 0.576e3 + t588 * t3933 * t77 * t1650 / 0.24e2 + 0.3e1 / 0.2e1 * t588 * t435 * t1381 * t34 * t1656 - t3917 * t1351 / 0.16e2 + 0.9e1 / 0.8e1 * t3917 * t1355;
  t3984 = t519 * t519;
  t4017 = t650 * t1338;
  t4057 = -0.6e1 * t1028 * t1029 * t3547 - 0.3e1 * t1312 * t3101 + t1312 * t3236 / 0.8e1 + 0.12e2 * t1028 * t1292 * t3554 + 0.12e2 * t1028 * t1029 * t3532 + t1032 * t3555 + t3231 * t1299 / 0.4e1 - t3634 * t1049 / 0.8e1 + t3634 * t1058 / 0.8e1 + 0.3e1 * t3595 * t2476 + 0.3e1 / 0.2e1 * t745 * t435 * t89 * t1381 * t1939;
  t4081 = t650 * t3925;
  t4091 = -0.3e1 * t3595 * t2537 - 0.648e3 * t3608 * t2480 - t1312 * t3242 / 0.8e1 - t1032 * t3562 / 0.2e1 - t1032 * t3548 / 0.2e1 + t4017 * t1361 * t77 * t78 * t1843 / 0.24e2 - t4017 * t1361 * t1639 * t21 * t1980 / 0.576e3 + 0.648e3 * t3608 * t2540 + t4081 * t653 / 0.32e2 - 0.81e2 / 0.2e1 * t35 * t240 * t1333 * t468 + 0.24e2 * t820 * t1185 * t1415;
  t4126 = 0.324e3 * t1692 * t441 * t1599 * t1696 + 0.12e2 * t104 * t492 * t1169 - 0.6e1 * t104 * t492 * t1177 - 0.36e2 * t104 * t645 * t498 * t519 - 0.4e1 * t104 * t1406 * t399 + 0.8e1 * t104 * t288 * t1386 * t188 - 0.4e1 * t104 * t177 * t3650 - 0.24e2 * t104 * t177 * t3683 - 0.12e2 * t160 * t360 * t1330 - t438 * t1461 / 0.4e1 - t154 * t343 * t1330;
  t4160 = 0.3e1 / 0.2e1 * t70 * t3947 * t27 * t1471 - 0.243e3 * t35 * t1425 * t1381 * t724 - 0.3e1 / 0.2e1 * t1440 * t473 + 0.3e1 / 0.2e1 * t1440 * t471 + 0.3e1 / 0.2e1 * t461 * t1481 + 0.3e1 / 0.2e1 * t1448 * t1484 - t154 * t343 * t1387 / 0.6e1 - 0.2e1 * t160 * t360 * t1387 + 0.3e1 * t444 * t1253 * t499 + t154 * t343 * t1407 / 0.6e1 + 0.2e1 * t160 * t360 * t1407;
  t4170 = t213 * t3913 * t89;
  t4188 = -0.3e1 * t461 * t1457 - t438 * t1490 / 0.8e1 + t438 * t1493 / 0.8e1 - t1444 * t457 / 0.8e1 - 0.5e1 / 0.64e2 * t4170 * t447 + t1444 * t454 / 0.8e1 - 0.3e1 / 0.2e1 * t444 * t1253 * t520 + 0.6e1 * t1452 * t3794 * t189 - 0.6e1 * t1452 * t3794 * t178 - 0.3e1 / 0.2e1 * t461 * t1478 - 0.3e1 / 0.2e1 * t1448 * t1487;
  t4225 = -0.486e4 * t35 * t464 * t1560 * t1786 + 0.3e1 / 0.2e1 * t444 * t1253 * t493 - t650 * t3960 * t1843 / 0.48e2 + 0.3e1 / 0.4e1 * t213 * t3937 * t89 * t1854 * t675 - 0.5e1 / 0.64e2 * t70 * t3954 * t27 * t156 - 0.15e2 / 0.16e2 * t35 * t25 * t3942 * t162 + 0.15e2 / 0.16e2 * t4170 * t451 + 0.15e2 / 0.4e1 * t70 * t3908 * t27 * t1454 + 0.216e3 * t2845 * t2807 - t3825 * t2180 / 0.12e2 + 0.3e1 / 0.2e1 * t3831 * t1218;
  t4251 = t3825 * t2188 / 0.12e2 - 0.3e1 / 0.2e1 * t3831 * t1215 + 0.108e3 * t465 * t467 * t520 - t4081 * t776 / 0.16e2 + 0.9e1 / 0.8e1 * t4081 * t779 - 0.216e3 * t465 * t467 * t499 + t1422 * t2636 / 0.24e2 - t1422 * t2645 / 0.24e2 - 0.72e2 * t1426 * t1429 + 0.72e2 * t1426 * t1432 - 0.108e3 * t465 * t467 * t493;
  t4258 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (0.24e2 * t104 * t1534 * t3902 + t1312 * t2864 / 0.4e1 - t104 * t128 * t3981 + 0.6e1 * t104 * t288 * t3984 + t104 * params->alpha * (-0.5e1 / 0.64e2 * t39 * t3943 * t42 + 0.5e1 / 0.128e3 * t110 * t3912 * t89 * t480 + t268 * t3925 * t271 / 0.128e3 - t268 * t1381 * t1721 * t435 * t20 * t332 / 0.1536e4 - t1397 * t1338 * t21 * t566 / 0.1152e4 - 0.5e1 / 0.64e2 * t46 * t3943 * t30) * t56 + 0.3e1 * t3204 * t1502 + t4017 * t1361 * t590 * t36 * t1926 / 0.288e3 - t1312 * t3239 / 0.4e1 + t1032 * t3533 - 0.6e1 * t1028 * t1029 * t3561 + t4057 + t4091 + t4126 + t4160 + t4188 + t4225 + t4251));
  tv4sigma40 = 0.2e1 * rho[0] * t4258;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t40, t41;
  double t42, t43, t44, t46, t47, t48, t51, t52;
  double t58, t59, t60, t62, t63, t64, t66, t70;
  double t71, t72, t74, t75, t76, t77, t79, t80;
  double t81, t82, t84, t85, t87, t88, t89, t90;
  double t91, t92, t95, t101, t102, t103, t105, t106;
  double t107, t109, t113, tzk0;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = tanh(t40);
  t42 = params->mu * t41;
  t43 = log(t40 + sqrt(t40 * t40 + 0.1e1));
  t44 = 0.1e1 - params->zeta;
  t46 = t44 * t29 * t32;
  t47 = 0.1e1 + t40;
  t48 = log(t47);
  t51 = params->zeta * t29;
  t52 = t32 * t34;
  t58 = 0.1e1 + params->alpha * (t51 * t52 * t37 / 0.12e2 + t46 * t38 * t48 / 0.12e2);
  t59 = t43 * t58;
  t60 = params->beta * t41;
  t62 = t60 * t43 + 0.1e1;
  t63 = 0.1e1 / t62;
  t64 = t59 * t63;
  t66 = t42 * t64 + 0.1e1;
  t70 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t66);
  t71 = rho[1] <= p->dens_threshold;
  t72 = -t16;
  t74 = my_piecewise5(t14, t11, t10, t15, t72 * t7);
  t75 = 0.1e1 + t74;
  t76 = t75 <= p->zeta_threshold;
  t77 = POW_1_3(t75);
  t79 = my_piecewise3(t76, t22, t77 * t75);
  t80 = t79 * t26;
  t81 = sqrt(sigma[2]);
  t82 = POW_1_3(rho[1]);
  t84 = 0.1e1 / t82 / rho[1];
  t85 = t81 * t84;
  t87 = t33 * t85 / 0.12e2;
  t88 = tanh(t87);
  t89 = params->mu * t88;
  t90 = log(t87 + sqrt(t87 * t87 + 0.1e1));
  t91 = 0.1e1 + t87;
  t92 = log(t91);
  t95 = t32 * t81;
  t101 = 0.1e1 + params->alpha * (t46 * t85 * t92 / 0.12e2 + t51 * t95 * t84 / 0.12e2);
  t102 = t90 * t101;
  t103 = params->beta * t88;
  t105 = t103 * t90 + 0.1e1;
  t106 = 0.1e1 / t105;
  t107 = t102 * t106;
  t109 = t89 * t107 + 0.1e1;
  t113 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t109);
  tzk0 = t70 + t113;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t40, t41;
  double t42, t43, t44, t46, t47, t48, t51, t52;
  double t58, t59, t60, t62, t63, t64, t66, t70;
  double t71, t72, t74, t75, t76, t77, t79, t80;
  double t81, t82, t84, t85, t87, t88, t89, t90;
  double t91, t92, t95, t101, t102, t103, t105, t106;
  double t107, t109, t113, tzk0;

  double t114, t115, t116, t118, t121, t122, t126, t127;
  double t128, t131, t132, t133, t134, t136, t137, t138;
  double t140, t143, t144, t145, t146, t147, t148, t150;
  double t154, t155, t156, t157, t158, t162, t166, t167;
  double t168, t170, t172, t176, t179, t180, t181, t183;
  double t184, t185, t186, t187, t188, t192, t193, t197;
  double t198, t200, t205, t206, t208, t211, t212, t216;
  double t219, t221, tvrho0, t225, t228, t229, t234, t236;
  double t239, t240, t244, t245, t247, t248, t249, t251;
  double t254, t255, t256, t258, t262, t263, t264, t265;
  double t266, t270, t274, t276, t278, t282, t285, t286;
  double t287, t289, t290, t291, t292, t296, t297, t301;
  double t302, t304, t309, tvrho1, t312, t313, t314, t316;
  double t319, t330, t333, t334, t335, t340, t344, t345;
  double t347, t351, tvsigma0, tvsigma1, t352, t353, t354, t356;
  double t359, t370, t373, t374, t375, t380, t384, t385;
  double t387, t391, tvsigma2;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = tanh(t40);
  t42 = params->mu * t41;
  t43 = log(t40 + sqrt(t40 * t40 + 0.1e1));
  t44 = 0.1e1 - params->zeta;
  t46 = t44 * t29 * t32;
  t47 = 0.1e1 + t40;
  t48 = log(t47);
  t51 = params->zeta * t29;
  t52 = t32 * t34;
  t58 = 0.1e1 + params->alpha * (t51 * t52 * t37 / 0.12e2 + t46 * t38 * t48 / 0.12e2);
  t59 = t43 * t58;
  t60 = params->beta * t41;
  t62 = t60 * t43 + 0.1e1;
  t63 = 0.1e1 / t62;
  t64 = t59 * t63;
  t66 = t42 * t64 + 0.1e1;
  t70 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t66);
  t71 = rho[1] <= p->dens_threshold;
  t72 = -t16;
  t74 = my_piecewise5(t14, t11, t10, t15, t72 * t7);
  t75 = 0.1e1 + t74;
  t76 = t75 <= p->zeta_threshold;
  t77 = POW_1_3(t75);
  t79 = my_piecewise3(t76, t22, t77 * t75);
  t80 = t79 * t26;
  t81 = sqrt(sigma[2]);
  t82 = POW_1_3(rho[1]);
  t84 = 0.1e1 / t82 / rho[1];
  t85 = t81 * t84;
  t87 = t33 * t85 / 0.12e2;
  t88 = tanh(t87);
  t89 = params->mu * t88;
  t90 = log(t87 + sqrt(t87 * t87 + 0.1e1));
  t91 = 0.1e1 + t87;
  t92 = log(t91);
  t95 = t32 * t81;
  t101 = 0.1e1 + params->alpha * (t46 * t85 * t92 / 0.12e2 + t51 * t95 * t84 / 0.12e2);
  t102 = t90 * t101;
  t103 = params->beta * t88;
  t105 = t103 * t90 + 0.1e1;
  t106 = 0.1e1 / t105;
  t107 = t102 * t106;
  t109 = t89 * t107 + 0.1e1;
  t113 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t109);
  tzk0 = t70 + t113;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t114 = t6 * t6;
  t115 = 0.1e1 / t114;
  t116 = t16 * t115;
  t118 = my_piecewise5(t10, 0, t14, 0, t7 - t116);
  t121 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t118);
  t122 = t121 * t26;
  t126 = t26 * t26;
  t127 = 0.1e1 / t126;
  t128 = t25 * t127;
  t131 = t5 * t128 * t66 / 0.8e1;
  t132 = params->mu * t29;
  t133 = t132 * t52;
  t134 = rho[0] * rho[0];
  t136 = 0.1e1 / t35 / t134;
  t137 = t41 * t41;
  t138 = 0.1e1 - t137;
  t140 = t136 * t138 * t64;
  t143 = t42 * t33;
  t144 = t34 * t136;
  t145 = t31 * t31;
  t146 = 0.1e1 / t145;
  t147 = t28 * t146;
  t148 = t35 * t35;
  t150 = 0.1e1 / t148 / t134;
  t154 = 0.6e1 * t147 * t150 * sigma[0] + 0.144e3;
  t155 = sqrt(t154);
  t156 = 0.1e1 / t155;
  t157 = t156 * t58;
  t158 = t157 * t63;
  t162 = t42 * t43;
  t166 = t44 * t28;
  t167 = t166 * t146;
  t168 = t134 * rho[0];
  t170 = 0.1e1 / t148 / t168;
  t172 = 0.1e1 / t47;
  t176 = t52 * t136;
  t179 = -t46 * t144 * t48 / 0.9e1 - t167 * sigma[0] * t170 * t172 / 0.18e2 - t51 * t176 / 0.9e1;
  t180 = params->alpha * t179;
  t181 = t180 * t63;
  t183 = t62 * t62;
  t184 = 0.1e1 / t183;
  t185 = t58 * t184;
  t186 = params->beta * t29;
  t187 = t186 * t32;
  t188 = t138 * t43;
  t192 = t60 * t29;
  t193 = t136 * t156;
  t197 = -t187 * t144 * t188 / 0.9e1 - 0.4e1 / 0.3e1 * t192 * t52 * t193;
  t198 = t185 * t197;
  t200 = -t133 * t140 / 0.9e1 - 0.4e1 / 0.3e1 * t143 * t144 * t158 + t162 * t181 - t162 * t198;
  t205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t66 - t131 - 0.3e1 / 0.8e1 * t5 * t27 * t200);
  t206 = t72 * t115;
  t208 = my_piecewise5(t14, 0, t10, 0, -t7 - t206);
  t211 = my_piecewise3(t76, 0, 0.4e1 / 0.3e1 * t77 * t208);
  t212 = t211 * t26;
  t216 = t79 * t127;
  t219 = t5 * t216 * t109 / 0.8e1;
  t221 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t109 - t219);
  tvrho0 = t70 + t113 + t6 * (t205 + t221);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t225 = my_piecewise5(t10, 0, t14, 0, -t7 - t116);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t225);
  t229 = t228 * t26;
  t234 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t66 - t131);
  t236 = my_piecewise5(t14, 0, t10, 0, t7 - t206);
  t239 = my_piecewise3(t76, 0, 0.4e1 / 0.3e1 * t77 * t236);
  t240 = t239 * t26;
  t244 = t132 * t95;
  t245 = rho[1] * rho[1];
  t247 = 0.1e1 / t82 / t245;
  t248 = t88 * t88;
  t249 = 0.1e1 - t248;
  t251 = t247 * t249 * t107;
  t254 = t89 * t33;
  t255 = t81 * t247;
  t256 = t82 * t82;
  t258 = 0.1e1 / t256 / t245;
  t262 = 0.6e1 * t147 * t258 * sigma[2] + 0.144e3;
  t263 = sqrt(t262);
  t264 = 0.1e1 / t263;
  t265 = t264 * t101;
  t266 = t265 * t106;
  t270 = t89 * t90;
  t274 = t245 * rho[1];
  t276 = 0.1e1 / t256 / t274;
  t278 = 0.1e1 / t91;
  t282 = t95 * t247;
  t285 = -t46 * t255 * t92 / 0.9e1 - t167 * sigma[2] * t276 * t278 / 0.18e2 - t51 * t282 / 0.9e1;
  t286 = params->alpha * t285;
  t287 = t286 * t106;
  t289 = t105 * t105;
  t290 = 0.1e1 / t289;
  t291 = t101 * t290;
  t292 = t249 * t90;
  t296 = t103 * t29;
  t297 = t247 * t264;
  t301 = -t187 * t255 * t292 / 0.9e1 - 0.4e1 / 0.3e1 * t296 * t95 * t297;
  t302 = t291 * t301;
  t304 = -t244 * t251 / 0.9e1 - 0.4e1 / 0.3e1 * t254 * t255 * t266 + t270 * t287 - t270 * t302;
  t309 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t109 - t219 - 0.3e1 / 0.8e1 * t5 * t80 * t304);
  tvrho1 = t70 + t113 + t6 * (t234 + t309);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t312 = 0.1e1 / t34;
  t313 = t32 * t312;
  t314 = t132 * t313;
  t316 = t37 * t138 * t64;
  t319 = t312 * t37;
  t330 = t313 * t37;
  t333 = t46 * t319 * t48 / 0.24e2 + t166 * t146 * t150 * t172 / 0.48e2 + t51 * t330 / 0.24e2;
  t334 = params->alpha * t333;
  t335 = t334 * t63;
  t340 = t37 * t156;
  t344 = t187 * t319 * t188 / 0.24e2 + t192 * t313 * t340 / 0.2e1;
  t345 = t185 * t344;
  t347 = t314 * t316 / 0.24e2 + t143 * t319 * t158 / 0.2e1 + t162 * t335 - t162 * t345;
  t351 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t347);
  tvsigma0 = t6 * t351;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t352 = 0.1e1 / t81;
  t353 = t32 * t352;
  t354 = t132 * t353;
  t356 = t84 * t249 * t107;
  t359 = t352 * t84;
  t370 = t353 * t84;
  t373 = t46 * t359 * t92 / 0.24e2 + t166 * t146 * t258 * t278 / 0.48e2 + t51 * t370 / 0.24e2;
  t374 = params->alpha * t373;
  t375 = t374 * t106;
  t380 = t84 * t264;
  t384 = t187 * t359 * t292 / 0.24e2 + t296 * t353 * t380 / 0.2e1;
  t385 = t291 * t384;
  t387 = t354 * t356 / 0.24e2 + t254 * t359 * t266 / 0.2e1 + t270 * t375 - t270 * t385;
  t391 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t387);
  tvsigma2 = t6 * t391;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t40, t41;
  double t42, t43, t44, t46, t47, t48, t51, t52;
  double t58, t59, t60, t62, t63, t64, t66, t70;
  double t71, t72, t74, t75, t76, t77, t79, t80;
  double t81, t82, t84, t85, t87, t88, t89, t90;
  double t91, t92, t95, t101, t102, t103, t105, t106;
  double t107, t109, t113, tzk0;

  double t114, t115, t116, t118, t121, t122, t126, t127;
  double t128, t131, t132, t133, t134, t136, t137, t138;
  double t140, t143, t144, t145, t146, t147, t148, t150;
  double t154, t155, t156, t157, t158, t162, t166, t167;
  double t168, t170, t172, t176, t179, t180, t181, t183;
  double t184, t185, t186, t187, t188, t192, t193, t197;
  double t198, t200, t205, t206, t208, t211, t212, t216;
  double t219, t221, tvrho0, t225, t228, t229, t234, t236;
  double t239, t240, t244, t245, t247, t248, t249, t251;
  double t254, t255, t256, t258, t262, t263, t264, t265;
  double t266, t270, t274, t276, t278, t282, t285, t286;
  double t287, t289, t290, t291, t292, t296, t297, t301;
  double t302, t304, t309, tvrho1, t312, t313, t314, t316;
  double t319, t330, t333, t334, t335, t340, t344, t345;
  double t347, t351, tvsigma0, tvsigma1, t352, t353, t354, t356;
  double t359, t370, t373, t374, t375, t380, t384, t385;
  double t387, t391, tvsigma2;

  double t394, t395, t396, t399, t400, t401, t404, t408;
  double t409, t413, t415, t421, t422, t425, t427, t430;
  double t432, t435, t436, t437, t439, t441, t442, t443;
  double t446, t447, t448, t451, t452, t455, t458, t462;
  double t463, t464, t465, t466, t467, t469, t470, t471;
  double t472, t476, t477, t480, t486, t490, t491, t492;
  double t493, t497, t500, t501, t502, t504, t509, t510;
  double t511, t512, t518, t519, t521, t524, t525, t529;
  double t533, t537, t538, t540, t545, t546, t547, t548;
  double t551, t554, t558, t559, t563, t565, t567, t570;
  double t572, tv2rho20, t575, t579, t583, t584, t588, t590;
  double t598, t599, t603, t607, t608, t612, t614, t621;
  double t624, tv2rho21, t629, t634, t638, t639, t645, t646;
  double t651, t655, t656, t666, t668, t671, t672, t674;
  double t676, t677, t678, t681, t682, t683, t686, t687;
  double t690, t693, t697, t698, t699, t700, t701, t703;
  double t704, t705, t706, t710, t711, t714, t720, t724;
  double t725, t726, t730, t733, t734, t735, t737, t742;
  double t743, t744, t745, t751, t753, t756, t760, t764;
  double t768, t769, t771, t776, tv2rho22, t784, t787, t788;
  double t791, t794, t799, t803, t804, t805, t806, t807;
  double t808, t812, t813, t816, t819, t822, t835, t838;
  double t839, t840, t844, t847, t850, t853, t861, t864;
  double t875, t876, t878, t883, tv2rhosigma0, tv2rhosigma1, t890, t892;
  double tv2rhosigma2, t898, tv2rhosigma3, tv2rhosigma4, t905, t906, t909, t912;
  double t917, t921, t922, t923, t924, t925, t926, t930;
  double t931, t934, t937, t940, t953, t956, t957, t958;
  double t962, t965, t968, t971, t979, t982, t993, t994;
  double t996, t1001, tv2rhosigma5, t1003, t1004, t1005, t1008, t1009;
  double t1011, t1014, t1016, t1023, t1027, t1028, t1029, t1030;
  double t1031, t1034, t1036, t1041, t1049, t1052, t1053, t1054;
  double t1059, t1060, t1066, t1068, t1081, t1082, t1084, t1088;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1089, t1090, t1091;
  double t1094, t1095, t1097, t1100, t1102, t1109, t1113, t1114;
  double t1115, t1116, t1117, t1120, t1122, t1127, t1135, t1138;
  double t1139, t1140, t1145, t1146, t1152, t1154, t1167, t1168;
  double t1170, t1174, tv2sigma25;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = tanh(t40);
  t42 = params->mu * t41;
  t43 = log(t40 + sqrt(t40 * t40 + 0.1e1));
  t44 = 0.1e1 - params->zeta;
  t46 = t44 * t29 * t32;
  t47 = 0.1e1 + t40;
  t48 = log(t47);
  t51 = params->zeta * t29;
  t52 = t32 * t34;
  t58 = 0.1e1 + params->alpha * (t51 * t52 * t37 / 0.12e2 + t46 * t38 * t48 / 0.12e2);
  t59 = t43 * t58;
  t60 = params->beta * t41;
  t62 = t60 * t43 + 0.1e1;
  t63 = 0.1e1 / t62;
  t64 = t59 * t63;
  t66 = t42 * t64 + 0.1e1;
  t70 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t66);
  t71 = rho[1] <= p->dens_threshold;
  t72 = -t16;
  t74 = my_piecewise5(t14, t11, t10, t15, t72 * t7);
  t75 = 0.1e1 + t74;
  t76 = t75 <= p->zeta_threshold;
  t77 = POW_1_3(t75);
  t79 = my_piecewise3(t76, t22, t77 * t75);
  t80 = t79 * t26;
  t81 = sqrt(sigma[2]);
  t82 = POW_1_3(rho[1]);
  t84 = 0.1e1 / t82 / rho[1];
  t85 = t81 * t84;
  t87 = t33 * t85 / 0.12e2;
  t88 = tanh(t87);
  t89 = params->mu * t88;
  t90 = log(t87 + sqrt(t87 * t87 + 0.1e1));
  t91 = 0.1e1 + t87;
  t92 = log(t91);
  t95 = t32 * t81;
  t101 = 0.1e1 + params->alpha * (t46 * t85 * t92 / 0.12e2 + t51 * t95 * t84 / 0.12e2);
  t102 = t90 * t101;
  t103 = params->beta * t88;
  t105 = t103 * t90 + 0.1e1;
  t106 = 0.1e1 / t105;
  t107 = t102 * t106;
  t109 = t89 * t107 + 0.1e1;
  t113 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t109);
  tzk0 = t70 + t113;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t114 = t6 * t6;
  t115 = 0.1e1 / t114;
  t116 = t16 * t115;
  t118 = my_piecewise5(t10, 0, t14, 0, t7 - t116);
  t121 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t118);
  t122 = t121 * t26;
  t126 = t26 * t26;
  t127 = 0.1e1 / t126;
  t128 = t25 * t127;
  t131 = t5 * t128 * t66 / 0.8e1;
  t132 = params->mu * t29;
  t133 = t132 * t52;
  t134 = rho[0] * rho[0];
  t136 = 0.1e1 / t35 / t134;
  t137 = t41 * t41;
  t138 = 0.1e1 - t137;
  t140 = t136 * t138 * t64;
  t143 = t42 * t33;
  t144 = t34 * t136;
  t145 = t31 * t31;
  t146 = 0.1e1 / t145;
  t147 = t28 * t146;
  t148 = t35 * t35;
  t150 = 0.1e1 / t148 / t134;
  t154 = 0.6e1 * t147 * t150 * sigma[0] + 0.144e3;
  t155 = sqrt(t154);
  t156 = 0.1e1 / t155;
  t157 = t156 * t58;
  t158 = t157 * t63;
  t162 = t42 * t43;
  t166 = t44 * t28;
  t167 = t166 * t146;
  t168 = t134 * rho[0];
  t170 = 0.1e1 / t148 / t168;
  t172 = 0.1e1 / t47;
  t176 = t52 * t136;
  t179 = -t46 * t144 * t48 / 0.9e1 - t167 * sigma[0] * t170 * t172 / 0.18e2 - t51 * t176 / 0.9e1;
  t180 = params->alpha * t179;
  t181 = t180 * t63;
  t183 = t62 * t62;
  t184 = 0.1e1 / t183;
  t185 = t58 * t184;
  t186 = params->beta * t29;
  t187 = t186 * t32;
  t188 = t138 * t43;
  t192 = t60 * t29;
  t193 = t136 * t156;
  t197 = -t187 * t144 * t188 / 0.9e1 - 0.4e1 / 0.3e1 * t192 * t52 * t193;
  t198 = t185 * t197;
  t200 = -t133 * t140 / 0.9e1 - 0.4e1 / 0.3e1 * t143 * t144 * t158 + t162 * t181 - t162 * t198;
  t205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t66 - t131 - 0.3e1 / 0.8e1 * t5 * t27 * t200);
  t206 = t72 * t115;
  t208 = my_piecewise5(t14, 0, t10, 0, -t7 - t206);
  t211 = my_piecewise3(t76, 0, 0.4e1 / 0.3e1 * t77 * t208);
  t212 = t211 * t26;
  t216 = t79 * t127;
  t219 = t5 * t216 * t109 / 0.8e1;
  t221 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t109 - t219);
  tvrho0 = t70 + t113 + t6 * (t205 + t221);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t225 = my_piecewise5(t10, 0, t14, 0, -t7 - t116);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t225);
  t229 = t228 * t26;
  t234 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t66 - t131);
  t236 = my_piecewise5(t14, 0, t10, 0, t7 - t206);
  t239 = my_piecewise3(t76, 0, 0.4e1 / 0.3e1 * t77 * t236);
  t240 = t239 * t26;
  t244 = t132 * t95;
  t245 = rho[1] * rho[1];
  t247 = 0.1e1 / t82 / t245;
  t248 = t88 * t88;
  t249 = 0.1e1 - t248;
  t251 = t247 * t249 * t107;
  t254 = t89 * t33;
  t255 = t81 * t247;
  t256 = t82 * t82;
  t258 = 0.1e1 / t256 / t245;
  t262 = 0.6e1 * t147 * t258 * sigma[2] + 0.144e3;
  t263 = sqrt(t262);
  t264 = 0.1e1 / t263;
  t265 = t264 * t101;
  t266 = t265 * t106;
  t270 = t89 * t90;
  t274 = t245 * rho[1];
  t276 = 0.1e1 / t256 / t274;
  t278 = 0.1e1 / t91;
  t282 = t95 * t247;
  t285 = -t46 * t255 * t92 / 0.9e1 - t167 * sigma[2] * t276 * t278 / 0.18e2 - t51 * t282 / 0.9e1;
  t286 = params->alpha * t285;
  t287 = t286 * t106;
  t289 = t105 * t105;
  t290 = 0.1e1 / t289;
  t291 = t101 * t290;
  t292 = t249 * t90;
  t296 = t103 * t29;
  t297 = t247 * t264;
  t301 = -t187 * t255 * t292 / 0.9e1 - 0.4e1 / 0.3e1 * t296 * t95 * t297;
  t302 = t291 * t301;
  t304 = -t244 * t251 / 0.9e1 - 0.4e1 / 0.3e1 * t254 * t255 * t266 + t270 * t287 - t270 * t302;
  t309 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t109 - t219 - 0.3e1 / 0.8e1 * t5 * t80 * t304);
  tvrho1 = t70 + t113 + t6 * (t234 + t309);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t312 = 0.1e1 / t34;
  t313 = t32 * t312;
  t314 = t132 * t313;
  t316 = t37 * t138 * t64;
  t319 = t312 * t37;
  t330 = t313 * t37;
  t333 = t46 * t319 * t48 / 0.24e2 + t166 * t146 * t150 * t172 / 0.48e2 + t51 * t330 / 0.24e2;
  t334 = params->alpha * t333;
  t335 = t334 * t63;
  t340 = t37 * t156;
  t344 = t187 * t319 * t188 / 0.24e2 + t192 * t313 * t340 / 0.2e1;
  t345 = t185 * t344;
  t347 = t314 * t316 / 0.24e2 + t143 * t319 * t158 / 0.2e1 + t162 * t335 - t162 * t345;
  t351 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t347);
  tvsigma0 = t6 * t351;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t352 = 0.1e1 / t81;
  t353 = t32 * t352;
  t354 = t132 * t353;
  t356 = t84 * t249 * t107;
  t359 = t352 * t84;
  t370 = t353 * t84;
  t373 = t46 * t359 * t92 / 0.24e2 + t166 * t146 * t258 * t278 / 0.48e2 + t51 * t370 / 0.24e2;
  t374 = params->alpha * t373;
  t375 = t374 * t106;
  t380 = t84 * t264;
  t384 = t187 * t359 * t292 / 0.24e2 + t296 * t353 * t380 / 0.2e1;
  t385 = t291 * t384;
  t387 = t354 * t356 / 0.24e2 + t254 * t359 * t266 / 0.2e1 + t270 * t375 - t270 * t385;
  t391 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t387);
  tvsigma2 = t6 * t391;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t394 = t23 * t23;
  t395 = 0.1e1 / t394;
  t396 = t118 * t118;
  t399 = t114 * t6;
  t400 = 0.1e1 / t399;
  t401 = t16 * t400;
  t404 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t115 + 0.2e1 * t401);
  t408 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t395 * t396 + 0.4e1 / 0.3e1 * t23 * t404);
  t409 = t408 * t26;
  t413 = t121 * t127;
  t415 = t5 * t413 * t66;
  t421 = 0.1e1 / t126 / t6;
  t422 = t25 * t421;
  t425 = t5 * t422 * t66 / 0.12e2;
  t427 = t5 * t128 * t200;
  t430 = 0.1e1 / t35 / t168;
  t432 = t430 * t138 * t64;
  t435 = params->mu * t28;
  t436 = t146 * sigma[0];
  t437 = t134 * t134;
  t439 = 0.1e1 / t148 / t437;
  t441 = t435 * t436 * t439;
  t442 = t41 * t138;
  t443 = t442 * t64;
  t446 = t435 * t436;
  t447 = t439 * t138;
  t448 = t447 * t158;
  t451 = t132 * t176;
  t452 = t188 * t181;
  t455 = t188 * t198;
  t458 = t34 * t430;
  t462 = 0.1e1 / t30;
  t463 = t34 * sigma[0];
  t464 = t462 * t463;
  t465 = t42 * t464;
  t466 = t437 * t134;
  t467 = 0.1e1 / t466;
  t469 = 0.1e1 / t155 / t154;
  t470 = t467 * t469;
  t471 = t58 * t63;
  t472 = t470 * t471;
  t476 = t42 * t33 * t34;
  t477 = t193 * t181;
  t480 = t193 * t198;
  t486 = sigma[0] * t439;
  t490 = t44 * t462;
  t491 = t463 * t467;
  t492 = t47 * t47;
  t493 = 0.1e1 / t492;
  t497 = t52 * t430;
  t500 = 0.7e1 / 0.27e2 * t46 * t458 * t48 + 0.5e1 / 0.18e2 * t167 * t486 * t172 - t490 * t491 * t493 / 0.27e2 + 0.7e1 / 0.27e2 * t51 * t497;
  t501 = params->alpha * t500;
  t502 = t501 * t63;
  t504 = t184 * t197;
  t509 = 0.1e1 / t183 / t62;
  t510 = t58 * t509;
  t511 = t197 * t197;
  t512 = t510 * t511;
  t518 = params->beta * t28;
  t519 = t518 * t436;
  t521 = t439 * t41 * t188;
  t524 = t518 * t146;
  t525 = t138 * t156;
  t529 = t430 * t156;
  t533 = t60 * t462;
  t537 = 0.7e1 / 0.27e2 * t187 * t458 * t188 - 0.4e1 / 0.27e2 * t519 * t521 + 0.16e2 / 0.9e1 * t524 * t486 * t525 + 0.28e2 / 0.9e1 * t192 * t52 * t529 - 0.64e2 * t533 * t491 * t469;
  t538 = t185 * t537;
  t540 = 0.7e1 / 0.27e2 * t133 * t432 - 0.4e1 / 0.27e2 * t441 * t443 + 0.16e2 / 0.9e1 * t446 * t448 - 0.2e1 / 0.9e1 * t451 * t452 + 0.2e1 / 0.9e1 * t451 * t455 + 0.28e2 / 0.9e1 * t143 * t458 * t158 - 0.64e2 * t465 * t472 - 0.8e1 / 0.3e1 * t476 * t477 + 0.8e1 / 0.3e1 * t476 * t480 + t162 * t502 - 0.2e1 * t162 * t180 * t504 + 0.2e1 * t162 * t512 - t162 * t538;
  t545 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t409 * t66 - t415 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t122 * t200 + t425 - t427 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t540);
  t546 = t77 * t77;
  t547 = 0.1e1 / t546;
  t548 = t208 * t208;
  t551 = t72 * t400;
  t554 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t115 + 0.2e1 * t551);
  t558 = my_piecewise3(t76, 0, 0.4e1 / 0.9e1 * t547 * t548 + 0.4e1 / 0.3e1 * t77 * t554);
  t559 = t558 * t26;
  t563 = t211 * t127;
  t565 = t5 * t563 * t109;
  t567 = t79 * t421;
  t570 = t5 * t567 * t109 / 0.12e2;
  t572 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t559 * t109 - t565 / 0.4e1 + t570);
  tv2rho20 = 0.2e1 * t205 + 0.2e1 * t221 + t6 * (t545 + t572);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t575 = t395 * t225;
  t579 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t401);
  t583 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t575 * t118 + 0.4e1 / 0.3e1 * t23 * t579);
  t584 = t583 * t26;
  t588 = t228 * t127;
  t590 = t5 * t588 * t66;
  t598 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t584 * t66 - t590 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t200 - t415 / 0.8e1 + t425 - t427 / 0.8e1);
  t599 = t547 * t236;
  t603 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t551);
  t607 = my_piecewise3(t76, 0, 0.4e1 / 0.9e1 * t599 * t208 + 0.4e1 / 0.3e1 * t77 * t603);
  t608 = t607 * t26;
  t612 = t239 * t127;
  t614 = t5 * t612 * t109;
  t621 = t5 * t216 * t304;
  t624 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t608 * t109 - t614 / 0.8e1 - t565 / 0.8e1 + t570 - 0.3e1 / 0.8e1 * t5 * t212 * t304 - t621 / 0.8e1);
  tv2rho21 = t205 + t221 + t234 + t309 + t6 * (t598 + t624);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t629 = t225 * t225;
  t634 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t115 + 0.2e1 * t401);
  t638 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t395 * t629 + 0.4e1 / 0.3e1 * t23 * t634);
  t639 = t638 * t26;
  t645 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t639 * t66 - t590 / 0.4e1 + t425);
  t646 = t236 * t236;
  t651 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t115 + 0.2e1 * t551);
  t655 = my_piecewise3(t76, 0, 0.4e1 / 0.9e1 * t547 * t646 + 0.4e1 / 0.3e1 * t77 * t651);
  t656 = t655 * t26;
  t666 = 0.1e1 / t82 / t274;
  t668 = t666 * t249 * t107;
  t671 = t146 * sigma[2];
  t672 = t245 * t245;
  t674 = 0.1e1 / t256 / t672;
  t676 = t435 * t671 * t674;
  t677 = t88 * t249;
  t678 = t677 * t107;
  t681 = t435 * t671;
  t682 = t674 * t249;
  t683 = t682 * t266;
  t686 = t132 * t282;
  t687 = t292 * t287;
  t690 = t292 * t302;
  t693 = t81 * t666;
  t697 = t81 * sigma[2];
  t698 = t462 * t697;
  t699 = t89 * t698;
  t700 = t672 * t245;
  t701 = 0.1e1 / t700;
  t703 = 0.1e1 / t263 / t262;
  t704 = t701 * t703;
  t705 = t101 * t106;
  t706 = t704 * t705;
  t710 = t89 * t33 * t81;
  t711 = t297 * t287;
  t714 = t297 * t302;
  t720 = sigma[2] * t674;
  t724 = t697 * t701;
  t725 = t91 * t91;
  t726 = 0.1e1 / t725;
  t730 = t95 * t666;
  t733 = 0.7e1 / 0.27e2 * t46 * t693 * t92 + 0.5e1 / 0.18e2 * t167 * t720 * t278 - t490 * t724 * t726 / 0.27e2 + 0.7e1 / 0.27e2 * t51 * t730;
  t734 = params->alpha * t733;
  t735 = t734 * t106;
  t737 = t290 * t301;
  t742 = 0.1e1 / t289 / t105;
  t743 = t101 * t742;
  t744 = t301 * t301;
  t745 = t743 * t744;
  t751 = t518 * t671;
  t753 = t674 * t88 * t292;
  t756 = t249 * t264;
  t760 = t666 * t264;
  t764 = t103 * t462;
  t768 = 0.7e1 / 0.27e2 * t187 * t693 * t292 - 0.4e1 / 0.27e2 * t751 * t753 + 0.16e2 / 0.9e1 * t524 * t720 * t756 + 0.28e2 / 0.9e1 * t296 * t95 * t760 - 0.64e2 * t764 * t724 * t703;
  t769 = t291 * t768;
  t771 = 0.7e1 / 0.27e2 * t244 * t668 - 0.4e1 / 0.27e2 * t676 * t678 + 0.16e2 / 0.9e1 * t681 * t683 - 0.2e1 / 0.9e1 * t686 * t687 + 0.2e1 / 0.9e1 * t686 * t690 + 0.28e2 / 0.9e1 * t254 * t693 * t266 - 0.64e2 * t699 * t706 - 0.8e1 / 0.3e1 * t710 * t711 + 0.8e1 / 0.3e1 * t710 * t714 + t270 * t735 - 0.2e1 * t270 * t286 * t737 + 0.2e1 * t270 * t745 - t270 * t769;
  t776 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t656 * t109 - t614 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t304 + t570 - t621 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t80 * t771);
  tv2rho22 = 0.2e1 * t234 + 0.2e1 * t309 + t6 * (t645 + t776);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t784 = t5 * t128 * t347 / 0.8e1;
  t787 = t146 * t170;
  t788 = t435 * t787;
  t791 = t525 * t471;
  t794 = t132 * t330;
  t799 = t312 * t136;
  t803 = t462 * t34;
  t804 = t42 * t803;
  t805 = t437 * rho[0];
  t806 = 0.1e1 / t805;
  t807 = t806 * t469;
  t808 = t807 * t471;
  t812 = t42 * t33 * t312;
  t813 = t340 * t181;
  t816 = t340 * t198;
  t819 = t188 * t335;
  t822 = t193 * t335;
  t835 = t313 * t136;
  t838 = -t46 * t799 * t48 / 0.18e2 - t166 * t787 * t172 / 0.12e2 + t490 * t806 * t493 * t34 / 0.72e2 - t51 * t835 / 0.18e2;
  t839 = params->alpha * t838;
  t840 = t839 * t63;
  t844 = t188 * t345;
  t847 = t193 * t345;
  t850 = t184 * t344;
  t853 = t344 * t197;
  t861 = t170 * t41 * t188;
  t864 = t170 * t138;
  t875 = -t187 * t799 * t188 / 0.18e2 + t524 * t861 / 0.18e2 - 0.2e1 / 0.3e1 * t524 * t864 * t156 - 0.2e1 / 0.3e1 * t192 * t313 * t193 + 0.24e2 * t533 * t34 * t806 * t469;
  t876 = t185 * t875;
  t878 = -t314 * t140 / 0.18e2 + t788 * t443 / 0.18e2 - 0.2e1 / 0.3e1 * t788 * t791 + t794 * t452 / 0.24e2 - t794 * t455 / 0.24e2 - 0.2e1 / 0.3e1 * t143 * t799 * t158 + 0.24e2 * t804 * t808 + t812 * t813 / 0.2e1 - t812 * t816 / 0.2e1 - t451 * t819 / 0.9e1 - 0.4e1 / 0.3e1 * t476 * t822 + t162 * t840 - t162 * t334 * t504 + t451 * t844 / 0.9e1 + 0.4e1 / 0.3e1 * t476 * t847 - t162 * t180 * t850 + 0.2e1 * t162 * t510 * t853 - t162 * t876;
  t883 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t347 - t784 - 0.3e1 / 0.8e1 * t5 * t27 * t878);
  tv2rhosigma0 = t6 * t883 + t351;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t890 = t5 * t216 * t387 / 0.8e1;
  t892 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t387 - t890);
  tv2rhosigma2 = t6 * t892 + t391;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t898 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t347 - t784);
  tv2rhosigma3 = t6 * t898 + t351;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t905 = t146 * t276;
  t906 = t435 * t905;
  t909 = t756 * t705;
  t912 = t132 * t370;
  t917 = t352 * t247;
  t921 = t462 * t81;
  t922 = t89 * t921;
  t923 = t672 * rho[1];
  t924 = 0.1e1 / t923;
  t925 = t924 * t703;
  t926 = t925 * t705;
  t930 = t89 * t33 * t352;
  t931 = t380 * t287;
  t934 = t380 * t302;
  t937 = t292 * t375;
  t940 = t297 * t375;
  t953 = t353 * t247;
  t956 = -t46 * t917 * t92 / 0.18e2 - t166 * t905 * t278 / 0.12e2 + t490 * t924 * t726 * t81 / 0.72e2 - t51 * t953 / 0.18e2;
  t957 = params->alpha * t956;
  t958 = t957 * t106;
  t962 = t292 * t385;
  t965 = t297 * t385;
  t968 = t290 * t384;
  t971 = t384 * t301;
  t979 = t276 * t88 * t292;
  t982 = t276 * t249;
  t993 = -t187 * t917 * t292 / 0.18e2 + t524 * t979 / 0.18e2 - 0.2e1 / 0.3e1 * t524 * t982 * t264 - 0.2e1 / 0.3e1 * t296 * t353 * t297 + 0.24e2 * t764 * t81 * t924 * t703;
  t994 = t291 * t993;
  t996 = -t354 * t251 / 0.18e2 + t906 * t678 / 0.18e2 - 0.2e1 / 0.3e1 * t906 * t909 + t912 * t687 / 0.24e2 - t912 * t690 / 0.24e2 - 0.2e1 / 0.3e1 * t254 * t917 * t266 + 0.24e2 * t922 * t926 + t930 * t931 / 0.2e1 - t930 * t934 / 0.2e1 - t686 * t937 / 0.9e1 - 0.4e1 / 0.3e1 * t710 * t940 + t270 * t958 - t270 * t374 * t737 + t686 * t962 / 0.9e1 + 0.4e1 / 0.3e1 * t710 * t965 - t270 * t286 * t968 + 0.2e1 * t270 * t743 * t971 - t270 * t994;
  t1001 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t387 - t890 - 0.3e1 / 0.8e1 * t5 * t80 * t996);
  tv2rhosigma5 = t6 * t1001 + t391;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1003 = 0.1e1 / t463;
  t1004 = t32 * t1003;
  t1005 = t132 * t1004;
  t1008 = 0.1e1 / sigma[0];
  t1009 = t146 * t1008;
  t1011 = t435 * t1009 * t150;
  t1014 = t435 * t1009;
  t1016 = t150 * t138 * t158;
  t1023 = t1003 * t37;
  t1027 = t462 * t312;
  t1028 = t42 * t1027;
  t1029 = 0.1e1 / t437;
  t1030 = t1029 * t469;
  t1031 = t1030 * t471;
  t1034 = t340 * t335;
  t1036 = t340 * t345;
  t1041 = t1008 * t150;
  t1049 = t1004 * t37;
  t1052 = -t46 * t1023 * t48 / 0.48e2 + t167 * t1041 * t172 / 0.96e2 - t490 * t1029 * t493 * t312 / 0.192e3 - t51 * t1049 / 0.48e2;
  t1053 = params->alpha * t1052;
  t1054 = t1053 * t63;
  t1059 = t344 * t344;
  t1060 = t510 * t1059;
  t1066 = t518 * t1009;
  t1068 = t150 * t41 * t188;
  t1081 = -t187 * t1023 * t188 / 0.48e2 - t1066 * t1068 / 0.48e2 + t524 * t1041 * t525 / 0.4e1 - t192 * t1004 * t340 / 0.4e1 - 0.9e1 * t533 * t312 * t1029 * t469;
  t1082 = t185 * t1081;
  t1084 = -t1005 * t316 / 0.48e2 - t1011 * t443 / 0.48e2 + t1014 * t1016 / 0.4e1 + t794 * t819 / 0.12e2 - t794 * t844 / 0.12e2 - t143 * t1023 * t158 / 0.4e1 - 0.9e1 * t1028 * t1031 + t812 * t1034 - t812 * t1036 + t162 * t1054 - 0.2e1 * t162 * t334 * t850 + 0.2e1 * t162 * t1060 - t162 * t1082;
  t1088 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1084);
  tv2sigma20 = t6 * t1088;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1089 = 0.1e1 / t697;
  t1090 = t32 * t1089;
  t1091 = t132 * t1090;
  t1094 = 0.1e1 / sigma[2];
  t1095 = t146 * t1094;
  t1097 = t435 * t1095 * t258;
  t1100 = t435 * t1095;
  t1102 = t258 * t249 * t266;
  t1109 = t1089 * t84;
  t1113 = t462 * t352;
  t1114 = t89 * t1113;
  t1115 = 0.1e1 / t672;
  t1116 = t1115 * t703;
  t1117 = t1116 * t705;
  t1120 = t380 * t375;
  t1122 = t380 * t385;
  t1127 = t1094 * t258;
  t1135 = t1090 * t84;
  t1138 = -t46 * t1109 * t92 / 0.48e2 + t167 * t1127 * t278 / 0.96e2 - t490 * t1115 * t726 * t352 / 0.192e3 - t51 * t1135 / 0.48e2;
  t1139 = params->alpha * t1138;
  t1140 = t1139 * t106;
  t1145 = t384 * t384;
  t1146 = t743 * t1145;
  t1152 = t518 * t1095;
  t1154 = t258 * t88 * t292;
  t1167 = -t187 * t1109 * t292 / 0.48e2 - t1152 * t1154 / 0.48e2 + t524 * t1127 * t756 / 0.4e1 - t296 * t1090 * t380 / 0.4e1 - 0.9e1 * t764 * t352 * t1115 * t703;
  t1168 = t291 * t1167;
  t1170 = -t1091 * t356 / 0.48e2 - t1097 * t678 / 0.48e2 + t1100 * t1102 / 0.4e1 + t912 * t937 / 0.12e2 - t912 * t962 / 0.12e2 - t254 * t1109 * t266 / 0.4e1 - 0.9e1 * t1114 * t1117 + t930 * t1120 - t930 * t1122 + t270 * t1140 - 0.2e1 * t270 * t374 * t968 + 0.2e1 * t270 * t1146 - t270 * t1168;
  t1174 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t1170);
  tv2sigma25 = t6 * t1174;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t40, t41;
  double t42, t43, t44, t46, t47, t48, t51, t52;
  double t58, t59, t60, t62, t63, t64, t66, t70;
  double t71, t72, t74, t75, t76, t77, t79, t80;
  double t81, t82, t84, t85, t87, t88, t89, t90;
  double t91, t92, t95, t101, t102, t103, t105, t106;
  double t107, t109, t113, tzk0;

  double t114, t115, t116, t118, t121, t122, t126, t127;
  double t128, t131, t132, t133, t134, t136, t137, t138;
  double t140, t143, t144, t145, t146, t147, t148, t150;
  double t154, t155, t156, t157, t158, t162, t166, t167;
  double t168, t170, t172, t176, t179, t180, t181, t183;
  double t184, t185, t186, t187, t188, t192, t193, t197;
  double t198, t200, t205, t206, t208, t211, t212, t216;
  double t219, t221, tvrho0, t225, t228, t229, t234, t236;
  double t239, t240, t244, t245, t247, t248, t249, t251;
  double t254, t255, t256, t258, t262, t263, t264, t265;
  double t266, t270, t274, t276, t278, t282, t285, t286;
  double t287, t289, t290, t291, t292, t296, t297, t301;
  double t302, t304, t309, tvrho1, t312, t313, t314, t316;
  double t319, t330, t333, t334, t335, t340, t344, t345;
  double t347, t351, tvsigma0, tvsigma1, t352, t353, t354, t356;
  double t359, t370, t373, t374, t375, t380, t384, t385;
  double t387, t391, tvsigma2;

  double t394, t395, t396, t399, t400, t401, t404, t408;
  double t409, t413, t415, t421, t422, t425, t427, t430;
  double t432, t435, t436, t437, t439, t441, t442, t443;
  double t446, t447, t448, t451, t452, t455, t458, t462;
  double t463, t464, t465, t466, t467, t469, t470, t471;
  double t472, t476, t477, t480, t486, t490, t491, t492;
  double t493, t497, t500, t501, t502, t504, t509, t510;
  double t511, t512, t518, t519, t521, t524, t525, t529;
  double t533, t537, t538, t540, t545, t546, t547, t548;
  double t551, t554, t558, t559, t563, t565, t567, t570;
  double t572, tv2rho20, t575, t579, t583, t584, t588, t590;
  double t598, t599, t603, t607, t608, t612, t614, t621;
  double t624, tv2rho21, t629, t634, t638, t639, t645, t646;
  double t651, t655, t656, t666, t668, t671, t672, t674;
  double t676, t677, t678, t681, t682, t683, t686, t687;
  double t690, t693, t697, t698, t699, t700, t701, t703;
  double t704, t705, t706, t710, t711, t714, t720, t724;
  double t725, t726, t730, t733, t734, t735, t737, t742;
  double t743, t744, t745, t751, t753, t756, t760, t764;
  double t768, t769, t771, t776, tv2rho22, t784, t787, t788;
  double t791, t794, t799, t803, t804, t805, t806, t807;
  double t808, t812, t813, t816, t819, t822, t835, t838;
  double t839, t840, t844, t847, t850, t853, t861, t864;
  double t875, t876, t878, t883, tv2rhosigma0, tv2rhosigma1, t890, t892;
  double tv2rhosigma2, t898, tv2rhosigma3, tv2rhosigma4, t905, t906, t909, t912;
  double t917, t921, t922, t923, t924, t925, t926, t930;
  double t931, t934, t937, t940, t953, t956, t957, t958;
  double t962, t965, t968, t971, t979, t982, t993, t994;
  double t996, t1001, tv2rhosigma5, t1003, t1004, t1005, t1008, t1009;
  double t1011, t1014, t1016, t1023, t1027, t1028, t1029, t1030;
  double t1031, t1034, t1036, t1041, t1049, t1052, t1053, t1054;
  double t1059, t1060, t1066, t1068, t1081, t1082, t1084, t1088;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1089, t1090, t1091;
  double t1094, t1095, t1097, t1100, t1102, t1109, t1113, t1114;
  double t1115, t1116, t1117, t1120, t1122, t1127, t1135, t1138;
  double t1139, t1140, t1145, t1146, t1152, t1154, t1167, t1168;
  double t1170, t1174, tv2sigma25;

  double t1178, t1179, t1182, t1185, t1186, t1187, t1190, t1194;
  double t1195, t1199, t1201, t1206, t1208, t1211, t1217, t1218;
  double t1221, t1223, t1226, t1228, t1229, t1230, t1231, t1232;
  double t1236, t1237, t1242, t1243, t1247, t1248, t1249, t1253;
  double t1254, t1255, t1257, t1259, t1264, t1268, t1269, t1275;
  double t1281, t1282, t1283, t1288, t1292, t1297, t1298, t1300;
  double t1304, t1311, t1312, t1313, t1314, t1315, t1318, t1319;
  double t1320, t1321, t1323, t1324, t1326, t1328, t1331, t1332;
  double t1334, t1341, t1345, t1349, t1350, t1351, t1352, t1355;
  double t1356, t1360, t1361, t1363, t1364, t1367, t1370, t1373;
  double t1376, t1379, t1383, t1388, t1391, t1392, t1395, t1398;
  double t1401, t1404, t1408, t1409, t1410, t1411, t1412, t1415;
  double t1416, t1417, t1418, t1421, t1422, t1425, t1426, t1429;
  double t1433, t1439, t1443, t1444, t1447, t1450, t1451, t1455;
  double t1458, t1461, t1462, t1467, t1469, t1470, t1473, t1476;
  double t1479, t1483, t1484, t1488, t1490, t1492, t1494, t1496;
  double t1499, t1501, tv3rho30, t1504, t1505, t1506, t1509, t1514;
  double t1515, t1517, t1521, t1522, t1526, t1529, t1533, t1535;
  double t1539, t1548, t1549, t1550, t1553, t1558, t1560, t1564;
  double t1565, t1569, t1572, t1573, t1575, t1584, t1586, t1589;
  double tv3rho31, t1592, t1597, t1601, t1605, t1606, t1610, t1612;
  double t1621, t1622, t1627, t1631, t1635, t1636, t1640, t1642;
  double t1649, t1657, t1659, t1660, tv3rho32, t1665, t1672, t1676;
  double t1677, t1684, t1685, t1692, t1696, t1697, t1712, t1713;
  double t1714, t1715, t1716, t1720, t1721, t1726, t1728, t1731;
  double t1735, t1736, t1737, t1738, t1743, t1747, t1751, t1752;
  double t1754, t1756, t1760, t1764, t1768, t1769, t1770, t1771;
  double t1772, t1775, t1776, t1777, t1778, t1780, t1781, t1783;
  double t1785, t1788, t1789, t1800, t1802, t1807, t1811, t1812;
  double t1817, t1821, t1825, t1829, t1830, t1831, t1834, t1835;
  double t1839, t1842, t1845, t1848, t1851, t1854, t1857, t1860;
  double t1864, t1865, t1866, t1867, t1868, t1871, t1873, t1874;
  double t1876, t1877, t1880, t1883, t1886, t1889, t1894, t1895;
  double t1896, t1897, t1900, t1901, t1904, t1907, t1908, t1911;
  double t1912, t1916, t1919, t1923, t1929, t1933, t1934, t1937;
  double t1940, t1941, t1946, tv3rho33, t1954, t1961, t1963, t1965;
  double t1969, t1978, t1979, t1981, t1984, t1988, t1989, t1991;
  double t1994, t1999, t2005, t2011, t2024, t2025, t2027, t2031;
  double t2033, t2036, t2039, t2042, t2045, t2048, t2051, t2054;
  double t2057, t2060, t2061, t2062, t2063, t2066, t2067, t2071;
  double t2074, t2075, t2078, t2080, t2081, t2084, t2087, t2088;
  double t2089, t2092, t2095, t2103, t2106, t2108, t2109, t2112;
  double t2114, t2119, t2120, t2122, t2127, t2130, t2133, t2134;
  double t2137, t2148, t2150, t2154, t2157, t2158, t2161, t2162;
  double t2169, t2173, t2174, t2177, t2179, t2182, t2183, t2185;
  double t2189, t2193, t2207, t2211, t2212, t2213, t2219, t2224;
  double t2226, t2231, tv3rho2sigma0, tv3rho2sigma1, t2238, t2242, t2244, tv3rho2sigma2;
  double t2250, t2258, tv3rho2sigma3, tv3rho2sigma4, t2264, t2271, t2274, tv3rho2sigma5;
  double t2282, tv3rho2sigma6, tv3rho2sigma7, t2293, t2294, t2295, t2296, t2299;
  double t2302, t2303, t2306, t2307, t2310, t2313, t2314, t2315;
  double t2318, t2321, t2324, t2325, t2329, t2335, t2336, t2339;
  double t2341, t2342, t2345, t2347, t2350, t2354, t2355, t2356;
  double t2358, t2363, t2366, t2369, t2372, t2385, t2387, t2390;
  double t2394, t2395, t2405, t2407, t2411, t2414, t2415, t2418;
  double t2419, t2426, t2430, t2431, t2432, t2435, t2437, t2439;
  double t2442, t2443, t2449, t2456, t2463, t2465, t2469, t2473;
  double t2477, t2491, t2495, t2498, t2501, t2504, t2507, t2510;
  double t2511, t2516, t2519, t2522, t2527, t2530, t2534, t2539;
  double t2540, t2541, t2547, t2552, t2554, t2559, tv3rho2sigma8, t2566;
  double t2567, t2568, t2572, t2574, t2575, t2580, t2584, t2586;
  double t2587, t2590, t2592, t2593, t2596, t2609, t2612, t2613;
  double t2616, t2619, t2625, t2636, t2639, t2647, t2651, t2664;
  double t2674, t2676, t2678, t2680, t2683, t2684, t2695, t2697;
  double t2700, t2704, t2705, t2707, t2711, t2715, t2725, t2729;
  double t2733, t2741, t2747, t2750, t2752, t2754, t2759, t2766;
  double t2770, t2783, t2786, t2789, t2792, t2795, t2798, t2800;
  double t2805, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2812, t2814;
  double tv3rhosigma25, t2820, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2825;
  double t2831, t2835, t2849, t2850, t2857, t2861, t2863, t2865;
  double t2867, t2870, t2871, t2882, t2884, t2887, t2891, t2892;
  double t2894, t2899, t2903, t2907, t2911, t2921, t2925, t2926;
  double t2931, t2937, t2938, t2940, t2941, t2944, t2952, t2953;
  double t2956, t2961, t2964, t2967, t2970, t2973, t2976, t2979;
  double t2994, t2997, t3000, t3003, t3006, t3017, t3023, t3026;
  double t3030, t3046, t3049, t3051, t3053, t3056, t3058, t3063;
  double tv3rhosigma211, t3065, t3066, t3070, t3071, t3072, t3075, t3079;
  double t3081, t3085, t3089, t3093, t3098, t3102, t3106, t3107;
  double t3108, t3109, t3112, t3114, t3116, t3119, t3120, t3128;
  double t3130, t3133, t3137, t3138, t3140, t3141, t3153, t3157;
  double t3160, t3161, t3164, t3173, t3176, t3183, t3184, t3185;
  double t3188, t3189, t3195, t3199, t3202, t3205, t3219, t3225;
  double t3232, t3237, t3238, t3242, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t3246, t3247, t3251;
  double t3252, t3257, t3258, t3260, t3263, t3264, t3268, t3269;
  double t3274, t3275, t3281, t3283, t3287, t3291, t3301, t3305;
  double t3306, t3307, t3308, t3311, t3313, t3315, t3318, t3319;
  double t3321, t3322, t3331, t3335, t3338, t3339, t3342, t3354;
  double t3357, t3360, t3365, t3368, t3369, t3370, t3373, t3376;
  double t3386, t3390, t3393, t3397, t3410, t3415, t3416, t3420;
  double tv3sigma39;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = tanh(t40);
  t42 = params->mu * t41;
  t43 = log(t40 + sqrt(t40 * t40 + 0.1e1));
  t44 = 0.1e1 - params->zeta;
  t46 = t44 * t29 * t32;
  t47 = 0.1e1 + t40;
  t48 = log(t47);
  t51 = params->zeta * t29;
  t52 = t32 * t34;
  t58 = 0.1e1 + params->alpha * (t51 * t52 * t37 / 0.12e2 + t46 * t38 * t48 / 0.12e2);
  t59 = t43 * t58;
  t60 = params->beta * t41;
  t62 = t60 * t43 + 0.1e1;
  t63 = 0.1e1 / t62;
  t64 = t59 * t63;
  t66 = t42 * t64 + 0.1e1;
  t70 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t66);
  t71 = rho[1] <= p->dens_threshold;
  t72 = -t16;
  t74 = my_piecewise5(t14, t11, t10, t15, t72 * t7);
  t75 = 0.1e1 + t74;
  t76 = t75 <= p->zeta_threshold;
  t77 = POW_1_3(t75);
  t79 = my_piecewise3(t76, t22, t77 * t75);
  t80 = t79 * t26;
  t81 = sqrt(sigma[2]);
  t82 = POW_1_3(rho[1]);
  t84 = 0.1e1 / t82 / rho[1];
  t85 = t81 * t84;
  t87 = t33 * t85 / 0.12e2;
  t88 = tanh(t87);
  t89 = params->mu * t88;
  t90 = log(t87 + sqrt(t87 * t87 + 0.1e1));
  t91 = 0.1e1 + t87;
  t92 = log(t91);
  t95 = t32 * t81;
  t101 = 0.1e1 + params->alpha * (t46 * t85 * t92 / 0.12e2 + t51 * t95 * t84 / 0.12e2);
  t102 = t90 * t101;
  t103 = params->beta * t88;
  t105 = t103 * t90 + 0.1e1;
  t106 = 0.1e1 / t105;
  t107 = t102 * t106;
  t109 = t89 * t107 + 0.1e1;
  t113 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t109);
  tzk0 = t70 + t113;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t114 = t6 * t6;
  t115 = 0.1e1 / t114;
  t116 = t16 * t115;
  t118 = my_piecewise5(t10, 0, t14, 0, t7 - t116);
  t121 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t118);
  t122 = t121 * t26;
  t126 = t26 * t26;
  t127 = 0.1e1 / t126;
  t128 = t25 * t127;
  t131 = t5 * t128 * t66 / 0.8e1;
  t132 = params->mu * t29;
  t133 = t132 * t52;
  t134 = rho[0] * rho[0];
  t136 = 0.1e1 / t35 / t134;
  t137 = t41 * t41;
  t138 = 0.1e1 - t137;
  t140 = t136 * t138 * t64;
  t143 = t42 * t33;
  t144 = t34 * t136;
  t145 = t31 * t31;
  t146 = 0.1e1 / t145;
  t147 = t28 * t146;
  t148 = t35 * t35;
  t150 = 0.1e1 / t148 / t134;
  t154 = 0.6e1 * t147 * t150 * sigma[0] + 0.144e3;
  t155 = sqrt(t154);
  t156 = 0.1e1 / t155;
  t157 = t156 * t58;
  t158 = t157 * t63;
  t162 = t42 * t43;
  t166 = t44 * t28;
  t167 = t166 * t146;
  t168 = t134 * rho[0];
  t170 = 0.1e1 / t148 / t168;
  t172 = 0.1e1 / t47;
  t176 = t52 * t136;
  t179 = -t46 * t144 * t48 / 0.9e1 - t167 * sigma[0] * t170 * t172 / 0.18e2 - t51 * t176 / 0.9e1;
  t180 = params->alpha * t179;
  t181 = t180 * t63;
  t183 = t62 * t62;
  t184 = 0.1e1 / t183;
  t185 = t58 * t184;
  t186 = params->beta * t29;
  t187 = t186 * t32;
  t188 = t138 * t43;
  t192 = t60 * t29;
  t193 = t136 * t156;
  t197 = -t187 * t144 * t188 / 0.9e1 - 0.4e1 / 0.3e1 * t192 * t52 * t193;
  t198 = t185 * t197;
  t200 = -t133 * t140 / 0.9e1 - 0.4e1 / 0.3e1 * t143 * t144 * t158 + t162 * t181 - t162 * t198;
  t205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t66 - t131 - 0.3e1 / 0.8e1 * t5 * t27 * t200);
  t206 = t72 * t115;
  t208 = my_piecewise5(t14, 0, t10, 0, -t7 - t206);
  t211 = my_piecewise3(t76, 0, 0.4e1 / 0.3e1 * t77 * t208);
  t212 = t211 * t26;
  t216 = t79 * t127;
  t219 = t5 * t216 * t109 / 0.8e1;
  t221 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t109 - t219);
  tvrho0 = t70 + t113 + t6 * (t205 + t221);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t225 = my_piecewise5(t10, 0, t14, 0, -t7 - t116);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t225);
  t229 = t228 * t26;
  t234 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t66 - t131);
  t236 = my_piecewise5(t14, 0, t10, 0, t7 - t206);
  t239 = my_piecewise3(t76, 0, 0.4e1 / 0.3e1 * t77 * t236);
  t240 = t239 * t26;
  t244 = t132 * t95;
  t245 = rho[1] * rho[1];
  t247 = 0.1e1 / t82 / t245;
  t248 = t88 * t88;
  t249 = 0.1e1 - t248;
  t251 = t247 * t249 * t107;
  t254 = t89 * t33;
  t255 = t81 * t247;
  t256 = t82 * t82;
  t258 = 0.1e1 / t256 / t245;
  t262 = 0.6e1 * t147 * t258 * sigma[2] + 0.144e3;
  t263 = sqrt(t262);
  t264 = 0.1e1 / t263;
  t265 = t264 * t101;
  t266 = t265 * t106;
  t270 = t89 * t90;
  t274 = t245 * rho[1];
  t276 = 0.1e1 / t256 / t274;
  t278 = 0.1e1 / t91;
  t282 = t95 * t247;
  t285 = -t46 * t255 * t92 / 0.9e1 - t167 * sigma[2] * t276 * t278 / 0.18e2 - t51 * t282 / 0.9e1;
  t286 = params->alpha * t285;
  t287 = t286 * t106;
  t289 = t105 * t105;
  t290 = 0.1e1 / t289;
  t291 = t101 * t290;
  t292 = t249 * t90;
  t296 = t103 * t29;
  t297 = t247 * t264;
  t301 = -t187 * t255 * t292 / 0.9e1 - 0.4e1 / 0.3e1 * t296 * t95 * t297;
  t302 = t291 * t301;
  t304 = -t244 * t251 / 0.9e1 - 0.4e1 / 0.3e1 * t254 * t255 * t266 + t270 * t287 - t270 * t302;
  t309 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t109 - t219 - 0.3e1 / 0.8e1 * t5 * t80 * t304);
  tvrho1 = t70 + t113 + t6 * (t234 + t309);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t312 = 0.1e1 / t34;
  t313 = t32 * t312;
  t314 = t132 * t313;
  t316 = t37 * t138 * t64;
  t319 = t312 * t37;
  t330 = t313 * t37;
  t333 = t46 * t319 * t48 / 0.24e2 + t166 * t146 * t150 * t172 / 0.48e2 + t51 * t330 / 0.24e2;
  t334 = params->alpha * t333;
  t335 = t334 * t63;
  t340 = t37 * t156;
  t344 = t187 * t319 * t188 / 0.24e2 + t192 * t313 * t340 / 0.2e1;
  t345 = t185 * t344;
  t347 = t314 * t316 / 0.24e2 + t143 * t319 * t158 / 0.2e1 + t162 * t335 - t162 * t345;
  t351 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t347);
  tvsigma0 = t6 * t351;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t352 = 0.1e1 / t81;
  t353 = t32 * t352;
  t354 = t132 * t353;
  t356 = t84 * t249 * t107;
  t359 = t352 * t84;
  t370 = t353 * t84;
  t373 = t46 * t359 * t92 / 0.24e2 + t166 * t146 * t258 * t278 / 0.48e2 + t51 * t370 / 0.24e2;
  t374 = params->alpha * t373;
  t375 = t374 * t106;
  t380 = t84 * t264;
  t384 = t187 * t359 * t292 / 0.24e2 + t296 * t353 * t380 / 0.2e1;
  t385 = t291 * t384;
  t387 = t354 * t356 / 0.24e2 + t254 * t359 * t266 / 0.2e1 + t270 * t375 - t270 * t385;
  t391 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t387);
  tvsigma2 = t6 * t391;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t394 = t23 * t23;
  t395 = 0.1e1 / t394;
  t396 = t118 * t118;
  t399 = t114 * t6;
  t400 = 0.1e1 / t399;
  t401 = t16 * t400;
  t404 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t115 + 0.2e1 * t401);
  t408 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t395 * t396 + 0.4e1 / 0.3e1 * t23 * t404);
  t409 = t408 * t26;
  t413 = t121 * t127;
  t415 = t5 * t413 * t66;
  t421 = 0.1e1 / t126 / t6;
  t422 = t25 * t421;
  t425 = t5 * t422 * t66 / 0.12e2;
  t427 = t5 * t128 * t200;
  t430 = 0.1e1 / t35 / t168;
  t432 = t430 * t138 * t64;
  t435 = params->mu * t28;
  t436 = t146 * sigma[0];
  t437 = t134 * t134;
  t439 = 0.1e1 / t148 / t437;
  t441 = t435 * t436 * t439;
  t442 = t41 * t138;
  t443 = t442 * t64;
  t446 = t435 * t436;
  t447 = t439 * t138;
  t448 = t447 * t158;
  t451 = t132 * t176;
  t452 = t188 * t181;
  t455 = t188 * t198;
  t458 = t34 * t430;
  t462 = 0.1e1 / t30;
  t463 = t34 * sigma[0];
  t464 = t462 * t463;
  t465 = t42 * t464;
  t466 = t437 * t134;
  t467 = 0.1e1 / t466;
  t469 = 0.1e1 / t155 / t154;
  t470 = t467 * t469;
  t471 = t58 * t63;
  t472 = t470 * t471;
  t476 = t42 * t33 * t34;
  t477 = t193 * t181;
  t480 = t193 * t198;
  t486 = sigma[0] * t439;
  t490 = t44 * t462;
  t491 = t463 * t467;
  t492 = t47 * t47;
  t493 = 0.1e1 / t492;
  t497 = t52 * t430;
  t500 = 0.7e1 / 0.27e2 * t46 * t458 * t48 + 0.5e1 / 0.18e2 * t167 * t486 * t172 - t490 * t491 * t493 / 0.27e2 + 0.7e1 / 0.27e2 * t51 * t497;
  t501 = params->alpha * t500;
  t502 = t501 * t63;
  t504 = t184 * t197;
  t509 = 0.1e1 / t183 / t62;
  t510 = t58 * t509;
  t511 = t197 * t197;
  t512 = t510 * t511;
  t518 = params->beta * t28;
  t519 = t518 * t436;
  t521 = t439 * t41 * t188;
  t524 = t518 * t146;
  t525 = t138 * t156;
  t529 = t430 * t156;
  t533 = t60 * t462;
  t537 = 0.7e1 / 0.27e2 * t187 * t458 * t188 - 0.4e1 / 0.27e2 * t519 * t521 + 0.16e2 / 0.9e1 * t524 * t486 * t525 + 0.28e2 / 0.9e1 * t192 * t52 * t529 - 0.64e2 * t533 * t491 * t469;
  t538 = t185 * t537;
  t540 = 0.7e1 / 0.27e2 * t133 * t432 - 0.4e1 / 0.27e2 * t441 * t443 + 0.16e2 / 0.9e1 * t446 * t448 - 0.2e1 / 0.9e1 * t451 * t452 + 0.2e1 / 0.9e1 * t451 * t455 + 0.28e2 / 0.9e1 * t143 * t458 * t158 - 0.64e2 * t465 * t472 - 0.8e1 / 0.3e1 * t476 * t477 + 0.8e1 / 0.3e1 * t476 * t480 + t162 * t502 - 0.2e1 * t162 * t180 * t504 + 0.2e1 * t162 * t512 - t162 * t538;
  t545 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t409 * t66 - t415 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t122 * t200 + t425 - t427 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t540);
  t546 = t77 * t77;
  t547 = 0.1e1 / t546;
  t548 = t208 * t208;
  t551 = t72 * t400;
  t554 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t115 + 0.2e1 * t551);
  t558 = my_piecewise3(t76, 0, 0.4e1 / 0.9e1 * t547 * t548 + 0.4e1 / 0.3e1 * t77 * t554);
  t559 = t558 * t26;
  t563 = t211 * t127;
  t565 = t5 * t563 * t109;
  t567 = t79 * t421;
  t570 = t5 * t567 * t109 / 0.12e2;
  t572 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t559 * t109 - t565 / 0.4e1 + t570);
  tv2rho20 = 0.2e1 * t205 + 0.2e1 * t221 + t6 * (t545 + t572);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t575 = t395 * t225;
  t579 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t401);
  t583 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t575 * t118 + 0.4e1 / 0.3e1 * t23 * t579);
  t584 = t583 * t26;
  t588 = t228 * t127;
  t590 = t5 * t588 * t66;
  t598 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t584 * t66 - t590 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t200 - t415 / 0.8e1 + t425 - t427 / 0.8e1);
  t599 = t547 * t236;
  t603 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t551);
  t607 = my_piecewise3(t76, 0, 0.4e1 / 0.9e1 * t599 * t208 + 0.4e1 / 0.3e1 * t77 * t603);
  t608 = t607 * t26;
  t612 = t239 * t127;
  t614 = t5 * t612 * t109;
  t621 = t5 * t216 * t304;
  t624 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t608 * t109 - t614 / 0.8e1 - t565 / 0.8e1 + t570 - 0.3e1 / 0.8e1 * t5 * t212 * t304 - t621 / 0.8e1);
  tv2rho21 = t205 + t221 + t234 + t309 + t6 * (t598 + t624);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t629 = t225 * t225;
  t634 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t115 + 0.2e1 * t401);
  t638 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t395 * t629 + 0.4e1 / 0.3e1 * t23 * t634);
  t639 = t638 * t26;
  t645 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t639 * t66 - t590 / 0.4e1 + t425);
  t646 = t236 * t236;
  t651 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t115 + 0.2e1 * t551);
  t655 = my_piecewise3(t76, 0, 0.4e1 / 0.9e1 * t547 * t646 + 0.4e1 / 0.3e1 * t77 * t651);
  t656 = t655 * t26;
  t666 = 0.1e1 / t82 / t274;
  t668 = t666 * t249 * t107;
  t671 = t146 * sigma[2];
  t672 = t245 * t245;
  t674 = 0.1e1 / t256 / t672;
  t676 = t435 * t671 * t674;
  t677 = t88 * t249;
  t678 = t677 * t107;
  t681 = t435 * t671;
  t682 = t674 * t249;
  t683 = t682 * t266;
  t686 = t132 * t282;
  t687 = t292 * t287;
  t690 = t292 * t302;
  t693 = t81 * t666;
  t697 = t81 * sigma[2];
  t698 = t462 * t697;
  t699 = t89 * t698;
  t700 = t672 * t245;
  t701 = 0.1e1 / t700;
  t703 = 0.1e1 / t263 / t262;
  t704 = t701 * t703;
  t705 = t101 * t106;
  t706 = t704 * t705;
  t710 = t89 * t33 * t81;
  t711 = t297 * t287;
  t714 = t297 * t302;
  t720 = sigma[2] * t674;
  t724 = t697 * t701;
  t725 = t91 * t91;
  t726 = 0.1e1 / t725;
  t730 = t95 * t666;
  t733 = 0.7e1 / 0.27e2 * t46 * t693 * t92 + 0.5e1 / 0.18e2 * t167 * t720 * t278 - t490 * t724 * t726 / 0.27e2 + 0.7e1 / 0.27e2 * t51 * t730;
  t734 = params->alpha * t733;
  t735 = t734 * t106;
  t737 = t290 * t301;
  t742 = 0.1e1 / t289 / t105;
  t743 = t101 * t742;
  t744 = t301 * t301;
  t745 = t743 * t744;
  t751 = t518 * t671;
  t753 = t674 * t88 * t292;
  t756 = t249 * t264;
  t760 = t666 * t264;
  t764 = t103 * t462;
  t768 = 0.7e1 / 0.27e2 * t187 * t693 * t292 - 0.4e1 / 0.27e2 * t751 * t753 + 0.16e2 / 0.9e1 * t524 * t720 * t756 + 0.28e2 / 0.9e1 * t296 * t95 * t760 - 0.64e2 * t764 * t724 * t703;
  t769 = t291 * t768;
  t771 = 0.7e1 / 0.27e2 * t244 * t668 - 0.4e1 / 0.27e2 * t676 * t678 + 0.16e2 / 0.9e1 * t681 * t683 - 0.2e1 / 0.9e1 * t686 * t687 + 0.2e1 / 0.9e1 * t686 * t690 + 0.28e2 / 0.9e1 * t254 * t693 * t266 - 0.64e2 * t699 * t706 - 0.8e1 / 0.3e1 * t710 * t711 + 0.8e1 / 0.3e1 * t710 * t714 + t270 * t735 - 0.2e1 * t270 * t286 * t737 + 0.2e1 * t270 * t745 - t270 * t769;
  t776 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t656 * t109 - t614 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t304 + t570 - t621 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t80 * t771);
  tv2rho22 = 0.2e1 * t234 + 0.2e1 * t309 + t6 * (t645 + t776);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t784 = t5 * t128 * t347 / 0.8e1;
  t787 = t146 * t170;
  t788 = t435 * t787;
  t791 = t525 * t471;
  t794 = t132 * t330;
  t799 = t312 * t136;
  t803 = t462 * t34;
  t804 = t42 * t803;
  t805 = t437 * rho[0];
  t806 = 0.1e1 / t805;
  t807 = t806 * t469;
  t808 = t807 * t471;
  t812 = t42 * t33 * t312;
  t813 = t340 * t181;
  t816 = t340 * t198;
  t819 = t188 * t335;
  t822 = t193 * t335;
  t835 = t313 * t136;
  t838 = -t46 * t799 * t48 / 0.18e2 - t166 * t787 * t172 / 0.12e2 + t490 * t806 * t493 * t34 / 0.72e2 - t51 * t835 / 0.18e2;
  t839 = params->alpha * t838;
  t840 = t839 * t63;
  t844 = t188 * t345;
  t847 = t193 * t345;
  t850 = t184 * t344;
  t853 = t344 * t197;
  t861 = t170 * t41 * t188;
  t864 = t170 * t138;
  t875 = -t187 * t799 * t188 / 0.18e2 + t524 * t861 / 0.18e2 - 0.2e1 / 0.3e1 * t524 * t864 * t156 - 0.2e1 / 0.3e1 * t192 * t313 * t193 + 0.24e2 * t533 * t34 * t806 * t469;
  t876 = t185 * t875;
  t878 = -t314 * t140 / 0.18e2 + t788 * t443 / 0.18e2 - 0.2e1 / 0.3e1 * t788 * t791 + t794 * t452 / 0.24e2 - t794 * t455 / 0.24e2 - 0.2e1 / 0.3e1 * t143 * t799 * t158 + 0.24e2 * t804 * t808 + t812 * t813 / 0.2e1 - t812 * t816 / 0.2e1 - t451 * t819 / 0.9e1 - 0.4e1 / 0.3e1 * t476 * t822 + t162 * t840 - t162 * t334 * t504 + t451 * t844 / 0.9e1 + 0.4e1 / 0.3e1 * t476 * t847 - t162 * t180 * t850 + 0.2e1 * t162 * t510 * t853 - t162 * t876;
  t883 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t347 - t784 - 0.3e1 / 0.8e1 * t5 * t27 * t878);
  tv2rhosigma0 = t6 * t883 + t351;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t890 = t5 * t216 * t387 / 0.8e1;
  t892 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t387 - t890);
  tv2rhosigma2 = t6 * t892 + t391;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t898 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t347 - t784);
  tv2rhosigma3 = t6 * t898 + t351;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t905 = t146 * t276;
  t906 = t435 * t905;
  t909 = t756 * t705;
  t912 = t132 * t370;
  t917 = t352 * t247;
  t921 = t462 * t81;
  t922 = t89 * t921;
  t923 = t672 * rho[1];
  t924 = 0.1e1 / t923;
  t925 = t924 * t703;
  t926 = t925 * t705;
  t930 = t89 * t33 * t352;
  t931 = t380 * t287;
  t934 = t380 * t302;
  t937 = t292 * t375;
  t940 = t297 * t375;
  t953 = t353 * t247;
  t956 = -t46 * t917 * t92 / 0.18e2 - t166 * t905 * t278 / 0.12e2 + t490 * t924 * t726 * t81 / 0.72e2 - t51 * t953 / 0.18e2;
  t957 = params->alpha * t956;
  t958 = t957 * t106;
  t962 = t292 * t385;
  t965 = t297 * t385;
  t968 = t290 * t384;
  t971 = t384 * t301;
  t979 = t276 * t88 * t292;
  t982 = t276 * t249;
  t993 = -t187 * t917 * t292 / 0.18e2 + t524 * t979 / 0.18e2 - 0.2e1 / 0.3e1 * t524 * t982 * t264 - 0.2e1 / 0.3e1 * t296 * t353 * t297 + 0.24e2 * t764 * t81 * t924 * t703;
  t994 = t291 * t993;
  t996 = -t354 * t251 / 0.18e2 + t906 * t678 / 0.18e2 - 0.2e1 / 0.3e1 * t906 * t909 + t912 * t687 / 0.24e2 - t912 * t690 / 0.24e2 - 0.2e1 / 0.3e1 * t254 * t917 * t266 + 0.24e2 * t922 * t926 + t930 * t931 / 0.2e1 - t930 * t934 / 0.2e1 - t686 * t937 / 0.9e1 - 0.4e1 / 0.3e1 * t710 * t940 + t270 * t958 - t270 * t374 * t737 + t686 * t962 / 0.9e1 + 0.4e1 / 0.3e1 * t710 * t965 - t270 * t286 * t968 + 0.2e1 * t270 * t743 * t971 - t270 * t994;
  t1001 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t387 - t890 - 0.3e1 / 0.8e1 * t5 * t80 * t996);
  tv2rhosigma5 = t6 * t1001 + t391;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1003 = 0.1e1 / t463;
  t1004 = t32 * t1003;
  t1005 = t132 * t1004;
  t1008 = 0.1e1 / sigma[0];
  t1009 = t146 * t1008;
  t1011 = t435 * t1009 * t150;
  t1014 = t435 * t1009;
  t1016 = t150 * t138 * t158;
  t1023 = t1003 * t37;
  t1027 = t462 * t312;
  t1028 = t42 * t1027;
  t1029 = 0.1e1 / t437;
  t1030 = t1029 * t469;
  t1031 = t1030 * t471;
  t1034 = t340 * t335;
  t1036 = t340 * t345;
  t1041 = t1008 * t150;
  t1049 = t1004 * t37;
  t1052 = -t46 * t1023 * t48 / 0.48e2 + t167 * t1041 * t172 / 0.96e2 - t490 * t1029 * t493 * t312 / 0.192e3 - t51 * t1049 / 0.48e2;
  t1053 = params->alpha * t1052;
  t1054 = t1053 * t63;
  t1059 = t344 * t344;
  t1060 = t510 * t1059;
  t1066 = t518 * t1009;
  t1068 = t150 * t41 * t188;
  t1081 = -t187 * t1023 * t188 / 0.48e2 - t1066 * t1068 / 0.48e2 + t524 * t1041 * t525 / 0.4e1 - t192 * t1004 * t340 / 0.4e1 - 0.9e1 * t533 * t312 * t1029 * t469;
  t1082 = t185 * t1081;
  t1084 = -t1005 * t316 / 0.48e2 - t1011 * t443 / 0.48e2 + t1014 * t1016 / 0.4e1 + t794 * t819 / 0.12e2 - t794 * t844 / 0.12e2 - t143 * t1023 * t158 / 0.4e1 - 0.9e1 * t1028 * t1031 + t812 * t1034 - t812 * t1036 + t162 * t1054 - 0.2e1 * t162 * t334 * t850 + 0.2e1 * t162 * t1060 - t162 * t1082;
  t1088 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1084);
  tv2sigma20 = t6 * t1088;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1089 = 0.1e1 / t697;
  t1090 = t32 * t1089;
  t1091 = t132 * t1090;
  t1094 = 0.1e1 / sigma[2];
  t1095 = t146 * t1094;
  t1097 = t435 * t1095 * t258;
  t1100 = t435 * t1095;
  t1102 = t258 * t249 * t266;
  t1109 = t1089 * t84;
  t1113 = t462 * t352;
  t1114 = t89 * t1113;
  t1115 = 0.1e1 / t672;
  t1116 = t1115 * t703;
  t1117 = t1116 * t705;
  t1120 = t380 * t375;
  t1122 = t380 * t385;
  t1127 = t1094 * t258;
  t1135 = t1090 * t84;
  t1138 = -t46 * t1109 * t92 / 0.48e2 + t167 * t1127 * t278 / 0.96e2 - t490 * t1115 * t726 * t352 / 0.192e3 - t51 * t1135 / 0.48e2;
  t1139 = params->alpha * t1138;
  t1140 = t1139 * t106;
  t1145 = t384 * t384;
  t1146 = t743 * t1145;
  t1152 = t518 * t1095;
  t1154 = t258 * t88 * t292;
  t1167 = -t187 * t1109 * t292 / 0.48e2 - t1152 * t1154 / 0.48e2 + t524 * t1127 * t756 / 0.4e1 - t296 * t1090 * t380 / 0.4e1 - 0.9e1 * t764 * t352 * t1115 * t703;
  t1168 = t291 * t1167;
  t1170 = -t1091 * t356 / 0.48e2 - t1097 * t678 / 0.48e2 + t1100 * t1102 / 0.4e1 + t912 * t937 / 0.12e2 - t912 * t962 / 0.12e2 - t254 * t1109 * t266 / 0.4e1 - 0.9e1 * t1114 * t1117 + t930 * t1120 - t930 * t1122 + t270 * t1140 - 0.2e1 * t270 * t374 * t968 + 0.2e1 * t270 * t1146 - t270 * t1168;
  t1174 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t1170);
  tv2sigma25 = t6 * t1174;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1178 = 0.1e1 / t394 / t19;
  t1179 = t396 * t118;
  t1182 = t395 * t118;
  t1185 = t114 * t114;
  t1186 = 0.1e1 / t1185;
  t1187 = t16 * t1186;
  t1190 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t400 - 0.6e1 * t1187);
  t1194 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1178 * t1179 + 0.4e1 / 0.3e1 * t1182 * t404 + 0.4e1 / 0.3e1 * t23 * t1190);
  t1195 = t1194 * t26;
  t1199 = t408 * t127;
  t1201 = t5 * t1199 * t66;
  t1206 = t121 * t421;
  t1208 = t5 * t1206 * t66;
  t1211 = t5 * t413 * t200;
  t1217 = 0.1e1 / t126 / t114;
  t1218 = t25 * t1217;
  t1221 = 0.5e1 / 0.36e2 * t5 * t1218 * t66;
  t1223 = t5 * t422 * t200;
  t1226 = t5 * t128 * t540;
  t1228 = t183 * t183;
  t1229 = 0.1e1 / t1228;
  t1230 = t58 * t1229;
  t1231 = t511 * t197;
  t1232 = t1230 * t1231;
  t1236 = 0.1e1 / t35 / t437;
  t1237 = t34 * t1236;
  t1242 = 0.1e1 / t148 / t805;
  t1243 = sigma[0] * t1242;
  t1247 = t437 * t168;
  t1248 = 0.1e1 / t1247;
  t1249 = t463 * t1248;
  t1253 = sigma[0] * sigma[0];
  t1254 = t490 * t1253;
  t1255 = t437 * t437;
  t1257 = 0.1e1 / t35 / t1255;
  t1259 = 0.1e1 / t492 / t47;
  t1264 = t52 * t1236;
  t1268 = params->alpha * (-0.7e2 / 0.81e2 * t46 * t1237 * t48 - 0.119e3 / 0.81e2 * t167 * t1243 * t172 + 0.11e2 / 0.27e2 * t490 * t1249 * t493 - 0.2e1 / 0.243e3 * t1254 * t1257 * t1259 * t33 - 0.7e2 / 0.81e2 * t51 * t1264);
  t1269 = t1268 * t63;
  t1275 = t1242 * t41 * t188;
  t1281 = params->beta * t462;
  t1282 = t1281 * t463;
  t1283 = t138 * t138;
  t1288 = t1248 * t137;
  t1292 = t1248 * t41;
  t1297 = 0.1e1 / t31 / t30;
  t1298 = t186 * t1297;
  t1300 = t138 * t469;
  t1304 = t1236 * t156;
  t1311 = t32 * t1253;
  t1312 = t186 * t1311;
  t1313 = t1257 * t138;
  t1314 = t462 * t469;
  t1315 = t1313 * t1314;
  t1318 = t34 * t1253;
  t1319 = t462 * t1318;
  t1320 = t60 * t1319;
  t1321 = t1255 * rho[0];
  t1323 = 0.1e1 / t148 / t1321;
  t1324 = t154 * t154;
  t1326 = 0.1e1 / t155 / t1324;
  t1328 = t1323 * t1326 * t147;
  t1331 = -0.7e2 / 0.81e2 * t187 * t1237 * t188 + 0.28e2 / 0.27e2 * t519 * t1275 - 0.112e3 / 0.9e1 * t524 * t1243 * t525 + 0.8e1 / 0.81e2 * t1282 * t1248 * t1283 * t43 - 0.16e2 / 0.81e2 * t1282 * t1288 * t188 + 0.32e2 / 0.9e1 * t1282 * t1292 * t525 + 0.128e3 / 0.9e1 * t1298 * t1253 * t1257 * t1300 - 0.28e3 / 0.27e2 * t192 * t52 * t1304 + 0.16e4 / 0.3e1 * t533 * t1249 * t469 + 0.64e2 / 0.9e1 * t1312 * t1315 - 0.1536e4 * t1320 * t1328;
  t1332 = t185 * t1331;
  t1334 = t197 * t537;
  t1341 = t184 * t537;
  t1345 = t509 * t511;
  t1349 = params->mu * t462;
  t1350 = t1349 * t1249;
  t1351 = t1283 * t43;
  t1352 = t1351 * t471;
  t1355 = t1248 * t469;
  t1356 = t1355 * t471;
  t1360 = t42 * t1319 * t1323;
  t1361 = t1326 * t58;
  t1363 = t63 * t28 * t146;
  t1364 = t1361 * t1363;
  t1367 = t193 * t502;
  t1370 = t193 * t538;
  t1373 = t193 * t512;
  t1376 = t188 * t512;
  t1379 = t132 * t497;
  t1383 = t435 * t436 * t1242;
  t1388 = t525 * t198;
  t1391 = -0.6e1 * t162 * t1232 + t162 * t1269 - t162 * t1332 + 0.6e1 * t162 * t510 * t1334 - 0.3e1 * t162 * t501 * t504 - 0.3e1 * t162 * t180 * t1341 + 0.6e1 * t162 * t180 * t1345 + 0.8e1 / 0.81e2 * t1350 * t1352 + 0.16e4 / 0.3e1 * t465 * t1356 - 0.1536e4 * t1360 * t1364 - 0.4e1 * t476 * t1367 + 0.4e1 * t476 * t1370 - 0.8e1 * t476 * t1373 - 0.2e1 / 0.3e1 * t451 * t1376 - 0.7e1 / 0.9e1 * t1379 * t455 + 0.28e2 / 0.27e2 * t1383 * t443 + 0.7e1 / 0.9e1 * t1379 * t452 - 0.16e2 / 0.3e1 * t441 * t1388;
  t1392 = t525 * t181;
  t1395 = t188 * t502;
  t1398 = t188 * t538;
  t1401 = t529 * t198;
  t1404 = t529 * t181;
  t1408 = t132 * t1311 * t1257;
  t1409 = t138 * t462;
  t1410 = t469 * t58;
  t1411 = t1410 * t63;
  t1412 = t1409 * t1411;
  t1415 = t193 * params->alpha;
  t1416 = t179 * t184;
  t1417 = t1416 * t197;
  t1418 = t1415 * t1417;
  t1421 = t442 * t43;
  t1422 = t1421 * t181;
  t1425 = t188 * params->alpha;
  t1426 = t1425 * t1417;
  t1429 = t1421 * t198;
  t1433 = t1236 * t138 * t64;
  t1439 = t1242 * t138;
  t1443 = t137 * t138;
  t1444 = t1443 * t64;
  t1447 = t442 * t158;
  t1450 = t1297 * t1253;
  t1451 = t132 * t1450;
  t1455 = t470 * t198;
  t1458 = t470 * t181;
  t1461 = 0.16e2 / 0.3e1 * t441 * t1392 - t451 * t1395 / 0.3e1 + t451 * t1398 / 0.3e1 - 0.28e2 / 0.3e1 * t476 * t1401 + 0.28e2 / 0.3e1 * t476 * t1404 + 0.64e2 / 0.9e1 * t1408 * t1412 + 0.8e1 * t476 * t1418 - 0.4e1 / 0.9e1 * t441 * t1422 + 0.2e1 / 0.3e1 * t451 * t1426 + 0.4e1 / 0.9e1 * t441 * t1429 - 0.7e2 / 0.81e2 * t133 * t1433 - 0.28e3 / 0.27e2 * t143 * t1237 * t158 - 0.112e3 / 0.9e1 * t446 * t1439 * t158 - 0.16e2 / 0.81e2 * t1350 * t1444 + 0.32e2 / 0.9e1 * t1350 * t1447 + 0.128e3 / 0.9e1 * t1451 * t1313 * t1411 + 0.192e3 * t465 * t1455 - 0.192e3 * t465 * t1458;
  t1462 = t1391 + t1461;
  t1467 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1195 * t66 - 0.3e1 / 0.8e1 * t1201 - 0.9e1 / 0.8e1 * t5 * t409 * t200 + t1208 / 0.4e1 - 0.3e1 / 0.4e1 * t1211 - 0.9e1 / 0.8e1 * t5 * t122 * t540 - t1221 + t1223 / 0.4e1 - 0.3e1 / 0.8e1 * t1226 - 0.3e1 / 0.8e1 * t5 * t27 * t1462);
  t1469 = 0.1e1 / t546 / t75;
  t1470 = t548 * t208;
  t1473 = t547 * t208;
  t1476 = t72 * t1186;
  t1479 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t400 - 0.6e1 * t1476);
  t1483 = my_piecewise3(t76, 0, -0.8e1 / 0.27e2 * t1469 * t1470 + 0.4e1 / 0.3e1 * t1473 * t554 + 0.4e1 / 0.3e1 * t77 * t1479);
  t1484 = t1483 * t26;
  t1488 = t558 * t127;
  t1490 = t5 * t1488 * t109;
  t1492 = t211 * t421;
  t1494 = t5 * t1492 * t109;
  t1496 = t79 * t1217;
  t1499 = 0.5e1 / 0.36e2 * t5 * t1496 * t109;
  t1501 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t1484 * t109 - 0.3e1 / 0.8e1 * t1490 + t1494 / 0.4e1 - t1499);
  tv3rho30 = 0.3e1 * t545 + 0.3e1 * t572 + t6 * (t1467 + t1501);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1504 = 0.2e1 * t598;
  t1505 = 0.2e1 * t624;
  t1506 = t1178 * t225;
  t1509 = t395 * t579;
  t1514 = 0.2e1 * t400;
  t1515 = 0.6e1 * t1187;
  t1517 = my_piecewise5(t10, 0, t14, 0, t1514 - t1515);
  t1521 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1506 * t396 + 0.8e1 / 0.9e1 * t1509 * t118 + 0.4e1 / 0.9e1 * t575 * t404 + 0.4e1 / 0.3e1 * t23 * t1517);
  t1522 = t1521 * t26;
  t1526 = t583 * t127;
  t1529 = t5 * t1526 * t66 / 0.4e1;
  t1533 = t228 * t421;
  t1535 = t5 * t1533 * t66;
  t1539 = t5 * t588 * t200 / 0.4e1;
  t1548 = -0.3e1 / 0.8e1 * t5 * t1522 * t66 - t1529 - 0.3e1 / 0.4e1 * t5 * t584 * t200 + t1535 / 0.12e2 - t1539 - 0.3e1 / 0.8e1 * t5 * t229 * t540 - t1201 / 0.8e1 + t1208 / 0.6e1 - t1211 / 0.4e1 - t1221 + t1223 / 0.6e1 - t1226 / 0.8e1;
  t1549 = my_piecewise3(t1, 0, t1548);
  t1550 = t1469 * t236;
  t1553 = t547 * t603;
  t1558 = 0.6e1 * t1476;
  t1560 = my_piecewise5(t14, 0, t10, 0, -t1514 - t1558);
  t1564 = my_piecewise3(t76, 0, -0.8e1 / 0.27e2 * t1550 * t548 + 0.8e1 / 0.9e1 * t1553 * t208 + 0.4e1 / 0.9e1 * t599 * t554 + 0.4e1 / 0.3e1 * t77 * t1560);
  t1565 = t1564 * t26;
  t1569 = t607 * t127;
  t1572 = t5 * t1569 * t109 / 0.4e1;
  t1573 = t239 * t421;
  t1575 = t5 * t1573 * t109;
  t1584 = t5 * t563 * t304 / 0.4e1;
  t1586 = t5 * t567 * t304;
  t1589 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t1565 * t109 - t1572 + t1575 / 0.12e2 - t1490 / 0.8e1 + t1494 / 0.6e1 - t1499 - 0.3e1 / 0.8e1 * t5 * t559 * t304 - t1584 + t1586 / 0.12e2);
  tv3rho31 = t545 + t572 + t1504 + t1505 + t6 * (t1549 + t1589);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1592 = t1178 * t629;
  t1597 = t395 * t634;
  t1601 = my_piecewise5(t10, 0, t14, 0, -t1514 - t1515);
  t1605 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1592 * t118 + 0.8e1 / 0.9e1 * t575 * t579 + 0.4e1 / 0.9e1 * t1597 * t118 + 0.4e1 / 0.3e1 * t23 * t1601);
  t1606 = t1605 * t26;
  t1610 = t638 * t127;
  t1612 = t5 * t1610 * t66;
  t1621 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1606 * t66 - t1612 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t639 * t200 - t1529 + t1535 / 0.6e1 - t1539 + t1208 / 0.12e2 - t1221 + t1223 / 0.12e2);
  t1622 = t1469 * t646;
  t1627 = t547 * t651;
  t1631 = my_piecewise5(t14, 0, t10, 0, t1514 - t1558);
  t1635 = my_piecewise3(t76, 0, -0.8e1 / 0.27e2 * t1622 * t208 + 0.8e1 / 0.9e1 * t599 * t603 + 0.4e1 / 0.9e1 * t1627 * t208 + 0.4e1 / 0.3e1 * t77 * t1631);
  t1636 = t1635 * t26;
  t1640 = t655 * t127;
  t1642 = t5 * t1640 * t109;
  t1649 = t5 * t612 * t304;
  t1657 = t5 * t216 * t771;
  t1659 = -0.3e1 / 0.8e1 * t5 * t1636 * t109 - t1642 / 0.8e1 - t1572 + t1575 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t608 * t304 - t1649 / 0.4e1 + t1494 / 0.12e2 - t1499 - t1584 + t1586 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t212 * t771 - t1657 / 0.8e1;
  t1660 = my_piecewise3(t71, 0, t1659);
  tv3rho32 = t1504 + t1505 + t645 + t776 + t6 * (t1621 + t1660);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1665 = t629 * t225;
  t1672 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t400 - 0.6e1 * t1187);
  t1676 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1178 * t1665 + 0.4e1 / 0.3e1 * t575 * t634 + 0.4e1 / 0.3e1 * t23 * t1672);
  t1677 = t1676 * t26;
  t1684 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1677 * t66 - 0.3e1 / 0.8e1 * t1612 + t1535 / 0.4e1 - t1221);
  t1685 = t646 * t236;
  t1692 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t400 - 0.6e1 * t1476);
  t1696 = my_piecewise3(t76, 0, -0.8e1 / 0.27e2 * t1469 * t1685 + 0.4e1 / 0.3e1 * t599 * t651 + 0.4e1 / 0.3e1 * t77 * t1692);
  t1697 = t1696 * t26;
  t1712 = t289 * t289;
  t1713 = 0.1e1 / t1712;
  t1714 = t101 * t1713;
  t1715 = t744 * t301;
  t1716 = t1714 * t1715;
  t1720 = 0.1e1 / t82 / t672;
  t1721 = t81 * t1720;
  t1726 = 0.1e1 / t256 / t923;
  t1728 = t1726 * t88 * t292;
  t1731 = sigma[2] * t1726;
  t1735 = t1281 * t697;
  t1736 = t672 * t274;
  t1737 = 0.1e1 / t1736;
  t1738 = t249 * t249;
  t1743 = t1737 * t248;
  t1747 = t1737 * t88;
  t1751 = sigma[2] * sigma[2];
  t1752 = t672 * t672;
  t1754 = 0.1e1 / t82 / t1752;
  t1756 = t249 * t703;
  t1760 = t1720 * t264;
  t1764 = t697 * t1737;
  t1768 = t32 * t1751;
  t1769 = t186 * t1768;
  t1770 = t1754 * t249;
  t1771 = t462 * t703;
  t1772 = t1770 * t1771;
  t1775 = t81 * t1751;
  t1776 = t462 * t1775;
  t1777 = t103 * t1776;
  t1778 = t1752 * rho[1];
  t1780 = 0.1e1 / t256 / t1778;
  t1781 = t262 * t262;
  t1783 = 0.1e1 / t263 / t1781;
  t1785 = t1780 * t1783 * t147;
  t1788 = -0.7e2 / 0.81e2 * t187 * t1721 * t292 + 0.28e2 / 0.27e2 * t751 * t1728 - 0.112e3 / 0.9e1 * t524 * t1731 * t756 + 0.8e1 / 0.81e2 * t1735 * t1737 * t1738 * t90 - 0.16e2 / 0.81e2 * t1735 * t1743 * t292 + 0.32e2 / 0.9e1 * t1735 * t1747 * t756 + 0.128e3 / 0.9e1 * t1298 * t1751 * t1754 * t1756 - 0.28e3 / 0.27e2 * t296 * t95 * t1760 + 0.16e4 / 0.3e1 * t764 * t1764 * t703 + 0.64e2 / 0.9e1 * t1769 * t1772 - 0.1536e4 * t1777 * t1785;
  t1789 = t291 * t1788;
  t1800 = t490 * t1751;
  t1802 = 0.1e1 / t725 / t91;
  t1807 = t95 * t1720;
  t1811 = params->alpha * (-0.7e2 / 0.81e2 * t46 * t1721 * t92 - 0.119e3 / 0.81e2 * t167 * t1731 * t278 + 0.11e2 / 0.27e2 * t490 * t1764 * t726 - 0.2e1 / 0.243e3 * t1800 * t1754 * t1802 * t33 - 0.7e2 / 0.81e2 * t51 * t1807);
  t1812 = t1811 * t106;
  t1817 = t290 * t768;
  t1821 = t301 * t768;
  t1825 = t742 * t744;
  t1829 = t1349 * t1764;
  t1830 = t1738 * t90;
  t1831 = t1830 * t705;
  t1834 = t1737 * t703;
  t1835 = t1834 * t705;
  t1839 = t435 * t671 * t1726;
  t1842 = t132 * t730;
  t1845 = t756 * t302;
  t1848 = t756 * t287;
  t1851 = t292 * t735;
  t1854 = t292 * t769;
  t1857 = t760 * t302;
  t1860 = t760 * t287;
  t1864 = t132 * t1768 * t1754;
  t1865 = t249 * t462;
  t1866 = t703 * t101;
  t1867 = t1866 * t106;
  t1868 = t1865 * t1867;
  t1871 = -0.6e1 * t270 * t1716 - t270 * t1789 + t270 * t1812 - 0.3e1 * t270 * t734 * t737 - 0.3e1 * t270 * t286 * t1817 + 0.6e1 * t270 * t743 * t1821 + 0.6e1 * t270 * t286 * t1825 + 0.8e1 / 0.81e2 * t1829 * t1831 + 0.16e4 / 0.3e1 * t699 * t1835 + 0.28e2 / 0.27e2 * t1839 * t678 + 0.7e1 / 0.9e1 * t1842 * t687 - 0.16e2 / 0.3e1 * t676 * t1845 + 0.16e2 / 0.3e1 * t676 * t1848 - t686 * t1851 / 0.3e1 + t686 * t1854 / 0.3e1 - 0.28e2 / 0.3e1 * t710 * t1857 + 0.28e2 / 0.3e1 * t710 * t1860 + 0.64e2 / 0.9e1 * t1864 * t1868;
  t1873 = t89 * t1776 * t1780;
  t1874 = t1783 * t101;
  t1876 = t106 * t28 * t146;
  t1877 = t1874 * t1876;
  t1880 = t297 * t735;
  t1883 = t297 * t769;
  t1886 = t297 * t745;
  t1889 = t292 * t745;
  t1894 = t292 * params->alpha;
  t1895 = t285 * t290;
  t1896 = t1895 * t301;
  t1897 = t1894 * t1896;
  t1900 = t677 * t90;
  t1901 = t1900 * t302;
  t1904 = t1900 * t287;
  t1907 = t297 * params->alpha;
  t1908 = t1907 * t1896;
  t1911 = t1297 * t1751;
  t1912 = t132 * t1911;
  t1916 = t704 * t302;
  t1919 = t704 * t287;
  t1923 = t1720 * t249 * t107;
  t1929 = t1726 * t249;
  t1933 = t248 * t249;
  t1934 = t1933 * t107;
  t1937 = t677 * t266;
  t1940 = -0.1536e4 * t1873 * t1877 - 0.4e1 * t710 * t1880 + 0.4e1 * t710 * t1883 - 0.8e1 * t710 * t1886 - 0.2e1 / 0.3e1 * t686 * t1889 - 0.7e1 / 0.9e1 * t1842 * t690 + 0.2e1 / 0.3e1 * t686 * t1897 + 0.4e1 / 0.9e1 * t676 * t1901 - 0.4e1 / 0.9e1 * t676 * t1904 + 0.8e1 * t710 * t1908 + 0.128e3 / 0.9e1 * t1912 * t1770 * t1867 + 0.192e3 * t699 * t1916 - 0.192e3 * t699 * t1919 - 0.7e2 / 0.81e2 * t244 * t1923 - 0.28e3 / 0.27e2 * t254 * t1721 * t266 - 0.112e3 / 0.9e1 * t681 * t1929 * t266 - 0.16e2 / 0.81e2 * t1829 * t1934 + 0.32e2 / 0.9e1 * t1829 * t1937;
  t1941 = t1871 + t1940;
  t1946 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t1697 * t109 - 0.3e1 / 0.8e1 * t1642 - 0.9e1 / 0.8e1 * t5 * t656 * t304 + t1575 / 0.4e1 - 0.3e1 / 0.4e1 * t1649 - 0.9e1 / 0.8e1 * t5 * t240 * t771 - t1499 + t1586 / 0.4e1 - 0.3e1 / 0.8e1 * t1657 - 0.3e1 / 0.8e1 * t5 * t80 * t1941);
  tv3rho33 = 0.3e1 * t645 + 0.3e1 * t776 + t6 * (t1684 + t1946);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1954 = t5 * t413 * t347;
  t1961 = t5 * t422 * t347 / 0.12e2;
  t1963 = t5 * t128 * t878;
  t1965 = t312 * t430;
  t1969 = t146 * t439;
  t1978 = 0.1e1 / t35 / t1247;
  t1979 = t490 * t1978;
  t1981 = t1259 * sigma[0] * t33;
  t1984 = t313 * t430;
  t1988 = params->alpha * (0.7e1 / 0.54e2 * t46 * t1965 * t48 + 0.37e2 / 0.108e3 * t166 * t1969 * t172 - t490 * t467 * t493 * t34 / 0.8e1 + t1979 * t1981 / 0.324e3 + 0.7e1 / 0.54e2 * t51 * t1984);
  t1989 = t1988 * t63;
  t1991 = t193 * t876;
  t1994 = t529 * t335;
  t1999 = t340 * t512;
  t2005 = t132 * t835;
  t2011 = t435 * t787 * t41;
  t2024 = t162 * t1989 + 0.8e1 / 0.3e1 * t476 * t1991 + 0.28e2 / 0.9e1 * t476 * t1994 - 0.7e1 / 0.27e2 * t1379 * t844 + t812 * t1999 + 0.7e1 / 0.27e2 * t1379 * t819 + t794 * t1376 / 0.12e2 + t2005 * t455 / 0.9e1 - t2005 * t452 / 0.9e1 - t2011 * t455 / 0.9e1 + t2011 * t452 / 0.9e1 + t794 * t1395 / 0.24e2 - t794 * t1398 / 0.24e2 + 0.4e1 / 0.3e1 * t812 * t480 - 0.4e1 / 0.3e1 * t812 * t477;
  t2025 = t32 * sigma[0];
  t2027 = t132 * t2025 * t1978;
  t2031 = 0.1e1 / t148 / t1255;
  t2033 = t42 * t464 * t2031;
  t2036 = t340 * t502;
  t2039 = t340 * t538;
  t2042 = t188 * t840;
  t2045 = t525 * t335;
  t2048 = t193 * t840;
  t2051 = t188 * t876;
  t2054 = t525 * t345;
  t2057 = t529 * t345;
  t2060 = t188 * t58;
  t2061 = t509 * t344;
  t2062 = t2061 * t197;
  t2063 = t2060 * t2062;
  t2066 = t340 * params->alpha;
  t2067 = t2066 * t1417;
  t2071 = t1421 * t345;
  t2074 = t1416 * t344;
  t2075 = t1425 * t2074;
  t2078 = -0.8e1 / 0.3e1 * t2027 * t1412 + 0.576e3 * t2033 * t1364 + t812 * t2036 / 0.2e1 - t812 * t2039 / 0.2e1 - 0.2e1 / 0.9e1 * t451 * t2042 + 0.16e2 / 0.9e1 * t441 * t2045 - 0.8e1 / 0.3e1 * t476 * t2048 + 0.2e1 / 0.9e1 * t451 * t2051 - 0.16e2 / 0.9e1 * t441 * t2054 - 0.28e2 / 0.9e1 * t476 * t2057 - 0.4e1 / 0.9e1 * t451 * t2063 - t812 * t2067 - t794 * t1426 / 0.12e2 + 0.4e1 / 0.27e2 * t441 * t2071 + 0.2e1 / 0.9e1 * t451 * t2075;
  t2080 = t193 * t58;
  t2081 = t2080 * t2062;
  t2084 = t1415 * t2074;
  t2087 = t333 * t184;
  t2088 = t2087 * t197;
  t2089 = t1425 * t2088;
  t2092 = t1421 * t335;
  t2095 = t1415 * t2088;
  t2103 = t435 * t1969;
  t2106 = t467 * t137;
  t2108 = t34 * t138;
  t2109 = t2108 * t64;
  t2112 = t467 * t41;
  t2114 = t2108 * t158;
  t2119 = t1297 * t1978;
  t2120 = t132 * t2119;
  t2122 = t1300 * t471 * sigma[0];
  t2127 = t807 * t198;
  t2130 = t807 * t181;
  t2133 = -0.16e2 / 0.3e1 * t476 * t2081 + 0.8e1 / 0.3e1 * t476 * t2084 + 0.2e1 / 0.9e1 * t451 * t2089 - 0.4e1 / 0.27e2 * t441 * t2092 + 0.8e1 / 0.3e1 * t476 * t2095 + 0.7e1 / 0.54e2 * t314 * t432 + 0.14e2 / 0.9e1 * t143 * t1965 * t158 - 0.5e1 / 0.18e2 * t2103 * t443 + 0.2e1 / 0.27e2 * t1349 * t2106 * t2109 - 0.4e1 / 0.3e1 * t1349 * t2112 * t2114 + 0.4e1 / 0.3e1 * t788 * t1388 - 0.16e2 / 0.3e1 * t2120 * t2122 - 0.4e1 / 0.3e1 * t788 * t1392 - 0.48e2 * t804 * t2127 + 0.48e2 * t804 * t2130;
  t2134 = t470 * t335;
  t2137 = t470 * t345;
  t2148 = t1281 * t467;
  t2150 = t34 * t1283 * t43;
  t2154 = t137 * t34 * t188;
  t2157 = t34 * t156;
  t2158 = t442 * t2157;
  t2161 = t1978 * t138;
  t2162 = t469 * sigma[0];
  t2169 = t34 * t467;
  t2173 = t186 * t2025;
  t2174 = t2161 * t1314;
  t2177 = t60 * t464;
  t2179 = t2031 * t1326 * t147;
  t2182 = 0.7e1 / 0.54e2 * t187 * t1965 * t188 - 0.5e1 / 0.18e2 * t524 * t521 + 0.1e2 / 0.3e1 * t524 * t447 * t156 - t2148 * t2150 / 0.27e2 + 0.2e1 / 0.27e2 * t2148 * t2154 - 0.4e1 / 0.3e1 * t2148 * t2158 - 0.16e2 / 0.3e1 * t1298 * t2161 * t2162 + 0.14e2 / 0.9e1 * t192 * t313 * t529 - 0.152e3 * t533 * t2169 * t469 - 0.8e1 / 0.3e1 * t2173 * t2174 + 0.576e3 * t2177 * t2179;
  t2183 = t185 * t2182;
  t2185 = t184 * t875;
  t2189 = t875 * t197;
  t2193 = t344 * t537;
  t2207 = t344 * t511;
  t2211 = t43 * params->alpha;
  t2212 = t42 * t2211;
  t2213 = t179 * t509;
  t2219 = t1349 * t2169;
  t2224 = -0.64e2 * t465 * t2134 + 0.64e2 * t465 * t2137 - t162 * t2183 - 0.2e1 * t162 * t180 * t2185 + 0.4e1 * t162 * t510 * t2189 + 0.2e1 * t162 * t510 * t2193 - 0.2e1 * t162 * t839 * t504 - t162 * t334 * t1341 - t162 * t501 * t850 + 0.2e1 * t162 * t334 * t1345 - 0.6e1 * t162 * t1230 * t2207 + 0.4e1 * t2212 * t2213 * t853 + 0.1e2 / 0.3e1 * t2103 * t791 - t2219 * t1352 / 0.27e2 - 0.152e3 * t804 * t472;
  t2226 = t2024 + t2078 + t2133 + t2224;
  t2231 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t409 * t347 - t1954 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t122 * t878 + t1961 - t1963 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t2226);
  tv3rho2sigma0 = t6 * t2231 + 0.2e1 * t883;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2238 = t5 * t563 * t387;
  t2242 = t5 * t567 * t387 / 0.12e2;
  t2244 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t559 * t387 - t2238 / 0.4e1 + t2242);
  tv3rho2sigma2 = t6 * t2244 + 0.2e1 * t892;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2250 = t5 * t588 * t347;
  t2258 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t584 * t347 - t2250 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t878 - t1954 / 0.8e1 + t1961 - t1963 / 0.8e1);
  tv3rho2sigma3 = t6 * t2258 + t883 + t898;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2264 = t5 * t612 * t387;
  t2271 = t5 * t216 * t996;
  t2274 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t608 * t387 - t2264 / 0.8e1 - t2238 / 0.8e1 + t2242 - 0.3e1 / 0.8e1 * t5 * t212 * t996 - t2271 / 0.8e1);
  tv3rho2sigma5 = t6 * t2274 + t1001 + t892;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2282 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t639 * t347 - t2250 / 0.4e1 + t1961);
  tv3rho2sigma6 = t6 * t2282 + 0.2e1 * t898;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2293 = t292 * t101;
  t2294 = t742 * t384;
  t2295 = t2294 * t301;
  t2296 = t2293 * t2295;
  t2299 = t1900 * t385;
  t2302 = t1895 * t384;
  t2303 = t1894 * t2302;
  t2306 = t297 * t101;
  t2307 = t2306 * t2295;
  t2310 = t1907 * t2302;
  t2313 = t373 * t290;
  t2314 = t2313 * t301;
  t2315 = t1894 * t2314;
  t2318 = t1900 * t375;
  t2321 = t1907 * t2314;
  t2324 = t380 * params->alpha;
  t2325 = t2324 * t1896;
  t2329 = t352 * t666;
  t2335 = t146 * t674;
  t2336 = t435 * t2335;
  t2339 = t701 * t248;
  t2341 = t81 * t249;
  t2342 = t2341 * t107;
  t2345 = t701 * t88;
  t2347 = t2341 * t266;
  t2350 = -0.4e1 / 0.9e1 * t686 * t2296 + 0.4e1 / 0.27e2 * t676 * t2299 + 0.2e1 / 0.9e1 * t686 * t2303 - 0.16e2 / 0.3e1 * t710 * t2307 + 0.8e1 / 0.3e1 * t710 * t2310 + 0.2e1 / 0.9e1 * t686 * t2315 - 0.4e1 / 0.27e2 * t676 * t2318 + 0.8e1 / 0.3e1 * t710 * t2321 - t930 * t2325 - t912 * t1897 / 0.12e2 + 0.14e2 / 0.9e1 * t254 * t2329 * t266 + 0.7e1 / 0.54e2 * t354 * t668 - 0.5e1 / 0.18e2 * t2336 * t678 + 0.2e1 / 0.27e2 * t1349 * t2339 * t2342 - 0.4e1 / 0.3e1 * t1349 * t2345 * t2347;
  t2354 = 0.1e1 / t82 / t1736;
  t2355 = t1297 * t2354;
  t2356 = t132 * t2355;
  t2358 = t1756 * t705 * sigma[2];
  t2363 = t925 * t302;
  t2366 = t925 * t287;
  t2369 = t704 * t375;
  t2372 = t704 * t385;
  t2385 = t490 * t2354;
  t2387 = t1802 * sigma[2] * t33;
  t2390 = t353 * t666;
  t2394 = params->alpha * (0.7e1 / 0.54e2 * t46 * t2329 * t92 + 0.37e2 / 0.108e3 * t166 * t2335 * t278 - t490 * t701 * t726 * t81 / 0.8e1 + t2385 * t2387 / 0.324e3 + 0.7e1 / 0.54e2 * t51 * t2390);
  t2395 = t2394 * t106;
  t2405 = t1281 * t701;
  t2407 = t81 * t1738 * t90;
  t2411 = t248 * t81 * t292;
  t2414 = t81 * t264;
  t2415 = t677 * t2414;
  t2418 = t2354 * t249;
  t2419 = t703 * sigma[2];
  t2426 = t81 * t701;
  t2430 = t32 * sigma[2];
  t2431 = t186 * t2430;
  t2432 = t2418 * t1771;
  t2435 = t103 * t698;
  t2437 = 0.1e1 / t256 / t1752;
  t2439 = t2437 * t1783 * t147;
  t2442 = 0.7e1 / 0.54e2 * t187 * t2329 * t292 - 0.5e1 / 0.18e2 * t524 * t753 + 0.1e2 / 0.3e1 * t524 * t682 * t264 - t2405 * t2407 / 0.27e2 + 0.2e1 / 0.27e2 * t2405 * t2411 - 0.4e1 / 0.3e1 * t2405 * t2415 - 0.16e2 / 0.3e1 * t1298 * t2418 * t2419 + 0.14e2 / 0.9e1 * t296 * t353 * t760 - 0.152e3 * t764 * t2426 * t703 - 0.8e1 / 0.3e1 * t2431 * t2432 + 0.576e3 * t2435 * t2439;
  t2443 = t291 * t2442;
  t2449 = t290 * t993;
  t2456 = t384 * t744;
  t2463 = 0.4e1 / 0.3e1 * t906 * t1845 - 0.16e2 / 0.3e1 * t2356 * t2358 - 0.4e1 / 0.3e1 * t906 * t1848 - 0.48e2 * t922 * t2363 + 0.48e2 * t922 * t2366 - 0.64e2 * t699 * t2369 + 0.64e2 * t699 * t2372 + t270 * t2395 - t270 * t2443 - t270 * t374 * t1817 - t270 * t734 * t968 - 0.2e1 * t270 * t286 * t2449 - 0.2e1 * t270 * t957 * t737 - 0.6e1 * t270 * t1714 * t2456 + 0.2e1 * t270 * t374 * t1825;
  t2465 = t993 * t301;
  t2469 = t384 * t768;
  t2473 = t132 * t953;
  t2477 = t435 * t905 * t88;
  t2491 = t132 * t2430 * t2354;
  t2495 = t89 * t698 * t2437;
  t2498 = t380 * t735;
  t2501 = t380 * t769;
  t2504 = t292 * t958;
  t2507 = t756 * t375;
  t2510 = 0.4e1 * t270 * t743 * t2465 + 0.2e1 * t270 * t743 * t2469 - t2473 * t687 / 0.9e1 - t2477 * t690 / 0.9e1 + t2477 * t687 / 0.9e1 + t912 * t1851 / 0.24e2 - t912 * t1854 / 0.24e2 + 0.4e1 / 0.3e1 * t930 * t714 - 0.4e1 / 0.3e1 * t930 * t711 - 0.8e1 / 0.3e1 * t2491 * t1868 + 0.576e3 * t2495 * t1877 + t930 * t2498 / 0.2e1 - t930 * t2501 / 0.2e1 - 0.2e1 / 0.9e1 * t686 * t2504 + 0.16e2 / 0.9e1 * t676 * t2507;
  t2511 = t297 * t958;
  t2516 = t292 * t994;
  t2519 = t756 * t385;
  t2522 = t297 * t994;
  t2527 = t760 * t385;
  t2530 = t380 * t745;
  t2534 = t760 * t375;
  t2539 = t90 * params->alpha;
  t2540 = t89 * t2539;
  t2541 = t285 * t742;
  t2547 = t1349 * t2426;
  t2552 = -0.8e1 / 0.3e1 * t710 * t2511 + t2473 * t690 / 0.9e1 + 0.2e1 / 0.9e1 * t686 * t2516 - 0.16e2 / 0.9e1 * t676 * t2519 + 0.8e1 / 0.3e1 * t710 * t2522 - 0.7e1 / 0.27e2 * t1842 * t962 - 0.28e2 / 0.9e1 * t710 * t2527 + t930 * t2530 + 0.7e1 / 0.27e2 * t1842 * t937 + 0.28e2 / 0.9e1 * t710 * t2534 + t912 * t1889 / 0.12e2 + 0.4e1 * t2540 * t2541 * t971 + 0.1e2 / 0.3e1 * t2336 * t909 - t2547 * t1831 / 0.27e2 - 0.152e3 * t922 * t706;
  t2554 = t2350 + t2463 + t2510 + t2552;
  t2559 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t656 * t387 - t2264 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t996 + t2242 - t2271 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t80 * t2554);
  tv3rho2sigma8 = t6 * t2559 + 0.2e1 * t1001;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2566 = t5 * t128 * t1084 / 0.8e1;
  t2567 = t312 * t806;
  t2568 = t1349 * t2567;
  t2572 = 0.1e1 / t35 / t466;
  t2574 = t132 * t1297 * t2572;
  t2575 = t1300 * t471;
  t2580 = t333 * t509;
  t2584 = t2066 * t2088;
  t2586 = t340 * t58;
  t2587 = t2586 * t2062;
  t2590 = t2066 * t2074;
  t2592 = t2087 * t344;
  t2593 = t1425 * t2592;
  t2596 = t1415 * t2592;
  t2609 = t1030 * t181;
  t2612 = t2568 * t1352 / 0.72e2 + 0.2e1 * t2574 * t2575 + 0.24e2 * t1028 * t808 + 0.4e1 * t2212 * t2580 * t853 - t812 * t2584 + 0.2e1 * t812 * t2587 - t812 * t2590 + 0.2e1 / 0.9e1 * t451 * t2593 + 0.8e1 / 0.3e1 * t476 * t2596 - t794 * t2089 / 0.12e2 + t794 * t2063 / 0.6e1 - t794 * t2075 / 0.12e2 + t1011 * t1429 / 0.48e2 - t1011 * t1422 / 0.48e2 - 0.9e1 * t1028 * t2609;
  t2613 = t807 * t335;
  t2616 = t807 * t345;
  t2619 = t1003 * t136;
  t2625 = t864 * t158;
  t2636 = t1030 * t198;
  t2639 = t32 * t2572;
  t2647 = t1008 * t170;
  t2651 = t1281 * t312;
  t2664 = t2572 * t138;
  t2674 = t2664 * t1314;
  t2676 = t60 * t803;
  t2678 = 0.1e1 / t148 / t1247;
  t2680 = t2678 * t1326 * t147;
  t2683 = t187 * t2619 * t188 / 0.36e2 + t1066 * t861 / 0.36e2 - t524 * t2647 * t525 / 0.3e1 + t2651 * t806 * t1283 * t43 / 0.72e2 - t2651 * t806 * t137 * t188 / 0.36e2 + t2651 * t806 * t41 * t525 / 0.2e1 + 0.2e1 * t1298 * t2664 * t469 + t192 * t1004 * t193 / 0.3e1 + 0.24e2 * t533 * t2567 * t469 + t187 * t2674 - 0.216e3 * t2676 * t2680;
  t2684 = t185 * t2683;
  t2695 = t490 * t2572;
  t2697 = t1259 * t29 * t32;
  t2700 = t1004 * t136;
  t2704 = params->alpha * (t46 * t2619 * t48 / 0.36e2 - t167 * t2647 * t172 / 0.72e2 + t490 * t2567 * t493 / 0.36e2 - t2695 * t2697 / 0.864e3 + t51 * t2700 / 0.36e2);
  t2705 = t2704 * t63;
  t2707 = t509 * t1059;
  t2711 = t1081 * t197;
  t2715 = 0.48e2 * t804 * t2613 - 0.48e2 * t804 * t2616 + t143 * t2619 * t158 / 0.3e1 + t1005 * t140 / 0.36e2 - t1014 * t2625 / 0.3e1 - t2568 * t1444 / 0.36e2 + t2568 * t1447 / 0.2e1 - 0.4e1 / 0.3e1 * t788 * t2045 + 0.4e1 / 0.3e1 * t788 * t2054 + 0.9e1 * t1028 * t2636 + t132 * t2639 * t1412 - t162 * t2684 + t162 * t2705 + 0.2e1 * t162 * t180 * t2707 + 0.2e1 * t162 * t510 * t2711;
  t2725 = t1059 * t197;
  t2729 = t344 * t875;
  t2733 = t184 * t1081;
  t2741 = t42 * t33 * t1003;
  t2747 = t42 * t803 * t2678;
  t2750 = t340 * t840;
  t2752 = t340 * t876;
  t2754 = t188 * t1054;
  t2759 = -t162 * t1053 * t504 - 0.2e1 * t162 * t839 * t850 - 0.2e1 * t162 * t334 * t2185 - 0.6e1 * t162 * t1230 * t2725 + 0.4e1 * t162 * t510 * t2729 - t162 * t180 * t2733 - t794 * t2051 / 0.12e2 - t2011 * t844 / 0.9e1 + t2741 * t816 / 0.4e1 - t2741 * t813 / 0.4e1 - 0.216e3 * t2747 * t1364 + t812 * t2750 - t812 * t2752 - t451 * t2754 / 0.9e1 - t1011 * t1388 / 0.4e1;
  t2766 = t132 * t1049;
  t2770 = t435 * t1009 * t170;
  t2783 = t193 * t1054;
  t2786 = t188 * t1060;
  t2789 = t193 * t1060;
  t2792 = t188 * t1082;
  t2795 = t193 * t1082;
  t2798 = t1011 * t1392 / 0.4e1 + t794 * t2042 / 0.12e2 + t2011 * t819 / 0.9e1 + t2766 * t455 / 0.48e2 + t2770 * t443 / 0.36e2 - t2766 * t452 / 0.48e2 + 0.4e1 / 0.3e1 * t812 * t847 - t2005 * t819 / 0.9e1 + t2005 * t844 / 0.9e1 - 0.4e1 / 0.3e1 * t812 * t822 - 0.4e1 / 0.3e1 * t476 * t2783 - 0.2e1 / 0.9e1 * t451 * t2786 - 0.8e1 / 0.3e1 * t476 * t2789 + t451 * t2792 / 0.9e1 + 0.4e1 / 0.3e1 * t476 * t2795;
  t2800 = t2612 + t2715 + t2759 + t2798;
  t2805 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t1084 - t2566 - 0.3e1 / 0.8e1 * t5 * t27 * t2800);
  tv3rhosigma20 = t6 * t2805 + t1088;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2812 = t5 * t216 * t1170 / 0.8e1;
  t2814 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t1170 - t2812);
  tv3rhosigma25 = t6 * t2814 + t1174;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2820 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t1084 - t2566);
  tv3rhosigma26 = t6 * t2820 + t1088;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2825 = t1089 * t247;
  t2831 = t1094 * t276;
  t2835 = t1281 * t352;
  t2849 = 0.1e1 / t82 / t700;
  t2850 = t2849 * t249;
  t2857 = t352 * t924;
  t2861 = t2850 * t1771;
  t2863 = t103 * t921;
  t2865 = 0.1e1 / t256 / t1736;
  t2867 = t2865 * t1783 * t147;
  t2870 = t187 * t2825 * t292 / 0.36e2 + t1152 * t979 / 0.36e2 - t524 * t2831 * t756 / 0.3e1 + t2835 * t924 * t1738 * t90 / 0.72e2 - t2835 * t924 * t248 * t292 / 0.36e2 + t2835 * t924 * t88 * t756 / 0.2e1 + 0.2e1 * t1298 * t2850 * t703 + t296 * t1090 * t297 / 0.3e1 + 0.24e2 * t764 * t2857 * t703 + t187 * t2861 - 0.216e3 * t2863 * t2867;
  t2871 = t291 * t2870;
  t2882 = t490 * t2849;
  t2884 = t1802 * t29 * t32;
  t2887 = t1090 * t247;
  t2891 = params->alpha * (t46 * t2825 * t92 / 0.36e2 - t167 * t2831 * t278 / 0.72e2 + t490 * t2857 * t726 / 0.36e2 - t2882 * t2884 / 0.864e3 + t51 * t2887 / 0.36e2);
  t2892 = t2891 * t106;
  t2894 = t290 * t1167;
  t2899 = t1145 * t301;
  t2903 = t384 * t993;
  t2907 = t742 * t1145;
  t2911 = t1167 * t301;
  t2921 = t1349 * t2857;
  t2925 = t132 * t1297 * t2849;
  t2926 = t1756 * t705;
  t2931 = t373 * t742;
  t2937 = -t270 * t2871 + t270 * t2892 - t270 * t286 * t2894 - t270 * t1139 * t737 - 0.6e1 * t270 * t1714 * t2899 + 0.4e1 * t270 * t743 * t2903 + 0.2e1 * t270 * t286 * t2907 + 0.2e1 * t270 * t743 * t2911 - 0.2e1 * t270 * t957 * t968 - 0.2e1 * t270 * t374 * t2449 + t2921 * t1831 / 0.72e2 + 0.2e1 * t2925 * t2926 + 0.24e2 * t1114 * t926 + 0.4e1 * t2540 * t2931 * t971 - t912 * t2303 / 0.12e2;
  t2938 = t2324 * t2314;
  t2940 = t380 * t101;
  t2941 = t2940 * t2295;
  t2944 = t2324 * t2302;
  t2952 = t2313 * t384;
  t2953 = t1894 * t2952;
  t2956 = t1907 * t2952;
  t2961 = t1116 * t302;
  t2964 = t32 * t2849;
  t2967 = t1116 * t287;
  t2970 = t925 * t375;
  t2973 = t925 * t385;
  t2976 = t982 * t266;
  t2979 = -t930 * t2938 + 0.2e1 * t930 * t2941 - t930 * t2944 + t1097 * t1901 / 0.48e2 - t1097 * t1904 / 0.48e2 - t912 * t2315 / 0.12e2 + 0.2e1 / 0.9e1 * t686 * t2953 + 0.8e1 / 0.3e1 * t710 * t2956 + t912 * t2296 / 0.6e1 + 0.9e1 * t1114 * t2961 + t132 * t2964 * t1868 - 0.9e1 * t1114 * t2967 + 0.48e2 * t922 * t2970 - 0.48e2 * t922 * t2973 - t1100 * t2976 / 0.3e1;
  t2994 = t297 * t1140;
  t2997 = t292 * t1146;
  t3000 = t297 * t1146;
  t3003 = t292 * t1168;
  t3006 = t297 * t1168;
  t3017 = -t2921 * t1934 / 0.36e2 + t2921 * t1937 / 0.2e1 - 0.4e1 / 0.3e1 * t906 * t2507 + 0.4e1 / 0.3e1 * t906 * t2519 + t254 * t2825 * t266 / 0.3e1 + t1091 * t251 / 0.36e2 - 0.4e1 / 0.3e1 * t710 * t2994 - 0.2e1 / 0.9e1 * t686 * t2997 - 0.8e1 / 0.3e1 * t710 * t3000 + t686 * t3003 / 0.9e1 + 0.4e1 / 0.3e1 * t710 * t3006 - t1097 * t1845 / 0.4e1 + t1097 * t1848 / 0.4e1 + t912 * t2504 / 0.12e2 + t2477 * t937 / 0.9e1;
  t3023 = t89 * t33 * t1089;
  t3026 = t132 * t1135;
  t3030 = t435 * t1095 * t276;
  t3046 = t89 * t921 * t2865;
  t3049 = t380 * t958;
  t3051 = t380 * t994;
  t3053 = t292 * t1140;
  t3056 = -t912 * t2516 / 0.12e2 - t2477 * t962 / 0.9e1 + t3023 * t934 / 0.4e1 + t3026 * t690 / 0.48e2 + t3030 * t678 / 0.36e2 - t3026 * t687 / 0.48e2 + t2473 * t962 / 0.9e1 - 0.4e1 / 0.3e1 * t930 * t940 + 0.4e1 / 0.3e1 * t930 * t965 - t2473 * t937 / 0.9e1 - t3023 * t931 / 0.4e1 - 0.216e3 * t3046 * t1877 + t930 * t3049 - t930 * t3051 - t686 * t3053 / 0.9e1;
  t3058 = t2937 + t2979 + t3017 + t3056;
  t3063 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t1170 - t2812 - 0.3e1 / 0.8e1 * t5 * t80 * t3058);
  tv3rhosigma211 = t6 * t3063 + t1174;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t3065 = 0.1e1 / t1318;
  t3066 = t3065 * t37;
  t3070 = 0.1e1 / t1253;
  t3071 = t146 * t3070;
  t3072 = t518 * t3071;
  t3075 = t3070 * t150;
  t3079 = t1281 * t1003;
  t3081 = t1029 * t1283 * t43;
  t3085 = t1029 * t137 * t188;
  t3089 = t1029 * t41 * t525;
  t3093 = 0.1e1 / t35 / t805;
  t3098 = t32 * t3065;
  t3102 = t1003 * t1029;
  t3106 = t32 * t1008;
  t3107 = t186 * t3106;
  t3108 = t3093 * t138;
  t3109 = t3108 * t1314;
  t3112 = t60 * t1027;
  t3114 = 0.1e1 / t148 / t466;
  t3116 = t3114 * t1326 * t147;
  t3119 = t187 * t3066 * t188 / 0.32e2 + t3072 * t1068 / 0.32e2 - 0.3e1 / 0.8e1 * t524 * t3075 * t525 - t3079 * t3081 / 0.192e3 + t3079 * t3085 / 0.96e2 - 0.3e1 / 0.16e2 * t3079 * t3089 - 0.3e1 / 0.4e1 * t1298 * t1008 * t3093 * t1300 + 0.3e1 / 0.8e1 * t192 * t3098 * t340 + 0.9e1 * t533 * t3102 * t469 - 0.3e1 / 0.8e1 * t3107 * t3109 + 0.81e2 * t3112 * t3116;
  t3120 = t185 * t3119;
  t3128 = t490 * t3093;
  t3130 = t1259 * t1008 * t33;
  t3133 = t3098 * t37;
  t3137 = params->alpha * (t46 * t3066 * t48 / 0.32e2 - t167 * t3075 * t172 / 0.64e2 + t3128 * t3130 / 0.2304e4 + t51 * t3133 / 0.32e2);
  t3138 = t3137 * t63;
  t3140 = t1059 * t344;
  t3141 = t1230 * t3140;
  t3153 = t344 * t1081;
  t3157 = t1349 * t3102;
  t3160 = t462 * t1003;
  t3161 = t42 * t3160;
  t3164 = t2066 * t2592;
  t3173 = t1030 * t335;
  t3176 = t435 * t3071;
  t3183 = t1297 * t1008;
  t3184 = t132 * t3183;
  t3185 = t3108 * t1411;
  t3188 = -t162 * t3120 + t162 * t3138 - 0.6e1 * t162 * t3141 + 0.6e1 * t162 * t334 * t2707 - 0.3e1 * t162 * t1053 * t850 - 0.3e1 * t162 * t334 * t2733 + 0.6e1 * t162 * t510 * t3153 - t3157 * t1352 / 0.192e3 + 0.9e1 * t3161 * t1031 - 0.3e1 * t812 * t3164 - t1011 * t2092 / 0.16e2 - t794 * t2593 / 0.4e1 + t1011 * t2071 / 0.16e2 - 0.27e2 * t1028 * t3173 - 0.3e1 / 0.8e1 * t3176 * t1016 + t3157 * t1444 / 0.96e2 - 0.3e1 / 0.16e2 * t3157 * t1447 - 0.3e1 / 0.4e1 * t3184 * t3185;
  t3189 = t1030 * t345;
  t3195 = t132 * t3098;
  t3199 = t42 * t1027 * t3114;
  t3202 = t340 * t1054;
  t3205 = t340 * t1082;
  t3219 = t132 * t3106 * t3093;
  t3225 = t435 * t3071 * t150;
  t3232 = t340 * t1060;
  t3237 = 0.27e2 * t1028 * t3189 + 0.3e1 / 0.8e1 * t143 * t3066 * t158 + t3195 * t316 / 0.32e2 + 0.81e2 * t3199 * t1364 + 0.3e1 / 0.2e1 * t812 * t3202 - 0.3e1 / 0.2e1 * t812 * t3205 + 0.3e1 / 0.4e1 * t1011 * t2045 + t794 * t2754 / 0.8e1 - t794 * t2792 / 0.8e1 + 0.3e1 / 0.4e1 * t2741 * t1036 - 0.3e1 / 0.4e1 * t2741 * t1034 - 0.3e1 / 0.8e1 * t3219 * t1412 + t2766 * t844 / 0.16e2 + t3225 * t443 / 0.32e2 - t2766 * t819 / 0.16e2 - 0.3e1 / 0.4e1 * t1011 * t2054 + 0.3e1 * t812 * t3232 + t794 * t2786 / 0.4e1;
  t3238 = t3188 + t3237;
  t3242 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t3238);
  tv3sigma30 = t6 * t3242;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t3246 = 0.1e1 / t1775;
  t3247 = t3246 * t84;
  t3251 = 0.1e1 / t1751;
  t3252 = t3251 * t258;
  t3257 = 0.1e1 / t82 / t923;
  t3258 = t490 * t3257;
  t3260 = t1802 * t1094 * t33;
  t3263 = t32 * t3246;
  t3264 = t3263 * t84;
  t3268 = params->alpha * (t46 * t3247 * t92 / 0.32e2 - t167 * t3252 * t278 / 0.64e2 + t3258 * t3260 / 0.2304e4 + t51 * t3264 / 0.32e2);
  t3269 = t3268 * t106;
  t3274 = t146 * t3251;
  t3275 = t518 * t3274;
  t3281 = t1281 * t1089;
  t3283 = t1115 * t1738 * t90;
  t3287 = t1115 * t248 * t292;
  t3291 = t1115 * t88 * t756;
  t3301 = t1089 * t1115;
  t3305 = t32 * t1094;
  t3306 = t186 * t3305;
  t3307 = t3257 * t249;
  t3308 = t3307 * t1771;
  t3311 = t103 * t1113;
  t3313 = 0.1e1 / t256 / t700;
  t3315 = t3313 * t1783 * t147;
  t3318 = t187 * t3247 * t292 / 0.32e2 + t3275 * t1154 / 0.32e2 - 0.3e1 / 0.8e1 * t524 * t3252 * t756 - t3281 * t3283 / 0.192e3 + t3281 * t3287 / 0.96e2 - 0.3e1 / 0.16e2 * t3281 * t3291 - 0.3e1 / 0.4e1 * t1298 * t1094 * t3257 * t1756 + 0.3e1 / 0.8e1 * t296 * t3263 * t380 + 0.9e1 * t764 * t3301 * t703 - 0.3e1 / 0.8e1 * t3306 * t3308 + 0.81e2 * t3311 * t3315;
  t3319 = t291 * t3318;
  t3321 = t1145 * t384;
  t3322 = t1714 * t3321;
  t3331 = t384 * t1167;
  t3335 = t1349 * t3301;
  t3338 = t462 * t1089;
  t3339 = t89 * t3338;
  t3342 = t2324 * t2952;
  t3354 = t132 * t3263;
  t3357 = t1116 * t375;
  t3360 = t435 * t3274;
  t3365 = 0.6e1 * t270 * t374 * t2907 + t270 * t3269 - t270 * t3319 - 0.6e1 * t270 * t3322 - 0.3e1 * t270 * t1139 * t968 - 0.3e1 * t270 * t374 * t2894 + 0.6e1 * t270 * t743 * t3331 - t3335 * t1831 / 0.192e3 + 0.9e1 * t3339 * t1117 - 0.3e1 * t930 * t3342 + t1097 * t2299 / 0.16e2 - t1097 * t2318 / 0.16e2 - t912 * t2953 / 0.4e1 + 0.3e1 / 0.8e1 * t254 * t3247 * t266 + t3354 * t356 / 0.32e2 - 0.27e2 * t1114 * t3357 - 0.3e1 / 0.8e1 * t3360 * t1102 + t3335 * t1934 / 0.96e2;
  t3368 = t1297 * t1094;
  t3369 = t132 * t3368;
  t3370 = t3307 * t1867;
  t3373 = t1116 * t385;
  t3376 = t380 * t1168;
  t3386 = t132 * t3305 * t3257;
  t3390 = t89 * t1113 * t3313;
  t3393 = t380 * t1140;
  t3397 = t435 * t3274 * t258;
  t3410 = t380 * t1146;
  t3415 = -0.3e1 / 0.16e2 * t3335 * t1937 - 0.3e1 / 0.4e1 * t3369 * t3370 + 0.27e2 * t1114 * t3373 - 0.3e1 / 0.2e1 * t930 * t3376 - t912 * t3003 / 0.8e1 + 0.3e1 / 0.4e1 * t3023 * t1122 - 0.3e1 / 0.4e1 * t3023 * t1120 - 0.3e1 / 0.8e1 * t3386 * t1868 + 0.81e2 * t3390 * t1877 + 0.3e1 / 0.2e1 * t930 * t3393 + t3397 * t678 / 0.32e2 - t3026 * t937 / 0.16e2 - 0.3e1 / 0.4e1 * t1097 * t2519 + 0.3e1 / 0.4e1 * t1097 * t2507 + t912 * t3053 / 0.8e1 + t3026 * t962 / 0.16e2 + 0.3e1 * t930 * t3410 + t912 * t2997 / 0.4e1;
  t3416 = t3365 + t3415;
  t3420 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t3416);
  tv3sigma39 = t6 * t3420;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t37, t38, t40, t41;
  double t42, t43, t44, t46, t47, t48, t51, t52;
  double t58, t59, t60, t62, t63, t64, t66, t70;
  double t71, t72, t74, t75, t76, t77, t79, t80;
  double t81, t82, t84, t85, t87, t88, t89, t90;
  double t91, t92, t95, t101, t102, t103, t105, t106;
  double t107, t109, t113, tzk0;

  double t114, t115, t116, t118, t121, t122, t126, t127;
  double t128, t131, t132, t133, t134, t136, t137, t138;
  double t140, t143, t144, t145, t146, t147, t148, t150;
  double t154, t155, t156, t157, t158, t162, t166, t167;
  double t168, t170, t172, t176, t179, t180, t181, t183;
  double t184, t185, t186, t187, t188, t192, t193, t197;
  double t198, t200, t205, t206, t208, t211, t212, t216;
  double t219, t221, tvrho0, t225, t228, t229, t234, t236;
  double t239, t240, t244, t245, t247, t248, t249, t251;
  double t254, t255, t256, t258, t262, t263, t264, t265;
  double t266, t270, t274, t276, t278, t282, t285, t286;
  double t287, t289, t290, t291, t292, t296, t297, t301;
  double t302, t304, t309, tvrho1, t312, t313, t314, t316;
  double t319, t330, t333, t334, t335, t340, t344, t345;
  double t347, t351, tvsigma0, tvsigma1, t352, t353, t354, t356;
  double t359, t370, t373, t374, t375, t380, t384, t385;
  double t387, t391, tvsigma2;

  double t394, t395, t396, t399, t400, t401, t404, t408;
  double t409, t413, t415, t421, t422, t425, t427, t430;
  double t432, t435, t436, t437, t439, t441, t442, t443;
  double t446, t447, t448, t451, t452, t455, t458, t462;
  double t463, t464, t465, t466, t467, t469, t470, t471;
  double t472, t476, t477, t480, t486, t490, t491, t492;
  double t493, t497, t500, t501, t502, t504, t509, t510;
  double t511, t512, t518, t519, t521, t524, t525, t529;
  double t533, t537, t538, t540, t545, t546, t547, t548;
  double t551, t554, t558, t559, t563, t565, t567, t570;
  double t572, tv2rho20, t575, t579, t583, t584, t588, t590;
  double t598, t599, t603, t607, t608, t612, t614, t621;
  double t624, tv2rho21, t629, t634, t638, t639, t645, t646;
  double t651, t655, t656, t666, t668, t671, t672, t674;
  double t676, t677, t678, t681, t682, t683, t686, t687;
  double t690, t693, t697, t698, t699, t700, t701, t703;
  double t704, t705, t706, t710, t711, t714, t720, t724;
  double t725, t726, t730, t733, t734, t735, t737, t742;
  double t743, t744, t745, t751, t753, t756, t760, t764;
  double t768, t769, t771, t776, tv2rho22, t784, t787, t788;
  double t791, t794, t799, t803, t804, t805, t806, t807;
  double t808, t812, t813, t816, t819, t822, t835, t838;
  double t839, t840, t844, t847, t850, t853, t861, t864;
  double t875, t876, t878, t883, tv2rhosigma0, tv2rhosigma1, t890, t892;
  double tv2rhosigma2, t898, tv2rhosigma3, tv2rhosigma4, t905, t906, t909, t912;
  double t917, t921, t922, t923, t924, t925, t926, t930;
  double t931, t934, t937, t940, t953, t956, t957, t958;
  double t962, t965, t968, t971, t979, t982, t993, t994;
  double t996, t1001, tv2rhosigma5, t1003, t1004, t1005, t1008, t1009;
  double t1011, t1014, t1016, t1023, t1027, t1028, t1029, t1030;
  double t1031, t1034, t1036, t1041, t1049, t1052, t1053, t1054;
  double t1059, t1060, t1066, t1068, t1081, t1082, t1084, t1088;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1089, t1090, t1091;
  double t1094, t1095, t1097, t1100, t1102, t1109, t1113, t1114;
  double t1115, t1116, t1117, t1120, t1122, t1127, t1135, t1138;
  double t1139, t1140, t1145, t1146, t1152, t1154, t1167, t1168;
  double t1170, t1174, tv2sigma25;

  double t1178, t1179, t1182, t1185, t1186, t1187, t1190, t1194;
  double t1195, t1199, t1201, t1206, t1208, t1211, t1217, t1218;
  double t1221, t1223, t1226, t1228, t1229, t1230, t1231, t1232;
  double t1236, t1237, t1242, t1243, t1247, t1248, t1249, t1253;
  double t1254, t1255, t1257, t1259, t1264, t1268, t1269, t1275;
  double t1281, t1282, t1283, t1288, t1292, t1297, t1298, t1300;
  double t1304, t1311, t1312, t1313, t1314, t1315, t1318, t1319;
  double t1320, t1321, t1323, t1324, t1326, t1328, t1331, t1332;
  double t1334, t1341, t1345, t1349, t1350, t1351, t1352, t1355;
  double t1356, t1360, t1361, t1363, t1364, t1367, t1370, t1373;
  double t1376, t1379, t1383, t1388, t1391, t1392, t1395, t1398;
  double t1401, t1404, t1408, t1409, t1410, t1411, t1412, t1415;
  double t1416, t1417, t1418, t1421, t1422, t1425, t1426, t1429;
  double t1433, t1439, t1443, t1444, t1447, t1450, t1451, t1455;
  double t1458, t1461, t1462, t1467, t1469, t1470, t1473, t1476;
  double t1479, t1483, t1484, t1488, t1490, t1492, t1494, t1496;
  double t1499, t1501, tv3rho30, t1504, t1505, t1506, t1509, t1514;
  double t1515, t1517, t1521, t1522, t1526, t1529, t1533, t1535;
  double t1539, t1548, t1549, t1550, t1553, t1558, t1560, t1564;
  double t1565, t1569, t1572, t1573, t1575, t1584, t1586, t1589;
  double tv3rho31, t1592, t1597, t1601, t1605, t1606, t1610, t1612;
  double t1621, t1622, t1627, t1631, t1635, t1636, t1640, t1642;
  double t1649, t1657, t1659, t1660, tv3rho32, t1665, t1672, t1676;
  double t1677, t1684, t1685, t1692, t1696, t1697, t1712, t1713;
  double t1714, t1715, t1716, t1720, t1721, t1726, t1728, t1731;
  double t1735, t1736, t1737, t1738, t1743, t1747, t1751, t1752;
  double t1754, t1756, t1760, t1764, t1768, t1769, t1770, t1771;
  double t1772, t1775, t1776, t1777, t1778, t1780, t1781, t1783;
  double t1785, t1788, t1789, t1800, t1802, t1807, t1811, t1812;
  double t1817, t1821, t1825, t1829, t1830, t1831, t1834, t1835;
  double t1839, t1842, t1845, t1848, t1851, t1854, t1857, t1860;
  double t1864, t1865, t1866, t1867, t1868, t1871, t1873, t1874;
  double t1876, t1877, t1880, t1883, t1886, t1889, t1894, t1895;
  double t1896, t1897, t1900, t1901, t1904, t1907, t1908, t1911;
  double t1912, t1916, t1919, t1923, t1929, t1933, t1934, t1937;
  double t1940, t1941, t1946, tv3rho33, t1954, t1961, t1963, t1965;
  double t1969, t1978, t1979, t1981, t1984, t1988, t1989, t1991;
  double t1994, t1999, t2005, t2011, t2024, t2025, t2027, t2031;
  double t2033, t2036, t2039, t2042, t2045, t2048, t2051, t2054;
  double t2057, t2060, t2061, t2062, t2063, t2066, t2067, t2071;
  double t2074, t2075, t2078, t2080, t2081, t2084, t2087, t2088;
  double t2089, t2092, t2095, t2103, t2106, t2108, t2109, t2112;
  double t2114, t2119, t2120, t2122, t2127, t2130, t2133, t2134;
  double t2137, t2148, t2150, t2154, t2157, t2158, t2161, t2162;
  double t2169, t2173, t2174, t2177, t2179, t2182, t2183, t2185;
  double t2189, t2193, t2207, t2211, t2212, t2213, t2219, t2224;
  double t2226, t2231, tv3rho2sigma0, tv3rho2sigma1, t2238, t2242, t2244, tv3rho2sigma2;
  double t2250, t2258, tv3rho2sigma3, tv3rho2sigma4, t2264, t2271, t2274, tv3rho2sigma5;
  double t2282, tv3rho2sigma6, tv3rho2sigma7, t2293, t2294, t2295, t2296, t2299;
  double t2302, t2303, t2306, t2307, t2310, t2313, t2314, t2315;
  double t2318, t2321, t2324, t2325, t2329, t2335, t2336, t2339;
  double t2341, t2342, t2345, t2347, t2350, t2354, t2355, t2356;
  double t2358, t2363, t2366, t2369, t2372, t2385, t2387, t2390;
  double t2394, t2395, t2405, t2407, t2411, t2414, t2415, t2418;
  double t2419, t2426, t2430, t2431, t2432, t2435, t2437, t2439;
  double t2442, t2443, t2449, t2456, t2463, t2465, t2469, t2473;
  double t2477, t2491, t2495, t2498, t2501, t2504, t2507, t2510;
  double t2511, t2516, t2519, t2522, t2527, t2530, t2534, t2539;
  double t2540, t2541, t2547, t2552, t2554, t2559, tv3rho2sigma8, t2566;
  double t2567, t2568, t2572, t2574, t2575, t2580, t2584, t2586;
  double t2587, t2590, t2592, t2593, t2596, t2609, t2612, t2613;
  double t2616, t2619, t2625, t2636, t2639, t2647, t2651, t2664;
  double t2674, t2676, t2678, t2680, t2683, t2684, t2695, t2697;
  double t2700, t2704, t2705, t2707, t2711, t2715, t2725, t2729;
  double t2733, t2741, t2747, t2750, t2752, t2754, t2759, t2766;
  double t2770, t2783, t2786, t2789, t2792, t2795, t2798, t2800;
  double t2805, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2812, t2814;
  double tv3rhosigma25, t2820, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2825;
  double t2831, t2835, t2849, t2850, t2857, t2861, t2863, t2865;
  double t2867, t2870, t2871, t2882, t2884, t2887, t2891, t2892;
  double t2894, t2899, t2903, t2907, t2911, t2921, t2925, t2926;
  double t2931, t2937, t2938, t2940, t2941, t2944, t2952, t2953;
  double t2956, t2961, t2964, t2967, t2970, t2973, t2976, t2979;
  double t2994, t2997, t3000, t3003, t3006, t3017, t3023, t3026;
  double t3030, t3046, t3049, t3051, t3053, t3056, t3058, t3063;
  double tv3rhosigma211, t3065, t3066, t3070, t3071, t3072, t3075, t3079;
  double t3081, t3085, t3089, t3093, t3098, t3102, t3106, t3107;
  double t3108, t3109, t3112, t3114, t3116, t3119, t3120, t3128;
  double t3130, t3133, t3137, t3138, t3140, t3141, t3153, t3157;
  double t3160, t3161, t3164, t3173, t3176, t3183, t3184, t3185;
  double t3188, t3189, t3195, t3199, t3202, t3205, t3219, t3225;
  double t3232, t3237, t3238, t3242, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t3246, t3247, t3251;
  double t3252, t3257, t3258, t3260, t3263, t3264, t3268, t3269;
  double t3274, t3275, t3281, t3283, t3287, t3291, t3301, t3305;
  double t3306, t3307, t3308, t3311, t3313, t3315, t3318, t3319;
  double t3321, t3322, t3331, t3335, t3338, t3339, t3342, t3354;
  double t3357, t3360, t3365, t3368, t3369, t3370, t3373, t3376;
  double t3386, t3390, t3393, t3397, t3410, t3415, t3416, t3420;
  double tv3sigma39;

  double t3423, t3425, t3426, t3432, t3438, t3439, t3442, t3446;
  double t3455, t3461, t3463, t3469, t3472, t3475, t3477, t3479;
  double t3482, t3483, t3484, t3494, t3495, t3496, t3497, t3498;
  double t3499, t3502, t3503, t3508, t3509, t3513, t3517, t3518;
  double t3522, t3525, t3527, t3532, t3533, t3535, t3537, t3547;
  double t3548, t3556, t3557, t3559, t3560, t3563, t3565, t3566;
  double t3567, t3570, t3571, t3577, t3578, t3585, t3594, t3609;
  double t3613, t3618, t3619, t3622, t3639, t3640, t3652, t3664;
  double t3674, t3679, t3680, t3683, t3686, t3692, t3694, t3697;
  double t3698, t3699, t3702, t3703, t3707, t3708, t3711, t3712;
  double t3724, t3725, t3730, t3731, t3736, t3739, t3744, t3747;
  double t3748, t3751, t3753, t3756, t3758, t3761, t3780, t3786;
  double t3789, t3809, t3813, t3814, t3817, t3819, t3823, t3826;
  double t3832, t3845, t3851, t3853, t3865, t3866, t3867, t3870;
  double t3882, t3888, t3890, t3896, t3906, t3909, t3914, t3930;
  double t3939, t3943, t3947, t3950, t3954, t3955, t3956, t3957;
  double t3959, t3960, t3966, t3971, t3974, t3978, t3985, t3989;
  double t3993, t3998, t4000, tv4rho40, t4021, t4022, t4024, t4028;
  double t4037, t4043, t4044, t4046, t4059, t4060, t4063, t4067;
  double t4072, t4073, t4090, t4092, t4096, t4103, t4107, t4108;
  double t4111, t4120, t4123, t4124, t4126, t4128, t4129, tv4rho41;
  double t4144, t4157, t4161, t4170, t4183, t4187, t4194, t4195;
  double t4204, t4217, t4221, t4228, t4232, t4241, t4244, t4255;
  double t4258, t4260, t4261, tv4rho42, t4282, t4286, t4293, t4304;
  double t4305, t4322, t4326, t4333, t4341, t4350, t4360, t4362;
  double t4363, tv4rho43, t4368, t4373, t4380, t4384, t4393, t4395;
  double t4402, t4419, t4420, t4421, t4425, t4428, t4433, t4435;
  double t4437, t4447, t4448, t4456, t4460, t4464, t4465, t4467;
  double t4468, t4471, t4473, t4474, t4475, t4478, t4479, t4485;
  double t4486, t4490, t4491, t4494, t4500, t4501, t4506, t4510;
  double t4525, t4542, t4543, t4557, t4558, t4563, t4567, t4575;
  double t4579, t4582, t4585, t4586, t4587, t4590, t4591, t4595;
  double t4596, t4599, t4602, t4604, t4605, t4612, t4613, t4622;
  double t4623, t4633, t4634, t4639, t4642, t4643, t4646, t4651;
  double t4654, t4657, t4659, t4662, t4664, t4667, t4681, t4684;
  double t4687, t4711, t4712, t4726, t4729, t4733, t4735, t4750;
  double t4754, t4755, t4758, t4761, t4768, t4774, t4778, t4782;
  double t4789, t4798, t4801, t4805, t4811, t4823, t4824, t4825;
  double t4830, t4839, t4846, t4851, t4858, t4862, t4884, t4885;
  double tv4rho44, t4893, t4899, t4902, t4909, t4911, t4914, t4918;
  double t4931, t4932, t4937, t4949, t4954, t4955, t4958, t4964;
  double t4970, t4976, t4984, t4988, t4994, t5021, t5023, t5025;
  double t5028, t5029, t5030, t5032, t5039, t5040, t5044, t5048;
  double t5072, t5077, t5080, t5083, t5088, t5108, t5111, t5115;
  double t5126, t5136, t5140, t5146, t5151, t5165, t5170, t5179;
  double t5182, t5199, t5228, t5243, t5267, t5284, t5310, t5311;
  double t5317, t5320, t5321, t5324, t5325, t5328, t5329, t5334;
  double t5335, t5336, t5339, t5340, t5343, t5346, t5360, t5365;
  double t5370, t5379, t5380, t5399, t5410, t5413, t5432, t5437;
  double t5448, t5452, t5466, t5481, t5487, t5522, t5531, tv4rho3sigma0;
  double tv4rho3sigma1, t5538, t5541, t5545, t5547, tv4rho3sigma2, t5549, t5555;
  double t5560, t5564, t5573, t5574, tv4rho3sigma3, tv4rho3sigma4, t5576, t5582;
  double t5584, t5593, t5595, t5598, tv4rho3sigma5, t5604, t5613, tv4rho3sigma6;
  double tv4rho3sigma7, t5619, t5626, t5634, t5636, t5637, tv4rho3sigma8, t5646;
  double tv4rho3sigma9, tv4rho3sigma10, t5664, t5665, t5671, t5672, t5678, t5681;
  double t5682, t5686, t5689, t5690, t5691, t5697, t5699, t5708;
  double t5714, t5715, t5728, t5735, t5738, t5743, t5749, t5753;
  double t5767, t5773, t5774, t5779, t5784, t5787, t5792, t5798;
  double t5810, t5813, t5819, t5843, t5850, t5856, t5879, t5882;
  double t5887, t5899, t5900, t5903, t5906, t5913, t5920, t5933;
  double t5939, t5940, t5954, t5957, t5962, t5965, t5970, t5983;
  double t6003, t6007, t6019, t6020, t6034, t6042, t6048, t6069;
  double t6099, t6113, t6125, t6145, t6158, t6159, t6164, t6189;
  double t6218, t6220, t6223, t6224, t6226, t6238, t6258, t6268;
  double t6277, tv4rho3sigma11, t6284, t6291, t6293, t6313, t6336, t6357;
  double t6360, t6363, t6366, t6369, t6384, t6395, t6401, t6403;
  double t6418, t6431, t6434, t6440, t6443, t6448, t6453, t6459;
  double t6482, t6502, t6511, t6526, t6531, t6550, t6551, t6552;
  double t6558, t6559, t6560, t6587, t6593, t6596, t6597, t6603;
  double t6604, t6611, t6612, t6618, t6619, t6625, t6626, t6632;
  double t6634, t6635, t6641, t6662, t6665, t6671, t6693, t6710;
  double t6723, t6726, t6730, t6734, t6811, t6819, t6822, t6832;
  double t6854, t6855, t6887, t6917, t6935, t6939, t6943, t6947;
  double t6952, t6958, t6967, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24;
  double t6974, t6978, t6980, tv4rho2sigma25, t6986, t6994, tv4rho2sigma26, tv4rho2sigma27;
  double tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t7000, t7007, t7010, tv4rho2sigma211, t7018;
  double tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t7033, t7057, t7061;
  double t7065, t7088, t7104, t7109, t7114, t7120, t7156, t7159;
  double t7165, t7181, t7196, t7209, t7226, t7242, t7256, t7261;
  double t7265, t7270, t7286, t7293, t7296, t7299, t7302, t7315;
  double t7329, t7341, t7344, t7372, t7404, t7420, t7421, t7424;
  double t7425, t7428, t7439, t7470, t7477, t7481, t7482, t7488;
  double t7489, t7495, t7496, t7503, t7504, t7510, t7511, t7514;
  double t7518, t7519, t7520, t7534, t7537, t7541, t7547, t7551;
  double t7554, t7557, t7561, t7587, t7588, t7605, t7626, t7662;
  double t7676, t7702, t7711, tv4rho2sigma217, t7718, t7731, t7734, t7749;
  double t7780, t7786, t7828, t7832, t7836, t7840, t7844, t7864;
  double t7877, t7883, t7886, t7890, t7899, t7916, t7924, t7936;
  double t7945, t7956, t7991, t8011, t8012, t8018, t8019, t8025;
  double t8026, t8042, t8053, t8082, t8100, t8113, t8127, t8133;
  double t8148, t8173, t8220, t8229, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33;
  double tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t8236, t8238, tv4rhosigma39;
  double t8244, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316;
  double tv4rhosigma317, tv4rhosigma318, t8270, t8288, t8296, t8298, t8304, t8307;
  double t8315, t8340, t8351, t8358, t8363, t8376, t8382, t8389;
  double t8402, t8429, t8430, t8436, t8437, t8443, t8444, t8461;
  double t8468, t8477, t8517, t8518, t8519, t8565, t8578, t8614;
  double t8619, t8636, t8640, t8656, t8662, t8677, t8702, t8749;
  double t8758, tv4rhosigma319, t8783, t8797, t8804, t8805, t8812, t8836;
  double t8843, t8844, t8869, t8901, t8934, t8946, t8947, t8961;
  double t8962, t8966, t8970, t8998, t9004, t9008, t9036, t9064;
  double t9068, t9085, t9092, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44;
  double tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412;
  double tv4sigma413, t9130, t9131, t9140, t9141, t9156, t9177, t9182;
  double t9194, t9202, t9209, t9216, t9243, t9272, t9295, t9296;
  double t9302, t9305, t9309, t9313, t9332, t9343, t9379, t9390;
  double t9418, t9425, tv4sigma414;

  gga_x_ncap_params *params;

  assert(p->params != NULL);
  params = (gga_x_ncap_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = tanh(t40);
  t42 = params->mu * t41;
  t43 = log(t40 + sqrt(t40 * t40 + 0.1e1));
  t44 = 0.1e1 - params->zeta;
  t46 = t44 * t29 * t32;
  t47 = 0.1e1 + t40;
  t48 = log(t47);
  t51 = params->zeta * t29;
  t52 = t32 * t34;
  t58 = 0.1e1 + params->alpha * (t51 * t52 * t37 / 0.12e2 + t46 * t38 * t48 / 0.12e2);
  t59 = t43 * t58;
  t60 = params->beta * t41;
  t62 = t60 * t43 + 0.1e1;
  t63 = 0.1e1 / t62;
  t64 = t59 * t63;
  t66 = t42 * t64 + 0.1e1;
  t70 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t66);
  t71 = rho[1] <= p->dens_threshold;
  t72 = -t16;
  t74 = my_piecewise5(t14, t11, t10, t15, t72 * t7);
  t75 = 0.1e1 + t74;
  t76 = t75 <= p->zeta_threshold;
  t77 = POW_1_3(t75);
  t79 = my_piecewise3(t76, t22, t77 * t75);
  t80 = t79 * t26;
  t81 = sqrt(sigma[2]);
  t82 = POW_1_3(rho[1]);
  t84 = 0.1e1 / t82 / rho[1];
  t85 = t81 * t84;
  t87 = t33 * t85 / 0.12e2;
  t88 = tanh(t87);
  t89 = params->mu * t88;
  t90 = log(t87 + sqrt(t87 * t87 + 0.1e1));
  t91 = 0.1e1 + t87;
  t92 = log(t91);
  t95 = t32 * t81;
  t101 = 0.1e1 + params->alpha * (t46 * t85 * t92 / 0.12e2 + t51 * t95 * t84 / 0.12e2);
  t102 = t90 * t101;
  t103 = params->beta * t88;
  t105 = t103 * t90 + 0.1e1;
  t106 = 0.1e1 / t105;
  t107 = t102 * t106;
  t109 = t89 * t107 + 0.1e1;
  t113 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t109);
  tzk0 = t70 + t113;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t114 = t6 * t6;
  t115 = 0.1e1 / t114;
  t116 = t16 * t115;
  t118 = my_piecewise5(t10, 0, t14, 0, t7 - t116);
  t121 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t118);
  t122 = t121 * t26;
  t126 = t26 * t26;
  t127 = 0.1e1 / t126;
  t128 = t25 * t127;
  t131 = t5 * t128 * t66 / 0.8e1;
  t132 = params->mu * t29;
  t133 = t132 * t52;
  t134 = rho[0] * rho[0];
  t136 = 0.1e1 / t35 / t134;
  t137 = t41 * t41;
  t138 = 0.1e1 - t137;
  t140 = t136 * t138 * t64;
  t143 = t42 * t33;
  t144 = t34 * t136;
  t145 = t31 * t31;
  t146 = 0.1e1 / t145;
  t147 = t28 * t146;
  t148 = t35 * t35;
  t150 = 0.1e1 / t148 / t134;
  t154 = 0.6e1 * t147 * t150 * sigma[0] + 0.144e3;
  t155 = sqrt(t154);
  t156 = 0.1e1 / t155;
  t157 = t156 * t58;
  t158 = t157 * t63;
  t162 = t42 * t43;
  t166 = t44 * t28;
  t167 = t166 * t146;
  t168 = t134 * rho[0];
  t170 = 0.1e1 / t148 / t168;
  t172 = 0.1e1 / t47;
  t176 = t52 * t136;
  t179 = -t46 * t144 * t48 / 0.9e1 - t167 * sigma[0] * t170 * t172 / 0.18e2 - t51 * t176 / 0.9e1;
  t180 = params->alpha * t179;
  t181 = t180 * t63;
  t183 = t62 * t62;
  t184 = 0.1e1 / t183;
  t185 = t58 * t184;
  t186 = params->beta * t29;
  t187 = t186 * t32;
  t188 = t138 * t43;
  t192 = t60 * t29;
  t193 = t136 * t156;
  t197 = -t187 * t144 * t188 / 0.9e1 - 0.4e1 / 0.3e1 * t192 * t52 * t193;
  t198 = t185 * t197;
  t200 = -t133 * t140 / 0.9e1 - 0.4e1 / 0.3e1 * t143 * t144 * t158 + t162 * t181 - t162 * t198;
  t205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t66 - t131 - 0.3e1 / 0.8e1 * t5 * t27 * t200);
  t206 = t72 * t115;
  t208 = my_piecewise5(t14, 0, t10, 0, -t7 - t206);
  t211 = my_piecewise3(t76, 0, 0.4e1 / 0.3e1 * t77 * t208);
  t212 = t211 * t26;
  t216 = t79 * t127;
  t219 = t5 * t216 * t109 / 0.8e1;
  t221 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t109 - t219);
  tvrho0 = t70 + t113 + t6 * (t205 + t221);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t225 = my_piecewise5(t10, 0, t14, 0, -t7 - t116);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t225);
  t229 = t228 * t26;
  t234 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t66 - t131);
  t236 = my_piecewise5(t14, 0, t10, 0, t7 - t206);
  t239 = my_piecewise3(t76, 0, 0.4e1 / 0.3e1 * t77 * t236);
  t240 = t239 * t26;
  t244 = t132 * t95;
  t245 = rho[1] * rho[1];
  t247 = 0.1e1 / t82 / t245;
  t248 = t88 * t88;
  t249 = 0.1e1 - t248;
  t251 = t247 * t249 * t107;
  t254 = t89 * t33;
  t255 = t81 * t247;
  t256 = t82 * t82;
  t258 = 0.1e1 / t256 / t245;
  t262 = 0.6e1 * t147 * t258 * sigma[2] + 0.144e3;
  t263 = sqrt(t262);
  t264 = 0.1e1 / t263;
  t265 = t264 * t101;
  t266 = t265 * t106;
  t270 = t89 * t90;
  t274 = t245 * rho[1];
  t276 = 0.1e1 / t256 / t274;
  t278 = 0.1e1 / t91;
  t282 = t95 * t247;
  t285 = -t46 * t255 * t92 / 0.9e1 - t167 * sigma[2] * t276 * t278 / 0.18e2 - t51 * t282 / 0.9e1;
  t286 = params->alpha * t285;
  t287 = t286 * t106;
  t289 = t105 * t105;
  t290 = 0.1e1 / t289;
  t291 = t101 * t290;
  t292 = t249 * t90;
  t296 = t103 * t29;
  t297 = t247 * t264;
  t301 = -t187 * t255 * t292 / 0.9e1 - 0.4e1 / 0.3e1 * t296 * t95 * t297;
  t302 = t291 * t301;
  t304 = -t244 * t251 / 0.9e1 - 0.4e1 / 0.3e1 * t254 * t255 * t266 + t270 * t287 - t270 * t302;
  t309 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t109 - t219 - 0.3e1 / 0.8e1 * t5 * t80 * t304);
  tvrho1 = t70 + t113 + t6 * (t234 + t309);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t312 = 0.1e1 / t34;
  t313 = t32 * t312;
  t314 = t132 * t313;
  t316 = t37 * t138 * t64;
  t319 = t312 * t37;
  t330 = t313 * t37;
  t333 = t46 * t319 * t48 / 0.24e2 + t166 * t146 * t150 * t172 / 0.48e2 + t51 * t330 / 0.24e2;
  t334 = params->alpha * t333;
  t335 = t334 * t63;
  t340 = t37 * t156;
  t344 = t187 * t319 * t188 / 0.24e2 + t192 * t313 * t340 / 0.2e1;
  t345 = t185 * t344;
  t347 = t314 * t316 / 0.24e2 + t143 * t319 * t158 / 0.2e1 + t162 * t335 - t162 * t345;
  t351 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t347);
  tvsigma0 = t6 * t351;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t352 = 0.1e1 / t81;
  t353 = t32 * t352;
  t354 = t132 * t353;
  t356 = t84 * t249 * t107;
  t359 = t352 * t84;
  t370 = t353 * t84;
  t373 = t46 * t359 * t92 / 0.24e2 + t166 * t146 * t258 * t278 / 0.48e2 + t51 * t370 / 0.24e2;
  t374 = params->alpha * t373;
  t375 = t374 * t106;
  t380 = t84 * t264;
  t384 = t187 * t359 * t292 / 0.24e2 + t296 * t353 * t380 / 0.2e1;
  t385 = t291 * t384;
  t387 = t354 * t356 / 0.24e2 + t254 * t359 * t266 / 0.2e1 + t270 * t375 - t270 * t385;
  t391 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t387);
  tvsigma2 = t6 * t391;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t394 = t23 * t23;
  t395 = 0.1e1 / t394;
  t396 = t118 * t118;
  t399 = t114 * t6;
  t400 = 0.1e1 / t399;
  t401 = t16 * t400;
  t404 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t115 + 0.2e1 * t401);
  t408 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t395 * t396 + 0.4e1 / 0.3e1 * t23 * t404);
  t409 = t408 * t26;
  t413 = t121 * t127;
  t415 = t5 * t413 * t66;
  t421 = 0.1e1 / t126 / t6;
  t422 = t25 * t421;
  t425 = t5 * t422 * t66 / 0.12e2;
  t427 = t5 * t128 * t200;
  t430 = 0.1e1 / t35 / t168;
  t432 = t430 * t138 * t64;
  t435 = params->mu * t28;
  t436 = t146 * sigma[0];
  t437 = t134 * t134;
  t439 = 0.1e1 / t148 / t437;
  t441 = t435 * t436 * t439;
  t442 = t41 * t138;
  t443 = t442 * t64;
  t446 = t435 * t436;
  t447 = t439 * t138;
  t448 = t447 * t158;
  t451 = t132 * t176;
  t452 = t188 * t181;
  t455 = t188 * t198;
  t458 = t34 * t430;
  t462 = 0.1e1 / t30;
  t463 = t34 * sigma[0];
  t464 = t462 * t463;
  t465 = t42 * t464;
  t466 = t437 * t134;
  t467 = 0.1e1 / t466;
  t469 = 0.1e1 / t155 / t154;
  t470 = t467 * t469;
  t471 = t58 * t63;
  t472 = t470 * t471;
  t476 = t42 * t33 * t34;
  t477 = t193 * t181;
  t480 = t193 * t198;
  t486 = sigma[0] * t439;
  t490 = t44 * t462;
  t491 = t463 * t467;
  t492 = t47 * t47;
  t493 = 0.1e1 / t492;
  t497 = t52 * t430;
  t500 = 0.7e1 / 0.27e2 * t46 * t458 * t48 + 0.5e1 / 0.18e2 * t167 * t486 * t172 - t490 * t491 * t493 / 0.27e2 + 0.7e1 / 0.27e2 * t51 * t497;
  t501 = params->alpha * t500;
  t502 = t501 * t63;
  t504 = t184 * t197;
  t509 = 0.1e1 / t183 / t62;
  t510 = t58 * t509;
  t511 = t197 * t197;
  t512 = t510 * t511;
  t518 = params->beta * t28;
  t519 = t518 * t436;
  t521 = t439 * t41 * t188;
  t524 = t518 * t146;
  t525 = t138 * t156;
  t529 = t430 * t156;
  t533 = t60 * t462;
  t537 = 0.7e1 / 0.27e2 * t187 * t458 * t188 - 0.4e1 / 0.27e2 * t519 * t521 + 0.16e2 / 0.9e1 * t524 * t486 * t525 + 0.28e2 / 0.9e1 * t192 * t52 * t529 - 0.64e2 * t533 * t491 * t469;
  t538 = t185 * t537;
  t540 = 0.7e1 / 0.27e2 * t133 * t432 - 0.4e1 / 0.27e2 * t441 * t443 + 0.16e2 / 0.9e1 * t446 * t448 - 0.2e1 / 0.9e1 * t451 * t452 + 0.2e1 / 0.9e1 * t451 * t455 + 0.28e2 / 0.9e1 * t143 * t458 * t158 - 0.64e2 * t465 * t472 - 0.8e1 / 0.3e1 * t476 * t477 + 0.8e1 / 0.3e1 * t476 * t480 + t162 * t502 - 0.2e1 * t162 * t180 * t504 + 0.2e1 * t162 * t512 - t162 * t538;
  t545 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t409 * t66 - t415 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t122 * t200 + t425 - t427 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t540);
  t546 = t77 * t77;
  t547 = 0.1e1 / t546;
  t548 = t208 * t208;
  t551 = t72 * t400;
  t554 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t115 + 0.2e1 * t551);
  t558 = my_piecewise3(t76, 0, 0.4e1 / 0.9e1 * t547 * t548 + 0.4e1 / 0.3e1 * t77 * t554);
  t559 = t558 * t26;
  t563 = t211 * t127;
  t565 = t5 * t563 * t109;
  t567 = t79 * t421;
  t570 = t5 * t567 * t109 / 0.12e2;
  t572 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t559 * t109 - t565 / 0.4e1 + t570);
  tv2rho20 = 0.2e1 * t205 + 0.2e1 * t221 + t6 * (t545 + t572);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t575 = t395 * t225;
  t579 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t401);
  t583 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t575 * t118 + 0.4e1 / 0.3e1 * t23 * t579);
  t584 = t583 * t26;
  t588 = t228 * t127;
  t590 = t5 * t588 * t66;
  t598 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t584 * t66 - t590 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t200 - t415 / 0.8e1 + t425 - t427 / 0.8e1);
  t599 = t547 * t236;
  t603 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t551);
  t607 = my_piecewise3(t76, 0, 0.4e1 / 0.9e1 * t599 * t208 + 0.4e1 / 0.3e1 * t77 * t603);
  t608 = t607 * t26;
  t612 = t239 * t127;
  t614 = t5 * t612 * t109;
  t621 = t5 * t216 * t304;
  t624 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t608 * t109 - t614 / 0.8e1 - t565 / 0.8e1 + t570 - 0.3e1 / 0.8e1 * t5 * t212 * t304 - t621 / 0.8e1);
  tv2rho21 = t205 + t221 + t234 + t309 + t6 * (t598 + t624);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t629 = t225 * t225;
  t634 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t115 + 0.2e1 * t401);
  t638 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t395 * t629 + 0.4e1 / 0.3e1 * t23 * t634);
  t639 = t638 * t26;
  t645 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t639 * t66 - t590 / 0.4e1 + t425);
  t646 = t236 * t236;
  t651 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t115 + 0.2e1 * t551);
  t655 = my_piecewise3(t76, 0, 0.4e1 / 0.9e1 * t547 * t646 + 0.4e1 / 0.3e1 * t77 * t651);
  t656 = t655 * t26;
  t666 = 0.1e1 / t82 / t274;
  t668 = t666 * t249 * t107;
  t671 = t146 * sigma[2];
  t672 = t245 * t245;
  t674 = 0.1e1 / t256 / t672;
  t676 = t435 * t671 * t674;
  t677 = t88 * t249;
  t678 = t677 * t107;
  t681 = t435 * t671;
  t682 = t674 * t249;
  t683 = t682 * t266;
  t686 = t132 * t282;
  t687 = t292 * t287;
  t690 = t292 * t302;
  t693 = t81 * t666;
  t697 = t81 * sigma[2];
  t698 = t462 * t697;
  t699 = t89 * t698;
  t700 = t672 * t245;
  t701 = 0.1e1 / t700;
  t703 = 0.1e1 / t263 / t262;
  t704 = t701 * t703;
  t705 = t101 * t106;
  t706 = t704 * t705;
  t710 = t89 * t33 * t81;
  t711 = t297 * t287;
  t714 = t297 * t302;
  t720 = sigma[2] * t674;
  t724 = t697 * t701;
  t725 = t91 * t91;
  t726 = 0.1e1 / t725;
  t730 = t95 * t666;
  t733 = 0.7e1 / 0.27e2 * t46 * t693 * t92 + 0.5e1 / 0.18e2 * t167 * t720 * t278 - t490 * t724 * t726 / 0.27e2 + 0.7e1 / 0.27e2 * t51 * t730;
  t734 = params->alpha * t733;
  t735 = t734 * t106;
  t737 = t290 * t301;
  t742 = 0.1e1 / t289 / t105;
  t743 = t101 * t742;
  t744 = t301 * t301;
  t745 = t743 * t744;
  t751 = t518 * t671;
  t753 = t674 * t88 * t292;
  t756 = t249 * t264;
  t760 = t666 * t264;
  t764 = t103 * t462;
  t768 = 0.7e1 / 0.27e2 * t187 * t693 * t292 - 0.4e1 / 0.27e2 * t751 * t753 + 0.16e2 / 0.9e1 * t524 * t720 * t756 + 0.28e2 / 0.9e1 * t296 * t95 * t760 - 0.64e2 * t764 * t724 * t703;
  t769 = t291 * t768;
  t771 = 0.7e1 / 0.27e2 * t244 * t668 - 0.4e1 / 0.27e2 * t676 * t678 + 0.16e2 / 0.9e1 * t681 * t683 - 0.2e1 / 0.9e1 * t686 * t687 + 0.2e1 / 0.9e1 * t686 * t690 + 0.28e2 / 0.9e1 * t254 * t693 * t266 - 0.64e2 * t699 * t706 - 0.8e1 / 0.3e1 * t710 * t711 + 0.8e1 / 0.3e1 * t710 * t714 + t270 * t735 - 0.2e1 * t270 * t286 * t737 + 0.2e1 * t270 * t745 - t270 * t769;
  t776 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t656 * t109 - t614 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t304 + t570 - t621 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t80 * t771);
  tv2rho22 = 0.2e1 * t234 + 0.2e1 * t309 + t6 * (t645 + t776);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t784 = t5 * t128 * t347 / 0.8e1;
  t787 = t146 * t170;
  t788 = t435 * t787;
  t791 = t525 * t471;
  t794 = t132 * t330;
  t799 = t312 * t136;
  t803 = t462 * t34;
  t804 = t42 * t803;
  t805 = t437 * rho[0];
  t806 = 0.1e1 / t805;
  t807 = t806 * t469;
  t808 = t807 * t471;
  t812 = t42 * t33 * t312;
  t813 = t340 * t181;
  t816 = t340 * t198;
  t819 = t188 * t335;
  t822 = t193 * t335;
  t835 = t313 * t136;
  t838 = -t46 * t799 * t48 / 0.18e2 - t166 * t787 * t172 / 0.12e2 + t490 * t806 * t493 * t34 / 0.72e2 - t51 * t835 / 0.18e2;
  t839 = params->alpha * t838;
  t840 = t839 * t63;
  t844 = t188 * t345;
  t847 = t193 * t345;
  t850 = t184 * t344;
  t853 = t344 * t197;
  t861 = t170 * t41 * t188;
  t864 = t170 * t138;
  t875 = -t187 * t799 * t188 / 0.18e2 + t524 * t861 / 0.18e2 - 0.2e1 / 0.3e1 * t524 * t864 * t156 - 0.2e1 / 0.3e1 * t192 * t313 * t193 + 0.24e2 * t533 * t34 * t806 * t469;
  t876 = t185 * t875;
  t878 = -t314 * t140 / 0.18e2 + t788 * t443 / 0.18e2 - 0.2e1 / 0.3e1 * t788 * t791 + t794 * t452 / 0.24e2 - t794 * t455 / 0.24e2 - 0.2e1 / 0.3e1 * t143 * t799 * t158 + 0.24e2 * t804 * t808 + t812 * t813 / 0.2e1 - t812 * t816 / 0.2e1 - t451 * t819 / 0.9e1 - 0.4e1 / 0.3e1 * t476 * t822 + t162 * t840 - t162 * t334 * t504 + t451 * t844 / 0.9e1 + 0.4e1 / 0.3e1 * t476 * t847 - t162 * t180 * t850 + 0.2e1 * t162 * t510 * t853 - t162 * t876;
  t883 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t347 - t784 - 0.3e1 / 0.8e1 * t5 * t27 * t878);
  tv2rhosigma0 = t6 * t883 + t351;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t890 = t5 * t216 * t387 / 0.8e1;
  t892 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t387 - t890);
  tv2rhosigma2 = t6 * t892 + t391;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t898 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t347 - t784);
  tv2rhosigma3 = t6 * t898 + t351;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t905 = t146 * t276;
  t906 = t435 * t905;
  t909 = t756 * t705;
  t912 = t132 * t370;
  t917 = t352 * t247;
  t921 = t462 * t81;
  t922 = t89 * t921;
  t923 = t672 * rho[1];
  t924 = 0.1e1 / t923;
  t925 = t924 * t703;
  t926 = t925 * t705;
  t930 = t89 * t33 * t352;
  t931 = t380 * t287;
  t934 = t380 * t302;
  t937 = t292 * t375;
  t940 = t297 * t375;
  t953 = t353 * t247;
  t956 = -t46 * t917 * t92 / 0.18e2 - t166 * t905 * t278 / 0.12e2 + t490 * t924 * t726 * t81 / 0.72e2 - t51 * t953 / 0.18e2;
  t957 = params->alpha * t956;
  t958 = t957 * t106;
  t962 = t292 * t385;
  t965 = t297 * t385;
  t968 = t290 * t384;
  t971 = t384 * t301;
  t979 = t276 * t88 * t292;
  t982 = t276 * t249;
  t993 = -t187 * t917 * t292 / 0.18e2 + t524 * t979 / 0.18e2 - 0.2e1 / 0.3e1 * t524 * t982 * t264 - 0.2e1 / 0.3e1 * t296 * t353 * t297 + 0.24e2 * t764 * t81 * t924 * t703;
  t994 = t291 * t993;
  t996 = -t354 * t251 / 0.18e2 + t906 * t678 / 0.18e2 - 0.2e1 / 0.3e1 * t906 * t909 + t912 * t687 / 0.24e2 - t912 * t690 / 0.24e2 - 0.2e1 / 0.3e1 * t254 * t917 * t266 + 0.24e2 * t922 * t926 + t930 * t931 / 0.2e1 - t930 * t934 / 0.2e1 - t686 * t937 / 0.9e1 - 0.4e1 / 0.3e1 * t710 * t940 + t270 * t958 - t270 * t374 * t737 + t686 * t962 / 0.9e1 + 0.4e1 / 0.3e1 * t710 * t965 - t270 * t286 * t968 + 0.2e1 * t270 * t743 * t971 - t270 * t994;
  t1001 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t387 - t890 - 0.3e1 / 0.8e1 * t5 * t80 * t996);
  tv2rhosigma5 = t6 * t1001 + t391;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1003 = 0.1e1 / t463;
  t1004 = t32 * t1003;
  t1005 = t132 * t1004;
  t1008 = 0.1e1 / sigma[0];
  t1009 = t146 * t1008;
  t1011 = t435 * t1009 * t150;
  t1014 = t435 * t1009;
  t1016 = t150 * t138 * t158;
  t1023 = t1003 * t37;
  t1027 = t462 * t312;
  t1028 = t42 * t1027;
  t1029 = 0.1e1 / t437;
  t1030 = t1029 * t469;
  t1031 = t1030 * t471;
  t1034 = t340 * t335;
  t1036 = t340 * t345;
  t1041 = t1008 * t150;
  t1049 = t1004 * t37;
  t1052 = -t46 * t1023 * t48 / 0.48e2 + t167 * t1041 * t172 / 0.96e2 - t490 * t1029 * t493 * t312 / 0.192e3 - t51 * t1049 / 0.48e2;
  t1053 = params->alpha * t1052;
  t1054 = t1053 * t63;
  t1059 = t344 * t344;
  t1060 = t510 * t1059;
  t1066 = t518 * t1009;
  t1068 = t150 * t41 * t188;
  t1081 = -t187 * t1023 * t188 / 0.48e2 - t1066 * t1068 / 0.48e2 + t524 * t1041 * t525 / 0.4e1 - t192 * t1004 * t340 / 0.4e1 - 0.9e1 * t533 * t312 * t1029 * t469;
  t1082 = t185 * t1081;
  t1084 = -t1005 * t316 / 0.48e2 - t1011 * t443 / 0.48e2 + t1014 * t1016 / 0.4e1 + t794 * t819 / 0.12e2 - t794 * t844 / 0.12e2 - t143 * t1023 * t158 / 0.4e1 - 0.9e1 * t1028 * t1031 + t812 * t1034 - t812 * t1036 + t162 * t1054 - 0.2e1 * t162 * t334 * t850 + 0.2e1 * t162 * t1060 - t162 * t1082;
  t1088 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1084);
  tv2sigma20 = t6 * t1088;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1089 = 0.1e1 / t697;
  t1090 = t32 * t1089;
  t1091 = t132 * t1090;
  t1094 = 0.1e1 / sigma[2];
  t1095 = t146 * t1094;
  t1097 = t435 * t1095 * t258;
  t1100 = t435 * t1095;
  t1102 = t258 * t249 * t266;
  t1109 = t1089 * t84;
  t1113 = t462 * t352;
  t1114 = t89 * t1113;
  t1115 = 0.1e1 / t672;
  t1116 = t1115 * t703;
  t1117 = t1116 * t705;
  t1120 = t380 * t375;
  t1122 = t380 * t385;
  t1127 = t1094 * t258;
  t1135 = t1090 * t84;
  t1138 = -t46 * t1109 * t92 / 0.48e2 + t167 * t1127 * t278 / 0.96e2 - t490 * t1115 * t726 * t352 / 0.192e3 - t51 * t1135 / 0.48e2;
  t1139 = params->alpha * t1138;
  t1140 = t1139 * t106;
  t1145 = t384 * t384;
  t1146 = t743 * t1145;
  t1152 = t518 * t1095;
  t1154 = t258 * t88 * t292;
  t1167 = -t187 * t1109 * t292 / 0.48e2 - t1152 * t1154 / 0.48e2 + t524 * t1127 * t756 / 0.4e1 - t296 * t1090 * t380 / 0.4e1 - 0.9e1 * t764 * t352 * t1115 * t703;
  t1168 = t291 * t1167;
  t1170 = -t1091 * t356 / 0.48e2 - t1097 * t678 / 0.48e2 + t1100 * t1102 / 0.4e1 + t912 * t937 / 0.12e2 - t912 * t962 / 0.12e2 - t254 * t1109 * t266 / 0.4e1 - 0.9e1 * t1114 * t1117 + t930 * t1120 - t930 * t1122 + t270 * t1140 - 0.2e1 * t270 * t374 * t968 + 0.2e1 * t270 * t1146 - t270 * t1168;
  t1174 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t1170);
  tv2sigma25 = t6 * t1174;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1178 = 0.1e1 / t394 / t19;
  t1179 = t396 * t118;
  t1182 = t395 * t118;
  t1185 = t114 * t114;
  t1186 = 0.1e1 / t1185;
  t1187 = t16 * t1186;
  t1190 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t400 - 0.6e1 * t1187);
  t1194 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1178 * t1179 + 0.4e1 / 0.3e1 * t1182 * t404 + 0.4e1 / 0.3e1 * t23 * t1190);
  t1195 = t1194 * t26;
  t1199 = t408 * t127;
  t1201 = t5 * t1199 * t66;
  t1206 = t121 * t421;
  t1208 = t5 * t1206 * t66;
  t1211 = t5 * t413 * t200;
  t1217 = 0.1e1 / t126 / t114;
  t1218 = t25 * t1217;
  t1221 = 0.5e1 / 0.36e2 * t5 * t1218 * t66;
  t1223 = t5 * t422 * t200;
  t1226 = t5 * t128 * t540;
  t1228 = t183 * t183;
  t1229 = 0.1e1 / t1228;
  t1230 = t58 * t1229;
  t1231 = t511 * t197;
  t1232 = t1230 * t1231;
  t1236 = 0.1e1 / t35 / t437;
  t1237 = t34 * t1236;
  t1242 = 0.1e1 / t148 / t805;
  t1243 = sigma[0] * t1242;
  t1247 = t437 * t168;
  t1248 = 0.1e1 / t1247;
  t1249 = t463 * t1248;
  t1253 = sigma[0] * sigma[0];
  t1254 = t490 * t1253;
  t1255 = t437 * t437;
  t1257 = 0.1e1 / t35 / t1255;
  t1259 = 0.1e1 / t492 / t47;
  t1264 = t52 * t1236;
  t1268 = params->alpha * (-0.7e2 / 0.81e2 * t46 * t1237 * t48 - 0.119e3 / 0.81e2 * t167 * t1243 * t172 + 0.11e2 / 0.27e2 * t490 * t1249 * t493 - 0.2e1 / 0.243e3 * t1254 * t1257 * t1259 * t33 - 0.7e2 / 0.81e2 * t51 * t1264);
  t1269 = t1268 * t63;
  t1275 = t1242 * t41 * t188;
  t1281 = params->beta * t462;
  t1282 = t1281 * t463;
  t1283 = t138 * t138;
  t1288 = t1248 * t137;
  t1292 = t1248 * t41;
  t1297 = 0.1e1 / t31 / t30;
  t1298 = t186 * t1297;
  t1300 = t138 * t469;
  t1304 = t1236 * t156;
  t1311 = t32 * t1253;
  t1312 = t186 * t1311;
  t1313 = t1257 * t138;
  t1314 = t462 * t469;
  t1315 = t1313 * t1314;
  t1318 = t34 * t1253;
  t1319 = t462 * t1318;
  t1320 = t60 * t1319;
  t1321 = t1255 * rho[0];
  t1323 = 0.1e1 / t148 / t1321;
  t1324 = t154 * t154;
  t1326 = 0.1e1 / t155 / t1324;
  t1328 = t1323 * t1326 * t147;
  t1331 = -0.7e2 / 0.81e2 * t187 * t1237 * t188 + 0.28e2 / 0.27e2 * t519 * t1275 - 0.112e3 / 0.9e1 * t524 * t1243 * t525 + 0.8e1 / 0.81e2 * t1282 * t1248 * t1283 * t43 - 0.16e2 / 0.81e2 * t1282 * t1288 * t188 + 0.32e2 / 0.9e1 * t1282 * t1292 * t525 + 0.128e3 / 0.9e1 * t1298 * t1253 * t1257 * t1300 - 0.28e3 / 0.27e2 * t192 * t52 * t1304 + 0.16e4 / 0.3e1 * t533 * t1249 * t469 + 0.64e2 / 0.9e1 * t1312 * t1315 - 0.1536e4 * t1320 * t1328;
  t1332 = t185 * t1331;
  t1334 = t197 * t537;
  t1341 = t184 * t537;
  t1345 = t509 * t511;
  t1349 = params->mu * t462;
  t1350 = t1349 * t1249;
  t1351 = t1283 * t43;
  t1352 = t1351 * t471;
  t1355 = t1248 * t469;
  t1356 = t1355 * t471;
  t1360 = t42 * t1319 * t1323;
  t1361 = t1326 * t58;
  t1363 = t63 * t28 * t146;
  t1364 = t1361 * t1363;
  t1367 = t193 * t502;
  t1370 = t193 * t538;
  t1373 = t193 * t512;
  t1376 = t188 * t512;
  t1379 = t132 * t497;
  t1383 = t435 * t436 * t1242;
  t1388 = t525 * t198;
  t1391 = -0.6e1 * t162 * t1232 + t162 * t1269 - t162 * t1332 + 0.6e1 * t162 * t510 * t1334 - 0.3e1 * t162 * t501 * t504 - 0.3e1 * t162 * t180 * t1341 + 0.6e1 * t162 * t180 * t1345 + 0.8e1 / 0.81e2 * t1350 * t1352 + 0.16e4 / 0.3e1 * t465 * t1356 - 0.1536e4 * t1360 * t1364 - 0.4e1 * t476 * t1367 + 0.4e1 * t476 * t1370 - 0.8e1 * t476 * t1373 - 0.2e1 / 0.3e1 * t451 * t1376 - 0.7e1 / 0.9e1 * t1379 * t455 + 0.28e2 / 0.27e2 * t1383 * t443 + 0.7e1 / 0.9e1 * t1379 * t452 - 0.16e2 / 0.3e1 * t441 * t1388;
  t1392 = t525 * t181;
  t1395 = t188 * t502;
  t1398 = t188 * t538;
  t1401 = t529 * t198;
  t1404 = t529 * t181;
  t1408 = t132 * t1311 * t1257;
  t1409 = t138 * t462;
  t1410 = t469 * t58;
  t1411 = t1410 * t63;
  t1412 = t1409 * t1411;
  t1415 = t193 * params->alpha;
  t1416 = t179 * t184;
  t1417 = t1416 * t197;
  t1418 = t1415 * t1417;
  t1421 = t442 * t43;
  t1422 = t1421 * t181;
  t1425 = t188 * params->alpha;
  t1426 = t1425 * t1417;
  t1429 = t1421 * t198;
  t1433 = t1236 * t138 * t64;
  t1439 = t1242 * t138;
  t1443 = t137 * t138;
  t1444 = t1443 * t64;
  t1447 = t442 * t158;
  t1450 = t1297 * t1253;
  t1451 = t132 * t1450;
  t1455 = t470 * t198;
  t1458 = t470 * t181;
  t1461 = 0.16e2 / 0.3e1 * t441 * t1392 - t451 * t1395 / 0.3e1 + t451 * t1398 / 0.3e1 - 0.28e2 / 0.3e1 * t476 * t1401 + 0.28e2 / 0.3e1 * t476 * t1404 + 0.64e2 / 0.9e1 * t1408 * t1412 + 0.8e1 * t476 * t1418 - 0.4e1 / 0.9e1 * t441 * t1422 + 0.2e1 / 0.3e1 * t451 * t1426 + 0.4e1 / 0.9e1 * t441 * t1429 - 0.7e2 / 0.81e2 * t133 * t1433 - 0.28e3 / 0.27e2 * t143 * t1237 * t158 - 0.112e3 / 0.9e1 * t446 * t1439 * t158 - 0.16e2 / 0.81e2 * t1350 * t1444 + 0.32e2 / 0.9e1 * t1350 * t1447 + 0.128e3 / 0.9e1 * t1451 * t1313 * t1411 + 0.192e3 * t465 * t1455 - 0.192e3 * t465 * t1458;
  t1462 = t1391 + t1461;
  t1467 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1195 * t66 - 0.3e1 / 0.8e1 * t1201 - 0.9e1 / 0.8e1 * t5 * t409 * t200 + t1208 / 0.4e1 - 0.3e1 / 0.4e1 * t1211 - 0.9e1 / 0.8e1 * t5 * t122 * t540 - t1221 + t1223 / 0.4e1 - 0.3e1 / 0.8e1 * t1226 - 0.3e1 / 0.8e1 * t5 * t27 * t1462);
  t1469 = 0.1e1 / t546 / t75;
  t1470 = t548 * t208;
  t1473 = t547 * t208;
  t1476 = t72 * t1186;
  t1479 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t400 - 0.6e1 * t1476);
  t1483 = my_piecewise3(t76, 0, -0.8e1 / 0.27e2 * t1469 * t1470 + 0.4e1 / 0.3e1 * t1473 * t554 + 0.4e1 / 0.3e1 * t77 * t1479);
  t1484 = t1483 * t26;
  t1488 = t558 * t127;
  t1490 = t5 * t1488 * t109;
  t1492 = t211 * t421;
  t1494 = t5 * t1492 * t109;
  t1496 = t79 * t1217;
  t1499 = 0.5e1 / 0.36e2 * t5 * t1496 * t109;
  t1501 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t1484 * t109 - 0.3e1 / 0.8e1 * t1490 + t1494 / 0.4e1 - t1499);
  tv3rho30 = 0.3e1 * t545 + 0.3e1 * t572 + t6 * (t1467 + t1501);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1504 = 0.2e1 * t598;
  t1505 = 0.2e1 * t624;
  t1506 = t1178 * t225;
  t1509 = t395 * t579;
  t1514 = 0.2e1 * t400;
  t1515 = 0.6e1 * t1187;
  t1517 = my_piecewise5(t10, 0, t14, 0, t1514 - t1515);
  t1521 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1506 * t396 + 0.8e1 / 0.9e1 * t1509 * t118 + 0.4e1 / 0.9e1 * t575 * t404 + 0.4e1 / 0.3e1 * t23 * t1517);
  t1522 = t1521 * t26;
  t1526 = t583 * t127;
  t1529 = t5 * t1526 * t66 / 0.4e1;
  t1533 = t228 * t421;
  t1535 = t5 * t1533 * t66;
  t1539 = t5 * t588 * t200 / 0.4e1;
  t1548 = -0.3e1 / 0.8e1 * t5 * t1522 * t66 - t1529 - 0.3e1 / 0.4e1 * t5 * t584 * t200 + t1535 / 0.12e2 - t1539 - 0.3e1 / 0.8e1 * t5 * t229 * t540 - t1201 / 0.8e1 + t1208 / 0.6e1 - t1211 / 0.4e1 - t1221 + t1223 / 0.6e1 - t1226 / 0.8e1;
  t1549 = my_piecewise3(t1, 0, t1548);
  t1550 = t1469 * t236;
  t1553 = t547 * t603;
  t1558 = 0.6e1 * t1476;
  t1560 = my_piecewise5(t14, 0, t10, 0, -t1514 - t1558);
  t1564 = my_piecewise3(t76, 0, -0.8e1 / 0.27e2 * t1550 * t548 + 0.8e1 / 0.9e1 * t1553 * t208 + 0.4e1 / 0.9e1 * t599 * t554 + 0.4e1 / 0.3e1 * t77 * t1560);
  t1565 = t1564 * t26;
  t1569 = t607 * t127;
  t1572 = t5 * t1569 * t109 / 0.4e1;
  t1573 = t239 * t421;
  t1575 = t5 * t1573 * t109;
  t1584 = t5 * t563 * t304 / 0.4e1;
  t1586 = t5 * t567 * t304;
  t1589 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t1565 * t109 - t1572 + t1575 / 0.12e2 - t1490 / 0.8e1 + t1494 / 0.6e1 - t1499 - 0.3e1 / 0.8e1 * t5 * t559 * t304 - t1584 + t1586 / 0.12e2);
  tv3rho31 = t545 + t572 + t1504 + t1505 + t6 * (t1549 + t1589);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1592 = t1178 * t629;
  t1597 = t395 * t634;
  t1601 = my_piecewise5(t10, 0, t14, 0, -t1514 - t1515);
  t1605 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1592 * t118 + 0.8e1 / 0.9e1 * t575 * t579 + 0.4e1 / 0.9e1 * t1597 * t118 + 0.4e1 / 0.3e1 * t23 * t1601);
  t1606 = t1605 * t26;
  t1610 = t638 * t127;
  t1612 = t5 * t1610 * t66;
  t1621 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1606 * t66 - t1612 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t639 * t200 - t1529 + t1535 / 0.6e1 - t1539 + t1208 / 0.12e2 - t1221 + t1223 / 0.12e2);
  t1622 = t1469 * t646;
  t1627 = t547 * t651;
  t1631 = my_piecewise5(t14, 0, t10, 0, t1514 - t1558);
  t1635 = my_piecewise3(t76, 0, -0.8e1 / 0.27e2 * t1622 * t208 + 0.8e1 / 0.9e1 * t599 * t603 + 0.4e1 / 0.9e1 * t1627 * t208 + 0.4e1 / 0.3e1 * t77 * t1631);
  t1636 = t1635 * t26;
  t1640 = t655 * t127;
  t1642 = t5 * t1640 * t109;
  t1649 = t5 * t612 * t304;
  t1657 = t5 * t216 * t771;
  t1659 = -0.3e1 / 0.8e1 * t5 * t1636 * t109 - t1642 / 0.8e1 - t1572 + t1575 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t608 * t304 - t1649 / 0.4e1 + t1494 / 0.12e2 - t1499 - t1584 + t1586 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t212 * t771 - t1657 / 0.8e1;
  t1660 = my_piecewise3(t71, 0, t1659);
  tv3rho32 = t1504 + t1505 + t645 + t776 + t6 * (t1621 + t1660);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1665 = t629 * t225;
  t1672 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t400 - 0.6e1 * t1187);
  t1676 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1178 * t1665 + 0.4e1 / 0.3e1 * t575 * t634 + 0.4e1 / 0.3e1 * t23 * t1672);
  t1677 = t1676 * t26;
  t1684 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1677 * t66 - 0.3e1 / 0.8e1 * t1612 + t1535 / 0.4e1 - t1221);
  t1685 = t646 * t236;
  t1692 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t400 - 0.6e1 * t1476);
  t1696 = my_piecewise3(t76, 0, -0.8e1 / 0.27e2 * t1469 * t1685 + 0.4e1 / 0.3e1 * t599 * t651 + 0.4e1 / 0.3e1 * t77 * t1692);
  t1697 = t1696 * t26;
  t1712 = t289 * t289;
  t1713 = 0.1e1 / t1712;
  t1714 = t101 * t1713;
  t1715 = t744 * t301;
  t1716 = t1714 * t1715;
  t1720 = 0.1e1 / t82 / t672;
  t1721 = t81 * t1720;
  t1726 = 0.1e1 / t256 / t923;
  t1728 = t1726 * t88 * t292;
  t1731 = sigma[2] * t1726;
  t1735 = t1281 * t697;
  t1736 = t672 * t274;
  t1737 = 0.1e1 / t1736;
  t1738 = t249 * t249;
  t1743 = t1737 * t248;
  t1747 = t1737 * t88;
  t1751 = sigma[2] * sigma[2];
  t1752 = t672 * t672;
  t1754 = 0.1e1 / t82 / t1752;
  t1756 = t249 * t703;
  t1760 = t1720 * t264;
  t1764 = t697 * t1737;
  t1768 = t32 * t1751;
  t1769 = t186 * t1768;
  t1770 = t1754 * t249;
  t1771 = t462 * t703;
  t1772 = t1770 * t1771;
  t1775 = t81 * t1751;
  t1776 = t462 * t1775;
  t1777 = t103 * t1776;
  t1778 = t1752 * rho[1];
  t1780 = 0.1e1 / t256 / t1778;
  t1781 = t262 * t262;
  t1783 = 0.1e1 / t263 / t1781;
  t1785 = t1780 * t1783 * t147;
  t1788 = -0.7e2 / 0.81e2 * t187 * t1721 * t292 + 0.28e2 / 0.27e2 * t751 * t1728 - 0.112e3 / 0.9e1 * t524 * t1731 * t756 + 0.8e1 / 0.81e2 * t1735 * t1737 * t1738 * t90 - 0.16e2 / 0.81e2 * t1735 * t1743 * t292 + 0.32e2 / 0.9e1 * t1735 * t1747 * t756 + 0.128e3 / 0.9e1 * t1298 * t1751 * t1754 * t1756 - 0.28e3 / 0.27e2 * t296 * t95 * t1760 + 0.16e4 / 0.3e1 * t764 * t1764 * t703 + 0.64e2 / 0.9e1 * t1769 * t1772 - 0.1536e4 * t1777 * t1785;
  t1789 = t291 * t1788;
  t1800 = t490 * t1751;
  t1802 = 0.1e1 / t725 / t91;
  t1807 = t95 * t1720;
  t1811 = params->alpha * (-0.7e2 / 0.81e2 * t46 * t1721 * t92 - 0.119e3 / 0.81e2 * t167 * t1731 * t278 + 0.11e2 / 0.27e2 * t490 * t1764 * t726 - 0.2e1 / 0.243e3 * t1800 * t1754 * t1802 * t33 - 0.7e2 / 0.81e2 * t51 * t1807);
  t1812 = t1811 * t106;
  t1817 = t290 * t768;
  t1821 = t301 * t768;
  t1825 = t742 * t744;
  t1829 = t1349 * t1764;
  t1830 = t1738 * t90;
  t1831 = t1830 * t705;
  t1834 = t1737 * t703;
  t1835 = t1834 * t705;
  t1839 = t435 * t671 * t1726;
  t1842 = t132 * t730;
  t1845 = t756 * t302;
  t1848 = t756 * t287;
  t1851 = t292 * t735;
  t1854 = t292 * t769;
  t1857 = t760 * t302;
  t1860 = t760 * t287;
  t1864 = t132 * t1768 * t1754;
  t1865 = t249 * t462;
  t1866 = t703 * t101;
  t1867 = t1866 * t106;
  t1868 = t1865 * t1867;
  t1871 = -0.6e1 * t270 * t1716 - t270 * t1789 + t270 * t1812 - 0.3e1 * t270 * t734 * t737 - 0.3e1 * t270 * t286 * t1817 + 0.6e1 * t270 * t743 * t1821 + 0.6e1 * t270 * t286 * t1825 + 0.8e1 / 0.81e2 * t1829 * t1831 + 0.16e4 / 0.3e1 * t699 * t1835 + 0.28e2 / 0.27e2 * t1839 * t678 + 0.7e1 / 0.9e1 * t1842 * t687 - 0.16e2 / 0.3e1 * t676 * t1845 + 0.16e2 / 0.3e1 * t676 * t1848 - t686 * t1851 / 0.3e1 + t686 * t1854 / 0.3e1 - 0.28e2 / 0.3e1 * t710 * t1857 + 0.28e2 / 0.3e1 * t710 * t1860 + 0.64e2 / 0.9e1 * t1864 * t1868;
  t1873 = t89 * t1776 * t1780;
  t1874 = t1783 * t101;
  t1876 = t106 * t28 * t146;
  t1877 = t1874 * t1876;
  t1880 = t297 * t735;
  t1883 = t297 * t769;
  t1886 = t297 * t745;
  t1889 = t292 * t745;
  t1894 = t292 * params->alpha;
  t1895 = t285 * t290;
  t1896 = t1895 * t301;
  t1897 = t1894 * t1896;
  t1900 = t677 * t90;
  t1901 = t1900 * t302;
  t1904 = t1900 * t287;
  t1907 = t297 * params->alpha;
  t1908 = t1907 * t1896;
  t1911 = t1297 * t1751;
  t1912 = t132 * t1911;
  t1916 = t704 * t302;
  t1919 = t704 * t287;
  t1923 = t1720 * t249 * t107;
  t1929 = t1726 * t249;
  t1933 = t248 * t249;
  t1934 = t1933 * t107;
  t1937 = t677 * t266;
  t1940 = -0.1536e4 * t1873 * t1877 - 0.4e1 * t710 * t1880 + 0.4e1 * t710 * t1883 - 0.8e1 * t710 * t1886 - 0.2e1 / 0.3e1 * t686 * t1889 - 0.7e1 / 0.9e1 * t1842 * t690 + 0.2e1 / 0.3e1 * t686 * t1897 + 0.4e1 / 0.9e1 * t676 * t1901 - 0.4e1 / 0.9e1 * t676 * t1904 + 0.8e1 * t710 * t1908 + 0.128e3 / 0.9e1 * t1912 * t1770 * t1867 + 0.192e3 * t699 * t1916 - 0.192e3 * t699 * t1919 - 0.7e2 / 0.81e2 * t244 * t1923 - 0.28e3 / 0.27e2 * t254 * t1721 * t266 - 0.112e3 / 0.9e1 * t681 * t1929 * t266 - 0.16e2 / 0.81e2 * t1829 * t1934 + 0.32e2 / 0.9e1 * t1829 * t1937;
  t1941 = t1871 + t1940;
  t1946 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t1697 * t109 - 0.3e1 / 0.8e1 * t1642 - 0.9e1 / 0.8e1 * t5 * t656 * t304 + t1575 / 0.4e1 - 0.3e1 / 0.4e1 * t1649 - 0.9e1 / 0.8e1 * t5 * t240 * t771 - t1499 + t1586 / 0.4e1 - 0.3e1 / 0.8e1 * t1657 - 0.3e1 / 0.8e1 * t5 * t80 * t1941);
  tv3rho33 = 0.3e1 * t645 + 0.3e1 * t776 + t6 * (t1684 + t1946);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1954 = t5 * t413 * t347;
  t1961 = t5 * t422 * t347 / 0.12e2;
  t1963 = t5 * t128 * t878;
  t1965 = t312 * t430;
  t1969 = t146 * t439;
  t1978 = 0.1e1 / t35 / t1247;
  t1979 = t490 * t1978;
  t1981 = t1259 * sigma[0] * t33;
  t1984 = t313 * t430;
  t1988 = params->alpha * (0.7e1 / 0.54e2 * t46 * t1965 * t48 + 0.37e2 / 0.108e3 * t166 * t1969 * t172 - t490 * t467 * t493 * t34 / 0.8e1 + t1979 * t1981 / 0.324e3 + 0.7e1 / 0.54e2 * t51 * t1984);
  t1989 = t1988 * t63;
  t1991 = t193 * t876;
  t1994 = t529 * t335;
  t1999 = t340 * t512;
  t2005 = t132 * t835;
  t2011 = t435 * t787 * t41;
  t2024 = t162 * t1989 + 0.8e1 / 0.3e1 * t476 * t1991 + 0.28e2 / 0.9e1 * t476 * t1994 - 0.7e1 / 0.27e2 * t1379 * t844 + t812 * t1999 + 0.7e1 / 0.27e2 * t1379 * t819 + t794 * t1376 / 0.12e2 + t2005 * t455 / 0.9e1 - t2005 * t452 / 0.9e1 - t2011 * t455 / 0.9e1 + t2011 * t452 / 0.9e1 + t794 * t1395 / 0.24e2 - t794 * t1398 / 0.24e2 + 0.4e1 / 0.3e1 * t812 * t480 - 0.4e1 / 0.3e1 * t812 * t477;
  t2025 = t32 * sigma[0];
  t2027 = t132 * t2025 * t1978;
  t2031 = 0.1e1 / t148 / t1255;
  t2033 = t42 * t464 * t2031;
  t2036 = t340 * t502;
  t2039 = t340 * t538;
  t2042 = t188 * t840;
  t2045 = t525 * t335;
  t2048 = t193 * t840;
  t2051 = t188 * t876;
  t2054 = t525 * t345;
  t2057 = t529 * t345;
  t2060 = t188 * t58;
  t2061 = t509 * t344;
  t2062 = t2061 * t197;
  t2063 = t2060 * t2062;
  t2066 = t340 * params->alpha;
  t2067 = t2066 * t1417;
  t2071 = t1421 * t345;
  t2074 = t1416 * t344;
  t2075 = t1425 * t2074;
  t2078 = -0.8e1 / 0.3e1 * t2027 * t1412 + 0.576e3 * t2033 * t1364 + t812 * t2036 / 0.2e1 - t812 * t2039 / 0.2e1 - 0.2e1 / 0.9e1 * t451 * t2042 + 0.16e2 / 0.9e1 * t441 * t2045 - 0.8e1 / 0.3e1 * t476 * t2048 + 0.2e1 / 0.9e1 * t451 * t2051 - 0.16e2 / 0.9e1 * t441 * t2054 - 0.28e2 / 0.9e1 * t476 * t2057 - 0.4e1 / 0.9e1 * t451 * t2063 - t812 * t2067 - t794 * t1426 / 0.12e2 + 0.4e1 / 0.27e2 * t441 * t2071 + 0.2e1 / 0.9e1 * t451 * t2075;
  t2080 = t193 * t58;
  t2081 = t2080 * t2062;
  t2084 = t1415 * t2074;
  t2087 = t333 * t184;
  t2088 = t2087 * t197;
  t2089 = t1425 * t2088;
  t2092 = t1421 * t335;
  t2095 = t1415 * t2088;
  t2103 = t435 * t1969;
  t2106 = t467 * t137;
  t2108 = t34 * t138;
  t2109 = t2108 * t64;
  t2112 = t467 * t41;
  t2114 = t2108 * t158;
  t2119 = t1297 * t1978;
  t2120 = t132 * t2119;
  t2122 = t1300 * t471 * sigma[0];
  t2127 = t807 * t198;
  t2130 = t807 * t181;
  t2133 = -0.16e2 / 0.3e1 * t476 * t2081 + 0.8e1 / 0.3e1 * t476 * t2084 + 0.2e1 / 0.9e1 * t451 * t2089 - 0.4e1 / 0.27e2 * t441 * t2092 + 0.8e1 / 0.3e1 * t476 * t2095 + 0.7e1 / 0.54e2 * t314 * t432 + 0.14e2 / 0.9e1 * t143 * t1965 * t158 - 0.5e1 / 0.18e2 * t2103 * t443 + 0.2e1 / 0.27e2 * t1349 * t2106 * t2109 - 0.4e1 / 0.3e1 * t1349 * t2112 * t2114 + 0.4e1 / 0.3e1 * t788 * t1388 - 0.16e2 / 0.3e1 * t2120 * t2122 - 0.4e1 / 0.3e1 * t788 * t1392 - 0.48e2 * t804 * t2127 + 0.48e2 * t804 * t2130;
  t2134 = t470 * t335;
  t2137 = t470 * t345;
  t2148 = t1281 * t467;
  t2150 = t34 * t1283 * t43;
  t2154 = t137 * t34 * t188;
  t2157 = t34 * t156;
  t2158 = t442 * t2157;
  t2161 = t1978 * t138;
  t2162 = t469 * sigma[0];
  t2169 = t34 * t467;
  t2173 = t186 * t2025;
  t2174 = t2161 * t1314;
  t2177 = t60 * t464;
  t2179 = t2031 * t1326 * t147;
  t2182 = 0.7e1 / 0.54e2 * t187 * t1965 * t188 - 0.5e1 / 0.18e2 * t524 * t521 + 0.1e2 / 0.3e1 * t524 * t447 * t156 - t2148 * t2150 / 0.27e2 + 0.2e1 / 0.27e2 * t2148 * t2154 - 0.4e1 / 0.3e1 * t2148 * t2158 - 0.16e2 / 0.3e1 * t1298 * t2161 * t2162 + 0.14e2 / 0.9e1 * t192 * t313 * t529 - 0.152e3 * t533 * t2169 * t469 - 0.8e1 / 0.3e1 * t2173 * t2174 + 0.576e3 * t2177 * t2179;
  t2183 = t185 * t2182;
  t2185 = t184 * t875;
  t2189 = t875 * t197;
  t2193 = t344 * t537;
  t2207 = t344 * t511;
  t2211 = t43 * params->alpha;
  t2212 = t42 * t2211;
  t2213 = t179 * t509;
  t2219 = t1349 * t2169;
  t2224 = -0.64e2 * t465 * t2134 + 0.64e2 * t465 * t2137 - t162 * t2183 - 0.2e1 * t162 * t180 * t2185 + 0.4e1 * t162 * t510 * t2189 + 0.2e1 * t162 * t510 * t2193 - 0.2e1 * t162 * t839 * t504 - t162 * t334 * t1341 - t162 * t501 * t850 + 0.2e1 * t162 * t334 * t1345 - 0.6e1 * t162 * t1230 * t2207 + 0.4e1 * t2212 * t2213 * t853 + 0.1e2 / 0.3e1 * t2103 * t791 - t2219 * t1352 / 0.27e2 - 0.152e3 * t804 * t472;
  t2226 = t2024 + t2078 + t2133 + t2224;
  t2231 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t409 * t347 - t1954 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t122 * t878 + t1961 - t1963 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t2226);
  tv3rho2sigma0 = t6 * t2231 + 0.2e1 * t883;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2238 = t5 * t563 * t387;
  t2242 = t5 * t567 * t387 / 0.12e2;
  t2244 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t559 * t387 - t2238 / 0.4e1 + t2242);
  tv3rho2sigma2 = t6 * t2244 + 0.2e1 * t892;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2250 = t5 * t588 * t347;
  t2258 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t584 * t347 - t2250 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t878 - t1954 / 0.8e1 + t1961 - t1963 / 0.8e1);
  tv3rho2sigma3 = t6 * t2258 + t883 + t898;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2264 = t5 * t612 * t387;
  t2271 = t5 * t216 * t996;
  t2274 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t608 * t387 - t2264 / 0.8e1 - t2238 / 0.8e1 + t2242 - 0.3e1 / 0.8e1 * t5 * t212 * t996 - t2271 / 0.8e1);
  tv3rho2sigma5 = t6 * t2274 + t1001 + t892;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2282 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t639 * t347 - t2250 / 0.4e1 + t1961);
  tv3rho2sigma6 = t6 * t2282 + 0.2e1 * t898;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2293 = t292 * t101;
  t2294 = t742 * t384;
  t2295 = t2294 * t301;
  t2296 = t2293 * t2295;
  t2299 = t1900 * t385;
  t2302 = t1895 * t384;
  t2303 = t1894 * t2302;
  t2306 = t297 * t101;
  t2307 = t2306 * t2295;
  t2310 = t1907 * t2302;
  t2313 = t373 * t290;
  t2314 = t2313 * t301;
  t2315 = t1894 * t2314;
  t2318 = t1900 * t375;
  t2321 = t1907 * t2314;
  t2324 = t380 * params->alpha;
  t2325 = t2324 * t1896;
  t2329 = t352 * t666;
  t2335 = t146 * t674;
  t2336 = t435 * t2335;
  t2339 = t701 * t248;
  t2341 = t81 * t249;
  t2342 = t2341 * t107;
  t2345 = t701 * t88;
  t2347 = t2341 * t266;
  t2350 = -0.4e1 / 0.9e1 * t686 * t2296 + 0.4e1 / 0.27e2 * t676 * t2299 + 0.2e1 / 0.9e1 * t686 * t2303 - 0.16e2 / 0.3e1 * t710 * t2307 + 0.8e1 / 0.3e1 * t710 * t2310 + 0.2e1 / 0.9e1 * t686 * t2315 - 0.4e1 / 0.27e2 * t676 * t2318 + 0.8e1 / 0.3e1 * t710 * t2321 - t930 * t2325 - t912 * t1897 / 0.12e2 + 0.14e2 / 0.9e1 * t254 * t2329 * t266 + 0.7e1 / 0.54e2 * t354 * t668 - 0.5e1 / 0.18e2 * t2336 * t678 + 0.2e1 / 0.27e2 * t1349 * t2339 * t2342 - 0.4e1 / 0.3e1 * t1349 * t2345 * t2347;
  t2354 = 0.1e1 / t82 / t1736;
  t2355 = t1297 * t2354;
  t2356 = t132 * t2355;
  t2358 = t1756 * t705 * sigma[2];
  t2363 = t925 * t302;
  t2366 = t925 * t287;
  t2369 = t704 * t375;
  t2372 = t704 * t385;
  t2385 = t490 * t2354;
  t2387 = t1802 * sigma[2] * t33;
  t2390 = t353 * t666;
  t2394 = params->alpha * (0.7e1 / 0.54e2 * t46 * t2329 * t92 + 0.37e2 / 0.108e3 * t166 * t2335 * t278 - t490 * t701 * t726 * t81 / 0.8e1 + t2385 * t2387 / 0.324e3 + 0.7e1 / 0.54e2 * t51 * t2390);
  t2395 = t2394 * t106;
  t2405 = t1281 * t701;
  t2407 = t81 * t1738 * t90;
  t2411 = t248 * t81 * t292;
  t2414 = t81 * t264;
  t2415 = t677 * t2414;
  t2418 = t2354 * t249;
  t2419 = t703 * sigma[2];
  t2426 = t81 * t701;
  t2430 = t32 * sigma[2];
  t2431 = t186 * t2430;
  t2432 = t2418 * t1771;
  t2435 = t103 * t698;
  t2437 = 0.1e1 / t256 / t1752;
  t2439 = t2437 * t1783 * t147;
  t2442 = 0.7e1 / 0.54e2 * t187 * t2329 * t292 - 0.5e1 / 0.18e2 * t524 * t753 + 0.1e2 / 0.3e1 * t524 * t682 * t264 - t2405 * t2407 / 0.27e2 + 0.2e1 / 0.27e2 * t2405 * t2411 - 0.4e1 / 0.3e1 * t2405 * t2415 - 0.16e2 / 0.3e1 * t1298 * t2418 * t2419 + 0.14e2 / 0.9e1 * t296 * t353 * t760 - 0.152e3 * t764 * t2426 * t703 - 0.8e1 / 0.3e1 * t2431 * t2432 + 0.576e3 * t2435 * t2439;
  t2443 = t291 * t2442;
  t2449 = t290 * t993;
  t2456 = t384 * t744;
  t2463 = 0.4e1 / 0.3e1 * t906 * t1845 - 0.16e2 / 0.3e1 * t2356 * t2358 - 0.4e1 / 0.3e1 * t906 * t1848 - 0.48e2 * t922 * t2363 + 0.48e2 * t922 * t2366 - 0.64e2 * t699 * t2369 + 0.64e2 * t699 * t2372 + t270 * t2395 - t270 * t2443 - t270 * t374 * t1817 - t270 * t734 * t968 - 0.2e1 * t270 * t286 * t2449 - 0.2e1 * t270 * t957 * t737 - 0.6e1 * t270 * t1714 * t2456 + 0.2e1 * t270 * t374 * t1825;
  t2465 = t993 * t301;
  t2469 = t384 * t768;
  t2473 = t132 * t953;
  t2477 = t435 * t905 * t88;
  t2491 = t132 * t2430 * t2354;
  t2495 = t89 * t698 * t2437;
  t2498 = t380 * t735;
  t2501 = t380 * t769;
  t2504 = t292 * t958;
  t2507 = t756 * t375;
  t2510 = 0.4e1 * t270 * t743 * t2465 + 0.2e1 * t270 * t743 * t2469 - t2473 * t687 / 0.9e1 - t2477 * t690 / 0.9e1 + t2477 * t687 / 0.9e1 + t912 * t1851 / 0.24e2 - t912 * t1854 / 0.24e2 + 0.4e1 / 0.3e1 * t930 * t714 - 0.4e1 / 0.3e1 * t930 * t711 - 0.8e1 / 0.3e1 * t2491 * t1868 + 0.576e3 * t2495 * t1877 + t930 * t2498 / 0.2e1 - t930 * t2501 / 0.2e1 - 0.2e1 / 0.9e1 * t686 * t2504 + 0.16e2 / 0.9e1 * t676 * t2507;
  t2511 = t297 * t958;
  t2516 = t292 * t994;
  t2519 = t756 * t385;
  t2522 = t297 * t994;
  t2527 = t760 * t385;
  t2530 = t380 * t745;
  t2534 = t760 * t375;
  t2539 = t90 * params->alpha;
  t2540 = t89 * t2539;
  t2541 = t285 * t742;
  t2547 = t1349 * t2426;
  t2552 = -0.8e1 / 0.3e1 * t710 * t2511 + t2473 * t690 / 0.9e1 + 0.2e1 / 0.9e1 * t686 * t2516 - 0.16e2 / 0.9e1 * t676 * t2519 + 0.8e1 / 0.3e1 * t710 * t2522 - 0.7e1 / 0.27e2 * t1842 * t962 - 0.28e2 / 0.9e1 * t710 * t2527 + t930 * t2530 + 0.7e1 / 0.27e2 * t1842 * t937 + 0.28e2 / 0.9e1 * t710 * t2534 + t912 * t1889 / 0.12e2 + 0.4e1 * t2540 * t2541 * t971 + 0.1e2 / 0.3e1 * t2336 * t909 - t2547 * t1831 / 0.27e2 - 0.152e3 * t922 * t706;
  t2554 = t2350 + t2463 + t2510 + t2552;
  t2559 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t656 * t387 - t2264 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t996 + t2242 - t2271 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t80 * t2554);
  tv3rho2sigma8 = t6 * t2559 + 0.2e1 * t1001;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2566 = t5 * t128 * t1084 / 0.8e1;
  t2567 = t312 * t806;
  t2568 = t1349 * t2567;
  t2572 = 0.1e1 / t35 / t466;
  t2574 = t132 * t1297 * t2572;
  t2575 = t1300 * t471;
  t2580 = t333 * t509;
  t2584 = t2066 * t2088;
  t2586 = t340 * t58;
  t2587 = t2586 * t2062;
  t2590 = t2066 * t2074;
  t2592 = t2087 * t344;
  t2593 = t1425 * t2592;
  t2596 = t1415 * t2592;
  t2609 = t1030 * t181;
  t2612 = t2568 * t1352 / 0.72e2 + 0.2e1 * t2574 * t2575 + 0.24e2 * t1028 * t808 + 0.4e1 * t2212 * t2580 * t853 - t812 * t2584 + 0.2e1 * t812 * t2587 - t812 * t2590 + 0.2e1 / 0.9e1 * t451 * t2593 + 0.8e1 / 0.3e1 * t476 * t2596 - t794 * t2089 / 0.12e2 + t794 * t2063 / 0.6e1 - t794 * t2075 / 0.12e2 + t1011 * t1429 / 0.48e2 - t1011 * t1422 / 0.48e2 - 0.9e1 * t1028 * t2609;
  t2613 = t807 * t335;
  t2616 = t807 * t345;
  t2619 = t1003 * t136;
  t2625 = t864 * t158;
  t2636 = t1030 * t198;
  t2639 = t32 * t2572;
  t2647 = t1008 * t170;
  t2651 = t1281 * t312;
  t2664 = t2572 * t138;
  t2674 = t2664 * t1314;
  t2676 = t60 * t803;
  t2678 = 0.1e1 / t148 / t1247;
  t2680 = t2678 * t1326 * t147;
  t2683 = t187 * t2619 * t188 / 0.36e2 + t1066 * t861 / 0.36e2 - t524 * t2647 * t525 / 0.3e1 + t2651 * t806 * t1283 * t43 / 0.72e2 - t2651 * t806 * t137 * t188 / 0.36e2 + t2651 * t806 * t41 * t525 / 0.2e1 + 0.2e1 * t1298 * t2664 * t469 + t192 * t1004 * t193 / 0.3e1 + 0.24e2 * t533 * t2567 * t469 + t187 * t2674 - 0.216e3 * t2676 * t2680;
  t2684 = t185 * t2683;
  t2695 = t490 * t2572;
  t2697 = t1259 * t29 * t32;
  t2700 = t1004 * t136;
  t2704 = params->alpha * (t46 * t2619 * t48 / 0.36e2 - t167 * t2647 * t172 / 0.72e2 + t490 * t2567 * t493 / 0.36e2 - t2695 * t2697 / 0.864e3 + t51 * t2700 / 0.36e2);
  t2705 = t2704 * t63;
  t2707 = t509 * t1059;
  t2711 = t1081 * t197;
  t2715 = 0.48e2 * t804 * t2613 - 0.48e2 * t804 * t2616 + t143 * t2619 * t158 / 0.3e1 + t1005 * t140 / 0.36e2 - t1014 * t2625 / 0.3e1 - t2568 * t1444 / 0.36e2 + t2568 * t1447 / 0.2e1 - 0.4e1 / 0.3e1 * t788 * t2045 + 0.4e1 / 0.3e1 * t788 * t2054 + 0.9e1 * t1028 * t2636 + t132 * t2639 * t1412 - t162 * t2684 + t162 * t2705 + 0.2e1 * t162 * t180 * t2707 + 0.2e1 * t162 * t510 * t2711;
  t2725 = t1059 * t197;
  t2729 = t344 * t875;
  t2733 = t184 * t1081;
  t2741 = t42 * t33 * t1003;
  t2747 = t42 * t803 * t2678;
  t2750 = t340 * t840;
  t2752 = t340 * t876;
  t2754 = t188 * t1054;
  t2759 = -t162 * t1053 * t504 - 0.2e1 * t162 * t839 * t850 - 0.2e1 * t162 * t334 * t2185 - 0.6e1 * t162 * t1230 * t2725 + 0.4e1 * t162 * t510 * t2729 - t162 * t180 * t2733 - t794 * t2051 / 0.12e2 - t2011 * t844 / 0.9e1 + t2741 * t816 / 0.4e1 - t2741 * t813 / 0.4e1 - 0.216e3 * t2747 * t1364 + t812 * t2750 - t812 * t2752 - t451 * t2754 / 0.9e1 - t1011 * t1388 / 0.4e1;
  t2766 = t132 * t1049;
  t2770 = t435 * t1009 * t170;
  t2783 = t193 * t1054;
  t2786 = t188 * t1060;
  t2789 = t193 * t1060;
  t2792 = t188 * t1082;
  t2795 = t193 * t1082;
  t2798 = t1011 * t1392 / 0.4e1 + t794 * t2042 / 0.12e2 + t2011 * t819 / 0.9e1 + t2766 * t455 / 0.48e2 + t2770 * t443 / 0.36e2 - t2766 * t452 / 0.48e2 + 0.4e1 / 0.3e1 * t812 * t847 - t2005 * t819 / 0.9e1 + t2005 * t844 / 0.9e1 - 0.4e1 / 0.3e1 * t812 * t822 - 0.4e1 / 0.3e1 * t476 * t2783 - 0.2e1 / 0.9e1 * t451 * t2786 - 0.8e1 / 0.3e1 * t476 * t2789 + t451 * t2792 / 0.9e1 + 0.4e1 / 0.3e1 * t476 * t2795;
  t2800 = t2612 + t2715 + t2759 + t2798;
  t2805 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t1084 - t2566 - 0.3e1 / 0.8e1 * t5 * t27 * t2800);
  tv3rhosigma20 = t6 * t2805 + t1088;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2812 = t5 * t216 * t1170 / 0.8e1;
  t2814 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t1170 - t2812);
  tv3rhosigma25 = t6 * t2814 + t1174;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2820 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t1084 - t2566);
  tv3rhosigma26 = t6 * t2820 + t1088;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2825 = t1089 * t247;
  t2831 = t1094 * t276;
  t2835 = t1281 * t352;
  t2849 = 0.1e1 / t82 / t700;
  t2850 = t2849 * t249;
  t2857 = t352 * t924;
  t2861 = t2850 * t1771;
  t2863 = t103 * t921;
  t2865 = 0.1e1 / t256 / t1736;
  t2867 = t2865 * t1783 * t147;
  t2870 = t187 * t2825 * t292 / 0.36e2 + t1152 * t979 / 0.36e2 - t524 * t2831 * t756 / 0.3e1 + t2835 * t924 * t1738 * t90 / 0.72e2 - t2835 * t924 * t248 * t292 / 0.36e2 + t2835 * t924 * t88 * t756 / 0.2e1 + 0.2e1 * t1298 * t2850 * t703 + t296 * t1090 * t297 / 0.3e1 + 0.24e2 * t764 * t2857 * t703 + t187 * t2861 - 0.216e3 * t2863 * t2867;
  t2871 = t291 * t2870;
  t2882 = t490 * t2849;
  t2884 = t1802 * t29 * t32;
  t2887 = t1090 * t247;
  t2891 = params->alpha * (t46 * t2825 * t92 / 0.36e2 - t167 * t2831 * t278 / 0.72e2 + t490 * t2857 * t726 / 0.36e2 - t2882 * t2884 / 0.864e3 + t51 * t2887 / 0.36e2);
  t2892 = t2891 * t106;
  t2894 = t290 * t1167;
  t2899 = t1145 * t301;
  t2903 = t384 * t993;
  t2907 = t742 * t1145;
  t2911 = t1167 * t301;
  t2921 = t1349 * t2857;
  t2925 = t132 * t1297 * t2849;
  t2926 = t1756 * t705;
  t2931 = t373 * t742;
  t2937 = -t270 * t2871 + t270 * t2892 - t270 * t286 * t2894 - t270 * t1139 * t737 - 0.6e1 * t270 * t1714 * t2899 + 0.4e1 * t270 * t743 * t2903 + 0.2e1 * t270 * t286 * t2907 + 0.2e1 * t270 * t743 * t2911 - 0.2e1 * t270 * t957 * t968 - 0.2e1 * t270 * t374 * t2449 + t2921 * t1831 / 0.72e2 + 0.2e1 * t2925 * t2926 + 0.24e2 * t1114 * t926 + 0.4e1 * t2540 * t2931 * t971 - t912 * t2303 / 0.12e2;
  t2938 = t2324 * t2314;
  t2940 = t380 * t101;
  t2941 = t2940 * t2295;
  t2944 = t2324 * t2302;
  t2952 = t2313 * t384;
  t2953 = t1894 * t2952;
  t2956 = t1907 * t2952;
  t2961 = t1116 * t302;
  t2964 = t32 * t2849;
  t2967 = t1116 * t287;
  t2970 = t925 * t375;
  t2973 = t925 * t385;
  t2976 = t982 * t266;
  t2979 = -t930 * t2938 + 0.2e1 * t930 * t2941 - t930 * t2944 + t1097 * t1901 / 0.48e2 - t1097 * t1904 / 0.48e2 - t912 * t2315 / 0.12e2 + 0.2e1 / 0.9e1 * t686 * t2953 + 0.8e1 / 0.3e1 * t710 * t2956 + t912 * t2296 / 0.6e1 + 0.9e1 * t1114 * t2961 + t132 * t2964 * t1868 - 0.9e1 * t1114 * t2967 + 0.48e2 * t922 * t2970 - 0.48e2 * t922 * t2973 - t1100 * t2976 / 0.3e1;
  t2994 = t297 * t1140;
  t2997 = t292 * t1146;
  t3000 = t297 * t1146;
  t3003 = t292 * t1168;
  t3006 = t297 * t1168;
  t3017 = -t2921 * t1934 / 0.36e2 + t2921 * t1937 / 0.2e1 - 0.4e1 / 0.3e1 * t906 * t2507 + 0.4e1 / 0.3e1 * t906 * t2519 + t254 * t2825 * t266 / 0.3e1 + t1091 * t251 / 0.36e2 - 0.4e1 / 0.3e1 * t710 * t2994 - 0.2e1 / 0.9e1 * t686 * t2997 - 0.8e1 / 0.3e1 * t710 * t3000 + t686 * t3003 / 0.9e1 + 0.4e1 / 0.3e1 * t710 * t3006 - t1097 * t1845 / 0.4e1 + t1097 * t1848 / 0.4e1 + t912 * t2504 / 0.12e2 + t2477 * t937 / 0.9e1;
  t3023 = t89 * t33 * t1089;
  t3026 = t132 * t1135;
  t3030 = t435 * t1095 * t276;
  t3046 = t89 * t921 * t2865;
  t3049 = t380 * t958;
  t3051 = t380 * t994;
  t3053 = t292 * t1140;
  t3056 = -t912 * t2516 / 0.12e2 - t2477 * t962 / 0.9e1 + t3023 * t934 / 0.4e1 + t3026 * t690 / 0.48e2 + t3030 * t678 / 0.36e2 - t3026 * t687 / 0.48e2 + t2473 * t962 / 0.9e1 - 0.4e1 / 0.3e1 * t930 * t940 + 0.4e1 / 0.3e1 * t930 * t965 - t2473 * t937 / 0.9e1 - t3023 * t931 / 0.4e1 - 0.216e3 * t3046 * t1877 + t930 * t3049 - t930 * t3051 - t686 * t3053 / 0.9e1;
  t3058 = t2937 + t2979 + t3017 + t3056;
  t3063 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t1170 - t2812 - 0.3e1 / 0.8e1 * t5 * t80 * t3058);
  tv3rhosigma211 = t6 * t3063 + t1174;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t3065 = 0.1e1 / t1318;
  t3066 = t3065 * t37;
  t3070 = 0.1e1 / t1253;
  t3071 = t146 * t3070;
  t3072 = t518 * t3071;
  t3075 = t3070 * t150;
  t3079 = t1281 * t1003;
  t3081 = t1029 * t1283 * t43;
  t3085 = t1029 * t137 * t188;
  t3089 = t1029 * t41 * t525;
  t3093 = 0.1e1 / t35 / t805;
  t3098 = t32 * t3065;
  t3102 = t1003 * t1029;
  t3106 = t32 * t1008;
  t3107 = t186 * t3106;
  t3108 = t3093 * t138;
  t3109 = t3108 * t1314;
  t3112 = t60 * t1027;
  t3114 = 0.1e1 / t148 / t466;
  t3116 = t3114 * t1326 * t147;
  t3119 = t187 * t3066 * t188 / 0.32e2 + t3072 * t1068 / 0.32e2 - 0.3e1 / 0.8e1 * t524 * t3075 * t525 - t3079 * t3081 / 0.192e3 + t3079 * t3085 / 0.96e2 - 0.3e1 / 0.16e2 * t3079 * t3089 - 0.3e1 / 0.4e1 * t1298 * t1008 * t3093 * t1300 + 0.3e1 / 0.8e1 * t192 * t3098 * t340 + 0.9e1 * t533 * t3102 * t469 - 0.3e1 / 0.8e1 * t3107 * t3109 + 0.81e2 * t3112 * t3116;
  t3120 = t185 * t3119;
  t3128 = t490 * t3093;
  t3130 = t1259 * t1008 * t33;
  t3133 = t3098 * t37;
  t3137 = params->alpha * (t46 * t3066 * t48 / 0.32e2 - t167 * t3075 * t172 / 0.64e2 + t3128 * t3130 / 0.2304e4 + t51 * t3133 / 0.32e2);
  t3138 = t3137 * t63;
  t3140 = t1059 * t344;
  t3141 = t1230 * t3140;
  t3153 = t344 * t1081;
  t3157 = t1349 * t3102;
  t3160 = t462 * t1003;
  t3161 = t42 * t3160;
  t3164 = t2066 * t2592;
  t3173 = t1030 * t335;
  t3176 = t435 * t3071;
  t3183 = t1297 * t1008;
  t3184 = t132 * t3183;
  t3185 = t3108 * t1411;
  t3188 = -t162 * t3120 + t162 * t3138 - 0.6e1 * t162 * t3141 + 0.6e1 * t162 * t334 * t2707 - 0.3e1 * t162 * t1053 * t850 - 0.3e1 * t162 * t334 * t2733 + 0.6e1 * t162 * t510 * t3153 - t3157 * t1352 / 0.192e3 + 0.9e1 * t3161 * t1031 - 0.3e1 * t812 * t3164 - t1011 * t2092 / 0.16e2 - t794 * t2593 / 0.4e1 + t1011 * t2071 / 0.16e2 - 0.27e2 * t1028 * t3173 - 0.3e1 / 0.8e1 * t3176 * t1016 + t3157 * t1444 / 0.96e2 - 0.3e1 / 0.16e2 * t3157 * t1447 - 0.3e1 / 0.4e1 * t3184 * t3185;
  t3189 = t1030 * t345;
  t3195 = t132 * t3098;
  t3199 = t42 * t1027 * t3114;
  t3202 = t340 * t1054;
  t3205 = t340 * t1082;
  t3219 = t132 * t3106 * t3093;
  t3225 = t435 * t3071 * t150;
  t3232 = t340 * t1060;
  t3237 = 0.27e2 * t1028 * t3189 + 0.3e1 / 0.8e1 * t143 * t3066 * t158 + t3195 * t316 / 0.32e2 + 0.81e2 * t3199 * t1364 + 0.3e1 / 0.2e1 * t812 * t3202 - 0.3e1 / 0.2e1 * t812 * t3205 + 0.3e1 / 0.4e1 * t1011 * t2045 + t794 * t2754 / 0.8e1 - t794 * t2792 / 0.8e1 + 0.3e1 / 0.4e1 * t2741 * t1036 - 0.3e1 / 0.4e1 * t2741 * t1034 - 0.3e1 / 0.8e1 * t3219 * t1412 + t2766 * t844 / 0.16e2 + t3225 * t443 / 0.32e2 - t2766 * t819 / 0.16e2 - 0.3e1 / 0.4e1 * t1011 * t2054 + 0.3e1 * t812 * t3232 + t794 * t2786 / 0.4e1;
  t3238 = t3188 + t3237;
  t3242 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t3238);
  tv3sigma30 = t6 * t3242;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t3246 = 0.1e1 / t1775;
  t3247 = t3246 * t84;
  t3251 = 0.1e1 / t1751;
  t3252 = t3251 * t258;
  t3257 = 0.1e1 / t82 / t923;
  t3258 = t490 * t3257;
  t3260 = t1802 * t1094 * t33;
  t3263 = t32 * t3246;
  t3264 = t3263 * t84;
  t3268 = params->alpha * (t46 * t3247 * t92 / 0.32e2 - t167 * t3252 * t278 / 0.64e2 + t3258 * t3260 / 0.2304e4 + t51 * t3264 / 0.32e2);
  t3269 = t3268 * t106;
  t3274 = t146 * t3251;
  t3275 = t518 * t3274;
  t3281 = t1281 * t1089;
  t3283 = t1115 * t1738 * t90;
  t3287 = t1115 * t248 * t292;
  t3291 = t1115 * t88 * t756;
  t3301 = t1089 * t1115;
  t3305 = t32 * t1094;
  t3306 = t186 * t3305;
  t3307 = t3257 * t249;
  t3308 = t3307 * t1771;
  t3311 = t103 * t1113;
  t3313 = 0.1e1 / t256 / t700;
  t3315 = t3313 * t1783 * t147;
  t3318 = t187 * t3247 * t292 / 0.32e2 + t3275 * t1154 / 0.32e2 - 0.3e1 / 0.8e1 * t524 * t3252 * t756 - t3281 * t3283 / 0.192e3 + t3281 * t3287 / 0.96e2 - 0.3e1 / 0.16e2 * t3281 * t3291 - 0.3e1 / 0.4e1 * t1298 * t1094 * t3257 * t1756 + 0.3e1 / 0.8e1 * t296 * t3263 * t380 + 0.9e1 * t764 * t3301 * t703 - 0.3e1 / 0.8e1 * t3306 * t3308 + 0.81e2 * t3311 * t3315;
  t3319 = t291 * t3318;
  t3321 = t1145 * t384;
  t3322 = t1714 * t3321;
  t3331 = t384 * t1167;
  t3335 = t1349 * t3301;
  t3338 = t462 * t1089;
  t3339 = t89 * t3338;
  t3342 = t2324 * t2952;
  t3354 = t132 * t3263;
  t3357 = t1116 * t375;
  t3360 = t435 * t3274;
  t3365 = 0.6e1 * t270 * t374 * t2907 + t270 * t3269 - t270 * t3319 - 0.6e1 * t270 * t3322 - 0.3e1 * t270 * t1139 * t968 - 0.3e1 * t270 * t374 * t2894 + 0.6e1 * t270 * t743 * t3331 - t3335 * t1831 / 0.192e3 + 0.9e1 * t3339 * t1117 - 0.3e1 * t930 * t3342 + t1097 * t2299 / 0.16e2 - t1097 * t2318 / 0.16e2 - t912 * t2953 / 0.4e1 + 0.3e1 / 0.8e1 * t254 * t3247 * t266 + t3354 * t356 / 0.32e2 - 0.27e2 * t1114 * t3357 - 0.3e1 / 0.8e1 * t3360 * t1102 + t3335 * t1934 / 0.96e2;
  t3368 = t1297 * t1094;
  t3369 = t132 * t3368;
  t3370 = t3307 * t1867;
  t3373 = t1116 * t385;
  t3376 = t380 * t1168;
  t3386 = t132 * t3305 * t3257;
  t3390 = t89 * t1113 * t3313;
  t3393 = t380 * t1140;
  t3397 = t435 * t3274 * t258;
  t3410 = t380 * t1146;
  t3415 = -0.3e1 / 0.16e2 * t3335 * t1937 - 0.3e1 / 0.4e1 * t3369 * t3370 + 0.27e2 * t1114 * t3373 - 0.3e1 / 0.2e1 * t930 * t3376 - t912 * t3003 / 0.8e1 + 0.3e1 / 0.4e1 * t3023 * t1122 - 0.3e1 / 0.4e1 * t3023 * t1120 - 0.3e1 / 0.8e1 * t3386 * t1868 + 0.81e2 * t3390 * t1877 + 0.3e1 / 0.2e1 * t930 * t3393 + t3397 * t678 / 0.32e2 - t3026 * t937 / 0.16e2 - 0.3e1 / 0.4e1 * t1097 * t2519 + 0.3e1 / 0.4e1 * t1097 * t2507 + t912 * t3053 / 0.8e1 + t3026 * t962 / 0.16e2 + 0.3e1 * t930 * t3410 + t912 * t2997 / 0.4e1;
  t3416 = t3365 + t3415;
  t3420 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * t3416);
  tv3sigma39 = t6 * t3420;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t3423 = t19 * t19;
  t3425 = 0.1e1 / t394 / t3423;
  t3426 = t396 * t396;
  t3432 = t404 * t404;
  t3438 = 0.1e1 / t1185 / t6;
  t3439 = t16 * t3438;
  t3442 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t1186 + 0.24e2 * t3439);
  t3446 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3425 * t3426 - 0.16e2 / 0.9e1 * t1178 * t396 * t404 + 0.4e1 / 0.3e1 * t395 * t3432 + 0.16e2 / 0.9e1 * t1182 * t1190 + 0.4e1 / 0.3e1 * t23 * t3442);
  t3455 = t5 * t1199 * t200;
  t3461 = t5 * t1206 * t200;
  t3463 = t5 * t413 * t540;
  t3469 = t5 * t1218 * t200;
  t3472 = t5 * t422 * t540;
  t3475 = t5 * t128 * t1462;
  t3477 = t435 * t146;
  t3479 = t3477 * t486 * t41;
  t3482 = 0.1e1 / t1255;
  t3483 = t463 * t3482;
  t3484 = t1349 * t3483;
  t3494 = t30 * t30;
  t3495 = 0.1e1 / t3494;
  t3496 = params->mu * t3495;
  t3497 = t1253 * sigma[0];
  t3498 = t1255 * t437;
  t3499 = 0.1e1 / t3498;
  t3502 = t138 * t1326;
  t3503 = t3502 * t471;
  t3508 = t58 / t1228 / t62;
  t3509 = t511 * t511;
  t3513 = t537 * t537;
  t3517 = t34 * t3497;
  t3518 = t462 * t3517;
  t3522 = 0.1e1 / t35 / t1255 / t805;
  t3525 = 0.1e1 / t155 / t1324 / t154;
  t3527 = t29 * t1297;
  t3532 = 0.1e1 / t145 / t30;
  t3533 = t3532 * t1318;
  t3535 = t1255 * t134;
  t3537 = 0.1e1 / t148 / t3535;
  t3547 = 0.1e1 / t35 / t1321;
  t3548 = t3547 * t138;
  t3556 = t1253 * t3547;
  t3557 = t1281 * t3556;
  t3559 = t41 * t29 * t32;
  t3560 = t1351 * t3559;
  t3563 = t137 * t41;
  t3565 = t32 * t138;
  t3566 = t3565 * t43;
  t3567 = t3563 * t29 * t3566;
  t3570 = t33 * t156;
  t3571 = t1443 * t3570;
  t3577 = t469 * t28 * t146;
  t3578 = t442 * t3577;
  t3585 = params->beta * t3495;
  t3594 = sigma[0] * t3114;
  t3609 = t34 * t3093;
  t3613 = t3114 * t41;
  t3618 = t32 * t156;
  t3619 = t1283 * t29 * t3618;
  t3622 = -0.6144e5 * t60 * t3518 * t3522 * t3525 * t3527 + 0.512e3 / 0.27e2 * t518 * t3533 * t3537 * t41 * t1300 + 0.364e4 / 0.81e2 * t192 * t52 * t3093 * t156 - 0.32e4 / 0.27e2 * t1312 * t3548 * t1314 + 0.27648e5 * t1320 * t3537 * t1326 * t147 + 0.64e2 / 0.729e3 * t3557 * t3560 - 0.32e2 / 0.729e3 * t3557 * t3567 + 0.256e3 / 0.243e3 * t3557 * t3571 + 0.1024e4 / 0.27e2 * t1281 * t1318 * t3537 * t3578 - 0.112e3 / 0.81e2 * t1282 * t3482 * t1283 * t43 + 0.4096e4 * t3585 * t3497 * t3499 * t138 * t1326 - 0.3808e5 / 0.9e1 * t533 * t3483 * t469 + 0.6832e4 / 0.81e2 * t524 * t3594 * t525 + 0.224e3 / 0.81e2 * t1282 * t3482 * t137 * t188 - 0.448e3 / 0.9e1 * t1282 * t3482 * t41 * t525 - 0.5888e4 / 0.27e2 * t1298 * t3556 * t1300 + 0.91e3 / 0.243e3 * t187 * t3609 * t188 - 0.1708e4 / 0.243e3 * t519 * t3613 * t188 - 0.128e3 / 0.243e3 * t3557 * t3619;
  t3639 = t492 * t492;
  t3640 = 0.1e1 / t3639;
  t3652 = t184 * t1331;
  t3664 = t1229 * t1231;
  t3674 = t529 * params->alpha;
  t3679 = t509 * t197 * t537;
  t3680 = t2060 * t3679;
  t3683 = t1421 * t512;
  t3686 = t1421 * t538;
  t3692 = 0.12e2 * t162 * t501 * t1345 - 0.36e2 * t162 * t1230 * t511 * t537 - 0.24e2 * t162 * t180 * t3664 + 0.112e3 / 0.27e2 * t1383 * t1422 - 0.28e2 / 0.9e1 * t1379 * t1426 - 0.112e3 / 0.27e2 * t1383 * t1429 - 0.112e3 / 0.3e1 * t476 * t3674 * t1417 - 0.8e1 / 0.3e1 * t451 * t3680 - 0.16e2 / 0.9e1 * t441 * t3683 + 0.8e1 / 0.9e1 * t441 * t3686 - 0.32e2 * t476 * t2080 * t3679;
  t3694 = t1421 * t502;
  t3697 = t500 * t184;
  t3698 = t3697 * t197;
  t3699 = t1425 * t3698;
  t3702 = t1416 * t537;
  t3703 = t1425 * t3702;
  t3707 = t1349 * t3556 * t1283;
  t3708 = t64 * t3559;
  t3711 = t2213 * t511;
  t3712 = t1425 * t3711;
  t3724 = t525 * params->alpha;
  t3725 = t3724 * t1417;
  t3730 = t33 * t138;
  t3731 = t3730 * t64;
  t3736 = t3730 * t158;
  t3739 = -0.8e1 / 0.9e1 * t441 * t3694 + 0.4e1 / 0.3e1 * t451 * t3699 + 0.4e1 / 0.3e1 * t451 * t3703 + 0.64e2 / 0.729e3 * t3707 * t3708 - 0.8e1 / 0.3e1 * t451 * t3712 - 0.32e2 * t476 * t1415 * t3711 + 0.16e2 * t476 * t1415 * t3698 + 0.16e2 * t476 * t1415 * t3702 - 0.64e2 / 0.3e1 * t441 * t3725 - 0.32e2 / 0.729e3 * t1349 * t3556 * t3563 * t3731 + 0.256e3 / 0.243e3 * t1349 * t3556 * t137 * t3736;
  t3744 = t442 * t462 * t1411;
  t3747 = t1409 * t469;
  t3748 = t3747 * t181;
  t3751 = t1361 * t184;
  t3753 = t3751 * t147 * t197;
  t3756 = t1326 * params->alpha;
  t3758 = t3756 * t179 * t1363;
  t3761 = t3747 * t198;
  t3780 = 0.1024e4 / 0.27e2 * t435 * t146 * t1318 * t3537 * t3744 + 0.256e3 / 0.9e1 * t1408 * t3748 + 0.6144e4 * t1360 * t3753 - 0.6144e4 * t1360 * t3758 - 0.256e3 / 0.9e1 * t1408 * t3761 + 0.364e4 / 0.81e2 * t143 * t3609 * t158 + 0.91e3 / 0.243e3 * t133 * t3108 * t64 + 0.224e3 / 0.81e2 * t3484 * t1444 - 0.448e3 / 0.9e1 * t3484 * t1447 - 0.384e3 * t465 * t470 * t502 + 0.384e3 * t465 * t470 * t538;
  t3786 = t1351 * t198;
  t3789 = t1351 * t181;
  t3809 = t525 * t538;
  t3813 = t132 * t1450 * t1257;
  t3814 = t1300 * t198;
  t3817 = -0.5888e4 / 0.27e2 * t1451 * t3548 * t1411 - 0.32e2 / 0.81e2 * t1350 * t3786 + 0.32e2 / 0.81e2 * t1350 * t3789 - 0.64e4 / 0.3e1 * t465 * t1355 * t198 + 0.64e4 / 0.3e1 * t465 * t1355 * t181 - 0.768e3 * t465 * t470 * t512 + 0.6832e4 / 0.81e2 * t446 * t3114 * t138 * t158 + 0.14e2 / 0.9e1 * t1379 * t1395 - 0.448e3 / 0.9e1 * t1383 * t1392 - 0.32e2 / 0.3e1 * t441 * t3809 - 0.512e3 / 0.9e1 * t3813 * t3814;
  t3819 = t1349 * t1249 * t137;
  t3823 = t1349 * t1249 * t41;
  t3826 = t188 * t1269;
  t3832 = t132 * t1264;
  t3845 = t188 * t1332;
  t3851 = 0.64e2 / 0.81e2 * t3819 * t455 - 0.128e3 / 0.9e1 * t3823 * t1388 - 0.4e1 / 0.9e1 * t451 * t3826 - 0.16e2 / 0.3e1 * t476 * t193 * t1269 + 0.28e3 / 0.81e2 * t3832 * t455 - 0.1708e4 / 0.243e3 * t435 * t436 * t3114 * t443 - 0.28e3 / 0.81e2 * t3832 * t452 - 0.14e2 / 0.9e1 * t1379 * t1398 + 0.448e3 / 0.9e1 * t1383 * t1388 + 0.4e1 / 0.9e1 * t451 * t3845 + 0.16e2 / 0.3e1 * t476 * t193 * t1332;
  t3853 = t33 * t158;
  t3865 = t42 * t464 * t467;
  t3866 = t469 * params->alpha;
  t3867 = t3866 * t1417;
  t3870 = t525 * t512;
  t3882 = t442 * t1411;
  t3888 = t63 * t29;
  t3890 = t3525 * t58 * t3888 * t1297;
  t3896 = -0.128e3 / 0.243e3 * t3707 * t3853 - 0.32e4 / 0.27e2 * t132 * t1311 * t3547 * t1412 + 0.27648e5 * t42 * t1319 * t3537 * t1364 + 0.768e3 * t3865 * t3867 + 0.64e2 / 0.3e1 * t441 * t3870 - 0.64e2 / 0.81e2 * t3819 * t452 + 0.128e3 / 0.9e1 * t3823 * t1392 + 0.112e3 / 0.3e1 * t476 * t529 * t512 + 0.512e3 / 0.27e2 * t435 * t3533 * t3537 * t3882 - 0.6144e5 * t42 * t3518 * t3522 * t3890 + 0.112e4 / 0.27e2 * t476 * t1304 * t198;
  t3906 = t525 * t502;
  t3909 = t1300 * t181;
  t3914 = t188 * t1232;
  t3930 = -0.112e4 / 0.27e2 * t476 * t1304 * t181 - 0.56e2 / 0.3e1 * t476 * t529 * t538 + 0.56e2 / 0.3e1 * t476 * t529 * t502 + 0.32e2 / 0.3e1 * t441 * t3906 + 0.512e3 / 0.9e1 * t3813 * t3909 + 0.28e2 / 0.9e1 * t1379 * t1376 + 0.8e1 / 0.3e1 * t451 * t3914 + 0.32e2 * t476 * t193 * t1232 - 0.4e1 * t162 * t1268 * t504 - 0.6e1 * t162 * t501 * t1341 + 0.8e1 * t162 * t510 * t1331 * t197;
  t3939 = t5 * t1194 * t127 * t66;
  t3943 = t5 * t408 * t421 * t66;
  t3947 = t5 * t121 * t1217 * t66;
  t3950 = 0.1e1 / t126 / t399;
  t3954 = 0.1e2 / 0.27e2 * t5 * t25 * t3950 * t66;
  t3955 = -0.3e1 / 0.8e1 * t5 * t3446 * t26 * t66 - 0.3e1 / 0.2e1 * t5 * t1195 * t200 - 0.3e1 / 0.2e1 * t3455 - 0.9e1 / 0.4e1 * t5 * t409 * t540 + t3461 - 0.3e1 / 0.2e1 * t3463 - 0.3e1 / 0.2e1 * t5 * t122 * t1462 - 0.5e1 / 0.9e1 * t3469 + t3472 / 0.2e1 - t3475 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (0.16e2 / 0.9e1 * t3479 * t1426 - 0.112e3 / 0.81e2 * t3484 * t1352 - 0.3808e5 / 0.9e1 * t465 * t3482 * t469 * t471 + 0.24e2 * t2212 * t2213 * t1334 + 0.4096e4 * t3496 * t3497 * t3499 * t3503 + 0.24e2 * t162 * t3508 * t3509 + 0.6e1 * t162 * t510 * t3513 - t162 * t185 * t3622 + t162 * params->alpha * (0.91e3 / 0.243e3 * t46 * t3609 * t48 + 0.721e3 / 0.81e2 * t167 * t3594 * t172 - 0.931e3 / 0.243e3 * t490 * t3483 * t493 + 0.116e3 / 0.729e3 * t1254 * t3547 * t1259 * t33 - 0.4e1 / 0.243e3 * t490 * t1318 * t3537 * t3640 * t147 + 0.91e3 / 0.243e3 * t51 * t52 * t3093) * t63 - 0.4e1 * t162 * t180 * t3652 + t3692 + t3739 + t3780 + t3817 + t3851 + t3896 + t3930) - t3939 / 0.2e1 + t3943 / 0.2e1 - 0.5e1 / 0.9e1 * t3947 + t3954;
  t3956 = my_piecewise3(t1, 0, t3955);
  t3957 = t75 * t75;
  t3959 = 0.1e1 / t546 / t3957;
  t3960 = t548 * t548;
  t3966 = t554 * t554;
  t3971 = t72 * t3438;
  t3974 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t1186 + 0.24e2 * t3971);
  t3978 = my_piecewise3(t76, 0, 0.4e2 / 0.81e2 * t3959 * t3960 - 0.16e2 / 0.9e1 * t1469 * t548 * t554 + 0.4e1 / 0.3e1 * t547 * t3966 + 0.16e2 / 0.9e1 * t1473 * t1479 + 0.4e1 / 0.3e1 * t77 * t3974);
  t3985 = t5 * t1483 * t127 * t109;
  t3989 = t5 * t558 * t421 * t109;
  t3993 = t5 * t211 * t1217 * t109;
  t3998 = 0.1e2 / 0.27e2 * t5 * t79 * t3950 * t109;
  t4000 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t3978 * t26 * t109 - t3985 / 0.2e1 + t3989 / 0.2e1 - 0.5e1 / 0.9e1 * t3993 + t3998);
  tv4rho40 = 0.4e1 * t1467 + 0.4e1 * t1501 + t6 * (t3956 + t4000);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t4021 = 0.12e2 * t1186;
  t4022 = 0.24e2 * t3439;
  t4024 = my_piecewise5(t10, 0, t14, 0, -t4021 + t4022);
  t4028 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3425 * t225 * t1179 - 0.8e1 / 0.9e1 * t1178 * t579 * t396 - 0.8e1 / 0.9e1 * t1506 * t118 * t404 + 0.4e1 / 0.3e1 * t395 * t1517 * t118 + 0.4e1 / 0.3e1 * t1509 * t404 + 0.4e1 / 0.9e1 * t575 * t1190 + 0.4e1 / 0.3e1 * t23 * t4024);
  t4037 = t5 * t1526 * t200;
  t4043 = t5 * t1533 * t200;
  t4044 = t4043 / 0.4e1;
  t4046 = t5 * t588 * t540;
  t4059 = t5 * t583 * t421 * t66;
  t4060 = t4059 / 0.4e1;
  t4063 = t5 * t228 * t1217 * t66;
  t4067 = t5 * t1521 * t127 * t66;
  t4072 = -0.3e1 / 0.8e1 * t5 * t4028 * t26 * t66 - 0.9e1 / 0.8e1 * t5 * t1522 * t200 - 0.3e1 / 0.4e1 * t4037 - 0.9e1 / 0.8e1 * t5 * t584 * t540 + t4044 - 0.3e1 / 0.8e1 * t4046 - 0.3e1 / 0.8e1 * t5 * t229 * t1462 - 0.3e1 / 0.8e1 * t3455 + t3461 / 0.2e1 - 0.3e1 / 0.8e1 * t3463 - 0.5e1 / 0.12e2 * t3469 + t3472 / 0.4e1 - t3475 / 0.8e1 + t4060 - 0.5e1 / 0.36e2 * t4063 - 0.3e1 / 0.8e1 * t4067 - t3939 / 0.8e1 + t3943 / 0.4e1 - 0.5e1 / 0.12e2 * t3947 + t3954;
  t4073 = my_piecewise3(t1, 0, t4072);
  t4090 = 0.24e2 * t3971;
  t4092 = my_piecewise5(t14, 0, t10, 0, t4021 + t4090);
  t4096 = my_piecewise3(t76, 0, 0.4e2 / 0.81e2 * t3959 * t236 * t1470 - 0.8e1 / 0.9e1 * t1469 * t603 * t548 - 0.8e1 / 0.9e1 * t1550 * t208 * t554 + 0.4e1 / 0.3e1 * t547 * t1560 * t208 + 0.4e1 / 0.3e1 * t1553 * t554 + 0.4e1 / 0.9e1 * t599 * t1479 + 0.4e1 / 0.3e1 * t77 * t4092);
  t4103 = t5 * t1564 * t127 * t109;
  t4107 = t5 * t607 * t421 * t109;
  t4108 = t4107 / 0.4e1;
  t4111 = t5 * t239 * t1217 * t109;
  t4120 = t5 * t1488 * t304;
  t4123 = t5 * t1492 * t304;
  t4124 = t4123 / 0.4e1;
  t4126 = t5 * t1496 * t304;
  t4128 = -0.3e1 / 0.8e1 * t5 * t4096 * t26 * t109 - 0.3e1 / 0.8e1 * t4103 + t4108 - 0.5e1 / 0.36e2 * t4111 - t3985 / 0.8e1 + t3989 / 0.4e1 - 0.5e1 / 0.12e2 * t3993 + t3998 - 0.3e1 / 0.8e1 * t5 * t1484 * t304 - 0.3e1 / 0.8e1 * t4120 + t4124 - 0.5e1 / 0.36e2 * t4126;
  t4129 = my_piecewise3(t71, 0, t4128);
  tv4rho41 = t1467 + t1501 + 0.3e1 * t1549 + 0.3e1 * t1589 + t6 * (t4073 + t4129);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t4144 = t579 * t579;
  t4157 = my_piecewise5(t10, 0, t14, 0, t4022);
  t4161 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3425 * t629 * t396 - 0.32e2 / 0.27e2 * t1506 * t118 * t579 - 0.8e1 / 0.27e2 * t1592 * t404 + 0.8e1 / 0.9e1 * t395 * t4144 + 0.8e1 / 0.9e1 * t575 * t1517 - 0.8e1 / 0.27e2 * t1178 * t634 * t396 + 0.8e1 / 0.9e1 * t395 * t1601 * t118 + 0.4e1 / 0.9e1 * t1597 * t404 + 0.4e1 / 0.3e1 * t23 * t4157);
  t4170 = t5 * t1610 * t200;
  t4183 = t5 * t1605 * t127 * t66;
  t4187 = t5 * t638 * t421 * t66;
  t4194 = -0.3e1 / 0.8e1 * t5 * t4161 * t26 * t66 - 0.3e1 / 0.4e1 * t5 * t1606 * t200 - t4170 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t639 * t540 - t4037 / 0.2e1 + t4043 / 0.3e1 - t4046 / 0.4e1 + t3461 / 0.6e1 - 0.5e1 / 0.18e2 * t3469 + t3472 / 0.12e2 - t4183 / 0.4e1 + t4187 / 0.12e2 + t4059 / 0.3e1 - 0.5e1 / 0.18e2 * t4063 - t4067 / 0.4e1 + t3943 / 0.12e2 - 0.5e1 / 0.18e2 * t3947 + t3954;
  t4195 = my_piecewise3(t1, 0, t4194);
  t4204 = t603 * t603;
  t4217 = my_piecewise5(t14, 0, t10, 0, t4090);
  t4221 = my_piecewise3(t76, 0, 0.4e2 / 0.81e2 * t3959 * t646 * t548 - 0.32e2 / 0.27e2 * t1550 * t208 * t603 - 0.8e1 / 0.27e2 * t1622 * t554 + 0.8e1 / 0.9e1 * t547 * t4204 + 0.8e1 / 0.9e1 * t599 * t1560 - 0.8e1 / 0.27e2 * t1469 * t651 * t548 + 0.8e1 / 0.9e1 * t547 * t1631 * t208 + 0.4e1 / 0.9e1 * t1627 * t554 + 0.4e1 / 0.3e1 * t77 * t4217);
  t4228 = t5 * t1635 * t127 * t109;
  t4232 = t5 * t655 * t421 * t109;
  t4241 = t5 * t1569 * t304;
  t4244 = t5 * t1573 * t304;
  t4255 = t5 * t563 * t771;
  t4258 = t5 * t567 * t771;
  t4260 = -0.3e1 / 0.8e1 * t5 * t4221 * t26 * t109 - t4228 / 0.4e1 + t4232 / 0.12e2 - t4103 / 0.4e1 + t4107 / 0.3e1 - 0.5e1 / 0.18e2 * t4111 - 0.3e1 / 0.4e1 * t5 * t1565 * t304 - t4241 / 0.2e1 + t4244 / 0.6e1 + t3989 / 0.12e2 - 0.5e1 / 0.18e2 * t3993 + t3998 - t4120 / 0.4e1 + t4123 / 0.3e1 - 0.5e1 / 0.18e2 * t4126 - 0.3e1 / 0.8e1 * t5 * t559 * t771 - t4255 / 0.4e1 + t4258 / 0.12e2;
  t4261 = my_piecewise3(t71, 0, t4260);
  tv4rho42 = 0.2e1 * t1549 + 0.2e1 * t1589 + 0.2e1 * t1621 + 0.2e1 * t1660 + t6 * (t4195 + t4261);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t4282 = my_piecewise5(t10, 0, t14, 0, t4021 + t4022);
  t4286 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3425 * t1665 * t118 - 0.8e1 / 0.9e1 * t1592 * t579 - 0.8e1 / 0.9e1 * t1506 * t634 * t118 + 0.4e1 / 0.3e1 * t1509 * t634 + 0.4e1 / 0.3e1 * t575 * t1601 + 0.4e1 / 0.9e1 * t395 * t1672 * t118 + 0.4e1 / 0.3e1 * t23 * t4282);
  t4293 = t5 * t1676 * t127 * t66;
  t4304 = -0.3e1 / 0.8e1 * t5 * t4286 * t26 * t66 - t4293 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1677 * t200 - 0.3e1 / 0.8e1 * t4183 + t4187 / 0.4e1 - 0.3e1 / 0.8e1 * t4170 + t4060 - 0.5e1 / 0.12e2 * t4063 + t4044 - 0.5e1 / 0.36e2 * t3947 + t3954 - 0.5e1 / 0.36e2 * t3469;
  t4305 = my_piecewise3(t1, 0, t4304);
  t4322 = my_piecewise5(t14, 0, t10, 0, -t4021 + t4090);
  t4326 = my_piecewise3(t76, 0, 0.4e2 / 0.81e2 * t3959 * t1685 * t208 - 0.8e1 / 0.9e1 * t1622 * t603 - 0.8e1 / 0.9e1 * t1550 * t651 * t208 + 0.4e1 / 0.3e1 * t1553 * t651 + 0.4e1 / 0.3e1 * t599 * t1631 + 0.4e1 / 0.9e1 * t547 * t1692 * t208 + 0.4e1 / 0.3e1 * t77 * t4322);
  t4333 = t5 * t1696 * t127 * t109;
  t4341 = t5 * t1640 * t304;
  t4350 = t5 * t612 * t771;
  t4360 = t5 * t216 * t1941;
  t4362 = -0.3e1 / 0.8e1 * t5 * t4326 * t26 * t109 - t4333 / 0.8e1 - 0.3e1 / 0.8e1 * t4228 + t4232 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1636 * t304 - 0.3e1 / 0.8e1 * t4341 + t4108 - 0.5e1 / 0.12e2 * t4111 - 0.3e1 / 0.4e1 * t4241 + t4244 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t608 * t771 - 0.3e1 / 0.8e1 * t4350 - 0.5e1 / 0.36e2 * t3993 + t3998 + t4124 - 0.5e1 / 0.12e2 * t4126 - 0.3e1 / 0.8e1 * t4255 + t4258 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t212 * t1941 - t4360 / 0.8e1;
  t4363 = my_piecewise3(t71, 0, t4362);
  tv4rho43 = 0.3e1 * t1621 + 0.3e1 * t1660 + t1684 + t1946 + t6 * (t4305 + t4363);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t4368 = t629 * t629;
  t4373 = t634 * t634;
  t4380 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t1186 + 0.24e2 * t3439);
  t4384 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3425 * t4368 - 0.16e2 / 0.9e1 * t1592 * t634 + 0.4e1 / 0.3e1 * t395 * t4373 + 0.16e2 / 0.9e1 * t575 * t1672 + 0.4e1 / 0.3e1 * t23 * t4380);
  t4393 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t4384 * t26 * t66 - t4293 / 0.2e1 + t4187 / 0.2e1 - 0.5e1 / 0.9e1 * t4063 + t3954);
  t4395 = t3477 * t720 * t88;
  t4402 = t290 * t1788;
  t4419 = t1751 * sigma[2];
  t4420 = t81 * t4419;
  t4421 = t462 * t4420;
  t4425 = 0.1e1 / t82 / t1752 / t923;
  t4428 = 0.1e1 / t263 / t1781 / t262;
  t4433 = t3532 * t1775;
  t4435 = t1752 * t245;
  t4437 = 0.1e1 / t256 / t4435;
  t4447 = 0.1e1 / t82 / t1778;
  t4448 = t4447 * t249;
  t4456 = t81 * t3257;
  t4460 = t3313 * t88;
  t4464 = t1751 * t4447;
  t4465 = t1281 * t4464;
  t4467 = t32 * t264;
  t4468 = t1738 * t29 * t4467;
  t4471 = t248 * t88;
  t4473 = t32 * t249;
  t4474 = t4473 * t90;
  t4475 = t4471 * t29 * t4474;
  t4478 = t33 * t264;
  t4479 = t1933 * t4478;
  t4485 = t703 * t28 * t146;
  t4486 = t677 * t4485;
  t4490 = t88 * t29 * t32;
  t4491 = t1830 * t4490;
  t4494 = 0.1e1 / t1752;
  t4500 = t1752 * t672;
  t4501 = 0.1e1 / t4500;
  t4506 = t697 * t4494;
  t4510 = sigma[2] * t3313;
  t4525 = -0.6144e5 * t103 * t4421 * t4425 * t4428 * t3527 + 0.512e3 / 0.27e2 * t518 * t4433 * t4437 * t88 * t1756 + 0.364e4 / 0.81e2 * t296 * t95 * t3257 * t264 - 0.32e4 / 0.27e2 * t1769 * t4448 * t1771 + 0.27648e5 * t1777 * t4437 * t1783 * t147 + 0.91e3 / 0.243e3 * t187 * t4456 * t292 - 0.1708e4 / 0.243e3 * t751 * t4460 * t292 - 0.128e3 / 0.243e3 * t4465 * t4468 - 0.32e2 / 0.729e3 * t4465 * t4475 + 0.256e3 / 0.243e3 * t4465 * t4479 + 0.1024e4 / 0.27e2 * t1281 * t1775 * t4437 * t4486 + 0.64e2 / 0.729e3 * t4465 * t4491 - 0.112e3 / 0.81e2 * t1735 * t4494 * t1738 * t90 + 0.4096e4 * t3585 * t4419 * t4501 * t249 * t1783 - 0.3808e5 / 0.9e1 * t764 * t4506 * t703 + 0.6832e4 / 0.81e2 * t524 * t4510 * t756 + 0.224e3 / 0.81e2 * t1735 * t4494 * t248 * t292 - 0.448e3 / 0.9e1 * t1735 * t4494 * t88 * t756 - 0.5888e4 / 0.27e2 * t1298 * t4464 * t1756;
  t4542 = t725 * t725;
  t4543 = 0.1e1 / t4542;
  t4557 = t101 / t1712 / t105;
  t4558 = t744 * t744;
  t4563 = t768 * t768;
  t4567 = t1713 * t1715;
  t4575 = t760 * params->alpha;
  t4579 = t1900 * t769;
  t4582 = t1900 * t735;
  t4585 = t733 * t290;
  t4586 = t4585 * t301;
  t4587 = t1894 * t4586;
  t4590 = t1895 * t768;
  t4591 = t1894 * t4590;
  t4595 = t742 * t301 * t768;
  t4596 = t2293 * t4595;
  t4599 = t1900 * t745;
  t4602 = 0.6e1 * t270 * t743 * t4563 - 0.24e2 * t270 * t286 * t4567 - 0.28e2 / 0.9e1 * t1842 * t1897 - 0.112e3 / 0.27e2 * t1839 * t1901 - 0.112e3 / 0.3e1 * t710 * t4575 * t1896 + 0.8e1 / 0.9e1 * t676 * t4579 - 0.8e1 / 0.9e1 * t676 * t4582 + 0.4e1 / 0.3e1 * t686 * t4587 + 0.4e1 / 0.3e1 * t686 * t4591 - 0.8e1 / 0.3e1 * t686 * t4596 - 0.16e2 / 0.9e1 * t676 * t4599;
  t4604 = t2541 * t744;
  t4605 = t1894 * t4604;
  t4612 = t1349 * t4464 * t1738;
  t4613 = t107 * t4490;
  t4622 = t756 * params->alpha;
  t4623 = t4622 * t1896;
  t4633 = t33 * t249;
  t4634 = t4633 * t107;
  t4639 = t4633 * t266;
  t4642 = t1865 * t703;
  t4643 = t4642 * t302;
  t4646 = -0.8e1 / 0.3e1 * t686 * t4605 - 0.32e2 * t710 * t1907 * t4604 + 0.64e2 / 0.729e3 * t4612 * t4613 + 0.16e2 * t710 * t1907 * t4586 + 0.16e2 * t710 * t1907 * t4590 - 0.64e2 / 0.3e1 * t676 * t4623 - 0.32e2 * t710 * t2306 * t4595 + 0.112e3 / 0.27e2 * t1839 * t1904 - 0.32e2 / 0.729e3 * t1349 * t4464 * t4471 * t4634 + 0.256e3 / 0.243e3 * t1349 * t4464 * t248 * t4639 - 0.256e3 / 0.9e1 * t1864 * t4643;
  t4651 = t677 * t462 * t1867;
  t4654 = t4642 * t287;
  t4657 = t1874 * t290;
  t4659 = t4657 * t147 * t301;
  t4662 = t1783 * params->alpha;
  t4664 = t4662 * t285 * t1876;
  t4667 = t1349 * t4506;
  t4681 = t1830 * t302;
  t4684 = t1830 * t287;
  t4687 = 0.1024e4 / 0.27e2 * t435 * t146 * t1775 * t4437 * t4651 + 0.256e3 / 0.9e1 * t1864 * t4654 + 0.6144e4 * t1873 * t4659 - 0.6144e4 * t1873 * t4664 + 0.224e3 / 0.81e2 * t4667 * t1934 - 0.448e3 / 0.9e1 * t4667 * t1937 - 0.384e3 * t699 * t704 * t735 + 0.384e3 * t699 * t704 * t769 - 0.5888e4 / 0.27e2 * t1912 * t4448 * t1867 - 0.32e2 / 0.81e2 * t1829 * t4681 + 0.32e2 / 0.81e2 * t1829 * t4684;
  t4711 = t249 * t1783;
  t4712 = t4711 * t705;
  t4726 = t677 * t1867;
  t4729 = -0.64e4 / 0.3e1 * t699 * t1834 * t302 + 0.64e4 / 0.3e1 * t699 * t1834 * t287 - 0.768e3 * t699 * t704 * t745 + 0.6832e4 / 0.81e2 * t681 * t3313 * t249 * t266 + 0.364e4 / 0.81e2 * t254 * t4456 * t266 + 0.91e3 / 0.243e3 * t244 * t3307 * t107 + 0.4096e4 * t3496 * t4419 * t4501 * t4712 + 0.24e2 * t2540 * t2541 * t1821 - 0.112e3 / 0.81e2 * t4667 * t1831 - 0.3808e5 / 0.9e1 * t699 * t4494 * t703 * t705 + 0.512e3 / 0.27e2 * t435 * t4433 * t4437 * t4726;
  t4733 = t106 * t29;
  t4735 = t4428 * t101 * t4733 * t1297;
  t4750 = t756 * t769;
  t4754 = t132 * t1911 * t1754;
  t4755 = t1756 * t302;
  t4758 = t756 * t735;
  t4761 = t1756 * t287;
  t4768 = -0.6144e5 * t89 * t4421 * t4425 * t4735 + 0.112e4 / 0.27e2 * t710 * t1760 * t302 - 0.112e4 / 0.27e2 * t710 * t1760 * t287 - 0.56e2 / 0.3e1 * t710 * t760 * t769 + 0.56e2 / 0.3e1 * t710 * t760 * t735 - 0.32e2 / 0.3e1 * t676 * t4750 - 0.512e3 / 0.9e1 * t4754 * t4755 + 0.32e2 / 0.3e1 * t676 * t4758 + 0.512e3 / 0.9e1 * t4754 * t4761 - 0.14e2 / 0.9e1 * t1842 * t1854 + 0.448e3 / 0.9e1 * t1839 * t1845;
  t4774 = t756 * t745;
  t4778 = t1349 * t1764 * t248;
  t4782 = t1349 * t1764 * t88;
  t4789 = t132 * t1807;
  t4798 = t292 * t1789;
  t4801 = 0.14e2 / 0.9e1 * t1842 * t1851 - 0.448e3 / 0.9e1 * t1839 * t1848 + 0.64e2 / 0.3e1 * t676 * t4774 + 0.64e2 / 0.81e2 * t4778 * t690 - 0.128e3 / 0.9e1 * t4782 * t1845 - 0.64e2 / 0.81e2 * t4778 * t687 + 0.128e3 / 0.9e1 * t4782 * t1848 + 0.28e3 / 0.81e2 * t4789 * t690 - 0.1708e4 / 0.243e3 * t435 * t671 * t3313 * t678 - 0.28e3 / 0.81e2 * t4789 * t687 + 0.4e1 / 0.9e1 * t686 * t4798;
  t4805 = t292 * t1812;
  t4811 = t33 * t266;
  t4823 = t89 * t698 * t701;
  t4824 = t703 * params->alpha;
  t4825 = t4824 * t1896;
  t4830 = t292 * t1716;
  t4839 = 0.16e2 / 0.3e1 * t710 * t297 * t1789 - 0.4e1 / 0.9e1 * t686 * t4805 - 0.16e2 / 0.3e1 * t710 * t297 * t1812 - 0.128e3 / 0.243e3 * t4612 * t4811 - 0.32e4 / 0.27e2 * t132 * t1768 * t4447 * t1868 + 0.27648e5 * t89 * t1776 * t4437 * t1877 + 0.768e3 * t4823 * t4825 + 0.28e2 / 0.9e1 * t1842 * t1889 + 0.8e1 / 0.3e1 * t686 * t4830 + 0.112e3 / 0.3e1 * t710 * t760 * t745 + 0.32e2 * t710 * t297 * t1716;
  t4846 = t646 * t646;
  t4851 = t651 * t651;
  t4858 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t1186 + 0.24e2 * t3971);
  t4862 = my_piecewise3(t76, 0, 0.4e2 / 0.81e2 * t3959 * t4846 - 0.16e2 / 0.9e1 * t1622 * t651 + 0.4e1 / 0.3e1 * t547 * t4851 + 0.16e2 / 0.9e1 * t599 * t1692 + 0.4e1 / 0.3e1 * t77 * t4858);
  t4884 = -0.3e1 / 0.8e1 * t5 * t80 * (0.16e2 / 0.9e1 * t4395 * t1897 - 0.36e2 * t270 * t1714 * t744 * t768 - 0.4e1 * t270 * t286 * t4402 + 0.8e1 * t270 * t743 * t1788 * t301 - 0.4e1 * t270 * t1811 * t737 + 0.12e2 * t270 * t734 * t1825 - 0.6e1 * t270 * t734 * t1817 - t270 * t291 * t4525 + t270 * params->alpha * (0.91e3 / 0.243e3 * t46 * t4456 * t92 + 0.721e3 / 0.81e2 * t167 * t4510 * t278 - 0.931e3 / 0.243e3 * t490 * t4506 * t726 + 0.116e3 / 0.729e3 * t1800 * t4447 * t1802 * t33 - 0.4e1 / 0.243e3 * t490 * t1775 * t4437 * t4543 * t147 + 0.91e3 / 0.243e3 * t51 * t95 * t3257) * t106 + 0.24e2 * t270 * t4557 * t4558 + t4602 + t4646 + t4687 + t4729 + t4768 + t4801 + t4839) - 0.3e1 / 0.8e1 * t5 * t4862 * t26 * t109 - 0.3e1 / 0.2e1 * t5 * t1697 * t304 - 0.9e1 / 0.4e1 * t5 * t656 * t771 - 0.3e1 / 0.2e1 * t5 * t240 * t1941 - t4333 / 0.2e1 - 0.3e1 / 0.2e1 * t4341 - 0.3e1 / 0.2e1 * t4350 - t4360 / 0.2e1 + t4232 / 0.2e1 + t4244 + t4258 / 0.2e1 - 0.5e1 / 0.9e1 * t4111 - 0.5e1 / 0.9e1 * t4126 + t3998;
  t4885 = my_piecewise3(t71, 0, t4884);
  tv4rho44 = 0.4e1 * t1684 + 0.4e1 * t1946 + t6 * (t4393 + t4885);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4893 = t5 * t1199 * t347;
  t4899 = t5 * t1206 * t347;
  t4902 = t5 * t413 * t878;
  t4909 = 0.5e1 / 0.36e2 * t5 * t1218 * t347;
  t4911 = t5 * t422 * t878;
  t4914 = t5 * t128 * t2226;
  t4918 = t1281 * t1248;
  t4931 = t1255 * t168;
  t4932 = 0.1e1 / t4931;
  t4937 = t34 * t1248;
  t4949 = 0.1e1 / t35 / t3498;
  t4954 = t1257 * sigma[0];
  t4955 = t1281 * t4954;
  t4958 = t3532 * t1323;
  t4964 = t312 * t1236;
  t4970 = t1257 * t3563;
  t4976 = t1257 * t137;
  t4984 = t138 * t463;
  t4988 = 0.119e3 / 0.81e2 * t524 * t1275 - 0.22e2 / 0.27e2 * t4918 * t2154 + 0.44e2 / 0.3e1 * t4918 * t2158 + 0.592e3 / 0.9e1 * t1298 * t1313 * t2162 - 0.476e3 / 0.27e2 * t524 * t1439 * t156 + 0.11e2 / 0.27e2 * t4918 * t2150 - 0.1536e4 * t3585 * t4932 * t3502 * t1253 + 0.296e4 / 0.3e1 * t533 * t4937 * t469 - 0.14e3 / 0.27e2 * t192 * t313 * t1304 + 0.328e3 / 0.9e1 * t2173 * t1315 - 0.864e4 * t2177 * t1328 + 0.2304e5 * t1320 * t4949 * t3525 * t3527 + 0.16e2 / 0.81e2 * t4955 * t3619 - 0.64e2 / 0.9e1 * t518 * t4958 * t41 * t463 * t1300 - 0.35e2 / 0.81e2 * t187 * t4964 * t188 - 0.8e1 / 0.243e3 * t4955 * t3560 + 0.4e1 / 0.243e3 * t1281 * t4970 * sigma[0] * t29 * t3566 - 0.32e2 / 0.81e2 * t1281 * t4976 * sigma[0] * t138 * t3570 - 0.128e3 / 0.9e1 * t1281 * t1323 * t41 * t4984 * t3577;
  t4994 = t146 * t1242;
  t5021 = t132 * t32;
  t5023 = t5021 * t144 * t138;
  t5025 = t2211 * t179 * t2062;
  t5028 = t42 * t29;
  t5029 = t5028 * t176;
  t5030 = t156 * params->alpha;
  t5032 = t5030 * t179 * t2062;
  t5039 = t42 * t59;
  t5040 = t1229 * t344;
  t5044 = t179 * t1229;
  t5048 = t435 * t4994;
  t5072 = t435 * t787 * t138;
  t5077 = t42 * t803 * t806;
  t5080 = t188 * t2183;
  t5083 = -t162 * t185 * t4988 + t162 * params->alpha * (-0.35e2 / 0.81e2 * t46 * t4964 * t48 - 0.91e2 / 0.54e2 * t166 * t4994 * t172 + 0.317e3 / 0.324e3 * t490 * t1248 * t493 * t34 - 0.49e2 / 0.972e3 * t490 * t1257 * t1981 + t490 * t1323 * t3640 * t463 * t147 / 0.162e3 - 0.35e2 / 0.81e2 * t51 * t313 * t1236) * t63 + 0.4e1 / 0.9e1 * t3479 * t2089 + 0.4e1 / 0.9e1 * t3479 * t2075 - 0.4e1 / 0.3e1 * t5023 * t5025 - 0.16e2 * t5029 * t5032 - 0.8e1 / 0.9e1 * t3479 * t2063 + 0.296e4 / 0.3e1 * t804 * t1356 - 0.18e2 * t5039 * t5040 * t1334 - 0.18e2 * t2212 * t5044 * t2207 - 0.476e3 / 0.27e2 * t5048 * t791 + 0.11e2 / 0.27e2 * t1349 * t4937 * t1352 + 0.6e1 * t2212 * t500 * t509 * t853 + 0.12e2 * t2212 * t2213 * t2189 + 0.6e1 * t2212 * t2213 * t2193 - 0.1536e4 * t3496 * t1253 * t4932 * t3503 + 0.6e1 * t2212 * t2580 * t1334 + 0.4e1 * t5072 * t5030 * t1417 - 0.144e3 * t5077 * t3867 + t451 * t5080 / 0.3e1;
  t5088 = t1349 * t4954 * t1283;
  t5108 = t1410 * t2062;
  t5111 = t3866 * t2074;
  t5115 = t188 * t1989;
  t5126 = t435 * t1969 * t41;
  t5136 = t1349 * t2106 * t34;
  t5140 = t1349 * t2112 * t138;
  t5146 = -t451 * t5115 / 0.3e1 - 0.4e1 * t476 * t193 * t1989 - 0.14e2 / 0.3e1 * t812 * t1401 + t2005 * t1398 / 0.6e1 + 0.5e1 / 0.6e1 * t5126 * t455 - t2005 * t1395 / 0.6e1 - 0.5e1 / 0.6e1 * t5126 * t452 - t2011 * t1398 / 0.6e1 - 0.2e1 / 0.9e1 * t5136 * t455 + 0.4e1 * t5140 * t2157 * t198 + 0.7e1 / 0.9e1 * t1379 * t2042;
  t5151 = t132 * t1984;
  t5165 = t3866 * t2088;
  t5170 = t1300 * t345;
  t5179 = t525 * t840;
  t5182 = t1300 * t335;
  t5199 = t2011 * t1376 / 0.3e1 - 0.7e1 / 0.18e2 * t5151 * t455 + 0.7e1 / 0.18e2 * t5151 * t452 - 0.16e2 / 0.81e2 * t3819 * t819 + 0.32e2 / 0.9e1 * t3823 * t2045 + 0.28e2 / 0.3e1 * t476 * t529 * t840 - 0.112e3 / 0.9e1 * t1383 * t2045 + 0.192e3 * t3865 * t5165 - 0.7e1 / 0.9e1 * t1379 * t2051 - 0.128e3 / 0.9e1 * t3813 * t5170 + t812 * t340 * t1269 / 0.2e1 - t812 * t340 * t1332 / 0.2e1 + 0.16e2 / 0.3e1 * t441 * t5179 + 0.128e3 / 0.9e1 * t3813 * t5182 + 0.14e2 / 0.3e1 * t812 * t1404 + 0.2e1 * t812 * t1370 - 0.2e1 * t812 * t1367 + 0.2304e5 * t42 * t1319 * t4949 * t3890 + t2011 * t1395 / 0.6e1 + 0.2e1 / 0.9e1 * t5136 * t452;
  t5228 = t132 * t2119 * t138;
  t5243 = t525 * t876;
  t5267 = 0.28e3 / 0.27e2 * t476 * t1304 * t345 + 0.16e2 * t5228 * t1410 * t504 * sigma[0] - 0.64e2 / 0.9e1 * t435 * t4958 * t41 * t4984 * t1411 - 0.16e2 * t5228 * t3866 * t179 * t63 * sigma[0] - 0.16e2 / 0.3e1 * t441 * t5243 + 0.24e2 * t162 * t3508 * t344 * t1231 - 0.6e1 * t162 * t334 * t3664 + 0.6e1 * t162 * t510 * t2182 * t197 - 0.18e2 * t162 * t1230 * t875 * t511 + 0.6e1 * t162 * t839 * t1345 - 0.3e1 * t162 * t839 * t1341;
  t5284 = t184 * t2182;
  t5310 = t2580 * t511;
  t5311 = t1425 * t5310;
  t5317 = t1421 * t876;
  t5320 = t3697 * t344;
  t5321 = t1425 * t5320;
  t5324 = t1416 * t875;
  t5325 = t1425 * t5324;
  t5328 = -t162 * t334 * t3652 - 0.3e1 * t162 * t1988 * t504 + 0.6e1 * t162 * t510 * t875 * t537 + 0.2e1 * t162 * t510 * t344 * t1331 - 0.3e1 * t162 * t180 * t5284 - t162 * t1268 * t850 - 0.3e1 * t162 * t501 * t2185 + 0.4e1 * t812 * t1418 + 0.3e1 * t812 * t2066 * t3711 + t2005 * t1426 / 0.3e1 + t794 * t3712 / 0.4e1 - 0.7e1 / 0.9e1 * t1379 * t2089 + 0.28e2 / 0.27e2 * t1383 * t2092 - 0.7e1 / 0.9e1 * t1379 * t2075 - 0.28e2 / 0.27e2 * t1383 * t2071 - 0.2e1 / 0.3e1 * t451 * t5311 - 0.8e1 * t476 * t1415 * t5310 + 0.4e1 / 0.9e1 * t441 * t5317 + t451 * t5321 / 0.3e1 + 0.2e1 / 0.3e1 * t451 * t5325;
  t5329 = t3724 * t2074;
  t5334 = t838 * t184;
  t5335 = t5334 * t197;
  t5336 = t1425 * t5335;
  t5339 = t2087 * t537;
  t5340 = t1425 * t5339;
  t5343 = t3724 * t2088;
  t5346 = t1421 * t840;
  t5360 = t509 * t875 * t197;
  t5365 = t2061 * t537;
  t5370 = t525 * t58 * t2062;
  t5379 = t5040 * t511;
  t5380 = t2060 * t5379;
  t5399 = -0.8e1 * t476 * t2080 * t5365 + 0.32e2 / 0.3e1 * t441 * t5370 + 0.4e1 * t476 * t1415 * t5320 + 0.8e1 * t476 * t1415 * t5324 + 0.2e1 * t451 * t5380 + 0.24e2 * t476 * t2080 * t5379 - 0.8e1 / 0.243e3 * t5088 * t3708 + 0.1728e4 * t2033 * t3758 + 0.8e1 * t2027 * t3761 - 0.128e3 / 0.9e1 * t435 * t146 * t463 * t1323 * t3744 - 0.8e1 * t2027 * t3748;
  t5410 = t2060 * t5360;
  t5413 = t2060 * t5365;
  t5432 = t3747 * t345;
  t5437 = t3751 * t344 * t28 * t146;
  t5448 = t3747 * t335;
  t5452 = t3756 * t333 * t1363;
  t5466 = 0.4e1 * t476 * t1415 * t5339 - 0.64e2 / 0.9e1 * t1408 * t5432 + 0.1536e4 * t1360 * t5437 + 0.4e1 / 0.243e3 * t1349 * t4970 * sigma[0] * t3731 - 0.32e2 / 0.81e2 * t1349 * t4976 * sigma[0] * t3736 + 0.64e2 / 0.9e1 * t1408 * t5448 - 0.1536e4 * t1360 * t5452 - 0.1728e4 * t2033 * t3753 + 0.72e2 * t804 * t807 * t502 - 0.72e2 * t804 * t807 * t538 - 0.192e3 * t465 * t470 * t840;
  t5481 = t1351 * t345;
  t5487 = t1351 * t335;
  t5522 = 0.144e3 * t804 * t807 * t512 + 0.119e3 / 0.81e2 * t5048 * t443 - 0.2e1 * t788 * t3906 + 0.2e1 * t788 * t3809 - 0.1e2 * t2103 * t1388 + 0.44e2 / 0.3e1 * t1349 * t1292 * t2114 + 0.592e3 / 0.9e1 * t132 * t1297 * t1257 * t2122 + 0.1e2 * t2103 * t1392 + t2219 * t3786 / 0.9e1 - t2219 * t3789 / 0.9e1 + 0.456e3 * t804 * t1455;
  t5531 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1195 * t347 - 0.3e1 / 0.8e1 * t4893 - 0.9e1 / 0.8e1 * t5 * t409 * t878 + t4899 / 0.4e1 - 0.3e1 / 0.4e1 * t4902 - 0.9e1 / 0.8e1 * t5 * t122 * t2226 - t4909 + t4911 / 0.4e1 - 0.3e1 / 0.8e1 * t4914 - 0.3e1 / 0.8e1 * t5 * t27 * (t5522 + t5466 + t5399 + t5328 + t5267 + t5199 + t5146 + t5083 + 0.16e2 / 0.81e2 * t3819 * t844 - 0.32e2 / 0.9e1 * t3823 * t2054 + 0.112e3 / 0.9e1 * t1383 * t2054 - 0.384e3 * t3865 * t5108 - 0.456e3 * t804 * t1458 - 0.8e1 / 0.81e2 * t1350 * t5481 - t794 * t3703 / 0.8e1 - t2011 * t1426 / 0.3e1 + t794 * t3680 / 0.4e1 - 0.4e1 / 0.3e1 * t451 * t5410 - 0.2e1 / 0.3e1 * t451 * t5413 - t794 * t3699 / 0.8e1 + t451 * t5340 / 0.3e1 - 0.16e2 / 0.3e1 * t441 * t5343 - 0.4e1 / 0.9e1 * t441 * t5346 - 0.16e2 / 0.3e1 * t441 * t5329 + 0.14e2 / 0.9e1 * t1379 * t2063 + 0.2e1 / 0.3e1 * t451 * t5336 + t794 * t3826 / 0.24e2 - t794 * t3845 / 0.24e2 - t2005 * t1376 / 0.3e1 - t794 * t3914 / 0.4e1 - 0.4e1 * t812 * t1373 - 0.7e2 / 0.81e2 * t3832 * t819 + 0.7e2 / 0.81e2 * t3832 * t844 + 0.192e3 * t3865 * t5111 + 0.16e2 / 0.81e2 * t5088 * t3853 + 0.8e1 / 0.81e2 * t1350 * t5487 - 0.4e1 * t788 * t3870 - 0.35e2 / 0.81e2 * t314 * t1433 + 0.328e3 / 0.9e1 * t132 * t2025 * t1257 * t1412 - 0.864e4 * t42 * t464 * t1323 * t1364 + 0.56e2 / 0.3e1 * t476 * t529 * t58 * t2062 + 0.4e1 * t476 * t193 * t2183 - 0.28e2 / 0.3e1 * t476 * t529 * t876 - 0.4e1 * t5140 * t2157 * t181 - 0.3e1 * t812 * t340 * t1232 - 0.28e3 / 0.27e2 * t476 * t1304 * t335 - 0.28e2 / 0.3e1 * t476 * t3674 * t2088 - 0.28e2 / 0.3e1 * t476 * t3674 * t2074 - 0.16e2 * t476 * t2080 * t5360 - 0.3e1 / 0.2e1 * t812 * t2066 * t3698 - 0.3e1 / 0.2e1 * t812 * t2066 * t3702 + 0.3e1 * t812 * t2586 * t3679 + 0.8e1 * t476 * t1415 * t5335 + 0.192e3 * t465 * t470 * t876 - 0.22e2 / 0.27e2 * t1349 * t1288 * t2109 - 0.14e3 / 0.27e2 * t143 * t4964 * t158 - 0.16e4 / 0.3e1 * t465 * t1355 * t345 + 0.16e4 / 0.3e1 * t465 * t1355 * t335));
  tv4rho3sigma0 = t6 * t5531 + 0.3e1 * t2231;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t5538 = t5 * t1488 * t387;
  t5541 = t5 * t1492 * t387;
  t5545 = 0.5e1 / 0.36e2 * t5 * t1496 * t387;
  t5547 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t1484 * t387 - 0.3e1 / 0.8e1 * t5538 + t5541 / 0.4e1 - t5545);
  tv4rho3sigma2 = t6 * t5547 + 0.3e1 * t2244;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t5549 = 0.2e1 * t2258;
  t5555 = t5 * t1526 * t347 / 0.4e1;
  t5560 = t5 * t1533 * t347;
  t5564 = t5 * t588 * t878 / 0.4e1;
  t5573 = -0.3e1 / 0.8e1 * t5 * t1522 * t347 - t5555 - 0.3e1 / 0.4e1 * t5 * t584 * t878 + t5560 / 0.12e2 - t5564 - 0.3e1 / 0.8e1 * t5 * t229 * t2226 - t4893 / 0.8e1 + t4899 / 0.6e1 - t4902 / 0.4e1 - t4909 + t4911 / 0.6e1 - t4914 / 0.8e1;
  t5574 = my_piecewise3(t1, 0, t5573);
  tv4rho3sigma3 = t6 * t5574 + t2231 + t5549;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t5576 = 0.2e1 * t2274;
  t5582 = t5 * t1569 * t387 / 0.4e1;
  t5584 = t5 * t1573 * t387;
  t5593 = t5 * t563 * t996 / 0.4e1;
  t5595 = t5 * t567 * t996;
  t5598 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t1565 * t387 - t5582 + t5584 / 0.12e2 - t5538 / 0.8e1 + t5541 / 0.6e1 - t5545 - 0.3e1 / 0.8e1 * t5 * t559 * t996 - t5593 + t5595 / 0.12e2);
  tv4rho3sigma5 = t6 * t5598 + t2244 + t5576;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t5604 = t5 * t1610 * t347;
  t5613 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1606 * t347 - t5604 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t639 * t878 - t5555 + t5560 / 0.6e1 - t5564 + t4899 / 0.12e2 - t4909 + t4911 / 0.12e2);
  tv4rho3sigma6 = t6 * t5613 + t2282 + t5549;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t5619 = t5 * t1640 * t387;
  t5626 = t5 * t612 * t996;
  t5634 = t5 * t216 * t2554;
  t5636 = -0.3e1 / 0.8e1 * t5 * t1636 * t387 - t5619 / 0.8e1 - t5582 + t5584 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t608 * t996 - t5626 / 0.4e1 + t5541 / 0.12e2 - t5545 - t5593 + t5595 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t212 * t2554 - t5634 / 0.8e1;
  t5637 = my_piecewise3(t71, 0, t5636);
  tv4rho3sigma8 = t6 * t5637 + t2559 + t5576;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t5646 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1677 * t347 - 0.3e1 / 0.8e1 * t5604 + t5560 / 0.4e1 - t4909);
  tv4rho3sigma9 = t6 * t5646 + 0.3e1 * t2282;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t5664 = t742 * t993 * t301;
  t5665 = t2293 * t5664;
  t5671 = t2294 * t768;
  t5672 = t2293 * t5671;
  t5678 = t1900 * t994;
  t5681 = t1895 * t993;
  t5682 = t1894 * t5681;
  t5686 = t756 * t101 * t2295;
  t5689 = t1713 * t384;
  t5690 = t5689 * t744;
  t5691 = t2293 * t5690;
  t5697 = t1754 * sigma[2];
  t5699 = t1349 * t5697 * t1738;
  t5708 = t4622 * t2302;
  t5714 = t2931 * t744;
  t5715 = t1894 * t5714;
  t5728 = -0.4e1 / 0.3e1 * t686 * t5665 - 0.16e2 * t710 * t2306 * t5664 - 0.2e1 / 0.3e1 * t686 * t5672 - 0.8e1 * t710 * t2306 * t5671 + 0.4e1 / 0.9e1 * t676 * t5678 + 0.2e1 / 0.3e1 * t686 * t5682 + 0.32e2 / 0.3e1 * t676 * t5686 + 0.2e1 * t686 * t5691 + 0.24e2 * t710 * t2306 * t5690 - 0.8e1 / 0.243e3 * t5699 * t4613 + 0.14e2 / 0.9e1 * t1842 * t2296 - 0.28e2 / 0.27e2 * t1839 * t2299 - 0.7e1 / 0.9e1 * t1842 * t2303 - 0.16e2 / 0.3e1 * t676 * t5708 + 0.8e1 * t710 * t1907 * t5681 - 0.2e1 / 0.3e1 * t686 * t5715 - 0.8e1 * t710 * t1907 * t5714 + 0.7e2 / 0.81e2 * t4789 * t962 - 0.28e2 / 0.3e1 * t710 * t760 * t994 - 0.7e1 / 0.9e1 * t1842 * t2516;
  t5735 = t292 * t2443;
  t5738 = t756 * t994;
  t5743 = t1756 * t385;
  t5749 = t1349 * t2339 * t81;
  t5753 = t1349 * t2345 * t249;
  t5767 = t4824 * t2314;
  t5773 = t435 * t905 * t249;
  t5774 = t264 * params->alpha;
  t5779 = t89 * t921 * t924;
  t5784 = t1866 * t2295;
  t5787 = t4824 * t2302;
  t5792 = -0.16e2 / 0.81e2 * t4778 * t937 + 0.32e2 / 0.9e1 * t4782 * t2507 + 0.28e2 / 0.3e1 * t710 * t760 * t958 + 0.192e3 * t4823 * t5767 + t2477 * t1889 / 0.3e1 + 0.4e1 * t5773 * t5774 * t1896 - 0.144e3 * t5779 * t4825 + 0.16e2 / 0.81e2 * t4778 * t962 - 0.384e3 * t4823 * t5784 + 0.192e3 * t4823 * t5787 + 0.7e1 / 0.9e1 * t1842 * t2504;
  t5798 = t292 * t2395;
  t5810 = t756 * t958;
  t5813 = t1756 * t375;
  t5819 = 0.1e1 / t82 / t4500;
  t5843 = t435 * t2335 * t88;
  t5850 = 0.4e1 * t710 * t297 * t2443 - t686 * t5798 / 0.3e1 - 0.4e1 * t710 * t297 * t2395 + 0.16e2 / 0.81e2 * t5699 * t4811 + 0.328e3 / 0.9e1 * t132 * t2430 * t1754 * t1868 + 0.16e2 / 0.3e1 * t676 * t5810 + 0.128e3 / 0.9e1 * t4754 * t5813 - 0.2e1 * t930 * t1880 + 0.2304e5 * t89 * t1776 * t5819 * t4735 + t930 * t380 * t1812 / 0.2e1 - t930 * t380 * t1789 / 0.2e1 + t912 * t4805 / 0.24e2 - t912 * t4798 / 0.24e2 - 0.14e2 / 0.3e1 * t930 * t1857 + 0.14e2 / 0.3e1 * t930 * t1860 + 0.2e1 * t930 * t1883 - t2473 * t1851 / 0.6e1 - 0.5e1 / 0.6e1 * t5843 * t687 - t2477 * t1854 / 0.6e1 - 0.2e1 / 0.9e1 * t5749 * t690;
  t5856 = t132 * t2390;
  t5879 = t3532 * t1780;
  t5882 = t697 * t249;
  t5887 = t132 * t2355 * t249;
  t5899 = t2313 * t768;
  t5900 = t1894 * t5899;
  t5903 = t4622 * t2314;
  t5906 = t4585 * t384;
  t5913 = t1894 * t5906;
  t5920 = 0.28e3 / 0.27e2 * t710 * t1760 * t385 - 0.64e2 / 0.9e1 * t435 * t5879 * t88 * t5882 * t1867 - 0.16e2 * t5887 * t4824 * t285 * t106 * sigma[2] + 0.16e2 * t5887 * t1866 * t737 * sigma[2] - 0.7e1 / 0.18e2 * t5856 * t690 + t686 * t5900 / 0.3e1 - 0.16e2 / 0.3e1 * t676 * t5903 + 0.4e1 * t710 * t1907 * t5906 + 0.3e1 * t930 * t2940 * t4595 + t686 * t5913 / 0.3e1 + 0.56e2 / 0.3e1 * t710 * t760 * t101 * t2295;
  t5933 = t1900 * t958;
  t5939 = t956 * t290;
  t5940 = t5939 * t301;
  t5954 = t1894 * t5940;
  t5957 = t4642 * t385;
  t5962 = t4657 * t384 * t28 * t146;
  t5965 = t1754 * t4471;
  t5970 = t1754 * t248;
  t5983 = -0.28e2 / 0.3e1 * t710 * t4575 * t2302 + t2473 * t1897 / 0.3e1 + 0.4e1 * t930 * t1908 - t2477 * t1897 / 0.3e1 - 0.4e1 / 0.9e1 * t676 * t5933 - 0.28e2 / 0.3e1 * t710 * t4575 * t2314 + 0.8e1 * t710 * t1907 * t5940 + 0.4e1 * t710 * t1907 * t5899 + 0.3e1 * t930 * t2324 * t4604 - 0.7e1 / 0.9e1 * t1842 * t2315 + 0.28e2 / 0.27e2 * t1839 * t2318 + 0.2e1 / 0.3e1 * t686 * t5954 - 0.64e2 / 0.9e1 * t1864 * t5957 + 0.1536e4 * t1873 * t5962 + 0.4e1 / 0.243e3 * t1349 * t5965 * sigma[2] * t4634 - 0.32e2 / 0.81e2 * t1349 * t5970 * sigma[2] * t4639 - 0.8e1 * t2491 * t4654 - 0.1728e4 * t2495 * t4659 + 0.1728e4 * t2495 * t4664 + 0.8e1 * t2491 * t4643;
  t6003 = t4642 * t375;
  t6007 = t4662 * t373 * t1876;
  t6019 = t146 * t1726;
  t6020 = t435 * t6019;
  t6034 = t1830 * t385;
  t6042 = 0.192e3 * t699 * t704 * t994 - 0.192e3 * t699 * t704 * t958 + 0.119e3 / 0.81e2 * t6020 * t678 - 0.22e2 / 0.27e2 * t1349 * t1743 * t2342 + t2547 * t4681 / 0.9e1 - t2547 * t4684 / 0.9e1 + 0.456e3 * t922 * t1916 - 0.456e3 * t922 * t1919 - 0.8e1 / 0.81e2 * t1829 * t6034 - 0.16e4 / 0.3e1 * t699 * t1834 * t385 - 0.4e1 * t906 * t4774;
  t6048 = t1830 * t375;
  t6069 = t352 * t1720;
  t6099 = t290 * t2442;
  t6113 = -0.18e2 * t1714 * t270 * t744 * t993 + 0.24e2 * t1715 * t270 * t384 * t4557 + 0.2e1 * t1788 * t270 * t384 * t743 + 0.6e1 * t2442 * t270 * t301 * t743 + 0.6e1 * t270 * t743 * t768 * t993 + 0.6e1 * t1825 * t270 * t957 - 0.3e1 * t2394 * t270 * t737 - 0.3e1 * t270 * t286 * t6099 - 0.6e1 * t270 * t374 * t4567 + 0.72e2 * t735 * t922 * t925 - 0.72e2 * t769 * t922 * t925;
  t6125 = t1281 * t5697;
  t6145 = t1281 * t1737;
  t6158 = t1752 * t274;
  t6159 = 0.1e1 / t6158;
  t6164 = t81 * t1737;
  t6189 = -0.8e1 / 0.243e3 * t6125 * t4491 + 0.4e1 / 0.243e3 * t1281 * t5965 * sigma[2] * t29 * t4474 - 0.32e2 / 0.81e2 * t1281 * t5970 * sigma[2] * t249 * t4478 - 0.128e3 / 0.9e1 * t1281 * t1780 * t88 * t5882 * t4485 + 0.119e3 / 0.81e2 * t524 * t1728 - 0.22e2 / 0.27e2 * t6145 * t2411 + 0.44e2 / 0.3e1 * t6145 * t2415 + 0.592e3 / 0.9e1 * t1298 * t1770 * t2419 - 0.476e3 / 0.27e2 * t524 * t1929 * t264 + 0.11e2 / 0.27e2 * t6145 * t2407 - 0.1536e4 * t3585 * t6159 * t4711 * t1751 + 0.296e4 / 0.3e1 * t764 * t6164 * t703 + 0.2304e5 * t1777 * t5819 * t4428 * t3527 - 0.64e2 / 0.9e1 * t518 * t5879 * t88 * t697 * t1756 - 0.14e3 / 0.27e2 * t296 * t353 * t1760 + 0.328e3 / 0.9e1 * t2431 * t1772 - 0.864e4 * t2435 * t1785 - 0.35e2 / 0.81e2 * t187 * t6069 * t292 + 0.16e2 / 0.81e2 * t6125 * t4468;
  t6218 = t5021 * t255 * t249;
  t6220 = t2539 * t285 * t2295;
  t6223 = t89 * t29;
  t6224 = t6223 * t282;
  t6226 = t5774 * t285 * t2295;
  t6238 = t285 * t1713;
  t6258 = t89 * t102;
  t6268 = -0.8e1 / 0.9e1 * t4395 * t2296 + 0.296e4 / 0.3e1 * t922 * t1835 - 0.18e2 * t2540 * t6238 * t2456 - 0.476e3 / 0.27e2 * t6020 * t909 + 0.11e2 / 0.27e2 * t1349 * t6164 * t1831 - 0.1536e4 * t3496 * t1751 * t6159 * t4712 + 0.6e1 * t2540 * t2931 * t1821 + 0.6e1 * t2540 * t733 * t742 * t971 - 0.18e2 * t6258 * t5689 * t1821 + 0.6e1 * t2540 * t2541 * t2469 + 0.12e2 * t2540 * t2541 * t2465;
  t6277 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t1697 * t387 - 0.3e1 / 0.8e1 * t5619 - 0.9e1 / 0.8e1 * t5 * t656 * t996 + t5584 / 0.4e1 - 0.3e1 / 0.4e1 * t5626 - 0.9e1 / 0.8e1 * t5 * t240 * t2554 - t5545 + t5595 / 0.4e1 - 0.3e1 / 0.8e1 * t5634 - 0.3e1 / 0.8e1 * t5 * t80 * (t5792 + t5728 - 0.128e3 / 0.9e1 * t435 * t146 * t697 * t1780 * t4651 - t2473 * t1889 / 0.3e1 - t912 * t4830 / 0.4e1 - 0.7e2 / 0.81e2 * t4789 * t937 - 0.4e1 * t930 * t1886 + t2473 * t1854 / 0.6e1 + 0.7e1 / 0.18e2 * t5856 * t687 + 0.5e1 / 0.6e1 * t5843 * t690 - 0.128e3 / 0.9e1 * t4754 * t5743 + t2477 * t1851 / 0.6e1 + 0.2e1 / 0.9e1 * t5749 * t687 - 0.112e3 / 0.9e1 * t1839 * t2507 + 0.112e3 / 0.9e1 * t1839 * t2519 + t686 * t5735 / 0.3e1 - 0.16e2 / 0.3e1 * t676 * t5738 - 0.32e2 / 0.9e1 * t4782 * t2519 - 0.4e1 / 0.3e1 * t6218 * t6220 - 0.16e2 * t6224 * t6226 + 0.4e1 / 0.9e1 * t4395 * t2315 + t6268 + t6113 + t6042 + t5983 + t5920 + t5850 - 0.864e4 * t89 * t698 * t1780 * t1877 + 0.592e3 / 0.9e1 * t132 * t1297 * t1754 * t2358 + t270 * params->alpha * (-0.35e2 / 0.81e2 * t46 * t6069 * t92 - 0.91e2 / 0.54e2 * t166 * t6019 * t278 + 0.317e3 / 0.324e3 * t490 * t1737 * t726 * t81 - 0.49e2 / 0.972e3 * t490 * t1754 * t2387 + t490 * t1780 * t4543 * t697 * t147 / 0.162e3 - 0.35e2 / 0.81e2 * t51 * t353 * t1720) * t106 - 0.4e1 * t5753 * t2414 * t287 + 0.4e1 * t5753 * t2414 * t302 - 0.28e3 / 0.27e2 * t710 * t1760 * t375 - 0.3e1 * t930 * t380 * t1716 - 0.3e1 / 0.2e1 * t930 * t2324 * t4586 - 0.3e1 / 0.2e1 * t930 * t2324 * t4590 + 0.144e3 * t922 * t925 * t745 + 0.16e4 / 0.3e1 * t699 * t1834 * t375 + 0.44e2 / 0.3e1 * t1349 * t1747 * t2347 - 0.14e3 / 0.27e2 * t254 * t6069 * t266 - t270 * t374 * t4402 - t270 * t1811 * t968 - 0.3e1 * t270 * t734 * t2449 - 0.3e1 * t270 * t957 * t1817 - t270 * t291 * t6189 + 0.4e1 / 0.9e1 * t4395 * t2303 + 0.8e1 / 0.81e2 * t1829 * t6048 - 0.2e1 * t906 * t4758 + 0.2e1 * t906 * t4750 - 0.1e2 * t2336 * t1845 - 0.35e2 / 0.81e2 * t354 * t1923 + t912 * t4596 / 0.4e1 + t912 * t4605 / 0.4e1 - t912 * t4587 / 0.8e1 - t912 * t4591 / 0.8e1 + 0.64e2 / 0.9e1 * t1864 * t6003 - 0.1536e4 * t1873 * t6007 + 0.1e2 * t2336 * t1848));
  tv4rho3sigma11 = t6 * t6277 + 0.3e1 * t2559;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t6284 = t5 * t413 * t1084;
  t6291 = t5 * t422 * t1084 / 0.12e2;
  t6293 = t5 * t128 * t2800;
  t6313 = t184 * t2683;
  t6336 = -0.6e1 * t1059 * t1230 * t162 * t537 + 0.24e2 * t1059 * t162 * t3508 * t511 - 0.6e1 * t1081 * t1230 * t162 * t511 + 0.2e1 * t1081 * t162 * t510 * t537 + 0.4e1 * t162 * t197 * t2683 * t510 - t1053 * t1341 * t162 + 0.2e1 * t1053 * t1345 * t162 - 0.2e1 * t162 * t180 * t6313 - 0.2e1 * t162 * t1988 * t850 - 0.4e1 * t162 * t2185 * t839 - 0.2e1 * t162 * t2704 * t504 - 0.2e1 * t162 * t334 * t5284;
  t6357 = t525 * t1054;
  t6360 = t525 * t1060;
  t6363 = t188 * t2684;
  t6366 = t525 * t1082;
  t6369 = -t162 * t501 * t2733 + 0.4e1 * t162 * t510 * t344 * t2182 + 0.2e1 * t162 * t501 * t2707 - t794 * t5080 / 0.12e2 - 0.2e1 / 0.9e1 * t2011 * t2051 - 0.4e1 / 0.27e2 * t5136 * t844 + 0.8e1 / 0.3e1 * t5140 * t2157 * t345 - 0.2e1 / 0.3e1 * t2741 * t480 + 0.16e2 / 0.9e1 * t441 * t6357 + 0.32e2 / 0.9e1 * t441 * t6360 + 0.2e1 / 0.9e1 * t451 * t6363 - 0.16e2 / 0.9e1 * t441 * t6366;
  t6384 = t132 * t2700;
  t6395 = t188 * t2705;
  t6401 = t1349 * t2567 * t41;
  t6403 = 0.8e1 / 0.3e1 * t476 * t193 * t2684 - 0.8e1 / 0.3e1 * t476 * t193 * t2705 + 0.2e1 / 0.9e1 * t2011 * t2042 + 0.4e1 / 0.27e2 * t5136 * t819 - 0.8e1 / 0.3e1 * t5140 * t2157 * t335 - t6384 * t455 / 0.18e2 - 0.7e1 / 0.108e3 * t435 * t1009 * t439 * t443 + t6384 * t452 / 0.18e2 - t812 * t340 * t2183 - 0.2e1 / 0.9e1 * t451 * t6395 - t1011 * t3809 / 0.4e1 - t6401 * t1388;
  t6418 = 0.1e1 / t35 / t4931;
  t6431 = t1349 * t2567 * t137;
  t6434 = t1978 * t3563;
  t6440 = t1011 * t3906 / 0.4e1 + t6401 * t1392 + 0.2e1 / 0.3e1 * t2741 * t477 + t2741 * t2039 / 0.4e1 + 0.2e1 / 0.3e1 * t2770 * t1388 - t2741 * t2036 / 0.4e1 - 0.2e1 / 0.3e1 * t2770 * t1392 - 0.864e4 * t42 * t464 * t6418 * t3890 + t812 * t340 * t1989 - 0.7e1 / 0.27e2 * t1379 * t2792 + 0.28e2 / 0.9e1 * t476 * t529 * t1054 - t6431 * t452 / 0.18e2 - t1349 * t6434 * t29 * t3565 * t64 / 0.162e3;
  t6443 = t1978 * t137;
  t6448 = t3866 * t2592;
  t6453 = t1978 * t1283;
  t6459 = t3532 * t2031;
  t6482 = 0.4e1 / 0.27e2 * t1349 * t6443 * t138 * t3853 + 0.128e3 * t3865 * t6448 + t6431 * t455 / 0.18e2 + t1349 * t6453 * t43 * t471 * t3559 / 0.81e2 + 0.8e1 / 0.3e1 * t435 * t6459 * t41 * t2108 * t1411 + 0.8e1 / 0.3e1 * t5072 * t5030 * t2088 - 0.96e2 * t5077 * t5165 - 0.16e2 / 0.3e1 * t5072 * t157 * t2062 + 0.192e3 * t5077 * t5108 + 0.8e1 / 0.3e1 * t5072 * t5030 * t2074 - 0.96e2 * t5077 * t5111 + t2766 * t1398 / 0.48e2;
  t6502 = t42 * t803 * t2031;
  t6511 = -t2766 * t1395 / 0.48e2 + t794 * t5115 / 0.12e2 + 0.7e1 / 0.27e2 * t5151 * t819 - 0.28e2 / 0.9e1 * t812 * t2057 - t2766 * t1376 / 0.24e2 - 0.2e1 / 0.9e1 * t2005 * t2042 - 0.5e1 / 0.9e1 * t5126 * t819 + 0.7e1 / 0.27e2 * t1379 * t2754 + t1011 * t3870 / 0.2e1 + 0.2232e4 * t6502 * t1364 - 0.8e1 / 0.3e1 * t812 * t2048 + 0.8e1 / 0.3e1 * t812 * t1991 - t2741 * t1999 / 0.2e1;
  t6526 = t132 * t2639 * t138;
  t6531 = t42 * t1027 * t1029;
  t6550 = -0.28e2 / 0.9e1 * t476 * t529 * t1082 + 0.2e1 / 0.9e1 * t2005 * t2051 + 0.5e1 / 0.9e1 * t5126 * t844 + 0.14e2 / 0.27e2 * t1379 * t2786 + 0.56e2 / 0.9e1 * t476 * t529 * t1060 - 0.2e1 * t6526 * t1314 * t198 + 0.18e2 * t6531 * t3867 + 0.2e1 * t6526 * t1314 * t181 - 0.32e2 / 0.3e1 * t5228 * t3866 * t333 * t63 * sigma[0] + 0.32e2 / 0.3e1 * t5228 * t1410 * t850 * sigma[0] + 0.28e2 / 0.9e1 * t812 * t1994 - 0.7e1 / 0.27e2 * t5151 * t844;
  t6551 = t1416 * t1081;
  t6552 = t1425 * t6551;
  t6558 = t1052 * t184;
  t6559 = t6558 * t197;
  t6560 = t1425 * t6559;
  t6587 = 0.2e1 / 0.9e1 * t451 * t6552 + 0.8e1 / 0.3e1 * t476 * t1415 * t6551 + 0.2e1 / 0.9e1 * t451 * t6560 + 0.8e1 / 0.3e1 * t476 * t1415 * t6559 - t1011 * t3683 / 0.24e2 - t794 * t5380 / 0.2e1 - 0.14e2 / 0.27e2 * t1379 * t2593 - 0.56e2 / 0.9e1 * t476 * t3674 * t2592 + t794 * t5311 / 0.6e1 - 0.6e1 * t812 * t2586 * t5379 + 0.8e1 / 0.3e1 * t812 * t2095 + 0.2e1 * t812 * t2066 * t5310 + t794 * t5410 / 0.3e1;
  t6593 = t1421 * t1060;
  t6596 = t5334 * t344;
  t6597 = t1425 * t6596;
  t6603 = t2087 * t875;
  t6604 = t1425 * t6603;
  t6611 = t1229 * t1059 * t197;
  t6612 = t2060 * t6611;
  t6618 = t2061 * t875;
  t6619 = t2060 * t6618;
  t6625 = t2213 * t1059;
  t6626 = t1425 * t6625;
  t6632 = -t794 * t5325 / 0.6e1 - 0.8e1 / 0.27e2 * t441 * t6593 + 0.4e1 / 0.9e1 * t451 * t6597 + 0.16e2 / 0.3e1 * t476 * t1415 * t6596 + 0.4e1 / 0.9e1 * t451 * t6604 + 0.16e2 / 0.3e1 * t476 * t1415 * t6603 + 0.4e1 / 0.3e1 * t451 * t6612 + 0.16e2 * t476 * t2080 * t6611 - 0.8e1 / 0.9e1 * t451 * t6619 - 0.32e2 / 0.3e1 * t476 * t2080 * t6618 - 0.4e1 / 0.9e1 * t451 * t6626 - 0.16e2 / 0.3e1 * t476 * t1415 * t6625;
  t6634 = t509 * t1081 * t197;
  t6635 = t2060 * t6634;
  t6641 = t1421 * t1054;
  t6662 = t1421 * t1082;
  t6665 = -0.4e1 / 0.9e1 * t451 * t6635 - 0.16e2 / 0.3e1 * t476 * t2080 * t6634 - 0.4e1 / 0.27e2 * t441 * t6641 - t1011 * t3725 / 0.2e1 + 0.432e3 * t2747 * t3753 - 0.432e3 * t2747 * t3758 - 0.2e1 * t812 * t2066 * t5335 + 0.4e1 * t812 * t2586 * t5360 + 0.4e1 / 0.9e1 * t2011 * t2063 - 0.2e1 / 0.9e1 * t2011 * t2075 + t2741 * t2067 / 0.2e1 + 0.4e1 / 0.27e2 * t441 * t6662;
  t6671 = t3724 * t2592;
  t6693 = 0.2e1 / 0.9e1 * t2005 * t2075 + t794 * t5413 / 0.6e1 - 0.32e2 / 0.9e1 * t441 * t6671 + 0.2e1 / 0.9e1 * t2005 * t2089 - 0.16e2 / 0.3e1 * t812 * t2081 + 0.8e1 / 0.3e1 * t812 * t2084 + 0.2e1 * t812 * t2586 * t5365 - t812 * t2066 * t5320 - t812 * t2066 * t5339 - t2770 * t1429 / 0.18e2 + t2766 * t1426 / 0.24e2 + t2770 * t1422 / 0.18e2;
  t6710 = t1300 * t58 * t1363;
  t6723 = -t794 * t5336 / 0.6e1 - 0.2e1 / 0.9e1 * t2011 * t2089 - 0.2e1 * t812 * t2066 * t5324 + 0.1152e4 * t2033 * t5452 + 0.16e2 / 0.3e1 * t2027 * t5432 - 0.1152e4 * t2033 * t5437 - t1011 * t3694 / 0.48e2 + 0.16e2 / 0.3e1 * t6502 * t6710 - 0.16e2 / 0.3e1 * t2027 * t5448 - t794 * t5321 / 0.12e2 + t1011 * t3686 / 0.48e2 - t794 * t5340 / 0.12e2 - 0.4e1 / 0.9e1 * t2005 * t2063;
  t6726 = t1003 * t430;
  t6730 = t1008 * t439;
  t6734 = t312 * t467;
  t6811 = 0.1e1 / t3535;
  t6819 = 0.8e1 / 0.3e1 * t518 * t6459 * t41 * t34 * t1300 - 0.7e1 / 0.9e1 * t192 * t1004 * t529 + 0.2232e4 * t2676 * t2179 - 0.864e4 * t2177 * t6418 * t3525 * t3527 - 0.7e1 / 0.108e3 * t187 * t6726 * t188 - 0.7e1 / 0.108e3 * t1066 * t521 + t1281 * t6453 * t43 * t41 * t33 / 0.81e2 - t1281 * t6434 * t33 * t188 / 0.162e3 + 0.4e1 / 0.27e2 * t1281 * t6443 * t138 * t29 * t3618 + 0.16e2 / 0.3e1 * t1281 * t34 * t2031 * t3578 - 0.9e1 * t187 * t2174 + 0.7e1 / 0.9e1 * t524 * t6730 * t525 + 0.19e2 / 0.108e3 * t2651 * t2106 * t188 - 0.19e2 / 0.6e1 * t2651 * t2112 * t525 - 0.2e1 / 0.27e2 * t1281 * t1978 * t3619 - 0.19e2 / 0.216e3 * t2651 * t467 * t1283 * t43 - 0.46e2 / 0.3e1 * t1298 * t2161 * t469 + 0.576e3 * t3585 * t6811 * t3502 * sigma[0] - 0.104e3 * t533 * t6734 * t469;
  t6822 = t875 * t875;
  t6832 = t1349 * t6734;
  t6854 = t162 * params->alpha * (-0.7e1 / 0.108e3 * t46 * t6726 * t48 + 0.7e1 / 0.216e3 * t167 * t6730 * t172 - 0.4e1 / 0.27e2 * t490 * t6734 * t493 + 0.35e2 / 0.2592e4 * t1979 * t2697 - t490 * t2031 * t3640 * t28 * t146 * t34 / 0.432e3 - 0.7e1 / 0.108e3 * t51 * t1004 * t430) * t63 - t162 * t185 * t6819 + 0.4e1 * t162 * t510 * t6822 - 0.104e3 * t1028 * t472 + 0.576e3 * t3496 * sigma[0] * t6811 * t3503 - 0.19e2 / 0.216e3 * t6832 * t1352 + 0.4e1 * t2212 * t2213 * t2711 + 0.8e1 * t2212 * t2580 * t2189 - 0.24e2 * t5039 * t5040 * t2189 - 0.12e2 * t2212 * t5044 * t2725 + 0.8e1 * t2212 * t2213 * t2729 + 0.8e1 * t2212 * t838 * t509 * t853;
  t6855 = t333 * t1229;
  t6887 = -0.12e2 * t2212 * t6855 * t2207 - 0.46e2 / 0.3e1 * t2120 * t2575 + 0.64e2 * t465 * t470 * t1082 + 0.8e1 / 0.3e1 * t788 * t5243 + 0.2e1 / 0.27e2 * t2219 * t5481 + 0.9e1 * t1028 * t1030 * t538 - 0.9e1 * t1028 * t1030 * t502 + 0.304e3 * t804 * t2137 + 0.2e2 / 0.3e1 * t2103 * t2045 - 0.304e3 * t804 * t2134 - t2568 * t3786 / 0.36e2 - 0.2e1 / 0.27e2 * t1349 * t6453 * t3853 + t2568 * t3789 / 0.36e2;
  t6917 = -0.9e1 * t132 * t32 * t1978 * t1412 - 0.2e2 / 0.3e1 * t2103 * t2054 + 0.7e1 / 0.9e1 * t1014 * t448 - 0.48e2 * t1028 * t2127 + 0.48e2 * t1028 * t2130 - 0.8e1 / 0.3e1 * t788 * t5179 + 0.96e2 * t804 * t807 * t840 - 0.96e2 * t804 * t807 * t876 - 0.4e1 * t2574 * t3814 + 0.4e1 * t2574 * t3909 - 0.2e1 / 0.27e2 * t2219 * t5487 + 0.19e2 / 0.108e3 * t6832 * t1444;
  t6935 = t2211 * t333 * t2062;
  t6939 = t5030 * t333 * t2062;
  t6943 = t3477 * t1041 * t41;
  t6947 = t5021 * t319 * t138;
  t6952 = t5028 * t330;
  t6958 = -0.19e2 / 0.6e1 * t6832 * t1447 - 0.64e2 * t465 * t470 * t1054 - 0.128e3 * t465 * t470 * t1060 - 0.7e1 / 0.108e3 * t1005 * t432 - 0.7e1 / 0.9e1 * t143 * t6726 * t158 - 0.18e2 * t1028 * t1030 * t512 - 0.8e1 / 0.9e1 * t5023 * t6935 - 0.32e2 / 0.3e1 * t5029 * t6939 + t6943 * t1426 / 0.24e2 + t6947 * t5025 / 0.3e1 + 0.8e1 / 0.27e2 * t3479 * t2593 + 0.4e1 * t6952 * t5032 + 0.4e1 * t2212 * t2580 * t2193;
  t6967 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t409 * t1084 - t6284 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t122 * t2800 + t6291 - t6293 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t6336 + t6369 + t6403 + t6440 + t6482 + t6511 + t6550 + t6587 + t6632 + t6665 + t6693 + t6723 + t6854 + t6887 + t6917 + t6958));
  tv4rho2sigma20 = t6 * t6967 + 0.2e1 * t2805;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t6974 = t5 * t563 * t1170;
  t6978 = t5 * t567 * t1170 / 0.12e2;
  t6980 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t559 * t1170 - t6974 / 0.4e1 + t6978);
  tv4rho2sigma25 = t6 * t6980 + 0.2e1 * t2814;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6986 = t5 * t588 * t1084;
  t6994 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t584 * t1084 - t6986 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t2800 - t6284 / 0.8e1 + t6291 - t6293 / 0.8e1);
  tv4rho2sigma26 = t6 * t6994 + t2805 + t2820;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t7000 = t5 * t612 * t1170;
  t7007 = t5 * t216 * t3058;
  t7010 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t608 * t1170 - t7000 / 0.8e1 - t6974 / 0.8e1 + t6978 - 0.3e1 / 0.8e1 * t5 * t212 * t3058 - t7007 / 0.8e1);
  tv4rho2sigma211 = t6 * t7010 + t2814 + t3063;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t7018 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t639 * t1084 - t6986 / 0.4e1 + t6291);
  tv4rho2sigma212 = t6 * t7018 + 0.2e1 * t2820;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t7033 = t290 * t2870;
  t7057 = t1089 * t666;
  t7061 = t1094 * t674;
  t7065 = t352 * t701;
  t7088 = 0.1e1 / t4435;
  t7104 = 0.1e1 / t82 / t6158;
  t7109 = t2354 * t4471;
  t7114 = t2354 * t248;
  t7120 = t3532 * t2437;
  t7156 = 0.16e2 / 0.3e1 * t1281 * t81 * t2437 * t4486 + 0.576e3 * t3585 * t7088 * t4711 * sigma[2] - 0.104e3 * t764 * t7065 * t703 - 0.19e2 / 0.216e3 * t2835 * t701 * t1738 * t90 - 0.46e2 / 0.3e1 * t1298 * t2418 * t703 - 0.864e4 * t2435 * t7104 * t4428 * t3527 - t1281 * t7109 * t33 * t292 / 0.162e3 + 0.4e1 / 0.27e2 * t1281 * t7114 * t249 * t29 * t4467 + 0.8e1 / 0.3e1 * t518 * t7120 * t88 * t81 * t1756 - 0.7e1 / 0.9e1 * t296 * t1090 * t760 + 0.2232e4 * t2863 * t2439 - 0.7e1 / 0.108e3 * t187 * t7057 * t292 - 0.7e1 / 0.108e3 * t1152 * t753 + t1281 * t2354 * t1738 * t90 * t88 * t33 / 0.81e2 - 0.9e1 * t187 * t2432 + 0.7e1 / 0.9e1 * t524 * t7061 * t756 + 0.19e2 / 0.108e3 * t2835 * t2339 * t292 - 0.19e2 / 0.6e1 * t2835 * t2345 * t756 - 0.2e1 / 0.27e2 * t1281 * t2354 * t4468;
  t7159 = t993 * t993;
  t7165 = 0.4e1 * t270 * t743 * t2870 * t301 - 0.2e1 * t270 * t286 * t7033 - 0.2e1 * t270 * t2394 * t968 - 0.4e1 * t270 * t957 * t2449 - 0.2e1 * t270 * t2891 * t737 - 0.6e1 * t270 * t1714 * t1167 * t744 + 0.24e2 * t270 * t4557 * t1145 * t744 + 0.2e1 * t270 * t1139 * t1825 + t270 * params->alpha * (-0.7e1 / 0.108e3 * t46 * t7057 * t92 + 0.7e1 / 0.216e3 * t167 * t7061 * t278 - 0.4e1 / 0.27e2 * t490 * t7065 * t726 + 0.35e2 / 0.2592e4 * t2385 * t2884 - t490 * t2437 * t4543 * t28 * t146 * t81 / 0.432e3 - 0.7e1 / 0.108e3 * t51 * t1090 * t666) * t106 - t270 * t291 * t7156 + 0.4e1 * t270 * t743 * t7159 + 0.14e2 / 0.27e2 * t1842 * t2997;
  t7181 = t89 * t1113 * t1115;
  t7196 = 0.2232e4 * t89 * t921 * t2437 * t1877 + 0.2e1 / 0.3e1 * t3023 * t711 + 0.7e1 / 0.27e2 * t5856 * t937 - 0.28e2 / 0.9e1 * t930 * t2527 + 0.28e2 / 0.9e1 * t930 * t2534 - 0.7e1 / 0.27e2 * t5856 * t962 + 0.18e2 * t7181 * t4825 + 0.2e1 / 0.9e1 * t2473 * t2516 + 0.5e1 / 0.9e1 * t5843 * t962 - 0.16e2 / 0.3e1 * t5773 * t265 * t2295 + 0.8e1 / 0.3e1 * t5773 * t5774 * t2302 - 0.8e1 / 0.3e1 * t930 * t2511;
  t7209 = t4824 * t2952;
  t7226 = 0.8e1 / 0.3e1 * t5773 * t5774 * t2314 - 0.96e2 * t5779 * t5767 + 0.8e1 / 0.3e1 * t930 * t2522 + 0.192e3 * t5779 * t5784 - 0.96e2 * t5779 * t5787 + 0.128e3 * t4823 * t7209 - t3026 * t1889 / 0.24e2 - t3023 * t2530 / 0.2e1 - 0.28e2 / 0.9e1 * t710 * t760 * t1168 + t1097 * t4774 / 0.2e1 + 0.56e2 / 0.9e1 * t710 * t760 * t1146 - 0.7e1 / 0.27e2 * t1842 * t3003;
  t7242 = t4733 * t32;
  t7256 = t132 * t2964 * t249;
  t7261 = t1349 * t2857 * t248;
  t7265 = t1349 * t2857 * t88;
  t7270 = 0.7e1 / 0.27e2 * t1842 * t3053 + 0.28e2 / 0.9e1 * t710 * t760 * t1140 - 0.8e1 / 0.3e1 * t710 * t297 * t2892 + 0.2e1 / 0.3e1 * t3030 * t1845 - 0.2e1 / 0.3e1 * t3030 * t1848 + t1349 * t2354 * t88 * t1738 * t102 * t7242 / 0.81e2 - t1349 * t7109 * t29 * t4473 * t107 / 0.162e3 + 0.4e1 / 0.27e2 * t1349 * t7114 * t249 * t4811 + 0.2e1 * t7256 * t1771 * t287 + t7261 * t690 / 0.18e2 - t7265 * t1845 - t7261 * t687 / 0.18e2 + t7265 * t1848;
  t7286 = t756 * t1168;
  t7293 = t756 * t1140;
  t7296 = t756 * t1146;
  t7299 = t292 * t2871;
  t7302 = -0.2e1 / 0.9e1 * t2473 * t2504 - 0.5e1 / 0.9e1 * t5843 * t937 - 0.2e1 * t7256 * t1771 * t302 + t912 * t5798 / 0.12e2 + 0.2e1 / 0.9e1 * t2477 * t2504 + 0.4e1 / 0.27e2 * t5749 * t937 - 0.16e2 / 0.9e1 * t676 * t7286 - t1097 * t4750 / 0.4e1 - t930 * t380 * t2443 + 0.16e2 / 0.9e1 * t676 * t7293 + 0.32e2 / 0.9e1 * t676 * t7296 + 0.2e1 / 0.9e1 * t686 * t7299;
  t7315 = t1349 * t2345 * t81;
  t7329 = t292 * t2892;
  t7341 = t132 * t2887;
  t7344 = 0.8e1 / 0.3e1 * t710 * t297 * t2871 - t3023 * t2498 / 0.4e1 - 0.864e4 * t89 * t698 * t7104 * t4735 + t930 * t380 * t2395 - 0.8e1 / 0.3e1 * t7315 * t2507 - 0.32e2 / 0.3e1 * t5887 * t4824 * t373 * t106 * sigma[2] + 0.8e1 / 0.3e1 * t7315 * t2519 + 0.32e2 / 0.3e1 * t5887 * t1866 * t968 * sigma[2] - 0.2e1 / 0.9e1 * t686 * t7329 - t3026 * t1851 / 0.48e2 + 0.8e1 / 0.3e1 * t435 * t7120 * t88 * t2341 * t1867 + t3023 * t2501 / 0.4e1 - t7341 * t690 / 0.18e2;
  t7372 = -0.7e1 / 0.108e3 * t435 * t1095 * t674 * t678 + t7341 * t687 / 0.18e2 + t3026 * t1854 / 0.48e2 - t912 * t5735 / 0.12e2 - 0.2e1 / 0.9e1 * t2477 * t2516 - 0.4e1 / 0.27e2 * t5749 * t962 - 0.2e1 / 0.3e1 * t3023 * t714 + t1097 * t4758 / 0.4e1 - 0.4e1 / 0.9e1 * t2473 * t2296 + 0.2e1 / 0.9e1 * t2473 * t2303 - t1097 * t4599 / 0.24e2 + t3030 * t1904 / 0.18e2;
  t7404 = t912 * t5715 / 0.6e1 - 0.6e1 * t930 * t2940 * t5690 - t3030 * t1901 / 0.18e2 + 0.2e1 * t930 * t2324 * t5714 - 0.14e2 / 0.27e2 * t1842 * t2953 - 0.56e2 / 0.9e1 * t710 * t4575 * t2952 - t912 * t5691 / 0.2e1 - 0.16e2 / 0.3e1 * t930 * t2307 + 0.8e1 / 0.3e1 * t930 * t2310 + 0.4e1 * t930 * t2940 * t5664 + 0.2e1 * t930 * t2940 * t5671 - t930 * t2324 * t5906 + t912 * t5665 / 0.3e1;
  t7420 = t5939 * t384;
  t7421 = t1894 * t7420;
  t7424 = t2313 * t993;
  t7425 = t1894 * t7424;
  t7428 = t4622 * t2952;
  t7439 = t912 * t5672 / 0.6e1 + 0.4e1 / 0.9e1 * t2477 * t2296 - t912 * t5913 / 0.12e2 - t912 * t5682 / 0.6e1 - 0.2e1 / 0.9e1 * t2477 * t2303 + 0.8e1 / 0.3e1 * t930 * t2321 + 0.4e1 / 0.9e1 * t686 * t7421 + 0.4e1 / 0.9e1 * t686 * t7425 - 0.32e2 / 0.9e1 * t676 * t7428 + 0.16e2 / 0.3e1 * t710 * t1907 * t7420 + 0.16e2 / 0.3e1 * t710 * t1907 * t7424 - t912 * t5900 / 0.12e2;
  t7470 = -0.2e1 / 0.9e1 * t2477 * t2315 + 0.432e3 * t3046 * t4659 + 0.16e2 / 0.3e1 * t435 * t146 * t2437 * t88 * t2341 * t462 * t1867 - 0.432e3 * t3046 * t4664 - 0.16e2 / 0.3e1 * t2491 * t6003 + 0.1152e4 * t2495 * t6007 + 0.16e2 / 0.3e1 * t2491 * t5957 - 0.1152e4 * t2495 * t5962 - 0.2e1 * t930 * t2324 * t5681 + t1097 * t4579 / 0.48e2 - t1097 * t4582 / 0.48e2 + 0.2e1 / 0.9e1 * t2473 * t2315;
  t7477 = t1900 * t1140;
  t7481 = t1713 * t1145 * t301;
  t7482 = t2293 * t7481;
  t7488 = t2294 * t993;
  t7489 = t2293 * t7488;
  t7495 = t2541 * t1145;
  t7496 = t1894 * t7495;
  t7503 = t742 * t1167 * t301;
  t7504 = t2293 * t7503;
  t7510 = t1895 * t1167;
  t7511 = t1894 * t7510;
  t7514 = -0.2e1 * t930 * t2324 * t5940 - t930 * t2324 * t5899 - 0.4e1 / 0.27e2 * t676 * t7477 + 0.4e1 / 0.3e1 * t686 * t7482 + 0.16e2 * t710 * t2306 * t7481 - 0.8e1 / 0.9e1 * t686 * t7489 - 0.32e2 / 0.3e1 * t710 * t2306 * t7488 - 0.4e1 / 0.9e1 * t686 * t7496 - 0.16e2 / 0.3e1 * t710 * t1907 * t7495 - 0.4e1 / 0.9e1 * t686 * t7504 - 0.16e2 / 0.3e1 * t710 * t2306 * t7503 + 0.2e1 / 0.9e1 * t686 * t7511;
  t7518 = t1138 * t290;
  t7519 = t7518 * t301;
  t7520 = t1894 * t7519;
  t7534 = t1900 * t1146;
  t7537 = t1900 * t1168;
  t7541 = t2539 * t373 * t2295;
  t7547 = t5774 * t373 * t2295;
  t7551 = t3477 * t1127 * t88;
  t7554 = 0.8e1 / 0.3e1 * t710 * t1907 * t7510 + 0.2e1 / 0.9e1 * t686 * t7520 + 0.8e1 / 0.3e1 * t710 * t1907 * t7519 + t3023 * t2325 / 0.2e1 - t912 * t5954 / 0.6e1 + t3026 * t1897 / 0.24e2 - t1097 * t4623 / 0.2e1 - 0.8e1 / 0.27e2 * t676 * t7534 + 0.4e1 / 0.27e2 * t676 * t7537 - 0.8e1 / 0.9e1 * t6218 * t7541 + 0.8e1 / 0.27e2 * t4395 * t2953 - 0.32e2 / 0.3e1 * t6224 * t7547 + t7551 * t1897 / 0.24e2;
  t7557 = t6223 * t370;
  t7561 = t5021 * t359 * t249;
  t7587 = 0.4e1 * t7557 * t6226 + t7561 * t6220 / 0.3e1 + 0.304e3 * t922 * t2372 - t2921 * t4681 / 0.36e2 + t2921 * t4684 / 0.36e2 + 0.9e1 * t1114 * t1116 * t769 - 0.9e1 * t1114 * t1116 * t735 + 0.96e2 * t922 * t925 * t958 - 0.2e2 / 0.3e1 * t2336 * t2519 + 0.2e2 / 0.3e1 * t2336 * t2507 - 0.304e3 * t922 * t2369 + 0.7e1 / 0.9e1 * t1100 * t683;
  t7588 = t1349 * t7065;
  t7605 = t32 * t1738 * t266;
  t7626 = 0.19e2 / 0.108e3 * t7588 * t1934 + 0.48e2 * t1114 * t2366 - 0.48e2 * t1114 * t2363 - 0.18e2 * t1114 * t1116 * t745 - 0.9e1 * t132 * t32 * t2354 * t1868 - 0.2e1 / 0.27e2 * t1349 * t2354 * t29 * t7605 - 0.8e1 / 0.3e1 * t906 * t5810 - 0.7e1 / 0.108e3 * t1091 * t668 - 0.7e1 / 0.9e1 * t254 * t7057 * t266 - 0.64e2 * t699 * t704 * t1140 - 0.128e3 * t699 * t704 * t1146 + 0.64e2 * t699 * t704 * t1168 - 0.4e1 * t2925 * t4755;
  t7662 = 0.4e1 * t2925 * t4761 - 0.2e1 / 0.27e2 * t2547 * t6048 + 0.2e1 / 0.27e2 * t2547 * t6034 + 0.8e1 / 0.3e1 * t906 * t5738 - 0.96e2 * t922 * t925 * t994 - 0.19e2 / 0.6e1 * t7588 * t1937 + 0.8e1 * t2540 * t2541 * t2903 + 0.4e1 * t2540 * t2541 * t2911 + 0.576e3 * t3496 * t7088 * t249 * t1874 * t106 * sigma[2] - 0.46e2 / 0.3e1 * t2356 * t2926 + 0.8e1 * t2540 * t956 * t742 * t971 + 0.8e1 * t2540 * t2931 * t2465;
  t7676 = t373 * t1713;
  t7702 = -0.24e2 * t6258 * t5689 * t2465 - 0.12e2 * t2540 * t6238 * t2899 - 0.104e3 * t1114 * t706 - 0.19e2 / 0.216e3 * t7588 * t1831 + 0.4e1 * t2540 * t2931 * t2469 - 0.12e2 * t2540 * t7676 * t2456 + 0.4e1 * t270 * t743 * t384 * t2442 + 0.2e1 * t270 * t734 * t2907 + 0.2e1 * t270 * t743 * t1167 * t768 - t270 * t1139 * t1817 - 0.2e1 * t270 * t374 * t6099 - 0.6e1 * t270 * t1714 * t1145 * t768 - t270 * t734 * t2894;
  t7711 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t656 * t1170 - t7000 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t3058 + t6978 - t7007 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t80 * (t7165 + t7196 + t7226 + t7270 + t7302 + t7344 + t7372 + t7404 + t7439 + t7470 + t7514 + t7554 + t7587 + t7626 + t7662 + t7702));
  tv4rho2sigma217 = t6 * t7711 + 0.2e1 * t3063;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t7718 = t5 * t128 * t3238 / 0.8e1;
  t7731 = t184 * t3119;
  t7734 = 0.1e1 / t1321;
  t7749 = t1229 * t3140;
  t7780 = 0.2e1 * t162 * t510 * t3119 * t197 + 0.6e1 * t162 * t510 * t875 * t1081 + 0.6e1 * t162 * t510 * t344 * t2683 - t162 * t180 * t7731 - 0.216e3 * t3496 * t7734 * t3503 - 0.3e1 * t162 * t334 * t6313 + 0.24e2 * t162 * t3508 * t3140 * t197 - 0.18e2 * t162 * t1230 * t1059 * t875 - 0.6e1 * t162 * t180 * t7749 + 0.6e1 * t162 * t839 * t2707 - t162 * t3137 * t504 - 0.3e1 * t162 * t2704 * t850 - 0.3e1 * t162 * t1053 * t2185 - 0.3e1 * t162 * t839 * t2733 - 0.72e2 * t1028 * t2616 + 0.72e2 * t1028 * t2613 + t3176 * t2625 / 0.2e1 - 0.4e1 * t788 * t6360 + 0.144e3 * t804 * t807 * t1060 + t2568 * t5487 / 0.24e2;
  t7786 = t3065 * t136;
  t7828 = -t2568 * t5481 / 0.24e2 - 0.27e2 * t1028 * t1030 * t840 - t143 * t7786 * t158 / 0.2e1 - 0.6e1 * t2574 * t5170 + t3157 * t3786 / 0.192e3 - t3157 * t3789 / 0.192e3 - 0.9e1 * t3161 * t2636 + 0.9e1 * t3161 * t2609 - 0.2e1 * t788 * t6357 + 0.72e2 * t804 * t807 * t1054 + 0.2e1 * t788 * t6366 - 0.72e2 * t804 * t807 * t1082 + 0.6e1 * t2574 * t5182 + t3184 * t2664 * t1411 + 0.27e2 * t1028 * t1030 * t876 - t3195 * t140 / 0.24e2 + 0.4e1 * t5072 * t5030 * t2592 - 0.144e3 * t5077 * t6448 - t6431 * t819 / 0.12e2 - t2005 * t2786 / 0.3e1;
  t7832 = t1008 * t2572;
  t7836 = t32 * t1283 * t158;
  t7840 = t1349 * t3102 * t41;
  t7844 = t132 * t3183 * t3093;
  t7864 = t3532 * t312;
  t7877 = t188 * t3120;
  t7883 = t188 * t3138;
  t7886 = -0.4e1 * t812 * t2789 + t1349 * t7832 * t29 * t7836 / 0.36e2 - 0.3e1 / 0.16e2 * t7840 * t1392 + 0.3e1 / 0.4e1 * t7844 * t3814 + 0.3e1 / 0.2e1 * t6401 * t2045 + t2011 * t2786 / 0.3e1 + t6431 * t844 / 0.12e2 - 0.3e1 / 0.2e1 * t6401 * t2054 + 0.27e2 * t6531 * t5165 + 0.3e1 * t6526 * t1314 * t335 + 0.3e1 / 0.8e1 * t3225 * t1388 + 0.3e1 / 0.4e1 * t1011 * t5179 - t435 * t7864 * t2678 * t3882 - 0.3e1 / 0.4e1 * t7844 * t3909 - 0.54e2 * t6531 * t5108 - 0.3e1 * t6526 * t1314 * t345 + 0.27e2 * t6531 * t5111 + t451 * t7877 / 0.9e1 + 0.4e1 / 0.3e1 * t476 * t193 * t3120 - t451 * t7883 / 0.9e1;
  t7890 = t188 * t3141;
  t7899 = t1349 * t3102 * t137;
  t7916 = t42 * t33 * t3065;
  t7924 = 0.1e1 / t35 / t3535;
  t7936 = t42 * t1027 * t2678;
  t7945 = -t2011 * t2792 / 0.6e1 - 0.3e1 / 0.8e1 * t7916 * t816 + 0.3e1 / 0.8e1 * t7916 * t813 + 0.3e1 / 0.4e1 * t2741 * t2752 + 0.324e4 * t42 * t803 * t7924 * t3890 + 0.3e1 / 0.2e1 * t812 * t340 * t2705 - 0.3e1 / 0.2e1 * t812 * t340 * t2684 - 0.324e3 * t7936 * t1364 - 0.2e1 * t812 * t2783 + 0.2e1 * t812 * t2795 + t2766 * t2051 / 0.16e2;
  t7956 = t132 * t3133;
  t7991 = -t2766 * t2042 / 0.16e2 - 0.3e1 / 0.4e1 * t1011 * t5243 + t2770 * t2054 - 0.3e1 / 0.4e1 * t2741 * t2750 - t7956 * t455 / 0.32e2 - t435 * t3071 * t170 * t443 / 0.24e2 + t7956 * t452 / 0.32e2 + t6384 * t819 / 0.12e2 - t6384 * t844 / 0.12e2 - t2741 * t847 + t2741 * t822 + t132 * t3106 * t2572 * t1412 - t2770 * t2045 - t2005 * t2754 / 0.6e1 + t2005 * t2792 / 0.6e1 - t2011 * t2593 / 0.3e1 - 0.3e1 / 0.4e1 * t794 * t6612 + t794 * t6619 / 0.2e1 - 0.3e1 * t812 * t2066 * t6596 - 0.3e1 * t812 * t2066 * t6603;
  t8011 = t6558 * t344;
  t8012 = t1425 * t8011;
  t8018 = t2087 * t1081;
  t8019 = t1425 * t8018;
  t8025 = t2061 * t1081;
  t8026 = t2060 * t8025;
  t8042 = t1351 * t58 * t3888 * t32;
  t8053 = -0.9e1 * t812 * t2586 * t6611 + 0.6e1 * t812 * t2586 * t6618 + 0.3e1 * t812 * t2066 * t6625 + t2770 * t2092 / 0.12e2 + t2005 * t2593 / 0.3e1 - t2770 * t2071 / 0.12e2 + 0.4e1 * t812 * t2596 + 0.648e3 * t2747 * t5437 + t451 * t8012 / 0.3e1 + 0.4e1 * t476 * t1415 * t8011 + t451 * t8019 / 0.3e1 + 0.4e1 * t476 * t1415 * t8018 - 0.2e1 / 0.3e1 * t451 * t8026 - 0.8e1 * t476 * t2080 * t8025 + t794 * t6626 / 0.4e1 + t1011 * t5317 / 0.16e2 - 0.648e3 * t2747 * t5452 - t1349 * t7832 * t41 * t8042 / 0.216e3 + t1349 * t7832 * t3563 * t3731 / 0.432e3 - t1349 * t7832 * t137 * t3736 / 0.18e2;
  t8082 = t2580 * t1059;
  t8100 = -0.2e1 * t7936 * t6710 - t1011 * t5346 / 0.16e2 - t794 * t6597 / 0.4e1 - t794 * t6604 / 0.4e1 - t794 * t6560 / 0.8e1 + t794 * t6635 / 0.4e1 - t794 * t6552 / 0.8e1 - 0.81e2 * t3199 * t3753 + 0.81e2 * t3199 * t3758 - 0.3e1 / 0.2e1 * t812 * t2066 * t6559 + 0.3e1 * t812 * t2586 * t6634 - 0.3e1 / 0.2e1 * t812 * t2066 * t6551 - 0.8e1 * t476 * t1415 * t8082 + 0.3e1 / 0.8e1 * t3219 * t3761 - 0.3e1 / 0.8e1 * t3219 * t3748 - t2766 * t2063 / 0.8e1 + t2766 * t2075 / 0.16e2 - t3225 * t1429 / 0.32e2 - 0.3e1 / 0.2e1 * t2741 * t2587 + 0.3e1 / 0.4e1 * t2741 * t2590;
  t8113 = t1425 * t8082;
  t8127 = t3070 * t170;
  t8133 = t1281 * t7832;
  t8148 = t1003 * t806;
  t8173 = t524 * t8127 * t525 / 0.2e1 + t1298 * t7832 * t1300 - t8133 * t3560 / 0.216e3 + t8133 * t3567 / 0.432e3 - t8133 * t3571 / 0.18e2 - 0.2e1 * t1281 * t312 * t2678 * t3578 - 0.216e3 * t3585 * t7734 * t138 * t1326 - 0.18e2 * t533 * t8148 * t469 - t518 * t7864 * t2678 * t41 * t1300 - t192 * t3098 * t193 / 0.2e1 + t3107 * t2674 - 0.324e3 * t3112 * t2680 + 0.324e4 * t2676 * t7924 * t3525 * t3527 - t187 * t7786 * t188 / 0.24e2 - t3072 * t861 / 0.24e2 + t8133 * t3619 / 0.36e2;
  t8220 = -t6943 * t2063 / 0.8e1 + 0.6e1 * t6952 * t6939 - t162 * t185 * t8173 + t162 * params->alpha * (-t46 * t7786 * t48 / 0.24e2 + t167 * t8127 * t172 / 0.48e2 - t490 * t8148 * t493 / 0.96e2 - t2695 * t3130 / 0.432e3 + t490 * t2678 * t3640 * t312 * t147 / 0.1152e4 - t51 * t3098 * t136 / 0.24e2) * t63 - 0.18e2 * t2212 * t6855 * t2725 + 0.12e2 * t2212 * t2580 * t2729 + 0.6e1 * t2212 * t1052 * t509 * t853 + 0.6e1 * t2212 * t2580 * t2711 - 0.18e2 * t5039 * t5040 * t2711 + 0.6e1 * t2212 * t2213 * t3153 - 0.18e2 * t3161 * t808;
  t8229 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t122 * t3238 - t7718 - 0.3e1 / 0.8e1 * t5 * t27 * (t7886 + 0.3e1 / 0.4e1 * t2741 * t2584 - 0.3e1 / 0.4e1 * t1011 * t5343 + t3225 * t1422 / 0.32e2 + t2766 * t2089 / 0.16e2 + 0.3e1 / 0.2e1 * t1011 * t5370 - 0.3e1 / 0.4e1 * t1011 * t5329 - 0.2e1 / 0.3e1 * t451 * t8113 + t6943 * t2075 / 0.16e2 + t6943 * t2089 / 0.16e2 + t6947 * t6935 / 0.2e1 + t794 * t6395 / 0.8e1 + t2011 * t2754 / 0.6e1 - t794 * t6363 / 0.8e1 + 0.2e1 / 0.3e1 * t451 * t7890 - 0.3e1 / 0.8e1 * t3225 * t1392 - t7899 * t455 / 0.96e2 + t7899 * t452 / 0.96e2 + 0.3e1 / 0.16e2 * t7840 * t1388 + t7828 + t7780 + t8100 + t8053 + t7991 + t7945 + t8220 - 0.4e1 / 0.3e1 * t476 * t193 * t3138 + 0.8e1 * t476 * t193 * t3141));
  tv4rhosigma30 = t6 * t8229 + t3242;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t8236 = t5 * t216 * t3416 / 0.8e1;
  t8238 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t212 * t3416 - t8236);
  tv4rhosigma39 = t6 * t8238 + t3420;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t8244 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t3238 - t7718);
  tv4rhosigma310 = t6 * t8244 + t3242;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t8270 = t89 * t1113 * t2865;
  t8288 = t292 * t3322;
  t8296 = 0.27e2 * t7181 * t5767 + 0.3e1 * t7256 * t1771 * t375 + 0.3e1 / 0.8e1 * t3397 * t1845 - t7341 * t962 / 0.12e2 - t2473 * t3053 / 0.6e1 - t435 * t3274 * t276 * t678 / 0.24e2 + t7341 * t937 / 0.12e2 + t132 * t3305 * t2849 * t1868 - 0.324e3 * t8270 * t1877 - 0.2e1 * t930 * t2994 - t3023 * t965 + t3023 * t940 + 0.2e1 * t930 * t3006 + t2473 * t3003 / 0.6e1 - t2473 * t2997 / 0.3e1 - 0.4e1 * t930 * t3000 + 0.4e1 / 0.3e1 * t710 * t297 * t3319 + 0.2e1 / 0.3e1 * t686 * t8288 + 0.8e1 * t710 * t297 * t3322 - 0.3e1 / 0.8e1 * t3397 * t1848;
  t8298 = t1349 * t3301 * t248;
  t8304 = t1349 * t3301 * t88;
  t8307 = t1094 * t2849;
  t8315 = t132 * t3368 * t3257;
  t8340 = 0.1e1 / t82 / t4435;
  t8351 = -t8298 * t690 / 0.96e2 + t8298 * t687 / 0.96e2 + 0.3e1 / 0.16e2 * t8304 * t1845 + t1349 * t8307 * t29 * t7605 / 0.36e2 - 0.3e1 / 0.16e2 * t8304 * t1848 + 0.3e1 / 0.4e1 * t8315 * t4755 + t2477 * t2997 / 0.3e1 + 0.4e1 * t5773 * t5774 * t2952 - 0.144e3 * t5779 * t7209 + t7261 * t962 / 0.12e2 - 0.3e1 / 0.2e1 * t7265 * t2519 - t7261 * t937 / 0.12e2 + 0.3e1 / 0.2e1 * t7265 * t2507 + 0.3e1 / 0.4e1 * t3023 * t3051 + t3030 * t2519 - 0.3e1 / 0.4e1 * t3023 * t3049 - t3030 * t2507 + 0.324e4 * t89 * t921 * t8340 * t4735 + 0.3e1 / 0.2e1 * t930 * t380 * t2892 - 0.3e1 / 0.2e1 * t930 * t380 * t2871;
  t8358 = t89 * t33 * t3246;
  t8363 = t3532 * t352;
  t8376 = t292 * t3269;
  t8382 = t292 * t3319;
  t8389 = t132 * t3264;
  t8402 = -t912 * t7299 / 0.8e1 - t2477 * t3003 / 0.6e1 - 0.3e1 / 0.8e1 * t8358 * t934 + 0.3e1 / 0.8e1 * t8358 * t931 - t435 * t8363 * t2865 * t4726 - 0.3e1 / 0.4e1 * t8315 * t4761 - 0.54e2 * t7181 * t5784 - 0.3e1 * t7256 * t1771 * t385 + 0.27e2 * t7181 * t5787 - t686 * t8376 / 0.9e1 - 0.4e1 / 0.3e1 * t710 * t297 * t3269 + t686 * t8382 / 0.9e1 + t912 * t7329 / 0.8e1 + t2477 * t3053 / 0.6e1 - t8389 * t690 / 0.32e2 + t8389 * t687 / 0.32e2 + t3026 * t2516 / 0.16e2 - t3026 * t2504 / 0.16e2 - 0.3e1 / 0.4e1 * t1097 * t5738 + 0.3e1 / 0.4e1 * t1097 * t5810;
  t8429 = t7518 * t384;
  t8430 = t1894 * t8429;
  t8436 = t2313 * t1167;
  t8437 = t1894 * t8436;
  t8443 = t2294 * t1167;
  t8444 = t2293 * t8443;
  t8461 = t1830 * t101 * t7242;
  t8468 = t686 * t8430 / 0.3e1 + 0.4e1 * t710 * t1907 * t8429 + t686 * t8437 / 0.3e1 + 0.4e1 * t710 * t1907 * t8436 - 0.2e1 / 0.3e1 * t686 * t8444 - 0.8e1 * t710 * t2306 * t8443 + 0.3e1 * t930 * t2940 * t7503 - 0.3e1 / 0.2e1 * t930 * t2324 * t7510 + t912 * t7504 / 0.4e1 - t1349 * t8307 * t88 * t8461 / 0.216e3 + t1349 * t8307 * t4471 * t4634 / 0.432e3;
  t8477 = t1756 * t101 * t1876;
  t8517 = -t1349 * t8307 * t248 * t4639 / 0.18e2 - 0.2e1 * t8270 * t8477 + 0.648e3 * t3046 * t5962 + t1097 * t5678 / 0.16e2 - t1097 * t5933 / 0.16e2 - t912 * t7421 / 0.4e1 - t912 * t7425 / 0.4e1 + t3397 * t1904 / 0.32e2 + t3026 * t2315 / 0.16e2 + 0.3e1 / 0.8e1 * t3386 * t4643 - 0.3e1 / 0.8e1 * t3386 * t4654 - 0.81e2 * t3390 * t4659 + 0.81e2 * t3390 * t4664 - 0.3e1 / 0.2e1 * t930 * t2324 * t7519 - t912 * t7511 / 0.8e1 - 0.3e1 / 0.2e1 * t3023 * t2941 + 0.3e1 / 0.4e1 * t3023 * t2944 + 0.3e1 / 0.4e1 * t3023 * t2938 - t3026 * t2296 / 0.8e1 + t3026 * t2303 / 0.16e2;
  t8518 = t2931 * t1145;
  t8519 = t1894 * t8518;
  t8565 = -0.2e1 / 0.3e1 * t686 * t8519 - 0.8e1 * t710 * t1907 * t8518 + 0.3e1 / 0.2e1 * t1097 * t5686 - 0.3e1 / 0.4e1 * t1097 * t5708 - 0.3e1 / 0.4e1 * t1097 * t5903 - t912 * t7520 / 0.8e1 - t3397 * t1901 / 0.32e2 - 0.6e1 * t2925 * t5743 + 0.6e1 * t2925 * t5813 + t3335 * t4681 / 0.192e3 - t3335 * t4684 / 0.192e3 - 0.9e1 * t3339 * t2961 + 0.2e1 * t906 * t7286 - 0.72e2 * t922 * t925 * t1168 + 0.27e2 * t1114 * t1116 * t994 - 0.27e2 * t1114 * t1116 * t958 + t3369 * t2850 * t1867 - 0.4e1 * t906 * t7296 + 0.144e3 * t922 * t925 * t1146 - t2921 * t6034 / 0.24e2;
  t8578 = t3246 * t247;
  t8614 = t2921 * t6048 / 0.24e2 + 0.9e1 * t3339 * t2967 - 0.2e1 * t906 * t7293 + 0.72e2 * t922 * t925 * t1140 - t3354 * t251 / 0.24e2 - t254 * t8578 * t266 / 0.2e1 - 0.72e2 * t1114 * t2973 + 0.72e2 * t1114 * t2970 + t3360 * t2976 / 0.2e1 - t3030 * t2299 / 0.12e2 + t3030 * t2318 / 0.12e2 + t2473 * t2953 / 0.3e1 + 0.4e1 * t930 * t2956 - t7551 * t2296 / 0.8e1 + t7551 * t2303 / 0.16e2 + t7551 * t2315 / 0.16e2 + t7561 * t7541 / 0.2e1 + 0.6e1 * t7557 * t7547 + 0.2e1 * t270 * t743 * t3318 * t301 + 0.6e1 * t270 * t743 * t993 * t1167;
  t8619 = 0.1e1 / t1778;
  t8636 = t1713 * t3321;
  t8640 = t290 * t3318;
  t8656 = t3251 * t276;
  t8662 = t1281 * t8307;
  t8677 = t1089 * t924;
  t8702 = t524 * t8656 * t756 / 0.2e1 + t1298 * t8307 * t1756 - t8662 * t4491 / 0.216e3 + t8662 * t4475 / 0.432e3 - t8662 * t4479 / 0.18e2 - 0.2e1 * t1281 * t352 * t2865 * t4486 - 0.216e3 * t3585 * t8619 * t249 * t1783 - 0.18e2 * t764 * t8677 * t703 - t518 * t8363 * t2865 * t88 * t1756 - t296 * t3263 * t297 / 0.2e1 + t3306 * t2861 - 0.324e3 * t3311 * t2867 + 0.324e4 * t2863 * t8340 * t4428 * t3527 - t187 * t8578 * t292 / 0.24e2 - t3275 * t979 / 0.24e2 + t8662 * t4468 / 0.36e2;
  t8749 = -0.3e1 * t270 * t957 * t2894 + 0.6e1 * t270 * t957 * t2907 - t270 * t291 * t8702 + t270 * params->alpha * (-t46 * t8578 * t92 / 0.24e2 + t167 * t8656 * t278 / 0.48e2 - t490 * t8677 * t726 / 0.96e2 - t2882 * t3260 / 0.432e3 + t490 * t2865 * t4543 * t352 * t147 / 0.1152e4 - t51 * t3263 * t247 / 0.24e2) * t106 + 0.6e1 * t2540 * t1138 * t742 * t971 + 0.6e1 * t2540 * t2931 * t2911 - 0.18e2 * t6258 * t5689 * t2911 + 0.6e1 * t2540 * t2541 * t3331 - 0.18e2 * t3339 * t926 - 0.18e2 * t2540 * t7676 * t2899 + 0.12e2 * t2540 * t2931 * t2903;
  t8758 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t240 * t3416 - t8236 - 0.3e1 / 0.8e1 * t5 * t80 * (t8749 + t8517 + t8468 + t8296 + 0.6e1 * t270 * t743 * t384 * t2870 + 0.24e2 * t270 * t4557 * t3321 * t301 - 0.18e2 * t270 * t1714 * t1145 * t993 + t8614 + t8402 + t912 * t7496 / 0.4e1 - t2477 * t2953 / 0.3e1 - 0.648e3 * t3046 * t6007 - 0.3e1 / 0.4e1 * t912 * t7482 + t912 * t7489 / 0.2e1 + t8565 + t8351 + 0.6e1 * t930 * t2940 * t7488 + 0.3e1 * t930 * t2324 * t7495 - 0.3e1 * t930 * t2324 * t7420 - 0.3e1 * t930 * t2324 * t7424 - 0.9e1 * t930 * t2940 * t7481 - 0.216e3 * t3496 * t8619 * t4712 - t270 * t3268 * t737 - 0.3e1 * t270 * t374 * t7033 - 0.6e1 * t270 * t286 * t8636 - t270 * t286 * t8640 - 0.3e1 * t270 * t2891 * t968 - 0.3e1 * t270 * t1139 * t2449));
  tv4rhosigma319 = t6 * t8758 + t3420;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t8783 = t32 * t3070;
  t8797 = t42 * t3160 * t3114;
  t8804 = 0.1e1 / t3497;
  t8805 = t146 * t8804;
  t8812 = 0.3e1 / 0.4e1 * t7840 * t2054 + 0.3e1 / 0.4e1 * t132 * t8783 * t3093 * t1412 - t2766 * t2754 / 0.8e1 + t2766 * t2792 / 0.8e1 - 0.3e1 / 0.2e1 * t2741 * t3202 + 0.3e1 / 0.2e1 * t2741 * t3205 - 0.243e3 / 0.2e1 * t8797 * t1364 - t2766 * t2786 / 0.4e1 - t7956 * t844 / 0.8e1 - 0.5e1 / 0.64e2 * t435 * t8805 * t150 * t443 + t7956 * t819 / 0.8e1;
  t8836 = t3070 * t3093;
  t8843 = -0.3e1 / 0.2e1 * t7916 * t1036 + 0.3e1 / 0.2e1 * t7916 * t1034 - 0.3e1 / 0.2e1 * t1011 * t6366 - t794 * t7877 / 0.6e1 - 0.2e1 * t812 * t340 * t3120 + t794 * t7883 / 0.6e1 + 0.2e1 * t812 * t340 * t3138 - 0.1215e4 * t42 * t1027 * t3547 * t3890 + 0.3e1 / 0.2e1 * t1011 * t6357 - t1349 * t8836 * t29 * t7836 / 0.96e2 + 0.3e1 * t7844 * t5170;
  t8844 = t3532 * t1003;
  t8869 = 0.3e1 / 0.8e1 * t435 * t8844 * t3114 * t3882 - 0.3e1 * t7844 * t5182 - 0.3e1 * t1011 * t6671 + 0.3e1 / 0.2e1 * t3219 * t5432 - 0.324e3 * t3199 * t5437 + t794 * t8026 - t1011 * t6593 / 0.4e1 + t1011 * t6662 / 0.8e1 - 0.3e1 / 0.2e1 * t3219 * t5448 + 0.324e3 * t3199 * t5452 + 0.12e2 * t812 * t2586 * t8025;
  t8901 = -t1011 * t6641 / 0.8e1 - t794 * t8012 / 0.2e1 - t794 * t8019 / 0.2e1 - 0.6e1 * t812 * t2066 * t8011 - 0.6e1 * t812 * t2066 * t8018 + t1349 * t8836 * t41 * t8042 / 0.576e3 - t1349 * t8836 * t3563 * t3731 / 0.1152e4 + t1349 * t8836 * t137 * t3736 / 0.48e2 + 0.3e1 / 0.4e1 * t8797 * t6710 + t2766 * t2593 / 0.4e1 + t794 * t8113;
  t8934 = -t3225 * t2071 / 0.8e1 + 0.3e1 * t2741 * t3164 + 0.12e2 * t812 * t2066 * t8082 + t3225 * t2092 / 0.8e1 + 0.8e1 * t162 * t510 * t3119 * t344 - 0.24e2 * t162 * t334 * t7749 - 0.4e1 * t162 * t334 * t7731 - 0.4e1 * t162 * t3137 * t850 - 0.6e1 * t162 * t1053 * t2733 - 0.36e2 * t162 * t1230 * t1059 * t1081 + 0.54e2 * t1028 * t1030 * t1082;
  t8946 = t3065 * t1029;
  t8947 = t1349 * t8946;
  t8961 = 0.1e1 / t3517;
  t8962 = t32 * t8961;
  t8966 = t8961 * t37;
  t8970 = -0.108e3 * t1028 * t1030 * t1060 - t3157 * t5487 / 0.48e2 + t3157 * t5481 / 0.48e2 - 0.54e2 * t1028 * t1030 * t1054 + 0.9e1 / 0.16e2 * t8947 * t1447 + 0.15e2 / 0.8e1 * t132 * t1297 * t3070 * t3185 + 0.15e2 / 0.16e2 * t435 * t8805 * t1016 - t8947 * t1444 / 0.32e2 + 0.36e2 * t3161 * t3173 - 0.5e1 / 0.64e2 * t132 * t8962 * t316 - 0.15e2 / 0.16e2 * t143 * t8966 * t158;
  t8998 = t1281 * t8836;
  t9004 = t8804 * t150;
  t9008 = t1281 * t3065;
  t9036 = 0.3e1 / 0.8e1 * t518 * t8844 * t3613 * t1300 - 0.15e2 / 0.16e2 * t192 * t8962 * t340 + 0.3e1 / 0.4e1 * t186 * t8783 * t3109 - 0.243e3 / 0.2e1 * t60 * t3160 * t3116 - 0.1215e4 * t3112 * t3547 * t3525 * t3527 - 0.5e1 / 0.64e2 * t518 * t8805 * t1068 - t8998 * t3619 / 0.96e2 - 0.5e1 / 0.64e2 * t187 * t8966 * t188 + 0.15e2 / 0.16e2 * t524 * t9004 * t525 - t9008 * t3085 / 0.32e2 + 0.9e1 / 0.16e2 * t9008 * t3089 + 0.15e2 / 0.8e1 * t1298 * t8836 * t1300 - t8998 * t3567 / 0.1152e4 + t8998 * t3571 / 0.48e2 + 0.3e1 / 0.4e1 * t1281 * t1003 * t3114 * t3578 + t8998 * t3560 / 0.576e3 + t9008 * t3081 / 0.64e2 + 0.81e2 * t3585 * t1008 * t3482 * t138 * t1326 - 0.81e2 / 0.4e1 * t533 * t8946 * t469;
  t9064 = t1059 * t1059;
  t9068 = t1081 * t1081;
  t9085 = -0.36e2 * t3161 * t3189 + t6943 * t2593 / 0.4e1 + 0.12e2 * t162 * t1053 * t2707 - t162 * t185 * t9036 + t162 * params->alpha * (-0.5e1 / 0.64e2 * t46 * t8966 * t48 + 0.5e1 / 0.128e3 * t167 * t9004 * t172 + t490 * t8946 * t493 / 0.256e3 - t490 * t3114 * t3640 * t1003 * t147 / 0.3072e4 - t3128 * t1259 * t3070 * t33 / 0.2304e4 - 0.5e1 / 0.64e2 * t51 * t8962 * t37) * t63 + 0.24e2 * t162 * t3508 * t9064 + 0.6e1 * t162 * t510 * t9068 + 0.24e2 * t2212 * t2580 * t3153 - 0.81e2 / 0.4e1 * t42 * t462 * t3065 * t1031 + t8947 * t1352 / 0.64e2 + 0.81e2 * t3496 * t1008 * t3482 * t3503;
  t9092 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (-t794 * t7890 - 0.12e2 * t812 * t340 * t3141 - 0.3e1 * t2741 * t3232 + 0.3e1 / 0.2e1 * t3225 * t2054 - 0.3e1 / 0.2e1 * t3225 * t2045 + 0.108e3 * t6531 * t6448 + 0.3e1 * t1011 * t6360 + t7899 * t819 / 0.24e2 - 0.3e1 / 0.4e1 * t7840 * t2045 - t7899 * t844 / 0.24e2 + t8812 + t8843 + t8869 + t8901 + t8934 + t8970 + t9085));
  tv4sigma40 = t6 * t9092;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t9130 = t3246 * t1115;
  t9131 = t1349 * t9130;
  t9140 = 0.1e1 / t4419;
  t9141 = t146 * t9140;
  t9156 = -t3335 * t6048 / 0.48e2 - 0.54e2 * t1114 * t1116 * t1140 + 0.9e1 / 0.16e2 * t9131 * t1937 + 0.15e2 / 0.8e1 * t132 * t1297 * t3251 * t3370 + 0.36e2 * t3339 * t3357 + 0.15e2 / 0.16e2 * t435 * t9141 * t1102 + 0.3e1 / 0.2e1 * t3023 * t3376 + t3026 * t3003 / 0.8e1 - 0.3e1 * t3023 * t3410 - 0.12e2 * t930 * t380 * t3322 - t3026 * t2997 / 0.4e1;
  t9177 = t3532 * t1089;
  t9182 = -t912 * t8288 + 0.3e1 * t1097 * t7296 + 0.108e3 * t7181 * t7209 - t8298 * t962 / 0.24e2 + 0.3e1 / 0.4e1 * t8304 * t2519 + t8298 * t937 / 0.24e2 - 0.3e1 / 0.4e1 * t8304 * t2507 - 0.3e1 / 0.2e1 * t1097 * t7286 - 0.3e1 / 0.2e1 * t8358 * t1122 + 0.3e1 * t8315 * t5743 + 0.3e1 / 0.8e1 * t435 * t9177 * t3313 * t4726;
  t9194 = t3251 * t3257;
  t9202 = t89 * t3338 * t3313;
  t9209 = t32 * t3251;
  t9216 = -0.3e1 * t8315 * t5813 + t912 * t8376 / 0.6e1 + 0.2e1 * t930 * t380 * t3269 + 0.3e1 / 0.2e1 * t3397 * t2519 - 0.3e1 / 0.2e1 * t3397 * t2507 - t1349 * t9194 * t29 * t7605 / 0.96e2 + t8389 * t937 / 0.8e1 - 0.243e3 / 0.2e1 * t9202 * t1877 - 0.5e1 / 0.64e2 * t435 * t9141 * t258 * t678 + 0.3e1 / 0.4e1 * t132 * t9209 * t3257 * t1868 - t8389 * t962 / 0.8e1;
  t9243 = 0.3e1 / 0.2e1 * t1097 * t7293 - t3026 * t3053 / 0.8e1 + 0.3e1 / 0.2e1 * t8358 * t1120 - 0.3e1 / 0.2e1 * t3023 * t3393 - 0.1215e4 * t89 * t1113 * t4447 * t4735 - t912 * t8382 / 0.6e1 - 0.2e1 * t930 * t380 * t3319 + 0.12e2 * t930 * t2324 * t8518 + t912 * t8444 - t1097 * t7534 / 0.4e1 + t912 * t8519;
  t9272 = t3397 * t2318 / 0.8e1 + t3026 * t2953 / 0.4e1 + 0.3e1 * t3023 * t3342 - t3397 * t2299 / 0.8e1 - t912 * t8430 / 0.2e1 - t912 * t8437 / 0.2e1 - 0.3e1 / 0.2e1 * t3386 * t6003 + 0.324e3 * t3390 * t6007 + t1349 * t9194 * t88 * t8461 / 0.576e3 - t1349 * t9194 * t4471 * t4634 / 0.1152e4 + t1349 * t9194 * t248 * t4639 / 0.48e2;
  t9295 = 0.1e1 / t4420;
  t9296 = t9295 * t84;
  t9302 = 0.3e1 / 0.4e1 * t9202 * t8477 + 0.3e1 / 0.2e1 * t3386 * t5957 - 0.6e1 * t930 * t2324 * t8429 - 0.6e1 * t930 * t2324 * t8436 - 0.3e1 * t1097 * t7428 + t1097 * t7537 / 0.8e1 - t1097 * t7477 / 0.8e1 + 0.12e2 * t930 * t2940 * t8443 - 0.324e3 * t3390 * t5962 - 0.15e2 / 0.16e2 * t254 * t9296 * t266 - 0.36e2 * t3339 * t3373;
  t9305 = t32 * t9295;
  t9309 = t1145 * t1145;
  t9313 = t1167 * t1167;
  t9332 = t1281 * t3246;
  t9343 = t1281 * t9194;
  t9379 = t9140 * t258;
  t9390 = t9332 * t3283 / 0.64e2 + 0.81e2 * t3585 * t1094 * t4494 * t249 * t1783 - 0.81e2 / 0.4e1 * t764 * t9130 * t703 + t9343 * t4491 / 0.576e3 - t9343 * t4475 / 0.1152e4 + t9343 * t4479 / 0.48e2 + 0.3e1 / 0.4e1 * t1281 * t1089 * t3313 * t4486 - 0.1215e4 * t3311 * t4447 * t4428 * t3527 + 0.3e1 / 0.8e1 * t518 * t9177 * t4460 * t1756 - 0.15e2 / 0.16e2 * t296 * t9305 * t380 + 0.3e1 / 0.4e1 * t186 * t9209 * t3308 - 0.243e3 / 0.2e1 * t103 * t3338 * t3315 - 0.5e1 / 0.64e2 * t187 * t9296 * t292 - 0.5e1 / 0.64e2 * t518 * t9141 * t1154 - t9343 * t4468 / 0.96e2 + 0.15e2 / 0.16e2 * t524 * t9379 * t756 - t9332 * t3287 / 0.32e2 + 0.9e1 / 0.16e2 * t9332 * t3291 + 0.15e2 / 0.8e1 * t1298 * t9194 * t1756;
  t9418 = -t9131 * t1934 / 0.32e2 - 0.5e1 / 0.64e2 * t132 * t9305 * t356 + 0.24e2 * t270 * t4557 * t9309 + 0.6e1 * t270 * t743 * t9313 + 0.24e2 * t2540 * t2931 * t3331 - 0.81e2 / 0.4e1 * t89 * t462 * t3246 * t1117 + t9131 * t1831 / 0.64e2 + 0.81e2 * t3496 * t1094 * t4494 * t4712 + t7551 * t2953 / 0.4e1 - t270 * t291 * t9390 + t270 * params->alpha * (-0.5e1 / 0.64e2 * t46 * t9296 * t92 + 0.5e1 / 0.128e3 * t167 * t9379 * t278 + t490 * t9130 * t726 / 0.256e3 - t490 * t3313 * t4543 * t1089 * t147 / 0.3072e4 - t3258 * t1802 * t3251 * t33 / 0.2304e4 - 0.5e1 / 0.64e2 * t51 * t9305 * t84) * t106;
  t9425 = my_piecewise3(t71, 0, -0.3e1 / 0.8e1 * t5 * t80 * (0.8e1 * t270 * t743 * t3318 * t384 - 0.36e2 * t270 * t1714 * t1145 * t1167 - 0.24e2 * t270 * t374 * t8636 - 0.4e1 * t270 * t3268 * t968 - 0.4e1 * t270 * t374 * t8640 - 0.6e1 * t270 * t1139 * t2894 + 0.12e2 * t270 * t1139 * t2907 + 0.54e2 * t1114 * t1116 * t1168 - 0.108e3 * t1114 * t1116 * t1146 + t3335 * t6034 / 0.48e2 + t9156 + t9182 + t9216 + t9243 + t9272 + t9302 + t9418));
  tv4sigma414 = t6 * t9425;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

