/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_am05.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t38, t39, t43;
  double t44, t45, t46, t47, t50, t51, t52, t53;
  double t54, t55, t56, t58, t60, t61, t62, t63;
  double t64, t68, t69, t72, t75, t76, t77, t83;
  double t84, t85, t86, t89, t90, t91, t95, t99;
  double tzk0;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->alpha * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = t26 * t34;
  t37 = 0.1e1 + t35 / 0.24e2;
  t38 = 0.1e1 / t37;
  t39 = t33 * t38;
  t43 = t25 * sigma[0];
  t44 = t21 * t43;
  t45 = t28 * t33;
  t46 = params->c * t20;
  t47 = t46 * t25;
  t50 = 0.1e1 + t47 * t34 / 0.24e2;
  t51 = t38 * t50;
  t52 = t20 * t20;
  t53 = params->c * t52;
  t54 = 0.1e1 / t23;
  t55 = sqrt(sigma[0]);
  t56 = t54 * t55;
  t58 = t53 * t56 * t28;
  t60 = 0.1e1 / t18 / rho[0];
  t61 = 0.1e1 / M_PI;
  t62 = t60 * t61;
  t63 = t3 * t3;
  t64 = sqrt(0.12e2);
  t68 = t52 * t54 * t55 * t27 * t60;
  t69 = sqrt(t68);
  t72 = sqrt(0.6e1);
  t75 = LambertW(t64 * t69 * t68 * t72 / 0.1728e4);
  t76 = POW_1_3(t75);
  t77 = t76 * t76;
  t83 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t3 * t28 * t76 * t75;
  t84 = POW_1_4(t83);
  t85 = t63 * t77 * t84;
  t86 = t62 * t85;
  t89 = 0.1e1 + t58 * t86 / 0.8e1;
  t90 = 0.1e1 / t89;
  t91 = t51 * t90;
  t95 = 0.1e1 - t26 * t29 * t39 / 0.24e2 + t44 * t45 * t91 / 0.24e2;
  t99 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t38, t39, t43;
  double t44, t45, t46, t47, t50, t51, t52, t53;
  double t54, t55, t56, t58, t60, t61, t62, t63;
  double t64, t68, t69, t72, t75, t76, t77, t83;
  double t84, t85, t86, t89, t90, t91, t95, t99;
  double tzk0;

  double t101, t105, t107, t108, t112, t113, t115, t116;
  double t117, t118, t119, t120, t122, t123, t124, t125;
  double t129, t133, t134, t135, t136, t137, t141, t142;
  double t143, t144, t149, t150, t151, t152, t154, t155;
  double t156, t159, t160, t161, t162, t163, t164, t168;
  double t169, t170, t171, t172, t173, t174, t175, t178;
  double t179, t180, t183, t188, tvrho0, t195, t197, t198;
  double t202, t203, t204, t208, t210, t219, t221, t224;
  double t225, t229, t230, t233, t234, t235, t238, t242;
  double tvsigma0;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->alpha * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = t26 * t34;
  t37 = 0.1e1 + t35 / 0.24e2;
  t38 = 0.1e1 / t37;
  t39 = t33 * t38;
  t43 = t25 * sigma[0];
  t44 = t21 * t43;
  t45 = t28 * t33;
  t46 = params->c * t20;
  t47 = t46 * t25;
  t50 = 0.1e1 + t47 * t34 / 0.24e2;
  t51 = t38 * t50;
  t52 = t20 * t20;
  t53 = params->c * t52;
  t54 = 0.1e1 / t23;
  t55 = sqrt(sigma[0]);
  t56 = t54 * t55;
  t58 = t53 * t56 * t28;
  t60 = 0.1e1 / t18 / rho[0];
  t61 = 0.1e1 / M_PI;
  t62 = t60 * t61;
  t63 = t3 * t3;
  t64 = sqrt(0.12e2);
  t68 = t52 * t54 * t55 * t27 * t60;
  t69 = sqrt(t68);
  t72 = sqrt(0.6e1);
  t75 = LambertW(t64 * t69 * t68 * t72 / 0.1728e4);
  t76 = POW_1_3(t75);
  t77 = t76 * t76;
  t83 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t3 * t28 * t76 * t75;
  t84 = POW_1_4(t83);
  t85 = t63 * t77 * t84;
  t86 = t62 * t85;
  t89 = 0.1e1 + t58 * t86 / 0.8e1;
  t90 = 0.1e1 / t89;
  t91 = t51 * t90;
  t95 = 0.1e1 - t26 * t29 * t39 / 0.24e2 + t44 * t45 * t91 / 0.24e2;
  t99 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t101 = t17 / t31;
  t105 = t30 * rho[0];
  t107 = 0.1e1 / t31 / t105;
  t108 = t107 * t38;
  t112 = params->alpha * params->alpha;
  t113 = t112 * t52;
  t115 = 0.1e1 / t23 / t22;
  t116 = t113 * t115;
  t117 = sigma[0] * sigma[0];
  t118 = t117 * t27;
  t119 = t30 * t30;
  t120 = t119 * t30;
  t122 = 0.1e1 / t18 / t120;
  t123 = t37 * t37;
  t124 = 0.1e1 / t123;
  t125 = t122 * t124;
  t129 = t28 * t107;
  t133 = t115 * t117;
  t134 = t113 * t133;
  t135 = t27 * t122;
  t136 = t124 * t50;
  t137 = t136 * t90;
  t141 = params->alpha * t52;
  t142 = t141 * t133;
  t143 = t38 * params->c;
  t144 = t143 * t90;
  t149 = t21 * t43 * t28;
  t150 = t89 * t89;
  t151 = 0.1e1 / t150;
  t152 = t50 * t151;
  t154 = 0.1e1 / t18 / t30;
  t155 = t154 * t61;
  t156 = t155 * t85;
  t159 = t155 * t63;
  t160 = t77 * t84;
  t161 = 0.1e1 + t75;
  t162 = 0.1e1 / t161;
  t163 = t160 * t162;
  t164 = t159 * t163;
  t168 = t53 * t56 * t27;
  t169 = t75 * t75;
  t170 = t84 * t84;
  t171 = t170 * t84;
  t172 = 0.1e1 / t171;
  t173 = t169 * t172;
  t174 = t173 * t162;
  t175 = t155 * t174;
  t178 = -t58 * t156 / 0.6e1 - t58 * t164 / 0.6e1 - 0.3e1 / 0.8e1 * t168 * t175;
  t179 = t152 * t178;
  t180 = t39 * t179;
  t183 = t26 * t29 * t108 / 0.9e1 - t116 * t118 * t125 / 0.108e3 - t44 * t129 * t91 / 0.9e1 + t134 * t135 * t137 / 0.108e3 - t142 * t135 * t144 / 0.108e3 - t149 * t180 / 0.24e2;
  t188 = my_piecewise3(t2, 0, -t6 * t101 * t95 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t183);
  tvrho0 = 0.2e1 * rho[0] * t188 + 0.2e1 * t99;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t195 = t119 * rho[0];
  t197 = 0.1e1 / t18 / t195;
  t198 = t197 * t124;
  t202 = t25 * t28;
  t203 = t21 * t202;
  t204 = t50 * t90;
  t208 = t115 * sigma[0];
  t210 = t27 * t197;
  t219 = t54 / t55;
  t221 = t53 * t219 * t28;
  t224 = t62 * t63;
  t225 = t224 * t163;
  t229 = t53 * t219 * t27;
  t230 = t62 * t174;
  t233 = t221 * t86 / 0.16e2 + t221 * t225 / 0.16e2 + 0.9e1 / 0.64e2 * t229 * t230;
  t234 = t152 * t233;
  t235 = t39 * t234;
  t238 = -t26 * t45 * t38 / 0.24e2 + t116 * sigma[0] * t27 * t198 / 0.288e3 + t203 * t39 * t204 / 0.24e2 - t113 * t208 * t210 * t137 / 0.288e3 + t141 * t208 * t210 * t144 / 0.288e3 - t149 * t235 / 0.24e2;
  t242 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t238);
  tvsigma0 = 0.2e1 * rho[0] * t242;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t38, t39, t43;
  double t44, t45, t46, t47, t50, t51, t52, t53;
  double t54, t55, t56, t58, t60, t61, t62, t63;
  double t64, t68, t69, t72, t75, t76, t77, t83;
  double t84, t85, t86, t89, t90, t91, t95, t99;
  double tzk0;

  double t101, t105, t107, t108, t112, t113, t115, t116;
  double t117, t118, t119, t120, t122, t123, t124, t125;
  double t129, t133, t134, t135, t136, t137, t141, t142;
  double t143, t144, t149, t150, t151, t152, t154, t155;
  double t156, t159, t160, t161, t162, t163, t164, t168;
  double t169, t170, t171, t172, t173, t174, t175, t178;
  double t179, t180, t183, t188, tvrho0, t195, t197, t198;
  double t202, t203, t204, t208, t210, t219, t221, t224;
  double t225, t229, t230, t233, t234, t235, t238, t242;
  double tvsigma0;

  double t247, t255, t256, t260, t262, t263, t268, t269;
  double t270, t271, t272, t273, t274, t275, t277, t281;
  double t285, t292, t295, t296, t300, t301, t302, t303;
  double t307, t308, t309, t312, t313, t314, t315, t316;
  double t320, t321, t322, t323, t324, t328, t329, t330;
  double t333, t334, t337, t340, t341, t342, t343, t346;
  double t347, t351, t352, t353, t354, t355, t360, t362;
  double t364, t367, t370, t371, t372, t375, t376, t377;
  double t380, t385, tv2rho20, t394, t398, t399, t400, t407;
  double t408, t409, t413, t415, t422, t427, t431, t432;
  double t433, t436, t437, t438, t441, t444, t447, t448;
  double t451, t452, t453, t463, t466, t469, t476, t479;
  double t480, t481, t484, t489, tv2rhosigma0, t495, t496, t509;
  double t518, t521, t524, t525, t526, t531, t533, t536;
  double t540, t541, t544, t551, t554, t555, t556, t559;
  double t563, tv2sigma20;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->alpha * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = t26 * t34;
  t37 = 0.1e1 + t35 / 0.24e2;
  t38 = 0.1e1 / t37;
  t39 = t33 * t38;
  t43 = t25 * sigma[0];
  t44 = t21 * t43;
  t45 = t28 * t33;
  t46 = params->c * t20;
  t47 = t46 * t25;
  t50 = 0.1e1 + t47 * t34 / 0.24e2;
  t51 = t38 * t50;
  t52 = t20 * t20;
  t53 = params->c * t52;
  t54 = 0.1e1 / t23;
  t55 = sqrt(sigma[0]);
  t56 = t54 * t55;
  t58 = t53 * t56 * t28;
  t60 = 0.1e1 / t18 / rho[0];
  t61 = 0.1e1 / M_PI;
  t62 = t60 * t61;
  t63 = t3 * t3;
  t64 = sqrt(0.12e2);
  t68 = t52 * t54 * t55 * t27 * t60;
  t69 = sqrt(t68);
  t72 = sqrt(0.6e1);
  t75 = LambertW(t64 * t69 * t68 * t72 / 0.1728e4);
  t76 = POW_1_3(t75);
  t77 = t76 * t76;
  t83 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t3 * t28 * t76 * t75;
  t84 = POW_1_4(t83);
  t85 = t63 * t77 * t84;
  t86 = t62 * t85;
  t89 = 0.1e1 + t58 * t86 / 0.8e1;
  t90 = 0.1e1 / t89;
  t91 = t51 * t90;
  t95 = 0.1e1 - t26 * t29 * t39 / 0.24e2 + t44 * t45 * t91 / 0.24e2;
  t99 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t101 = t17 / t31;
  t105 = t30 * rho[0];
  t107 = 0.1e1 / t31 / t105;
  t108 = t107 * t38;
  t112 = params->alpha * params->alpha;
  t113 = t112 * t52;
  t115 = 0.1e1 / t23 / t22;
  t116 = t113 * t115;
  t117 = sigma[0] * sigma[0];
  t118 = t117 * t27;
  t119 = t30 * t30;
  t120 = t119 * t30;
  t122 = 0.1e1 / t18 / t120;
  t123 = t37 * t37;
  t124 = 0.1e1 / t123;
  t125 = t122 * t124;
  t129 = t28 * t107;
  t133 = t115 * t117;
  t134 = t113 * t133;
  t135 = t27 * t122;
  t136 = t124 * t50;
  t137 = t136 * t90;
  t141 = params->alpha * t52;
  t142 = t141 * t133;
  t143 = t38 * params->c;
  t144 = t143 * t90;
  t149 = t21 * t43 * t28;
  t150 = t89 * t89;
  t151 = 0.1e1 / t150;
  t152 = t50 * t151;
  t154 = 0.1e1 / t18 / t30;
  t155 = t154 * t61;
  t156 = t155 * t85;
  t159 = t155 * t63;
  t160 = t77 * t84;
  t161 = 0.1e1 + t75;
  t162 = 0.1e1 / t161;
  t163 = t160 * t162;
  t164 = t159 * t163;
  t168 = t53 * t56 * t27;
  t169 = t75 * t75;
  t170 = t84 * t84;
  t171 = t170 * t84;
  t172 = 0.1e1 / t171;
  t173 = t169 * t172;
  t174 = t173 * t162;
  t175 = t155 * t174;
  t178 = -t58 * t156 / 0.6e1 - t58 * t164 / 0.6e1 - 0.3e1 / 0.8e1 * t168 * t175;
  t179 = t152 * t178;
  t180 = t39 * t179;
  t183 = t26 * t29 * t108 / 0.9e1 - t116 * t118 * t125 / 0.108e3 - t44 * t129 * t91 / 0.9e1 + t134 * t135 * t137 / 0.108e3 - t142 * t135 * t144 / 0.108e3 - t149 * t180 / 0.24e2;
  t188 = my_piecewise3(t2, 0, -t6 * t101 * t95 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t183);
  tvrho0 = 0.2e1 * rho[0] * t188 + 0.2e1 * t99;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t195 = t119 * rho[0];
  t197 = 0.1e1 / t18 / t195;
  t198 = t197 * t124;
  t202 = t25 * t28;
  t203 = t21 * t202;
  t204 = t50 * t90;
  t208 = t115 * sigma[0];
  t210 = t27 * t197;
  t219 = t54 / t55;
  t221 = t53 * t219 * t28;
  t224 = t62 * t63;
  t225 = t224 * t163;
  t229 = t53 * t219 * t27;
  t230 = t62 * t174;
  t233 = t221 * t86 / 0.16e2 + t221 * t225 / 0.16e2 + 0.9e1 / 0.64e2 * t229 * t230;
  t234 = t152 * t233;
  t235 = t39 * t234;
  t238 = -t26 * t45 * t38 / 0.24e2 + t116 * sigma[0] * t27 * t198 / 0.288e3 + t203 * t39 * t204 / 0.24e2 - t113 * t208 * t210 * t137 / 0.288e3 + t141 * t208 * t210 * t144 / 0.288e3 - t149 * t235 / 0.24e2;
  t242 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t238);
  tvsigma0 = 0.2e1 * rho[0] * t242;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t247 = t17 / t31 / rho[0];
  t255 = 0.1e1 / t31 / t119;
  t256 = t255 * t38;
  t260 = t119 * t105;
  t262 = 0.1e1 / t18 / t260;
  t263 = t262 * t124;
  t268 = t22 * t22;
  t269 = 0.1e1 / t268;
  t270 = t112 * params->alpha * t269;
  t271 = t117 * sigma[0];
  t272 = t119 * t119;
  t273 = t272 * t30;
  t274 = 0.1e1 / t273;
  t275 = t271 * t274;
  t277 = 0.1e1 / t123 / t37;
  t281 = t28 * t255;
  t285 = t27 * t262;
  t292 = t108 * t179;
  t295 = t270 * t271;
  t296 = t274 * t277;
  t300 = t112 * t269;
  t301 = t300 * t271;
  t302 = t274 * t124;
  t303 = params->c * t90;
  t307 = t133 * t27;
  t308 = t113 * t307;
  t309 = t125 * t179;
  t312 = t141 * t307;
  t313 = t122 * t38;
  t314 = params->c * t151;
  t315 = t314 * t178;
  t316 = t313 * t315;
  t320 = 0.1e1 / t150 / t89;
  t321 = t50 * t320;
  t322 = t178 * t178;
  t323 = t321 * t322;
  t324 = t39 * t323;
  t328 = 0.1e1 / t18 / t105;
  t329 = t328 * t61;
  t330 = t329 * t85;
  t333 = t329 * t63;
  t334 = t333 * t163;
  t337 = t329 * t174;
  t340 = t161 * t161;
  t341 = 0.1e1 / t340;
  t342 = t160 * t341;
  t343 = t333 * t342;
  t346 = t173 * t341;
  t347 = t329 * t346;
  t351 = t77 * t75 * t84;
  t352 = t340 * t161;
  t353 = 0.1e1 / t352;
  t354 = t351 * t353;
  t355 = t333 * t354;
  t360 = t169 * t75;
  t362 = t61 * t76 * t360;
  t364 = 0.1e1 / t171 / t83;
  t367 = t362 * t364 * t341 * t3;
  t370 = t360 * t172;
  t371 = t370 * t353;
  t372 = t329 * t371;
  t375 = 0.7e1 / 0.18e2 * t58 * t330 + 0.11e2 / 0.18e2 * t58 * t334 + 0.11e2 / 0.8e1 * t168 * t337 + 0.2e1 / 0.9e1 * t58 * t343 + 0.2e1 * t168 * t347 - t58 * t355 / 0.3e1 - 0.9e1 / 0.8e1 * t53 * t56 * t328 * t367 - 0.3e1 / 0.4e1 * t168 * t372;
  t376 = t152 * t375;
  t377 = t39 * t376;
  t380 = -0.11e2 / 0.27e2 * t26 * t29 * t256 + t116 * t118 * t263 / 0.12e2 - 0.2e1 / 0.81e2 * t270 * t275 * t277 + 0.11e2 / 0.27e2 * t44 * t281 * t91 - t134 * t285 * t137 / 0.12e2 + t142 * t285 * t144 / 0.12e2 + 0.2e1 / 0.9e1 * t149 * t292 + 0.2e1 / 0.81e2 * t295 * t296 * t204 - 0.2e1 / 0.81e2 * t301 * t302 * t303 - t308 * t309 / 0.54e2 + t312 * t316 / 0.54e2 + t149 * t324 / 0.12e2 - t149 * t377 / 0.24e2;
  t385 = my_piecewise3(t2, 0, t6 * t247 * t95 / 0.12e2 - t6 * t101 * t183 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t380);
  tv2rho20 = 0.2e1 * rho[0] * t385 + 0.4e1 * t188;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t394 = t124 * sigma[0];
  t398 = t272 * rho[0];
  t399 = 0.1e1 / t398;
  t400 = t117 * t399;
  t407 = t115 * t27;
  t408 = t113 * t407;
  t409 = t204 * sigma[0];
  t413 = t141 * t407;
  t415 = params->c * sigma[0] * t90;
  t422 = t399 * t277;
  t427 = t399 * t124;
  t431 = t208 * t27;
  t432 = t113 * t431;
  t433 = t198 * t179;
  t436 = t141 * t431;
  t437 = t197 * t38;
  t438 = t437 * t315;
  t441 = t108 * t234;
  t444 = t125 * t234;
  t447 = t314 * t233;
  t448 = t313 * t447;
  t451 = t39 * t50;
  t452 = t320 * t233;
  t453 = t452 * t178;
  t463 = t159 * t342;
  t466 = t155 * t346;
  t469 = t159 * t354;
  t476 = t155 * t371;
  t479 = -t221 * t156 / 0.12e2 - t221 * t164 / 0.6e1 - 0.3e1 / 0.8e1 * t229 * t175 - t221 * t463 / 0.12e2 - 0.3e1 / 0.4e1 * t229 * t466 + t221 * t469 / 0.8e1 + 0.27e2 / 0.64e2 * t53 * t219 * t154 * t367 + 0.9e1 / 0.32e2 * t229 * t476;
  t480 = t152 * t479;
  t481 = t39 * t480;
  t484 = t26 * t129 * t38 / 0.9e1 - t116 * t135 * t394 / 0.36e2 + t270 * t400 * t277 / 0.108e3 - t203 * t108 * t204 / 0.9e1 + t408 * t125 * t409 / 0.36e2 - t413 * t313 * t415 / 0.36e2 - t203 * t180 / 0.24e2 - t270 * t117 * t422 * t204 / 0.108e3 + t300 * t117 * t427 * t303 / 0.108e3 + t432 * t433 / 0.288e3 - t436 * t438 / 0.288e3 + t149 * t441 / 0.9e1 - t308 * t444 / 0.108e3 + t312 * t448 / 0.108e3 + t149 * t451 * t453 / 0.12e2 - t149 * t481 / 0.24e2;
  t489 = my_piecewise3(t2, 0, -t6 * t101 * t238 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t484);
  tv2rhosigma0 = 0.2e1 * rho[0] * t489 + 0.2e1 * t242;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t495 = 0.1e1 / t272;
  t496 = sigma[0] * t495;
  t509 = t495 * t277;
  t518 = t198 * t234;
  t521 = t437 * t447;
  t524 = t233 * t233;
  t525 = t321 * t524;
  t526 = t39 * t525;
  t531 = t54 / t55 / sigma[0];
  t533 = t53 * t531 * t28;
  t536 = t224 * t342;
  t540 = t53 * t531 * t27;
  t541 = t62 * t346;
  t544 = t224 * t354;
  t551 = t62 * t371;
  t554 = -t533 * t86 / 0.32e2 + t533 * t536 / 0.32e2 + 0.9e1 / 0.32e2 * t540 * t541 - 0.3e1 / 0.64e2 * t533 * t544 - 0.81e2 / 0.512e3 * t53 * t531 * t60 * t367 - 0.27e2 / 0.256e3 * t540 * t551;
  t555 = t152 * t554;
  t556 = t39 * t555;
  t559 = t116 * t210 * t124 / 0.144e3 - t270 * t496 * t277 / 0.288e3 - t408 * t198 * t204 / 0.144e3 + t413 * t437 * t303 / 0.144e3 - t203 * t235 / 0.12e2 + t270 * sigma[0] * t509 * t204 / 0.288e3 - t300 * sigma[0] * t495 * t124 * t303 / 0.288e3 + t432 * t518 / 0.144e3 - t436 * t521 / 0.144e3 + t149 * t526 / 0.12e2 - t149 * t556 / 0.24e2;
  t563 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t559);
  tv2sigma20 = 0.2e1 * rho[0] * t563;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t38, t39, t43;
  double t44, t45, t46, t47, t50, t51, t52, t53;
  double t54, t55, t56, t58, t60, t61, t62, t63;
  double t64, t68, t69, t72, t75, t76, t77, t83;
  double t84, t85, t86, t89, t90, t91, t95, t99;
  double tzk0;

  double t101, t105, t107, t108, t112, t113, t115, t116;
  double t117, t118, t119, t120, t122, t123, t124, t125;
  double t129, t133, t134, t135, t136, t137, t141, t142;
  double t143, t144, t149, t150, t151, t152, t154, t155;
  double t156, t159, t160, t161, t162, t163, t164, t168;
  double t169, t170, t171, t172, t173, t174, t175, t178;
  double t179, t180, t183, t188, tvrho0, t195, t197, t198;
  double t202, t203, t204, t208, t210, t219, t221, t224;
  double t225, t229, t230, t233, t234, t235, t238, t242;
  double tvsigma0;

  double t247, t255, t256, t260, t262, t263, t268, t269;
  double t270, t271, t272, t273, t274, t275, t277, t281;
  double t285, t292, t295, t296, t300, t301, t302, t303;
  double t307, t308, t309, t312, t313, t314, t315, t316;
  double t320, t321, t322, t323, t324, t328, t329, t330;
  double t333, t334, t337, t340, t341, t342, t343, t346;
  double t347, t351, t352, t353, t354, t355, t360, t362;
  double t364, t367, t370, t371, t372, t375, t376, t377;
  double t380, t385, tv2rho20, t394, t398, t399, t400, t407;
  double t408, t409, t413, t415, t422, t427, t431, t432;
  double t433, t436, t437, t438, t441, t444, t447, t448;
  double t451, t452, t453, t463, t466, t469, t476, t479;
  double t480, t481, t484, t489, tv2rhosigma0, t495, t496, t509;
  double t518, t521, t524, t525, t526, t531, t533, t536;
  double t540, t541, t544, t551, t554, t555, t556, t559;
  double t563, tv2sigma20;

  double t566, t576, t577, t578, t582, t583, t584, t585;
  double t588, t589, t590, t593, t594, t595, t596, t598;
  double t599, t601, t602, t604, t608, t610, t611, t614;
  double t616, t617, t620, t623, t624, t625, t626, t629;
  double t630, t631, t632, t636, t638, t639, t640, t643;
  double t646, t649, t652, t655, t656, t657, t662, t665;
  double t666, t670, t672, t673, t676, t679, t684, t687;
  double t688, t691, t692, t693, t696, t697, t701, t703;
  double t704, t708, t710, t713, t716, t721, t722, t727;
  double t728, t732, t733, t741, t748, t753, t757, t760;
  double t766, t767, t768, t769, t770, t771, t774, t775;
  double t782, t785, t786, t791, tv3rho30, t807, t810, t813;
  double t814, t817, t820, t822, t823, t830, t831, t832;
  double t835, t836, t852, t856, t860, t861, t864, t865;
  double t866, t869, t873, t874, t878, t881, t885, t888;
  double t891, t902, t907, t912, t923, t924, t925, t928;
  double t929, t938, t941, t944, t947, t951, t955, t958;
  double t959, t961, t962, t965, t966, t969, t972, t978;
  double t979, t984, tv3rho2sigma0, t1000, t1001, t1005, t1008, t1023;
  double t1027, t1031, t1032, t1036, t1037, t1041, t1045, t1047;
  double t1048, t1051, t1054, t1055, t1058, t1062, t1066, t1077;
  double t1080, t1083, t1089, t1092, t1097, t1108, t1111, t1112;
  double t1113, t1116, t1119, t1122, t1123, t1126, t1129, t1130;
  double t1133, t1134, t1135, t1138, t1139, t1142, t1145, t1151;
  double t1152, t1157, tv3rhosigma20, t1160, t1161, t1162, t1165, t1169;
  double t1172, t1177, t1179, t1185, t1190, t1193, t1196, t1202;
  double t1205, t1210, t1221, t1224, t1225, t1226, t1229, t1232;
  double t1236, t1237, t1239, t1243, t1248, t1249, t1252, t1253;
  double t1271, t1275, tv3sigma30;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->alpha * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = t26 * t34;
  t37 = 0.1e1 + t35 / 0.24e2;
  t38 = 0.1e1 / t37;
  t39 = t33 * t38;
  t43 = t25 * sigma[0];
  t44 = t21 * t43;
  t45 = t28 * t33;
  t46 = params->c * t20;
  t47 = t46 * t25;
  t50 = 0.1e1 + t47 * t34 / 0.24e2;
  t51 = t38 * t50;
  t52 = t20 * t20;
  t53 = params->c * t52;
  t54 = 0.1e1 / t23;
  t55 = sqrt(sigma[0]);
  t56 = t54 * t55;
  t58 = t53 * t56 * t28;
  t60 = 0.1e1 / t18 / rho[0];
  t61 = 0.1e1 / M_PI;
  t62 = t60 * t61;
  t63 = t3 * t3;
  t64 = sqrt(0.12e2);
  t68 = t52 * t54 * t55 * t27 * t60;
  t69 = sqrt(t68);
  t72 = sqrt(0.6e1);
  t75 = LambertW(t64 * t69 * t68 * t72 / 0.1728e4);
  t76 = POW_1_3(t75);
  t77 = t76 * t76;
  t83 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t3 * t28 * t76 * t75;
  t84 = POW_1_4(t83);
  t85 = t63 * t77 * t84;
  t86 = t62 * t85;
  t89 = 0.1e1 + t58 * t86 / 0.8e1;
  t90 = 0.1e1 / t89;
  t91 = t51 * t90;
  t95 = 0.1e1 - t26 * t29 * t39 / 0.24e2 + t44 * t45 * t91 / 0.24e2;
  t99 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t101 = t17 / t31;
  t105 = t30 * rho[0];
  t107 = 0.1e1 / t31 / t105;
  t108 = t107 * t38;
  t112 = params->alpha * params->alpha;
  t113 = t112 * t52;
  t115 = 0.1e1 / t23 / t22;
  t116 = t113 * t115;
  t117 = sigma[0] * sigma[0];
  t118 = t117 * t27;
  t119 = t30 * t30;
  t120 = t119 * t30;
  t122 = 0.1e1 / t18 / t120;
  t123 = t37 * t37;
  t124 = 0.1e1 / t123;
  t125 = t122 * t124;
  t129 = t28 * t107;
  t133 = t115 * t117;
  t134 = t113 * t133;
  t135 = t27 * t122;
  t136 = t124 * t50;
  t137 = t136 * t90;
  t141 = params->alpha * t52;
  t142 = t141 * t133;
  t143 = t38 * params->c;
  t144 = t143 * t90;
  t149 = t21 * t43 * t28;
  t150 = t89 * t89;
  t151 = 0.1e1 / t150;
  t152 = t50 * t151;
  t154 = 0.1e1 / t18 / t30;
  t155 = t154 * t61;
  t156 = t155 * t85;
  t159 = t155 * t63;
  t160 = t77 * t84;
  t161 = 0.1e1 + t75;
  t162 = 0.1e1 / t161;
  t163 = t160 * t162;
  t164 = t159 * t163;
  t168 = t53 * t56 * t27;
  t169 = t75 * t75;
  t170 = t84 * t84;
  t171 = t170 * t84;
  t172 = 0.1e1 / t171;
  t173 = t169 * t172;
  t174 = t173 * t162;
  t175 = t155 * t174;
  t178 = -t58 * t156 / 0.6e1 - t58 * t164 / 0.6e1 - 0.3e1 / 0.8e1 * t168 * t175;
  t179 = t152 * t178;
  t180 = t39 * t179;
  t183 = t26 * t29 * t108 / 0.9e1 - t116 * t118 * t125 / 0.108e3 - t44 * t129 * t91 / 0.9e1 + t134 * t135 * t137 / 0.108e3 - t142 * t135 * t144 / 0.108e3 - t149 * t180 / 0.24e2;
  t188 = my_piecewise3(t2, 0, -t6 * t101 * t95 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t183);
  tvrho0 = 0.2e1 * rho[0] * t188 + 0.2e1 * t99;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t195 = t119 * rho[0];
  t197 = 0.1e1 / t18 / t195;
  t198 = t197 * t124;
  t202 = t25 * t28;
  t203 = t21 * t202;
  t204 = t50 * t90;
  t208 = t115 * sigma[0];
  t210 = t27 * t197;
  t219 = t54 / t55;
  t221 = t53 * t219 * t28;
  t224 = t62 * t63;
  t225 = t224 * t163;
  t229 = t53 * t219 * t27;
  t230 = t62 * t174;
  t233 = t221 * t86 / 0.16e2 + t221 * t225 / 0.16e2 + 0.9e1 / 0.64e2 * t229 * t230;
  t234 = t152 * t233;
  t235 = t39 * t234;
  t238 = -t26 * t45 * t38 / 0.24e2 + t116 * sigma[0] * t27 * t198 / 0.288e3 + t203 * t39 * t204 / 0.24e2 - t113 * t208 * t210 * t137 / 0.288e3 + t141 * t208 * t210 * t144 / 0.288e3 - t149 * t235 / 0.24e2;
  t242 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t238);
  tvsigma0 = 0.2e1 * rho[0] * t242;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t247 = t17 / t31 / rho[0];
  t255 = 0.1e1 / t31 / t119;
  t256 = t255 * t38;
  t260 = t119 * t105;
  t262 = 0.1e1 / t18 / t260;
  t263 = t262 * t124;
  t268 = t22 * t22;
  t269 = 0.1e1 / t268;
  t270 = t112 * params->alpha * t269;
  t271 = t117 * sigma[0];
  t272 = t119 * t119;
  t273 = t272 * t30;
  t274 = 0.1e1 / t273;
  t275 = t271 * t274;
  t277 = 0.1e1 / t123 / t37;
  t281 = t28 * t255;
  t285 = t27 * t262;
  t292 = t108 * t179;
  t295 = t270 * t271;
  t296 = t274 * t277;
  t300 = t112 * t269;
  t301 = t300 * t271;
  t302 = t274 * t124;
  t303 = params->c * t90;
  t307 = t133 * t27;
  t308 = t113 * t307;
  t309 = t125 * t179;
  t312 = t141 * t307;
  t313 = t122 * t38;
  t314 = params->c * t151;
  t315 = t314 * t178;
  t316 = t313 * t315;
  t320 = 0.1e1 / t150 / t89;
  t321 = t50 * t320;
  t322 = t178 * t178;
  t323 = t321 * t322;
  t324 = t39 * t323;
  t328 = 0.1e1 / t18 / t105;
  t329 = t328 * t61;
  t330 = t329 * t85;
  t333 = t329 * t63;
  t334 = t333 * t163;
  t337 = t329 * t174;
  t340 = t161 * t161;
  t341 = 0.1e1 / t340;
  t342 = t160 * t341;
  t343 = t333 * t342;
  t346 = t173 * t341;
  t347 = t329 * t346;
  t351 = t77 * t75 * t84;
  t352 = t340 * t161;
  t353 = 0.1e1 / t352;
  t354 = t351 * t353;
  t355 = t333 * t354;
  t360 = t169 * t75;
  t362 = t61 * t76 * t360;
  t364 = 0.1e1 / t171 / t83;
  t367 = t362 * t364 * t341 * t3;
  t370 = t360 * t172;
  t371 = t370 * t353;
  t372 = t329 * t371;
  t375 = 0.7e1 / 0.18e2 * t58 * t330 + 0.11e2 / 0.18e2 * t58 * t334 + 0.11e2 / 0.8e1 * t168 * t337 + 0.2e1 / 0.9e1 * t58 * t343 + 0.2e1 * t168 * t347 - t58 * t355 / 0.3e1 - 0.9e1 / 0.8e1 * t53 * t56 * t328 * t367 - 0.3e1 / 0.4e1 * t168 * t372;
  t376 = t152 * t375;
  t377 = t39 * t376;
  t380 = -0.11e2 / 0.27e2 * t26 * t29 * t256 + t116 * t118 * t263 / 0.12e2 - 0.2e1 / 0.81e2 * t270 * t275 * t277 + 0.11e2 / 0.27e2 * t44 * t281 * t91 - t134 * t285 * t137 / 0.12e2 + t142 * t285 * t144 / 0.12e2 + 0.2e1 / 0.9e1 * t149 * t292 + 0.2e1 / 0.81e2 * t295 * t296 * t204 - 0.2e1 / 0.81e2 * t301 * t302 * t303 - t308 * t309 / 0.54e2 + t312 * t316 / 0.54e2 + t149 * t324 / 0.12e2 - t149 * t377 / 0.24e2;
  t385 = my_piecewise3(t2, 0, t6 * t247 * t95 / 0.12e2 - t6 * t101 * t183 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t380);
  tv2rho20 = 0.2e1 * rho[0] * t385 + 0.4e1 * t188;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t394 = t124 * sigma[0];
  t398 = t272 * rho[0];
  t399 = 0.1e1 / t398;
  t400 = t117 * t399;
  t407 = t115 * t27;
  t408 = t113 * t407;
  t409 = t204 * sigma[0];
  t413 = t141 * t407;
  t415 = params->c * sigma[0] * t90;
  t422 = t399 * t277;
  t427 = t399 * t124;
  t431 = t208 * t27;
  t432 = t113 * t431;
  t433 = t198 * t179;
  t436 = t141 * t431;
  t437 = t197 * t38;
  t438 = t437 * t315;
  t441 = t108 * t234;
  t444 = t125 * t234;
  t447 = t314 * t233;
  t448 = t313 * t447;
  t451 = t39 * t50;
  t452 = t320 * t233;
  t453 = t452 * t178;
  t463 = t159 * t342;
  t466 = t155 * t346;
  t469 = t159 * t354;
  t476 = t155 * t371;
  t479 = -t221 * t156 / 0.12e2 - t221 * t164 / 0.6e1 - 0.3e1 / 0.8e1 * t229 * t175 - t221 * t463 / 0.12e2 - 0.3e1 / 0.4e1 * t229 * t466 + t221 * t469 / 0.8e1 + 0.27e2 / 0.64e2 * t53 * t219 * t154 * t367 + 0.9e1 / 0.32e2 * t229 * t476;
  t480 = t152 * t479;
  t481 = t39 * t480;
  t484 = t26 * t129 * t38 / 0.9e1 - t116 * t135 * t394 / 0.36e2 + t270 * t400 * t277 / 0.108e3 - t203 * t108 * t204 / 0.9e1 + t408 * t125 * t409 / 0.36e2 - t413 * t313 * t415 / 0.36e2 - t203 * t180 / 0.24e2 - t270 * t117 * t422 * t204 / 0.108e3 + t300 * t117 * t427 * t303 / 0.108e3 + t432 * t433 / 0.288e3 - t436 * t438 / 0.288e3 + t149 * t441 / 0.9e1 - t308 * t444 / 0.108e3 + t312 * t448 / 0.108e3 + t149 * t451 * t453 / 0.12e2 - t149 * t481 / 0.24e2;
  t489 = my_piecewise3(t2, 0, -t6 * t101 * t238 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t484);
  tv2rhosigma0 = 0.2e1 * rho[0] * t489 + 0.2e1 * t242;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t495 = 0.1e1 / t272;
  t496 = sigma[0] * t495;
  t509 = t495 * t277;
  t518 = t198 * t234;
  t521 = t437 * t447;
  t524 = t233 * t233;
  t525 = t321 * t524;
  t526 = t39 * t525;
  t531 = t54 / t55 / sigma[0];
  t533 = t53 * t531 * t28;
  t536 = t224 * t342;
  t540 = t53 * t531 * t27;
  t541 = t62 * t346;
  t544 = t224 * t354;
  t551 = t62 * t371;
  t554 = -t533 * t86 / 0.32e2 + t533 * t536 / 0.32e2 + 0.9e1 / 0.32e2 * t540 * t541 - 0.3e1 / 0.64e2 * t533 * t544 - 0.81e2 / 0.512e3 * t53 * t531 * t60 * t367 - 0.27e2 / 0.256e3 * t540 * t551;
  t555 = t152 * t554;
  t556 = t39 * t555;
  t559 = t116 * t210 * t124 / 0.144e3 - t270 * t496 * t277 / 0.288e3 - t408 * t198 * t204 / 0.144e3 + t413 * t437 * t303 / 0.144e3 - t203 * t235 / 0.12e2 + t270 * sigma[0] * t509 * t204 / 0.288e3 - t300 * sigma[0] * t495 * t124 * t303 / 0.288e3 + t432 * t518 / 0.144e3 - t436 * t521 / 0.144e3 + t149 * t526 / 0.12e2 - t149 * t556 / 0.24e2;
  t563 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t559);
  tv2sigma20 = 0.2e1 * rho[0] * t563;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t566 = t17 * t33;
  t576 = t272 * t105;
  t577 = 0.1e1 / t576;
  t578 = t271 * t577;
  t582 = t270 * t275;
  t583 = t277 * t50;
  t584 = t151 * t178;
  t585 = t583 * t584;
  t588 = t300 * t275;
  t589 = t124 * params->c;
  t590 = t589 * t584;
  t593 = t112 * t112;
  t594 = t593 * t269;
  t595 = t117 * t117;
  t596 = t272 * t195;
  t598 = 0.1e1 / t31 / t596;
  t599 = t595 * t598;
  t601 = t123 * t123;
  t602 = 0.1e1 / t601;
  t604 = t602 * t20 * t202;
  t608 = 0.1e1 / t18 / t119;
  t610 = t53 * t56 * t608;
  t611 = t169 * t169;
  t614 = t83 * t83;
  t616 = 0.1e1 / t171 / t614;
  t617 = t61 * t77 * t611 * t616;
  t620 = t617 * t353 * t63 * t28;
  t623 = t608 * t61;
  t624 = t623 * t63;
  t625 = t160 * t353;
  t626 = t624 * t625;
  t629 = t340 * t340;
  t630 = 0.1e1 / t629;
  t631 = t351 * t630;
  t632 = t624 * t631;
  t636 = t77 * t169 * t84;
  t638 = 0.1e1 / t629 / t161;
  t639 = t636 * t638;
  t640 = t624 * t639;
  t643 = t623 * t85;
  t646 = t624 * t163;
  t649 = t624 * t342;
  t652 = t624 * t354;
  t655 = t611 * t172;
  t656 = t655 * t638;
  t657 = t623 * t656;
  t662 = t362 * t364 * t353 * t3;
  t665 = t370 * t630;
  t666 = t623 * t665;
  t670 = t61 * t76 * t611;
  t672 = t364 * t630 * t3;
  t673 = t670 * t672;
  t676 = t623 * t174;
  t679 = t623 * t346;
  t684 = t623 * t371;
  t687 = t173 * t353;
  t688 = t623 * t687;
  t691 = -0.63e2 / 0.16e2 * t610 * t620 - 0.8e1 / 0.27e2 * t58 * t626 + 0.2e1 * t58 * t632 - 0.2e1 * t58 * t640 - 0.35e2 / 0.27e2 * t58 * t643 - 0.23e2 / 0.9e1 * t58 * t646 - 0.14e2 / 0.9e1 * t58 * t649 + 0.7e1 / 0.3e1 * t58 * t652 - 0.9e1 / 0.2e1 * t168 * t657 + 0.27e2 / 0.2e1 * t610 * t662 + 0.27e2 / 0.2e1 * t168 * t666 - 0.27e2 / 0.4e1 * t610 * t673 - 0.23e2 / 0.4e1 * t168 * t676 - 0.14e2 * t168 * t679 + 0.63e2 / 0.8e1 * t610 * t367 + 0.21e2 / 0.4e1 * t168 * t684 - 0.26e2 / 0.3e1 * t168 * t688;
  t692 = t152 * t691;
  t693 = t39 * t692;
  t696 = t314 * t375;
  t697 = t313 * t696;
  t701 = t594 * t599 * t602;
  t703 = t20 * t25 * t28;
  t704 = t204 * t703;
  t708 = t270 * t599 * t277;
  t710 = t46 * t202 * t90;
  t713 = t125 * t376;
  t716 = t262 * t38;
  t721 = 0.1e1 / t31 / t195;
  t722 = t721 * t38;
  t727 = 0.1e1 / t18 / t272;
  t728 = t727 * t124;
  t732 = 0.38e2 / 0.81e2 * t270 * t578 * t277 - 0.2e1 / 0.27e2 * t582 * t585 + 0.2e1 / 0.27e2 * t588 * t590 - 0.2e1 / 0.243e3 * t594 * t599 * t604 - t149 * t693 / 0.24e2 + t312 * t697 / 0.36e2 + 0.2e1 / 0.243e3 * t701 * t704 - 0.2e1 / 0.243e3 * t708 * t710 - t308 * t713 / 0.36e2 - t312 * t716 * t315 / 0.4e1 + 0.154e3 / 0.81e2 * t26 * t29 * t722 - 0.341e3 / 0.486e3 * t116 * t118 * t728;
  t733 = t577 * t277;
  t741 = t27 * t727;
  t748 = t28 * t721;
  t753 = t320 * t178 * t375;
  t757 = t108 * t376;
  t760 = t256 * t179;
  t766 = t150 * t150;
  t767 = 0.1e1 / t766;
  t768 = t50 * t767;
  t769 = t322 * t178;
  t770 = t768 * t769;
  t771 = t39 * t770;
  t774 = params->c * t320;
  t775 = t774 * t322;
  t782 = t108 * t323;
  t785 = -0.38e2 / 0.81e2 * t295 * t733 * t204 + 0.38e2 / 0.81e2 * t301 * t577 * t124 * t303 + 0.341e3 / 0.486e3 * t134 * t741 * t137 - 0.341e3 / 0.486e3 * t142 * t741 * t144 - 0.154e3 / 0.81e2 * t44 * t748 * t91 + t149 * t451 * t753 / 0.4e1 + t149 * t757 / 0.3e1 - 0.11e2 / 0.9e1 * t149 * t760 + t308 * t263 * t179 / 0.4e1 - t149 * t771 / 0.4e1 - t312 * t313 * t775 / 0.18e2 + t308 * t125 * t323 / 0.18e2 - 0.2e1 / 0.3e1 * t149 * t782;
  t786 = t732 + t785;
  t791 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t566 * t95 + t6 * t247 * t183 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t101 * t380 - 0.3e1 / 0.8e1 * t6 * t19 * t786);
  tv3rho30 = 0.2e1 * rho[0] * t791 + 0.6e1 * t385;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t807 = t270 * t400;
  t810 = t300 * t400;
  t813 = t151 * t233;
  t814 = t583 * t813;
  t817 = t589 * t813;
  t820 = t272 * t119;
  t822 = 0.1e1 / t31 / t820;
  t823 = t271 * t822;
  t830 = t270 * t274;
  t831 = t90 * t117;
  t832 = t583 * t831;
  t835 = t300 * t274;
  t836 = t589 * t831;
  t852 = t767 * t233 * t322;
  t856 = t108 * t50;
  t860 = t313 * params->c;
  t861 = t860 * t453;
  t864 = -0.17e2 / 0.108e3 * t270 * t296 * t117 + 0.11e2 / 0.27e2 * t203 * t256 * t204 + t807 * t585 / 0.54e2 - t810 * t590 / 0.54e2 - 0.2e1 / 0.81e2 * t582 * t814 + 0.2e1 / 0.81e2 * t588 * t817 + t594 * t823 * t604 / 0.324e3 + 0.65e2 / 0.324e3 * t116 * t285 * t394 + 0.17e2 / 0.108e3 * t830 * t832 - 0.17e2 / 0.108e3 * t835 * t836 + t203 * t324 / 0.12e2 - t203 * t377 / 0.24e2 + 0.2e1 / 0.9e1 * t203 * t292 - 0.65e2 / 0.324e3 * t408 * t263 * t409 + 0.65e2 / 0.324e3 * t413 * t716 * t415 - t149 * t451 * t852 / 0.4e1 - 0.4e1 / 0.9e1 * t149 * t856 * t453 - t312 * t861 / 0.27e2;
  t865 = t125 * t50;
  t866 = t865 * t453;
  t869 = t452 * t375;
  t873 = t320 * t479;
  t874 = t873 * t178;
  t878 = t256 * t234;
  t881 = t333 * t639;
  t885 = t53 * t219 * t328;
  t888 = t333 * t625;
  t891 = t333 * t631;
  t902 = t329 * t656;
  t907 = t329 * t687;
  t912 = t329 * t665;
  t923 = 0.3e1 / 0.4e1 * t221 * t881 + 0.189e3 / 0.128e3 * t885 * t620 + t221 * t888 / 0.9e1 - 0.3e1 / 0.4e1 * t221 * t891 + 0.7e1 / 0.36e2 * t221 * t330 + t221 * t334 / 0.2e1 + 0.5e1 / 0.12e2 * t221 * t343 - 0.5e1 / 0.8e1 * t221 * t355 + 0.27e2 / 0.16e2 * t229 * t902 - 0.45e2 / 0.32e2 * t229 * t372 + 0.13e2 / 0.4e1 * t229 * t907 - 0.81e2 / 0.16e2 * t885 * t662 - 0.81e2 / 0.16e2 * t229 * t912 + 0.81e2 / 0.32e2 * t885 * t673 + 0.9e1 / 0.8e1 * t229 * t337 + 0.15e2 / 0.4e1 * t229 * t347 - 0.135e3 / 0.64e2 * t885 * t367;
  t924 = t152 * t923;
  t925 = t39 * t924;
  t928 = t314 * t479;
  t929 = t313 * t928;
  t938 = t125 * t480;
  t941 = t108 * t480;
  t944 = t437 * t696;
  t947 = t198 * t376;
  t951 = t594 * t823 * t602;
  t955 = t270 * t823 * t277;
  t958 = t407 * t122;
  t959 = t113 * t958;
  t961 = t151 * sigma[0] * t178;
  t962 = t136 * t961;
  t965 = t141 * t958;
  t966 = t143 * t961;
  t969 = t437 * t775;
  t972 = t198 * t323;
  t978 = t308 * t866 / 0.27e2 + t149 * t451 * t869 / 0.12e2 + t149 * t451 * t874 / 0.6e1 - 0.11e2 / 0.27e2 * t149 * t878 - t149 * t925 / 0.24e2 + t312 * t929 / 0.54e2 + t308 * t263 * t234 / 0.12e2 - t312 * t716 * t447 / 0.12e2 - t308 * t938 / 0.54e2 + 0.2e1 / 0.9e1 * t149 * t941 - t436 * t944 / 0.288e3 + t432 * t947 / 0.288e3 - t951 * t704 / 0.324e3 + t955 * t710 / 0.324e3 - t959 * t962 / 0.18e2 + t965 * t966 / 0.18e2 + t436 * t969 / 0.144e3 - t432 * t972 / 0.144e3 - 0.11e2 / 0.27e2 * t26 * t281 * t38;
  t979 = t864 + t978;
  t984 = my_piecewise3(t2, 0, t6 * t247 * t238 / 0.12e2 - t6 * t101 * t484 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t979);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t984 + 0.4e1 * t489;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1000 = 0.1e1 / t31 / t576;
  t1001 = t117 * t1000;
  t1005 = t270 * t496;
  t1008 = t300 * t496;
  t1023 = t437 * params->c;
  t1027 = t198 * t50;
  t1031 = t767 * t524;
  t1032 = t1031 * t178;
  t1036 = t320 * t554;
  t1037 = t1036 * t178;
  t1041 = t452 * t479;
  t1045 = 0.5e1 / 0.108e3 * t270 * t422 * sigma[0] - t413 * t313 * t303 / 0.27e2 + t408 * t125 * t204 / 0.27e2 - t594 * t1001 * t604 / 0.864e3 - t1005 * t585 / 0.288e3 + t1008 * t590 / 0.288e3 + t807 * t814 / 0.54e2 - t810 * t817 / 0.54e2 + 0.2e1 / 0.9e1 * t203 * t441 - t413 * t438 / 0.144e3 - t203 * t481 / 0.12e2 + t408 * t433 / 0.144e3 + t436 * t1023 * t453 / 0.72e2 - t432 * t1027 * t453 / 0.72e2 - t149 * t451 * t1032 / 0.4e1 + t149 * t451 * t1037 / 0.12e2 + t149 * t451 * t1041 / 0.6e1;
  t1047 = t21 * t202 * t33;
  t1048 = t51 * t453;
  t1051 = t198 * t480;
  t1054 = t813 * sigma[0];
  t1055 = t136 * t1054;
  t1058 = t143 * t1054;
  t1062 = t594 * t1001 * t602;
  t1066 = t270 * t1001 * t277;
  t1077 = t159 * t625;
  t1080 = t155 * t687;
  t1083 = t159 * t631;
  t1089 = t53 * t531 * t154;
  t1092 = t155 * t665;
  t1097 = t159 * t639;
  t1108 = t155 * t656;
  t1111 = t533 * t156 / 0.24e2 + t533 * t164 / 0.24e2 + 0.3e1 / 0.32e2 * t540 * t175 - t533 * t463 / 0.24e2 - t533 * t1077 / 0.24e2 - 0.39e2 / 0.32e2 * t540 * t1080 + 0.9e1 / 0.32e2 * t533 * t1083 - 0.3e1 / 0.8e1 * t540 * t466 + 0.243e3 / 0.128e3 * t1089 * t662 + 0.243e3 / 0.128e3 * t540 * t1092 + t533 * t469 / 0.16e2 - 0.9e1 / 0.32e2 * t533 * t1097 + 0.27e2 / 0.128e3 * t1089 * t367 - 0.567e3 / 0.1024e4 * t1089 * t620 - 0.243e3 / 0.256e3 * t1089 * t673 + 0.9e1 / 0.64e2 * t540 * t476 - 0.81e2 / 0.128e3 * t540 * t1108;
  t1112 = t152 * t1111;
  t1113 = t39 * t1112;
  t1116 = t437 * t928;
  t1119 = t125 * t555;
  t1122 = t314 * t554;
  t1123 = t313 * t1122;
  t1126 = t125 * t525;
  t1129 = t774 * t524;
  t1130 = t313 * t1129;
  t1133 = t270 * t399;
  t1134 = t90 * sigma[0];
  t1135 = t583 * t1134;
  t1138 = t300 * t399;
  t1139 = t589 * t1134;
  t1142 = t108 * t555;
  t1145 = t108 * t525;
  t1151 = t1047 * t1048 / 0.6e1 + t432 * t1051 / 0.144e3 - t959 * t1055 / 0.18e2 + t965 * t1058 / 0.18e2 + t1062 * t704 / 0.864e3 - t1066 * t710 / 0.864e3 - t149 * t1113 / 0.24e2 - t436 * t1116 / 0.144e3 - t308 * t1119 / 0.108e3 + t312 * t1123 / 0.108e3 + t308 * t1126 / 0.54e2 - t312 * t1130 / 0.54e2 - 0.5e1 / 0.108e3 * t1133 * t1135 + 0.5e1 / 0.108e3 * t1138 * t1139 + t149 * t1142 / 0.9e1 - 0.2e1 / 0.9e1 * t149 * t1145 - t116 * t135 * t124 / 0.27e2;
  t1152 = t1045 + t1151;
  t1157 = my_piecewise3(t2, 0, -t6 * t101 * t559 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1152);
  tv3rhosigma20 = 0.2e1 * rho[0] * t1157 + 0.2e1 * t563;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1160 = t524 * t233;
  t1161 = t768 * t1160;
  t1162 = t39 * t1161;
  t1165 = t452 * t554;
  t1169 = t437 * t1129;
  t1172 = t198 * t525;
  t1177 = t54 / t55 / t117;
  t1179 = t53 * t1177 * t28;
  t1185 = t53 * t1177 * t27;
  t1190 = t224 * t625;
  t1193 = t62 * t687;
  t1196 = t224 * t631;
  t1202 = t53 * t1177 * t60;
  t1205 = t62 * t665;
  t1210 = t224 * t639;
  t1221 = t62 * t656;
  t1224 = 0.3e1 / 0.64e2 * t1179 * t86 - t1179 * t225 / 0.64e2 - 0.9e1 / 0.256e3 * t1185 * t230 - 0.3e1 / 0.64e2 * t1179 * t536 + t1179 * t1190 / 0.64e2 + 0.117e3 / 0.256e3 * t1185 * t1193 - 0.27e2 / 0.256e3 * t1179 * t1196 - 0.27e2 / 0.64e2 * t1185 * t541 - 0.729e3 / 0.1024e4 * t1202 * t662 - 0.729e3 / 0.1024e4 * t1185 * t1205 + 0.9e1 / 0.128e3 * t1179 * t544 + 0.27e2 / 0.256e3 * t1179 * t1210 + 0.243e3 / 0.1024e4 * t1202 * t367 + 0.1701e4 / 0.8192e4 * t1202 * t620 + 0.729e3 / 0.2048e4 * t1202 * t673 + 0.81e2 / 0.512e3 * t1185 * t551 + 0.243e3 / 0.1024e4 * t1185 * t1221;
  t1225 = t152 * t1224;
  t1226 = t39 * t1225;
  t1229 = t437 * t1122;
  t1232 = t198 * t555;
  t1236 = 0.1e1 / t31 / t273;
  t1237 = sigma[0] * t1236;
  t1239 = t594 * t1237 * t602;
  t1243 = t270 * t1237 * t277;
  t1248 = t270 * t495;
  t1249 = t583 * t90;
  t1252 = t300 * t495;
  t1253 = t589 * t90;
  t1271 = -t149 * t1162 / 0.4e1 + t149 * t451 * t1165 / 0.4e1 + t436 * t1169 / 0.48e2 - t432 * t1172 / 0.48e2 - t149 * t1226 / 0.24e2 - t436 * t1229 / 0.96e2 + t432 * t1232 / 0.96e2 - t1239 * t704 / 0.2304e4 + t1243 * t710 / 0.2304e4 + t203 * t526 / 0.4e1 + t1248 * t1249 / 0.96e2 - t1252 * t1253 / 0.96e2 + t594 * t1237 * t604 / 0.2304e4 - t1005 * t814 / 0.96e2 + t1008 * t817 / 0.96e2 - t270 * t509 / 0.96e2 + t408 * t518 / 0.48e2 - t413 * t521 / 0.48e2 - t203 * t556 / 0.8e1;
  t1275 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1271);
  tv3sigma30 = 0.2e1 * rho[0] * t1275;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t38, t39, t43;
  double t44, t45, t46, t47, t50, t51, t52, t53;
  double t54, t55, t56, t58, t60, t61, t62, t63;
  double t64, t68, t69, t72, t75, t76, t77, t83;
  double t84, t85, t86, t89, t90, t91, t95, t99;
  double tzk0;

  double t101, t105, t107, t108, t112, t113, t115, t116;
  double t117, t118, t119, t120, t122, t123, t124, t125;
  double t129, t133, t134, t135, t136, t137, t141, t142;
  double t143, t144, t149, t150, t151, t152, t154, t155;
  double t156, t159, t160, t161, t162, t163, t164, t168;
  double t169, t170, t171, t172, t173, t174, t175, t178;
  double t179, t180, t183, t188, tvrho0, t195, t197, t198;
  double t202, t203, t204, t208, t210, t219, t221, t224;
  double t225, t229, t230, t233, t234, t235, t238, t242;
  double tvsigma0;

  double t247, t255, t256, t260, t262, t263, t268, t269;
  double t270, t271, t272, t273, t274, t275, t277, t281;
  double t285, t292, t295, t296, t300, t301, t302, t303;
  double t307, t308, t309, t312, t313, t314, t315, t316;
  double t320, t321, t322, t323, t324, t328, t329, t330;
  double t333, t334, t337, t340, t341, t342, t343, t346;
  double t347, t351, t352, t353, t354, t355, t360, t362;
  double t364, t367, t370, t371, t372, t375, t376, t377;
  double t380, t385, tv2rho20, t394, t398, t399, t400, t407;
  double t408, t409, t413, t415, t422, t427, t431, t432;
  double t433, t436, t437, t438, t441, t444, t447, t448;
  double t451, t452, t453, t463, t466, t469, t476, t479;
  double t480, t481, t484, t489, tv2rhosigma0, t495, t496, t509;
  double t518, t521, t524, t525, t526, t531, t533, t536;
  double t540, t541, t544, t551, t554, t555, t556, t559;
  double t563, tv2sigma20;

  double t566, t576, t577, t578, t582, t583, t584, t585;
  double t588, t589, t590, t593, t594, t595, t596, t598;
  double t599, t601, t602, t604, t608, t610, t611, t614;
  double t616, t617, t620, t623, t624, t625, t626, t629;
  double t630, t631, t632, t636, t638, t639, t640, t643;
  double t646, t649, t652, t655, t656, t657, t662, t665;
  double t666, t670, t672, t673, t676, t679, t684, t687;
  double t688, t691, t692, t693, t696, t697, t701, t703;
  double t704, t708, t710, t713, t716, t721, t722, t727;
  double t728, t732, t733, t741, t748, t753, t757, t760;
  double t766, t767, t768, t769, t770, t771, t774, t775;
  double t782, t785, t786, t791, tv3rho30, t807, t810, t813;
  double t814, t817, t820, t822, t823, t830, t831, t832;
  double t835, t836, t852, t856, t860, t861, t864, t865;
  double t866, t869, t873, t874, t878, t881, t885, t888;
  double t891, t902, t907, t912, t923, t924, t925, t928;
  double t929, t938, t941, t944, t947, t951, t955, t958;
  double t959, t961, t962, t965, t966, t969, t972, t978;
  double t979, t984, tv3rho2sigma0, t1000, t1001, t1005, t1008, t1023;
  double t1027, t1031, t1032, t1036, t1037, t1041, t1045, t1047;
  double t1048, t1051, t1054, t1055, t1058, t1062, t1066, t1077;
  double t1080, t1083, t1089, t1092, t1097, t1108, t1111, t1112;
  double t1113, t1116, t1119, t1122, t1123, t1126, t1129, t1130;
  double t1133, t1134, t1135, t1138, t1139, t1142, t1145, t1151;
  double t1152, t1157, tv3rhosigma20, t1160, t1161, t1162, t1165, t1169;
  double t1172, t1177, t1179, t1185, t1190, t1193, t1196, t1202;
  double t1205, t1210, t1221, t1224, t1225, t1226, t1229, t1232;
  double t1236, t1237, t1239, t1243, t1248, t1249, t1252, t1253;
  double t1271, t1275, tv3sigma30;

  double t1291, t1296, t1297, t1300, t1303, t1306, t1309, t1310;
  double t1313, t1316, t1319, t1324, t1326, t1330, t1333, t1335;
  double t1339, t1345, t1346, t1350, t1365, t1367, t1372, t1387;
  double t1394, t1396, t1397, t1405, t1412, t1413, t1420, t1421;
  double t1436, t1439, t1445, t1448, t1452, t1461, t1472, t1477;
  double t1493, t1497, t1508, t1511, t1515, t1519, t1526, t1564;
  double t1568, t1569, t1570, t1581, t1587, t1598, t1612, t1613;
  double t1614, t1618, t1625, tv4rho40, t1638, t1639, t1646, t1656;
  double t1661, t1662, t1666, t1678, t1698, t1703, t1706, t1761;
  double t1790, t1794, t1819, t1849, t1885, t1894, t1902, t1906;
  double t1923, t1924, t1927, t1940, t1957, t1966, t1973, tv4rho3sigma0;
  double t2029, t2049, t2066, t2095, t2133, t2139, t2143, t2150;
  double t2166, t2183, t2256, t2279, t2283, t2296, t2299, t2300;
  double t2303, t2306, t2307, t2310, t2330, t2338, tv4rho2sigma20, t2380;
  double t2410, t2448, t2454, t2457, t2475, t2487, t2496, t2515;
  double t2569, t2583, t2608, t2612, t2619, tv4rhosigma30, t2664, t2669;
  double t2683, t2688, t2708, t2710, t2718, t2747, t2749, t2786;
  double t2798, t2803, tv4sigma40;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->alpha * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = t26 * t34;
  t37 = 0.1e1 + t35 / 0.24e2;
  t38 = 0.1e1 / t37;
  t39 = t33 * t38;
  t43 = t25 * sigma[0];
  t44 = t21 * t43;
  t45 = t28 * t33;
  t46 = params->c * t20;
  t47 = t46 * t25;
  t50 = 0.1e1 + t47 * t34 / 0.24e2;
  t51 = t38 * t50;
  t52 = t20 * t20;
  t53 = params->c * t52;
  t54 = 0.1e1 / t23;
  t55 = sqrt(sigma[0]);
  t56 = t54 * t55;
  t58 = t53 * t56 * t28;
  t60 = 0.1e1 / t18 / rho[0];
  t61 = 0.1e1 / M_PI;
  t62 = t60 * t61;
  t63 = t3 * t3;
  t64 = sqrt(0.12e2);
  t68 = t52 * t54 * t55 * t27 * t60;
  t69 = sqrt(t68);
  t72 = sqrt(0.6e1);
  t75 = LambertW(t64 * t69 * t68 * t72 / 0.1728e4);
  t76 = POW_1_3(t75);
  t77 = t76 * t76;
  t83 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t3 * t28 * t76 * t75;
  t84 = POW_1_4(t83);
  t85 = t63 * t77 * t84;
  t86 = t62 * t85;
  t89 = 0.1e1 + t58 * t86 / 0.8e1;
  t90 = 0.1e1 / t89;
  t91 = t51 * t90;
  t95 = 0.1e1 - t26 * t29 * t39 / 0.24e2 + t44 * t45 * t91 / 0.24e2;
  t99 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t101 = t17 / t31;
  t105 = t30 * rho[0];
  t107 = 0.1e1 / t31 / t105;
  t108 = t107 * t38;
  t112 = params->alpha * params->alpha;
  t113 = t112 * t52;
  t115 = 0.1e1 / t23 / t22;
  t116 = t113 * t115;
  t117 = sigma[0] * sigma[0];
  t118 = t117 * t27;
  t119 = t30 * t30;
  t120 = t119 * t30;
  t122 = 0.1e1 / t18 / t120;
  t123 = t37 * t37;
  t124 = 0.1e1 / t123;
  t125 = t122 * t124;
  t129 = t28 * t107;
  t133 = t115 * t117;
  t134 = t113 * t133;
  t135 = t27 * t122;
  t136 = t124 * t50;
  t137 = t136 * t90;
  t141 = params->alpha * t52;
  t142 = t141 * t133;
  t143 = t38 * params->c;
  t144 = t143 * t90;
  t149 = t21 * t43 * t28;
  t150 = t89 * t89;
  t151 = 0.1e1 / t150;
  t152 = t50 * t151;
  t154 = 0.1e1 / t18 / t30;
  t155 = t154 * t61;
  t156 = t155 * t85;
  t159 = t155 * t63;
  t160 = t77 * t84;
  t161 = 0.1e1 + t75;
  t162 = 0.1e1 / t161;
  t163 = t160 * t162;
  t164 = t159 * t163;
  t168 = t53 * t56 * t27;
  t169 = t75 * t75;
  t170 = t84 * t84;
  t171 = t170 * t84;
  t172 = 0.1e1 / t171;
  t173 = t169 * t172;
  t174 = t173 * t162;
  t175 = t155 * t174;
  t178 = -t58 * t156 / 0.6e1 - t58 * t164 / 0.6e1 - 0.3e1 / 0.8e1 * t168 * t175;
  t179 = t152 * t178;
  t180 = t39 * t179;
  t183 = t26 * t29 * t108 / 0.9e1 - t116 * t118 * t125 / 0.108e3 - t44 * t129 * t91 / 0.9e1 + t134 * t135 * t137 / 0.108e3 - t142 * t135 * t144 / 0.108e3 - t149 * t180 / 0.24e2;
  t188 = my_piecewise3(t2, 0, -t6 * t101 * t95 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t183);
  tvrho0 = 0.2e1 * rho[0] * t188 + 0.2e1 * t99;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t195 = t119 * rho[0];
  t197 = 0.1e1 / t18 / t195;
  t198 = t197 * t124;
  t202 = t25 * t28;
  t203 = t21 * t202;
  t204 = t50 * t90;
  t208 = t115 * sigma[0];
  t210 = t27 * t197;
  t219 = t54 / t55;
  t221 = t53 * t219 * t28;
  t224 = t62 * t63;
  t225 = t224 * t163;
  t229 = t53 * t219 * t27;
  t230 = t62 * t174;
  t233 = t221 * t86 / 0.16e2 + t221 * t225 / 0.16e2 + 0.9e1 / 0.64e2 * t229 * t230;
  t234 = t152 * t233;
  t235 = t39 * t234;
  t238 = -t26 * t45 * t38 / 0.24e2 + t116 * sigma[0] * t27 * t198 / 0.288e3 + t203 * t39 * t204 / 0.24e2 - t113 * t208 * t210 * t137 / 0.288e3 + t141 * t208 * t210 * t144 / 0.288e3 - t149 * t235 / 0.24e2;
  t242 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t238);
  tvsigma0 = 0.2e1 * rho[0] * t242;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t247 = t17 / t31 / rho[0];
  t255 = 0.1e1 / t31 / t119;
  t256 = t255 * t38;
  t260 = t119 * t105;
  t262 = 0.1e1 / t18 / t260;
  t263 = t262 * t124;
  t268 = t22 * t22;
  t269 = 0.1e1 / t268;
  t270 = t112 * params->alpha * t269;
  t271 = t117 * sigma[0];
  t272 = t119 * t119;
  t273 = t272 * t30;
  t274 = 0.1e1 / t273;
  t275 = t271 * t274;
  t277 = 0.1e1 / t123 / t37;
  t281 = t28 * t255;
  t285 = t27 * t262;
  t292 = t108 * t179;
  t295 = t270 * t271;
  t296 = t274 * t277;
  t300 = t112 * t269;
  t301 = t300 * t271;
  t302 = t274 * t124;
  t303 = params->c * t90;
  t307 = t133 * t27;
  t308 = t113 * t307;
  t309 = t125 * t179;
  t312 = t141 * t307;
  t313 = t122 * t38;
  t314 = params->c * t151;
  t315 = t314 * t178;
  t316 = t313 * t315;
  t320 = 0.1e1 / t150 / t89;
  t321 = t50 * t320;
  t322 = t178 * t178;
  t323 = t321 * t322;
  t324 = t39 * t323;
  t328 = 0.1e1 / t18 / t105;
  t329 = t328 * t61;
  t330 = t329 * t85;
  t333 = t329 * t63;
  t334 = t333 * t163;
  t337 = t329 * t174;
  t340 = t161 * t161;
  t341 = 0.1e1 / t340;
  t342 = t160 * t341;
  t343 = t333 * t342;
  t346 = t173 * t341;
  t347 = t329 * t346;
  t351 = t77 * t75 * t84;
  t352 = t340 * t161;
  t353 = 0.1e1 / t352;
  t354 = t351 * t353;
  t355 = t333 * t354;
  t360 = t169 * t75;
  t362 = t61 * t76 * t360;
  t364 = 0.1e1 / t171 / t83;
  t367 = t362 * t364 * t341 * t3;
  t370 = t360 * t172;
  t371 = t370 * t353;
  t372 = t329 * t371;
  t375 = 0.7e1 / 0.18e2 * t58 * t330 + 0.11e2 / 0.18e2 * t58 * t334 + 0.11e2 / 0.8e1 * t168 * t337 + 0.2e1 / 0.9e1 * t58 * t343 + 0.2e1 * t168 * t347 - t58 * t355 / 0.3e1 - 0.9e1 / 0.8e1 * t53 * t56 * t328 * t367 - 0.3e1 / 0.4e1 * t168 * t372;
  t376 = t152 * t375;
  t377 = t39 * t376;
  t380 = -0.11e2 / 0.27e2 * t26 * t29 * t256 + t116 * t118 * t263 / 0.12e2 - 0.2e1 / 0.81e2 * t270 * t275 * t277 + 0.11e2 / 0.27e2 * t44 * t281 * t91 - t134 * t285 * t137 / 0.12e2 + t142 * t285 * t144 / 0.12e2 + 0.2e1 / 0.9e1 * t149 * t292 + 0.2e1 / 0.81e2 * t295 * t296 * t204 - 0.2e1 / 0.81e2 * t301 * t302 * t303 - t308 * t309 / 0.54e2 + t312 * t316 / 0.54e2 + t149 * t324 / 0.12e2 - t149 * t377 / 0.24e2;
  t385 = my_piecewise3(t2, 0, t6 * t247 * t95 / 0.12e2 - t6 * t101 * t183 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t380);
  tv2rho20 = 0.2e1 * rho[0] * t385 + 0.4e1 * t188;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t394 = t124 * sigma[0];
  t398 = t272 * rho[0];
  t399 = 0.1e1 / t398;
  t400 = t117 * t399;
  t407 = t115 * t27;
  t408 = t113 * t407;
  t409 = t204 * sigma[0];
  t413 = t141 * t407;
  t415 = params->c * sigma[0] * t90;
  t422 = t399 * t277;
  t427 = t399 * t124;
  t431 = t208 * t27;
  t432 = t113 * t431;
  t433 = t198 * t179;
  t436 = t141 * t431;
  t437 = t197 * t38;
  t438 = t437 * t315;
  t441 = t108 * t234;
  t444 = t125 * t234;
  t447 = t314 * t233;
  t448 = t313 * t447;
  t451 = t39 * t50;
  t452 = t320 * t233;
  t453 = t452 * t178;
  t463 = t159 * t342;
  t466 = t155 * t346;
  t469 = t159 * t354;
  t476 = t155 * t371;
  t479 = -t221 * t156 / 0.12e2 - t221 * t164 / 0.6e1 - 0.3e1 / 0.8e1 * t229 * t175 - t221 * t463 / 0.12e2 - 0.3e1 / 0.4e1 * t229 * t466 + t221 * t469 / 0.8e1 + 0.27e2 / 0.64e2 * t53 * t219 * t154 * t367 + 0.9e1 / 0.32e2 * t229 * t476;
  t480 = t152 * t479;
  t481 = t39 * t480;
  t484 = t26 * t129 * t38 / 0.9e1 - t116 * t135 * t394 / 0.36e2 + t270 * t400 * t277 / 0.108e3 - t203 * t108 * t204 / 0.9e1 + t408 * t125 * t409 / 0.36e2 - t413 * t313 * t415 / 0.36e2 - t203 * t180 / 0.24e2 - t270 * t117 * t422 * t204 / 0.108e3 + t300 * t117 * t427 * t303 / 0.108e3 + t432 * t433 / 0.288e3 - t436 * t438 / 0.288e3 + t149 * t441 / 0.9e1 - t308 * t444 / 0.108e3 + t312 * t448 / 0.108e3 + t149 * t451 * t453 / 0.12e2 - t149 * t481 / 0.24e2;
  t489 = my_piecewise3(t2, 0, -t6 * t101 * t238 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t484);
  tv2rhosigma0 = 0.2e1 * rho[0] * t489 + 0.2e1 * t242;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t495 = 0.1e1 / t272;
  t496 = sigma[0] * t495;
  t509 = t495 * t277;
  t518 = t198 * t234;
  t521 = t437 * t447;
  t524 = t233 * t233;
  t525 = t321 * t524;
  t526 = t39 * t525;
  t531 = t54 / t55 / sigma[0];
  t533 = t53 * t531 * t28;
  t536 = t224 * t342;
  t540 = t53 * t531 * t27;
  t541 = t62 * t346;
  t544 = t224 * t354;
  t551 = t62 * t371;
  t554 = -t533 * t86 / 0.32e2 + t533 * t536 / 0.32e2 + 0.9e1 / 0.32e2 * t540 * t541 - 0.3e1 / 0.64e2 * t533 * t544 - 0.81e2 / 0.512e3 * t53 * t531 * t60 * t367 - 0.27e2 / 0.256e3 * t540 * t551;
  t555 = t152 * t554;
  t556 = t39 * t555;
  t559 = t116 * t210 * t124 / 0.144e3 - t270 * t496 * t277 / 0.288e3 - t408 * t198 * t204 / 0.144e3 + t413 * t437 * t303 / 0.144e3 - t203 * t235 / 0.12e2 + t270 * sigma[0] * t509 * t204 / 0.288e3 - t300 * sigma[0] * t495 * t124 * t303 / 0.288e3 + t432 * t518 / 0.144e3 - t436 * t521 / 0.144e3 + t149 * t526 / 0.12e2 - t149 * t556 / 0.24e2;
  t563 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t559);
  tv2sigma20 = 0.2e1 * rho[0] * t563;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t566 = t17 * t33;
  t576 = t272 * t105;
  t577 = 0.1e1 / t576;
  t578 = t271 * t577;
  t582 = t270 * t275;
  t583 = t277 * t50;
  t584 = t151 * t178;
  t585 = t583 * t584;
  t588 = t300 * t275;
  t589 = t124 * params->c;
  t590 = t589 * t584;
  t593 = t112 * t112;
  t594 = t593 * t269;
  t595 = t117 * t117;
  t596 = t272 * t195;
  t598 = 0.1e1 / t31 / t596;
  t599 = t595 * t598;
  t601 = t123 * t123;
  t602 = 0.1e1 / t601;
  t604 = t602 * t20 * t202;
  t608 = 0.1e1 / t18 / t119;
  t610 = t53 * t56 * t608;
  t611 = t169 * t169;
  t614 = t83 * t83;
  t616 = 0.1e1 / t171 / t614;
  t617 = t61 * t77 * t611 * t616;
  t620 = t617 * t353 * t63 * t28;
  t623 = t608 * t61;
  t624 = t623 * t63;
  t625 = t160 * t353;
  t626 = t624 * t625;
  t629 = t340 * t340;
  t630 = 0.1e1 / t629;
  t631 = t351 * t630;
  t632 = t624 * t631;
  t636 = t77 * t169 * t84;
  t638 = 0.1e1 / t629 / t161;
  t639 = t636 * t638;
  t640 = t624 * t639;
  t643 = t623 * t85;
  t646 = t624 * t163;
  t649 = t624 * t342;
  t652 = t624 * t354;
  t655 = t611 * t172;
  t656 = t655 * t638;
  t657 = t623 * t656;
  t662 = t362 * t364 * t353 * t3;
  t665 = t370 * t630;
  t666 = t623 * t665;
  t670 = t61 * t76 * t611;
  t672 = t364 * t630 * t3;
  t673 = t670 * t672;
  t676 = t623 * t174;
  t679 = t623 * t346;
  t684 = t623 * t371;
  t687 = t173 * t353;
  t688 = t623 * t687;
  t691 = -0.63e2 / 0.16e2 * t610 * t620 - 0.8e1 / 0.27e2 * t58 * t626 + 0.2e1 * t58 * t632 - 0.2e1 * t58 * t640 - 0.35e2 / 0.27e2 * t58 * t643 - 0.23e2 / 0.9e1 * t58 * t646 - 0.14e2 / 0.9e1 * t58 * t649 + 0.7e1 / 0.3e1 * t58 * t652 - 0.9e1 / 0.2e1 * t168 * t657 + 0.27e2 / 0.2e1 * t610 * t662 + 0.27e2 / 0.2e1 * t168 * t666 - 0.27e2 / 0.4e1 * t610 * t673 - 0.23e2 / 0.4e1 * t168 * t676 - 0.14e2 * t168 * t679 + 0.63e2 / 0.8e1 * t610 * t367 + 0.21e2 / 0.4e1 * t168 * t684 - 0.26e2 / 0.3e1 * t168 * t688;
  t692 = t152 * t691;
  t693 = t39 * t692;
  t696 = t314 * t375;
  t697 = t313 * t696;
  t701 = t594 * t599 * t602;
  t703 = t20 * t25 * t28;
  t704 = t204 * t703;
  t708 = t270 * t599 * t277;
  t710 = t46 * t202 * t90;
  t713 = t125 * t376;
  t716 = t262 * t38;
  t721 = 0.1e1 / t31 / t195;
  t722 = t721 * t38;
  t727 = 0.1e1 / t18 / t272;
  t728 = t727 * t124;
  t732 = 0.38e2 / 0.81e2 * t270 * t578 * t277 - 0.2e1 / 0.27e2 * t582 * t585 + 0.2e1 / 0.27e2 * t588 * t590 - 0.2e1 / 0.243e3 * t594 * t599 * t604 - t149 * t693 / 0.24e2 + t312 * t697 / 0.36e2 + 0.2e1 / 0.243e3 * t701 * t704 - 0.2e1 / 0.243e3 * t708 * t710 - t308 * t713 / 0.36e2 - t312 * t716 * t315 / 0.4e1 + 0.154e3 / 0.81e2 * t26 * t29 * t722 - 0.341e3 / 0.486e3 * t116 * t118 * t728;
  t733 = t577 * t277;
  t741 = t27 * t727;
  t748 = t28 * t721;
  t753 = t320 * t178 * t375;
  t757 = t108 * t376;
  t760 = t256 * t179;
  t766 = t150 * t150;
  t767 = 0.1e1 / t766;
  t768 = t50 * t767;
  t769 = t322 * t178;
  t770 = t768 * t769;
  t771 = t39 * t770;
  t774 = params->c * t320;
  t775 = t774 * t322;
  t782 = t108 * t323;
  t785 = -0.38e2 / 0.81e2 * t295 * t733 * t204 + 0.38e2 / 0.81e2 * t301 * t577 * t124 * t303 + 0.341e3 / 0.486e3 * t134 * t741 * t137 - 0.341e3 / 0.486e3 * t142 * t741 * t144 - 0.154e3 / 0.81e2 * t44 * t748 * t91 + t149 * t451 * t753 / 0.4e1 + t149 * t757 / 0.3e1 - 0.11e2 / 0.9e1 * t149 * t760 + t308 * t263 * t179 / 0.4e1 - t149 * t771 / 0.4e1 - t312 * t313 * t775 / 0.18e2 + t308 * t125 * t323 / 0.18e2 - 0.2e1 / 0.3e1 * t149 * t782;
  t786 = t732 + t785;
  t791 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t566 * t95 + t6 * t247 * t183 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t101 * t380 - 0.3e1 / 0.8e1 * t6 * t19 * t786);
  tv3rho30 = 0.2e1 * rho[0] * t791 + 0.6e1 * t385;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t807 = t270 * t400;
  t810 = t300 * t400;
  t813 = t151 * t233;
  t814 = t583 * t813;
  t817 = t589 * t813;
  t820 = t272 * t119;
  t822 = 0.1e1 / t31 / t820;
  t823 = t271 * t822;
  t830 = t270 * t274;
  t831 = t90 * t117;
  t832 = t583 * t831;
  t835 = t300 * t274;
  t836 = t589 * t831;
  t852 = t767 * t233 * t322;
  t856 = t108 * t50;
  t860 = t313 * params->c;
  t861 = t860 * t453;
  t864 = -0.17e2 / 0.108e3 * t270 * t296 * t117 + 0.11e2 / 0.27e2 * t203 * t256 * t204 + t807 * t585 / 0.54e2 - t810 * t590 / 0.54e2 - 0.2e1 / 0.81e2 * t582 * t814 + 0.2e1 / 0.81e2 * t588 * t817 + t594 * t823 * t604 / 0.324e3 + 0.65e2 / 0.324e3 * t116 * t285 * t394 + 0.17e2 / 0.108e3 * t830 * t832 - 0.17e2 / 0.108e3 * t835 * t836 + t203 * t324 / 0.12e2 - t203 * t377 / 0.24e2 + 0.2e1 / 0.9e1 * t203 * t292 - 0.65e2 / 0.324e3 * t408 * t263 * t409 + 0.65e2 / 0.324e3 * t413 * t716 * t415 - t149 * t451 * t852 / 0.4e1 - 0.4e1 / 0.9e1 * t149 * t856 * t453 - t312 * t861 / 0.27e2;
  t865 = t125 * t50;
  t866 = t865 * t453;
  t869 = t452 * t375;
  t873 = t320 * t479;
  t874 = t873 * t178;
  t878 = t256 * t234;
  t881 = t333 * t639;
  t885 = t53 * t219 * t328;
  t888 = t333 * t625;
  t891 = t333 * t631;
  t902 = t329 * t656;
  t907 = t329 * t687;
  t912 = t329 * t665;
  t923 = 0.3e1 / 0.4e1 * t221 * t881 + 0.189e3 / 0.128e3 * t885 * t620 + t221 * t888 / 0.9e1 - 0.3e1 / 0.4e1 * t221 * t891 + 0.7e1 / 0.36e2 * t221 * t330 + t221 * t334 / 0.2e1 + 0.5e1 / 0.12e2 * t221 * t343 - 0.5e1 / 0.8e1 * t221 * t355 + 0.27e2 / 0.16e2 * t229 * t902 - 0.45e2 / 0.32e2 * t229 * t372 + 0.13e2 / 0.4e1 * t229 * t907 - 0.81e2 / 0.16e2 * t885 * t662 - 0.81e2 / 0.16e2 * t229 * t912 + 0.81e2 / 0.32e2 * t885 * t673 + 0.9e1 / 0.8e1 * t229 * t337 + 0.15e2 / 0.4e1 * t229 * t347 - 0.135e3 / 0.64e2 * t885 * t367;
  t924 = t152 * t923;
  t925 = t39 * t924;
  t928 = t314 * t479;
  t929 = t313 * t928;
  t938 = t125 * t480;
  t941 = t108 * t480;
  t944 = t437 * t696;
  t947 = t198 * t376;
  t951 = t594 * t823 * t602;
  t955 = t270 * t823 * t277;
  t958 = t407 * t122;
  t959 = t113 * t958;
  t961 = t151 * sigma[0] * t178;
  t962 = t136 * t961;
  t965 = t141 * t958;
  t966 = t143 * t961;
  t969 = t437 * t775;
  t972 = t198 * t323;
  t978 = t308 * t866 / 0.27e2 + t149 * t451 * t869 / 0.12e2 + t149 * t451 * t874 / 0.6e1 - 0.11e2 / 0.27e2 * t149 * t878 - t149 * t925 / 0.24e2 + t312 * t929 / 0.54e2 + t308 * t263 * t234 / 0.12e2 - t312 * t716 * t447 / 0.12e2 - t308 * t938 / 0.54e2 + 0.2e1 / 0.9e1 * t149 * t941 - t436 * t944 / 0.288e3 + t432 * t947 / 0.288e3 - t951 * t704 / 0.324e3 + t955 * t710 / 0.324e3 - t959 * t962 / 0.18e2 + t965 * t966 / 0.18e2 + t436 * t969 / 0.144e3 - t432 * t972 / 0.144e3 - 0.11e2 / 0.27e2 * t26 * t281 * t38;
  t979 = t864 + t978;
  t984 = my_piecewise3(t2, 0, t6 * t247 * t238 / 0.12e2 - t6 * t101 * t484 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t979);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t984 + 0.4e1 * t489;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1000 = 0.1e1 / t31 / t576;
  t1001 = t117 * t1000;
  t1005 = t270 * t496;
  t1008 = t300 * t496;
  t1023 = t437 * params->c;
  t1027 = t198 * t50;
  t1031 = t767 * t524;
  t1032 = t1031 * t178;
  t1036 = t320 * t554;
  t1037 = t1036 * t178;
  t1041 = t452 * t479;
  t1045 = 0.5e1 / 0.108e3 * t270 * t422 * sigma[0] - t413 * t313 * t303 / 0.27e2 + t408 * t125 * t204 / 0.27e2 - t594 * t1001 * t604 / 0.864e3 - t1005 * t585 / 0.288e3 + t1008 * t590 / 0.288e3 + t807 * t814 / 0.54e2 - t810 * t817 / 0.54e2 + 0.2e1 / 0.9e1 * t203 * t441 - t413 * t438 / 0.144e3 - t203 * t481 / 0.12e2 + t408 * t433 / 0.144e3 + t436 * t1023 * t453 / 0.72e2 - t432 * t1027 * t453 / 0.72e2 - t149 * t451 * t1032 / 0.4e1 + t149 * t451 * t1037 / 0.12e2 + t149 * t451 * t1041 / 0.6e1;
  t1047 = t21 * t202 * t33;
  t1048 = t51 * t453;
  t1051 = t198 * t480;
  t1054 = t813 * sigma[0];
  t1055 = t136 * t1054;
  t1058 = t143 * t1054;
  t1062 = t594 * t1001 * t602;
  t1066 = t270 * t1001 * t277;
  t1077 = t159 * t625;
  t1080 = t155 * t687;
  t1083 = t159 * t631;
  t1089 = t53 * t531 * t154;
  t1092 = t155 * t665;
  t1097 = t159 * t639;
  t1108 = t155 * t656;
  t1111 = t533 * t156 / 0.24e2 + t533 * t164 / 0.24e2 + 0.3e1 / 0.32e2 * t540 * t175 - t533 * t463 / 0.24e2 - t533 * t1077 / 0.24e2 - 0.39e2 / 0.32e2 * t540 * t1080 + 0.9e1 / 0.32e2 * t533 * t1083 - 0.3e1 / 0.8e1 * t540 * t466 + 0.243e3 / 0.128e3 * t1089 * t662 + 0.243e3 / 0.128e3 * t540 * t1092 + t533 * t469 / 0.16e2 - 0.9e1 / 0.32e2 * t533 * t1097 + 0.27e2 / 0.128e3 * t1089 * t367 - 0.567e3 / 0.1024e4 * t1089 * t620 - 0.243e3 / 0.256e3 * t1089 * t673 + 0.9e1 / 0.64e2 * t540 * t476 - 0.81e2 / 0.128e3 * t540 * t1108;
  t1112 = t152 * t1111;
  t1113 = t39 * t1112;
  t1116 = t437 * t928;
  t1119 = t125 * t555;
  t1122 = t314 * t554;
  t1123 = t313 * t1122;
  t1126 = t125 * t525;
  t1129 = t774 * t524;
  t1130 = t313 * t1129;
  t1133 = t270 * t399;
  t1134 = t90 * sigma[0];
  t1135 = t583 * t1134;
  t1138 = t300 * t399;
  t1139 = t589 * t1134;
  t1142 = t108 * t555;
  t1145 = t108 * t525;
  t1151 = t1047 * t1048 / 0.6e1 + t432 * t1051 / 0.144e3 - t959 * t1055 / 0.18e2 + t965 * t1058 / 0.18e2 + t1062 * t704 / 0.864e3 - t1066 * t710 / 0.864e3 - t149 * t1113 / 0.24e2 - t436 * t1116 / 0.144e3 - t308 * t1119 / 0.108e3 + t312 * t1123 / 0.108e3 + t308 * t1126 / 0.54e2 - t312 * t1130 / 0.54e2 - 0.5e1 / 0.108e3 * t1133 * t1135 + 0.5e1 / 0.108e3 * t1138 * t1139 + t149 * t1142 / 0.9e1 - 0.2e1 / 0.9e1 * t149 * t1145 - t116 * t135 * t124 / 0.27e2;
  t1152 = t1045 + t1151;
  t1157 = my_piecewise3(t2, 0, -t6 * t101 * t559 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1152);
  tv3rhosigma20 = 0.2e1 * rho[0] * t1157 + 0.2e1 * t563;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1160 = t524 * t233;
  t1161 = t768 * t1160;
  t1162 = t39 * t1161;
  t1165 = t452 * t554;
  t1169 = t437 * t1129;
  t1172 = t198 * t525;
  t1177 = t54 / t55 / t117;
  t1179 = t53 * t1177 * t28;
  t1185 = t53 * t1177 * t27;
  t1190 = t224 * t625;
  t1193 = t62 * t687;
  t1196 = t224 * t631;
  t1202 = t53 * t1177 * t60;
  t1205 = t62 * t665;
  t1210 = t224 * t639;
  t1221 = t62 * t656;
  t1224 = 0.3e1 / 0.64e2 * t1179 * t86 - t1179 * t225 / 0.64e2 - 0.9e1 / 0.256e3 * t1185 * t230 - 0.3e1 / 0.64e2 * t1179 * t536 + t1179 * t1190 / 0.64e2 + 0.117e3 / 0.256e3 * t1185 * t1193 - 0.27e2 / 0.256e3 * t1179 * t1196 - 0.27e2 / 0.64e2 * t1185 * t541 - 0.729e3 / 0.1024e4 * t1202 * t662 - 0.729e3 / 0.1024e4 * t1185 * t1205 + 0.9e1 / 0.128e3 * t1179 * t544 + 0.27e2 / 0.256e3 * t1179 * t1210 + 0.243e3 / 0.1024e4 * t1202 * t367 + 0.1701e4 / 0.8192e4 * t1202 * t620 + 0.729e3 / 0.2048e4 * t1202 * t673 + 0.81e2 / 0.512e3 * t1185 * t551 + 0.243e3 / 0.1024e4 * t1185 * t1221;
  t1225 = t152 * t1224;
  t1226 = t39 * t1225;
  t1229 = t437 * t1122;
  t1232 = t198 * t555;
  t1236 = 0.1e1 / t31 / t273;
  t1237 = sigma[0] * t1236;
  t1239 = t594 * t1237 * t602;
  t1243 = t270 * t1237 * t277;
  t1248 = t270 * t495;
  t1249 = t583 * t90;
  t1252 = t300 * t495;
  t1253 = t589 * t90;
  t1271 = -t149 * t1162 / 0.4e1 + t149 * t451 * t1165 / 0.4e1 + t436 * t1169 / 0.48e2 - t432 * t1172 / 0.48e2 - t149 * t1226 / 0.24e2 - t436 * t1229 / 0.96e2 + t432 * t1232 / 0.96e2 - t1239 * t704 / 0.2304e4 + t1243 * t710 / 0.2304e4 + t203 * t526 / 0.4e1 + t1248 * t1249 / 0.96e2 - t1252 * t1253 / 0.96e2 + t594 * t1237 * t604 / 0.2304e4 - t1005 * t814 / 0.96e2 + t1008 * t817 / 0.96e2 - t270 * t509 / 0.96e2 + t408 * t518 / 0.48e2 - t413 * t521 / 0.48e2 - t203 * t556 / 0.8e1;
  t1275 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1271);
  tv3sigma30 = 0.2e1 * rho[0] * t1275;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1291 = 0.1e1 / t820;
  t1296 = t151 * t375;
  t1297 = t589 * t1296;
  t1300 = t583 * t1296;
  t1303 = t300 * t578;
  t1306 = t270 * t578;
  t1309 = t320 * t322;
  t1310 = t589 * t1309;
  t1313 = t583 * t1309;
  t1316 = t272 * t120;
  t1319 = t595 / t31 / t1316;
  t1324 = t593 * params->alpha * t269;
  t1326 = t272 * t272;
  t1330 = t595 * sigma[0] / t18 / t1326 / rho[0];
  t1333 = 0.1e1 / t601 / t37;
  t1335 = t1333 * t52 * t407;
  t1339 = 0.1e1 / t31 / t120;
  t1345 = 0.1e1 / t18 / t398;
  t1346 = t27 * t1345;
  t1350 = -0.5126e4 / 0.729e3 * t270 * t271 * t1291 * t277 + 0.4e1 / 0.27e2 * t588 * t1297 - 0.4e1 / 0.27e2 * t582 * t1300 - 0.152e3 / 0.81e2 * t1303 * t590 + 0.152e3 / 0.81e2 * t1306 * t585 - 0.8e1 / 0.27e2 * t588 * t1310 + 0.8e1 / 0.27e2 * t582 * t1313 + 0.196e3 / 0.729e3 * t594 * t1319 * t604 - 0.16e2 / 0.2187e4 * t1324 * t1330 * t1335 + 0.2618e4 / 0.243e3 * t44 * t28 * t1339 * t91 + 0.3047e4 / 0.486e3 * t142 * t1346 * t144;
  t1365 = t28 * t151;
  t1367 = t47 * t1365 * t178;
  t1372 = t152 * t20 * t202 * t178;
  t1387 = t727 * t38;
  t1394 = -0.3047e4 / 0.486e3 * t134 * t1346 * t137 + t149 * t451 * t320 * t691 * t178 / 0.3e1 - 0.2e1 / 0.9e1 * t312 * t860 * t753 + 0.2e1 / 0.9e1 * t308 * t865 * t753 + 0.8e1 / 0.243e3 * t708 * t1367 - 0.8e1 / 0.243e3 * t701 * t1372 - 0.3e1 / 0.2e1 * t149 * t451 * t767 * t322 * t375 - 0.8e1 / 0.3e1 * t149 * t856 * t753 - 0.2618e4 / 0.243e3 * t26 * t29 * t1339 * t38 + 0.682e3 / 0.243e3 * t312 * t1387 * t315 - 0.682e3 / 0.243e3 * t308 * t728 * t179;
  t1396 = t197 * t61;
  t1397 = t1396 * t63;
  t1405 = t53 * t56 * t197;
  t1412 = 0.1e1 / t629 / t340;
  t1413 = t636 * t1412;
  t1420 = 0.1e1 / t629 / t352;
  t1421 = t77 * t360 * t84 * t1420;
  t1436 = t617 * t630 * t63 * t28;
  t1439 = t611 * t75;
  t1445 = t61 * t77 * t1439 * t616 * t638 * t63 * t28;
  t1448 = t160 * t630;
  t1452 = t351 * t638;
  t1461 = -0.68e2 / 0.3e1 * t58 * t1397 * t631 + 0.68e2 / 0.3e1 * t58 * t1397 * t639 + 0.357e3 / 0.8e1 * t1405 * t620 + 0.272e3 / 0.81e2 * t58 * t1397 * t625 + 0.8e2 / 0.3e1 * t58 * t1397 * t1413 - 0.2e2 * t58 * t1397 * t1421 + 0.1037e4 / 0.81e2 * t58 * t1397 * t163 + 0.274e3 / 0.27e2 * t58 * t1397 * t342 - 0.137e3 / 0.9e1 * t58 * t1397 * t354 + 0.84e2 * t1405 * t1436 - 0.189e3 / 0.4e1 * t1405 * t1445 + 0.32e2 / 0.81e2 * t58 * t1397 * t1448 - 0.76e2 / 0.9e1 * t58 * t1397 * t1452 - 0.411e3 / 0.8e1 * t1405 * t367 - 0.137e3 / 0.4e1 * t168 * t1396 * t371;
  t1472 = t362 * t672;
  t1477 = t670 * t364 * t638 * t3;
  t1493 = t61 * t76 * t1439 * t364 * t1412 * t3;
  t1497 = t1439 * t172 * t1420;
  t1508 = t61 * t611 * t169 / t171 / t614 / t83 * t630 * t27;
  t1511 = t173 * t630;
  t1515 = t370 * t638;
  t1519 = t655 * t1412;
  t1526 = 0.153e3 / 0.2e1 * t1405 * t673 + 0.51e2 * t168 * t1396 * t656 - 0.153e3 * t1405 * t662 + 0.455e3 / 0.81e2 * t58 * t1396 * t85 - 0.116e3 * t1405 * t1472 + 0.18e3 * t1405 * t1477 + 0.274e3 / 0.3e1 * t168 * t1396 * t346 + 0.884e3 / 0.9e1 * t168 * t1396 * t687 - 0.153e3 * t168 * t1396 * t665 - 0.135e3 / 0.2e1 * t1405 * t1493 - 0.45e2 * t168 * t1396 * t1497 - 0.2079e4 / 0.16e2 * t1405 * t1508 + 0.32e3 / 0.9e1 * t168 * t1396 * t1511 - 0.139e3 * t168 * t1396 * t1515 + 0.15e3 * t168 * t1396 * t1519 + 0.1037e4 / 0.36e2 * t168 * t1396 * t174;
  t1564 = t314 * t691;
  t1568 = -t149 * t39 * t152 * (t1461 + t1526) / 0.24e2 + 0.4e1 / 0.9e1 * t149 * t108 * t692 - 0.196e3 / 0.729e3 * t594 * t1319 * t602 * t704 - t312 * t716 * t696 / 0.2e1 + t308 * t263 * t376 / 0.2e1 + 0.196e3 / 0.729e3 * t270 * t1319 * t277 * t710 + 0.3047e4 / 0.486e3 * t116 * t118 * t1345 * t124 + 0.5126e4 / 0.729e3 * t295 * t1291 * t277 * t204 - 0.5126e4 / 0.729e3 * t301 * t1291 * t124 * t303 - t308 * t125 * t692 / 0.27e2 + t312 * t313 * t1564 / 0.27e2;
  t1569 = params->c * t767;
  t1570 = t1569 * t769;
  t1581 = t204 * t52 * t115 * t27;
  t1587 = t53 * t407 * t90;
  t1598 = t375 * t375;
  t1612 = 0.1e1 / t766 / t89;
  t1613 = t50 * t1612;
  t1614 = t322 * t322;
  t1618 = 0.2e1 / 0.9e1 * t312 * t313 * t1570 + 0.616e3 / 0.81e2 * t149 * t722 * t179 + 0.16e2 / 0.2187e4 * t1324 * t1330 * t1333 * t1581 - 0.16e2 / 0.2187e4 * t594 * t1330 * t602 * t1587 - 0.22e2 / 0.9e1 * t149 * t256 * t376 + t312 * t716 * t775 - 0.2e1 / 0.9e1 * t308 * t125 * t770 + t149 * t39 * t321 * t1598 / 0.4e1 - t308 * t263 * t323 + 0.44e2 / 0.9e1 * t149 * t256 * t323 + 0.8e1 / 0.3e1 * t149 * t108 * t770 + t149 * t39 * t1613 * t1614;
  t1625 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t107 * t95 - 0.5e1 / 0.9e1 * t6 * t566 * t183 + t6 * t247 * t380 / 0.2e1 - t6 * t101 * t786 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1350 + t1394 + t1568 + t1618));
  tv4rho40 = 0.2e1 * rho[0] * t1625 + 0.8e1 * t791;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1638 = t151 * t479;
  t1639 = t583 * t1638;
  t1646 = t598 * t602;
  t1656 = t270 * t296;
  t1661 = t300 * t302;
  t1662 = params->c * t117;
  t1666 = t589 * t1638;
  t1678 = t595 / t18 / t1326;
  t1698 = -0.2e1 / 0.27e2 * t582 * t1639 - t810 * t1297 / 0.36e2 + t807 * t1300 / 0.36e2 - 0.89e2 / 0.972e3 * t594 * t1646 * t271 * t20 * t202 + t810 * t1310 / 0.18e2 - t807 * t1313 / 0.18e2 - 0.17e2 / 0.36e2 * t1656 * t152 * t117 * t178 + 0.17e2 / 0.36e2 * t1661 * t1662 * t584 + 0.2e1 / 0.27e2 * t588 * t1666 + 0.38e2 / 0.81e2 * t1306 * t814 - 0.38e2 / 0.81e2 * t1303 * t817 - 0.154e3 / 0.81e2 * t203 * t722 * t204 + 0.2e1 / 0.729e3 * t1324 * t1678 * t1335 + 0.1025e4 / 0.486e3 * t300 * t577 * t836 - 0.253e3 / 0.162e3 * t116 * t741 * t394 - 0.1025e4 / 0.486e3 * t270 * t577 * t832 - 0.253e3 / 0.162e3 * t413 * t1387 * t415 - t203 * t693 / 0.24e2 + t203 * t757 / 0.3e1;
  t1703 = t583 * t453;
  t1706 = t589 * t453;
  t1761 = -0.2e1 / 0.3e1 * t203 * t782 - t203 * t771 / 0.4e1 + 0.4e1 / 0.27e2 * t582 * t1703 - 0.4e1 / 0.27e2 * t588 * t1706 - 0.11e2 / 0.9e1 * t203 * t760 + 0.253e3 / 0.162e3 * t408 * t728 * t409 - 0.2e1 / 0.3e1 * t149 * t856 * t869 - 0.4e1 / 0.3e1 * t149 * t856 * t874 - 0.3e1 / 0.4e1 * t149 * t451 * t767 * t479 * t322 + t312 * t716 * params->c * t453 / 0.2e1 + t312 * t860 * t852 / 0.6e1 + t149 * t451 * t873 * t375 / 0.4e1 - t308 * t263 * t50 * t453 / 0.2e1 - t308 * t865 * t852 / 0.6e1 + t149 * t451 * t452 * t691 / 0.12e2 - t312 * t860 * t869 / 0.18e2 + t308 * t865 * t869 / 0.18e2 + t149 * t451 * t320 * t923 * t178 / 0.4e1 + t308 * t865 * t874 / 0.9e1;
  t1790 = t234 * t703;
  t1794 = t47 * t1365 * t233;
  t1819 = t53 * t219 * t608;
  t1849 = -0.1e2 * t221 * t624 * t1413 + 0.15e2 / 0.2e1 * t221 * t624 * t1421 - 0.63e2 / 0.2e1 * t1819 * t1436 + 0.37e2 / 0.12e2 * t221 * t652 + 0.567e3 / 0.32e2 * t1819 * t1445 - 0.4e1 / 0.27e2 * t221 * t624 * t1448 + 0.19e2 / 0.6e1 * t221 * t624 * t1452 - 0.52e2 / 0.27e2 * t221 * t646 - 0.37e2 / 0.18e2 * t221 * t649 - 0.25e2 / 0.27e2 * t221 * t626 + 0.25e2 / 0.4e1 * t221 * t632 - 0.25e2 / 0.4e1 * t221 * t640 - 0.1575e4 / 0.128e3 * t1819 * t620 + 0.6237e4 / 0.128e3 * t1819 * t1508 - 0.4e2 / 0.3e1 * t229 * t623 * t1511;
  t1885 = 0.111e3 / 0.16e2 * t229 * t684 + 0.675e3 / 0.16e2 * t1819 * t662 - 0.225e3 / 0.16e2 * t229 * t657 - 0.35e2 / 0.54e2 * t221 * t643 - 0.135e3 / 0.2e1 * t1819 * t1477 + 0.333e3 / 0.32e2 * t1819 * t367 + 0.405e3 / 0.16e2 * t1819 * t1493 + 0.135e3 / 0.8e1 * t229 * t623 * t1497 - 0.675e3 / 0.32e2 * t1819 * t673 + 0.87e2 / 0.2e1 * t1819 * t1472 + 0.417e3 / 0.8e1 * t229 * t623 * t1515 - 0.13e2 / 0.3e1 * t229 * t676 - 0.37e2 / 0.2e1 * t229 * t679 - 0.325e3 / 0.12e2 * t229 * t688 + 0.675e3 / 0.16e2 * t229 * t666 - 0.225e3 / 0.4e1 * t229 * t623 * t1519;
  t1894 = t90 * t271 * t703;
  t1902 = -t312 * t860 * t874 / 0.9e1 + 0.22e2 / 0.9e1 * t149 * t256 * t50 * t453 + 0.2e1 * t149 * t856 * t852 + t436 * t1023 * t753 / 0.48e2 - t432 * t1027 * t753 / 0.48e2 - t955 * t1367 / 0.108e3 + t951 * t1372 / 0.108e3 + t149 * t451 * t1612 * t233 * t769 + 0.154e3 / 0.81e2 * t26 * t748 * t38 - 0.2e1 / 0.243e3 * t701 * t1790 + 0.2e1 / 0.243e3 * t708 * t1794 + t149 * t108 * t924 / 0.3e1 + 0.154e3 / 0.81e2 * t149 * t722 * t234 - 0.341e3 / 0.486e3 * t308 * t728 * t234 + 0.341e3 / 0.486e3 * t312 * t1387 * t447 - t312 * t716 * t928 / 0.4e1 - t149 * t39 * t152 * (t1849 + t1885) / 0.24e2 + 0.89e2 / 0.972e3 * t594 * t1646 * t50 * t1894 - 0.89e2 / 0.972e3 * t270 * t598 * t277 * params->c * t1894;
  t1906 = t314 * t923;
  t1923 = t407 * t262;
  t1924 = t141 * t1923;
  t1927 = t113 * t1923;
  t1940 = t1309 * sigma[0];
  t1957 = t51 * t767;
  t1966 = -0.11e2 / 0.9e1 * t149 * t256 * t480 + t312 * t313 * t1906 / 0.36e2 + t308 * t263 * t480 / 0.4e1 - t308 * t125 * t924 / 0.36e2 - t436 * t437 * t1564 / 0.288e3 - t432 * t713 / 0.12e2 + t436 * t697 / 0.12e2 - 0.65e2 / 0.108e3 * t1924 * t966 + 0.65e2 / 0.108e3 * t1927 * t962 + 0.2e1 / 0.729e3 * t594 * t1678 * t602 * t1587 + t432 * t198 * t692 / 0.288e3 + t1047 * t51 * t753 / 0.4e1 + t959 * t136 * t1940 / 0.6e1 - t965 * t143 * t1940 / 0.6e1 - 0.2e1 / 0.729e3 * t1324 * t1678 * t1333 * t1581 + t432 * t198 * t770 / 0.48e2 - t436 * t437 * t1570 / 0.48e2 - 0.3e1 / 0.4e1 * t35 * t1957 * t233 * t375 * t178 + 0.1025e4 / 0.486e3 * t270 * t733 * t117;
  t1973 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t566 * t238 + t6 * t247 * t484 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t101 * t979 - 0.3e1 / 0.8e1 * t6 * t19 * (t1698 + t1761 + t1902 + t1966));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1973 + 0.6e1 * t984;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t2029 = t408 * t947 / 0.144e3 - t203 * t925 / 0.12e2 + 0.2e1 / 0.27e2 * t413 * t316 - t413 * t944 / 0.144e3 + 0.4e1 / 0.9e1 * t203 * t941 + t432 * t1027 * t852 / 0.24e2 + 0.2e1 / 0.9e1 * t432 * t866 - t1062 * t1372 / 0.432e3 + t951 * t1790 / 0.162e3 - t955 * t1794 / 0.162e3 + t1066 * t1367 / 0.432e3;
  t2049 = t479 * t479;
  t2066 = t53 * t531 * t328;
  t2095 = -0.7e1 / 0.72e2 * t533 * t330 - 0.405e3 / 0.64e2 * t540 * t329 * t1497 + 0.891e3 / 0.256e3 * t2066 * t673 - 0.18711e5 / 0.1024e4 * t2066 * t1508 - 0.1215e4 / 0.128e3 * t2066 * t1493 + 0.297e3 / 0.128e3 * t540 * t902 + 0.405e3 / 0.16e2 * t2066 * t1477 + 0.675e3 / 0.32e2 * t540 * t329 * t1519 - 0.261e3 / 0.16e2 * t2066 * t1472 - 0.1251e4 / 0.64e2 * t540 * t329 * t1515 - 0.891e3 / 0.128e3 * t2066 * t662 - 0.891e3 / 0.128e3 * t540 * t912 - 0.11e2 / 0.32e2 * t540 * t337 + 0.3e1 / 0.8e1 * t540 * t347 - 0.27e2 / 0.128e3 * t2066 * t367;
  t2133 = -0.9e1 / 0.64e2 * t540 * t372 + 0.143e3 / 0.32e2 * t540 * t907 + 0.5e1 * t540 * t329 * t1511 + 0.33e2 / 0.32e2 * t533 * t881 - 0.45e2 / 0.16e2 * t533 * t333 * t1421 + 0.2079e4 / 0.1024e4 * t2066 * t620 - 0.1701e4 / 0.256e3 * t2066 * t1445 + 0.189e3 / 0.16e2 * t2066 * t1436 - 0.19e2 / 0.16e2 * t533 * t333 * t1452 + 0.15e2 / 0.4e1 * t533 * t333 * t1413 - 0.11e2 / 0.72e2 * t533 * t334 + t533 * t343 / 0.24e2 - t533 * t355 / 0.16e2 + 0.11e2 / 0.72e2 * t533 * t888 - 0.33e2 / 0.32e2 * t533 * t891 + t533 * t333 * t1448 / 0.18e2;
  t2139 = t314 * t1111;
  t2143 = 0.2e1 / 0.9e1 * t149 * t108 * t1112 - 0.11e2 / 0.27e2 * t149 * t256 * t555 + t308 * t263 * t555 / 0.12e2 - t312 * t716 * t1122 / 0.12e2 - t308 * t263 * t525 / 0.6e1 + t312 * t716 * t1129 / 0.6e1 + t149 * t39 * t321 * t2049 / 0.6e1 + 0.22e2 / 0.27e2 * t149 * t256 * t525 - t308 * t125 * t1112 / 0.54e2 - t149 * t39 * t152 * (t2095 + t2133) / 0.24e2 + t312 * t313 * t2139 / 0.54e2;
  t2150 = t271 / t18 / t272 / t260;
  t2166 = t117 * t822;
  t2183 = -t436 * t437 * t1906 / 0.144e3 - t594 * t2150 * t602 * t1587 / 0.972e3 + t432 * t198 * t924 / 0.144e3 - t432 * t938 / 0.9e1 + t436 * t929 / 0.9e1 + t1324 * t2150 * t1333 * t1581 / 0.972e3 - 0.25e2 / 0.864e3 * t594 * t2166 * t602 * t704 + 0.25e2 / 0.864e3 * t270 * t2166 * t277 * t710 - 0.65e2 / 0.162e3 * t1924 * t1058 + 0.65e2 / 0.162e3 * t1927 * t1055 - 0.8e1 / 0.9e1 * t21 * t202 * t107 * t1048;
  t2256 = -0.2e1 / 0.9e1 * t436 * t861 - t436 * t1023 * t852 / 0.24e2 + t149 * t451 * t1612 * t524 * t322 - t312 * t860 * t1037 / 0.27e2 + t149 * t451 * t1036 * t375 / 0.12e2 + t308 * t865 * t1037 / 0.27e2 + t149 * t451 * t452 * t923 / 0.6e1 + 0.4e1 / 0.3e1 * t149 * t856 * t1032 + 0.2e1 / 0.27e2 * t308 * t865 * t1041 - 0.2e1 / 0.27e2 * t312 * t860 * t1041 - t149 * t451 * t1031 * t375 / 0.4e1;
  t2279 = t178 * sigma[0];
  t2283 = t270 * t422;
  t2296 = -t308 * t865 * t1032 / 0.9e1 + t312 * t860 * t1032 / 0.9e1 + t436 * t1023 * t869 / 0.72e2 + t436 * t1023 * t874 / 0.36e2 - t432 * t1027 * t874 / 0.36e2 - t432 * t1027 * t869 / 0.72e2 + t1008 * t1297 / 0.288e3 - 0.5e1 / 0.54e2 * t300 * t427 * t314 * t2279 + 0.5e1 / 0.54e2 * t2283 * t152 * t2279 + 0.25e2 / 0.864e3 * t594 * t822 * t602 * t117 * t20 * t202 - t1324 * t2150 * t1335 / 0.972e3;
  t2299 = t151 * t554;
  t2300 = t583 * t2299;
  t2303 = t589 * t2299;
  t2306 = t320 * t524;
  t2307 = t583 * t2306;
  t2310 = t589 * t2306;
  t2330 = -t1005 * t1300 / 0.288e3 - 0.2e1 / 0.81e2 * t582 * t2300 + 0.2e1 / 0.81e2 * t588 * t2303 + 0.4e1 / 0.81e2 * t582 * t2307 - 0.4e1 / 0.81e2 * t588 * t2310 - t810 * t1666 / 0.27e2 + t807 * t1639 / 0.27e2 - 0.17e2 / 0.54e2 * t1656 * t152 * t233 * t117 + 0.17e2 / 0.54e2 * t1661 * t1662 * t813 - 0.167e3 / 0.324e3 * t270 * t296 * sigma[0] + 0.19e2 / 0.81e2 * t116 * t285 * t124;
  t2338 = my_piecewise3(t2, 0, t6 * t247 * t559 / 0.12e2 - t6 * t101 * t1152 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-t35 * t1957 * t233 * t479 * t178 + t149 * t451 * t320 * t1111 * t178 / 0.6e1 - t149 * t451 * t767 * t554 * t322 / 0.4e1 + t2330 + t2296 + t2256 + t2029 - 0.19e2 / 0.81e2 * t408 * t263 * t204 + 0.19e2 / 0.81e2 * t413 * t716 * t303 - t1047 * t51 * t852 / 0.2e1 + t1047 * t51 * t874 / 0.3e1 + t1047 * t51 * t869 / 0.6e1 - 0.4e1 / 0.9e1 * t149 * t856 * t1037 - 0.8e1 / 0.9e1 * t149 * t856 * t1041 + t2183 + t2143 + 0.167e3 / 0.324e3 * t830 * t1135 - 0.167e3 / 0.324e3 * t835 * t1139 + t413 * t969 / 0.72e2 - 0.22e2 / 0.27e2 * t203 * t878 - 0.2e1 / 0.27e2 * t408 * t309 - t1008 * t1310 / 0.144e3 + t1005 * t1313 / 0.144e3 + 0.2e1 / 0.27e2 * t810 * t1706 - 0.2e1 / 0.27e2 * t807 * t1703 - t408 * t972 / 0.72e2));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t2338 + 0.4e1 * t1157;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t2380 = t53 * t1177 * t154;
  t2410 = 0.3e1 / 0.4e1 * t1185 * t466 - t1179 * t156 / 0.16e2 + 0.3645e4 / 0.1024e4 * t2380 * t1493 + 0.81e2 / 0.128e3 * t1185 * t1108 + 0.1215e4 / 0.512e3 * t1185 * t155 * t1497 - 0.2025e4 / 0.256e3 * t1185 * t155 * t1519 + 0.243e3 / 0.256e3 * t2380 * t673 + 0.56133e5 / 0.8192e4 * t2380 * t1508 - 0.243e3 / 0.128e3 * t2380 * t662 - 0.243e3 / 0.128e3 * t1185 * t1092 - 0.1215e4 / 0.128e3 * t2380 * t1477 - 0.27e2 / 0.64e2 * t2380 * t367 - 0.9e1 / 0.32e2 * t1185 * t476 + 0.39e2 / 0.32e2 * t1185 * t1080 - 0.15e2 / 0.8e1 * t1185 * t155 * t1511;
  t2448 = 0.783e3 / 0.128e3 * t2380 * t1472 + 0.3753e4 / 0.512e3 * t1185 * t155 * t1515 - 0.3e1 / 0.32e2 * t1185 * t175 + 0.9e1 / 0.32e2 * t1179 * t1097 + 0.135e3 / 0.128e3 * t1179 * t159 * t1421 + 0.567e3 / 0.1024e4 * t2380 * t620 + 0.5103e4 / 0.2048e4 * t2380 * t1445 - 0.567e3 / 0.128e3 * t2380 * t1436 - t1179 * t159 * t1448 / 0.48e2 + 0.57e2 / 0.128e3 * t1179 * t159 * t1452 - 0.45e2 / 0.32e2 * t1179 * t159 * t1413 - t1179 * t164 / 0.24e2 + t1179 * t463 / 0.12e2 - t1179 * t469 / 0.8e1 + t1179 * t1077 / 0.24e2 - 0.9e1 / 0.32e2 * t1179 * t1083;
  t2454 = t2283 / 0.12e2 + 0.2e1 / 0.3e1 * t149 * t108 * t1161 + t1005 * t1703 / 0.48e2 + t203 * t1142 / 0.3e1 + t413 * t448 / 0.9e1 - t408 * t444 / 0.9e1 - 0.2e1 / 0.3e1 * t203 * t1145 - t413 * t1116 / 0.48e2 - t203 * t1113 / 0.8e1 - t1008 * t1706 / 0.48e2 + t408 * t1051 / 0.48e2 - t436 * t1130 / 0.6e1 + t149 * t108 * t1225 / 0.9e1 + t432 * t1126 / 0.6e1 + t436 * t1123 / 0.12e2 - t149 * t39 * t152 * (t2410 + t2448) / 0.24e2;
  t2457 = t314 * t1224;
  t2475 = t117 / t18 / t1316;
  t2487 = t407 * t197;
  t2496 = sigma[0] * t1000;
  t2515 = -t432 * t1119 / 0.12e2 + t312 * t313 * t2457 / 0.108e3 - t308 * t125 * t1225 / 0.108e3 + t432 * t198 * t1112 / 0.96e2 - t436 * t437 * t2139 / 0.96e2 + t1047 * t51 * t1041 / 0.2e1 - t1324 * t2475 * t1333 * t1581 / 0.2592e4 + t594 * t2475 * t602 * t1587 / 0.2592e4 - 0.3e1 / 0.4e1 * t1047 * t51 * t1032 + t141 * t2487 * t143 * t453 / 0.24e2 - t113 * t2487 * t136 * t453 / 0.24e2 + 0.7e1 / 0.864e3 * t594 * t2496 * t602 * t704 + t1047 * t51 * t1037 / 0.4e1 - 0.7e1 / 0.864e3 * t270 * t2496 * t277 * t710 - 0.3e1 / 0.4e1 * t35 * t1957 * t233 * t554 * t178 - t1248 * t585 / 0.96e2;
  t2569 = t1252 * t590 / 0.96e2 + t149 * t451 * t1612 * t1160 * t178 - 0.2e1 / 0.3e1 * t149 * t856 * t1165 + t149 * t451 * t873 * t554 / 0.4e1 - 0.3e1 / 0.4e1 * t149 * t451 * t1031 * t479 + t149 * t451 * t452 * t1111 / 0.4e1 + t436 * t1023 * t1041 / 0.24e2 - t436 * t1023 * t1032 / 0.16e2 + t308 * t865 * t1165 / 0.18e2 - t312 * t860 * t1165 / 0.18e2 + t432 * t1027 * t1032 / 0.16e2 - t432 * t1027 * t1041 / 0.24e2 + t149 * t451 * t320 * t1224 * t178 / 0.12e2 + t436 * t1023 * t1037 / 0.48e2 - t432 * t1027 * t1037 / 0.48e2 - t1243 * t1367 / 0.2304e4;
  t2583 = sigma[0] * t399;
  t2608 = t1569 * t1160;
  t2612 = t1239 * t1372 / 0.2304e4 - t1062 * t1790 / 0.288e3 + t1066 * t1794 / 0.288e3 - t1133 * t1249 / 0.12e2 + t1138 * t1253 / 0.12e2 - 0.7e1 / 0.864e3 * t594 * t2496 * t604 + 0.5e1 / 0.36e2 * t270 * t2583 * t814 - 0.5e1 / 0.36e2 * t300 * t2583 * t817 + t810 * t2310 / 0.18e2 - t807 * t2307 / 0.18e2 - t810 * t2303 / 0.36e2 + t807 * t2300 / 0.36e2 + t1324 * t2475 * t1335 / 0.2592e4 - t1005 * t1639 / 0.96e2 + t1008 * t1666 / 0.96e2 - t308 * t125 * t1161 / 0.18e2 + t312 * t313 * t2608 / 0.18e2;
  t2619 = my_piecewise3(t2, 0, -t6 * t101 * t1271 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t2454 + t2515 + t2569 + t2612));
  tv4rhosigma30 = 0.2e1 * rho[0] * t2619 + 0.2e1 * t1275;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t2664 = t270 * t1236 * t277 * t710 / 0.576e3 - t594 * t1236 * t602 * t704 / 0.576e3 + t408 * t1232 / 0.24e2 - t413 * t1229 / 0.24e2 - t203 * t1226 / 0.6e1 - t408 * t1172 / 0.12e2 + t413 * t1169 / 0.12e2 - t203 * t1162 + t594 * t1236 * t604 / 0.576e3 - 0.3e1 / 0.2e1 * t149 * t451 * t1031 * t554 + t149 * t451 * t452 * t1224 / 0.3e1 + t436 * t1023 * t1165 / 0.12e2 - t432 * t1027 * t1165 / 0.12e2 - t1243 * t1794 / 0.576e3 + t1239 * t1790 / 0.576e3 - t1248 * t814 / 0.24e2;
  t2669 = sigma[0] / t18 / t596;
  t2683 = t554 * t554;
  t2688 = t524 * t524;
  t2708 = t54 / t55 / t271;
  t2710 = t53 * t2708 * t60;
  t2718 = t53 * t2708 * t28;
  t2747 = -0.1701e4 / 0.2048e4 * t2710 * t620 - 0.15309e5 / 0.16384e5 * t2710 * t1445 + 0.1701e4 / 0.1024e4 * t2710 * t1436 - 0.27e2 / 0.64e2 * t2718 * t1210 + 0.135e3 / 0.256e3 * t2718 * t224 * t1413 + 0.7e1 / 0.64e2 * t2718 * t536 - 0.21e2 / 0.128e3 * t2718 * t544 - t2718 * t1190 / 0.16e2 + 0.27e2 / 0.64e2 * t2718 * t1196 + t2718 * t224 * t1448 / 0.128e3 - 0.171e3 / 0.1024e4 * t2718 * t224 * t1452 + t2718 * t225 / 0.16e2 - 0.405e3 / 0.1024e4 * t2718 * t224 * t1421 - 0.15e2 / 0.128e3 * t2718 * t86 - 0.10935e5 / 0.8192e4 * t2710 * t1493;
  t2749 = t53 * t2708 * t27;
  t2786 = -0.243e3 / 0.256e3 * t2749 * t1221 - 0.3645e4 / 0.4096e4 * t2749 * t62 * t1497 + 0.6075e4 / 0.2048e4 * t2749 * t62 * t1519 - 0.729e3 / 0.512e3 * t2710 * t673 - 0.168399e6 / 0.65536e5 * t2710 * t1508 - 0.11259e5 / 0.4096e4 * t2749 * t62 * t1515 + 0.729e3 / 0.256e3 * t2710 * t662 + 0.729e3 / 0.256e3 * t2749 * t1205 + 0.3645e4 / 0.1024e4 * t2710 * t1477 + 0.63e2 / 0.64e2 * t2749 * t541 - 0.567e3 / 0.1024e4 * t2710 * t367 - 0.189e3 / 0.512e3 * t2749 * t551 - 0.117e3 / 0.64e2 * t2749 * t1193 + 0.45e2 / 0.64e2 * t2749 * t62 * t1511 - 0.2349e4 / 0.1024e4 * t2710 * t1472 + 0.9e1 / 0.64e2 * t2749 * t230;
  t2798 = t1252 * t817 / 0.24e2 - t1324 * t2669 * t1335 / 0.6912e4 - t1008 * t2310 / 0.24e2 + t1005 * t2307 / 0.24e2 + t1008 * t2303 / 0.48e2 - t1005 * t2300 / 0.48e2 + t1047 * t51 * t1165 + t149 * t39 * t321 * t2683 / 0.4e1 + t149 * t39 * t1613 * t2688 + t1324 * t2669 * t1333 * t1581 / 0.6912e4 - t594 * t2669 * t602 * t1587 / 0.6912e4 + t432 * t198 * t1225 / 0.72e2 - t436 * t437 * t2457 / 0.72e2 - t149 * t39 * t152 * (t2747 + t2786) / 0.24e2 + t432 * t198 * t1161 / 0.12e2 - t436 * t437 * t2608 / 0.12e2;
  t2803 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (t2664 + t2798));
  tv4sigma40 = 0.2e1 * rho[0] * t2803;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t39, t41;
  double t42, t43, t45, t46, t50, t51, t52, t55;
  double t56, t57, t58, t59, t60, t62, t65, t66;
  double t67, t68, t69, t70, t72, t73, t76, t79;
  double t80, t81, t83, t84, t88, t89, t91, t94;
  double t95, t96, t97, t100, t104, t105, t106, t108;
  double t109, t110, t111, t113, t114, t115, t116, t117;
  double t119, t121, t122, t123, t125, t126, t130, t131;
  double t134, t135, t136, t138, t142, t143, t148, t149;
  double t150, t155, t156, t158, t161, t162, t163, t164;
  double t167, t171, tzk0;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = t33 * sigma[0];
  t42 = t41 * t39;
  t43 = t29 * t42;
  t45 = 0.1e1 + t43 / 0.24e2;
  t46 = 0.1e1 / t45;
  t50 = t29 * t41;
  t51 = t39 * t46;
  t52 = params->c * t28;
  t55 = 0.1e1 + t52 * t42 / 0.24e2;
  t56 = t28 * t28;
  t57 = params->c * t56;
  t58 = 0.1e1 / t31;
  t59 = sqrt(sigma[0]);
  t60 = t58 * t59;
  t62 = 0.1e1 / t36 / rho[0];
  t65 = 0.1e1 / M_PI;
  t66 = t2 * t2;
  t67 = t65 * t66;
  t68 = M_CBRT2;
  t69 = sqrt(0.12e2);
  t70 = t56 * t58;
  t72 = t70 * t59 * t62;
  t73 = sqrt(t72);
  t76 = sqrt(0.6e1);
  t79 = LambertW(t69 * t73 * t72 * t76 / 0.1728e4);
  t80 = POW_1_3(t79);
  t81 = t80 * t80;
  t83 = t68 * t68;
  t84 = t2 * t83;
  t88 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t80 * t79;
  t89 = POW_1_4(t88);
  t91 = t67 * t68 * t81 * t89;
  t94 = 0.1e1 + t57 * t60 * t62 * t91 / 0.8e1;
  t95 = 0.1e1 / t94;
  t96 = t55 * t95;
  t97 = t51 * t96;
  t100 = 0.1e1 - t34 * sigma[0] * t39 * t46 / 0.24e2 + t50 * t97 / 0.24e2;
  t104 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t100);
  t105 = rho[1] <= p->dens_threshold;
  t106 = -t16;
  t108 = my_piecewise5(t14, t11, t10, t15, t106 * t7);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = rho[1] * rho[1];
  t116 = POW_1_3(rho[1]);
  t117 = t116 * t116;
  t119 = 0.1e1 / t117 / t115;
  t121 = t33 * sigma[2];
  t122 = t121 * t119;
  t123 = t29 * t122;
  t125 = 0.1e1 + t123 / 0.24e2;
  t126 = 0.1e1 / t125;
  t130 = t29 * t121;
  t131 = t119 * t126;
  t134 = 0.1e1 + t52 * t122 / 0.24e2;
  t135 = sqrt(sigma[2]);
  t136 = t58 * t135;
  t138 = 0.1e1 / t116 / rho[1];
  t142 = t70 * t135 * t138;
  t143 = sqrt(t142);
  t148 = LambertW(t69 * t143 * t142 * t76 / 0.1728e4);
  t149 = POW_1_3(t148);
  t150 = t149 * t149;
  t155 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t149 * t148;
  t156 = POW_1_4(t155);
  t158 = t67 * t68 * t150 * t156;
  t161 = 0.1e1 + t57 * t136 * t138 * t158 / 0.8e1;
  t162 = 0.1e1 / t161;
  t163 = t134 * t162;
  t164 = t131 * t163;
  t167 = 0.1e1 - t34 * sigma[2] * t119 * t126 / 0.24e2 + t130 * t164 / 0.24e2;
  t171 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t167);
  tzk0 = t104 + t171;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t39, t41;
  double t42, t43, t45, t46, t50, t51, t52, t55;
  double t56, t57, t58, t59, t60, t62, t65, t66;
  double t67, t68, t69, t70, t72, t73, t76, t79;
  double t80, t81, t83, t84, t88, t89, t91, t94;
  double t95, t96, t97, t100, t104, t105, t106, t108;
  double t109, t110, t111, t113, t114, t115, t116, t117;
  double t119, t121, t122, t123, t125, t126, t130, t131;
  double t134, t135, t136, t138, t142, t143, t148, t149;
  double t150, t155, t156, t158, t161, t162, t163, t164;
  double t167, t171, tzk0;

  double t172, t173, t174, t176, t179, t180, t184, t185;
  double t186, t189, t190, t192, t197, t198, t200, t201;
  double t202, t203, t204, t206, t208, t209, t213, t214;
  double t217, t218, t219, t220, t223, t224, t225, t226;
  double t227, t230, t231, t232, t234, t236, t239, t240;
  double t241, t242, t244, t247, t248, t249, t250, t251;
  double t252, t253, t254, t255, t258, t259, t263, t268;
  double t269, t271, t274, t275, t279, t282, t284, tvrho0;
  double t288, t291, t292, t297, t299, t302, t303, t307;
  double t309, t314, t315, t316, t318, t320, t321, t325;
  double t326, t329, t330, t331, t332, t335, t336, t337;
  double t338, t341, t342, t343, t345, t347, t350, t351;
  double t352, t354, t357, t358, t359, t360, t361, t362;
  double t363, t364, t365, t368, t369, t373, t378, tvrho1;
  double t381, t385, t387, t394, t395, t396, t397, t400;
  double t401, t402, t406, t408, t413, t414, t415, t418;
  double t419, t423, t427, tvsigma0, tvsigma1, t428, t432, t434;
  double t441, t442, t443, t444, t447, t448, t449, t453;
  double t455, t460, t461, t462, t465, t466, t470, t474;
  double tvsigma2;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = t33 * sigma[0];
  t42 = t41 * t39;
  t43 = t29 * t42;
  t45 = 0.1e1 + t43 / 0.24e2;
  t46 = 0.1e1 / t45;
  t50 = t29 * t41;
  t51 = t39 * t46;
  t52 = params->c * t28;
  t55 = 0.1e1 + t52 * t42 / 0.24e2;
  t56 = t28 * t28;
  t57 = params->c * t56;
  t58 = 0.1e1 / t31;
  t59 = sqrt(sigma[0]);
  t60 = t58 * t59;
  t62 = 0.1e1 / t36 / rho[0];
  t65 = 0.1e1 / M_PI;
  t66 = t2 * t2;
  t67 = t65 * t66;
  t68 = M_CBRT2;
  t69 = sqrt(0.12e2);
  t70 = t56 * t58;
  t72 = t70 * t59 * t62;
  t73 = sqrt(t72);
  t76 = sqrt(0.6e1);
  t79 = LambertW(t69 * t73 * t72 * t76 / 0.1728e4);
  t80 = POW_1_3(t79);
  t81 = t80 * t80;
  t83 = t68 * t68;
  t84 = t2 * t83;
  t88 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t80 * t79;
  t89 = POW_1_4(t88);
  t91 = t67 * t68 * t81 * t89;
  t94 = 0.1e1 + t57 * t60 * t62 * t91 / 0.8e1;
  t95 = 0.1e1 / t94;
  t96 = t55 * t95;
  t97 = t51 * t96;
  t100 = 0.1e1 - t34 * sigma[0] * t39 * t46 / 0.24e2 + t50 * t97 / 0.24e2;
  t104 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t100);
  t105 = rho[1] <= p->dens_threshold;
  t106 = -t16;
  t108 = my_piecewise5(t14, t11, t10, t15, t106 * t7);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = rho[1] * rho[1];
  t116 = POW_1_3(rho[1]);
  t117 = t116 * t116;
  t119 = 0.1e1 / t117 / t115;
  t121 = t33 * sigma[2];
  t122 = t121 * t119;
  t123 = t29 * t122;
  t125 = 0.1e1 + t123 / 0.24e2;
  t126 = 0.1e1 / t125;
  t130 = t29 * t121;
  t131 = t119 * t126;
  t134 = 0.1e1 + t52 * t122 / 0.24e2;
  t135 = sqrt(sigma[2]);
  t136 = t58 * t135;
  t138 = 0.1e1 / t116 / rho[1];
  t142 = t70 * t135 * t138;
  t143 = sqrt(t142);
  t148 = LambertW(t69 * t143 * t142 * t76 / 0.1728e4);
  t149 = POW_1_3(t148);
  t150 = t149 * t149;
  t155 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t149 * t148;
  t156 = POW_1_4(t155);
  t158 = t67 * t68 * t150 * t156;
  t161 = 0.1e1 + t57 * t136 * t138 * t158 / 0.8e1;
  t162 = 0.1e1 / t161;
  t163 = t134 * t162;
  t164 = t131 * t163;
  t167 = 0.1e1 - t34 * sigma[2] * t119 * t126 / 0.24e2 + t130 * t164 / 0.24e2;
  t171 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t167);
  tzk0 = t104 + t171;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t172 = t6 * t6;
  t173 = 0.1e1 / t172;
  t174 = t16 * t173;
  t176 = my_piecewise5(t10, 0, t14, 0, t7 - t174);
  t179 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t176);
  t180 = t179 * t26;
  t184 = t26 * t26;
  t185 = 0.1e1 / t184;
  t186 = t25 * t185;
  t189 = t5 * t186 * t100 / 0.8e1;
  t190 = t35 * rho[0];
  t192 = 0.1e1 / t37 / t190;
  t197 = params->alpha * params->alpha;
  t198 = t197 * t56;
  t200 = 0.1e1 / t31 / t30;
  t201 = t198 * t200;
  t202 = sigma[0] * sigma[0];
  t203 = t35 * t35;
  t204 = t203 * t35;
  t206 = 0.1e1 / t36 / t204;
  t208 = t45 * t45;
  t209 = 0.1e1 / t208;
  t213 = t192 * t46;
  t214 = t213 * t96;
  t217 = t200 * t202;
  t218 = t198 * t217;
  t219 = t206 * t209;
  t220 = t219 * t96;
  t223 = params->alpha * t56;
  t224 = t223 * t217;
  t225 = t206 * t46;
  t226 = params->c * t95;
  t227 = t225 * t226;
  t230 = t94 * t94;
  t231 = 0.1e1 / t230;
  t232 = t55 * t231;
  t234 = 0.1e1 / t36 / t35;
  t236 = t57 * t60 * t234;
  t239 = t67 * t68;
  t240 = t81 * t89;
  t241 = 0.1e1 + t79;
  t242 = 0.1e1 / t241;
  t244 = t239 * t240 * t242;
  t247 = t57 * t60;
  t248 = t234 * t65;
  t249 = t79 * t79;
  t250 = t89 * t89;
  t251 = t250 * t89;
  t252 = 0.1e1 / t251;
  t253 = t249 * t252;
  t254 = t253 * t242;
  t255 = t248 * t254;
  t258 = -t236 * t91 / 0.6e1 - t236 * t244 / 0.6e1 - 0.3e1 / 0.8e1 * t247 * t255;
  t259 = t232 * t258;
  t263 = t34 * sigma[0] * t192 * t46 / 0.9e1 - t201 * t202 * t206 * t209 / 0.216e3 - t50 * t214 / 0.9e1 + t218 * t220 / 0.216e3 - t224 * t227 / 0.216e3 - t50 * t51 * t259 / 0.24e2;
  t268 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t100 - t189 - 0.3e1 / 0.8e1 * t5 * t27 * t263);
  t269 = t106 * t173;
  t271 = my_piecewise5(t14, 0, t10, 0, -t7 - t269);
  t274 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t271);
  t275 = t274 * t26;
  t279 = t113 * t185;
  t282 = t5 * t279 * t167 / 0.8e1;
  t284 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t167 - t282);
  tvrho0 = t104 + t171 + t6 * (t268 + t284);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t288 = my_piecewise5(t10, 0, t14, 0, -t7 - t174);
  t291 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t288);
  t292 = t291 * t26;
  t297 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t100 - t189);
  t299 = my_piecewise5(t14, 0, t10, 0, t7 - t269);
  t302 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t299);
  t303 = t302 * t26;
  t307 = t115 * rho[1];
  t309 = 0.1e1 / t117 / t307;
  t314 = sigma[2] * sigma[2];
  t315 = t115 * t115;
  t316 = t315 * t115;
  t318 = 0.1e1 / t116 / t316;
  t320 = t125 * t125;
  t321 = 0.1e1 / t320;
  t325 = t309 * t126;
  t326 = t325 * t163;
  t329 = t200 * t314;
  t330 = t198 * t329;
  t331 = t318 * t321;
  t332 = t331 * t163;
  t335 = t223 * t329;
  t336 = t318 * t126;
  t337 = params->c * t162;
  t338 = t336 * t337;
  t341 = t161 * t161;
  t342 = 0.1e1 / t341;
  t343 = t134 * t342;
  t345 = 0.1e1 / t116 / t115;
  t347 = t57 * t136 * t345;
  t350 = t150 * t156;
  t351 = 0.1e1 + t148;
  t352 = 0.1e1 / t351;
  t354 = t239 * t350 * t352;
  t357 = t57 * t136;
  t358 = t345 * t65;
  t359 = t148 * t148;
  t360 = t156 * t156;
  t361 = t360 * t156;
  t362 = 0.1e1 / t361;
  t363 = t359 * t362;
  t364 = t363 * t352;
  t365 = t358 * t364;
  t368 = -t347 * t158 / 0.6e1 - t347 * t354 / 0.6e1 - 0.3e1 / 0.8e1 * t357 * t365;
  t369 = t343 * t368;
  t373 = t34 * sigma[2] * t309 * t126 / 0.9e1 - t201 * t314 * t318 * t321 / 0.216e3 - t130 * t326 / 0.9e1 + t330 * t332 / 0.216e3 - t335 * t338 / 0.216e3 - t130 * t131 * t369 / 0.24e2;
  t378 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t167 - t282 - 0.3e1 / 0.8e1 * t5 * t114 * t373);
  tvrho1 = t104 + t171 + t6 * (t297 + t378);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t381 = t33 * t39;
  t385 = t203 * rho[0];
  t387 = 0.1e1 / t36 / t385;
  t394 = t200 * sigma[0];
  t395 = t198 * t394;
  t396 = t387 * t209;
  t397 = t396 * t96;
  t400 = t223 * t394;
  t401 = t387 * t46;
  t402 = t401 * t226;
  t406 = t58 / t59;
  t408 = t57 * t406 * t62;
  t413 = t57 * t406;
  t414 = t62 * t65;
  t415 = t414 * t254;
  t418 = t408 * t91 / 0.16e2 + t408 * t244 / 0.16e2 + 0.9e1 / 0.64e2 * t413 * t415;
  t419 = t232 * t418;
  t423 = -t29 * t381 * t46 / 0.24e2 + t201 * sigma[0] * t387 * t209 / 0.576e3 + t34 * t97 / 0.24e2 - t395 * t397 / 0.576e3 + t400 * t402 / 0.576e3 - t50 * t51 * t419 / 0.24e2;
  t427 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t423);
  tvsigma0 = t6 * t427;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t428 = t33 * t119;
  t432 = t315 * rho[1];
  t434 = 0.1e1 / t116 / t432;
  t441 = t200 * sigma[2];
  t442 = t198 * t441;
  t443 = t434 * t321;
  t444 = t443 * t163;
  t447 = t223 * t441;
  t448 = t434 * t126;
  t449 = t448 * t337;
  t453 = t58 / t135;
  t455 = t57 * t453 * t138;
  t460 = t57 * t453;
  t461 = t138 * t65;
  t462 = t461 * t364;
  t465 = t455 * t158 / 0.16e2 + t455 * t354 / 0.16e2 + 0.9e1 / 0.64e2 * t460 * t462;
  t466 = t343 * t465;
  t470 = -t29 * t428 * t126 / 0.24e2 + t201 * sigma[2] * t434 * t321 / 0.576e3 + t34 * t164 / 0.24e2 - t442 * t444 / 0.576e3 + t447 * t449 / 0.576e3 - t130 * t131 * t466 / 0.24e2;
  t474 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t470);
  tvsigma2 = t6 * t474;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t39, t41;
  double t42, t43, t45, t46, t50, t51, t52, t55;
  double t56, t57, t58, t59, t60, t62, t65, t66;
  double t67, t68, t69, t70, t72, t73, t76, t79;
  double t80, t81, t83, t84, t88, t89, t91, t94;
  double t95, t96, t97, t100, t104, t105, t106, t108;
  double t109, t110, t111, t113, t114, t115, t116, t117;
  double t119, t121, t122, t123, t125, t126, t130, t131;
  double t134, t135, t136, t138, t142, t143, t148, t149;
  double t150, t155, t156, t158, t161, t162, t163, t164;
  double t167, t171, tzk0;

  double t172, t173, t174, t176, t179, t180, t184, t185;
  double t186, t189, t190, t192, t197, t198, t200, t201;
  double t202, t203, t204, t206, t208, t209, t213, t214;
  double t217, t218, t219, t220, t223, t224, t225, t226;
  double t227, t230, t231, t232, t234, t236, t239, t240;
  double t241, t242, t244, t247, t248, t249, t250, t251;
  double t252, t253, t254, t255, t258, t259, t263, t268;
  double t269, t271, t274, t275, t279, t282, t284, tvrho0;
  double t288, t291, t292, t297, t299, t302, t303, t307;
  double t309, t314, t315, t316, t318, t320, t321, t325;
  double t326, t329, t330, t331, t332, t335, t336, t337;
  double t338, t341, t342, t343, t345, t347, t350, t351;
  double t352, t354, t357, t358, t359, t360, t361, t362;
  double t363, t364, t365, t368, t369, t373, t378, tvrho1;
  double t381, t385, t387, t394, t395, t396, t397, t400;
  double t401, t402, t406, t408, t413, t414, t415, t418;
  double t419, t423, t427, tvsigma0, tvsigma1, t428, t432, t434;
  double t441, t442, t443, t444, t447, t448, t449, t453;
  double t455, t460, t461, t462, t465, t466, t470, t474;
  double tvsigma2;

  double t477, t478, t479, t482, t483, t484, t487, t491;
  double t492, t496, t498, t504, t505, t508, t510, t513;
  double t518, t520, t526, t527, t528, t529, t530, t531;
  double t532, t533, t535, t539, t540, t543, t544, t547;
  double t548, t554, t555, t559, t560, t561, t568, t569;
  double t574, t575, t576, t577, t582, t584, t589, t590;
  double t593, t594, t596, t599, t600, t604, t605, t606;
  double t608, t611, t615, t616, t619, t622, t623, t624;
  double t627, t628, t632, t637, t638, t639, t640, t643;
  double t646, t650, t651, t655, t657, t659, t662, t664;
  double tv2rho20, t667, t671, t675, t676, t680, t682, t690;
  double t691, t695, t699, t700, t704, t706, t713, t716;
  double tv2rho21, t721, t726, t730, t731, t737, t738, t743;
  double t747, t748, t758, t763, t765, t770, t771, t772;
  double t773, t774, t776, t780, t781, t784, t785, t788;
  double t789, t795, t796, t800, t801, t808, t809, t814;
  double t815, t816, t817, t822, t824, t829, t830, t833;
  double t834, t836, t839, t840, t844, t845, t846, t848;
  double t851, t855, t856, t859, t862, t863, t864, t867;
  double t868, t872, t877, tv2rho22, t885, t886, t893, t894;
  double t895, t901, t902, t903, t904, t905, t908, t909;
  double t910, t913, t914, t915, t916, t920, t925, t941;
  double t945, t946, t947, t951, t960, t967, t970, t971;
  double t975, t980, tv2rhosigma0, tv2rhosigma1, t987, t989, tv2rhosigma2, t995;
  double tv2rhosigma3, tv2rhosigma4, t1000, t1007, t1008, t1009, t1015, t1016;
  double t1017, t1018, t1019, t1022, t1023, t1024, t1027, t1028;
  double t1029, t1030, t1034, t1055, t1059, t1060, t1061, t1065;
  double t1074, t1081, t1084, t1085, t1089, t1094, tv2rhosigma5, t1096;
  double t1100, t1101, t1107, t1110, t1111, t1115, t1130, t1131;
  double t1137, t1139, t1144, t1145, t1152, t1155, t1156, t1160;
  double t1164, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1165, t1169;
  double t1170, t1178, t1179, t1183, t1198, t1199, t1205, t1207;
  double t1212, t1213, t1220, t1223, t1224, t1228, t1232, tv2sigma25;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = t33 * sigma[0];
  t42 = t41 * t39;
  t43 = t29 * t42;
  t45 = 0.1e1 + t43 / 0.24e2;
  t46 = 0.1e1 / t45;
  t50 = t29 * t41;
  t51 = t39 * t46;
  t52 = params->c * t28;
  t55 = 0.1e1 + t52 * t42 / 0.24e2;
  t56 = t28 * t28;
  t57 = params->c * t56;
  t58 = 0.1e1 / t31;
  t59 = sqrt(sigma[0]);
  t60 = t58 * t59;
  t62 = 0.1e1 / t36 / rho[0];
  t65 = 0.1e1 / M_PI;
  t66 = t2 * t2;
  t67 = t65 * t66;
  t68 = M_CBRT2;
  t69 = sqrt(0.12e2);
  t70 = t56 * t58;
  t72 = t70 * t59 * t62;
  t73 = sqrt(t72);
  t76 = sqrt(0.6e1);
  t79 = LambertW(t69 * t73 * t72 * t76 / 0.1728e4);
  t80 = POW_1_3(t79);
  t81 = t80 * t80;
  t83 = t68 * t68;
  t84 = t2 * t83;
  t88 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t80 * t79;
  t89 = POW_1_4(t88);
  t91 = t67 * t68 * t81 * t89;
  t94 = 0.1e1 + t57 * t60 * t62 * t91 / 0.8e1;
  t95 = 0.1e1 / t94;
  t96 = t55 * t95;
  t97 = t51 * t96;
  t100 = 0.1e1 - t34 * sigma[0] * t39 * t46 / 0.24e2 + t50 * t97 / 0.24e2;
  t104 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t100);
  t105 = rho[1] <= p->dens_threshold;
  t106 = -t16;
  t108 = my_piecewise5(t14, t11, t10, t15, t106 * t7);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = rho[1] * rho[1];
  t116 = POW_1_3(rho[1]);
  t117 = t116 * t116;
  t119 = 0.1e1 / t117 / t115;
  t121 = t33 * sigma[2];
  t122 = t121 * t119;
  t123 = t29 * t122;
  t125 = 0.1e1 + t123 / 0.24e2;
  t126 = 0.1e1 / t125;
  t130 = t29 * t121;
  t131 = t119 * t126;
  t134 = 0.1e1 + t52 * t122 / 0.24e2;
  t135 = sqrt(sigma[2]);
  t136 = t58 * t135;
  t138 = 0.1e1 / t116 / rho[1];
  t142 = t70 * t135 * t138;
  t143 = sqrt(t142);
  t148 = LambertW(t69 * t143 * t142 * t76 / 0.1728e4);
  t149 = POW_1_3(t148);
  t150 = t149 * t149;
  t155 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t149 * t148;
  t156 = POW_1_4(t155);
  t158 = t67 * t68 * t150 * t156;
  t161 = 0.1e1 + t57 * t136 * t138 * t158 / 0.8e1;
  t162 = 0.1e1 / t161;
  t163 = t134 * t162;
  t164 = t131 * t163;
  t167 = 0.1e1 - t34 * sigma[2] * t119 * t126 / 0.24e2 + t130 * t164 / 0.24e2;
  t171 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t167);
  tzk0 = t104 + t171;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t172 = t6 * t6;
  t173 = 0.1e1 / t172;
  t174 = t16 * t173;
  t176 = my_piecewise5(t10, 0, t14, 0, t7 - t174);
  t179 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t176);
  t180 = t179 * t26;
  t184 = t26 * t26;
  t185 = 0.1e1 / t184;
  t186 = t25 * t185;
  t189 = t5 * t186 * t100 / 0.8e1;
  t190 = t35 * rho[0];
  t192 = 0.1e1 / t37 / t190;
  t197 = params->alpha * params->alpha;
  t198 = t197 * t56;
  t200 = 0.1e1 / t31 / t30;
  t201 = t198 * t200;
  t202 = sigma[0] * sigma[0];
  t203 = t35 * t35;
  t204 = t203 * t35;
  t206 = 0.1e1 / t36 / t204;
  t208 = t45 * t45;
  t209 = 0.1e1 / t208;
  t213 = t192 * t46;
  t214 = t213 * t96;
  t217 = t200 * t202;
  t218 = t198 * t217;
  t219 = t206 * t209;
  t220 = t219 * t96;
  t223 = params->alpha * t56;
  t224 = t223 * t217;
  t225 = t206 * t46;
  t226 = params->c * t95;
  t227 = t225 * t226;
  t230 = t94 * t94;
  t231 = 0.1e1 / t230;
  t232 = t55 * t231;
  t234 = 0.1e1 / t36 / t35;
  t236 = t57 * t60 * t234;
  t239 = t67 * t68;
  t240 = t81 * t89;
  t241 = 0.1e1 + t79;
  t242 = 0.1e1 / t241;
  t244 = t239 * t240 * t242;
  t247 = t57 * t60;
  t248 = t234 * t65;
  t249 = t79 * t79;
  t250 = t89 * t89;
  t251 = t250 * t89;
  t252 = 0.1e1 / t251;
  t253 = t249 * t252;
  t254 = t253 * t242;
  t255 = t248 * t254;
  t258 = -t236 * t91 / 0.6e1 - t236 * t244 / 0.6e1 - 0.3e1 / 0.8e1 * t247 * t255;
  t259 = t232 * t258;
  t263 = t34 * sigma[0] * t192 * t46 / 0.9e1 - t201 * t202 * t206 * t209 / 0.216e3 - t50 * t214 / 0.9e1 + t218 * t220 / 0.216e3 - t224 * t227 / 0.216e3 - t50 * t51 * t259 / 0.24e2;
  t268 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t100 - t189 - 0.3e1 / 0.8e1 * t5 * t27 * t263);
  t269 = t106 * t173;
  t271 = my_piecewise5(t14, 0, t10, 0, -t7 - t269);
  t274 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t271);
  t275 = t274 * t26;
  t279 = t113 * t185;
  t282 = t5 * t279 * t167 / 0.8e1;
  t284 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t167 - t282);
  tvrho0 = t104 + t171 + t6 * (t268 + t284);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t288 = my_piecewise5(t10, 0, t14, 0, -t7 - t174);
  t291 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t288);
  t292 = t291 * t26;
  t297 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t100 - t189);
  t299 = my_piecewise5(t14, 0, t10, 0, t7 - t269);
  t302 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t299);
  t303 = t302 * t26;
  t307 = t115 * rho[1];
  t309 = 0.1e1 / t117 / t307;
  t314 = sigma[2] * sigma[2];
  t315 = t115 * t115;
  t316 = t315 * t115;
  t318 = 0.1e1 / t116 / t316;
  t320 = t125 * t125;
  t321 = 0.1e1 / t320;
  t325 = t309 * t126;
  t326 = t325 * t163;
  t329 = t200 * t314;
  t330 = t198 * t329;
  t331 = t318 * t321;
  t332 = t331 * t163;
  t335 = t223 * t329;
  t336 = t318 * t126;
  t337 = params->c * t162;
  t338 = t336 * t337;
  t341 = t161 * t161;
  t342 = 0.1e1 / t341;
  t343 = t134 * t342;
  t345 = 0.1e1 / t116 / t115;
  t347 = t57 * t136 * t345;
  t350 = t150 * t156;
  t351 = 0.1e1 + t148;
  t352 = 0.1e1 / t351;
  t354 = t239 * t350 * t352;
  t357 = t57 * t136;
  t358 = t345 * t65;
  t359 = t148 * t148;
  t360 = t156 * t156;
  t361 = t360 * t156;
  t362 = 0.1e1 / t361;
  t363 = t359 * t362;
  t364 = t363 * t352;
  t365 = t358 * t364;
  t368 = -t347 * t158 / 0.6e1 - t347 * t354 / 0.6e1 - 0.3e1 / 0.8e1 * t357 * t365;
  t369 = t343 * t368;
  t373 = t34 * sigma[2] * t309 * t126 / 0.9e1 - t201 * t314 * t318 * t321 / 0.216e3 - t130 * t326 / 0.9e1 + t330 * t332 / 0.216e3 - t335 * t338 / 0.216e3 - t130 * t131 * t369 / 0.24e2;
  t378 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t167 - t282 - 0.3e1 / 0.8e1 * t5 * t114 * t373);
  tvrho1 = t104 + t171 + t6 * (t297 + t378);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t381 = t33 * t39;
  t385 = t203 * rho[0];
  t387 = 0.1e1 / t36 / t385;
  t394 = t200 * sigma[0];
  t395 = t198 * t394;
  t396 = t387 * t209;
  t397 = t396 * t96;
  t400 = t223 * t394;
  t401 = t387 * t46;
  t402 = t401 * t226;
  t406 = t58 / t59;
  t408 = t57 * t406 * t62;
  t413 = t57 * t406;
  t414 = t62 * t65;
  t415 = t414 * t254;
  t418 = t408 * t91 / 0.16e2 + t408 * t244 / 0.16e2 + 0.9e1 / 0.64e2 * t413 * t415;
  t419 = t232 * t418;
  t423 = -t29 * t381 * t46 / 0.24e2 + t201 * sigma[0] * t387 * t209 / 0.576e3 + t34 * t97 / 0.24e2 - t395 * t397 / 0.576e3 + t400 * t402 / 0.576e3 - t50 * t51 * t419 / 0.24e2;
  t427 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t423);
  tvsigma0 = t6 * t427;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t428 = t33 * t119;
  t432 = t315 * rho[1];
  t434 = 0.1e1 / t116 / t432;
  t441 = t200 * sigma[2];
  t442 = t198 * t441;
  t443 = t434 * t321;
  t444 = t443 * t163;
  t447 = t223 * t441;
  t448 = t434 * t126;
  t449 = t448 * t337;
  t453 = t58 / t135;
  t455 = t57 * t453 * t138;
  t460 = t57 * t453;
  t461 = t138 * t65;
  t462 = t461 * t364;
  t465 = t455 * t158 / 0.16e2 + t455 * t354 / 0.16e2 + 0.9e1 / 0.64e2 * t460 * t462;
  t466 = t343 * t465;
  t470 = -t29 * t428 * t126 / 0.24e2 + t201 * sigma[2] * t434 * t321 / 0.576e3 + t34 * t164 / 0.24e2 - t442 * t444 / 0.576e3 + t447 * t449 / 0.576e3 - t130 * t131 * t466 / 0.24e2;
  t474 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t470);
  tvsigma2 = t6 * t474;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t477 = t23 * t23;
  t478 = 0.1e1 / t477;
  t479 = t176 * t176;
  t482 = t172 * t6;
  t483 = 0.1e1 / t482;
  t484 = t16 * t483;
  t487 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t173 + 0.2e1 * t484);
  t491 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t478 * t479 + 0.4e1 / 0.3e1 * t23 * t487);
  t492 = t491 * t26;
  t496 = t179 * t185;
  t498 = t5 * t496 * t100;
  t504 = 0.1e1 / t184 / t6;
  t505 = t25 * t504;
  t508 = t5 * t505 * t100 / 0.12e2;
  t510 = t5 * t186 * t263;
  t513 = 0.1e1 / t37 / t203;
  t518 = t203 * t190;
  t520 = 0.1e1 / t36 / t518;
  t526 = t30 * t30;
  t527 = 0.1e1 / t526;
  t528 = t197 * params->alpha * t527;
  t529 = t202 * sigma[0];
  t530 = t203 * t203;
  t531 = t530 * t35;
  t532 = 0.1e1 / t531;
  t533 = t529 * t532;
  t535 = 0.1e1 / t208 / t45;
  t539 = t513 * t46;
  t540 = t539 * t96;
  t543 = t520 * t209;
  t544 = t543 * t96;
  t547 = t520 * t46;
  t548 = t547 * t226;
  t554 = t528 * t529;
  t555 = t532 * t535;
  t559 = t197 * t527;
  t560 = t559 * t529;
  t561 = t532 * t209;
  t568 = params->c * t231;
  t569 = t568 * t258;
  t574 = 0.1e1 / t230 / t94;
  t575 = t55 * t574;
  t576 = t258 * t258;
  t577 = t575 * t576;
  t582 = 0.1e1 / t36 / t190;
  t584 = t57 * t60 * t582;
  t589 = t582 * t65;
  t590 = t589 * t254;
  t593 = t241 * t241;
  t594 = 0.1e1 / t593;
  t596 = t239 * t240 * t594;
  t599 = t253 * t594;
  t600 = t589 * t599;
  t604 = t81 * t79 * t89;
  t605 = t593 * t241;
  t606 = 0.1e1 / t605;
  t608 = t239 * t604 * t606;
  t611 = t249 * t79;
  t615 = 0.1e1 / t251 / t88;
  t616 = t65 * t80 * t611 * t615;
  t619 = t616 * t594 * t2 * t83;
  t622 = t611 * t252;
  t623 = t622 * t606;
  t624 = t589 * t623;
  t627 = 0.7e1 / 0.18e2 * t584 * t91 + 0.11e2 / 0.18e2 * t584 * t244 + 0.11e2 / 0.8e1 * t247 * t590 + 0.2e1 / 0.9e1 * t584 * t596 + 0.2e1 * t247 * t600 - t584 * t608 / 0.3e1 - 0.9e1 / 0.16e2 * t584 * t619 - 0.3e1 / 0.4e1 * t247 * t624;
  t628 = t232 * t627;
  t632 = -0.11e2 / 0.27e2 * t34 * sigma[0] * t513 * t46 + t201 * t202 * t520 * t209 / 0.24e2 - t528 * t533 * t535 / 0.162e3 + 0.11e2 / 0.27e2 * t50 * t540 - t218 * t544 / 0.24e2 + t224 * t548 / 0.24e2 + 0.2e1 / 0.9e1 * t50 * t213 * t259 + t554 * t555 * t96 / 0.162e3 - t560 * t561 * t226 / 0.162e3 - t218 * t219 * t259 / 0.108e3 + t224 * t225 * t569 / 0.108e3 + t50 * t51 * t577 / 0.12e2 - t50 * t51 * t628 / 0.24e2;
  t637 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t492 * t100 - t498 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t180 * t263 + t508 - t510 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t632);
  t638 = t111 * t111;
  t639 = 0.1e1 / t638;
  t640 = t271 * t271;
  t643 = t106 * t483;
  t646 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t173 + 0.2e1 * t643);
  t650 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t639 * t640 + 0.4e1 / 0.3e1 * t111 * t646);
  t651 = t650 * t26;
  t655 = t274 * t185;
  t657 = t5 * t655 * t167;
  t659 = t113 * t504;
  t662 = t5 * t659 * t167 / 0.12e2;
  t664 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t651 * t167 - t657 / 0.4e1 + t662);
  tv2rho20 = 0.2e1 * t268 + 0.2e1 * t284 + t6 * (t637 + t664);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t667 = t478 * t288;
  t671 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t484);
  t675 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t667 * t176 + 0.4e1 / 0.3e1 * t23 * t671);
  t676 = t675 * t26;
  t680 = t291 * t185;
  t682 = t5 * t680 * t100;
  t690 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t676 * t100 - t682 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t292 * t263 - t498 / 0.8e1 + t508 - t510 / 0.8e1);
  t691 = t639 * t299;
  t695 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t643);
  t699 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t691 * t271 + 0.4e1 / 0.3e1 * t111 * t695);
  t700 = t699 * t26;
  t704 = t302 * t185;
  t706 = t5 * t704 * t167;
  t713 = t5 * t279 * t373;
  t716 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t700 * t167 - t706 / 0.8e1 - t657 / 0.8e1 + t662 - 0.3e1 / 0.8e1 * t5 * t275 * t373 - t713 / 0.8e1);
  tv2rho21 = t268 + t284 + t297 + t378 + t6 * (t690 + t716);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t721 = t288 * t288;
  t726 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t173 + 0.2e1 * t484);
  t730 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t478 * t721 + 0.4e1 / 0.3e1 * t23 * t726);
  t731 = t730 * t26;
  t737 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t731 * t100 - t682 / 0.4e1 + t508);
  t738 = t299 * t299;
  t743 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t173 + 0.2e1 * t643);
  t747 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t639 * t738 + 0.4e1 / 0.3e1 * t111 * t743);
  t748 = t747 * t26;
  t758 = 0.1e1 / t117 / t315;
  t763 = t315 * t307;
  t765 = 0.1e1 / t116 / t763;
  t770 = t314 * sigma[2];
  t771 = t315 * t315;
  t772 = t771 * t115;
  t773 = 0.1e1 / t772;
  t774 = t770 * t773;
  t776 = 0.1e1 / t320 / t125;
  t780 = t758 * t126;
  t781 = t780 * t163;
  t784 = t765 * t321;
  t785 = t784 * t163;
  t788 = t765 * t126;
  t789 = t788 * t337;
  t795 = t528 * t770;
  t796 = t773 * t776;
  t800 = t559 * t770;
  t801 = t773 * t321;
  t808 = params->c * t342;
  t809 = t808 * t368;
  t814 = 0.1e1 / t341 / t161;
  t815 = t134 * t814;
  t816 = t368 * t368;
  t817 = t815 * t816;
  t822 = 0.1e1 / t116 / t307;
  t824 = t57 * t136 * t822;
  t829 = t822 * t65;
  t830 = t829 * t364;
  t833 = t351 * t351;
  t834 = 0.1e1 / t833;
  t836 = t239 * t350 * t834;
  t839 = t363 * t834;
  t840 = t829 * t839;
  t844 = t150 * t148 * t156;
  t845 = t833 * t351;
  t846 = 0.1e1 / t845;
  t848 = t239 * t844 * t846;
  t851 = t359 * t148;
  t855 = 0.1e1 / t361 / t155;
  t856 = t65 * t149 * t851 * t855;
  t859 = t856 * t834 * t2 * t83;
  t862 = t851 * t362;
  t863 = t862 * t846;
  t864 = t829 * t863;
  t867 = 0.7e1 / 0.18e2 * t824 * t158 + 0.11e2 / 0.18e2 * t824 * t354 + 0.11e2 / 0.8e1 * t357 * t830 + 0.2e1 / 0.9e1 * t824 * t836 + 0.2e1 * t357 * t840 - t824 * t848 / 0.3e1 - 0.9e1 / 0.16e2 * t824 * t859 - 0.3e1 / 0.4e1 * t357 * t864;
  t868 = t343 * t867;
  t872 = -0.11e2 / 0.27e2 * t34 * sigma[2] * t758 * t126 + t201 * t314 * t765 * t321 / 0.24e2 - t528 * t774 * t776 / 0.162e3 + 0.11e2 / 0.27e2 * t130 * t781 - t330 * t785 / 0.24e2 + t335 * t789 / 0.24e2 + 0.2e1 / 0.9e1 * t130 * t325 * t369 + t795 * t796 * t163 / 0.162e3 - t800 * t801 * t337 / 0.162e3 - t330 * t331 * t369 / 0.108e3 + t335 * t336 * t809 / 0.108e3 + t130 * t131 * t817 / 0.12e2 - t130 * t131 * t868 / 0.24e2;
  t877 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t748 * t167 - t706 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t303 * t373 + t662 - t713 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t872);
  tv2rho22 = 0.2e1 * t297 + 0.2e1 * t378 + t6 * (t737 + t877);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t885 = t5 * t186 * t423 / 0.8e1;
  t886 = t33 * t192;
  t893 = t530 * rho[0];
  t894 = 0.1e1 / t893;
  t895 = t202 * t894;
  t901 = t200 * t206;
  t902 = t198 * t901;
  t903 = t209 * t55;
  t904 = t95 * sigma[0];
  t905 = t903 * t904;
  t908 = t223 * t901;
  t909 = t46 * params->c;
  t910 = t909 * t904;
  t913 = t29 * t381;
  t914 = t46 * t55;
  t915 = t231 * t258;
  t916 = t914 * t915;
  t920 = t894 * t535;
  t925 = t894 * t209;
  t941 = t568 * t418;
  t945 = t574 * t418;
  t946 = t945 * t258;
  t947 = t914 * t946;
  t951 = t57 * t406 * t234;
  t960 = t248 * t599;
  t967 = t248 * t623;
  t970 = -t951 * t91 / 0.12e2 - t951 * t244 / 0.6e1 - 0.3e1 / 0.8e1 * t413 * t255 - t951 * t596 / 0.12e2 - 0.3e1 / 0.4e1 * t413 * t960 + t951 * t608 / 0.8e1 + 0.27e2 / 0.128e3 * t951 * t619 + 0.9e1 / 0.32e2 * t413 * t967;
  t971 = t232 * t970;
  t975 = t29 * t886 * t46 / 0.9e1 - t201 * t219 * sigma[0] / 0.72e2 + t528 * t895 * t535 / 0.432e3 - t34 * t214 / 0.9e1 + t902 * t905 / 0.72e2 - t908 * t910 / 0.72e2 - t913 * t916 / 0.24e2 - t528 * t202 * t920 * t96 / 0.432e3 + t559 * t202 * t925 * t226 / 0.432e3 + t395 * t396 * t259 / 0.576e3 - t400 * t401 * t569 / 0.576e3 + t50 * t213 * t419 / 0.9e1 - t218 * t219 * t419 / 0.216e3 + t224 * t225 * t941 / 0.216e3 + t43 * t947 / 0.12e2 - t50 * t51 * t971 / 0.24e2;
  t980 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t423 - t885 - 0.3e1 / 0.8e1 * t5 * t27 * t975);
  tv2rhosigma0 = t6 * t980 + t427;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t987 = t5 * t279 * t470 / 0.8e1;
  t989 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t470 - t987);
  tv2rhosigma2 = t6 * t989 + t474;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t995 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t423 - t885);
  tv2rhosigma3 = t6 * t995 + t427;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1000 = t33 * t309;
  t1007 = t771 * rho[1];
  t1008 = 0.1e1 / t1007;
  t1009 = t314 * t1008;
  t1015 = t200 * t318;
  t1016 = t198 * t1015;
  t1017 = t321 * t134;
  t1018 = t162 * sigma[2];
  t1019 = t1017 * t1018;
  t1022 = t223 * t1015;
  t1023 = t126 * params->c;
  t1024 = t1023 * t1018;
  t1027 = t29 * t428;
  t1028 = t126 * t134;
  t1029 = t342 * t368;
  t1030 = t1028 * t1029;
  t1034 = t1008 * t776;
  t1055 = t808 * t465;
  t1059 = t814 * t465;
  t1060 = t1059 * t368;
  t1061 = t1028 * t1060;
  t1065 = t57 * t453 * t345;
  t1074 = t358 * t839;
  t1081 = t358 * t863;
  t1084 = -t1065 * t158 / 0.12e2 - t1065 * t354 / 0.6e1 - 0.3e1 / 0.8e1 * t460 * t365 - t1065 * t836 / 0.12e2 - 0.3e1 / 0.4e1 * t460 * t1074 + t1065 * t848 / 0.8e1 + 0.27e2 / 0.128e3 * t1065 * t859 + 0.9e1 / 0.32e2 * t460 * t1081;
  t1085 = t343 * t1084;
  t1089 = t29 * t1000 * t126 / 0.9e1 - t201 * t331 * sigma[2] / 0.72e2 + t528 * t1009 * t776 / 0.432e3 - t34 * t326 / 0.9e1 + t1016 * t1019 / 0.72e2 - t1022 * t1024 / 0.72e2 - t1027 * t1030 / 0.24e2 - t528 * t314 * t1034 * t163 / 0.432e3 + t559 * t314 * t1008 * t321 * t337 / 0.432e3 + t442 * t443 * t369 / 0.576e3 - t447 * t448 * t809 / 0.576e3 + t130 * t325 * t466 / 0.9e1 - t330 * t331 * t466 / 0.216e3 + t335 * t336 * t1055 / 0.216e3 + t123 * t1061 / 0.12e2 - t130 * t131 * t1085 / 0.24e2;
  t1094 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t470 - t987 - 0.3e1 / 0.8e1 * t5 * t114 * t1089);
  tv2rhosigma5 = t6 * t1094 + t474;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1096 = t200 * t387;
  t1100 = 0.1e1 / t530;
  t1101 = sigma[0] * t1100;
  t1107 = t223 * t200;
  t1110 = t231 * t418;
  t1111 = t914 * t1110;
  t1115 = t1100 * t535;
  t1130 = t418 * t418;
  t1131 = t575 * t1130;
  t1137 = t58 / t59 / sigma[0];
  t1139 = t57 * t1137 * t62;
  t1144 = t57 * t1137;
  t1145 = t414 * t599;
  t1152 = t414 * t623;
  t1155 = -t1139 * t91 / 0.32e2 + t1139 * t596 / 0.32e2 + 0.9e1 / 0.32e2 * t1144 * t1145 - 0.3e1 / 0.64e2 * t1139 * t608 - 0.81e2 / 0.1024e4 * t1139 * t619 - 0.27e2 / 0.256e3 * t1144 * t1152;
  t1156 = t232 * t1155;
  t1160 = t198 * t1096 * t209 / 0.288e3 - t528 * t1101 * t535 / 0.1152e4 - t201 * t397 / 0.288e3 + t1107 * t402 / 0.288e3 - t913 * t1111 / 0.12e2 + t528 * sigma[0] * t1115 * t96 / 0.1152e4 - t559 * sigma[0] * t1100 * t209 * t226 / 0.1152e4 + t395 * t396 * t419 / 0.288e3 - t400 * t401 * t941 / 0.288e3 + t50 * t51 * t1131 / 0.12e2 - t50 * t51 * t1156 / 0.24e2;
  t1164 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1160);
  tv2sigma20 = t6 * t1164;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1165 = t200 * t434;
  t1169 = 0.1e1 / t771;
  t1170 = sigma[2] * t1169;
  t1178 = t342 * t465;
  t1179 = t1028 * t1178;
  t1183 = t1169 * t776;
  t1198 = t465 * t465;
  t1199 = t815 * t1198;
  t1205 = t58 / t135 / sigma[2];
  t1207 = t57 * t1205 * t138;
  t1212 = t57 * t1205;
  t1213 = t461 * t839;
  t1220 = t461 * t863;
  t1223 = -t1207 * t158 / 0.32e2 + t1207 * t836 / 0.32e2 + 0.9e1 / 0.32e2 * t1212 * t1213 - 0.3e1 / 0.64e2 * t1207 * t848 - 0.81e2 / 0.1024e4 * t1207 * t859 - 0.27e2 / 0.256e3 * t1212 * t1220;
  t1224 = t343 * t1223;
  t1228 = t198 * t1165 * t321 / 0.288e3 - t528 * t1170 * t776 / 0.1152e4 - t201 * t444 / 0.288e3 + t1107 * t449 / 0.288e3 - t1027 * t1179 / 0.12e2 + t528 * sigma[2] * t1183 * t163 / 0.1152e4 - t559 * sigma[2] * t1169 * t321 * t337 / 0.1152e4 + t442 * t443 * t466 / 0.288e3 - t447 * t448 * t1055 / 0.288e3 + t130 * t131 * t1199 / 0.12e2 - t130 * t131 * t1224 / 0.24e2;
  t1232 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t1228);
  tv2sigma25 = t6 * t1232;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t39, t41;
  double t42, t43, t45, t46, t50, t51, t52, t55;
  double t56, t57, t58, t59, t60, t62, t65, t66;
  double t67, t68, t69, t70, t72, t73, t76, t79;
  double t80, t81, t83, t84, t88, t89, t91, t94;
  double t95, t96, t97, t100, t104, t105, t106, t108;
  double t109, t110, t111, t113, t114, t115, t116, t117;
  double t119, t121, t122, t123, t125, t126, t130, t131;
  double t134, t135, t136, t138, t142, t143, t148, t149;
  double t150, t155, t156, t158, t161, t162, t163, t164;
  double t167, t171, tzk0;

  double t172, t173, t174, t176, t179, t180, t184, t185;
  double t186, t189, t190, t192, t197, t198, t200, t201;
  double t202, t203, t204, t206, t208, t209, t213, t214;
  double t217, t218, t219, t220, t223, t224, t225, t226;
  double t227, t230, t231, t232, t234, t236, t239, t240;
  double t241, t242, t244, t247, t248, t249, t250, t251;
  double t252, t253, t254, t255, t258, t259, t263, t268;
  double t269, t271, t274, t275, t279, t282, t284, tvrho0;
  double t288, t291, t292, t297, t299, t302, t303, t307;
  double t309, t314, t315, t316, t318, t320, t321, t325;
  double t326, t329, t330, t331, t332, t335, t336, t337;
  double t338, t341, t342, t343, t345, t347, t350, t351;
  double t352, t354, t357, t358, t359, t360, t361, t362;
  double t363, t364, t365, t368, t369, t373, t378, tvrho1;
  double t381, t385, t387, t394, t395, t396, t397, t400;
  double t401, t402, t406, t408, t413, t414, t415, t418;
  double t419, t423, t427, tvsigma0, tvsigma1, t428, t432, t434;
  double t441, t442, t443, t444, t447, t448, t449, t453;
  double t455, t460, t461, t462, t465, t466, t470, t474;
  double tvsigma2;

  double t477, t478, t479, t482, t483, t484, t487, t491;
  double t492, t496, t498, t504, t505, t508, t510, t513;
  double t518, t520, t526, t527, t528, t529, t530, t531;
  double t532, t533, t535, t539, t540, t543, t544, t547;
  double t548, t554, t555, t559, t560, t561, t568, t569;
  double t574, t575, t576, t577, t582, t584, t589, t590;
  double t593, t594, t596, t599, t600, t604, t605, t606;
  double t608, t611, t615, t616, t619, t622, t623, t624;
  double t627, t628, t632, t637, t638, t639, t640, t643;
  double t646, t650, t651, t655, t657, t659, t662, t664;
  double tv2rho20, t667, t671, t675, t676, t680, t682, t690;
  double t691, t695, t699, t700, t704, t706, t713, t716;
  double tv2rho21, t721, t726, t730, t731, t737, t738, t743;
  double t747, t748, t758, t763, t765, t770, t771, t772;
  double t773, t774, t776, t780, t781, t784, t785, t788;
  double t789, t795, t796, t800, t801, t808, t809, t814;
  double t815, t816, t817, t822, t824, t829, t830, t833;
  double t834, t836, t839, t840, t844, t845, t846, t848;
  double t851, t855, t856, t859, t862, t863, t864, t867;
  double t868, t872, t877, tv2rho22, t885, t886, t893, t894;
  double t895, t901, t902, t903, t904, t905, t908, t909;
  double t910, t913, t914, t915, t916, t920, t925, t941;
  double t945, t946, t947, t951, t960, t967, t970, t971;
  double t975, t980, tv2rhosigma0, tv2rhosigma1, t987, t989, tv2rhosigma2, t995;
  double tv2rhosigma3, tv2rhosigma4, t1000, t1007, t1008, t1009, t1015, t1016;
  double t1017, t1018, t1019, t1022, t1023, t1024, t1027, t1028;
  double t1029, t1030, t1034, t1055, t1059, t1060, t1061, t1065;
  double t1074, t1081, t1084, t1085, t1089, t1094, tv2rhosigma5, t1096;
  double t1100, t1101, t1107, t1110, t1111, t1115, t1130, t1131;
  double t1137, t1139, t1144, t1145, t1152, t1155, t1156, t1160;
  double t1164, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1165, t1169;
  double t1170, t1178, t1179, t1183, t1198, t1199, t1205, t1207;
  double t1212, t1213, t1220, t1223, t1224, t1228, t1232, tv2sigma25;

  double t1236, t1237, t1240, t1243, t1244, t1245, t1248, t1252;
  double t1253, t1257, t1259, t1264, t1266, t1269, t1275, t1276;
  double t1279, t1281, t1284, t1287, t1288, t1289, t1292, t1293;
  double t1294, t1297, t1298, t1299, t1303, t1304, t1308, t1312;
  double t1313, t1317, t1318, t1319, t1320, t1321, t1331, t1332;
  double t1338, t1339, t1340, t1341, t1343, t1344, t1346, t1347;
  double t1350, t1351, t1354, t1357, t1372, t1374, t1378, t1379;
  double t1380, t1392, t1397, t1399, t1400, t1403, t1405, t1406;
  double t1409, t1414, t1415, t1416, t1418, t1419, t1423, t1427;
  double t1432, t1436, t1438, t1440, t1451, t1452, t1453, t1454;
  double t1457, t1460, t1463, t1464, t1467, t1468, t1471, t1476;
  double t1477, t1486, t1487, t1490, t1491, t1496, t1498, t1499;
  double t1502, t1505, t1508, t1512, t1513, t1517, t1519, t1521;
  double t1523, t1525, t1528, t1530, tv3rho30, t1533, t1534, t1535;
  double t1538, t1543, t1544, t1546, t1550, t1551, t1555, t1558;
  double t1562, t1564, t1568, t1577, t1578, t1579, t1582, t1587;
  double t1589, t1593, t1594, t1598, t1601, t1602, t1604, t1613;
  double t1615, t1618, tv3rho31, t1621, t1626, t1630, t1634, t1635;
  double t1639, t1641, t1650, t1651, t1656, t1660, t1664, t1665;
  double t1669, t1671, t1678, t1686, t1688, t1689, tv3rho32, t1694;
  double t1701, t1705, t1706, t1713, t1714, t1721, t1725, t1726;
  double t1741, t1742, t1743, t1745, t1746, t1747, t1752, t1753;
  double t1754, t1763, t1764, t1768, t1769, t1770, t1773, t1774;
  double t1775, t1778, t1779, t1780, t1784, t1785, t1789, t1793;
  double t1805, t1807, t1809, t1810, t1813, t1815, t1816, t1819;
  double t1824, t1825, t1826, t1828, t1829, t1833, t1837, t1842;
  double t1846, t1848, t1850, t1863, t1864, t1865, t1866, t1869;
  double t1872, t1873, t1876, t1877, t1880, t1883, t1886, t1887;
  double t1891, t1894, t1895, t1898, t1902, t1903, t1908, t1923;
  double t1924, t1928, t1929, t1930, t1931, t1932, t1942, t1943;
  double t1948, tv3rho33, t1956, t1963, t1965, t1970, t1972, t1974;
  double t1977, t1978, t1979, t1982, t1983, t1987, t1990, t1991;
  double t1994, t1995, t1996, t1999, t2000, t2003, t2004, t2005;
  double t2009, t2010, t2013, t2014, t2017, t2018, t2021, t2022;
  double t2025, t2028, t2031, t2034, t2037, t2040, t2041, t2053;
  double t2064, t2065, t2068, t2083, t2094, t2117, t2120, t2129;
  double t2132, t2133, t2137, t2138, t2141, t2144, t2145, t2150;
  double tv3rho2sigma0, tv3rho2sigma1, t2157, t2161, t2163, tv3rho2sigma2, t2169, t2177;
  double tv3rho2sigma3, tv3rho2sigma4, t2183, t2190, t2193, tv3rho2sigma5, t2201, tv3rho2sigma6;
  double tv3rho2sigma7, t2215, t2217, t2222, t2223, t2224, t2227, t2228;
  double t2249, t2260, t2261, t2264, t2267, t2268, t2271, t2274;
  double t2277, t2278, t2279, t2282, t2285, t2288, t2291, t2292;
  double t2295, t2299, t2322, t2329, t2332, t2337, t2338, t2345;
  double t2346, t2352, t2353, t2354, t2358, t2361, t2362, t2363;
  double t2366, t2367, t2370, t2371, t2375, t2376, t2382, t2389;
  double t2390, t2395, tv3rho2sigma8, t2402, t2403, t2405, t2410, t2411;
  double t2414, t2415, t2431, t2432, t2435, t2438, t2450, t2453;
  double t2454, t2457, t2460, t2461, t2462, t2466, t2477, t2486;
  double t2501, t2504, t2505, t2509, t2510, t2513, t2514, t2517;
  double t2518, t2519, t2522, t2525, t2526, t2527, t2531, t2538;
  double t2541, t2548, t2549, t2552, t2553, t2556, t2557, t2560;
  double t2561, t2566, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2573;
  double t2575, tv3rhosigma25, t2581, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t2594, t2595, t2598, t2602, t2603, t2613, t2616, t2617;
  double t2623, t2628, t2639, t2648, t2663, t2666, t2667, t2674;
  double t2675, t2678, t2681, t2682, t2683, t2686, t2687, t2688;
  double t2689, t2692, t2693, t2702, t2705, t2706, t2709, t2710;
  double t2714, t2723, t2726, t2729, t2730, t2733, t2734, t2737;
  double t2738, t2743, t2744, t2749, tv3rhosigma211, t2751, t2752, t2756;
  double t2757, t2768, t2770, t2775, t2782, t2791, t2806, t2809;
  double t2810, t2821, t2822, t2829, t2830, t2833, t2834, t2837;
  double t2838, t2845, t2848, t2851, t2852, t2858, t2862, t2866;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t2867, t2869, t2870, t2876, t2878, t2883, t2890;
  double t2899, t2914, t2917, t2918, t2925, t2935, t2936, t2939;
  double t2940, t2943, t2944, t2949, t2952, t2953, t2958, t2963;
  double t2964, t2970, t2971, t2978, t2982, tv3sigma39;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = t33 * sigma[0];
  t42 = t41 * t39;
  t43 = t29 * t42;
  t45 = 0.1e1 + t43 / 0.24e2;
  t46 = 0.1e1 / t45;
  t50 = t29 * t41;
  t51 = t39 * t46;
  t52 = params->c * t28;
  t55 = 0.1e1 + t52 * t42 / 0.24e2;
  t56 = t28 * t28;
  t57 = params->c * t56;
  t58 = 0.1e1 / t31;
  t59 = sqrt(sigma[0]);
  t60 = t58 * t59;
  t62 = 0.1e1 / t36 / rho[0];
  t65 = 0.1e1 / M_PI;
  t66 = t2 * t2;
  t67 = t65 * t66;
  t68 = M_CBRT2;
  t69 = sqrt(0.12e2);
  t70 = t56 * t58;
  t72 = t70 * t59 * t62;
  t73 = sqrt(t72);
  t76 = sqrt(0.6e1);
  t79 = LambertW(t69 * t73 * t72 * t76 / 0.1728e4);
  t80 = POW_1_3(t79);
  t81 = t80 * t80;
  t83 = t68 * t68;
  t84 = t2 * t83;
  t88 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t80 * t79;
  t89 = POW_1_4(t88);
  t91 = t67 * t68 * t81 * t89;
  t94 = 0.1e1 + t57 * t60 * t62 * t91 / 0.8e1;
  t95 = 0.1e1 / t94;
  t96 = t55 * t95;
  t97 = t51 * t96;
  t100 = 0.1e1 - t34 * sigma[0] * t39 * t46 / 0.24e2 + t50 * t97 / 0.24e2;
  t104 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t100);
  t105 = rho[1] <= p->dens_threshold;
  t106 = -t16;
  t108 = my_piecewise5(t14, t11, t10, t15, t106 * t7);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = rho[1] * rho[1];
  t116 = POW_1_3(rho[1]);
  t117 = t116 * t116;
  t119 = 0.1e1 / t117 / t115;
  t121 = t33 * sigma[2];
  t122 = t121 * t119;
  t123 = t29 * t122;
  t125 = 0.1e1 + t123 / 0.24e2;
  t126 = 0.1e1 / t125;
  t130 = t29 * t121;
  t131 = t119 * t126;
  t134 = 0.1e1 + t52 * t122 / 0.24e2;
  t135 = sqrt(sigma[2]);
  t136 = t58 * t135;
  t138 = 0.1e1 / t116 / rho[1];
  t142 = t70 * t135 * t138;
  t143 = sqrt(t142);
  t148 = LambertW(t69 * t143 * t142 * t76 / 0.1728e4);
  t149 = POW_1_3(t148);
  t150 = t149 * t149;
  t155 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t149 * t148;
  t156 = POW_1_4(t155);
  t158 = t67 * t68 * t150 * t156;
  t161 = 0.1e1 + t57 * t136 * t138 * t158 / 0.8e1;
  t162 = 0.1e1 / t161;
  t163 = t134 * t162;
  t164 = t131 * t163;
  t167 = 0.1e1 - t34 * sigma[2] * t119 * t126 / 0.24e2 + t130 * t164 / 0.24e2;
  t171 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t167);
  tzk0 = t104 + t171;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t172 = t6 * t6;
  t173 = 0.1e1 / t172;
  t174 = t16 * t173;
  t176 = my_piecewise5(t10, 0, t14, 0, t7 - t174);
  t179 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t176);
  t180 = t179 * t26;
  t184 = t26 * t26;
  t185 = 0.1e1 / t184;
  t186 = t25 * t185;
  t189 = t5 * t186 * t100 / 0.8e1;
  t190 = t35 * rho[0];
  t192 = 0.1e1 / t37 / t190;
  t197 = params->alpha * params->alpha;
  t198 = t197 * t56;
  t200 = 0.1e1 / t31 / t30;
  t201 = t198 * t200;
  t202 = sigma[0] * sigma[0];
  t203 = t35 * t35;
  t204 = t203 * t35;
  t206 = 0.1e1 / t36 / t204;
  t208 = t45 * t45;
  t209 = 0.1e1 / t208;
  t213 = t192 * t46;
  t214 = t213 * t96;
  t217 = t200 * t202;
  t218 = t198 * t217;
  t219 = t206 * t209;
  t220 = t219 * t96;
  t223 = params->alpha * t56;
  t224 = t223 * t217;
  t225 = t206 * t46;
  t226 = params->c * t95;
  t227 = t225 * t226;
  t230 = t94 * t94;
  t231 = 0.1e1 / t230;
  t232 = t55 * t231;
  t234 = 0.1e1 / t36 / t35;
  t236 = t57 * t60 * t234;
  t239 = t67 * t68;
  t240 = t81 * t89;
  t241 = 0.1e1 + t79;
  t242 = 0.1e1 / t241;
  t244 = t239 * t240 * t242;
  t247 = t57 * t60;
  t248 = t234 * t65;
  t249 = t79 * t79;
  t250 = t89 * t89;
  t251 = t250 * t89;
  t252 = 0.1e1 / t251;
  t253 = t249 * t252;
  t254 = t253 * t242;
  t255 = t248 * t254;
  t258 = -t236 * t91 / 0.6e1 - t236 * t244 / 0.6e1 - 0.3e1 / 0.8e1 * t247 * t255;
  t259 = t232 * t258;
  t263 = t34 * sigma[0] * t192 * t46 / 0.9e1 - t201 * t202 * t206 * t209 / 0.216e3 - t50 * t214 / 0.9e1 + t218 * t220 / 0.216e3 - t224 * t227 / 0.216e3 - t50 * t51 * t259 / 0.24e2;
  t268 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t100 - t189 - 0.3e1 / 0.8e1 * t5 * t27 * t263);
  t269 = t106 * t173;
  t271 = my_piecewise5(t14, 0, t10, 0, -t7 - t269);
  t274 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t271);
  t275 = t274 * t26;
  t279 = t113 * t185;
  t282 = t5 * t279 * t167 / 0.8e1;
  t284 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t167 - t282);
  tvrho0 = t104 + t171 + t6 * (t268 + t284);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t288 = my_piecewise5(t10, 0, t14, 0, -t7 - t174);
  t291 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t288);
  t292 = t291 * t26;
  t297 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t100 - t189);
  t299 = my_piecewise5(t14, 0, t10, 0, t7 - t269);
  t302 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t299);
  t303 = t302 * t26;
  t307 = t115 * rho[1];
  t309 = 0.1e1 / t117 / t307;
  t314 = sigma[2] * sigma[2];
  t315 = t115 * t115;
  t316 = t315 * t115;
  t318 = 0.1e1 / t116 / t316;
  t320 = t125 * t125;
  t321 = 0.1e1 / t320;
  t325 = t309 * t126;
  t326 = t325 * t163;
  t329 = t200 * t314;
  t330 = t198 * t329;
  t331 = t318 * t321;
  t332 = t331 * t163;
  t335 = t223 * t329;
  t336 = t318 * t126;
  t337 = params->c * t162;
  t338 = t336 * t337;
  t341 = t161 * t161;
  t342 = 0.1e1 / t341;
  t343 = t134 * t342;
  t345 = 0.1e1 / t116 / t115;
  t347 = t57 * t136 * t345;
  t350 = t150 * t156;
  t351 = 0.1e1 + t148;
  t352 = 0.1e1 / t351;
  t354 = t239 * t350 * t352;
  t357 = t57 * t136;
  t358 = t345 * t65;
  t359 = t148 * t148;
  t360 = t156 * t156;
  t361 = t360 * t156;
  t362 = 0.1e1 / t361;
  t363 = t359 * t362;
  t364 = t363 * t352;
  t365 = t358 * t364;
  t368 = -t347 * t158 / 0.6e1 - t347 * t354 / 0.6e1 - 0.3e1 / 0.8e1 * t357 * t365;
  t369 = t343 * t368;
  t373 = t34 * sigma[2] * t309 * t126 / 0.9e1 - t201 * t314 * t318 * t321 / 0.216e3 - t130 * t326 / 0.9e1 + t330 * t332 / 0.216e3 - t335 * t338 / 0.216e3 - t130 * t131 * t369 / 0.24e2;
  t378 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t167 - t282 - 0.3e1 / 0.8e1 * t5 * t114 * t373);
  tvrho1 = t104 + t171 + t6 * (t297 + t378);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t381 = t33 * t39;
  t385 = t203 * rho[0];
  t387 = 0.1e1 / t36 / t385;
  t394 = t200 * sigma[0];
  t395 = t198 * t394;
  t396 = t387 * t209;
  t397 = t396 * t96;
  t400 = t223 * t394;
  t401 = t387 * t46;
  t402 = t401 * t226;
  t406 = t58 / t59;
  t408 = t57 * t406 * t62;
  t413 = t57 * t406;
  t414 = t62 * t65;
  t415 = t414 * t254;
  t418 = t408 * t91 / 0.16e2 + t408 * t244 / 0.16e2 + 0.9e1 / 0.64e2 * t413 * t415;
  t419 = t232 * t418;
  t423 = -t29 * t381 * t46 / 0.24e2 + t201 * sigma[0] * t387 * t209 / 0.576e3 + t34 * t97 / 0.24e2 - t395 * t397 / 0.576e3 + t400 * t402 / 0.576e3 - t50 * t51 * t419 / 0.24e2;
  t427 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t423);
  tvsigma0 = t6 * t427;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t428 = t33 * t119;
  t432 = t315 * rho[1];
  t434 = 0.1e1 / t116 / t432;
  t441 = t200 * sigma[2];
  t442 = t198 * t441;
  t443 = t434 * t321;
  t444 = t443 * t163;
  t447 = t223 * t441;
  t448 = t434 * t126;
  t449 = t448 * t337;
  t453 = t58 / t135;
  t455 = t57 * t453 * t138;
  t460 = t57 * t453;
  t461 = t138 * t65;
  t462 = t461 * t364;
  t465 = t455 * t158 / 0.16e2 + t455 * t354 / 0.16e2 + 0.9e1 / 0.64e2 * t460 * t462;
  t466 = t343 * t465;
  t470 = -t29 * t428 * t126 / 0.24e2 + t201 * sigma[2] * t434 * t321 / 0.576e3 + t34 * t164 / 0.24e2 - t442 * t444 / 0.576e3 + t447 * t449 / 0.576e3 - t130 * t131 * t466 / 0.24e2;
  t474 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t470);
  tvsigma2 = t6 * t474;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t477 = t23 * t23;
  t478 = 0.1e1 / t477;
  t479 = t176 * t176;
  t482 = t172 * t6;
  t483 = 0.1e1 / t482;
  t484 = t16 * t483;
  t487 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t173 + 0.2e1 * t484);
  t491 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t478 * t479 + 0.4e1 / 0.3e1 * t23 * t487);
  t492 = t491 * t26;
  t496 = t179 * t185;
  t498 = t5 * t496 * t100;
  t504 = 0.1e1 / t184 / t6;
  t505 = t25 * t504;
  t508 = t5 * t505 * t100 / 0.12e2;
  t510 = t5 * t186 * t263;
  t513 = 0.1e1 / t37 / t203;
  t518 = t203 * t190;
  t520 = 0.1e1 / t36 / t518;
  t526 = t30 * t30;
  t527 = 0.1e1 / t526;
  t528 = t197 * params->alpha * t527;
  t529 = t202 * sigma[0];
  t530 = t203 * t203;
  t531 = t530 * t35;
  t532 = 0.1e1 / t531;
  t533 = t529 * t532;
  t535 = 0.1e1 / t208 / t45;
  t539 = t513 * t46;
  t540 = t539 * t96;
  t543 = t520 * t209;
  t544 = t543 * t96;
  t547 = t520 * t46;
  t548 = t547 * t226;
  t554 = t528 * t529;
  t555 = t532 * t535;
  t559 = t197 * t527;
  t560 = t559 * t529;
  t561 = t532 * t209;
  t568 = params->c * t231;
  t569 = t568 * t258;
  t574 = 0.1e1 / t230 / t94;
  t575 = t55 * t574;
  t576 = t258 * t258;
  t577 = t575 * t576;
  t582 = 0.1e1 / t36 / t190;
  t584 = t57 * t60 * t582;
  t589 = t582 * t65;
  t590 = t589 * t254;
  t593 = t241 * t241;
  t594 = 0.1e1 / t593;
  t596 = t239 * t240 * t594;
  t599 = t253 * t594;
  t600 = t589 * t599;
  t604 = t81 * t79 * t89;
  t605 = t593 * t241;
  t606 = 0.1e1 / t605;
  t608 = t239 * t604 * t606;
  t611 = t249 * t79;
  t615 = 0.1e1 / t251 / t88;
  t616 = t65 * t80 * t611 * t615;
  t619 = t616 * t594 * t2 * t83;
  t622 = t611 * t252;
  t623 = t622 * t606;
  t624 = t589 * t623;
  t627 = 0.7e1 / 0.18e2 * t584 * t91 + 0.11e2 / 0.18e2 * t584 * t244 + 0.11e2 / 0.8e1 * t247 * t590 + 0.2e1 / 0.9e1 * t584 * t596 + 0.2e1 * t247 * t600 - t584 * t608 / 0.3e1 - 0.9e1 / 0.16e2 * t584 * t619 - 0.3e1 / 0.4e1 * t247 * t624;
  t628 = t232 * t627;
  t632 = -0.11e2 / 0.27e2 * t34 * sigma[0] * t513 * t46 + t201 * t202 * t520 * t209 / 0.24e2 - t528 * t533 * t535 / 0.162e3 + 0.11e2 / 0.27e2 * t50 * t540 - t218 * t544 / 0.24e2 + t224 * t548 / 0.24e2 + 0.2e1 / 0.9e1 * t50 * t213 * t259 + t554 * t555 * t96 / 0.162e3 - t560 * t561 * t226 / 0.162e3 - t218 * t219 * t259 / 0.108e3 + t224 * t225 * t569 / 0.108e3 + t50 * t51 * t577 / 0.12e2 - t50 * t51 * t628 / 0.24e2;
  t637 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t492 * t100 - t498 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t180 * t263 + t508 - t510 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t632);
  t638 = t111 * t111;
  t639 = 0.1e1 / t638;
  t640 = t271 * t271;
  t643 = t106 * t483;
  t646 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t173 + 0.2e1 * t643);
  t650 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t639 * t640 + 0.4e1 / 0.3e1 * t111 * t646);
  t651 = t650 * t26;
  t655 = t274 * t185;
  t657 = t5 * t655 * t167;
  t659 = t113 * t504;
  t662 = t5 * t659 * t167 / 0.12e2;
  t664 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t651 * t167 - t657 / 0.4e1 + t662);
  tv2rho20 = 0.2e1 * t268 + 0.2e1 * t284 + t6 * (t637 + t664);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t667 = t478 * t288;
  t671 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t484);
  t675 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t667 * t176 + 0.4e1 / 0.3e1 * t23 * t671);
  t676 = t675 * t26;
  t680 = t291 * t185;
  t682 = t5 * t680 * t100;
  t690 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t676 * t100 - t682 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t292 * t263 - t498 / 0.8e1 + t508 - t510 / 0.8e1);
  t691 = t639 * t299;
  t695 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t643);
  t699 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t691 * t271 + 0.4e1 / 0.3e1 * t111 * t695);
  t700 = t699 * t26;
  t704 = t302 * t185;
  t706 = t5 * t704 * t167;
  t713 = t5 * t279 * t373;
  t716 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t700 * t167 - t706 / 0.8e1 - t657 / 0.8e1 + t662 - 0.3e1 / 0.8e1 * t5 * t275 * t373 - t713 / 0.8e1);
  tv2rho21 = t268 + t284 + t297 + t378 + t6 * (t690 + t716);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t721 = t288 * t288;
  t726 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t173 + 0.2e1 * t484);
  t730 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t478 * t721 + 0.4e1 / 0.3e1 * t23 * t726);
  t731 = t730 * t26;
  t737 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t731 * t100 - t682 / 0.4e1 + t508);
  t738 = t299 * t299;
  t743 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t173 + 0.2e1 * t643);
  t747 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t639 * t738 + 0.4e1 / 0.3e1 * t111 * t743);
  t748 = t747 * t26;
  t758 = 0.1e1 / t117 / t315;
  t763 = t315 * t307;
  t765 = 0.1e1 / t116 / t763;
  t770 = t314 * sigma[2];
  t771 = t315 * t315;
  t772 = t771 * t115;
  t773 = 0.1e1 / t772;
  t774 = t770 * t773;
  t776 = 0.1e1 / t320 / t125;
  t780 = t758 * t126;
  t781 = t780 * t163;
  t784 = t765 * t321;
  t785 = t784 * t163;
  t788 = t765 * t126;
  t789 = t788 * t337;
  t795 = t528 * t770;
  t796 = t773 * t776;
  t800 = t559 * t770;
  t801 = t773 * t321;
  t808 = params->c * t342;
  t809 = t808 * t368;
  t814 = 0.1e1 / t341 / t161;
  t815 = t134 * t814;
  t816 = t368 * t368;
  t817 = t815 * t816;
  t822 = 0.1e1 / t116 / t307;
  t824 = t57 * t136 * t822;
  t829 = t822 * t65;
  t830 = t829 * t364;
  t833 = t351 * t351;
  t834 = 0.1e1 / t833;
  t836 = t239 * t350 * t834;
  t839 = t363 * t834;
  t840 = t829 * t839;
  t844 = t150 * t148 * t156;
  t845 = t833 * t351;
  t846 = 0.1e1 / t845;
  t848 = t239 * t844 * t846;
  t851 = t359 * t148;
  t855 = 0.1e1 / t361 / t155;
  t856 = t65 * t149 * t851 * t855;
  t859 = t856 * t834 * t2 * t83;
  t862 = t851 * t362;
  t863 = t862 * t846;
  t864 = t829 * t863;
  t867 = 0.7e1 / 0.18e2 * t824 * t158 + 0.11e2 / 0.18e2 * t824 * t354 + 0.11e2 / 0.8e1 * t357 * t830 + 0.2e1 / 0.9e1 * t824 * t836 + 0.2e1 * t357 * t840 - t824 * t848 / 0.3e1 - 0.9e1 / 0.16e2 * t824 * t859 - 0.3e1 / 0.4e1 * t357 * t864;
  t868 = t343 * t867;
  t872 = -0.11e2 / 0.27e2 * t34 * sigma[2] * t758 * t126 + t201 * t314 * t765 * t321 / 0.24e2 - t528 * t774 * t776 / 0.162e3 + 0.11e2 / 0.27e2 * t130 * t781 - t330 * t785 / 0.24e2 + t335 * t789 / 0.24e2 + 0.2e1 / 0.9e1 * t130 * t325 * t369 + t795 * t796 * t163 / 0.162e3 - t800 * t801 * t337 / 0.162e3 - t330 * t331 * t369 / 0.108e3 + t335 * t336 * t809 / 0.108e3 + t130 * t131 * t817 / 0.12e2 - t130 * t131 * t868 / 0.24e2;
  t877 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t748 * t167 - t706 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t303 * t373 + t662 - t713 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t872);
  tv2rho22 = 0.2e1 * t297 + 0.2e1 * t378 + t6 * (t737 + t877);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t885 = t5 * t186 * t423 / 0.8e1;
  t886 = t33 * t192;
  t893 = t530 * rho[0];
  t894 = 0.1e1 / t893;
  t895 = t202 * t894;
  t901 = t200 * t206;
  t902 = t198 * t901;
  t903 = t209 * t55;
  t904 = t95 * sigma[0];
  t905 = t903 * t904;
  t908 = t223 * t901;
  t909 = t46 * params->c;
  t910 = t909 * t904;
  t913 = t29 * t381;
  t914 = t46 * t55;
  t915 = t231 * t258;
  t916 = t914 * t915;
  t920 = t894 * t535;
  t925 = t894 * t209;
  t941 = t568 * t418;
  t945 = t574 * t418;
  t946 = t945 * t258;
  t947 = t914 * t946;
  t951 = t57 * t406 * t234;
  t960 = t248 * t599;
  t967 = t248 * t623;
  t970 = -t951 * t91 / 0.12e2 - t951 * t244 / 0.6e1 - 0.3e1 / 0.8e1 * t413 * t255 - t951 * t596 / 0.12e2 - 0.3e1 / 0.4e1 * t413 * t960 + t951 * t608 / 0.8e1 + 0.27e2 / 0.128e3 * t951 * t619 + 0.9e1 / 0.32e2 * t413 * t967;
  t971 = t232 * t970;
  t975 = t29 * t886 * t46 / 0.9e1 - t201 * t219 * sigma[0] / 0.72e2 + t528 * t895 * t535 / 0.432e3 - t34 * t214 / 0.9e1 + t902 * t905 / 0.72e2 - t908 * t910 / 0.72e2 - t913 * t916 / 0.24e2 - t528 * t202 * t920 * t96 / 0.432e3 + t559 * t202 * t925 * t226 / 0.432e3 + t395 * t396 * t259 / 0.576e3 - t400 * t401 * t569 / 0.576e3 + t50 * t213 * t419 / 0.9e1 - t218 * t219 * t419 / 0.216e3 + t224 * t225 * t941 / 0.216e3 + t43 * t947 / 0.12e2 - t50 * t51 * t971 / 0.24e2;
  t980 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t423 - t885 - 0.3e1 / 0.8e1 * t5 * t27 * t975);
  tv2rhosigma0 = t6 * t980 + t427;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t987 = t5 * t279 * t470 / 0.8e1;
  t989 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t470 - t987);
  tv2rhosigma2 = t6 * t989 + t474;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t995 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t423 - t885);
  tv2rhosigma3 = t6 * t995 + t427;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1000 = t33 * t309;
  t1007 = t771 * rho[1];
  t1008 = 0.1e1 / t1007;
  t1009 = t314 * t1008;
  t1015 = t200 * t318;
  t1016 = t198 * t1015;
  t1017 = t321 * t134;
  t1018 = t162 * sigma[2];
  t1019 = t1017 * t1018;
  t1022 = t223 * t1015;
  t1023 = t126 * params->c;
  t1024 = t1023 * t1018;
  t1027 = t29 * t428;
  t1028 = t126 * t134;
  t1029 = t342 * t368;
  t1030 = t1028 * t1029;
  t1034 = t1008 * t776;
  t1055 = t808 * t465;
  t1059 = t814 * t465;
  t1060 = t1059 * t368;
  t1061 = t1028 * t1060;
  t1065 = t57 * t453 * t345;
  t1074 = t358 * t839;
  t1081 = t358 * t863;
  t1084 = -t1065 * t158 / 0.12e2 - t1065 * t354 / 0.6e1 - 0.3e1 / 0.8e1 * t460 * t365 - t1065 * t836 / 0.12e2 - 0.3e1 / 0.4e1 * t460 * t1074 + t1065 * t848 / 0.8e1 + 0.27e2 / 0.128e3 * t1065 * t859 + 0.9e1 / 0.32e2 * t460 * t1081;
  t1085 = t343 * t1084;
  t1089 = t29 * t1000 * t126 / 0.9e1 - t201 * t331 * sigma[2] / 0.72e2 + t528 * t1009 * t776 / 0.432e3 - t34 * t326 / 0.9e1 + t1016 * t1019 / 0.72e2 - t1022 * t1024 / 0.72e2 - t1027 * t1030 / 0.24e2 - t528 * t314 * t1034 * t163 / 0.432e3 + t559 * t314 * t1008 * t321 * t337 / 0.432e3 + t442 * t443 * t369 / 0.576e3 - t447 * t448 * t809 / 0.576e3 + t130 * t325 * t466 / 0.9e1 - t330 * t331 * t466 / 0.216e3 + t335 * t336 * t1055 / 0.216e3 + t123 * t1061 / 0.12e2 - t130 * t131 * t1085 / 0.24e2;
  t1094 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t470 - t987 - 0.3e1 / 0.8e1 * t5 * t114 * t1089);
  tv2rhosigma5 = t6 * t1094 + t474;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1096 = t200 * t387;
  t1100 = 0.1e1 / t530;
  t1101 = sigma[0] * t1100;
  t1107 = t223 * t200;
  t1110 = t231 * t418;
  t1111 = t914 * t1110;
  t1115 = t1100 * t535;
  t1130 = t418 * t418;
  t1131 = t575 * t1130;
  t1137 = t58 / t59 / sigma[0];
  t1139 = t57 * t1137 * t62;
  t1144 = t57 * t1137;
  t1145 = t414 * t599;
  t1152 = t414 * t623;
  t1155 = -t1139 * t91 / 0.32e2 + t1139 * t596 / 0.32e2 + 0.9e1 / 0.32e2 * t1144 * t1145 - 0.3e1 / 0.64e2 * t1139 * t608 - 0.81e2 / 0.1024e4 * t1139 * t619 - 0.27e2 / 0.256e3 * t1144 * t1152;
  t1156 = t232 * t1155;
  t1160 = t198 * t1096 * t209 / 0.288e3 - t528 * t1101 * t535 / 0.1152e4 - t201 * t397 / 0.288e3 + t1107 * t402 / 0.288e3 - t913 * t1111 / 0.12e2 + t528 * sigma[0] * t1115 * t96 / 0.1152e4 - t559 * sigma[0] * t1100 * t209 * t226 / 0.1152e4 + t395 * t396 * t419 / 0.288e3 - t400 * t401 * t941 / 0.288e3 + t50 * t51 * t1131 / 0.12e2 - t50 * t51 * t1156 / 0.24e2;
  t1164 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1160);
  tv2sigma20 = t6 * t1164;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1165 = t200 * t434;
  t1169 = 0.1e1 / t771;
  t1170 = sigma[2] * t1169;
  t1178 = t342 * t465;
  t1179 = t1028 * t1178;
  t1183 = t1169 * t776;
  t1198 = t465 * t465;
  t1199 = t815 * t1198;
  t1205 = t58 / t135 / sigma[2];
  t1207 = t57 * t1205 * t138;
  t1212 = t57 * t1205;
  t1213 = t461 * t839;
  t1220 = t461 * t863;
  t1223 = -t1207 * t158 / 0.32e2 + t1207 * t836 / 0.32e2 + 0.9e1 / 0.32e2 * t1212 * t1213 - 0.3e1 / 0.64e2 * t1207 * t848 - 0.81e2 / 0.1024e4 * t1207 * t859 - 0.27e2 / 0.256e3 * t1212 * t1220;
  t1224 = t343 * t1223;
  t1228 = t198 * t1165 * t321 / 0.288e3 - t528 * t1170 * t776 / 0.1152e4 - t201 * t444 / 0.288e3 + t1107 * t449 / 0.288e3 - t1027 * t1179 / 0.12e2 + t528 * sigma[2] * t1183 * t163 / 0.1152e4 - t559 * sigma[2] * t1169 * t321 * t337 / 0.1152e4 + t442 * t443 * t466 / 0.288e3 - t447 * t448 * t1055 / 0.288e3 + t130 * t131 * t1199 / 0.12e2 - t130 * t131 * t1224 / 0.24e2;
  t1232 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t1228);
  tv2sigma25 = t6 * t1232;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1236 = 0.1e1 / t477 / t19;
  t1237 = t479 * t176;
  t1240 = t478 * t176;
  t1243 = t172 * t172;
  t1244 = 0.1e1 / t1243;
  t1245 = t16 * t1244;
  t1248 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t483 - 0.6e1 * t1245);
  t1252 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1236 * t1237 + 0.4e1 / 0.3e1 * t1240 * t487 + 0.4e1 / 0.3e1 * t23 * t1248);
  t1253 = t1252 * t26;
  t1257 = t491 * t185;
  t1259 = t5 * t1257 * t100;
  t1264 = t179 * t504;
  t1266 = t5 * t1264 * t100;
  t1269 = t5 * t496 * t263;
  t1275 = 0.1e1 / t184 / t172;
  t1276 = t25 * t1275;
  t1279 = 0.5e1 / 0.36e2 * t5 * t1276 * t100;
  t1281 = t5 * t505 * t263;
  t1284 = t5 * t186 * t632;
  t1287 = 0.1e1 / t37 / t385;
  t1288 = t1287 * t46;
  t1289 = t1288 * t96;
  t1292 = t528 * t533;
  t1293 = t535 * t55;
  t1294 = t1293 * t915;
  t1297 = t559 * t533;
  t1298 = t209 * params->c;
  t1299 = t1298 * t915;
  t1303 = 0.1e1 / t36 / t530;
  t1304 = t1303 * t209;
  t1308 = t1303 * t46;
  t1312 = params->c * t574;
  t1313 = t1312 * t576;
  t1317 = t230 * t230;
  t1318 = 0.1e1 / t1317;
  t1319 = t55 * t1318;
  t1320 = t576 * t258;
  t1321 = t1319 * t1320;
  t1331 = t568 * t627;
  t1332 = t225 * t1331;
  t1338 = t197 * t197;
  t1339 = t1338 * t527;
  t1340 = t202 * t202;
  t1341 = t530 * t385;
  t1343 = 0.1e1 / t37 / t1341;
  t1344 = t1340 * t1343;
  t1346 = t208 * t208;
  t1347 = 0.1e1 / t1346;
  t1350 = t95 * t28 * t33;
  t1351 = t1347 * t55 * t1350;
  t1354 = -0.154e3 / 0.81e2 * t50 * t1289 - t1292 * t1294 / 0.54e2 + t1297 * t1299 / 0.54e2 + 0.341e3 / 0.972e3 * t218 * t1304 * t96 - 0.341e3 / 0.972e3 * t224 * t1308 * t226 - t224 * t225 * t1313 / 0.36e2 - t50 * t51 * t1321 / 0.4e1 + t218 * t219 * t577 / 0.36e2 - 0.2e1 / 0.3e1 * t50 * t213 * t577 + t224 * t1332 / 0.72e2 - t218 * t219 * t628 / 0.72e2 + t1339 * t1344 * t1351 / 0.486e3;
  t1357 = t535 * params->c * t1350;
  t1372 = t1339 * t1340;
  t1374 = t28 * t33;
  t1378 = t530 * t190;
  t1379 = 0.1e1 / t1378;
  t1380 = t1379 * t535;
  t1392 = t529 * t1379;
  t1397 = 0.1e1 / t36 / t203;
  t1399 = t57 * t60 * t1397;
  t1400 = t249 * t249;
  t1403 = t88 * t88;
  t1405 = 0.1e1 / t251 / t1403;
  t1406 = t65 * t81 * t1400 * t1405;
  t1409 = t1406 * t606 * t66 * t68;
  t1414 = t65 * t80 * t1400 * t615;
  t1415 = t593 * t593;
  t1416 = 0.1e1 / t1415;
  t1418 = t1416 * t2 * t83;
  t1419 = t1414 * t1418;
  t1423 = t239 * t240 * t606;
  t1427 = t239 * t604 * t1416;
  t1432 = t616 * t606 * t2 * t83;
  t1436 = t81 * t249 * t89;
  t1438 = 0.1e1 / t1415 / t241;
  t1440 = t239 * t1436 * t1438;
  t1451 = t1397 * t65;
  t1452 = t1400 * t252;
  t1453 = t1452 * t1438;
  t1454 = t1451 * t1453;
  t1457 = t1451 * t599;
  t1460 = t1451 * t623;
  t1463 = t253 * t606;
  t1464 = t1451 * t1463;
  t1467 = t622 * t1416;
  t1468 = t1451 * t1467;
  t1471 = t1451 * t254;
  t1476 = -0.63e2 / 0.16e2 * t1399 * t1409 - 0.27e2 / 0.8e1 * t1399 * t1419 - 0.8e1 / 0.27e2 * t1399 * t1423 + 0.2e1 * t1399 * t1427 + 0.27e2 / 0.4e1 * t1399 * t1432 - 0.2e1 * t1399 * t1440 - 0.23e2 / 0.9e1 * t1399 * t244 - 0.14e2 / 0.9e1 * t1399 * t596 + 0.7e1 / 0.3e1 * t1399 * t608 + 0.63e2 / 0.16e2 * t1399 * t619 - 0.9e1 / 0.2e1 * t247 * t1454 - 0.14e2 * t247 * t1457 + 0.21e2 / 0.4e1 * t247 * t1460 - 0.26e2 / 0.3e1 * t247 * t1464 + 0.27e2 / 0.2e1 * t247 * t1468 - 0.23e2 / 0.4e1 * t247 * t1471 - 0.35e2 / 0.27e2 * t1399 * t91;
  t1477 = t232 * t1476;
  t1486 = t574 * t258 * t627;
  t1487 = t914 * t1486;
  t1490 = -t528 * t1344 * t1357 / 0.486e3 + t218 * t543 * t259 / 0.8e1 - t224 * t547 * t569 / 0.8e1 + t50 * t213 * t628 / 0.3e1 - 0.11e2 / 0.9e1 * t50 * t539 * t259 - t1372 * t1343 * t1347 * t1374 / 0.486e3 - 0.19e2 / 0.162e3 * t554 * t1380 * t96 + 0.19e2 / 0.162e3 * t560 * t1379 * t209 * t226 + 0.154e3 / 0.81e2 * t34 * sigma[0] * t1287 * t46 + 0.19e2 / 0.162e3 * t528 * t1392 * t535 - t50 * t51 * t1477 / 0.24e2 - 0.341e3 / 0.972e3 * t201 * t202 * t1303 * t209 + t43 * t1487 / 0.4e1;
  t1491 = t1354 + t1490;
  t1496 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1253 * t100 - 0.3e1 / 0.8e1 * t1259 - 0.9e1 / 0.8e1 * t5 * t492 * t263 + t1266 / 0.4e1 - 0.3e1 / 0.4e1 * t1269 - 0.9e1 / 0.8e1 * t5 * t180 * t632 - t1279 + t1281 / 0.4e1 - 0.3e1 / 0.8e1 * t1284 - 0.3e1 / 0.8e1 * t5 * t27 * t1491);
  t1498 = 0.1e1 / t638 / t109;
  t1499 = t640 * t271;
  t1502 = t639 * t271;
  t1505 = t106 * t1244;
  t1508 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t483 - 0.6e1 * t1505);
  t1512 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1498 * t1499 + 0.4e1 / 0.3e1 * t1502 * t646 + 0.4e1 / 0.3e1 * t111 * t1508);
  t1513 = t1512 * t26;
  t1517 = t650 * t185;
  t1519 = t5 * t1517 * t167;
  t1521 = t274 * t504;
  t1523 = t5 * t1521 * t167;
  t1525 = t113 * t1275;
  t1528 = 0.5e1 / 0.36e2 * t5 * t1525 * t167;
  t1530 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t1513 * t167 - 0.3e1 / 0.8e1 * t1519 + t1523 / 0.4e1 - t1528);
  tv3rho30 = 0.3e1 * t637 + 0.3e1 * t664 + t6 * (t1496 + t1530);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1533 = 0.2e1 * t690;
  t1534 = 0.2e1 * t716;
  t1535 = t1236 * t288;
  t1538 = t478 * t671;
  t1543 = 0.2e1 * t483;
  t1544 = 0.6e1 * t1245;
  t1546 = my_piecewise5(t10, 0, t14, 0, t1543 - t1544);
  t1550 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1535 * t479 + 0.8e1 / 0.9e1 * t1538 * t176 + 0.4e1 / 0.9e1 * t667 * t487 + 0.4e1 / 0.3e1 * t23 * t1546);
  t1551 = t1550 * t26;
  t1555 = t675 * t185;
  t1558 = t5 * t1555 * t100 / 0.4e1;
  t1562 = t291 * t504;
  t1564 = t5 * t1562 * t100;
  t1568 = t5 * t680 * t263 / 0.4e1;
  t1577 = -0.3e1 / 0.8e1 * t5 * t1551 * t100 - t1558 - 0.3e1 / 0.4e1 * t5 * t676 * t263 + t1564 / 0.12e2 - t1568 - 0.3e1 / 0.8e1 * t5 * t292 * t632 - t1259 / 0.8e1 + t1266 / 0.6e1 - t1269 / 0.4e1 - t1279 + t1281 / 0.6e1 - t1284 / 0.8e1;
  t1578 = my_piecewise3(t1, 0, t1577);
  t1579 = t1498 * t299;
  t1582 = t639 * t695;
  t1587 = 0.6e1 * t1505;
  t1589 = my_piecewise5(t14, 0, t10, 0, -t1543 - t1587);
  t1593 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1579 * t640 + 0.8e1 / 0.9e1 * t1582 * t271 + 0.4e1 / 0.9e1 * t691 * t646 + 0.4e1 / 0.3e1 * t111 * t1589);
  t1594 = t1593 * t26;
  t1598 = t699 * t185;
  t1601 = t5 * t1598 * t167 / 0.4e1;
  t1602 = t302 * t504;
  t1604 = t5 * t1602 * t167;
  t1613 = t5 * t655 * t373 / 0.4e1;
  t1615 = t5 * t659 * t373;
  t1618 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t1594 * t167 - t1601 + t1604 / 0.12e2 - t1519 / 0.8e1 + t1523 / 0.6e1 - t1528 - 0.3e1 / 0.8e1 * t5 * t651 * t373 - t1613 + t1615 / 0.12e2);
  tv3rho31 = t637 + t664 + t1533 + t1534 + t6 * (t1578 + t1618);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1621 = t1236 * t721;
  t1626 = t478 * t726;
  t1630 = my_piecewise5(t10, 0, t14, 0, -t1543 - t1544);
  t1634 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1621 * t176 + 0.8e1 / 0.9e1 * t667 * t671 + 0.4e1 / 0.9e1 * t1626 * t176 + 0.4e1 / 0.3e1 * t23 * t1630);
  t1635 = t1634 * t26;
  t1639 = t730 * t185;
  t1641 = t5 * t1639 * t100;
  t1650 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1635 * t100 - t1641 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t731 * t263 - t1558 + t1564 / 0.6e1 - t1568 + t1266 / 0.12e2 - t1279 + t1281 / 0.12e2);
  t1651 = t1498 * t738;
  t1656 = t639 * t743;
  t1660 = my_piecewise5(t14, 0, t10, 0, t1543 - t1587);
  t1664 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1651 * t271 + 0.8e1 / 0.9e1 * t691 * t695 + 0.4e1 / 0.9e1 * t1656 * t271 + 0.4e1 / 0.3e1 * t111 * t1660);
  t1665 = t1664 * t26;
  t1669 = t747 * t185;
  t1671 = t5 * t1669 * t167;
  t1678 = t5 * t704 * t373;
  t1686 = t5 * t279 * t872;
  t1688 = -0.3e1 / 0.8e1 * t5 * t1665 * t167 - t1671 / 0.8e1 - t1601 + t1604 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t700 * t373 - t1678 / 0.4e1 + t1523 / 0.12e2 - t1528 - t1613 + t1615 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t275 * t872 - t1686 / 0.8e1;
  t1689 = my_piecewise3(t105, 0, t1688);
  tv3rho32 = t1533 + t1534 + t737 + t877 + t6 * (t1650 + t1689);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1694 = t721 * t288;
  t1701 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t483 - 0.6e1 * t1245);
  t1705 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1236 * t1694 + 0.4e1 / 0.3e1 * t667 * t726 + 0.4e1 / 0.3e1 * t23 * t1701);
  t1706 = t1705 * t26;
  t1713 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1706 * t100 - 0.3e1 / 0.8e1 * t1641 + t1564 / 0.4e1 - t1279);
  t1714 = t738 * t299;
  t1721 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t483 - 0.6e1 * t1505);
  t1725 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1498 * t1714 + 0.4e1 / 0.3e1 * t691 * t743 + 0.4e1 / 0.3e1 * t111 * t1721);
  t1726 = t1725 * t26;
  t1741 = t314 * t314;
  t1742 = t1339 * t1741;
  t1743 = t771 * t432;
  t1745 = 0.1e1 / t117 / t1743;
  t1746 = t320 * t320;
  t1747 = 0.1e1 / t1746;
  t1752 = t771 * t307;
  t1753 = 0.1e1 / t1752;
  t1754 = t1753 * t776;
  t1763 = t814 * t368 * t867;
  t1764 = t1028 * t1763;
  t1768 = 0.1e1 / t117 / t432;
  t1769 = t1768 * t126;
  t1770 = t1769 * t163;
  t1773 = t528 * t774;
  t1774 = t776 * t134;
  t1775 = t1774 * t1029;
  t1778 = t559 * t774;
  t1779 = t321 * params->c;
  t1780 = t1779 * t1029;
  t1784 = 0.1e1 / t116 / t771;
  t1785 = t1784 * t321;
  t1789 = t1784 * t126;
  t1793 = t770 * t1753;
  t1805 = -t1742 * t1745 * t1747 * t1374 / 0.486e3 - 0.19e2 / 0.162e3 * t795 * t1754 * t163 + 0.19e2 / 0.162e3 * t800 * t1753 * t321 * t337 + t123 * t1764 / 0.4e1 - 0.154e3 / 0.81e2 * t130 * t1770 - t1773 * t1775 / 0.54e2 + t1778 * t1780 / 0.54e2 + 0.341e3 / 0.972e3 * t330 * t1785 * t163 - 0.341e3 / 0.972e3 * t335 * t1789 * t337 + 0.19e2 / 0.162e3 * t528 * t1793 * t776 + 0.154e3 / 0.81e2 * t34 * sigma[2] * t1768 * t126 - 0.341e3 / 0.972e3 * t201 * t314 * t1784 * t321;
  t1807 = 0.1e1 / t116 / t315;
  t1809 = t57 * t136 * t1807;
  t1810 = t359 * t359;
  t1813 = t155 * t155;
  t1815 = 0.1e1 / t361 / t1813;
  t1816 = t65 * t150 * t1810 * t1815;
  t1819 = t1816 * t846 * t66 * t68;
  t1824 = t65 * t149 * t1810 * t855;
  t1825 = t833 * t833;
  t1826 = 0.1e1 / t1825;
  t1828 = t1826 * t2 * t83;
  t1829 = t1824 * t1828;
  t1833 = t239 * t350 * t846;
  t1837 = t239 * t844 * t1826;
  t1842 = t856 * t846 * t2 * t83;
  t1846 = t150 * t359 * t156;
  t1848 = 0.1e1 / t1825 / t351;
  t1850 = t239 * t1846 * t1848;
  t1863 = t1807 * t65;
  t1864 = t1810 * t362;
  t1865 = t1864 * t1848;
  t1866 = t1863 * t1865;
  t1869 = t1863 * t863;
  t1872 = t363 * t846;
  t1873 = t1863 * t1872;
  t1876 = t862 * t1826;
  t1877 = t1863 * t1876;
  t1880 = t1863 * t364;
  t1883 = t1863 * t839;
  t1886 = -0.63e2 / 0.16e2 * t1809 * t1819 - 0.27e2 / 0.8e1 * t1809 * t1829 - 0.8e1 / 0.27e2 * t1809 * t1833 + 0.2e1 * t1809 * t1837 + 0.27e2 / 0.4e1 * t1809 * t1842 - 0.2e1 * t1809 * t1850 - 0.23e2 / 0.9e1 * t1809 * t354 - 0.14e2 / 0.9e1 * t1809 * t836 + 0.7e1 / 0.3e1 * t1809 * t848 + 0.63e2 / 0.16e2 * t1809 * t859 - 0.35e2 / 0.27e2 * t1809 * t158 - 0.9e1 / 0.2e1 * t357 * t1866 + 0.21e2 / 0.4e1 * t357 * t1869 - 0.26e2 / 0.3e1 * t357 * t1873 + 0.27e2 / 0.2e1 * t357 * t1877 - 0.23e2 / 0.4e1 * t357 * t1880 - 0.14e2 * t357 * t1883;
  t1887 = t343 * t1886;
  t1891 = t331 * t868;
  t1894 = t808 * t867;
  t1895 = t336 * t1894;
  t1898 = t1741 * t1745;
  t1902 = t162 * t28 * t33;
  t1903 = t1747 * t134 * t1902;
  t1908 = t776 * params->c * t1902;
  t1923 = params->c * t814;
  t1924 = t1923 * t816;
  t1928 = t341 * t341;
  t1929 = 0.1e1 / t1928;
  t1930 = t134 * t1929;
  t1931 = t816 * t368;
  t1932 = t1930 * t1931;
  t1942 = -t130 * t131 * t1887 / 0.24e2 - t330 * t1891 / 0.72e2 + t335 * t1895 / 0.72e2 + t1339 * t1898 * t1903 / 0.486e3 - t528 * t1898 * t1908 / 0.486e3 - t335 * t788 * t809 / 0.8e1 + t130 * t325 * t868 / 0.3e1 - 0.11e2 / 0.9e1 * t130 * t780 * t369 + t330 * t784 * t369 / 0.8e1 - t335 * t336 * t1924 / 0.36e2 - t130 * t131 * t1932 / 0.4e1 + t330 * t331 * t817 / 0.36e2 - 0.2e1 / 0.3e1 * t130 * t325 * t817;
  t1943 = t1805 + t1942;
  t1948 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t1726 * t167 - 0.3e1 / 0.8e1 * t1671 - 0.9e1 / 0.8e1 * t5 * t748 * t373 + t1604 / 0.4e1 - 0.3e1 / 0.4e1 * t1678 - 0.9e1 / 0.8e1 * t5 * t303 * t872 - t1528 + t1615 / 0.4e1 - 0.3e1 / 0.8e1 * t1686 - 0.3e1 / 0.8e1 * t5 * t114 * t1943);
  tv3rho33 = 0.3e1 * t737 + 0.3e1 * t877 + t6 * (t1713 + t1948);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1956 = t5 * t496 * t423;
  t1963 = t5 * t505 * t423 / 0.12e2;
  t1965 = t5 * t186 * t975;
  t1970 = t530 * t203;
  t1972 = 0.1e1 / t37 / t1970;
  t1974 = t1972 * t1347 * t1374;
  t1977 = t528 * t532;
  t1978 = t95 * t202;
  t1979 = t1293 * t1978;
  t1982 = t559 * t532;
  t1983 = t1298 * t1978;
  t1987 = t29 * t41 * t192;
  t1990 = t945 * t627;
  t1991 = t914 * t1990;
  t1994 = t217 * t206;
  t1995 = t223 * t1994;
  t1996 = t909 * t946;
  t1999 = t198 * t1994;
  t2000 = t903 * t946;
  t2003 = t574 * t970;
  t2004 = t2003 * t258;
  t2005 = t914 * t2004;
  t2009 = t1318 * t418 * t576;
  t2010 = t914 * t2009;
  t2013 = t200 * t520;
  t2014 = t223 * t2013;
  t2017 = t231 * t627;
  t2018 = t914 * t2017;
  t2021 = t574 * t576;
  t2022 = t914 * t2021;
  t2025 = t1293 * t1110;
  t2028 = t1298 * t1110;
  t2031 = t528 * t895;
  t2034 = t559 * t895;
  t2037 = t29 * t886;
  t2040 = 0.11e2 / 0.27e2 * t34 * t540 + t1339 * t529 * t1974 / 0.1296e4 + 0.17e2 / 0.432e3 * t1977 * t1979 - 0.17e2 / 0.432e3 * t1982 * t1983 - 0.4e1 / 0.9e1 * t1987 * t947 + t43 * t1991 / 0.12e2 - t1995 * t1996 / 0.54e2 + t1999 * t2000 / 0.54e2 + t43 * t2005 / 0.6e1 - t43 * t2010 / 0.4e1 + 0.65e2 / 0.648e3 * t2014 * t910 - t913 * t2018 / 0.24e2 + t913 * t2022 / 0.12e2 - t1292 * t2025 / 0.162e3 + t1297 * t2028 / 0.162e3 + t2031 * t1294 / 0.216e3 - t2034 * t1299 / 0.216e3 + 0.2e1 / 0.9e1 * t2037 * t916;
  t2041 = t198 * t2013;
  t2053 = t529 * t1972;
  t2064 = t231 * sigma[0] * t258;
  t2065 = t903 * t2064;
  t2068 = t909 * t2064;
  t2083 = t33 * t513;
  t2094 = t57 * t406 * t582;
  t2117 = t589 * t1467;
  t2120 = t589 * t1453;
  t2129 = t589 * t1463;
  t2132 = 0.3e1 / 0.4e1 * t2094 * t1440 + 0.189e3 / 0.128e3 * t2094 * t1409 + 0.81e2 / 0.64e2 * t2094 * t1419 - 0.135e3 / 0.128e3 * t2094 * t619 + t2094 * t1423 / 0.9e1 - 0.3e1 / 0.4e1 * t2094 * t1427 - 0.81e2 / 0.32e2 * t2094 * t1432 + 0.7e1 / 0.36e2 * t2094 * t91 + t2094 * t244 / 0.2e1 + 0.5e1 / 0.12e2 * t2094 * t596 - 0.5e1 / 0.8e1 * t2094 * t608 - 0.81e2 / 0.16e2 * t413 * t2117 + 0.27e2 / 0.16e2 * t413 * t2120 + 0.9e1 / 0.8e1 * t413 * t590 + 0.15e2 / 0.4e1 * t413 * t600 - 0.45e2 / 0.32e2 * t413 * t624 + 0.13e2 / 0.4e1 * t413 * t2129;
  t2133 = t232 * t2132;
  t2137 = t568 * t970;
  t2138 = t225 * t2137;
  t2141 = t219 * t971;
  t2144 = -0.65e2 / 0.648e3 * t2041 * t905 + t400 * t401 * t1313 / 0.288e3 - 0.11e2 / 0.27e2 * t50 * t539 * t419 - t395 * t396 * t577 / 0.288e3 - t1339 * t2053 * t1351 / 0.1296e4 + t528 * t2053 * t1357 / 0.1296e4 + t395 * t396 * t628 / 0.576e3 - t902 * t2065 / 0.36e2 + t908 * t2068 / 0.36e2 + 0.2e1 / 0.9e1 * t50 * t213 * t971 + t218 * t543 * t419 / 0.24e2 - t224 * t547 * t941 / 0.24e2 - t400 * t401 * t1331 / 0.576e3 - 0.11e2 / 0.27e2 * t29 * t2083 * t46 - 0.17e2 / 0.432e3 * t528 * t555 * t202 + 0.65e2 / 0.648e3 * t201 * t543 * sigma[0] - t50 * t51 * t2133 / 0.24e2 + t224 * t2138 / 0.108e3 - t218 * t2141 / 0.108e3;
  t2145 = t2040 + t2144;
  t2150 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t492 * t423 - t1956 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t180 * t975 + t1963 - t1965 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t2145);
  tv3rho2sigma0 = t6 * t2150 + 0.2e1 * t980;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2157 = t5 * t655 * t470;
  t2161 = t5 * t659 * t470 / 0.12e2;
  t2163 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t651 * t470 - t2157 / 0.4e1 + t2161);
  tv3rho2sigma2 = t6 * t2163 + 0.2e1 * t989;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2169 = t5 * t680 * t423;
  t2177 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t676 * t423 - t2169 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t292 * t975 - t1956 / 0.8e1 + t1963 - t1965 / 0.8e1);
  tv3rho2sigma3 = t6 * t2177 + t980 + t995;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2183 = t5 * t704 * t470;
  t2190 = t5 * t279 * t1089;
  t2193 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t700 * t470 - t2183 / 0.8e1 - t2157 / 0.8e1 + t2161 - 0.3e1 / 0.8e1 * t5 * t275 * t1089 - t2190 / 0.8e1);
  tv3rho2sigma5 = t6 * t2193 + t1094 + t989;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2201 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t731 * t423 - t2169 / 0.4e1 + t1963);
  tv3rho2sigma6 = t6 * t2201 + 0.2e1 * t995;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2215 = t771 * t315;
  t2217 = 0.1e1 / t117 / t2215;
  t2222 = t528 * t773;
  t2223 = t162 * t314;
  t2224 = t1774 * t2223;
  t2227 = t559 * t773;
  t2228 = t1779 * t2223;
  t2249 = t770 * t2217;
  t2260 = t342 * sigma[2] * t368;
  t2261 = t1017 * t2260;
  t2264 = t1023 * t2260;
  t2267 = t814 * t816;
  t2268 = t1028 * t2267;
  t2271 = t1774 * t1178;
  t2274 = t1779 * t1178;
  t2277 = 0.11e2 / 0.27e2 * t34 * t781 + t1339 * t770 * t2217 * t1747 * t1374 / 0.1296e4 + 0.17e2 / 0.432e3 * t2222 * t2224 - 0.17e2 / 0.432e3 * t2227 * t2228 - 0.11e2 / 0.27e2 * t130 * t780 * t466 - t442 * t443 * t817 / 0.288e3 + t447 * t448 * t1924 / 0.288e3 + t330 * t784 * t466 / 0.24e2 - t335 * t788 * t1055 / 0.24e2 - t447 * t448 * t1894 / 0.576e3 + t528 * t2249 * t1908 / 0.1296e4 + t442 * t443 * t868 / 0.576e3 - t1339 * t2249 * t1903 / 0.1296e4 - t1016 * t2261 / 0.36e2 + t1022 * t2264 / 0.36e2 + t1027 * t2268 / 0.12e2 - t1773 * t2271 / 0.162e3 + t1778 * t2274 / 0.162e3;
  t2278 = t342 * t867;
  t2279 = t1028 * t2278;
  t2282 = t528 * t1009;
  t2285 = t559 * t1009;
  t2288 = t29 * t1000;
  t2291 = t200 * t765;
  t2292 = t198 * t2291;
  t2295 = t223 * t2291;
  t2299 = t57 * t453 * t822;
  t2322 = t829 * t1865;
  t2329 = t829 * t1872;
  t2332 = t829 * t1876;
  t2337 = 0.189e3 / 0.128e3 * t2299 * t1819 + 0.81e2 / 0.64e2 * t2299 * t1829 - 0.3e1 / 0.4e1 * t2299 * t1837 - 0.81e2 / 0.32e2 * t2299 * t1842 + 0.3e1 / 0.4e1 * t2299 * t1850 + t2299 * t354 / 0.2e1 + 0.5e1 / 0.12e2 * t2299 * t836 - 0.5e1 / 0.8e1 * t2299 * t848 - 0.135e3 / 0.128e3 * t2299 * t859 + t2299 * t1833 / 0.9e1 + 0.7e1 / 0.36e2 * t2299 * t158 + 0.27e2 / 0.16e2 * t460 * t2322 + 0.15e2 / 0.4e1 * t460 * t840 - 0.45e2 / 0.32e2 * t460 * t864 + 0.13e2 / 0.4e1 * t460 * t2329 - 0.81e2 / 0.16e2 * t460 * t2332 + 0.9e1 / 0.8e1 * t460 * t830;
  t2338 = t343 * t2337;
  t2345 = t808 * t1084;
  t2346 = t336 * t2345;
  t2352 = t329 * t318;
  t2353 = t198 * t2352;
  t2354 = t1017 * t1060;
  t2358 = t29 * t121 * t309;
  t2361 = t814 * t1084;
  t2362 = t2361 * t368;
  t2363 = t1028 * t2362;
  t2366 = t1059 * t867;
  t2367 = t1028 * t2366;
  t2370 = t223 * t2352;
  t2371 = t1023 * t1060;
  t2375 = t1929 * t465 * t816;
  t2376 = t1028 * t2375;
  t2382 = t33 * t758;
  t2389 = -t1027 * t2279 / 0.24e2 + t2282 * t1775 / 0.216e3 - t2285 * t1780 / 0.216e3 + 0.2e1 / 0.9e1 * t2288 * t1030 - 0.65e2 / 0.648e3 * t2292 * t1019 + 0.65e2 / 0.648e3 * t2295 * t1024 - t130 * t131 * t2338 / 0.24e2 - t330 * t331 * t1085 / 0.108e3 + t335 * t2346 / 0.108e3 + 0.2e1 / 0.9e1 * t130 * t325 * t1085 + t2353 * t2354 / 0.54e2 - 0.4e1 / 0.9e1 * t2358 * t1061 + t123 * t2363 / 0.6e1 + t123 * t2367 / 0.12e2 - t2370 * t2371 / 0.54e2 - t123 * t2376 / 0.4e1 + 0.65e2 / 0.648e3 * t201 * t784 * sigma[2] - 0.11e2 / 0.27e2 * t29 * t2382 * t126 - 0.17e2 / 0.432e3 * t528 * t796 * t314;
  t2390 = t2277 + t2389;
  t2395 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t748 * t470 - t2183 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t303 * t1089 + t2161 - t2190 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t2390);
  tv3rho2sigma8 = t6 * t2395 + 0.2e1 * t1094;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2402 = t5 * t186 * t1160 / 0.8e1;
  t2403 = t1339 * t202;
  t2405 = 0.1e1 / t37 / t1378;
  t2410 = t528 * t894;
  t2411 = t1293 * t904;
  t2414 = t559 * t894;
  t2415 = t1298 * t904;
  t2431 = t1110 * sigma[0];
  t2432 = t903 * t2431;
  t2435 = t909 * t2431;
  t2438 = t202 * t2405;
  t2450 = t219 * t1156;
  t2453 = t568 * t1155;
  t2454 = t225 * t2453;
  t2457 = t219 * t1131;
  t2460 = -t2403 * t2405 * t1347 * t1374 / 0.3456e4 - 0.5e1 / 0.432e3 * t2410 * t2411 + 0.5e1 / 0.432e3 * t2414 * t2415 + t201 * t220 / 0.54e2 - t1107 * t227 / 0.54e2 - 0.2e1 / 0.9e1 * t50 * t213 * t1131 + t395 * t396 * t971 / 0.288e3 - t400 * t401 * t2137 / 0.288e3 - t902 * t2432 / 0.36e2 + t908 * t2435 / 0.36e2 + t1339 * t2438 * t1351 / 0.3456e4 - t528 * t2438 * t1357 / 0.3456e4 + t913 * t947 / 0.6e1 + t50 * t213 * t1156 / 0.9e1 - t218 * t2450 / 0.216e3 + t224 * t2454 / 0.216e3 + t218 * t2457 / 0.108e3;
  t2461 = t1312 * t1130;
  t2462 = t225 * t2461;
  t2466 = t57 * t1137 * t234;
  t2477 = t248 * t1463;
  t2486 = t248 * t1467;
  t2501 = t248 * t1453;
  t2504 = t2466 * t91 / 0.24e2 + t2466 * t244 / 0.24e2 + 0.3e1 / 0.32e2 * t1144 * t255 - t2466 * t596 / 0.24e2 - t2466 * t1423 / 0.24e2 - 0.39e2 / 0.32e2 * t1144 * t2477 + 0.9e1 / 0.32e2 * t2466 * t1427 - 0.3e1 / 0.8e1 * t1144 * t960 + 0.243e3 / 0.256e3 * t2466 * t1432 + 0.243e3 / 0.128e3 * t1144 * t2486 + t2466 * t608 / 0.16e2 - 0.9e1 / 0.32e2 * t2466 * t1440 + 0.27e2 / 0.256e3 * t2466 * t619 - 0.567e3 / 0.1024e4 * t2466 * t1409 - 0.243e3 / 0.512e3 * t2466 * t1419 + 0.9e1 / 0.64e2 * t1144 * t967 - 0.81e2 / 0.128e3 * t1144 * t2501;
  t2505 = t232 * t2504;
  t2509 = t945 * t970;
  t2510 = t914 * t2509;
  t2513 = t394 * t387;
  t2514 = t198 * t2513;
  t2517 = t574 * t1155;
  t2518 = t2517 * t258;
  t2519 = t914 * t2518;
  t2522 = t223 * t2513;
  t2525 = t1318 * t1130;
  t2526 = t2525 * t258;
  t2527 = t914 * t2526;
  t2531 = t198 * t901 * t209;
  t2538 = t528 * t1101;
  t2541 = t559 * t1101;
  t2548 = t198 * t1096;
  t2549 = t903 * t915;
  t2552 = t223 * t1096;
  t2553 = t909 * t915;
  t2556 = t231 * t970;
  t2557 = t914 * t2556;
  t2560 = -t224 * t2462 / 0.108e3 - t50 * t51 * t2505 / 0.24e2 + t43 * t2510 / 0.6e1 - t2514 * t2000 / 0.144e3 + t43 * t2519 / 0.12e2 + t2522 * t1996 / 0.144e3 - t43 * t2527 / 0.4e1 - t2531 / 0.54e2 + 0.5e1 / 0.432e3 * t528 * t920 * sigma[0] + 0.2e1 / 0.9e1 * t2037 * t1111 - t2538 * t1294 / 0.1152e4 + t2541 * t1299 / 0.1152e4 + t2031 * t2025 / 0.216e3 - t2034 * t2028 / 0.216e3 + t2548 * t2549 / 0.288e3 - t2552 * t2553 / 0.288e3 - t913 * t2557 / 0.12e2;
  t2561 = t2460 + t2560;
  t2566 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t1160 - t2402 - 0.3e1 / 0.8e1 * t5 * t27 * t2561);
  tv3rhosigma20 = t6 * t2566 + t1164;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2573 = t5 * t279 * t1228 / 0.8e1;
  t2575 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t1228 - t2573);
  tv3rhosigma25 = t6 * t2575 + t1232;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2581 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t1160 - t2402);
  tv3rhosigma26 = t6 * t2581 + t1164;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2594 = t1178 * sigma[2];
  t2595 = t1017 * t2594;
  t2598 = t1023 * t2594;
  t2602 = 0.1e1 / t117 / t1752;
  t2603 = t314 * t2602;
  t2613 = t331 * t1224;
  t2616 = t808 * t1223;
  t2617 = t336 * t2616;
  t2623 = t1923 * t1198;
  t2628 = t57 * t1205 * t345;
  t2639 = t358 * t1872;
  t2648 = t358 * t1876;
  t2663 = t358 * t1865;
  t2666 = t2628 * t158 / 0.24e2 + t2628 * t354 / 0.24e2 + 0.3e1 / 0.32e2 * t1212 * t365 - t2628 * t836 / 0.24e2 - t2628 * t1833 / 0.24e2 - 0.39e2 / 0.32e2 * t1212 * t2639 + 0.9e1 / 0.32e2 * t2628 * t1837 - 0.3e1 / 0.8e1 * t1212 * t1074 + 0.243e3 / 0.256e3 * t2628 * t1842 + 0.243e3 / 0.128e3 * t1212 * t2648 + t2628 * t848 / 0.16e2 - 0.9e1 / 0.32e2 * t2628 * t1850 + 0.27e2 / 0.256e3 * t2628 * t859 - 0.567e3 / 0.1024e4 * t2628 * t1819 - 0.243e3 / 0.512e3 * t2628 * t1829 + 0.9e1 / 0.64e2 * t1212 * t1081 - 0.81e2 / 0.128e3 * t1212 * t2663;
  t2667 = t343 * t2666;
  t2674 = t441 * t434;
  t2675 = t198 * t2674;
  t2678 = t223 * t2674;
  t2681 = t814 * t1223;
  t2682 = t2681 * t368;
  t2683 = t1028 * t2682;
  t2686 = t1027 * t1061 / 0.6e1 + t130 * t325 * t1224 / 0.9e1 - 0.2e1 / 0.9e1 * t130 * t325 * t1199 - t1016 * t2595 / 0.36e2 + t1022 * t2598 / 0.36e2 + t1339 * t2603 * t1903 / 0.3456e4 - t528 * t2603 * t1908 / 0.3456e4 + t442 * t443 * t1085 / 0.288e3 - t330 * t2613 / 0.216e3 + t335 * t2617 / 0.216e3 + t330 * t331 * t1199 / 0.108e3 - t335 * t336 * t2623 / 0.108e3 - t130 * t131 * t2667 / 0.24e2 - t447 * t448 * t2345 / 0.288e3 - t2675 * t2354 / 0.144e3 + t2678 * t2371 / 0.144e3 + t123 * t2683 / 0.12e2;
  t2687 = t1929 * t1198;
  t2688 = t2687 * t368;
  t2689 = t1028 * t2688;
  t2692 = t1059 * t1084;
  t2693 = t1028 * t2692;
  t2702 = t2602 * t1747 * t1374;
  t2705 = t528 * t1008;
  t2706 = t1774 * t1018;
  t2709 = t559 * t1008;
  t2710 = t1779 * t1018;
  t2714 = t198 * t1015 * t321;
  t2723 = t528 * t1170;
  t2726 = t559 * t1170;
  t2729 = t198 * t1165;
  t2730 = t1017 * t1029;
  t2733 = t223 * t1165;
  t2734 = t1023 * t1029;
  t2737 = t342 * t1084;
  t2738 = t1028 * t2737;
  t2743 = -t123 * t2689 / 0.4e1 + t123 * t2693 / 0.6e1 + t201 * t332 / 0.54e2 - t1107 * t338 / 0.54e2 - t1339 * t314 * t2702 / 0.3456e4 - 0.5e1 / 0.432e3 * t2705 * t2706 + 0.5e1 / 0.432e3 * t2709 * t2710 - t2714 / 0.54e2 + 0.5e1 / 0.432e3 * t528 * t1034 * sigma[2] + t2282 * t2271 / 0.216e3 - t2285 * t2274 / 0.216e3 - t2723 * t1775 / 0.1152e4 + t2726 * t1780 / 0.1152e4 + t2729 * t2730 / 0.288e3 - t2733 * t2734 / 0.288e3 - t1027 * t2738 / 0.12e2 + 0.2e1 / 0.9e1 * t2288 * t1179;
  t2744 = t2686 + t2743;
  t2749 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t1228 - t2573 - 0.3e1 / 0.8e1 * t5 * t114 * t2744);
  tv3rhosigma211 = t6 * t2749 + t1232;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2751 = t1130 * t418;
  t2752 = t1319 * t2751;
  t2756 = t945 * t1155;
  t2757 = t914 * t2756;
  t2768 = t58 / t59 / t202;
  t2770 = t57 * t2768 * t62;
  t2775 = t57 * t2768;
  t2782 = t414 * t1463;
  t2791 = t414 * t1467;
  t2806 = t414 * t1453;
  t2809 = 0.3e1 / 0.64e2 * t2770 * t91 - t2770 * t244 / 0.64e2 - 0.9e1 / 0.256e3 * t2775 * t415 - 0.3e1 / 0.64e2 * t2770 * t596 + t2770 * t1423 / 0.64e2 + 0.117e3 / 0.256e3 * t2775 * t2782 - 0.27e2 / 0.256e3 * t2770 * t1427 - 0.27e2 / 0.64e2 * t2775 * t1145 - 0.729e3 / 0.2048e4 * t2770 * t1432 - 0.729e3 / 0.1024e4 * t2775 * t2791 + 0.9e1 / 0.128e3 * t2770 * t608 + 0.27e2 / 0.256e3 * t2770 * t1440 + 0.243e3 / 0.2048e4 * t2770 * t619 + 0.1701e4 / 0.8192e4 * t2770 * t1409 + 0.729e3 / 0.4096e4 * t2770 * t1419 + 0.81e2 / 0.512e3 * t2775 * t1152 + 0.243e3 / 0.1024e4 * t2775 * t2806;
  t2810 = t232 * t2809;
  t2821 = 0.1e1 / t37 / t531;
  t2822 = sigma[0] * t2821;
  t2829 = t574 * t1130;
  t2830 = t914 * t2829;
  t2833 = t528 * t1100;
  t2834 = t1293 * t95;
  t2837 = t559 * t1100;
  t2838 = t1298 * t95;
  t2845 = t903 * t1110;
  t2848 = t909 * t1110;
  t2851 = t231 * t1155;
  t2852 = t914 * t2851;
  t2858 = t2821 * t1347;
  t2862 = -t50 * t51 * t2752 / 0.4e1 + t43 * t2757 / 0.4e1 - t395 * t396 * t1131 / 0.96e2 + t400 * t401 * t2461 / 0.96e2 - t50 * t51 * t2810 / 0.24e2 + t395 * t396 * t1156 / 0.192e3 - t400 * t401 * t2453 / 0.192e3 - t1339 * t2822 * t1351 / 0.9216e4 + t528 * t2822 * t1357 / 0.9216e4 + t913 * t2830 / 0.4e1 + t2833 * t2834 / 0.384e3 - t2837 * t2838 / 0.384e3 - t2538 * t2025 / 0.384e3 + t2541 * t2028 / 0.384e3 + t2548 * t2845 / 0.96e2 - t2552 * t2848 / 0.96e2 - t913 * t2852 / 0.8e1 - t528 * t1115 / 0.384e3 + t1339 * sigma[0] * t2858 * t1374 / 0.9216e4;
  t2866 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2862);
  tv3sigma30 = t6 * t2866;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2867 = t1339 * sigma[2];
  t2869 = 0.1e1 / t117 / t772;
  t2870 = t2869 * t1747;
  t2876 = t58 / t135 / t314;
  t2878 = t57 * t2876 * t138;
  t2883 = t57 * t2876;
  t2890 = t461 * t1872;
  t2899 = t461 * t1876;
  t2914 = t461 * t1865;
  t2917 = 0.3e1 / 0.64e2 * t2878 * t158 - t2878 * t354 / 0.64e2 - 0.9e1 / 0.256e3 * t2883 * t462 - 0.3e1 / 0.64e2 * t2878 * t836 + t2878 * t1833 / 0.64e2 + 0.117e3 / 0.256e3 * t2883 * t2890 - 0.27e2 / 0.256e3 * t2878 * t1837 - 0.27e2 / 0.64e2 * t2883 * t1213 - 0.729e3 / 0.2048e4 * t2878 * t1842 - 0.729e3 / 0.1024e4 * t2883 * t2899 + 0.9e1 / 0.128e3 * t2878 * t848 + 0.27e2 / 0.256e3 * t2878 * t1850 + 0.243e3 / 0.2048e4 * t2878 * t859 + 0.1701e4 / 0.8192e4 * t2878 * t1819 + 0.729e3 / 0.4096e4 * t2878 * t1829 + 0.81e2 / 0.512e3 * t2883 * t1220 + 0.243e3 / 0.1024e4 * t2883 * t2914;
  t2918 = t343 * t2917;
  t2925 = sigma[2] * t2869;
  t2935 = t814 * t1198;
  t2936 = t1028 * t2935;
  t2939 = t528 * t1169;
  t2940 = t1774 * t162;
  t2943 = t559 * t1169;
  t2944 = t1779 * t162;
  t2949 = t1023 * t1178;
  t2952 = t342 * t1223;
  t2953 = t1028 * t2952;
  t2958 = t1017 * t1178;
  t2963 = t1059 * t1223;
  t2964 = t1028 * t2963;
  t2970 = t1198 * t465;
  t2971 = t1930 * t2970;
  t2978 = t2867 * t2870 * t1374 / 0.9216e4 - t130 * t131 * t2918 / 0.24e2 - t447 * t448 * t2616 / 0.192e3 - t1339 * t2925 * t1903 / 0.9216e4 + t528 * t2925 * t1908 / 0.9216e4 + t442 * t443 * t1224 / 0.192e3 + t1027 * t2936 / 0.4e1 + t2939 * t2940 / 0.384e3 - t2943 * t2944 / 0.384e3 + t2726 * t2274 / 0.384e3 - t2733 * t2949 / 0.96e2 - t1027 * t2953 / 0.8e1 - t2723 * t2271 / 0.384e3 + t2729 * t2958 / 0.96e2 - t528 * t1183 / 0.384e3 + t123 * t2964 / 0.4e1 + t447 * t448 * t2623 / 0.96e2 - t130 * t131 * t2971 / 0.4e1 - t442 * t443 * t1199 / 0.96e2;
  t2982 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t2978);
  tv3sigma39 = t6 * t2982;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t30, t31;
  double t32, t33, t34, t35, t36, t37, t39, t41;
  double t42, t43, t45, t46, t50, t51, t52, t55;
  double t56, t57, t58, t59, t60, t62, t65, t66;
  double t67, t68, t69, t70, t72, t73, t76, t79;
  double t80, t81, t83, t84, t88, t89, t91, t94;
  double t95, t96, t97, t100, t104, t105, t106, t108;
  double t109, t110, t111, t113, t114, t115, t116, t117;
  double t119, t121, t122, t123, t125, t126, t130, t131;
  double t134, t135, t136, t138, t142, t143, t148, t149;
  double t150, t155, t156, t158, t161, t162, t163, t164;
  double t167, t171, tzk0;

  double t172, t173, t174, t176, t179, t180, t184, t185;
  double t186, t189, t190, t192, t197, t198, t200, t201;
  double t202, t203, t204, t206, t208, t209, t213, t214;
  double t217, t218, t219, t220, t223, t224, t225, t226;
  double t227, t230, t231, t232, t234, t236, t239, t240;
  double t241, t242, t244, t247, t248, t249, t250, t251;
  double t252, t253, t254, t255, t258, t259, t263, t268;
  double t269, t271, t274, t275, t279, t282, t284, tvrho0;
  double t288, t291, t292, t297, t299, t302, t303, t307;
  double t309, t314, t315, t316, t318, t320, t321, t325;
  double t326, t329, t330, t331, t332, t335, t336, t337;
  double t338, t341, t342, t343, t345, t347, t350, t351;
  double t352, t354, t357, t358, t359, t360, t361, t362;
  double t363, t364, t365, t368, t369, t373, t378, tvrho1;
  double t381, t385, t387, t394, t395, t396, t397, t400;
  double t401, t402, t406, t408, t413, t414, t415, t418;
  double t419, t423, t427, tvsigma0, tvsigma1, t428, t432, t434;
  double t441, t442, t443, t444, t447, t448, t449, t453;
  double t455, t460, t461, t462, t465, t466, t470, t474;
  double tvsigma2;

  double t477, t478, t479, t482, t483, t484, t487, t491;
  double t492, t496, t498, t504, t505, t508, t510, t513;
  double t518, t520, t526, t527, t528, t529, t530, t531;
  double t532, t533, t535, t539, t540, t543, t544, t547;
  double t548, t554, t555, t559, t560, t561, t568, t569;
  double t574, t575, t576, t577, t582, t584, t589, t590;
  double t593, t594, t596, t599, t600, t604, t605, t606;
  double t608, t611, t615, t616, t619, t622, t623, t624;
  double t627, t628, t632, t637, t638, t639, t640, t643;
  double t646, t650, t651, t655, t657, t659, t662, t664;
  double tv2rho20, t667, t671, t675, t676, t680, t682, t690;
  double t691, t695, t699, t700, t704, t706, t713, t716;
  double tv2rho21, t721, t726, t730, t731, t737, t738, t743;
  double t747, t748, t758, t763, t765, t770, t771, t772;
  double t773, t774, t776, t780, t781, t784, t785, t788;
  double t789, t795, t796, t800, t801, t808, t809, t814;
  double t815, t816, t817, t822, t824, t829, t830, t833;
  double t834, t836, t839, t840, t844, t845, t846, t848;
  double t851, t855, t856, t859, t862, t863, t864, t867;
  double t868, t872, t877, tv2rho22, t885, t886, t893, t894;
  double t895, t901, t902, t903, t904, t905, t908, t909;
  double t910, t913, t914, t915, t916, t920, t925, t941;
  double t945, t946, t947, t951, t960, t967, t970, t971;
  double t975, t980, tv2rhosigma0, tv2rhosigma1, t987, t989, tv2rhosigma2, t995;
  double tv2rhosigma3, tv2rhosigma4, t1000, t1007, t1008, t1009, t1015, t1016;
  double t1017, t1018, t1019, t1022, t1023, t1024, t1027, t1028;
  double t1029, t1030, t1034, t1055, t1059, t1060, t1061, t1065;
  double t1074, t1081, t1084, t1085, t1089, t1094, tv2rhosigma5, t1096;
  double t1100, t1101, t1107, t1110, t1111, t1115, t1130, t1131;
  double t1137, t1139, t1144, t1145, t1152, t1155, t1156, t1160;
  double t1164, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1165, t1169;
  double t1170, t1178, t1179, t1183, t1198, t1199, t1205, t1207;
  double t1212, t1213, t1220, t1223, t1224, t1228, t1232, tv2sigma25;

  double t1236, t1237, t1240, t1243, t1244, t1245, t1248, t1252;
  double t1253, t1257, t1259, t1264, t1266, t1269, t1275, t1276;
  double t1279, t1281, t1284, t1287, t1288, t1289, t1292, t1293;
  double t1294, t1297, t1298, t1299, t1303, t1304, t1308, t1312;
  double t1313, t1317, t1318, t1319, t1320, t1321, t1331, t1332;
  double t1338, t1339, t1340, t1341, t1343, t1344, t1346, t1347;
  double t1350, t1351, t1354, t1357, t1372, t1374, t1378, t1379;
  double t1380, t1392, t1397, t1399, t1400, t1403, t1405, t1406;
  double t1409, t1414, t1415, t1416, t1418, t1419, t1423, t1427;
  double t1432, t1436, t1438, t1440, t1451, t1452, t1453, t1454;
  double t1457, t1460, t1463, t1464, t1467, t1468, t1471, t1476;
  double t1477, t1486, t1487, t1490, t1491, t1496, t1498, t1499;
  double t1502, t1505, t1508, t1512, t1513, t1517, t1519, t1521;
  double t1523, t1525, t1528, t1530, tv3rho30, t1533, t1534, t1535;
  double t1538, t1543, t1544, t1546, t1550, t1551, t1555, t1558;
  double t1562, t1564, t1568, t1577, t1578, t1579, t1582, t1587;
  double t1589, t1593, t1594, t1598, t1601, t1602, t1604, t1613;
  double t1615, t1618, tv3rho31, t1621, t1626, t1630, t1634, t1635;
  double t1639, t1641, t1650, t1651, t1656, t1660, t1664, t1665;
  double t1669, t1671, t1678, t1686, t1688, t1689, tv3rho32, t1694;
  double t1701, t1705, t1706, t1713, t1714, t1721, t1725, t1726;
  double t1741, t1742, t1743, t1745, t1746, t1747, t1752, t1753;
  double t1754, t1763, t1764, t1768, t1769, t1770, t1773, t1774;
  double t1775, t1778, t1779, t1780, t1784, t1785, t1789, t1793;
  double t1805, t1807, t1809, t1810, t1813, t1815, t1816, t1819;
  double t1824, t1825, t1826, t1828, t1829, t1833, t1837, t1842;
  double t1846, t1848, t1850, t1863, t1864, t1865, t1866, t1869;
  double t1872, t1873, t1876, t1877, t1880, t1883, t1886, t1887;
  double t1891, t1894, t1895, t1898, t1902, t1903, t1908, t1923;
  double t1924, t1928, t1929, t1930, t1931, t1932, t1942, t1943;
  double t1948, tv3rho33, t1956, t1963, t1965, t1970, t1972, t1974;
  double t1977, t1978, t1979, t1982, t1983, t1987, t1990, t1991;
  double t1994, t1995, t1996, t1999, t2000, t2003, t2004, t2005;
  double t2009, t2010, t2013, t2014, t2017, t2018, t2021, t2022;
  double t2025, t2028, t2031, t2034, t2037, t2040, t2041, t2053;
  double t2064, t2065, t2068, t2083, t2094, t2117, t2120, t2129;
  double t2132, t2133, t2137, t2138, t2141, t2144, t2145, t2150;
  double tv3rho2sigma0, tv3rho2sigma1, t2157, t2161, t2163, tv3rho2sigma2, t2169, t2177;
  double tv3rho2sigma3, tv3rho2sigma4, t2183, t2190, t2193, tv3rho2sigma5, t2201, tv3rho2sigma6;
  double tv3rho2sigma7, t2215, t2217, t2222, t2223, t2224, t2227, t2228;
  double t2249, t2260, t2261, t2264, t2267, t2268, t2271, t2274;
  double t2277, t2278, t2279, t2282, t2285, t2288, t2291, t2292;
  double t2295, t2299, t2322, t2329, t2332, t2337, t2338, t2345;
  double t2346, t2352, t2353, t2354, t2358, t2361, t2362, t2363;
  double t2366, t2367, t2370, t2371, t2375, t2376, t2382, t2389;
  double t2390, t2395, tv3rho2sigma8, t2402, t2403, t2405, t2410, t2411;
  double t2414, t2415, t2431, t2432, t2435, t2438, t2450, t2453;
  double t2454, t2457, t2460, t2461, t2462, t2466, t2477, t2486;
  double t2501, t2504, t2505, t2509, t2510, t2513, t2514, t2517;
  double t2518, t2519, t2522, t2525, t2526, t2527, t2531, t2538;
  double t2541, t2548, t2549, t2552, t2553, t2556, t2557, t2560;
  double t2561, t2566, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t2573;
  double t2575, tv3rhosigma25, t2581, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t2594, t2595, t2598, t2602, t2603, t2613, t2616, t2617;
  double t2623, t2628, t2639, t2648, t2663, t2666, t2667, t2674;
  double t2675, t2678, t2681, t2682, t2683, t2686, t2687, t2688;
  double t2689, t2692, t2693, t2702, t2705, t2706, t2709, t2710;
  double t2714, t2723, t2726, t2729, t2730, t2733, t2734, t2737;
  double t2738, t2743, t2744, t2749, tv3rhosigma211, t2751, t2752, t2756;
  double t2757, t2768, t2770, t2775, t2782, t2791, t2806, t2809;
  double t2810, t2821, t2822, t2829, t2830, t2833, t2834, t2837;
  double t2838, t2845, t2848, t2851, t2852, t2858, t2862, t2866;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t2867, t2869, t2870, t2876, t2878, t2883, t2890;
  double t2899, t2914, t2917, t2918, t2925, t2935, t2936, t2939;
  double t2940, t2943, t2944, t2949, t2952, t2953, t2958, t2963;
  double t2964, t2970, t2971, t2978, t2982, tv3sigma39;

  double t2990, t2993, t2997, t2999, t3003, t3004, t3006, t3017;
  double t3023, t3029, t3030, t3032, t3035, t3037, t3039, t3043;
  double t3045, t3050, t3051, t3064, t3071, t3074, t3085, t3088;
  double t3091, t3093, t3102, t3106, t3107, t3112, t3118, t3123;
  double t3126, t3129, t3134, t3137, t3141, t3145, t3169, t3172;
  double t3173, t3179, t3181, t3186, t3194, t3199, t3201, t3205;
  double t3223, t3227, t3231, t3244, t3254, t3255, t3256, t3260;
  double t3261, t3265, t3266, t3289, t3305, t3312, t3315, t3318;
  double t3324, t3326, t3331, t3333, t3334, t3340, t3346, t3347;
  double t3350, t3354, t3363, t3366, t3370, t3373, t3377, t3381;
  double t3383, t3384, t3385, t3387, t3388, t3394, t3399, t3402;
  double t3406, t3413, t3417, t3421, t3426, t3428, tv4rho40, t3435;
  double t3439, t3443, t3444, t3449, t3450, t3452, t3470, t3471;
  double t3473, t3477, t3486, t3500, t3501, t3518, t3520, t3524;
  double t3531, t3535, t3536, t3539, t3548, t3551, t3552, t3554;
  double t3556, t3557, tv4rho41, t3566, t3570, t3583, t3596, t3600;
  double t3609, t3622, t3623, t3632, t3645, t3649, t3656, t3660;
  double t3669, t3672, t3683, t3686, t3688, t3689, tv4rho42, t3710;
  double t3714, t3721, t3732, t3733, t3750, t3754, t3761, t3769;
  double t3778, t3788, t3790, t3791, tv4rho43, t3796, t3801, t3808;
  double t3812, t3821, t3822, t3832, t3836, t3838, t3841, t3847;
  double t3848, t3850, t3864, t3866, t3867, t3871, t3887, t3892;
  double t3896, t3898, t3905, t3910, t3913, t3917, t3921, t3925;
  double t3930, t3944, t3953, t3957, t3961, t3962, t3966, t3976;
  double t3981, t3989, t3994, t4013, t4019, t4033, t4041, t4042;
  double t4045, t4046, t4049, t4052, t4053, t4058, t4068, t4069;
  double t4070, t4074, t4075, t4091, t4098, t4104, t4113, t4116;
  double t4119, t4130, t4133, t4136, t4139, t4151, t4156, t4163;
  double t4167, t4183, t4184, tv4rho44, t4192, t4198, t4201, t4208;
  double t4210, t4213, t4216, t4220, t4243, t4244, t4289, t4298;
  double t4331, t4346, t4353, t4359, t4362, t4381, t4388, t4396;
  double t4397, t4413, t4415, t4418, t4426, t4429, t4436, t4468;
  double t4477, t4478, t4485, t4506, t4509, t4514, t4518, t4521;
  double t4524, t4535, t4542, tv4rho3sigma0, tv4rho3sigma1, t4549, t4552, t4556;
  double t4558, tv4rho3sigma2, t4560, t4566, t4571, t4575, t4584, t4585;
  double tv4rho3sigma3, tv4rho3sigma4, t4587, t4593, t4595, t4604, t4606, t4609;
  double tv4rho3sigma5, t4615, t4624, tv4rho3sigma6, tv4rho3sigma7, t4630, t4637, t4645;
  double t4647, t4648, tv4rho3sigma8, t4657, tv4rho3sigma9, tv4rho3sigma10, t4702, t4711;
  double t4744, t4762, t4765, t4768, t4771, t4778, t4788, t4792;
  double t4796, t4809, t4812, t4817, t4820, t4827, t4828, t4851;
  double t4872, t4892, t4895, t4906, t4911, t4912, t4924, t4927;
  double t4930, t4937, t4960, t4963, t4966, t4972, t4988, t4995;
  double t5002, tv4rho3sigma11, t5009, t5016, t5018, t5020, t5023, t5033;
  double t5038, t5049, t5053, t5058, t5083, t5089, t5109, t5124;
  double t5131, t5134, t5137, t5140, t5153, t5204, t5205, t5218;
  double t5239, t5270, t5308, t5314, t5323, t5326, t5333, t5350;
  double t5359, t5367, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t5374;
  double t5378, t5380, tv4rho2sigma25, t5386, t5394, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28;
  double tv4rho2sigma29, tv4rho2sigma210, t5400, t5407, t5410, tv4rho2sigma211, t5418, tv4rho2sigma212;
  double tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t5456, t5468, t5471, t5474;
  double t5477, t5485, t5491, t5494, t5502, t5521, t5557, t5590;
  double t5606, t5609, t5610, t5637, t5653, t5656, t5659, t5662;
  double t5674, t5699, t5703, t5712, t5736, t5745, t5746, t5751;
  double t5768, t5776, tv4rho2sigma217, t5783, t5802, t5809, t5826, t5830;
  double t5833, t5865, t5874, t5907, t5916, t5934, t5944, t5951;
  double t5956, t5957, t5991, t5994, t6018, t6042, t6049, tv4rhosigma30;
  double tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38;
  double t6056, t6058, tv4rhosigma39, t6064, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313;
  double tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t6077, t6088, t6110;
  double t6114, t6132, t6141, t6153, t6157, t6163, t6164, t6199;
  double t6208, t6241, t6254, t6258, t6280, t6298, t6325, t6332;
  double tv4rhosigma319, t6356, t6361, t6367, t6369, t6372, t6406, t6439;
  double t6453, t6454, t6461, t6512, t6517, tv4sigma40, tv4sigma41, tv4sigma42;
  double tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410;
  double tv4sigma411, tv4sigma412, tv4sigma413, t6524, t6525, t6554, t6563, t6596;
  double t6605, t6609, t6615, t6616, t6644, t6697, t6702, tv4sigma414;

  gga_x_am05_params *params;

  assert(p->params != NULL);
  params = (gga_x_am05_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = t33 * sigma[0];
  t42 = t41 * t39;
  t43 = t29 * t42;
  t45 = 0.1e1 + t43 / 0.24e2;
  t46 = 0.1e1 / t45;
  t50 = t29 * t41;
  t51 = t39 * t46;
  t52 = params->c * t28;
  t55 = 0.1e1 + t52 * t42 / 0.24e2;
  t56 = t28 * t28;
  t57 = params->c * t56;
  t58 = 0.1e1 / t31;
  t59 = sqrt(sigma[0]);
  t60 = t58 * t59;
  t62 = 0.1e1 / t36 / rho[0];
  t65 = 0.1e1 / M_PI;
  t66 = t2 * t2;
  t67 = t65 * t66;
  t68 = M_CBRT2;
  t69 = sqrt(0.12e2);
  t70 = t56 * t58;
  t72 = t70 * t59 * t62;
  t73 = sqrt(t72);
  t76 = sqrt(0.6e1);
  t79 = LambertW(t69 * t73 * t72 * t76 / 0.1728e4);
  t80 = POW_1_3(t79);
  t81 = t80 * t80;
  t83 = t68 * t68;
  t84 = t2 * t83;
  t88 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t80 * t79;
  t89 = POW_1_4(t88);
  t91 = t67 * t68 * t81 * t89;
  t94 = 0.1e1 + t57 * t60 * t62 * t91 / 0.8e1;
  t95 = 0.1e1 / t94;
  t96 = t55 * t95;
  t97 = t51 * t96;
  t100 = 0.1e1 - t34 * sigma[0] * t39 * t46 / 0.24e2 + t50 * t97 / 0.24e2;
  t104 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t100);
  t105 = rho[1] <= p->dens_threshold;
  t106 = -t16;
  t108 = my_piecewise5(t14, t11, t10, t15, t106 * t7);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = rho[1] * rho[1];
  t116 = POW_1_3(rho[1]);
  t117 = t116 * t116;
  t119 = 0.1e1 / t117 / t115;
  t121 = t33 * sigma[2];
  t122 = t121 * t119;
  t123 = t29 * t122;
  t125 = 0.1e1 + t123 / 0.24e2;
  t126 = 0.1e1 / t125;
  t130 = t29 * t121;
  t131 = t119 * t126;
  t134 = 0.1e1 + t52 * t122 / 0.24e2;
  t135 = sqrt(sigma[2]);
  t136 = t58 * t135;
  t138 = 0.1e1 / t116 / rho[1];
  t142 = t70 * t135 * t138;
  t143 = sqrt(t142);
  t148 = LambertW(t69 * t143 * t142 * t76 / 0.1728e4);
  t149 = POW_1_3(t148);
  t150 = t149 * t149;
  t155 = 0.2823705740248932030511071641312341561894e2 + 0.3e1 / 0.4e1 * t84 * t149 * t148;
  t156 = POW_1_4(t155);
  t158 = t67 * t68 * t150 * t156;
  t161 = 0.1e1 + t57 * t136 * t138 * t158 / 0.8e1;
  t162 = 0.1e1 / t161;
  t163 = t134 * t162;
  t164 = t131 * t163;
  t167 = 0.1e1 - t34 * sigma[2] * t119 * t126 / 0.24e2 + t130 * t164 / 0.24e2;
  t171 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t167);
  tzk0 = t104 + t171;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t172 = t6 * t6;
  t173 = 0.1e1 / t172;
  t174 = t16 * t173;
  t176 = my_piecewise5(t10, 0, t14, 0, t7 - t174);
  t179 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t176);
  t180 = t179 * t26;
  t184 = t26 * t26;
  t185 = 0.1e1 / t184;
  t186 = t25 * t185;
  t189 = t5 * t186 * t100 / 0.8e1;
  t190 = t35 * rho[0];
  t192 = 0.1e1 / t37 / t190;
  t197 = params->alpha * params->alpha;
  t198 = t197 * t56;
  t200 = 0.1e1 / t31 / t30;
  t201 = t198 * t200;
  t202 = sigma[0] * sigma[0];
  t203 = t35 * t35;
  t204 = t203 * t35;
  t206 = 0.1e1 / t36 / t204;
  t208 = t45 * t45;
  t209 = 0.1e1 / t208;
  t213 = t192 * t46;
  t214 = t213 * t96;
  t217 = t200 * t202;
  t218 = t198 * t217;
  t219 = t206 * t209;
  t220 = t219 * t96;
  t223 = params->alpha * t56;
  t224 = t223 * t217;
  t225 = t206 * t46;
  t226 = params->c * t95;
  t227 = t225 * t226;
  t230 = t94 * t94;
  t231 = 0.1e1 / t230;
  t232 = t55 * t231;
  t234 = 0.1e1 / t36 / t35;
  t236 = t57 * t60 * t234;
  t239 = t67 * t68;
  t240 = t81 * t89;
  t241 = 0.1e1 + t79;
  t242 = 0.1e1 / t241;
  t244 = t239 * t240 * t242;
  t247 = t57 * t60;
  t248 = t234 * t65;
  t249 = t79 * t79;
  t250 = t89 * t89;
  t251 = t250 * t89;
  t252 = 0.1e1 / t251;
  t253 = t249 * t252;
  t254 = t253 * t242;
  t255 = t248 * t254;
  t258 = -t236 * t91 / 0.6e1 - t236 * t244 / 0.6e1 - 0.3e1 / 0.8e1 * t247 * t255;
  t259 = t232 * t258;
  t263 = t34 * sigma[0] * t192 * t46 / 0.9e1 - t201 * t202 * t206 * t209 / 0.216e3 - t50 * t214 / 0.9e1 + t218 * t220 / 0.216e3 - t224 * t227 / 0.216e3 - t50 * t51 * t259 / 0.24e2;
  t268 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t100 - t189 - 0.3e1 / 0.8e1 * t5 * t27 * t263);
  t269 = t106 * t173;
  t271 = my_piecewise5(t14, 0, t10, 0, -t7 - t269);
  t274 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t271);
  t275 = t274 * t26;
  t279 = t113 * t185;
  t282 = t5 * t279 * t167 / 0.8e1;
  t284 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t167 - t282);
  tvrho0 = t104 + t171 + t6 * (t268 + t284);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t288 = my_piecewise5(t10, 0, t14, 0, -t7 - t174);
  t291 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t288);
  t292 = t291 * t26;
  t297 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t100 - t189);
  t299 = my_piecewise5(t14, 0, t10, 0, t7 - t269);
  t302 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t299);
  t303 = t302 * t26;
  t307 = t115 * rho[1];
  t309 = 0.1e1 / t117 / t307;
  t314 = sigma[2] * sigma[2];
  t315 = t115 * t115;
  t316 = t315 * t115;
  t318 = 0.1e1 / t116 / t316;
  t320 = t125 * t125;
  t321 = 0.1e1 / t320;
  t325 = t309 * t126;
  t326 = t325 * t163;
  t329 = t200 * t314;
  t330 = t198 * t329;
  t331 = t318 * t321;
  t332 = t331 * t163;
  t335 = t223 * t329;
  t336 = t318 * t126;
  t337 = params->c * t162;
  t338 = t336 * t337;
  t341 = t161 * t161;
  t342 = 0.1e1 / t341;
  t343 = t134 * t342;
  t345 = 0.1e1 / t116 / t115;
  t347 = t57 * t136 * t345;
  t350 = t150 * t156;
  t351 = 0.1e1 + t148;
  t352 = 0.1e1 / t351;
  t354 = t239 * t350 * t352;
  t357 = t57 * t136;
  t358 = t345 * t65;
  t359 = t148 * t148;
  t360 = t156 * t156;
  t361 = t360 * t156;
  t362 = 0.1e1 / t361;
  t363 = t359 * t362;
  t364 = t363 * t352;
  t365 = t358 * t364;
  t368 = -t347 * t158 / 0.6e1 - t347 * t354 / 0.6e1 - 0.3e1 / 0.8e1 * t357 * t365;
  t369 = t343 * t368;
  t373 = t34 * sigma[2] * t309 * t126 / 0.9e1 - t201 * t314 * t318 * t321 / 0.216e3 - t130 * t326 / 0.9e1 + t330 * t332 / 0.216e3 - t335 * t338 / 0.216e3 - t130 * t131 * t369 / 0.24e2;
  t378 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t167 - t282 - 0.3e1 / 0.8e1 * t5 * t114 * t373);
  tvrho1 = t104 + t171 + t6 * (t297 + t378);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t381 = t33 * t39;
  t385 = t203 * rho[0];
  t387 = 0.1e1 / t36 / t385;
  t394 = t200 * sigma[0];
  t395 = t198 * t394;
  t396 = t387 * t209;
  t397 = t396 * t96;
  t400 = t223 * t394;
  t401 = t387 * t46;
  t402 = t401 * t226;
  t406 = t58 / t59;
  t408 = t57 * t406 * t62;
  t413 = t57 * t406;
  t414 = t62 * t65;
  t415 = t414 * t254;
  t418 = t408 * t91 / 0.16e2 + t408 * t244 / 0.16e2 + 0.9e1 / 0.64e2 * t413 * t415;
  t419 = t232 * t418;
  t423 = -t29 * t381 * t46 / 0.24e2 + t201 * sigma[0] * t387 * t209 / 0.576e3 + t34 * t97 / 0.24e2 - t395 * t397 / 0.576e3 + t400 * t402 / 0.576e3 - t50 * t51 * t419 / 0.24e2;
  t427 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t423);
  tvsigma0 = t6 * t427;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t428 = t33 * t119;
  t432 = t315 * rho[1];
  t434 = 0.1e1 / t116 / t432;
  t441 = t200 * sigma[2];
  t442 = t198 * t441;
  t443 = t434 * t321;
  t444 = t443 * t163;
  t447 = t223 * t441;
  t448 = t434 * t126;
  t449 = t448 * t337;
  t453 = t58 / t135;
  t455 = t57 * t453 * t138;
  t460 = t57 * t453;
  t461 = t138 * t65;
  t462 = t461 * t364;
  t465 = t455 * t158 / 0.16e2 + t455 * t354 / 0.16e2 + 0.9e1 / 0.64e2 * t460 * t462;
  t466 = t343 * t465;
  t470 = -t29 * t428 * t126 / 0.24e2 + t201 * sigma[2] * t434 * t321 / 0.576e3 + t34 * t164 / 0.24e2 - t442 * t444 / 0.576e3 + t447 * t449 / 0.576e3 - t130 * t131 * t466 / 0.24e2;
  t474 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t470);
  tvsigma2 = t6 * t474;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t477 = t23 * t23;
  t478 = 0.1e1 / t477;
  t479 = t176 * t176;
  t482 = t172 * t6;
  t483 = 0.1e1 / t482;
  t484 = t16 * t483;
  t487 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t173 + 0.2e1 * t484);
  t491 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t478 * t479 + 0.4e1 / 0.3e1 * t23 * t487);
  t492 = t491 * t26;
  t496 = t179 * t185;
  t498 = t5 * t496 * t100;
  t504 = 0.1e1 / t184 / t6;
  t505 = t25 * t504;
  t508 = t5 * t505 * t100 / 0.12e2;
  t510 = t5 * t186 * t263;
  t513 = 0.1e1 / t37 / t203;
  t518 = t203 * t190;
  t520 = 0.1e1 / t36 / t518;
  t526 = t30 * t30;
  t527 = 0.1e1 / t526;
  t528 = t197 * params->alpha * t527;
  t529 = t202 * sigma[0];
  t530 = t203 * t203;
  t531 = t530 * t35;
  t532 = 0.1e1 / t531;
  t533 = t529 * t532;
  t535 = 0.1e1 / t208 / t45;
  t539 = t513 * t46;
  t540 = t539 * t96;
  t543 = t520 * t209;
  t544 = t543 * t96;
  t547 = t520 * t46;
  t548 = t547 * t226;
  t554 = t528 * t529;
  t555 = t532 * t535;
  t559 = t197 * t527;
  t560 = t559 * t529;
  t561 = t532 * t209;
  t568 = params->c * t231;
  t569 = t568 * t258;
  t574 = 0.1e1 / t230 / t94;
  t575 = t55 * t574;
  t576 = t258 * t258;
  t577 = t575 * t576;
  t582 = 0.1e1 / t36 / t190;
  t584 = t57 * t60 * t582;
  t589 = t582 * t65;
  t590 = t589 * t254;
  t593 = t241 * t241;
  t594 = 0.1e1 / t593;
  t596 = t239 * t240 * t594;
  t599 = t253 * t594;
  t600 = t589 * t599;
  t604 = t81 * t79 * t89;
  t605 = t593 * t241;
  t606 = 0.1e1 / t605;
  t608 = t239 * t604 * t606;
  t611 = t249 * t79;
  t615 = 0.1e1 / t251 / t88;
  t616 = t65 * t80 * t611 * t615;
  t619 = t616 * t594 * t2 * t83;
  t622 = t611 * t252;
  t623 = t622 * t606;
  t624 = t589 * t623;
  t627 = 0.7e1 / 0.18e2 * t584 * t91 + 0.11e2 / 0.18e2 * t584 * t244 + 0.11e2 / 0.8e1 * t247 * t590 + 0.2e1 / 0.9e1 * t584 * t596 + 0.2e1 * t247 * t600 - t584 * t608 / 0.3e1 - 0.9e1 / 0.16e2 * t584 * t619 - 0.3e1 / 0.4e1 * t247 * t624;
  t628 = t232 * t627;
  t632 = -0.11e2 / 0.27e2 * t34 * sigma[0] * t513 * t46 + t201 * t202 * t520 * t209 / 0.24e2 - t528 * t533 * t535 / 0.162e3 + 0.11e2 / 0.27e2 * t50 * t540 - t218 * t544 / 0.24e2 + t224 * t548 / 0.24e2 + 0.2e1 / 0.9e1 * t50 * t213 * t259 + t554 * t555 * t96 / 0.162e3 - t560 * t561 * t226 / 0.162e3 - t218 * t219 * t259 / 0.108e3 + t224 * t225 * t569 / 0.108e3 + t50 * t51 * t577 / 0.12e2 - t50 * t51 * t628 / 0.24e2;
  t637 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t492 * t100 - t498 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t180 * t263 + t508 - t510 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t632);
  t638 = t111 * t111;
  t639 = 0.1e1 / t638;
  t640 = t271 * t271;
  t643 = t106 * t483;
  t646 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t173 + 0.2e1 * t643);
  t650 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t639 * t640 + 0.4e1 / 0.3e1 * t111 * t646);
  t651 = t650 * t26;
  t655 = t274 * t185;
  t657 = t5 * t655 * t167;
  t659 = t113 * t504;
  t662 = t5 * t659 * t167 / 0.12e2;
  t664 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t651 * t167 - t657 / 0.4e1 + t662);
  tv2rho20 = 0.2e1 * t268 + 0.2e1 * t284 + t6 * (t637 + t664);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t667 = t478 * t288;
  t671 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t484);
  t675 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t667 * t176 + 0.4e1 / 0.3e1 * t23 * t671);
  t676 = t675 * t26;
  t680 = t291 * t185;
  t682 = t5 * t680 * t100;
  t690 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t676 * t100 - t682 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t292 * t263 - t498 / 0.8e1 + t508 - t510 / 0.8e1);
  t691 = t639 * t299;
  t695 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t643);
  t699 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t691 * t271 + 0.4e1 / 0.3e1 * t111 * t695);
  t700 = t699 * t26;
  t704 = t302 * t185;
  t706 = t5 * t704 * t167;
  t713 = t5 * t279 * t373;
  t716 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t700 * t167 - t706 / 0.8e1 - t657 / 0.8e1 + t662 - 0.3e1 / 0.8e1 * t5 * t275 * t373 - t713 / 0.8e1);
  tv2rho21 = t268 + t284 + t297 + t378 + t6 * (t690 + t716);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t721 = t288 * t288;
  t726 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t173 + 0.2e1 * t484);
  t730 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t478 * t721 + 0.4e1 / 0.3e1 * t23 * t726);
  t731 = t730 * t26;
  t737 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t731 * t100 - t682 / 0.4e1 + t508);
  t738 = t299 * t299;
  t743 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t173 + 0.2e1 * t643);
  t747 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t639 * t738 + 0.4e1 / 0.3e1 * t111 * t743);
  t748 = t747 * t26;
  t758 = 0.1e1 / t117 / t315;
  t763 = t315 * t307;
  t765 = 0.1e1 / t116 / t763;
  t770 = t314 * sigma[2];
  t771 = t315 * t315;
  t772 = t771 * t115;
  t773 = 0.1e1 / t772;
  t774 = t770 * t773;
  t776 = 0.1e1 / t320 / t125;
  t780 = t758 * t126;
  t781 = t780 * t163;
  t784 = t765 * t321;
  t785 = t784 * t163;
  t788 = t765 * t126;
  t789 = t788 * t337;
  t795 = t528 * t770;
  t796 = t773 * t776;
  t800 = t559 * t770;
  t801 = t773 * t321;
  t808 = params->c * t342;
  t809 = t808 * t368;
  t814 = 0.1e1 / t341 / t161;
  t815 = t134 * t814;
  t816 = t368 * t368;
  t817 = t815 * t816;
  t822 = 0.1e1 / t116 / t307;
  t824 = t57 * t136 * t822;
  t829 = t822 * t65;
  t830 = t829 * t364;
  t833 = t351 * t351;
  t834 = 0.1e1 / t833;
  t836 = t239 * t350 * t834;
  t839 = t363 * t834;
  t840 = t829 * t839;
  t844 = t150 * t148 * t156;
  t845 = t833 * t351;
  t846 = 0.1e1 / t845;
  t848 = t239 * t844 * t846;
  t851 = t359 * t148;
  t855 = 0.1e1 / t361 / t155;
  t856 = t65 * t149 * t851 * t855;
  t859 = t856 * t834 * t2 * t83;
  t862 = t851 * t362;
  t863 = t862 * t846;
  t864 = t829 * t863;
  t867 = 0.7e1 / 0.18e2 * t824 * t158 + 0.11e2 / 0.18e2 * t824 * t354 + 0.11e2 / 0.8e1 * t357 * t830 + 0.2e1 / 0.9e1 * t824 * t836 + 0.2e1 * t357 * t840 - t824 * t848 / 0.3e1 - 0.9e1 / 0.16e2 * t824 * t859 - 0.3e1 / 0.4e1 * t357 * t864;
  t868 = t343 * t867;
  t872 = -0.11e2 / 0.27e2 * t34 * sigma[2] * t758 * t126 + t201 * t314 * t765 * t321 / 0.24e2 - t528 * t774 * t776 / 0.162e3 + 0.11e2 / 0.27e2 * t130 * t781 - t330 * t785 / 0.24e2 + t335 * t789 / 0.24e2 + 0.2e1 / 0.9e1 * t130 * t325 * t369 + t795 * t796 * t163 / 0.162e3 - t800 * t801 * t337 / 0.162e3 - t330 * t331 * t369 / 0.108e3 + t335 * t336 * t809 / 0.108e3 + t130 * t131 * t817 / 0.12e2 - t130 * t131 * t868 / 0.24e2;
  t877 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t748 * t167 - t706 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t303 * t373 + t662 - t713 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t872);
  tv2rho22 = 0.2e1 * t297 + 0.2e1 * t378 + t6 * (t737 + t877);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t885 = t5 * t186 * t423 / 0.8e1;
  t886 = t33 * t192;
  t893 = t530 * rho[0];
  t894 = 0.1e1 / t893;
  t895 = t202 * t894;
  t901 = t200 * t206;
  t902 = t198 * t901;
  t903 = t209 * t55;
  t904 = t95 * sigma[0];
  t905 = t903 * t904;
  t908 = t223 * t901;
  t909 = t46 * params->c;
  t910 = t909 * t904;
  t913 = t29 * t381;
  t914 = t46 * t55;
  t915 = t231 * t258;
  t916 = t914 * t915;
  t920 = t894 * t535;
  t925 = t894 * t209;
  t941 = t568 * t418;
  t945 = t574 * t418;
  t946 = t945 * t258;
  t947 = t914 * t946;
  t951 = t57 * t406 * t234;
  t960 = t248 * t599;
  t967 = t248 * t623;
  t970 = -t951 * t91 / 0.12e2 - t951 * t244 / 0.6e1 - 0.3e1 / 0.8e1 * t413 * t255 - t951 * t596 / 0.12e2 - 0.3e1 / 0.4e1 * t413 * t960 + t951 * t608 / 0.8e1 + 0.27e2 / 0.128e3 * t951 * t619 + 0.9e1 / 0.32e2 * t413 * t967;
  t971 = t232 * t970;
  t975 = t29 * t886 * t46 / 0.9e1 - t201 * t219 * sigma[0] / 0.72e2 + t528 * t895 * t535 / 0.432e3 - t34 * t214 / 0.9e1 + t902 * t905 / 0.72e2 - t908 * t910 / 0.72e2 - t913 * t916 / 0.24e2 - t528 * t202 * t920 * t96 / 0.432e3 + t559 * t202 * t925 * t226 / 0.432e3 + t395 * t396 * t259 / 0.576e3 - t400 * t401 * t569 / 0.576e3 + t50 * t213 * t419 / 0.9e1 - t218 * t219 * t419 / 0.216e3 + t224 * t225 * t941 / 0.216e3 + t43 * t947 / 0.12e2 - t50 * t51 * t971 / 0.24e2;
  t980 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t423 - t885 - 0.3e1 / 0.8e1 * t5 * t27 * t975);
  tv2rhosigma0 = t6 * t980 + t427;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t987 = t5 * t279 * t470 / 0.8e1;
  t989 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t470 - t987);
  tv2rhosigma2 = t6 * t989 + t474;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t995 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t423 - t885);
  tv2rhosigma3 = t6 * t995 + t427;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1000 = t33 * t309;
  t1007 = t771 * rho[1];
  t1008 = 0.1e1 / t1007;
  t1009 = t314 * t1008;
  t1015 = t200 * t318;
  t1016 = t198 * t1015;
  t1017 = t321 * t134;
  t1018 = t162 * sigma[2];
  t1019 = t1017 * t1018;
  t1022 = t223 * t1015;
  t1023 = t126 * params->c;
  t1024 = t1023 * t1018;
  t1027 = t29 * t428;
  t1028 = t126 * t134;
  t1029 = t342 * t368;
  t1030 = t1028 * t1029;
  t1034 = t1008 * t776;
  t1055 = t808 * t465;
  t1059 = t814 * t465;
  t1060 = t1059 * t368;
  t1061 = t1028 * t1060;
  t1065 = t57 * t453 * t345;
  t1074 = t358 * t839;
  t1081 = t358 * t863;
  t1084 = -t1065 * t158 / 0.12e2 - t1065 * t354 / 0.6e1 - 0.3e1 / 0.8e1 * t460 * t365 - t1065 * t836 / 0.12e2 - 0.3e1 / 0.4e1 * t460 * t1074 + t1065 * t848 / 0.8e1 + 0.27e2 / 0.128e3 * t1065 * t859 + 0.9e1 / 0.32e2 * t460 * t1081;
  t1085 = t343 * t1084;
  t1089 = t29 * t1000 * t126 / 0.9e1 - t201 * t331 * sigma[2] / 0.72e2 + t528 * t1009 * t776 / 0.432e3 - t34 * t326 / 0.9e1 + t1016 * t1019 / 0.72e2 - t1022 * t1024 / 0.72e2 - t1027 * t1030 / 0.24e2 - t528 * t314 * t1034 * t163 / 0.432e3 + t559 * t314 * t1008 * t321 * t337 / 0.432e3 + t442 * t443 * t369 / 0.576e3 - t447 * t448 * t809 / 0.576e3 + t130 * t325 * t466 / 0.9e1 - t330 * t331 * t466 / 0.216e3 + t335 * t336 * t1055 / 0.216e3 + t123 * t1061 / 0.12e2 - t130 * t131 * t1085 / 0.24e2;
  t1094 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t470 - t987 - 0.3e1 / 0.8e1 * t5 * t114 * t1089);
  tv2rhosigma5 = t6 * t1094 + t474;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1096 = t200 * t387;
  t1100 = 0.1e1 / t530;
  t1101 = sigma[0] * t1100;
  t1107 = t223 * t200;
  t1110 = t231 * t418;
  t1111 = t914 * t1110;
  t1115 = t1100 * t535;
  t1130 = t418 * t418;
  t1131 = t575 * t1130;
  t1137 = t58 / t59 / sigma[0];
  t1139 = t57 * t1137 * t62;
  t1144 = t57 * t1137;
  t1145 = t414 * t599;
  t1152 = t414 * t623;
  t1155 = -t1139 * t91 / 0.32e2 + t1139 * t596 / 0.32e2 + 0.9e1 / 0.32e2 * t1144 * t1145 - 0.3e1 / 0.64e2 * t1139 * t608 - 0.81e2 / 0.1024e4 * t1139 * t619 - 0.27e2 / 0.256e3 * t1144 * t1152;
  t1156 = t232 * t1155;
  t1160 = t198 * t1096 * t209 / 0.288e3 - t528 * t1101 * t535 / 0.1152e4 - t201 * t397 / 0.288e3 + t1107 * t402 / 0.288e3 - t913 * t1111 / 0.12e2 + t528 * sigma[0] * t1115 * t96 / 0.1152e4 - t559 * sigma[0] * t1100 * t209 * t226 / 0.1152e4 + t395 * t396 * t419 / 0.288e3 - t400 * t401 * t941 / 0.288e3 + t50 * t51 * t1131 / 0.12e2 - t50 * t51 * t1156 / 0.24e2;
  t1164 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1160);
  tv2sigma20 = t6 * t1164;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1165 = t200 * t434;
  t1169 = 0.1e1 / t771;
  t1170 = sigma[2] * t1169;
  t1178 = t342 * t465;
  t1179 = t1028 * t1178;
  t1183 = t1169 * t776;
  t1198 = t465 * t465;
  t1199 = t815 * t1198;
  t1205 = t58 / t135 / sigma[2];
  t1207 = t57 * t1205 * t138;
  t1212 = t57 * t1205;
  t1213 = t461 * t839;
  t1220 = t461 * t863;
  t1223 = -t1207 * t158 / 0.32e2 + t1207 * t836 / 0.32e2 + 0.9e1 / 0.32e2 * t1212 * t1213 - 0.3e1 / 0.64e2 * t1207 * t848 - 0.81e2 / 0.1024e4 * t1207 * t859 - 0.27e2 / 0.256e3 * t1212 * t1220;
  t1224 = t343 * t1223;
  t1228 = t198 * t1165 * t321 / 0.288e3 - t528 * t1170 * t776 / 0.1152e4 - t201 * t444 / 0.288e3 + t1107 * t449 / 0.288e3 - t1027 * t1179 / 0.12e2 + t528 * sigma[2] * t1183 * t163 / 0.1152e4 - t559 * sigma[2] * t1169 * t321 * t337 / 0.1152e4 + t442 * t443 * t466 / 0.288e3 - t447 * t448 * t1055 / 0.288e3 + t130 * t131 * t1199 / 0.12e2 - t130 * t131 * t1224 / 0.24e2;
  t1232 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t1228);
  tv2sigma25 = t6 * t1232;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1236 = 0.1e1 / t477 / t19;
  t1237 = t479 * t176;
  t1240 = t478 * t176;
  t1243 = t172 * t172;
  t1244 = 0.1e1 / t1243;
  t1245 = t16 * t1244;
  t1248 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t483 - 0.6e1 * t1245);
  t1252 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1236 * t1237 + 0.4e1 / 0.3e1 * t1240 * t487 + 0.4e1 / 0.3e1 * t23 * t1248);
  t1253 = t1252 * t26;
  t1257 = t491 * t185;
  t1259 = t5 * t1257 * t100;
  t1264 = t179 * t504;
  t1266 = t5 * t1264 * t100;
  t1269 = t5 * t496 * t263;
  t1275 = 0.1e1 / t184 / t172;
  t1276 = t25 * t1275;
  t1279 = 0.5e1 / 0.36e2 * t5 * t1276 * t100;
  t1281 = t5 * t505 * t263;
  t1284 = t5 * t186 * t632;
  t1287 = 0.1e1 / t37 / t385;
  t1288 = t1287 * t46;
  t1289 = t1288 * t96;
  t1292 = t528 * t533;
  t1293 = t535 * t55;
  t1294 = t1293 * t915;
  t1297 = t559 * t533;
  t1298 = t209 * params->c;
  t1299 = t1298 * t915;
  t1303 = 0.1e1 / t36 / t530;
  t1304 = t1303 * t209;
  t1308 = t1303 * t46;
  t1312 = params->c * t574;
  t1313 = t1312 * t576;
  t1317 = t230 * t230;
  t1318 = 0.1e1 / t1317;
  t1319 = t55 * t1318;
  t1320 = t576 * t258;
  t1321 = t1319 * t1320;
  t1331 = t568 * t627;
  t1332 = t225 * t1331;
  t1338 = t197 * t197;
  t1339 = t1338 * t527;
  t1340 = t202 * t202;
  t1341 = t530 * t385;
  t1343 = 0.1e1 / t37 / t1341;
  t1344 = t1340 * t1343;
  t1346 = t208 * t208;
  t1347 = 0.1e1 / t1346;
  t1350 = t95 * t28 * t33;
  t1351 = t1347 * t55 * t1350;
  t1354 = -0.154e3 / 0.81e2 * t50 * t1289 - t1292 * t1294 / 0.54e2 + t1297 * t1299 / 0.54e2 + 0.341e3 / 0.972e3 * t218 * t1304 * t96 - 0.341e3 / 0.972e3 * t224 * t1308 * t226 - t224 * t225 * t1313 / 0.36e2 - t50 * t51 * t1321 / 0.4e1 + t218 * t219 * t577 / 0.36e2 - 0.2e1 / 0.3e1 * t50 * t213 * t577 + t224 * t1332 / 0.72e2 - t218 * t219 * t628 / 0.72e2 + t1339 * t1344 * t1351 / 0.486e3;
  t1357 = t535 * params->c * t1350;
  t1372 = t1339 * t1340;
  t1374 = t28 * t33;
  t1378 = t530 * t190;
  t1379 = 0.1e1 / t1378;
  t1380 = t1379 * t535;
  t1392 = t529 * t1379;
  t1397 = 0.1e1 / t36 / t203;
  t1399 = t57 * t60 * t1397;
  t1400 = t249 * t249;
  t1403 = t88 * t88;
  t1405 = 0.1e1 / t251 / t1403;
  t1406 = t65 * t81 * t1400 * t1405;
  t1409 = t1406 * t606 * t66 * t68;
  t1414 = t65 * t80 * t1400 * t615;
  t1415 = t593 * t593;
  t1416 = 0.1e1 / t1415;
  t1418 = t1416 * t2 * t83;
  t1419 = t1414 * t1418;
  t1423 = t239 * t240 * t606;
  t1427 = t239 * t604 * t1416;
  t1432 = t616 * t606 * t2 * t83;
  t1436 = t81 * t249 * t89;
  t1438 = 0.1e1 / t1415 / t241;
  t1440 = t239 * t1436 * t1438;
  t1451 = t1397 * t65;
  t1452 = t1400 * t252;
  t1453 = t1452 * t1438;
  t1454 = t1451 * t1453;
  t1457 = t1451 * t599;
  t1460 = t1451 * t623;
  t1463 = t253 * t606;
  t1464 = t1451 * t1463;
  t1467 = t622 * t1416;
  t1468 = t1451 * t1467;
  t1471 = t1451 * t254;
  t1476 = -0.63e2 / 0.16e2 * t1399 * t1409 - 0.27e2 / 0.8e1 * t1399 * t1419 - 0.8e1 / 0.27e2 * t1399 * t1423 + 0.2e1 * t1399 * t1427 + 0.27e2 / 0.4e1 * t1399 * t1432 - 0.2e1 * t1399 * t1440 - 0.23e2 / 0.9e1 * t1399 * t244 - 0.14e2 / 0.9e1 * t1399 * t596 + 0.7e1 / 0.3e1 * t1399 * t608 + 0.63e2 / 0.16e2 * t1399 * t619 - 0.9e1 / 0.2e1 * t247 * t1454 - 0.14e2 * t247 * t1457 + 0.21e2 / 0.4e1 * t247 * t1460 - 0.26e2 / 0.3e1 * t247 * t1464 + 0.27e2 / 0.2e1 * t247 * t1468 - 0.23e2 / 0.4e1 * t247 * t1471 - 0.35e2 / 0.27e2 * t1399 * t91;
  t1477 = t232 * t1476;
  t1486 = t574 * t258 * t627;
  t1487 = t914 * t1486;
  t1490 = -t528 * t1344 * t1357 / 0.486e3 + t218 * t543 * t259 / 0.8e1 - t224 * t547 * t569 / 0.8e1 + t50 * t213 * t628 / 0.3e1 - 0.11e2 / 0.9e1 * t50 * t539 * t259 - t1372 * t1343 * t1347 * t1374 / 0.486e3 - 0.19e2 / 0.162e3 * t554 * t1380 * t96 + 0.19e2 / 0.162e3 * t560 * t1379 * t209 * t226 + 0.154e3 / 0.81e2 * t34 * sigma[0] * t1287 * t46 + 0.19e2 / 0.162e3 * t528 * t1392 * t535 - t50 * t51 * t1477 / 0.24e2 - 0.341e3 / 0.972e3 * t201 * t202 * t1303 * t209 + t43 * t1487 / 0.4e1;
  t1491 = t1354 + t1490;
  t1496 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1253 * t100 - 0.3e1 / 0.8e1 * t1259 - 0.9e1 / 0.8e1 * t5 * t492 * t263 + t1266 / 0.4e1 - 0.3e1 / 0.4e1 * t1269 - 0.9e1 / 0.8e1 * t5 * t180 * t632 - t1279 + t1281 / 0.4e1 - 0.3e1 / 0.8e1 * t1284 - 0.3e1 / 0.8e1 * t5 * t27 * t1491);
  t1498 = 0.1e1 / t638 / t109;
  t1499 = t640 * t271;
  t1502 = t639 * t271;
  t1505 = t106 * t1244;
  t1508 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t483 - 0.6e1 * t1505);
  t1512 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1498 * t1499 + 0.4e1 / 0.3e1 * t1502 * t646 + 0.4e1 / 0.3e1 * t111 * t1508);
  t1513 = t1512 * t26;
  t1517 = t650 * t185;
  t1519 = t5 * t1517 * t167;
  t1521 = t274 * t504;
  t1523 = t5 * t1521 * t167;
  t1525 = t113 * t1275;
  t1528 = 0.5e1 / 0.36e2 * t5 * t1525 * t167;
  t1530 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t1513 * t167 - 0.3e1 / 0.8e1 * t1519 + t1523 / 0.4e1 - t1528);
  tv3rho30 = 0.3e1 * t637 + 0.3e1 * t664 + t6 * (t1496 + t1530);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1533 = 0.2e1 * t690;
  t1534 = 0.2e1 * t716;
  t1535 = t1236 * t288;
  t1538 = t478 * t671;
  t1543 = 0.2e1 * t483;
  t1544 = 0.6e1 * t1245;
  t1546 = my_piecewise5(t10, 0, t14, 0, t1543 - t1544);
  t1550 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1535 * t479 + 0.8e1 / 0.9e1 * t1538 * t176 + 0.4e1 / 0.9e1 * t667 * t487 + 0.4e1 / 0.3e1 * t23 * t1546);
  t1551 = t1550 * t26;
  t1555 = t675 * t185;
  t1558 = t5 * t1555 * t100 / 0.4e1;
  t1562 = t291 * t504;
  t1564 = t5 * t1562 * t100;
  t1568 = t5 * t680 * t263 / 0.4e1;
  t1577 = -0.3e1 / 0.8e1 * t5 * t1551 * t100 - t1558 - 0.3e1 / 0.4e1 * t5 * t676 * t263 + t1564 / 0.12e2 - t1568 - 0.3e1 / 0.8e1 * t5 * t292 * t632 - t1259 / 0.8e1 + t1266 / 0.6e1 - t1269 / 0.4e1 - t1279 + t1281 / 0.6e1 - t1284 / 0.8e1;
  t1578 = my_piecewise3(t1, 0, t1577);
  t1579 = t1498 * t299;
  t1582 = t639 * t695;
  t1587 = 0.6e1 * t1505;
  t1589 = my_piecewise5(t14, 0, t10, 0, -t1543 - t1587);
  t1593 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1579 * t640 + 0.8e1 / 0.9e1 * t1582 * t271 + 0.4e1 / 0.9e1 * t691 * t646 + 0.4e1 / 0.3e1 * t111 * t1589);
  t1594 = t1593 * t26;
  t1598 = t699 * t185;
  t1601 = t5 * t1598 * t167 / 0.4e1;
  t1602 = t302 * t504;
  t1604 = t5 * t1602 * t167;
  t1613 = t5 * t655 * t373 / 0.4e1;
  t1615 = t5 * t659 * t373;
  t1618 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t1594 * t167 - t1601 + t1604 / 0.12e2 - t1519 / 0.8e1 + t1523 / 0.6e1 - t1528 - 0.3e1 / 0.8e1 * t5 * t651 * t373 - t1613 + t1615 / 0.12e2);
  tv3rho31 = t637 + t664 + t1533 + t1534 + t6 * (t1578 + t1618);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1621 = t1236 * t721;
  t1626 = t478 * t726;
  t1630 = my_piecewise5(t10, 0, t14, 0, -t1543 - t1544);
  t1634 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1621 * t176 + 0.8e1 / 0.9e1 * t667 * t671 + 0.4e1 / 0.9e1 * t1626 * t176 + 0.4e1 / 0.3e1 * t23 * t1630);
  t1635 = t1634 * t26;
  t1639 = t730 * t185;
  t1641 = t5 * t1639 * t100;
  t1650 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1635 * t100 - t1641 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t731 * t263 - t1558 + t1564 / 0.6e1 - t1568 + t1266 / 0.12e2 - t1279 + t1281 / 0.12e2);
  t1651 = t1498 * t738;
  t1656 = t639 * t743;
  t1660 = my_piecewise5(t14, 0, t10, 0, t1543 - t1587);
  t1664 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1651 * t271 + 0.8e1 / 0.9e1 * t691 * t695 + 0.4e1 / 0.9e1 * t1656 * t271 + 0.4e1 / 0.3e1 * t111 * t1660);
  t1665 = t1664 * t26;
  t1669 = t747 * t185;
  t1671 = t5 * t1669 * t167;
  t1678 = t5 * t704 * t373;
  t1686 = t5 * t279 * t872;
  t1688 = -0.3e1 / 0.8e1 * t5 * t1665 * t167 - t1671 / 0.8e1 - t1601 + t1604 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t700 * t373 - t1678 / 0.4e1 + t1523 / 0.12e2 - t1528 - t1613 + t1615 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t275 * t872 - t1686 / 0.8e1;
  t1689 = my_piecewise3(t105, 0, t1688);
  tv3rho32 = t1533 + t1534 + t737 + t877 + t6 * (t1650 + t1689);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1694 = t721 * t288;
  t1701 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t483 - 0.6e1 * t1245);
  t1705 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1236 * t1694 + 0.4e1 / 0.3e1 * t667 * t726 + 0.4e1 / 0.3e1 * t23 * t1701);
  t1706 = t1705 * t26;
  t1713 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1706 * t100 - 0.3e1 / 0.8e1 * t1641 + t1564 / 0.4e1 - t1279);
  t1714 = t738 * t299;
  t1721 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t483 - 0.6e1 * t1505);
  t1725 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1498 * t1714 + 0.4e1 / 0.3e1 * t691 * t743 + 0.4e1 / 0.3e1 * t111 * t1721);
  t1726 = t1725 * t26;
  t1741 = t314 * t314;
  t1742 = t1339 * t1741;
  t1743 = t771 * t432;
  t1745 = 0.1e1 / t117 / t1743;
  t1746 = t320 * t320;
  t1747 = 0.1e1 / t1746;
  t1752 = t771 * t307;
  t1753 = 0.1e1 / t1752;
  t1754 = t1753 * t776;
  t1763 = t814 * t368 * t867;
  t1764 = t1028 * t1763;
  t1768 = 0.1e1 / t117 / t432;
  t1769 = t1768 * t126;
  t1770 = t1769 * t163;
  t1773 = t528 * t774;
  t1774 = t776 * t134;
  t1775 = t1774 * t1029;
  t1778 = t559 * t774;
  t1779 = t321 * params->c;
  t1780 = t1779 * t1029;
  t1784 = 0.1e1 / t116 / t771;
  t1785 = t1784 * t321;
  t1789 = t1784 * t126;
  t1793 = t770 * t1753;
  t1805 = -t1742 * t1745 * t1747 * t1374 / 0.486e3 - 0.19e2 / 0.162e3 * t795 * t1754 * t163 + 0.19e2 / 0.162e3 * t800 * t1753 * t321 * t337 + t123 * t1764 / 0.4e1 - 0.154e3 / 0.81e2 * t130 * t1770 - t1773 * t1775 / 0.54e2 + t1778 * t1780 / 0.54e2 + 0.341e3 / 0.972e3 * t330 * t1785 * t163 - 0.341e3 / 0.972e3 * t335 * t1789 * t337 + 0.19e2 / 0.162e3 * t528 * t1793 * t776 + 0.154e3 / 0.81e2 * t34 * sigma[2] * t1768 * t126 - 0.341e3 / 0.972e3 * t201 * t314 * t1784 * t321;
  t1807 = 0.1e1 / t116 / t315;
  t1809 = t57 * t136 * t1807;
  t1810 = t359 * t359;
  t1813 = t155 * t155;
  t1815 = 0.1e1 / t361 / t1813;
  t1816 = t65 * t150 * t1810 * t1815;
  t1819 = t1816 * t846 * t66 * t68;
  t1824 = t65 * t149 * t1810 * t855;
  t1825 = t833 * t833;
  t1826 = 0.1e1 / t1825;
  t1828 = t1826 * t2 * t83;
  t1829 = t1824 * t1828;
  t1833 = t239 * t350 * t846;
  t1837 = t239 * t844 * t1826;
  t1842 = t856 * t846 * t2 * t83;
  t1846 = t150 * t359 * t156;
  t1848 = 0.1e1 / t1825 / t351;
  t1850 = t239 * t1846 * t1848;
  t1863 = t1807 * t65;
  t1864 = t1810 * t362;
  t1865 = t1864 * t1848;
  t1866 = t1863 * t1865;
  t1869 = t1863 * t863;
  t1872 = t363 * t846;
  t1873 = t1863 * t1872;
  t1876 = t862 * t1826;
  t1877 = t1863 * t1876;
  t1880 = t1863 * t364;
  t1883 = t1863 * t839;
  t1886 = -0.63e2 / 0.16e2 * t1809 * t1819 - 0.27e2 / 0.8e1 * t1809 * t1829 - 0.8e1 / 0.27e2 * t1809 * t1833 + 0.2e1 * t1809 * t1837 + 0.27e2 / 0.4e1 * t1809 * t1842 - 0.2e1 * t1809 * t1850 - 0.23e2 / 0.9e1 * t1809 * t354 - 0.14e2 / 0.9e1 * t1809 * t836 + 0.7e1 / 0.3e1 * t1809 * t848 + 0.63e2 / 0.16e2 * t1809 * t859 - 0.35e2 / 0.27e2 * t1809 * t158 - 0.9e1 / 0.2e1 * t357 * t1866 + 0.21e2 / 0.4e1 * t357 * t1869 - 0.26e2 / 0.3e1 * t357 * t1873 + 0.27e2 / 0.2e1 * t357 * t1877 - 0.23e2 / 0.4e1 * t357 * t1880 - 0.14e2 * t357 * t1883;
  t1887 = t343 * t1886;
  t1891 = t331 * t868;
  t1894 = t808 * t867;
  t1895 = t336 * t1894;
  t1898 = t1741 * t1745;
  t1902 = t162 * t28 * t33;
  t1903 = t1747 * t134 * t1902;
  t1908 = t776 * params->c * t1902;
  t1923 = params->c * t814;
  t1924 = t1923 * t816;
  t1928 = t341 * t341;
  t1929 = 0.1e1 / t1928;
  t1930 = t134 * t1929;
  t1931 = t816 * t368;
  t1932 = t1930 * t1931;
  t1942 = -t130 * t131 * t1887 / 0.24e2 - t330 * t1891 / 0.72e2 + t335 * t1895 / 0.72e2 + t1339 * t1898 * t1903 / 0.486e3 - t528 * t1898 * t1908 / 0.486e3 - t335 * t788 * t809 / 0.8e1 + t130 * t325 * t868 / 0.3e1 - 0.11e2 / 0.9e1 * t130 * t780 * t369 + t330 * t784 * t369 / 0.8e1 - t335 * t336 * t1924 / 0.36e2 - t130 * t131 * t1932 / 0.4e1 + t330 * t331 * t817 / 0.36e2 - 0.2e1 / 0.3e1 * t130 * t325 * t817;
  t1943 = t1805 + t1942;
  t1948 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t1726 * t167 - 0.3e1 / 0.8e1 * t1671 - 0.9e1 / 0.8e1 * t5 * t748 * t373 + t1604 / 0.4e1 - 0.3e1 / 0.4e1 * t1678 - 0.9e1 / 0.8e1 * t5 * t303 * t872 - t1528 + t1615 / 0.4e1 - 0.3e1 / 0.8e1 * t1686 - 0.3e1 / 0.8e1 * t5 * t114 * t1943);
  tv3rho33 = 0.3e1 * t737 + 0.3e1 * t877 + t6 * (t1713 + t1948);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1956 = t5 * t496 * t423;
  t1963 = t5 * t505 * t423 / 0.12e2;
  t1965 = t5 * t186 * t975;
  t1970 = t530 * t203;
  t1972 = 0.1e1 / t37 / t1970;
  t1974 = t1972 * t1347 * t1374;
  t1977 = t528 * t532;
  t1978 = t95 * t202;
  t1979 = t1293 * t1978;
  t1982 = t559 * t532;
  t1983 = t1298 * t1978;
  t1987 = t29 * t41 * t192;
  t1990 = t945 * t627;
  t1991 = t914 * t1990;
  t1994 = t217 * t206;
  t1995 = t223 * t1994;
  t1996 = t909 * t946;
  t1999 = t198 * t1994;
  t2000 = t903 * t946;
  t2003 = t574 * t970;
  t2004 = t2003 * t258;
  t2005 = t914 * t2004;
  t2009 = t1318 * t418 * t576;
  t2010 = t914 * t2009;
  t2013 = t200 * t520;
  t2014 = t223 * t2013;
  t2017 = t231 * t627;
  t2018 = t914 * t2017;
  t2021 = t574 * t576;
  t2022 = t914 * t2021;
  t2025 = t1293 * t1110;
  t2028 = t1298 * t1110;
  t2031 = t528 * t895;
  t2034 = t559 * t895;
  t2037 = t29 * t886;
  t2040 = 0.11e2 / 0.27e2 * t34 * t540 + t1339 * t529 * t1974 / 0.1296e4 + 0.17e2 / 0.432e3 * t1977 * t1979 - 0.17e2 / 0.432e3 * t1982 * t1983 - 0.4e1 / 0.9e1 * t1987 * t947 + t43 * t1991 / 0.12e2 - t1995 * t1996 / 0.54e2 + t1999 * t2000 / 0.54e2 + t43 * t2005 / 0.6e1 - t43 * t2010 / 0.4e1 + 0.65e2 / 0.648e3 * t2014 * t910 - t913 * t2018 / 0.24e2 + t913 * t2022 / 0.12e2 - t1292 * t2025 / 0.162e3 + t1297 * t2028 / 0.162e3 + t2031 * t1294 / 0.216e3 - t2034 * t1299 / 0.216e3 + 0.2e1 / 0.9e1 * t2037 * t916;
  t2041 = t198 * t2013;
  t2053 = t529 * t1972;
  t2064 = t231 * sigma[0] * t258;
  t2065 = t903 * t2064;
  t2068 = t909 * t2064;
  t2083 = t33 * t513;
  t2094 = t57 * t406 * t582;
  t2117 = t589 * t1467;
  t2120 = t589 * t1453;
  t2129 = t589 * t1463;
  t2132 = 0.3e1 / 0.4e1 * t2094 * t1440 + 0.189e3 / 0.128e3 * t2094 * t1409 + 0.81e2 / 0.64e2 * t2094 * t1419 - 0.135e3 / 0.128e3 * t2094 * t619 + t2094 * t1423 / 0.9e1 - 0.3e1 / 0.4e1 * t2094 * t1427 - 0.81e2 / 0.32e2 * t2094 * t1432 + 0.7e1 / 0.36e2 * t2094 * t91 + t2094 * t244 / 0.2e1 + 0.5e1 / 0.12e2 * t2094 * t596 - 0.5e1 / 0.8e1 * t2094 * t608 - 0.81e2 / 0.16e2 * t413 * t2117 + 0.27e2 / 0.16e2 * t413 * t2120 + 0.9e1 / 0.8e1 * t413 * t590 + 0.15e2 / 0.4e1 * t413 * t600 - 0.45e2 / 0.32e2 * t413 * t624 + 0.13e2 / 0.4e1 * t413 * t2129;
  t2133 = t232 * t2132;
  t2137 = t568 * t970;
  t2138 = t225 * t2137;
  t2141 = t219 * t971;
  t2144 = -0.65e2 / 0.648e3 * t2041 * t905 + t400 * t401 * t1313 / 0.288e3 - 0.11e2 / 0.27e2 * t50 * t539 * t419 - t395 * t396 * t577 / 0.288e3 - t1339 * t2053 * t1351 / 0.1296e4 + t528 * t2053 * t1357 / 0.1296e4 + t395 * t396 * t628 / 0.576e3 - t902 * t2065 / 0.36e2 + t908 * t2068 / 0.36e2 + 0.2e1 / 0.9e1 * t50 * t213 * t971 + t218 * t543 * t419 / 0.24e2 - t224 * t547 * t941 / 0.24e2 - t400 * t401 * t1331 / 0.576e3 - 0.11e2 / 0.27e2 * t29 * t2083 * t46 - 0.17e2 / 0.432e3 * t528 * t555 * t202 + 0.65e2 / 0.648e3 * t201 * t543 * sigma[0] - t50 * t51 * t2133 / 0.24e2 + t224 * t2138 / 0.108e3 - t218 * t2141 / 0.108e3;
  t2145 = t2040 + t2144;
  t2150 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t492 * t423 - t1956 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t180 * t975 + t1963 - t1965 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t2145);
  tv3rho2sigma0 = t6 * t2150 + 0.2e1 * t980;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2157 = t5 * t655 * t470;
  t2161 = t5 * t659 * t470 / 0.12e2;
  t2163 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t651 * t470 - t2157 / 0.4e1 + t2161);
  tv3rho2sigma2 = t6 * t2163 + 0.2e1 * t989;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2169 = t5 * t680 * t423;
  t2177 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t676 * t423 - t2169 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t292 * t975 - t1956 / 0.8e1 + t1963 - t1965 / 0.8e1);
  tv3rho2sigma3 = t6 * t2177 + t980 + t995;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2183 = t5 * t704 * t470;
  t2190 = t5 * t279 * t1089;
  t2193 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t700 * t470 - t2183 / 0.8e1 - t2157 / 0.8e1 + t2161 - 0.3e1 / 0.8e1 * t5 * t275 * t1089 - t2190 / 0.8e1);
  tv3rho2sigma5 = t6 * t2193 + t1094 + t989;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2201 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t731 * t423 - t2169 / 0.4e1 + t1963);
  tv3rho2sigma6 = t6 * t2201 + 0.2e1 * t995;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2215 = t771 * t315;
  t2217 = 0.1e1 / t117 / t2215;
  t2222 = t528 * t773;
  t2223 = t162 * t314;
  t2224 = t1774 * t2223;
  t2227 = t559 * t773;
  t2228 = t1779 * t2223;
  t2249 = t770 * t2217;
  t2260 = t342 * sigma[2] * t368;
  t2261 = t1017 * t2260;
  t2264 = t1023 * t2260;
  t2267 = t814 * t816;
  t2268 = t1028 * t2267;
  t2271 = t1774 * t1178;
  t2274 = t1779 * t1178;
  t2277 = 0.11e2 / 0.27e2 * t34 * t781 + t1339 * t770 * t2217 * t1747 * t1374 / 0.1296e4 + 0.17e2 / 0.432e3 * t2222 * t2224 - 0.17e2 / 0.432e3 * t2227 * t2228 - 0.11e2 / 0.27e2 * t130 * t780 * t466 - t442 * t443 * t817 / 0.288e3 + t447 * t448 * t1924 / 0.288e3 + t330 * t784 * t466 / 0.24e2 - t335 * t788 * t1055 / 0.24e2 - t447 * t448 * t1894 / 0.576e3 + t528 * t2249 * t1908 / 0.1296e4 + t442 * t443 * t868 / 0.576e3 - t1339 * t2249 * t1903 / 0.1296e4 - t1016 * t2261 / 0.36e2 + t1022 * t2264 / 0.36e2 + t1027 * t2268 / 0.12e2 - t1773 * t2271 / 0.162e3 + t1778 * t2274 / 0.162e3;
  t2278 = t342 * t867;
  t2279 = t1028 * t2278;
  t2282 = t528 * t1009;
  t2285 = t559 * t1009;
  t2288 = t29 * t1000;
  t2291 = t200 * t765;
  t2292 = t198 * t2291;
  t2295 = t223 * t2291;
  t2299 = t57 * t453 * t822;
  t2322 = t829 * t1865;
  t2329 = t829 * t1872;
  t2332 = t829 * t1876;
  t2337 = 0.189e3 / 0.128e3 * t2299 * t1819 + 0.81e2 / 0.64e2 * t2299 * t1829 - 0.3e1 / 0.4e1 * t2299 * t1837 - 0.81e2 / 0.32e2 * t2299 * t1842 + 0.3e1 / 0.4e1 * t2299 * t1850 + t2299 * t354 / 0.2e1 + 0.5e1 / 0.12e2 * t2299 * t836 - 0.5e1 / 0.8e1 * t2299 * t848 - 0.135e3 / 0.128e3 * t2299 * t859 + t2299 * t1833 / 0.9e1 + 0.7e1 / 0.36e2 * t2299 * t158 + 0.27e2 / 0.16e2 * t460 * t2322 + 0.15e2 / 0.4e1 * t460 * t840 - 0.45e2 / 0.32e2 * t460 * t864 + 0.13e2 / 0.4e1 * t460 * t2329 - 0.81e2 / 0.16e2 * t460 * t2332 + 0.9e1 / 0.8e1 * t460 * t830;
  t2338 = t343 * t2337;
  t2345 = t808 * t1084;
  t2346 = t336 * t2345;
  t2352 = t329 * t318;
  t2353 = t198 * t2352;
  t2354 = t1017 * t1060;
  t2358 = t29 * t121 * t309;
  t2361 = t814 * t1084;
  t2362 = t2361 * t368;
  t2363 = t1028 * t2362;
  t2366 = t1059 * t867;
  t2367 = t1028 * t2366;
  t2370 = t223 * t2352;
  t2371 = t1023 * t1060;
  t2375 = t1929 * t465 * t816;
  t2376 = t1028 * t2375;
  t2382 = t33 * t758;
  t2389 = -t1027 * t2279 / 0.24e2 + t2282 * t1775 / 0.216e3 - t2285 * t1780 / 0.216e3 + 0.2e1 / 0.9e1 * t2288 * t1030 - 0.65e2 / 0.648e3 * t2292 * t1019 + 0.65e2 / 0.648e3 * t2295 * t1024 - t130 * t131 * t2338 / 0.24e2 - t330 * t331 * t1085 / 0.108e3 + t335 * t2346 / 0.108e3 + 0.2e1 / 0.9e1 * t130 * t325 * t1085 + t2353 * t2354 / 0.54e2 - 0.4e1 / 0.9e1 * t2358 * t1061 + t123 * t2363 / 0.6e1 + t123 * t2367 / 0.12e2 - t2370 * t2371 / 0.54e2 - t123 * t2376 / 0.4e1 + 0.65e2 / 0.648e3 * t201 * t784 * sigma[2] - 0.11e2 / 0.27e2 * t29 * t2382 * t126 - 0.17e2 / 0.432e3 * t528 * t796 * t314;
  t2390 = t2277 + t2389;
  t2395 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t748 * t470 - t2183 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t303 * t1089 + t2161 - t2190 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t2390);
  tv3rho2sigma8 = t6 * t2395 + 0.2e1 * t1094;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2402 = t5 * t186 * t1160 / 0.8e1;
  t2403 = t1339 * t202;
  t2405 = 0.1e1 / t37 / t1378;
  t2410 = t528 * t894;
  t2411 = t1293 * t904;
  t2414 = t559 * t894;
  t2415 = t1298 * t904;
  t2431 = t1110 * sigma[0];
  t2432 = t903 * t2431;
  t2435 = t909 * t2431;
  t2438 = t202 * t2405;
  t2450 = t219 * t1156;
  t2453 = t568 * t1155;
  t2454 = t225 * t2453;
  t2457 = t219 * t1131;
  t2460 = -t2403 * t2405 * t1347 * t1374 / 0.3456e4 - 0.5e1 / 0.432e3 * t2410 * t2411 + 0.5e1 / 0.432e3 * t2414 * t2415 + t201 * t220 / 0.54e2 - t1107 * t227 / 0.54e2 - 0.2e1 / 0.9e1 * t50 * t213 * t1131 + t395 * t396 * t971 / 0.288e3 - t400 * t401 * t2137 / 0.288e3 - t902 * t2432 / 0.36e2 + t908 * t2435 / 0.36e2 + t1339 * t2438 * t1351 / 0.3456e4 - t528 * t2438 * t1357 / 0.3456e4 + t913 * t947 / 0.6e1 + t50 * t213 * t1156 / 0.9e1 - t218 * t2450 / 0.216e3 + t224 * t2454 / 0.216e3 + t218 * t2457 / 0.108e3;
  t2461 = t1312 * t1130;
  t2462 = t225 * t2461;
  t2466 = t57 * t1137 * t234;
  t2477 = t248 * t1463;
  t2486 = t248 * t1467;
  t2501 = t248 * t1453;
  t2504 = t2466 * t91 / 0.24e2 + t2466 * t244 / 0.24e2 + 0.3e1 / 0.32e2 * t1144 * t255 - t2466 * t596 / 0.24e2 - t2466 * t1423 / 0.24e2 - 0.39e2 / 0.32e2 * t1144 * t2477 + 0.9e1 / 0.32e2 * t2466 * t1427 - 0.3e1 / 0.8e1 * t1144 * t960 + 0.243e3 / 0.256e3 * t2466 * t1432 + 0.243e3 / 0.128e3 * t1144 * t2486 + t2466 * t608 / 0.16e2 - 0.9e1 / 0.32e2 * t2466 * t1440 + 0.27e2 / 0.256e3 * t2466 * t619 - 0.567e3 / 0.1024e4 * t2466 * t1409 - 0.243e3 / 0.512e3 * t2466 * t1419 + 0.9e1 / 0.64e2 * t1144 * t967 - 0.81e2 / 0.128e3 * t1144 * t2501;
  t2505 = t232 * t2504;
  t2509 = t945 * t970;
  t2510 = t914 * t2509;
  t2513 = t394 * t387;
  t2514 = t198 * t2513;
  t2517 = t574 * t1155;
  t2518 = t2517 * t258;
  t2519 = t914 * t2518;
  t2522 = t223 * t2513;
  t2525 = t1318 * t1130;
  t2526 = t2525 * t258;
  t2527 = t914 * t2526;
  t2531 = t198 * t901 * t209;
  t2538 = t528 * t1101;
  t2541 = t559 * t1101;
  t2548 = t198 * t1096;
  t2549 = t903 * t915;
  t2552 = t223 * t1096;
  t2553 = t909 * t915;
  t2556 = t231 * t970;
  t2557 = t914 * t2556;
  t2560 = -t224 * t2462 / 0.108e3 - t50 * t51 * t2505 / 0.24e2 + t43 * t2510 / 0.6e1 - t2514 * t2000 / 0.144e3 + t43 * t2519 / 0.12e2 + t2522 * t1996 / 0.144e3 - t43 * t2527 / 0.4e1 - t2531 / 0.54e2 + 0.5e1 / 0.432e3 * t528 * t920 * sigma[0] + 0.2e1 / 0.9e1 * t2037 * t1111 - t2538 * t1294 / 0.1152e4 + t2541 * t1299 / 0.1152e4 + t2031 * t2025 / 0.216e3 - t2034 * t2028 / 0.216e3 + t2548 * t2549 / 0.288e3 - t2552 * t2553 / 0.288e3 - t913 * t2557 / 0.12e2;
  t2561 = t2460 + t2560;
  t2566 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t1160 - t2402 - 0.3e1 / 0.8e1 * t5 * t27 * t2561);
  tv3rhosigma20 = t6 * t2566 + t1164;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2573 = t5 * t279 * t1228 / 0.8e1;
  t2575 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t1228 - t2573);
  tv3rhosigma25 = t6 * t2575 + t1232;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2581 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t1160 - t2402);
  tv3rhosigma26 = t6 * t2581 + t1164;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2594 = t1178 * sigma[2];
  t2595 = t1017 * t2594;
  t2598 = t1023 * t2594;
  t2602 = 0.1e1 / t117 / t1752;
  t2603 = t314 * t2602;
  t2613 = t331 * t1224;
  t2616 = t808 * t1223;
  t2617 = t336 * t2616;
  t2623 = t1923 * t1198;
  t2628 = t57 * t1205 * t345;
  t2639 = t358 * t1872;
  t2648 = t358 * t1876;
  t2663 = t358 * t1865;
  t2666 = t2628 * t158 / 0.24e2 + t2628 * t354 / 0.24e2 + 0.3e1 / 0.32e2 * t1212 * t365 - t2628 * t836 / 0.24e2 - t2628 * t1833 / 0.24e2 - 0.39e2 / 0.32e2 * t1212 * t2639 + 0.9e1 / 0.32e2 * t2628 * t1837 - 0.3e1 / 0.8e1 * t1212 * t1074 + 0.243e3 / 0.256e3 * t2628 * t1842 + 0.243e3 / 0.128e3 * t1212 * t2648 + t2628 * t848 / 0.16e2 - 0.9e1 / 0.32e2 * t2628 * t1850 + 0.27e2 / 0.256e3 * t2628 * t859 - 0.567e3 / 0.1024e4 * t2628 * t1819 - 0.243e3 / 0.512e3 * t2628 * t1829 + 0.9e1 / 0.64e2 * t1212 * t1081 - 0.81e2 / 0.128e3 * t1212 * t2663;
  t2667 = t343 * t2666;
  t2674 = t441 * t434;
  t2675 = t198 * t2674;
  t2678 = t223 * t2674;
  t2681 = t814 * t1223;
  t2682 = t2681 * t368;
  t2683 = t1028 * t2682;
  t2686 = t1027 * t1061 / 0.6e1 + t130 * t325 * t1224 / 0.9e1 - 0.2e1 / 0.9e1 * t130 * t325 * t1199 - t1016 * t2595 / 0.36e2 + t1022 * t2598 / 0.36e2 + t1339 * t2603 * t1903 / 0.3456e4 - t528 * t2603 * t1908 / 0.3456e4 + t442 * t443 * t1085 / 0.288e3 - t330 * t2613 / 0.216e3 + t335 * t2617 / 0.216e3 + t330 * t331 * t1199 / 0.108e3 - t335 * t336 * t2623 / 0.108e3 - t130 * t131 * t2667 / 0.24e2 - t447 * t448 * t2345 / 0.288e3 - t2675 * t2354 / 0.144e3 + t2678 * t2371 / 0.144e3 + t123 * t2683 / 0.12e2;
  t2687 = t1929 * t1198;
  t2688 = t2687 * t368;
  t2689 = t1028 * t2688;
  t2692 = t1059 * t1084;
  t2693 = t1028 * t2692;
  t2702 = t2602 * t1747 * t1374;
  t2705 = t528 * t1008;
  t2706 = t1774 * t1018;
  t2709 = t559 * t1008;
  t2710 = t1779 * t1018;
  t2714 = t198 * t1015 * t321;
  t2723 = t528 * t1170;
  t2726 = t559 * t1170;
  t2729 = t198 * t1165;
  t2730 = t1017 * t1029;
  t2733 = t223 * t1165;
  t2734 = t1023 * t1029;
  t2737 = t342 * t1084;
  t2738 = t1028 * t2737;
  t2743 = -t123 * t2689 / 0.4e1 + t123 * t2693 / 0.6e1 + t201 * t332 / 0.54e2 - t1107 * t338 / 0.54e2 - t1339 * t314 * t2702 / 0.3456e4 - 0.5e1 / 0.432e3 * t2705 * t2706 + 0.5e1 / 0.432e3 * t2709 * t2710 - t2714 / 0.54e2 + 0.5e1 / 0.432e3 * t528 * t1034 * sigma[2] + t2282 * t2271 / 0.216e3 - t2285 * t2274 / 0.216e3 - t2723 * t1775 / 0.1152e4 + t2726 * t1780 / 0.1152e4 + t2729 * t2730 / 0.288e3 - t2733 * t2734 / 0.288e3 - t1027 * t2738 / 0.12e2 + 0.2e1 / 0.9e1 * t2288 * t1179;
  t2744 = t2686 + t2743;
  t2749 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t1228 - t2573 - 0.3e1 / 0.8e1 * t5 * t114 * t2744);
  tv3rhosigma211 = t6 * t2749 + t1232;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2751 = t1130 * t418;
  t2752 = t1319 * t2751;
  t2756 = t945 * t1155;
  t2757 = t914 * t2756;
  t2768 = t58 / t59 / t202;
  t2770 = t57 * t2768 * t62;
  t2775 = t57 * t2768;
  t2782 = t414 * t1463;
  t2791 = t414 * t1467;
  t2806 = t414 * t1453;
  t2809 = 0.3e1 / 0.64e2 * t2770 * t91 - t2770 * t244 / 0.64e2 - 0.9e1 / 0.256e3 * t2775 * t415 - 0.3e1 / 0.64e2 * t2770 * t596 + t2770 * t1423 / 0.64e2 + 0.117e3 / 0.256e3 * t2775 * t2782 - 0.27e2 / 0.256e3 * t2770 * t1427 - 0.27e2 / 0.64e2 * t2775 * t1145 - 0.729e3 / 0.2048e4 * t2770 * t1432 - 0.729e3 / 0.1024e4 * t2775 * t2791 + 0.9e1 / 0.128e3 * t2770 * t608 + 0.27e2 / 0.256e3 * t2770 * t1440 + 0.243e3 / 0.2048e4 * t2770 * t619 + 0.1701e4 / 0.8192e4 * t2770 * t1409 + 0.729e3 / 0.4096e4 * t2770 * t1419 + 0.81e2 / 0.512e3 * t2775 * t1152 + 0.243e3 / 0.1024e4 * t2775 * t2806;
  t2810 = t232 * t2809;
  t2821 = 0.1e1 / t37 / t531;
  t2822 = sigma[0] * t2821;
  t2829 = t574 * t1130;
  t2830 = t914 * t2829;
  t2833 = t528 * t1100;
  t2834 = t1293 * t95;
  t2837 = t559 * t1100;
  t2838 = t1298 * t95;
  t2845 = t903 * t1110;
  t2848 = t909 * t1110;
  t2851 = t231 * t1155;
  t2852 = t914 * t2851;
  t2858 = t2821 * t1347;
  t2862 = -t50 * t51 * t2752 / 0.4e1 + t43 * t2757 / 0.4e1 - t395 * t396 * t1131 / 0.96e2 + t400 * t401 * t2461 / 0.96e2 - t50 * t51 * t2810 / 0.24e2 + t395 * t396 * t1156 / 0.192e3 - t400 * t401 * t2453 / 0.192e3 - t1339 * t2822 * t1351 / 0.9216e4 + t528 * t2822 * t1357 / 0.9216e4 + t913 * t2830 / 0.4e1 + t2833 * t2834 / 0.384e3 - t2837 * t2838 / 0.384e3 - t2538 * t2025 / 0.384e3 + t2541 * t2028 / 0.384e3 + t2548 * t2845 / 0.96e2 - t2552 * t2848 / 0.96e2 - t913 * t2852 / 0.8e1 - t528 * t1115 / 0.384e3 + t1339 * sigma[0] * t2858 * t1374 / 0.9216e4;
  t2866 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2862);
  tv3sigma30 = t6 * t2866;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2867 = t1339 * sigma[2];
  t2869 = 0.1e1 / t117 / t772;
  t2870 = t2869 * t1747;
  t2876 = t58 / t135 / t314;
  t2878 = t57 * t2876 * t138;
  t2883 = t57 * t2876;
  t2890 = t461 * t1872;
  t2899 = t461 * t1876;
  t2914 = t461 * t1865;
  t2917 = 0.3e1 / 0.64e2 * t2878 * t158 - t2878 * t354 / 0.64e2 - 0.9e1 / 0.256e3 * t2883 * t462 - 0.3e1 / 0.64e2 * t2878 * t836 + t2878 * t1833 / 0.64e2 + 0.117e3 / 0.256e3 * t2883 * t2890 - 0.27e2 / 0.256e3 * t2878 * t1837 - 0.27e2 / 0.64e2 * t2883 * t1213 - 0.729e3 / 0.2048e4 * t2878 * t1842 - 0.729e3 / 0.1024e4 * t2883 * t2899 + 0.9e1 / 0.128e3 * t2878 * t848 + 0.27e2 / 0.256e3 * t2878 * t1850 + 0.243e3 / 0.2048e4 * t2878 * t859 + 0.1701e4 / 0.8192e4 * t2878 * t1819 + 0.729e3 / 0.4096e4 * t2878 * t1829 + 0.81e2 / 0.512e3 * t2883 * t1220 + 0.243e3 / 0.1024e4 * t2883 * t2914;
  t2918 = t343 * t2917;
  t2925 = sigma[2] * t2869;
  t2935 = t814 * t1198;
  t2936 = t1028 * t2935;
  t2939 = t528 * t1169;
  t2940 = t1774 * t162;
  t2943 = t559 * t1169;
  t2944 = t1779 * t162;
  t2949 = t1023 * t1178;
  t2952 = t342 * t1223;
  t2953 = t1028 * t2952;
  t2958 = t1017 * t1178;
  t2963 = t1059 * t1223;
  t2964 = t1028 * t2963;
  t2970 = t1198 * t465;
  t2971 = t1930 * t2970;
  t2978 = t2867 * t2870 * t1374 / 0.9216e4 - t130 * t131 * t2918 / 0.24e2 - t447 * t448 * t2616 / 0.192e3 - t1339 * t2925 * t1903 / 0.9216e4 + t528 * t2925 * t1908 / 0.9216e4 + t442 * t443 * t1224 / 0.192e3 + t1027 * t2936 / 0.4e1 + t2939 * t2940 / 0.384e3 - t2943 * t2944 / 0.384e3 + t2726 * t2274 / 0.384e3 - t2733 * t2949 / 0.96e2 - t1027 * t2953 / 0.8e1 - t2723 * t2271 / 0.384e3 + t2729 * t2958 / 0.96e2 - t528 * t1183 / 0.384e3 + t123 * t2964 / 0.4e1 + t447 * t448 * t2623 / 0.96e2 - t130 * t131 * t2971 / 0.4e1 - t442 * t443 * t1199 / 0.96e2;
  t2982 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * t2978);
  tv3sigma39 = t6 * t2982;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2990 = t903 * t1486;
  t2993 = t909 * t1486;
  t2997 = t1339 * t1344 * t1347;
  t2999 = t232 * t1374 * t258;
  t3003 = t528 * t1344 * t535;
  t3004 = t33 * t231;
  t3006 = t52 * t3004 * t258;
  t3017 = 0.1e1 / t36 / t893;
  t3023 = 0.1e1 / t37 / t204;
  t3029 = t1338 * params->alpha * t527;
  t3030 = t1340 * sigma[0];
  t3032 = t530 * t530;
  t3035 = 0.1e1 / t36 / t3032 / rho[0];
  t3037 = 0.1e1 / t1346 / t45;
  t3039 = t56 * t200;
  t3043 = t530 * t204;
  t3045 = 0.1e1 / t37 / t3043;
  t3050 = t43 * t914 * t574 * t1476 * t258 / 0.3e1 + t1999 * t2990 / 0.9e1 - t1995 * t2993 / 0.9e1 - 0.2e1 / 0.243e3 * t2997 * t2999 + 0.2e1 / 0.243e3 * t3003 * t3006 - 0.8e1 / 0.3e1 * t1987 * t1487 - 0.3e1 / 0.2e1 * t43 * t914 * t1318 * t576 * t627 + 0.3047e4 / 0.972e3 * t201 * t202 * t3017 * t209 - 0.2618e4 / 0.243e3 * t34 * sigma[0] * t3023 * t46 - 0.2e1 / 0.2187e4 * t3029 * t3030 * t3035 * t3037 * t3039 + 0.49e2 / 0.729e3 * t1372 * t3045 * t1347 * t1374;
  t3051 = 0.1e1 / t1970;
  t3064 = t1298 * t2017;
  t3071 = t1293 * t2021;
  t3074 = t1298 * t2021;
  t3085 = t528 * t1392;
  t3088 = t559 * t1392;
  t3091 = -0.2563e4 / 0.1458e4 * t528 * t529 * t3051 * t535 + 0.2563e4 / 0.1458e4 * t554 * t3051 * t535 * t96 - 0.2563e4 / 0.1458e4 * t560 * t3051 * t209 * t226 + t1297 * t3064 / 0.27e2 + 0.2618e4 / 0.243e3 * t50 * t3023 * t46 * t96 + 0.2e1 / 0.27e2 * t1292 * t3071 - 0.2e1 / 0.27e2 * t1297 * t3074 - 0.3047e4 / 0.972e3 * t218 * t3017 * t209 * t96 + 0.3047e4 / 0.972e3 * t224 * t3017 * t46 * t226 + 0.38e2 / 0.81e2 * t3085 * t1294 - 0.38e2 / 0.81e2 * t3088 * t1299;
  t3093 = t1293 * t2017;
  t3102 = t3030 * t3035;
  t3106 = t95 * t56 * t200;
  t3107 = t3037 * t55 * t3106;
  t3112 = t1347 * params->c * t3106;
  t3118 = t568 * t1476;
  t3123 = t57 * t60 * t387;
  t3126 = t1414 * t1438 * t2 * t83;
  t3129 = t1400 * t79;
  t3134 = 0.1e1 / t1415 / t593;
  t3137 = t65 * t80 * t3129 * t615 * t3134 * t2 * t83;
  t3141 = t239 * t240 * t1416;
  t3145 = t239 * t604 * t1438;
  t3169 = t239 * t1436 * t3134;
  t3172 = 0.9e2 * t3123 * t3126 - 0.135e3 / 0.4e1 * t3123 * t3137 + 0.32e2 / 0.81e2 * t3123 * t3141 - 0.76e2 / 0.9e1 * t3123 * t3145 - 0.411e3 / 0.16e2 * t3123 * t619 + 0.1037e4 / 0.81e2 * t3123 * t244 + 0.68e2 / 0.3e1 * t3123 * t1440 - 0.68e2 / 0.3e1 * t3123 * t1427 - 0.153e3 / 0.2e1 * t3123 * t1432 + 0.272e3 / 0.81e2 * t3123 * t1423 + 0.357e3 / 0.8e1 * t3123 * t1409 + 0.153e3 / 0.4e1 * t3123 * t1419 + 0.274e3 / 0.27e2 * t3123 * t596 - 0.137e3 / 0.9e1 * t3123 * t608 + 0.8e2 / 0.3e1 * t3123 * t3169;
  t3173 = t616 * t1418;
  t3179 = 0.1e1 / t1415 / t605;
  t3181 = t239 * t81 * t611 * t89 * t3179;
  t3186 = t1406 * t1416 * t66 * t68;
  t3194 = t65 * t81 * t3129 * t1405 * t1438 * t66 * t68;
  t3199 = t387 * t65;
  t3201 = t3129 * t252 * t3179;
  t3205 = t1452 * t3134;
  t3223 = t1400 * t249 / t251 / t1403 / t88 * t1416;
  t3227 = t253 * t1416;
  t3231 = t622 * t1438;
  t3244 = -0.58e2 * t3123 * t3173 - 0.2e2 * t3123 * t3181 + 0.84e2 * t3123 * t3186 - 0.189e3 / 0.4e1 * t3123 * t3194 + 0.455e3 / 0.81e2 * t3123 * t91 - 0.45e2 * t247 * t3199 * t3201 + 0.15e3 * t247 * t3199 * t3205 + 0.274e3 / 0.3e1 * t247 * t3199 * t599 + 0.884e3 / 0.9e1 * t247 * t3199 * t1463 - 0.153e3 * t247 * t3199 * t1467 - 0.2079e4 / 0.16e2 * t247 * t3199 * t3223 + 0.32e3 / 0.9e1 * t247 * t3199 * t3227 - 0.139e3 * t247 * t3199 * t3231 + 0.1037e4 / 0.36e2 * t247 * t3199 * t254 + 0.51e2 * t247 * t3199 * t1453 - 0.137e3 / 0.4e1 * t247 * t3199 * t623;
  t3254 = 0.1e1 / t1317 / t94;
  t3255 = t55 * t3254;
  t3256 = t576 * t576;
  t3260 = params->c * t1318;
  t3261 = t3260 * t1320;
  t3265 = -t1292 * t3093 / 0.27e2 - t218 * t219 * t1321 / 0.9e1 + 0.616e3 / 0.81e2 * t50 * t1288 * t259 + 0.2e1 / 0.2187e4 * t3029 * t3102 * t3107 - 0.2e1 / 0.2187e4 * t1339 * t3102 * t3112 - t218 * t219 * t1477 / 0.54e2 + t224 * t225 * t3118 / 0.54e2 - t50 * t51 * t232 * (t3172 + t3244) / 0.24e2 + 0.8e1 / 0.3e1 * t50 * t213 * t1321 + t50 * t51 * t3255 * t3256 + t224 * t225 * t3261 / 0.9e1;
  t3266 = t627 * t627;
  t3289 = t1340 * t3045;
  t3305 = t50 * t51 * t575 * t3266 / 0.4e1 + 0.44e2 / 0.9e1 * t50 * t539 * t577 - 0.22e2 / 0.9e1 * t50 * t539 * t628 - 0.341e3 / 0.243e3 * t218 * t1304 * t259 - t218 * t543 * t577 / 0.2e1 + 0.341e3 / 0.243e3 * t224 * t1308 * t569 + t224 * t547 * t1313 / 0.2e1 - 0.49e2 / 0.729e3 * t1339 * t3289 * t1351 + 0.49e2 / 0.729e3 * t528 * t3289 * t1357 + t218 * t543 * t628 / 0.4e1 - t224 * t547 * t1331 / 0.4e1 + 0.4e1 / 0.9e1 * t50 * t213 * t1477;
  t3312 = t5 * t186 * t1491;
  t3315 = t5 * t505 * t632;
  t3318 = t5 * t1276 * t263;
  t3324 = t5 * t1264 * t263;
  t3326 = t5 * t496 * t632;
  t3331 = t19 * t19;
  t3333 = 0.1e1 / t477 / t3331;
  t3334 = t479 * t479;
  t3340 = t487 * t487;
  t3346 = 0.1e1 / t1243 / t6;
  t3347 = t16 * t3346;
  t3350 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t1244 + 0.24e2 * t3347);
  t3354 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3333 * t3334 - 0.16e2 / 0.9e1 * t1236 * t479 * t487 + 0.4e1 / 0.3e1 * t478 * t3340 + 0.16e2 / 0.9e1 * t1240 * t1248 + 0.4e1 / 0.3e1 * t23 * t3350);
  t3363 = t5 * t1257 * t263;
  t3366 = 0.1e1 / t184 / t482;
  t3370 = 0.1e2 / 0.27e2 * t5 * t25 * t3366 * t100;
  t3373 = t5 * t179 * t1275 * t100;
  t3377 = t5 * t1252 * t185 * t100;
  t3381 = t5 * t491 * t504 * t100;
  t3383 = -0.3e1 / 0.8e1 * t5 * t27 * (t3050 + t3091 + t3265 + t3305) - t3312 / 0.2e1 + t3315 / 0.2e1 - 0.5e1 / 0.9e1 * t3318 - 0.3e1 / 0.2e1 * t5 * t180 * t1491 + t3324 - 0.3e1 / 0.2e1 * t3326 - 0.9e1 / 0.4e1 * t5 * t492 * t632 - 0.3e1 / 0.8e1 * t5 * t3354 * t26 * t100 - 0.3e1 / 0.2e1 * t5 * t1253 * t263 - 0.3e1 / 0.2e1 * t3363 + t3370 - 0.5e1 / 0.9e1 * t3373 - t3377 / 0.2e1 + t3381 / 0.2e1;
  t3384 = my_piecewise3(t1, 0, t3383);
  t3385 = t109 * t109;
  t3387 = 0.1e1 / t638 / t3385;
  t3388 = t640 * t640;
  t3394 = t646 * t646;
  t3399 = t106 * t3346;
  t3402 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t1244 + 0.24e2 * t3399);
  t3406 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t3387 * t3388 - 0.16e2 / 0.9e1 * t1498 * t640 * t646 + 0.4e1 / 0.3e1 * t639 * t3394 + 0.16e2 / 0.9e1 * t1502 * t1508 + 0.4e1 / 0.3e1 * t111 * t3402);
  t3413 = t5 * t1512 * t185 * t167;
  t3417 = t5 * t650 * t504 * t167;
  t3421 = t5 * t274 * t1275 * t167;
  t3426 = 0.1e2 / 0.27e2 * t5 * t113 * t3366 * t167;
  t3428 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t3406 * t26 * t167 - t3413 / 0.2e1 + t3417 / 0.2e1 - 0.5e1 / 0.9e1 * t3421 + t3426);
  tv4rho40 = 0.4e1 * t1496 + 0.4e1 * t1530 + t6 * (t3384 + t3428);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3435 = t5 * t291 * t1275 * t100;
  t3439 = t5 * t1550 * t185 * t100;
  t3443 = t5 * t675 * t504 * t100;
  t3444 = t3443 / 0.4e1;
  t3449 = t5 * t1562 * t263;
  t3450 = t3449 / 0.4e1;
  t3452 = t5 * t680 * t632;
  t3470 = 0.12e2 * t1244;
  t3471 = 0.24e2 * t3347;
  t3473 = my_piecewise5(t10, 0, t14, 0, -t3470 + t3471);
  t3477 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3333 * t288 * t1237 - 0.8e1 / 0.9e1 * t1236 * t671 * t479 - 0.8e1 / 0.9e1 * t1535 * t176 * t487 + 0.4e1 / 0.3e1 * t478 * t1546 * t176 + 0.4e1 / 0.3e1 * t1538 * t487 + 0.4e1 / 0.9e1 * t667 * t1248 + 0.4e1 / 0.3e1 * t23 * t3473);
  t3486 = t5 * t1555 * t263;
  t3500 = -0.5e1 / 0.36e2 * t3435 - 0.3e1 / 0.8e1 * t3439 + t3444 - 0.3e1 / 0.8e1 * t5 * t292 * t1491 + t3450 - 0.3e1 / 0.8e1 * t3452 - 0.3e1 / 0.8e1 * t5 * t3477 * t26 * t100 - 0.9e1 / 0.8e1 * t5 * t1551 * t263 - 0.3e1 / 0.4e1 * t3486 - 0.9e1 / 0.8e1 * t5 * t676 * t632 - t3312 / 0.8e1 + t3315 / 0.4e1 - 0.5e1 / 0.12e2 * t3318 + t3324 / 0.2e1 - 0.3e1 / 0.8e1 * t3326 - 0.3e1 / 0.8e1 * t3363 + t3370 - 0.5e1 / 0.12e2 * t3373 - t3377 / 0.8e1 + t3381 / 0.4e1;
  t3501 = my_piecewise3(t1, 0, t3500);
  t3518 = 0.24e2 * t3399;
  t3520 = my_piecewise5(t14, 0, t10, 0, t3470 + t3518);
  t3524 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t3387 * t299 * t1499 - 0.8e1 / 0.9e1 * t1498 * t695 * t640 - 0.8e1 / 0.9e1 * t1579 * t271 * t646 + 0.4e1 / 0.3e1 * t639 * t1589 * t271 + 0.4e1 / 0.3e1 * t1582 * t646 + 0.4e1 / 0.9e1 * t691 * t1508 + 0.4e1 / 0.3e1 * t111 * t3520);
  t3531 = t5 * t1593 * t185 * t167;
  t3535 = t5 * t699 * t504 * t167;
  t3536 = t3535 / 0.4e1;
  t3539 = t5 * t302 * t1275 * t167;
  t3548 = t5 * t1517 * t373;
  t3551 = t5 * t1521 * t373;
  t3552 = t3551 / 0.4e1;
  t3554 = t5 * t1525 * t373;
  t3556 = -0.3e1 / 0.8e1 * t5 * t3524 * t26 * t167 - 0.3e1 / 0.8e1 * t3531 + t3536 - 0.5e1 / 0.36e2 * t3539 - t3413 / 0.8e1 + t3417 / 0.4e1 - 0.5e1 / 0.12e2 * t3421 + t3426 - 0.3e1 / 0.8e1 * t5 * t1513 * t373 - 0.3e1 / 0.8e1 * t3548 + t3552 - 0.5e1 / 0.36e2 * t3554;
  t3557 = my_piecewise3(t105, 0, t3556);
  tv4rho41 = t1496 + t1530 + 0.3e1 * t1578 + 0.3e1 * t1618 + t6 * (t3501 + t3557);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t3566 = t5 * t1634 * t185 * t100;
  t3570 = t5 * t730 * t504 * t100;
  t3583 = t671 * t671;
  t3596 = my_piecewise5(t10, 0, t14, 0, t3471);
  t3600 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3333 * t721 * t479 - 0.32e2 / 0.27e2 * t1535 * t176 * t671 - 0.8e1 / 0.27e2 * t1621 * t487 + 0.8e1 / 0.9e1 * t478 * t3583 + 0.8e1 / 0.9e1 * t667 * t1546 - 0.8e1 / 0.27e2 * t1236 * t726 * t479 + 0.8e1 / 0.9e1 * t478 * t1630 * t176 + 0.4e1 / 0.9e1 * t1626 * t487 + 0.4e1 / 0.3e1 * t23 * t3596);
  t3609 = t5 * t1639 * t263;
  t3622 = -t3566 / 0.4e1 + t3570 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t731 * t632 - 0.3e1 / 0.8e1 * t5 * t3600 * t26 * t100 - 0.3e1 / 0.4e1 * t5 * t1635 * t263 - t3609 / 0.4e1 - 0.5e1 / 0.18e2 * t3435 - t3439 / 0.4e1 + t3443 / 0.3e1 + t3449 / 0.3e1 - t3452 / 0.4e1 - t3486 / 0.2e1 + t3315 / 0.12e2 - 0.5e1 / 0.18e2 * t3318 + t3324 / 0.6e1 + t3370 - 0.5e1 / 0.18e2 * t3373 + t3381 / 0.12e2;
  t3623 = my_piecewise3(t1, 0, t3622);
  t3632 = t695 * t695;
  t3645 = my_piecewise5(t14, 0, t10, 0, t3518);
  t3649 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t3387 * t738 * t640 - 0.32e2 / 0.27e2 * t1579 * t271 * t695 - 0.8e1 / 0.27e2 * t1651 * t646 + 0.8e1 / 0.9e1 * t639 * t3632 + 0.8e1 / 0.9e1 * t691 * t1589 - 0.8e1 / 0.27e2 * t1498 * t743 * t640 + 0.8e1 / 0.9e1 * t639 * t1660 * t271 + 0.4e1 / 0.9e1 * t1656 * t646 + 0.4e1 / 0.3e1 * t111 * t3645);
  t3656 = t5 * t1664 * t185 * t167;
  t3660 = t5 * t747 * t504 * t167;
  t3669 = t5 * t1598 * t373;
  t3672 = t5 * t1602 * t373;
  t3683 = t5 * t655 * t872;
  t3686 = t5 * t659 * t872;
  t3688 = -0.3e1 / 0.8e1 * t5 * t3649 * t26 * t167 - t3656 / 0.4e1 + t3660 / 0.12e2 - t3531 / 0.4e1 + t3535 / 0.3e1 - 0.5e1 / 0.18e2 * t3539 - 0.3e1 / 0.4e1 * t5 * t1594 * t373 - t3669 / 0.2e1 + t3672 / 0.6e1 + t3417 / 0.12e2 - 0.5e1 / 0.18e2 * t3421 + t3426 - t3548 / 0.4e1 + t3551 / 0.3e1 - 0.5e1 / 0.18e2 * t3554 - 0.3e1 / 0.8e1 * t5 * t651 * t872 - t3683 / 0.4e1 + t3686 / 0.12e2;
  t3689 = my_piecewise3(t105, 0, t3688);
  tv4rho42 = 0.2e1 * t1578 + 0.2e1 * t1618 + 0.2e1 * t1650 + 0.2e1 * t1689 + t6 * (t3623 + t3689);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t3710 = my_piecewise5(t10, 0, t14, 0, t3470 + t3471);
  t3714 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3333 * t1694 * t176 - 0.8e1 / 0.9e1 * t1621 * t671 - 0.8e1 / 0.9e1 * t1535 * t726 * t176 + 0.4e1 / 0.3e1 * t1538 * t726 + 0.4e1 / 0.3e1 * t667 * t1630 + 0.4e1 / 0.9e1 * t478 * t1701 * t176 + 0.4e1 / 0.3e1 * t23 * t3710);
  t3721 = t5 * t1705 * t185 * t100;
  t3732 = -0.3e1 / 0.8e1 * t5 * t3714 * t26 * t100 - t3721 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1706 * t263 - 0.3e1 / 0.8e1 * t3566 + t3570 / 0.4e1 - 0.3e1 / 0.8e1 * t3609 + t3444 - 0.5e1 / 0.12e2 * t3435 + t3450 - 0.5e1 / 0.36e2 * t3373 + t3370 - 0.5e1 / 0.36e2 * t3318;
  t3733 = my_piecewise3(t1, 0, t3732);
  t3750 = my_piecewise5(t14, 0, t10, 0, -t3470 + t3518);
  t3754 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t3387 * t1714 * t271 - 0.8e1 / 0.9e1 * t1651 * t695 - 0.8e1 / 0.9e1 * t1579 * t743 * t271 + 0.4e1 / 0.3e1 * t1582 * t743 + 0.4e1 / 0.3e1 * t691 * t1660 + 0.4e1 / 0.9e1 * t639 * t1721 * t271 + 0.4e1 / 0.3e1 * t111 * t3750);
  t3761 = t5 * t1725 * t185 * t167;
  t3769 = t5 * t1669 * t373;
  t3778 = t5 * t704 * t872;
  t3788 = t5 * t279 * t1943;
  t3790 = -0.3e1 / 0.8e1 * t5 * t3754 * t26 * t167 - t3761 / 0.8e1 - 0.3e1 / 0.8e1 * t3656 + t3660 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1665 * t373 - 0.3e1 / 0.8e1 * t3769 + t3536 - 0.5e1 / 0.12e2 * t3539 - 0.3e1 / 0.4e1 * t3669 + t3672 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t700 * t872 - 0.3e1 / 0.8e1 * t3778 - 0.5e1 / 0.36e2 * t3421 + t3426 + t3552 - 0.5e1 / 0.12e2 * t3554 - 0.3e1 / 0.8e1 * t3683 + t3686 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t275 * t1943 - t3788 / 0.8e1;
  t3791 = my_piecewise3(t105, 0, t3790);
  tv4rho43 = 0.3e1 * t1650 + 0.3e1 * t1689 + t1713 + t1948 + t6 * (t3733 + t3791);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3796 = t721 * t721;
  t3801 = t726 * t726;
  t3808 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t1244 + 0.24e2 * t3347);
  t3812 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t3333 * t3796 - 0.16e2 / 0.9e1 * t1621 * t726 + 0.4e1 / 0.3e1 * t478 * t3801 + 0.16e2 / 0.9e1 * t667 * t1701 + 0.4e1 / 0.3e1 * t23 * t3808);
  t3821 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t3812 * t26 * t100 - t3721 / 0.2e1 + t3570 / 0.2e1 - 0.5e1 / 0.9e1 * t3435 + t3370);
  t3822 = 0.1e1 / t2215;
  t3832 = t1017 * t1763;
  t3836 = t1339 * t1898 * t1747;
  t3838 = t343 * t1374 * t368;
  t3841 = t1023 * t1763;
  t3847 = t528 * t1898 * t776;
  t3848 = t33 * t342;
  t3850 = t52 * t3848 * t368;
  t3864 = t771 * t316;
  t3866 = 0.1e1 / t117 / t3864;
  t3867 = t1741 * t3866;
  t3871 = -0.2563e4 / 0.1458e4 * t528 * t770 * t3822 * t776 + t123 * t1028 * t814 * t1886 * t368 / 0.3e1 + t2353 * t3832 / 0.9e1 - 0.2e1 / 0.243e3 * t3836 * t3838 - t2370 * t3841 / 0.9e1 - 0.8e1 / 0.3e1 * t2358 * t1764 + 0.2e1 / 0.243e3 * t3847 * t3850 - 0.3e1 / 0.2e1 * t123 * t1028 * t1929 * t816 * t867 + t330 * t784 * t868 / 0.4e1 + 0.4e1 / 0.9e1 * t130 * t325 * t1887 + 0.49e2 / 0.729e3 * t528 * t3867 * t1908;
  t3887 = t808 * t1886;
  t3892 = t57 * t136 * t434;
  t3896 = 0.1e1 / t1825 / t845;
  t3898 = t239 * t150 * t851 * t156 * t3896;
  t3905 = t1810 * t148;
  t3910 = 0.1e1 / t1825 / t833;
  t3913 = t65 * t149 * t3905 * t855 * t3910 * t2 * t83;
  t3917 = t239 * t350 * t1826;
  t3921 = t239 * t844 * t1848;
  t3925 = t239 * t1846 * t3910;
  t3930 = t434 * t65;
  t3944 = t3905 * t362 * t3896;
  t3953 = t1810 * t359 / t361 / t1813 / t155 * t1826;
  t3957 = t363 * t1826;
  t3961 = -0.2e2 * t3892 * t3898 + 0.274e3 / 0.27e2 * t3892 * t836 - 0.137e3 / 0.9e1 * t3892 * t848 - 0.135e3 / 0.4e1 * t3892 * t3913 + 0.32e2 / 0.81e2 * t3892 * t3917 - 0.76e2 / 0.9e1 * t3892 * t3921 + 0.8e2 / 0.3e1 * t3892 * t3925 + 0.455e3 / 0.81e2 * t3892 * t158 + 0.274e3 / 0.3e1 * t357 * t3930 * t839 + 0.884e3 / 0.9e1 * t357 * t3930 * t1872 - 0.153e3 * t357 * t3930 * t1876 + 0.1037e4 / 0.36e2 * t357 * t3930 * t364 - 0.45e2 * t357 * t3930 * t3944 - 0.2079e4 / 0.16e2 * t357 * t3930 * t3953 + 0.32e3 / 0.9e1 * t357 * t3930 * t3957;
  t3962 = t862 * t1848;
  t3966 = t1864 * t3910;
  t3976 = t856 * t1828;
  t3981 = t1816 * t1826 * t66 * t68;
  t3989 = t65 * t150 * t3905 * t1815 * t1848 * t66 * t68;
  t3994 = t1824 * t1848 * t2 * t83;
  t4013 = -0.139e3 * t357 * t3930 * t3962 + 0.15e3 * t357 * t3930 * t3966 - 0.137e3 / 0.4e1 * t357 * t3930 * t863 + 0.51e2 * t357 * t3930 * t1865 - 0.58e2 * t3892 * t3976 + 0.84e2 * t3892 * t3981 - 0.189e3 / 0.4e1 * t3892 * t3989 + 0.9e2 * t3892 * t3994 - 0.411e3 / 0.16e2 * t3892 * t859 + 0.1037e4 / 0.81e2 * t3892 * t354 - 0.153e3 / 0.2e1 * t3892 * t1842 + 0.68e2 / 0.3e1 * t3892 * t1850 - 0.68e2 / 0.3e1 * t3892 * t1837 + 0.153e3 / 0.4e1 * t3892 * t1829 + 0.272e3 / 0.81e2 * t3892 * t1833 + 0.357e3 / 0.8e1 * t3892 * t1819;
  t4019 = t867 * t867;
  t4033 = 0.341e3 / 0.243e3 * t335 * t1789 * t809 + t335 * t788 * t1924 / 0.2e1 - 0.49e2 / 0.729e3 * t1339 * t3867 * t1903 - t335 * t788 * t1894 / 0.4e1 - 0.22e2 / 0.9e1 * t130 * t780 * t868 + t335 * t336 * t3887 / 0.54e2 - t130 * t131 * t343 * (t3961 + t4013) / 0.24e2 + t130 * t131 * t815 * t4019 / 0.4e1 + 0.44e2 / 0.9e1 * t130 * t780 * t817 - t330 * t784 * t817 / 0.2e1 - t330 * t331 * t1932 / 0.9e1;
  t4041 = t1741 * sigma[2];
  t4042 = t771 * t771;
  t4045 = 0.1e1 / t116 / t4042 / rho[1];
  t4046 = t4041 * t4045;
  t4049 = 0.1e1 / t1746 / t125;
  t4052 = t162 * t56 * t200;
  t4053 = t4049 * t134 * t4052;
  t4058 = t1747 * params->c * t4052;
  t4068 = 0.1e1 / t1928 / t161;
  t4069 = t134 * t4068;
  t4070 = t816 * t816;
  t4074 = params->c * t1929;
  t4075 = t4074 * t1931;
  t4091 = -0.341e3 / 0.243e3 * t330 * t1785 * t369 + 0.616e3 / 0.81e2 * t130 * t1769 * t369 + 0.2e1 / 0.2187e4 * t3029 * t4046 * t4053 - 0.2e1 / 0.2187e4 * t1339 * t4046 * t4058 - t330 * t331 * t1887 / 0.54e2 + 0.8e1 / 0.3e1 * t130 * t325 * t1932 + t130 * t131 * t4069 * t4070 + t335 * t336 * t4075 / 0.9e1 + 0.49e2 / 0.729e3 * t1742 * t3866 * t1747 * t1374 + 0.2563e4 / 0.1458e4 * t795 * t3822 * t776 * t163 - 0.2563e4 / 0.1458e4 * t800 * t3822 * t321 * t337;
  t4098 = 0.1e1 / t117 / t316;
  t4104 = 0.1e1 / t116 / t1007;
  t4113 = t1774 * t2267;
  t4116 = t1779 * t2267;
  t4119 = t528 * t1793;
  t4130 = t559 * t1793;
  t4133 = t1774 * t2278;
  t4136 = t1779 * t2278;
  t4139 = -0.2e1 / 0.2187e4 * t3029 * t4041 * t4045 * t4049 * t3039 - 0.2618e4 / 0.243e3 * t34 * sigma[2] * t4098 * t126 + 0.3047e4 / 0.972e3 * t201 * t314 * t4104 * t321 + 0.2618e4 / 0.243e3 * t130 * t4098 * t126 * t163 + 0.2e1 / 0.27e2 * t1773 * t4113 - 0.2e1 / 0.27e2 * t1778 * t4116 + 0.38e2 / 0.81e2 * t4119 * t1775 - 0.3047e4 / 0.972e3 * t330 * t4104 * t321 * t163 + 0.3047e4 / 0.972e3 * t335 * t4104 * t126 * t337 - 0.38e2 / 0.81e2 * t4130 * t1780 - t1773 * t4133 / 0.27e2 + t1778 * t4136 / 0.27e2;
  t4151 = t738 * t738;
  t4156 = t743 * t743;
  t4163 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t1244 + 0.24e2 * t3399);
  t4167 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t3387 * t4151 - 0.16e2 / 0.9e1 * t1651 * t743 + 0.4e1 / 0.3e1 * t639 * t4156 + 0.16e2 / 0.9e1 * t691 * t1721 + 0.4e1 / 0.3e1 * t111 * t4163);
  t4183 = -0.3e1 / 0.8e1 * t5 * t114 * (t3871 + t4033 + t4091 + t4139) - 0.3e1 / 0.2e1 * t5 * t303 * t1943 - 0.9e1 / 0.4e1 * t5 * t748 * t872 - 0.3e1 / 0.8e1 * t5 * t4167 * t26 * t167 - 0.3e1 / 0.2e1 * t5 * t1726 * t373 - 0.3e1 / 0.2e1 * t3778 - t3788 / 0.2e1 - t3761 / 0.2e1 - 0.3e1 / 0.2e1 * t3769 + t3660 / 0.2e1 + t3672 + t3686 / 0.2e1 - 0.5e1 / 0.9e1 * t3539 - 0.5e1 / 0.9e1 * t3554 + t3426;
  t4184 = my_piecewise3(t105, 0, t4183);
  tv4rho44 = 0.4e1 * t1713 + 0.4e1 * t1948 + t6 * (t3821 + t4184);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4192 = t5 * t1257 * t423;
  t4198 = t5 * t1264 * t423;
  t4201 = t5 * t496 * t975;
  t4208 = 0.5e1 / 0.36e2 * t5 * t1276 * t423;
  t4210 = t5 * t505 * t975;
  t4213 = t5 * t186 * t2145;
  t4216 = t1339 * t2053 * t1347;
  t4220 = t528 * t2053 * t535;
  t4243 = t914 * t1318;
  t4244 = t418 * t258;
  t4289 = t57 * t406 * t1397;
  t4298 = 0.111e3 / 0.16e2 * t413 * t1460 - 0.325e3 / 0.12e2 * t413 * t1464 + 0.675e3 / 0.16e2 * t413 * t1468 + 0.135e3 / 0.8e1 * t413 * t1451 * t3201 - 0.4e2 / 0.3e1 * t413 * t1451 * t3227 + 0.417e3 / 0.8e1 * t413 * t1451 * t3231 - 0.13e2 / 0.3e1 * t413 * t1471 - 0.37e2 / 0.2e1 * t413 * t1457 - 0.225e3 / 0.4e1 * t413 * t1451 * t3205 + 0.6237e4 / 0.128e3 * t413 * t1451 * t3223 - 0.225e3 / 0.16e2 * t413 * t1454 - 0.37e2 / 0.18e2 * t4289 * t596 + 0.37e2 / 0.12e2 * t4289 * t608 + 0.19e2 / 0.6e1 * t4289 * t3145 + 0.87e2 / 0.4e1 * t4289 * t3173;
  t4331 = -0.135e3 / 0.4e1 * t4289 * t3126 + 0.405e3 / 0.32e2 * t4289 * t3137 + 0.675e3 / 0.32e2 * t4289 * t1432 - 0.4e1 / 0.27e2 * t4289 * t3141 - 0.1e2 * t4289 * t3169 + 0.15e2 / 0.2e1 * t4289 * t3181 - 0.63e2 / 0.2e1 * t4289 * t3186 + 0.567e3 / 0.32e2 * t4289 * t3194 + 0.25e2 / 0.4e1 * t4289 * t1427 - 0.25e2 / 0.27e2 * t4289 * t1423 - 0.675e3 / 0.64e2 * t4289 * t1419 + 0.333e3 / 0.64e2 * t4289 * t619 - 0.1575e4 / 0.128e3 * t4289 * t1409 - 0.25e2 / 0.4e1 * t4289 * t1440 - 0.52e2 / 0.27e2 * t4289 * t244 - 0.35e2 / 0.54e2 * t4289 * t91;
  t4346 = t568 * t2132;
  t4353 = t4216 * t2999 / 0.432e3 - t4220 * t3006 / 0.432e3 - t2514 * t2990 / 0.96e2 + 0.1025e4 / 0.1944e4 * t528 * t1380 * t202 + 0.154e3 / 0.81e2 * t29 * t33 * t1287 * t46 + t43 * t914 * t945 * t1476 / 0.12e2 + t43 * t914 * t2003 * t627 / 0.4e1 - 0.253e3 / 0.324e3 * t201 * t1304 * sigma[0] - 0.3e1 / 0.4e1 * t43 * t4243 * t4244 * t627 + 0.2e1 * t1987 * t2010 + t43 * t914 * t3254 * t418 * t1320 + t50 * t213 * t2133 / 0.3e1 - t218 * t219 * t2133 / 0.72e2 - t50 * t51 * t232 * (t4298 + t4331) / 0.24e2 - t224 * t547 * t2137 / 0.8e1 - 0.11e2 / 0.9e1 * t50 * t539 * t971 + t218 * t543 * t971 / 0.8e1 + t224 * t225 * t4346 / 0.72e2 + 0.341e3 / 0.972e3 * t224 * t1308 * t941;
  t4359 = t1298 * t946;
  t4362 = t1293 * t946;
  t4381 = t2021 * sigma[0];
  t4388 = t529 * t1343;
  t4396 = 0.1e1 / t36 / t3032;
  t4397 = t1340 * t4396;
  t4413 = t400 * t1332 / 0.24e2 - 0.341e3 / 0.972e3 * t218 * t1304 * t419 - t1297 * t4359 / 0.27e2 + t1292 * t4362 / 0.27e2 - t400 * t401 * t3118 / 0.576e3 + t395 * t396 * t1477 / 0.576e3 - t902 * t903 * t2017 * sigma[0] / 0.24e2 + t913 * t1487 / 0.4e1 + 0.65e2 / 0.216e3 * t2041 * t2065 - 0.65e2 / 0.216e3 * t2014 * t2068 + t902 * t903 * t4381 / 0.12e2 - t908 * t909 * t4381 / 0.12e2 - 0.89e2 / 0.3888e4 * t528 * t4388 * t1357 + 0.89e2 / 0.3888e4 * t1339 * t4388 * t1351 - t3029 * t4397 * t3107 / 0.2916e4 + t1339 * t4397 * t3112 / 0.2916e4 - t400 * t401 * t3261 / 0.96e2 + t395 * t396 * t1321 / 0.96e2 + 0.154e3 / 0.81e2 * t50 * t1288 * t419;
  t4415 = t903 * t1990;
  t4418 = t909 * t1990;
  t4426 = t909 * t2004;
  t4429 = t903 * t2004;
  t4436 = t217 * t520;
  t4468 = t200 * t1303;
  t4477 = t1999 * t4415 / 0.36e2 - t1995 * t4418 / 0.36e2 + t43 * t914 * t574 * t2132 * t258 / 0.4e1 - t1995 * t4426 / 0.18e2 + t1999 * t4429 / 0.18e2 - 0.4e1 / 0.3e1 * t1987 * t2005 + t2522 * t2993 / 0.96e2 - t198 * t4436 * t2000 / 0.4e1 + 0.22e2 / 0.9e1 * t29 * t41 * t513 * t947 - 0.2e1 / 0.3e1 * t1987 * t1991 + t3029 * t1340 * t4396 * t3037 * t3039 / 0.2916e4 - 0.1025e4 / 0.1944e4 * t528 * t1379 * t1979 + 0.1025e4 / 0.1944e4 * t559 * t1379 * t1983 - 0.89e2 / 0.3888e4 * t1339 * t1343 * t1347 * t529 * t1374 - 0.154e3 / 0.81e2 * t34 * t1289 - t913 * t914 * t1318 * t1320 / 0.4e1 - 0.253e3 / 0.324e3 * t223 * t4468 * t910 + 0.253e3 / 0.324e3 * t198 * t4468 * t905 + t2034 * t3074 / 0.72e2;
  t4478 = t29 * t2083;
  t4485 = t202 * t532;
  t4506 = t1293 * t2556;
  t4509 = t1298 * t2556;
  t4514 = t232 * t418 * t28 * t33;
  t4518 = t52 * t3004 * t418;
  t4521 = t903 * t2009;
  t4524 = t909 * t2009;
  t4535 = -0.11e2 / 0.9e1 * t4478 * t916 - 0.2e1 / 0.3e1 * t2037 * t2022 - t2031 * t3071 / 0.72e2 + 0.17e2 / 0.144e3 * t559 * t4485 * t1299 - 0.17e2 / 0.144e3 * t528 * t4485 * t1294 - t913 * t914 * t231 * t1476 / 0.24e2 + t2031 * t3093 / 0.144e3 + t2037 * t2018 / 0.3e1 - t2034 * t3064 / 0.144e3 + 0.19e2 / 0.162e3 * t3085 * t2025 - 0.19e2 / 0.162e3 * t3088 * t2028 - t1292 * t4506 / 0.54e2 + t1297 * t4509 / 0.54e2 - t2997 * t4514 / 0.486e3 + t3003 * t4518 / 0.486e3 - t1999 * t4521 / 0.12e2 + t1995 * t4524 / 0.12e2 - 0.3e1 / 0.4e1 * t43 * t914 * t1318 * t970 * t576 + t223 * t4436 * t1996 / 0.4e1;
  t4542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1253 * t423 - 0.3e1 / 0.8e1 * t4192 - 0.9e1 / 0.8e1 * t5 * t492 * t975 + t4198 / 0.4e1 - 0.3e1 / 0.4e1 * t4201 - 0.9e1 / 0.8e1 * t5 * t180 * t2145 - t4208 + t4210 / 0.4e1 - 0.3e1 / 0.8e1 * t4213 - 0.3e1 / 0.8e1 * t5 * t27 * (t4353 + t4413 + t4477 + t4535));
  tv4rho3sigma0 = t6 * t4542 + 0.3e1 * t2150;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t4549 = t5 * t1517 * t470;
  t4552 = t5 * t1521 * t470;
  t4556 = 0.5e1 / 0.36e2 * t5 * t1525 * t470;
  t4558 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t1513 * t470 - 0.3e1 / 0.8e1 * t4549 + t4552 / 0.4e1 - t4556);
  tv4rho3sigma2 = t6 * t4558 + 0.3e1 * t2163;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t4560 = 0.2e1 * t2177;
  t4566 = t5 * t1555 * t423 / 0.4e1;
  t4571 = t5 * t1562 * t423;
  t4575 = t5 * t680 * t975 / 0.4e1;
  t4584 = -0.3e1 / 0.8e1 * t5 * t1551 * t423 - t4566 - 0.3e1 / 0.4e1 * t5 * t676 * t975 + t4571 / 0.12e2 - t4575 - 0.3e1 / 0.8e1 * t5 * t292 * t2145 - t4192 / 0.8e1 + t4198 / 0.6e1 - t4201 / 0.4e1 - t4208 + t4210 / 0.6e1 - t4213 / 0.8e1;
  t4585 = my_piecewise3(t1, 0, t4584);
  tv4rho3sigma3 = t6 * t4585 + t2150 + t4560;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t4587 = 0.2e1 * t2193;
  t4593 = t5 * t1598 * t470 / 0.4e1;
  t4595 = t5 * t1602 * t470;
  t4604 = t5 * t655 * t1089 / 0.4e1;
  t4606 = t5 * t659 * t1089;
  t4609 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t1594 * t470 - t4593 + t4595 / 0.12e2 - t4549 / 0.8e1 + t4552 / 0.6e1 - t4556 - 0.3e1 / 0.8e1 * t5 * t651 * t1089 - t4604 + t4606 / 0.12e2);
  tv4rho3sigma5 = t6 * t4609 + t2163 + t4587;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t4615 = t5 * t1639 * t423;
  t4624 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1635 * t423 - t4615 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t731 * t975 - t4566 + t4571 / 0.6e1 - t4575 + t4198 / 0.12e2 - t4208 + t4210 / 0.12e2);
  tv4rho3sigma6 = t6 * t4624 + t2201 + t4560;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t4630 = t5 * t1669 * t470;
  t4637 = t5 * t704 * t1089;
  t4645 = t5 * t279 * t2390;
  t4647 = -0.3e1 / 0.8e1 * t5 * t1665 * t470 - t4630 / 0.8e1 - t4593 + t4595 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t700 * t1089 - t4637 / 0.4e1 + t4552 / 0.12e2 - t4556 - t4604 + t4606 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t275 * t2390 - t4645 / 0.8e1;
  t4648 = my_piecewise3(t105, 0, t4647);
  tv4rho3sigma8 = t6 * t4648 + t2395 + t4587;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t4657 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1706 * t423 - 0.3e1 / 0.8e1 * t4615 + t4571 / 0.4e1 - t4208);
  tv4rho3sigma9 = t6 * t4657 + 0.3e1 * t2201;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t4702 = t57 * t453 * t1807;
  t4711 = 0.111e3 / 0.16e2 * t460 * t1869 - 0.225e3 / 0.16e2 * t460 * t1866 + 0.6237e4 / 0.128e3 * t460 * t1863 * t3953 - 0.4e2 / 0.3e1 * t460 * t1863 * t3957 - 0.13e2 / 0.3e1 * t460 * t1880 + 0.135e3 / 0.8e1 * t460 * t1863 * t3944 + 0.417e3 / 0.8e1 * t460 * t1863 * t3962 - 0.225e3 / 0.4e1 * t460 * t1863 * t3966 - 0.37e2 / 0.2e1 * t460 * t1883 - 0.325e3 / 0.12e2 * t460 * t1873 + 0.675e3 / 0.16e2 * t460 * t1877 - 0.35e2 / 0.54e2 * t4702 * t158 - 0.25e2 / 0.27e2 * t4702 * t1833 + 0.87e2 / 0.4e1 * t4702 * t3976 + 0.15e2 / 0.2e1 * t4702 * t3898;
  t4744 = -0.37e2 / 0.18e2 * t4702 * t836 + 0.37e2 / 0.12e2 * t4702 * t848 - 0.63e2 / 0.2e1 * t4702 * t3981 + 0.567e3 / 0.32e2 * t4702 * t3989 - 0.135e3 / 0.4e1 * t4702 * t3994 + 0.405e3 / 0.32e2 * t4702 * t3913 + 0.19e2 / 0.6e1 * t4702 * t3921 - 0.1e2 * t4702 * t3925 + 0.333e3 / 0.64e2 * t4702 * t859 - 0.52e2 / 0.27e2 * t4702 * t354 + 0.675e3 / 0.32e2 * t4702 * t1842 - 0.25e2 / 0.4e1 * t4702 * t1850 + 0.25e2 / 0.4e1 * t4702 * t1837 - 0.1575e4 / 0.128e3 * t4702 * t1819 - 0.675e3 / 0.64e2 * t4702 * t1829 - 0.4e1 / 0.27e2 * t4702 * t3917;
  t4762 = t1017 * t2362;
  t4765 = t1017 * t2375;
  t4768 = t1023 * t2375;
  t4771 = t1023 * t2362;
  t4778 = t329 * t765;
  t4788 = t52 * t3848 * t465;
  t4792 = t1339 * t2249 * t1747;
  t4796 = t528 * t2249 * t776;
  t4809 = t343 * t465 * t28 * t33;
  t4812 = -t130 * t131 * t343 * (t4711 + t4744) / 0.24e2 - 0.2e1 / 0.3e1 * t2358 * t2367 + t123 * t1028 * t814 * t2337 * t368 / 0.4e1 - 0.3e1 / 0.4e1 * t123 * t1028 * t1929 * t1084 * t816 + t2353 * t4762 / 0.18e2 - t2353 * t4765 / 0.12e2 + t2370 * t4768 / 0.12e2 - t2370 * t4771 / 0.18e2 - 0.4e1 / 0.3e1 * t2358 * t2363 + t2678 * t3841 / 0.96e2 - t198 * t4778 * t2354 / 0.4e1 - t2675 * t3832 / 0.96e2 + t223 * t4778 * t2371 / 0.4e1 + t3847 * t4788 / 0.486e3 + t4792 * t3838 / 0.432e3 - t4796 * t3850 / 0.432e3 + t123 * t1028 * t1059 * t1886 / 0.12e2 + t123 * t1028 * t2361 * t867 / 0.4e1 - t3836 * t4809 / 0.486e3;
  t4817 = t1017 * t2366;
  t4820 = t1023 * t2366;
  t4827 = t1028 * t1929;
  t4828 = t465 * t368;
  t4851 = t770 * t1745;
  t4872 = 0.22e2 / 0.9e1 * t29 * t121 * t758 * t1061 + t2353 * t4817 / 0.36e2 - t2370 * t4820 / 0.36e2 + t123 * t1028 * t4068 * t465 * t1931 - 0.3e1 / 0.4e1 * t123 * t4827 * t4828 * t867 + t330 * t784 * t1085 / 0.8e1 + t130 * t325 * t2338 / 0.3e1 - 0.341e3 / 0.972e3 * t330 * t1785 * t466 + 0.341e3 / 0.972e3 * t335 * t1789 * t1055 - 0.11e2 / 0.9e1 * t130 * t780 * t1085 - t335 * t788 * t2345 / 0.8e1 + 0.89e2 / 0.3888e4 * t1339 * t4851 * t1903 + 0.65e2 / 0.216e3 * t2292 * t2261 - 0.89e2 / 0.3888e4 * t528 * t4851 * t1908 - t442 * t1891 / 0.24e2 + t447 * t1895 / 0.24e2 - 0.65e2 / 0.216e3 * t2295 * t2264 + t442 * t443 * t1932 / 0.96e2 - t447 * t448 * t4075 / 0.96e2;
  t4892 = t29 * t2382;
  t4895 = t200 * t1784;
  t4906 = t528 * t796;
  t4911 = t559 * t801;
  t4912 = params->c * t314;
  t4924 = t1774 * t2737;
  t4927 = t1779 * t2737;
  t4930 = 0.154e3 / 0.81e2 * t130 * t1769 * t466 + 0.2e1 * t2358 * t2376 - 0.253e3 / 0.324e3 * t201 * t1785 * sigma[2] - t2282 * t4113 / 0.72e2 + t2288 * t2279 / 0.3e1 - 0.2e1 / 0.3e1 * t2288 * t2268 - t1027 * t1028 * t1929 * t1931 / 0.4e1 - 0.11e2 / 0.9e1 * t4892 * t1030 + 0.253e3 / 0.324e3 * t198 * t4895 * t1019 - 0.253e3 / 0.324e3 * t223 * t4895 * t1024 - t1027 * t1028 * t342 * t1886 / 0.24e2 - 0.17e2 / 0.144e3 * t4906 * t343 * t314 * t368 + 0.17e2 / 0.144e3 * t4911 * t4912 * t1029 + t2282 * t4133 / 0.144e3 - t2285 * t4136 / 0.144e3 + 0.19e2 / 0.162e3 * t4119 * t2271 - 0.19e2 / 0.162e3 * t4130 * t2274 - t1773 * t4924 / 0.54e2 + t1778 * t4927 / 0.54e2;
  t4937 = 0.1e1 / t116 / t4042;
  t4960 = t1779 * t1060;
  t4963 = t1774 * t1060;
  t4966 = t1741 * t4937;
  t4972 = t2267 * sigma[2];
  t4988 = t808 * t2337;
  t4995 = t2285 * t4116 / 0.72e2 - 0.154e3 / 0.81e2 * t34 * t1770 + t3029 * t1741 * t4937 * t4049 * t3039 / 0.2916e4 - 0.1025e4 / 0.1944e4 * t528 * t1753 * t2224 + 0.1025e4 / 0.1944e4 * t559 * t1753 * t2228 - 0.89e2 / 0.3888e4 * t1339 * t1745 * t1747 * t770 * t1374 + 0.154e3 / 0.81e2 * t29 * t33 * t1768 * t126 + 0.1025e4 / 0.1944e4 * t528 * t1754 * t314 - t1778 * t4960 / 0.27e2 + t1773 * t4963 / 0.27e2 - t3029 * t4966 * t4053 / 0.2916e4 + t1027 * t1764 / 0.4e1 + t1016 * t1017 * t4972 / 0.12e2 - t1022 * t1023 * t4972 / 0.12e2 + t1339 * t4966 * t4058 / 0.2916e4 + t442 * t443 * t1887 / 0.576e3 - t447 * t448 * t3887 / 0.576e3 + t335 * t336 * t4988 / 0.72e2 - t330 * t331 * t2338 / 0.72e2;
  t5002 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t1726 * t470 - 0.3e1 / 0.8e1 * t4630 - 0.9e1 / 0.8e1 * t5 * t748 * t1089 + t4595 / 0.4e1 - 0.3e1 / 0.4e1 * t4637 - 0.9e1 / 0.8e1 * t5 * t303 * t2390 - t4556 + t4606 / 0.4e1 - 0.3e1 / 0.8e1 * t4645 - 0.3e1 / 0.8e1 * t5 * t114 * (t4812 + t4872 + t4930 + t4995));
  tv4rho3sigma11 = t6 * t5002 + 0.3e1 * t2395;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t5009 = t5 * t496 * t1160;
  t5016 = t5 * t505 * t1160 / 0.12e2;
  t5018 = t5 * t186 * t2561;
  t5020 = t903 * t2526;
  t5023 = t903 * t2509;
  t5033 = t909 * t2509;
  t5038 = params->c * sigma[0];
  t5049 = t903 * t2518;
  t5053 = t1339 * t2438 * t1347;
  t5058 = t528 * t2438 * t535;
  t5083 = t909 * t2518;
  t5089 = t5058 * t3006 / 0.1728e4 - 0.4e1 / 0.9e1 * t1987 * t2519 + t2522 * t4418 / 0.144e3 + t43 * t914 * t2517 * t627 / 0.12e2 - t43 * t914 * t2525 * t627 / 0.4e1 + 0.4e1 / 0.3e1 * t1987 * t2527 - 0.8e1 / 0.9e1 * t1987 * t2510 + t43 * t914 * t945 * t2132 / 0.6e1 - t2514 * t4415 / 0.144e3 - t1995 * t5083 / 0.54e2 - t218 * t543 * t1131 / 0.12e2;
  t5109 = t528 * t920;
  t5124 = t224 * t547 * t2461 / 0.12e2 - t395 * t2141 / 0.18e2 + 0.2e1 / 0.9e1 * t50 * t213 * t2505 - 0.65e2 / 0.324e3 * t2014 * t2435 + 0.65e2 / 0.324e3 * t2041 * t2432 + t400 * t2138 / 0.18e2 - t2538 * t3093 / 0.1152e4 + t2541 * t3064 / 0.1152e4 + 0.5e1 / 0.216e3 * t5109 * t232 * sigma[0] * t258 - 0.17e2 / 0.216e3 * t528 * t555 * t232 * t418 * t202 + 0.17e2 / 0.216e3 * t559 * t561 * params->c * t202 * t1110;
  t5131 = t1293 * t2829;
  t5134 = t1298 * t2829;
  t5137 = t1293 * t2851;
  t5140 = t1298 * t2851;
  t5153 = 0.4e1 / 0.9e1 * t2037 * t2557 + t2031 * t4506 / 0.108e3 - t2034 * t4509 / 0.108e3 + t1292 * t5131 / 0.81e2 - t1297 * t5134 / 0.81e2 - t1292 * t5137 / 0.162e3 + t1297 * t5140 / 0.162e3 - 0.22e2 / 0.27e2 * t4478 * t1111 + t2552 * t909 * t2021 / 0.144e3 - t2548 * t903 * t2021 / 0.144e3 - t2541 * t3074 / 0.576e3;
  t5204 = 0.1e1 / t36 / t530 / t518;
  t5205 = t529 * t5204;
  t5218 = 0.19e2 / 0.162e3 * t198 * t2013 * t209 - 0.167e3 / 0.1296e4 * t528 * t555 * sigma[0] - t2031 * t4362 / 0.54e2 + t2034 * t4359 / 0.54e2 + t913 * t2005 / 0.3e1 + t913 * t1991 / 0.6e1 - 0.8e1 / 0.9e1 * t2037 * t947 + t3029 * t5205 * t3107 / 0.7776e4 - t1339 * t5205 * t3112 / 0.7776e4 - t400 * t401 * t4346 / 0.288e3 + t395 * t396 * t2133 / 0.288e3;
  t5239 = t57 * t1137 * t582;
  t5270 = -0.7e1 / 0.72e2 * t5239 * t91 - 0.261e3 / 0.32e2 * t5239 * t3173 - 0.11e2 / 0.72e2 * t5239 * t244 + t5239 * t596 / 0.24e2 - t5239 * t608 / 0.16e2 - 0.27e2 / 0.256e3 * t5239 * t619 - 0.1215e4 / 0.256e3 * t5239 * t3137 + 0.2079e4 / 0.1024e4 * t5239 * t1409 + 0.891e3 / 0.512e3 * t5239 * t1419 - 0.1701e4 / 0.256e3 * t5239 * t3194 + 0.33e2 / 0.32e2 * t5239 * t1440 - 0.45e2 / 0.16e2 * t5239 * t3181 + 0.15e2 / 0.4e1 * t5239 * t3169 - 0.891e3 / 0.256e3 * t5239 * t1432 + 0.189e3 / 0.16e2 * t5239 * t3186;
  t5308 = 0.405e3 / 0.32e2 * t5239 * t3126 + 0.11e2 / 0.72e2 * t5239 * t1423 - 0.33e2 / 0.32e2 * t5239 * t1427 + t5239 * t3141 / 0.18e2 - 0.19e2 / 0.16e2 * t5239 * t3145 + 0.297e3 / 0.128e3 * t1144 * t2120 - 0.405e3 / 0.64e2 * t1144 * t589 * t3201 + 0.675e3 / 0.32e2 * t1144 * t589 * t3205 - 0.18711e5 / 0.1024e4 * t1144 * t589 * t3223 + 0.5e1 * t1144 * t589 * t3227 - 0.1251e4 / 0.64e2 * t1144 * t589 * t3231 - 0.891e3 / 0.128e3 * t1144 * t2117 - 0.11e2 / 0.32e2 * t1144 * t590 + 0.3e1 / 0.8e1 * t1144 * t600 - 0.9e1 / 0.64e2 * t1144 * t624 + 0.143e3 / 0.32e2 * t1144 * t2129;
  t5314 = t909 * t2526;
  t5323 = -t43 * t4243 * t4244 * t970 - 0.19e2 / 0.162e3 * t201 * t544 + 0.19e2 / 0.162e3 * t1107 * t548 - 0.167e3 / 0.1296e4 * t1982 * t2415 + 0.25e2 / 0.3456e4 * t2403 * t1974 + 0.167e3 / 0.1296e4 * t1977 * t2411 - t3029 * t529 * t5204 * t3037 * t3039 / 0.7776e4 - t50 * t51 * t232 * (t5270 + t5308) / 0.24e2 + t1995 * t5314 / 0.18e2 + t2514 * t4521 / 0.48e2 + t43 * t914 * t3254 * t1130 * t576;
  t5326 = t568 * t2504;
  t5333 = t970 * t970;
  t5350 = t202 * t1972;
  t5359 = -t2522 * t4524 / 0.48e2 + t224 * t225 * t5326 / 0.108e3 - t218 * t219 * t2505 / 0.108e3 + t50 * t51 * t575 * t5333 / 0.6e1 + 0.22e2 / 0.27e2 * t50 * t539 * t1131 - 0.11e2 / 0.27e2 * t50 * t539 * t1156 - t224 * t547 * t2453 / 0.24e2 + t218 * t543 * t1156 / 0.24e2 - 0.25e2 / 0.3456e4 * t1339 * t5350 * t1351 + 0.25e2 / 0.3456e4 * t528 * t5350 * t1357 - t913 * t2010 / 0.2e1;
  t5367 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t492 * t1160 - t5009 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t180 * t2561 + t5016 - t5018 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t5124 - t902 * t2549 / 0.27e2 + t908 * t2553 / 0.27e2 + t4216 * t4514 / 0.648e3 - t4220 * t4518 / 0.648e3 + t2538 * t3071 / 0.576e3 - t1995 * t5033 / 0.27e2 + t2522 * t4426 / 0.72e2 + t1999 * t5049 / 0.54e2 - t5053 * t2999 / 0.1728e4 - t1999 * t5020 / 0.18e2 + t1999 * t5023 / 0.27e2 - t2514 * t4429 / 0.72e2 + t5089 + t5153 + t5323 + t5218 - t913 * t914 * t231 * t2132 / 0.12e2 - 0.5e1 / 0.216e3 * t559 * t925 * t5038 * t915 + t5359 - t2552 * t909 * t2017 / 0.288e3 + t2548 * t903 * t2017 / 0.288e3 + t43 * t914 * t574 * t2504 * t258 / 0.6e1 - t223 * t901 * t46 * t5038 * t946 / 0.9e1 + t2531 * t575 * t418 * sigma[0] * t258 / 0.9e1 - t43 * t914 * t1318 * t1155 * t576 / 0.4e1));
  tv4rho2sigma20 = t6 * t5367 + 0.2e1 * t2566;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t5374 = t5 * t655 * t1228;
  t5378 = t5 * t659 * t1228 / 0.12e2;
  t5380 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t651 * t1228 - t5374 / 0.4e1 + t5378);
  tv4rho2sigma25 = t6 * t5380 + 0.2e1 * t2575;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t5386 = t5 * t680 * t1160;
  t5394 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t676 * t1160 - t5386 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t292 * t2561 - t5009 / 0.8e1 + t5016 - t5018 / 0.8e1);
  tv4rho2sigma26 = t6 * t5394 + t2566 + t2581;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t5400 = t5 * t704 * t1228;
  t5407 = t5 * t279 * t2744;
  t5410 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t700 * t1228 - t5400 / 0.8e1 - t5374 / 0.8e1 + t5378 - 0.3e1 / 0.8e1 * t5 * t275 * t2744 - t5407 / 0.8e1);
  tv4rho2sigma211 = t6 * t5410 + t2575 + t2749;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t5418 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t731 * t1160 - t5386 / 0.4e1 + t5016);
  tv4rho2sigma212 = t6 * t5418 + 0.2e1 * t2581;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t5456 = t1017 * t2682;
  t5468 = t1023 * t2682;
  t5471 = t1017 * t2692;
  t5474 = t1023 * t2688;
  t5477 = t1023 * t2692;
  t5485 = t1017 * t2688;
  t5491 = t1339 * t2603 * t1747;
  t5494 = -t2678 * t4768 / 0.48e2 + t2675 * t4765 / 0.48e2 + t123 * t1028 * t4068 * t1198 * t816 - t2370 * t5468 / 0.54e2 + t2353 * t5471 / 0.27e2 + t2370 * t5474 / 0.18e2 - t2370 * t5477 / 0.27e2 + t123 * t1028 * t814 * t2666 * t368 / 0.6e1 - t2353 * t5485 / 0.18e2 + t2678 * t4771 / 0.72e2 - t5491 * t3838 / 0.1728e4;
  t5502 = t528 * t2603 * t776;
  t5521 = t57 * t1205 * t822;
  t5557 = -0.7e1 / 0.72e2 * t5521 * t158 + 0.675e3 / 0.32e2 * t1212 * t829 * t3966 - 0.18711e5 / 0.1024e4 * t1212 * t829 * t3953 + 0.297e3 / 0.128e3 * t1212 * t2322 - 0.405e3 / 0.64e2 * t1212 * t829 * t3944 - 0.11e2 / 0.32e2 * t1212 * t830 + 0.3e1 / 0.8e1 * t1212 * t840 - 0.9e1 / 0.64e2 * t1212 * t864 + 0.143e3 / 0.32e2 * t1212 * t2329 + 0.5e1 * t1212 * t829 * t3957 - 0.1251e4 / 0.64e2 * t1212 * t829 * t3962 - 0.891e3 / 0.128e3 * t1212 * t2332 - t5521 * t848 / 0.16e2 - 0.27e2 / 0.256e3 * t5521 * t859 - 0.1215e4 / 0.256e3 * t5521 * t3913;
  t5590 = -0.45e2 / 0.16e2 * t5521 * t3898 + 0.2079e4 / 0.1024e4 * t5521 * t1819 + 0.891e3 / 0.512e3 * t5521 * t1829 - 0.1701e4 / 0.256e3 * t5521 * t3989 + 0.405e3 / 0.32e2 * t5521 * t3994 + 0.33e2 / 0.32e2 * t5521 * t1850 + 0.15e2 / 0.4e1 * t5521 * t3925 - 0.891e3 / 0.256e3 * t5521 * t1842 + 0.189e3 / 0.16e2 * t5521 * t3981 + 0.11e2 / 0.72e2 * t5521 * t1833 - 0.33e2 / 0.32e2 * t5521 * t1837 + t5521 * t3917 / 0.18e2 - 0.19e2 / 0.16e2 * t5521 * t3921 - 0.261e3 / 0.32e2 * t5521 * t3976 - 0.11e2 / 0.72e2 * t5521 * t354 + t5521 * t836 / 0.24e2;
  t5606 = t2714 * t815 * t465 * sigma[2] * t368 / 0.9e1 + t5502 * t3850 / 0.1728e4 - t2675 * t4762 / 0.72e2 - t223 * t1015 * t126 * params->c * sigma[2] * t1060 / 0.9e1 + t4792 * t4809 / 0.648e3 - t4796 * t4788 / 0.648e3 - t123 * t4827 * t4828 * t1084 - t130 * t131 * t343 * (t5557 + t5590) / 0.24e2 - t447 * t448 * t4988 / 0.288e3 - t1016 * t1017 * t2737 * sigma[2] / 0.18e2 + t442 * t443 * t2338 / 0.288e3;
  t5609 = 0.1e1 / t116 / t771 / t763;
  t5610 = t770 * t5609;
  t5637 = t3029 * t5610 * t4053 / 0.7776e4 - t1339 * t5610 * t4058 / 0.7776e4 + t2285 * t4960 / 0.54e2 - t2282 * t4963 / 0.54e2 + t1027 * t2367 / 0.6e1 - 0.8e1 / 0.9e1 * t2288 * t1061 + t1027 * t2363 / 0.3e1 - t2733 * t1023 * t2278 / 0.288e3 + t2726 * t4136 / 0.1152e4 - t1016 * t2730 / 0.27e2 + t2729 * t1017 * t2278 / 0.288e3;
  t5653 = t1774 * t2935;
  t5656 = t1779 * t2935;
  t5659 = t1774 * t2952;
  t5662 = t1779 * t2952;
  t5674 = t1084 * t1084;
  t5699 = t314 * t2217;
  t5703 = -0.11e2 / 0.27e2 * t130 * t780 * t1224 - t1027 * t2376 / 0.2e1 + t130 * t131 * t815 * t5674 / 0.6e1 + t330 * t784 * t1224 / 0.24e2 + t335 * t788 * t2623 / 0.12e2 - t330 * t784 * t1199 / 0.12e2 - t335 * t788 * t2616 / 0.24e2 + t447 * t2346 / 0.18e2 + 0.2e1 / 0.9e1 * t130 * t325 * t2667 - t330 * t331 * t2667 / 0.108e3 + 0.25e2 / 0.3456e4 * t528 * t5699 * t1908;
  t5712 = t808 * t2666;
  t5736 = -0.65e2 / 0.324e3 * t2295 * t2598 - 0.25e2 / 0.3456e4 * t1339 * t5699 * t1903 + 0.65e2 / 0.324e3 * t2292 * t2595 + t335 * t336 * t5712 / 0.108e3 - t3029 * t770 * t5609 * t4049 * t3039 / 0.7776e4 + 0.167e3 / 0.1296e4 * t2222 * t2706 - 0.167e3 / 0.1296e4 * t2227 * t2710 + 0.25e2 / 0.3456e4 * t1339 * t2217 * t1747 * t314 * t1374 + 0.19e2 / 0.162e3 * t1107 * t789 - 0.19e2 / 0.162e3 * t201 * t785 - 0.22e2 / 0.27e2 * t4892 * t1179;
  t5745 = sigma[2] * t1008;
  t5746 = t559 * t5745;
  t5751 = t528 * t5745;
  t5768 = 0.4e1 / 0.9e1 * t2288 * t2738 + t2733 * t1023 * t2267 / 0.144e3 - t2729 * t1017 * t2267 / 0.144e3 - 0.5e1 / 0.216e3 * t5746 * t1780 - t2726 * t4116 / 0.576e3 + 0.5e1 / 0.216e3 * t5751 * t1775 + t2723 * t4113 / 0.576e3 - t1027 * t1028 * t342 * t2337 / 0.12e2 + t1022 * t2734 / 0.27e2 + 0.19e2 / 0.162e3 * t198 * t2291 * t321 - 0.167e3 / 0.1296e4 * t528 * t796 * sigma[2];
  t5776 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t748 * t1228 - t5400 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t303 * t2744 + t5378 - t5407 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * (t5494 + t5703 + t5768 + t2353 * t5456 / 0.54e2 - t1778 * t5656 / 0.81e2 - t1773 * t5659 / 0.162e3 + t1778 * t5662 / 0.162e3 - t2723 * t4133 / 0.1152e4 + t2282 * t4924 / 0.108e3 - t2285 * t4927 / 0.108e3 + t1773 * t5653 / 0.81e2 - 0.8e1 / 0.9e1 * t2358 * t2693 - 0.4e1 / 0.9e1 * t2358 * t2683 + 0.4e1 / 0.3e1 * t2358 * t2689 + t2678 * t4820 / 0.144e3 - t2675 * t4817 / 0.144e3 + t5637 + t123 * t1028 * t2681 * t867 / 0.12e2 + t123 * t1028 * t1059 * t2337 / 0.6e1 - t123 * t1028 * t2687 * t867 / 0.4e1 - 0.17e2 / 0.216e3 * t4906 * t343 * t465 * t314 + t5606 + t5736 + 0.17e2 / 0.216e3 * t4911 * t4912 * t1178 + 0.22e2 / 0.27e2 * t130 * t780 * t1199 - t123 * t1028 * t1929 * t1223 * t816 / 0.4e1));
  tv4rho2sigma217 = t6 * t5776 + 0.2e1 * t2749;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t5783 = t5 * t186 * t2862 / 0.8e1;
  t5802 = t909 * t2756;
  t5809 = t903 * t2756;
  t5826 = t528 * t2822 * t535;
  t5830 = t1339 * t2822 * t1347;
  t5833 = -0.3e1 / 0.4e1 * t43 * t914 * t2525 * t970 + t43 * t914 * t2003 * t1155 / 0.4e1 - t2514 * t5023 / 0.48e2 + t43 * t914 * t945 * t2504 / 0.4e1 + t43 * t914 * t3254 * t2751 * t258 - t1995 * t5802 / 0.36e2 + t2514 * t5020 / 0.32e2 + t2522 * t5033 / 0.48e2 + t1999 * t5809 / 0.36e2 + t43 * t914 * t574 * t2809 * t258 / 0.12e2 - t2522 * t5314 / 0.32e2 + t2522 * t5083 / 0.96e2 - t2514 * t5049 / 0.96e2 + t5058 * t4518 / 0.1152e4 - t5826 * t3006 / 0.9216e4 + t5830 * t2999 / 0.9216e4;
  t5865 = t57 * t2768 * t234;
  t5874 = 0.56133e5 / 0.8192e4 * t2775 * t248 * t3223 + 0.81e2 / 0.128e3 * t2775 * t2501 + 0.1215e4 / 0.512e3 * t2775 * t248 * t3201 - 0.243e3 / 0.128e3 * t2775 * t2486 - 0.2025e4 / 0.256e3 * t2775 * t248 * t3205 + 0.3e1 / 0.4e1 * t2775 * t960 - 0.9e1 / 0.32e2 * t2775 * t967 + 0.39e2 / 0.32e2 * t2775 * t2477 - 0.15e2 / 0.8e1 * t2775 * t248 * t3227 + 0.3753e4 / 0.512e3 * t2775 * t248 * t3231 - 0.3e1 / 0.32e2 * t2775 * t255 - t5865 * t244 / 0.24e2 + t5865 * t596 / 0.12e2 - t5865 * t608 / 0.8e1 + 0.57e2 / 0.128e3 * t5865 * t3145;
  t5907 = 0.3645e4 / 0.2048e4 * t5865 * t3137 + 0.135e3 / 0.128e3 * t5865 * t3181 + 0.567e3 / 0.1024e4 * t5865 * t1409 + 0.243e3 / 0.512e3 * t5865 * t1419 + 0.5103e4 / 0.2048e4 * t5865 * t3194 - 0.567e3 / 0.128e3 * t5865 * t3186 - 0.1215e4 / 0.256e3 * t5865 * t3126 + 0.9e1 / 0.32e2 * t5865 * t1440 + 0.783e3 / 0.256e3 * t5865 * t3173 - 0.45e2 / 0.32e2 * t5865 * t3169 - 0.243e3 / 0.256e3 * t5865 * t1432 - 0.27e2 / 0.128e3 * t5865 * t619 + t5865 * t1423 / 0.24e2 - 0.9e1 / 0.32e2 * t5865 * t1427 - t5865 * t3141 / 0.48e2 - t5865 * t91 / 0.16e2;
  t5916 = t3260 * t2751;
  t5934 = t568 * t2809;
  t5944 = sigma[0] * t2405;
  t5951 = -t5053 * t4514 / 0.1152e4 + t5109 / 0.48e2 - t50 * t51 * t232 * (t5874 + t5907) / 0.24e2 - t218 * t219 * t2752 / 0.36e2 + t224 * t225 * t5916 / 0.36e2 + 0.2e1 / 0.3e1 * t50 * t213 * t2752 + t50 * t213 * t2810 / 0.9e1 + t395 * t2457 / 0.12e2 + t400 * t2454 / 0.24e2 - t395 * t2450 / 0.24e2 - t400 * t2462 / 0.12e2 + t224 * t225 * t5934 / 0.216e3 + t395 * t396 * t2505 / 0.192e3 - t218 * t219 * t2810 / 0.216e3 + 0.7e1 / 0.3456e4 * t1339 * t5944 * t1351 - 0.7e1 / 0.3456e4 * t528 * t5944 * t1357;
  t5956 = 0.1e1 / t36 / t3043;
  t5957 = t202 * t5956;
  t5991 = t2538 * t4362 / 0.192e3 - t3029 * t5957 * t3107 / 0.20736e5 + t1339 * t5957 * t3112 / 0.20736e5 - 0.3e1 / 0.4e1 * t913 * t2527 + t913 * t2510 / 0.2e1 - t400 * t401 * t5326 / 0.192e3 + t913 * t2519 / 0.4e1 + t2552 * t1996 / 0.48e2 - t2548 * t2000 / 0.48e2 - t2541 * t4359 / 0.192e3 + t2031 * t5137 / 0.144e3 - t2034 * t5140 / 0.144e3 - t2031 * t5131 / 0.72e2 + t2034 * t5134 / 0.72e2 + t2037 * t2852 / 0.3e1 + t908 * t2848 / 0.18e2;
  t5994 = sigma[0] * t894;
  t6018 = t1347 * t28;
  t6042 = -t902 * t2845 / 0.18e2 - 0.5e1 / 0.144e3 * t559 * t5994 * t2028 + 0.5e1 / 0.144e3 * t528 * t5994 * t2025 - 0.2e1 / 0.3e1 * t2037 * t2830 - t913 * t914 * t231 * t2504 / 0.8e1 + t2548 * t903 * t2556 / 0.96e2 - t2552 * t909 * t2556 / 0.96e2 - t2538 * t4506 / 0.384e3 + t2541 * t4509 / 0.384e3 - 0.7e1 / 0.3456e4 * t1339 * t2405 * t6018 * t41 + t3029 * t202 * t5956 * t3037 * t3039 / 0.20736e5 - t2833 * t1294 / 0.384e3 + t2837 * t1299 / 0.384e3 - 0.3e1 / 0.4e1 * t43 * t4243 * t418 * t1155 * t258 - 0.2e1 / 0.3e1 * t1987 * t2757 - t2410 * t2834 / 0.48e2 + t2414 * t2838 / 0.48e2;
  t6049 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t180 * t2862 - t5783 - 0.3e1 / 0.8e1 * t5 * t27 * (t5833 + t5951 + t5991 + t6042));
  tv4rhosigma30 = t6 * t6049 + t2866;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t6056 = t5 * t279 * t2978 / 0.8e1;
  t6058 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t275 * t2978 - t6056);
  tv4rhosigma39 = t6 * t6058 + t2982;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t6064 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t292 * t2862 - t5783);
  tv4rhosigma310 = t6 * t6064 + t2866;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t6077 = t1023 * t2963;
  t6088 = t1017 * t2963;
  t6110 = t4074 * t2970;
  t6114 = t123 * t1028 * t1059 * t2666 / 0.4e1 + t123 * t1028 * t2361 * t1223 / 0.4e1 - t2370 * t6077 / 0.36e2 - t2678 * t5474 / 0.32e2 + t2678 * t5477 / 0.48e2 - 0.3e1 / 0.4e1 * t123 * t1028 * t2687 * t1084 + t2353 * t6088 / 0.36e2 + t2675 * t5485 / 0.32e2 - t2675 * t5471 / 0.48e2 + t123 * t1028 * t4068 * t2970 * t368 - 0.2e1 / 0.3e1 * t2358 * t2964 - t2675 * t5456 / 0.96e2 + t5502 * t4788 / 0.1152e4 - t5491 * t4809 / 0.1152e4 - t330 * t331 * t2971 / 0.36e2 + t335 * t336 * t6110 / 0.36e2;
  t6132 = t2935 * sigma[2];
  t6141 = sigma[2] * t2602;
  t6153 = t808 * t2917;
  t6157 = -t2726 * t4960 / 0.192e3 + t2733 * t2371 / 0.48e2 + t1027 * t2683 / 0.4e1 + t2723 * t4963 / 0.192e3 - t2729 * t2354 / 0.48e2 + t442 * t443 * t2667 / 0.192e3 - 0.3e1 / 0.4e1 * t1027 * t2689 + t1027 * t2693 / 0.2e1 + t1016 * t1017 * t6132 / 0.12e2 - t1022 * t1023 * t6132 / 0.12e2 + t447 * t2617 / 0.24e2 + 0.7e1 / 0.3456e4 * t1339 * t6141 * t1903 - 0.7e1 / 0.3456e4 * t528 * t6141 * t1908 - t442 * t2613 / 0.24e2 - t330 * t331 * t2918 / 0.216e3 + t335 * t336 * t6153 / 0.216e3;
  t6163 = 0.1e1 / t116 / t3864;
  t6164 = t314 * t6163;
  t6199 = t57 * t2876 * t345;
  t6208 = -0.3e1 / 0.32e2 * t2883 * t365 + 0.3e1 / 0.4e1 * t2883 * t1074 - 0.9e1 / 0.32e2 * t2883 * t1081 + 0.39e2 / 0.32e2 * t2883 * t2639 - 0.15e2 / 0.8e1 * t2883 * t358 * t3957 + 0.3753e4 / 0.512e3 * t2883 * t358 * t3962 - 0.243e3 / 0.128e3 * t2883 * t2648 - 0.2025e4 / 0.256e3 * t2883 * t358 * t3966 + 0.56133e5 / 0.8192e4 * t2883 * t358 * t3953 + 0.81e2 / 0.128e3 * t2883 * t2663 + 0.1215e4 / 0.512e3 * t2883 * t358 * t3944 - t6199 * t158 / 0.16e2 + 0.567e3 / 0.1024e4 * t6199 * t1819 + 0.243e3 / 0.512e3 * t6199 * t1829 + 0.5103e4 / 0.2048e4 * t6199 * t3989;
  t6241 = 0.9e1 / 0.32e2 * t6199 * t1850 - 0.45e2 / 0.32e2 * t6199 * t3925 - 0.243e3 / 0.256e3 * t6199 * t1842 - 0.567e3 / 0.128e3 * t6199 * t3981 - 0.1215e4 / 0.256e3 * t6199 * t3994 - t6199 * t3917 / 0.48e2 + 0.57e2 / 0.128e3 * t6199 * t3921 + 0.783e3 / 0.256e3 * t6199 * t3976 + t6199 * t836 / 0.12e2 - t6199 * t848 / 0.8e1 - 0.27e2 / 0.128e3 * t6199 * t859 + t6199 * t1833 / 0.24e2 - 0.9e1 / 0.32e2 * t6199 * t1837 - t6199 * t354 / 0.24e2 + 0.3645e4 / 0.2048e4 * t6199 * t3913 + 0.135e3 / 0.128e3 * t6199 * t3898;
  t6254 = t1339 * t2925 * t1747;
  t6258 = t528 * t2925 * t776;
  t6280 = -t447 * t448 * t5712 / 0.192e3 - t3029 * t6164 * t4053 / 0.20736e5 + t1339 * t6164 * t4058 / 0.20736e5 - t130 * t131 * t343 * (t6208 + t6241) / 0.24e2 + 0.2e1 / 0.3e1 * t130 * t325 * t2971 + t130 * t325 * t2918 / 0.9e1 + t6254 * t3838 / 0.9216e4 - t6258 * t3850 / 0.9216e4 + t2678 * t5468 / 0.96e2 + t2288 * t2953 / 0.3e1 + 0.5e1 / 0.144e3 * t5751 * t2271 - t1016 * t2958 / 0.18e2 - t1027 * t1028 * t342 * t2666 / 0.8e1 - t2723 * t4924 / 0.384e3 + t2729 * t1017 * t2737 / 0.96e2 + t2285 * t5656 / 0.72e2;
  t6298 = t814 * t2917;
  t6325 = -t2282 * t5653 / 0.72e2 + t2726 * t4927 / 0.384e3 - t2733 * t1023 * t2737 / 0.96e2 + t2282 * t5659 / 0.144e3 - t2285 * t5662 / 0.144e3 - 0.2e1 / 0.3e1 * t2288 * t2936 - 0.5e1 / 0.144e3 * t5746 * t2274 + t1022 * t2949 / 0.18e2 + t123 * t1028 * t6298 * t368 / 0.12e2 - 0.3e1 / 0.4e1 * t123 * t4827 * t465 * t1223 * t368 + t2943 * t1780 / 0.384e3 - t2939 * t1775 / 0.384e3 + t3029 * t314 * t6163 * t4049 * t3039 / 0.20736e5 - 0.7e1 / 0.3456e4 * t2867 * t2702 + t528 * t1034 / 0.48e2 - t2705 * t2940 / 0.48e2 + t2709 * t2944 / 0.48e2;
  t6332 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t303 * t2978 - t6056 - 0.3e1 / 0.8e1 * t5 * t114 * (t6114 + t6157 + t6280 + t6325));
  tv4rhosigma319 = t6 * t6332 + t2982;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t6356 = t1155 * t1155;
  t6361 = t1130 * t1130;
  t6367 = t58 / t59 / t529;
  t6369 = t57 * t6367 * t62;
  t6372 = t57 * t6367;
  t6406 = -0.15e2 / 0.128e3 * t6369 * t91 - 0.243e3 / 0.256e3 * t6372 * t2806 - 0.3645e4 / 0.4096e4 * t6372 * t414 * t3201 + 0.6075e4 / 0.2048e4 * t6372 * t414 * t3205 - 0.168399e6 / 0.65536e5 * t6372 * t414 * t3223 + 0.45e2 / 0.64e2 * t6372 * t414 * t3227 - 0.11259e5 / 0.4096e4 * t6372 * t414 * t3231 + 0.729e3 / 0.256e3 * t6372 * t2791 + 0.9e1 / 0.64e2 * t6372 * t415 + 0.63e2 / 0.64e2 * t6372 * t1145 - 0.189e3 / 0.512e3 * t6372 * t1152 - 0.117e3 / 0.64e2 * t6372 * t2782 + t6369 * t3141 / 0.128e3 - 0.171e3 / 0.1024e4 * t6369 * t3145 - 0.2349e4 / 0.2048e4 * t6369 * t3173;
  t6439 = 0.135e3 / 0.256e3 * t6369 * t3169 - 0.567e3 / 0.2048e4 * t6369 * t619 - t6369 * t1423 / 0.16e2 + 0.27e2 / 0.64e2 * t6369 * t1427 + t6369 * t244 / 0.16e2 + 0.7e1 / 0.64e2 * t6369 * t596 - 0.21e2 / 0.128e3 * t6369 * t608 - 0.1701e4 / 0.2048e4 * t6369 * t1409 - 0.729e3 / 0.1024e4 * t6369 * t1419 - 0.15309e5 / 0.16384e5 * t6369 * t3194 - 0.10935e5 / 0.16384e5 * t6369 * t3137 - 0.27e2 / 0.64e2 * t6369 * t1440 - 0.405e3 / 0.1024e4 * t6369 * t3181 + 0.729e3 / 0.512e3 * t6369 * t1432 + 0.1701e4 / 0.1024e4 * t6369 * t3186 + 0.3645e4 / 0.2048e4 * t6369 * t3126;
  t6453 = 0.1e1 / t36 / t1341;
  t6454 = sigma[0] * t6453;
  t6461 = -0.3e1 / 0.2e1 * t43 * t914 * t2525 * t1155 + t2522 * t5802 / 0.24e2 + t43 * t914 * t945 * t2809 / 0.3e1 + t5830 * t4514 / 0.2304e4 - t5826 * t4518 / 0.2304e4 - t2514 * t5809 / 0.24e2 + t395 * t396 * t2752 / 0.24e2 - t400 * t401 * t5916 / 0.24e2 + t50 * t51 * t575 * t6356 / 0.4e1 + t50 * t51 * t3255 * t6361 - t50 * t51 * t232 * (t6406 + t6439) / 0.24e2 + t395 * t396 * t2810 / 0.144e3 - t400 * t401 * t5934 / 0.144e3 + t913 * t2757 + t3029 * t6454 * t3107 / 0.55296e5 - t1339 * t6454 * t3112 / 0.55296e5;
  t6512 = t528 * t2821 * t535 * t52 * t33 * t95 / 0.2304e4 - t1339 * t2858 * t96 * t1374 / 0.2304e4 - t2552 * t909 * t2851 / 0.48e2 + t2548 * t903 * t2851 / 0.48e2 + t2552 * t909 * t2829 / 0.24e2 - t913 * t914 * t231 * t2809 / 0.6e1 - t2548 * t903 * t2829 / 0.24e2 - t913 * t914 * t1318 * t2751 - t2538 * t5137 / 0.192e3 + t2541 * t5140 / 0.192e3 + t2538 * t5131 / 0.96e2 - t2541 * t5134 / 0.96e2 - t3029 * sigma[0] * t6453 * t3037 * t3039 / 0.55296e5 - t2833 * t2025 / 0.96e2 + t2837 * t2028 / 0.96e2 + t1339 * t2821 * t6018 * t33 / 0.2304e4;
  t6517 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (t6461 + t6512));
  tv4sigma40 = t6 * t6517;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t6524 = t58 / t135 / t770;
  t6525 = t57 * t6524;
  t6554 = t57 * t6524 * t138;
  t6563 = -0.189e3 / 0.512e3 * t6525 * t1220 - 0.117e3 / 0.64e2 * t6525 * t2890 - 0.243e3 / 0.256e3 * t6525 * t2914 - 0.3645e4 / 0.4096e4 * t6525 * t461 * t3944 + 0.6075e4 / 0.2048e4 * t6525 * t461 * t3966 - 0.168399e6 / 0.65536e5 * t6525 * t461 * t3953 + 0.45e2 / 0.64e2 * t6525 * t461 * t3957 - 0.11259e5 / 0.4096e4 * t6525 * t461 * t3962 + 0.729e3 / 0.256e3 * t6525 * t2899 + 0.9e1 / 0.64e2 * t6525 * t462 + 0.63e2 / 0.64e2 * t6525 * t1213 + 0.7e1 / 0.64e2 * t6554 * t836 - 0.21e2 / 0.128e3 * t6554 * t848 - 0.567e3 / 0.2048e4 * t6554 * t859 - t6554 * t1833 / 0.16e2;
  t6596 = 0.27e2 / 0.64e2 * t6554 * t1837 + t6554 * t354 / 0.16e2 - 0.15309e5 / 0.16384e5 * t6554 * t3989 - 0.10935e5 / 0.16384e5 * t6554 * t3913 - 0.27e2 / 0.64e2 * t6554 * t1850 - 0.405e3 / 0.1024e4 * t6554 * t3898 - 0.1701e4 / 0.2048e4 * t6554 * t1819 - 0.729e3 / 0.1024e4 * t6554 * t1829 + 0.729e3 / 0.512e3 * t6554 * t1842 + 0.1701e4 / 0.1024e4 * t6554 * t3981 + 0.3645e4 / 0.2048e4 * t6554 * t3994 + t6554 * t3917 / 0.128e3 - 0.171e3 / 0.1024e4 * t6554 * t3921 - 0.2349e4 / 0.2048e4 * t6554 * t3976 + 0.135e3 / 0.256e3 * t6554 * t3925 - 0.15e2 / 0.128e3 * t6554 * t158;
  t6605 = t1198 * t1198;
  t6609 = t1223 * t1223;
  t6615 = 0.1e1 / t116 / t1743;
  t6616 = sigma[2] * t6615;
  t6644 = t1027 * t2964 + t442 * t443 * t2971 / 0.24e2 - t130 * t131 * t343 * (t6563 + t6596) / 0.24e2 - t447 * t448 * t6110 / 0.24e2 + t130 * t131 * t4069 * t6605 + t130 * t131 * t815 * t6609 / 0.4e1 + t3029 * t6616 * t4053 / 0.55296e5 - t1339 * t6616 * t4058 / 0.55296e5 - t447 * t448 * t6153 / 0.144e3 + t442 * t443 * t2918 / 0.144e3 - t2729 * t1017 * t2935 / 0.24e2 + t2733 * t1023 * t2935 / 0.24e2 + t2726 * t5662 / 0.192e3 + t2723 * t5653 / 0.96e2 - t2726 * t5656 / 0.96e2 - t1027 * t1028 * t1929 * t2970;
  t6697 = -t2733 * t1023 * t2952 / 0.48e2 - t1027 * t1028 * t342 * t2917 / 0.6e1 - t1339 * t2870 * t163 * t1374 / 0.2304e4 + t528 * t2869 * t776 * t52 * t33 * t162 / 0.2304e4 + t2729 * t1017 * t2952 / 0.48e2 - t2723 * t5659 / 0.192e3 - t2939 * t2271 / 0.96e2 + t2943 * t2274 / 0.96e2 - t3029 * sigma[2] * t6615 * t4049 * t3039 / 0.55296e5 + t1339 * t2869 * t1747 * t28 * t33 / 0.2304e4 + t2678 * t6077 / 0.24e2 + t123 * t1028 * t6298 * t465 / 0.3e1 - t6258 * t4788 / 0.2304e4 - t2675 * t6088 / 0.24e2 + t6254 * t4809 / 0.2304e4 - 0.3e1 / 0.2e1 * t123 * t1028 * t2687 * t1223;
  t6702 = my_piecewise3(t105, 0, -0.3e1 / 0.8e1 * t5 * t114 * (t6644 + t6697));
  tv4sigma414 = t6 * t6702;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

