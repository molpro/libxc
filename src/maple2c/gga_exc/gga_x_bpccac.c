/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_bpccac.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t24;
  double t25, t27, t28, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t42;
  double t43, t44, t46, t49, t52, t55, t56, t59;
  double t61, t62, t63, t64, t65, t66, t68, t71;
  double t72, t74, t75, t76, t79, t80, t83, t84;
  double t86, t88, t92, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = sqrt(sigma[0]);
  t21 = M_CBRT2;
  t24 = 0.1e1 / t18 / rho[0];
  t25 = t20 * t21 * t24;
  t27 = exp(-t25 + 0.19e2);
  t28 = 0.1e1 + t27;
  t29 = 0.1e1 / t28;
  t30 = 0.1e1 - t29;
  t31 = M_CBRT6;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = t21 * t21;
  t38 = sigma[0] * t37;
  t39 = rho[0] * rho[0];
  t40 = t18 * t18;
  t42 = 0.1e1 / t40 / t39;
  t43 = t38 * t42;
  t44 = t36 * t43;
  t46 = 0.1227e1 + 0.91464571985215458336e-2 * t44;
  t49 = 0.2227e1 - 0.1505529e1 / t46;
  t52 = exp(-0.25e2 / 0.6e1 * t44);
  t55 = (0.2743e0 - 0.1508e0 * t52) * t31;
  t56 = t55 * t35;
  t59 = t31 * t31;
  t61 = 0.1e1 / t33 / t32;
  t62 = t59 * t61;
  t63 = sigma[0] * sigma[0];
  t64 = t63 * t21;
  t65 = t39 * t39;
  t66 = t65 * rho[0];
  t68 = 0.1e1 / t18 / t66;
  t71 = 0.13888888888888888889e-4 * t62 * t64 * t68;
  t72 = t56 * t43 / 0.24e2 - t71;
  t74 = t59 / t33;
  t75 = t74 * t20;
  t76 = t21 * t24;
  t79 = log(0.64963333333333333333e0 * t74 * t25 + sqrt(POW_2(0.64963333333333333333e0 * t74 * t25) + 0.1e1));
  t80 = t76 * t79;
  t83 = 0.1e1 + 0.16370833333333333333e-1 * t75 * t80 + t71;
  t84 = 0.1e1 / t83;
  t86 = t72 * t84 + 0.1e1;
  t88 = t29 * t86 + t30 * t49;
  t92 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t88);
  tzk0 = 0.2e1 * t92;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t24;
  double t25, t27, t28, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t42;
  double t43, t44, t46, t49, t52, t55, t56, t59;
  double t61, t62, t63, t64, t65, t66, t68, t71;
  double t72, t74, t75, t76, t79, t80, t83, t84;
  double t86, t88, t92, tzk0;

  double t94, t98, t99, t100, t101, t103, t105, t108;
  double t109, t111, t112, t113, t115, t116, t120, t121;
  double t122, t123, t126, t127, t129, t130, t131, t139;
  double t140, t142, t143, t144, t145, t148, t150, t151;
  double t152, t153, t156, t158, t160, t165, tvrho0, t168;
  double t169, t170, t172, t175, t176, t179, t180, t183;
  double t190, t193, t194, t196, t199, t200, t203, t205;
  double t207, t211, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = sqrt(sigma[0]);
  t21 = M_CBRT2;
  t24 = 0.1e1 / t18 / rho[0];
  t25 = t20 * t21 * t24;
  t27 = exp(-t25 + 0.19e2);
  t28 = 0.1e1 + t27;
  t29 = 0.1e1 / t28;
  t30 = 0.1e1 - t29;
  t31 = M_CBRT6;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = t21 * t21;
  t38 = sigma[0] * t37;
  t39 = rho[0] * rho[0];
  t40 = t18 * t18;
  t42 = 0.1e1 / t40 / t39;
  t43 = t38 * t42;
  t44 = t36 * t43;
  t46 = 0.1227e1 + 0.91464571985215458336e-2 * t44;
  t49 = 0.2227e1 - 0.1505529e1 / t46;
  t52 = exp(-0.25e2 / 0.6e1 * t44);
  t55 = (0.2743e0 - 0.1508e0 * t52) * t31;
  t56 = t55 * t35;
  t59 = t31 * t31;
  t61 = 0.1e1 / t33 / t32;
  t62 = t59 * t61;
  t63 = sigma[0] * sigma[0];
  t64 = t63 * t21;
  t65 = t39 * t39;
  t66 = t65 * rho[0];
  t68 = 0.1e1 / t18 / t66;
  t71 = 0.13888888888888888889e-4 * t62 * t64 * t68;
  t72 = t56 * t43 / 0.24e2 - t71;
  t74 = t59 / t33;
  t75 = t74 * t20;
  t76 = t21 * t24;
  t79 = log(0.64963333333333333333e0 * t74 * t25 + sqrt(POW_2(0.64963333333333333333e0 * t74 * t25) + 0.1e1));
  t80 = t76 * t79;
  t83 = 0.1e1 + 0.16370833333333333333e-1 * t75 * t80 + t71;
  t84 = 0.1e1 / t83;
  t86 = t72 * t84 + 0.1e1;
  t88 = t29 * t86 + t30 * t49;
  t92 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t88);
  tzk0 = 0.2e1 * t92;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t94 = t17 / t40;
  t98 = t28 * t28;
  t99 = 0.1e1 / t98;
  t100 = t99 * t20;
  t101 = t100 * t21;
  t103 = 0.1e1 / t18 / t39;
  t105 = t103 * t27 * t49;
  t108 = t46 * t46;
  t109 = 0.1e1 / t108;
  t111 = t30 * t109 * t31;
  t112 = t35 * sigma[0];
  t113 = t39 * rho[0];
  t115 = 0.1e1 / t40 / t113;
  t116 = t37 * t115;
  t120 = t99 * t86;
  t121 = t120 * t20;
  t122 = t21 * t103;
  t123 = t122 * t27;
  t126 = t62 * t63;
  t127 = t65 * t39;
  t129 = 0.1e1 / t18 / t127;
  t130 = t21 * t129;
  t131 = t130 * t52;
  t139 = 0.74074074074074074075e-4 * t62 * t64 * t129;
  t140 = -0.13962962962962962963e0 * t126 * t131 - t56 * t38 * t115 / 0.9e1 + t139;
  t142 = t83 * t83;
  t143 = 0.1e1 / t142;
  t144 = t72 * t143;
  t145 = t122 * t79;
  t148 = t36 * sigma[0];
  t150 = 0.25321408066666666666e1 * t44 + 0.1e1;
  t151 = sqrt(t150);
  t152 = 0.1e1 / t151;
  t153 = t116 * t152;
  t156 = -0.21827777777777777777e-1 * t75 * t145 - 0.85080312222222222219e-1 * t148 * t153 - t139;
  t158 = t140 * t84 - t144 * t156;
  t160 = 0.4e1 / 0.3e1 * t101 * t105 - 0.36720684159021185007e-1 * t111 * t112 * t116 - 0.4e1 / 0.3e1 * t121 * t123 + t29 * t158;
  t165 = my_piecewise3(t2, 0, -t6 * t94 * t88 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t160);
  tvrho0 = 0.2e1 * rho[0] * t165 + 0.2e1 * t92;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t168 = 0.1e1 / t20;
  t169 = t99 * t168;
  t170 = t169 * t21;
  t172 = t24 * t27 * t49;
  t175 = t35 * t37;
  t176 = t175 * t42;
  t179 = t120 * t168;
  t180 = t76 * t27;
  t183 = t62 * t21;
  t190 = sigma[0] * t21;
  t193 = 0.27777777777777777778e-4 * t62 * t190 * t68;
  t194 = 0.52361111111111111112e-1 * t183 * t68 * t52 * sigma[0] + t55 * t176 / 0.24e2 - t193;
  t196 = t74 * t168;
  t199 = t37 * t42;
  t200 = t199 * t152;
  t203 = 0.81854166666666666665e-2 * t196 * t80 + 0.31905117083333333333e-1 * t36 * t200 + t193;
  t205 = -t144 * t203 + t194 * t84;
  t207 = -t170 * t172 / 0.2e1 + 0.13770256559632944377e-1 * t111 * t176 + t179 * t180 / 0.2e1 + t29 * t205;
  t211 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t207);
  tvsigma0 = 0.2e1 * rho[0] * t211;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t24;
  double t25, t27, t28, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t42;
  double t43, t44, t46, t49, t52, t55, t56, t59;
  double t61, t62, t63, t64, t65, t66, t68, t71;
  double t72, t74, t75, t76, t79, t80, t83, t84;
  double t86, t88, t92, tzk0;

  double t94, t98, t99, t100, t101, t103, t105, t108;
  double t109, t111, t112, t113, t115, t116, t120, t121;
  double t122, t123, t126, t127, t129, t130, t131, t139;
  double t140, t142, t143, t144, t145, t148, t150, t151;
  double t152, t153, t156, t158, t160, t165, tvrho0, t168;
  double t169, t170, t172, t175, t176, t179, t180, t183;
  double t190, t193, t194, t196, t199, t200, t203, t205;
  double t207, t211, tvsigma0;

  double t216, t224, t226, t228, t229, t231, t235, t237;
  double t240, t241, t243, t246, t247, t248, t251, t255;
  double t257, t258, t259, t261, t262, t266, t270, t271;
  double t272, t275, t276, t279, t280, t283, t284, t287;
  double t290, t291, t292, t293, t294, t295, t296, t305;
  double t306, t308, t312, t313, t314, t317, t320, t324;
  double t325, t328, t330, t332, t337, tv2rho20, t343, t345;
  double t350, t352, t355, t359, t364, t367, t370, t375;
  double t378, t379, t386, t387, t388, t389, t396, t397;
  double t399, t402, t413, t415, t417, t422, tv2rhosigma0, t425;
  double t426, t427, t429, t432, t433, t434, t437, t438;
  double t440, t443, t450, t451, t454, t456, t459, t460;
  double t463, t464, t465, t468, t473, t474, t478, t481;
  double t484, t487, t490, t492, t494, t498, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = sqrt(sigma[0]);
  t21 = M_CBRT2;
  t24 = 0.1e1 / t18 / rho[0];
  t25 = t20 * t21 * t24;
  t27 = exp(-t25 + 0.19e2);
  t28 = 0.1e1 + t27;
  t29 = 0.1e1 / t28;
  t30 = 0.1e1 - t29;
  t31 = M_CBRT6;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = t21 * t21;
  t38 = sigma[0] * t37;
  t39 = rho[0] * rho[0];
  t40 = t18 * t18;
  t42 = 0.1e1 / t40 / t39;
  t43 = t38 * t42;
  t44 = t36 * t43;
  t46 = 0.1227e1 + 0.91464571985215458336e-2 * t44;
  t49 = 0.2227e1 - 0.1505529e1 / t46;
  t52 = exp(-0.25e2 / 0.6e1 * t44);
  t55 = (0.2743e0 - 0.1508e0 * t52) * t31;
  t56 = t55 * t35;
  t59 = t31 * t31;
  t61 = 0.1e1 / t33 / t32;
  t62 = t59 * t61;
  t63 = sigma[0] * sigma[0];
  t64 = t63 * t21;
  t65 = t39 * t39;
  t66 = t65 * rho[0];
  t68 = 0.1e1 / t18 / t66;
  t71 = 0.13888888888888888889e-4 * t62 * t64 * t68;
  t72 = t56 * t43 / 0.24e2 - t71;
  t74 = t59 / t33;
  t75 = t74 * t20;
  t76 = t21 * t24;
  t79 = log(0.64963333333333333333e0 * t74 * t25 + sqrt(POW_2(0.64963333333333333333e0 * t74 * t25) + 0.1e1));
  t80 = t76 * t79;
  t83 = 0.1e1 + 0.16370833333333333333e-1 * t75 * t80 + t71;
  t84 = 0.1e1 / t83;
  t86 = t72 * t84 + 0.1e1;
  t88 = t29 * t86 + t30 * t49;
  t92 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t88);
  tzk0 = 0.2e1 * t92;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t94 = t17 / t40;
  t98 = t28 * t28;
  t99 = 0.1e1 / t98;
  t100 = t99 * t20;
  t101 = t100 * t21;
  t103 = 0.1e1 / t18 / t39;
  t105 = t103 * t27 * t49;
  t108 = t46 * t46;
  t109 = 0.1e1 / t108;
  t111 = t30 * t109 * t31;
  t112 = t35 * sigma[0];
  t113 = t39 * rho[0];
  t115 = 0.1e1 / t40 / t113;
  t116 = t37 * t115;
  t120 = t99 * t86;
  t121 = t120 * t20;
  t122 = t21 * t103;
  t123 = t122 * t27;
  t126 = t62 * t63;
  t127 = t65 * t39;
  t129 = 0.1e1 / t18 / t127;
  t130 = t21 * t129;
  t131 = t130 * t52;
  t139 = 0.74074074074074074075e-4 * t62 * t64 * t129;
  t140 = -0.13962962962962962963e0 * t126 * t131 - t56 * t38 * t115 / 0.9e1 + t139;
  t142 = t83 * t83;
  t143 = 0.1e1 / t142;
  t144 = t72 * t143;
  t145 = t122 * t79;
  t148 = t36 * sigma[0];
  t150 = 0.25321408066666666666e1 * t44 + 0.1e1;
  t151 = sqrt(t150);
  t152 = 0.1e1 / t151;
  t153 = t116 * t152;
  t156 = -0.21827777777777777777e-1 * t75 * t145 - 0.85080312222222222219e-1 * t148 * t153 - t139;
  t158 = t140 * t84 - t144 * t156;
  t160 = 0.4e1 / 0.3e1 * t101 * t105 - 0.36720684159021185007e-1 * t111 * t112 * t116 - 0.4e1 / 0.3e1 * t121 * t123 + t29 * t158;
  t165 = my_piecewise3(t2, 0, -t6 * t94 * t88 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t160);
  tvrho0 = 0.2e1 * rho[0] * t165 + 0.2e1 * t92;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t168 = 0.1e1 / t20;
  t169 = t99 * t168;
  t170 = t169 * t21;
  t172 = t24 * t27 * t49;
  t175 = t35 * t37;
  t176 = t175 * t42;
  t179 = t120 * t168;
  t180 = t76 * t27;
  t183 = t62 * t21;
  t190 = sigma[0] * t21;
  t193 = 0.27777777777777777778e-4 * t62 * t190 * t68;
  t194 = 0.52361111111111111112e-1 * t183 * t68 * t52 * sigma[0] + t55 * t176 / 0.24e2 - t193;
  t196 = t74 * t168;
  t199 = t37 * t42;
  t200 = t199 * t152;
  t203 = 0.81854166666666666665e-2 * t196 * t80 + 0.31905117083333333333e-1 * t36 * t200 + t193;
  t205 = -t144 * t203 + t194 * t84;
  t207 = -t170 * t172 / 0.2e1 + 0.13770256559632944377e-1 * t111 * t176 + t179 * t180 / 0.2e1 + t29 * t205;
  t211 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t207);
  tvsigma0 = 0.2e1 * rho[0] * t211;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t216 = t17 / t40 / rho[0];
  t224 = 0.1e1 / t98 / t28;
  t226 = t224 * sigma[0] * t37;
  t228 = 0.1e1 / t40 / t65;
  t229 = t27 * t27;
  t231 = t228 * t229 * t49;
  t235 = 0.1e1 / t18 / t113;
  t237 = t235 * t27 * t49;
  t240 = t99 * sigma[0];
  t241 = t240 * t37;
  t243 = t228 * t27 * t49;
  t246 = t20 * sigma[0];
  t247 = t99 * t246;
  t248 = 0.1e1 / t127;
  t251 = t27 * t109 * t36;
  t255 = 0.1e1 / t108 / t46;
  t257 = t30 * t255 * t59;
  t258 = t61 * t63;
  t259 = t65 * t113;
  t261 = 0.1e1 / t18 / t259;
  t262 = t21 * t261;
  t266 = t37 * t228;
  t270 = t224 * t86;
  t271 = t270 * sigma[0];
  t272 = t266 * t229;
  t275 = t99 * t158;
  t276 = t275 * t20;
  t279 = t21 * t235;
  t280 = t279 * t27;
  t283 = t120 * sigma[0];
  t284 = t266 * t27;
  t287 = t262 * t52;
  t290 = t32 * t32;
  t291 = 0.1e1 / t290;
  t292 = t63 * sigma[0];
  t293 = t291 * t292;
  t294 = t65 * t65;
  t295 = t294 * t39;
  t296 = 0.1e1 / t295;
  t305 = 0.46913580246913580247e-3 * t62 * t64 * t261;
  t306 = 0.12566666666666666667e1 * t126 * t287 - 0.18617283950617283951e2 * t293 * t296 * t52 + 0.11e2 / 0.27e2 * t56 * t38 * t228 - t305;
  t308 = t140 * t143;
  t312 = 0.1e1 / t142 / t83;
  t313 = t72 * t312;
  t314 = t156 * t156;
  t317 = t279 * t79;
  t320 = t266 * t152;
  t324 = 0.1e1 / t151 / t150;
  t325 = t262 * t324;
  t328 = 0.5093148148148148148e-1 * t75 * t317 + 0.42540156111111111109e0 * t148 * t320 - 0.57449421445821236542e0 * t126 * t325 + t305;
  t330 = -t144 * t328 - 0.2e1 * t308 * t156 + t306 * t84 + 0.2e1 * t313 * t314;
  t332 = -0.32e2 / 0.9e1 * t226 * t231 - 0.28e2 / 0.9e1 * t101 * t237 + 0.16e2 / 0.9e1 * t241 * t243 - 0.1958436488481129867e0 * t247 * t248 * t251 - 0.35825511035830977502e-2 * t257 * t258 * t262 + 0.13464250858307767836e0 * t111 * t112 * t266 + 0.32e2 / 0.9e1 * t271 * t272 - 0.8e1 / 0.3e1 * t276 * t123 + 0.28e2 / 0.9e1 * t121 * t280 - 0.16e2 / 0.9e1 * t283 * t284 + t29 * t330;
  t337 = my_piecewise3(t2, 0, t6 * t216 * t88 / 0.12e2 - t6 * t94 * t160 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t332);
  tv2rho20 = 0.2e1 * rho[0] * t337 + 0.4e1 * t165;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t343 = t224 * t37;
  t345 = t115 * t229 * t49;
  t350 = t99 * t37;
  t352 = t115 * t27 * t49;
  t355 = 0.1e1 / t66;
  t359 = t61 * t21;
  t364 = t175 * t115;
  t367 = t116 * t229;
  t370 = t275 * t168;
  t375 = t116 * t27;
  t378 = t99 * t205;
  t379 = t378 * t20;
  t386 = t294 * rho[0];
  t387 = 0.1e1 / t386;
  t388 = t291 * t387;
  t389 = t63 * t52;
  t396 = 0.14814814814814814815e-3 * t62 * t190 * t129;
  t397 = -0.41888888888888888889e0 * t183 * t129 * t52 * sigma[0] + 0.69814814814814814816e1 * t388 * t389 - t55 * t364 / 0.9e1 + t396;
  t399 = t194 * t143;
  t402 = t203 * t156;
  t413 = -0.10913888888888888889e-1 * t196 * t145 - 0.12762046833333333333e0 * t36 * t153 + 0.21543533042182963704e0 * t183 * t129 * t324 * sigma[0] - t396;
  t415 = -t144 * t413 - t399 * t156 - t308 * t203 + 0.2e1 * t313 * t402 + t397 * t84;
  t417 = 0.4e1 / 0.3e1 * t343 * t345 + 0.2e1 / 0.3e1 * t170 * t105 - 0.2e1 / 0.3e1 * t350 * t352 + 0.73441368318042370012e-1 * t100 * t355 * t251 + 0.13434566638436616562e-2 * t257 * t359 * t129 * sigma[0] - 0.36720684159021185005e-1 * t111 * t364 - 0.4e1 / 0.3e1 * t270 * t367 + t370 * t180 / 0.2e1 - 0.2e1 / 0.3e1 * t179 * t123 + 0.2e1 / 0.3e1 * t120 * t375 - 0.4e1 / 0.3e1 * t379 * t123 + t29 * t415;
  t422 = my_piecewise3(t2, 0, -t6 * t94 * t207 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t417);
  tv2rhosigma0 = 0.2e1 * rho[0] * t422 + 0.2e1 * t211;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t425 = 0.1e1 / sigma[0];
  t426 = t224 * t425;
  t427 = t426 * t37;
  t429 = t42 * t229 * t49;
  t432 = 0.1e1 / t246;
  t433 = t99 * t432;
  t434 = t433 * t21;
  t437 = t99 * t425;
  t438 = t437 * t37;
  t440 = t42 * t27 * t49;
  t443 = 0.1e1 / t65;
  t450 = t270 * t425;
  t451 = t199 * t229;
  t454 = t378 * t168;
  t456 = t120 * t432;
  t459 = t120 * t425;
  t460 = t199 * t27;
  t463 = 0.1e1 / t294;
  t464 = t291 * t463;
  t465 = t52 * sigma[0];
  t468 = t21 * t68;
  t473 = 0.27777777777777777778e-4 * t62 * t468;
  t474 = -0.26180555555555555556e1 * t464 * t465 + 0.10472222222222222222e0 * t62 * t468 * t52 - t473;
  t478 = t203 * t203;
  t481 = t74 * t432;
  t484 = t36 * t425;
  t487 = t468 * t324;
  t490 = -0.40927083333333333332e-2 * t481 * t80 + 0.15952558541666666666e-1 * t484 * t200 - 0.80788248908186113886e-1 * t62 * t487 + t473;
  t492 = -t144 * t490 - 0.2e1 * t399 * t203 + 0.2e1 * t313 * t478 + t474 * t84;
  t494 = -t427 * t429 / 0.2e1 + t434 * t172 / 0.4e1 + t438 * t440 / 0.4e1 - 0.27540513119265888754e-1 * t169 * t443 * t251 - 0.50379624894137312108e-3 * t257 * t359 * t68 + t450 * t451 / 0.2e1 + t454 * t180 - t456 * t180 / 0.4e1 - t459 * t460 / 0.4e1 + t29 * t492;
  t498 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t494);
  tv2sigma20 = 0.2e1 * rho[0] * t498;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t24;
  double t25, t27, t28, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t42;
  double t43, t44, t46, t49, t52, t55, t56, t59;
  double t61, t62, t63, t64, t65, t66, t68, t71;
  double t72, t74, t75, t76, t79, t80, t83, t84;
  double t86, t88, t92, tzk0;

  double t94, t98, t99, t100, t101, t103, t105, t108;
  double t109, t111, t112, t113, t115, t116, t120, t121;
  double t122, t123, t126, t127, t129, t130, t131, t139;
  double t140, t142, t143, t144, t145, t148, t150, t151;
  double t152, t153, t156, t158, t160, t165, tvrho0, t168;
  double t169, t170, t172, t175, t176, t179, t180, t183;
  double t190, t193, t194, t196, t199, t200, t203, t205;
  double t207, t211, tvsigma0;

  double t216, t224, t226, t228, t229, t231, t235, t237;
  double t240, t241, t243, t246, t247, t248, t251, t255;
  double t257, t258, t259, t261, t262, t266, t270, t271;
  double t272, t275, t276, t279, t280, t283, t284, t287;
  double t290, t291, t292, t293, t294, t295, t296, t305;
  double t306, t308, t312, t313, t314, t317, t320, t324;
  double t325, t328, t330, t332, t337, tv2rho20, t343, t345;
  double t350, t352, t355, t359, t364, t367, t370, t375;
  double t378, t379, t386, t387, t388, t389, t396, t397;
  double t399, t402, t413, t415, t417, t422, tv2rhosigma0, t425;
  double t426, t427, t429, t432, t433, t434, t437, t438;
  double t440, t443, t450, t451, t454, t456, t459, t460;
  double t463, t464, t465, t468, t473, t474, t478, t481;
  double t484, t487, t490, t492, t494, t498, tv2sigma20;

  double t501, t512, t513, t517, t518, t522, t523, t524;
  double t526, t528, t529, t533, t539, t540, t542, t545;
  double t550, t551, t552, t553, t556, t560, t561, t562;
  double t565, t566, t572, t573, t575, t578, t580, t582;
  double t583, t584, t587, t588, t589, t590, t591, t594;
  double t597, t598, t602, t603, t611, t614, t618, t621;
  double t622, t625, t626, t629, t630, t635, t639, t646;
  double t649, t650, t652, t655, t657, t666, t668, t669;
  double t672, t676, t677, t678, t681, t682, t687, tv3rho30;
  double t705, t708, t711, t712, t715, t716, t719, t726;
  double t729, t731, t732, t740, t741, t743, t746, t755;
  double t758, t761, t772, t775, t777, t781, t782, t785;
  double t786, t791, t793, t794, t798, t799, t806, t812;
  double t826, t827, t829, t830, t833, t839, t847, t848;
  double t853, tv3rho2sigma0, t861, t864, t866, t871, t876, t877;
  double t891, t895, t897, t899, t905, t906, t908, t918;
  double t921, t925, t932, t935, t938, t940, t944, t949;
  double t958, t959, t962, t965, t980, t981, t988, t989;
  double t994, tv3rhosigma20, t997, t1000, t1001, t1005, t1007, t1008;
  double t1013, t1021, t1024, t1027, t1030, t1031, t1034, t1039;
  double t1041, t1043, t1046, t1049, t1052, t1053, t1056, t1059;
  double t1060, t1063, t1066, t1069, t1070, t1072, t1075, t1077;
  double t1081, t1086, t1089, t1090, t1096, t1097, t1107, t1108;
  double t1112, t1113, t1117, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = sqrt(sigma[0]);
  t21 = M_CBRT2;
  t24 = 0.1e1 / t18 / rho[0];
  t25 = t20 * t21 * t24;
  t27 = exp(-t25 + 0.19e2);
  t28 = 0.1e1 + t27;
  t29 = 0.1e1 / t28;
  t30 = 0.1e1 - t29;
  t31 = M_CBRT6;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = t21 * t21;
  t38 = sigma[0] * t37;
  t39 = rho[0] * rho[0];
  t40 = t18 * t18;
  t42 = 0.1e1 / t40 / t39;
  t43 = t38 * t42;
  t44 = t36 * t43;
  t46 = 0.1227e1 + 0.91464571985215458336e-2 * t44;
  t49 = 0.2227e1 - 0.1505529e1 / t46;
  t52 = exp(-0.25e2 / 0.6e1 * t44);
  t55 = (0.2743e0 - 0.1508e0 * t52) * t31;
  t56 = t55 * t35;
  t59 = t31 * t31;
  t61 = 0.1e1 / t33 / t32;
  t62 = t59 * t61;
  t63 = sigma[0] * sigma[0];
  t64 = t63 * t21;
  t65 = t39 * t39;
  t66 = t65 * rho[0];
  t68 = 0.1e1 / t18 / t66;
  t71 = 0.13888888888888888889e-4 * t62 * t64 * t68;
  t72 = t56 * t43 / 0.24e2 - t71;
  t74 = t59 / t33;
  t75 = t74 * t20;
  t76 = t21 * t24;
  t79 = log(0.64963333333333333333e0 * t74 * t25 + sqrt(POW_2(0.64963333333333333333e0 * t74 * t25) + 0.1e1));
  t80 = t76 * t79;
  t83 = 0.1e1 + 0.16370833333333333333e-1 * t75 * t80 + t71;
  t84 = 0.1e1 / t83;
  t86 = t72 * t84 + 0.1e1;
  t88 = t29 * t86 + t30 * t49;
  t92 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t88);
  tzk0 = 0.2e1 * t92;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t94 = t17 / t40;
  t98 = t28 * t28;
  t99 = 0.1e1 / t98;
  t100 = t99 * t20;
  t101 = t100 * t21;
  t103 = 0.1e1 / t18 / t39;
  t105 = t103 * t27 * t49;
  t108 = t46 * t46;
  t109 = 0.1e1 / t108;
  t111 = t30 * t109 * t31;
  t112 = t35 * sigma[0];
  t113 = t39 * rho[0];
  t115 = 0.1e1 / t40 / t113;
  t116 = t37 * t115;
  t120 = t99 * t86;
  t121 = t120 * t20;
  t122 = t21 * t103;
  t123 = t122 * t27;
  t126 = t62 * t63;
  t127 = t65 * t39;
  t129 = 0.1e1 / t18 / t127;
  t130 = t21 * t129;
  t131 = t130 * t52;
  t139 = 0.74074074074074074075e-4 * t62 * t64 * t129;
  t140 = -0.13962962962962962963e0 * t126 * t131 - t56 * t38 * t115 / 0.9e1 + t139;
  t142 = t83 * t83;
  t143 = 0.1e1 / t142;
  t144 = t72 * t143;
  t145 = t122 * t79;
  t148 = t36 * sigma[0];
  t150 = 0.25321408066666666666e1 * t44 + 0.1e1;
  t151 = sqrt(t150);
  t152 = 0.1e1 / t151;
  t153 = t116 * t152;
  t156 = -0.21827777777777777777e-1 * t75 * t145 - 0.85080312222222222219e-1 * t148 * t153 - t139;
  t158 = t140 * t84 - t144 * t156;
  t160 = 0.4e1 / 0.3e1 * t101 * t105 - 0.36720684159021185007e-1 * t111 * t112 * t116 - 0.4e1 / 0.3e1 * t121 * t123 + t29 * t158;
  t165 = my_piecewise3(t2, 0, -t6 * t94 * t88 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t160);
  tvrho0 = 0.2e1 * rho[0] * t165 + 0.2e1 * t92;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t168 = 0.1e1 / t20;
  t169 = t99 * t168;
  t170 = t169 * t21;
  t172 = t24 * t27 * t49;
  t175 = t35 * t37;
  t176 = t175 * t42;
  t179 = t120 * t168;
  t180 = t76 * t27;
  t183 = t62 * t21;
  t190 = sigma[0] * t21;
  t193 = 0.27777777777777777778e-4 * t62 * t190 * t68;
  t194 = 0.52361111111111111112e-1 * t183 * t68 * t52 * sigma[0] + t55 * t176 / 0.24e2 - t193;
  t196 = t74 * t168;
  t199 = t37 * t42;
  t200 = t199 * t152;
  t203 = 0.81854166666666666665e-2 * t196 * t80 + 0.31905117083333333333e-1 * t36 * t200 + t193;
  t205 = -t144 * t203 + t194 * t84;
  t207 = -t170 * t172 / 0.2e1 + 0.13770256559632944377e-1 * t111 * t176 + t179 * t180 / 0.2e1 + t29 * t205;
  t211 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t207);
  tvsigma0 = 0.2e1 * rho[0] * t211;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t216 = t17 / t40 / rho[0];
  t224 = 0.1e1 / t98 / t28;
  t226 = t224 * sigma[0] * t37;
  t228 = 0.1e1 / t40 / t65;
  t229 = t27 * t27;
  t231 = t228 * t229 * t49;
  t235 = 0.1e1 / t18 / t113;
  t237 = t235 * t27 * t49;
  t240 = t99 * sigma[0];
  t241 = t240 * t37;
  t243 = t228 * t27 * t49;
  t246 = t20 * sigma[0];
  t247 = t99 * t246;
  t248 = 0.1e1 / t127;
  t251 = t27 * t109 * t36;
  t255 = 0.1e1 / t108 / t46;
  t257 = t30 * t255 * t59;
  t258 = t61 * t63;
  t259 = t65 * t113;
  t261 = 0.1e1 / t18 / t259;
  t262 = t21 * t261;
  t266 = t37 * t228;
  t270 = t224 * t86;
  t271 = t270 * sigma[0];
  t272 = t266 * t229;
  t275 = t99 * t158;
  t276 = t275 * t20;
  t279 = t21 * t235;
  t280 = t279 * t27;
  t283 = t120 * sigma[0];
  t284 = t266 * t27;
  t287 = t262 * t52;
  t290 = t32 * t32;
  t291 = 0.1e1 / t290;
  t292 = t63 * sigma[0];
  t293 = t291 * t292;
  t294 = t65 * t65;
  t295 = t294 * t39;
  t296 = 0.1e1 / t295;
  t305 = 0.46913580246913580247e-3 * t62 * t64 * t261;
  t306 = 0.12566666666666666667e1 * t126 * t287 - 0.18617283950617283951e2 * t293 * t296 * t52 + 0.11e2 / 0.27e2 * t56 * t38 * t228 - t305;
  t308 = t140 * t143;
  t312 = 0.1e1 / t142 / t83;
  t313 = t72 * t312;
  t314 = t156 * t156;
  t317 = t279 * t79;
  t320 = t266 * t152;
  t324 = 0.1e1 / t151 / t150;
  t325 = t262 * t324;
  t328 = 0.5093148148148148148e-1 * t75 * t317 + 0.42540156111111111109e0 * t148 * t320 - 0.57449421445821236542e0 * t126 * t325 + t305;
  t330 = -t144 * t328 - 0.2e1 * t308 * t156 + t306 * t84 + 0.2e1 * t313 * t314;
  t332 = -0.32e2 / 0.9e1 * t226 * t231 - 0.28e2 / 0.9e1 * t101 * t237 + 0.16e2 / 0.9e1 * t241 * t243 - 0.1958436488481129867e0 * t247 * t248 * t251 - 0.35825511035830977502e-2 * t257 * t258 * t262 + 0.13464250858307767836e0 * t111 * t112 * t266 + 0.32e2 / 0.9e1 * t271 * t272 - 0.8e1 / 0.3e1 * t276 * t123 + 0.28e2 / 0.9e1 * t121 * t280 - 0.16e2 / 0.9e1 * t283 * t284 + t29 * t330;
  t337 = my_piecewise3(t2, 0, t6 * t216 * t88 / 0.12e2 - t6 * t94 * t160 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t332);
  tv2rho20 = 0.2e1 * rho[0] * t337 + 0.4e1 * t165;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t343 = t224 * t37;
  t345 = t115 * t229 * t49;
  t350 = t99 * t37;
  t352 = t115 * t27 * t49;
  t355 = 0.1e1 / t66;
  t359 = t61 * t21;
  t364 = t175 * t115;
  t367 = t116 * t229;
  t370 = t275 * t168;
  t375 = t116 * t27;
  t378 = t99 * t205;
  t379 = t378 * t20;
  t386 = t294 * rho[0];
  t387 = 0.1e1 / t386;
  t388 = t291 * t387;
  t389 = t63 * t52;
  t396 = 0.14814814814814814815e-3 * t62 * t190 * t129;
  t397 = -0.41888888888888888889e0 * t183 * t129 * t52 * sigma[0] + 0.69814814814814814816e1 * t388 * t389 - t55 * t364 / 0.9e1 + t396;
  t399 = t194 * t143;
  t402 = t203 * t156;
  t413 = -0.10913888888888888889e-1 * t196 * t145 - 0.12762046833333333333e0 * t36 * t153 + 0.21543533042182963704e0 * t183 * t129 * t324 * sigma[0] - t396;
  t415 = -t144 * t413 - t399 * t156 - t308 * t203 + 0.2e1 * t313 * t402 + t397 * t84;
  t417 = 0.4e1 / 0.3e1 * t343 * t345 + 0.2e1 / 0.3e1 * t170 * t105 - 0.2e1 / 0.3e1 * t350 * t352 + 0.73441368318042370012e-1 * t100 * t355 * t251 + 0.13434566638436616562e-2 * t257 * t359 * t129 * sigma[0] - 0.36720684159021185005e-1 * t111 * t364 - 0.4e1 / 0.3e1 * t270 * t367 + t370 * t180 / 0.2e1 - 0.2e1 / 0.3e1 * t179 * t123 + 0.2e1 / 0.3e1 * t120 * t375 - 0.4e1 / 0.3e1 * t379 * t123 + t29 * t415;
  t422 = my_piecewise3(t2, 0, -t6 * t94 * t207 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t417);
  tv2rhosigma0 = 0.2e1 * rho[0] * t422 + 0.2e1 * t211;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t425 = 0.1e1 / sigma[0];
  t426 = t224 * t425;
  t427 = t426 * t37;
  t429 = t42 * t229 * t49;
  t432 = 0.1e1 / t246;
  t433 = t99 * t432;
  t434 = t433 * t21;
  t437 = t99 * t425;
  t438 = t437 * t37;
  t440 = t42 * t27 * t49;
  t443 = 0.1e1 / t65;
  t450 = t270 * t425;
  t451 = t199 * t229;
  t454 = t378 * t168;
  t456 = t120 * t432;
  t459 = t120 * t425;
  t460 = t199 * t27;
  t463 = 0.1e1 / t294;
  t464 = t291 * t463;
  t465 = t52 * sigma[0];
  t468 = t21 * t68;
  t473 = 0.27777777777777777778e-4 * t62 * t468;
  t474 = -0.26180555555555555556e1 * t464 * t465 + 0.10472222222222222222e0 * t62 * t468 * t52 - t473;
  t478 = t203 * t203;
  t481 = t74 * t432;
  t484 = t36 * t425;
  t487 = t468 * t324;
  t490 = -0.40927083333333333332e-2 * t481 * t80 + 0.15952558541666666666e-1 * t484 * t200 - 0.80788248908186113886e-1 * t62 * t487 + t473;
  t492 = -t144 * t490 - 0.2e1 * t399 * t203 + 0.2e1 * t313 * t478 + t474 * t84;
  t494 = -t427 * t429 / 0.2e1 + t434 * t172 / 0.4e1 + t438 * t440 / 0.4e1 - 0.27540513119265888754e-1 * t169 * t443 * t251 - 0.50379624894137312108e-3 * t257 * t359 * t68 + t450 * t451 / 0.2e1 + t454 * t180 - t456 * t180 / 0.4e1 - t459 * t460 / 0.4e1 + t29 * t492;
  t498 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t494);
  tv2sigma20 = 0.2e1 * rho[0] * t498;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t501 = t17 * t42;
  t512 = 0.1e1 / t18 / t294;
  t513 = t21 * t512;
  t517 = t294 * t113;
  t518 = 0.1e1 / t517;
  t522 = t63 * t63;
  t523 = t291 * t522;
  t524 = t294 * t66;
  t526 = 0.1e1 / t40 / t524;
  t528 = t37 * t52;
  t529 = t36 * t528;
  t533 = 0.1e1 / t40 / t66;
  t539 = 0.34403292181069958848e-2 * t62 * t64 * t512;
  t540 = -0.10580823045267489712e2 * t126 * t513 * t52 + 0.35372839506172839507e3 * t293 * t518 * t52 - 0.20685871056241426612e3 * t523 * t526 * t529 - 0.154e3 / 0.81e2 * t56 * t38 * t533 + t539;
  t542 = t306 * t143;
  t545 = t140 * t312;
  t550 = t142 * t142;
  t551 = 0.1e1 / t550;
  t552 = t72 * t551;
  t553 = t314 * t156;
  t556 = t156 * t328;
  t560 = 0.1e1 / t18 / t65;
  t561 = t21 * t560;
  t562 = t561 * t79;
  t565 = t37 * t533;
  t566 = t565 * t152;
  t572 = t292 * t518;
  t573 = t150 * t150;
  t575 = 0.1e1 / t151 / t573;
  t578 = -0.16977160493827160493e0 * t75 * t562 - 0.22499015898765432098e1 * t148 * t566 + 0.70854286449846191734e1 * t126 * t513 * t324 - 0.71682849057236891051e0 * t572 * t575 - t539;
  t580 = -t144 * t578 - 0.3e1 * t542 * t156 - 0.3e1 * t308 * t328 + 0.6e1 * t313 * t556 + 0.6e1 * t545 * t314 + t540 * t84 - 0.6e1 * t552 * t553;
  t582 = 0.1e1 / t259;
  t583 = t246 * t582;
  t584 = t583 * t27;
  t587 = t98 * t98;
  t588 = 0.1e1 / t587;
  t589 = t588 * t86;
  t590 = t229 * t27;
  t591 = t583 * t590;
  t594 = t583 * t229;
  t597 = t588 * t246;
  t598 = t582 * t590;
  t602 = t224 * t246;
  t603 = t582 * t229;
  t611 = t275 * sigma[0];
  t614 = t565 * t27;
  t618 = t533 * t27 * t49;
  t621 = t224 * t158;
  t622 = t621 * sigma[0];
  t625 = t99 * t330;
  t626 = t625 * t20;
  t629 = t29 * t580 - 0.128e3 / 0.27e2 * t120 * t584 - 0.256e3 / 0.9e1 * t589 * t591 + 0.256e3 / 0.9e1 * t270 * t594 + 0.256e3 / 0.9e1 * t597 * t598 * t49 - 0.256e3 / 0.9e1 * t602 * t603 * t49 + 0.128e3 / 0.27e2 * t247 * t582 * t27 * t49 - 0.16e2 / 0.3e1 * t611 * t284 + 0.112e3 / 0.9e1 * t283 * t614 - 0.112e3 / 0.9e1 * t241 * t618 + 0.32e2 / 0.3e1 * t622 * t272 - 0.4e1 * t626 * t123;
  t630 = t561 * t27;
  t635 = t565 * t229;
  t639 = t560 * t27 * t49;
  t646 = t533 * t229 * t49;
  t649 = t20 * t63;
  t650 = t99 * t649;
  t652 = 0.1e1 / t40 / t386;
  t655 = t255 * t59;
  t657 = t655 * t61 * t37;
  t666 = t224 * t63;
  t668 = t229 * t109;
  t669 = t668 * t36;
  t672 = t99 * t63;
  t676 = t108 * t108;
  t677 = 0.1e1 / t676;
  t678 = t30 * t677;
  t681 = -0.28e3 / 0.27e2 * t121 * t630 + 0.28e2 / 0.3e1 * t276 * t280 - 0.224e3 / 0.9e1 * t271 * t635 + 0.28e3 / 0.27e2 * t101 * t639 + 0.17625928396330168804e1 * t247 * t582 * t251 + 0.224e3 / 0.9e1 * t226 * t646 - 0.14330204414332391e-1 * t650 * t652 * t27 * t657 + 0.39408062139414075252e-1 * t257 * t258 * t513 - 0.62833170672102916568e0 * t111 * t112 * t565 + 0.78337459539245194681e0 * t666 * t513 * t669 - 0.3916872976962259734e0 * t672 * t513 * t251 - 0.32293643214718787941e-4 * t678 * t572;
  t682 = t629 + t681;
  t687 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t501 * t88 + t6 * t216 * t160 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t94 * t332 - 0.3e1 / 0.8e1 * t6 * t19 * t682);
  tv3rho30 = 0.2e1 * rho[0] * t687 + 0.6e1 * t337;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t705 = t175 * t228;
  t708 = t625 * t168;
  t711 = t99 * t415;
  t712 = t711 * t20;
  t715 = t224 * t205;
  t716 = t715 * sigma[0];
  t719 = t378 * sigma[0];
  t726 = t291 * t296;
  t729 = t294 * t65;
  t731 = 0.1e1 / t40 / t729;
  t732 = t291 * t731;
  t740 = 0.93827160493827160495e-3 * t62 * t190 * t261;
  t741 = 0.3025308641975308642e1 * t183 * t261 * t52 * sigma[0] - 0.11868518518518518519e3 * t726 * t389 + 0.77572016460905349795e2 * t732 * t292 * t529 + 0.11e2 / 0.27e2 * t55 * t705 - t740;
  t743 = t397 * t143;
  t746 = t194 * t312;
  t755 = t203 * t314;
  t758 = t413 * t156;
  t761 = t203 * t328;
  t772 = t296 * t575;
  t775 = 0.25465740740740740741e-1 * t196 * t317 + 0.52466192537037037036e0 * t36 * t320 - 0.2226165081025572916e1 * t183 * t261 * t324 * sigma[0] + 0.26881068396463834145e0 * t772 * t63 + t740;
  t777 = -t144 * t775 - 0.2e1 * t743 * t156 - t542 * t203 - 0.2e1 * t308 * t413 + 0.4e1 * t313 * t758 + 0.2e1 * t313 * t761 + 0.2e1 * t746 * t314 - t399 * t328 + 0.4e1 * t545 * t402 - 0.6e1 * t552 * t755 + t741 * t84;
  t781 = t248 * t590;
  t782 = t781 * t20;
  t785 = t248 * t229;
  t786 = t785 * t20;
  t791 = 0.28e2 / 0.9e1 * t379 * t280 + 0.14e2 / 0.9e1 * t179 * t280 - 0.4e1 / 0.3e1 * t370 * t123 - 0.14e2 / 0.9e1 * t170 * t237 + 0.13464250858307767835e0 * t111 * t705 + t708 * t180 / 0.2e1 - 0.8e1 / 0.3e1 * t712 * t123 + 0.32e2 / 0.9e1 * t716 * t272 - 0.16e2 / 0.9e1 * t719 * t284 + t29 * t777 - 0.8e1 / 0.3e1 * t621 * t367 + 0.32e2 / 0.3e1 * t589 * t782 - 0.32e2 / 0.3e1 * t270 * t786 + 0.4e1 / 0.3e1 * t275 * t375;
  t793 = t590 * t49;
  t794 = t793 * t20;
  t798 = t229 * t49;
  t799 = t798 * t20;
  t806 = t20 * t27 * t49;
  t812 = t248 * t20 * t27;
  t826 = t224 * t21;
  t827 = t261 * t229;
  t829 = t109 * t31;
  t830 = t829 * t112;
  t833 = t99 * t21;
  t839 = 0.1e1 / t40 / t294;
  t847 = -0.32e2 / 0.3e1 * t588 * t248 * t794 + 0.32e2 / 0.3e1 * t224 * t248 * t799 + 0.1e2 / 0.3e1 * t350 * t243 - 0.16e2 / 0.9e1 * t99 * t248 * t806 - 0.1e2 / 0.3e1 * t120 * t284 + 0.16e2 / 0.9e1 * t120 * t812 - 0.2e2 / 0.3e1 * t343 * t231 + 0.2e2 / 0.3e1 * t270 * t272 - 0.12091109974592954906e-1 * t257 * t359 * t261 * sigma[0] - 0.51408957822629659009e0 * t100 * t248 * t251 - 0.29376547327216948005e0 * t826 * t827 * t830 + 0.14688273663608474002e0 * t833 * t261 * t27 * t830 + 0.5373826655374646625e-2 * t247 * t839 * t27 * t657 + 0.12110116205519545477e-4 * t678 * t296 * t63;
  t848 = t791 + t847;
  t853 = my_piecewise3(t2, 0, t6 * t216 * t207 / 0.12e2 - t6 * t94 * t417 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t848);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t853 + 0.4e1 * t422;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t861 = t621 * t425;
  t864 = t711 * t168;
  t866 = t275 * t432;
  t871 = t275 * t425;
  t876 = t99 * t492;
  t877 = t876 * t20;
  t891 = -t438 * t352 / 0.3e1 + t861 * t451 / 0.2e1 + t864 * t180 - t866 * t180 / 0.4e1 + t459 * t375 / 0.3e1 - t871 * t460 / 0.4e1 - t434 * t105 / 0.3e1 - 0.4e1 / 0.3e1 * t877 * t123 - 0.4e1 / 0.3e1 * t454 * t123 + t456 * t123 / 0.3e1 + 0.26869133276873233124e-2 * t257 * t359 * t129 - 0.2e1 / 0.3e1 * t450 * t367 + 0.2e1 / 0.3e1 * t427 * t345;
  t895 = 0.1e1 / t40 / t517;
  t897 = t291 * t895 * t31;
  t899 = t35 * t63 * t528;
  t905 = 0.14814814814814814815e-3 * t62 * t130;
  t906 = 0.34907407407407407408e2 * t388 * t465 - 0.29089506172839506173e2 * t897 * t899 - 0.55851851851851851851e0 * t62 * t131 + t905;
  t908 = t474 * t143;
  t918 = t478 * t156;
  t921 = t203 * t413;
  t925 = t490 * t156;
  t932 = t130 * t324;
  t935 = t387 * t575;
  t938 = 0.54569444444444444443e-2 * t481 * t145 - 0.21270078055555555554e-1 * t484 * t153 + 0.53858832605457409257e0 * t62 * t932 - 0.10080400648673937804e0 * t935 * sigma[0] - t905;
  t940 = -t144 * t938 - t908 * t156 - 0.2e1 * t743 * t203 - t308 * t490 + 0.4e1 * t313 * t921 + 0.2e1 * t313 * t925 - 0.2e1 * t399 * t413 + 0.4e1 * t746 * t402 + 0.2e1 * t545 * t478 - 0.6e1 * t552 * t918 + t906 * t84;
  t944 = t588 * t168;
  t949 = t224 * t168;
  t958 = t168 * t355;
  t959 = t958 * t27;
  t962 = t958 * t590;
  t965 = t958 * t229;
  t980 = 0.1e1 / t40 / t259;
  t981 = t980 * t27;
  t988 = t29 * t940 + 0.4e1 / 0.3e1 * t378 * t375 + 0.4e1 * t944 * t355 * t590 * t49 - 0.4e1 * t949 * t355 * t229 * t49 + 0.2e1 / 0.3e1 * t169 * t355 * t27 * t49 - 0.2e1 / 0.3e1 * t120 * t959 - 0.4e1 * t589 * t962 + 0.4e1 * t270 * t965 - 0.8e1 / 0.3e1 * t715 * t367 - 0.55081026238531777509e-1 * t833 * t129 * t251 + 0.11016205247706355502e0 * t826 * t129 * t669 + 0.91801710397552962516e-1 * t169 * t355 * t251 - 0.20151849957654924843e-2 * t100 * t981 * t657 - 0.45412935770698295538e-5 * t678 * t387 * sigma[0];
  t989 = t891 + t988;
  t994 = my_piecewise3(t2, 0, -t6 * t94 * t494 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t989);
  tv3rhosigma20 = 0.2e1 * rho[0] * t994 + 0.2e1 * t498;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t997 = t378 * t432;
  t1000 = 0.1e1 / t649;
  t1001 = t120 * t1000;
  t1005 = 0.1e1 / t40 / t295;
  t1007 = t291 * t1005 * t31;
  t1008 = t175 * t465;
  t1013 = 0.10908564814814814815e2 * t1007 * t1008 - 0.78541666666666666666e1 * t464 * t52;
  t1021 = t478 * t203;
  t1024 = t203 * t490;
  t1027 = t74 * t1000;
  t1030 = 0.1e1 / t63;
  t1031 = t36 * t1030;
  t1034 = t62 * t425;
  t1039 = 0.61390624999999999998e-2 * t1027 * t80 - 0.23928837812499999999e-1 * t1031 * t200 - 0.40394124454093056942e-1 * t1034 * t487 + 0.37801502432527266763e-1 * t463 * t575;
  t1041 = t1013 * t84 - 0.6e1 * t552 * t1021 + 0.6e1 * t313 * t1024 - t144 * t1039 - 0.3e1 * t908 * t203 - 0.3e1 * t399 * t490 + 0.6e1 * t746 * t478;
  t1043 = t378 * t425;
  t1046 = t120 * t1030;
  t1049 = t876 * t168;
  t1052 = t99 * t1030;
  t1053 = t1052 * t37;
  t1056 = t715 * t425;
  t1059 = t432 * t443;
  t1060 = t1059 * t27;
  t1063 = t1059 * t590;
  t1066 = t1059 * t229;
  t1069 = -0.3e1 / 0.4e1 * t997 * t180 + 0.3e1 / 0.8e1 * t1001 * t180 + t29 * t1041 - 0.3e1 / 0.4e1 * t1043 * t460 + 0.3e1 / 0.8e1 * t1046 * t460 + 0.3e1 / 0.2e1 * t1049 * t180 - 0.3e1 / 0.8e1 * t1053 * t440 + 0.3e1 / 0.2e1 * t1056 * t451 + t120 * t1060 / 0.4e1 + 0.3e1 / 0.2e1 * t589 * t1063 - 0.3e1 / 0.2e1 * t270 * t1066;
  t1070 = t588 * t432;
  t1072 = t443 * t590 * t49;
  t1075 = t224 * t432;
  t1077 = t443 * t229 * t49;
  t1081 = t443 * t27 * t49;
  t1086 = t270 * t1030;
  t1089 = t99 * t1000;
  t1090 = t1089 * t21;
  t1096 = t224 * t1030;
  t1097 = t1096 * t37;
  t1107 = 0.1e1 / t40 / t127;
  t1108 = t1107 * t27;
  t1112 = -0.3e1 / 0.2e1 * t1070 * t1072 + 0.3e1 / 0.2e1 * t1075 * t1077 - t433 * t1081 / 0.4e1 + 0.17029850914011860826e-5 * t678 * t463 - 0.3e1 / 0.4e1 * t1086 * t451 - 0.3e1 / 0.8e1 * t1090 * t172 + 0.20655384839449416566e-1 * t433 * t443 * t251 + 0.3e1 / 0.4e1 * t1097 * t429 - 0.41310769678898833131e-1 * t426 * t468 * t669 + 0.20655384839449416566e-1 * t437 * t468 * t251 + 0.75569437341205968162e-3 * t169 * t1108 * t657;
  t1113 = t1069 + t1112;
  t1117 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1113);
  tv3sigma30 = 0.2e1 * rho[0] * t1117;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t24;
  double t25, t27, t28, t29, t30, t31, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t42;
  double t43, t44, t46, t49, t52, t55, t56, t59;
  double t61, t62, t63, t64, t65, t66, t68, t71;
  double t72, t74, t75, t76, t79, t80, t83, t84;
  double t86, t88, t92, tzk0;

  double t94, t98, t99, t100, t101, t103, t105, t108;
  double t109, t111, t112, t113, t115, t116, t120, t121;
  double t122, t123, t126, t127, t129, t130, t131, t139;
  double t140, t142, t143, t144, t145, t148, t150, t151;
  double t152, t153, t156, t158, t160, t165, tvrho0, t168;
  double t169, t170, t172, t175, t176, t179, t180, t183;
  double t190, t193, t194, t196, t199, t200, t203, t205;
  double t207, t211, tvsigma0;

  double t216, t224, t226, t228, t229, t231, t235, t237;
  double t240, t241, t243, t246, t247, t248, t251, t255;
  double t257, t258, t259, t261, t262, t266, t270, t271;
  double t272, t275, t276, t279, t280, t283, t284, t287;
  double t290, t291, t292, t293, t294, t295, t296, t305;
  double t306, t308, t312, t313, t314, t317, t320, t324;
  double t325, t328, t330, t332, t337, tv2rho20, t343, t345;
  double t350, t352, t355, t359, t364, t367, t370, t375;
  double t378, t379, t386, t387, t388, t389, t396, t397;
  double t399, t402, t413, t415, t417, t422, tv2rhosigma0, t425;
  double t426, t427, t429, t432, t433, t434, t437, t438;
  double t440, t443, t450, t451, t454, t456, t459, t460;
  double t463, t464, t465, t468, t473, t474, t478, t481;
  double t484, t487, t490, t492, t494, t498, tv2sigma20;

  double t501, t512, t513, t517, t518, t522, t523, t524;
  double t526, t528, t529, t533, t539, t540, t542, t545;
  double t550, t551, t552, t553, t556, t560, t561, t562;
  double t565, t566, t572, t573, t575, t578, t580, t582;
  double t583, t584, t587, t588, t589, t590, t591, t594;
  double t597, t598, t602, t603, t611, t614, t618, t621;
  double t622, t625, t626, t629, t630, t635, t639, t646;
  double t649, t650, t652, t655, t657, t666, t668, t669;
  double t672, t676, t677, t678, t681, t682, t687, tv3rho30;
  double t705, t708, t711, t712, t715, t716, t719, t726;
  double t729, t731, t732, t740, t741, t743, t746, t755;
  double t758, t761, t772, t775, t777, t781, t782, t785;
  double t786, t791, t793, t794, t798, t799, t806, t812;
  double t826, t827, t829, t830, t833, t839, t847, t848;
  double t853, tv3rho2sigma0, t861, t864, t866, t871, t876, t877;
  double t891, t895, t897, t899, t905, t906, t908, t918;
  double t921, t925, t932, t935, t938, t940, t944, t949;
  double t958, t959, t962, t965, t980, t981, t988, t989;
  double t994, tv3rhosigma20, t997, t1000, t1001, t1005, t1007, t1008;
  double t1013, t1021, t1024, t1027, t1030, t1031, t1034, t1039;
  double t1041, t1043, t1046, t1049, t1052, t1053, t1056, t1059;
  double t1060, t1063, t1066, t1069, t1070, t1072, t1075, t1077;
  double t1081, t1086, t1089, t1090, t1096, t1097, t1107, t1108;
  double t1112, t1113, t1117, tv3sigma30;

  double t1133, t1155, t1163, t1164, t1168, t1172, t1175, t1177;
  double t1179, t1188, t1191, t1197, t1211, t1216, t1217, t1225;
  double t1228, t1231, t1236, t1245, t1246, t1252, t1267, t1273;
  double t1275, t1280, t1282, t1285, t1289, t1298, t1308, t1320;
  double t1325, t1329, t1330, t1332, t1345, t1350, t1353, t1357;
  double t1360, t1363, t1366, t1372, t1378, t1388, t1403, t1410;
  double tv4rho40, t1425, t1432, t1451, t1458, t1469, t1492, t1511;
  double t1518, t1531, t1558, t1568, t1612, t1637, t1652, t1655;
  double t1678, t1689, t1696, tv4rho3sigma0, t1716, t1731, t1743, t1746;
  double t1748, t1783, t1787, t1816, t1834, t1905, t1920, t1950;
  double t1956, t1959, t1962, t1968, t1975, tv4rho2sigma20, t2002, t2007;
  double t2022, t2047, t2049, t2074, t2090, t2127, t2185, t2190;
  double t2197, tv4rhosigma30, t2203, t2241, t2250, t2276, t2284, t2308;
  double t2357, t2363, t2386, t2388, t2394, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = sqrt(sigma[0]);
  t21 = M_CBRT2;
  t24 = 0.1e1 / t18 / rho[0];
  t25 = t20 * t21 * t24;
  t27 = exp(-t25 + 0.19e2);
  t28 = 0.1e1 + t27;
  t29 = 0.1e1 / t28;
  t30 = 0.1e1 - t29;
  t31 = M_CBRT6;
  t32 = M_PI * M_PI;
  t33 = POW_1_3(t32);
  t34 = t33 * t33;
  t35 = 0.1e1 / t34;
  t36 = t31 * t35;
  t37 = t21 * t21;
  t38 = sigma[0] * t37;
  t39 = rho[0] * rho[0];
  t40 = t18 * t18;
  t42 = 0.1e1 / t40 / t39;
  t43 = t38 * t42;
  t44 = t36 * t43;
  t46 = 0.1227e1 + 0.91464571985215458336e-2 * t44;
  t49 = 0.2227e1 - 0.1505529e1 / t46;
  t52 = exp(-0.25e2 / 0.6e1 * t44);
  t55 = (0.2743e0 - 0.1508e0 * t52) * t31;
  t56 = t55 * t35;
  t59 = t31 * t31;
  t61 = 0.1e1 / t33 / t32;
  t62 = t59 * t61;
  t63 = sigma[0] * sigma[0];
  t64 = t63 * t21;
  t65 = t39 * t39;
  t66 = t65 * rho[0];
  t68 = 0.1e1 / t18 / t66;
  t71 = 0.13888888888888888889e-4 * t62 * t64 * t68;
  t72 = t56 * t43 / 0.24e2 - t71;
  t74 = t59 / t33;
  t75 = t74 * t20;
  t76 = t21 * t24;
  t79 = log(0.64963333333333333333e0 * t74 * t25 + sqrt(POW_2(0.64963333333333333333e0 * t74 * t25) + 0.1e1));
  t80 = t76 * t79;
  t83 = 0.1e1 + 0.16370833333333333333e-1 * t75 * t80 + t71;
  t84 = 0.1e1 / t83;
  t86 = t72 * t84 + 0.1e1;
  t88 = t29 * t86 + t30 * t49;
  t92 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t88);
  tzk0 = 0.2e1 * t92;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t94 = t17 / t40;
  t98 = t28 * t28;
  t99 = 0.1e1 / t98;
  t100 = t99 * t20;
  t101 = t100 * t21;
  t103 = 0.1e1 / t18 / t39;
  t105 = t103 * t27 * t49;
  t108 = t46 * t46;
  t109 = 0.1e1 / t108;
  t111 = t30 * t109 * t31;
  t112 = t35 * sigma[0];
  t113 = t39 * rho[0];
  t115 = 0.1e1 / t40 / t113;
  t116 = t37 * t115;
  t120 = t99 * t86;
  t121 = t120 * t20;
  t122 = t21 * t103;
  t123 = t122 * t27;
  t126 = t62 * t63;
  t127 = t65 * t39;
  t129 = 0.1e1 / t18 / t127;
  t130 = t21 * t129;
  t131 = t130 * t52;
  t139 = 0.74074074074074074075e-4 * t62 * t64 * t129;
  t140 = -0.13962962962962962963e0 * t126 * t131 - t56 * t38 * t115 / 0.9e1 + t139;
  t142 = t83 * t83;
  t143 = 0.1e1 / t142;
  t144 = t72 * t143;
  t145 = t122 * t79;
  t148 = t36 * sigma[0];
  t150 = 0.25321408066666666666e1 * t44 + 0.1e1;
  t151 = sqrt(t150);
  t152 = 0.1e1 / t151;
  t153 = t116 * t152;
  t156 = -0.21827777777777777777e-1 * t75 * t145 - 0.85080312222222222219e-1 * t148 * t153 - t139;
  t158 = t140 * t84 - t144 * t156;
  t160 = 0.4e1 / 0.3e1 * t101 * t105 - 0.36720684159021185007e-1 * t111 * t112 * t116 - 0.4e1 / 0.3e1 * t121 * t123 + t29 * t158;
  t165 = my_piecewise3(t2, 0, -t6 * t94 * t88 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t160);
  tvrho0 = 0.2e1 * rho[0] * t165 + 0.2e1 * t92;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t168 = 0.1e1 / t20;
  t169 = t99 * t168;
  t170 = t169 * t21;
  t172 = t24 * t27 * t49;
  t175 = t35 * t37;
  t176 = t175 * t42;
  t179 = t120 * t168;
  t180 = t76 * t27;
  t183 = t62 * t21;
  t190 = sigma[0] * t21;
  t193 = 0.27777777777777777778e-4 * t62 * t190 * t68;
  t194 = 0.52361111111111111112e-1 * t183 * t68 * t52 * sigma[0] + t55 * t176 / 0.24e2 - t193;
  t196 = t74 * t168;
  t199 = t37 * t42;
  t200 = t199 * t152;
  t203 = 0.81854166666666666665e-2 * t196 * t80 + 0.31905117083333333333e-1 * t36 * t200 + t193;
  t205 = -t144 * t203 + t194 * t84;
  t207 = -t170 * t172 / 0.2e1 + 0.13770256559632944377e-1 * t111 * t176 + t179 * t180 / 0.2e1 + t29 * t205;
  t211 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t207);
  tvsigma0 = 0.2e1 * rho[0] * t211;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t216 = t17 / t40 / rho[0];
  t224 = 0.1e1 / t98 / t28;
  t226 = t224 * sigma[0] * t37;
  t228 = 0.1e1 / t40 / t65;
  t229 = t27 * t27;
  t231 = t228 * t229 * t49;
  t235 = 0.1e1 / t18 / t113;
  t237 = t235 * t27 * t49;
  t240 = t99 * sigma[0];
  t241 = t240 * t37;
  t243 = t228 * t27 * t49;
  t246 = t20 * sigma[0];
  t247 = t99 * t246;
  t248 = 0.1e1 / t127;
  t251 = t27 * t109 * t36;
  t255 = 0.1e1 / t108 / t46;
  t257 = t30 * t255 * t59;
  t258 = t61 * t63;
  t259 = t65 * t113;
  t261 = 0.1e1 / t18 / t259;
  t262 = t21 * t261;
  t266 = t37 * t228;
  t270 = t224 * t86;
  t271 = t270 * sigma[0];
  t272 = t266 * t229;
  t275 = t99 * t158;
  t276 = t275 * t20;
  t279 = t21 * t235;
  t280 = t279 * t27;
  t283 = t120 * sigma[0];
  t284 = t266 * t27;
  t287 = t262 * t52;
  t290 = t32 * t32;
  t291 = 0.1e1 / t290;
  t292 = t63 * sigma[0];
  t293 = t291 * t292;
  t294 = t65 * t65;
  t295 = t294 * t39;
  t296 = 0.1e1 / t295;
  t305 = 0.46913580246913580247e-3 * t62 * t64 * t261;
  t306 = 0.12566666666666666667e1 * t126 * t287 - 0.18617283950617283951e2 * t293 * t296 * t52 + 0.11e2 / 0.27e2 * t56 * t38 * t228 - t305;
  t308 = t140 * t143;
  t312 = 0.1e1 / t142 / t83;
  t313 = t72 * t312;
  t314 = t156 * t156;
  t317 = t279 * t79;
  t320 = t266 * t152;
  t324 = 0.1e1 / t151 / t150;
  t325 = t262 * t324;
  t328 = 0.5093148148148148148e-1 * t75 * t317 + 0.42540156111111111109e0 * t148 * t320 - 0.57449421445821236542e0 * t126 * t325 + t305;
  t330 = -t144 * t328 - 0.2e1 * t308 * t156 + t306 * t84 + 0.2e1 * t313 * t314;
  t332 = -0.32e2 / 0.9e1 * t226 * t231 - 0.28e2 / 0.9e1 * t101 * t237 + 0.16e2 / 0.9e1 * t241 * t243 - 0.1958436488481129867e0 * t247 * t248 * t251 - 0.35825511035830977502e-2 * t257 * t258 * t262 + 0.13464250858307767836e0 * t111 * t112 * t266 + 0.32e2 / 0.9e1 * t271 * t272 - 0.8e1 / 0.3e1 * t276 * t123 + 0.28e2 / 0.9e1 * t121 * t280 - 0.16e2 / 0.9e1 * t283 * t284 + t29 * t330;
  t337 = my_piecewise3(t2, 0, t6 * t216 * t88 / 0.12e2 - t6 * t94 * t160 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t332);
  tv2rho20 = 0.2e1 * rho[0] * t337 + 0.4e1 * t165;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t343 = t224 * t37;
  t345 = t115 * t229 * t49;
  t350 = t99 * t37;
  t352 = t115 * t27 * t49;
  t355 = 0.1e1 / t66;
  t359 = t61 * t21;
  t364 = t175 * t115;
  t367 = t116 * t229;
  t370 = t275 * t168;
  t375 = t116 * t27;
  t378 = t99 * t205;
  t379 = t378 * t20;
  t386 = t294 * rho[0];
  t387 = 0.1e1 / t386;
  t388 = t291 * t387;
  t389 = t63 * t52;
  t396 = 0.14814814814814814815e-3 * t62 * t190 * t129;
  t397 = -0.41888888888888888889e0 * t183 * t129 * t52 * sigma[0] + 0.69814814814814814816e1 * t388 * t389 - t55 * t364 / 0.9e1 + t396;
  t399 = t194 * t143;
  t402 = t203 * t156;
  t413 = -0.10913888888888888889e-1 * t196 * t145 - 0.12762046833333333333e0 * t36 * t153 + 0.21543533042182963704e0 * t183 * t129 * t324 * sigma[0] - t396;
  t415 = -t144 * t413 - t399 * t156 - t308 * t203 + 0.2e1 * t313 * t402 + t397 * t84;
  t417 = 0.4e1 / 0.3e1 * t343 * t345 + 0.2e1 / 0.3e1 * t170 * t105 - 0.2e1 / 0.3e1 * t350 * t352 + 0.73441368318042370012e-1 * t100 * t355 * t251 + 0.13434566638436616562e-2 * t257 * t359 * t129 * sigma[0] - 0.36720684159021185005e-1 * t111 * t364 - 0.4e1 / 0.3e1 * t270 * t367 + t370 * t180 / 0.2e1 - 0.2e1 / 0.3e1 * t179 * t123 + 0.2e1 / 0.3e1 * t120 * t375 - 0.4e1 / 0.3e1 * t379 * t123 + t29 * t415;
  t422 = my_piecewise3(t2, 0, -t6 * t94 * t207 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t417);
  tv2rhosigma0 = 0.2e1 * rho[0] * t422 + 0.2e1 * t211;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t425 = 0.1e1 / sigma[0];
  t426 = t224 * t425;
  t427 = t426 * t37;
  t429 = t42 * t229 * t49;
  t432 = 0.1e1 / t246;
  t433 = t99 * t432;
  t434 = t433 * t21;
  t437 = t99 * t425;
  t438 = t437 * t37;
  t440 = t42 * t27 * t49;
  t443 = 0.1e1 / t65;
  t450 = t270 * t425;
  t451 = t199 * t229;
  t454 = t378 * t168;
  t456 = t120 * t432;
  t459 = t120 * t425;
  t460 = t199 * t27;
  t463 = 0.1e1 / t294;
  t464 = t291 * t463;
  t465 = t52 * sigma[0];
  t468 = t21 * t68;
  t473 = 0.27777777777777777778e-4 * t62 * t468;
  t474 = -0.26180555555555555556e1 * t464 * t465 + 0.10472222222222222222e0 * t62 * t468 * t52 - t473;
  t478 = t203 * t203;
  t481 = t74 * t432;
  t484 = t36 * t425;
  t487 = t468 * t324;
  t490 = -0.40927083333333333332e-2 * t481 * t80 + 0.15952558541666666666e-1 * t484 * t200 - 0.80788248908186113886e-1 * t62 * t487 + t473;
  t492 = -t144 * t490 - 0.2e1 * t399 * t203 + 0.2e1 * t313 * t478 + t474 * t84;
  t494 = -t427 * t429 / 0.2e1 + t434 * t172 / 0.4e1 + t438 * t440 / 0.4e1 - 0.27540513119265888754e-1 * t169 * t443 * t251 - 0.50379624894137312108e-3 * t257 * t359 * t68 + t450 * t451 / 0.2e1 + t454 * t180 - t456 * t180 / 0.4e1 - t459 * t460 / 0.4e1 + t29 * t492;
  t498 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t494);
  tv2sigma20 = 0.2e1 * rho[0] * t498;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t501 = t17 * t42;
  t512 = 0.1e1 / t18 / t294;
  t513 = t21 * t512;
  t517 = t294 * t113;
  t518 = 0.1e1 / t517;
  t522 = t63 * t63;
  t523 = t291 * t522;
  t524 = t294 * t66;
  t526 = 0.1e1 / t40 / t524;
  t528 = t37 * t52;
  t529 = t36 * t528;
  t533 = 0.1e1 / t40 / t66;
  t539 = 0.34403292181069958848e-2 * t62 * t64 * t512;
  t540 = -0.10580823045267489712e2 * t126 * t513 * t52 + 0.35372839506172839507e3 * t293 * t518 * t52 - 0.20685871056241426612e3 * t523 * t526 * t529 - 0.154e3 / 0.81e2 * t56 * t38 * t533 + t539;
  t542 = t306 * t143;
  t545 = t140 * t312;
  t550 = t142 * t142;
  t551 = 0.1e1 / t550;
  t552 = t72 * t551;
  t553 = t314 * t156;
  t556 = t156 * t328;
  t560 = 0.1e1 / t18 / t65;
  t561 = t21 * t560;
  t562 = t561 * t79;
  t565 = t37 * t533;
  t566 = t565 * t152;
  t572 = t292 * t518;
  t573 = t150 * t150;
  t575 = 0.1e1 / t151 / t573;
  t578 = -0.16977160493827160493e0 * t75 * t562 - 0.22499015898765432098e1 * t148 * t566 + 0.70854286449846191734e1 * t126 * t513 * t324 - 0.71682849057236891051e0 * t572 * t575 - t539;
  t580 = -t144 * t578 - 0.3e1 * t542 * t156 - 0.3e1 * t308 * t328 + 0.6e1 * t313 * t556 + 0.6e1 * t545 * t314 + t540 * t84 - 0.6e1 * t552 * t553;
  t582 = 0.1e1 / t259;
  t583 = t246 * t582;
  t584 = t583 * t27;
  t587 = t98 * t98;
  t588 = 0.1e1 / t587;
  t589 = t588 * t86;
  t590 = t229 * t27;
  t591 = t583 * t590;
  t594 = t583 * t229;
  t597 = t588 * t246;
  t598 = t582 * t590;
  t602 = t224 * t246;
  t603 = t582 * t229;
  t611 = t275 * sigma[0];
  t614 = t565 * t27;
  t618 = t533 * t27 * t49;
  t621 = t224 * t158;
  t622 = t621 * sigma[0];
  t625 = t99 * t330;
  t626 = t625 * t20;
  t629 = t29 * t580 - 0.128e3 / 0.27e2 * t120 * t584 - 0.256e3 / 0.9e1 * t589 * t591 + 0.256e3 / 0.9e1 * t270 * t594 + 0.256e3 / 0.9e1 * t597 * t598 * t49 - 0.256e3 / 0.9e1 * t602 * t603 * t49 + 0.128e3 / 0.27e2 * t247 * t582 * t27 * t49 - 0.16e2 / 0.3e1 * t611 * t284 + 0.112e3 / 0.9e1 * t283 * t614 - 0.112e3 / 0.9e1 * t241 * t618 + 0.32e2 / 0.3e1 * t622 * t272 - 0.4e1 * t626 * t123;
  t630 = t561 * t27;
  t635 = t565 * t229;
  t639 = t560 * t27 * t49;
  t646 = t533 * t229 * t49;
  t649 = t20 * t63;
  t650 = t99 * t649;
  t652 = 0.1e1 / t40 / t386;
  t655 = t255 * t59;
  t657 = t655 * t61 * t37;
  t666 = t224 * t63;
  t668 = t229 * t109;
  t669 = t668 * t36;
  t672 = t99 * t63;
  t676 = t108 * t108;
  t677 = 0.1e1 / t676;
  t678 = t30 * t677;
  t681 = -0.28e3 / 0.27e2 * t121 * t630 + 0.28e2 / 0.3e1 * t276 * t280 - 0.224e3 / 0.9e1 * t271 * t635 + 0.28e3 / 0.27e2 * t101 * t639 + 0.17625928396330168804e1 * t247 * t582 * t251 + 0.224e3 / 0.9e1 * t226 * t646 - 0.14330204414332391e-1 * t650 * t652 * t27 * t657 + 0.39408062139414075252e-1 * t257 * t258 * t513 - 0.62833170672102916568e0 * t111 * t112 * t565 + 0.78337459539245194681e0 * t666 * t513 * t669 - 0.3916872976962259734e0 * t672 * t513 * t251 - 0.32293643214718787941e-4 * t678 * t572;
  t682 = t629 + t681;
  t687 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t501 * t88 + t6 * t216 * t160 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t94 * t332 - 0.3e1 / 0.8e1 * t6 * t19 * t682);
  tv3rho30 = 0.2e1 * rho[0] * t687 + 0.6e1 * t337;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t705 = t175 * t228;
  t708 = t625 * t168;
  t711 = t99 * t415;
  t712 = t711 * t20;
  t715 = t224 * t205;
  t716 = t715 * sigma[0];
  t719 = t378 * sigma[0];
  t726 = t291 * t296;
  t729 = t294 * t65;
  t731 = 0.1e1 / t40 / t729;
  t732 = t291 * t731;
  t740 = 0.93827160493827160495e-3 * t62 * t190 * t261;
  t741 = 0.3025308641975308642e1 * t183 * t261 * t52 * sigma[0] - 0.11868518518518518519e3 * t726 * t389 + 0.77572016460905349795e2 * t732 * t292 * t529 + 0.11e2 / 0.27e2 * t55 * t705 - t740;
  t743 = t397 * t143;
  t746 = t194 * t312;
  t755 = t203 * t314;
  t758 = t413 * t156;
  t761 = t203 * t328;
  t772 = t296 * t575;
  t775 = 0.25465740740740740741e-1 * t196 * t317 + 0.52466192537037037036e0 * t36 * t320 - 0.2226165081025572916e1 * t183 * t261 * t324 * sigma[0] + 0.26881068396463834145e0 * t772 * t63 + t740;
  t777 = -t144 * t775 - 0.2e1 * t743 * t156 - t542 * t203 - 0.2e1 * t308 * t413 + 0.4e1 * t313 * t758 + 0.2e1 * t313 * t761 + 0.2e1 * t746 * t314 - t399 * t328 + 0.4e1 * t545 * t402 - 0.6e1 * t552 * t755 + t741 * t84;
  t781 = t248 * t590;
  t782 = t781 * t20;
  t785 = t248 * t229;
  t786 = t785 * t20;
  t791 = 0.28e2 / 0.9e1 * t379 * t280 + 0.14e2 / 0.9e1 * t179 * t280 - 0.4e1 / 0.3e1 * t370 * t123 - 0.14e2 / 0.9e1 * t170 * t237 + 0.13464250858307767835e0 * t111 * t705 + t708 * t180 / 0.2e1 - 0.8e1 / 0.3e1 * t712 * t123 + 0.32e2 / 0.9e1 * t716 * t272 - 0.16e2 / 0.9e1 * t719 * t284 + t29 * t777 - 0.8e1 / 0.3e1 * t621 * t367 + 0.32e2 / 0.3e1 * t589 * t782 - 0.32e2 / 0.3e1 * t270 * t786 + 0.4e1 / 0.3e1 * t275 * t375;
  t793 = t590 * t49;
  t794 = t793 * t20;
  t798 = t229 * t49;
  t799 = t798 * t20;
  t806 = t20 * t27 * t49;
  t812 = t248 * t20 * t27;
  t826 = t224 * t21;
  t827 = t261 * t229;
  t829 = t109 * t31;
  t830 = t829 * t112;
  t833 = t99 * t21;
  t839 = 0.1e1 / t40 / t294;
  t847 = -0.32e2 / 0.3e1 * t588 * t248 * t794 + 0.32e2 / 0.3e1 * t224 * t248 * t799 + 0.1e2 / 0.3e1 * t350 * t243 - 0.16e2 / 0.9e1 * t99 * t248 * t806 - 0.1e2 / 0.3e1 * t120 * t284 + 0.16e2 / 0.9e1 * t120 * t812 - 0.2e2 / 0.3e1 * t343 * t231 + 0.2e2 / 0.3e1 * t270 * t272 - 0.12091109974592954906e-1 * t257 * t359 * t261 * sigma[0] - 0.51408957822629659009e0 * t100 * t248 * t251 - 0.29376547327216948005e0 * t826 * t827 * t830 + 0.14688273663608474002e0 * t833 * t261 * t27 * t830 + 0.5373826655374646625e-2 * t247 * t839 * t27 * t657 + 0.12110116205519545477e-4 * t678 * t296 * t63;
  t848 = t791 + t847;
  t853 = my_piecewise3(t2, 0, t6 * t216 * t207 / 0.12e2 - t6 * t94 * t417 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t848);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t853 + 0.4e1 * t422;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t861 = t621 * t425;
  t864 = t711 * t168;
  t866 = t275 * t432;
  t871 = t275 * t425;
  t876 = t99 * t492;
  t877 = t876 * t20;
  t891 = -t438 * t352 / 0.3e1 + t861 * t451 / 0.2e1 + t864 * t180 - t866 * t180 / 0.4e1 + t459 * t375 / 0.3e1 - t871 * t460 / 0.4e1 - t434 * t105 / 0.3e1 - 0.4e1 / 0.3e1 * t877 * t123 - 0.4e1 / 0.3e1 * t454 * t123 + t456 * t123 / 0.3e1 + 0.26869133276873233124e-2 * t257 * t359 * t129 - 0.2e1 / 0.3e1 * t450 * t367 + 0.2e1 / 0.3e1 * t427 * t345;
  t895 = 0.1e1 / t40 / t517;
  t897 = t291 * t895 * t31;
  t899 = t35 * t63 * t528;
  t905 = 0.14814814814814814815e-3 * t62 * t130;
  t906 = 0.34907407407407407408e2 * t388 * t465 - 0.29089506172839506173e2 * t897 * t899 - 0.55851851851851851851e0 * t62 * t131 + t905;
  t908 = t474 * t143;
  t918 = t478 * t156;
  t921 = t203 * t413;
  t925 = t490 * t156;
  t932 = t130 * t324;
  t935 = t387 * t575;
  t938 = 0.54569444444444444443e-2 * t481 * t145 - 0.21270078055555555554e-1 * t484 * t153 + 0.53858832605457409257e0 * t62 * t932 - 0.10080400648673937804e0 * t935 * sigma[0] - t905;
  t940 = -t144 * t938 - t908 * t156 - 0.2e1 * t743 * t203 - t308 * t490 + 0.4e1 * t313 * t921 + 0.2e1 * t313 * t925 - 0.2e1 * t399 * t413 + 0.4e1 * t746 * t402 + 0.2e1 * t545 * t478 - 0.6e1 * t552 * t918 + t906 * t84;
  t944 = t588 * t168;
  t949 = t224 * t168;
  t958 = t168 * t355;
  t959 = t958 * t27;
  t962 = t958 * t590;
  t965 = t958 * t229;
  t980 = 0.1e1 / t40 / t259;
  t981 = t980 * t27;
  t988 = t29 * t940 + 0.4e1 / 0.3e1 * t378 * t375 + 0.4e1 * t944 * t355 * t590 * t49 - 0.4e1 * t949 * t355 * t229 * t49 + 0.2e1 / 0.3e1 * t169 * t355 * t27 * t49 - 0.2e1 / 0.3e1 * t120 * t959 - 0.4e1 * t589 * t962 + 0.4e1 * t270 * t965 - 0.8e1 / 0.3e1 * t715 * t367 - 0.55081026238531777509e-1 * t833 * t129 * t251 + 0.11016205247706355502e0 * t826 * t129 * t669 + 0.91801710397552962516e-1 * t169 * t355 * t251 - 0.20151849957654924843e-2 * t100 * t981 * t657 - 0.45412935770698295538e-5 * t678 * t387 * sigma[0];
  t989 = t891 + t988;
  t994 = my_piecewise3(t2, 0, -t6 * t94 * t494 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t989);
  tv3rhosigma20 = 0.2e1 * rho[0] * t994 + 0.2e1 * t498;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t997 = t378 * t432;
  t1000 = 0.1e1 / t649;
  t1001 = t120 * t1000;
  t1005 = 0.1e1 / t40 / t295;
  t1007 = t291 * t1005 * t31;
  t1008 = t175 * t465;
  t1013 = 0.10908564814814814815e2 * t1007 * t1008 - 0.78541666666666666666e1 * t464 * t52;
  t1021 = t478 * t203;
  t1024 = t203 * t490;
  t1027 = t74 * t1000;
  t1030 = 0.1e1 / t63;
  t1031 = t36 * t1030;
  t1034 = t62 * t425;
  t1039 = 0.61390624999999999998e-2 * t1027 * t80 - 0.23928837812499999999e-1 * t1031 * t200 - 0.40394124454093056942e-1 * t1034 * t487 + 0.37801502432527266763e-1 * t463 * t575;
  t1041 = t1013 * t84 - 0.6e1 * t552 * t1021 + 0.6e1 * t313 * t1024 - t144 * t1039 - 0.3e1 * t908 * t203 - 0.3e1 * t399 * t490 + 0.6e1 * t746 * t478;
  t1043 = t378 * t425;
  t1046 = t120 * t1030;
  t1049 = t876 * t168;
  t1052 = t99 * t1030;
  t1053 = t1052 * t37;
  t1056 = t715 * t425;
  t1059 = t432 * t443;
  t1060 = t1059 * t27;
  t1063 = t1059 * t590;
  t1066 = t1059 * t229;
  t1069 = -0.3e1 / 0.4e1 * t997 * t180 + 0.3e1 / 0.8e1 * t1001 * t180 + t29 * t1041 - 0.3e1 / 0.4e1 * t1043 * t460 + 0.3e1 / 0.8e1 * t1046 * t460 + 0.3e1 / 0.2e1 * t1049 * t180 - 0.3e1 / 0.8e1 * t1053 * t440 + 0.3e1 / 0.2e1 * t1056 * t451 + t120 * t1060 / 0.4e1 + 0.3e1 / 0.2e1 * t589 * t1063 - 0.3e1 / 0.2e1 * t270 * t1066;
  t1070 = t588 * t432;
  t1072 = t443 * t590 * t49;
  t1075 = t224 * t432;
  t1077 = t443 * t229 * t49;
  t1081 = t443 * t27 * t49;
  t1086 = t270 * t1030;
  t1089 = t99 * t1000;
  t1090 = t1089 * t21;
  t1096 = t224 * t1030;
  t1097 = t1096 * t37;
  t1107 = 0.1e1 / t40 / t127;
  t1108 = t1107 * t27;
  t1112 = -0.3e1 / 0.2e1 * t1070 * t1072 + 0.3e1 / 0.2e1 * t1075 * t1077 - t433 * t1081 / 0.4e1 + 0.17029850914011860826e-5 * t678 * t463 - 0.3e1 / 0.4e1 * t1086 * t451 - 0.3e1 / 0.8e1 * t1090 * t172 + 0.20655384839449416566e-1 * t433 * t443 * t251 + 0.3e1 / 0.4e1 * t1097 * t429 - 0.41310769678898833131e-1 * t426 * t468 * t669 + 0.20655384839449416566e-1 * t437 * t468 * t251 + 0.75569437341205968162e-3 * t169 * t1108 * t657;
  t1113 = t1069 + t1112;
  t1117 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1113);
  tv3sigma30 = 0.2e1 * rho[0] * t1117;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1133 = t246 * t463;
  t1155 = t588 * t158;
  t1163 = 0.1e1 / t18 / t386;
  t1164 = t21 * t1163;
  t1168 = t37 * t1107;
  t1172 = 0.1792e4 / 0.27e2 * t120 * t1133 * t27 + 0.3584e4 / 0.9e1 * t589 * t1133 * t590 - 0.3584e4 / 0.9e1 * t270 * t1133 * t229 - 0.3584e4 / 0.9e1 * t597 * t463 * t590 * t49 + 0.3584e4 / 0.9e1 * t602 * t463 * t229 * t49 + 0.1024e4 / 0.9e1 * t621 * t594 - 0.512e3 / 0.27e2 * t275 * t584 - 0.1024e4 / 0.9e1 * t1155 * t591 - 0.1792e4 / 0.27e2 * t247 * t463 * t27 * t49 - 0.38970194782309474416e0 * t257 * t258 * t1164 + 0.35605463380858319389e1 * t111 * t112 * t1168;
  t1175 = t30 / t676 / t46;
  t1177 = t294 * t127;
  t1179 = 0.1e1 / t40 / t1177;
  t1188 = 0.1e1 / t729;
  t1191 = t229 * t255 * t62;
  t1197 = t27 * t255 * t62;
  t1211 = t294 * t294;
  t1216 = t21 * t52;
  t1217 = t62 * t1216;
  t1225 = 0.28669410150891632373e-1 * t62 * t64 * t1163;
  t1228 = t540 * t143;
  t1231 = t306 * t312;
  t1236 = t140 * t551;
  t1245 = t72 / t550 / t83;
  t1246 = t314 * t314;
  t1252 = t328 * t328;
  t1267 = t292 * t1188;
  t1273 = 0.1e1 / t151 / t573 / t150;
  t1275 = t36 * t37;
  t1280 = (0.9454477366255144033e2 * t126 * t1164 * t52 - 0.53017887517146776407e4 * t293 * t1188 * t52 + 0.67573845450388660266e4 * t523 * t1179 * t529 - 0.45968602347203170249e4 * t291 * t522 * sigma[0] / t18 / t1211 / rho[0] * t1217 + 0.2618e4 / 0.243e3 * t56 * t38 * t1107 - t1225) * t84 - 0.4e1 * t1228 * t156 + 0.12e2 * t1231 * t314 - 0.6e1 * t542 * t328 - 0.24e2 * t1236 * t553 + 0.24e2 * t545 * t556 - 0.4e1 * t308 * t578 + 0.24e2 * t1245 * t1246 - 0.36e2 * t552 * t314 * t328 + 0.6e1 * t313 * t1252 + 0.8e1 * t313 * t156 * t578 - t144 * (0.73567695473251028803e0 * t75 * t468 * t79 + 0.13631756691604938272e2 * t148 * t1168 * t152 - 0.74237419046100108997e2 * t126 * t1164 * t324 + 0.16725998113355274578e2 * t1267 * t575 - 0.12100737815730448498e2 * t522 * t1179 * t1273 * t1275 + t1225);
  t1282 = t1163 * t229;
  t1285 = t829 * t35 * t21;
  t1289 = t650 * t1005 * t27;
  t1298 = t829 * t175;
  t1308 = -0.31506392047760120809e-5 * t1175 * t522 * t1179 * t31 * t175 - 0.14775315285318746442e2 * t247 * t463 * t251 + 0.15285551375287883734e0 * t224 * t292 * t1188 * t1191 - 0.76427756876439418667e-1 * t99 * t292 * t1188 * t1197 + t29 * t1280 - 0.1305624325654086578e2 * t666 * t1282 * t1285 + 0.27705061867709289268e0 * t1289 * t657 + 0.65281216282704328901e1 * t672 * t1164 * t251 - 0.41779978420930770496e1 * t588 * t649 * t1005 * t590 * t1298 + 0.41779978420930770496e1 * t224 * t649 * t1005 * t229 * t1298 - 0.69633297368217950827e0 * t1289 * t1298;
  t1320 = t99 * t580;
  t1325 = t798 * t21;
  t1329 = 0.1e1 / t587 / t28;
  t1330 = t1329 * t86;
  t1332 = t229 * t229;
  t1345 = t1332 * t49 * t21;
  t1350 = t793 * t21;
  t1353 = t1107 * t229;
  t1357 = t20 * t292;
  t1360 = 0.1e1 / t18 / t524;
  t1363 = t27 * t677 * t21;
  t1366 = 0.7104601507238133347e-3 * t678 * t1267 + 0.7168e4 / 0.81e2 * t270 * t63 * t1282 * t21 - 0.512e3 / 0.81e2 * t120 * t63 * t1164 * t27 - 0.16e2 / 0.3e1 * t1320 * t20 * t123 - 0.7168e4 / 0.81e2 * t666 * t1163 * t1325 + 0.4096e4 / 0.27e2 * t1330 * t63 * t1163 * t1332 * t21 - 0.2048e4 / 0.9e1 * t589 * t63 * t1163 * t590 * t21 - 0.4096e4 / 0.27e2 * t1329 * t63 * t1163 * t1345 + 0.2048e4 / 0.9e1 * t588 * t63 * t1163 * t1350 - 0.13664e5 / 0.81e2 * t226 * t1353 * t49 - 0.17223276381183353568e-3 * t99 * t1357 * t1360 * t1363;
  t1372 = t224 * t330;
  t1378 = t21 * t27 * t49;
  t1388 = t468 * t27;
  t1403 = -0.112e4 / 0.27e2 * t276 * t630 + 0.13664e5 / 0.81e2 * t271 * t1168 * t229 + 0.64e2 / 0.3e1 * t1372 * sigma[0] * t272 + 0.512e3 / 0.81e2 * t672 * t1163 * t1378 - 0.32e2 / 0.3e1 * t625 * sigma[0] * t284 - 0.364e4 / 0.81e2 * t101 * t68 * t27 * t49 + 0.364e4 / 0.81e2 * t121 * t1388 + 0.56e2 / 0.3e1 * t626 * t280 - 0.896e3 / 0.9e1 * t622 * t635 + 0.448e3 / 0.9e1 * t611 * t614 - 0.6832e4 / 0.81e2 * t283 * t1168 * t27 + 0.6832e4 / 0.81e2 * t241 * t1108 * t49;
  t1410 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t115 * t88 - 0.5e1 / 0.9e1 * t6 * t501 * t160 + t6 * t216 * t332 / 0.2e1 - t6 * t94 * t682 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1172 + t1308 + t1366 + t1403));
  tv4rho40 = 0.2e1 * rho[0] * t1410 + 0.8e1 * t687;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1425 = t99 * t652 * t246 * t27;
  t1432 = t36 * t246 * t37;
  t1451 = t224 * t415;
  t1458 = t99 * t777;
  t1469 = 0.26112486513081731559e0 * t1425 * t1298 + 0.15667491907849038936e1 * t588 * t652 * t590 * t109 * t1432 - 0.20073974006931581136e1 * t240 * t513 * t251 - 0.87772502037785894876e-1 * t1425 * t657 + 0.40147948013863162274e1 * t826 * t512 * t229 * t830 - 0.15667491907849038936e1 * t224 * t652 * t668 * t1432 - 0.23009220790487136406e-3 * t678 * t518 * t63 + 0.32e2 / 0.3e1 * t1451 * sigma[0] * t272 - 0.16e2 / 0.3e1 * t711 * sigma[0] * t284 - 0.4e1 * t1458 * t20 * t123 + t1320 * t168 * t180 / 0.2e1 + 0.28e2 / 0.3e1 * t712 * t280 + 0.112e3 / 0.9e1 * t719 * t614;
  t1492 = t175 * t533;
  t1511 = t49 * sigma[0] * t21;
  t1518 = -0.224e3 / 0.9e1 * t716 * t635 - 0.2e1 * t708 * t123 - 0.28e3 / 0.27e2 * t379 * t630 + 0.256e3 / 0.3e1 * t589 * t512 * t590 * sigma[0] * t21 - 0.896e3 / 0.27e2 * t270 * t512 * sigma[0] * t229 * t21 + 0.64e2 / 0.27e2 * t120 * t512 * t190 * t27 + 0.14e2 / 0.3e1 * t370 * t280 - 0.62833170672102916563e0 * t111 * t1492 + 0.14e3 / 0.27e2 * t170 * t639 - 0.14e3 / 0.27e2 * t179 * t630 - 0.64e2 / 0.27e2 * t99 * t512 * sigma[0] * t1378 + 0.64587286429437575877e-4 * t650 / t18 / t729 * t1363 + 0.512e3 / 0.9e1 * t1329 * t512 * t1332 * t1511 - 0.256e3 / 0.3e1 * t588 * t512 * t590 * t1511;
  t1531 = t588 * t205;
  t1558 = 0.896e3 / 0.27e2 * t224 * t512 * t229 * t1511 - 0.512e3 / 0.9e1 * t1330 * t512 * t1332 * sigma[0] * t21 + 0.952e3 / 0.27e2 * t343 * t646 - 0.256e3 / 0.9e1 * t1531 * t591 + 0.256e3 / 0.9e1 * t715 * t594 - 0.128e3 / 0.27e2 * t378 * t584 - 0.952e3 / 0.27e2 * t270 * t635 - 0.4e1 * t1372 * t367 + 0.2e1 * t625 * t375 + 0.352e3 / 0.3e1 * t588 * t582 * t794 - 0.352e3 / 0.3e1 * t224 * t582 * t799 + 0.2e2 * t621 * t272 - 0.352e3 / 0.3e1 * t589 * t598 * t20 + 0.352e3 / 0.3e1 * t270 * t603 * t20;
  t1568 = t655 * t258;
  t1612 = 0.68806584362139917696e-2 * t62 * t190 * t512;
  t1637 = t741 * t143;
  t1652 = t397 * t312;
  t1655 = t194 * t551;
  t1678 = 0.24e2 * t1245 * t203 * t553 + 0.6e1 * t313 * t775 * t156 + 0.2e1 * t313 * t203 * t578 + 0.6e1 * t313 * t413 * t328 - 0.18e2 * t552 * t413 * t314 + 0.6e1 * t1231 * t402 + 0.6e1 * t1652 * t314 - 0.6e1 * t1655 * t553 + 0.12e2 * t545 * t758 + 0.6e1 * t545 * t761 + 0.6e1 * t746 * t556;
  t1689 = 0.10180416052681969439e0 * t257 * t359 * t512 * sigma[0] + 0.3557826287407385925e1 * t100 * t582 * t251 - 0.57320817657329564001e-1 * t224 * t518 * t229 * t1568 + 0.28660408828664782e-1 * t99 * t518 * t27 * t1568 + 0.11814897017910045303e-5 * t1175 * t526 * t292 * t31 * t175 + 0.176e3 / 0.9e1 * t99 * t582 * t806 + 0.32e2 * t1155 * t782 - 0.32e2 * t621 * t786 - 0.176e3 / 0.9e1 * t120 * t582 * t20 * t27 + t29 * ((-0.23550864197530864197e2 * t183 * t512 * t52 * sigma[0] + 0.15902263374485596708e4 * t291 * t518 * t389 - 0.23013031550068587107e4 * t291 * t526 * t292 * t529 + 0.17238225880201188843e4 * t291 / t18 / t1211 * t522 * t1217 - 0.154e3 / 0.81e2 * t55 * t1492 + t1612) * t84 - t144 * (-0.8488580246913580247e-1 * t196 * t562 - 0.25807694707407407406e1 * t36 * t566 + 0.19867924916679844304e2 * t183 * t512 * t324 * sigma[0] - 0.54658172406143129427e1 * t518 * t575 * t63 + 0.4537776680898918187e1 * t526 * t1273 * t292 * t1275 - t1612) - 0.3e1 * t308 * t775 - t1228 * t203 - 0.3e1 * t542 * t413 - 0.3e1 * t1637 * t156 - 0.3e1 * t743 * t328 - t399 * t578 - 0.18e2 * t552 * t402 * t328 - 0.18e2 * t1236 * t755 + t1678) + 0.16e2 / 0.3e1 * t275 * t812 - 0.1e2 * t275 * t284 - 0.476e3 / 0.27e2 * t350 * t618 + 0.476e3 / 0.27e2 * t120 * t614;
  t1696 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t501 * t207 + t6 * t216 * t417 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t94 * t848 - 0.3e1 / 0.8e1 * t6 * t19 * (t1469 + t1518 + t1558 + t1689));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1696 + 0.6e1 * t853;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1716 = t99 * t940;
  t1731 = t224 * t492;
  t1743 = t829 * t35 * t20;
  t1746 = -0.8e1 / 0.3e1 * t864 * t123 + 0.2e1 / 0.3e1 * t866 * t123 + 0.14e2 / 0.9e1 * t450 * t272 - 0.7e1 / 0.9e1 * t459 * t284 - 0.4e1 / 0.3e1 * t861 * t367 - 0.8e1 / 0.3e1 * t1716 * t20 * t123 - t625 * t432 * t180 / 0.4e1 + 0.7e1 / 0.9e1 * t438 * t243 - 0.16e2 / 0.9e1 * t876 * sigma[0] * t284 - t625 * t425 * t460 / 0.4e1 + 0.32e2 / 0.9e1 * t1731 * sigma[0] * t272 + 0.2e1 / 0.3e1 * t871 * t375 + t1372 * t425 * t451 / 0.2e1 + 0.5875309465443389601e0 * t343 * t839 * t229 * t1743;
  t1748 = t350 * t839 * t20;
  t1783 = t168 * t248;
  t1787 = -0.9792182442405649335e-1 * t1748 * t251 + 0.23510491617264078984e-1 * t1748 * t1197 - 0.58753094654433896011e0 * t588 * t37 * t839 * t590 * t1743 - 0.17017117742019714312e-1 * t257 * t359 * t261 + t1458 * t168 * t180 + 0.28e2 / 0.9e1 * t877 * t280 - 0.14e2 / 0.9e1 * t427 * t231 + 0.7e1 / 0.9e1 * t434 * t237 + 0.28e2 / 0.9e1 * t454 * t280 - 0.7e1 / 0.9e1 * t456 * t280 - 0.24220232411039090953e-4 * t247 / t18 / t517 * t1363 + 0.49572923614678599759e0 * t833 * t261 * t251 - 0.2e2 / 0.3e1 * t378 * t284 + 0.38e2 / 0.9e1 * t120 * t1783 * t27;
  t1816 = t655 * t61 * sigma[0];
  t1834 = 0.8e1 * t621 * t965 - 0.4e1 / 0.3e1 * t275 * t959 + 0.76e2 / 0.3e1 * t589 * t1783 * t590 - 0.76e2 / 0.3e1 * t270 * t1783 * t229 - 0.76e2 / 0.3e1 * t944 * t781 * t49 + 0.76e2 / 0.3e1 * t949 * t785 * t49 + 0.4e2 / 0.3e1 * t715 * t272 - 0.43452809588175068924e0 * t169 * t248 * t251 - 0.99145847229357199519e0 * t826 * t261 * t669 + 0.214953066214985865e-1 * t224 * t296 * t229 * t1816 - 0.1074765331074929325e-1 * t99 * t296 * t27 * t1816 - 0.44305863817162669884e-6 * t1175 * t731 * t63 * t31 * t175 + 0.8e1 / 0.3e1 * t711 * t375 - 0.38e2 / 0.9e1 * t169 * t248 * t27 * t49;
  t1905 = 0.93827160493827160495e-3 * t62 * t262;
  t1920 = -0.6e1 * t552 * t490 * t314 + 0.24e2 * t1245 * t478 * t314 - 0.12e2 * t1655 * t755 + 0.8e1 * t1652 * t402 + 0.8e1 * t746 * t758 + 0.4e1 * t746 * t761 - 0.24e2 * t552 * t402 * t413 + (-0.38863580246913580247e3 * t726 * t465 + 0.72723765432098765433e3 * t732 * t31 * t899 - 0.64643347050754458162e3 * t291 / t18 / t294 / t259 * t59 * t61 * t292 * t1216 + 0.35372839506172839506e1 * t62 * t287 - t1905) * t84 - 0.12e2 * t1236 * t918 + 0.8e1 * t545 * t921 - 0.6e1 * t552 * t478 * t328 + 0.4e1 * t313 * t203 * t775 + 0.4e1 * t545 * t925;
  t1950 = t906 * t143;
  t1956 = t413 * t413;
  t1959 = t474 * t312;
  t1962 = 0.4e1 * t313 * t938 * t156 + 0.2e1 * t313 * t490 * t328 - t144 * (-0.1273287037037037037e-1 * t481 * t317 + 0.49630182129629629625e-1 * t484 * t320 - 0.3554682951960189011e1 * t62 * t325 + 0.1579262768292250256e1 * t772 * sigma[0] - 0.17016662553370943201e1 * t731 * t1273 * t63 * t1275 + t1905) - t542 * t490 - 0.2e1 * t308 * t938 + 0.2e1 * t1231 * t478 - 0.4e1 * t743 * t413 - 0.2e1 * t399 * t775 - 0.2e1 * t1950 * t156 - t908 * t328 - 0.2e1 * t1637 * t203 + 0.4e1 * t313 * t1956 + 0.2e1 * t1959 * t314;
  t1968 = -0.8e1 * t1155 * t962 - 0.16e2 / 0.3e1 * t1451 * t367 + 0.32e2 * t588 * t261 * t1350 - 0.112e3 / 0.9e1 * t224 * t261 * t1325 + 0.64e2 / 0.3e1 * t1531 * t782 - 0.64e2 / 0.3e1 * t715 * t786 + 0.112e3 / 0.9e1 * t270 * t827 * t21 - 0.8e1 / 0.9e1 * t120 * t262 * t27 + 0.64e2 / 0.3e1 * t1330 * t261 * t1332 * t21 - 0.32e2 * t589 * t261 * t590 * t21 + 0.8e1 / 0.9e1 * t99 * t261 * t1378 + 0.32e2 / 0.9e1 * t378 * t812 - 0.64e2 / 0.3e1 * t1329 * t261 * t1345 + t29 * (t1920 + t1962) + 0.65091874604667556937e-4 * t678 * t296 * sigma[0];
  t1975 = my_piecewise3(t2, 0, t6 * t216 * t494 / 0.12e2 - t6 * t94 * t989 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1746 + t1787 + t1834 + t1968));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1975 + 0.4e1 * t994;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t2002 = t99 * t1041;
  t2007 = 0.3e1 / 0.8e1 * t275 * t1030 * t460 - t1001 * t123 / 0.2e1 + t997 * t123 + t1053 * t352 / 0.2e1 + 0.3e1 / 0.2e1 * t1451 * t425 * t451 + t1090 * t105 / 0.2e1 - 0.2e1 * t1049 * t123 - 0.3e1 / 0.4e1 * t711 * t432 * t180 + 0.3e1 / 0.8e1 * t275 * t1000 * t180 - 0.4e1 / 0.3e1 * t2002 * t20 * t123 + t1086 * t367;
  t2022 = t655 * t61;
  t2047 = -t1046 * t375 / 0.2e1 - 0.2e1 * t1056 * t367 + t1043 * t375 - 0.3e1 / 0.4e1 * t711 * t425 * t460 + 0.3e1 / 0.2e1 * t1716 * t168 * t180 - t1097 * t345 - 0.80607399830619699373e-2 * t224 * t387 * t229 * t2022 + 0.40303699915309849687e-2 * t99 * t387 * t27 * t2022 - 0.8e1 * t1330 * t425 * t129 * t1332 * t21 + 0.12e2 * t589 * t425 * t129 * t590 * t21 + 0.8e1 * t1329 * t425 * t129 * t1345 - 0.12e2 * t588 * t425 * t129 * t1350;
  t2049 = t129 * t229;
  t2074 = t169 * t981;
  t2090 = -0.14e2 / 0.3e1 * t450 * t2049 * t21 + t459 * t130 * t27 / 0.3e1 + 0.14e2 / 0.3e1 * t426 * t129 * t1325 - t437 * t129 * t1378 / 0.3e1 + 0.90825871541396591075e-5 * t101 / t18 / t295 * t27 * t677 - 0.3e1 / 0.4e1 * t621 * t1030 * t451 + 0.11016205247706355501e0 * t426 * t2049 * t1285 - 0.40303699915309849686e-2 * t2074 * t657 + 0.22032410495412711003e0 * t944 * t980 * t590 * t1298 - 0.22032410495412711004e0 * t949 * t980 * t229 * t1298 + 0.36720684159021185007e-1 * t2074 * t1298 - 0.5508102623853177751e-1 * t437 * t130 * t251;
  t2127 = t1013 * t143;
  t2185 = -0.3e1 * t399 * t938 - 0.6e1 * t1236 * t1021 + 0.24e2 * t1245 * t1021 * t156 - 0.18e2 * t552 * t478 * t413 + 0.6e1 * t545 * t1024 - 0.18e2 * t552 * t1024 * t156 + 0.6e1 * t313 * t413 * t490 + 0.6e1 * t313 * t203 * t938 - t308 * t1039 + 0.2e1 * t313 * t1039 * t156 - t144 * (-0.81854166666666666664e-2 * t1027 * t145 + 0.31905117083333333332e-1 * t1031 * t153 + 0.5385883260545740925e-1 * t1034 * t932 - 0.35281402270358782312e0 * t935 + 0.63812484575141037e0 * t895 * t1273 * t31 * t112 * t37);
  t2190 = 0.12e2 * t715 * t965 - 0.2e1 * t378 * t959 - 0.4e1 * t1731 * t367 + 0.2e1 * t876 * t375 - 0.3e1 / 0.2e1 * t621 * t1066 - 0.12e2 * t1531 * t962 + t275 * t1060 / 0.4e1 + 0.3e1 / 0.2e1 * t1155 * t1063 - 0.55081026238531777509e-1 * t433 * t355 * t251 + 0.16614698931436001206e-6 * t1175 * t895 * t36 * t38 + t29 * ((-0.20362654320987654321e3 * t897 * t1008 + 0.24241255144032921811e3 * t291 / t18 / t1177 * t59 * t359 * t389 + 0.62833333333333333333e2 * t388 * t52) * t84 - t2127 * t156 - 0.3e1 * t1950 * t203 + 0.6e1 * t1959 * t402 - 0.3e1 * t908 * t413 + 0.6e1 * t1652 * t478 - 0.18e2 * t1655 * t918 + 0.12e2 * t746 * t921 - 0.3e1 * t743 * t490 + 0.6e1 * t746 * t925 + t2185) - 0.13623880731209488661e-4 * t678 * t387;
  t2197 = my_piecewise3(t2, 0, -t6 * t94 * t1113 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t2007 + t2047 + t2090 + t2190));
  tv4rhosigma30 = 0.2e1 * rho[0] * t2197 + 0.2e1 * t1117;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t2203 = t68 * t229;
  t2241 = 0.1e1 / t292;
  t2250 = 0.1e1 / t1357;
  t2276 = -0.62305120992885004519e-7 * t1175 * t1005 * t1275 - 0.15e2 / 0.8e1 * t224 * t2241 * t37 * t429 + 0.15e2 / 0.16e2 * t99 * t2241 * t37 * t440 + 0.15e2 / 0.16e2 * t99 * t2250 * t21 * t172 + 0.2e1 * t2002 * t168 * t180 - 0.3e1 / 0.2e1 * t876 * t425 * t460 - 0.3e1 * t715 * t1030 * t451 + 0.3e1 / 0.2e1 * t378 * t1030 * t460 + 0.15e2 / 0.8e1 * t270 * t2241 * t451 - 0.15e2 / 0.16e2 * t120 * t2241 * t460 - 0.3e1 / 0.2e1 * t876 * t432 * t180;
  t2284 = t433 * t1108;
  t2308 = t1000 * t443;
  t2357 = t478 * t478;
  t2363 = t490 * t490;
  t2386 = (-0.90904706790123456792e2 * t291 * t1360 * t59 * t359 * t465 + 0.43634259259259259259e2 * t1007 * t175 * t52) * t84 - 0.4e1 * t2127 * t203 + 0.12e2 * t1959 * t478 - 0.6e1 * t908 * t490 - 0.24e2 * t1655 * t1021 + 0.24e2 * t746 * t1024 - 0.4e1 * t399 * t1039 + 0.24e2 * t1245 * t2357 - 0.36e2 * t552 * t478 * t490 + 0.6e1 * t313 * t2363 + 0.8e1 * t313 * t203 * t1039 - t144 * (-0.1534765625e-1 * t74 * t2250 * t80 + 0.59822094531249999998e-1 * t36 * t2241 * t200 + 0.10098531113523264236e0 * t62 * t1030 * t487 + 0.18900751216263633381e-1 * t425 * t463 * t575 - 0.23929681715677888874e0 * t1005 * t1273 * t1275);
  t2388 = t378 * t1060 + 0.9e1 / 0.2e1 * t270 * t2308 * t229 - 0.3e1 / 0.4e1 * t120 * t2308 * t27 - 0.9e1 / 0.2e1 * t589 * t2308 * t590 + 0.9e1 / 0.2e1 * t588 * t1000 * t1072 + 0.6e1 * t1531 * t1063 - 0.9e1 / 0.2e1 * t224 * t1000 * t1077 - 0.41310769678898833132e-1 * t1089 * t443 * t251 + 0.30227774936482387264e-2 * t426 * t463 * t1191 - 0.15113887468241193633e-2 * t437 * t463 * t1197 + t29 * t2386;
  t2394 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (0.3e1 * t1731 * t425 * t451 + 0.7e1 / 0.4e1 * t1086 * t2203 * t21 - t1046 * t1388 / 0.8e1 + 0.3e1 * t1330 * t1030 * t68 * t1332 * t21 - 0.9e1 / 0.2e1 * t589 * t1030 * t68 * t590 * t21 - 0.3e1 * t1329 * t1030 * t68 * t1345 + 0.9e1 / 0.2e1 * t588 * t1030 * t68 * t1350 - 0.7e1 / 0.4e1 * t1096 * t68 * t1325 + t1052 * t68 * t1378 / 0.8e1 - 0.34059701828023721652e-5 * t170 * t1163 * t27 * t677 + t2276 - 0.15e2 / 0.16e2 * t120 * t2250 * t180 + 0.3e1 / 0.2e1 * t378 * t1000 * t180 - 0.75569437341205968163e-3 * t2284 * t657 - 0.82621539357797666262e-1 * t1070 * t1107 * t590 * t1298 + 0.82621539357797666263e-1 * t1075 * t1353 * t1298 - 0.13770256559632944377e-1 * t2284 * t1298 + 0.82621539357797666263e-1 * t1096 * t2203 * t1285 - 0.41310769678898833132e-1 * t1052 * t468 * t251 + 0.3e1 / 0.4e1 * t1089 * t1081 - 0.6e1 * t715 * t1066 + t2388));
  tv4sigma40 = 0.2e1 * rho[0] * t2394;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t44, t45, t47, t49, t51, t54;
  double t57, t60, t61, t65, t67, t68, t69, t70;
  double t71, t73, t76, t77, t79, t82, t86, t87;
  double t89, t91, t95, t96, t97, t99, t100, t101;
  double t102, t104, t105, t106, t107, t109, t110, t112;
  double t113, t114, t115, t116, t117, t119, t121, t123;
  double t126, t129, t132, t133, t137, t138, t139, t141;
  double t144, t145, t148, t152, t153, t155, t157, t161;
  double tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = sqrt(sigma[0]);
  t29 = POW_1_3(rho[0]);
  t31 = 0.1e1 / t29 / rho[0];
  t32 = t28 * t31;
  t34 = exp(-t32 + 0.19e2);
  t35 = 0.1e1 + t34;
  t36 = 0.1e1 / t35;
  t37 = 0.1e1 - t36;
  t38 = M_CBRT6;
  t39 = M_PI * M_PI;
  t40 = POW_1_3(t39);
  t41 = t40 * t40;
  t42 = 0.1e1 / t41;
  t43 = t38 * t42;
  t44 = rho[0] * rho[0];
  t45 = t29 * t29;
  t47 = 0.1e1 / t45 / t44;
  t49 = t43 * sigma[0] * t47;
  t51 = 0.1227e1 + 0.91464571985215458336e-2 * t49;
  t54 = 0.2227e1 - 0.1505529e1 / t51;
  t57 = exp(-0.25e2 / 0.6e1 * t49);
  t60 = (0.2743e0 - 0.1508e0 * t57) * t38;
  t61 = t42 * sigma[0];
  t65 = t38 * t38;
  t67 = 0.1e1 / t40 / t39;
  t68 = t65 * t67;
  t69 = sigma[0] * sigma[0];
  t70 = t44 * t44;
  t71 = t70 * rho[0];
  t73 = 0.1e1 / t29 / t71;
  t76 = 0.69444444444444444444e-5 * t68 * t69 * t73;
  t77 = t60 * t61 * t47 / 0.24e2 - t76;
  t79 = t65 / t40;
  t82 = log(0.64963333333333333333e0 * t79 * t32 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t32) + 0.1e1));
  t86 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t32 * t82 + t76;
  t87 = 0.1e1 / t86;
  t89 = t77 * t87 + 0.1e1;
  t91 = t36 * t89 + t37 * t54;
  t95 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t91);
  t96 = rho[1] <= p->dens_threshold;
  t97 = -t16;
  t99 = my_piecewise5(t14, t11, t10, t15, t97 * t7);
  t100 = 0.1e1 + t99;
  t101 = t100 <= p->zeta_threshold;
  t102 = POW_1_3(t100);
  t104 = my_piecewise3(t101, t22, t102 * t100);
  t105 = t104 * t26;
  t106 = sqrt(sigma[2]);
  t107 = POW_1_3(rho[1]);
  t109 = 0.1e1 / t107 / rho[1];
  t110 = t106 * t109;
  t112 = exp(-t110 + 0.19e2);
  t113 = 0.1e1 + t112;
  t114 = 0.1e1 / t113;
  t115 = 0.1e1 - t114;
  t116 = rho[1] * rho[1];
  t117 = t107 * t107;
  t119 = 0.1e1 / t117 / t116;
  t121 = t43 * sigma[2] * t119;
  t123 = 0.1227e1 + 0.91464571985215458336e-2 * t121;
  t126 = 0.2227e1 - 0.1505529e1 / t123;
  t129 = exp(-0.25e2 / 0.6e1 * t121);
  t132 = (0.2743e0 - 0.1508e0 * t129) * t38;
  t133 = t42 * sigma[2];
  t137 = sigma[2] * sigma[2];
  t138 = t116 * t116;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t107 / t139;
  t144 = 0.69444444444444444444e-5 * t68 * t137 * t141;
  t145 = t132 * t133 * t119 / 0.24e2 - t144;
  t148 = log(0.64963333333333333333e0 * t79 * t110 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t110) + 0.1e1));
  t152 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t110 * t148 + t144;
  t153 = 0.1e1 / t152;
  t155 = t145 * t153 + 0.1e1;
  t157 = t114 * t155 + t115 * t126;
  t161 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t157);
  tzk0 = t95 + t161;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t44, t45, t47, t49, t51, t54;
  double t57, t60, t61, t65, t67, t68, t69, t70;
  double t71, t73, t76, t77, t79, t82, t86, t87;
  double t89, t91, t95, t96, t97, t99, t100, t101;
  double t102, t104, t105, t106, t107, t109, t110, t112;
  double t113, t114, t115, t116, t117, t119, t121, t123;
  double t126, t129, t132, t133, t137, t138, t139, t141;
  double t144, t145, t148, t152, t153, t155, t157, t161;
  double tzk0;

  double t162, t163, t164, t166, t169, t170, t174, t175;
  double t176, t179, t180, t181, t182, t184, t186, t189;
  double t190, t191, t192, t193, t195, t196, t199, t200;
  double t201, t204, t206, t207, t214, t215, t217, t218;
  double t219, t225, t226, t227, t231, t233, t235, t240;
  double t241, t243, t246, t247, t251, t254, t256, tvrho0;
  double t260, t263, t264, t269, t271, t274, t275, t279;
  double t280, t281, t283, t285, t288, t289, t290, t291;
  double t292, t294, t295, t298, t299, t300, t303, t305;
  double t306, t313, t314, t316, t317, t318, t324, t325;
  double t326, t330, t332, t334, t339, tvrho1, t342, t343;
  double t345, t351, t352, t355, t364, t365, t373, t375;
  double t377, t381, tvsigma0, tvsigma1, t382, t383, t385, t391;
  double t392, t395, t404, t405, t413, t415, t417, t421;
  double tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = sqrt(sigma[0]);
  t29 = POW_1_3(rho[0]);
  t31 = 0.1e1 / t29 / rho[0];
  t32 = t28 * t31;
  t34 = exp(-t32 + 0.19e2);
  t35 = 0.1e1 + t34;
  t36 = 0.1e1 / t35;
  t37 = 0.1e1 - t36;
  t38 = M_CBRT6;
  t39 = M_PI * M_PI;
  t40 = POW_1_3(t39);
  t41 = t40 * t40;
  t42 = 0.1e1 / t41;
  t43 = t38 * t42;
  t44 = rho[0] * rho[0];
  t45 = t29 * t29;
  t47 = 0.1e1 / t45 / t44;
  t49 = t43 * sigma[0] * t47;
  t51 = 0.1227e1 + 0.91464571985215458336e-2 * t49;
  t54 = 0.2227e1 - 0.1505529e1 / t51;
  t57 = exp(-0.25e2 / 0.6e1 * t49);
  t60 = (0.2743e0 - 0.1508e0 * t57) * t38;
  t61 = t42 * sigma[0];
  t65 = t38 * t38;
  t67 = 0.1e1 / t40 / t39;
  t68 = t65 * t67;
  t69 = sigma[0] * sigma[0];
  t70 = t44 * t44;
  t71 = t70 * rho[0];
  t73 = 0.1e1 / t29 / t71;
  t76 = 0.69444444444444444444e-5 * t68 * t69 * t73;
  t77 = t60 * t61 * t47 / 0.24e2 - t76;
  t79 = t65 / t40;
  t82 = log(0.64963333333333333333e0 * t79 * t32 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t32) + 0.1e1));
  t86 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t32 * t82 + t76;
  t87 = 0.1e1 / t86;
  t89 = t77 * t87 + 0.1e1;
  t91 = t36 * t89 + t37 * t54;
  t95 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t91);
  t96 = rho[1] <= p->dens_threshold;
  t97 = -t16;
  t99 = my_piecewise5(t14, t11, t10, t15, t97 * t7);
  t100 = 0.1e1 + t99;
  t101 = t100 <= p->zeta_threshold;
  t102 = POW_1_3(t100);
  t104 = my_piecewise3(t101, t22, t102 * t100);
  t105 = t104 * t26;
  t106 = sqrt(sigma[2]);
  t107 = POW_1_3(rho[1]);
  t109 = 0.1e1 / t107 / rho[1];
  t110 = t106 * t109;
  t112 = exp(-t110 + 0.19e2);
  t113 = 0.1e1 + t112;
  t114 = 0.1e1 / t113;
  t115 = 0.1e1 - t114;
  t116 = rho[1] * rho[1];
  t117 = t107 * t107;
  t119 = 0.1e1 / t117 / t116;
  t121 = t43 * sigma[2] * t119;
  t123 = 0.1227e1 + 0.91464571985215458336e-2 * t121;
  t126 = 0.2227e1 - 0.1505529e1 / t123;
  t129 = exp(-0.25e2 / 0.6e1 * t121);
  t132 = (0.2743e0 - 0.1508e0 * t129) * t38;
  t133 = t42 * sigma[2];
  t137 = sigma[2] * sigma[2];
  t138 = t116 * t116;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t107 / t139;
  t144 = 0.69444444444444444444e-5 * t68 * t137 * t141;
  t145 = t132 * t133 * t119 / 0.24e2 - t144;
  t148 = log(0.64963333333333333333e0 * t79 * t110 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t110) + 0.1e1));
  t152 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t110 * t148 + t144;
  t153 = 0.1e1 / t152;
  t155 = t145 * t153 + 0.1e1;
  t157 = t114 * t155 + t115 * t126;
  t161 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t157);
  tzk0 = t95 + t161;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t162 = t6 * t6;
  t163 = 0.1e1 / t162;
  t164 = t16 * t163;
  t166 = my_piecewise5(t10, 0, t14, 0, t7 - t164);
  t169 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t166);
  t170 = t169 * t26;
  t174 = t26 * t26;
  t175 = 0.1e1 / t174;
  t176 = t25 * t175;
  t179 = t5 * t176 * t91 / 0.8e1;
  t180 = t35 * t35;
  t181 = 0.1e1 / t180;
  t182 = t181 * t28;
  t184 = 0.1e1 / t29 / t44;
  t186 = t184 * t34 * t54;
  t189 = t51 * t51;
  t190 = 0.1e1 / t189;
  t191 = t37 * t190;
  t192 = t191 * t38;
  t193 = t44 * rho[0];
  t195 = 0.1e1 / t45 / t193;
  t196 = t61 * t195;
  t199 = t181 * t89;
  t200 = t28 * t184;
  t201 = t200 * t34;
  t204 = t70 * t44;
  t206 = 0.1e1 / t29 / t204;
  t207 = t69 * t206;
  t214 = 0.37037037037037037037e-4 * t68 * t207;
  t215 = -0.69814814814814814817e-1 * t68 * t207 * t57 - t60 * t196 / 0.9e1 + t214;
  t217 = t86 * t86;
  t218 = 0.1e1 / t217;
  t219 = t77 * t218;
  t225 = 0.25321408066666666666e1 * t49 + 0.1e1;
  t226 = sqrt(t225);
  t227 = 0.1e1 / t226;
  t231 = -0.21827777777777777777e-1 * t79 * t200 * t82 - 0.85080312222222222219e-1 * t43 * sigma[0] * t195 * t227 - t214;
  t233 = t215 * t87 - t219 * t231;
  t235 = 0.4e1 / 0.3e1 * t182 * t186 - 0.36720684159021185007e-1 * t192 * t196 - 0.4e1 / 0.3e1 * t199 * t201 + t36 * t233;
  t240 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t91 - t179 - 0.3e1 / 0.8e1 * t5 * t27 * t235);
  t241 = t97 * t163;
  t243 = my_piecewise5(t14, 0, t10, 0, -t7 - t241);
  t246 = my_piecewise3(t101, 0, 0.4e1 / 0.3e1 * t102 * t243);
  t247 = t246 * t26;
  t251 = t104 * t175;
  t254 = t5 * t251 * t157 / 0.8e1;
  t256 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t157 - t254);
  tvrho0 = t95 + t161 + t6 * (t240 + t256);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t260 = my_piecewise5(t10, 0, t14, 0, -t7 - t164);
  t263 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t260);
  t264 = t263 * t26;
  t269 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t91 - t179);
  t271 = my_piecewise5(t14, 0, t10, 0, t7 - t241);
  t274 = my_piecewise3(t101, 0, 0.4e1 / 0.3e1 * t102 * t271);
  t275 = t274 * t26;
  t279 = t113 * t113;
  t280 = 0.1e1 / t279;
  t281 = t280 * t106;
  t283 = 0.1e1 / t107 / t116;
  t285 = t283 * t112 * t126;
  t288 = t123 * t123;
  t289 = 0.1e1 / t288;
  t290 = t115 * t289;
  t291 = t290 * t38;
  t292 = t116 * rho[1];
  t294 = 0.1e1 / t117 / t292;
  t295 = t133 * t294;
  t298 = t280 * t155;
  t299 = t106 * t283;
  t300 = t299 * t112;
  t303 = t138 * t116;
  t305 = 0.1e1 / t107 / t303;
  t306 = t137 * t305;
  t313 = 0.37037037037037037037e-4 * t68 * t306;
  t314 = -0.69814814814814814817e-1 * t68 * t306 * t129 - t132 * t295 / 0.9e1 + t313;
  t316 = t152 * t152;
  t317 = 0.1e1 / t316;
  t318 = t145 * t317;
  t324 = 0.25321408066666666666e1 * t121 + 0.1e1;
  t325 = sqrt(t324);
  t326 = 0.1e1 / t325;
  t330 = -0.21827777777777777777e-1 * t79 * t299 * t148 - 0.85080312222222222219e-1 * t43 * sigma[2] * t294 * t326 - t313;
  t332 = t314 * t153 - t318 * t330;
  t334 = 0.4e1 / 0.3e1 * t281 * t285 - 0.36720684159021185007e-1 * t291 * t295 - 0.4e1 / 0.3e1 * t298 * t300 + t114 * t332;
  t339 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t157 - t254 - 0.3e1 / 0.8e1 * t5 * t105 * t334);
  tvrho1 = t95 + t161 + t6 * (t269 + t339);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t342 = 0.1e1 / t28;
  t343 = t181 * t342;
  t345 = t31 * t34 * t54;
  t351 = t342 * t31;
  t352 = t351 * t34;
  t355 = t73 * t57;
  t364 = 0.13888888888888888889e-4 * t68 * sigma[0] * t73;
  t365 = 0.26180555555555555555e-1 * t68 * t355 * sigma[0] + t60 * t42 * t47 / 0.24e2 - t364;
  t373 = 0.81854166666666666665e-2 * t79 * t351 * t82 + 0.31905117083333333333e-1 * t43 * t47 * t227 + t364;
  t375 = -t219 * t373 + t365 * t87;
  t377 = -t343 * t345 / 0.2e1 + 0.13770256559632944377e-1 * t191 * t43 * t47 + t199 * t352 / 0.2e1 + t36 * t375;
  t381 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t377);
  tvsigma0 = t6 * t381;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t382 = 0.1e1 / t106;
  t383 = t280 * t382;
  t385 = t109 * t112 * t126;
  t391 = t382 * t109;
  t392 = t391 * t112;
  t395 = t141 * t129;
  t404 = 0.13888888888888888889e-4 * t68 * sigma[2] * t141;
  t405 = 0.26180555555555555555e-1 * t68 * t395 * sigma[2] + t132 * t42 * t119 / 0.24e2 - t404;
  t413 = 0.81854166666666666665e-2 * t79 * t391 * t148 + 0.31905117083333333333e-1 * t43 * t119 * t326 + t404;
  t415 = t405 * t153 - t318 * t413;
  t417 = -t383 * t385 / 0.2e1 + 0.13770256559632944377e-1 * t290 * t43 * t119 + t298 * t392 / 0.2e1 + t114 * t415;
  t421 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t417);
  tvsigma2 = t6 * t421;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t44, t45, t47, t49, t51, t54;
  double t57, t60, t61, t65, t67, t68, t69, t70;
  double t71, t73, t76, t77, t79, t82, t86, t87;
  double t89, t91, t95, t96, t97, t99, t100, t101;
  double t102, t104, t105, t106, t107, t109, t110, t112;
  double t113, t114, t115, t116, t117, t119, t121, t123;
  double t126, t129, t132, t133, t137, t138, t139, t141;
  double t144, t145, t148, t152, t153, t155, t157, t161;
  double tzk0;

  double t162, t163, t164, t166, t169, t170, t174, t175;
  double t176, t179, t180, t181, t182, t184, t186, t189;
  double t190, t191, t192, t193, t195, t196, t199, t200;
  double t201, t204, t206, t207, t214, t215, t217, t218;
  double t219, t225, t226, t227, t231, t233, t235, t240;
  double t241, t243, t246, t247, t251, t254, t256, tvrho0;
  double t260, t263, t264, t269, t271, t274, t275, t279;
  double t280, t281, t283, t285, t288, t289, t290, t291;
  double t292, t294, t295, t298, t299, t300, t303, t305;
  double t306, t313, t314, t316, t317, t318, t324, t325;
  double t326, t330, t332, t334, t339, tvrho1, t342, t343;
  double t345, t351, t352, t355, t364, t365, t373, t375;
  double t377, t381, tvsigma0, tvsigma1, t382, t383, t385, t391;
  double t392, t395, t404, t405, t413, t415, t417, t421;
  double tvsigma2;

  double t424, t425, t426, t429, t430, t431, t434, t438;
  double t439, t443, t445, t451, t452, t455, t457, t460;
  double t461, t463, t464, t465, t466, t470, t472, t475;
  double t476, t477, t480, t481, t482, t485, t489, t490;
  double t491, t492, t493, t495, t499, t502, t503, t504;
  double t507, t510, t511, t514, t517, t521, t522, t523;
  double t524, t525, t526, t527, t534, t535, t537, t541;
  double t542, t543, t553, t557, t559, t561, t566, t567;
  double t568, t569, t572, t575, t579, t580, t584, t586;
  double t588, t591, t593, tv2rho20, t596, t600, t604, t605;
  double t609, t611, t619, t620, t624, t628, t629, t633;
  double t635, t642, t645, tv2rho21, t650, t655, t659, t660;
  double t666, t667, t672, t676, t677, t687, t688, t690;
  double t691, t692, t693, t697, t699, t702, t703, t704;
  double t707, t708, t709, t712, t716, t717, t718, t719;
  double t720, t722, t726, t729, t730, t731, t734, t737;
  double t738, t741, t744, t748, t749, t750, t751, t752;
  double t759, t760, t762, t766, t767, t768, t778, t782;
  double t784, t786, t791, tv2rho22, t799, t801, t807, t810;
  double t821, t826, t827, t830, t833, t836, t840, t841;
  double t842, t843, t851, t852, t854, t857, t866, t870;
  double t872, t874, t879, tv2rhosigma0, tv2rhosigma1, t886, t888, tv2rhosigma2;
  double t894, tv2rhosigma3, tv2rhosigma4, t900, t906, t909, t920, t925;
  double t926, t929, t932, t935, t939, t940, t941, t942;
  double t950, t951, t953, t956, t965, t969, t971, t973;
  double t978, tv2rhosigma5, t980, t981, t983, t986, t987, t990;
  double t992, t995, t999, t1002, t1003, t1007, t1008, t1011;
  double t1014, t1015, t1016, t1021, t1022, t1026, t1038, t1040;
  double t1042, t1046, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1047;
  double t1048, t1050, t1053, t1054, t1057, t1059, t1062, t1066;
  double t1069, t1070, t1074, t1075, t1078, t1081, t1082, t1083;
  double t1088, t1089, t1093, t1105, t1107, t1109, t1113, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = sqrt(sigma[0]);
  t29 = POW_1_3(rho[0]);
  t31 = 0.1e1 / t29 / rho[0];
  t32 = t28 * t31;
  t34 = exp(-t32 + 0.19e2);
  t35 = 0.1e1 + t34;
  t36 = 0.1e1 / t35;
  t37 = 0.1e1 - t36;
  t38 = M_CBRT6;
  t39 = M_PI * M_PI;
  t40 = POW_1_3(t39);
  t41 = t40 * t40;
  t42 = 0.1e1 / t41;
  t43 = t38 * t42;
  t44 = rho[0] * rho[0];
  t45 = t29 * t29;
  t47 = 0.1e1 / t45 / t44;
  t49 = t43 * sigma[0] * t47;
  t51 = 0.1227e1 + 0.91464571985215458336e-2 * t49;
  t54 = 0.2227e1 - 0.1505529e1 / t51;
  t57 = exp(-0.25e2 / 0.6e1 * t49);
  t60 = (0.2743e0 - 0.1508e0 * t57) * t38;
  t61 = t42 * sigma[0];
  t65 = t38 * t38;
  t67 = 0.1e1 / t40 / t39;
  t68 = t65 * t67;
  t69 = sigma[0] * sigma[0];
  t70 = t44 * t44;
  t71 = t70 * rho[0];
  t73 = 0.1e1 / t29 / t71;
  t76 = 0.69444444444444444444e-5 * t68 * t69 * t73;
  t77 = t60 * t61 * t47 / 0.24e2 - t76;
  t79 = t65 / t40;
  t82 = log(0.64963333333333333333e0 * t79 * t32 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t32) + 0.1e1));
  t86 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t32 * t82 + t76;
  t87 = 0.1e1 / t86;
  t89 = t77 * t87 + 0.1e1;
  t91 = t36 * t89 + t37 * t54;
  t95 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t91);
  t96 = rho[1] <= p->dens_threshold;
  t97 = -t16;
  t99 = my_piecewise5(t14, t11, t10, t15, t97 * t7);
  t100 = 0.1e1 + t99;
  t101 = t100 <= p->zeta_threshold;
  t102 = POW_1_3(t100);
  t104 = my_piecewise3(t101, t22, t102 * t100);
  t105 = t104 * t26;
  t106 = sqrt(sigma[2]);
  t107 = POW_1_3(rho[1]);
  t109 = 0.1e1 / t107 / rho[1];
  t110 = t106 * t109;
  t112 = exp(-t110 + 0.19e2);
  t113 = 0.1e1 + t112;
  t114 = 0.1e1 / t113;
  t115 = 0.1e1 - t114;
  t116 = rho[1] * rho[1];
  t117 = t107 * t107;
  t119 = 0.1e1 / t117 / t116;
  t121 = t43 * sigma[2] * t119;
  t123 = 0.1227e1 + 0.91464571985215458336e-2 * t121;
  t126 = 0.2227e1 - 0.1505529e1 / t123;
  t129 = exp(-0.25e2 / 0.6e1 * t121);
  t132 = (0.2743e0 - 0.1508e0 * t129) * t38;
  t133 = t42 * sigma[2];
  t137 = sigma[2] * sigma[2];
  t138 = t116 * t116;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t107 / t139;
  t144 = 0.69444444444444444444e-5 * t68 * t137 * t141;
  t145 = t132 * t133 * t119 / 0.24e2 - t144;
  t148 = log(0.64963333333333333333e0 * t79 * t110 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t110) + 0.1e1));
  t152 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t110 * t148 + t144;
  t153 = 0.1e1 / t152;
  t155 = t145 * t153 + 0.1e1;
  t157 = t114 * t155 + t115 * t126;
  t161 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t157);
  tzk0 = t95 + t161;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t162 = t6 * t6;
  t163 = 0.1e1 / t162;
  t164 = t16 * t163;
  t166 = my_piecewise5(t10, 0, t14, 0, t7 - t164);
  t169 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t166);
  t170 = t169 * t26;
  t174 = t26 * t26;
  t175 = 0.1e1 / t174;
  t176 = t25 * t175;
  t179 = t5 * t176 * t91 / 0.8e1;
  t180 = t35 * t35;
  t181 = 0.1e1 / t180;
  t182 = t181 * t28;
  t184 = 0.1e1 / t29 / t44;
  t186 = t184 * t34 * t54;
  t189 = t51 * t51;
  t190 = 0.1e1 / t189;
  t191 = t37 * t190;
  t192 = t191 * t38;
  t193 = t44 * rho[0];
  t195 = 0.1e1 / t45 / t193;
  t196 = t61 * t195;
  t199 = t181 * t89;
  t200 = t28 * t184;
  t201 = t200 * t34;
  t204 = t70 * t44;
  t206 = 0.1e1 / t29 / t204;
  t207 = t69 * t206;
  t214 = 0.37037037037037037037e-4 * t68 * t207;
  t215 = -0.69814814814814814817e-1 * t68 * t207 * t57 - t60 * t196 / 0.9e1 + t214;
  t217 = t86 * t86;
  t218 = 0.1e1 / t217;
  t219 = t77 * t218;
  t225 = 0.25321408066666666666e1 * t49 + 0.1e1;
  t226 = sqrt(t225);
  t227 = 0.1e1 / t226;
  t231 = -0.21827777777777777777e-1 * t79 * t200 * t82 - 0.85080312222222222219e-1 * t43 * sigma[0] * t195 * t227 - t214;
  t233 = t215 * t87 - t219 * t231;
  t235 = 0.4e1 / 0.3e1 * t182 * t186 - 0.36720684159021185007e-1 * t192 * t196 - 0.4e1 / 0.3e1 * t199 * t201 + t36 * t233;
  t240 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t91 - t179 - 0.3e1 / 0.8e1 * t5 * t27 * t235);
  t241 = t97 * t163;
  t243 = my_piecewise5(t14, 0, t10, 0, -t7 - t241);
  t246 = my_piecewise3(t101, 0, 0.4e1 / 0.3e1 * t102 * t243);
  t247 = t246 * t26;
  t251 = t104 * t175;
  t254 = t5 * t251 * t157 / 0.8e1;
  t256 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t157 - t254);
  tvrho0 = t95 + t161 + t6 * (t240 + t256);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t260 = my_piecewise5(t10, 0, t14, 0, -t7 - t164);
  t263 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t260);
  t264 = t263 * t26;
  t269 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t91 - t179);
  t271 = my_piecewise5(t14, 0, t10, 0, t7 - t241);
  t274 = my_piecewise3(t101, 0, 0.4e1 / 0.3e1 * t102 * t271);
  t275 = t274 * t26;
  t279 = t113 * t113;
  t280 = 0.1e1 / t279;
  t281 = t280 * t106;
  t283 = 0.1e1 / t107 / t116;
  t285 = t283 * t112 * t126;
  t288 = t123 * t123;
  t289 = 0.1e1 / t288;
  t290 = t115 * t289;
  t291 = t290 * t38;
  t292 = t116 * rho[1];
  t294 = 0.1e1 / t117 / t292;
  t295 = t133 * t294;
  t298 = t280 * t155;
  t299 = t106 * t283;
  t300 = t299 * t112;
  t303 = t138 * t116;
  t305 = 0.1e1 / t107 / t303;
  t306 = t137 * t305;
  t313 = 0.37037037037037037037e-4 * t68 * t306;
  t314 = -0.69814814814814814817e-1 * t68 * t306 * t129 - t132 * t295 / 0.9e1 + t313;
  t316 = t152 * t152;
  t317 = 0.1e1 / t316;
  t318 = t145 * t317;
  t324 = 0.25321408066666666666e1 * t121 + 0.1e1;
  t325 = sqrt(t324);
  t326 = 0.1e1 / t325;
  t330 = -0.21827777777777777777e-1 * t79 * t299 * t148 - 0.85080312222222222219e-1 * t43 * sigma[2] * t294 * t326 - t313;
  t332 = t314 * t153 - t318 * t330;
  t334 = 0.4e1 / 0.3e1 * t281 * t285 - 0.36720684159021185007e-1 * t291 * t295 - 0.4e1 / 0.3e1 * t298 * t300 + t114 * t332;
  t339 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t157 - t254 - 0.3e1 / 0.8e1 * t5 * t105 * t334);
  tvrho1 = t95 + t161 + t6 * (t269 + t339);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t342 = 0.1e1 / t28;
  t343 = t181 * t342;
  t345 = t31 * t34 * t54;
  t351 = t342 * t31;
  t352 = t351 * t34;
  t355 = t73 * t57;
  t364 = 0.13888888888888888889e-4 * t68 * sigma[0] * t73;
  t365 = 0.26180555555555555555e-1 * t68 * t355 * sigma[0] + t60 * t42 * t47 / 0.24e2 - t364;
  t373 = 0.81854166666666666665e-2 * t79 * t351 * t82 + 0.31905117083333333333e-1 * t43 * t47 * t227 + t364;
  t375 = -t219 * t373 + t365 * t87;
  t377 = -t343 * t345 / 0.2e1 + 0.13770256559632944377e-1 * t191 * t43 * t47 + t199 * t352 / 0.2e1 + t36 * t375;
  t381 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t377);
  tvsigma0 = t6 * t381;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t382 = 0.1e1 / t106;
  t383 = t280 * t382;
  t385 = t109 * t112 * t126;
  t391 = t382 * t109;
  t392 = t391 * t112;
  t395 = t141 * t129;
  t404 = 0.13888888888888888889e-4 * t68 * sigma[2] * t141;
  t405 = 0.26180555555555555555e-1 * t68 * t395 * sigma[2] + t132 * t42 * t119 / 0.24e2 - t404;
  t413 = 0.81854166666666666665e-2 * t79 * t391 * t148 + 0.31905117083333333333e-1 * t43 * t119 * t326 + t404;
  t415 = t405 * t153 - t318 * t413;
  t417 = -t383 * t385 / 0.2e1 + 0.13770256559632944377e-1 * t290 * t43 * t119 + t298 * t392 / 0.2e1 + t114 * t415;
  t421 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t417);
  tvsigma2 = t6 * t421;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t424 = t23 * t23;
  t425 = 0.1e1 / t424;
  t426 = t166 * t166;
  t429 = t162 * t6;
  t430 = 0.1e1 / t429;
  t431 = t16 * t430;
  t434 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t163 + 0.2e1 * t431);
  t438 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t425 * t426 + 0.4e1 / 0.3e1 * t23 * t434);
  t439 = t438 * t26;
  t443 = t169 * t175;
  t445 = t5 * t443 * t91;
  t451 = 0.1e1 / t174 / t6;
  t452 = t25 * t451;
  t455 = t5 * t452 * t91 / 0.12e2;
  t457 = t5 * t176 * t235;
  t460 = 0.1e1 / t180 / t35;
  t461 = t460 * sigma[0];
  t463 = 0.1e1 / t45 / t70;
  t464 = t34 * t34;
  t465 = t463 * t464;
  t466 = t465 * t54;
  t470 = 0.1e1 / t29 / t193;
  t472 = t470 * t34 * t54;
  t475 = t181 * sigma[0];
  t476 = t463 * t34;
  t477 = t476 * t54;
  t480 = t28 * sigma[0];
  t481 = t181 * t480;
  t482 = 0.1e1 / t204;
  t485 = t34 * t190 * t43;
  t489 = 0.1e1 / t189 / t51;
  t490 = t37 * t489;
  t491 = t490 * t65;
  t492 = t67 * t69;
  t493 = t70 * t193;
  t495 = 0.1e1 / t29 / t493;
  t499 = t61 * t463;
  t502 = t460 * t89;
  t503 = sigma[0] * t463;
  t504 = t503 * t464;
  t507 = t181 * t233;
  t510 = t28 * t470;
  t511 = t510 * t34;
  t514 = t503 * t34;
  t517 = t69 * t495;
  t521 = t39 * t39;
  t522 = 0.1e1 / t521;
  t523 = t69 * sigma[0];
  t524 = t522 * t523;
  t525 = t70 * t70;
  t526 = t525 * t44;
  t527 = 0.1e1 / t526;
  t534 = 0.23456790123456790123e-3 * t68 * t517;
  t535 = 0.62833333333333333335e0 * t68 * t517 * t57 - 0.46543209876543209878e1 * t524 * t527 * t57 + 0.11e2 / 0.27e2 * t60 * t499 - t534;
  t537 = t215 * t218;
  t541 = 0.1e1 / t217 / t86;
  t542 = t77 * t541;
  t543 = t231 * t231;
  t553 = 0.1e1 / t226 / t225;
  t557 = 0.5093148148148148148e-1 * t79 * t510 * t82 + 0.42540156111111111109e0 * t43 * t503 * t227 - 0.2872471072291061827e0 * t68 * t517 * t553 + t534;
  t559 = -t219 * t557 - 0.2e1 * t537 * t231 + t535 * t87 + 0.2e1 * t542 * t543;
  t561 = -0.32e2 / 0.9e1 * t461 * t466 - 0.28e2 / 0.9e1 * t182 * t472 + 0.16e2 / 0.9e1 * t475 * t477 - 0.97921824424056493352e-1 * t481 * t482 * t485 - 0.17912755517915488751e-2 * t491 * t492 * t495 + 0.13464250858307767836e0 * t192 * t499 + 0.32e2 / 0.9e1 * t502 * t504 - 0.8e1 / 0.3e1 * t507 * t201 + 0.28e2 / 0.9e1 * t199 * t511 - 0.16e2 / 0.9e1 * t199 * t514 + t36 * t559;
  t566 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t439 * t91 - t445 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t170 * t235 + t455 - t457 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t561);
  t567 = t102 * t102;
  t568 = 0.1e1 / t567;
  t569 = t243 * t243;
  t572 = t97 * t430;
  t575 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t163 + 0.2e1 * t572);
  t579 = my_piecewise3(t101, 0, 0.4e1 / 0.9e1 * t568 * t569 + 0.4e1 / 0.3e1 * t102 * t575);
  t580 = t579 * t26;
  t584 = t246 * t175;
  t586 = t5 * t584 * t157;
  t588 = t104 * t451;
  t591 = t5 * t588 * t157 / 0.12e2;
  t593 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t580 * t157 - t586 / 0.4e1 + t591);
  tv2rho20 = 0.2e1 * t240 + 0.2e1 * t256 + t6 * (t566 + t593);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t596 = t425 * t260;
  t600 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t431);
  t604 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t596 * t166 + 0.4e1 / 0.3e1 * t23 * t600);
  t605 = t604 * t26;
  t609 = t263 * t175;
  t611 = t5 * t609 * t91;
  t619 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t91 - t611 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t264 * t235 - t445 / 0.8e1 + t455 - t457 / 0.8e1);
  t620 = t568 * t271;
  t624 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t572);
  t628 = my_piecewise3(t101, 0, 0.4e1 / 0.9e1 * t620 * t243 + 0.4e1 / 0.3e1 * t102 * t624);
  t629 = t628 * t26;
  t633 = t274 * t175;
  t635 = t5 * t633 * t157;
  t642 = t5 * t251 * t334;
  t645 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t629 * t157 - t635 / 0.8e1 - t586 / 0.8e1 + t591 - 0.3e1 / 0.8e1 * t5 * t247 * t334 - t642 / 0.8e1);
  tv2rho21 = t240 + t256 + t269 + t339 + t6 * (t619 + t645);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t650 = t260 * t260;
  t655 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t163 + 0.2e1 * t431);
  t659 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t425 * t650 + 0.4e1 / 0.3e1 * t23 * t655);
  t660 = t659 * t26;
  t666 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t660 * t91 - t611 / 0.4e1 + t455);
  t667 = t271 * t271;
  t672 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t163 + 0.2e1 * t572);
  t676 = my_piecewise3(t101, 0, 0.4e1 / 0.9e1 * t568 * t667 + 0.4e1 / 0.3e1 * t102 * t672);
  t677 = t676 * t26;
  t687 = 0.1e1 / t279 / t113;
  t688 = t687 * sigma[2];
  t690 = 0.1e1 / t117 / t138;
  t691 = t112 * t112;
  t692 = t690 * t691;
  t693 = t692 * t126;
  t697 = 0.1e1 / t107 / t292;
  t699 = t697 * t112 * t126;
  t702 = t280 * sigma[2];
  t703 = t690 * t112;
  t704 = t703 * t126;
  t707 = t106 * sigma[2];
  t708 = t280 * t707;
  t709 = 0.1e1 / t303;
  t712 = t112 * t289 * t43;
  t716 = 0.1e1 / t288 / t123;
  t717 = t115 * t716;
  t718 = t717 * t65;
  t719 = t67 * t137;
  t720 = t138 * t292;
  t722 = 0.1e1 / t107 / t720;
  t726 = t133 * t690;
  t729 = t687 * t155;
  t730 = sigma[2] * t690;
  t731 = t730 * t691;
  t734 = t280 * t332;
  t737 = t106 * t697;
  t738 = t737 * t112;
  t741 = t730 * t112;
  t744 = t137 * t722;
  t748 = t137 * sigma[2];
  t749 = t522 * t748;
  t750 = t138 * t138;
  t751 = t750 * t116;
  t752 = 0.1e1 / t751;
  t759 = 0.23456790123456790123e-3 * t68 * t744;
  t760 = 0.62833333333333333335e0 * t68 * t744 * t129 - 0.46543209876543209878e1 * t749 * t752 * t129 + 0.11e2 / 0.27e2 * t132 * t726 - t759;
  t762 = t314 * t317;
  t766 = 0.1e1 / t316 / t152;
  t767 = t145 * t766;
  t768 = t330 * t330;
  t778 = 0.1e1 / t325 / t324;
  t782 = 0.5093148148148148148e-1 * t79 * t737 * t148 + 0.42540156111111111109e0 * t43 * t730 * t326 - 0.2872471072291061827e0 * t68 * t744 * t778 + t759;
  t784 = t760 * t153 - t318 * t782 - 0.2e1 * t762 * t330 + 0.2e1 * t767 * t768;
  t786 = -0.32e2 / 0.9e1 * t688 * t693 - 0.28e2 / 0.9e1 * t281 * t699 + 0.16e2 / 0.9e1 * t702 * t704 - 0.97921824424056493352e-1 * t708 * t709 * t712 - 0.17912755517915488751e-2 * t718 * t719 * t722 + 0.13464250858307767836e0 * t291 * t726 + 0.32e2 / 0.9e1 * t729 * t731 - 0.8e1 / 0.3e1 * t734 * t300 + 0.28e2 / 0.9e1 * t298 * t738 - 0.16e2 / 0.9e1 * t298 * t741 + t114 * t784;
  t791 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t677 * t157 - t635 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t275 * t334 + t591 - t642 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t105 * t786);
  tv2rho22 = 0.2e1 * t269 + 0.2e1 * t339 + t6 * (t666 + t791);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t799 = t5 * t176 * t377 / 0.8e1;
  t801 = t464 * t54;
  t807 = t34 * t54;
  t810 = 0.1e1 / t71;
  t821 = t195 * t464;
  t826 = t342 * t184;
  t827 = t826 * t34;
  t830 = t195 * t34;
  t833 = t181 * t375;
  t836 = t206 * t57;
  t840 = t525 * rho[0];
  t841 = 0.1e1 / t840;
  t842 = t522 * t841;
  t843 = t69 * t57;
  t851 = 0.74074074074074074075e-4 * t68 * sigma[0] * t206;
  t852 = -0.20944444444444444445e0 * t68 * t836 * sigma[0] + 0.17453703703703703703e1 * t842 * t843 - t60 * t42 * t195 / 0.9e1 + t851;
  t854 = t365 * t218;
  t857 = t373 * t231;
  t866 = t206 * t553;
  t870 = -0.10913888888888888889e-1 * t79 * t826 * t82 - 0.12762046833333333333e0 * t43 * t195 * t227 + 0.10771766521091481852e0 * t68 * t866 * sigma[0] - t851;
  t872 = -t219 * t870 - t854 * t231 - t537 * t373 + 0.2e1 * t542 * t857 + t852 * t87;
  t874 = 0.4e1 / 0.3e1 * t460 * t195 * t801 + 0.2e1 / 0.3e1 * t343 * t186 - 0.2e1 / 0.3e1 * t181 * t195 * t807 + 0.36720684159021185007e-1 * t182 * t810 * t485 + 0.67172833192183082812e-3 * t491 * t67 * t206 * sigma[0] - 0.36720684159021185005e-1 * t191 * t43 * t195 - 0.4e1 / 0.3e1 * t502 * t821 + t507 * t352 / 0.2e1 - 0.2e1 / 0.3e1 * t199 * t827 + 0.2e1 / 0.3e1 * t199 * t830 - 0.4e1 / 0.3e1 * t833 * t201 + t36 * t872;
  t879 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t377 - t799 - 0.3e1 / 0.8e1 * t5 * t27 * t874);
  tv2rhosigma0 = t6 * t879 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t886 = t5 * t251 * t417 / 0.8e1;
  t888 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t417 - t886);
  tv2rhosigma2 = t6 * t888 + t421;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t894 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t377 - t799);
  tv2rhosigma3 = t6 * t894 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t900 = t691 * t126;
  t906 = t112 * t126;
  t909 = 0.1e1 / t139;
  t920 = t294 * t691;
  t925 = t382 * t283;
  t926 = t925 * t112;
  t929 = t294 * t112;
  t932 = t280 * t415;
  t935 = t305 * t129;
  t939 = t750 * rho[1];
  t940 = 0.1e1 / t939;
  t941 = t522 * t940;
  t942 = t137 * t129;
  t950 = 0.74074074074074074075e-4 * t68 * sigma[2] * t305;
  t951 = -0.20944444444444444445e0 * t68 * t935 * sigma[2] + 0.17453703703703703703e1 * t941 * t942 - t132 * t42 * t294 / 0.9e1 + t950;
  t953 = t405 * t317;
  t956 = t413 * t330;
  t965 = t305 * t778;
  t969 = -0.10913888888888888889e-1 * t79 * t925 * t148 - 0.12762046833333333333e0 * t43 * t294 * t326 + 0.10771766521091481852e0 * t68 * t965 * sigma[2] - t950;
  t971 = t951 * t153 - t318 * t969 - t953 * t330 - t762 * t413 + 0.2e1 * t767 * t956;
  t973 = 0.4e1 / 0.3e1 * t687 * t294 * t900 + 0.2e1 / 0.3e1 * t383 * t285 - 0.2e1 / 0.3e1 * t280 * t294 * t906 + 0.36720684159021185007e-1 * t281 * t909 * t712 + 0.67172833192183082812e-3 * t718 * t67 * t305 * sigma[2] - 0.36720684159021185005e-1 * t290 * t43 * t294 - 0.4e1 / 0.3e1 * t729 * t920 + t734 * t392 / 0.2e1 - 0.2e1 / 0.3e1 * t298 * t926 + 0.2e1 / 0.3e1 * t298 * t929 - 0.4e1 / 0.3e1 * t932 * t300 + t114 * t971;
  t978 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t417 - t886 - 0.3e1 / 0.8e1 * t5 * t105 * t973);
  tv2rhosigma5 = t6 * t978 + t421;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t980 = 0.1e1 / sigma[0];
  t981 = t460 * t980;
  t983 = t47 * t464 * t54;
  t986 = 0.1e1 / t480;
  t987 = t181 * t986;
  t990 = t181 * t980;
  t992 = t47 * t34 * t54;
  t995 = 0.1e1 / t70;
  t999 = t68 * t73;
  t1002 = t980 * t47;
  t1003 = t1002 * t464;
  t1007 = t986 * t31;
  t1008 = t1007 * t34;
  t1011 = t1002 * t34;
  t1014 = 0.1e1 / t525;
  t1015 = t522 * t1014;
  t1016 = t57 * sigma[0];
  t1021 = 0.13888888888888888889e-4 * t999;
  t1022 = -0.65451388888888888888e0 * t1015 * t1016 + 0.5236111111111111111e-1 * t68 * t355 - t1021;
  t1026 = t373 * t373;
  t1038 = -0.40927083333333333332e-2 * t79 * t1007 * t82 + 0.15952558541666666666e-1 * t43 * t1002 * t227 - 0.40394124454093056943e-1 * t68 * t73 * t553 + t1021;
  t1040 = t1022 * t87 + 0.2e1 * t542 * t1026 - t219 * t1038 - 0.2e1 * t854 * t373;
  t1042 = -t981 * t983 / 0.2e1 + t987 * t345 / 0.4e1 + t990 * t992 / 0.4e1 - 0.13770256559632944377e-1 * t343 * t995 * t485 - 0.25189812447068656054e-3 * t490 * t999 + t502 * t1003 / 0.2e1 + t833 * t352 - t199 * t1008 / 0.4e1 - t199 * t1011 / 0.4e1 + t36 * t1040;
  t1046 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1042);
  tv2sigma20 = t6 * t1046;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1047 = 0.1e1 / sigma[2];
  t1048 = t687 * t1047;
  t1050 = t119 * t691 * t126;
  t1053 = 0.1e1 / t707;
  t1054 = t280 * t1053;
  t1057 = t280 * t1047;
  t1059 = t119 * t112 * t126;
  t1062 = 0.1e1 / t138;
  t1066 = t68 * t141;
  t1069 = t1047 * t119;
  t1070 = t1069 * t691;
  t1074 = t1053 * t109;
  t1075 = t1074 * t112;
  t1078 = t1069 * t112;
  t1081 = 0.1e1 / t750;
  t1082 = t522 * t1081;
  t1083 = t129 * sigma[2];
  t1088 = 0.13888888888888888889e-4 * t1066;
  t1089 = -0.65451388888888888888e0 * t1082 * t1083 + 0.5236111111111111111e-1 * t68 * t395 - t1088;
  t1093 = t413 * t413;
  t1105 = -0.40927083333333333332e-2 * t79 * t1074 * t148 + 0.15952558541666666666e-1 * t43 * t1069 * t326 - 0.40394124454093056943e-1 * t68 * t141 * t778 + t1088;
  t1107 = t1089 * t153 + 0.2e1 * t767 * t1093 - t318 * t1105 - 0.2e1 * t953 * t413;
  t1109 = -t1048 * t1050 / 0.2e1 + t1054 * t385 / 0.4e1 + t1057 * t1059 / 0.4e1 - 0.13770256559632944377e-1 * t383 * t1062 * t712 - 0.25189812447068656054e-3 * t717 * t1066 + t729 * t1070 / 0.2e1 + t932 * t392 - t298 * t1075 / 0.4e1 - t298 * t1078 / 0.4e1 + t114 * t1107;
  t1113 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t1109);
  tv2sigma25 = t6 * t1113;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t44, t45, t47, t49, t51, t54;
  double t57, t60, t61, t65, t67, t68, t69, t70;
  double t71, t73, t76, t77, t79, t82, t86, t87;
  double t89, t91, t95, t96, t97, t99, t100, t101;
  double t102, t104, t105, t106, t107, t109, t110, t112;
  double t113, t114, t115, t116, t117, t119, t121, t123;
  double t126, t129, t132, t133, t137, t138, t139, t141;
  double t144, t145, t148, t152, t153, t155, t157, t161;
  double tzk0;

  double t162, t163, t164, t166, t169, t170, t174, t175;
  double t176, t179, t180, t181, t182, t184, t186, t189;
  double t190, t191, t192, t193, t195, t196, t199, t200;
  double t201, t204, t206, t207, t214, t215, t217, t218;
  double t219, t225, t226, t227, t231, t233, t235, t240;
  double t241, t243, t246, t247, t251, t254, t256, tvrho0;
  double t260, t263, t264, t269, t271, t274, t275, t279;
  double t280, t281, t283, t285, t288, t289, t290, t291;
  double t292, t294, t295, t298, t299, t300, t303, t305;
  double t306, t313, t314, t316, t317, t318, t324, t325;
  double t326, t330, t332, t334, t339, tvrho1, t342, t343;
  double t345, t351, t352, t355, t364, t365, t373, t375;
  double t377, t381, tvsigma0, tvsigma1, t382, t383, t385, t391;
  double t392, t395, t404, t405, t413, t415, t417, t421;
  double tvsigma2;

  double t424, t425, t426, t429, t430, t431, t434, t438;
  double t439, t443, t445, t451, t452, t455, t457, t460;
  double t461, t463, t464, t465, t466, t470, t472, t475;
  double t476, t477, t480, t481, t482, t485, t489, t490;
  double t491, t492, t493, t495, t499, t502, t503, t504;
  double t507, t510, t511, t514, t517, t521, t522, t523;
  double t524, t525, t526, t527, t534, t535, t537, t541;
  double t542, t543, t553, t557, t559, t561, t566, t567;
  double t568, t569, t572, t575, t579, t580, t584, t586;
  double t588, t591, t593, tv2rho20, t596, t600, t604, t605;
  double t609, t611, t619, t620, t624, t628, t629, t633;
  double t635, t642, t645, tv2rho21, t650, t655, t659, t660;
  double t666, t667, t672, t676, t677, t687, t688, t690;
  double t691, t692, t693, t697, t699, t702, t703, t704;
  double t707, t708, t709, t712, t716, t717, t718, t719;
  double t720, t722, t726, t729, t730, t731, t734, t737;
  double t738, t741, t744, t748, t749, t750, t751, t752;
  double t759, t760, t762, t766, t767, t768, t778, t782;
  double t784, t786, t791, tv2rho22, t799, t801, t807, t810;
  double t821, t826, t827, t830, t833, t836, t840, t841;
  double t842, t843, t851, t852, t854, t857, t866, t870;
  double t872, t874, t879, tv2rhosigma0, tv2rhosigma1, t886, t888, tv2rhosigma2;
  double t894, tv2rhosigma3, tv2rhosigma4, t900, t906, t909, t920, t925;
  double t926, t929, t932, t935, t939, t940, t941, t942;
  double t950, t951, t953, t956, t965, t969, t971, t973;
  double t978, tv2rhosigma5, t980, t981, t983, t986, t987, t990;
  double t992, t995, t999, t1002, t1003, t1007, t1008, t1011;
  double t1014, t1015, t1016, t1021, t1022, t1026, t1038, t1040;
  double t1042, t1046, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1047;
  double t1048, t1050, t1053, t1054, t1057, t1059, t1062, t1066;
  double t1069, t1070, t1074, t1075, t1078, t1081, t1082, t1083;
  double t1088, t1089, t1093, t1105, t1107, t1109, t1113, tv2sigma25;

  double t1117, t1118, t1121, t1124, t1125, t1126, t1129, t1133;
  double t1134, t1138, t1140, t1145, t1147, t1150, t1156, t1157;
  double t1160, t1162, t1165, t1167, t1168, t1170, t1173, t1177;
  double t1182, t1183, t1188, t1189, t1192, t1193, t1194, t1197;
  double t1200, t1203, t1204, t1205, t1206, t1207, t1211, t1212;
  double t1216, t1224, t1225, t1228, t1229, t1232, t1233, t1234;
  double t1235, t1236, t1237, t1240, t1247, t1248, t1249, t1251;
  double t1253, t1259, t1260, t1262, t1265, t1270, t1271, t1272;
  double t1273, t1276, t1280, t1281, t1291, t1293, t1296, t1298;
  double t1300, t1306, t1309, t1312, t1316, t1319, t1325, t1329;
  double t1330, t1335, t1337, t1338, t1341, t1344, t1347, t1351;
  double t1352, t1356, t1358, t1360, t1362, t1364, t1367, t1369;
  double tv3rho30, t1372, t1373, t1374, t1377, t1382, t1383, t1385;
  double t1389, t1390, t1394, t1397, t1401, t1403, t1407, t1416;
  double t1417, t1418, t1421, t1426, t1428, t1432, t1433, t1437;
  double t1440, t1441, t1443, t1452, t1454, t1457, tv3rho31, t1460;
  double t1465, t1469, t1473, t1474, t1478, t1480, t1489, t1490;
  double t1495, t1499, t1503, t1504, t1508, t1510, t1517, t1525;
  double t1527, t1528, tv3rho32, t1533, t1540, t1544, t1545, t1552;
  double t1553, t1560, t1564, t1565, t1583, t1584, t1585, t1589;
  double t1590, t1591, t1595, t1596, t1600, t1601, t1605, t1606;
  double t1607, t1609, t1611, t1614, t1618, t1619, t1621, t1624;
  double t1629, t1630, t1631, t1632, t1635, t1647, t1648, t1650;
  double t1653, t1655, t1657, t1658, t1659, t1664, t1667, t1668;
  double t1669, t1670, t1671, t1674, t1677, t1680, t1681, t1685;
  double t1686, t1690, t1691, t1699, t1702, t1707, t1715, t1718;
  double t1724, t1728, t1729, t1731, t1734, t1737, t1738, t1739;
  double t1742, t1743, t1748, tv3rho33, t1756, t1763, t1765, t1767;
  double t1768, t1769, t1770, t1776, t1777, t1781, t1806, t1807;
  double t1810, t1819, t1820, t1824, t1829, t1832, t1835, t1836;
  double t1839, t1840, t1846, t1849, t1856, t1860, t1863, t1865;
  double t1866, t1875, t1876, t1878, t1881, t1890, t1893, t1896;
  double t1905, t1909, t1912, t1914, t1916, t1917, t1922, tv3rho2sigma0;
  double tv3rho2sigma1, t1929, t1933, t1935, tv3rho2sigma2, t1941, t1949, tv3rho2sigma3;
  double tv3rho2sigma4, t1955, t1962, t1965, tv3rho2sigma5, t1973, tv3rho2sigma6, tv3rho2sigma7;
  double t1984, t1985, t1986, t1987, t1993, t1994, t1998, t2004;
  double t2005, t2016, t2017, t2021, t2026, t2031, t2034, t2035;
  double t2036, t2039, t2040, t2043, t2049, t2073, t2077, t2080;
  double t2082, t2083, t2092, t2093, t2095, t2098, t2107, t2110;
  double t2113, t2122, t2126, t2129, t2131, t2133, t2134, t2139;
  double tv3rho2sigma8, t2146, t2151, t2155, t2156, t2159, t2164, t2167;
  double t2172, t2177, t2178, t2181, t2190, t2193, t2194, t2200;
  double t2205, t2210, t2211, t2216, t2233, t2235, t2237, t2242;
  double t2243, t2245, t2255, t2258, t2262, t2273, t2276, t2278;
  double t2280, t2281, t2286, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24;
  double t2293, t2295, tv3rhosigma25, t2301, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t2310, t2314, t2315, t2318, t2323, t2326, t2331;
  double t2336, t2345, t2346, t2349, t2352, t2354, t2359, t2364;
  double t2369, t2370, t2382, t2392, t2394, t2396, t2401, t2402;
  double t2404, t2414, t2417, t2421, t2432, t2435, t2437, t2439;
  double t2440, t2445, tv3rhosigma211, t2447, t2448, t2449, t2452, t2453;
  double t2454, t2459, t2462, t2466, t2467, t2470, t2475, t2483;
  double t2486, t2501, t2503, t2505, t2506, t2511, t2516, t2519;
  double t2520, t2525, t2527, t2530, t2532, t2535, t2539, t2543;
  double t2558, t2559, t2563, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34;
  double tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2565, t2566, t2569, t2574;
  double t2582, t2585, t2588, t2589, t2593, t2594, t2604, t2606;
  double t2610, t2613, t2616, t2619, t2624, t2625, t2630, t2635;
  double t2636, t2639, t2644, t2646, t2649, t2651, t2654, t2658;
  double t2671, t2675, t2676, t2680, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = sqrt(sigma[0]);
  t29 = POW_1_3(rho[0]);
  t31 = 0.1e1 / t29 / rho[0];
  t32 = t28 * t31;
  t34 = exp(-t32 + 0.19e2);
  t35 = 0.1e1 + t34;
  t36 = 0.1e1 / t35;
  t37 = 0.1e1 - t36;
  t38 = M_CBRT6;
  t39 = M_PI * M_PI;
  t40 = POW_1_3(t39);
  t41 = t40 * t40;
  t42 = 0.1e1 / t41;
  t43 = t38 * t42;
  t44 = rho[0] * rho[0];
  t45 = t29 * t29;
  t47 = 0.1e1 / t45 / t44;
  t49 = t43 * sigma[0] * t47;
  t51 = 0.1227e1 + 0.91464571985215458336e-2 * t49;
  t54 = 0.2227e1 - 0.1505529e1 / t51;
  t57 = exp(-0.25e2 / 0.6e1 * t49);
  t60 = (0.2743e0 - 0.1508e0 * t57) * t38;
  t61 = t42 * sigma[0];
  t65 = t38 * t38;
  t67 = 0.1e1 / t40 / t39;
  t68 = t65 * t67;
  t69 = sigma[0] * sigma[0];
  t70 = t44 * t44;
  t71 = t70 * rho[0];
  t73 = 0.1e1 / t29 / t71;
  t76 = 0.69444444444444444444e-5 * t68 * t69 * t73;
  t77 = t60 * t61 * t47 / 0.24e2 - t76;
  t79 = t65 / t40;
  t82 = log(0.64963333333333333333e0 * t79 * t32 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t32) + 0.1e1));
  t86 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t32 * t82 + t76;
  t87 = 0.1e1 / t86;
  t89 = t77 * t87 + 0.1e1;
  t91 = t36 * t89 + t37 * t54;
  t95 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t91);
  t96 = rho[1] <= p->dens_threshold;
  t97 = -t16;
  t99 = my_piecewise5(t14, t11, t10, t15, t97 * t7);
  t100 = 0.1e1 + t99;
  t101 = t100 <= p->zeta_threshold;
  t102 = POW_1_3(t100);
  t104 = my_piecewise3(t101, t22, t102 * t100);
  t105 = t104 * t26;
  t106 = sqrt(sigma[2]);
  t107 = POW_1_3(rho[1]);
  t109 = 0.1e1 / t107 / rho[1];
  t110 = t106 * t109;
  t112 = exp(-t110 + 0.19e2);
  t113 = 0.1e1 + t112;
  t114 = 0.1e1 / t113;
  t115 = 0.1e1 - t114;
  t116 = rho[1] * rho[1];
  t117 = t107 * t107;
  t119 = 0.1e1 / t117 / t116;
  t121 = t43 * sigma[2] * t119;
  t123 = 0.1227e1 + 0.91464571985215458336e-2 * t121;
  t126 = 0.2227e1 - 0.1505529e1 / t123;
  t129 = exp(-0.25e2 / 0.6e1 * t121);
  t132 = (0.2743e0 - 0.1508e0 * t129) * t38;
  t133 = t42 * sigma[2];
  t137 = sigma[2] * sigma[2];
  t138 = t116 * t116;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t107 / t139;
  t144 = 0.69444444444444444444e-5 * t68 * t137 * t141;
  t145 = t132 * t133 * t119 / 0.24e2 - t144;
  t148 = log(0.64963333333333333333e0 * t79 * t110 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t110) + 0.1e1));
  t152 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t110 * t148 + t144;
  t153 = 0.1e1 / t152;
  t155 = t145 * t153 + 0.1e1;
  t157 = t114 * t155 + t115 * t126;
  t161 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t157);
  tzk0 = t95 + t161;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t162 = t6 * t6;
  t163 = 0.1e1 / t162;
  t164 = t16 * t163;
  t166 = my_piecewise5(t10, 0, t14, 0, t7 - t164);
  t169 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t166);
  t170 = t169 * t26;
  t174 = t26 * t26;
  t175 = 0.1e1 / t174;
  t176 = t25 * t175;
  t179 = t5 * t176 * t91 / 0.8e1;
  t180 = t35 * t35;
  t181 = 0.1e1 / t180;
  t182 = t181 * t28;
  t184 = 0.1e1 / t29 / t44;
  t186 = t184 * t34 * t54;
  t189 = t51 * t51;
  t190 = 0.1e1 / t189;
  t191 = t37 * t190;
  t192 = t191 * t38;
  t193 = t44 * rho[0];
  t195 = 0.1e1 / t45 / t193;
  t196 = t61 * t195;
  t199 = t181 * t89;
  t200 = t28 * t184;
  t201 = t200 * t34;
  t204 = t70 * t44;
  t206 = 0.1e1 / t29 / t204;
  t207 = t69 * t206;
  t214 = 0.37037037037037037037e-4 * t68 * t207;
  t215 = -0.69814814814814814817e-1 * t68 * t207 * t57 - t60 * t196 / 0.9e1 + t214;
  t217 = t86 * t86;
  t218 = 0.1e1 / t217;
  t219 = t77 * t218;
  t225 = 0.25321408066666666666e1 * t49 + 0.1e1;
  t226 = sqrt(t225);
  t227 = 0.1e1 / t226;
  t231 = -0.21827777777777777777e-1 * t79 * t200 * t82 - 0.85080312222222222219e-1 * t43 * sigma[0] * t195 * t227 - t214;
  t233 = t215 * t87 - t219 * t231;
  t235 = 0.4e1 / 0.3e1 * t182 * t186 - 0.36720684159021185007e-1 * t192 * t196 - 0.4e1 / 0.3e1 * t199 * t201 + t36 * t233;
  t240 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t91 - t179 - 0.3e1 / 0.8e1 * t5 * t27 * t235);
  t241 = t97 * t163;
  t243 = my_piecewise5(t14, 0, t10, 0, -t7 - t241);
  t246 = my_piecewise3(t101, 0, 0.4e1 / 0.3e1 * t102 * t243);
  t247 = t246 * t26;
  t251 = t104 * t175;
  t254 = t5 * t251 * t157 / 0.8e1;
  t256 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t157 - t254);
  tvrho0 = t95 + t161 + t6 * (t240 + t256);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t260 = my_piecewise5(t10, 0, t14, 0, -t7 - t164);
  t263 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t260);
  t264 = t263 * t26;
  t269 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t91 - t179);
  t271 = my_piecewise5(t14, 0, t10, 0, t7 - t241);
  t274 = my_piecewise3(t101, 0, 0.4e1 / 0.3e1 * t102 * t271);
  t275 = t274 * t26;
  t279 = t113 * t113;
  t280 = 0.1e1 / t279;
  t281 = t280 * t106;
  t283 = 0.1e1 / t107 / t116;
  t285 = t283 * t112 * t126;
  t288 = t123 * t123;
  t289 = 0.1e1 / t288;
  t290 = t115 * t289;
  t291 = t290 * t38;
  t292 = t116 * rho[1];
  t294 = 0.1e1 / t117 / t292;
  t295 = t133 * t294;
  t298 = t280 * t155;
  t299 = t106 * t283;
  t300 = t299 * t112;
  t303 = t138 * t116;
  t305 = 0.1e1 / t107 / t303;
  t306 = t137 * t305;
  t313 = 0.37037037037037037037e-4 * t68 * t306;
  t314 = -0.69814814814814814817e-1 * t68 * t306 * t129 - t132 * t295 / 0.9e1 + t313;
  t316 = t152 * t152;
  t317 = 0.1e1 / t316;
  t318 = t145 * t317;
  t324 = 0.25321408066666666666e1 * t121 + 0.1e1;
  t325 = sqrt(t324);
  t326 = 0.1e1 / t325;
  t330 = -0.21827777777777777777e-1 * t79 * t299 * t148 - 0.85080312222222222219e-1 * t43 * sigma[2] * t294 * t326 - t313;
  t332 = t314 * t153 - t318 * t330;
  t334 = 0.4e1 / 0.3e1 * t281 * t285 - 0.36720684159021185007e-1 * t291 * t295 - 0.4e1 / 0.3e1 * t298 * t300 + t114 * t332;
  t339 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t157 - t254 - 0.3e1 / 0.8e1 * t5 * t105 * t334);
  tvrho1 = t95 + t161 + t6 * (t269 + t339);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t342 = 0.1e1 / t28;
  t343 = t181 * t342;
  t345 = t31 * t34 * t54;
  t351 = t342 * t31;
  t352 = t351 * t34;
  t355 = t73 * t57;
  t364 = 0.13888888888888888889e-4 * t68 * sigma[0] * t73;
  t365 = 0.26180555555555555555e-1 * t68 * t355 * sigma[0] + t60 * t42 * t47 / 0.24e2 - t364;
  t373 = 0.81854166666666666665e-2 * t79 * t351 * t82 + 0.31905117083333333333e-1 * t43 * t47 * t227 + t364;
  t375 = -t219 * t373 + t365 * t87;
  t377 = -t343 * t345 / 0.2e1 + 0.13770256559632944377e-1 * t191 * t43 * t47 + t199 * t352 / 0.2e1 + t36 * t375;
  t381 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t377);
  tvsigma0 = t6 * t381;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t382 = 0.1e1 / t106;
  t383 = t280 * t382;
  t385 = t109 * t112 * t126;
  t391 = t382 * t109;
  t392 = t391 * t112;
  t395 = t141 * t129;
  t404 = 0.13888888888888888889e-4 * t68 * sigma[2] * t141;
  t405 = 0.26180555555555555555e-1 * t68 * t395 * sigma[2] + t132 * t42 * t119 / 0.24e2 - t404;
  t413 = 0.81854166666666666665e-2 * t79 * t391 * t148 + 0.31905117083333333333e-1 * t43 * t119 * t326 + t404;
  t415 = t405 * t153 - t318 * t413;
  t417 = -t383 * t385 / 0.2e1 + 0.13770256559632944377e-1 * t290 * t43 * t119 + t298 * t392 / 0.2e1 + t114 * t415;
  t421 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t417);
  tvsigma2 = t6 * t421;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t424 = t23 * t23;
  t425 = 0.1e1 / t424;
  t426 = t166 * t166;
  t429 = t162 * t6;
  t430 = 0.1e1 / t429;
  t431 = t16 * t430;
  t434 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t163 + 0.2e1 * t431);
  t438 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t425 * t426 + 0.4e1 / 0.3e1 * t23 * t434);
  t439 = t438 * t26;
  t443 = t169 * t175;
  t445 = t5 * t443 * t91;
  t451 = 0.1e1 / t174 / t6;
  t452 = t25 * t451;
  t455 = t5 * t452 * t91 / 0.12e2;
  t457 = t5 * t176 * t235;
  t460 = 0.1e1 / t180 / t35;
  t461 = t460 * sigma[0];
  t463 = 0.1e1 / t45 / t70;
  t464 = t34 * t34;
  t465 = t463 * t464;
  t466 = t465 * t54;
  t470 = 0.1e1 / t29 / t193;
  t472 = t470 * t34 * t54;
  t475 = t181 * sigma[0];
  t476 = t463 * t34;
  t477 = t476 * t54;
  t480 = t28 * sigma[0];
  t481 = t181 * t480;
  t482 = 0.1e1 / t204;
  t485 = t34 * t190 * t43;
  t489 = 0.1e1 / t189 / t51;
  t490 = t37 * t489;
  t491 = t490 * t65;
  t492 = t67 * t69;
  t493 = t70 * t193;
  t495 = 0.1e1 / t29 / t493;
  t499 = t61 * t463;
  t502 = t460 * t89;
  t503 = sigma[0] * t463;
  t504 = t503 * t464;
  t507 = t181 * t233;
  t510 = t28 * t470;
  t511 = t510 * t34;
  t514 = t503 * t34;
  t517 = t69 * t495;
  t521 = t39 * t39;
  t522 = 0.1e1 / t521;
  t523 = t69 * sigma[0];
  t524 = t522 * t523;
  t525 = t70 * t70;
  t526 = t525 * t44;
  t527 = 0.1e1 / t526;
  t534 = 0.23456790123456790123e-3 * t68 * t517;
  t535 = 0.62833333333333333335e0 * t68 * t517 * t57 - 0.46543209876543209878e1 * t524 * t527 * t57 + 0.11e2 / 0.27e2 * t60 * t499 - t534;
  t537 = t215 * t218;
  t541 = 0.1e1 / t217 / t86;
  t542 = t77 * t541;
  t543 = t231 * t231;
  t553 = 0.1e1 / t226 / t225;
  t557 = 0.5093148148148148148e-1 * t79 * t510 * t82 + 0.42540156111111111109e0 * t43 * t503 * t227 - 0.2872471072291061827e0 * t68 * t517 * t553 + t534;
  t559 = -t219 * t557 - 0.2e1 * t537 * t231 + t535 * t87 + 0.2e1 * t542 * t543;
  t561 = -0.32e2 / 0.9e1 * t461 * t466 - 0.28e2 / 0.9e1 * t182 * t472 + 0.16e2 / 0.9e1 * t475 * t477 - 0.97921824424056493352e-1 * t481 * t482 * t485 - 0.17912755517915488751e-2 * t491 * t492 * t495 + 0.13464250858307767836e0 * t192 * t499 + 0.32e2 / 0.9e1 * t502 * t504 - 0.8e1 / 0.3e1 * t507 * t201 + 0.28e2 / 0.9e1 * t199 * t511 - 0.16e2 / 0.9e1 * t199 * t514 + t36 * t559;
  t566 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t439 * t91 - t445 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t170 * t235 + t455 - t457 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t561);
  t567 = t102 * t102;
  t568 = 0.1e1 / t567;
  t569 = t243 * t243;
  t572 = t97 * t430;
  t575 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t163 + 0.2e1 * t572);
  t579 = my_piecewise3(t101, 0, 0.4e1 / 0.9e1 * t568 * t569 + 0.4e1 / 0.3e1 * t102 * t575);
  t580 = t579 * t26;
  t584 = t246 * t175;
  t586 = t5 * t584 * t157;
  t588 = t104 * t451;
  t591 = t5 * t588 * t157 / 0.12e2;
  t593 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t580 * t157 - t586 / 0.4e1 + t591);
  tv2rho20 = 0.2e1 * t240 + 0.2e1 * t256 + t6 * (t566 + t593);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t596 = t425 * t260;
  t600 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t431);
  t604 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t596 * t166 + 0.4e1 / 0.3e1 * t23 * t600);
  t605 = t604 * t26;
  t609 = t263 * t175;
  t611 = t5 * t609 * t91;
  t619 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t91 - t611 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t264 * t235 - t445 / 0.8e1 + t455 - t457 / 0.8e1);
  t620 = t568 * t271;
  t624 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t572);
  t628 = my_piecewise3(t101, 0, 0.4e1 / 0.9e1 * t620 * t243 + 0.4e1 / 0.3e1 * t102 * t624);
  t629 = t628 * t26;
  t633 = t274 * t175;
  t635 = t5 * t633 * t157;
  t642 = t5 * t251 * t334;
  t645 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t629 * t157 - t635 / 0.8e1 - t586 / 0.8e1 + t591 - 0.3e1 / 0.8e1 * t5 * t247 * t334 - t642 / 0.8e1);
  tv2rho21 = t240 + t256 + t269 + t339 + t6 * (t619 + t645);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t650 = t260 * t260;
  t655 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t163 + 0.2e1 * t431);
  t659 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t425 * t650 + 0.4e1 / 0.3e1 * t23 * t655);
  t660 = t659 * t26;
  t666 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t660 * t91 - t611 / 0.4e1 + t455);
  t667 = t271 * t271;
  t672 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t163 + 0.2e1 * t572);
  t676 = my_piecewise3(t101, 0, 0.4e1 / 0.9e1 * t568 * t667 + 0.4e1 / 0.3e1 * t102 * t672);
  t677 = t676 * t26;
  t687 = 0.1e1 / t279 / t113;
  t688 = t687 * sigma[2];
  t690 = 0.1e1 / t117 / t138;
  t691 = t112 * t112;
  t692 = t690 * t691;
  t693 = t692 * t126;
  t697 = 0.1e1 / t107 / t292;
  t699 = t697 * t112 * t126;
  t702 = t280 * sigma[2];
  t703 = t690 * t112;
  t704 = t703 * t126;
  t707 = t106 * sigma[2];
  t708 = t280 * t707;
  t709 = 0.1e1 / t303;
  t712 = t112 * t289 * t43;
  t716 = 0.1e1 / t288 / t123;
  t717 = t115 * t716;
  t718 = t717 * t65;
  t719 = t67 * t137;
  t720 = t138 * t292;
  t722 = 0.1e1 / t107 / t720;
  t726 = t133 * t690;
  t729 = t687 * t155;
  t730 = sigma[2] * t690;
  t731 = t730 * t691;
  t734 = t280 * t332;
  t737 = t106 * t697;
  t738 = t737 * t112;
  t741 = t730 * t112;
  t744 = t137 * t722;
  t748 = t137 * sigma[2];
  t749 = t522 * t748;
  t750 = t138 * t138;
  t751 = t750 * t116;
  t752 = 0.1e1 / t751;
  t759 = 0.23456790123456790123e-3 * t68 * t744;
  t760 = 0.62833333333333333335e0 * t68 * t744 * t129 - 0.46543209876543209878e1 * t749 * t752 * t129 + 0.11e2 / 0.27e2 * t132 * t726 - t759;
  t762 = t314 * t317;
  t766 = 0.1e1 / t316 / t152;
  t767 = t145 * t766;
  t768 = t330 * t330;
  t778 = 0.1e1 / t325 / t324;
  t782 = 0.5093148148148148148e-1 * t79 * t737 * t148 + 0.42540156111111111109e0 * t43 * t730 * t326 - 0.2872471072291061827e0 * t68 * t744 * t778 + t759;
  t784 = t760 * t153 - t318 * t782 - 0.2e1 * t762 * t330 + 0.2e1 * t767 * t768;
  t786 = -0.32e2 / 0.9e1 * t688 * t693 - 0.28e2 / 0.9e1 * t281 * t699 + 0.16e2 / 0.9e1 * t702 * t704 - 0.97921824424056493352e-1 * t708 * t709 * t712 - 0.17912755517915488751e-2 * t718 * t719 * t722 + 0.13464250858307767836e0 * t291 * t726 + 0.32e2 / 0.9e1 * t729 * t731 - 0.8e1 / 0.3e1 * t734 * t300 + 0.28e2 / 0.9e1 * t298 * t738 - 0.16e2 / 0.9e1 * t298 * t741 + t114 * t784;
  t791 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t677 * t157 - t635 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t275 * t334 + t591 - t642 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t105 * t786);
  tv2rho22 = 0.2e1 * t269 + 0.2e1 * t339 + t6 * (t666 + t791);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t799 = t5 * t176 * t377 / 0.8e1;
  t801 = t464 * t54;
  t807 = t34 * t54;
  t810 = 0.1e1 / t71;
  t821 = t195 * t464;
  t826 = t342 * t184;
  t827 = t826 * t34;
  t830 = t195 * t34;
  t833 = t181 * t375;
  t836 = t206 * t57;
  t840 = t525 * rho[0];
  t841 = 0.1e1 / t840;
  t842 = t522 * t841;
  t843 = t69 * t57;
  t851 = 0.74074074074074074075e-4 * t68 * sigma[0] * t206;
  t852 = -0.20944444444444444445e0 * t68 * t836 * sigma[0] + 0.17453703703703703703e1 * t842 * t843 - t60 * t42 * t195 / 0.9e1 + t851;
  t854 = t365 * t218;
  t857 = t373 * t231;
  t866 = t206 * t553;
  t870 = -0.10913888888888888889e-1 * t79 * t826 * t82 - 0.12762046833333333333e0 * t43 * t195 * t227 + 0.10771766521091481852e0 * t68 * t866 * sigma[0] - t851;
  t872 = -t219 * t870 - t854 * t231 - t537 * t373 + 0.2e1 * t542 * t857 + t852 * t87;
  t874 = 0.4e1 / 0.3e1 * t460 * t195 * t801 + 0.2e1 / 0.3e1 * t343 * t186 - 0.2e1 / 0.3e1 * t181 * t195 * t807 + 0.36720684159021185007e-1 * t182 * t810 * t485 + 0.67172833192183082812e-3 * t491 * t67 * t206 * sigma[0] - 0.36720684159021185005e-1 * t191 * t43 * t195 - 0.4e1 / 0.3e1 * t502 * t821 + t507 * t352 / 0.2e1 - 0.2e1 / 0.3e1 * t199 * t827 + 0.2e1 / 0.3e1 * t199 * t830 - 0.4e1 / 0.3e1 * t833 * t201 + t36 * t872;
  t879 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t377 - t799 - 0.3e1 / 0.8e1 * t5 * t27 * t874);
  tv2rhosigma0 = t6 * t879 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t886 = t5 * t251 * t417 / 0.8e1;
  t888 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t417 - t886);
  tv2rhosigma2 = t6 * t888 + t421;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t894 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t377 - t799);
  tv2rhosigma3 = t6 * t894 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t900 = t691 * t126;
  t906 = t112 * t126;
  t909 = 0.1e1 / t139;
  t920 = t294 * t691;
  t925 = t382 * t283;
  t926 = t925 * t112;
  t929 = t294 * t112;
  t932 = t280 * t415;
  t935 = t305 * t129;
  t939 = t750 * rho[1];
  t940 = 0.1e1 / t939;
  t941 = t522 * t940;
  t942 = t137 * t129;
  t950 = 0.74074074074074074075e-4 * t68 * sigma[2] * t305;
  t951 = -0.20944444444444444445e0 * t68 * t935 * sigma[2] + 0.17453703703703703703e1 * t941 * t942 - t132 * t42 * t294 / 0.9e1 + t950;
  t953 = t405 * t317;
  t956 = t413 * t330;
  t965 = t305 * t778;
  t969 = -0.10913888888888888889e-1 * t79 * t925 * t148 - 0.12762046833333333333e0 * t43 * t294 * t326 + 0.10771766521091481852e0 * t68 * t965 * sigma[2] - t950;
  t971 = t951 * t153 - t318 * t969 - t953 * t330 - t762 * t413 + 0.2e1 * t767 * t956;
  t973 = 0.4e1 / 0.3e1 * t687 * t294 * t900 + 0.2e1 / 0.3e1 * t383 * t285 - 0.2e1 / 0.3e1 * t280 * t294 * t906 + 0.36720684159021185007e-1 * t281 * t909 * t712 + 0.67172833192183082812e-3 * t718 * t67 * t305 * sigma[2] - 0.36720684159021185005e-1 * t290 * t43 * t294 - 0.4e1 / 0.3e1 * t729 * t920 + t734 * t392 / 0.2e1 - 0.2e1 / 0.3e1 * t298 * t926 + 0.2e1 / 0.3e1 * t298 * t929 - 0.4e1 / 0.3e1 * t932 * t300 + t114 * t971;
  t978 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t417 - t886 - 0.3e1 / 0.8e1 * t5 * t105 * t973);
  tv2rhosigma5 = t6 * t978 + t421;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t980 = 0.1e1 / sigma[0];
  t981 = t460 * t980;
  t983 = t47 * t464 * t54;
  t986 = 0.1e1 / t480;
  t987 = t181 * t986;
  t990 = t181 * t980;
  t992 = t47 * t34 * t54;
  t995 = 0.1e1 / t70;
  t999 = t68 * t73;
  t1002 = t980 * t47;
  t1003 = t1002 * t464;
  t1007 = t986 * t31;
  t1008 = t1007 * t34;
  t1011 = t1002 * t34;
  t1014 = 0.1e1 / t525;
  t1015 = t522 * t1014;
  t1016 = t57 * sigma[0];
  t1021 = 0.13888888888888888889e-4 * t999;
  t1022 = -0.65451388888888888888e0 * t1015 * t1016 + 0.5236111111111111111e-1 * t68 * t355 - t1021;
  t1026 = t373 * t373;
  t1038 = -0.40927083333333333332e-2 * t79 * t1007 * t82 + 0.15952558541666666666e-1 * t43 * t1002 * t227 - 0.40394124454093056943e-1 * t68 * t73 * t553 + t1021;
  t1040 = t1022 * t87 + 0.2e1 * t542 * t1026 - t219 * t1038 - 0.2e1 * t854 * t373;
  t1042 = -t981 * t983 / 0.2e1 + t987 * t345 / 0.4e1 + t990 * t992 / 0.4e1 - 0.13770256559632944377e-1 * t343 * t995 * t485 - 0.25189812447068656054e-3 * t490 * t999 + t502 * t1003 / 0.2e1 + t833 * t352 - t199 * t1008 / 0.4e1 - t199 * t1011 / 0.4e1 + t36 * t1040;
  t1046 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1042);
  tv2sigma20 = t6 * t1046;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1047 = 0.1e1 / sigma[2];
  t1048 = t687 * t1047;
  t1050 = t119 * t691 * t126;
  t1053 = 0.1e1 / t707;
  t1054 = t280 * t1053;
  t1057 = t280 * t1047;
  t1059 = t119 * t112 * t126;
  t1062 = 0.1e1 / t138;
  t1066 = t68 * t141;
  t1069 = t1047 * t119;
  t1070 = t1069 * t691;
  t1074 = t1053 * t109;
  t1075 = t1074 * t112;
  t1078 = t1069 * t112;
  t1081 = 0.1e1 / t750;
  t1082 = t522 * t1081;
  t1083 = t129 * sigma[2];
  t1088 = 0.13888888888888888889e-4 * t1066;
  t1089 = -0.65451388888888888888e0 * t1082 * t1083 + 0.5236111111111111111e-1 * t68 * t395 - t1088;
  t1093 = t413 * t413;
  t1105 = -0.40927083333333333332e-2 * t79 * t1074 * t148 + 0.15952558541666666666e-1 * t43 * t1069 * t326 - 0.40394124454093056943e-1 * t68 * t141 * t778 + t1088;
  t1107 = t1089 * t153 + 0.2e1 * t767 * t1093 - t318 * t1105 - 0.2e1 * t953 * t413;
  t1109 = -t1048 * t1050 / 0.2e1 + t1054 * t385 / 0.4e1 + t1057 * t1059 / 0.4e1 - 0.13770256559632944377e-1 * t383 * t1062 * t712 - 0.25189812447068656054e-3 * t717 * t1066 + t729 * t1070 / 0.2e1 + t932 * t392 - t298 * t1075 / 0.4e1 - t298 * t1078 / 0.4e1 + t114 * t1107;
  t1113 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t1109);
  tv2sigma25 = t6 * t1113;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1117 = 0.1e1 / t424 / t19;
  t1118 = t426 * t166;
  t1121 = t425 * t166;
  t1124 = t162 * t162;
  t1125 = 0.1e1 / t1124;
  t1126 = t16 * t1125;
  t1129 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t430 - 0.6e1 * t1126);
  t1133 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1117 * t1118 + 0.4e1 / 0.3e1 * t1121 * t434 + 0.4e1 / 0.3e1 * t23 * t1129);
  t1134 = t1133 * t26;
  t1138 = t438 * t175;
  t1140 = t5 * t1138 * t91;
  t1145 = t169 * t451;
  t1147 = t5 * t1145 * t91;
  t1150 = t5 * t443 * t235;
  t1156 = 0.1e1 / t174 / t162;
  t1157 = t25 * t1156;
  t1160 = 0.5e1 / 0.36e2 * t5 * t1157 * t91;
  t1162 = t5 * t452 * t235;
  t1165 = t5 * t176 * t561;
  t1167 = t28 * t69;
  t1168 = t181 * t1167;
  t1170 = 0.1e1 / t45 / t840;
  t1173 = t34 * t489 * t68;
  t1177 = 0.1e1 / t29 / t525;
  t1182 = 0.1e1 / t45 / t71;
  t1183 = t61 * t1182;
  t1188 = sigma[0] * t1182;
  t1189 = t1188 * t34;
  t1192 = 0.1e1 / t493;
  t1193 = t480 * t1192;
  t1194 = t1193 * t34;
  t1197 = t1193 * t464;
  t1200 = t181 * t559;
  t1203 = t180 * t180;
  t1204 = 0.1e1 / t1203;
  t1205 = t1204 * t480;
  t1206 = t464 * t34;
  t1207 = t1192 * t1206;
  t1211 = t460 * t480;
  t1212 = t1192 * t464;
  t1216 = t1182 * t34;
  t1224 = -0.71651022071661955004e-2 * t1168 * t1170 * t1173 + 0.19704031069707037626e-1 * t491 * t492 * t1177 - 0.62833170672102916568e0 * t192 * t1183 - 0.16e2 / 0.3e1 * t507 * t514 + 0.112e3 / 0.9e1 * t199 * t1189 - 0.64e2 / 0.27e2 * t199 * t1194 + 0.128e3 / 0.9e1 * t502 * t1197 - 0.4e1 * t1200 * t201 + 0.128e3 / 0.9e1 * t1205 * t1207 * t54 - 0.128e3 / 0.9e1 * t1211 * t1212 * t54 - 0.112e3 / 0.9e1 * t475 * t1216 * t54 + 0.64e2 / 0.27e2 * t481 * t1192 * t34 * t54;
  t1225 = t460 * t233;
  t1228 = t1204 * t89;
  t1229 = t1193 * t1206;
  t1232 = t189 * t189;
  t1233 = 0.1e1 / t1232;
  t1234 = t37 * t1233;
  t1235 = t525 * t193;
  t1236 = 0.1e1 / t1235;
  t1237 = t523 * t1236;
  t1240 = t69 * t1177;
  t1247 = t69 * t69;
  t1248 = t522 * t1247;
  t1249 = t525 * t71;
  t1251 = 0.1e1 / t45 / t1249;
  t1253 = t43 * t57;
  t1259 = 0.17201646090534979424e-2 * t68 * t1240;
  t1260 = -0.52904115226337448561e1 * t68 * t1240 * t57 + 0.88432098765432098768e2 * t524 * t1236 * t57 - 0.51714677640603566531e2 * t1248 * t1251 * t1253 - 0.154e3 / 0.81e2 * t60 * t1183 + t1259;
  t1262 = t535 * t218;
  t1265 = t215 * t541;
  t1270 = t217 * t217;
  t1271 = 0.1e1 / t1270;
  t1272 = t77 * t1271;
  t1273 = t543 * t231;
  t1276 = t231 * t557;
  t1280 = 0.1e1 / t29 / t70;
  t1281 = t28 * t1280;
  t1291 = t225 * t225;
  t1293 = 0.1e1 / t226 / t1291;
  t1296 = -0.16977160493827160493e0 * t79 * t1281 * t82 - 0.22499015898765432098e1 * t43 * t1188 * t227 + 0.35427143224923095866e1 * t68 * t1240 * t553 - 0.17920712264309222762e0 * t1237 * t1293 - t1259;
  t1298 = t1260 * t87 - 0.3e1 * t1262 * t231 + 0.6e1 * t1265 * t543 - 0.6e1 * t1272 * t1273 + 0.6e1 * t542 * t1276 - t219 * t1296 - 0.3e1 * t537 * t557;
  t1300 = t1281 * t34;
  t1306 = t1280 * t34 * t54;
  t1309 = t1188 * t464;
  t1312 = t1182 * t464;
  t1316 = t460 * t69;
  t1319 = t464 * t190 * t43;
  t1325 = t181 * t69;
  t1329 = 0.32e2 / 0.3e1 * t1225 * t504 - 0.128e3 / 0.9e1 * t1228 * t1229 - 0.80734108036796969854e-5 * t1234 * t1237 + t36 * t1298 - 0.28e3 / 0.27e2 * t199 * t1300 + 0.28e2 / 0.3e1 * t507 * t511 + 0.28e3 / 0.27e2 * t182 * t1306 - 0.224e3 / 0.9e1 * t502 * t1309 + 0.224e3 / 0.9e1 * t461 * t1312 * t54 + 0.39168729769622597341e0 * t1316 * t1177 * t1319 + 0.88129641981650844017e0 * t481 * t1192 * t485 - 0.1958436488481129867e0 * t1325 * t1177 * t485;
  t1330 = t1224 + t1329;
  t1335 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1134 * t91 - 0.3e1 / 0.8e1 * t1140 - 0.9e1 / 0.8e1 * t5 * t439 * t235 + t1147 / 0.4e1 - 0.3e1 / 0.4e1 * t1150 - 0.9e1 / 0.8e1 * t5 * t170 * t561 - t1160 + t1162 / 0.4e1 - 0.3e1 / 0.8e1 * t1165 - 0.3e1 / 0.8e1 * t5 * t27 * t1330);
  t1337 = 0.1e1 / t567 / t100;
  t1338 = t569 * t243;
  t1341 = t568 * t243;
  t1344 = t97 * t1125;
  t1347 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t430 - 0.6e1 * t1344);
  t1351 = my_piecewise3(t101, 0, -0.8e1 / 0.27e2 * t1337 * t1338 + 0.4e1 / 0.3e1 * t1341 * t575 + 0.4e1 / 0.3e1 * t102 * t1347);
  t1352 = t1351 * t26;
  t1356 = t579 * t175;
  t1358 = t5 * t1356 * t157;
  t1360 = t246 * t451;
  t1362 = t5 * t1360 * t157;
  t1364 = t104 * t1156;
  t1367 = 0.5e1 / 0.36e2 * t5 * t1364 * t157;
  t1369 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t1352 * t157 - 0.3e1 / 0.8e1 * t1358 + t1362 / 0.4e1 - t1367);
  tv3rho30 = 0.3e1 * t566 + 0.3e1 * t593 + t6 * (t1335 + t1369);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1372 = 0.2e1 * t619;
  t1373 = 0.2e1 * t645;
  t1374 = t1117 * t260;
  t1377 = t425 * t600;
  t1382 = 0.2e1 * t430;
  t1383 = 0.6e1 * t1126;
  t1385 = my_piecewise5(t10, 0, t14, 0, t1382 - t1383);
  t1389 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1374 * t426 + 0.8e1 / 0.9e1 * t1377 * t166 + 0.4e1 / 0.9e1 * t596 * t434 + 0.4e1 / 0.3e1 * t23 * t1385);
  t1390 = t1389 * t26;
  t1394 = t604 * t175;
  t1397 = t5 * t1394 * t91 / 0.4e1;
  t1401 = t263 * t451;
  t1403 = t5 * t1401 * t91;
  t1407 = t5 * t609 * t235 / 0.4e1;
  t1416 = -0.3e1 / 0.8e1 * t5 * t1390 * t91 - t1397 - 0.3e1 / 0.4e1 * t5 * t605 * t235 + t1403 / 0.12e2 - t1407 - 0.3e1 / 0.8e1 * t5 * t264 * t561 - t1140 / 0.8e1 + t1147 / 0.6e1 - t1150 / 0.4e1 - t1160 + t1162 / 0.6e1 - t1165 / 0.8e1;
  t1417 = my_piecewise3(t1, 0, t1416);
  t1418 = t1337 * t271;
  t1421 = t568 * t624;
  t1426 = 0.6e1 * t1344;
  t1428 = my_piecewise5(t14, 0, t10, 0, -t1382 - t1426);
  t1432 = my_piecewise3(t101, 0, -0.8e1 / 0.27e2 * t1418 * t569 + 0.8e1 / 0.9e1 * t1421 * t243 + 0.4e1 / 0.9e1 * t620 * t575 + 0.4e1 / 0.3e1 * t102 * t1428);
  t1433 = t1432 * t26;
  t1437 = t628 * t175;
  t1440 = t5 * t1437 * t157 / 0.4e1;
  t1441 = t274 * t451;
  t1443 = t5 * t1441 * t157;
  t1452 = t5 * t584 * t334 / 0.4e1;
  t1454 = t5 * t588 * t334;
  t1457 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t1433 * t157 - t1440 + t1443 / 0.12e2 - t1358 / 0.8e1 + t1362 / 0.6e1 - t1367 - 0.3e1 / 0.8e1 * t5 * t580 * t334 - t1452 + t1454 / 0.12e2);
  tv3rho31 = t566 + t593 + t1372 + t1373 + t6 * (t1417 + t1457);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1460 = t1117 * t650;
  t1465 = t425 * t655;
  t1469 = my_piecewise5(t10, 0, t14, 0, -t1382 - t1383);
  t1473 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1460 * t166 + 0.8e1 / 0.9e1 * t596 * t600 + 0.4e1 / 0.9e1 * t1465 * t166 + 0.4e1 / 0.3e1 * t23 * t1469);
  t1474 = t1473 * t26;
  t1478 = t659 * t175;
  t1480 = t5 * t1478 * t91;
  t1489 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1474 * t91 - t1480 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t660 * t235 - t1397 + t1403 / 0.6e1 - t1407 + t1147 / 0.12e2 - t1160 + t1162 / 0.12e2);
  t1490 = t1337 * t667;
  t1495 = t568 * t672;
  t1499 = my_piecewise5(t14, 0, t10, 0, t1382 - t1426);
  t1503 = my_piecewise3(t101, 0, -0.8e1 / 0.27e2 * t1490 * t243 + 0.8e1 / 0.9e1 * t620 * t624 + 0.4e1 / 0.9e1 * t1495 * t243 + 0.4e1 / 0.3e1 * t102 * t1499);
  t1504 = t1503 * t26;
  t1508 = t676 * t175;
  t1510 = t5 * t1508 * t157;
  t1517 = t5 * t633 * t334;
  t1525 = t5 * t251 * t786;
  t1527 = -0.3e1 / 0.8e1 * t5 * t1504 * t157 - t1510 / 0.8e1 - t1440 + t1443 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t629 * t334 - t1517 / 0.4e1 + t1362 / 0.12e2 - t1367 - t1452 + t1454 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t247 * t786 - t1525 / 0.8e1;
  t1528 = my_piecewise3(t96, 0, t1527);
  tv3rho32 = t1372 + t1373 + t666 + t791 + t6 * (t1489 + t1528);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1533 = t650 * t260;
  t1540 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t430 - 0.6e1 * t1126);
  t1544 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1117 * t1533 + 0.4e1 / 0.3e1 * t596 * t655 + 0.4e1 / 0.3e1 * t23 * t1540);
  t1545 = t1544 * t26;
  t1552 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1545 * t91 - 0.3e1 / 0.8e1 * t1480 + t1403 / 0.4e1 - t1160);
  t1553 = t667 * t271;
  t1560 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t430 - 0.6e1 * t1344);
  t1564 = my_piecewise3(t101, 0, -0.8e1 / 0.27e2 * t1337 * t1553 + 0.4e1 / 0.3e1 * t620 * t672 + 0.4e1 / 0.3e1 * t102 * t1560);
  t1565 = t1564 * t26;
  t1583 = 0.1e1 / t107 / t138;
  t1584 = t106 * t1583;
  t1585 = t1584 * t112;
  t1589 = 0.1e1 / t117 / t139;
  t1590 = sigma[2] * t1589;
  t1591 = t1590 * t691;
  t1595 = 0.1e1 / t107 / t750;
  t1596 = t137 * t1595;
  t1600 = t750 * t292;
  t1601 = 0.1e1 / t1600;
  t1605 = t137 * t137;
  t1606 = t522 * t1605;
  t1607 = t750 * t139;
  t1609 = 0.1e1 / t117 / t1607;
  t1611 = t43 * t129;
  t1614 = t133 * t1589;
  t1618 = 0.17201646090534979424e-2 * t68 * t1596;
  t1619 = -0.52904115226337448561e1 * t68 * t1596 * t129 + 0.88432098765432098768e2 * t749 * t1601 * t129 - 0.51714677640603566531e2 * t1606 * t1609 * t1611 - 0.154e3 / 0.81e2 * t132 * t1614 + t1618;
  t1621 = t760 * t317;
  t1624 = t314 * t766;
  t1629 = t316 * t316;
  t1630 = 0.1e1 / t1629;
  t1631 = t145 * t1630;
  t1632 = t768 * t330;
  t1635 = t330 * t782;
  t1647 = t748 * t1601;
  t1648 = t324 * t324;
  t1650 = 0.1e1 / t325 / t1648;
  t1653 = -0.16977160493827160493e0 * t79 * t1584 * t148 - 0.22499015898765432098e1 * t43 * t1590 * t326 + 0.35427143224923095866e1 * t68 * t1596 * t778 - 0.17920712264309222762e0 * t1647 * t1650 - t1618;
  t1655 = t1619 * t153 - 0.3e1 * t1621 * t330 + 0.6e1 * t1624 * t768 - 0.6e1 * t1631 * t1632 + 0.6e1 * t767 * t1635 - t318 * t1653 - 0.3e1 * t762 * t782;
  t1657 = 0.1e1 / t720;
  t1658 = t707 * t1657;
  t1659 = t1658 * t112;
  t1664 = t1590 * t112;
  t1667 = t279 * t279;
  t1668 = 0.1e1 / t1667;
  t1669 = t1668 * t155;
  t1670 = t691 * t112;
  t1671 = t1658 * t1670;
  t1674 = t1658 * t691;
  t1677 = t280 * t784;
  t1680 = t1668 * t707;
  t1681 = t1657 * t1670;
  t1685 = t687 * t707;
  t1686 = t1657 * t691;
  t1690 = 0.28e2 / 0.3e1 * t734 * t738 - 0.28e3 / 0.27e2 * t298 * t1585 - 0.224e3 / 0.9e1 * t729 * t1591 + t114 * t1655 - 0.64e2 / 0.27e2 * t298 * t1659 - 0.16e2 / 0.3e1 * t734 * t741 + 0.112e3 / 0.9e1 * t298 * t1664 - 0.128e3 / 0.9e1 * t1669 * t1671 + 0.128e3 / 0.9e1 * t729 * t1674 - 0.4e1 * t1677 * t300 + 0.128e3 / 0.9e1 * t1680 * t1681 * t126 - 0.128e3 / 0.9e1 * t1685 * t1686 * t126;
  t1691 = t1589 * t112;
  t1699 = t687 * t332;
  t1702 = t1589 * t691;
  t1707 = t1583 * t112 * t126;
  t1715 = t687 * t137;
  t1718 = t691 * t289 * t43;
  t1724 = t280 * t137;
  t1728 = t106 * t137;
  t1729 = t280 * t1728;
  t1731 = 0.1e1 / t117 / t939;
  t1734 = t112 * t716 * t68;
  t1737 = t288 * t288;
  t1738 = 0.1e1 / t1737;
  t1739 = t115 * t1738;
  t1742 = -0.112e3 / 0.9e1 * t702 * t1691 * t126 + 0.64e2 / 0.27e2 * t708 * t1657 * t112 * t126 + 0.32e2 / 0.3e1 * t1699 * t731 + 0.224e3 / 0.9e1 * t688 * t1702 * t126 + 0.28e3 / 0.27e2 * t281 * t1707 + 0.19704031069707037626e-1 * t718 * t719 * t1595 - 0.62833170672102916568e0 * t291 * t1614 + 0.39168729769622597341e0 * t1715 * t1595 * t1718 + 0.88129641981650844017e0 * t708 * t1657 * t712 - 0.1958436488481129867e0 * t1724 * t1595 * t712 - 0.71651022071661955004e-2 * t1729 * t1731 * t1734 - 0.80734108036796969854e-5 * t1739 * t1647;
  t1743 = t1690 + t1742;
  t1748 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t1565 * t157 - 0.3e1 / 0.8e1 * t1510 - 0.9e1 / 0.8e1 * t5 * t677 * t334 + t1443 / 0.4e1 - 0.3e1 / 0.4e1 * t1517 - 0.9e1 / 0.8e1 * t5 * t275 * t786 - t1367 + t1454 / 0.4e1 - 0.3e1 / 0.8e1 * t1525 - 0.3e1 / 0.8e1 * t5 * t105 * t1743);
  tv3rho33 = 0.3e1 * t666 + 0.3e1 * t791 + t6 * (t1552 + t1748);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1756 = t5 * t443 * t377;
  t1763 = t5 * t452 * t377 / 0.12e2;
  t1765 = t5 * t176 * t874;
  t1767 = t460 * t495;
  t1768 = t1767 * t464;
  t1769 = t190 * t38;
  t1770 = t1769 * t61;
  t1776 = t181 * t495;
  t1777 = t1776 * t34;
  t1781 = 0.1e1 / t45 / t525;
  t1806 = t342 * t470;
  t1807 = t1806 * t34;
  t1810 = -0.14688273663608474003e0 * t1768 * t1770 - 0.25704478911314829505e0 * t182 * t482 * t485 + 0.73441368318042370014e-1 * t1777 * t1770 + 0.26869133276873233126e-2 * t481 * t1781 * t1173 - 0.8e1 / 0.3e1 * t1225 * t821 + 0.4e1 / 0.3e1 * t507 * t830 - 0.1e2 / 0.3e1 * t199 * t476 + 0.2e2 / 0.3e1 * t502 * t465 - 0.2e2 / 0.3e1 * t460 * t463 * t801 + 0.1e2 / 0.3e1 * t181 * t463 * t807 + 0.30275290513798863693e-5 * t1234 * t527 * t69 + 0.28e2 / 0.9e1 * t833 * t511 - 0.4e1 / 0.3e1 * t507 * t827 + 0.14e2 / 0.9e1 * t199 * t1807;
  t1819 = t1206 * t54;
  t1820 = t1819 * t28;
  t1824 = t801 * t28;
  t1829 = t28 * t34 * t54;
  t1832 = t181 * t872;
  t1835 = t482 * t1206;
  t1836 = t1835 * t28;
  t1839 = t482 * t464;
  t1840 = t1839 * t28;
  t1846 = t482 * t28 * t34;
  t1849 = t460 * t375;
  t1856 = t495 * t57;
  t1860 = t522 * t527;
  t1863 = t525 * t70;
  t1865 = 0.1e1 / t45 / t1863;
  t1866 = t522 * t1865;
  t1875 = 0.46913580246913580247e-3 * t68 * sigma[0] * t495;
  t1876 = 0.1512654320987654321e1 * t68 * t1856 * sigma[0] - 0.29671296296296296296e2 * t1860 * t843 + 0.19393004115226337448e2 * t1866 * t523 * t1253 + 0.11e2 / 0.27e2 * t60 * t42 * t463 - t1875;
  t1878 = t852 * t218;
  t1881 = t365 * t541;
  t1890 = t373 * t543;
  t1893 = t870 * t231;
  t1896 = t373 * t557;
  t1905 = t495 * t553;
  t1909 = t527 * t1293;
  t1912 = 0.25465740740740740741e-1 * t79 * t1806 * t82 + 0.52466192537037037036e0 * t43 * t463 * t227 - 0.1113082540512786458e1 * t68 * t1905 * sigma[0] + 0.67202670991159585361e-1 * t1909 * t69 + t1875;
  t1914 = -t1262 * t373 + 0.4e1 * t1265 * t857 - 0.6e1 * t1272 * t1890 + t1876 * t87 - 0.2e1 * t1878 * t231 + 0.2e1 * t1881 * t543 + 0.4e1 * t542 * t1893 + 0.2e1 * t542 * t1896 - t219 * t1912 - 0.2e1 * t537 * t870 - t854 * t557;
  t1916 = 0.13464250858307767835e0 * t191 * t43 * t463 - 0.14e2 / 0.9e1 * t343 * t472 + t1200 * t352 / 0.2e1 - 0.16e2 / 0.3e1 * t1204 * t482 * t1820 + 0.16e2 / 0.3e1 * t460 * t482 * t1824 - 0.8e1 / 0.9e1 * t181 * t482 * t1829 - 0.8e1 / 0.3e1 * t1832 * t201 + 0.16e2 / 0.3e1 * t1228 * t1836 - 0.16e2 / 0.3e1 * t502 * t1840 - 0.16e2 / 0.9e1 * t833 * t514 + 0.8e1 / 0.9e1 * t199 * t1846 + 0.32e2 / 0.9e1 * t1849 * t504 - 0.60455549872964774531e-2 * t491 * t67 * t495 * sigma[0] + t36 * t1914;
  t1917 = t1810 + t1916;
  t1922 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t439 * t377 - t1756 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t170 * t874 + t1763 - t1765 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1917);
  tv3rho2sigma0 = t6 * t1922 + 0.2e1 * t879;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1929 = t5 * t584 * t417;
  t1933 = t5 * t588 * t417 / 0.12e2;
  t1935 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t580 * t417 - t1929 / 0.4e1 + t1933);
  tv3rho2sigma2 = t6 * t1935 + 0.2e1 * t888;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1941 = t5 * t609 * t377;
  t1949 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t377 - t1941 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t264 * t874 - t1756 / 0.8e1 + t1763 - t1765 / 0.8e1);
  tv3rho2sigma3 = t6 * t1949 + t879 + t894;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1955 = t5 * t633 * t417;
  t1962 = t5 * t251 * t973;
  t1965 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t629 * t417 - t1955 / 0.8e1 - t1929 / 0.8e1 + t1933 - 0.3e1 / 0.8e1 * t5 * t247 * t973 - t1962 / 0.8e1);
  tv3rho2sigma5 = t6 * t1965 + t888 + t978;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1973 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t660 * t377 - t1941 / 0.4e1 + t1763);
  tv3rho2sigma6 = t6 * t1973 + 0.2e1 * t894;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1984 = t687 * t722;
  t1985 = t1984 * t691;
  t1986 = t289 * t38;
  t1987 = t1986 * t133;
  t1993 = t280 * t722;
  t1994 = t1993 * t112;
  t1998 = 0.1e1 / t117 / t750;
  t2004 = t382 * t697;
  t2005 = t2004 * t112;
  t2016 = t1670 * t126;
  t2017 = t2016 * t106;
  t2021 = t900 * t106;
  t2026 = t106 * t112 * t126;
  t2031 = t280 * t971;
  t2034 = -0.14688273663608474003e0 * t1985 * t1987 - 0.25704478911314829505e0 * t281 * t709 * t712 + 0.73441368318042370014e-1 * t1994 * t1987 + 0.26869133276873233126e-2 * t708 * t1998 * t1734 - 0.4e1 / 0.3e1 * t734 * t926 + 0.14e2 / 0.9e1 * t298 * t2005 - 0.14e2 / 0.9e1 * t383 * t699 + 0.13464250858307767835e0 * t290 * t43 * t690 + t1677 * t392 / 0.2e1 - 0.16e2 / 0.3e1 * t1668 * t709 * t2017 + 0.16e2 / 0.3e1 * t687 * t709 * t2021 - 0.8e1 / 0.9e1 * t280 * t709 * t2026 + 0.28e2 / 0.9e1 * t932 * t738 - 0.8e1 / 0.3e1 * t2031 * t300;
  t2035 = t709 * t1670;
  t2036 = t2035 * t106;
  t2039 = t709 * t691;
  t2040 = t2039 * t106;
  t2043 = t687 * t415;
  t2049 = t709 * t106 * t112;
  t2073 = t722 * t129;
  t2077 = t522 * t752;
  t2080 = t750 * t138;
  t2082 = 0.1e1 / t117 / t2080;
  t2083 = t522 * t2082;
  t2092 = 0.46913580246913580247e-3 * t68 * sigma[2] * t722;
  t2093 = 0.1512654320987654321e1 * t68 * t2073 * sigma[2] - 0.29671296296296296296e2 * t2077 * t942 + 0.19393004115226337448e2 * t2083 * t748 * t1611 + 0.11e2 / 0.27e2 * t132 * t42 * t690 - t2092;
  t2095 = t951 * t317;
  t2098 = t405 * t766;
  t2107 = t413 * t768;
  t2110 = t969 * t330;
  t2113 = t413 * t782;
  t2122 = t722 * t778;
  t2126 = t752 * t1650;
  t2129 = 0.25465740740740740741e-1 * t79 * t2004 * t148 + 0.52466192537037037036e0 * t43 * t690 * t326 - 0.1113082540512786458e1 * t68 * t2122 * sigma[2] + 0.67202670991159585361e-1 * t2126 * t137 + t2092;
  t2131 = t2093 * t153 - t1621 * t413 + 0.4e1 * t1624 * t956 - 0.6e1 * t1631 * t2107 - 0.2e1 * t2095 * t330 + 0.2e1 * t2098 * t768 + 0.4e1 * t767 * t2110 + 0.2e1 * t767 * t2113 - t318 * t2129 - 0.2e1 * t762 * t969 - t953 * t782;
  t2133 = 0.16e2 / 0.3e1 * t1669 * t2036 - 0.16e2 / 0.3e1 * t729 * t2040 + 0.32e2 / 0.9e1 * t2043 * t731 - 0.16e2 / 0.9e1 * t932 * t741 + 0.8e1 / 0.9e1 * t298 * t2049 - 0.60455549872964774531e-2 * t718 * t67 * t722 * sigma[2] + 0.4e1 / 0.3e1 * t734 * t929 - 0.1e2 / 0.3e1 * t298 * t703 + 0.1e2 / 0.3e1 * t280 * t690 * t906 + 0.30275290513798863693e-5 * t1739 * t752 * t137 - 0.8e1 / 0.3e1 * t1699 * t920 + 0.2e2 / 0.3e1 * t729 * t692 - 0.2e2 / 0.3e1 * t687 * t690 * t900 + t114 * t2131;
  t2134 = t2034 + t2133;
  t2139 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t677 * t417 - t1955 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t275 * t973 + t1933 - t1962 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t105 * t2134);
  tv3rho2sigma8 = t6 * t2139 + 0.2e1 * t978;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2146 = t5 * t176 * t1042 / 0.8e1;
  t2151 = 0.1e1 / t45 / t493;
  t2155 = t980 * t195;
  t2156 = t2155 * t464;
  t2159 = t821 * t54;
  t2164 = t68 * t206;
  t2167 = t1204 * t342;
  t2172 = t460 * t342;
  t2177 = t342 * t810;
  t2178 = t2177 * t34;
  t2181 = t830 * t54;
  t2190 = t2177 * t1206;
  t2193 = 0.45900855198776481256e-1 * t343 * t810 * t485 - 0.10075924978827462422e-2 * t182 * t2151 * t1173 - 0.2e1 / 0.3e1 * t502 * t2156 + 0.2e1 / 0.3e1 * t981 * t2159 - t987 * t186 / 0.3e1 + 0.13434566638436616562e-2 * t490 * t2164 + 0.2e1 * t2167 * t810 * t1206 * t54 - 0.2e1 * t2172 * t810 * t464 * t54 - t199 * t2178 / 0.3e1 - t990 * t2181 / 0.3e1 + t343 * t810 * t34 * t54 / 0.3e1 + t1225 * t1003 / 0.2e1 - 0.2e1 * t1228 * t2190;
  t2194 = t2177 * t464;
  t2200 = t2155 * t34;
  t2205 = t181 * t1040;
  t2210 = t986 * t184;
  t2211 = t2210 * t34;
  t2216 = t1769 * t42;
  t2233 = 0.1e1 / t45 / t1235;
  t2235 = t522 * t2233 * t38;
  t2237 = t42 * t69 * t57;
  t2242 = 0.74074074074074074075e-4 * t2164;
  t2243 = 0.87268518518518518517e1 * t842 * t1016 - 0.72723765432098765431e1 * t2235 * t2237 - 0.27925925925925925925e0 * t68 * t836 + t2242;
  t2245 = t1022 * t218;
  t2255 = t1026 * t231;
  t2258 = t373 * t870;
  t2262 = t1038 * t231;
  t2273 = t841 * t1293;
  t2276 = 0.54569444444444444443e-2 * t79 * t2210 * t82 - 0.21270078055555555554e-1 * t43 * t2155 * t227 + 0.26929416302728704629e0 * t68 * t866 - 0.25201001621684844509e-1 * t2273 * sigma[0] - t2242;
  t2278 = 0.2e1 * t1265 * t1026 - t537 * t1038 - 0.6e1 * t1272 * t2255 - 0.2e1 * t1878 * t373 + 0.4e1 * t1881 * t857 - t219 * t2276 + t2243 * t87 - t2245 * t231 + 0.4e1 * t542 * t2258 + 0.2e1 * t542 * t2262 - 0.2e1 * t854 * t870;
  t2280 = 0.2e1 * t502 * t2194 + t1832 * t352 - t507 * t1008 / 0.4e1 + t199 * t2200 / 0.3e1 - t507 * t1011 / 0.4e1 - 0.4e1 / 0.3e1 * t2205 * t201 - 0.4e1 / 0.3e1 * t833 * t827 + t199 * t2211 / 0.3e1 + 0.55081026238531777509e-1 * t460 * t206 * t464 * t2216 - 0.27540513119265888755e-1 * t181 * t206 * t34 * t2216 + 0.4e1 / 0.3e1 * t833 * t830 - 0.11353233942674573885e-5 * t1234 * t841 * sigma[0] - 0.8e1 / 0.3e1 * t1849 * t821 + t36 * t2278;
  t2281 = t2193 + t2280;
  t2286 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t1042 - t2146 - 0.3e1 / 0.8e1 * t5 * t27 * t2281);
  tv3rhosigma20 = t6 * t2286 + t1046;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2293 = t5 * t251 * t1109 / 0.8e1;
  t2295 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t1109 - t2293);
  tv3rhosigma25 = t6 * t2295 + t1113;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2301 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t1042 - t2146);
  tv3rhosigma26 = t6 * t2301 + t1046;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2310 = 0.1e1 / t117 / t720;
  t2314 = t1047 * t294;
  t2315 = t2314 * t691;
  t2318 = t920 * t126;
  t2323 = t68 * t305;
  t2326 = t1668 * t382;
  t2331 = t687 * t382;
  t2336 = t929 * t126;
  t2345 = t382 * t909;
  t2346 = t2345 * t1670;
  t2349 = t2345 * t691;
  t2352 = 0.45900855198776481256e-1 * t383 * t909 * t712 - 0.10075924978827462422e-2 * t281 * t2310 * t1734 - 0.2e1 / 0.3e1 * t729 * t2315 + 0.2e1 / 0.3e1 * t1048 * t2318 - t1054 * t285 / 0.3e1 + 0.13434566638436616562e-2 * t717 * t2323 + 0.2e1 * t2326 * t909 * t1670 * t126 - 0.2e1 * t2331 * t909 * t691 * t126 - t1057 * t2336 / 0.3e1 + t383 * t909 * t112 * t126 / 0.3e1 + t1699 * t1070 / 0.2e1 - 0.2e1 * t1669 * t2346 + 0.2e1 * t729 * t2349;
  t2354 = t2345 * t112;
  t2359 = t2314 * t112;
  t2364 = t280 * t1107;
  t2369 = t1053 * t283;
  t2370 = t2369 * t112;
  t2382 = t1986 * t42;
  t2392 = 0.1e1 / t117 / t1600;
  t2394 = t522 * t2392 * t38;
  t2396 = t42 * t137 * t129;
  t2401 = 0.74074074074074074075e-4 * t2323;
  t2402 = 0.87268518518518518517e1 * t941 * t1083 - 0.72723765432098765431e1 * t2394 * t2396 - 0.27925925925925925925e0 * t68 * t935 + t2401;
  t2404 = t1089 * t317;
  t2414 = t1093 * t330;
  t2417 = t413 * t969;
  t2421 = t1105 * t330;
  t2432 = t940 * t1650;
  t2435 = 0.54569444444444444443e-2 * t79 * t2369 * t148 - 0.21270078055555555554e-1 * t43 * t2314 * t326 + 0.26929416302728704629e0 * t68 * t965 - 0.25201001621684844509e-1 * t2432 * sigma[2] - t2401;
  t2437 = 0.2e1 * t1624 * t1093 - t762 * t1105 + t2402 * t153 - 0.6e1 * t1631 * t2414 - 0.2e1 * t2095 * t413 + 0.4e1 * t2098 * t956 - t2404 * t330 + 0.4e1 * t767 * t2417 + 0.2e1 * t767 * t2421 - t318 * t2435 - 0.2e1 * t953 * t969;
  t2439 = t2031 * t392 - t298 * t2354 / 0.3e1 - t734 * t1075 / 0.4e1 + t298 * t2359 / 0.3e1 - t734 * t1078 / 0.4e1 - 0.4e1 / 0.3e1 * t2364 * t300 - 0.4e1 / 0.3e1 * t932 * t926 + t298 * t2370 / 0.3e1 - 0.8e1 / 0.3e1 * t2043 * t920 + 0.4e1 / 0.3e1 * t932 * t929 - 0.11353233942674573885e-5 * t1739 * t940 * sigma[2] + 0.55081026238531777509e-1 * t687 * t305 * t691 * t2382 - 0.27540513119265888755e-1 * t280 * t305 * t112 * t2382 + t114 * t2437;
  t2440 = t2352 + t2439;
  t2445 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t1109 - t2293 - 0.3e1 / 0.8e1 * t5 * t105 * t2440);
  tv3rhosigma211 = t6 * t2445 + t1113;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2447 = 0.1e1 / t1167;
  t2448 = t2447 * t31;
  t2449 = t2448 * t34;
  t2452 = 0.1e1 / t69;
  t2453 = t2452 * t47;
  t2454 = t2453 * t464;
  t2459 = t460 * t2452;
  t2462 = t181 * t2447;
  t2466 = 0.1e1 / t45 / t526;
  t2467 = t522 * t2466;
  t2470 = t42 * t57 * sigma[0];
  t2475 = 0.27271412037037037037e1 * t2467 * t38 * t2470 - 0.19635416666666666667e1 * t1015 * t57;
  t2483 = t1026 * t373;
  t2486 = t373 * t1038;
  t2501 = 0.61390624999999999998e-2 * t79 * t2448 * t82 - 0.23928837812499999999e-1 * t43 * t2453 * t227 - 0.20197062227046528471e-1 * t68 * t980 * t73 * t553 + 0.94503756081318166912e-2 * t1014 * t1293;
  t2503 = 0.6e1 * t1881 * t1026 - 0.3e1 * t854 * t1038 - 0.6e1 * t1272 * t2483 - t219 * t2501 - 0.3e1 * t2245 * t373 + t2475 * t87 + 0.6e1 * t542 * t2486;
  t2505 = t986 * t995;
  t2506 = t2505 * t34;
  t2511 = t2453 * t34;
  t2516 = t2505 * t1206;
  t2519 = 0.3e1 / 0.8e1 * t199 * t2449 - 0.3e1 / 0.4e1 * t502 * t2454 - 0.3e1 / 0.4e1 * t833 * t1008 + 0.3e1 / 0.4e1 * t2459 * t983 - 0.3e1 / 0.8e1 * t2462 * t345 + t36 * t2503 + t199 * t2506 / 0.8e1 - 0.3e1 / 0.4e1 * t833 * t1011 + 0.3e1 / 0.8e1 * t199 * t2511 + 0.3e1 / 0.2e1 * t1849 * t1003 + 0.3e1 / 0.4e1 * t1228 * t2516;
  t2520 = t2505 * t464;
  t2525 = t1204 * t986;
  t2527 = t995 * t1206 * t54;
  t2530 = t460 * t986;
  t2532 = t995 * t464 * t54;
  t2535 = t181 * t2452;
  t2539 = t995 * t34 * t54;
  t2543 = 0.1e1 / t45 / t204;
  t2558 = -0.3e1 / 0.4e1 * t502 * t2520 + 0.3e1 / 0.2e1 * t2205 * t352 - 0.3e1 / 0.4e1 * t2525 * t2527 + 0.3e1 / 0.4e1 * t2530 * t2532 - 0.3e1 / 0.8e1 * t2535 * t992 - t987 * t2539 / 0.8e1 + 0.37784718670602984081e-3 * t343 * t2543 * t1173 - 0.20655384839449416566e-1 * t981 * t73 * t1319 + 0.10327692419724708283e-1 * t987 * t995 * t485 + 0.10327692419724708283e-1 * t990 * t73 * t485 + 0.42574627285029652067e-6 * t1234 * t1014;
  t2559 = t2519 + t2558;
  t2563 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2559);
  tv3sigma30 = t6 * t2563;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2565 = 0.1e1 / t117 / t751;
  t2566 = t522 * t2565;
  t2569 = t42 * t129 * sigma[2];
  t2574 = 0.27271412037037037037e1 * t2566 * t38 * t2569 - 0.19635416666666666667e1 * t1082 * t129;
  t2582 = t1093 * t413;
  t2585 = t413 * t1105;
  t2588 = 0.1e1 / t1728;
  t2589 = t2588 * t109;
  t2593 = 0.1e1 / t137;
  t2594 = t2593 * t119;
  t2604 = 0.61390624999999999998e-2 * t79 * t2589 * t148 - 0.23928837812499999999e-1 * t43 * t2594 * t326 - 0.20197062227046528471e-1 * t68 * t1047 * t141 * t778 + 0.94503756081318166912e-2 * t1081 * t1650;
  t2606 = 0.6e1 * t2098 * t1093 - 0.3e1 * t953 * t1105 + t2574 * t153 - 0.6e1 * t1631 * t2582 - 0.3e1 * t2404 * t413 + 0.6e1 * t767 * t2585 - t318 * t2604;
  t2610 = t2589 * t112;
  t2613 = t2594 * t691;
  t2616 = t687 * t2593;
  t2619 = t280 * t2588;
  t2624 = t1053 * t1062;
  t2625 = t2624 * t112;
  t2630 = t2594 * t112;
  t2635 = t114 * t2606 - 0.3e1 / 0.4e1 * t932 * t1075 + 0.3e1 / 0.8e1 * t298 * t2610 - 0.3e1 / 0.4e1 * t729 * t2613 + 0.3e1 / 0.4e1 * t2616 * t1050 - 0.3e1 / 0.8e1 * t2619 * t385 + 0.42574627285029652067e-6 * t1739 * t1081 + t298 * t2625 / 0.8e1 - 0.3e1 / 0.4e1 * t932 * t1078 + 0.3e1 / 0.8e1 * t298 * t2630 + 0.3e1 / 0.2e1 * t2043 * t1070;
  t2636 = t2624 * t1670;
  t2639 = t2624 * t691;
  t2644 = t1668 * t1053;
  t2646 = t1062 * t1670 * t126;
  t2649 = t687 * t1053;
  t2651 = t1062 * t691 * t126;
  t2654 = t280 * t2593;
  t2658 = t1062 * t112 * t126;
  t2671 = 0.1e1 / t117 / t303;
  t2675 = 0.3e1 / 0.4e1 * t1669 * t2636 - 0.3e1 / 0.4e1 * t729 * t2639 + 0.3e1 / 0.2e1 * t2364 * t392 - 0.3e1 / 0.4e1 * t2644 * t2646 + 0.3e1 / 0.4e1 * t2649 * t2651 - 0.3e1 / 0.8e1 * t2654 * t1059 - t1054 * t2658 / 0.8e1 - 0.20655384839449416566e-1 * t1048 * t141 * t1718 + 0.10327692419724708283e-1 * t1054 * t1062 * t712 + 0.10327692419724708283e-1 * t1057 * t141 * t712 + 0.37784718670602984081e-3 * t383 * t2671 * t1734;
  t2676 = t2635 + t2675;
  t2680 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t2676);
  tv3sigma39 = t6 * t2680;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t44, t45, t47, t49, t51, t54;
  double t57, t60, t61, t65, t67, t68, t69, t70;
  double t71, t73, t76, t77, t79, t82, t86, t87;
  double t89, t91, t95, t96, t97, t99, t100, t101;
  double t102, t104, t105, t106, t107, t109, t110, t112;
  double t113, t114, t115, t116, t117, t119, t121, t123;
  double t126, t129, t132, t133, t137, t138, t139, t141;
  double t144, t145, t148, t152, t153, t155, t157, t161;
  double tzk0;

  double t162, t163, t164, t166, t169, t170, t174, t175;
  double t176, t179, t180, t181, t182, t184, t186, t189;
  double t190, t191, t192, t193, t195, t196, t199, t200;
  double t201, t204, t206, t207, t214, t215, t217, t218;
  double t219, t225, t226, t227, t231, t233, t235, t240;
  double t241, t243, t246, t247, t251, t254, t256, tvrho0;
  double t260, t263, t264, t269, t271, t274, t275, t279;
  double t280, t281, t283, t285, t288, t289, t290, t291;
  double t292, t294, t295, t298, t299, t300, t303, t305;
  double t306, t313, t314, t316, t317, t318, t324, t325;
  double t326, t330, t332, t334, t339, tvrho1, t342, t343;
  double t345, t351, t352, t355, t364, t365, t373, t375;
  double t377, t381, tvsigma0, tvsigma1, t382, t383, t385, t391;
  double t392, t395, t404, t405, t413, t415, t417, t421;
  double tvsigma2;

  double t424, t425, t426, t429, t430, t431, t434, t438;
  double t439, t443, t445, t451, t452, t455, t457, t460;
  double t461, t463, t464, t465, t466, t470, t472, t475;
  double t476, t477, t480, t481, t482, t485, t489, t490;
  double t491, t492, t493, t495, t499, t502, t503, t504;
  double t507, t510, t511, t514, t517, t521, t522, t523;
  double t524, t525, t526, t527, t534, t535, t537, t541;
  double t542, t543, t553, t557, t559, t561, t566, t567;
  double t568, t569, t572, t575, t579, t580, t584, t586;
  double t588, t591, t593, tv2rho20, t596, t600, t604, t605;
  double t609, t611, t619, t620, t624, t628, t629, t633;
  double t635, t642, t645, tv2rho21, t650, t655, t659, t660;
  double t666, t667, t672, t676, t677, t687, t688, t690;
  double t691, t692, t693, t697, t699, t702, t703, t704;
  double t707, t708, t709, t712, t716, t717, t718, t719;
  double t720, t722, t726, t729, t730, t731, t734, t737;
  double t738, t741, t744, t748, t749, t750, t751, t752;
  double t759, t760, t762, t766, t767, t768, t778, t782;
  double t784, t786, t791, tv2rho22, t799, t801, t807, t810;
  double t821, t826, t827, t830, t833, t836, t840, t841;
  double t842, t843, t851, t852, t854, t857, t866, t870;
  double t872, t874, t879, tv2rhosigma0, tv2rhosigma1, t886, t888, tv2rhosigma2;
  double t894, tv2rhosigma3, tv2rhosigma4, t900, t906, t909, t920, t925;
  double t926, t929, t932, t935, t939, t940, t941, t942;
  double t950, t951, t953, t956, t965, t969, t971, t973;
  double t978, tv2rhosigma5, t980, t981, t983, t986, t987, t990;
  double t992, t995, t999, t1002, t1003, t1007, t1008, t1011;
  double t1014, t1015, t1016, t1021, t1022, t1026, t1038, t1040;
  double t1042, t1046, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1047;
  double t1048, t1050, t1053, t1054, t1057, t1059, t1062, t1066;
  double t1069, t1070, t1074, t1075, t1078, t1081, t1082, t1083;
  double t1088, t1089, t1093, t1105, t1107, t1109, t1113, tv2sigma25;

  double t1117, t1118, t1121, t1124, t1125, t1126, t1129, t1133;
  double t1134, t1138, t1140, t1145, t1147, t1150, t1156, t1157;
  double t1160, t1162, t1165, t1167, t1168, t1170, t1173, t1177;
  double t1182, t1183, t1188, t1189, t1192, t1193, t1194, t1197;
  double t1200, t1203, t1204, t1205, t1206, t1207, t1211, t1212;
  double t1216, t1224, t1225, t1228, t1229, t1232, t1233, t1234;
  double t1235, t1236, t1237, t1240, t1247, t1248, t1249, t1251;
  double t1253, t1259, t1260, t1262, t1265, t1270, t1271, t1272;
  double t1273, t1276, t1280, t1281, t1291, t1293, t1296, t1298;
  double t1300, t1306, t1309, t1312, t1316, t1319, t1325, t1329;
  double t1330, t1335, t1337, t1338, t1341, t1344, t1347, t1351;
  double t1352, t1356, t1358, t1360, t1362, t1364, t1367, t1369;
  double tv3rho30, t1372, t1373, t1374, t1377, t1382, t1383, t1385;
  double t1389, t1390, t1394, t1397, t1401, t1403, t1407, t1416;
  double t1417, t1418, t1421, t1426, t1428, t1432, t1433, t1437;
  double t1440, t1441, t1443, t1452, t1454, t1457, tv3rho31, t1460;
  double t1465, t1469, t1473, t1474, t1478, t1480, t1489, t1490;
  double t1495, t1499, t1503, t1504, t1508, t1510, t1517, t1525;
  double t1527, t1528, tv3rho32, t1533, t1540, t1544, t1545, t1552;
  double t1553, t1560, t1564, t1565, t1583, t1584, t1585, t1589;
  double t1590, t1591, t1595, t1596, t1600, t1601, t1605, t1606;
  double t1607, t1609, t1611, t1614, t1618, t1619, t1621, t1624;
  double t1629, t1630, t1631, t1632, t1635, t1647, t1648, t1650;
  double t1653, t1655, t1657, t1658, t1659, t1664, t1667, t1668;
  double t1669, t1670, t1671, t1674, t1677, t1680, t1681, t1685;
  double t1686, t1690, t1691, t1699, t1702, t1707, t1715, t1718;
  double t1724, t1728, t1729, t1731, t1734, t1737, t1738, t1739;
  double t1742, t1743, t1748, tv3rho33, t1756, t1763, t1765, t1767;
  double t1768, t1769, t1770, t1776, t1777, t1781, t1806, t1807;
  double t1810, t1819, t1820, t1824, t1829, t1832, t1835, t1836;
  double t1839, t1840, t1846, t1849, t1856, t1860, t1863, t1865;
  double t1866, t1875, t1876, t1878, t1881, t1890, t1893, t1896;
  double t1905, t1909, t1912, t1914, t1916, t1917, t1922, tv3rho2sigma0;
  double tv3rho2sigma1, t1929, t1933, t1935, tv3rho2sigma2, t1941, t1949, tv3rho2sigma3;
  double tv3rho2sigma4, t1955, t1962, t1965, tv3rho2sigma5, t1973, tv3rho2sigma6, tv3rho2sigma7;
  double t1984, t1985, t1986, t1987, t1993, t1994, t1998, t2004;
  double t2005, t2016, t2017, t2021, t2026, t2031, t2034, t2035;
  double t2036, t2039, t2040, t2043, t2049, t2073, t2077, t2080;
  double t2082, t2083, t2092, t2093, t2095, t2098, t2107, t2110;
  double t2113, t2122, t2126, t2129, t2131, t2133, t2134, t2139;
  double tv3rho2sigma8, t2146, t2151, t2155, t2156, t2159, t2164, t2167;
  double t2172, t2177, t2178, t2181, t2190, t2193, t2194, t2200;
  double t2205, t2210, t2211, t2216, t2233, t2235, t2237, t2242;
  double t2243, t2245, t2255, t2258, t2262, t2273, t2276, t2278;
  double t2280, t2281, t2286, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24;
  double t2293, t2295, tv3rhosigma25, t2301, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t2310, t2314, t2315, t2318, t2323, t2326, t2331;
  double t2336, t2345, t2346, t2349, t2352, t2354, t2359, t2364;
  double t2369, t2370, t2382, t2392, t2394, t2396, t2401, t2402;
  double t2404, t2414, t2417, t2421, t2432, t2435, t2437, t2439;
  double t2440, t2445, tv3rhosigma211, t2447, t2448, t2449, t2452, t2453;
  double t2454, t2459, t2462, t2466, t2467, t2470, t2475, t2483;
  double t2486, t2501, t2503, t2505, t2506, t2511, t2516, t2519;
  double t2520, t2525, t2527, t2530, t2532, t2535, t2539, t2543;
  double t2558, t2559, t2563, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34;
  double tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2565, t2566, t2569, t2574;
  double t2582, t2585, t2588, t2589, t2593, t2594, t2604, t2606;
  double t2610, t2613, t2616, t2619, t2624, t2625, t2630, t2635;
  double t2636, t2639, t2644, t2646, t2649, t2651, t2654, t2658;
  double t2671, t2675, t2676, t2680, tv3sigma39;

  double t2684, t2688, t2694, t2710, t2713, t2724, t2725, t2729;
  double t2732, t2745, t2759, t2765, t2770, t2779, t2782, t2786;
  double t2788, t2809, t2810, t2813, t2817, t2822, t2825, t2841;
  double t2846, t2848, t2850, t2866, t2871, t2877, t2880, t2883;
  double t2888, t2897, t2898, t2904, t2924, t2931, t2933, t2940;
  double t2943, t2946, t2952, t2954, t2957, t2961, t2964, t2968;
  double t2972, t2975, t2980, t2982, t2983, t2989, t2995, t2996;
  double t2999, t3003, t3011, t3012, t3013, t3015, t3016, t3022;
  double t3027, t3030, t3034, t3041, t3045, t3049, t3054, t3056;
  double tv4rho40, t3063, t3067, t3068, t3073, t3074, t3076, t3079;
  double t3100, t3101, t3103, t3107, t3117, t3128, t3129, t3146;
  double t3148, t3152, t3159, t3163, t3164, t3167, t3176, t3179;
  double t3180, t3182, t3184, t3185, tv4rho41, t3194, t3198, t3201;
  double t3214, t3227, t3231, t3250, t3251, t3260, t3273, t3277;
  double t3284, t3288, t3297, t3300, t3311, t3314, t3316, t3317;
  double tv4rho42, t3338, t3342, t3349, t3360, t3361, t3378, t3382;
  double t3389, t3397, t3406, t3416, t3418, t3419, tv4rho43, t3424;
  double t3429, t3436, t3440, t3449, t3450, t3451, t3454, t3467;
  double t3475, t3486, t3494, t3501, t3502, t3512, t3520, t3523;
  double t3526, t3527, t3528, t3537, t3554, t3557, t3566, t3573;
  double t3576, t3584, t3594, t3607, t3609, t3611, t3616, t3633;
  double t3638, t3644, t3647, t3650, t3655, t3664, t3665, t3671;
  double t3691, t3698, t3700, t3712, t3717, t3724, t3728, t3744;
  double t3745, tv4rho44, t3753, t3759, t3762, t3769, t3771, t3774;
  double t3782, t3798, t3803, t3804, t3813, t3817, t3821, t3825;
  double t3837, t3874, t3881, t3908, t3910, t3962, t3965, t3976;
  double t3981, t4000, t4024, t4027, t4034, t4037, t4044, tv4rho3sigma0;
  double tv4rho3sigma1, t4051, t4054, t4058, t4060, tv4rho3sigma2, t4062, t4068;
  double t4073, t4077, t4086, t4087, tv4rho3sigma3, tv4rho3sigma4, t4089, t4095;
  double t4097, t4106, t4108, t4111, tv4rho3sigma5, t4117, t4126, tv4rho3sigma6;
  double tv4rho3sigma7, t4132, t4139, t4147, t4149, t4150, tv4rho3sigma8, t4159;
  double tv4rho3sigma9, tv4rho3sigma10, t4176, t4182, t4183, t4186, t4196, t4203;
  double t4220, t4234, t4237, t4242, t4251, t4258, t4297, t4318;
  double t4331, t4339, t4375, t4402, t4424, t4427, t4434, t4437;
  double t4444, tv4rho3sigma11, t4451, t4458, t4460, t4464, t4470, t4494;
  double t4495, t4525, t4531, t4534, t4545, t4552, t4562, t4570;
  double t4594, t4605, t4632, t4643, t4667, t4690, t4693, t4713;
  double t4720, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t4727, t4731;
  double t4733, tv4rho2sigma25, t4739, t4747, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29;
  double tv4rho2sigma210, t4753, t4760, t4763, tv4rho2sigma211, t4771, tv4rho2sigma212, tv4rho2sigma213;
  double tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t4784, t4820, t4827, t4836, t4845;
  double t4852, t4856, t4866, t4894, t4898, t4945, t4946, t4949;
  double t4977, t4980, t5004, t5015, t5029, t5036, tv4rho2sigma217, t5043;
  double t5046, t5054, t5072, t5073, t5079, t5084, t5102, t5144;
  double t5149, t5162, t5186, t5245, t5248, t5255, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t5262;
  double t5264, tv4rhosigma39, t5270, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314;
  double tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t5279, t5286, t5304, t5308;
  double t5333, t5356, t5368, t5384, t5439, t5444, t5456, t5469;
  double t5479, t5486, tv4rhosigma319, t5490, t5507, t5511, t5521, t5546;
  double t5579, t5584, t5610, t5616, t5639, t5650, t5667, t5673;
  double tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47;
  double tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t5674, t5675;
  double t5679, t5708, t5714, t5723, t5727, t5739, t5744, t5768;
  double t5788, t5853, t5859, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = sqrt(sigma[0]);
  t29 = POW_1_3(rho[0]);
  t31 = 0.1e1 / t29 / rho[0];
  t32 = t28 * t31;
  t34 = exp(-t32 + 0.19e2);
  t35 = 0.1e1 + t34;
  t36 = 0.1e1 / t35;
  t37 = 0.1e1 - t36;
  t38 = M_CBRT6;
  t39 = M_PI * M_PI;
  t40 = POW_1_3(t39);
  t41 = t40 * t40;
  t42 = 0.1e1 / t41;
  t43 = t38 * t42;
  t44 = rho[0] * rho[0];
  t45 = t29 * t29;
  t47 = 0.1e1 / t45 / t44;
  t49 = t43 * sigma[0] * t47;
  t51 = 0.1227e1 + 0.91464571985215458336e-2 * t49;
  t54 = 0.2227e1 - 0.1505529e1 / t51;
  t57 = exp(-0.25e2 / 0.6e1 * t49);
  t60 = (0.2743e0 - 0.1508e0 * t57) * t38;
  t61 = t42 * sigma[0];
  t65 = t38 * t38;
  t67 = 0.1e1 / t40 / t39;
  t68 = t65 * t67;
  t69 = sigma[0] * sigma[0];
  t70 = t44 * t44;
  t71 = t70 * rho[0];
  t73 = 0.1e1 / t29 / t71;
  t76 = 0.69444444444444444444e-5 * t68 * t69 * t73;
  t77 = t60 * t61 * t47 / 0.24e2 - t76;
  t79 = t65 / t40;
  t82 = log(0.64963333333333333333e0 * t79 * t32 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t32) + 0.1e1));
  t86 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t32 * t82 + t76;
  t87 = 0.1e1 / t86;
  t89 = t77 * t87 + 0.1e1;
  t91 = t36 * t89 + t37 * t54;
  t95 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t91);
  t96 = rho[1] <= p->dens_threshold;
  t97 = -t16;
  t99 = my_piecewise5(t14, t11, t10, t15, t97 * t7);
  t100 = 0.1e1 + t99;
  t101 = t100 <= p->zeta_threshold;
  t102 = POW_1_3(t100);
  t104 = my_piecewise3(t101, t22, t102 * t100);
  t105 = t104 * t26;
  t106 = sqrt(sigma[2]);
  t107 = POW_1_3(rho[1]);
  t109 = 0.1e1 / t107 / rho[1];
  t110 = t106 * t109;
  t112 = exp(-t110 + 0.19e2);
  t113 = 0.1e1 + t112;
  t114 = 0.1e1 / t113;
  t115 = 0.1e1 - t114;
  t116 = rho[1] * rho[1];
  t117 = t107 * t107;
  t119 = 0.1e1 / t117 / t116;
  t121 = t43 * sigma[2] * t119;
  t123 = 0.1227e1 + 0.91464571985215458336e-2 * t121;
  t126 = 0.2227e1 - 0.1505529e1 / t123;
  t129 = exp(-0.25e2 / 0.6e1 * t121);
  t132 = (0.2743e0 - 0.1508e0 * t129) * t38;
  t133 = t42 * sigma[2];
  t137 = sigma[2] * sigma[2];
  t138 = t116 * t116;
  t139 = t138 * rho[1];
  t141 = 0.1e1 / t107 / t139;
  t144 = 0.69444444444444444444e-5 * t68 * t137 * t141;
  t145 = t132 * t133 * t119 / 0.24e2 - t144;
  t148 = log(0.64963333333333333333e0 * t79 * t110 + sqrt(POW_2(0.64963333333333333333e0 * t79 * t110) + 0.1e1));
  t152 = 0.1e1 + 0.16370833333333333333e-1 * t79 * t110 * t148 + t144;
  t153 = 0.1e1 / t152;
  t155 = t145 * t153 + 0.1e1;
  t157 = t114 * t155 + t115 * t126;
  t161 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t157);
  tzk0 = t95 + t161;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t162 = t6 * t6;
  t163 = 0.1e1 / t162;
  t164 = t16 * t163;
  t166 = my_piecewise5(t10, 0, t14, 0, t7 - t164);
  t169 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t166);
  t170 = t169 * t26;
  t174 = t26 * t26;
  t175 = 0.1e1 / t174;
  t176 = t25 * t175;
  t179 = t5 * t176 * t91 / 0.8e1;
  t180 = t35 * t35;
  t181 = 0.1e1 / t180;
  t182 = t181 * t28;
  t184 = 0.1e1 / t29 / t44;
  t186 = t184 * t34 * t54;
  t189 = t51 * t51;
  t190 = 0.1e1 / t189;
  t191 = t37 * t190;
  t192 = t191 * t38;
  t193 = t44 * rho[0];
  t195 = 0.1e1 / t45 / t193;
  t196 = t61 * t195;
  t199 = t181 * t89;
  t200 = t28 * t184;
  t201 = t200 * t34;
  t204 = t70 * t44;
  t206 = 0.1e1 / t29 / t204;
  t207 = t69 * t206;
  t214 = 0.37037037037037037037e-4 * t68 * t207;
  t215 = -0.69814814814814814817e-1 * t68 * t207 * t57 - t60 * t196 / 0.9e1 + t214;
  t217 = t86 * t86;
  t218 = 0.1e1 / t217;
  t219 = t77 * t218;
  t225 = 0.25321408066666666666e1 * t49 + 0.1e1;
  t226 = sqrt(t225);
  t227 = 0.1e1 / t226;
  t231 = -0.21827777777777777777e-1 * t79 * t200 * t82 - 0.85080312222222222219e-1 * t43 * sigma[0] * t195 * t227 - t214;
  t233 = t215 * t87 - t219 * t231;
  t235 = 0.4e1 / 0.3e1 * t182 * t186 - 0.36720684159021185007e-1 * t192 * t196 - 0.4e1 / 0.3e1 * t199 * t201 + t36 * t233;
  t240 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t91 - t179 - 0.3e1 / 0.8e1 * t5 * t27 * t235);
  t241 = t97 * t163;
  t243 = my_piecewise5(t14, 0, t10, 0, -t7 - t241);
  t246 = my_piecewise3(t101, 0, 0.4e1 / 0.3e1 * t102 * t243);
  t247 = t246 * t26;
  t251 = t104 * t175;
  t254 = t5 * t251 * t157 / 0.8e1;
  t256 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t157 - t254);
  tvrho0 = t95 + t161 + t6 * (t240 + t256);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t260 = my_piecewise5(t10, 0, t14, 0, -t7 - t164);
  t263 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t260);
  t264 = t263 * t26;
  t269 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t91 - t179);
  t271 = my_piecewise5(t14, 0, t10, 0, t7 - t241);
  t274 = my_piecewise3(t101, 0, 0.4e1 / 0.3e1 * t102 * t271);
  t275 = t274 * t26;
  t279 = t113 * t113;
  t280 = 0.1e1 / t279;
  t281 = t280 * t106;
  t283 = 0.1e1 / t107 / t116;
  t285 = t283 * t112 * t126;
  t288 = t123 * t123;
  t289 = 0.1e1 / t288;
  t290 = t115 * t289;
  t291 = t290 * t38;
  t292 = t116 * rho[1];
  t294 = 0.1e1 / t117 / t292;
  t295 = t133 * t294;
  t298 = t280 * t155;
  t299 = t106 * t283;
  t300 = t299 * t112;
  t303 = t138 * t116;
  t305 = 0.1e1 / t107 / t303;
  t306 = t137 * t305;
  t313 = 0.37037037037037037037e-4 * t68 * t306;
  t314 = -0.69814814814814814817e-1 * t68 * t306 * t129 - t132 * t295 / 0.9e1 + t313;
  t316 = t152 * t152;
  t317 = 0.1e1 / t316;
  t318 = t145 * t317;
  t324 = 0.25321408066666666666e1 * t121 + 0.1e1;
  t325 = sqrt(t324);
  t326 = 0.1e1 / t325;
  t330 = -0.21827777777777777777e-1 * t79 * t299 * t148 - 0.85080312222222222219e-1 * t43 * sigma[2] * t294 * t326 - t313;
  t332 = t314 * t153 - t318 * t330;
  t334 = 0.4e1 / 0.3e1 * t281 * t285 - 0.36720684159021185007e-1 * t291 * t295 - 0.4e1 / 0.3e1 * t298 * t300 + t114 * t332;
  t339 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t157 - t254 - 0.3e1 / 0.8e1 * t5 * t105 * t334);
  tvrho1 = t95 + t161 + t6 * (t269 + t339);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t342 = 0.1e1 / t28;
  t343 = t181 * t342;
  t345 = t31 * t34 * t54;
  t351 = t342 * t31;
  t352 = t351 * t34;
  t355 = t73 * t57;
  t364 = 0.13888888888888888889e-4 * t68 * sigma[0] * t73;
  t365 = 0.26180555555555555555e-1 * t68 * t355 * sigma[0] + t60 * t42 * t47 / 0.24e2 - t364;
  t373 = 0.81854166666666666665e-2 * t79 * t351 * t82 + 0.31905117083333333333e-1 * t43 * t47 * t227 + t364;
  t375 = -t219 * t373 + t365 * t87;
  t377 = -t343 * t345 / 0.2e1 + 0.13770256559632944377e-1 * t191 * t43 * t47 + t199 * t352 / 0.2e1 + t36 * t375;
  t381 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t377);
  tvsigma0 = t6 * t381;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t382 = 0.1e1 / t106;
  t383 = t280 * t382;
  t385 = t109 * t112 * t126;
  t391 = t382 * t109;
  t392 = t391 * t112;
  t395 = t141 * t129;
  t404 = 0.13888888888888888889e-4 * t68 * sigma[2] * t141;
  t405 = 0.26180555555555555555e-1 * t68 * t395 * sigma[2] + t132 * t42 * t119 / 0.24e2 - t404;
  t413 = 0.81854166666666666665e-2 * t79 * t391 * t148 + 0.31905117083333333333e-1 * t43 * t119 * t326 + t404;
  t415 = t405 * t153 - t318 * t413;
  t417 = -t383 * t385 / 0.2e1 + 0.13770256559632944377e-1 * t290 * t43 * t119 + t298 * t392 / 0.2e1 + t114 * t415;
  t421 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t417);
  tvsigma2 = t6 * t421;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t424 = t23 * t23;
  t425 = 0.1e1 / t424;
  t426 = t166 * t166;
  t429 = t162 * t6;
  t430 = 0.1e1 / t429;
  t431 = t16 * t430;
  t434 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t163 + 0.2e1 * t431);
  t438 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t425 * t426 + 0.4e1 / 0.3e1 * t23 * t434);
  t439 = t438 * t26;
  t443 = t169 * t175;
  t445 = t5 * t443 * t91;
  t451 = 0.1e1 / t174 / t6;
  t452 = t25 * t451;
  t455 = t5 * t452 * t91 / 0.12e2;
  t457 = t5 * t176 * t235;
  t460 = 0.1e1 / t180 / t35;
  t461 = t460 * sigma[0];
  t463 = 0.1e1 / t45 / t70;
  t464 = t34 * t34;
  t465 = t463 * t464;
  t466 = t465 * t54;
  t470 = 0.1e1 / t29 / t193;
  t472 = t470 * t34 * t54;
  t475 = t181 * sigma[0];
  t476 = t463 * t34;
  t477 = t476 * t54;
  t480 = t28 * sigma[0];
  t481 = t181 * t480;
  t482 = 0.1e1 / t204;
  t485 = t34 * t190 * t43;
  t489 = 0.1e1 / t189 / t51;
  t490 = t37 * t489;
  t491 = t490 * t65;
  t492 = t67 * t69;
  t493 = t70 * t193;
  t495 = 0.1e1 / t29 / t493;
  t499 = t61 * t463;
  t502 = t460 * t89;
  t503 = sigma[0] * t463;
  t504 = t503 * t464;
  t507 = t181 * t233;
  t510 = t28 * t470;
  t511 = t510 * t34;
  t514 = t503 * t34;
  t517 = t69 * t495;
  t521 = t39 * t39;
  t522 = 0.1e1 / t521;
  t523 = t69 * sigma[0];
  t524 = t522 * t523;
  t525 = t70 * t70;
  t526 = t525 * t44;
  t527 = 0.1e1 / t526;
  t534 = 0.23456790123456790123e-3 * t68 * t517;
  t535 = 0.62833333333333333335e0 * t68 * t517 * t57 - 0.46543209876543209878e1 * t524 * t527 * t57 + 0.11e2 / 0.27e2 * t60 * t499 - t534;
  t537 = t215 * t218;
  t541 = 0.1e1 / t217 / t86;
  t542 = t77 * t541;
  t543 = t231 * t231;
  t553 = 0.1e1 / t226 / t225;
  t557 = 0.5093148148148148148e-1 * t79 * t510 * t82 + 0.42540156111111111109e0 * t43 * t503 * t227 - 0.2872471072291061827e0 * t68 * t517 * t553 + t534;
  t559 = -t219 * t557 - 0.2e1 * t537 * t231 + t535 * t87 + 0.2e1 * t542 * t543;
  t561 = -0.32e2 / 0.9e1 * t461 * t466 - 0.28e2 / 0.9e1 * t182 * t472 + 0.16e2 / 0.9e1 * t475 * t477 - 0.97921824424056493352e-1 * t481 * t482 * t485 - 0.17912755517915488751e-2 * t491 * t492 * t495 + 0.13464250858307767836e0 * t192 * t499 + 0.32e2 / 0.9e1 * t502 * t504 - 0.8e1 / 0.3e1 * t507 * t201 + 0.28e2 / 0.9e1 * t199 * t511 - 0.16e2 / 0.9e1 * t199 * t514 + t36 * t559;
  t566 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t439 * t91 - t445 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t170 * t235 + t455 - t457 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t561);
  t567 = t102 * t102;
  t568 = 0.1e1 / t567;
  t569 = t243 * t243;
  t572 = t97 * t430;
  t575 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t163 + 0.2e1 * t572);
  t579 = my_piecewise3(t101, 0, 0.4e1 / 0.9e1 * t568 * t569 + 0.4e1 / 0.3e1 * t102 * t575);
  t580 = t579 * t26;
  t584 = t246 * t175;
  t586 = t5 * t584 * t157;
  t588 = t104 * t451;
  t591 = t5 * t588 * t157 / 0.12e2;
  t593 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t580 * t157 - t586 / 0.4e1 + t591);
  tv2rho20 = 0.2e1 * t240 + 0.2e1 * t256 + t6 * (t566 + t593);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t596 = t425 * t260;
  t600 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t431);
  t604 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t596 * t166 + 0.4e1 / 0.3e1 * t23 * t600);
  t605 = t604 * t26;
  t609 = t263 * t175;
  t611 = t5 * t609 * t91;
  t619 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t91 - t611 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t264 * t235 - t445 / 0.8e1 + t455 - t457 / 0.8e1);
  t620 = t568 * t271;
  t624 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t572);
  t628 = my_piecewise3(t101, 0, 0.4e1 / 0.9e1 * t620 * t243 + 0.4e1 / 0.3e1 * t102 * t624);
  t629 = t628 * t26;
  t633 = t274 * t175;
  t635 = t5 * t633 * t157;
  t642 = t5 * t251 * t334;
  t645 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t629 * t157 - t635 / 0.8e1 - t586 / 0.8e1 + t591 - 0.3e1 / 0.8e1 * t5 * t247 * t334 - t642 / 0.8e1);
  tv2rho21 = t240 + t256 + t269 + t339 + t6 * (t619 + t645);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t650 = t260 * t260;
  t655 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t163 + 0.2e1 * t431);
  t659 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t425 * t650 + 0.4e1 / 0.3e1 * t23 * t655);
  t660 = t659 * t26;
  t666 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t660 * t91 - t611 / 0.4e1 + t455);
  t667 = t271 * t271;
  t672 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t163 + 0.2e1 * t572);
  t676 = my_piecewise3(t101, 0, 0.4e1 / 0.9e1 * t568 * t667 + 0.4e1 / 0.3e1 * t102 * t672);
  t677 = t676 * t26;
  t687 = 0.1e1 / t279 / t113;
  t688 = t687 * sigma[2];
  t690 = 0.1e1 / t117 / t138;
  t691 = t112 * t112;
  t692 = t690 * t691;
  t693 = t692 * t126;
  t697 = 0.1e1 / t107 / t292;
  t699 = t697 * t112 * t126;
  t702 = t280 * sigma[2];
  t703 = t690 * t112;
  t704 = t703 * t126;
  t707 = t106 * sigma[2];
  t708 = t280 * t707;
  t709 = 0.1e1 / t303;
  t712 = t112 * t289 * t43;
  t716 = 0.1e1 / t288 / t123;
  t717 = t115 * t716;
  t718 = t717 * t65;
  t719 = t67 * t137;
  t720 = t138 * t292;
  t722 = 0.1e1 / t107 / t720;
  t726 = t133 * t690;
  t729 = t687 * t155;
  t730 = sigma[2] * t690;
  t731 = t730 * t691;
  t734 = t280 * t332;
  t737 = t106 * t697;
  t738 = t737 * t112;
  t741 = t730 * t112;
  t744 = t137 * t722;
  t748 = t137 * sigma[2];
  t749 = t522 * t748;
  t750 = t138 * t138;
  t751 = t750 * t116;
  t752 = 0.1e1 / t751;
  t759 = 0.23456790123456790123e-3 * t68 * t744;
  t760 = 0.62833333333333333335e0 * t68 * t744 * t129 - 0.46543209876543209878e1 * t749 * t752 * t129 + 0.11e2 / 0.27e2 * t132 * t726 - t759;
  t762 = t314 * t317;
  t766 = 0.1e1 / t316 / t152;
  t767 = t145 * t766;
  t768 = t330 * t330;
  t778 = 0.1e1 / t325 / t324;
  t782 = 0.5093148148148148148e-1 * t79 * t737 * t148 + 0.42540156111111111109e0 * t43 * t730 * t326 - 0.2872471072291061827e0 * t68 * t744 * t778 + t759;
  t784 = t760 * t153 - t318 * t782 - 0.2e1 * t762 * t330 + 0.2e1 * t767 * t768;
  t786 = -0.32e2 / 0.9e1 * t688 * t693 - 0.28e2 / 0.9e1 * t281 * t699 + 0.16e2 / 0.9e1 * t702 * t704 - 0.97921824424056493352e-1 * t708 * t709 * t712 - 0.17912755517915488751e-2 * t718 * t719 * t722 + 0.13464250858307767836e0 * t291 * t726 + 0.32e2 / 0.9e1 * t729 * t731 - 0.8e1 / 0.3e1 * t734 * t300 + 0.28e2 / 0.9e1 * t298 * t738 - 0.16e2 / 0.9e1 * t298 * t741 + t114 * t784;
  t791 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t677 * t157 - t635 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t275 * t334 + t591 - t642 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t105 * t786);
  tv2rho22 = 0.2e1 * t269 + 0.2e1 * t339 + t6 * (t666 + t791);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t799 = t5 * t176 * t377 / 0.8e1;
  t801 = t464 * t54;
  t807 = t34 * t54;
  t810 = 0.1e1 / t71;
  t821 = t195 * t464;
  t826 = t342 * t184;
  t827 = t826 * t34;
  t830 = t195 * t34;
  t833 = t181 * t375;
  t836 = t206 * t57;
  t840 = t525 * rho[0];
  t841 = 0.1e1 / t840;
  t842 = t522 * t841;
  t843 = t69 * t57;
  t851 = 0.74074074074074074075e-4 * t68 * sigma[0] * t206;
  t852 = -0.20944444444444444445e0 * t68 * t836 * sigma[0] + 0.17453703703703703703e1 * t842 * t843 - t60 * t42 * t195 / 0.9e1 + t851;
  t854 = t365 * t218;
  t857 = t373 * t231;
  t866 = t206 * t553;
  t870 = -0.10913888888888888889e-1 * t79 * t826 * t82 - 0.12762046833333333333e0 * t43 * t195 * t227 + 0.10771766521091481852e0 * t68 * t866 * sigma[0] - t851;
  t872 = -t219 * t870 - t854 * t231 - t537 * t373 + 0.2e1 * t542 * t857 + t852 * t87;
  t874 = 0.4e1 / 0.3e1 * t460 * t195 * t801 + 0.2e1 / 0.3e1 * t343 * t186 - 0.2e1 / 0.3e1 * t181 * t195 * t807 + 0.36720684159021185007e-1 * t182 * t810 * t485 + 0.67172833192183082812e-3 * t491 * t67 * t206 * sigma[0] - 0.36720684159021185005e-1 * t191 * t43 * t195 - 0.4e1 / 0.3e1 * t502 * t821 + t507 * t352 / 0.2e1 - 0.2e1 / 0.3e1 * t199 * t827 + 0.2e1 / 0.3e1 * t199 * t830 - 0.4e1 / 0.3e1 * t833 * t201 + t36 * t872;
  t879 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t377 - t799 - 0.3e1 / 0.8e1 * t5 * t27 * t874);
  tv2rhosigma0 = t6 * t879 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t886 = t5 * t251 * t417 / 0.8e1;
  t888 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t417 - t886);
  tv2rhosigma2 = t6 * t888 + t421;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t894 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t377 - t799);
  tv2rhosigma3 = t6 * t894 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t900 = t691 * t126;
  t906 = t112 * t126;
  t909 = 0.1e1 / t139;
  t920 = t294 * t691;
  t925 = t382 * t283;
  t926 = t925 * t112;
  t929 = t294 * t112;
  t932 = t280 * t415;
  t935 = t305 * t129;
  t939 = t750 * rho[1];
  t940 = 0.1e1 / t939;
  t941 = t522 * t940;
  t942 = t137 * t129;
  t950 = 0.74074074074074074075e-4 * t68 * sigma[2] * t305;
  t951 = -0.20944444444444444445e0 * t68 * t935 * sigma[2] + 0.17453703703703703703e1 * t941 * t942 - t132 * t42 * t294 / 0.9e1 + t950;
  t953 = t405 * t317;
  t956 = t413 * t330;
  t965 = t305 * t778;
  t969 = -0.10913888888888888889e-1 * t79 * t925 * t148 - 0.12762046833333333333e0 * t43 * t294 * t326 + 0.10771766521091481852e0 * t68 * t965 * sigma[2] - t950;
  t971 = t951 * t153 - t318 * t969 - t953 * t330 - t762 * t413 + 0.2e1 * t767 * t956;
  t973 = 0.4e1 / 0.3e1 * t687 * t294 * t900 + 0.2e1 / 0.3e1 * t383 * t285 - 0.2e1 / 0.3e1 * t280 * t294 * t906 + 0.36720684159021185007e-1 * t281 * t909 * t712 + 0.67172833192183082812e-3 * t718 * t67 * t305 * sigma[2] - 0.36720684159021185005e-1 * t290 * t43 * t294 - 0.4e1 / 0.3e1 * t729 * t920 + t734 * t392 / 0.2e1 - 0.2e1 / 0.3e1 * t298 * t926 + 0.2e1 / 0.3e1 * t298 * t929 - 0.4e1 / 0.3e1 * t932 * t300 + t114 * t971;
  t978 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t417 - t886 - 0.3e1 / 0.8e1 * t5 * t105 * t973);
  tv2rhosigma5 = t6 * t978 + t421;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t980 = 0.1e1 / sigma[0];
  t981 = t460 * t980;
  t983 = t47 * t464 * t54;
  t986 = 0.1e1 / t480;
  t987 = t181 * t986;
  t990 = t181 * t980;
  t992 = t47 * t34 * t54;
  t995 = 0.1e1 / t70;
  t999 = t68 * t73;
  t1002 = t980 * t47;
  t1003 = t1002 * t464;
  t1007 = t986 * t31;
  t1008 = t1007 * t34;
  t1011 = t1002 * t34;
  t1014 = 0.1e1 / t525;
  t1015 = t522 * t1014;
  t1016 = t57 * sigma[0];
  t1021 = 0.13888888888888888889e-4 * t999;
  t1022 = -0.65451388888888888888e0 * t1015 * t1016 + 0.5236111111111111111e-1 * t68 * t355 - t1021;
  t1026 = t373 * t373;
  t1038 = -0.40927083333333333332e-2 * t79 * t1007 * t82 + 0.15952558541666666666e-1 * t43 * t1002 * t227 - 0.40394124454093056943e-1 * t68 * t73 * t553 + t1021;
  t1040 = t1022 * t87 + 0.2e1 * t542 * t1026 - t219 * t1038 - 0.2e1 * t854 * t373;
  t1042 = -t981 * t983 / 0.2e1 + t987 * t345 / 0.4e1 + t990 * t992 / 0.4e1 - 0.13770256559632944377e-1 * t343 * t995 * t485 - 0.25189812447068656054e-3 * t490 * t999 + t502 * t1003 / 0.2e1 + t833 * t352 - t199 * t1008 / 0.4e1 - t199 * t1011 / 0.4e1 + t36 * t1040;
  t1046 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1042);
  tv2sigma20 = t6 * t1046;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1047 = 0.1e1 / sigma[2];
  t1048 = t687 * t1047;
  t1050 = t119 * t691 * t126;
  t1053 = 0.1e1 / t707;
  t1054 = t280 * t1053;
  t1057 = t280 * t1047;
  t1059 = t119 * t112 * t126;
  t1062 = 0.1e1 / t138;
  t1066 = t68 * t141;
  t1069 = t1047 * t119;
  t1070 = t1069 * t691;
  t1074 = t1053 * t109;
  t1075 = t1074 * t112;
  t1078 = t1069 * t112;
  t1081 = 0.1e1 / t750;
  t1082 = t522 * t1081;
  t1083 = t129 * sigma[2];
  t1088 = 0.13888888888888888889e-4 * t1066;
  t1089 = -0.65451388888888888888e0 * t1082 * t1083 + 0.5236111111111111111e-1 * t68 * t395 - t1088;
  t1093 = t413 * t413;
  t1105 = -0.40927083333333333332e-2 * t79 * t1074 * t148 + 0.15952558541666666666e-1 * t43 * t1069 * t326 - 0.40394124454093056943e-1 * t68 * t141 * t778 + t1088;
  t1107 = t1089 * t153 + 0.2e1 * t767 * t1093 - t318 * t1105 - 0.2e1 * t953 * t413;
  t1109 = -t1048 * t1050 / 0.2e1 + t1054 * t385 / 0.4e1 + t1057 * t1059 / 0.4e1 - 0.13770256559632944377e-1 * t383 * t1062 * t712 - 0.25189812447068656054e-3 * t717 * t1066 + t729 * t1070 / 0.2e1 + t932 * t392 - t298 * t1075 / 0.4e1 - t298 * t1078 / 0.4e1 + t114 * t1107;
  t1113 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t1109);
  tv2sigma25 = t6 * t1113;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1117 = 0.1e1 / t424 / t19;
  t1118 = t426 * t166;
  t1121 = t425 * t166;
  t1124 = t162 * t162;
  t1125 = 0.1e1 / t1124;
  t1126 = t16 * t1125;
  t1129 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t430 - 0.6e1 * t1126);
  t1133 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1117 * t1118 + 0.4e1 / 0.3e1 * t1121 * t434 + 0.4e1 / 0.3e1 * t23 * t1129);
  t1134 = t1133 * t26;
  t1138 = t438 * t175;
  t1140 = t5 * t1138 * t91;
  t1145 = t169 * t451;
  t1147 = t5 * t1145 * t91;
  t1150 = t5 * t443 * t235;
  t1156 = 0.1e1 / t174 / t162;
  t1157 = t25 * t1156;
  t1160 = 0.5e1 / 0.36e2 * t5 * t1157 * t91;
  t1162 = t5 * t452 * t235;
  t1165 = t5 * t176 * t561;
  t1167 = t28 * t69;
  t1168 = t181 * t1167;
  t1170 = 0.1e1 / t45 / t840;
  t1173 = t34 * t489 * t68;
  t1177 = 0.1e1 / t29 / t525;
  t1182 = 0.1e1 / t45 / t71;
  t1183 = t61 * t1182;
  t1188 = sigma[0] * t1182;
  t1189 = t1188 * t34;
  t1192 = 0.1e1 / t493;
  t1193 = t480 * t1192;
  t1194 = t1193 * t34;
  t1197 = t1193 * t464;
  t1200 = t181 * t559;
  t1203 = t180 * t180;
  t1204 = 0.1e1 / t1203;
  t1205 = t1204 * t480;
  t1206 = t464 * t34;
  t1207 = t1192 * t1206;
  t1211 = t460 * t480;
  t1212 = t1192 * t464;
  t1216 = t1182 * t34;
  t1224 = -0.71651022071661955004e-2 * t1168 * t1170 * t1173 + 0.19704031069707037626e-1 * t491 * t492 * t1177 - 0.62833170672102916568e0 * t192 * t1183 - 0.16e2 / 0.3e1 * t507 * t514 + 0.112e3 / 0.9e1 * t199 * t1189 - 0.64e2 / 0.27e2 * t199 * t1194 + 0.128e3 / 0.9e1 * t502 * t1197 - 0.4e1 * t1200 * t201 + 0.128e3 / 0.9e1 * t1205 * t1207 * t54 - 0.128e3 / 0.9e1 * t1211 * t1212 * t54 - 0.112e3 / 0.9e1 * t475 * t1216 * t54 + 0.64e2 / 0.27e2 * t481 * t1192 * t34 * t54;
  t1225 = t460 * t233;
  t1228 = t1204 * t89;
  t1229 = t1193 * t1206;
  t1232 = t189 * t189;
  t1233 = 0.1e1 / t1232;
  t1234 = t37 * t1233;
  t1235 = t525 * t193;
  t1236 = 0.1e1 / t1235;
  t1237 = t523 * t1236;
  t1240 = t69 * t1177;
  t1247 = t69 * t69;
  t1248 = t522 * t1247;
  t1249 = t525 * t71;
  t1251 = 0.1e1 / t45 / t1249;
  t1253 = t43 * t57;
  t1259 = 0.17201646090534979424e-2 * t68 * t1240;
  t1260 = -0.52904115226337448561e1 * t68 * t1240 * t57 + 0.88432098765432098768e2 * t524 * t1236 * t57 - 0.51714677640603566531e2 * t1248 * t1251 * t1253 - 0.154e3 / 0.81e2 * t60 * t1183 + t1259;
  t1262 = t535 * t218;
  t1265 = t215 * t541;
  t1270 = t217 * t217;
  t1271 = 0.1e1 / t1270;
  t1272 = t77 * t1271;
  t1273 = t543 * t231;
  t1276 = t231 * t557;
  t1280 = 0.1e1 / t29 / t70;
  t1281 = t28 * t1280;
  t1291 = t225 * t225;
  t1293 = 0.1e1 / t226 / t1291;
  t1296 = -0.16977160493827160493e0 * t79 * t1281 * t82 - 0.22499015898765432098e1 * t43 * t1188 * t227 + 0.35427143224923095866e1 * t68 * t1240 * t553 - 0.17920712264309222762e0 * t1237 * t1293 - t1259;
  t1298 = t1260 * t87 - 0.3e1 * t1262 * t231 + 0.6e1 * t1265 * t543 - 0.6e1 * t1272 * t1273 + 0.6e1 * t542 * t1276 - t219 * t1296 - 0.3e1 * t537 * t557;
  t1300 = t1281 * t34;
  t1306 = t1280 * t34 * t54;
  t1309 = t1188 * t464;
  t1312 = t1182 * t464;
  t1316 = t460 * t69;
  t1319 = t464 * t190 * t43;
  t1325 = t181 * t69;
  t1329 = 0.32e2 / 0.3e1 * t1225 * t504 - 0.128e3 / 0.9e1 * t1228 * t1229 - 0.80734108036796969854e-5 * t1234 * t1237 + t36 * t1298 - 0.28e3 / 0.27e2 * t199 * t1300 + 0.28e2 / 0.3e1 * t507 * t511 + 0.28e3 / 0.27e2 * t182 * t1306 - 0.224e3 / 0.9e1 * t502 * t1309 + 0.224e3 / 0.9e1 * t461 * t1312 * t54 + 0.39168729769622597341e0 * t1316 * t1177 * t1319 + 0.88129641981650844017e0 * t481 * t1192 * t485 - 0.1958436488481129867e0 * t1325 * t1177 * t485;
  t1330 = t1224 + t1329;
  t1335 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1134 * t91 - 0.3e1 / 0.8e1 * t1140 - 0.9e1 / 0.8e1 * t5 * t439 * t235 + t1147 / 0.4e1 - 0.3e1 / 0.4e1 * t1150 - 0.9e1 / 0.8e1 * t5 * t170 * t561 - t1160 + t1162 / 0.4e1 - 0.3e1 / 0.8e1 * t1165 - 0.3e1 / 0.8e1 * t5 * t27 * t1330);
  t1337 = 0.1e1 / t567 / t100;
  t1338 = t569 * t243;
  t1341 = t568 * t243;
  t1344 = t97 * t1125;
  t1347 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t430 - 0.6e1 * t1344);
  t1351 = my_piecewise3(t101, 0, -0.8e1 / 0.27e2 * t1337 * t1338 + 0.4e1 / 0.3e1 * t1341 * t575 + 0.4e1 / 0.3e1 * t102 * t1347);
  t1352 = t1351 * t26;
  t1356 = t579 * t175;
  t1358 = t5 * t1356 * t157;
  t1360 = t246 * t451;
  t1362 = t5 * t1360 * t157;
  t1364 = t104 * t1156;
  t1367 = 0.5e1 / 0.36e2 * t5 * t1364 * t157;
  t1369 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t1352 * t157 - 0.3e1 / 0.8e1 * t1358 + t1362 / 0.4e1 - t1367);
  tv3rho30 = 0.3e1 * t566 + 0.3e1 * t593 + t6 * (t1335 + t1369);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1372 = 0.2e1 * t619;
  t1373 = 0.2e1 * t645;
  t1374 = t1117 * t260;
  t1377 = t425 * t600;
  t1382 = 0.2e1 * t430;
  t1383 = 0.6e1 * t1126;
  t1385 = my_piecewise5(t10, 0, t14, 0, t1382 - t1383);
  t1389 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1374 * t426 + 0.8e1 / 0.9e1 * t1377 * t166 + 0.4e1 / 0.9e1 * t596 * t434 + 0.4e1 / 0.3e1 * t23 * t1385);
  t1390 = t1389 * t26;
  t1394 = t604 * t175;
  t1397 = t5 * t1394 * t91 / 0.4e1;
  t1401 = t263 * t451;
  t1403 = t5 * t1401 * t91;
  t1407 = t5 * t609 * t235 / 0.4e1;
  t1416 = -0.3e1 / 0.8e1 * t5 * t1390 * t91 - t1397 - 0.3e1 / 0.4e1 * t5 * t605 * t235 + t1403 / 0.12e2 - t1407 - 0.3e1 / 0.8e1 * t5 * t264 * t561 - t1140 / 0.8e1 + t1147 / 0.6e1 - t1150 / 0.4e1 - t1160 + t1162 / 0.6e1 - t1165 / 0.8e1;
  t1417 = my_piecewise3(t1, 0, t1416);
  t1418 = t1337 * t271;
  t1421 = t568 * t624;
  t1426 = 0.6e1 * t1344;
  t1428 = my_piecewise5(t14, 0, t10, 0, -t1382 - t1426);
  t1432 = my_piecewise3(t101, 0, -0.8e1 / 0.27e2 * t1418 * t569 + 0.8e1 / 0.9e1 * t1421 * t243 + 0.4e1 / 0.9e1 * t620 * t575 + 0.4e1 / 0.3e1 * t102 * t1428);
  t1433 = t1432 * t26;
  t1437 = t628 * t175;
  t1440 = t5 * t1437 * t157 / 0.4e1;
  t1441 = t274 * t451;
  t1443 = t5 * t1441 * t157;
  t1452 = t5 * t584 * t334 / 0.4e1;
  t1454 = t5 * t588 * t334;
  t1457 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t1433 * t157 - t1440 + t1443 / 0.12e2 - t1358 / 0.8e1 + t1362 / 0.6e1 - t1367 - 0.3e1 / 0.8e1 * t5 * t580 * t334 - t1452 + t1454 / 0.12e2);
  tv3rho31 = t566 + t593 + t1372 + t1373 + t6 * (t1417 + t1457);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1460 = t1117 * t650;
  t1465 = t425 * t655;
  t1469 = my_piecewise5(t10, 0, t14, 0, -t1382 - t1383);
  t1473 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1460 * t166 + 0.8e1 / 0.9e1 * t596 * t600 + 0.4e1 / 0.9e1 * t1465 * t166 + 0.4e1 / 0.3e1 * t23 * t1469);
  t1474 = t1473 * t26;
  t1478 = t659 * t175;
  t1480 = t5 * t1478 * t91;
  t1489 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1474 * t91 - t1480 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t660 * t235 - t1397 + t1403 / 0.6e1 - t1407 + t1147 / 0.12e2 - t1160 + t1162 / 0.12e2);
  t1490 = t1337 * t667;
  t1495 = t568 * t672;
  t1499 = my_piecewise5(t14, 0, t10, 0, t1382 - t1426);
  t1503 = my_piecewise3(t101, 0, -0.8e1 / 0.27e2 * t1490 * t243 + 0.8e1 / 0.9e1 * t620 * t624 + 0.4e1 / 0.9e1 * t1495 * t243 + 0.4e1 / 0.3e1 * t102 * t1499);
  t1504 = t1503 * t26;
  t1508 = t676 * t175;
  t1510 = t5 * t1508 * t157;
  t1517 = t5 * t633 * t334;
  t1525 = t5 * t251 * t786;
  t1527 = -0.3e1 / 0.8e1 * t5 * t1504 * t157 - t1510 / 0.8e1 - t1440 + t1443 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t629 * t334 - t1517 / 0.4e1 + t1362 / 0.12e2 - t1367 - t1452 + t1454 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t247 * t786 - t1525 / 0.8e1;
  t1528 = my_piecewise3(t96, 0, t1527);
  tv3rho32 = t1372 + t1373 + t666 + t791 + t6 * (t1489 + t1528);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1533 = t650 * t260;
  t1540 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t430 - 0.6e1 * t1126);
  t1544 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1117 * t1533 + 0.4e1 / 0.3e1 * t596 * t655 + 0.4e1 / 0.3e1 * t23 * t1540);
  t1545 = t1544 * t26;
  t1552 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1545 * t91 - 0.3e1 / 0.8e1 * t1480 + t1403 / 0.4e1 - t1160);
  t1553 = t667 * t271;
  t1560 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t430 - 0.6e1 * t1344);
  t1564 = my_piecewise3(t101, 0, -0.8e1 / 0.27e2 * t1337 * t1553 + 0.4e1 / 0.3e1 * t620 * t672 + 0.4e1 / 0.3e1 * t102 * t1560);
  t1565 = t1564 * t26;
  t1583 = 0.1e1 / t107 / t138;
  t1584 = t106 * t1583;
  t1585 = t1584 * t112;
  t1589 = 0.1e1 / t117 / t139;
  t1590 = sigma[2] * t1589;
  t1591 = t1590 * t691;
  t1595 = 0.1e1 / t107 / t750;
  t1596 = t137 * t1595;
  t1600 = t750 * t292;
  t1601 = 0.1e1 / t1600;
  t1605 = t137 * t137;
  t1606 = t522 * t1605;
  t1607 = t750 * t139;
  t1609 = 0.1e1 / t117 / t1607;
  t1611 = t43 * t129;
  t1614 = t133 * t1589;
  t1618 = 0.17201646090534979424e-2 * t68 * t1596;
  t1619 = -0.52904115226337448561e1 * t68 * t1596 * t129 + 0.88432098765432098768e2 * t749 * t1601 * t129 - 0.51714677640603566531e2 * t1606 * t1609 * t1611 - 0.154e3 / 0.81e2 * t132 * t1614 + t1618;
  t1621 = t760 * t317;
  t1624 = t314 * t766;
  t1629 = t316 * t316;
  t1630 = 0.1e1 / t1629;
  t1631 = t145 * t1630;
  t1632 = t768 * t330;
  t1635 = t330 * t782;
  t1647 = t748 * t1601;
  t1648 = t324 * t324;
  t1650 = 0.1e1 / t325 / t1648;
  t1653 = -0.16977160493827160493e0 * t79 * t1584 * t148 - 0.22499015898765432098e1 * t43 * t1590 * t326 + 0.35427143224923095866e1 * t68 * t1596 * t778 - 0.17920712264309222762e0 * t1647 * t1650 - t1618;
  t1655 = t1619 * t153 - 0.3e1 * t1621 * t330 + 0.6e1 * t1624 * t768 - 0.6e1 * t1631 * t1632 + 0.6e1 * t767 * t1635 - t318 * t1653 - 0.3e1 * t762 * t782;
  t1657 = 0.1e1 / t720;
  t1658 = t707 * t1657;
  t1659 = t1658 * t112;
  t1664 = t1590 * t112;
  t1667 = t279 * t279;
  t1668 = 0.1e1 / t1667;
  t1669 = t1668 * t155;
  t1670 = t691 * t112;
  t1671 = t1658 * t1670;
  t1674 = t1658 * t691;
  t1677 = t280 * t784;
  t1680 = t1668 * t707;
  t1681 = t1657 * t1670;
  t1685 = t687 * t707;
  t1686 = t1657 * t691;
  t1690 = 0.28e2 / 0.3e1 * t734 * t738 - 0.28e3 / 0.27e2 * t298 * t1585 - 0.224e3 / 0.9e1 * t729 * t1591 + t114 * t1655 - 0.64e2 / 0.27e2 * t298 * t1659 - 0.16e2 / 0.3e1 * t734 * t741 + 0.112e3 / 0.9e1 * t298 * t1664 - 0.128e3 / 0.9e1 * t1669 * t1671 + 0.128e3 / 0.9e1 * t729 * t1674 - 0.4e1 * t1677 * t300 + 0.128e3 / 0.9e1 * t1680 * t1681 * t126 - 0.128e3 / 0.9e1 * t1685 * t1686 * t126;
  t1691 = t1589 * t112;
  t1699 = t687 * t332;
  t1702 = t1589 * t691;
  t1707 = t1583 * t112 * t126;
  t1715 = t687 * t137;
  t1718 = t691 * t289 * t43;
  t1724 = t280 * t137;
  t1728 = t106 * t137;
  t1729 = t280 * t1728;
  t1731 = 0.1e1 / t117 / t939;
  t1734 = t112 * t716 * t68;
  t1737 = t288 * t288;
  t1738 = 0.1e1 / t1737;
  t1739 = t115 * t1738;
  t1742 = -0.112e3 / 0.9e1 * t702 * t1691 * t126 + 0.64e2 / 0.27e2 * t708 * t1657 * t112 * t126 + 0.32e2 / 0.3e1 * t1699 * t731 + 0.224e3 / 0.9e1 * t688 * t1702 * t126 + 0.28e3 / 0.27e2 * t281 * t1707 + 0.19704031069707037626e-1 * t718 * t719 * t1595 - 0.62833170672102916568e0 * t291 * t1614 + 0.39168729769622597341e0 * t1715 * t1595 * t1718 + 0.88129641981650844017e0 * t708 * t1657 * t712 - 0.1958436488481129867e0 * t1724 * t1595 * t712 - 0.71651022071661955004e-2 * t1729 * t1731 * t1734 - 0.80734108036796969854e-5 * t1739 * t1647;
  t1743 = t1690 + t1742;
  t1748 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t1565 * t157 - 0.3e1 / 0.8e1 * t1510 - 0.9e1 / 0.8e1 * t5 * t677 * t334 + t1443 / 0.4e1 - 0.3e1 / 0.4e1 * t1517 - 0.9e1 / 0.8e1 * t5 * t275 * t786 - t1367 + t1454 / 0.4e1 - 0.3e1 / 0.8e1 * t1525 - 0.3e1 / 0.8e1 * t5 * t105 * t1743);
  tv3rho33 = 0.3e1 * t666 + 0.3e1 * t791 + t6 * (t1552 + t1748);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1756 = t5 * t443 * t377;
  t1763 = t5 * t452 * t377 / 0.12e2;
  t1765 = t5 * t176 * t874;
  t1767 = t460 * t495;
  t1768 = t1767 * t464;
  t1769 = t190 * t38;
  t1770 = t1769 * t61;
  t1776 = t181 * t495;
  t1777 = t1776 * t34;
  t1781 = 0.1e1 / t45 / t525;
  t1806 = t342 * t470;
  t1807 = t1806 * t34;
  t1810 = -0.14688273663608474003e0 * t1768 * t1770 - 0.25704478911314829505e0 * t182 * t482 * t485 + 0.73441368318042370014e-1 * t1777 * t1770 + 0.26869133276873233126e-2 * t481 * t1781 * t1173 - 0.8e1 / 0.3e1 * t1225 * t821 + 0.4e1 / 0.3e1 * t507 * t830 - 0.1e2 / 0.3e1 * t199 * t476 + 0.2e2 / 0.3e1 * t502 * t465 - 0.2e2 / 0.3e1 * t460 * t463 * t801 + 0.1e2 / 0.3e1 * t181 * t463 * t807 + 0.30275290513798863693e-5 * t1234 * t527 * t69 + 0.28e2 / 0.9e1 * t833 * t511 - 0.4e1 / 0.3e1 * t507 * t827 + 0.14e2 / 0.9e1 * t199 * t1807;
  t1819 = t1206 * t54;
  t1820 = t1819 * t28;
  t1824 = t801 * t28;
  t1829 = t28 * t34 * t54;
  t1832 = t181 * t872;
  t1835 = t482 * t1206;
  t1836 = t1835 * t28;
  t1839 = t482 * t464;
  t1840 = t1839 * t28;
  t1846 = t482 * t28 * t34;
  t1849 = t460 * t375;
  t1856 = t495 * t57;
  t1860 = t522 * t527;
  t1863 = t525 * t70;
  t1865 = 0.1e1 / t45 / t1863;
  t1866 = t522 * t1865;
  t1875 = 0.46913580246913580247e-3 * t68 * sigma[0] * t495;
  t1876 = 0.1512654320987654321e1 * t68 * t1856 * sigma[0] - 0.29671296296296296296e2 * t1860 * t843 + 0.19393004115226337448e2 * t1866 * t523 * t1253 + 0.11e2 / 0.27e2 * t60 * t42 * t463 - t1875;
  t1878 = t852 * t218;
  t1881 = t365 * t541;
  t1890 = t373 * t543;
  t1893 = t870 * t231;
  t1896 = t373 * t557;
  t1905 = t495 * t553;
  t1909 = t527 * t1293;
  t1912 = 0.25465740740740740741e-1 * t79 * t1806 * t82 + 0.52466192537037037036e0 * t43 * t463 * t227 - 0.1113082540512786458e1 * t68 * t1905 * sigma[0] + 0.67202670991159585361e-1 * t1909 * t69 + t1875;
  t1914 = -t1262 * t373 + 0.4e1 * t1265 * t857 - 0.6e1 * t1272 * t1890 + t1876 * t87 - 0.2e1 * t1878 * t231 + 0.2e1 * t1881 * t543 + 0.4e1 * t542 * t1893 + 0.2e1 * t542 * t1896 - t219 * t1912 - 0.2e1 * t537 * t870 - t854 * t557;
  t1916 = 0.13464250858307767835e0 * t191 * t43 * t463 - 0.14e2 / 0.9e1 * t343 * t472 + t1200 * t352 / 0.2e1 - 0.16e2 / 0.3e1 * t1204 * t482 * t1820 + 0.16e2 / 0.3e1 * t460 * t482 * t1824 - 0.8e1 / 0.9e1 * t181 * t482 * t1829 - 0.8e1 / 0.3e1 * t1832 * t201 + 0.16e2 / 0.3e1 * t1228 * t1836 - 0.16e2 / 0.3e1 * t502 * t1840 - 0.16e2 / 0.9e1 * t833 * t514 + 0.8e1 / 0.9e1 * t199 * t1846 + 0.32e2 / 0.9e1 * t1849 * t504 - 0.60455549872964774531e-2 * t491 * t67 * t495 * sigma[0] + t36 * t1914;
  t1917 = t1810 + t1916;
  t1922 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t439 * t377 - t1756 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t170 * t874 + t1763 - t1765 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1917);
  tv3rho2sigma0 = t6 * t1922 + 0.2e1 * t879;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1929 = t5 * t584 * t417;
  t1933 = t5 * t588 * t417 / 0.12e2;
  t1935 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t580 * t417 - t1929 / 0.4e1 + t1933);
  tv3rho2sigma2 = t6 * t1935 + 0.2e1 * t888;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1941 = t5 * t609 * t377;
  t1949 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t377 - t1941 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t264 * t874 - t1756 / 0.8e1 + t1763 - t1765 / 0.8e1);
  tv3rho2sigma3 = t6 * t1949 + t879 + t894;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1955 = t5 * t633 * t417;
  t1962 = t5 * t251 * t973;
  t1965 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t629 * t417 - t1955 / 0.8e1 - t1929 / 0.8e1 + t1933 - 0.3e1 / 0.8e1 * t5 * t247 * t973 - t1962 / 0.8e1);
  tv3rho2sigma5 = t6 * t1965 + t888 + t978;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1973 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t660 * t377 - t1941 / 0.4e1 + t1763);
  tv3rho2sigma6 = t6 * t1973 + 0.2e1 * t894;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1984 = t687 * t722;
  t1985 = t1984 * t691;
  t1986 = t289 * t38;
  t1987 = t1986 * t133;
  t1993 = t280 * t722;
  t1994 = t1993 * t112;
  t1998 = 0.1e1 / t117 / t750;
  t2004 = t382 * t697;
  t2005 = t2004 * t112;
  t2016 = t1670 * t126;
  t2017 = t2016 * t106;
  t2021 = t900 * t106;
  t2026 = t106 * t112 * t126;
  t2031 = t280 * t971;
  t2034 = -0.14688273663608474003e0 * t1985 * t1987 - 0.25704478911314829505e0 * t281 * t709 * t712 + 0.73441368318042370014e-1 * t1994 * t1987 + 0.26869133276873233126e-2 * t708 * t1998 * t1734 - 0.4e1 / 0.3e1 * t734 * t926 + 0.14e2 / 0.9e1 * t298 * t2005 - 0.14e2 / 0.9e1 * t383 * t699 + 0.13464250858307767835e0 * t290 * t43 * t690 + t1677 * t392 / 0.2e1 - 0.16e2 / 0.3e1 * t1668 * t709 * t2017 + 0.16e2 / 0.3e1 * t687 * t709 * t2021 - 0.8e1 / 0.9e1 * t280 * t709 * t2026 + 0.28e2 / 0.9e1 * t932 * t738 - 0.8e1 / 0.3e1 * t2031 * t300;
  t2035 = t709 * t1670;
  t2036 = t2035 * t106;
  t2039 = t709 * t691;
  t2040 = t2039 * t106;
  t2043 = t687 * t415;
  t2049 = t709 * t106 * t112;
  t2073 = t722 * t129;
  t2077 = t522 * t752;
  t2080 = t750 * t138;
  t2082 = 0.1e1 / t117 / t2080;
  t2083 = t522 * t2082;
  t2092 = 0.46913580246913580247e-3 * t68 * sigma[2] * t722;
  t2093 = 0.1512654320987654321e1 * t68 * t2073 * sigma[2] - 0.29671296296296296296e2 * t2077 * t942 + 0.19393004115226337448e2 * t2083 * t748 * t1611 + 0.11e2 / 0.27e2 * t132 * t42 * t690 - t2092;
  t2095 = t951 * t317;
  t2098 = t405 * t766;
  t2107 = t413 * t768;
  t2110 = t969 * t330;
  t2113 = t413 * t782;
  t2122 = t722 * t778;
  t2126 = t752 * t1650;
  t2129 = 0.25465740740740740741e-1 * t79 * t2004 * t148 + 0.52466192537037037036e0 * t43 * t690 * t326 - 0.1113082540512786458e1 * t68 * t2122 * sigma[2] + 0.67202670991159585361e-1 * t2126 * t137 + t2092;
  t2131 = t2093 * t153 - t1621 * t413 + 0.4e1 * t1624 * t956 - 0.6e1 * t1631 * t2107 - 0.2e1 * t2095 * t330 + 0.2e1 * t2098 * t768 + 0.4e1 * t767 * t2110 + 0.2e1 * t767 * t2113 - t318 * t2129 - 0.2e1 * t762 * t969 - t953 * t782;
  t2133 = 0.16e2 / 0.3e1 * t1669 * t2036 - 0.16e2 / 0.3e1 * t729 * t2040 + 0.32e2 / 0.9e1 * t2043 * t731 - 0.16e2 / 0.9e1 * t932 * t741 + 0.8e1 / 0.9e1 * t298 * t2049 - 0.60455549872964774531e-2 * t718 * t67 * t722 * sigma[2] + 0.4e1 / 0.3e1 * t734 * t929 - 0.1e2 / 0.3e1 * t298 * t703 + 0.1e2 / 0.3e1 * t280 * t690 * t906 + 0.30275290513798863693e-5 * t1739 * t752 * t137 - 0.8e1 / 0.3e1 * t1699 * t920 + 0.2e2 / 0.3e1 * t729 * t692 - 0.2e2 / 0.3e1 * t687 * t690 * t900 + t114 * t2131;
  t2134 = t2034 + t2133;
  t2139 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t677 * t417 - t1955 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t275 * t973 + t1933 - t1962 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t105 * t2134);
  tv3rho2sigma8 = t6 * t2139 + 0.2e1 * t978;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2146 = t5 * t176 * t1042 / 0.8e1;
  t2151 = 0.1e1 / t45 / t493;
  t2155 = t980 * t195;
  t2156 = t2155 * t464;
  t2159 = t821 * t54;
  t2164 = t68 * t206;
  t2167 = t1204 * t342;
  t2172 = t460 * t342;
  t2177 = t342 * t810;
  t2178 = t2177 * t34;
  t2181 = t830 * t54;
  t2190 = t2177 * t1206;
  t2193 = 0.45900855198776481256e-1 * t343 * t810 * t485 - 0.10075924978827462422e-2 * t182 * t2151 * t1173 - 0.2e1 / 0.3e1 * t502 * t2156 + 0.2e1 / 0.3e1 * t981 * t2159 - t987 * t186 / 0.3e1 + 0.13434566638436616562e-2 * t490 * t2164 + 0.2e1 * t2167 * t810 * t1206 * t54 - 0.2e1 * t2172 * t810 * t464 * t54 - t199 * t2178 / 0.3e1 - t990 * t2181 / 0.3e1 + t343 * t810 * t34 * t54 / 0.3e1 + t1225 * t1003 / 0.2e1 - 0.2e1 * t1228 * t2190;
  t2194 = t2177 * t464;
  t2200 = t2155 * t34;
  t2205 = t181 * t1040;
  t2210 = t986 * t184;
  t2211 = t2210 * t34;
  t2216 = t1769 * t42;
  t2233 = 0.1e1 / t45 / t1235;
  t2235 = t522 * t2233 * t38;
  t2237 = t42 * t69 * t57;
  t2242 = 0.74074074074074074075e-4 * t2164;
  t2243 = 0.87268518518518518517e1 * t842 * t1016 - 0.72723765432098765431e1 * t2235 * t2237 - 0.27925925925925925925e0 * t68 * t836 + t2242;
  t2245 = t1022 * t218;
  t2255 = t1026 * t231;
  t2258 = t373 * t870;
  t2262 = t1038 * t231;
  t2273 = t841 * t1293;
  t2276 = 0.54569444444444444443e-2 * t79 * t2210 * t82 - 0.21270078055555555554e-1 * t43 * t2155 * t227 + 0.26929416302728704629e0 * t68 * t866 - 0.25201001621684844509e-1 * t2273 * sigma[0] - t2242;
  t2278 = 0.2e1 * t1265 * t1026 - t537 * t1038 - 0.6e1 * t1272 * t2255 - 0.2e1 * t1878 * t373 + 0.4e1 * t1881 * t857 - t219 * t2276 + t2243 * t87 - t2245 * t231 + 0.4e1 * t542 * t2258 + 0.2e1 * t542 * t2262 - 0.2e1 * t854 * t870;
  t2280 = 0.2e1 * t502 * t2194 + t1832 * t352 - t507 * t1008 / 0.4e1 + t199 * t2200 / 0.3e1 - t507 * t1011 / 0.4e1 - 0.4e1 / 0.3e1 * t2205 * t201 - 0.4e1 / 0.3e1 * t833 * t827 + t199 * t2211 / 0.3e1 + 0.55081026238531777509e-1 * t460 * t206 * t464 * t2216 - 0.27540513119265888755e-1 * t181 * t206 * t34 * t2216 + 0.4e1 / 0.3e1 * t833 * t830 - 0.11353233942674573885e-5 * t1234 * t841 * sigma[0] - 0.8e1 / 0.3e1 * t1849 * t821 + t36 * t2278;
  t2281 = t2193 + t2280;
  t2286 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t1042 - t2146 - 0.3e1 / 0.8e1 * t5 * t27 * t2281);
  tv3rhosigma20 = t6 * t2286 + t1046;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2293 = t5 * t251 * t1109 / 0.8e1;
  t2295 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t1109 - t2293);
  tv3rhosigma25 = t6 * t2295 + t1113;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2301 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t1042 - t2146);
  tv3rhosigma26 = t6 * t2301 + t1046;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2310 = 0.1e1 / t117 / t720;
  t2314 = t1047 * t294;
  t2315 = t2314 * t691;
  t2318 = t920 * t126;
  t2323 = t68 * t305;
  t2326 = t1668 * t382;
  t2331 = t687 * t382;
  t2336 = t929 * t126;
  t2345 = t382 * t909;
  t2346 = t2345 * t1670;
  t2349 = t2345 * t691;
  t2352 = 0.45900855198776481256e-1 * t383 * t909 * t712 - 0.10075924978827462422e-2 * t281 * t2310 * t1734 - 0.2e1 / 0.3e1 * t729 * t2315 + 0.2e1 / 0.3e1 * t1048 * t2318 - t1054 * t285 / 0.3e1 + 0.13434566638436616562e-2 * t717 * t2323 + 0.2e1 * t2326 * t909 * t1670 * t126 - 0.2e1 * t2331 * t909 * t691 * t126 - t1057 * t2336 / 0.3e1 + t383 * t909 * t112 * t126 / 0.3e1 + t1699 * t1070 / 0.2e1 - 0.2e1 * t1669 * t2346 + 0.2e1 * t729 * t2349;
  t2354 = t2345 * t112;
  t2359 = t2314 * t112;
  t2364 = t280 * t1107;
  t2369 = t1053 * t283;
  t2370 = t2369 * t112;
  t2382 = t1986 * t42;
  t2392 = 0.1e1 / t117 / t1600;
  t2394 = t522 * t2392 * t38;
  t2396 = t42 * t137 * t129;
  t2401 = 0.74074074074074074075e-4 * t2323;
  t2402 = 0.87268518518518518517e1 * t941 * t1083 - 0.72723765432098765431e1 * t2394 * t2396 - 0.27925925925925925925e0 * t68 * t935 + t2401;
  t2404 = t1089 * t317;
  t2414 = t1093 * t330;
  t2417 = t413 * t969;
  t2421 = t1105 * t330;
  t2432 = t940 * t1650;
  t2435 = 0.54569444444444444443e-2 * t79 * t2369 * t148 - 0.21270078055555555554e-1 * t43 * t2314 * t326 + 0.26929416302728704629e0 * t68 * t965 - 0.25201001621684844509e-1 * t2432 * sigma[2] - t2401;
  t2437 = 0.2e1 * t1624 * t1093 - t762 * t1105 + t2402 * t153 - 0.6e1 * t1631 * t2414 - 0.2e1 * t2095 * t413 + 0.4e1 * t2098 * t956 - t2404 * t330 + 0.4e1 * t767 * t2417 + 0.2e1 * t767 * t2421 - t318 * t2435 - 0.2e1 * t953 * t969;
  t2439 = t2031 * t392 - t298 * t2354 / 0.3e1 - t734 * t1075 / 0.4e1 + t298 * t2359 / 0.3e1 - t734 * t1078 / 0.4e1 - 0.4e1 / 0.3e1 * t2364 * t300 - 0.4e1 / 0.3e1 * t932 * t926 + t298 * t2370 / 0.3e1 - 0.8e1 / 0.3e1 * t2043 * t920 + 0.4e1 / 0.3e1 * t932 * t929 - 0.11353233942674573885e-5 * t1739 * t940 * sigma[2] + 0.55081026238531777509e-1 * t687 * t305 * t691 * t2382 - 0.27540513119265888755e-1 * t280 * t305 * t112 * t2382 + t114 * t2437;
  t2440 = t2352 + t2439;
  t2445 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t1109 - t2293 - 0.3e1 / 0.8e1 * t5 * t105 * t2440);
  tv3rhosigma211 = t6 * t2445 + t1113;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2447 = 0.1e1 / t1167;
  t2448 = t2447 * t31;
  t2449 = t2448 * t34;
  t2452 = 0.1e1 / t69;
  t2453 = t2452 * t47;
  t2454 = t2453 * t464;
  t2459 = t460 * t2452;
  t2462 = t181 * t2447;
  t2466 = 0.1e1 / t45 / t526;
  t2467 = t522 * t2466;
  t2470 = t42 * t57 * sigma[0];
  t2475 = 0.27271412037037037037e1 * t2467 * t38 * t2470 - 0.19635416666666666667e1 * t1015 * t57;
  t2483 = t1026 * t373;
  t2486 = t373 * t1038;
  t2501 = 0.61390624999999999998e-2 * t79 * t2448 * t82 - 0.23928837812499999999e-1 * t43 * t2453 * t227 - 0.20197062227046528471e-1 * t68 * t980 * t73 * t553 + 0.94503756081318166912e-2 * t1014 * t1293;
  t2503 = 0.6e1 * t1881 * t1026 - 0.3e1 * t854 * t1038 - 0.6e1 * t1272 * t2483 - t219 * t2501 - 0.3e1 * t2245 * t373 + t2475 * t87 + 0.6e1 * t542 * t2486;
  t2505 = t986 * t995;
  t2506 = t2505 * t34;
  t2511 = t2453 * t34;
  t2516 = t2505 * t1206;
  t2519 = 0.3e1 / 0.8e1 * t199 * t2449 - 0.3e1 / 0.4e1 * t502 * t2454 - 0.3e1 / 0.4e1 * t833 * t1008 + 0.3e1 / 0.4e1 * t2459 * t983 - 0.3e1 / 0.8e1 * t2462 * t345 + t36 * t2503 + t199 * t2506 / 0.8e1 - 0.3e1 / 0.4e1 * t833 * t1011 + 0.3e1 / 0.8e1 * t199 * t2511 + 0.3e1 / 0.2e1 * t1849 * t1003 + 0.3e1 / 0.4e1 * t1228 * t2516;
  t2520 = t2505 * t464;
  t2525 = t1204 * t986;
  t2527 = t995 * t1206 * t54;
  t2530 = t460 * t986;
  t2532 = t995 * t464 * t54;
  t2535 = t181 * t2452;
  t2539 = t995 * t34 * t54;
  t2543 = 0.1e1 / t45 / t204;
  t2558 = -0.3e1 / 0.4e1 * t502 * t2520 + 0.3e1 / 0.2e1 * t2205 * t352 - 0.3e1 / 0.4e1 * t2525 * t2527 + 0.3e1 / 0.4e1 * t2530 * t2532 - 0.3e1 / 0.8e1 * t2535 * t992 - t987 * t2539 / 0.8e1 + 0.37784718670602984081e-3 * t343 * t2543 * t1173 - 0.20655384839449416566e-1 * t981 * t73 * t1319 + 0.10327692419724708283e-1 * t987 * t995 * t485 + 0.10327692419724708283e-1 * t990 * t73 * t485 + 0.42574627285029652067e-6 * t1234 * t1014;
  t2559 = t2519 + t2558;
  t2563 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2559);
  tv3sigma30 = t6 * t2563;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2565 = 0.1e1 / t117 / t751;
  t2566 = t522 * t2565;
  t2569 = t42 * t129 * sigma[2];
  t2574 = 0.27271412037037037037e1 * t2566 * t38 * t2569 - 0.19635416666666666667e1 * t1082 * t129;
  t2582 = t1093 * t413;
  t2585 = t413 * t1105;
  t2588 = 0.1e1 / t1728;
  t2589 = t2588 * t109;
  t2593 = 0.1e1 / t137;
  t2594 = t2593 * t119;
  t2604 = 0.61390624999999999998e-2 * t79 * t2589 * t148 - 0.23928837812499999999e-1 * t43 * t2594 * t326 - 0.20197062227046528471e-1 * t68 * t1047 * t141 * t778 + 0.94503756081318166912e-2 * t1081 * t1650;
  t2606 = 0.6e1 * t2098 * t1093 - 0.3e1 * t953 * t1105 + t2574 * t153 - 0.6e1 * t1631 * t2582 - 0.3e1 * t2404 * t413 + 0.6e1 * t767 * t2585 - t318 * t2604;
  t2610 = t2589 * t112;
  t2613 = t2594 * t691;
  t2616 = t687 * t2593;
  t2619 = t280 * t2588;
  t2624 = t1053 * t1062;
  t2625 = t2624 * t112;
  t2630 = t2594 * t112;
  t2635 = t114 * t2606 - 0.3e1 / 0.4e1 * t932 * t1075 + 0.3e1 / 0.8e1 * t298 * t2610 - 0.3e1 / 0.4e1 * t729 * t2613 + 0.3e1 / 0.4e1 * t2616 * t1050 - 0.3e1 / 0.8e1 * t2619 * t385 + 0.42574627285029652067e-6 * t1739 * t1081 + t298 * t2625 / 0.8e1 - 0.3e1 / 0.4e1 * t932 * t1078 + 0.3e1 / 0.8e1 * t298 * t2630 + 0.3e1 / 0.2e1 * t2043 * t1070;
  t2636 = t2624 * t1670;
  t2639 = t2624 * t691;
  t2644 = t1668 * t1053;
  t2646 = t1062 * t1670 * t126;
  t2649 = t687 * t1053;
  t2651 = t1062 * t691 * t126;
  t2654 = t280 * t2593;
  t2658 = t1062 * t112 * t126;
  t2671 = 0.1e1 / t117 / t303;
  t2675 = 0.3e1 / 0.4e1 * t1669 * t2636 - 0.3e1 / 0.4e1 * t729 * t2639 + 0.3e1 / 0.2e1 * t2364 * t392 - 0.3e1 / 0.4e1 * t2644 * t2646 + 0.3e1 / 0.4e1 * t2649 * t2651 - 0.3e1 / 0.8e1 * t2654 * t1059 - t1054 * t2658 / 0.8e1 - 0.20655384839449416566e-1 * t1048 * t141 * t1718 + 0.10327692419724708283e-1 * t1054 * t1062 * t712 + 0.10327692419724708283e-1 * t1057 * t141 * t712 + 0.37784718670602984081e-3 * t383 * t2671 * t1734;
  t2676 = t2635 + t2675;
  t2680 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * t2676);
  tv3sigma39 = t6 * t2680;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2684 = 0.1e1 / t29 / t840;
  t2688 = t1168 * t2466;
  t2694 = t1206 * t190 * t43;
  t2710 = 0.1e1 / t1863;
  t2713 = t464 * t489 * t68;
  t2724 = -0.65281216282704328902e1 * t1316 * t2684 * t1319 + 0.13852530933854644634e0 * t2688 * t1173 - 0.20889989210465385248e1 * t1204 * t1167 * t2466 * t2694 + 0.20889989210465385248e1 * t460 * t1167 * t2466 * t1319 + 0.3264060814135216445e1 * t1325 * t2684 * t485 - 0.34816648684108975414e0 * t2688 * t485 - 0.73876576426593732207e1 * t481 * t1014 * t485 + 0.38213878438219709336e-1 * t460 * t523 * t2710 * t2713 - 0.19106939219109854667e-1 * t181 * t523 * t2710 * t1173 - 0.32e2 / 0.3e1 * t1200 * t514 + 0.448e3 / 0.9e1 * t507 * t1189;
  t2725 = sigma[0] * t2543;
  t2729 = t28 * t523;
  t2732 = 0.1e1 / t29 / t1249;
  t2745 = t480 * t1014;
  t2759 = t523 * t2710;
  t2765 = -0.6832e4 / 0.81e2 * t199 * t2725 * t34 - 0.43058190952958383923e-4 * t181 * t2729 * t2732 * t34 * t1233 + 0.56e2 / 0.3e1 * t1200 * t511 - 0.1792e4 / 0.9e1 * t1205 * t1014 * t1206 * t54 - 0.896e3 / 0.9e1 * t1225 * t1309 + 0.1792e4 / 0.9e1 * t1228 * t2745 * t1206 + 0.1792e4 / 0.9e1 * t1211 * t1014 * t464 * t54 + 0.6832e4 / 0.81e2 * t475 * t2543 * t34 * t54 - 0.256e3 / 0.27e2 * t507 * t1194 + 0.17761503768095333368e-3 * t1234 * t2759 - 0.1792e4 / 0.9e1 * t502 * t2745 * t464;
  t2770 = t69 * t2684;
  t2779 = t181 * t1298;
  t2782 = t460 * t559;
  t2786 = 0.1e1 / t1203 / t35;
  t2788 = t464 * t464;
  t2809 = 0.896e3 / 0.27e2 * t199 * t2745 * t34 + 0.3584e4 / 0.81e2 * t502 * t2770 * t464 - 0.256e3 / 0.81e2 * t199 * t2770 * t34 + 0.512e3 / 0.9e1 * t1225 * t1197 - 0.16e2 / 0.3e1 * t2779 * t201 + 0.64e2 / 0.3e1 * t2782 * t504 - 0.2048e4 / 0.27e2 * t2786 * t69 * t2684 * t2788 * t54 + 0.1024e4 / 0.9e1 * t1204 * t69 * t2684 * t1206 * t54 - 0.3584e4 / 0.81e2 * t1316 * t2684 * t464 * t54 - 0.896e3 / 0.27e2 * t481 * t1014 * t34 * t54 - 0.1024e4 / 0.9e1 * t1228 * t2770 * t1206;
  t2810 = t1204 * t233;
  t2813 = t2786 * t89;
  t2817 = t2684 * t34;
  t2822 = t73 * t34 * t54;
  t2825 = t28 * t73;
  t2841 = t61 * t2543;
  t2846 = t37 / t1232 / t51;
  t2848 = t525 * t204;
  t2850 = 0.1e1 / t45 / t2848;
  t2866 = t525 * t525;
  t2871 = t68 * t57;
  t2877 = 0.14334705075445816187e-1 * t68 * t2770;
  t2880 = t1260 * t218;
  t2883 = t535 * t541;
  t2888 = t215 * t1271;
  t2897 = t77 / t1270 / t86;
  t2898 = t543 * t543;
  t2904 = t557 * t557;
  t2924 = 0.1e1 / t226 / t1291 / t225;
  t2931 = (0.47272386831275720165e2 * t68 * t2770 * t57 - 0.13254471879286694102e4 * t524 * t2710 * t57 + 0.16893461362597165067e4 * t1248 * t2850 * t1253 - 0.57460752934003962812e3 * t522 * t1247 * sigma[0] / t29 / t2866 / rho[0] * t2871 + 0.2618e4 / 0.243e3 * t60 * t2841 - t2877) * t87 - 0.4e1 * t2880 * t231 + 0.12e2 * t2883 * t543 - 0.6e1 * t1262 * t557 - 0.24e2 * t2888 * t1273 + 0.24e2 * t1265 * t1276 - 0.4e1 * t537 * t1296 + 0.24e2 * t2897 * t2898 - 0.36e2 * t1272 * t543 * t557 + 0.6e1 * t542 * t2904 + 0.8e1 * t542 * t231 * t1296 - t219 * (0.73567695473251028803e0 * t79 * t2825 * t82 + 0.13631756691604938272e2 * t43 * t2725 * t227 - 0.37118709523050054497e2 * t68 * t2770 * t553 + 0.41814995283388186444e1 * t2759 * t1293 - 0.30251844539326121245e1 * t1247 * t2850 * t2924 * t38 * t42 + t2877);
  t2933 = -0.512e3 / 0.9e1 * t2810 * t1229 + 0.2048e4 / 0.27e2 * t2813 * t2770 * t2788 + 0.256e3 / 0.81e2 * t1325 * t2817 * t54 - 0.364e4 / 0.81e2 * t182 * t2822 + 0.364e4 / 0.81e2 * t199 * t2825 * t34 - 0.13664e5 / 0.81e2 * t461 * t2543 * t464 * t54 - 0.112e4 / 0.27e2 * t507 * t1300 + 0.13664e5 / 0.81e2 * t502 * t2725 * t464 - 0.19485097391154737208e0 * t491 * t492 * t2684 + 0.35605463380858319389e1 * t192 * t2841 - 0.78765980119400302024e-6 * t2846 * t1247 * t2850 * t38 * t42 + t36 * t2931;
  t2940 = t5 * t176 * t1330;
  t2943 = t5 * t452 * t561;
  t2946 = t5 * t1157 * t235;
  t2952 = t5 * t1145 * t235;
  t2954 = t5 * t443 * t561;
  t2957 = 0.1e1 / t174 / t429;
  t2961 = 0.1e2 / 0.27e2 * t5 * t25 * t2957 * t91;
  t2964 = t5 * t169 * t1156 * t91;
  t2968 = t5 * t1133 * t175 * t91;
  t2972 = t5 * t438 * t451 * t91;
  t2975 = t5 * t1138 * t235;
  t2980 = t19 * t19;
  t2982 = 0.1e1 / t424 / t2980;
  t2983 = t426 * t426;
  t2989 = t434 * t434;
  t2995 = 0.1e1 / t1124 / t6;
  t2996 = t16 * t2995;
  t2999 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t1125 + 0.24e2 * t2996);
  t3003 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2982 * t2983 - 0.16e2 / 0.9e1 * t1117 * t426 * t434 + 0.4e1 / 0.3e1 * t425 * t2989 + 0.16e2 / 0.9e1 * t1121 * t1129 + 0.4e1 / 0.3e1 * t23 * t2999);
  t3011 = -0.3e1 / 0.8e1 * t5 * t27 * (t2724 + t2765 + t2809 + t2933) - t2940 / 0.2e1 + t2943 / 0.2e1 - 0.5e1 / 0.9e1 * t2946 - 0.3e1 / 0.2e1 * t5 * t170 * t1330 + t2952 - 0.3e1 / 0.2e1 * t2954 + t2961 - 0.5e1 / 0.9e1 * t2964 - t2968 / 0.2e1 + t2972 / 0.2e1 - 0.3e1 / 0.2e1 * t2975 - 0.9e1 / 0.4e1 * t5 * t439 * t561 - 0.3e1 / 0.8e1 * t5 * t3003 * t26 * t91 - 0.3e1 / 0.2e1 * t5 * t1134 * t235;
  t3012 = my_piecewise3(t1, 0, t3011);
  t3013 = t100 * t100;
  t3015 = 0.1e1 / t567 / t3013;
  t3016 = t569 * t569;
  t3022 = t575 * t575;
  t3027 = t97 * t2995;
  t3030 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t1125 + 0.24e2 * t3027);
  t3034 = my_piecewise3(t101, 0, 0.4e2 / 0.81e2 * t3015 * t3016 - 0.16e2 / 0.9e1 * t1337 * t569 * t575 + 0.4e1 / 0.3e1 * t568 * t3022 + 0.16e2 / 0.9e1 * t1341 * t1347 + 0.4e1 / 0.3e1 * t102 * t3030);
  t3041 = t5 * t1351 * t175 * t157;
  t3045 = t5 * t579 * t451 * t157;
  t3049 = t5 * t246 * t1156 * t157;
  t3054 = 0.1e2 / 0.27e2 * t5 * t104 * t2957 * t157;
  t3056 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t3034 * t26 * t157 - t3041 / 0.2e1 + t3045 / 0.2e1 - 0.5e1 / 0.9e1 * t3049 + t3054);
  tv4rho40 = 0.4e1 * t1335 + 0.4e1 * t1369 + t6 * (t3012 + t3056);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3063 = t5 * t263 * t1156 * t91;
  t3067 = t5 * t604 * t451 * t91;
  t3068 = t3067 / 0.4e1;
  t3073 = t5 * t1401 * t235;
  t3074 = t3073 / 0.4e1;
  t3076 = t5 * t609 * t561;
  t3079 = t5 * t1394 * t235;
  t3100 = 0.12e2 * t1125;
  t3101 = 0.24e2 * t2996;
  t3103 = my_piecewise5(t10, 0, t14, 0, -t3100 + t3101);
  t3107 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2982 * t260 * t1118 - 0.8e1 / 0.9e1 * t1117 * t600 * t426 - 0.8e1 / 0.9e1 * t1374 * t166 * t434 + 0.4e1 / 0.3e1 * t425 * t1385 * t166 + 0.4e1 / 0.3e1 * t1377 * t434 + 0.4e1 / 0.9e1 * t596 * t1129 + 0.4e1 / 0.3e1 * t23 * t3103);
  t3117 = t5 * t1389 * t175 * t91;
  t3128 = -0.5e1 / 0.36e2 * t3063 + t3068 - 0.3e1 / 0.8e1 * t5 * t264 * t1330 + t3074 - 0.3e1 / 0.8e1 * t3076 - 0.3e1 / 0.4e1 * t3079 - 0.9e1 / 0.8e1 * t5 * t605 * t561 - 0.3e1 / 0.8e1 * t5 * t3107 * t26 * t91 - 0.9e1 / 0.8e1 * t5 * t1390 * t235 - 0.3e1 / 0.8e1 * t3117 - t2940 / 0.8e1 + t2943 / 0.4e1 - 0.5e1 / 0.12e2 * t2946 + t2952 / 0.2e1 - 0.3e1 / 0.8e1 * t2954 + t2961 - 0.5e1 / 0.12e2 * t2964 - t2968 / 0.8e1 + t2972 / 0.4e1 - 0.3e1 / 0.8e1 * t2975;
  t3129 = my_piecewise3(t1, 0, t3128);
  t3146 = 0.24e2 * t3027;
  t3148 = my_piecewise5(t14, 0, t10, 0, t3100 + t3146);
  t3152 = my_piecewise3(t101, 0, 0.4e2 / 0.81e2 * t3015 * t271 * t1338 - 0.8e1 / 0.9e1 * t1337 * t624 * t569 - 0.8e1 / 0.9e1 * t1418 * t243 * t575 + 0.4e1 / 0.3e1 * t568 * t1428 * t243 + 0.4e1 / 0.3e1 * t1421 * t575 + 0.4e1 / 0.9e1 * t620 * t1347 + 0.4e1 / 0.3e1 * t102 * t3148);
  t3159 = t5 * t1432 * t175 * t157;
  t3163 = t5 * t628 * t451 * t157;
  t3164 = t3163 / 0.4e1;
  t3167 = t5 * t274 * t1156 * t157;
  t3176 = t5 * t1356 * t334;
  t3179 = t5 * t1360 * t334;
  t3180 = t3179 / 0.4e1;
  t3182 = t5 * t1364 * t334;
  t3184 = -0.3e1 / 0.8e1 * t5 * t3152 * t26 * t157 - 0.3e1 / 0.8e1 * t3159 + t3164 - 0.5e1 / 0.36e2 * t3167 - t3041 / 0.8e1 + t3045 / 0.4e1 - 0.5e1 / 0.12e2 * t3049 + t3054 - 0.3e1 / 0.8e1 * t5 * t1352 * t334 - 0.3e1 / 0.8e1 * t3176 + t3180 - 0.5e1 / 0.36e2 * t3182;
  t3185 = my_piecewise3(t96, 0, t3184);
  tv4rho41 = t1335 + t1369 + 0.3e1 * t1417 + 0.3e1 * t1457 + t6 * (t3129 + t3185);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t3194 = t5 * t659 * t451 * t91;
  t3198 = t5 * t1473 * t175 * t91;
  t3201 = t5 * t1478 * t235;
  t3214 = t600 * t600;
  t3227 = my_piecewise5(t10, 0, t14, 0, t3101);
  t3231 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2982 * t650 * t426 - 0.32e2 / 0.27e2 * t1374 * t166 * t600 - 0.8e1 / 0.27e2 * t1460 * t434 + 0.8e1 / 0.9e1 * t425 * t3214 + 0.8e1 / 0.9e1 * t596 * t1385 - 0.8e1 / 0.27e2 * t1117 * t655 * t426 + 0.8e1 / 0.9e1 * t425 * t1469 * t166 + 0.4e1 / 0.9e1 * t1465 * t434 + 0.4e1 / 0.3e1 * t23 * t3227);
  t3250 = t3194 / 0.12e2 - t3198 / 0.4e1 - t3201 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t660 * t561 - 0.3e1 / 0.8e1 * t5 * t3231 * t26 * t91 - 0.3e1 / 0.4e1 * t5 * t1474 * t235 - 0.5e1 / 0.18e2 * t3063 + t3067 / 0.3e1 + t3073 / 0.3e1 - t3076 / 0.4e1 - t3079 / 0.2e1 - t3117 / 0.4e1 + t2943 / 0.12e2 - 0.5e1 / 0.18e2 * t2946 + t2952 / 0.6e1 + t2961 - 0.5e1 / 0.18e2 * t2964 + t2972 / 0.12e2;
  t3251 = my_piecewise3(t1, 0, t3250);
  t3260 = t624 * t624;
  t3273 = my_piecewise5(t14, 0, t10, 0, t3146);
  t3277 = my_piecewise3(t101, 0, 0.4e2 / 0.81e2 * t3015 * t667 * t569 - 0.32e2 / 0.27e2 * t1418 * t243 * t624 - 0.8e1 / 0.27e2 * t1490 * t575 + 0.8e1 / 0.9e1 * t568 * t3260 + 0.8e1 / 0.9e1 * t620 * t1428 - 0.8e1 / 0.27e2 * t1337 * t672 * t569 + 0.8e1 / 0.9e1 * t568 * t1499 * t243 + 0.4e1 / 0.9e1 * t1495 * t575 + 0.4e1 / 0.3e1 * t102 * t3273);
  t3284 = t5 * t1503 * t175 * t157;
  t3288 = t5 * t676 * t451 * t157;
  t3297 = t5 * t1437 * t334;
  t3300 = t5 * t1441 * t334;
  t3311 = t5 * t584 * t786;
  t3314 = t5 * t588 * t786;
  t3316 = -0.3e1 / 0.8e1 * t5 * t3277 * t26 * t157 - t3284 / 0.4e1 + t3288 / 0.12e2 - t3159 / 0.4e1 + t3163 / 0.3e1 - 0.5e1 / 0.18e2 * t3167 - 0.3e1 / 0.4e1 * t5 * t1433 * t334 - t3297 / 0.2e1 + t3300 / 0.6e1 + t3045 / 0.12e2 - 0.5e1 / 0.18e2 * t3049 + t3054 - t3176 / 0.4e1 + t3179 / 0.3e1 - 0.5e1 / 0.18e2 * t3182 - 0.3e1 / 0.8e1 * t5 * t580 * t786 - t3311 / 0.4e1 + t3314 / 0.12e2;
  t3317 = my_piecewise3(t96, 0, t3316);
  tv4rho42 = 0.2e1 * t1417 + 0.2e1 * t1457 + 0.2e1 * t1489 + 0.2e1 * t1528 + t6 * (t3251 + t3317);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t3338 = my_piecewise5(t10, 0, t14, 0, t3100 + t3101);
  t3342 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2982 * t1533 * t166 - 0.8e1 / 0.9e1 * t1460 * t600 - 0.8e1 / 0.9e1 * t1374 * t655 * t166 + 0.4e1 / 0.3e1 * t1377 * t655 + 0.4e1 / 0.3e1 * t596 * t1469 + 0.4e1 / 0.9e1 * t425 * t1540 * t166 + 0.4e1 / 0.3e1 * t23 * t3338);
  t3349 = t5 * t1544 * t175 * t91;
  t3360 = -0.3e1 / 0.8e1 * t5 * t3342 * t26 * t91 - t3349 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1545 * t235 - 0.3e1 / 0.8e1 * t3198 + t3194 / 0.4e1 - 0.3e1 / 0.8e1 * t3201 + t3068 - 0.5e1 / 0.12e2 * t3063 + t3074 - 0.5e1 / 0.36e2 * t2964 + t2961 - 0.5e1 / 0.36e2 * t2946;
  t3361 = my_piecewise3(t1, 0, t3360);
  t3378 = my_piecewise5(t14, 0, t10, 0, -t3100 + t3146);
  t3382 = my_piecewise3(t101, 0, 0.4e2 / 0.81e2 * t3015 * t1553 * t243 - 0.8e1 / 0.9e1 * t1490 * t624 - 0.8e1 / 0.9e1 * t1418 * t672 * t243 + 0.4e1 / 0.3e1 * t1421 * t672 + 0.4e1 / 0.3e1 * t620 * t1499 + 0.4e1 / 0.9e1 * t568 * t1560 * t243 + 0.4e1 / 0.3e1 * t102 * t3378);
  t3389 = t5 * t1564 * t175 * t157;
  t3397 = t5 * t1508 * t334;
  t3406 = t5 * t633 * t786;
  t3416 = t5 * t251 * t1743;
  t3418 = -0.3e1 / 0.8e1 * t5 * t3382 * t26 * t157 - t3389 / 0.8e1 - 0.3e1 / 0.8e1 * t3284 + t3288 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1504 * t334 - 0.3e1 / 0.8e1 * t3397 + t3164 - 0.5e1 / 0.12e2 * t3167 - 0.3e1 / 0.4e1 * t3297 + t3300 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t629 * t786 - 0.3e1 / 0.8e1 * t3406 - 0.5e1 / 0.36e2 * t3049 + t3054 + t3180 - 0.5e1 / 0.12e2 * t3182 - 0.3e1 / 0.8e1 * t3311 + t3314 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t247 * t1743 - t3416 / 0.8e1;
  t3419 = my_piecewise3(t96, 0, t3418);
  tv4rho43 = 0.3e1 * t1489 + 0.3e1 * t1528 + t1552 + t1748 + t6 * (t3361 + t3419);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3424 = t650 * t650;
  t3429 = t655 * t655;
  t3436 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t1125 + 0.24e2 * t2996);
  t3440 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2982 * t3424 - 0.16e2 / 0.9e1 * t1460 * t655 + 0.4e1 / 0.3e1 * t425 * t3429 + 0.16e2 / 0.9e1 * t596 * t1540 + 0.4e1 / 0.3e1 * t23 * t3436);
  t3449 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t3440 * t26 * t91 - t3349 / 0.2e1 + t3194 / 0.2e1 - 0.5e1 / 0.9e1 * t3063 + t2961);
  t3450 = 0.1e1 / t2080;
  t3451 = t748 * t3450;
  t3454 = t707 * t1081;
  t3467 = sigma[2] * t2671;
  t3475 = t141 * t112 * t126;
  t3486 = 0.17761503768095333368e-3 * t1739 * t3451 + 0.1792e4 / 0.9e1 * t1669 * t3454 * t1670 - 0.1792e4 / 0.9e1 * t729 * t3454 * t691 + 0.56e2 / 0.3e1 * t1677 * t738 - 0.896e3 / 0.9e1 * t1699 * t1591 + 0.448e3 / 0.9e1 * t734 * t1664 + 0.13664e5 / 0.81e2 * t729 * t3467 * t691 - 0.6832e4 / 0.81e2 * t298 * t3467 * t112 - 0.364e4 / 0.81e2 * t281 * t3475 + 0.6832e4 / 0.81e2 * t702 * t2671 * t112 * t126 - 0.1792e4 / 0.9e1 * t1680 * t1081 * t1670 * t126;
  t3494 = t106 * t141;
  t3501 = 0.1e1 / t107 / t939;
  t3502 = t137 * t3501;
  t3512 = t280 * t1655;
  t3520 = t1668 * t332;
  t3523 = 0.1792e4 / 0.9e1 * t1685 * t1081 * t691 * t126 + 0.896e3 / 0.27e2 * t298 * t3454 * t112 + 0.364e4 / 0.81e2 * t298 * t3494 * t112 - 0.112e4 / 0.27e2 * t734 * t1585 - 0.256e3 / 0.81e2 * t298 * t3502 * t112 - 0.32e2 / 0.3e1 * t1677 * t741 - 0.13664e5 / 0.81e2 * t688 * t2671 * t691 * t126 - 0.16e2 / 0.3e1 * t3512 * t300 - 0.256e3 / 0.27e2 * t734 * t1659 + 0.3584e4 / 0.81e2 * t729 * t3502 * t691 - 0.512e3 / 0.9e1 * t3520 * t1671;
  t3526 = 0.1e1 / t1667 / t113;
  t3527 = t3526 * t155;
  t3528 = t691 * t691;
  t3537 = t687 * t784;
  t3554 = t106 * t748;
  t3557 = 0.1e1 / t107 / t1607;
  t3566 = t3501 * t112;
  t3573 = t691 * t716 * t68;
  t3576 = 0.2048e4 / 0.27e2 * t3527 * t3502 * t3528 - 0.1024e4 / 0.9e1 * t1669 * t3502 * t1670 + 0.512e3 / 0.9e1 * t1699 * t1674 + 0.64e2 / 0.3e1 * t3537 * t731 - 0.2048e4 / 0.27e2 * t3526 * t137 * t3501 * t3528 * t126 + 0.1024e4 / 0.9e1 * t1668 * t137 * t3501 * t1670 * t126 - 0.3584e4 / 0.81e2 * t1715 * t3501 * t691 * t126 - 0.43058190952958383923e-4 * t280 * t3554 * t3557 * t112 * t1738 - 0.896e3 / 0.27e2 * t708 * t1081 * t112 * t126 + 0.256e3 / 0.81e2 * t1724 * t3566 * t126 + 0.38213878438219709336e-1 * t687 * t748 * t3450 * t3573;
  t3584 = t1670 * t289 * t43;
  t3594 = t1729 * t2565;
  t3607 = t115 / t1737 / t123;
  t3609 = t750 * t303;
  t3611 = 0.1e1 / t117 / t3609;
  t3616 = t133 * t2671;
  t3633 = t750 * t750;
  t3638 = t68 * t129;
  t3644 = 0.14334705075445816187e-1 * t68 * t3502;
  t3647 = t1619 * t317;
  t3650 = t760 * t766;
  t3655 = t314 * t1630;
  t3664 = t145 / t1629 / t152;
  t3665 = t768 * t768;
  t3671 = t782 * t782;
  t3691 = 0.1e1 / t325 / t1648 / t324;
  t3698 = (0.47272386831275720165e2 * t68 * t3502 * t129 - 0.13254471879286694102e4 * t749 * t3450 * t129 + 0.16893461362597165067e4 * t1606 * t3611 * t1611 - 0.57460752934003962812e3 * t522 * t1605 * sigma[2] / t107 / t3633 / rho[1] * t3638 + 0.2618e4 / 0.243e3 * t132 * t3616 - t3644) * t153 - 0.4e1 * t3647 * t330 + 0.12e2 * t3650 * t768 - 0.6e1 * t1621 * t782 - 0.24e2 * t3655 * t1632 + 0.24e2 * t1624 * t1635 - 0.4e1 * t762 * t1653 + 0.24e2 * t3664 * t3665 - 0.36e2 * t1631 * t768 * t782 + 0.6e1 * t767 * t3671 + 0.8e1 * t767 * t330 * t1653 - t318 * (0.73567695473251028803e0 * t79 * t3494 * t148 + 0.13631756691604938272e2 * t43 * t3467 * t326 - 0.37118709523050054497e2 * t68 * t3502 * t778 + 0.41814995283388186444e1 * t3451 * t1650 - 0.30251844539326121245e1 * t1605 * t3611 * t3691 * t38 * t42 + t3644);
  t3700 = -0.19106939219109854667e-1 * t280 * t748 * t3450 * t1734 - 0.20889989210465385248e1 * t1668 * t1728 * t2565 * t3584 + 0.20889989210465385248e1 * t687 * t1728 * t2565 * t1718 + 0.3264060814135216445e1 * t1724 * t3501 * t712 - 0.34816648684108975414e0 * t3594 * t712 - 0.65281216282704328902e1 * t1715 * t3501 * t1718 - 0.73876576426593732207e1 * t708 * t1081 * t712 + 0.13852530933854644634e0 * t3594 * t1734 - 0.78765980119400302024e-6 * t3607 * t1605 * t3611 * t38 * t42 + 0.35605463380858319389e1 * t291 * t3616 - 0.19485097391154737208e0 * t718 * t719 * t3501 + t114 * t3698;
  t3712 = t667 * t667;
  t3717 = t672 * t672;
  t3724 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t1125 + 0.24e2 * t3027);
  t3728 = my_piecewise3(t101, 0, 0.4e2 / 0.81e2 * t3015 * t3712 - 0.16e2 / 0.9e1 * t1490 * t672 + 0.4e1 / 0.3e1 * t568 * t3717 + 0.16e2 / 0.9e1 * t620 * t1560 + 0.4e1 / 0.3e1 * t102 * t3724);
  t3744 = -0.3e1 / 0.8e1 * t5 * t105 * (t3486 + t3523 + t3576 + t3700) - 0.3e1 / 0.2e1 * t5 * t275 * t1743 - 0.9e1 / 0.4e1 * t5 * t677 * t786 - 0.3e1 / 0.8e1 * t5 * t3728 * t26 * t157 - 0.3e1 / 0.2e1 * t5 * t1565 * t334 - 0.3e1 / 0.2e1 * t3406 - t3416 / 0.2e1 - t3389 / 0.2e1 - 0.3e1 / 0.2e1 * t3397 + t3300 + t3314 / 0.2e1 + t3288 / 0.2e1 - 0.5e1 / 0.9e1 * t3167 - 0.5e1 / 0.9e1 * t3182 + t3054;
  t3745 = my_piecewise3(t96, 0, t3744);
  tv4rho44 = 0.4e1 * t1552 + 0.4e1 * t1748 + t6 * (t3449 + t3745);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t3753 = t5 * t1138 * t377;
  t3759 = t5 * t1145 * t377;
  t3762 = t5 * t443 * t874;
  t3769 = 0.5e1 / 0.36e2 * t5 * t1157 * t377;
  t3771 = t5 * t452 * t874;
  t3774 = t5 * t176 * t1917;
  t3782 = t523 * t38 * t42;
  t3798 = t481 * t1170;
  t3803 = t489 * t65;
  t3804 = t3803 * t492;
  t3813 = t181 * t1177;
  t3817 = t460 * t1177;
  t3821 = 0.50902080263409847198e-1 * t491 * t67 * t1177 * sigma[0] + 0.29537242544775113257e-6 * t2846 * t1251 * t3782 + 0.28e2 / 0.3e1 * t1832 * t511 + 0.112e3 / 0.9e1 * t833 * t1189 - 0.88e2 / 0.9e1 * t199 * t1192 * t28 * t34 - 0.224e3 / 0.9e1 * t1849 * t1309 + 0.17789131437036929626e1 * t182 * t1192 * t485 - 0.43886251018892947439e-1 * t3798 * t1173 + 0.71651022071661955003e-2 * t181 * t1236 * t34 * t3804 - 0.14330204414332391001e-1 * t460 * t1236 * t464 * t3804 + 0.1305624325654086578e0 * t3798 * t485 - 0.10036987003465790569e1 * t3813 * t34 * t1770 + 0.20073974006931581138e1 * t3817 * t464 * t1770;
  t3825 = t1769 * t42 * t480;
  t3837 = t2788 * t54;
  t3874 = 0.78337459539245194682e0 * t1204 * t1170 * t1206 * t3825 - 0.78337459539245194681e0 * t460 * t1170 * t464 * t3825 + t2779 * t352 / 0.2e1 - 0.16e2 * t1225 * t1840 + 0.256e3 / 0.9e1 * t2786 * t1177 * t3837 * sigma[0] - 0.128e3 / 0.3e1 * t1204 * t1177 * t1819 * sigma[0] + 0.448e3 / 0.27e2 * t3817 * t801 * sigma[0] - 0.32e2 / 0.27e2 * t3813 * sigma[0] * t34 * t54 + 0.1614682160735939397e-4 * t1168 / t29 / t1863 * t34 * t1233 + 0.176e3 / 0.3e1 * t1204 * t1192 * t1820 - 0.176e3 / 0.3e1 * t460 * t1192 * t1824 - 0.256e3 / 0.9e1 * t2813 * t1177 * t2788 * sigma[0] + 0.128e3 / 0.3e1 * t1228 * t1177 * t1206 * sigma[0] - 0.2e1 * t1200 * t827;
  t3881 = t342 * t1280;
  t3908 = sigma[0] * t1177;
  t3910 = 0.34403292181069958848e-2 * t68 * t3908;
  t3962 = t852 * t541;
  t3965 = t365 * t1271;
  t3976 = t1876 * t218;
  t3981 = -0.18e2 * t1272 * t870 * t543 - 0.3e1 * t1262 * t870 + 0.6e1 * t1265 * t1896 - 0.6e1 * t3965 * t1273 + 0.6e1 * t1881 * t1276 - t854 * t1296 - 0.3e1 * t1878 * t557 - 0.3e1 * t537 * t1912 - 0.3e1 * t3976 * t231 - t2880 * t373 + 0.6e1 * t3962 * t543;
  t4000 = 0.88e2 / 0.9e1 * t181 * t1192 * t1829 + 0.14e2 / 0.3e1 * t507 * t1807 - 0.14e3 / 0.27e2 * t199 * t3881 * t34 - 0.62833170672102916563e0 * t191 * t43 * t1182 + 0.14e3 / 0.27e2 * t343 * t1306 - 0.28e3 / 0.27e2 * t833 * t1300 + t36 * (-t219 * (-0.8488580246913580247e-1 * t79 * t3881 * t82 - 0.25807694707407407406e1 * t43 * t1182 * t227 + 0.99339624583399221521e1 * t68 * t1177 * t553 * sigma[0] - 0.13664543101535782356e1 * t1236 * t1293 * t69 + 0.11344441702247295467e1 * t1251 * t2924 * t3782 - t3910) - 0.18e2 * t1272 * t857 * t557 + 0.24e2 * t2897 * t373 * t1273 - 0.18e2 * t2888 * t1890 + (-0.11775432098765432099e2 * t68 * t1177 * t57 * sigma[0] + 0.39755658436213991769e3 * t522 * t1236 * t843 - 0.57532578875171467763e3 * t522 * t1251 * t523 * t1253 + 0.21547782350251486053e3 * t522 / t29 / t2866 * t1247 * t2871 - 0.154e3 / 0.81e2 * t60 * t42 * t1182 + t3910) * t87 + 0.6e1 * t542 * t1912 * t231 + 0.6e1 * t542 * t870 * t557 + 0.2e1 * t542 * t373 * t1296 + 0.6e1 * t2883 * t857 + 0.12e2 * t1265 * t1893 + t3981) + 0.2e1 * t1200 * t830 + 0.2e2 * t1225 * t465 - 0.4e1 * t2782 * t821 - 0.952e3 / 0.27e2 * t502 * t1312 - 0.176e3 / 0.3e1 * t1228 * t1207 * t28 + 0.176e3 / 0.3e1 * t502 * t1212 * t28 + 0.16e2 * t2810 * t1836;
  t4024 = t181 * t1914;
  t4027 = t1204 * t375;
  t4034 = t460 * t872;
  t4037 = 0.476e3 / 0.27e2 * t199 * t1216 - 0.1e2 * t507 * t476 - 0.476e3 / 0.27e2 * t181 * t1182 * t807 - 0.57523051976217841017e-4 * t1234 * t1236 * t69 + 0.952e3 / 0.27e2 * t460 * t1182 * t801 - 0.64e2 / 0.27e2 * t833 * t1194 + 0.8e1 / 0.3e1 * t507 * t1846 - 0.448e3 / 0.27e2 * t502 * t3908 * t464 + 0.32e2 / 0.27e2 * t199 * t3908 * t34 - 0.4e1 * t4024 * t201 - 0.128e3 / 0.9e1 * t4027 * t1229 + 0.128e3 / 0.9e1 * t1849 * t1197 - 0.16e2 / 0.3e1 * t1832 * t514 + 0.32e2 / 0.3e1 * t4034 * t504;
  t4044 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1134 * t377 - 0.3e1 / 0.8e1 * t3753 - 0.9e1 / 0.8e1 * t5 * t439 * t874 + t3759 / 0.4e1 - 0.3e1 / 0.4e1 * t3762 - 0.9e1 / 0.8e1 * t5 * t170 * t1917 - t3769 + t3771 / 0.4e1 - 0.3e1 / 0.8e1 * t3774 - 0.3e1 / 0.8e1 * t5 * t27 * (t3821 + t3874 + t4000 + t4037));
  tv4rho3sigma0 = t6 * t4044 + 0.3e1 * t1922;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t4051 = t5 * t1356 * t417;
  t4054 = t5 * t1360 * t417;
  t4058 = 0.5e1 / 0.36e2 * t5 * t1364 * t417;
  t4060 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t1352 * t417 - 0.3e1 / 0.8e1 * t4051 + t4054 / 0.4e1 - t4058);
  tv4rho3sigma2 = t6 * t4060 + 0.3e1 * t1935;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t4062 = 0.2e1 * t1949;
  t4068 = t5 * t1394 * t377 / 0.4e1;
  t4073 = t5 * t1401 * t377;
  t4077 = t5 * t609 * t874 / 0.4e1;
  t4086 = -0.3e1 / 0.8e1 * t5 * t1390 * t377 - t4068 - 0.3e1 / 0.4e1 * t5 * t605 * t874 + t4073 / 0.12e2 - t4077 - 0.3e1 / 0.8e1 * t5 * t264 * t1917 - t3753 / 0.8e1 + t3759 / 0.6e1 - t3762 / 0.4e1 - t3769 + t3771 / 0.6e1 - t3774 / 0.8e1;
  t4087 = my_piecewise3(t1, 0, t4086);
  tv4rho3sigma3 = t6 * t4087 + t1922 + t4062;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t4089 = 0.2e1 * t1965;
  t4095 = t5 * t1437 * t417 / 0.4e1;
  t4097 = t5 * t1441 * t417;
  t4106 = t5 * t584 * t973 / 0.4e1;
  t4108 = t5 * t588 * t973;
  t4111 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t1433 * t417 - t4095 + t4097 / 0.12e2 - t4051 / 0.8e1 + t4054 / 0.6e1 - t4058 - 0.3e1 / 0.8e1 * t5 * t580 * t973 - t4106 + t4108 / 0.12e2);
  tv4rho3sigma5 = t6 * t4111 + t1935 + t4089;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t4117 = t5 * t1478 * t377;
  t4126 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1474 * t377 - t4117 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t660 * t874 - t4068 + t4073 / 0.6e1 - t4077 + t3759 / 0.12e2 - t3769 + t3771 / 0.12e2);
  tv4rho3sigma6 = t6 * t4126 + t1973 + t4062;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t4132 = t5 * t1508 * t417;
  t4139 = t5 * t633 * t973;
  t4147 = t5 * t251 * t2134;
  t4149 = -0.3e1 / 0.8e1 * t5 * t1504 * t417 - t4132 / 0.8e1 - t4095 + t4097 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t629 * t973 - t4139 / 0.4e1 + t4054 / 0.12e2 - t4058 - t4106 + t4108 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t247 * t2134 - t4147 / 0.8e1;
  t4150 = my_piecewise3(t96, 0, t4149);
  tv4rho3sigma8 = t6 * t4150 + t2139 + t4089;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t4159 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1545 * t377 - 0.3e1 / 0.8e1 * t4117 + t4073 / 0.4e1 - t3769);
  tv4rho3sigma9 = t6 * t4159 + 0.3e1 * t1973;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t4176 = t280 * t1595;
  t4182 = t716 * t65;
  t4183 = t4182 * t719;
  t4186 = t708 * t1731;
  t4196 = t687 * t1595;
  t4203 = t1986 * t42 * t707;
  t4220 = -0.10036987003465790569e1 * t4176 * t112 * t1987 - 0.14330204414332391001e-1 * t687 * t1601 * t691 * t4183 - 0.43886251018892947439e-1 * t4186 * t1734 + 0.71651022071661955003e-2 * t280 * t1601 * t112 * t4183 + 0.17789131437036929626e1 * t281 * t1657 * t712 + 0.20073974006931581138e1 * t4196 * t691 * t1987 + 0.78337459539245194682e0 * t1668 * t1731 * t1670 * t4203 - 0.78337459539245194681e0 * t687 * t1731 * t691 * t4203 + 0.1305624325654086578e0 * t4186 * t712 - 0.952e3 / 0.27e2 * t729 * t1702 + 0.2e1 * t1677 * t929 - 0.1e2 * t734 * t703 - 0.4e1 * t3537 * t920;
  t4234 = t687 * t971;
  t4237 = t280 * t2131;
  t4242 = t1668 * t415;
  t4251 = t1595 * sigma[2];
  t4258 = 0.2e2 * t1699 * t692 - 0.57523051976217841017e-4 * t1739 * t1601 * t137 + 0.952e3 / 0.27e2 * t687 * t1589 * t900 + 0.476e3 / 0.27e2 * t298 * t1691 - 0.476e3 / 0.27e2 * t280 * t1589 * t906 + 0.32e2 / 0.3e1 * t4234 * t731 - 0.4e1 * t4237 * t300 - 0.16e2 / 0.3e1 * t2031 * t741 - 0.128e3 / 0.9e1 * t4242 * t1671 + 0.128e3 / 0.9e1 * t2043 * t1674 - 0.64e2 / 0.27e2 * t932 * t1659 + 0.8e1 / 0.3e1 * t734 * t2049 - 0.448e3 / 0.27e2 * t729 * t4251 * t691 + 0.32e2 / 0.27e2 * t298 * t4251 * t112;
  t4297 = 0.16e2 * t3520 * t2036 - 0.256e3 / 0.9e1 * t3527 * t1595 * t3528 * sigma[2] + 0.128e3 / 0.3e1 * t1669 * t1595 * t1670 * sigma[2] - 0.16e2 * t1699 * t2040 + t3512 * t392 / 0.2e1 - 0.176e3 / 0.3e1 * t1669 * t1681 * t106 + 0.176e3 / 0.3e1 * t729 * t1686 * t106 + 0.28e2 / 0.3e1 * t2031 * t738 - 0.88e2 / 0.9e1 * t298 * t1657 * t106 * t112 + 0.112e3 / 0.9e1 * t932 * t1664 - 0.224e3 / 0.9e1 * t2043 * t1591 - 0.2e1 * t1677 * t926 + 0.88e2 / 0.9e1 * t280 * t1657 * t2026 - 0.28e3 / 0.27e2 * t932 * t1585;
  t4318 = t3528 * t126;
  t4331 = t382 * t1583;
  t4339 = t748 * t38 * t42;
  t4375 = 0.34403292181069958848e-2 * t68 * t4251;
  t4402 = t2093 * t317;
  t4424 = t951 * t766;
  t4427 = t405 * t1630;
  t4434 = -0.18e2 * t1631 * t969 * t768 + 0.2e1 * t767 * t413 * t1653 + 0.6e1 * t767 * t2129 * t330 + 0.6e1 * t767 * t969 * t782 + 0.12e2 * t1624 * t2110 + 0.6e1 * t1624 * t2113 - 0.6e1 * t4427 * t1632 + 0.6e1 * t2098 * t1635 - 0.3e1 * t2095 * t782 + 0.6e1 * t3650 * t956 + 0.6e1 * t4424 * t768;
  t4437 = 0.1614682160735939397e-4 * t1729 / t107 / t2080 * t112 * t1738 + 0.448e3 / 0.27e2 * t4196 * t900 * sigma[2] - 0.32e2 / 0.27e2 * t4176 * sigma[2] * t112 * t126 + 0.176e3 / 0.3e1 * t1668 * t1657 * t2017 - 0.176e3 / 0.3e1 * t687 * t1657 * t2021 + 0.256e3 / 0.9e1 * t3526 * t1595 * t4318 * sigma[2] - 0.128e3 / 0.3e1 * t1668 * t1595 * t2016 * sigma[2] - 0.62833170672102916563e0 * t290 * t43 * t1589 + 0.14e2 / 0.3e1 * t734 * t2005 - 0.14e3 / 0.27e2 * t298 * t4331 * t112 + 0.14e3 / 0.27e2 * t383 * t1707 + 0.29537242544775113257e-6 * t3607 * t1609 * t4339 + 0.50902080263409847198e-1 * t718 * t67 * t1595 * sigma[2] + t114 * (-0.18e2 * t1631 * t956 * t782 + 0.24e2 * t3664 * t413 * t1632 - 0.18e2 * t3655 * t2107 + (-0.11775432098765432099e2 * t68 * t1595 * t129 * sigma[2] + 0.39755658436213991769e3 * t522 * t1601 * t942 - 0.57532578875171467763e3 * t522 * t1609 * t748 * t1611 + 0.21547782350251486053e3 * t522 / t107 / t3633 * t1605 * t3638 - 0.154e3 / 0.81e2 * t132 * t42 * t1589 + t4375) * t153 - t318 * (-0.8488580246913580247e-1 * t79 * t4331 * t148 - 0.25807694707407407406e1 * t43 * t1589 * t326 + 0.99339624583399221521e1 * t68 * t1595 * t778 * sigma[2] - 0.13664543101535782356e1 * t1601 * t1650 * t137 + 0.11344441702247295467e1 * t1609 * t3691 * t4339 - t4375) - 0.3e1 * t762 * t2129 - t953 * t1653 - t3647 * t413 - 0.3e1 * t1621 * t969 - 0.3e1 * t4402 * t330 + t4434);
  t4444 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t1565 * t417 - 0.3e1 / 0.8e1 * t4132 - 0.9e1 / 0.8e1 * t5 * t677 * t973 + t4097 / 0.4e1 - 0.3e1 / 0.4e1 * t4139 - 0.9e1 / 0.8e1 * t5 * t275 * t2134 - t4058 + t4108 / 0.4e1 - 0.3e1 / 0.8e1 * t4147 - 0.3e1 / 0.8e1 * t5 * t105 * (t4220 + t4258 + t4297 + t4437));
  tv4rho3sigma11 = t6 * t4444 + 0.3e1 * t2139;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t4451 = t5 * t443 * t1042;
  t4458 = t5 * t452 * t1042 / 0.12e2;
  t4460 = t5 * t176 * t2281;
  t4464 = t986 * t470;
  t4470 = t181 * t2278;
  t4494 = t68 * t495;
  t4495 = 0.46913580246913580247e-3 * t4494;
  t4525 = -0.24e2 * t1272 * t857 * t870 + (-0.97158950617283950615e2 * t1860 * t1016 + 0.18180941358024691358e3 * t1866 * t38 * t2237 - 0.80804183813443072701e2 * t522 / t29 / t525 / t493 * t65 * t67 * t523 * t57 + 0.17686419753086419752e1 * t68 * t1856 - t4495) * t87 - 0.12e2 * t3965 * t1890 + 0.8e1 * t1881 * t1893 + 0.4e1 * t1881 * t1896 - 0.6e1 * t1272 * t1038 * t543 + 0.24e2 * t2897 * t1026 * t543 + 0.8e1 * t1265 * t2258 - 0.6e1 * t1272 * t1026 * t557 + 0.8e1 * t3962 * t857 + 0.4e1 * t542 * t373 * t1912 + 0.4e1 * t1265 * t2262 + 0.4e1 * t542 * t2276 * t231;
  t4531 = t870 * t870;
  t4534 = t1022 * t541;
  t4545 = t2243 * t218;
  t4552 = t980 * t463;
  t4562 = t69 * t38 * t42;
  t4570 = 0.2e1 * t542 * t1038 * t557 - 0.12e2 * t2888 * t2255 + 0.4e1 * t542 * t4531 + 0.2e1 * t4534 * t543 - 0.2e1 * t854 * t1912 + 0.2e1 * t2883 * t1026 - 0.2e1 * t3976 * t373 - 0.4e1 * t1878 * t870 - 0.2e1 * t4545 * t231 - t2245 * t557 - t219 * (-0.1273287037037037037e-1 * t79 * t4464 * t82 + 0.49630182129629629625e-1 * t43 * t4552 * t227 - 0.17773414759800945055e1 * t68 * t1905 + 0.39481569207306256398e0 * t1909 * sigma[0] - 0.42541656383427358e0 * t1865 * t2924 * t4562 + t4495) - t1262 * t1038 - 0.2e1 * t537 * t2276;
  t4594 = 0.28e2 / 0.9e1 * t2205 * t511 - 0.7e1 / 0.9e1 * t199 * t4464 * t34 + 0.28e2 / 0.9e1 * t833 * t1807 - 0.8e1 / 0.3e1 * t4470 * t201 - 0.16e2 / 0.9e1 * t2205 * t514 + t36 * (t4525 + t4570) + 0.16272968651166889234e-4 * t1234 * t527 * sigma[0] + 0.8e1 / 0.3e1 * t1832 * t830 + 0.32e2 / 0.3e1 * t2813 * t495 * t2788 - 0.16e2 * t1228 * t495 * t1206 + 0.56e2 / 0.9e1 * t502 * t495 * t464 - 0.4e1 / 0.9e1 * t199 * t495 * t34 - 0.56e2 / 0.9e1 * t1767 * t801 + 0.4e1 / 0.9e1 * t1776 * t807;
  t4605 = t460 * t1040;
  t4632 = -0.16e2 / 0.3e1 * t4034 * t821 - 0.32e2 / 0.3e1 * t2786 * t495 * t3837 + 0.16e2 * t1204 * t495 * t1819 - 0.8e1 / 0.3e1 * t1832 * t827 + 0.32e2 / 0.9e1 * t4605 * t504 - 0.7e1 / 0.9e1 * t199 * t4552 * t34 + 0.32e2 / 0.3e1 * t4027 * t1836 - 0.32e2 / 0.3e1 * t1849 * t1840 + 0.2e1 / 0.3e1 * t507 * t2211 + 0.14e2 / 0.9e1 * t502 * t4552 * t464 - t1200 * t1008 / 0.4e1 + 0.16e2 / 0.9e1 * t833 * t1846 - 0.60550581027597727388e-5 * t481 / t29 / t1235 * t34 * t1233 - t1200 * t1011 / 0.4e1;
  t4643 = t342 * t482;
  t4667 = -0.14e2 / 0.9e1 * t981 * t466 + 0.7e1 / 0.9e1 * t987 * t472 - 0.85085588710098571559e-2 * t490 * t4494 - 0.38e2 / 0.3e1 * t2167 * t1835 * t54 + 0.38e2 / 0.3e1 * t1228 * t4643 * t1206 + 0.7e1 / 0.9e1 * t990 * t477 + 0.19e2 / 0.9e1 * t199 * t4643 * t34 - 0.2e1 / 0.3e1 * t507 * t2178 - 0.4e1 / 0.3e1 * t1225 * t2156 + 0.2e1 / 0.3e1 * t507 * t2200 - 0.38e2 / 0.3e1 * t502 * t4643 * t464 + t2782 * t1003 / 0.2e1 + 0.4e1 * t1225 * t2194 - 0.4e1 * t2810 * t2190;
  t4690 = t3803 * t67 * sigma[0];
  t4693 = t182 * t1781;
  t4713 = 0.38e2 / 0.3e1 * t2172 * t1839 * t54 - 0.19e2 / 0.9e1 * t343 * t482 * t34 * t54 + t4024 * t352 - 0.49572923614678599758e0 * t1768 * t2216 + 0.24786461807339299879e0 * t1777 * t2216 - 0.11076465954290667471e-6 * t2846 * t1865 * t4562 + 0.4e2 / 0.3e1 * t1849 * t465 - 0.2e2 / 0.3e1 * t833 * t476 - 0.26869133276873233126e-2 * t181 * t527 * t34 * t4690 + 0.11755245808632039492e-1 * t4693 * t1173 - 0.29376547327216948005e0 * t1204 * t28 * t1781 * t2694 + 0.29376547327216948004e0 * t460 * t28 * t1781 * t1319 + 0.5373826655374646625e-2 * t460 * t527 * t464 * t4690 - 0.21726404794087534461e0 * t343 * t482 * t485 - 0.48960912212028246676e-1 * t4693 * t485;
  t4720 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t439 * t1042 - t4451 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t170 * t2281 + t4458 - t4460 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t4594 + t4632 + t4667 + t4713));
  tv4rho2sigma20 = t6 * t4720 + 0.2e1 * t2286;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t4727 = t5 * t584 * t1109;
  t4731 = t5 * t588 * t1109 / 0.12e2;
  t4733 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t580 * t1109 - t4727 / 0.4e1 + t4731);
  tv4rho2sigma25 = t6 * t4733 + 0.2e1 * t2295;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t4739 = t5 * t609 * t1042;
  t4747 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t1042 - t4739 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t264 * t2281 - t4451 / 0.8e1 + t4458 - t4460 / 0.8e1);
  tv4rho2sigma26 = t6 * t4747 + t2286 + t2301;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t4753 = t5 * t633 * t1109;
  t4760 = t5 * t251 * t2440;
  t4763 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t629 * t1109 - t4753 / 0.8e1 - t4727 / 0.8e1 + t4731 - 0.3e1 / 0.8e1 * t5 * t247 * t2440 - t4760 / 0.8e1);
  tv4rho2sigma211 = t6 * t4763 + t2295 + t2445;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t4771 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t660 * t1042 - t4739 / 0.4e1 + t4458);
  tv4rho2sigma212 = t6 * t4771 + 0.2e1 * t2301;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t4784 = t137 * t38 * t42;
  t4820 = -0.11076465954290667471e-6 * t3607 * t2082 * t4784 - 0.49572923614678599758e0 * t1985 * t2382 + 0.24786461807339299879e0 * t1994 * t2382 - 0.2e2 / 0.3e1 * t932 * t703 + 0.8e1 / 0.3e1 * t2031 * t929 - 0.32e2 / 0.3e1 * t3526 * t722 * t4318 + 0.16e2 * t1668 * t722 * t2016 + 0.32e2 / 0.3e1 * t3527 * t722 * t3528 - 0.16e2 * t1669 * t722 * t1670 + 0.56e2 / 0.9e1 * t729 * t722 * t691 - 0.4e1 / 0.9e1 * t298 * t722 * t112 + 0.4e2 / 0.3e1 * t2043 * t692 - 0.16e2 / 0.3e1 * t4234 * t920 + 0.16272968651166889234e-4 * t1739 * t752 * sigma[2];
  t4827 = t1047 * t690;
  t4836 = t280 * t2437;
  t4845 = t687 * t1107;
  t4852 = t1053 * t697;
  t4856 = -0.56e2 / 0.9e1 * t1984 * t900 + 0.4e1 / 0.9e1 * t1993 * t906 - 0.8e1 / 0.3e1 * t2031 * t926 + 0.14e2 / 0.9e1 * t729 * t4827 * t691 - 0.7e1 / 0.9e1 * t298 * t4827 * t112 + 0.2e1 / 0.3e1 * t734 * t2370 - 0.8e1 / 0.3e1 * t4836 * t300 - t1677 * t1075 / 0.4e1 - 0.16e2 / 0.9e1 * t2364 * t741 - 0.2e1 / 0.3e1 * t734 * t2354 + 0.32e2 / 0.9e1 * t4845 * t731 + 0.2e1 / 0.3e1 * t734 * t2359 + 0.28e2 / 0.9e1 * t932 * t2005 - 0.7e1 / 0.9e1 * t298 * t4852 * t112;
  t4866 = t382 * t709;
  t4894 = -t1677 * t1078 / 0.4e1 - 0.4e1 / 0.3e1 * t1699 * t2315 + 0.4e1 * t1699 * t2349 - 0.4e1 * t3520 * t2346 - 0.38e2 / 0.3e1 * t729 * t4866 * t691 + t3537 * t1070 / 0.2e1 + t4237 * t392 + 0.16e2 / 0.9e1 * t932 * t2049 + 0.32e2 / 0.3e1 * t4242 * t2036 - 0.32e2 / 0.3e1 * t2043 * t2040 - 0.60550581027597727388e-5 * t708 / t107 / t1600 * t112 * t1738 - 0.19e2 / 0.9e1 * t383 * t709 * t112 * t126 + 0.38e2 / 0.3e1 * t1669 * t4866 * t1670 + 0.28e2 / 0.9e1 * t2364 * t738;
  t4898 = t68 * t722;
  t4945 = -0.6e1 * t1631 * t1093 * t782 + 0.24e2 * t3664 * t1093 * t768 - 0.6e1 * t1631 * t1105 * t768 + 0.2e1 * t767 * t1105 * t782 + 0.4e1 * t767 * t413 * t2129 + 0.4e1 * t767 * t2435 * t330 + 0.8e1 * t1624 * t2417 + 0.4e1 * t1624 * t2421 + 0.8e1 * t2098 * t2110 + 0.4e1 * t2098 * t2113 - 0.12e2 * t4427 * t2107 - 0.12e2 * t3655 * t2414 + 0.8e1 * t4424 * t956;
  t4946 = t1089 * t766;
  t4949 = t2402 * t317;
  t4977 = 0.46913580246913580247e-3 * t4898;
  t4980 = t969 * t969;
  t5004 = 0.2e1 * t4946 * t768 - 0.2e1 * t4949 * t330 - t2404 * t782 - 0.2e1 * t4402 * t413 - 0.4e1 * t2095 * t969 - 0.2e1 * t953 * t2129 + 0.2e1 * t3650 * t1093 - t1621 * t1105 - 0.2e1 * t762 * t2435 - t318 * (-0.1273287037037037037e-1 * t79 * t4852 * t148 + 0.49630182129629629625e-1 * t43 * t4827 * t326 - 0.17773414759800945055e1 * t68 * t2122 + 0.39481569207306256398e0 * t2126 * sigma[2] - 0.42541656383427358e0 * t2082 * t3691 * t4784 + t4977) + 0.4e1 * t767 * t4980 + (-0.97158950617283950615e2 * t2077 * t1083 + 0.18180941358024691358e3 * t2083 * t38 * t2396 - 0.80804183813443072701e2 * t522 / t107 / t750 / t720 * t65 * t67 * t748 * t129 + 0.17686419753086419752e1 * t68 * t2073 - t4977) * t153 - 0.24e2 * t1631 * t956 * t969;
  t5015 = t281 * t1998;
  t5029 = 0.19e2 / 0.9e1 * t298 * t4866 * t112 - 0.85085588710098571559e-2 * t717 * t4898 - 0.14e2 / 0.9e1 * t1048 * t693 + 0.7e1 / 0.9e1 * t1054 * t699 - 0.38e2 / 0.3e1 * t2326 * t2035 * t126 + 0.38e2 / 0.3e1 * t2331 * t2039 * t126 + 0.7e1 / 0.9e1 * t1057 * t704 + t114 * (t4945 + t5004) - 0.29376547327216948005e0 * t1668 * t106 * t1998 * t3584 + 0.29376547327216948004e0 * t687 * t106 * t1998 * t1718 - 0.48960912212028246676e-1 * t5015 * t712 + 0.11755245808632039492e-1 * t5015 * t1734 + 0.5373826655374646625e-2 * t688 * t752 * t3573 - 0.26869133276873233126e-2 * t702 * t752 * t1734 - 0.21726404794087534461e0 * t383 * t709 * t712;
  t5036 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t677 * t1109 - t4753 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t275 * t2440 + t4731 - t4760 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t105 * (t4820 + t4856 + t4894 + t5029));
  tv4rho2sigma217 = t6 * t5036 + 0.2e1 * t2445;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t5043 = t5 * t176 * t2559 / 0.8e1;
  t5046 = t3803 * t67;
  t5054 = t43 * sigma[0];
  t5072 = -0.20151849957654924844e-2 * t460 * t841 * t464 * t5046 + 0.10075924978827462422e-2 * t181 * t841 * t34 * t5046 + 0.41536747328590003016e-7 * t2846 * t2233 * t5054 + 0.2e1 * t2205 * t830 - 0.4e1 * t4605 * t821 - 0.3e1 / 0.4e1 * t1832 * t1008 + 0.3e1 / 0.8e1 * t507 * t2449 - 0.34059701828023721654e-5 * t1234 * t841 - 0.3e1 / 0.4e1 * t1225 * t2454 - 0.2e1 * t1849 * t2156 + t833 * t2200;
  t5073 = t2452 * t195;
  t5079 = t181 * t2503;
  t5084 = t980 * t206;
  t5102 = t502 * t5073 * t464 - t199 * t5073 * t34 / 0.2e1 - 0.4e1 / 0.3e1 * t5079 * t201 + t507 * t2506 / 0.8e1 - 0.7e1 / 0.3e1 * t502 * t5084 * t464 + t199 * t5084 * t34 / 0.6e1 + t2535 * t2181 / 0.2e1 - 0.3e1 / 0.4e1 * t1832 * t1011 + 0.3e1 / 0.2e1 * t4034 * t1003 - t833 * t2178 + 0.3e1 / 0.8e1 * t507 * t2511 - 0.6e1 * t4027 * t2190;
  t5144 = 0.3e1 / 0.4e1 * t2810 * t2516 + 0.6e1 * t1849 * t2194 + 0.3e1 / 0.2e1 * t4470 * t352 + 0.4e1 * t2786 * t980 * t206 * t2788 * t54 - 0.6e1 * t1204 * t980 * t206 * t1206 * t54 + 0.7e1 / 0.3e1 * t981 * t206 * t464 * t54 - t990 * t206 * t34 * t54 / 0.6e1 + 0.22706467885349147769e-5 * t182 / t29 / t526 * t34 * t1233 - 0.4e1 * t2813 * t5084 * t2788 + 0.6e1 * t1228 * t5084 * t1206 - 0.3e1 / 0.4e1 * t1225 * t2520 - 0.2e1 * t2205 * t827;
  t5149 = t2447 * t184;
  t5162 = t343 * t2151;
  t5186 = t2475 * t218;
  t5245 = -0.3e1 * t854 * t2276 - 0.6e1 * t2888 * t2483 + 0.24e2 * t2897 * t2483 * t231 - 0.18e2 * t1272 * t1026 * t870 + 0.6e1 * t1265 * t2486 - 0.18e2 * t1272 * t2486 * t231 + 0.6e1 * t542 * t870 * t1038 + 0.6e1 * t542 * t373 * t2276 - t537 * t2501 + 0.2e1 * t542 * t2501 * t231 - t219 * (-0.81854166666666666664e-2 * t79 * t5149 * t82 + 0.31905117083333333332e-1 * t43 * t5073 * t227 + 0.26929416302728704625e-1 * t68 * t5084 * t553 - 0.88203505675896955784e-1 * t2273 + 0.15953121143785259251e0 * t2233 * t2924 * t5054);
  t5248 = t833 * t2211 - t2459 * t2159 + t2462 * t186 / 0.2e1 - t199 * t5149 * t34 / 0.2e1 + 0.11016205247706355502e0 * t2167 * t2151 * t2694 - 0.11016205247706355502e0 * t2172 * t2151 * t1319 - 0.27540513119265888754e-1 * t990 * t206 * t485 + 0.18360342079510592503e-1 * t5162 * t485 + 0.5508102623853177751e-1 * t981 * t206 * t1319 - 0.27540513119265888754e-1 * t987 * t810 * t485 - 0.20151849957654924843e-2 * t5162 * t1173 + t36 * ((-0.50906635802469135803e2 * t2235 * t2470 + 0.30301568930041152263e2 * t522 / t29 / t2848 * t65 * t492 * t57 + 0.15708333333333333334e2 * t842 * t57) * t87 - t5186 * t231 - 0.3e1 * t4545 * t373 + 0.6e1 * t4534 * t857 - 0.3e1 * t2245 * t870 + 0.6e1 * t3962 * t1026 - 0.18e2 * t3965 * t2255 + 0.12e2 * t1881 * t2258 - 0.3e1 * t1878 * t1038 + 0.6e1 * t1881 * t2262 + t5245);
  t5255 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t2559 - t5043 - 0.3e1 / 0.8e1 * t5 * t27 * (t5072 + t5102 + t5144 + t5248));
  tv4rhosigma30 = t6 * t5255 + t2563;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t5262 = t5 * t251 * t2676 / 0.8e1;
  t5264 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t247 * t2676 - t5262);
  tv4rhosigma39 = t6 * t5264 + t2680;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t5270 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t264 * t2559 - t5043);
  tv4rhosigma310 = t6 * t5270 + t2563;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t5279 = t280 * t2606;
  t5286 = t2593 * t294;
  t5304 = -0.2e1 * t2364 * t926 - 0.3e1 / 0.4e1 * t2031 * t1075 - 0.4e1 / 0.3e1 * t5279 * t300 - 0.3e1 / 0.4e1 * t1699 * t2613 + 0.3e1 / 0.8e1 * t734 * t2610 + t729 * t5286 * t691 - t298 * t5286 * t112 / 0.2e1 - 0.3e1 / 0.4e1 * t2031 * t1078 + t2654 * t2336 / 0.2e1 + 0.22706467885349147769e-5 * t281 / t107 / t751 * t112 * t1738 + t734 * t2625 / 0.8e1;
  t5308 = t1047 * t305;
  t5333 = -0.2e1 * t2043 * t2315 + t932 * t2359 + t298 * t5308 * t112 / 0.6e1 + 0.3e1 / 0.2e1 * t4234 * t1070 - 0.7e1 / 0.3e1 * t729 * t5308 * t691 - t932 * t2354 + 0.3e1 / 0.8e1 * t734 * t2630 + 0.3e1 / 0.2e1 * t4836 * t392 - 0.6e1 * t4242 * t2346 + 0.6e1 * t2043 * t2349 - 0.3e1 / 0.4e1 * t1699 * t2639 + 0.4e1 * t3526 * t1047 * t305 * t3528 * t126;
  t5356 = t2588 * t283;
  t5368 = -0.6e1 * t1668 * t1047 * t305 * t1670 * t126 + 0.7e1 / 0.3e1 * t1048 * t305 * t691 * t126 - t1057 * t305 * t112 * t126 / 0.6e1 + 0.3e1 / 0.4e1 * t3520 * t2636 - 0.4e1 * t3527 * t5308 * t3528 + 0.6e1 * t1669 * t5308 * t1670 - t298 * t5356 * t112 / 0.2e1 - t2616 * t2318 + t2619 * t285 / 0.2e1 + t932 * t2370 - 0.34059701828023721654e-5 * t1739 * t940 - 0.4e1 * t4845 * t920;
  t5384 = t2574 * t317;
  t5439 = t43 * sigma[2];
  t5444 = -0.3e1 * t953 * t2435 - 0.6e1 * t3655 * t2582 + 0.24e2 * t3664 * t2582 * t330 - 0.18e2 * t1631 * t1093 * t969 + 0.6e1 * t1624 * t2585 - 0.18e2 * t1631 * t2585 * t330 + 0.6e1 * t767 * t969 * t1105 + 0.6e1 * t767 * t413 * t2435 - t762 * t2604 + 0.2e1 * t767 * t2604 * t330 - t318 * (-0.81854166666666666664e-2 * t79 * t5356 * t148 + 0.31905117083333333332e-1 * t43 * t5286 * t326 + 0.26929416302728704625e-1 * t68 * t5308 * t778 - 0.88203505675896955784e-1 * t2432 + 0.15953121143785259251e0 * t2392 * t3691 * t5439);
  t5456 = t383 * t2310;
  t5469 = t4182 * t67;
  t5479 = 0.2e1 * t2364 * t929 + t114 * ((-0.50906635802469135803e2 * t2394 * t2569 + 0.30301568930041152263e2 * t522 / t107 / t3609 * t65 * t719 * t129 + 0.15708333333333333334e2 * t941 * t129) * t153 - t5384 * t330 - 0.3e1 * t4949 * t413 + 0.6e1 * t4946 * t956 - 0.3e1 * t2404 * t969 + 0.6e1 * t4424 * t1093 - 0.18e2 * t4427 * t2414 + 0.12e2 * t2098 * t2417 - 0.3e1 * t2095 * t1105 + 0.6e1 * t2098 * t2421 + t5444) + 0.11016205247706355502e0 * t2326 * t2310 * t3584 - 0.11016205247706355502e0 * t2331 * t2310 * t1718 - 0.27540513119265888754e-1 * t1057 * t305 * t712 + 0.18360342079510592503e-1 * t5456 * t712 - 0.20151849957654924843e-2 * t5456 * t1734 + 0.5508102623853177751e-1 * t1048 * t305 * t1718 - 0.27540513119265888754e-1 * t1054 * t909 * t712 - 0.20151849957654924844e-2 * t687 * t940 * t691 * t5469 + 0.10075924978827462422e-2 * t280 * t940 * t112 * t5469 + 0.41536747328590003016e-7 * t3607 * t2392 * t5439;
  t5486 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t275 * t2676 - t5262 - 0.3e1 / 0.8e1 * t5 * t105 * (t5304 + t5333 + t5368 + t5479));
  tv4rhosigma319 = t6 * t5486 + t2680;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t5490 = t2447 * t995;
  t5507 = 0.1e1 / t523;
  t5511 = t5507 * t47;
  t5521 = t2452 * t73;
  t5546 = -0.3e1 * t1849 * t2454 - t199 * t5521 * t34 / 0.16e2 - 0.3e1 / 0.2e1 * t2205 * t1011 + 0.2e1 * t5079 * t352 + t833 * t2506 / 0.2e1 + 0.7e1 / 0.8e1 * t502 * t5521 * t464 + 0.3e1 * t4605 * t1003 - 0.3e1 * t1849 * t2520 - 0.7e1 / 0.8e1 * t2459 * t73 * t464 * t54 + 0.3e1 / 0.8e1 * t2462 * t2539 + 0.3e1 * t4027 * t2516;
  t5579 = 0.1e1 / t2729;
  t5584 = t5579 * t31;
  t5610 = t1026 * t1026;
  t5616 = t1038 * t1038;
  t5639 = (-0.11363088348765432099e2 * t522 * t2732 * t65 * t67 * t57 * sigma[0] + 0.10908564814814814815e2 * t2467 * t1253) * t87 - 0.4e1 * t5186 * t373 + 0.12e2 * t4534 * t1026 - 0.6e1 * t2245 * t1038 - 0.24e2 * t3965 * t2483 + 0.24e2 * t1881 * t2486 - 0.4e1 * t854 * t2501 + 0.24e2 * t2897 * t5610 - 0.36e2 * t1272 * t1026 * t1038 + 0.6e1 * t542 * t5616 + 0.8e1 * t542 * t373 * t2501 - t219 * (-0.1534765625e-1 * t79 * t5584 * t82 + 0.59822094531249999998e-1 * t43 * t5511 * t227 + 0.50492655567616321177e-1 * t68 * t5521 * t553 + 0.47251878040659083455e-2 * t980 * t1014 * t1293 - 0.59824204289194722189e-1 * t2466 * t2924 * t43);
  t5650 = t987 * t2543;
  t5667 = -0.15e2 / 0.16e2 * t199 * t5584 * t34 + t36 * t5639 + 0.41310769678898833132e-1 * t2459 * t73 * t1319 - 0.20655384839449416565e-1 * t2462 * t995 * t485 - 0.20655384839449416566e-1 * t2535 * t73 * t485 - 0.68851282798164721886e-2 * t5650 * t485 + 0.75569437341205968163e-3 * t981 * t1014 * t2713 - 0.37784718670602984081e-3 * t990 * t1014 * t1173 - 0.41310769678898833132e-1 * t2525 * t2543 * t2694 + 0.41310769678898833132e-1 * t2530 * t2543 * t1319 - 0.37784718670602984081e-3 * t5650 * t1173;
  t5673 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (0.3e1 / 0.2e1 * t833 * t2449 - 0.9e1 / 0.4e1 * t1228 * t5490 * t1206 + 0.9e1 / 0.4e1 * t502 * t5490 * t464 - 0.3e1 / 0.2e1 * t2205 * t1008 + 0.3e1 / 0.2e1 * t833 * t2511 + 0.9e1 / 0.4e1 * t1204 * t2447 * t2527 - 0.9e1 / 0.4e1 * t460 * t2447 * t2532 + 0.15e2 / 0.16e2 * t181 * t5507 * t992 + 0.15e2 / 0.8e1 * t502 * t5511 * t464 - 0.15e2 / 0.16e2 * t199 * t5511 * t34 + t5546 + 0.3e1 / 0.2e1 * t2813 * t5521 * t2788 - 0.9e1 / 0.4e1 * t1228 * t5521 * t1206 + t2535 * t2822 / 0.16e2 - 0.85149254570059304134e-6 * t343 * t2817 * t1233 - 0.15576280248221251131e-7 * t2846 * t2466 * t38 * t42 - 0.3e1 / 0.2e1 * t2786 * t2452 * t73 * t2788 * t54 + 0.9e1 / 0.4e1 * t1204 * t2452 * t73 * t1206 * t54 - 0.3e1 / 0.8e1 * t199 * t5490 * t34 - 0.15e2 / 0.8e1 * t460 * t5507 * t983 + 0.15e2 / 0.16e2 * t181 * t5579 * t345 + t5667));
  tv4sigma40 = t6 * t5673;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t5674 = 0.1e1 / t3554;
  t5675 = t5674 * t109;
  t5679 = 0.1e1 / t748;
  t5708 = t1093 * t1093;
  t5714 = t1105 * t1105;
  t5723 = t5679 * t119;
  t5727 = t2593 * t141;
  t5739 = (-0.11363088348765432099e2 * t522 * t3557 * t65 * t67 * t129 * sigma[2] + 0.10908564814814814815e2 * t2566 * t1611) * t153 - 0.4e1 * t5384 * t413 + 0.12e2 * t4946 * t1093 - 0.6e1 * t2404 * t1105 - 0.24e2 * t4427 * t2582 + 0.24e2 * t2098 * t2585 - 0.4e1 * t953 * t2604 + 0.24e2 * t3664 * t5708 - 0.36e2 * t1631 * t1093 * t1105 + 0.6e1 * t767 * t5714 + 0.8e1 * t767 * t413 * t2604 - t318 * (-0.1534765625e-1 * t79 * t5675 * t148 + 0.59822094531249999998e-1 * t43 * t5723 * t326 + 0.50492655567616321177e-1 * t68 * t5727 * t778 + 0.47251878040659083455e-2 * t1047 * t1081 * t1650 - 0.59824204289194722189e-1 * t2565 * t3691 * t43);
  t5744 = t1054 * t2671;
  t5768 = t2588 * t1062;
  t5788 = -0.20655384839449416565e-1 * t2619 * t1062 * t712 + 0.41310769678898833132e-1 * t2616 * t141 * t1718 - 0.68851282798164721886e-2 * t5744 * t712 - 0.3e1 / 0.8e1 * t298 * t5768 * t112 + 0.3e1 / 0.2e1 * t932 * t2610 + 0.2e1 * t5279 * t392 - 0.3e1 / 0.2e1 * t2364 * t1075 - 0.3e1 * t2043 * t2613 + 0.3e1 / 0.2e1 * t932 * t2630 + 0.15e2 / 0.8e1 * t729 * t5723 * t691 - 0.15e2 / 0.16e2 * t298 * t5723 * t112;
  t5853 = -0.3e1 / 0.2e1 * t2364 * t1078 - 0.3e1 * t2043 * t2639 + 0.3e1 * t4845 * t1070 + 0.3e1 * t4242 * t2636 + 0.3e1 / 0.2e1 * t3527 * t5727 * t3528 - 0.9e1 / 0.4e1 * t1669 * t5727 * t1670 - 0.3e1 / 0.2e1 * t3526 * t2593 * t141 * t3528 * t126 + 0.9e1 / 0.4e1 * t1668 * t2593 * t141 * t1670 * t126 - 0.7e1 / 0.8e1 * t2616 * t141 * t691 * t126 + 0.3e1 / 0.8e1 * t2619 * t2658 + t2654 * t3475 / 0.16e2;
  t5859 = my_piecewise3(t96, 0, -0.3e1 / 0.8e1 * t5 * t105 * (-0.15e2 / 0.16e2 * t298 * t5675 * t112 - 0.15e2 / 0.8e1 * t687 * t5679 * t1050 + 0.15e2 / 0.16e2 * t280 * t5674 * t385 + t114 * t5739 + 0.75569437341205968163e-3 * t1048 * t1081 * t3573 - 0.37784718670602984081e-3 * t5744 * t1734 - 0.37784718670602984081e-3 * t1057 * t1081 * t1734 - 0.41310769678898833132e-1 * t2644 * t2671 * t3584 + 0.41310769678898833132e-1 * t2649 * t2671 * t1718 - 0.20655384839449416566e-1 * t2654 * t141 * t712 + t5788 - 0.9e1 / 0.4e1 * t1669 * t5768 * t1670 + 0.9e1 / 0.4e1 * t729 * t5768 * t691 + 0.9e1 / 0.4e1 * t1668 * t2588 * t2646 - 0.9e1 / 0.4e1 * t687 * t2588 * t2651 + 0.15e2 / 0.16e2 * t280 * t5679 * t1059 - 0.85149254570059304134e-6 * t383 * t3566 * t1738 - 0.15576280248221251131e-7 * t3607 * t2565 * t38 * t42 + t932 * t2625 / 0.2e1 + 0.7e1 / 0.8e1 * t729 * t5727 * t691 - t298 * t5727 * t112 / 0.16e2 + t5853));
  tv4sigma414 = t6 * t5859;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

