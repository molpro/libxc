/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2024 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_hcth_a.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t34, t35, t36, t37, t38, t40, t44;
  double t45, t47, t48, t49, t53, t54, t55, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t72, t76, tzk0;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->c1 * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = params->beta * sigma[0];
  t29 = M_CBRT2;
  t30 = t29 * t29;
  t31 = rho[0] * rho[0];
  t32 = t18 * t18;
  t34 = 0.1e1 / t32 / t31;
  t35 = t30 * t34;
  t36 = params->gamma * params->beta;
  t37 = sqrt(sigma[0]);
  t38 = t36 * t37;
  t40 = 0.1e1 / t18 / rho[0];
  t44 = log(t37 * t29 * t40 + sqrt(POW_2(t37 * t29 * t40) + 0.1e1));
  t45 = t29 * t40 * t44;
  t47 = t38 * t45 + 0.1e1;
  t48 = 0.1e1 / t47;
  t49 = t35 * t48;
  t53 = params->c2 * t20;
  t54 = sigma[0] * t30;
  t55 = t34 * t48;
  t57 = t37 * sigma[0];
  t58 = params->beta * t57;
  t59 = t31 * t31;
  t60 = 0.1e1 / t59;
  t61 = t58 * t60;
  t62 = t47 * t47;
  t63 = 0.1e1 / t62;
  t64 = t63 * params->gamma;
  t65 = t64 * t44;
  t72 = params->c0 - 0.2e1 / 0.9e1 * t27 * t28 * t49 - 0.2e1 / 0.9e1 * t53 * t26 * (t54 * t55 - 0.2e1 * t61 * t65);
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t34, t35, t36, t37, t38, t40, t44;
  double t45, t47, t48, t49, t53, t54, t55, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t72, t76, tzk0;

  double t78, t82, t84, t85, t86, t91, t92, t96;
  double t98, t99, t100, t101, t102, t103, t106, t107;
  double t108, t111, t114, t115, t116, t120, t121, t123;
  double t126, t127, t128, t130, t132, t133, t140, t145;
  double tvrho0, t148, t151, t152, t154, t157, t158, t159;
  double t161, t162, t166, t170, t177, t181, tvsigma0;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->c1 * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = params->beta * sigma[0];
  t29 = M_CBRT2;
  t30 = t29 * t29;
  t31 = rho[0] * rho[0];
  t32 = t18 * t18;
  t34 = 0.1e1 / t32 / t31;
  t35 = t30 * t34;
  t36 = params->gamma * params->beta;
  t37 = sqrt(sigma[0]);
  t38 = t36 * t37;
  t40 = 0.1e1 / t18 / rho[0];
  t44 = log(t37 * t29 * t40 + sqrt(POW_2(t37 * t29 * t40) + 0.1e1));
  t45 = t29 * t40 * t44;
  t47 = t38 * t45 + 0.1e1;
  t48 = 0.1e1 / t47;
  t49 = t35 * t48;
  t53 = params->c2 * t20;
  t54 = sigma[0] * t30;
  t55 = t34 * t48;
  t57 = t37 * sigma[0];
  t58 = params->beta * t57;
  t59 = t31 * t31;
  t60 = 0.1e1 / t59;
  t61 = t58 * t60;
  t62 = t47 * t47;
  t63 = 0.1e1 / t62;
  t64 = t63 * params->gamma;
  t65 = t64 * t44;
  t72 = params->c0 - 0.2e1 / 0.9e1 * t27 * t28 * t49 - 0.2e1 / 0.9e1 * t53 * t26 * (t54 * t55 - 0.2e1 * t61 * t65);
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t17 / t32;
  t82 = t31 * rho[0];
  t84 = 0.1e1 / t32 / t82;
  t85 = t30 * t84;
  t86 = t85 * t48;
  t91 = t21 * t26 * params->beta;
  t92 = t34 * t63;
  t96 = t29 / t18 / t31 * t44;
  t98 = t36 * sigma[0];
  t99 = t54 * t34;
  t100 = t99 + 0.1e1;
  t101 = sqrt(t100);
  t102 = 0.1e1 / t101;
  t103 = t85 * t102;
  t106 = -0.4e1 / 0.3e1 * t98 * t103 - 0.4e1 / 0.3e1 * t38 * t96;
  t107 = t92 * t106;
  t108 = t54 * t107;
  t111 = t84 * t48;
  t114 = t59 * rho[0];
  t115 = 0.1e1 / t114;
  t116 = t58 * t115;
  t120 = 0.1e1 / t62 / t47;
  t121 = t120 * params->gamma;
  t123 = t121 * t44 * t106;
  t126 = sigma[0] * sigma[0];
  t127 = params->beta * t126;
  t128 = t59 * t31;
  t130 = 0.1e1 / t18 / t128;
  t132 = t29 * t102;
  t133 = t64 * t132;
  t140 = 0.16e2 / 0.27e2 * t27 * t28 * t86 + 0.2e1 / 0.9e1 * t91 * t108 - 0.2e1 / 0.9e1 * t53 * t26 * (-0.8e1 / 0.3e1 * t54 * t111 - t108 + 0.8e1 * t116 * t65 + 0.4e1 * t61 * t123 + 0.8e1 / 0.3e1 * t127 * t130 * t133);
  t145 = my_piecewise3(t2, 0, -t6 * t78 * t72 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t140);
  tvrho0 = 0.2e1 * rho[0] * t145 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t148 = params->beta * t30;
  t151 = 0.1e1 / t37;
  t152 = t36 * t151;
  t154 = t35 * t102;
  t157 = t152 * t45 / 0.2e1 + t36 * t154 / 0.2e1;
  t158 = t92 * t157;
  t159 = t54 * t158;
  t161 = params->beta * t37;
  t162 = t161 * t60;
  t166 = t121 * t44 * t157;
  t170 = 0.1e1 / t18 / t114;
  t177 = -0.2e1 / 0.9e1 * t27 * t148 * t55 + 0.2e1 / 0.9e1 * t91 * t159 - 0.2e1 / 0.9e1 * t53 * t26 * (-t28 * t170 * t133 - 0.3e1 * t162 * t65 + 0.4e1 * t61 * t166 - t159 + t49);
  t181 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t177);
  tvsigma0 = 0.2e1 * rho[0] * t181;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t34, t35, t36, t37, t38, t40, t44;
  double t45, t47, t48, t49, t53, t54, t55, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t72, t76, tzk0;

  double t78, t82, t84, t85, t86, t91, t92, t96;
  double t98, t99, t100, t101, t102, t103, t106, t107;
  double t108, t111, t114, t115, t116, t120, t121, t123;
  double t126, t127, t128, t130, t132, t133, t140, t145;
  double tvrho0, t148, t151, t152, t154, t157, t158, t159;
  double t161, t162, t166, t170, t177, t181, tvsigma0;

  double t186, t194, t195, t196, t200, t201, t202, t205;
  double t206, t207, t208, t214, t217, t220, t221, t223;
  double t226, t227, t230, t231, t232, t235, t240, t241;
  double t249, t250, t251, t253, t256, t257, t258, t259;
  double t260, t264, t267, t268, t269, t270, t271, t272;
  double t273, t276, t280, t285, tv2rho20, t297, t298, t301;
  double t302, t303, t310, t315, t316, t317, t321, t325;
  double t335, t336, t337, t338, t339, t342, t343, t347;
  double t350, t351, t354, t355, t356, t359, t363, t368;
  double tv2rhosigma0, t374, t375, t376, t379, t380, t383, t384;
  double t387, t388, t391, t392, t393, t396, t400, t401;
  double t406, t408, t412, t418, t421, t422, t428, t432;
  double tv2sigma20;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->c1 * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = params->beta * sigma[0];
  t29 = M_CBRT2;
  t30 = t29 * t29;
  t31 = rho[0] * rho[0];
  t32 = t18 * t18;
  t34 = 0.1e1 / t32 / t31;
  t35 = t30 * t34;
  t36 = params->gamma * params->beta;
  t37 = sqrt(sigma[0]);
  t38 = t36 * t37;
  t40 = 0.1e1 / t18 / rho[0];
  t44 = log(t37 * t29 * t40 + sqrt(POW_2(t37 * t29 * t40) + 0.1e1));
  t45 = t29 * t40 * t44;
  t47 = t38 * t45 + 0.1e1;
  t48 = 0.1e1 / t47;
  t49 = t35 * t48;
  t53 = params->c2 * t20;
  t54 = sigma[0] * t30;
  t55 = t34 * t48;
  t57 = t37 * sigma[0];
  t58 = params->beta * t57;
  t59 = t31 * t31;
  t60 = 0.1e1 / t59;
  t61 = t58 * t60;
  t62 = t47 * t47;
  t63 = 0.1e1 / t62;
  t64 = t63 * params->gamma;
  t65 = t64 * t44;
  t72 = params->c0 - 0.2e1 / 0.9e1 * t27 * t28 * t49 - 0.2e1 / 0.9e1 * t53 * t26 * (t54 * t55 - 0.2e1 * t61 * t65);
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t17 / t32;
  t82 = t31 * rho[0];
  t84 = 0.1e1 / t32 / t82;
  t85 = t30 * t84;
  t86 = t85 * t48;
  t91 = t21 * t26 * params->beta;
  t92 = t34 * t63;
  t96 = t29 / t18 / t31 * t44;
  t98 = t36 * sigma[0];
  t99 = t54 * t34;
  t100 = t99 + 0.1e1;
  t101 = sqrt(t100);
  t102 = 0.1e1 / t101;
  t103 = t85 * t102;
  t106 = -0.4e1 / 0.3e1 * t98 * t103 - 0.4e1 / 0.3e1 * t38 * t96;
  t107 = t92 * t106;
  t108 = t54 * t107;
  t111 = t84 * t48;
  t114 = t59 * rho[0];
  t115 = 0.1e1 / t114;
  t116 = t58 * t115;
  t120 = 0.1e1 / t62 / t47;
  t121 = t120 * params->gamma;
  t123 = t121 * t44 * t106;
  t126 = sigma[0] * sigma[0];
  t127 = params->beta * t126;
  t128 = t59 * t31;
  t130 = 0.1e1 / t18 / t128;
  t132 = t29 * t102;
  t133 = t64 * t132;
  t140 = 0.16e2 / 0.27e2 * t27 * t28 * t86 + 0.2e1 / 0.9e1 * t91 * t108 - 0.2e1 / 0.9e1 * t53 * t26 * (-0.8e1 / 0.3e1 * t54 * t111 - t108 + 0.8e1 * t116 * t65 + 0.4e1 * t61 * t123 + 0.8e1 / 0.3e1 * t127 * t130 * t133);
  t145 = my_piecewise3(t2, 0, -t6 * t78 * t72 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t140);
  tvrho0 = 0.2e1 * rho[0] * t145 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t148 = params->beta * t30;
  t151 = 0.1e1 / t37;
  t152 = t36 * t151;
  t154 = t35 * t102;
  t157 = t152 * t45 / 0.2e1 + t36 * t154 / 0.2e1;
  t158 = t92 * t157;
  t159 = t54 * t158;
  t161 = params->beta * t37;
  t162 = t161 * t60;
  t166 = t121 * t44 * t157;
  t170 = 0.1e1 / t18 / t114;
  t177 = -0.2e1 / 0.9e1 * t27 * t148 * t55 + 0.2e1 / 0.9e1 * t91 * t159 - 0.2e1 / 0.9e1 * t53 * t26 * (-t28 * t170 * t133 - 0.3e1 * t162 * t65 + 0.4e1 * t61 * t166 - t159 + t49);
  t181 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t177);
  tvsigma0 = 0.2e1 * rho[0] * t181;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t186 = t17 / t32 / rho[0];
  t194 = 0.1e1 / t32 / t59;
  t195 = t30 * t194;
  t196 = t195 * t48;
  t200 = t84 * t63;
  t201 = t200 * t106;
  t202 = t54 * t201;
  t205 = t34 * t120;
  t206 = t106 * t106;
  t207 = t205 * t206;
  t208 = t54 * t207;
  t214 = t29 / t18 / t82 * t44;
  t217 = t195 * t102;
  t220 = t36 * t126;
  t221 = t59 * t82;
  t223 = 0.1e1 / t18 / t221;
  t226 = 0.1e1 / t101 / t100;
  t227 = t29 * t223 * t226;
  t230 = 0.28e2 / 0.9e1 * t38 * t214 + 0.2e2 / 0.3e1 * t98 * t217 - 0.32e2 / 0.9e1 * t220 * t227;
  t231 = t92 * t230;
  t232 = t54 * t231;
  t235 = t194 * t48;
  t240 = 0.1e1 / t128;
  t241 = t58 * t240;
  t249 = t62 * t62;
  t250 = 0.1e1 / t249;
  t251 = t250 * params->gamma;
  t253 = t251 * t44 * t206;
  t256 = t130 * t120;
  t257 = t127 * t256;
  t258 = params->gamma * t29;
  t259 = t102 * t106;
  t260 = t258 * t259;
  t264 = t121 * t44 * t230;
  t267 = t126 * sigma[0];
  t268 = params->beta * t267;
  t269 = t59 * t59;
  t270 = t269 * t31;
  t271 = 0.1e1 / t270;
  t272 = t268 * t271;
  t273 = t64 * t226;
  t276 = 0.88e2 / 0.9e1 * t54 * t235 + 0.16e2 / 0.3e1 * t202 + 0.2e1 * t208 - t232 - 0.4e2 * t241 * t65 - 0.32e2 * t116 * t123 - 0.248e3 / 0.9e1 * t127 * t223 * t133 - 0.12e2 * t61 * t253 - 0.32e2 / 0.3e1 * t257 * t260 + 0.4e1 * t61 * t264 + 0.64e2 / 0.9e1 * t272 * t273;
  t280 = -0.176e3 / 0.81e2 * t27 * t28 * t196 - 0.32e2 / 0.27e2 * t91 * t202 - 0.4e1 / 0.9e1 * t91 * t208 + 0.2e1 / 0.9e1 * t91 * t232 - 0.2e1 / 0.9e1 * t53 * t26 * t276;
  t285 = my_piecewise3(t2, 0, t6 * t186 * t72 / 0.12e2 - t6 * t78 * t140 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t280);
  tv2rho20 = 0.2e1 * rho[0] * t285 + 0.4e1 * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t297 = t200 * t157;
  t298 = t54 * t297;
  t301 = t120 * t157;
  t302 = t301 * t106;
  t303 = t99 * t302;
  t310 = t36 * t29;
  t315 = -0.2e1 / 0.3e1 * t152 * t96 - 0.2e1 * t36 * t103 + 0.4e1 / 0.3e1 * t310 * t130 * t226 * sigma[0];
  t316 = t92 * t315;
  t317 = t54 * t316;
  t321 = t63 * t106;
  t325 = t161 * t115;
  t335 = t60 * t250;
  t336 = t58 * t335;
  t337 = params->gamma * t44;
  t338 = t157 * t106;
  t339 = t337 * t338;
  t342 = t102 * t157;
  t343 = t258 * t342;
  t347 = t121 * t44 * t315;
  t350 = t170 * t120;
  t351 = t28 * t350;
  t354 = t269 * rho[0];
  t355 = 0.1e1 / t354;
  t356 = t127 * t355;
  t359 = -0.8e1 / 0.3e1 * t86 - t35 * t321 + 0.8e1 / 0.3e1 * t298 + 0.2e1 * t303 - t317 + 0.12e2 * t325 * t65 + 0.6e1 * t162 * t123 + 0.28e2 / 0.3e1 * t28 * t130 * t133 - 0.16e2 * t116 * t166 - 0.12e2 * t336 * t339 - 0.16e2 / 0.3e1 * t257 * t343 + 0.4e1 * t61 * t347 + 0.2e1 * t351 * t260 - 0.8e1 / 0.3e1 * t356 * t273;
  t363 = 0.16e2 / 0.27e2 * t27 * t148 * t111 + 0.2e1 / 0.9e1 * t27 * t148 * t107 - 0.16e2 / 0.27e2 * t91 * t298 - 0.4e1 / 0.9e1 * t91 * t303 + 0.2e1 / 0.9e1 * t91 * t317 - 0.2e1 / 0.9e1 * t53 * t26 * t359;
  t368 = my_piecewise3(t2, 0, -t6 * t78 * t177 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t363);
  tv2rhosigma0 = 0.2e1 * rho[0] * t368 + 0.2e1 * t181;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t374 = t157 * t157;
  t375 = t205 * t374;
  t376 = t54 * t375;
  t379 = 0.1e1 / t57;
  t380 = t36 * t379;
  t383 = 0.1e1 / sigma[0];
  t384 = t36 * t383;
  t387 = t29 * t170;
  t388 = t387 * t226;
  t391 = -t380 * t45 / 0.4e1 + t384 * t154 / 0.4e1 - t36 * t388 / 0.2e1;
  t392 = t92 * t391;
  t393 = t54 * t392;
  t396 = t63 * t157;
  t400 = params->beta * t151;
  t401 = t400 * t60;
  t406 = params->beta * t170;
  t408 = t258 * t102;
  t412 = t251 * t44 * t374;
  t418 = t121 * t44 * t391;
  t421 = 0.1e1 / t269;
  t422 = t28 * t421;
  t428 = 0.4e1 / 0.9e1 * t27 * t148 * t158 - 0.4e1 / 0.9e1 * t91 * t376 + 0.2e1 / 0.9e1 * t91 * t393 - 0.2e1 / 0.9e1 * t53 * t26 * (-0.2e1 * t35 * t396 + 0.2e1 * t376 - t393 - 0.3e1 / 0.2e1 * t401 * t65 + 0.12e2 * t162 * t166 - 0.5e1 / 0.2e1 * t406 * t63 * t408 - 0.12e2 * t61 * t412 + 0.4e1 * t351 * t343 + 0.4e1 * t61 * t418 + t422 * t273);
  t432 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t428);
  tv2sigma20 = 0.2e1 * rho[0] * t432;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t34, t35, t36, t37, t38, t40, t44;
  double t45, t47, t48, t49, t53, t54, t55, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t72, t76, tzk0;

  double t78, t82, t84, t85, t86, t91, t92, t96;
  double t98, t99, t100, t101, t102, t103, t106, t107;
  double t108, t111, t114, t115, t116, t120, t121, t123;
  double t126, t127, t128, t130, t132, t133, t140, t145;
  double tvrho0, t148, t151, t152, t154, t157, t158, t159;
  double t161, t162, t166, t170, t177, t181, tvsigma0;

  double t186, t194, t195, t196, t200, t201, t202, t205;
  double t206, t207, t208, t214, t217, t220, t221, t223;
  double t226, t227, t230, t231, t232, t235, t240, t241;
  double t249, t250, t251, t253, t256, t257, t258, t259;
  double t260, t264, t267, t268, t269, t270, t271, t272;
  double t273, t276, t280, t285, tv2rho20, t297, t298, t301;
  double t302, t303, t310, t315, t316, t317, t321, t325;
  double t335, t336, t337, t338, t339, t342, t343, t347;
  double t350, t351, t354, t355, t356, t359, t363, t368;
  double tv2rhosigma0, t374, t375, t376, t379, t380, t383, t384;
  double t387, t388, t391, t392, t393, t396, t400, t401;
  double t406, t408, t412, t418, t421, t422, t428, t432;
  double tv2sigma20;

  double t435, t446, t447, t448, t452, t453, t454, t457;
  double t458, t459, t462, t463, t466, t467, t468, t469;
  double t472, t473, t474, t480, t483, t487, t492, t493;
  double t495, t497, t501, t502, t503, t509, t512, t517;
  double t518, t522, t523, t525, t529, t530, t533, t534;
  double t536, t540, t545, t546, t557, t561, t564, t565;
  double t566, t568, t571, t574, t579, t584, tv3rho30, t606;
  double t607, t610, t611, t614, t615, t618, t619, t620;
  double t623, t624, t625, t628, t629, t640, t644, t645;
  double t646, t649, t651, t665, t669, t679, t685, t688;
  double t689, t694, t696, t697, t702, t703, t706, t707;
  double t710, t711, t716, t720, t723, t724, t726, t733;
  double t736, t741, t746, tv3rho2sigma0, t755, t761, t762, t765;
  double t766, t767, t770, t771, t774, t775, t778, t779;
  double t780, t788, t791, t795, t796, t797, t800, t806;
  double t812, t826, t832, t836, t837, t839, t840, t845;
  double t849, t853, t856, t857, t862, t863, t866, t867;
  double t870, t880, t885, t890, tv3rhosigma20, t899, t900, t901;
  double t904, t905, t909, t910, t913, t914, t922, t923;
  double t924, t928, t934, t937, t940, t946, t949, t950;
  double t957, t958, t963, t974, t977, t981, t985, tv3sigma30;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->c1 * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = params->beta * sigma[0];
  t29 = M_CBRT2;
  t30 = t29 * t29;
  t31 = rho[0] * rho[0];
  t32 = t18 * t18;
  t34 = 0.1e1 / t32 / t31;
  t35 = t30 * t34;
  t36 = params->gamma * params->beta;
  t37 = sqrt(sigma[0]);
  t38 = t36 * t37;
  t40 = 0.1e1 / t18 / rho[0];
  t44 = log(t37 * t29 * t40 + sqrt(POW_2(t37 * t29 * t40) + 0.1e1));
  t45 = t29 * t40 * t44;
  t47 = t38 * t45 + 0.1e1;
  t48 = 0.1e1 / t47;
  t49 = t35 * t48;
  t53 = params->c2 * t20;
  t54 = sigma[0] * t30;
  t55 = t34 * t48;
  t57 = t37 * sigma[0];
  t58 = params->beta * t57;
  t59 = t31 * t31;
  t60 = 0.1e1 / t59;
  t61 = t58 * t60;
  t62 = t47 * t47;
  t63 = 0.1e1 / t62;
  t64 = t63 * params->gamma;
  t65 = t64 * t44;
  t72 = params->c0 - 0.2e1 / 0.9e1 * t27 * t28 * t49 - 0.2e1 / 0.9e1 * t53 * t26 * (t54 * t55 - 0.2e1 * t61 * t65);
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t17 / t32;
  t82 = t31 * rho[0];
  t84 = 0.1e1 / t32 / t82;
  t85 = t30 * t84;
  t86 = t85 * t48;
  t91 = t21 * t26 * params->beta;
  t92 = t34 * t63;
  t96 = t29 / t18 / t31 * t44;
  t98 = t36 * sigma[0];
  t99 = t54 * t34;
  t100 = t99 + 0.1e1;
  t101 = sqrt(t100);
  t102 = 0.1e1 / t101;
  t103 = t85 * t102;
  t106 = -0.4e1 / 0.3e1 * t98 * t103 - 0.4e1 / 0.3e1 * t38 * t96;
  t107 = t92 * t106;
  t108 = t54 * t107;
  t111 = t84 * t48;
  t114 = t59 * rho[0];
  t115 = 0.1e1 / t114;
  t116 = t58 * t115;
  t120 = 0.1e1 / t62 / t47;
  t121 = t120 * params->gamma;
  t123 = t121 * t44 * t106;
  t126 = sigma[0] * sigma[0];
  t127 = params->beta * t126;
  t128 = t59 * t31;
  t130 = 0.1e1 / t18 / t128;
  t132 = t29 * t102;
  t133 = t64 * t132;
  t140 = 0.16e2 / 0.27e2 * t27 * t28 * t86 + 0.2e1 / 0.9e1 * t91 * t108 - 0.2e1 / 0.9e1 * t53 * t26 * (-0.8e1 / 0.3e1 * t54 * t111 - t108 + 0.8e1 * t116 * t65 + 0.4e1 * t61 * t123 + 0.8e1 / 0.3e1 * t127 * t130 * t133);
  t145 = my_piecewise3(t2, 0, -t6 * t78 * t72 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t140);
  tvrho0 = 0.2e1 * rho[0] * t145 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t148 = params->beta * t30;
  t151 = 0.1e1 / t37;
  t152 = t36 * t151;
  t154 = t35 * t102;
  t157 = t152 * t45 / 0.2e1 + t36 * t154 / 0.2e1;
  t158 = t92 * t157;
  t159 = t54 * t158;
  t161 = params->beta * t37;
  t162 = t161 * t60;
  t166 = t121 * t44 * t157;
  t170 = 0.1e1 / t18 / t114;
  t177 = -0.2e1 / 0.9e1 * t27 * t148 * t55 + 0.2e1 / 0.9e1 * t91 * t159 - 0.2e1 / 0.9e1 * t53 * t26 * (-t28 * t170 * t133 - 0.3e1 * t162 * t65 + 0.4e1 * t61 * t166 - t159 + t49);
  t181 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t177);
  tvsigma0 = 0.2e1 * rho[0] * t181;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t186 = t17 / t32 / rho[0];
  t194 = 0.1e1 / t32 / t59;
  t195 = t30 * t194;
  t196 = t195 * t48;
  t200 = t84 * t63;
  t201 = t200 * t106;
  t202 = t54 * t201;
  t205 = t34 * t120;
  t206 = t106 * t106;
  t207 = t205 * t206;
  t208 = t54 * t207;
  t214 = t29 / t18 / t82 * t44;
  t217 = t195 * t102;
  t220 = t36 * t126;
  t221 = t59 * t82;
  t223 = 0.1e1 / t18 / t221;
  t226 = 0.1e1 / t101 / t100;
  t227 = t29 * t223 * t226;
  t230 = 0.28e2 / 0.9e1 * t38 * t214 + 0.2e2 / 0.3e1 * t98 * t217 - 0.32e2 / 0.9e1 * t220 * t227;
  t231 = t92 * t230;
  t232 = t54 * t231;
  t235 = t194 * t48;
  t240 = 0.1e1 / t128;
  t241 = t58 * t240;
  t249 = t62 * t62;
  t250 = 0.1e1 / t249;
  t251 = t250 * params->gamma;
  t253 = t251 * t44 * t206;
  t256 = t130 * t120;
  t257 = t127 * t256;
  t258 = params->gamma * t29;
  t259 = t102 * t106;
  t260 = t258 * t259;
  t264 = t121 * t44 * t230;
  t267 = t126 * sigma[0];
  t268 = params->beta * t267;
  t269 = t59 * t59;
  t270 = t269 * t31;
  t271 = 0.1e1 / t270;
  t272 = t268 * t271;
  t273 = t64 * t226;
  t276 = 0.88e2 / 0.9e1 * t54 * t235 + 0.16e2 / 0.3e1 * t202 + 0.2e1 * t208 - t232 - 0.4e2 * t241 * t65 - 0.32e2 * t116 * t123 - 0.248e3 / 0.9e1 * t127 * t223 * t133 - 0.12e2 * t61 * t253 - 0.32e2 / 0.3e1 * t257 * t260 + 0.4e1 * t61 * t264 + 0.64e2 / 0.9e1 * t272 * t273;
  t280 = -0.176e3 / 0.81e2 * t27 * t28 * t196 - 0.32e2 / 0.27e2 * t91 * t202 - 0.4e1 / 0.9e1 * t91 * t208 + 0.2e1 / 0.9e1 * t91 * t232 - 0.2e1 / 0.9e1 * t53 * t26 * t276;
  t285 = my_piecewise3(t2, 0, t6 * t186 * t72 / 0.12e2 - t6 * t78 * t140 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t280);
  tv2rho20 = 0.2e1 * rho[0] * t285 + 0.4e1 * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t297 = t200 * t157;
  t298 = t54 * t297;
  t301 = t120 * t157;
  t302 = t301 * t106;
  t303 = t99 * t302;
  t310 = t36 * t29;
  t315 = -0.2e1 / 0.3e1 * t152 * t96 - 0.2e1 * t36 * t103 + 0.4e1 / 0.3e1 * t310 * t130 * t226 * sigma[0];
  t316 = t92 * t315;
  t317 = t54 * t316;
  t321 = t63 * t106;
  t325 = t161 * t115;
  t335 = t60 * t250;
  t336 = t58 * t335;
  t337 = params->gamma * t44;
  t338 = t157 * t106;
  t339 = t337 * t338;
  t342 = t102 * t157;
  t343 = t258 * t342;
  t347 = t121 * t44 * t315;
  t350 = t170 * t120;
  t351 = t28 * t350;
  t354 = t269 * rho[0];
  t355 = 0.1e1 / t354;
  t356 = t127 * t355;
  t359 = -0.8e1 / 0.3e1 * t86 - t35 * t321 + 0.8e1 / 0.3e1 * t298 + 0.2e1 * t303 - t317 + 0.12e2 * t325 * t65 + 0.6e1 * t162 * t123 + 0.28e2 / 0.3e1 * t28 * t130 * t133 - 0.16e2 * t116 * t166 - 0.12e2 * t336 * t339 - 0.16e2 / 0.3e1 * t257 * t343 + 0.4e1 * t61 * t347 + 0.2e1 * t351 * t260 - 0.8e1 / 0.3e1 * t356 * t273;
  t363 = 0.16e2 / 0.27e2 * t27 * t148 * t111 + 0.2e1 / 0.9e1 * t27 * t148 * t107 - 0.16e2 / 0.27e2 * t91 * t298 - 0.4e1 / 0.9e1 * t91 * t303 + 0.2e1 / 0.9e1 * t91 * t317 - 0.2e1 / 0.9e1 * t53 * t26 * t359;
  t368 = my_piecewise3(t2, 0, -t6 * t78 * t177 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t363);
  tv2rhosigma0 = 0.2e1 * rho[0] * t368 + 0.2e1 * t181;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t374 = t157 * t157;
  t375 = t205 * t374;
  t376 = t54 * t375;
  t379 = 0.1e1 / t57;
  t380 = t36 * t379;
  t383 = 0.1e1 / sigma[0];
  t384 = t36 * t383;
  t387 = t29 * t170;
  t388 = t387 * t226;
  t391 = -t380 * t45 / 0.4e1 + t384 * t154 / 0.4e1 - t36 * t388 / 0.2e1;
  t392 = t92 * t391;
  t393 = t54 * t392;
  t396 = t63 * t157;
  t400 = params->beta * t151;
  t401 = t400 * t60;
  t406 = params->beta * t170;
  t408 = t258 * t102;
  t412 = t251 * t44 * t374;
  t418 = t121 * t44 * t391;
  t421 = 0.1e1 / t269;
  t422 = t28 * t421;
  t428 = 0.4e1 / 0.9e1 * t27 * t148 * t158 - 0.4e1 / 0.9e1 * t91 * t376 + 0.2e1 / 0.9e1 * t91 * t393 - 0.2e1 / 0.9e1 * t53 * t26 * (-0.2e1 * t35 * t396 + 0.2e1 * t376 - t393 - 0.3e1 / 0.2e1 * t401 * t65 + 0.12e2 * t162 * t166 - 0.5e1 / 0.2e1 * t406 * t63 * t408 - 0.12e2 * t61 * t412 + 0.4e1 * t351 * t343 + 0.4e1 * t61 * t418 + t422 * t273);
  t432 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t428);
  tv2sigma20 = 0.2e1 * rho[0] * t432;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t435 = t17 * t34;
  t446 = 0.1e1 / t32 / t114;
  t447 = t30 * t446;
  t448 = t447 * t48;
  t452 = t194 * t63;
  t453 = t452 * t106;
  t454 = t54 * t453;
  t457 = t84 * t120;
  t458 = t457 * t206;
  t459 = t54 * t458;
  t462 = t200 * t230;
  t463 = t54 * t462;
  t466 = t34 * t250;
  t467 = t206 * t106;
  t468 = t466 * t467;
  t469 = t54 * t468;
  t472 = t120 * t106;
  t473 = t472 * t230;
  t474 = t99 * t473;
  t480 = t29 / t18 / t59 * t44;
  t483 = t447 * t102;
  t487 = 0.1e1 / t18 / t269;
  t492 = t269 * t82;
  t493 = 0.1e1 / t492;
  t495 = t100 * t100;
  t497 = 0.1e1 / t101 / t495;
  t501 = -0.28e3 / 0.27e2 * t38 * t480 - 0.952e3 / 0.27e2 * t98 * t483 + 0.1184e4 / 0.27e2 * t220 * t29 * t487 * t226 - 0.256e3 / 0.9e1 * t36 * t267 * t493 * t497;
  t502 = t92 * t501;
  t503 = t54 * t502;
  t509 = t268 * t493;
  t512 = t446 * t48;
  t517 = t223 * t120;
  t518 = t127 * t517;
  t522 = 0.1e1 / t249 / t47;
  t523 = t522 * params->gamma;
  t525 = t523 * t44 * t467;
  t529 = t106 * t230;
  t530 = t337 * t529;
  t533 = t130 * t250;
  t534 = t127 * t533;
  t536 = t258 * t102 * t206;
  t540 = t258 * t102 * t230;
  t545 = 0.1e1 / t221;
  t546 = t58 * t545;
  t557 = t121 * t226 * t106;
  t561 = t121 * t44 * t501;
  t564 = t126 * t126;
  t565 = params->beta * t564;
  t566 = t269 * t114;
  t568 = 0.1e1 / t32 / t566;
  t571 = t64 * t497 * t30;
  t574 = -0.36e2 * t336 * t530 + 0.48e2 * t534 * t536 - 0.16e2 * t257 * t540 + 0.144e3 * t116 * t253 + 0.24e3 * t546 * t65 + 0.24e3 * t241 * t123 + 0.6896e4 / 0.27e2 * t127 * t487 * t133 - 0.48e2 * t116 * t264 - 0.128e3 / 0.3e1 * t272 * t557 + 0.4e1 * t61 * t561 + 0.256e3 / 0.9e1 * t565 * t568 * t571;
  t579 = 0.2464e4 / 0.243e3 * t27 * t28 * t448 + 0.176e3 / 0.27e2 * t91 * t454 + 0.32e2 / 0.9e1 * t91 * t459 - 0.16e2 / 0.9e1 * t91 * t463 + 0.4e1 / 0.3e1 * t91 * t469 - 0.4e1 / 0.3e1 * t91 * t474 + 0.2e1 / 0.9e1 * t91 * t503 - 0.2e1 / 0.9e1 * t53 * t26 * (-0.16e2 * t459 - 0.6e1 * t469 + 0.6e1 * t474 - 0.3904e4 / 0.27e2 * t509 * t273 - 0.1232e4 / 0.27e2 * t54 * t512 - 0.88e2 / 0.3e1 * t454 + 0.8e1 * t463 - t503 + 0.496e3 / 0.3e1 * t518 * t260 + 0.48e2 * t61 * t525 + t574);
  t584 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t435 * t72 + t6 * t186 * t140 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t78 * t280 - 0.3e1 / 0.8e1 * t6 * t19 * t579);
  tv3rho30 = 0.2e1 * rho[0] * t584 + 0.6e1 * t285;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t606 = t452 * t157;
  t607 = t54 * t606;
  t610 = t54 * t84;
  t611 = t610 * t302;
  t614 = t200 * t315;
  t615 = t54 * t614;
  t618 = t250 * t157;
  t619 = t618 * t206;
  t620 = t99 * t619;
  t623 = t120 * t315;
  t624 = t623 * t106;
  t625 = t99 * t624;
  t628 = t301 * t230;
  t629 = t99 * t628;
  t640 = t271 * t497;
  t644 = 0.14e2 / 0.9e1 * t152 * t214 + 0.74e2 / 0.9e1 * t36 * t217 - 0.124e3 / 0.9e1 * t310 * t223 * t226 * sigma[0] + 0.32e2 / 0.3e1 * t36 * t640 * t126;
  t645 = t92 * t644;
  t646 = t54 * t645;
  t649 = t269 * t59;
  t651 = 0.1e1 / t32 / t649;
  t665 = t121 * t226 * t157;
  t669 = t121 * t44 * t644;
  t679 = t161 * t240;
  t685 = t127 * t271;
  t688 = -0.32e2 / 0.3e1 * t268 * t651 * t571 - 0.48e2 * t325 * t123 - 0.676e3 / 0.9e1 * t28 * t223 * t133 + 0.6e1 * t162 * t264 - 0.32e2 * t116 * t347 - 0.128e3 / 0.9e1 * t272 * t665 + 0.4e1 * t61 * t669 + 0.32e2 / 0.3e1 * t356 * t557 + 0.8e2 * t241 * t166 - 0.18e2 * t162 * t253 - 0.6e1 * t620 - 0.6e2 * t679 * t65 - 0.32e2 / 0.3e1 * t611 + 0.4e1 * t625 + 0.2e1 * t629 + 0.44e3 / 0.9e1 * t685 * t273;
  t689 = t120 * t206;
  t694 = t63 * t230;
  t696 = t115 * t250;
  t697 = t58 * t696;
  t702 = t315 * t106;
  t703 = t337 * t702;
  t706 = t157 * t230;
  t707 = t337 * t706;
  t710 = t102 * t315;
  t711 = t258 * t710;
  t716 = t28 * t256;
  t720 = t28 * t170 * t250;
  t723 = t60 * t522;
  t724 = t58 * t723;
  t726 = t337 * t157 * t206;
  t733 = t258 * t342 * t106;
  t736 = 0.2e1 * t35 * t689 + 0.16e2 / 0.3e1 * t85 * t321 - t35 * t694 + 0.96e2 * t697 * t339 + 0.496e3 / 0.9e1 * t518 * t343 - 0.24e2 * t336 * t703 - 0.12e2 * t336 * t707 - 0.32e2 / 0.3e1 * t257 * t711 + 0.2e1 * t351 * t540 - 0.112e3 / 0.3e1 * t716 * t260 - 0.6e1 * t720 * t536 + 0.48e2 * t724 * t726 - 0.88e2 / 0.9e1 * t607 + 0.16e2 / 0.3e1 * t615 - t646 + 0.88e2 / 0.9e1 * t196 + 0.32e2 * t534 * t733;
  t741 = -0.176e3 / 0.81e2 * t27 * t148 * t235 - 0.32e2 / 0.27e2 * t27 * t148 * t201 - 0.4e1 / 0.9e1 * t27 * t148 * t207 + 0.2e1 / 0.9e1 * t27 * t148 * t231 + 0.176e3 / 0.81e2 * t91 * t607 + 0.64e2 / 0.27e2 * t91 * t611 - 0.32e2 / 0.27e2 * t91 * t615 + 0.4e1 / 0.3e1 * t91 * t620 - 0.8e1 / 0.9e1 * t91 * t625 - 0.4e1 / 0.9e1 * t91 * t629 + 0.2e1 / 0.9e1 * t91 * t646 - 0.2e1 / 0.9e1 * t53 * t26 * (t688 + t736);
  t746 = my_piecewise3(t2, 0, t6 * t186 * t177 / 0.12e2 - t6 * t78 * t363 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t741);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t746 + 0.4e1 * t368;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t755 = t35 * t302;
  t761 = t457 * t374;
  t762 = t54 * t761;
  t765 = t250 * t374;
  t766 = t765 * t106;
  t767 = t99 * t766;
  t770 = t301 * t315;
  t771 = t99 * t770;
  t774 = t200 * t391;
  t775 = t54 * t774;
  t778 = t120 * t391;
  t779 = t778 * t106;
  t780 = t99 * t779;
  t788 = t29 * t130 * t226;
  t791 = t355 * t497;
  t795 = t380 * t96 / 0.3e1 - t384 * t103 / 0.3e1 + 0.1e2 / 0.3e1 * t36 * t788 - 0.4e1 * t36 * t791 * sigma[0];
  t796 = t92 * t795;
  t797 = t54 * t796;
  t800 = t406 * t120;
  t806 = t121 * t44 * t795;
  t812 = 0.1e1 / t32 / t492;
  t826 = t400 * t115;
  t832 = params->beta * t130;
  t836 = 0.5e1 * t800 * t260 + 0.32e2 / 0.3e1 * t356 * t665 + 0.4e1 * t61 * t806 - 0.2e1 * t422 * t557 + 0.4e1 * t127 * t812 * t571 - 0.16e2 * t116 * t418 - 0.48e2 * t325 * t166 + 0.48e2 * t116 * t412 + 0.3e1 * t401 * t123 + 0.12e2 * t162 * t347 + 0.6e1 * t826 * t65 - 0.6e1 * t767 + 0.4e1 * t771 + 0.2e1 * t780 + 0.46e2 / 0.3e1 * t832 * t63 * t408;
  t837 = params->beta * t355;
  t839 = params->gamma * t226;
  t840 = t839 * sigma[0];
  t845 = t63 * t315;
  t849 = t337 * t374 * t106;
  t853 = t337 * t157 * t315;
  t856 = t102 * t374;
  t857 = t258 * t856;
  t862 = t391 * t106;
  t863 = t337 * t862;
  t866 = t102 * t391;
  t867 = t258 * t866;
  t870 = t161 * t335;
  t880 = -0.44e2 / 0.3e1 * t837 * t63 * t840 + 0.16e2 / 0.3e1 * t85 * t396 - 0.2e1 * t35 * t845 + 0.48e2 * t724 * t849 - 0.24e2 * t336 * t853 + 0.16e2 * t534 * t857 + 0.4e1 * t351 * t711 - 0.12e2 * t336 * t863 - 0.16e2 / 0.3e1 * t257 * t867 - 0.36e2 * t870 * t339 - 0.112e3 / 0.3e1 * t716 * t343 + 0.4e1 * t755 - t797 - 0.16e2 / 0.3e1 * t762 + 0.8e1 / 0.3e1 * t775 - 0.12e2 * t720 * t733;
  t885 = -0.32e2 / 0.27e2 * t27 * t148 * t297 - 0.8e1 / 0.9e1 * t91 * t755 + 0.4e1 / 0.9e1 * t27 * t148 * t316 + 0.32e2 / 0.27e2 * t91 * t762 + 0.4e1 / 0.3e1 * t91 * t767 - 0.8e1 / 0.9e1 * t91 * t771 - 0.16e2 / 0.27e2 * t91 * t775 - 0.4e1 / 0.9e1 * t91 * t780 + 0.2e1 / 0.9e1 * t91 * t797 - 0.2e1 / 0.9e1 * t53 * t26 * (t836 + t880);
  t890 = my_piecewise3(t2, 0, -t6 * t78 * t428 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t885);
  tv3rhosigma20 = 0.2e1 * rho[0] * t890 + 0.2e1 * t432;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t899 = t374 * t157;
  t900 = t466 * t899;
  t901 = t54 * t900;
  t904 = t301 * t391;
  t905 = t99 * t904;
  t909 = 0.1e1 / t37 / t126;
  t910 = t36 * t909;
  t913 = 0.1e1 / t126;
  t914 = t36 * t913;
  t922 = 0.3e1 / 0.8e1 * t910 * t45 - 0.3e1 / 0.8e1 * t914 * t154 - t384 * t388 / 0.4e1 + 0.3e1 / 0.2e1 * t36 * t421 * t497;
  t923 = t92 * t922;
  t924 = t54 * t923;
  t928 = 0.1e1 / t32 / t270;
  t934 = params->beta * t421;
  t937 = t120 * t374;
  t940 = t63 * t391;
  t946 = t523 * t44 * t899;
  t949 = t157 * t391;
  t950 = t337 * t949;
  t957 = params->beta * t379;
  t958 = t957 * t60;
  t963 = params->beta * t383;
  t974 = t121 * t44 * t922;
  t977 = -0.3e1 / 0.2e1 * t28 * t928 * t571 - 0.6e1 * t901 + 0.6e1 * t905 - t924 + 0.7e1 / 0.2e1 * t934 * t273 + 0.6e1 * t35 * t937 - 0.3e1 * t35 * t940 - 0.54e2 * t162 * t412 + 0.48e2 * t61 * t946 - 0.36e2 * t336 * t950 - 0.18e2 * t720 * t857 + 0.6e1 * t351 * t867 + 0.3e1 / 0.4e1 * t958 * t65 + 0.9e1 * t401 * t166 - 0.3e1 / 0.4e1 * t963 * t170 * t133 + 0.18e2 * t162 * t418 + 0.15e2 * t800 * t343 - 0.6e1 * t422 * t665 + 0.4e1 * t61 * t974;
  t981 = -0.4e1 / 0.3e1 * t27 * t148 * t375 + 0.2e1 / 0.3e1 * t27 * t148 * t392 + 0.4e1 / 0.3e1 * t91 * t901 - 0.4e1 / 0.3e1 * t91 * t905 + 0.2e1 / 0.9e1 * t91 * t924 - 0.2e1 / 0.9e1 * t53 * t26 * t977;
  t985 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t981);
  tv3sigma30 = 0.2e1 * rho[0] * t985;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t32, t34, t35, t36, t37, t38, t40, t44;
  double t45, t47, t48, t49, t53, t54, t55, t57;
  double t58, t59, t60, t61, t62, t63, t64, t65;
  double t72, t76, tzk0;

  double t78, t82, t84, t85, t86, t91, t92, t96;
  double t98, t99, t100, t101, t102, t103, t106, t107;
  double t108, t111, t114, t115, t116, t120, t121, t123;
  double t126, t127, t128, t130, t132, t133, t140, t145;
  double tvrho0, t148, t151, t152, t154, t157, t158, t159;
  double t161, t162, t166, t170, t177, t181, tvsigma0;

  double t186, t194, t195, t196, t200, t201, t202, t205;
  double t206, t207, t208, t214, t217, t220, t221, t223;
  double t226, t227, t230, t231, t232, t235, t240, t241;
  double t249, t250, t251, t253, t256, t257, t258, t259;
  double t260, t264, t267, t268, t269, t270, t271, t272;
  double t273, t276, t280, t285, tv2rho20, t297, t298, t301;
  double t302, t303, t310, t315, t316, t317, t321, t325;
  double t335, t336, t337, t338, t339, t342, t343, t347;
  double t350, t351, t354, t355, t356, t359, t363, t368;
  double tv2rhosigma0, t374, t375, t376, t379, t380, t383, t384;
  double t387, t388, t391, t392, t393, t396, t400, t401;
  double t406, t408, t412, t418, t421, t422, t428, t432;
  double tv2sigma20;

  double t435, t446, t447, t448, t452, t453, t454, t457;
  double t458, t459, t462, t463, t466, t467, t468, t469;
  double t472, t473, t474, t480, t483, t487, t492, t493;
  double t495, t497, t501, t502, t503, t509, t512, t517;
  double t518, t522, t523, t525, t529, t530, t533, t534;
  double t536, t540, t545, t546, t557, t561, t564, t565;
  double t566, t568, t571, t574, t579, t584, tv3rho30, t606;
  double t607, t610, t611, t614, t615, t618, t619, t620;
  double t623, t624, t625, t628, t629, t640, t644, t645;
  double t646, t649, t651, t665, t669, t679, t685, t688;
  double t689, t694, t696, t697, t702, t703, t706, t707;
  double t710, t711, t716, t720, t723, t724, t726, t733;
  double t736, t741, t746, tv3rho2sigma0, t755, t761, t762, t765;
  double t766, t767, t770, t771, t774, t775, t778, t779;
  double t780, t788, t791, t795, t796, t797, t800, t806;
  double t812, t826, t832, t836, t837, t839, t840, t845;
  double t849, t853, t856, t857, t862, t863, t866, t867;
  double t870, t880, t885, t890, tv3rhosigma20, t899, t900, t901;
  double t904, t905, t909, t910, t913, t914, t922, t923;
  double t924, t928, t934, t937, t940, t946, t949, t950;
  double t957, t958, t963, t974, t977, t981, t985, tv3sigma30;

  double t1002, t1003, t1008, t1010, t1013, t1015, t1019, t1022;
  double t1024, t1027, t1031, t1034, t1035, t1037, t1042, t1045;
  double t1047, t1051, t1061, t1066, t1072, t1074, t1077, t1082;
  double t1084, t1113, t1119, t1128, t1132, t1137, t1139, t1140;
  double t1155, t1156, t1158, t1168, t1170, t1178, t1182, t1186;
  double t1197, t1200, t1205, t1210, tv4rho40, t1224, t1244, t1246;
  double t1263, t1269, t1271, t1275, t1282, t1284, t1287, t1290;
  double t1292, t1307, t1321, t1342, t1345, t1347, t1350, t1364;
  double t1381, t1385, t1389, t1394, t1396, t1404, t1408, t1413;
  double t1429, t1437, t1443, t1449, t1452, t1456, t1467, t1468;
  double t1476, t1501, t1507, tv4rho3sigma0, t1528, t1536, t1539, t1544;
  double t1555, t1562, t1566, t1572, t1575, t1577, t1578, t1580;
  double t1583, t1586, t1594, t1619, t1637, t1642, t1644, t1646;
  double t1648, t1651, t1652, t1655, t1658, t1661, t1664, t1678;
  double t1699, t1723, t1729, t1744, t1749, t1753, t1759, t1762;
  double t1792, t1817, t1823, tv4rho2sigma20, t1832, t1835, t1841, t1848;
  double t1853, t1857, t1860, t1863, t1868, t1872, t1876, t1881;
  double t1897, t1899, t1909, t1936, t1968, t1995, t2004, t2014;
  double t2032, t2040, t2047, t2056, t2062, t2067, tv4rhosigma30, t2073;
  double t2079, t2081, t2085, t2088, t2090, t2094, t2116, t2118;
  double t2170, t2207, t2216, tv4sigma40;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = t3 * t3;
  t21 = params->c1 * t20;
  t23 = POW_1_3(0.1e1 / M_PI);
  t24 = 0.1e1 / t23;
  t25 = M_CBRT4;
  t26 = t24 * t25;
  t27 = t21 * t26;
  t28 = params->beta * sigma[0];
  t29 = M_CBRT2;
  t30 = t29 * t29;
  t31 = rho[0] * rho[0];
  t32 = t18 * t18;
  t34 = 0.1e1 / t32 / t31;
  t35 = t30 * t34;
  t36 = params->gamma * params->beta;
  t37 = sqrt(sigma[0]);
  t38 = t36 * t37;
  t40 = 0.1e1 / t18 / rho[0];
  t44 = log(t37 * t29 * t40 + sqrt(POW_2(t37 * t29 * t40) + 0.1e1));
  t45 = t29 * t40 * t44;
  t47 = t38 * t45 + 0.1e1;
  t48 = 0.1e1 / t47;
  t49 = t35 * t48;
  t53 = params->c2 * t20;
  t54 = sigma[0] * t30;
  t55 = t34 * t48;
  t57 = t37 * sigma[0];
  t58 = params->beta * t57;
  t59 = t31 * t31;
  t60 = 0.1e1 / t59;
  t61 = t58 * t60;
  t62 = t47 * t47;
  t63 = 0.1e1 / t62;
  t64 = t63 * params->gamma;
  t65 = t64 * t44;
  t72 = params->c0 - 0.2e1 / 0.9e1 * t27 * t28 * t49 - 0.2e1 / 0.9e1 * t53 * t26 * (t54 * t55 - 0.2e1 * t61 * t65);
  t76 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t72);
  tzk0 = 0.2e1 * t76;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t17 / t32;
  t82 = t31 * rho[0];
  t84 = 0.1e1 / t32 / t82;
  t85 = t30 * t84;
  t86 = t85 * t48;
  t91 = t21 * t26 * params->beta;
  t92 = t34 * t63;
  t96 = t29 / t18 / t31 * t44;
  t98 = t36 * sigma[0];
  t99 = t54 * t34;
  t100 = t99 + 0.1e1;
  t101 = sqrt(t100);
  t102 = 0.1e1 / t101;
  t103 = t85 * t102;
  t106 = -0.4e1 / 0.3e1 * t98 * t103 - 0.4e1 / 0.3e1 * t38 * t96;
  t107 = t92 * t106;
  t108 = t54 * t107;
  t111 = t84 * t48;
  t114 = t59 * rho[0];
  t115 = 0.1e1 / t114;
  t116 = t58 * t115;
  t120 = 0.1e1 / t62 / t47;
  t121 = t120 * params->gamma;
  t123 = t121 * t44 * t106;
  t126 = sigma[0] * sigma[0];
  t127 = params->beta * t126;
  t128 = t59 * t31;
  t130 = 0.1e1 / t18 / t128;
  t132 = t29 * t102;
  t133 = t64 * t132;
  t140 = 0.16e2 / 0.27e2 * t27 * t28 * t86 + 0.2e1 / 0.9e1 * t91 * t108 - 0.2e1 / 0.9e1 * t53 * t26 * (-0.8e1 / 0.3e1 * t54 * t111 - t108 + 0.8e1 * t116 * t65 + 0.4e1 * t61 * t123 + 0.8e1 / 0.3e1 * t127 * t130 * t133);
  t145 = my_piecewise3(t2, 0, -t6 * t78 * t72 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t140);
  tvrho0 = 0.2e1 * rho[0] * t145 + 0.2e1 * t76;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t148 = params->beta * t30;
  t151 = 0.1e1 / t37;
  t152 = t36 * t151;
  t154 = t35 * t102;
  t157 = t152 * t45 / 0.2e1 + t36 * t154 / 0.2e1;
  t158 = t92 * t157;
  t159 = t54 * t158;
  t161 = params->beta * t37;
  t162 = t161 * t60;
  t166 = t121 * t44 * t157;
  t170 = 0.1e1 / t18 / t114;
  t177 = -0.2e1 / 0.9e1 * t27 * t148 * t55 + 0.2e1 / 0.9e1 * t91 * t159 - 0.2e1 / 0.9e1 * t53 * t26 * (-t28 * t170 * t133 - 0.3e1 * t162 * t65 + 0.4e1 * t61 * t166 - t159 + t49);
  t181 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t177);
  tvsigma0 = 0.2e1 * rho[0] * t181;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t186 = t17 / t32 / rho[0];
  t194 = 0.1e1 / t32 / t59;
  t195 = t30 * t194;
  t196 = t195 * t48;
  t200 = t84 * t63;
  t201 = t200 * t106;
  t202 = t54 * t201;
  t205 = t34 * t120;
  t206 = t106 * t106;
  t207 = t205 * t206;
  t208 = t54 * t207;
  t214 = t29 / t18 / t82 * t44;
  t217 = t195 * t102;
  t220 = t36 * t126;
  t221 = t59 * t82;
  t223 = 0.1e1 / t18 / t221;
  t226 = 0.1e1 / t101 / t100;
  t227 = t29 * t223 * t226;
  t230 = 0.28e2 / 0.9e1 * t38 * t214 + 0.2e2 / 0.3e1 * t98 * t217 - 0.32e2 / 0.9e1 * t220 * t227;
  t231 = t92 * t230;
  t232 = t54 * t231;
  t235 = t194 * t48;
  t240 = 0.1e1 / t128;
  t241 = t58 * t240;
  t249 = t62 * t62;
  t250 = 0.1e1 / t249;
  t251 = t250 * params->gamma;
  t253 = t251 * t44 * t206;
  t256 = t130 * t120;
  t257 = t127 * t256;
  t258 = params->gamma * t29;
  t259 = t102 * t106;
  t260 = t258 * t259;
  t264 = t121 * t44 * t230;
  t267 = t126 * sigma[0];
  t268 = params->beta * t267;
  t269 = t59 * t59;
  t270 = t269 * t31;
  t271 = 0.1e1 / t270;
  t272 = t268 * t271;
  t273 = t64 * t226;
  t276 = 0.88e2 / 0.9e1 * t54 * t235 + 0.16e2 / 0.3e1 * t202 + 0.2e1 * t208 - t232 - 0.4e2 * t241 * t65 - 0.32e2 * t116 * t123 - 0.248e3 / 0.9e1 * t127 * t223 * t133 - 0.12e2 * t61 * t253 - 0.32e2 / 0.3e1 * t257 * t260 + 0.4e1 * t61 * t264 + 0.64e2 / 0.9e1 * t272 * t273;
  t280 = -0.176e3 / 0.81e2 * t27 * t28 * t196 - 0.32e2 / 0.27e2 * t91 * t202 - 0.4e1 / 0.9e1 * t91 * t208 + 0.2e1 / 0.9e1 * t91 * t232 - 0.2e1 / 0.9e1 * t53 * t26 * t276;
  t285 = my_piecewise3(t2, 0, t6 * t186 * t72 / 0.12e2 - t6 * t78 * t140 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t280);
  tv2rho20 = 0.2e1 * rho[0] * t285 + 0.4e1 * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t297 = t200 * t157;
  t298 = t54 * t297;
  t301 = t120 * t157;
  t302 = t301 * t106;
  t303 = t99 * t302;
  t310 = t36 * t29;
  t315 = -0.2e1 / 0.3e1 * t152 * t96 - 0.2e1 * t36 * t103 + 0.4e1 / 0.3e1 * t310 * t130 * t226 * sigma[0];
  t316 = t92 * t315;
  t317 = t54 * t316;
  t321 = t63 * t106;
  t325 = t161 * t115;
  t335 = t60 * t250;
  t336 = t58 * t335;
  t337 = params->gamma * t44;
  t338 = t157 * t106;
  t339 = t337 * t338;
  t342 = t102 * t157;
  t343 = t258 * t342;
  t347 = t121 * t44 * t315;
  t350 = t170 * t120;
  t351 = t28 * t350;
  t354 = t269 * rho[0];
  t355 = 0.1e1 / t354;
  t356 = t127 * t355;
  t359 = -0.8e1 / 0.3e1 * t86 - t35 * t321 + 0.8e1 / 0.3e1 * t298 + 0.2e1 * t303 - t317 + 0.12e2 * t325 * t65 + 0.6e1 * t162 * t123 + 0.28e2 / 0.3e1 * t28 * t130 * t133 - 0.16e2 * t116 * t166 - 0.12e2 * t336 * t339 - 0.16e2 / 0.3e1 * t257 * t343 + 0.4e1 * t61 * t347 + 0.2e1 * t351 * t260 - 0.8e1 / 0.3e1 * t356 * t273;
  t363 = 0.16e2 / 0.27e2 * t27 * t148 * t111 + 0.2e1 / 0.9e1 * t27 * t148 * t107 - 0.16e2 / 0.27e2 * t91 * t298 - 0.4e1 / 0.9e1 * t91 * t303 + 0.2e1 / 0.9e1 * t91 * t317 - 0.2e1 / 0.9e1 * t53 * t26 * t359;
  t368 = my_piecewise3(t2, 0, -t6 * t78 * t177 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t363);
  tv2rhosigma0 = 0.2e1 * rho[0] * t368 + 0.2e1 * t181;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t374 = t157 * t157;
  t375 = t205 * t374;
  t376 = t54 * t375;
  t379 = 0.1e1 / t57;
  t380 = t36 * t379;
  t383 = 0.1e1 / sigma[0];
  t384 = t36 * t383;
  t387 = t29 * t170;
  t388 = t387 * t226;
  t391 = -t380 * t45 / 0.4e1 + t384 * t154 / 0.4e1 - t36 * t388 / 0.2e1;
  t392 = t92 * t391;
  t393 = t54 * t392;
  t396 = t63 * t157;
  t400 = params->beta * t151;
  t401 = t400 * t60;
  t406 = params->beta * t170;
  t408 = t258 * t102;
  t412 = t251 * t44 * t374;
  t418 = t121 * t44 * t391;
  t421 = 0.1e1 / t269;
  t422 = t28 * t421;
  t428 = 0.4e1 / 0.9e1 * t27 * t148 * t158 - 0.4e1 / 0.9e1 * t91 * t376 + 0.2e1 / 0.9e1 * t91 * t393 - 0.2e1 / 0.9e1 * t53 * t26 * (-0.2e1 * t35 * t396 + 0.2e1 * t376 - t393 - 0.3e1 / 0.2e1 * t401 * t65 + 0.12e2 * t162 * t166 - 0.5e1 / 0.2e1 * t406 * t63 * t408 - 0.12e2 * t61 * t412 + 0.4e1 * t351 * t343 + 0.4e1 * t61 * t418 + t422 * t273);
  t432 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t428);
  tv2sigma20 = 0.2e1 * rho[0] * t432;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t435 = t17 * t34;
  t446 = 0.1e1 / t32 / t114;
  t447 = t30 * t446;
  t448 = t447 * t48;
  t452 = t194 * t63;
  t453 = t452 * t106;
  t454 = t54 * t453;
  t457 = t84 * t120;
  t458 = t457 * t206;
  t459 = t54 * t458;
  t462 = t200 * t230;
  t463 = t54 * t462;
  t466 = t34 * t250;
  t467 = t206 * t106;
  t468 = t466 * t467;
  t469 = t54 * t468;
  t472 = t120 * t106;
  t473 = t472 * t230;
  t474 = t99 * t473;
  t480 = t29 / t18 / t59 * t44;
  t483 = t447 * t102;
  t487 = 0.1e1 / t18 / t269;
  t492 = t269 * t82;
  t493 = 0.1e1 / t492;
  t495 = t100 * t100;
  t497 = 0.1e1 / t101 / t495;
  t501 = -0.28e3 / 0.27e2 * t38 * t480 - 0.952e3 / 0.27e2 * t98 * t483 + 0.1184e4 / 0.27e2 * t220 * t29 * t487 * t226 - 0.256e3 / 0.9e1 * t36 * t267 * t493 * t497;
  t502 = t92 * t501;
  t503 = t54 * t502;
  t509 = t268 * t493;
  t512 = t446 * t48;
  t517 = t223 * t120;
  t518 = t127 * t517;
  t522 = 0.1e1 / t249 / t47;
  t523 = t522 * params->gamma;
  t525 = t523 * t44 * t467;
  t529 = t106 * t230;
  t530 = t337 * t529;
  t533 = t130 * t250;
  t534 = t127 * t533;
  t536 = t258 * t102 * t206;
  t540 = t258 * t102 * t230;
  t545 = 0.1e1 / t221;
  t546 = t58 * t545;
  t557 = t121 * t226 * t106;
  t561 = t121 * t44 * t501;
  t564 = t126 * t126;
  t565 = params->beta * t564;
  t566 = t269 * t114;
  t568 = 0.1e1 / t32 / t566;
  t571 = t64 * t497 * t30;
  t574 = -0.36e2 * t336 * t530 + 0.48e2 * t534 * t536 - 0.16e2 * t257 * t540 + 0.144e3 * t116 * t253 + 0.24e3 * t546 * t65 + 0.24e3 * t241 * t123 + 0.6896e4 / 0.27e2 * t127 * t487 * t133 - 0.48e2 * t116 * t264 - 0.128e3 / 0.3e1 * t272 * t557 + 0.4e1 * t61 * t561 + 0.256e3 / 0.9e1 * t565 * t568 * t571;
  t579 = 0.2464e4 / 0.243e3 * t27 * t28 * t448 + 0.176e3 / 0.27e2 * t91 * t454 + 0.32e2 / 0.9e1 * t91 * t459 - 0.16e2 / 0.9e1 * t91 * t463 + 0.4e1 / 0.3e1 * t91 * t469 - 0.4e1 / 0.3e1 * t91 * t474 + 0.2e1 / 0.9e1 * t91 * t503 - 0.2e1 / 0.9e1 * t53 * t26 * (-0.16e2 * t459 - 0.6e1 * t469 + 0.6e1 * t474 - 0.3904e4 / 0.27e2 * t509 * t273 - 0.1232e4 / 0.27e2 * t54 * t512 - 0.88e2 / 0.3e1 * t454 + 0.8e1 * t463 - t503 + 0.496e3 / 0.3e1 * t518 * t260 + 0.48e2 * t61 * t525 + t574);
  t584 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t435 * t72 + t6 * t186 * t140 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t78 * t280 - 0.3e1 / 0.8e1 * t6 * t19 * t579);
  tv3rho30 = 0.2e1 * rho[0] * t584 + 0.6e1 * t285;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t606 = t452 * t157;
  t607 = t54 * t606;
  t610 = t54 * t84;
  t611 = t610 * t302;
  t614 = t200 * t315;
  t615 = t54 * t614;
  t618 = t250 * t157;
  t619 = t618 * t206;
  t620 = t99 * t619;
  t623 = t120 * t315;
  t624 = t623 * t106;
  t625 = t99 * t624;
  t628 = t301 * t230;
  t629 = t99 * t628;
  t640 = t271 * t497;
  t644 = 0.14e2 / 0.9e1 * t152 * t214 + 0.74e2 / 0.9e1 * t36 * t217 - 0.124e3 / 0.9e1 * t310 * t223 * t226 * sigma[0] + 0.32e2 / 0.3e1 * t36 * t640 * t126;
  t645 = t92 * t644;
  t646 = t54 * t645;
  t649 = t269 * t59;
  t651 = 0.1e1 / t32 / t649;
  t665 = t121 * t226 * t157;
  t669 = t121 * t44 * t644;
  t679 = t161 * t240;
  t685 = t127 * t271;
  t688 = -0.32e2 / 0.3e1 * t268 * t651 * t571 - 0.48e2 * t325 * t123 - 0.676e3 / 0.9e1 * t28 * t223 * t133 + 0.6e1 * t162 * t264 - 0.32e2 * t116 * t347 - 0.128e3 / 0.9e1 * t272 * t665 + 0.4e1 * t61 * t669 + 0.32e2 / 0.3e1 * t356 * t557 + 0.8e2 * t241 * t166 - 0.18e2 * t162 * t253 - 0.6e1 * t620 - 0.6e2 * t679 * t65 - 0.32e2 / 0.3e1 * t611 + 0.4e1 * t625 + 0.2e1 * t629 + 0.44e3 / 0.9e1 * t685 * t273;
  t689 = t120 * t206;
  t694 = t63 * t230;
  t696 = t115 * t250;
  t697 = t58 * t696;
  t702 = t315 * t106;
  t703 = t337 * t702;
  t706 = t157 * t230;
  t707 = t337 * t706;
  t710 = t102 * t315;
  t711 = t258 * t710;
  t716 = t28 * t256;
  t720 = t28 * t170 * t250;
  t723 = t60 * t522;
  t724 = t58 * t723;
  t726 = t337 * t157 * t206;
  t733 = t258 * t342 * t106;
  t736 = 0.2e1 * t35 * t689 + 0.16e2 / 0.3e1 * t85 * t321 - t35 * t694 + 0.96e2 * t697 * t339 + 0.496e3 / 0.9e1 * t518 * t343 - 0.24e2 * t336 * t703 - 0.12e2 * t336 * t707 - 0.32e2 / 0.3e1 * t257 * t711 + 0.2e1 * t351 * t540 - 0.112e3 / 0.3e1 * t716 * t260 - 0.6e1 * t720 * t536 + 0.48e2 * t724 * t726 - 0.88e2 / 0.9e1 * t607 + 0.16e2 / 0.3e1 * t615 - t646 + 0.88e2 / 0.9e1 * t196 + 0.32e2 * t534 * t733;
  t741 = -0.176e3 / 0.81e2 * t27 * t148 * t235 - 0.32e2 / 0.27e2 * t27 * t148 * t201 - 0.4e1 / 0.9e1 * t27 * t148 * t207 + 0.2e1 / 0.9e1 * t27 * t148 * t231 + 0.176e3 / 0.81e2 * t91 * t607 + 0.64e2 / 0.27e2 * t91 * t611 - 0.32e2 / 0.27e2 * t91 * t615 + 0.4e1 / 0.3e1 * t91 * t620 - 0.8e1 / 0.9e1 * t91 * t625 - 0.4e1 / 0.9e1 * t91 * t629 + 0.2e1 / 0.9e1 * t91 * t646 - 0.2e1 / 0.9e1 * t53 * t26 * (t688 + t736);
  t746 = my_piecewise3(t2, 0, t6 * t186 * t177 / 0.12e2 - t6 * t78 * t363 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t741);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t746 + 0.4e1 * t368;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t755 = t35 * t302;
  t761 = t457 * t374;
  t762 = t54 * t761;
  t765 = t250 * t374;
  t766 = t765 * t106;
  t767 = t99 * t766;
  t770 = t301 * t315;
  t771 = t99 * t770;
  t774 = t200 * t391;
  t775 = t54 * t774;
  t778 = t120 * t391;
  t779 = t778 * t106;
  t780 = t99 * t779;
  t788 = t29 * t130 * t226;
  t791 = t355 * t497;
  t795 = t380 * t96 / 0.3e1 - t384 * t103 / 0.3e1 + 0.1e2 / 0.3e1 * t36 * t788 - 0.4e1 * t36 * t791 * sigma[0];
  t796 = t92 * t795;
  t797 = t54 * t796;
  t800 = t406 * t120;
  t806 = t121 * t44 * t795;
  t812 = 0.1e1 / t32 / t492;
  t826 = t400 * t115;
  t832 = params->beta * t130;
  t836 = 0.5e1 * t800 * t260 + 0.32e2 / 0.3e1 * t356 * t665 + 0.4e1 * t61 * t806 - 0.2e1 * t422 * t557 + 0.4e1 * t127 * t812 * t571 - 0.16e2 * t116 * t418 - 0.48e2 * t325 * t166 + 0.48e2 * t116 * t412 + 0.3e1 * t401 * t123 + 0.12e2 * t162 * t347 + 0.6e1 * t826 * t65 - 0.6e1 * t767 + 0.4e1 * t771 + 0.2e1 * t780 + 0.46e2 / 0.3e1 * t832 * t63 * t408;
  t837 = params->beta * t355;
  t839 = params->gamma * t226;
  t840 = t839 * sigma[0];
  t845 = t63 * t315;
  t849 = t337 * t374 * t106;
  t853 = t337 * t157 * t315;
  t856 = t102 * t374;
  t857 = t258 * t856;
  t862 = t391 * t106;
  t863 = t337 * t862;
  t866 = t102 * t391;
  t867 = t258 * t866;
  t870 = t161 * t335;
  t880 = -0.44e2 / 0.3e1 * t837 * t63 * t840 + 0.16e2 / 0.3e1 * t85 * t396 - 0.2e1 * t35 * t845 + 0.48e2 * t724 * t849 - 0.24e2 * t336 * t853 + 0.16e2 * t534 * t857 + 0.4e1 * t351 * t711 - 0.12e2 * t336 * t863 - 0.16e2 / 0.3e1 * t257 * t867 - 0.36e2 * t870 * t339 - 0.112e3 / 0.3e1 * t716 * t343 + 0.4e1 * t755 - t797 - 0.16e2 / 0.3e1 * t762 + 0.8e1 / 0.3e1 * t775 - 0.12e2 * t720 * t733;
  t885 = -0.32e2 / 0.27e2 * t27 * t148 * t297 - 0.8e1 / 0.9e1 * t91 * t755 + 0.4e1 / 0.9e1 * t27 * t148 * t316 + 0.32e2 / 0.27e2 * t91 * t762 + 0.4e1 / 0.3e1 * t91 * t767 - 0.8e1 / 0.9e1 * t91 * t771 - 0.16e2 / 0.27e2 * t91 * t775 - 0.4e1 / 0.9e1 * t91 * t780 + 0.2e1 / 0.9e1 * t91 * t797 - 0.2e1 / 0.9e1 * t53 * t26 * (t836 + t880);
  t890 = my_piecewise3(t2, 0, -t6 * t78 * t428 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t885);
  tv3rhosigma20 = 0.2e1 * rho[0] * t890 + 0.2e1 * t432;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t899 = t374 * t157;
  t900 = t466 * t899;
  t901 = t54 * t900;
  t904 = t301 * t391;
  t905 = t99 * t904;
  t909 = 0.1e1 / t37 / t126;
  t910 = t36 * t909;
  t913 = 0.1e1 / t126;
  t914 = t36 * t913;
  t922 = 0.3e1 / 0.8e1 * t910 * t45 - 0.3e1 / 0.8e1 * t914 * t154 - t384 * t388 / 0.4e1 + 0.3e1 / 0.2e1 * t36 * t421 * t497;
  t923 = t92 * t922;
  t924 = t54 * t923;
  t928 = 0.1e1 / t32 / t270;
  t934 = params->beta * t421;
  t937 = t120 * t374;
  t940 = t63 * t391;
  t946 = t523 * t44 * t899;
  t949 = t157 * t391;
  t950 = t337 * t949;
  t957 = params->beta * t379;
  t958 = t957 * t60;
  t963 = params->beta * t383;
  t974 = t121 * t44 * t922;
  t977 = -0.3e1 / 0.2e1 * t28 * t928 * t571 - 0.6e1 * t901 + 0.6e1 * t905 - t924 + 0.7e1 / 0.2e1 * t934 * t273 + 0.6e1 * t35 * t937 - 0.3e1 * t35 * t940 - 0.54e2 * t162 * t412 + 0.48e2 * t61 * t946 - 0.36e2 * t336 * t950 - 0.18e2 * t720 * t857 + 0.6e1 * t351 * t867 + 0.3e1 / 0.4e1 * t958 * t65 + 0.9e1 * t401 * t166 - 0.3e1 / 0.4e1 * t963 * t170 * t133 + 0.18e2 * t162 * t418 + 0.15e2 * t800 * t343 - 0.6e1 * t422 * t665 + 0.4e1 * t61 * t974;
  t981 = -0.4e1 / 0.3e1 * t27 * t148 * t375 + 0.2e1 / 0.3e1 * t27 * t148 * t392 + 0.4e1 / 0.3e1 * t91 * t901 - 0.4e1 / 0.3e1 * t91 * t905 + 0.2e1 / 0.9e1 * t91 * t924 - 0.2e1 / 0.9e1 * t53 * t26 * t977;
  t985 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t981);
  tv3sigma30 = 0.2e1 * rho[0] * t985;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1002 = 0.1e1 / t32 / t128;
  t1003 = t30 * t1002;
  t1008 = t446 * t63;
  t1010 = t54 * t1008 * t106;
  t1013 = t194 * t120;
  t1015 = t54 * t1013 * t206;
  t1019 = t54 * t452 * t230;
  t1022 = t84 * t250;
  t1024 = t54 * t1022 * t467;
  t1027 = t610 * t473;
  t1031 = t54 * t200 * t501;
  t1034 = t34 * t522;
  t1035 = t206 * t206;
  t1037 = t54 * t1034 * t1035;
  t1042 = t99 * t250 * t206 * t230;
  t1045 = t230 * t230;
  t1047 = t54 * t205 * t1045;
  t1051 = t99 * t472 * t501;
  t1061 = 0.1e1 / t18 / t354;
  t1066 = 0.1e1 / t649;
  t1072 = t269 * t128;
  t1074 = 0.1e1 / t32 / t1072;
  t1077 = 0.1e1 / t101 / t495 / t100;
  t1082 = 0.364e4 / 0.81e2 * t38 * t387 * t44 + 0.5768e4 / 0.27e2 * t98 * t1003 * t102 - 0.37216e5 / 0.81e2 * t220 * t29 * t1061 * t226 + 0.1792e5 / 0.27e2 * t36 * t267 * t1066 * t497 - 0.512e4 / 0.27e2 * t36 * t564 * t1074 * t1077 * t30;
  t1084 = t54 * t92 * t1082;
  t1113 = t269 * t269;
  t1119 = t64 * t1077 * t29;
  t1128 = t251 * t226 * t206;
  t1132 = t121 * t226 * t230;
  t1137 = -0.176e3 / 0.3e1 * t1019 + 0.32e2 / 0.3e1 * t1031 - t1084 - 0.168e4 * t58 * t421 * t65 + 0.184e6 / 0.81e2 * t268 * t1066 * t273 - 0.64e2 * t1027 - 0.36e2 * t1042 + 0.8e1 * t1051 - 0.192e4 * t546 * t123 - 0.19832e6 / 0.81e2 * t127 * t1061 * t133 + 0.48e3 * t241 * t264 - 0.64e2 * t116 * t561 + 0.4e1 * t61 * t121 * t44 * t1082 + 0.1024e5 / 0.27e2 * params->beta * t564 * sigma[0] / t18 / t1113 / rho[0] * t1119 + 0.31232e5 / 0.27e2 * t509 * t557 - 0.8704e4 / 0.9e1 * t565 * t1074 * t571 + 0.256e3 * t272 * t1128 - 0.256e3 / 0.3e1 * t272 * t1132 - 0.768e3 * t116 * t525;
  t1139 = 0.1e1 / t249 / t62;
  t1140 = t1139 * params->gamma;
  t1155 = t565 * t568 * t120;
  t1156 = params->gamma * t497;
  t1158 = t1156 * t106 * t30;
  t1168 = t127 * t130 * t522;
  t1170 = t258 * t102 * t467;
  t1178 = t258 * t102 * t501;
  t1182 = t127 * t487 * t120;
  t1186 = t127 * t223 * t250;
  t1197 = t258 * t259 * t230;
  t1200 = -0.24e3 * t61 * t1140 * t44 * t1035 - 0.36e2 * t61 * t251 * t44 * t1045 - 0.144e4 * t241 * t253 + 0.20944e5 / 0.81e2 * t54 * t1002 * t48 - 0.2048e4 / 0.9e1 * t1155 * t1158 + 0.992e3 / 0.3e1 * t518 * t540 + 0.288e3 * t724 * t337 * t206 * t230 - 0.256e3 * t1168 * t1170 - 0.48e2 * t336 * t337 * t106 * t501 - 0.64e2 / 0.3e1 * t257 * t1178 - 0.55168e5 / 0.27e2 * t1182 * t260 - 0.992e3 * t1186 * t536 + 0.576e3 * t697 * t530 + 0.352e3 / 0.3e1 * t1015 + 0.64e2 * t1024 + 0.24e2 * t1037 + 0.6e1 * t1047 + 0.4928e4 / 0.27e2 * t1010 + 0.192e3 * t534 * t1197;
  t1205 = -0.41888e5 / 0.729e3 * t27 * t28 * t1003 * t48 - 0.9856e4 / 0.243e3 * t91 * t1010 - 0.704e3 / 0.27e2 * t91 * t1015 + 0.352e3 / 0.27e2 * t91 * t1019 - 0.128e3 / 0.9e1 * t91 * t1024 + 0.128e3 / 0.9e1 * t91 * t1027 - 0.64e2 / 0.27e2 * t91 * t1031 - 0.16e2 / 0.3e1 * t91 * t1037 + 0.8e1 * t91 * t1042 - 0.4e1 / 0.3e1 * t91 * t1047 - 0.16e2 / 0.9e1 * t91 * t1051 + 0.2e1 / 0.9e1 * t91 * t1084 - 0.2e1 / 0.9e1 * t53 * t26 * (t1137 + t1200);
  t1210 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t84 * t72 - 0.5e1 / 0.9e1 * t6 * t435 * t140 + t6 * t186 * t280 / 0.2e1 - t6 * t78 * t579 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1205);
  tv4rho40 = 0.2e1 * rho[0] * t1210 + 0.8e1 * t584;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1224 = t54 * t200 * t644;
  t1244 = -0.14e3 / 0.27e2 * t152 * t480 - 0.364e3 / 0.9e1 * t36 * t483 + 0.332e4 / 0.27e2 * t310 * t487 * t226 * sigma[0] - 0.1952e4 / 0.9e1 * t36 * t493 * t497 * t126 + 0.64e3 / 0.9e1 * t36 * t568 * t1077 * t267 * t30;
  t1246 = t54 * t92 * t1244;
  t1263 = t99 * t522 * t157 * t467;
  t1269 = t54 * t194 * t302;
  t1271 = t610 * t619;
  t1275 = t99 * t250 * t315 * t206;
  t1282 = t99 * t120 * t644 * t106;
  t1284 = t610 * t628;
  t1287 = t99 * t623 * t230;
  t1290 = t99 * t301 * t501;
  t1292 = t610 * t624;
  t1307 = 0.24e2 * t1263 + 0.36e3 * t161 * t545 * t65 + 0.176e3 / 0.3e1 * t1269 + 0.48e2 * t1271 - 0.18e2 * t1275 - 0.18608e5 / 0.27e2 * t127 * t493 * t273 + 0.6e1 * t1282 - 0.16e2 * t1284 + 0.6e1 * t1287 + 0.2e1 * t1290 - 0.32e2 * t1292 + 0.17032e5 / 0.27e2 * t28 * t487 * t133 - 0.72e2 * t325 * t264 + 0.6e1 * t162 * t561 - 0.48e2 * t116 * t669 + 0.4e1 * t61 * t121 * t44 * t1244;
  t1321 = t121 * t226 * t315;
  t1342 = t54 * t452 * t315;
  t1345 = t54 * t1008 * t157;
  t1347 = t35 * t473;
  t1350 = -0.18e2 * t99 * t618 * t529 - 0.88e3 / 0.3e1 * t685 * t557 + 0.992e3 / 0.3e1 * t268 * t568 * t571 + 0.24e3 * t241 * t347 + 0.7808e4 / 0.27e2 * t509 * t665 - 0.128e3 / 0.3e1 * t272 * t1321 + 0.16e2 * t356 * t1132 - 0.48e2 * t356 * t1128 + 0.36e3 * t679 * t123 - 0.128e4 / 0.9e1 * t565 / t18 / t1113 * t1119 + 0.216e3 * t325 * t253 + 0.72e2 * t162 * t525 - 0.48e3 * t546 * t166 - 0.88e2 / 0.3e1 * t1342 + 0.1232e4 / 0.27e2 * t1345 + 0.6e1 * t1347 + 0.8e1 * t1224;
  t1364 = t28 * t533;
  t1381 = t28 * t517;
  t1385 = t28 * t170 * t522;
  t1389 = t58 * t60 * t1139;
  t1394 = -t1246 - 0.1232e4 / 0.27e2 * t448 - 0.16e2 * t85 * t689 - 0.6e1 * t35 * t250 * t467 - 0.88e2 / 0.3e1 * t195 * t321 + 0.8e1 * t85 * t694 - t35 * t63 * t501 + 0.168e3 * t1364 * t536 - 0.72e3 * t58 * t240 * t250 * t339 - 0.13792e5 / 0.27e2 * t1182 * t343 + 0.288e3 * t697 * t703 + 0.144e3 * t697 * t707 + 0.496e3 / 0.3e1 * t518 * t711 - 0.56e2 * t716 * t540 + 0.1352e4 / 0.3e1 * t1381 * t260 + 0.24e2 * t1385 * t1170 - 0.24e3 * t1389 * t337 * t157 * t467;
  t1396 = t58 * t115 * t522;
  t1404 = t1156 * t157 * t30;
  t1408 = t268 * t651 * t120;
  t1413 = t839 * t338;
  t1429 = t258 * t102 * t644;
  t1437 = t258 * t342 * t230;
  t1443 = t258 * t342 * t206;
  t1449 = t258 * t710 * t106;
  t1452 = t706 * t106;
  t1456 = -0.576e3 * t1396 * t726 + 0.144e3 * t724 * t337 * t315 * t206 - 0.512e3 / 0.9e1 * t1155 * t1404 + 0.64e2 * t1408 * t1158 + 0.128e3 * t268 * t271 * t250 * t1413 - 0.36e2 * t336 * t337 * t644 * t106 - 0.36e2 * t336 * t337 * t315 * t230 - 0.12e2 * t336 * t337 * t157 * t501 - 0.16e2 * t257 * t1429 + 0.2e1 * t351 * t1178 - 0.54e2 * t870 * t530 + 0.48e2 * t534 * t1437 - 0.18e2 * t720 * t1197 - 0.192e3 * t1168 * t1443 - 0.496e3 * t1186 * t733 + 0.96e2 * t534 * t1449 + 0.144e3 * t724 * t337 * t1452;
  t1467 = t21 * t24 * t25 * params->beta * sigma[0];
  t1468 = t35 * t250;
  t1476 = -0.16e2 / 0.9e1 * t91 * t1224 + 0.2e1 / 0.9e1 * t91 * t1246 + 0.2e1 / 0.9e1 * t27 * t148 * t502 + 0.2464e4 / 0.243e3 * t27 * t148 * t512 + 0.176e3 / 0.27e2 * t27 * t148 * t453 - 0.16e2 / 0.9e1 * t27 * t148 * t462 - 0.2e1 / 0.9e1 * t53 * t26 * (t1307 + t1350 + t1394 + t1456) - 0.16e2 / 0.3e1 * t91 * t1263 + 0.4e1 * t1467 * t1468 * t1452 - 0.32e2 / 0.3e1 * t91 * t1271 + 0.4e1 * t91 * t1275;
  t1501 = -0.4e1 / 0.3e1 * t91 * t1282 - 0.4e1 / 0.3e1 * t91 * t1287 - 0.4e1 / 0.9e1 * t91 * t1290 - 0.2464e4 / 0.243e3 * t91 * t1345 - 0.352e3 / 0.27e2 * t91 * t1269 + 0.64e2 / 0.9e1 * t91 * t1292 + 0.32e2 / 0.9e1 * t91 * t1284 + 0.32e2 / 0.9e1 * t27 * t148 * t458 + 0.4e1 / 0.3e1 * t27 * t148 * t468 - 0.4e1 / 0.3e1 * t91 * t1347 + 0.176e3 / 0.27e2 * t91 * t1342;
  t1507 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t435 * t177 + t6 * t186 * t363 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t78 * t741 - 0.3e1 / 0.8e1 * t6 * t19 * (t1476 + t1501));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1507 + 0.6e1 * t746;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1528 = t121 * t226 * t391;
  t1536 = t832 * t120;
  t1539 = t837 * t120;
  t1544 = t315 * t315;
  t1555 = t406 * t250;
  t1562 = t99 * t522 * t374 * t206;
  t1566 = t99 * t250 * t391 * t206;
  t1572 = t610 * t779;
  t1575 = t99 * t778 * t230;
  t1577 = -0.316e3 / 0.3e1 * params->beta * t651 * t63 * t1156 * t126 * t30 + 0.64e2 / 0.3e1 * t356 * t1321 - 0.32e2 * t116 * t806 - 0.128e3 / 0.9e1 * t272 * t1528 + 0.24e3 * t679 * t166 - 0.24e2 * t99 * t618 * t702 - 0.184e3 / 0.3e1 * t1536 * t260 + 0.176e3 / 0.3e1 * t1539 * t839 * sigma[0] * t106 - 0.24e2 * t61 * t251 * t44 * t1544 + 0.8e2 * t241 * t418 + 0.6e1 * t422 * t1128 - 0.9e1 * t401 * t253 - 0.15e2 * t1555 * t536 - 0.24e3 * t241 * t412 + 0.24e2 * t1562 - 0.6e1 * t1566 - 0.946e3 / 0.9e1 * params->beta * t223 * t63 * t408 - 0.32e2 / 0.3e1 * t1572 + 0.2e1 * t1575;
  t1578 = t610 * t766;
  t1580 = t610 * t770;
  t1583 = t99 * t765 * t230;
  t1586 = t99 * t301 * t644;
  t1594 = t99 * t120 * t795 * t106;
  t1619 = -0.7e1 / 0.9e1 * t380 * t214 + 0.7e1 / 0.9e1 * t384 * t217 - 0.22e2 * t36 * t227 + 0.188e3 / 0.3e1 * t36 * t640 * sigma[0] - 0.8e2 / 0.3e1 * t36 * t651 * t1077 * t126 * t30;
  t1637 = t251 * t226 * t374;
  t1642 = t85 * t302;
  t1644 = t35 * t624;
  t1646 = t35 * t628;
  t1648 = 0.32e2 * t1578 - 0.64e2 / 0.3e1 * t1580 - 0.6e1 * t1583 + 0.4e1 * t1586 + 0.1556e4 / 0.9e1 * params->beta * t271 * t63 * t840 + 0.4e1 * t1594 - 0.3e2 * t400 * t240 * t65 + 0.3e1 * t401 * t264 + 0.12e2 * t162 * t669 + 0.5e1 * t800 * t540 + 0.4e1 * t61 * t121 * t44 * t1619 - 0.2e1 * t422 * t1132 + 0.16e3 / 0.3e1 * t268 / t18 / t269 / t221 * t1119 - 0.96e2 * t325 * t347 - 0.176e4 / 0.9e1 * t685 * t665 + 0.128e3 / 0.3e1 * t272 * t1637 - 0.24e2 * t826 * t123 - 0.64e2 / 0.3e1 * t1642 + 0.8e1 * t1644 + 0.4e1 * t1646;
  t1651 = t54 * t92 * t1619;
  t1652 = t35 * t619;
  t1655 = t54 * t200 * t795;
  t1658 = t54 * t1013 * t374;
  t1661 = t54 * t205 * t1544;
  t1664 = t54 * t452 * t391;
  t1678 = t127 * t812 * t120;
  t1699 = -t1651 - 0.12e2 * t1652 + 0.16e2 / 0.3e1 * t1655 + 0.176e3 / 0.9e1 * t1658 + 0.4e1 * t1661 - 0.88e2 / 0.9e1 * t1664 - 0.176e3 / 0.9e1 * t195 * t396 + 0.32e2 / 0.3e1 * t85 * t845 - 0.2e1 * t35 * t63 * t644 + 0.48e2 * t724 * t337 * t391 * t206 - 0.16e2 * t1678 * t1158 - 0.64e2 * t127 * t355 * t250 * t1413 + 0.128e3 / 0.3e1 * t1408 * t1404 + 0.2704e4 / 0.9e1 * t1381 * t343 - 0.72e2 * t870 * t703 - 0.36e2 * t870 * t707 - 0.384e3 * t1396 * t849 + 0.192e3 * t697 * t853 - 0.496e3 / 0.3e1 * t1186 * t857;
  t1723 = t258 * t102 * t795;
  t1729 = t161 * t723;
  t1744 = t338 * t315;
  t1749 = t258 * t856 * t106;
  t1753 = t258 * t342 * t315;
  t1759 = t258 * t866 * t106;
  t1762 = 0.48e2 * t724 * t337 * t374 * t230 - 0.24e2 * t336 * t337 * t157 * t644 + 0.4e1 * t351 * t1429 + 0.96e2 * t697 * t863 + 0.496e3 / 0.9e1 * t518 * t867 - 0.24e2 * t336 * t337 * t795 * t106 - 0.12e2 * t336 * t337 * t391 * t230 - 0.32e2 / 0.3e1 * t257 * t1723 + 0.288e3 * t161 * t696 * t339 + 0.144e3 * t1729 * t726 - 0.24e3 * t1389 * t337 * t374 * t206 - 0.224e3 / 0.3e1 * t716 * t711 + 0.48e2 * t1385 * t1443 - 0.12e2 * t720 * t1437 + 0.224e3 * t1364 * t733 + 0.192e3 * t724 * t337 * t1744 - 0.128e3 * t1168 * t1749 + 0.64e2 * t534 * t1753 - 0.24e2 * t720 * t1449 + 0.32e2 * t534 * t1759;
  t1792 = -0.2e1 / 0.9e1 * t53 * t26 * (t1577 + t1648 + t1699 + t1762) - 0.32e2 / 0.27e2 * t91 * t1655 + 0.2e1 / 0.9e1 * t91 * t1651 + 0.352e3 / 0.81e2 * t27 * t148 * t606 + 0.128e3 / 0.27e2 * t91 * t1642 - 0.16e2 / 0.9e1 * t91 * t1644 - 0.8e1 / 0.9e1 * t91 * t1646 - 0.64e2 / 0.27e2 * t27 * t148 * t614 + 0.4e1 / 0.9e1 * t27 * t148 * t645 - 0.16e2 / 0.3e1 * t91 * t1562 + 0.16e2 / 0.3e1 * t1467 * t1468 * t1744;
  t1817 = 0.4e1 / 0.3e1 * t91 * t1566 - 0.8e1 / 0.9e1 * t91 * t1661 - 0.8e1 / 0.9e1 * t91 * t1586 + 0.176e3 / 0.81e2 * t91 * t1664 + 0.64e2 / 0.27e2 * t91 * t1572 - 0.8e1 / 0.9e1 * t91 * t1594 - 0.4e1 / 0.9e1 * t91 * t1575 + 0.8e1 / 0.3e1 * t91 * t1652 - 0.352e3 / 0.81e2 * t91 * t1658 - 0.64e2 / 0.9e1 * t91 * t1578 + 0.128e3 / 0.27e2 * t91 * t1580 + 0.4e1 / 0.3e1 * t91 * t1583;
  t1823 = my_piecewise3(t2, 0, t6 * t186 * t428 / 0.12e2 - t6 * t78 * t885 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1792 + t1817));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1823 + 0.4e1 * t890;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1832 = t35 * t766;
  t1835 = t35 * t770;
  t1841 = t35 * t779;
  t1848 = t54 * t1022 * t899;
  t1853 = t99 * t522 * t899 * t106;
  t1857 = t99 * t765 * t315;
  t1860 = t610 * t904;
  t1863 = t949 * t106;
  t1868 = t99 * t623 * t391;
  t1872 = t99 * t301 * t795;
  t1876 = t54 * t200 * t922;
  t1881 = t99 * t120 * t922 * t106;
  t1897 = -t910 * t96 / 0.2e1 + t914 * t103 / 0.2e1 + t384 * t788 / 0.3e1 - 0.14e2 * t36 * t791 + 0.1e2 * t36 * t812 * t1077 * sigma[0] * t30;
  t1899 = t54 * t92 * t1897;
  t1909 = t934 * t120;
  t1936 = -0.3e1 * t957 * t115 * t65 - 0.16e2 * t1860 + 0.6e1 * t1868 + 0.6e1 * t1872 + 0.2e1 * t1881 - 0.7e1 * t1909 * t839 * t106 + 0.24e2 * t1853 - 0.18e2 * t1857 + 0.9e1 * t401 * t347 - 0.92e2 * t1536 * t343 - 0.2e2 * t127 / t18 / t1072 * t1119 + 0.15e2 * t800 * t711 + 0.88e2 * t1539 * t839 * t157 * sigma[0] - 0.6e1 * t422 * t1321 + 0.4e1 * t61 * t121 * t44 * t1897;
  t1968 = -0.18e2 * t99 * t618 * t862 - 0.48e2 * t356 * t1637 + 0.16e2 * t356 * t1528 - 0.3e1 / 0.2e1 * t958 * t123 + 0.3e1 * t963 * t130 * t133 + 0.18e2 * t162 * t806 + 0.3e2 * t28 * t812 * t571 + 0.216e3 * t325 * t412 - 0.192e3 * t116 * t946 - 0.16e2 * t116 * t974 - 0.36e2 * t826 * t166 - 0.72e2 * t325 * t418 - t1899 + 0.8e1 / 0.3e1 * t1876 - 0.3e2 * t837 * t273 + 0.16e2 * t1848;
  t1995 = t28 * t928 * t120;
  t2004 = -0.45e2 * t406 * t251 * t132 * t338 + 0.18e2 * t28 * t421 * t250 * t1413 - 0.3e1 * t35 * t63 * t795 + 0.3e1 * t1995 * t1158 + 0.168e3 * t1364 * t857 - 0.24e2 * t1678 * t1404 + 0.216e3 * t1729 * t849 - 0.56e2 * t716 * t867 - 0.16e2 * t85 * t937 + 0.8e1 * t85 * t940 - 0.108e3 * t870 * t853 - 0.54e2 * t870 * t863 - 0.18e2 * t1832 + 0.12e2 * t1835 + 0.6e1 * t1841;
  t2014 = t258 * t102 * t899;
  t2032 = t258 * t102 * t922;
  t2040 = t963 * t350;
  t2047 = t258 * t342 * t391;
  t2056 = -0.24e3 * t1389 * t337 * t899 * t106 + 0.144e3 * t724 * t337 * t374 * t315 - 0.64e2 * t1168 * t2014 - 0.36e2 * t336 * t337 * t315 * t391 - 0.36e2 * t336 * t337 * t157 * t795 + 0.144e3 * t697 * t950 - 0.12e2 * t336 * t337 * t922 * t106 - 0.16e2 / 0.3e1 * t257 * t2032 + 0.6e1 * t351 * t1723 - 0.27e2 * t400 * t335 * t339 + 0.3e1 / 0.2e1 * t2040 * t260 + 0.144e3 * t724 * t337 * t1863 + 0.48e2 * t534 * t2047 + 0.72e2 * t1385 * t1749 - 0.36e2 * t720 * t1753 - 0.18e2 * t720 * t1759;
  t2062 = 0.32e2 / 0.9e1 * t27 * t148 * t761 + 0.4e1 * t91 * t1832 - 0.8e1 / 0.3e1 * t91 * t1835 - 0.16e2 / 0.9e1 * t27 * t148 * t774 - 0.4e1 / 0.3e1 * t91 * t1841 + 0.2e1 / 0.3e1 * t27 * t148 * t796 - 0.32e2 / 0.9e1 * t91 * t1848 - 0.16e2 / 0.3e1 * t91 * t1853 + 0.4e1 * t91 * t1857 + 0.32e2 / 0.9e1 * t91 * t1860 + 0.4e1 * t1467 * t1468 * t1863 - 0.4e1 / 0.3e1 * t91 * t1868 - 0.4e1 / 0.3e1 * t91 * t1872 - 0.16e2 / 0.27e2 * t91 * t1876 - 0.4e1 / 0.9e1 * t91 * t1881 + 0.2e1 / 0.9e1 * t91 * t1899 - 0.2e1 / 0.9e1 * t53 * t26 * (t1936 + t1968 + t2004 + t2056);
  t2067 = my_piecewise3(t2, 0, -t6 * t78 * t981 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t2062);
  tv4rhosigma30 = 0.2e1 * rho[0] * t2067 + 0.2e1 * t985;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t2073 = t35 * t904;
  t2079 = t374 * t374;
  t2081 = t54 * t1034 * t2079;
  t2085 = t99 * t765 * t391;
  t2088 = t391 * t391;
  t2090 = t54 * t205 * t2088;
  t2094 = t99 * t301 * t922;
  t2116 = -0.15e2 / 0.16e2 * t36 / t37 / t267 * t45 + 0.15e2 / 0.16e2 * t36 / t267 * t154 + 0.5e1 / 0.8e1 * t914 * t388 + 0.3e1 / 0.4e1 * t36 * t383 * t421 * t497 - 0.15e2 / 0.4e1 * t36 * t928 * t1077 * t30;
  t2118 = t54 * t92 * t2116;
  t2170 = 0.18e2 * t401 * t418 + 0.24e2 * t162 * t974 + 0.4e1 * t61 * t121 * t44 * t2116 + 0.15e2 / 0.2e1 * t28 / t18 / t566 * t1119 - 0.9e2 * t1555 * t857 + 0.36e2 * t422 * t1637 - 0.12e2 * t422 * t1528 - 0.6e1 * t958 * t166 + 0.9e1 / 0.8e1 * params->beta * t913 * t170 * t133 + 0.3e2 * t800 * t867 - 0.54e2 * t401 * t412 + 0.288e3 * t162 * t946 - 0.24e3 * t61 * t1140 * t44 * t2079 - 0.36e2 * t61 * t251 * t44 * t2088 - 0.27e2 / 0.4e1 * params->beta * t928 * t63 * t1156 * t30 - 0.9e1 / 0.8e1 * params->beta * t909 * t60 * t65 - 0.36e2 * t2085;
  t2207 = 0.8e1 * t2094 - 0.28e2 * t1909 * t839 * t157 + 0.3e1 / 0.4e1 * t963 * t421 * t273 - t2118 + 0.24e2 * t2081 + 0.24e2 * t2073 + 0.6e1 * t2090 - 0.24e2 * t35 * t250 * t899 - 0.4e1 * t35 * t63 * t922 + 0.8e1 * t351 * t2032 + 0.6e1 * t2040 * t343 + 0.12e2 * t1995 * t1404 - 0.216e3 * t870 * t950 + 0.288e3 * t724 * t337 * t374 * t391 + 0.96e2 * t1385 * t2014 - 0.48e2 * t336 * t337 * t157 * t922 - 0.72e2 * t720 * t2047;
  t2216 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (0.16e2 / 0.3e1 * t27 * t148 * t900 - 0.16e2 / 0.3e1 * t91 * t2073 + 0.8e1 / 0.9e1 * t27 * t148 * t923 - 0.16e2 / 0.3e1 * t91 * t2081 + 0.8e1 * t91 * t2085 - 0.4e1 / 0.3e1 * t91 * t2090 - 0.16e2 / 0.9e1 * t91 * t2094 + 0.2e1 / 0.9e1 * t91 * t2118 - 0.2e1 / 0.9e1 * t53 * t26 * (t2170 + t2207)));
  tv4sigma40 = 0.2e1 * rho[0] * t2216;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t41;
  double t42, t43, t45, t46, t47, t50, t51, t52;
  double t56, t57, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t73, t77, t78, t79, t81;
  double t82, t83, t84, t86, t87, t88, t89, t90;
  double t91, t93, t94, t96, t97, t98, t101, t102;
  double t103, t107, t109, t110, t111, t112, t113, t114;
  double t115, t116, t117, t123, t127, tzk0;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->c1 * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = params->beta * sigma[0];
  t37 = rho[0] * rho[0];
  t38 = POW_1_3(rho[0]);
  t39 = t38 * t38;
  t41 = 0.1e1 / t39 / t37;
  t42 = params->gamma * params->beta;
  t43 = sqrt(sigma[0]);
  t45 = 0.1e1 / t38 / rho[0];
  t46 = t43 * t45;
  t47 = log(t46 + sqrt(t46 * t46 + 0.1e1));
  t50 = t42 * t46 * t47 + 0.1e1;
  t51 = 0.1e1 / t50;
  t52 = t41 * t51;
  t56 = params->c2 * t28;
  t57 = sigma[0] * t41;
  t59 = t43 * sigma[0];
  t60 = params->beta * t59;
  t61 = t37 * t37;
  t62 = 0.1e1 / t61;
  t63 = t60 * t62;
  t64 = t50 * t50;
  t65 = 0.1e1 / t64;
  t66 = t65 * params->gamma;
  t67 = t66 * t47;
  t73 = params->c0 - 0.2e1 / 0.9e1 * t35 * t36 * t52 - 0.2e1 / 0.9e1 * t56 * t34 * (t57 * t51 - t63 * t67);
  t77 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = -t16;
  t81 = my_piecewise5(t14, t11, t10, t15, t79 * t7);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = params->beta * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = sqrt(sigma[2]);
  t96 = 0.1e1 / t90 / rho[1];
  t97 = t94 * t96;
  t98 = log(t97 + sqrt(t97 * t97 + 0.1e1));
  t101 = t42 * t97 * t98 + 0.1e1;
  t102 = 0.1e1 / t101;
  t103 = t93 * t102;
  t107 = sigma[2] * t93;
  t109 = t94 * sigma[2];
  t110 = params->beta * t109;
  t111 = t89 * t89;
  t112 = 0.1e1 / t111;
  t113 = t110 * t112;
  t114 = t101 * t101;
  t115 = 0.1e1 / t114;
  t116 = t115 * params->gamma;
  t117 = t116 * t98;
  t123 = params->c0 - 0.2e1 / 0.9e1 * t35 * t88 * t103 - 0.2e1 / 0.9e1 * t56 * t34 * (t107 * t102 - t113 * t117);
  t127 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t123);
  tzk0 = t77 + t127;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t41;
  double t42, t43, t45, t46, t47, t50, t51, t52;
  double t56, t57, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t73, t77, t78, t79, t81;
  double t82, t83, t84, t86, t87, t88, t89, t90;
  double t91, t93, t94, t96, t97, t98, t101, t102;
  double t103, t107, t109, t110, t111, t112, t113, t114;
  double t115, t116, t117, t123, t127, tzk0;

  double t128, t129, t130, t132, t135, t136, t140, t141;
  double t142, t145, t146, t148, t149, t153, t155, t159;
  double t160, t161, t162, t166, t167, t173, t175, t176;
  double t177, t181, t182, t184, t187, t188, t189, t191;
  double t192, t193, t200, t205, t206, t208, t211, t212;
  double t216, t219, t221, tvrho0, t225, t228, t229, t234;
  double t236, t239, t240, t244, t246, t247, t251, t253;
  double t257, t258, t259, t260, t264, t265, t271, t273;
  double t274, t275, t279, t280, t282, t285, t286, t287;
  double t289, t290, t291, t298, t303, tvrho1, t306, t307;
  double t310, t317, t318, t321, t323, t324, t328, t332;
  double t333, t340, t344, tvsigma0, tvsigma1, t347, t354, t355;
  double t358, t360, t361, t365, t369, t370, t377, t381;
  double tvsigma2;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->c1 * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = params->beta * sigma[0];
  t37 = rho[0] * rho[0];
  t38 = POW_1_3(rho[0]);
  t39 = t38 * t38;
  t41 = 0.1e1 / t39 / t37;
  t42 = params->gamma * params->beta;
  t43 = sqrt(sigma[0]);
  t45 = 0.1e1 / t38 / rho[0];
  t46 = t43 * t45;
  t47 = log(t46 + sqrt(t46 * t46 + 0.1e1));
  t50 = t42 * t46 * t47 + 0.1e1;
  t51 = 0.1e1 / t50;
  t52 = t41 * t51;
  t56 = params->c2 * t28;
  t57 = sigma[0] * t41;
  t59 = t43 * sigma[0];
  t60 = params->beta * t59;
  t61 = t37 * t37;
  t62 = 0.1e1 / t61;
  t63 = t60 * t62;
  t64 = t50 * t50;
  t65 = 0.1e1 / t64;
  t66 = t65 * params->gamma;
  t67 = t66 * t47;
  t73 = params->c0 - 0.2e1 / 0.9e1 * t35 * t36 * t52 - 0.2e1 / 0.9e1 * t56 * t34 * (t57 * t51 - t63 * t67);
  t77 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = -t16;
  t81 = my_piecewise5(t14, t11, t10, t15, t79 * t7);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = params->beta * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = sqrt(sigma[2]);
  t96 = 0.1e1 / t90 / rho[1];
  t97 = t94 * t96;
  t98 = log(t97 + sqrt(t97 * t97 + 0.1e1));
  t101 = t42 * t97 * t98 + 0.1e1;
  t102 = 0.1e1 / t101;
  t103 = t93 * t102;
  t107 = sigma[2] * t93;
  t109 = t94 * sigma[2];
  t110 = params->beta * t109;
  t111 = t89 * t89;
  t112 = 0.1e1 / t111;
  t113 = t110 * t112;
  t114 = t101 * t101;
  t115 = 0.1e1 / t114;
  t116 = t115 * params->gamma;
  t117 = t116 * t98;
  t123 = params->c0 - 0.2e1 / 0.9e1 * t35 * t88 * t103 - 0.2e1 / 0.9e1 * t56 * t34 * (t107 * t102 - t113 * t117);
  t127 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t123);
  tzk0 = t77 + t127;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t128 = t6 * t6;
  t129 = 0.1e1 / t128;
  t130 = t16 * t129;
  t132 = my_piecewise5(t10, 0, t14, 0, t7 - t130);
  t135 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t132);
  t136 = t135 * t26;
  t140 = t26 * t26;
  t141 = 0.1e1 / t140;
  t142 = t25 * t141;
  t145 = t5 * t142 * t73 / 0.8e1;
  t146 = t37 * rho[0];
  t148 = 0.1e1 / t39 / t146;
  t149 = t148 * t51;
  t153 = t41 * t65;
  t155 = 0.1e1 / t38 / t37;
  t159 = sigma[0] * t148;
  t160 = t57 + 0.1e1;
  t161 = sqrt(t160);
  t162 = 0.1e1 / t161;
  t166 = -0.4e1 / 0.3e1 * t42 * t43 * t155 * t47 - 0.4e1 / 0.3e1 * t42 * t159 * t162;
  t167 = t153 * t166;
  t173 = t65 * t166;
  t175 = t61 * rho[0];
  t176 = 0.1e1 / t175;
  t177 = t60 * t176;
  t181 = 0.1e1 / t64 / t50;
  t182 = t181 * params->gamma;
  t184 = t182 * t47 * t166;
  t187 = sigma[0] * sigma[0];
  t188 = params->beta * t187;
  t189 = t61 * t37;
  t191 = 0.1e1 / t38 / t189;
  t192 = t188 * t191;
  t193 = t66 * t162;
  t200 = 0.16e2 / 0.27e2 * t35 * t36 * t149 + 0.2e1 / 0.9e1 * t35 * t36 * t167 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.8e1 / 0.3e1 * t159 * t51 - t57 * t173 + 0.4e1 * t177 * t67 + 0.2e1 * t63 * t184 + 0.4e1 / 0.3e1 * t192 * t193);
  t205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t73 - t145 - 0.3e1 / 0.8e1 * t5 * t27 * t200);
  t206 = t79 * t129;
  t208 = my_piecewise5(t14, 0, t10, 0, -t7 - t206);
  t211 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t208);
  t212 = t211 * t26;
  t216 = t86 * t141;
  t219 = t5 * t216 * t123 / 0.8e1;
  t221 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t123 - t219);
  tvrho0 = t77 + t127 + t6 * (t205 + t221);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t225 = my_piecewise5(t10, 0, t14, 0, -t7 - t130);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t225);
  t229 = t228 * t26;
  t234 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t73 - t145);
  t236 = my_piecewise5(t14, 0, t10, 0, t7 - t206);
  t239 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t236);
  t240 = t239 * t26;
  t244 = t89 * rho[1];
  t246 = 0.1e1 / t91 / t244;
  t247 = t246 * t102;
  t251 = t93 * t115;
  t253 = 0.1e1 / t90 / t89;
  t257 = sigma[2] * t246;
  t258 = t107 + 0.1e1;
  t259 = sqrt(t258);
  t260 = 0.1e1 / t259;
  t264 = -0.4e1 / 0.3e1 * t42 * t94 * t253 * t98 - 0.4e1 / 0.3e1 * t42 * t257 * t260;
  t265 = t251 * t264;
  t271 = t115 * t264;
  t273 = t111 * rho[1];
  t274 = 0.1e1 / t273;
  t275 = t110 * t274;
  t279 = 0.1e1 / t114 / t101;
  t280 = t279 * params->gamma;
  t282 = t280 * t98 * t264;
  t285 = sigma[2] * sigma[2];
  t286 = params->beta * t285;
  t287 = t111 * t89;
  t289 = 0.1e1 / t90 / t287;
  t290 = t286 * t289;
  t291 = t116 * t260;
  t298 = 0.16e2 / 0.27e2 * t35 * t88 * t247 + 0.2e1 / 0.9e1 * t35 * t88 * t265 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.8e1 / 0.3e1 * t257 * t102 - t107 * t271 + 0.4e1 * t275 * t117 + 0.2e1 * t113 * t282 + 0.4e1 / 0.3e1 * t290 * t291);
  t303 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t123 - t219 - 0.3e1 / 0.8e1 * t5 * t87 * t298);
  tvrho1 = t77 + t127 + t6 * (t234 + t303);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t306 = t29 * t32;
  t307 = t33 * params->beta;
  t310 = 0.1e1 / t43;
  t317 = t42 * t310 * t45 * t47 / 0.2e1 + t42 * t41 * t162 / 0.2e1;
  t318 = t153 * t317;
  t321 = t65 * t317;
  t323 = params->beta * t43;
  t324 = t323 * t62;
  t328 = t182 * t47 * t317;
  t332 = 0.1e1 / t38 / t175;
  t333 = t36 * t332;
  t340 = -0.2e1 / 0.9e1 * t306 * t307 * t52 + 0.2e1 / 0.9e1 * t35 * t36 * t318 - 0.2e1 / 0.9e1 * t56 * t34 * (t52 - t57 * t321 - 0.3e1 / 0.2e1 * t324 * t67 + 0.2e1 * t63 * t328 - t333 * t193 / 0.2e1);
  t344 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t340);
  tvsigma0 = t6 * t344;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t347 = 0.1e1 / t94;
  t354 = t42 * t347 * t96 * t98 / 0.2e1 + t42 * t93 * t260 / 0.2e1;
  t355 = t251 * t354;
  t358 = t115 * t354;
  t360 = params->beta * t94;
  t361 = t360 * t112;
  t365 = t280 * t98 * t354;
  t369 = 0.1e1 / t90 / t273;
  t370 = t88 * t369;
  t377 = -0.2e1 / 0.9e1 * t306 * t307 * t103 + 0.2e1 / 0.9e1 * t35 * t88 * t355 - 0.2e1 / 0.9e1 * t56 * t34 * (t103 - t107 * t358 - 0.3e1 / 0.2e1 * t361 * t117 + 0.2e1 * t113 * t365 - t370 * t291 / 0.2e1);
  t381 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t377);
  tvsigma2 = t6 * t381;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t41;
  double t42, t43, t45, t46, t47, t50, t51, t52;
  double t56, t57, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t73, t77, t78, t79, t81;
  double t82, t83, t84, t86, t87, t88, t89, t90;
  double t91, t93, t94, t96, t97, t98, t101, t102;
  double t103, t107, t109, t110, t111, t112, t113, t114;
  double t115, t116, t117, t123, t127, tzk0;

  double t128, t129, t130, t132, t135, t136, t140, t141;
  double t142, t145, t146, t148, t149, t153, t155, t159;
  double t160, t161, t162, t166, t167, t173, t175, t176;
  double t177, t181, t182, t184, t187, t188, t189, t191;
  double t192, t193, t200, t205, t206, t208, t211, t212;
  double t216, t219, t221, tvrho0, t225, t228, t229, t234;
  double t236, t239, t240, t244, t246, t247, t251, t253;
  double t257, t258, t259, t260, t264, t265, t271, t273;
  double t274, t275, t279, t280, t282, t285, t286, t287;
  double t289, t290, t291, t298, t303, tvrho1, t306, t307;
  double t310, t317, t318, t321, t323, t324, t328, t332;
  double t333, t340, t344, tvsigma0, tvsigma1, t347, t354, t355;
  double t358, t360, t361, t365, t369, t370, t377, t381;
  double tvsigma2;

  double t384, t385, t386, t389, t390, t391, t394, t398;
  double t399, t403, t405, t411, t412, t415, t417, t420;
  double t421, t425, t426, t430, t431, t432, t437, t442;
  double t446, t448, t451, t455, t456, t464, t467, t469;
  double t470, t475, t478, t479, t480, t482, t486, t490;
  double t493, t494, t495, t496, t497, t498, t499, t502;
  double t506, t511, t512, t513, t514, t517, t520, t524;
  double t525, t529, t531, t533, t536, t538, tv2rho20, t541;
  double t545, t549, t550, t554, t556, t564, t565, t569;
  double t573, t574, t578, t580, t587, t590, tv2rho21, t595;
  double t600, t604, t605, t611, t612, t617, t621, t622;
  double t632, t633, t637, t638, t642, t643, t644, t649;
  double t654, t658, t660, t663, t667, t668, t676, t679;
  double t681, t682, t687, t690, t691, t692, t694, t698;
  double t702, t705, t706, t707, t708, t709, t710, t711;
  double t714, t718, t723, tv2rho22, t731, t735, t739, t744;
  double t745, t746, t747, t757, t761, t762, t770, t772;
  double t777, t782, t783, t784, t785, t786, t790, t794;
  double t798, t799, t800, t803, t807, t812, tv2rhosigma0, tv2rhosigma1;
  double t819, t821, tv2rhosigma2, t827, tv2rhosigma3, tv2rhosigma4, t835, t839;
  double t843, t844, t845, t855, t859, t860, t868, t870;
  double t875, t880, t881, t882, t883, t884, t888, t892;
  double t896, t897, t898, t901, t905, t910, tv2rhosigma5, t915;
  double t916, t920, t924, t931, t932, t937, t940, t942;
  double t943, t948, t952, t958, t961, t962, t969, t973;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t977, t978, t982;
  double t986, t993, t994, t999, t1002, t1004, t1005, t1010;
  double t1014, t1020, t1023, t1024, t1031, t1035, tv2sigma25;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->c1 * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = params->beta * sigma[0];
  t37 = rho[0] * rho[0];
  t38 = POW_1_3(rho[0]);
  t39 = t38 * t38;
  t41 = 0.1e1 / t39 / t37;
  t42 = params->gamma * params->beta;
  t43 = sqrt(sigma[0]);
  t45 = 0.1e1 / t38 / rho[0];
  t46 = t43 * t45;
  t47 = log(t46 + sqrt(t46 * t46 + 0.1e1));
  t50 = t42 * t46 * t47 + 0.1e1;
  t51 = 0.1e1 / t50;
  t52 = t41 * t51;
  t56 = params->c2 * t28;
  t57 = sigma[0] * t41;
  t59 = t43 * sigma[0];
  t60 = params->beta * t59;
  t61 = t37 * t37;
  t62 = 0.1e1 / t61;
  t63 = t60 * t62;
  t64 = t50 * t50;
  t65 = 0.1e1 / t64;
  t66 = t65 * params->gamma;
  t67 = t66 * t47;
  t73 = params->c0 - 0.2e1 / 0.9e1 * t35 * t36 * t52 - 0.2e1 / 0.9e1 * t56 * t34 * (t57 * t51 - t63 * t67);
  t77 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = -t16;
  t81 = my_piecewise5(t14, t11, t10, t15, t79 * t7);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = params->beta * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = sqrt(sigma[2]);
  t96 = 0.1e1 / t90 / rho[1];
  t97 = t94 * t96;
  t98 = log(t97 + sqrt(t97 * t97 + 0.1e1));
  t101 = t42 * t97 * t98 + 0.1e1;
  t102 = 0.1e1 / t101;
  t103 = t93 * t102;
  t107 = sigma[2] * t93;
  t109 = t94 * sigma[2];
  t110 = params->beta * t109;
  t111 = t89 * t89;
  t112 = 0.1e1 / t111;
  t113 = t110 * t112;
  t114 = t101 * t101;
  t115 = 0.1e1 / t114;
  t116 = t115 * params->gamma;
  t117 = t116 * t98;
  t123 = params->c0 - 0.2e1 / 0.9e1 * t35 * t88 * t103 - 0.2e1 / 0.9e1 * t56 * t34 * (t107 * t102 - t113 * t117);
  t127 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t123);
  tzk0 = t77 + t127;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t128 = t6 * t6;
  t129 = 0.1e1 / t128;
  t130 = t16 * t129;
  t132 = my_piecewise5(t10, 0, t14, 0, t7 - t130);
  t135 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t132);
  t136 = t135 * t26;
  t140 = t26 * t26;
  t141 = 0.1e1 / t140;
  t142 = t25 * t141;
  t145 = t5 * t142 * t73 / 0.8e1;
  t146 = t37 * rho[0];
  t148 = 0.1e1 / t39 / t146;
  t149 = t148 * t51;
  t153 = t41 * t65;
  t155 = 0.1e1 / t38 / t37;
  t159 = sigma[0] * t148;
  t160 = t57 + 0.1e1;
  t161 = sqrt(t160);
  t162 = 0.1e1 / t161;
  t166 = -0.4e1 / 0.3e1 * t42 * t43 * t155 * t47 - 0.4e1 / 0.3e1 * t42 * t159 * t162;
  t167 = t153 * t166;
  t173 = t65 * t166;
  t175 = t61 * rho[0];
  t176 = 0.1e1 / t175;
  t177 = t60 * t176;
  t181 = 0.1e1 / t64 / t50;
  t182 = t181 * params->gamma;
  t184 = t182 * t47 * t166;
  t187 = sigma[0] * sigma[0];
  t188 = params->beta * t187;
  t189 = t61 * t37;
  t191 = 0.1e1 / t38 / t189;
  t192 = t188 * t191;
  t193 = t66 * t162;
  t200 = 0.16e2 / 0.27e2 * t35 * t36 * t149 + 0.2e1 / 0.9e1 * t35 * t36 * t167 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.8e1 / 0.3e1 * t159 * t51 - t57 * t173 + 0.4e1 * t177 * t67 + 0.2e1 * t63 * t184 + 0.4e1 / 0.3e1 * t192 * t193);
  t205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t73 - t145 - 0.3e1 / 0.8e1 * t5 * t27 * t200);
  t206 = t79 * t129;
  t208 = my_piecewise5(t14, 0, t10, 0, -t7 - t206);
  t211 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t208);
  t212 = t211 * t26;
  t216 = t86 * t141;
  t219 = t5 * t216 * t123 / 0.8e1;
  t221 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t123 - t219);
  tvrho0 = t77 + t127 + t6 * (t205 + t221);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t225 = my_piecewise5(t10, 0, t14, 0, -t7 - t130);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t225);
  t229 = t228 * t26;
  t234 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t73 - t145);
  t236 = my_piecewise5(t14, 0, t10, 0, t7 - t206);
  t239 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t236);
  t240 = t239 * t26;
  t244 = t89 * rho[1];
  t246 = 0.1e1 / t91 / t244;
  t247 = t246 * t102;
  t251 = t93 * t115;
  t253 = 0.1e1 / t90 / t89;
  t257 = sigma[2] * t246;
  t258 = t107 + 0.1e1;
  t259 = sqrt(t258);
  t260 = 0.1e1 / t259;
  t264 = -0.4e1 / 0.3e1 * t42 * t94 * t253 * t98 - 0.4e1 / 0.3e1 * t42 * t257 * t260;
  t265 = t251 * t264;
  t271 = t115 * t264;
  t273 = t111 * rho[1];
  t274 = 0.1e1 / t273;
  t275 = t110 * t274;
  t279 = 0.1e1 / t114 / t101;
  t280 = t279 * params->gamma;
  t282 = t280 * t98 * t264;
  t285 = sigma[2] * sigma[2];
  t286 = params->beta * t285;
  t287 = t111 * t89;
  t289 = 0.1e1 / t90 / t287;
  t290 = t286 * t289;
  t291 = t116 * t260;
  t298 = 0.16e2 / 0.27e2 * t35 * t88 * t247 + 0.2e1 / 0.9e1 * t35 * t88 * t265 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.8e1 / 0.3e1 * t257 * t102 - t107 * t271 + 0.4e1 * t275 * t117 + 0.2e1 * t113 * t282 + 0.4e1 / 0.3e1 * t290 * t291);
  t303 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t123 - t219 - 0.3e1 / 0.8e1 * t5 * t87 * t298);
  tvrho1 = t77 + t127 + t6 * (t234 + t303);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t306 = t29 * t32;
  t307 = t33 * params->beta;
  t310 = 0.1e1 / t43;
  t317 = t42 * t310 * t45 * t47 / 0.2e1 + t42 * t41 * t162 / 0.2e1;
  t318 = t153 * t317;
  t321 = t65 * t317;
  t323 = params->beta * t43;
  t324 = t323 * t62;
  t328 = t182 * t47 * t317;
  t332 = 0.1e1 / t38 / t175;
  t333 = t36 * t332;
  t340 = -0.2e1 / 0.9e1 * t306 * t307 * t52 + 0.2e1 / 0.9e1 * t35 * t36 * t318 - 0.2e1 / 0.9e1 * t56 * t34 * (t52 - t57 * t321 - 0.3e1 / 0.2e1 * t324 * t67 + 0.2e1 * t63 * t328 - t333 * t193 / 0.2e1);
  t344 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t340);
  tvsigma0 = t6 * t344;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t347 = 0.1e1 / t94;
  t354 = t42 * t347 * t96 * t98 / 0.2e1 + t42 * t93 * t260 / 0.2e1;
  t355 = t251 * t354;
  t358 = t115 * t354;
  t360 = params->beta * t94;
  t361 = t360 * t112;
  t365 = t280 * t98 * t354;
  t369 = 0.1e1 / t90 / t273;
  t370 = t88 * t369;
  t377 = -0.2e1 / 0.9e1 * t306 * t307 * t103 + 0.2e1 / 0.9e1 * t35 * t88 * t355 - 0.2e1 / 0.9e1 * t56 * t34 * (t103 - t107 * t358 - 0.3e1 / 0.2e1 * t361 * t117 + 0.2e1 * t113 * t365 - t370 * t291 / 0.2e1);
  t381 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t377);
  tvsigma2 = t6 * t381;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t384 = t23 * t23;
  t385 = 0.1e1 / t384;
  t386 = t132 * t132;
  t389 = t128 * t6;
  t390 = 0.1e1 / t389;
  t391 = t16 * t390;
  t394 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t129 + 0.2e1 * t391);
  t398 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t385 * t386 + 0.4e1 / 0.3e1 * t23 * t394);
  t399 = t398 * t26;
  t403 = t135 * t141;
  t405 = t5 * t403 * t73;
  t411 = 0.1e1 / t140 / t6;
  t412 = t25 * t411;
  t415 = t5 * t412 * t73 / 0.12e2;
  t417 = t5 * t142 * t200;
  t420 = 0.1e1 / t39 / t61;
  t421 = t420 * t51;
  t425 = t148 * t65;
  t426 = t425 * t166;
  t430 = t41 * t181;
  t431 = t166 * t166;
  t432 = t430 * t431;
  t437 = 0.1e1 / t38 / t146;
  t442 = sigma[0] * t420;
  t446 = t61 * t146;
  t448 = 0.1e1 / t38 / t446;
  t451 = 0.1e1 / t161 / t160;
  t455 = 0.28e2 / 0.9e1 * t42 * t43 * t437 * t47 + 0.2e2 / 0.3e1 * t42 * t442 * t162 - 0.16e2 / 0.9e1 * t42 * t187 * t448 * t451;
  t456 = t153 * t455;
  t464 = t181 * t431;
  t467 = t65 * t455;
  t469 = 0.1e1 / t189;
  t470 = t60 * t469;
  t475 = t188 * t448;
  t478 = t64 * t64;
  t479 = 0.1e1 / t478;
  t480 = t479 * params->gamma;
  t482 = t480 * t47 * t431;
  t486 = t182 * t162 * t166;
  t490 = t182 * t47 * t455;
  t493 = t187 * sigma[0];
  t494 = params->beta * t493;
  t495 = t61 * t61;
  t496 = t495 * t37;
  t497 = 0.1e1 / t496;
  t498 = t494 * t497;
  t499 = t66 * t451;
  t502 = 0.88e2 / 0.9e1 * t442 * t51 + 0.16e2 / 0.3e1 * t159 * t173 + 0.2e1 * t57 * t464 - t57 * t467 - 0.2e2 * t470 * t67 - 0.16e2 * t177 * t184 - 0.124e3 / 0.9e1 * t475 * t193 - 0.6e1 * t63 * t482 - 0.16e2 / 0.3e1 * t192 * t486 + 0.2e1 * t63 * t490 + 0.16e2 / 0.9e1 * t498 * t499;
  t506 = -0.176e3 / 0.81e2 * t35 * t36 * t421 - 0.32e2 / 0.27e2 * t35 * t36 * t426 - 0.4e1 / 0.9e1 * t35 * t36 * t432 + 0.2e1 / 0.9e1 * t35 * t36 * t456 - 0.2e1 / 0.9e1 * t56 * t34 * t502;
  t511 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t399 * t73 - t405 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t136 * t200 + t415 - t417 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t506);
  t512 = t84 * t84;
  t513 = 0.1e1 / t512;
  t514 = t208 * t208;
  t517 = t79 * t390;
  t520 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t129 + 0.2e1 * t517);
  t524 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t513 * t514 + 0.4e1 / 0.3e1 * t84 * t520);
  t525 = t524 * t26;
  t529 = t211 * t141;
  t531 = t5 * t529 * t123;
  t533 = t86 * t411;
  t536 = t5 * t533 * t123 / 0.12e2;
  t538 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t525 * t123 - t531 / 0.4e1 + t536);
  tv2rho20 = 0.2e1 * t205 + 0.2e1 * t221 + t6 * (t511 + t538);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t541 = t385 * t225;
  t545 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t391);
  t549 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t541 * t132 + 0.4e1 / 0.3e1 * t23 * t545);
  t550 = t549 * t26;
  t554 = t228 * t141;
  t556 = t5 * t554 * t73;
  t564 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t550 * t73 - t556 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t200 - t405 / 0.8e1 + t415 - t417 / 0.8e1);
  t565 = t513 * t236;
  t569 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t517);
  t573 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t565 * t208 + 0.4e1 / 0.3e1 * t84 * t569);
  t574 = t573 * t26;
  t578 = t239 * t141;
  t580 = t5 * t578 * t123;
  t587 = t5 * t216 * t298;
  t590 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t574 * t123 - t580 / 0.8e1 - t531 / 0.8e1 + t536 - 0.3e1 / 0.8e1 * t5 * t212 * t298 - t587 / 0.8e1);
  tv2rho21 = t205 + t221 + t234 + t303 + t6 * (t564 + t590);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t595 = t225 * t225;
  t600 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t129 + 0.2e1 * t391);
  t604 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t385 * t595 + 0.4e1 / 0.3e1 * t23 * t600);
  t605 = t604 * t26;
  t611 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t73 - t556 / 0.4e1 + t415);
  t612 = t236 * t236;
  t617 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t129 + 0.2e1 * t517);
  t621 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t513 * t612 + 0.4e1 / 0.3e1 * t84 * t617);
  t622 = t621 * t26;
  t632 = 0.1e1 / t91 / t111;
  t633 = t632 * t102;
  t637 = t246 * t115;
  t638 = t637 * t264;
  t642 = t93 * t279;
  t643 = t264 * t264;
  t644 = t642 * t643;
  t649 = 0.1e1 / t90 / t244;
  t654 = sigma[2] * t632;
  t658 = t111 * t244;
  t660 = 0.1e1 / t90 / t658;
  t663 = 0.1e1 / t259 / t258;
  t667 = 0.28e2 / 0.9e1 * t42 * t94 * t649 * t98 + 0.2e2 / 0.3e1 * t42 * t654 * t260 - 0.16e2 / 0.9e1 * t42 * t285 * t660 * t663;
  t668 = t251 * t667;
  t676 = t279 * t643;
  t679 = t115 * t667;
  t681 = 0.1e1 / t287;
  t682 = t110 * t681;
  t687 = t286 * t660;
  t690 = t114 * t114;
  t691 = 0.1e1 / t690;
  t692 = t691 * params->gamma;
  t694 = t692 * t98 * t643;
  t698 = t280 * t260 * t264;
  t702 = t280 * t98 * t667;
  t705 = t285 * sigma[2];
  t706 = params->beta * t705;
  t707 = t111 * t111;
  t708 = t707 * t89;
  t709 = 0.1e1 / t708;
  t710 = t706 * t709;
  t711 = t116 * t663;
  t714 = 0.88e2 / 0.9e1 * t654 * t102 + 0.16e2 / 0.3e1 * t257 * t271 + 0.2e1 * t107 * t676 - t107 * t679 - 0.2e2 * t682 * t117 - 0.16e2 * t275 * t282 - 0.124e3 / 0.9e1 * t687 * t291 - 0.6e1 * t113 * t694 - 0.16e2 / 0.3e1 * t290 * t698 + 0.2e1 * t113 * t702 + 0.16e2 / 0.9e1 * t710 * t711;
  t718 = -0.176e3 / 0.81e2 * t35 * t88 * t633 - 0.32e2 / 0.27e2 * t35 * t88 * t638 - 0.4e1 / 0.9e1 * t35 * t88 * t644 + 0.2e1 / 0.9e1 * t35 * t88 * t668 - 0.2e1 / 0.9e1 * t56 * t34 * t714;
  t723 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t622 * t123 - t580 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t298 + t536 - t587 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t718);
  tv2rho22 = 0.2e1 * t234 + 0.2e1 * t303 + t6 * (t611 + t723);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t731 = t5 * t142 * t340 / 0.8e1;
  t735 = params->beta * t41;
  t739 = t425 * t317;
  t744 = t29 * t34 * params->beta;
  t745 = t181 * t317;
  t746 = t745 * t166;
  t747 = t57 * t746;
  t757 = t191 * t451;
  t761 = -0.2e1 / 0.3e1 * t42 * t310 * t155 * t47 - 0.2e1 * t42 * t148 * t162 + 0.2e1 / 0.3e1 * t42 * t757 * sigma[0];
  t762 = t153 * t761;
  t770 = t65 * t761;
  t772 = t323 * t176;
  t777 = t36 * t191;
  t782 = t62 * t479;
  t783 = t60 * t782;
  t784 = params->gamma * t47;
  t785 = t317 * t166;
  t786 = t784 * t785;
  t790 = t182 * t162 * t317;
  t794 = t182 * t47 * t761;
  t798 = t495 * rho[0];
  t799 = 0.1e1 / t798;
  t800 = t188 * t799;
  t803 = -0.8e1 / 0.3e1 * t149 - t167 + 0.8e1 / 0.3e1 * t159 * t321 + 0.2e1 * t747 - t57 * t770 + 0.6e1 * t772 * t67 + 0.3e1 * t324 * t184 + 0.14e2 / 0.3e1 * t777 * t193 - 0.8e1 * t177 * t328 - 0.6e1 * t783 * t786 - 0.8e1 / 0.3e1 * t192 * t790 + 0.2e1 * t63 * t794 + t333 * t486 - 0.2e1 / 0.3e1 * t800 * t499;
  t807 = 0.16e2 / 0.27e2 * t306 * t307 * t149 + 0.2e1 / 0.9e1 * t35 * t735 * t173 - 0.16e2 / 0.27e2 * t35 * t36 * t739 - 0.4e1 / 0.9e1 * t744 * t747 + 0.2e1 / 0.9e1 * t35 * t36 * t762 - 0.2e1 / 0.9e1 * t56 * t34 * t803;
  t812 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t340 - t731 - 0.3e1 / 0.8e1 * t5 * t27 * t807);
  tv2rhosigma0 = t6 * t812 + t344;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t819 = t5 * t216 * t377 / 0.8e1;
  t821 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t377 - t819);
  tv2rhosigma2 = t6 * t821 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t827 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t340 - t731);
  tv2rhosigma3 = t6 * t827 + t344;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t835 = params->beta * t93;
  t839 = t637 * t354;
  t843 = t279 * t354;
  t844 = t843 * t264;
  t845 = t107 * t844;
  t855 = t289 * t663;
  t859 = -0.2e1 / 0.3e1 * t42 * t347 * t253 * t98 - 0.2e1 * t42 * t246 * t260 + 0.2e1 / 0.3e1 * t42 * t855 * sigma[2];
  t860 = t251 * t859;
  t868 = t115 * t859;
  t870 = t360 * t274;
  t875 = t88 * t289;
  t880 = t112 * t691;
  t881 = t110 * t880;
  t882 = params->gamma * t98;
  t883 = t354 * t264;
  t884 = t882 * t883;
  t888 = t280 * t260 * t354;
  t892 = t280 * t98 * t859;
  t896 = t707 * rho[1];
  t897 = 0.1e1 / t896;
  t898 = t286 * t897;
  t901 = -0.8e1 / 0.3e1 * t247 - t265 + 0.8e1 / 0.3e1 * t257 * t358 + 0.2e1 * t845 - t107 * t868 + 0.6e1 * t870 * t117 + 0.3e1 * t361 * t282 + 0.14e2 / 0.3e1 * t875 * t291 - 0.8e1 * t275 * t365 - 0.6e1 * t881 * t884 - 0.8e1 / 0.3e1 * t290 * t888 + 0.2e1 * t113 * t892 + t370 * t698 - 0.2e1 / 0.3e1 * t898 * t711;
  t905 = 0.16e2 / 0.27e2 * t306 * t307 * t247 + 0.2e1 / 0.9e1 * t35 * t835 * t271 - 0.16e2 / 0.27e2 * t35 * t88 * t839 - 0.4e1 / 0.9e1 * t744 * t845 + 0.2e1 / 0.9e1 * t35 * t88 * t860 - 0.2e1 / 0.9e1 * t56 * t34 * t901;
  t910 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t377 - t819 - 0.3e1 / 0.8e1 * t5 * t87 * t905);
  tv2rhosigma5 = t6 * t910 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t915 = t317 * t317;
  t916 = t430 * t915;
  t920 = 0.1e1 / t59;
  t924 = 0.1e1 / sigma[0];
  t931 = t42 * t924 * t41 * t162 / 0.4e1 - t42 * t920 * t45 * t47 / 0.4e1 - t42 * t332 * t451 / 0.4e1;
  t932 = t153 * t931;
  t937 = t181 * t915;
  t940 = t65 * t931;
  t942 = params->beta * t310;
  t943 = t942 * t62;
  t948 = params->beta * t332;
  t952 = t480 * t47 * t915;
  t958 = t182 * t47 * t931;
  t961 = 0.1e1 / t495;
  t962 = t36 * t961;
  t969 = 0.4e1 / 0.9e1 * t35 * t735 * t321 - 0.4e1 / 0.9e1 * t35 * t36 * t916 + 0.2e1 / 0.9e1 * t35 * t36 * t932 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.2e1 * t318 + 0.2e1 * t57 * t937 - t57 * t940 - 0.3e1 / 0.4e1 * t943 * t67 + 0.6e1 * t324 * t328 - 0.5e1 / 0.4e1 * t948 * t193 - 0.6e1 * t63 * t952 + 0.2e1 * t333 * t790 + 0.2e1 * t63 * t958 + t962 * t499 / 0.4e1);
  t973 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t969);
  tv2sigma20 = t6 * t973;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t977 = t354 * t354;
  t978 = t642 * t977;
  t982 = 0.1e1 / t109;
  t986 = 0.1e1 / sigma[2];
  t993 = t42 * t986 * t93 * t260 / 0.4e1 - t42 * t982 * t96 * t98 / 0.4e1 - t42 * t369 * t663 / 0.4e1;
  t994 = t251 * t993;
  t999 = t279 * t977;
  t1002 = t115 * t993;
  t1004 = params->beta * t347;
  t1005 = t1004 * t112;
  t1010 = params->beta * t369;
  t1014 = t692 * t98 * t977;
  t1020 = t280 * t98 * t993;
  t1023 = 0.1e1 / t707;
  t1024 = t88 * t1023;
  t1031 = 0.4e1 / 0.9e1 * t35 * t835 * t358 - 0.4e1 / 0.9e1 * t35 * t88 * t978 + 0.2e1 / 0.9e1 * t35 * t88 * t994 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.2e1 * t355 + 0.2e1 * t107 * t999 - t107 * t1002 - 0.3e1 / 0.4e1 * t1005 * t117 + 0.6e1 * t361 * t365 - 0.5e1 / 0.4e1 * t1010 * t291 - 0.6e1 * t113 * t1014 + 0.2e1 * t370 * t888 + 0.2e1 * t113 * t1020 + t1024 * t711 / 0.4e1);
  t1035 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t1031);
  tv2sigma25 = t6 * t1035;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t41;
  double t42, t43, t45, t46, t47, t50, t51, t52;
  double t56, t57, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t73, t77, t78, t79, t81;
  double t82, t83, t84, t86, t87, t88, t89, t90;
  double t91, t93, t94, t96, t97, t98, t101, t102;
  double t103, t107, t109, t110, t111, t112, t113, t114;
  double t115, t116, t117, t123, t127, tzk0;

  double t128, t129, t130, t132, t135, t136, t140, t141;
  double t142, t145, t146, t148, t149, t153, t155, t159;
  double t160, t161, t162, t166, t167, t173, t175, t176;
  double t177, t181, t182, t184, t187, t188, t189, t191;
  double t192, t193, t200, t205, t206, t208, t211, t212;
  double t216, t219, t221, tvrho0, t225, t228, t229, t234;
  double t236, t239, t240, t244, t246, t247, t251, t253;
  double t257, t258, t259, t260, t264, t265, t271, t273;
  double t274, t275, t279, t280, t282, t285, t286, t287;
  double t289, t290, t291, t298, t303, tvrho1, t306, t307;
  double t310, t317, t318, t321, t323, t324, t328, t332;
  double t333, t340, t344, tvsigma0, tvsigma1, t347, t354, t355;
  double t358, t360, t361, t365, t369, t370, t377, t381;
  double tvsigma2;

  double t384, t385, t386, t389, t390, t391, t394, t398;
  double t399, t403, t405, t411, t412, t415, t417, t420;
  double t421, t425, t426, t430, t431, t432, t437, t442;
  double t446, t448, t451, t455, t456, t464, t467, t469;
  double t470, t475, t478, t479, t480, t482, t486, t490;
  double t493, t494, t495, t496, t497, t498, t499, t502;
  double t506, t511, t512, t513, t514, t517, t520, t524;
  double t525, t529, t531, t533, t536, t538, tv2rho20, t541;
  double t545, t549, t550, t554, t556, t564, t565, t569;
  double t573, t574, t578, t580, t587, t590, tv2rho21, t595;
  double t600, t604, t605, t611, t612, t617, t621, t622;
  double t632, t633, t637, t638, t642, t643, t644, t649;
  double t654, t658, t660, t663, t667, t668, t676, t679;
  double t681, t682, t687, t690, t691, t692, t694, t698;
  double t702, t705, t706, t707, t708, t709, t710, t711;
  double t714, t718, t723, tv2rho22, t731, t735, t739, t744;
  double t745, t746, t747, t757, t761, t762, t770, t772;
  double t777, t782, t783, t784, t785, t786, t790, t794;
  double t798, t799, t800, t803, t807, t812, tv2rhosigma0, tv2rhosigma1;
  double t819, t821, tv2rhosigma2, t827, tv2rhosigma3, tv2rhosigma4, t835, t839;
  double t843, t844, t845, t855, t859, t860, t868, t870;
  double t875, t880, t881, t882, t883, t884, t888, t892;
  double t896, t897, t898, t901, t905, t910, tv2rhosigma5, t915;
  double t916, t920, t924, t931, t932, t937, t940, t942;
  double t943, t948, t952, t958, t961, t962, t969, t973;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t977, t978, t982;
  double t986, t993, t994, t999, t1002, t1004, t1005, t1010;
  double t1014, t1020, t1023, t1024, t1031, t1035, tv2sigma25;

  double t1039, t1040, t1043, t1046, t1047, t1048, t1051, t1055;
  double t1056, t1060, t1062, t1067, t1069, t1072, t1078, t1079;
  double t1082, t1084, t1087, t1090, t1091, t1095, t1096, t1100;
  double t1101, t1105, t1109, t1110, t1111, t1115, t1116, t1117;
  double t1121, t1126, t1131, t1136, t1137, t1139, t1141, t1145;
  double t1146, t1150, t1153, t1156, t1157, t1158, t1160, t1161;
  double t1162, t1167, t1177, t1183, t1184, t1186, t1189, t1190;
  double t1193, t1194, t1204, t1208, t1212, t1216, t1219, t1224;
  double t1229, t1231, t1232, t1235, t1238, t1241, t1245, t1246;
  double t1250, t1252, t1254, t1256, t1258, t1261, t1263, tv3rho30;
  double t1266, t1267, t1268, t1271, t1276, t1277, t1279, t1283;
  double t1284, t1288, t1291, t1295, t1297, t1301, t1310, t1311;
  double t1312, t1315, t1320, t1322, t1326, t1327, t1331, t1334;
  double t1335, t1337, t1346, t1348, t1351, tv3rho31, t1354, t1359;
  double t1363, t1367, t1368, t1372, t1374, t1383, t1384, t1389;
  double t1393, t1397, t1398, t1402, t1404, t1411, t1419, t1421;
  double t1422, tv3rho32, t1427, t1434, t1438, t1439, t1446, t1447;
  double t1454, t1458, t1459, t1475, t1476, t1480, t1481, t1485;
  double t1486, t1490, t1494, t1495, t1496, t1500, t1501, t1502;
  double t1506, t1511, t1516, t1521, t1522, t1524, t1526, t1530;
  double t1531, t1538, t1539, t1541, t1544, t1545, t1548, t1551;
  double t1554, t1555, t1556, t1558, t1559, t1560, t1565, t1576;
  double t1578, t1579, t1589, t1593, t1597, t1601, t1604, t1609;
  double t1614, tv3rho33, t1622, t1629, t1631, t1636, t1646, t1650;
  double t1653, t1658, t1659, t1662, t1663, t1664, t1667, t1668;
  double t1678, t1682, t1686, t1687, t1695, t1698, t1701, t1704;
  double t1706, t1707, t1711, t1712, t1715, t1716, t1719, t1720;
  double t1723, t1724, t1725, t1726, t1729, t1730, t1731, t1732;
  double t1739, t1753, t1757, t1761, t1773, t1775, t1780, t1785;
  double tv3rho2sigma0, tv3rho2sigma1, t1792, t1796, t1798, tv3rho2sigma2, t1804, t1812;
  double tv3rho2sigma3, tv3rho2sigma4, t1818, t1825, t1828, tv3rho2sigma5, t1836, tv3rho2sigma6;
  double tv3rho2sigma7, t1850, t1860, t1864, t1867, t1872, t1873, t1876;
  double t1877, t1878, t1881, t1882, t1892, t1896, t1900, t1901;
  double t1905, t1908, t1911, t1914, t1916, t1917, t1925, t1926;
  double t1929, t1930, t1931, t1932, t1935, t1936, t1939, t1940;
  double t1941, t1942, t1945, t1946, t1953, t1961, t1965, t1969;
  double t1987, t1989, t1994, t1999, tv3rho2sigma8, t2006, t2016, t2020;
  double t2021, t2022, t2025, t2026, t2029, t2033, t2034, t2035;
  double t2048, t2051, t2052, t2057, t2068, t2070, t2072, t2073;
  double t2077, t2078, t2080, t2083, t2084, t2087, t2090, t2091;
  double t2094, t2095, t2098, t2100, t2103, t2104, t2108, t2112;
  double t2130, t2139, t2144, t2149, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t2156, t2158, tv3rhosigma25, t2164, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t2178, t2182, t2183, t2184, t2187, t2188;
  double t2191, t2195, t2196, t2197, t2210, t2213, t2214, t2221;
  double t2226, t2232, t2234, t2235, t2239, t2240, t2242, t2245;
  double t2246, t2249, t2250, t2253, t2254, t2258, t2261, t2262;
  double t2263, t2266, t2272, t2286, t2290, t2301, t2306, t2311;
  double tv3rhosigma211, t2319, t2320, t2324, t2325, t2329, t2334, t2346;
  double t2347, t2351, t2352, t2355, t2358, t2362, t2366, t2367;
  double t2370, t2371, t2382, t2389, t2392, t2393, t2399, t2402;
  double t2406, t2410, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, t2417, t2418, t2422, t2423, t2427;
  double t2432, t2444, t2445, t2449, t2450, t2453, t2456, t2460;
  double t2464, t2465, t2468, t2469, t2480, t2485, t2488, t2489;
  double t2498, t2500, t2504, t2508, tv3sigma39;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->c1 * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = params->beta * sigma[0];
  t37 = rho[0] * rho[0];
  t38 = POW_1_3(rho[0]);
  t39 = t38 * t38;
  t41 = 0.1e1 / t39 / t37;
  t42 = params->gamma * params->beta;
  t43 = sqrt(sigma[0]);
  t45 = 0.1e1 / t38 / rho[0];
  t46 = t43 * t45;
  t47 = log(t46 + sqrt(t46 * t46 + 0.1e1));
  t50 = t42 * t46 * t47 + 0.1e1;
  t51 = 0.1e1 / t50;
  t52 = t41 * t51;
  t56 = params->c2 * t28;
  t57 = sigma[0] * t41;
  t59 = t43 * sigma[0];
  t60 = params->beta * t59;
  t61 = t37 * t37;
  t62 = 0.1e1 / t61;
  t63 = t60 * t62;
  t64 = t50 * t50;
  t65 = 0.1e1 / t64;
  t66 = t65 * params->gamma;
  t67 = t66 * t47;
  t73 = params->c0 - 0.2e1 / 0.9e1 * t35 * t36 * t52 - 0.2e1 / 0.9e1 * t56 * t34 * (t57 * t51 - t63 * t67);
  t77 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = -t16;
  t81 = my_piecewise5(t14, t11, t10, t15, t79 * t7);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = params->beta * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = sqrt(sigma[2]);
  t96 = 0.1e1 / t90 / rho[1];
  t97 = t94 * t96;
  t98 = log(t97 + sqrt(t97 * t97 + 0.1e1));
  t101 = t42 * t97 * t98 + 0.1e1;
  t102 = 0.1e1 / t101;
  t103 = t93 * t102;
  t107 = sigma[2] * t93;
  t109 = t94 * sigma[2];
  t110 = params->beta * t109;
  t111 = t89 * t89;
  t112 = 0.1e1 / t111;
  t113 = t110 * t112;
  t114 = t101 * t101;
  t115 = 0.1e1 / t114;
  t116 = t115 * params->gamma;
  t117 = t116 * t98;
  t123 = params->c0 - 0.2e1 / 0.9e1 * t35 * t88 * t103 - 0.2e1 / 0.9e1 * t56 * t34 * (t107 * t102 - t113 * t117);
  t127 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t123);
  tzk0 = t77 + t127;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t128 = t6 * t6;
  t129 = 0.1e1 / t128;
  t130 = t16 * t129;
  t132 = my_piecewise5(t10, 0, t14, 0, t7 - t130);
  t135 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t132);
  t136 = t135 * t26;
  t140 = t26 * t26;
  t141 = 0.1e1 / t140;
  t142 = t25 * t141;
  t145 = t5 * t142 * t73 / 0.8e1;
  t146 = t37 * rho[0];
  t148 = 0.1e1 / t39 / t146;
  t149 = t148 * t51;
  t153 = t41 * t65;
  t155 = 0.1e1 / t38 / t37;
  t159 = sigma[0] * t148;
  t160 = t57 + 0.1e1;
  t161 = sqrt(t160);
  t162 = 0.1e1 / t161;
  t166 = -0.4e1 / 0.3e1 * t42 * t43 * t155 * t47 - 0.4e1 / 0.3e1 * t42 * t159 * t162;
  t167 = t153 * t166;
  t173 = t65 * t166;
  t175 = t61 * rho[0];
  t176 = 0.1e1 / t175;
  t177 = t60 * t176;
  t181 = 0.1e1 / t64 / t50;
  t182 = t181 * params->gamma;
  t184 = t182 * t47 * t166;
  t187 = sigma[0] * sigma[0];
  t188 = params->beta * t187;
  t189 = t61 * t37;
  t191 = 0.1e1 / t38 / t189;
  t192 = t188 * t191;
  t193 = t66 * t162;
  t200 = 0.16e2 / 0.27e2 * t35 * t36 * t149 + 0.2e1 / 0.9e1 * t35 * t36 * t167 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.8e1 / 0.3e1 * t159 * t51 - t57 * t173 + 0.4e1 * t177 * t67 + 0.2e1 * t63 * t184 + 0.4e1 / 0.3e1 * t192 * t193);
  t205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t73 - t145 - 0.3e1 / 0.8e1 * t5 * t27 * t200);
  t206 = t79 * t129;
  t208 = my_piecewise5(t14, 0, t10, 0, -t7 - t206);
  t211 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t208);
  t212 = t211 * t26;
  t216 = t86 * t141;
  t219 = t5 * t216 * t123 / 0.8e1;
  t221 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t123 - t219);
  tvrho0 = t77 + t127 + t6 * (t205 + t221);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t225 = my_piecewise5(t10, 0, t14, 0, -t7 - t130);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t225);
  t229 = t228 * t26;
  t234 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t73 - t145);
  t236 = my_piecewise5(t14, 0, t10, 0, t7 - t206);
  t239 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t236);
  t240 = t239 * t26;
  t244 = t89 * rho[1];
  t246 = 0.1e1 / t91 / t244;
  t247 = t246 * t102;
  t251 = t93 * t115;
  t253 = 0.1e1 / t90 / t89;
  t257 = sigma[2] * t246;
  t258 = t107 + 0.1e1;
  t259 = sqrt(t258);
  t260 = 0.1e1 / t259;
  t264 = -0.4e1 / 0.3e1 * t42 * t94 * t253 * t98 - 0.4e1 / 0.3e1 * t42 * t257 * t260;
  t265 = t251 * t264;
  t271 = t115 * t264;
  t273 = t111 * rho[1];
  t274 = 0.1e1 / t273;
  t275 = t110 * t274;
  t279 = 0.1e1 / t114 / t101;
  t280 = t279 * params->gamma;
  t282 = t280 * t98 * t264;
  t285 = sigma[2] * sigma[2];
  t286 = params->beta * t285;
  t287 = t111 * t89;
  t289 = 0.1e1 / t90 / t287;
  t290 = t286 * t289;
  t291 = t116 * t260;
  t298 = 0.16e2 / 0.27e2 * t35 * t88 * t247 + 0.2e1 / 0.9e1 * t35 * t88 * t265 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.8e1 / 0.3e1 * t257 * t102 - t107 * t271 + 0.4e1 * t275 * t117 + 0.2e1 * t113 * t282 + 0.4e1 / 0.3e1 * t290 * t291);
  t303 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t123 - t219 - 0.3e1 / 0.8e1 * t5 * t87 * t298);
  tvrho1 = t77 + t127 + t6 * (t234 + t303);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t306 = t29 * t32;
  t307 = t33 * params->beta;
  t310 = 0.1e1 / t43;
  t317 = t42 * t310 * t45 * t47 / 0.2e1 + t42 * t41 * t162 / 0.2e1;
  t318 = t153 * t317;
  t321 = t65 * t317;
  t323 = params->beta * t43;
  t324 = t323 * t62;
  t328 = t182 * t47 * t317;
  t332 = 0.1e1 / t38 / t175;
  t333 = t36 * t332;
  t340 = -0.2e1 / 0.9e1 * t306 * t307 * t52 + 0.2e1 / 0.9e1 * t35 * t36 * t318 - 0.2e1 / 0.9e1 * t56 * t34 * (t52 - t57 * t321 - 0.3e1 / 0.2e1 * t324 * t67 + 0.2e1 * t63 * t328 - t333 * t193 / 0.2e1);
  t344 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t340);
  tvsigma0 = t6 * t344;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t347 = 0.1e1 / t94;
  t354 = t42 * t347 * t96 * t98 / 0.2e1 + t42 * t93 * t260 / 0.2e1;
  t355 = t251 * t354;
  t358 = t115 * t354;
  t360 = params->beta * t94;
  t361 = t360 * t112;
  t365 = t280 * t98 * t354;
  t369 = 0.1e1 / t90 / t273;
  t370 = t88 * t369;
  t377 = -0.2e1 / 0.9e1 * t306 * t307 * t103 + 0.2e1 / 0.9e1 * t35 * t88 * t355 - 0.2e1 / 0.9e1 * t56 * t34 * (t103 - t107 * t358 - 0.3e1 / 0.2e1 * t361 * t117 + 0.2e1 * t113 * t365 - t370 * t291 / 0.2e1);
  t381 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t377);
  tvsigma2 = t6 * t381;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t384 = t23 * t23;
  t385 = 0.1e1 / t384;
  t386 = t132 * t132;
  t389 = t128 * t6;
  t390 = 0.1e1 / t389;
  t391 = t16 * t390;
  t394 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t129 + 0.2e1 * t391);
  t398 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t385 * t386 + 0.4e1 / 0.3e1 * t23 * t394);
  t399 = t398 * t26;
  t403 = t135 * t141;
  t405 = t5 * t403 * t73;
  t411 = 0.1e1 / t140 / t6;
  t412 = t25 * t411;
  t415 = t5 * t412 * t73 / 0.12e2;
  t417 = t5 * t142 * t200;
  t420 = 0.1e1 / t39 / t61;
  t421 = t420 * t51;
  t425 = t148 * t65;
  t426 = t425 * t166;
  t430 = t41 * t181;
  t431 = t166 * t166;
  t432 = t430 * t431;
  t437 = 0.1e1 / t38 / t146;
  t442 = sigma[0] * t420;
  t446 = t61 * t146;
  t448 = 0.1e1 / t38 / t446;
  t451 = 0.1e1 / t161 / t160;
  t455 = 0.28e2 / 0.9e1 * t42 * t43 * t437 * t47 + 0.2e2 / 0.3e1 * t42 * t442 * t162 - 0.16e2 / 0.9e1 * t42 * t187 * t448 * t451;
  t456 = t153 * t455;
  t464 = t181 * t431;
  t467 = t65 * t455;
  t469 = 0.1e1 / t189;
  t470 = t60 * t469;
  t475 = t188 * t448;
  t478 = t64 * t64;
  t479 = 0.1e1 / t478;
  t480 = t479 * params->gamma;
  t482 = t480 * t47 * t431;
  t486 = t182 * t162 * t166;
  t490 = t182 * t47 * t455;
  t493 = t187 * sigma[0];
  t494 = params->beta * t493;
  t495 = t61 * t61;
  t496 = t495 * t37;
  t497 = 0.1e1 / t496;
  t498 = t494 * t497;
  t499 = t66 * t451;
  t502 = 0.88e2 / 0.9e1 * t442 * t51 + 0.16e2 / 0.3e1 * t159 * t173 + 0.2e1 * t57 * t464 - t57 * t467 - 0.2e2 * t470 * t67 - 0.16e2 * t177 * t184 - 0.124e3 / 0.9e1 * t475 * t193 - 0.6e1 * t63 * t482 - 0.16e2 / 0.3e1 * t192 * t486 + 0.2e1 * t63 * t490 + 0.16e2 / 0.9e1 * t498 * t499;
  t506 = -0.176e3 / 0.81e2 * t35 * t36 * t421 - 0.32e2 / 0.27e2 * t35 * t36 * t426 - 0.4e1 / 0.9e1 * t35 * t36 * t432 + 0.2e1 / 0.9e1 * t35 * t36 * t456 - 0.2e1 / 0.9e1 * t56 * t34 * t502;
  t511 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t399 * t73 - t405 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t136 * t200 + t415 - t417 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t506);
  t512 = t84 * t84;
  t513 = 0.1e1 / t512;
  t514 = t208 * t208;
  t517 = t79 * t390;
  t520 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t129 + 0.2e1 * t517);
  t524 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t513 * t514 + 0.4e1 / 0.3e1 * t84 * t520);
  t525 = t524 * t26;
  t529 = t211 * t141;
  t531 = t5 * t529 * t123;
  t533 = t86 * t411;
  t536 = t5 * t533 * t123 / 0.12e2;
  t538 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t525 * t123 - t531 / 0.4e1 + t536);
  tv2rho20 = 0.2e1 * t205 + 0.2e1 * t221 + t6 * (t511 + t538);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t541 = t385 * t225;
  t545 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t391);
  t549 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t541 * t132 + 0.4e1 / 0.3e1 * t23 * t545);
  t550 = t549 * t26;
  t554 = t228 * t141;
  t556 = t5 * t554 * t73;
  t564 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t550 * t73 - t556 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t200 - t405 / 0.8e1 + t415 - t417 / 0.8e1);
  t565 = t513 * t236;
  t569 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t517);
  t573 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t565 * t208 + 0.4e1 / 0.3e1 * t84 * t569);
  t574 = t573 * t26;
  t578 = t239 * t141;
  t580 = t5 * t578 * t123;
  t587 = t5 * t216 * t298;
  t590 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t574 * t123 - t580 / 0.8e1 - t531 / 0.8e1 + t536 - 0.3e1 / 0.8e1 * t5 * t212 * t298 - t587 / 0.8e1);
  tv2rho21 = t205 + t221 + t234 + t303 + t6 * (t564 + t590);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t595 = t225 * t225;
  t600 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t129 + 0.2e1 * t391);
  t604 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t385 * t595 + 0.4e1 / 0.3e1 * t23 * t600);
  t605 = t604 * t26;
  t611 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t73 - t556 / 0.4e1 + t415);
  t612 = t236 * t236;
  t617 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t129 + 0.2e1 * t517);
  t621 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t513 * t612 + 0.4e1 / 0.3e1 * t84 * t617);
  t622 = t621 * t26;
  t632 = 0.1e1 / t91 / t111;
  t633 = t632 * t102;
  t637 = t246 * t115;
  t638 = t637 * t264;
  t642 = t93 * t279;
  t643 = t264 * t264;
  t644 = t642 * t643;
  t649 = 0.1e1 / t90 / t244;
  t654 = sigma[2] * t632;
  t658 = t111 * t244;
  t660 = 0.1e1 / t90 / t658;
  t663 = 0.1e1 / t259 / t258;
  t667 = 0.28e2 / 0.9e1 * t42 * t94 * t649 * t98 + 0.2e2 / 0.3e1 * t42 * t654 * t260 - 0.16e2 / 0.9e1 * t42 * t285 * t660 * t663;
  t668 = t251 * t667;
  t676 = t279 * t643;
  t679 = t115 * t667;
  t681 = 0.1e1 / t287;
  t682 = t110 * t681;
  t687 = t286 * t660;
  t690 = t114 * t114;
  t691 = 0.1e1 / t690;
  t692 = t691 * params->gamma;
  t694 = t692 * t98 * t643;
  t698 = t280 * t260 * t264;
  t702 = t280 * t98 * t667;
  t705 = t285 * sigma[2];
  t706 = params->beta * t705;
  t707 = t111 * t111;
  t708 = t707 * t89;
  t709 = 0.1e1 / t708;
  t710 = t706 * t709;
  t711 = t116 * t663;
  t714 = 0.88e2 / 0.9e1 * t654 * t102 + 0.16e2 / 0.3e1 * t257 * t271 + 0.2e1 * t107 * t676 - t107 * t679 - 0.2e2 * t682 * t117 - 0.16e2 * t275 * t282 - 0.124e3 / 0.9e1 * t687 * t291 - 0.6e1 * t113 * t694 - 0.16e2 / 0.3e1 * t290 * t698 + 0.2e1 * t113 * t702 + 0.16e2 / 0.9e1 * t710 * t711;
  t718 = -0.176e3 / 0.81e2 * t35 * t88 * t633 - 0.32e2 / 0.27e2 * t35 * t88 * t638 - 0.4e1 / 0.9e1 * t35 * t88 * t644 + 0.2e1 / 0.9e1 * t35 * t88 * t668 - 0.2e1 / 0.9e1 * t56 * t34 * t714;
  t723 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t622 * t123 - t580 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t298 + t536 - t587 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t718);
  tv2rho22 = 0.2e1 * t234 + 0.2e1 * t303 + t6 * (t611 + t723);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t731 = t5 * t142 * t340 / 0.8e1;
  t735 = params->beta * t41;
  t739 = t425 * t317;
  t744 = t29 * t34 * params->beta;
  t745 = t181 * t317;
  t746 = t745 * t166;
  t747 = t57 * t746;
  t757 = t191 * t451;
  t761 = -0.2e1 / 0.3e1 * t42 * t310 * t155 * t47 - 0.2e1 * t42 * t148 * t162 + 0.2e1 / 0.3e1 * t42 * t757 * sigma[0];
  t762 = t153 * t761;
  t770 = t65 * t761;
  t772 = t323 * t176;
  t777 = t36 * t191;
  t782 = t62 * t479;
  t783 = t60 * t782;
  t784 = params->gamma * t47;
  t785 = t317 * t166;
  t786 = t784 * t785;
  t790 = t182 * t162 * t317;
  t794 = t182 * t47 * t761;
  t798 = t495 * rho[0];
  t799 = 0.1e1 / t798;
  t800 = t188 * t799;
  t803 = -0.8e1 / 0.3e1 * t149 - t167 + 0.8e1 / 0.3e1 * t159 * t321 + 0.2e1 * t747 - t57 * t770 + 0.6e1 * t772 * t67 + 0.3e1 * t324 * t184 + 0.14e2 / 0.3e1 * t777 * t193 - 0.8e1 * t177 * t328 - 0.6e1 * t783 * t786 - 0.8e1 / 0.3e1 * t192 * t790 + 0.2e1 * t63 * t794 + t333 * t486 - 0.2e1 / 0.3e1 * t800 * t499;
  t807 = 0.16e2 / 0.27e2 * t306 * t307 * t149 + 0.2e1 / 0.9e1 * t35 * t735 * t173 - 0.16e2 / 0.27e2 * t35 * t36 * t739 - 0.4e1 / 0.9e1 * t744 * t747 + 0.2e1 / 0.9e1 * t35 * t36 * t762 - 0.2e1 / 0.9e1 * t56 * t34 * t803;
  t812 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t340 - t731 - 0.3e1 / 0.8e1 * t5 * t27 * t807);
  tv2rhosigma0 = t6 * t812 + t344;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t819 = t5 * t216 * t377 / 0.8e1;
  t821 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t377 - t819);
  tv2rhosigma2 = t6 * t821 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t827 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t340 - t731);
  tv2rhosigma3 = t6 * t827 + t344;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t835 = params->beta * t93;
  t839 = t637 * t354;
  t843 = t279 * t354;
  t844 = t843 * t264;
  t845 = t107 * t844;
  t855 = t289 * t663;
  t859 = -0.2e1 / 0.3e1 * t42 * t347 * t253 * t98 - 0.2e1 * t42 * t246 * t260 + 0.2e1 / 0.3e1 * t42 * t855 * sigma[2];
  t860 = t251 * t859;
  t868 = t115 * t859;
  t870 = t360 * t274;
  t875 = t88 * t289;
  t880 = t112 * t691;
  t881 = t110 * t880;
  t882 = params->gamma * t98;
  t883 = t354 * t264;
  t884 = t882 * t883;
  t888 = t280 * t260 * t354;
  t892 = t280 * t98 * t859;
  t896 = t707 * rho[1];
  t897 = 0.1e1 / t896;
  t898 = t286 * t897;
  t901 = -0.8e1 / 0.3e1 * t247 - t265 + 0.8e1 / 0.3e1 * t257 * t358 + 0.2e1 * t845 - t107 * t868 + 0.6e1 * t870 * t117 + 0.3e1 * t361 * t282 + 0.14e2 / 0.3e1 * t875 * t291 - 0.8e1 * t275 * t365 - 0.6e1 * t881 * t884 - 0.8e1 / 0.3e1 * t290 * t888 + 0.2e1 * t113 * t892 + t370 * t698 - 0.2e1 / 0.3e1 * t898 * t711;
  t905 = 0.16e2 / 0.27e2 * t306 * t307 * t247 + 0.2e1 / 0.9e1 * t35 * t835 * t271 - 0.16e2 / 0.27e2 * t35 * t88 * t839 - 0.4e1 / 0.9e1 * t744 * t845 + 0.2e1 / 0.9e1 * t35 * t88 * t860 - 0.2e1 / 0.9e1 * t56 * t34 * t901;
  t910 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t377 - t819 - 0.3e1 / 0.8e1 * t5 * t87 * t905);
  tv2rhosigma5 = t6 * t910 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t915 = t317 * t317;
  t916 = t430 * t915;
  t920 = 0.1e1 / t59;
  t924 = 0.1e1 / sigma[0];
  t931 = t42 * t924 * t41 * t162 / 0.4e1 - t42 * t920 * t45 * t47 / 0.4e1 - t42 * t332 * t451 / 0.4e1;
  t932 = t153 * t931;
  t937 = t181 * t915;
  t940 = t65 * t931;
  t942 = params->beta * t310;
  t943 = t942 * t62;
  t948 = params->beta * t332;
  t952 = t480 * t47 * t915;
  t958 = t182 * t47 * t931;
  t961 = 0.1e1 / t495;
  t962 = t36 * t961;
  t969 = 0.4e1 / 0.9e1 * t35 * t735 * t321 - 0.4e1 / 0.9e1 * t35 * t36 * t916 + 0.2e1 / 0.9e1 * t35 * t36 * t932 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.2e1 * t318 + 0.2e1 * t57 * t937 - t57 * t940 - 0.3e1 / 0.4e1 * t943 * t67 + 0.6e1 * t324 * t328 - 0.5e1 / 0.4e1 * t948 * t193 - 0.6e1 * t63 * t952 + 0.2e1 * t333 * t790 + 0.2e1 * t63 * t958 + t962 * t499 / 0.4e1);
  t973 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t969);
  tv2sigma20 = t6 * t973;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t977 = t354 * t354;
  t978 = t642 * t977;
  t982 = 0.1e1 / t109;
  t986 = 0.1e1 / sigma[2];
  t993 = t42 * t986 * t93 * t260 / 0.4e1 - t42 * t982 * t96 * t98 / 0.4e1 - t42 * t369 * t663 / 0.4e1;
  t994 = t251 * t993;
  t999 = t279 * t977;
  t1002 = t115 * t993;
  t1004 = params->beta * t347;
  t1005 = t1004 * t112;
  t1010 = params->beta * t369;
  t1014 = t692 * t98 * t977;
  t1020 = t280 * t98 * t993;
  t1023 = 0.1e1 / t707;
  t1024 = t88 * t1023;
  t1031 = 0.4e1 / 0.9e1 * t35 * t835 * t358 - 0.4e1 / 0.9e1 * t35 * t88 * t978 + 0.2e1 / 0.9e1 * t35 * t88 * t994 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.2e1 * t355 + 0.2e1 * t107 * t999 - t107 * t1002 - 0.3e1 / 0.4e1 * t1005 * t117 + 0.6e1 * t361 * t365 - 0.5e1 / 0.4e1 * t1010 * t291 - 0.6e1 * t113 * t1014 + 0.2e1 * t370 * t888 + 0.2e1 * t113 * t1020 + t1024 * t711 / 0.4e1);
  t1035 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t1031);
  tv2sigma25 = t6 * t1035;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1039 = 0.1e1 / t384 / t19;
  t1040 = t386 * t132;
  t1043 = t385 * t132;
  t1046 = t128 * t128;
  t1047 = 0.1e1 / t1046;
  t1048 = t16 * t1047;
  t1051 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t390 - 0.6e1 * t1048);
  t1055 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1039 * t1040 + 0.4e1 / 0.3e1 * t1043 * t394 + 0.4e1 / 0.3e1 * t23 * t1051);
  t1056 = t1055 * t26;
  t1060 = t398 * t141;
  t1062 = t5 * t1060 * t73;
  t1067 = t135 * t411;
  t1069 = t5 * t1067 * t73;
  t1072 = t5 * t403 * t200;
  t1078 = 0.1e1 / t140 / t128;
  t1079 = t25 * t1078;
  t1082 = 0.5e1 / 0.36e2 * t5 * t1079 * t73;
  t1084 = t5 * t412 * t200;
  t1087 = t5 * t142 * t506;
  t1090 = 0.1e1 / t39 / t175;
  t1091 = t1090 * t51;
  t1095 = t420 * t65;
  t1096 = t1095 * t166;
  t1100 = t148 * t181;
  t1101 = t1100 * t431;
  t1105 = t425 * t455;
  t1109 = t41 * t479;
  t1110 = t431 * t166;
  t1111 = t1109 * t1110;
  t1115 = t181 * t166;
  t1116 = t1115 * t455;
  t1117 = t57 * t1116;
  t1121 = 0.1e1 / t38 / t61;
  t1126 = sigma[0] * t1090;
  t1131 = 0.1e1 / t38 / t495;
  t1136 = t495 * t146;
  t1137 = 0.1e1 / t1136;
  t1139 = t160 * t160;
  t1141 = 0.1e1 / t161 / t1139;
  t1145 = -0.28e3 / 0.27e2 * t42 * t43 * t1121 * t47 - 0.952e3 / 0.27e2 * t42 * t1126 * t162 + 0.592e3 / 0.27e2 * t42 * t187 * t1131 * t451 - 0.64e2 / 0.9e1 * t42 * t493 * t1137 * t1141;
  t1146 = t153 * t1145;
  t1150 = t188 * t1131;
  t1153 = t494 * t1137;
  t1156 = t187 * t187;
  t1157 = params->beta * t1156;
  t1158 = t495 * t175;
  t1160 = 0.1e1 / t39 / t1158;
  t1161 = t1157 * t1160;
  t1162 = t66 * t1141;
  t1167 = t479 * t1110;
  t1177 = t65 * t1145;
  t1183 = 0.1e1 / t478 / t50;
  t1184 = t1183 * params->gamma;
  t1186 = t1184 * t47 * t1110;
  t1189 = t166 * t455;
  t1190 = t784 * t1189;
  t1193 = 0.1e1 / t446;
  t1194 = t60 * t1193;
  t1204 = t480 * t162 * t431;
  t1208 = t182 * t162 * t455;
  t1212 = t182 * t451 * t166;
  t1216 = t182 * t47 * t1145;
  t1219 = 0.72e2 * t177 * t482 + 0.24e2 * t63 * t1186 - 0.18e2 * t783 * t1190 + 0.12e3 * t1194 * t67 + 0.12e3 * t470 * t184 - 0.24e2 * t177 * t490 + 0.248e3 / 0.3e1 * t475 * t486 + 0.24e2 * t192 * t1204 - 0.8e1 * t192 * t1208 - 0.32e2 / 0.3e1 * t498 * t1212 + 0.2e1 * t63 * t1216;
  t1224 = 0.2464e4 / 0.243e3 * t35 * t36 * t1091 + 0.176e3 / 0.27e2 * t35 * t36 * t1096 + 0.32e2 / 0.9e1 * t35 * t36 * t1101 - 0.16e2 / 0.9e1 * t35 * t36 * t1105 + 0.4e1 / 0.3e1 * t35 * t36 * t1111 - 0.4e1 / 0.3e1 * t744 * t1117 + 0.2e1 / 0.9e1 * t35 * t36 * t1146 - 0.2e1 / 0.9e1 * t56 * t34 * (0.3448e4 / 0.27e2 * t1150 * t193 - 0.976e3 / 0.27e2 * t1153 * t499 + 0.64e2 / 0.9e1 * t1161 * t1162 - 0.16e2 * t159 * t464 - 0.6e1 * t57 * t1167 + 0.6e1 * t1117 - 0.1232e4 / 0.27e2 * t1126 * t51 - 0.88e2 / 0.3e1 * t442 * t173 + 0.8e1 * t159 * t467 - t57 * t1177 + t1219);
  t1229 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1056 * t73 - 0.3e1 / 0.8e1 * t1062 - 0.9e1 / 0.8e1 * t5 * t399 * t200 + t1069 / 0.4e1 - 0.3e1 / 0.4e1 * t1072 - 0.9e1 / 0.8e1 * t5 * t136 * t506 - t1082 + t1084 / 0.4e1 - 0.3e1 / 0.8e1 * t1087 - 0.3e1 / 0.8e1 * t5 * t27 * t1224);
  t1231 = 0.1e1 / t512 / t82;
  t1232 = t514 * t208;
  t1235 = t513 * t208;
  t1238 = t79 * t1047;
  t1241 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t390 - 0.6e1 * t1238);
  t1245 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1231 * t1232 + 0.4e1 / 0.3e1 * t1235 * t520 + 0.4e1 / 0.3e1 * t84 * t1241);
  t1246 = t1245 * t26;
  t1250 = t524 * t141;
  t1252 = t5 * t1250 * t123;
  t1254 = t211 * t411;
  t1256 = t5 * t1254 * t123;
  t1258 = t86 * t1078;
  t1261 = 0.5e1 / 0.36e2 * t5 * t1258 * t123;
  t1263 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t1246 * t123 - 0.3e1 / 0.8e1 * t1252 + t1256 / 0.4e1 - t1261);
  tv3rho30 = 0.3e1 * t511 + 0.3e1 * t538 + t6 * (t1229 + t1263);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1266 = 0.2e1 * t564;
  t1267 = 0.2e1 * t590;
  t1268 = t1039 * t225;
  t1271 = t385 * t545;
  t1276 = 0.2e1 * t390;
  t1277 = 0.6e1 * t1048;
  t1279 = my_piecewise5(t10, 0, t14, 0, t1276 - t1277);
  t1283 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1268 * t386 + 0.8e1 / 0.9e1 * t1271 * t132 + 0.4e1 / 0.9e1 * t541 * t394 + 0.4e1 / 0.3e1 * t23 * t1279);
  t1284 = t1283 * t26;
  t1288 = t549 * t141;
  t1291 = t5 * t1288 * t73 / 0.4e1;
  t1295 = t228 * t411;
  t1297 = t5 * t1295 * t73;
  t1301 = t5 * t554 * t200 / 0.4e1;
  t1310 = -0.3e1 / 0.8e1 * t5 * t1284 * t73 - t1291 - 0.3e1 / 0.4e1 * t5 * t550 * t200 + t1297 / 0.12e2 - t1301 - 0.3e1 / 0.8e1 * t5 * t229 * t506 - t1062 / 0.8e1 + t1069 / 0.6e1 - t1072 / 0.4e1 - t1082 + t1084 / 0.6e1 - t1087 / 0.8e1;
  t1311 = my_piecewise3(t1, 0, t1310);
  t1312 = t1231 * t236;
  t1315 = t513 * t569;
  t1320 = 0.6e1 * t1238;
  t1322 = my_piecewise5(t14, 0, t10, 0, -t1276 - t1320);
  t1326 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1312 * t514 + 0.8e1 / 0.9e1 * t1315 * t208 + 0.4e1 / 0.9e1 * t565 * t520 + 0.4e1 / 0.3e1 * t84 * t1322);
  t1327 = t1326 * t26;
  t1331 = t573 * t141;
  t1334 = t5 * t1331 * t123 / 0.4e1;
  t1335 = t239 * t411;
  t1337 = t5 * t1335 * t123;
  t1346 = t5 * t529 * t298 / 0.4e1;
  t1348 = t5 * t533 * t298;
  t1351 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t1327 * t123 - t1334 + t1337 / 0.12e2 - t1252 / 0.8e1 + t1256 / 0.6e1 - t1261 - 0.3e1 / 0.8e1 * t5 * t525 * t298 - t1346 + t1348 / 0.12e2);
  tv3rho31 = t511 + t538 + t1266 + t1267 + t6 * (t1311 + t1351);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1354 = t1039 * t595;
  t1359 = t385 * t600;
  t1363 = my_piecewise5(t10, 0, t14, 0, -t1276 - t1277);
  t1367 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1354 * t132 + 0.8e1 / 0.9e1 * t541 * t545 + 0.4e1 / 0.9e1 * t1359 * t132 + 0.4e1 / 0.3e1 * t23 * t1363);
  t1368 = t1367 * t26;
  t1372 = t604 * t141;
  t1374 = t5 * t1372 * t73;
  t1383 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1368 * t73 - t1374 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t605 * t200 - t1291 + t1297 / 0.6e1 - t1301 + t1069 / 0.12e2 - t1082 + t1084 / 0.12e2);
  t1384 = t1231 * t612;
  t1389 = t513 * t617;
  t1393 = my_piecewise5(t14, 0, t10, 0, t1276 - t1320);
  t1397 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1384 * t208 + 0.8e1 / 0.9e1 * t565 * t569 + 0.4e1 / 0.9e1 * t1389 * t208 + 0.4e1 / 0.3e1 * t84 * t1393);
  t1398 = t1397 * t26;
  t1402 = t621 * t141;
  t1404 = t5 * t1402 * t123;
  t1411 = t5 * t578 * t298;
  t1419 = t5 * t216 * t718;
  t1421 = -0.3e1 / 0.8e1 * t5 * t1398 * t123 - t1404 / 0.8e1 - t1334 + t1337 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t574 * t298 - t1411 / 0.4e1 + t1256 / 0.12e2 - t1261 - t1346 + t1348 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t212 * t718 - t1419 / 0.8e1;
  t1422 = my_piecewise3(t78, 0, t1421);
  tv3rho32 = t1266 + t1267 + t611 + t723 + t6 * (t1383 + t1422);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1427 = t595 * t225;
  t1434 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t390 - 0.6e1 * t1048);
  t1438 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1039 * t1427 + 0.4e1 / 0.3e1 * t541 * t600 + 0.4e1 / 0.3e1 * t23 * t1434);
  t1439 = t1438 * t26;
  t1446 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1439 * t73 - 0.3e1 / 0.8e1 * t1374 + t1297 / 0.4e1 - t1082);
  t1447 = t612 * t236;
  t1454 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t390 - 0.6e1 * t1238);
  t1458 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1231 * t1447 + 0.4e1 / 0.3e1 * t565 * t617 + 0.4e1 / 0.3e1 * t84 * t1454);
  t1459 = t1458 * t26;
  t1475 = 0.1e1 / t91 / t273;
  t1476 = t1475 * t102;
  t1480 = t632 * t115;
  t1481 = t1480 * t264;
  t1485 = t246 * t279;
  t1486 = t1485 * t643;
  t1490 = t637 * t667;
  t1494 = t93 * t691;
  t1495 = t643 * t264;
  t1496 = t1494 * t1495;
  t1500 = t279 * t264;
  t1501 = t1500 * t667;
  t1502 = t107 * t1501;
  t1506 = 0.1e1 / t90 / t111;
  t1511 = sigma[2] * t1475;
  t1516 = 0.1e1 / t90 / t707;
  t1521 = t707 * t244;
  t1522 = 0.1e1 / t1521;
  t1524 = t258 * t258;
  t1526 = 0.1e1 / t259 / t1524;
  t1530 = -0.28e3 / 0.27e2 * t42 * t94 * t1506 * t98 - 0.952e3 / 0.27e2 * t42 * t1511 * t260 + 0.592e3 / 0.27e2 * t42 * t285 * t1516 * t663 - 0.64e2 / 0.9e1 * t42 * t705 * t1522 * t1526;
  t1531 = t251 * t1530;
  t1538 = 0.1e1 / t690 / t101;
  t1539 = t1538 * params->gamma;
  t1541 = t1539 * t98 * t1495;
  t1544 = t264 * t667;
  t1545 = t882 * t1544;
  t1548 = t286 * t1516;
  t1551 = t706 * t1522;
  t1554 = t285 * t285;
  t1555 = params->beta * t1554;
  t1556 = t707 * t273;
  t1558 = 0.1e1 / t91 / t1556;
  t1559 = t1555 * t1558;
  t1560 = t116 * t1526;
  t1565 = t691 * t1495;
  t1576 = t115 * t1530;
  t1578 = 0.1e1 / t658;
  t1579 = t110 * t1578;
  t1589 = t692 * t260 * t643;
  t1593 = t280 * t260 * t667;
  t1597 = t280 * t663 * t264;
  t1601 = t280 * t98 * t1530;
  t1604 = -0.88e2 / 0.3e1 * t654 * t271 + 0.8e1 * t257 * t679 - t107 * t1576 + 0.12e3 * t1579 * t117 + 0.12e3 * t682 * t282 - 0.24e2 * t275 * t702 + 0.248e3 / 0.3e1 * t687 * t698 + 0.24e2 * t290 * t1589 - 0.8e1 * t290 * t1593 - 0.32e2 / 0.3e1 * t710 * t1597 + 0.2e1 * t113 * t1601;
  t1609 = 0.2464e4 / 0.243e3 * t35 * t88 * t1476 + 0.176e3 / 0.27e2 * t35 * t88 * t1481 + 0.32e2 / 0.9e1 * t35 * t88 * t1486 - 0.16e2 / 0.9e1 * t35 * t88 * t1490 + 0.4e1 / 0.3e1 * t35 * t88 * t1496 - 0.4e1 / 0.3e1 * t744 * t1502 + 0.2e1 / 0.9e1 * t35 * t88 * t1531 - 0.2e1 / 0.9e1 * t56 * t34 * (0.72e2 * t275 * t694 + 0.24e2 * t113 * t1541 - 0.18e2 * t881 * t1545 + 0.3448e4 / 0.27e2 * t1548 * t291 - 0.976e3 / 0.27e2 * t1551 * t711 + 0.64e2 / 0.9e1 * t1559 * t1560 - 0.16e2 * t257 * t676 - 0.6e1 * t107 * t1565 + 0.6e1 * t1502 - 0.1232e4 / 0.27e2 * t1511 * t102 + t1604);
  t1614 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t1459 * t123 - 0.3e1 / 0.8e1 * t1404 - 0.9e1 / 0.8e1 * t5 * t622 * t298 + t1337 / 0.4e1 - 0.3e1 / 0.4e1 * t1411 - 0.9e1 / 0.8e1 * t5 * t240 * t718 - t1261 + t1348 / 0.4e1 - 0.3e1 / 0.8e1 * t1419 - 0.3e1 / 0.8e1 * t5 * t87 * t1609);
  tv3rho33 = 0.3e1 * t611 + 0.3e1 * t723 + t6 * (t1446 + t1614);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1622 = t5 * t403 * t340;
  t1629 = t5 * t412 * t340 / 0.12e2;
  t1631 = t5 * t142 * t807;
  t1636 = params->beta * t148;
  t1646 = t1095 * t317;
  t1650 = t159 * t746;
  t1653 = t425 * t761;
  t1658 = t479 * t317 * t431;
  t1659 = t57 * t1658;
  t1662 = t181 * t761;
  t1663 = t1662 * t166;
  t1664 = t57 * t1663;
  t1667 = t745 * t455;
  t1668 = t57 * t1667;
  t1678 = t448 * t451;
  t1682 = t497 * t1141;
  t1686 = 0.14e2 / 0.9e1 * t42 * t310 * t437 * t47 + 0.74e2 / 0.9e1 * t42 * t420 * t162 - 0.62e2 / 0.9e1 * t42 * t1678 * sigma[0] + 0.8e1 / 0.3e1 * t42 * t1682 * t187;
  t1687 = t153 * t1686;
  t1695 = t323 * t469;
  t1698 = t36 * t448;
  t1701 = t188 * t497;
  t1704 = t495 * t61;
  t1706 = 0.1e1 / t39 / t1704;
  t1707 = t494 * t1706;
  t1711 = t176 * t479;
  t1712 = t60 * t1711;
  t1715 = t761 * t166;
  t1716 = t784 * t1715;
  t1719 = t317 * t455;
  t1720 = t784 * t1719;
  t1723 = t191 * t479;
  t1724 = t188 * t1723;
  t1725 = params->gamma * t162;
  t1726 = t1725 * t785;
  t1729 = t62 * t1183;
  t1730 = t60 * t1729;
  t1731 = t317 * t431;
  t1732 = t784 * t1731;
  t1739 = 0.2e1 * t1668 - 0.6e1 * t1659 - 0.32e2 / 0.3e1 * t1650 + 0.4e1 * t1664 - 0.3e2 * t1695 * t67 - 0.338e3 / 0.9e1 * t1698 * t193 + 0.11e3 / 0.9e1 * t1701 * t499 - 0.8e1 / 0.3e1 * t1707 * t1162 + 0.88e2 / 0.9e1 * t421 + 0.48e2 * t1712 * t786 - 0.12e2 * t783 * t1716 - 0.6e1 * t783 * t1720 + 0.16e2 * t1724 * t1726 + 0.24e2 * t1730 * t1732 - 0.3e1 * t333 * t1204 - 0.9e1 * t324 * t482;
  t1753 = t182 * t162 * t761;
  t1757 = t182 * t451 * t317;
  t1761 = t182 * t47 * t1686;
  t1773 = t65 * t1686;
  t1775 = 0.4e2 * t470 * t328 - 0.24e2 * t772 * t184 + 0.3e1 * t324 * t490 - 0.56e2 / 0.3e1 * t777 * t486 - 0.16e2 * t177 * t794 + 0.248e3 / 0.9e1 * t475 * t790 - 0.16e2 / 0.3e1 * t192 * t1753 - 0.32e2 / 0.9e1 * t498 * t1757 + 0.2e1 * t63 * t1761 + t333 * t1208 + 0.8e1 / 0.3e1 * t800 * t1212 + 0.16e2 / 0.3e1 * t426 - t456 + 0.2e1 * t432 - 0.88e2 / 0.9e1 * t442 * t321 + 0.16e2 / 0.3e1 * t159 * t770 - t57 * t1773;
  t1780 = -0.176e3 / 0.81e2 * t306 * t307 * t421 - 0.32e2 / 0.27e2 * t35 * t1636 * t173 - 0.4e1 / 0.9e1 * t35 * t735 * t464 + 0.2e1 / 0.9e1 * t35 * t735 * t467 + 0.176e3 / 0.81e2 * t35 * t36 * t1646 + 0.64e2 / 0.27e2 * t744 * t1650 - 0.32e2 / 0.27e2 * t35 * t36 * t1653 + 0.4e1 / 0.3e1 * t744 * t1659 - 0.8e1 / 0.9e1 * t744 * t1664 - 0.4e1 / 0.9e1 * t744 * t1668 + 0.2e1 / 0.9e1 * t35 * t36 * t1687 - 0.2e1 / 0.9e1 * t56 * t34 * (t1739 + t1775);
  t1785 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t399 * t340 - t1622 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t136 * t807 + t1629 - t1631 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1780);
  tv3rho2sigma0 = t6 * t1785 + 0.2e1 * t812;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1792 = t5 * t529 * t377;
  t1796 = t5 * t533 * t377 / 0.12e2;
  t1798 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t525 * t377 - t1792 / 0.4e1 + t1796);
  tv3rho2sigma2 = t6 * t1798 + 0.2e1 * t821;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1804 = t5 * t554 * t340;
  t1812 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t550 * t340 - t1804 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t807 - t1622 / 0.8e1 + t1629 - t1631 / 0.8e1);
  tv3rho2sigma3 = t6 * t1812 + t812 + t827;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1818 = t5 * t578 * t377;
  t1825 = t5 * t216 * t905;
  t1828 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t574 * t377 - t1818 / 0.8e1 - t1792 / 0.8e1 + t1796 - 0.3e1 / 0.8e1 * t5 * t212 * t905 - t1825 / 0.8e1);
  tv3rho2sigma5 = t6 * t1828 + t821 + t910;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1836 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t340 - t1804 / 0.4e1 + t1629);
  tv3rho2sigma6 = t6 * t1836 + 0.2e1 * t827;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1850 = params->beta * t246;
  t1860 = t1480 * t354;
  t1864 = t257 * t844;
  t1867 = t637 * t859;
  t1872 = t691 * t354 * t643;
  t1873 = t107 * t1872;
  t1876 = t279 * t859;
  t1877 = t1876 * t264;
  t1878 = t107 * t1877;
  t1881 = t843 * t667;
  t1882 = t107 * t1881;
  t1892 = t660 * t663;
  t1896 = t709 * t1526;
  t1900 = 0.14e2 / 0.9e1 * t42 * t347 * t649 * t98 + 0.74e2 / 0.9e1 * t42 * t632 * t260 - 0.62e2 / 0.9e1 * t42 * t1892 * sigma[2] + 0.8e1 / 0.3e1 * t42 * t1896 * t285;
  t1901 = t251 * t1900;
  t1905 = t360 * t681;
  t1908 = t88 * t660;
  t1911 = t286 * t709;
  t1914 = t707 * t111;
  t1916 = 0.1e1 / t91 / t1914;
  t1917 = t706 * t1916;
  t1925 = t354 * t667;
  t1926 = t882 * t1925;
  t1929 = t289 * t691;
  t1930 = t286 * t1929;
  t1931 = params->gamma * t260;
  t1932 = t1931 * t883;
  t1935 = t274 * t691;
  t1936 = t110 * t1935;
  t1939 = t112 * t1538;
  t1940 = t110 * t1939;
  t1941 = t354 * t643;
  t1942 = t882 * t1941;
  t1945 = t859 * t264;
  t1946 = t882 * t1945;
  t1953 = -0.3e2 * t1905 * t117 - 0.338e3 / 0.9e1 * t1908 * t291 + 0.11e3 / 0.9e1 * t1911 * t711 - 0.8e1 / 0.3e1 * t1917 * t1560 - 0.6e1 * t1873 - 0.32e2 / 0.3e1 * t1864 + 0.4e1 * t1878 + 0.2e1 * t1882 + 0.88e2 / 0.9e1 * t633 - 0.6e1 * t881 * t1926 + 0.16e2 * t1930 * t1932 + 0.48e2 * t1936 * t884 + 0.24e2 * t1940 * t1942 - 0.12e2 * t881 * t1946 - 0.3e1 * t370 * t1589 - 0.9e1 * t361 * t694;
  t1961 = t280 * t260 * t859;
  t1965 = t280 * t663 * t354;
  t1969 = t280 * t98 * t1900;
  t1987 = t115 * t1900;
  t1989 = 0.4e2 * t682 * t365 - 0.16e2 * t275 * t892 + 0.248e3 / 0.9e1 * t687 * t888 - 0.16e2 / 0.3e1 * t290 * t1961 - 0.32e2 / 0.9e1 * t710 * t1965 + 0.2e1 * t113 * t1969 + t370 * t1593 + 0.8e1 / 0.3e1 * t898 * t1597 - 0.24e2 * t870 * t282 + 0.3e1 * t361 * t702 - 0.56e2 / 0.3e1 * t875 * t698 + 0.16e2 / 0.3e1 * t638 - t668 + 0.2e1 * t644 - 0.88e2 / 0.9e1 * t654 * t358 + 0.16e2 / 0.3e1 * t257 * t868 - t107 * t1987;
  t1994 = -0.176e3 / 0.81e2 * t306 * t307 * t633 - 0.32e2 / 0.27e2 * t35 * t1850 * t271 - 0.4e1 / 0.9e1 * t35 * t835 * t676 + 0.2e1 / 0.9e1 * t35 * t835 * t679 + 0.176e3 / 0.81e2 * t35 * t88 * t1860 + 0.64e2 / 0.27e2 * t744 * t1864 - 0.32e2 / 0.27e2 * t35 * t88 * t1867 + 0.4e1 / 0.3e1 * t744 * t1873 - 0.8e1 / 0.9e1 * t744 * t1878 - 0.4e1 / 0.9e1 * t744 * t1882 + 0.2e1 / 0.9e1 * t35 * t88 * t1901 - 0.2e1 / 0.9e1 * t56 * t34 * (t1953 + t1989);
  t1999 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t622 * t377 - t1818 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t905 + t1796 - t1825 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t1994);
  tv3rho2sigma8 = t6 * t1999 + 0.2e1 * t910;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2006 = t5 * t142 * t969 / 0.8e1;
  t2016 = t1100 * t915;
  t2020 = t479 * t915;
  t2021 = t2020 * t166;
  t2022 = t57 * t2021;
  t2025 = t745 * t761;
  t2026 = t57 * t2025;
  t2029 = t425 * t931;
  t2033 = t181 * t931;
  t2034 = t2033 * t166;
  t2035 = t57 * t2034;
  t2048 = t799 * t1141;
  t2051 = t42 * t920 * t155 * t47 / 0.3e1 - t42 * t924 * t148 * t162 / 0.3e1 + 0.5e1 / 0.3e1 * t42 * t757 - t42 * t2048 * sigma[0];
  t2052 = t153 * t2051;
  t2057 = params->beta * t191;
  t2068 = t65 * t2051;
  t2070 = params->beta * t799;
  t2072 = params->gamma * t451;
  t2073 = t2072 * sigma[0];
  t2077 = 0.1e1 / t39 / t1136;
  t2078 = t188 * t2077;
  t2080 = t942 * t176;
  t2083 = t948 * t181;
  t2084 = t1725 * t166;
  t2087 = t323 * t782;
  t2090 = t915 * t166;
  t2091 = t784 * t2090;
  t2094 = t317 * t761;
  t2095 = t784 * t2094;
  t2098 = 0.2e1 * t2035 + 0.23e2 / 0.3e1 * t2057 * t193 - 0.6e1 * t2022 + 0.4e1 * t2026 - 0.16e2 / 0.3e1 * t159 * t937 + 0.8e1 / 0.3e1 * t159 * t940 + 0.4e1 * t430 * t785 - t57 * t2068 - 0.11e2 / 0.3e1 * t2070 * t65 * t2073 + t2078 * t1162 + 0.3e1 * t2080 * t67 + 0.5e1 / 0.2e1 * t2083 * t2084 - 0.18e2 * t2087 * t786 + 0.24e2 * t1730 * t2091 - 0.12e2 * t783 * t2095;
  t2100 = t36 * t332 * t479;
  t2103 = t931 * t166;
  t2104 = t784 * t2103;
  t2108 = t182 * t47 * t2051;
  t2112 = t182 * t162 * t931;
  t2130 = t480 * t162 * t915;
  t2139 = -0.6e1 * t2100 * t1726 - 0.6e1 * t783 * t2104 + 0.2e1 * t63 * t2108 - 0.8e1 / 0.3e1 * t192 * t2112 - t962 * t1212 / 0.2e1 - 0.24e2 * t772 * t328 + 0.24e2 * t177 * t952 - 0.8e1 * t177 * t958 + 0.3e1 / 0.2e1 * t943 * t184 + 0.6e1 * t324 * t794 - 0.56e2 / 0.3e1 * t777 * t790 + 0.8e1 * t192 * t2130 + 0.2e1 * t333 * t1753 + 0.8e1 / 0.3e1 * t800 * t1757 - 0.2e1 * t762 + 0.16e2 / 0.3e1 * t739;
  t2144 = -0.32e2 / 0.27e2 * t35 * t1636 * t321 - 0.8e1 / 0.9e1 * t35 * t735 * t746 + 0.4e1 / 0.9e1 * t35 * t735 * t770 + 0.32e2 / 0.27e2 * t35 * t36 * t2016 + 0.4e1 / 0.3e1 * t744 * t2022 - 0.8e1 / 0.9e1 * t744 * t2026 - 0.16e2 / 0.27e2 * t35 * t36 * t2029 - 0.4e1 / 0.9e1 * t744 * t2035 + 0.2e1 / 0.9e1 * t35 * t36 * t2052 - 0.2e1 / 0.9e1 * t56 * t34 * (t2098 + t2139);
  t2149 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t969 - t2006 - 0.3e1 / 0.8e1 * t5 * t27 * t2144);
  tv3rhosigma20 = t6 * t2149 + t973;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2156 = t5 * t216 * t1031 / 0.8e1;
  t2158 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t1031 - t2156);
  tv3rhosigma25 = t6 * t2158 + t1035;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2164 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t969 - t2006);
  tv3rhosigma26 = t6 * t2164 + t973;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2178 = t1485 * t977;
  t2182 = t691 * t977;
  t2183 = t2182 * t264;
  t2184 = t107 * t2183;
  t2187 = t843 * t859;
  t2188 = t107 * t2187;
  t2191 = t637 * t993;
  t2195 = t279 * t993;
  t2196 = t2195 * t264;
  t2197 = t107 * t2196;
  t2210 = t897 * t1526;
  t2213 = t42 * t982 * t253 * t98 / 0.3e1 - t42 * t986 * t246 * t260 / 0.3e1 + 0.5e1 / 0.3e1 * t42 * t855 - t42 * t2210 * sigma[2];
  t2214 = t251 * t2213;
  t2221 = params->beta * t289;
  t2226 = t115 * t2213;
  t2232 = params->beta * t897;
  t2234 = params->gamma * t663;
  t2235 = t2234 * sigma[2];
  t2239 = 0.1e1 / t91 / t1521;
  t2240 = t286 * t2239;
  t2242 = t1004 * t274;
  t2245 = t1010 * t279;
  t2246 = t1931 * t264;
  t2249 = t977 * t264;
  t2250 = t882 * t2249;
  t2253 = t354 * t859;
  t2254 = t882 * t2253;
  t2258 = t88 * t369 * t691;
  t2261 = -0.6e1 * t2184 + 0.4e1 * t2188 + 0.2e1 * t2197 + 0.23e2 / 0.3e1 * t2221 * t291 + 0.4e1 * t642 * t883 - t107 * t2226 - 0.16e2 / 0.3e1 * t257 * t999 + 0.8e1 / 0.3e1 * t257 * t1002 - 0.11e2 / 0.3e1 * t2232 * t115 * t2235 + t2240 * t1560 + 0.3e1 * t2242 * t117 + 0.5e1 / 0.2e1 * t2245 * t2246 + 0.24e2 * t1940 * t2250 - 0.12e2 * t881 * t2254 - 0.6e1 * t2258 * t1932;
  t2262 = t993 * t264;
  t2263 = t882 * t2262;
  t2266 = t360 * t880;
  t2272 = t692 * t260 * t977;
  t2286 = t280 * t98 * t2213;
  t2290 = t280 * t260 * t993;
  t2301 = -0.6e1 * t881 * t2263 - 0.18e2 * t2266 * t884 - 0.56e2 / 0.3e1 * t875 * t888 + 0.8e1 * t290 * t2272 - 0.24e2 * t870 * t365 + 0.24e2 * t275 * t1014 - 0.8e1 * t275 * t1020 + 0.2e1 * t370 * t1961 + 0.8e1 / 0.3e1 * t898 * t1965 + 0.2e1 * t113 * t2286 - 0.8e1 / 0.3e1 * t290 * t2290 - t1024 * t1597 / 0.2e1 + 0.3e1 / 0.2e1 * t1005 * t282 + 0.6e1 * t361 * t892 - 0.2e1 * t860 + 0.16e2 / 0.3e1 * t839;
  t2306 = -0.32e2 / 0.27e2 * t35 * t1850 * t358 - 0.8e1 / 0.9e1 * t35 * t835 * t844 + 0.4e1 / 0.9e1 * t35 * t835 * t868 + 0.32e2 / 0.27e2 * t35 * t88 * t2178 + 0.4e1 / 0.3e1 * t744 * t2184 - 0.8e1 / 0.9e1 * t744 * t2188 - 0.16e2 / 0.27e2 * t35 * t88 * t2191 - 0.4e1 / 0.9e1 * t744 * t2197 + 0.2e1 / 0.9e1 * t35 * t88 * t2214 - 0.2e1 / 0.9e1 * t56 * t34 * (t2261 + t2301);
  t2311 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t1031 - t2156 - 0.3e1 / 0.8e1 * t5 * t87 * t2306);
  tv3rhosigma211 = t6 * t2311 + t1035;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2319 = t915 * t317;
  t2320 = t1109 * t2319;
  t2324 = t745 * t931;
  t2325 = t57 * t2324;
  t2329 = 0.1e1 / t43 / t187;
  t2334 = 0.1e1 / t187;
  t2346 = 0.3e1 / 0.8e1 * t42 * t2329 * t45 * t47 - 0.3e1 / 0.8e1 * t42 * t2334 * t41 * t162 - t42 * t924 * t332 * t451 / 0.8e1 + 0.3e1 / 0.8e1 * t42 * t961 * t1141;
  t2347 = t153 * t2346;
  t2351 = params->beta * t924;
  t2352 = t2351 * t332;
  t2355 = t1725 * t317;
  t2358 = params->beta * t961;
  t2362 = t182 * t47 * t2346;
  t2366 = 0.1e1 / t39 / t496;
  t2367 = t36 * t2366;
  t2370 = params->beta * t920;
  t2371 = t2370 * t62;
  t2382 = t479 * t2319;
  t2389 = t1184 * t47 * t2319;
  t2392 = t317 * t931;
  t2393 = t784 * t2392;
  t2399 = t65 * t2346;
  t2402 = -0.3e1 / 0.8e1 * t2352 * t193 + 0.15e2 / 0.2e1 * t2083 * t2355 + 0.7e1 / 0.8e1 * t2358 * t499 + 0.2e1 * t63 * t2362 - 0.3e1 / 0.8e1 * t2367 * t1162 + 0.3e1 / 0.8e1 * t2371 * t67 + 0.9e1 / 0.2e1 * t943 * t328 + 0.9e1 * t324 * t958 - 0.9e1 * t333 * t2130 + 0.3e1 * t333 * t2112 - 0.6e1 * t57 * t2382 + 0.6e1 * t2325 - 0.27e2 * t324 * t952 + 0.24e2 * t63 * t2389 - 0.18e2 * t783 * t2393 - 0.3e1 / 0.2e1 * t962 * t1757 - 0.3e1 * t932 - t57 * t2399 + 0.6e1 * t916;
  t2406 = -0.4e1 / 0.3e1 * t35 * t735 * t937 + 0.2e1 / 0.3e1 * t35 * t735 * t940 + 0.4e1 / 0.3e1 * t35 * t36 * t2320 - 0.4e1 / 0.3e1 * t744 * t2325 + 0.2e1 / 0.9e1 * t35 * t36 * t2347 - 0.2e1 / 0.9e1 * t56 * t34 * t2402;
  t2410 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2406);
  tv3sigma30 = t6 * t2410;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2417 = t977 * t354;
  t2418 = t1494 * t2417;
  t2422 = t843 * t993;
  t2423 = t107 * t2422;
  t2427 = 0.1e1 / t94 / t285;
  t2432 = 0.1e1 / t285;
  t2444 = 0.3e1 / 0.8e1 * t42 * t2427 * t96 * t98 - 0.3e1 / 0.8e1 * t42 * t2432 * t93 * t260 - t42 * t986 * t369 * t663 / 0.8e1 + 0.3e1 / 0.8e1 * t42 * t1023 * t1526;
  t2445 = t251 * t2444;
  t2449 = params->beta * t986;
  t2450 = t2449 * t369;
  t2453 = t1931 * t354;
  t2456 = params->beta * t1023;
  t2460 = t280 * t98 * t2444;
  t2464 = 0.1e1 / t91 / t708;
  t2465 = t88 * t2464;
  t2468 = params->beta * t982;
  t2469 = t2468 * t112;
  t2480 = t691 * t2417;
  t2485 = t1539 * t98 * t2417;
  t2488 = t354 * t993;
  t2489 = t882 * t2488;
  t2498 = t115 * t2444;
  t2500 = -0.3e1 / 0.8e1 * t2450 * t291 + 0.15e2 / 0.2e1 * t2245 * t2453 + 0.7e1 / 0.8e1 * t2456 * t711 + 0.2e1 * t113 * t2460 - 0.3e1 / 0.8e1 * t2465 * t1560 + 0.3e1 / 0.8e1 * t2469 * t117 + 0.9e1 / 0.2e1 * t1005 * t365 + 0.9e1 * t361 * t1020 - 0.9e1 * t370 * t2272 + 0.3e1 * t370 * t2290 - 0.6e1 * t107 * t2480 + 0.6e1 * t2423 + 0.24e2 * t113 * t2485 - 0.18e2 * t881 * t2489 - 0.3e1 / 0.2e1 * t1024 * t1965 - 0.27e2 * t361 * t1014 - 0.3e1 * t994 + 0.6e1 * t978 - t107 * t2498;
  t2504 = -0.4e1 / 0.3e1 * t35 * t835 * t999 + 0.2e1 / 0.3e1 * t35 * t835 * t1002 + 0.4e1 / 0.3e1 * t35 * t88 * t2418 - 0.4e1 / 0.3e1 * t744 * t2423 + 0.2e1 / 0.9e1 * t35 * t88 * t2445 - 0.2e1 / 0.9e1 * t56 * t34 * t2500;
  t2508 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t2504);
  tv3sigma39 = t6 * t2508;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t31, t32;
  double t33, t34, t35, t36, t37, t38, t39, t41;
  double t42, t43, t45, t46, t47, t50, t51, t52;
  double t56, t57, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t73, t77, t78, t79, t81;
  double t82, t83, t84, t86, t87, t88, t89, t90;
  double t91, t93, t94, t96, t97, t98, t101, t102;
  double t103, t107, t109, t110, t111, t112, t113, t114;
  double t115, t116, t117, t123, t127, tzk0;

  double t128, t129, t130, t132, t135, t136, t140, t141;
  double t142, t145, t146, t148, t149, t153, t155, t159;
  double t160, t161, t162, t166, t167, t173, t175, t176;
  double t177, t181, t182, t184, t187, t188, t189, t191;
  double t192, t193, t200, t205, t206, t208, t211, t212;
  double t216, t219, t221, tvrho0, t225, t228, t229, t234;
  double t236, t239, t240, t244, t246, t247, t251, t253;
  double t257, t258, t259, t260, t264, t265, t271, t273;
  double t274, t275, t279, t280, t282, t285, t286, t287;
  double t289, t290, t291, t298, t303, tvrho1, t306, t307;
  double t310, t317, t318, t321, t323, t324, t328, t332;
  double t333, t340, t344, tvsigma0, tvsigma1, t347, t354, t355;
  double t358, t360, t361, t365, t369, t370, t377, t381;
  double tvsigma2;

  double t384, t385, t386, t389, t390, t391, t394, t398;
  double t399, t403, t405, t411, t412, t415, t417, t420;
  double t421, t425, t426, t430, t431, t432, t437, t442;
  double t446, t448, t451, t455, t456, t464, t467, t469;
  double t470, t475, t478, t479, t480, t482, t486, t490;
  double t493, t494, t495, t496, t497, t498, t499, t502;
  double t506, t511, t512, t513, t514, t517, t520, t524;
  double t525, t529, t531, t533, t536, t538, tv2rho20, t541;
  double t545, t549, t550, t554, t556, t564, t565, t569;
  double t573, t574, t578, t580, t587, t590, tv2rho21, t595;
  double t600, t604, t605, t611, t612, t617, t621, t622;
  double t632, t633, t637, t638, t642, t643, t644, t649;
  double t654, t658, t660, t663, t667, t668, t676, t679;
  double t681, t682, t687, t690, t691, t692, t694, t698;
  double t702, t705, t706, t707, t708, t709, t710, t711;
  double t714, t718, t723, tv2rho22, t731, t735, t739, t744;
  double t745, t746, t747, t757, t761, t762, t770, t772;
  double t777, t782, t783, t784, t785, t786, t790, t794;
  double t798, t799, t800, t803, t807, t812, tv2rhosigma0, tv2rhosigma1;
  double t819, t821, tv2rhosigma2, t827, tv2rhosigma3, tv2rhosigma4, t835, t839;
  double t843, t844, t845, t855, t859, t860, t868, t870;
  double t875, t880, t881, t882, t883, t884, t888, t892;
  double t896, t897, t898, t901, t905, t910, tv2rhosigma5, t915;
  double t916, t920, t924, t931, t932, t937, t940, t942;
  double t943, t948, t952, t958, t961, t962, t969, t973;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t977, t978, t982;
  double t986, t993, t994, t999, t1002, t1004, t1005, t1010;
  double t1014, t1020, t1023, t1024, t1031, t1035, tv2sigma25;

  double t1039, t1040, t1043, t1046, t1047, t1048, t1051, t1055;
  double t1056, t1060, t1062, t1067, t1069, t1072, t1078, t1079;
  double t1082, t1084, t1087, t1090, t1091, t1095, t1096, t1100;
  double t1101, t1105, t1109, t1110, t1111, t1115, t1116, t1117;
  double t1121, t1126, t1131, t1136, t1137, t1139, t1141, t1145;
  double t1146, t1150, t1153, t1156, t1157, t1158, t1160, t1161;
  double t1162, t1167, t1177, t1183, t1184, t1186, t1189, t1190;
  double t1193, t1194, t1204, t1208, t1212, t1216, t1219, t1224;
  double t1229, t1231, t1232, t1235, t1238, t1241, t1245, t1246;
  double t1250, t1252, t1254, t1256, t1258, t1261, t1263, tv3rho30;
  double t1266, t1267, t1268, t1271, t1276, t1277, t1279, t1283;
  double t1284, t1288, t1291, t1295, t1297, t1301, t1310, t1311;
  double t1312, t1315, t1320, t1322, t1326, t1327, t1331, t1334;
  double t1335, t1337, t1346, t1348, t1351, tv3rho31, t1354, t1359;
  double t1363, t1367, t1368, t1372, t1374, t1383, t1384, t1389;
  double t1393, t1397, t1398, t1402, t1404, t1411, t1419, t1421;
  double t1422, tv3rho32, t1427, t1434, t1438, t1439, t1446, t1447;
  double t1454, t1458, t1459, t1475, t1476, t1480, t1481, t1485;
  double t1486, t1490, t1494, t1495, t1496, t1500, t1501, t1502;
  double t1506, t1511, t1516, t1521, t1522, t1524, t1526, t1530;
  double t1531, t1538, t1539, t1541, t1544, t1545, t1548, t1551;
  double t1554, t1555, t1556, t1558, t1559, t1560, t1565, t1576;
  double t1578, t1579, t1589, t1593, t1597, t1601, t1604, t1609;
  double t1614, tv3rho33, t1622, t1629, t1631, t1636, t1646, t1650;
  double t1653, t1658, t1659, t1662, t1663, t1664, t1667, t1668;
  double t1678, t1682, t1686, t1687, t1695, t1698, t1701, t1704;
  double t1706, t1707, t1711, t1712, t1715, t1716, t1719, t1720;
  double t1723, t1724, t1725, t1726, t1729, t1730, t1731, t1732;
  double t1739, t1753, t1757, t1761, t1773, t1775, t1780, t1785;
  double tv3rho2sigma0, tv3rho2sigma1, t1792, t1796, t1798, tv3rho2sigma2, t1804, t1812;
  double tv3rho2sigma3, tv3rho2sigma4, t1818, t1825, t1828, tv3rho2sigma5, t1836, tv3rho2sigma6;
  double tv3rho2sigma7, t1850, t1860, t1864, t1867, t1872, t1873, t1876;
  double t1877, t1878, t1881, t1882, t1892, t1896, t1900, t1901;
  double t1905, t1908, t1911, t1914, t1916, t1917, t1925, t1926;
  double t1929, t1930, t1931, t1932, t1935, t1936, t1939, t1940;
  double t1941, t1942, t1945, t1946, t1953, t1961, t1965, t1969;
  double t1987, t1989, t1994, t1999, tv3rho2sigma8, t2006, t2016, t2020;
  double t2021, t2022, t2025, t2026, t2029, t2033, t2034, t2035;
  double t2048, t2051, t2052, t2057, t2068, t2070, t2072, t2073;
  double t2077, t2078, t2080, t2083, t2084, t2087, t2090, t2091;
  double t2094, t2095, t2098, t2100, t2103, t2104, t2108, t2112;
  double t2130, t2139, t2144, t2149, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t2156, t2158, tv3rhosigma25, t2164, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28;
  double tv3rhosigma29, tv3rhosigma210, t2178, t2182, t2183, t2184, t2187, t2188;
  double t2191, t2195, t2196, t2197, t2210, t2213, t2214, t2221;
  double t2226, t2232, t2234, t2235, t2239, t2240, t2242, t2245;
  double t2246, t2249, t2250, t2253, t2254, t2258, t2261, t2262;
  double t2263, t2266, t2272, t2286, t2290, t2301, t2306, t2311;
  double tv3rhosigma211, t2319, t2320, t2324, t2325, t2329, t2334, t2346;
  double t2347, t2351, t2352, t2355, t2358, t2362, t2366, t2367;
  double t2370, t2371, t2382, t2389, t2392, t2393, t2399, t2402;
  double t2406, t2410, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, t2417, t2418, t2422, t2423, t2427;
  double t2432, t2444, t2445, t2449, t2450, t2453, t2456, t2460;
  double t2464, t2465, t2468, t2469, t2480, t2485, t2488, t2489;
  double t2498, t2500, t2504, t2508, tv3sigma39;

  double t2513, t2517, t2521, t2524, t2528, t2529, t2531, t2532;
  double t2538, t2544, t2545, t2548, t2552, t2561, t2567, t2569;
  double t2575, t2578, t2581, t2584, t2589, t2594, t2603, t2608;
  double t2615, t2616, t2623, t2626, t2632, t2639, t2644, t2649;
  double t2654, t2656, t2660, t2664, t2697, t2706, t2710, t2714;
  double t2717, t2725, t2741, t2749, t2750, t2767, t2772, t2781;
  double t2786, t2790, t2791, t2792, t2794, t2795, t2801, t2806;
  double t2809, t2813, t2820, t2824, t2828, t2833, t2835, tv4rho40;
  double t2842, t2846, t2847, t2850, t2871, t2872, t2874, t2878;
  double t2887, t2893, t2894, t2896, t2907, t2908, t2925, t2927;
  double t2931, t2938, t2942, t2943, t2946, t2955, t2958, t2959;
  double t2961, t2963, t2964, tv4rho41, t2973, t2977, t2992, t3005;
  double t3009, t3018, t3029, t3030, t3039, t3052, t3056, t3063;
  double t3067, t3076, t3079, t3090, t3093, t3095, t3096, tv4rho42;
  double t3117, t3121, t3128, t3139, t3140, t3157, t3161, t3168;
  double t3176, t3185, t3195, t3197, t3198, tv4rho43, t3203, t3208;
  double t3215, t3219, t3228, t3230, t3235, t3240, t3249, t3254;
  double t3261, t3262, t3269, t3272, t3278, t3285, t3290, t3295;
  double t3300, t3302, t3306, t3310, t3347, t3352, t3366, t3371;
  double t3379, t3380, t3396, t3400, t3404, t3414, t3422, t3427;
  double t3432, t3436, t3441, t3448, t3452, t3474, t3475, tv4rho44;
  double t3483, t3489, t3492, t3499, t3501, t3504, t3508, t3513;
  double t3517, t3521, t3528, t3531, t3534, t3564, t3567, t3571;
  double t3586, t3587, t3588, t3589, t3607, t3611, t3615, t3635;
  double t3666, t3688, t3695, t3700, t3708, t3714, t3722, t3723;
  double t3726, t3735, t3739, t3773, t3779, tv4rho3sigma0, tv4rho3sigma1, t3786;
  double t3789, t3793, t3795, tv4rho3sigma2, t3797, t3803, t3808, t3812;
  double t3821, t3822, tv4rho3sigma3, tv4rho3sigma4, t3824, t3830, t3832, t3841;
  double t3843, t3846, tv4rho3sigma5, t3852, t3861, tv4rho3sigma6, tv4rho3sigma7, t3867;
  double t3874, t3882, t3884, t3885, tv4rho3sigma8, t3894, tv4rho3sigma9, tv4rho3sigma10;
  double t3934, t3953, t3956, t3959, t3962, t3967, t3970, t3973;
  double t3977, t3984, t3985, t3986, t4021, t4024, t4026, t4030;
  double t4069, t4071, t4076, t4092, t4093, t4104, t4114, t4118;
  double t4127, t4134, t4139, t4153, t4159, t4178, t4184, tv4rho3sigma11;
  double t4191, t4198, t4200, t4229, t4241, t4244, t4250, t4257;
  double t4260, t4263, t4267, t4277, t4280, t4309, t4313, t4329;
  double t4332, t4347, t4365, t4372, t4379, t4386, t4389, t4409;
  double t4417, t4419, t4431, t4441, t4448, t4454, t4461, t4489;
  double t4507, t4513, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t4520;
  double t4524, t4526, tv4rho2sigma25, t4532, t4540, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28;
  double tv4rho2sigma29, tv4rho2sigma210, t4546, t4553, t4556, tv4rho2sigma211, t4564, tv4rho2sigma212;
  double tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t4596, t4620, t4626, t4630;
  double t4639, t4640, t4655, t4660, t4662, t4665, t4667, t4671;
  double t4674, t4681, t4685, t4688, t4690, t4697, t4700, t4702;
  double t4715, t4725, t4750, t4758, t4761, t4793, t4801, t4804;
  double t4814, t4850, t4882, t4888, tv4rho2sigma217, t4895, t4920, t4924;
  double t4927, t4930, t4931, t4935, t4939, t4948, t4969, t4993;
  double t5000, t5015, t5042, t5050, t5085, t5098, t5127, t5133;
  double t5138, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36;
  double tv4rhosigma37, tv4rhosigma38, t5145, t5147, tv4rhosigma39, t5153, tv4rhosigma310, tv4rhosigma311;
  double tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t5182;
  double t5186, t5189, t5192, t5193, t5197, t5201, t5210, t5231;
  double t5256, t5270, t5307, t5325, t5347, t5359, t5379, t5388;
  double t5394, t5399, tv4rhosigma319, t5410, t5416, t5419, t5425, t5450;
  double t5503, t5544, t5553, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44;
  double tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412;
  double tv4sigma413, t5563, t5569, t5572, t5578, t5603, t5656, t5697;
  double t5706, tv4sigma414;

  gga_x_hcth_a_params *params;

  assert(p->params != NULL);
  params = (gga_x_hcth_a_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t18 = my_piecewise5(t10, t11, t14, t15, t16 * t7);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = t2 * t2;
  t29 = params->c1 * t28;
  t31 = POW_1_3(0.1e1 / M_PI);
  t32 = 0.1e1 / t31;
  t33 = M_CBRT4;
  t34 = t32 * t33;
  t35 = t29 * t34;
  t36 = params->beta * sigma[0];
  t37 = rho[0] * rho[0];
  t38 = POW_1_3(rho[0]);
  t39 = t38 * t38;
  t41 = 0.1e1 / t39 / t37;
  t42 = params->gamma * params->beta;
  t43 = sqrt(sigma[0]);
  t45 = 0.1e1 / t38 / rho[0];
  t46 = t43 * t45;
  t47 = log(t46 + sqrt(t46 * t46 + 0.1e1));
  t50 = t42 * t46 * t47 + 0.1e1;
  t51 = 0.1e1 / t50;
  t52 = t41 * t51;
  t56 = params->c2 * t28;
  t57 = sigma[0] * t41;
  t59 = t43 * sigma[0];
  t60 = params->beta * t59;
  t61 = t37 * t37;
  t62 = 0.1e1 / t61;
  t63 = t60 * t62;
  t64 = t50 * t50;
  t65 = 0.1e1 / t64;
  t66 = t65 * params->gamma;
  t67 = t66 * t47;
  t73 = params->c0 - 0.2e1 / 0.9e1 * t35 * t36 * t52 - 0.2e1 / 0.9e1 * t56 * t34 * (t57 * t51 - t63 * t67);
  t77 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t73);
  t78 = rho[1] <= p->dens_threshold;
  t79 = -t16;
  t81 = my_piecewise5(t14, t11, t10, t15, t79 * t7);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = params->beta * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = sqrt(sigma[2]);
  t96 = 0.1e1 / t90 / rho[1];
  t97 = t94 * t96;
  t98 = log(t97 + sqrt(t97 * t97 + 0.1e1));
  t101 = t42 * t97 * t98 + 0.1e1;
  t102 = 0.1e1 / t101;
  t103 = t93 * t102;
  t107 = sigma[2] * t93;
  t109 = t94 * sigma[2];
  t110 = params->beta * t109;
  t111 = t89 * t89;
  t112 = 0.1e1 / t111;
  t113 = t110 * t112;
  t114 = t101 * t101;
  t115 = 0.1e1 / t114;
  t116 = t115 * params->gamma;
  t117 = t116 * t98;
  t123 = params->c0 - 0.2e1 / 0.9e1 * t35 * t88 * t103 - 0.2e1 / 0.9e1 * t56 * t34 * (t107 * t102 - t113 * t117);
  t127 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t123);
  tzk0 = t77 + t127;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t128 = t6 * t6;
  t129 = 0.1e1 / t128;
  t130 = t16 * t129;
  t132 = my_piecewise5(t10, 0, t14, 0, t7 - t130);
  t135 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t132);
  t136 = t135 * t26;
  t140 = t26 * t26;
  t141 = 0.1e1 / t140;
  t142 = t25 * t141;
  t145 = t5 * t142 * t73 / 0.8e1;
  t146 = t37 * rho[0];
  t148 = 0.1e1 / t39 / t146;
  t149 = t148 * t51;
  t153 = t41 * t65;
  t155 = 0.1e1 / t38 / t37;
  t159 = sigma[0] * t148;
  t160 = t57 + 0.1e1;
  t161 = sqrt(t160);
  t162 = 0.1e1 / t161;
  t166 = -0.4e1 / 0.3e1 * t42 * t43 * t155 * t47 - 0.4e1 / 0.3e1 * t42 * t159 * t162;
  t167 = t153 * t166;
  t173 = t65 * t166;
  t175 = t61 * rho[0];
  t176 = 0.1e1 / t175;
  t177 = t60 * t176;
  t181 = 0.1e1 / t64 / t50;
  t182 = t181 * params->gamma;
  t184 = t182 * t47 * t166;
  t187 = sigma[0] * sigma[0];
  t188 = params->beta * t187;
  t189 = t61 * t37;
  t191 = 0.1e1 / t38 / t189;
  t192 = t188 * t191;
  t193 = t66 * t162;
  t200 = 0.16e2 / 0.27e2 * t35 * t36 * t149 + 0.2e1 / 0.9e1 * t35 * t36 * t167 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.8e1 / 0.3e1 * t159 * t51 - t57 * t173 + 0.4e1 * t177 * t67 + 0.2e1 * t63 * t184 + 0.4e1 / 0.3e1 * t192 * t193);
  t205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t73 - t145 - 0.3e1 / 0.8e1 * t5 * t27 * t200);
  t206 = t79 * t129;
  t208 = my_piecewise5(t14, 0, t10, 0, -t7 - t206);
  t211 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t208);
  t212 = t211 * t26;
  t216 = t86 * t141;
  t219 = t5 * t216 * t123 / 0.8e1;
  t221 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t123 - t219);
  tvrho0 = t77 + t127 + t6 * (t205 + t221);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t225 = my_piecewise5(t10, 0, t14, 0, -t7 - t130);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t225);
  t229 = t228 * t26;
  t234 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t73 - t145);
  t236 = my_piecewise5(t14, 0, t10, 0, t7 - t206);
  t239 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t236);
  t240 = t239 * t26;
  t244 = t89 * rho[1];
  t246 = 0.1e1 / t91 / t244;
  t247 = t246 * t102;
  t251 = t93 * t115;
  t253 = 0.1e1 / t90 / t89;
  t257 = sigma[2] * t246;
  t258 = t107 + 0.1e1;
  t259 = sqrt(t258);
  t260 = 0.1e1 / t259;
  t264 = -0.4e1 / 0.3e1 * t42 * t94 * t253 * t98 - 0.4e1 / 0.3e1 * t42 * t257 * t260;
  t265 = t251 * t264;
  t271 = t115 * t264;
  t273 = t111 * rho[1];
  t274 = 0.1e1 / t273;
  t275 = t110 * t274;
  t279 = 0.1e1 / t114 / t101;
  t280 = t279 * params->gamma;
  t282 = t280 * t98 * t264;
  t285 = sigma[2] * sigma[2];
  t286 = params->beta * t285;
  t287 = t111 * t89;
  t289 = 0.1e1 / t90 / t287;
  t290 = t286 * t289;
  t291 = t116 * t260;
  t298 = 0.16e2 / 0.27e2 * t35 * t88 * t247 + 0.2e1 / 0.9e1 * t35 * t88 * t265 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.8e1 / 0.3e1 * t257 * t102 - t107 * t271 + 0.4e1 * t275 * t117 + 0.2e1 * t113 * t282 + 0.4e1 / 0.3e1 * t290 * t291);
  t303 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t123 - t219 - 0.3e1 / 0.8e1 * t5 * t87 * t298);
  tvrho1 = t77 + t127 + t6 * (t234 + t303);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t306 = t29 * t32;
  t307 = t33 * params->beta;
  t310 = 0.1e1 / t43;
  t317 = t42 * t310 * t45 * t47 / 0.2e1 + t42 * t41 * t162 / 0.2e1;
  t318 = t153 * t317;
  t321 = t65 * t317;
  t323 = params->beta * t43;
  t324 = t323 * t62;
  t328 = t182 * t47 * t317;
  t332 = 0.1e1 / t38 / t175;
  t333 = t36 * t332;
  t340 = -0.2e1 / 0.9e1 * t306 * t307 * t52 + 0.2e1 / 0.9e1 * t35 * t36 * t318 - 0.2e1 / 0.9e1 * t56 * t34 * (t52 - t57 * t321 - 0.3e1 / 0.2e1 * t324 * t67 + 0.2e1 * t63 * t328 - t333 * t193 / 0.2e1);
  t344 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t340);
  tvsigma0 = t6 * t344;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t347 = 0.1e1 / t94;
  t354 = t42 * t347 * t96 * t98 / 0.2e1 + t42 * t93 * t260 / 0.2e1;
  t355 = t251 * t354;
  t358 = t115 * t354;
  t360 = params->beta * t94;
  t361 = t360 * t112;
  t365 = t280 * t98 * t354;
  t369 = 0.1e1 / t90 / t273;
  t370 = t88 * t369;
  t377 = -0.2e1 / 0.9e1 * t306 * t307 * t103 + 0.2e1 / 0.9e1 * t35 * t88 * t355 - 0.2e1 / 0.9e1 * t56 * t34 * (t103 - t107 * t358 - 0.3e1 / 0.2e1 * t361 * t117 + 0.2e1 * t113 * t365 - t370 * t291 / 0.2e1);
  t381 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t377);
  tvsigma2 = t6 * t381;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t384 = t23 * t23;
  t385 = 0.1e1 / t384;
  t386 = t132 * t132;
  t389 = t128 * t6;
  t390 = 0.1e1 / t389;
  t391 = t16 * t390;
  t394 = my_piecewise5(t10, 0, t14, 0, -0.2e1 * t129 + 0.2e1 * t391);
  t398 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t385 * t386 + 0.4e1 / 0.3e1 * t23 * t394);
  t399 = t398 * t26;
  t403 = t135 * t141;
  t405 = t5 * t403 * t73;
  t411 = 0.1e1 / t140 / t6;
  t412 = t25 * t411;
  t415 = t5 * t412 * t73 / 0.12e2;
  t417 = t5 * t142 * t200;
  t420 = 0.1e1 / t39 / t61;
  t421 = t420 * t51;
  t425 = t148 * t65;
  t426 = t425 * t166;
  t430 = t41 * t181;
  t431 = t166 * t166;
  t432 = t430 * t431;
  t437 = 0.1e1 / t38 / t146;
  t442 = sigma[0] * t420;
  t446 = t61 * t146;
  t448 = 0.1e1 / t38 / t446;
  t451 = 0.1e1 / t161 / t160;
  t455 = 0.28e2 / 0.9e1 * t42 * t43 * t437 * t47 + 0.2e2 / 0.3e1 * t42 * t442 * t162 - 0.16e2 / 0.9e1 * t42 * t187 * t448 * t451;
  t456 = t153 * t455;
  t464 = t181 * t431;
  t467 = t65 * t455;
  t469 = 0.1e1 / t189;
  t470 = t60 * t469;
  t475 = t188 * t448;
  t478 = t64 * t64;
  t479 = 0.1e1 / t478;
  t480 = t479 * params->gamma;
  t482 = t480 * t47 * t431;
  t486 = t182 * t162 * t166;
  t490 = t182 * t47 * t455;
  t493 = t187 * sigma[0];
  t494 = params->beta * t493;
  t495 = t61 * t61;
  t496 = t495 * t37;
  t497 = 0.1e1 / t496;
  t498 = t494 * t497;
  t499 = t66 * t451;
  t502 = 0.88e2 / 0.9e1 * t442 * t51 + 0.16e2 / 0.3e1 * t159 * t173 + 0.2e1 * t57 * t464 - t57 * t467 - 0.2e2 * t470 * t67 - 0.16e2 * t177 * t184 - 0.124e3 / 0.9e1 * t475 * t193 - 0.6e1 * t63 * t482 - 0.16e2 / 0.3e1 * t192 * t486 + 0.2e1 * t63 * t490 + 0.16e2 / 0.9e1 * t498 * t499;
  t506 = -0.176e3 / 0.81e2 * t35 * t36 * t421 - 0.32e2 / 0.27e2 * t35 * t36 * t426 - 0.4e1 / 0.9e1 * t35 * t36 * t432 + 0.2e1 / 0.9e1 * t35 * t36 * t456 - 0.2e1 / 0.9e1 * t56 * t34 * t502;
  t511 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t399 * t73 - t405 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t136 * t200 + t415 - t417 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t506);
  t512 = t84 * t84;
  t513 = 0.1e1 / t512;
  t514 = t208 * t208;
  t517 = t79 * t390;
  t520 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t129 + 0.2e1 * t517);
  t524 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t513 * t514 + 0.4e1 / 0.3e1 * t84 * t520);
  t525 = t524 * t26;
  t529 = t211 * t141;
  t531 = t5 * t529 * t123;
  t533 = t86 * t411;
  t536 = t5 * t533 * t123 / 0.12e2;
  t538 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t525 * t123 - t531 / 0.4e1 + t536);
  tv2rho20 = 0.2e1 * t205 + 0.2e1 * t221 + t6 * (t511 + t538);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t541 = t385 * t225;
  t545 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t391);
  t549 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t541 * t132 + 0.4e1 / 0.3e1 * t23 * t545);
  t550 = t549 * t26;
  t554 = t228 * t141;
  t556 = t5 * t554 * t73;
  t564 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t550 * t73 - t556 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t200 - t405 / 0.8e1 + t415 - t417 / 0.8e1);
  t565 = t513 * t236;
  t569 = my_piecewise5(t14, 0, t10, 0, 0.2e1 * t517);
  t573 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t565 * t208 + 0.4e1 / 0.3e1 * t84 * t569);
  t574 = t573 * t26;
  t578 = t239 * t141;
  t580 = t5 * t578 * t123;
  t587 = t5 * t216 * t298;
  t590 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t574 * t123 - t580 / 0.8e1 - t531 / 0.8e1 + t536 - 0.3e1 / 0.8e1 * t5 * t212 * t298 - t587 / 0.8e1);
  tv2rho21 = t205 + t221 + t234 + t303 + t6 * (t564 + t590);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t595 = t225 * t225;
  t600 = my_piecewise5(t10, 0, t14, 0, 0.2e1 * t129 + 0.2e1 * t391);
  t604 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t385 * t595 + 0.4e1 / 0.3e1 * t23 * t600);
  t605 = t604 * t26;
  t611 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t73 - t556 / 0.4e1 + t415);
  t612 = t236 * t236;
  t617 = my_piecewise5(t14, 0, t10, 0, -0.2e1 * t129 + 0.2e1 * t517);
  t621 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t513 * t612 + 0.4e1 / 0.3e1 * t84 * t617);
  t622 = t621 * t26;
  t632 = 0.1e1 / t91 / t111;
  t633 = t632 * t102;
  t637 = t246 * t115;
  t638 = t637 * t264;
  t642 = t93 * t279;
  t643 = t264 * t264;
  t644 = t642 * t643;
  t649 = 0.1e1 / t90 / t244;
  t654 = sigma[2] * t632;
  t658 = t111 * t244;
  t660 = 0.1e1 / t90 / t658;
  t663 = 0.1e1 / t259 / t258;
  t667 = 0.28e2 / 0.9e1 * t42 * t94 * t649 * t98 + 0.2e2 / 0.3e1 * t42 * t654 * t260 - 0.16e2 / 0.9e1 * t42 * t285 * t660 * t663;
  t668 = t251 * t667;
  t676 = t279 * t643;
  t679 = t115 * t667;
  t681 = 0.1e1 / t287;
  t682 = t110 * t681;
  t687 = t286 * t660;
  t690 = t114 * t114;
  t691 = 0.1e1 / t690;
  t692 = t691 * params->gamma;
  t694 = t692 * t98 * t643;
  t698 = t280 * t260 * t264;
  t702 = t280 * t98 * t667;
  t705 = t285 * sigma[2];
  t706 = params->beta * t705;
  t707 = t111 * t111;
  t708 = t707 * t89;
  t709 = 0.1e1 / t708;
  t710 = t706 * t709;
  t711 = t116 * t663;
  t714 = 0.88e2 / 0.9e1 * t654 * t102 + 0.16e2 / 0.3e1 * t257 * t271 + 0.2e1 * t107 * t676 - t107 * t679 - 0.2e2 * t682 * t117 - 0.16e2 * t275 * t282 - 0.124e3 / 0.9e1 * t687 * t291 - 0.6e1 * t113 * t694 - 0.16e2 / 0.3e1 * t290 * t698 + 0.2e1 * t113 * t702 + 0.16e2 / 0.9e1 * t710 * t711;
  t718 = -0.176e3 / 0.81e2 * t35 * t88 * t633 - 0.32e2 / 0.27e2 * t35 * t88 * t638 - 0.4e1 / 0.9e1 * t35 * t88 * t644 + 0.2e1 / 0.9e1 * t35 * t88 * t668 - 0.2e1 / 0.9e1 * t56 * t34 * t714;
  t723 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t622 * t123 - t580 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t298 + t536 - t587 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t718);
  tv2rho22 = 0.2e1 * t234 + 0.2e1 * t303 + t6 * (t611 + t723);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t731 = t5 * t142 * t340 / 0.8e1;
  t735 = params->beta * t41;
  t739 = t425 * t317;
  t744 = t29 * t34 * params->beta;
  t745 = t181 * t317;
  t746 = t745 * t166;
  t747 = t57 * t746;
  t757 = t191 * t451;
  t761 = -0.2e1 / 0.3e1 * t42 * t310 * t155 * t47 - 0.2e1 * t42 * t148 * t162 + 0.2e1 / 0.3e1 * t42 * t757 * sigma[0];
  t762 = t153 * t761;
  t770 = t65 * t761;
  t772 = t323 * t176;
  t777 = t36 * t191;
  t782 = t62 * t479;
  t783 = t60 * t782;
  t784 = params->gamma * t47;
  t785 = t317 * t166;
  t786 = t784 * t785;
  t790 = t182 * t162 * t317;
  t794 = t182 * t47 * t761;
  t798 = t495 * rho[0];
  t799 = 0.1e1 / t798;
  t800 = t188 * t799;
  t803 = -0.8e1 / 0.3e1 * t149 - t167 + 0.8e1 / 0.3e1 * t159 * t321 + 0.2e1 * t747 - t57 * t770 + 0.6e1 * t772 * t67 + 0.3e1 * t324 * t184 + 0.14e2 / 0.3e1 * t777 * t193 - 0.8e1 * t177 * t328 - 0.6e1 * t783 * t786 - 0.8e1 / 0.3e1 * t192 * t790 + 0.2e1 * t63 * t794 + t333 * t486 - 0.2e1 / 0.3e1 * t800 * t499;
  t807 = 0.16e2 / 0.27e2 * t306 * t307 * t149 + 0.2e1 / 0.9e1 * t35 * t735 * t173 - 0.16e2 / 0.27e2 * t35 * t36 * t739 - 0.4e1 / 0.9e1 * t744 * t747 + 0.2e1 / 0.9e1 * t35 * t36 * t762 - 0.2e1 / 0.9e1 * t56 * t34 * t803;
  t812 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t340 - t731 - 0.3e1 / 0.8e1 * t5 * t27 * t807);
  tv2rhosigma0 = t6 * t812 + t344;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t819 = t5 * t216 * t377 / 0.8e1;
  t821 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t377 - t819);
  tv2rhosigma2 = t6 * t821 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t827 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t340 - t731);
  tv2rhosigma3 = t6 * t827 + t344;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t835 = params->beta * t93;
  t839 = t637 * t354;
  t843 = t279 * t354;
  t844 = t843 * t264;
  t845 = t107 * t844;
  t855 = t289 * t663;
  t859 = -0.2e1 / 0.3e1 * t42 * t347 * t253 * t98 - 0.2e1 * t42 * t246 * t260 + 0.2e1 / 0.3e1 * t42 * t855 * sigma[2];
  t860 = t251 * t859;
  t868 = t115 * t859;
  t870 = t360 * t274;
  t875 = t88 * t289;
  t880 = t112 * t691;
  t881 = t110 * t880;
  t882 = params->gamma * t98;
  t883 = t354 * t264;
  t884 = t882 * t883;
  t888 = t280 * t260 * t354;
  t892 = t280 * t98 * t859;
  t896 = t707 * rho[1];
  t897 = 0.1e1 / t896;
  t898 = t286 * t897;
  t901 = -0.8e1 / 0.3e1 * t247 - t265 + 0.8e1 / 0.3e1 * t257 * t358 + 0.2e1 * t845 - t107 * t868 + 0.6e1 * t870 * t117 + 0.3e1 * t361 * t282 + 0.14e2 / 0.3e1 * t875 * t291 - 0.8e1 * t275 * t365 - 0.6e1 * t881 * t884 - 0.8e1 / 0.3e1 * t290 * t888 + 0.2e1 * t113 * t892 + t370 * t698 - 0.2e1 / 0.3e1 * t898 * t711;
  t905 = 0.16e2 / 0.27e2 * t306 * t307 * t247 + 0.2e1 / 0.9e1 * t35 * t835 * t271 - 0.16e2 / 0.27e2 * t35 * t88 * t839 - 0.4e1 / 0.9e1 * t744 * t845 + 0.2e1 / 0.9e1 * t35 * t88 * t860 - 0.2e1 / 0.9e1 * t56 * t34 * t901;
  t910 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t377 - t819 - 0.3e1 / 0.8e1 * t5 * t87 * t905);
  tv2rhosigma5 = t6 * t910 + t381;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t915 = t317 * t317;
  t916 = t430 * t915;
  t920 = 0.1e1 / t59;
  t924 = 0.1e1 / sigma[0];
  t931 = t42 * t924 * t41 * t162 / 0.4e1 - t42 * t920 * t45 * t47 / 0.4e1 - t42 * t332 * t451 / 0.4e1;
  t932 = t153 * t931;
  t937 = t181 * t915;
  t940 = t65 * t931;
  t942 = params->beta * t310;
  t943 = t942 * t62;
  t948 = params->beta * t332;
  t952 = t480 * t47 * t915;
  t958 = t182 * t47 * t931;
  t961 = 0.1e1 / t495;
  t962 = t36 * t961;
  t969 = 0.4e1 / 0.9e1 * t35 * t735 * t321 - 0.4e1 / 0.9e1 * t35 * t36 * t916 + 0.2e1 / 0.9e1 * t35 * t36 * t932 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.2e1 * t318 + 0.2e1 * t57 * t937 - t57 * t940 - 0.3e1 / 0.4e1 * t943 * t67 + 0.6e1 * t324 * t328 - 0.5e1 / 0.4e1 * t948 * t193 - 0.6e1 * t63 * t952 + 0.2e1 * t333 * t790 + 0.2e1 * t63 * t958 + t962 * t499 / 0.4e1);
  t973 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t969);
  tv2sigma20 = t6 * t973;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t977 = t354 * t354;
  t978 = t642 * t977;
  t982 = 0.1e1 / t109;
  t986 = 0.1e1 / sigma[2];
  t993 = t42 * t986 * t93 * t260 / 0.4e1 - t42 * t982 * t96 * t98 / 0.4e1 - t42 * t369 * t663 / 0.4e1;
  t994 = t251 * t993;
  t999 = t279 * t977;
  t1002 = t115 * t993;
  t1004 = params->beta * t347;
  t1005 = t1004 * t112;
  t1010 = params->beta * t369;
  t1014 = t692 * t98 * t977;
  t1020 = t280 * t98 * t993;
  t1023 = 0.1e1 / t707;
  t1024 = t88 * t1023;
  t1031 = 0.4e1 / 0.9e1 * t35 * t835 * t358 - 0.4e1 / 0.9e1 * t35 * t88 * t978 + 0.2e1 / 0.9e1 * t35 * t88 * t994 - 0.2e1 / 0.9e1 * t56 * t34 * (-0.2e1 * t355 + 0.2e1 * t107 * t999 - t107 * t1002 - 0.3e1 / 0.4e1 * t1005 * t117 + 0.6e1 * t361 * t365 - 0.5e1 / 0.4e1 * t1010 * t291 - 0.6e1 * t113 * t1014 + 0.2e1 * t370 * t888 + 0.2e1 * t113 * t1020 + t1024 * t711 / 0.4e1);
  t1035 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t1031);
  tv2sigma25 = t6 * t1035;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1039 = 0.1e1 / t384 / t19;
  t1040 = t386 * t132;
  t1043 = t385 * t132;
  t1046 = t128 * t128;
  t1047 = 0.1e1 / t1046;
  t1048 = t16 * t1047;
  t1051 = my_piecewise5(t10, 0, t14, 0, 0.6e1 * t390 - 0.6e1 * t1048);
  t1055 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1039 * t1040 + 0.4e1 / 0.3e1 * t1043 * t394 + 0.4e1 / 0.3e1 * t23 * t1051);
  t1056 = t1055 * t26;
  t1060 = t398 * t141;
  t1062 = t5 * t1060 * t73;
  t1067 = t135 * t411;
  t1069 = t5 * t1067 * t73;
  t1072 = t5 * t403 * t200;
  t1078 = 0.1e1 / t140 / t128;
  t1079 = t25 * t1078;
  t1082 = 0.5e1 / 0.36e2 * t5 * t1079 * t73;
  t1084 = t5 * t412 * t200;
  t1087 = t5 * t142 * t506;
  t1090 = 0.1e1 / t39 / t175;
  t1091 = t1090 * t51;
  t1095 = t420 * t65;
  t1096 = t1095 * t166;
  t1100 = t148 * t181;
  t1101 = t1100 * t431;
  t1105 = t425 * t455;
  t1109 = t41 * t479;
  t1110 = t431 * t166;
  t1111 = t1109 * t1110;
  t1115 = t181 * t166;
  t1116 = t1115 * t455;
  t1117 = t57 * t1116;
  t1121 = 0.1e1 / t38 / t61;
  t1126 = sigma[0] * t1090;
  t1131 = 0.1e1 / t38 / t495;
  t1136 = t495 * t146;
  t1137 = 0.1e1 / t1136;
  t1139 = t160 * t160;
  t1141 = 0.1e1 / t161 / t1139;
  t1145 = -0.28e3 / 0.27e2 * t42 * t43 * t1121 * t47 - 0.952e3 / 0.27e2 * t42 * t1126 * t162 + 0.592e3 / 0.27e2 * t42 * t187 * t1131 * t451 - 0.64e2 / 0.9e1 * t42 * t493 * t1137 * t1141;
  t1146 = t153 * t1145;
  t1150 = t188 * t1131;
  t1153 = t494 * t1137;
  t1156 = t187 * t187;
  t1157 = params->beta * t1156;
  t1158 = t495 * t175;
  t1160 = 0.1e1 / t39 / t1158;
  t1161 = t1157 * t1160;
  t1162 = t66 * t1141;
  t1167 = t479 * t1110;
  t1177 = t65 * t1145;
  t1183 = 0.1e1 / t478 / t50;
  t1184 = t1183 * params->gamma;
  t1186 = t1184 * t47 * t1110;
  t1189 = t166 * t455;
  t1190 = t784 * t1189;
  t1193 = 0.1e1 / t446;
  t1194 = t60 * t1193;
  t1204 = t480 * t162 * t431;
  t1208 = t182 * t162 * t455;
  t1212 = t182 * t451 * t166;
  t1216 = t182 * t47 * t1145;
  t1219 = 0.72e2 * t177 * t482 + 0.24e2 * t63 * t1186 - 0.18e2 * t783 * t1190 + 0.12e3 * t1194 * t67 + 0.12e3 * t470 * t184 - 0.24e2 * t177 * t490 + 0.248e3 / 0.3e1 * t475 * t486 + 0.24e2 * t192 * t1204 - 0.8e1 * t192 * t1208 - 0.32e2 / 0.3e1 * t498 * t1212 + 0.2e1 * t63 * t1216;
  t1224 = 0.2464e4 / 0.243e3 * t35 * t36 * t1091 + 0.176e3 / 0.27e2 * t35 * t36 * t1096 + 0.32e2 / 0.9e1 * t35 * t36 * t1101 - 0.16e2 / 0.9e1 * t35 * t36 * t1105 + 0.4e1 / 0.3e1 * t35 * t36 * t1111 - 0.4e1 / 0.3e1 * t744 * t1117 + 0.2e1 / 0.9e1 * t35 * t36 * t1146 - 0.2e1 / 0.9e1 * t56 * t34 * (0.3448e4 / 0.27e2 * t1150 * t193 - 0.976e3 / 0.27e2 * t1153 * t499 + 0.64e2 / 0.9e1 * t1161 * t1162 - 0.16e2 * t159 * t464 - 0.6e1 * t57 * t1167 + 0.6e1 * t1117 - 0.1232e4 / 0.27e2 * t1126 * t51 - 0.88e2 / 0.3e1 * t442 * t173 + 0.8e1 * t159 * t467 - t57 * t1177 + t1219);
  t1229 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1056 * t73 - 0.3e1 / 0.8e1 * t1062 - 0.9e1 / 0.8e1 * t5 * t399 * t200 + t1069 / 0.4e1 - 0.3e1 / 0.4e1 * t1072 - 0.9e1 / 0.8e1 * t5 * t136 * t506 - t1082 + t1084 / 0.4e1 - 0.3e1 / 0.8e1 * t1087 - 0.3e1 / 0.8e1 * t5 * t27 * t1224);
  t1231 = 0.1e1 / t512 / t82;
  t1232 = t514 * t208;
  t1235 = t513 * t208;
  t1238 = t79 * t1047;
  t1241 = my_piecewise5(t14, 0, t10, 0, -0.6e1 * t390 - 0.6e1 * t1238);
  t1245 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1231 * t1232 + 0.4e1 / 0.3e1 * t1235 * t520 + 0.4e1 / 0.3e1 * t84 * t1241);
  t1246 = t1245 * t26;
  t1250 = t524 * t141;
  t1252 = t5 * t1250 * t123;
  t1254 = t211 * t411;
  t1256 = t5 * t1254 * t123;
  t1258 = t86 * t1078;
  t1261 = 0.5e1 / 0.36e2 * t5 * t1258 * t123;
  t1263 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t1246 * t123 - 0.3e1 / 0.8e1 * t1252 + t1256 / 0.4e1 - t1261);
  tv3rho30 = 0.3e1 * t511 + 0.3e1 * t538 + t6 * (t1229 + t1263);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1266 = 0.2e1 * t564;
  t1267 = 0.2e1 * t590;
  t1268 = t1039 * t225;
  t1271 = t385 * t545;
  t1276 = 0.2e1 * t390;
  t1277 = 0.6e1 * t1048;
  t1279 = my_piecewise5(t10, 0, t14, 0, t1276 - t1277);
  t1283 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1268 * t386 + 0.8e1 / 0.9e1 * t1271 * t132 + 0.4e1 / 0.9e1 * t541 * t394 + 0.4e1 / 0.3e1 * t23 * t1279);
  t1284 = t1283 * t26;
  t1288 = t549 * t141;
  t1291 = t5 * t1288 * t73 / 0.4e1;
  t1295 = t228 * t411;
  t1297 = t5 * t1295 * t73;
  t1301 = t5 * t554 * t200 / 0.4e1;
  t1310 = -0.3e1 / 0.8e1 * t5 * t1284 * t73 - t1291 - 0.3e1 / 0.4e1 * t5 * t550 * t200 + t1297 / 0.12e2 - t1301 - 0.3e1 / 0.8e1 * t5 * t229 * t506 - t1062 / 0.8e1 + t1069 / 0.6e1 - t1072 / 0.4e1 - t1082 + t1084 / 0.6e1 - t1087 / 0.8e1;
  t1311 = my_piecewise3(t1, 0, t1310);
  t1312 = t1231 * t236;
  t1315 = t513 * t569;
  t1320 = 0.6e1 * t1238;
  t1322 = my_piecewise5(t14, 0, t10, 0, -t1276 - t1320);
  t1326 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1312 * t514 + 0.8e1 / 0.9e1 * t1315 * t208 + 0.4e1 / 0.9e1 * t565 * t520 + 0.4e1 / 0.3e1 * t84 * t1322);
  t1327 = t1326 * t26;
  t1331 = t573 * t141;
  t1334 = t5 * t1331 * t123 / 0.4e1;
  t1335 = t239 * t411;
  t1337 = t5 * t1335 * t123;
  t1346 = t5 * t529 * t298 / 0.4e1;
  t1348 = t5 * t533 * t298;
  t1351 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t1327 * t123 - t1334 + t1337 / 0.12e2 - t1252 / 0.8e1 + t1256 / 0.6e1 - t1261 - 0.3e1 / 0.8e1 * t5 * t525 * t298 - t1346 + t1348 / 0.12e2);
  tv3rho31 = t511 + t538 + t1266 + t1267 + t6 * (t1311 + t1351);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1354 = t1039 * t595;
  t1359 = t385 * t600;
  t1363 = my_piecewise5(t10, 0, t14, 0, -t1276 - t1277);
  t1367 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1354 * t132 + 0.8e1 / 0.9e1 * t541 * t545 + 0.4e1 / 0.9e1 * t1359 * t132 + 0.4e1 / 0.3e1 * t23 * t1363);
  t1368 = t1367 * t26;
  t1372 = t604 * t141;
  t1374 = t5 * t1372 * t73;
  t1383 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1368 * t73 - t1374 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t605 * t200 - t1291 + t1297 / 0.6e1 - t1301 + t1069 / 0.12e2 - t1082 + t1084 / 0.12e2);
  t1384 = t1231 * t612;
  t1389 = t513 * t617;
  t1393 = my_piecewise5(t14, 0, t10, 0, t1276 - t1320);
  t1397 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1384 * t208 + 0.8e1 / 0.9e1 * t565 * t569 + 0.4e1 / 0.9e1 * t1389 * t208 + 0.4e1 / 0.3e1 * t84 * t1393);
  t1398 = t1397 * t26;
  t1402 = t621 * t141;
  t1404 = t5 * t1402 * t123;
  t1411 = t5 * t578 * t298;
  t1419 = t5 * t216 * t718;
  t1421 = -0.3e1 / 0.8e1 * t5 * t1398 * t123 - t1404 / 0.8e1 - t1334 + t1337 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t574 * t298 - t1411 / 0.4e1 + t1256 / 0.12e2 - t1261 - t1346 + t1348 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t212 * t718 - t1419 / 0.8e1;
  t1422 = my_piecewise3(t78, 0, t1421);
  tv3rho32 = t1266 + t1267 + t611 + t723 + t6 * (t1383 + t1422);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1427 = t595 * t225;
  t1434 = my_piecewise5(t10, 0, t14, 0, -0.6e1 * t390 - 0.6e1 * t1048);
  t1438 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1039 * t1427 + 0.4e1 / 0.3e1 * t541 * t600 + 0.4e1 / 0.3e1 * t23 * t1434);
  t1439 = t1438 * t26;
  t1446 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1439 * t73 - 0.3e1 / 0.8e1 * t1374 + t1297 / 0.4e1 - t1082);
  t1447 = t612 * t236;
  t1454 = my_piecewise5(t14, 0, t10, 0, 0.6e1 * t390 - 0.6e1 * t1238);
  t1458 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1231 * t1447 + 0.4e1 / 0.3e1 * t565 * t617 + 0.4e1 / 0.3e1 * t84 * t1454);
  t1459 = t1458 * t26;
  t1475 = 0.1e1 / t91 / t273;
  t1476 = t1475 * t102;
  t1480 = t632 * t115;
  t1481 = t1480 * t264;
  t1485 = t246 * t279;
  t1486 = t1485 * t643;
  t1490 = t637 * t667;
  t1494 = t93 * t691;
  t1495 = t643 * t264;
  t1496 = t1494 * t1495;
  t1500 = t279 * t264;
  t1501 = t1500 * t667;
  t1502 = t107 * t1501;
  t1506 = 0.1e1 / t90 / t111;
  t1511 = sigma[2] * t1475;
  t1516 = 0.1e1 / t90 / t707;
  t1521 = t707 * t244;
  t1522 = 0.1e1 / t1521;
  t1524 = t258 * t258;
  t1526 = 0.1e1 / t259 / t1524;
  t1530 = -0.28e3 / 0.27e2 * t42 * t94 * t1506 * t98 - 0.952e3 / 0.27e2 * t42 * t1511 * t260 + 0.592e3 / 0.27e2 * t42 * t285 * t1516 * t663 - 0.64e2 / 0.9e1 * t42 * t705 * t1522 * t1526;
  t1531 = t251 * t1530;
  t1538 = 0.1e1 / t690 / t101;
  t1539 = t1538 * params->gamma;
  t1541 = t1539 * t98 * t1495;
  t1544 = t264 * t667;
  t1545 = t882 * t1544;
  t1548 = t286 * t1516;
  t1551 = t706 * t1522;
  t1554 = t285 * t285;
  t1555 = params->beta * t1554;
  t1556 = t707 * t273;
  t1558 = 0.1e1 / t91 / t1556;
  t1559 = t1555 * t1558;
  t1560 = t116 * t1526;
  t1565 = t691 * t1495;
  t1576 = t115 * t1530;
  t1578 = 0.1e1 / t658;
  t1579 = t110 * t1578;
  t1589 = t692 * t260 * t643;
  t1593 = t280 * t260 * t667;
  t1597 = t280 * t663 * t264;
  t1601 = t280 * t98 * t1530;
  t1604 = -0.88e2 / 0.3e1 * t654 * t271 + 0.8e1 * t257 * t679 - t107 * t1576 + 0.12e3 * t1579 * t117 + 0.12e3 * t682 * t282 - 0.24e2 * t275 * t702 + 0.248e3 / 0.3e1 * t687 * t698 + 0.24e2 * t290 * t1589 - 0.8e1 * t290 * t1593 - 0.32e2 / 0.3e1 * t710 * t1597 + 0.2e1 * t113 * t1601;
  t1609 = 0.2464e4 / 0.243e3 * t35 * t88 * t1476 + 0.176e3 / 0.27e2 * t35 * t88 * t1481 + 0.32e2 / 0.9e1 * t35 * t88 * t1486 - 0.16e2 / 0.9e1 * t35 * t88 * t1490 + 0.4e1 / 0.3e1 * t35 * t88 * t1496 - 0.4e1 / 0.3e1 * t744 * t1502 + 0.2e1 / 0.9e1 * t35 * t88 * t1531 - 0.2e1 / 0.9e1 * t56 * t34 * (0.72e2 * t275 * t694 + 0.24e2 * t113 * t1541 - 0.18e2 * t881 * t1545 + 0.3448e4 / 0.27e2 * t1548 * t291 - 0.976e3 / 0.27e2 * t1551 * t711 + 0.64e2 / 0.9e1 * t1559 * t1560 - 0.16e2 * t257 * t676 - 0.6e1 * t107 * t1565 + 0.6e1 * t1502 - 0.1232e4 / 0.27e2 * t1511 * t102 + t1604);
  t1614 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t1459 * t123 - 0.3e1 / 0.8e1 * t1404 - 0.9e1 / 0.8e1 * t5 * t622 * t298 + t1337 / 0.4e1 - 0.3e1 / 0.4e1 * t1411 - 0.9e1 / 0.8e1 * t5 * t240 * t718 - t1261 + t1348 / 0.4e1 - 0.3e1 / 0.8e1 * t1419 - 0.3e1 / 0.8e1 * t5 * t87 * t1609);
  tv3rho33 = 0.3e1 * t611 + 0.3e1 * t723 + t6 * (t1446 + t1614);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1622 = t5 * t403 * t340;
  t1629 = t5 * t412 * t340 / 0.12e2;
  t1631 = t5 * t142 * t807;
  t1636 = params->beta * t148;
  t1646 = t1095 * t317;
  t1650 = t159 * t746;
  t1653 = t425 * t761;
  t1658 = t479 * t317 * t431;
  t1659 = t57 * t1658;
  t1662 = t181 * t761;
  t1663 = t1662 * t166;
  t1664 = t57 * t1663;
  t1667 = t745 * t455;
  t1668 = t57 * t1667;
  t1678 = t448 * t451;
  t1682 = t497 * t1141;
  t1686 = 0.14e2 / 0.9e1 * t42 * t310 * t437 * t47 + 0.74e2 / 0.9e1 * t42 * t420 * t162 - 0.62e2 / 0.9e1 * t42 * t1678 * sigma[0] + 0.8e1 / 0.3e1 * t42 * t1682 * t187;
  t1687 = t153 * t1686;
  t1695 = t323 * t469;
  t1698 = t36 * t448;
  t1701 = t188 * t497;
  t1704 = t495 * t61;
  t1706 = 0.1e1 / t39 / t1704;
  t1707 = t494 * t1706;
  t1711 = t176 * t479;
  t1712 = t60 * t1711;
  t1715 = t761 * t166;
  t1716 = t784 * t1715;
  t1719 = t317 * t455;
  t1720 = t784 * t1719;
  t1723 = t191 * t479;
  t1724 = t188 * t1723;
  t1725 = params->gamma * t162;
  t1726 = t1725 * t785;
  t1729 = t62 * t1183;
  t1730 = t60 * t1729;
  t1731 = t317 * t431;
  t1732 = t784 * t1731;
  t1739 = 0.2e1 * t1668 - 0.6e1 * t1659 - 0.32e2 / 0.3e1 * t1650 + 0.4e1 * t1664 - 0.3e2 * t1695 * t67 - 0.338e3 / 0.9e1 * t1698 * t193 + 0.11e3 / 0.9e1 * t1701 * t499 - 0.8e1 / 0.3e1 * t1707 * t1162 + 0.88e2 / 0.9e1 * t421 + 0.48e2 * t1712 * t786 - 0.12e2 * t783 * t1716 - 0.6e1 * t783 * t1720 + 0.16e2 * t1724 * t1726 + 0.24e2 * t1730 * t1732 - 0.3e1 * t333 * t1204 - 0.9e1 * t324 * t482;
  t1753 = t182 * t162 * t761;
  t1757 = t182 * t451 * t317;
  t1761 = t182 * t47 * t1686;
  t1773 = t65 * t1686;
  t1775 = 0.4e2 * t470 * t328 - 0.24e2 * t772 * t184 + 0.3e1 * t324 * t490 - 0.56e2 / 0.3e1 * t777 * t486 - 0.16e2 * t177 * t794 + 0.248e3 / 0.9e1 * t475 * t790 - 0.16e2 / 0.3e1 * t192 * t1753 - 0.32e2 / 0.9e1 * t498 * t1757 + 0.2e1 * t63 * t1761 + t333 * t1208 + 0.8e1 / 0.3e1 * t800 * t1212 + 0.16e2 / 0.3e1 * t426 - t456 + 0.2e1 * t432 - 0.88e2 / 0.9e1 * t442 * t321 + 0.16e2 / 0.3e1 * t159 * t770 - t57 * t1773;
  t1780 = -0.176e3 / 0.81e2 * t306 * t307 * t421 - 0.32e2 / 0.27e2 * t35 * t1636 * t173 - 0.4e1 / 0.9e1 * t35 * t735 * t464 + 0.2e1 / 0.9e1 * t35 * t735 * t467 + 0.176e3 / 0.81e2 * t35 * t36 * t1646 + 0.64e2 / 0.27e2 * t744 * t1650 - 0.32e2 / 0.27e2 * t35 * t36 * t1653 + 0.4e1 / 0.3e1 * t744 * t1659 - 0.8e1 / 0.9e1 * t744 * t1664 - 0.4e1 / 0.9e1 * t744 * t1668 + 0.2e1 / 0.9e1 * t35 * t36 * t1687 - 0.2e1 / 0.9e1 * t56 * t34 * (t1739 + t1775);
  t1785 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t399 * t340 - t1622 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t136 * t807 + t1629 - t1631 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1780);
  tv3rho2sigma0 = t6 * t1785 + 0.2e1 * t812;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1792 = t5 * t529 * t377;
  t1796 = t5 * t533 * t377 / 0.12e2;
  t1798 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t525 * t377 - t1792 / 0.4e1 + t1796);
  tv3rho2sigma2 = t6 * t1798 + 0.2e1 * t821;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1804 = t5 * t554 * t340;
  t1812 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t550 * t340 - t1804 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t807 - t1622 / 0.8e1 + t1629 - t1631 / 0.8e1);
  tv3rho2sigma3 = t6 * t1812 + t812 + t827;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1818 = t5 * t578 * t377;
  t1825 = t5 * t216 * t905;
  t1828 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t574 * t377 - t1818 / 0.8e1 - t1792 / 0.8e1 + t1796 - 0.3e1 / 0.8e1 * t5 * t212 * t905 - t1825 / 0.8e1);
  tv3rho2sigma5 = t6 * t1828 + t821 + t910;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1836 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t340 - t1804 / 0.4e1 + t1629);
  tv3rho2sigma6 = t6 * t1836 + 0.2e1 * t827;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1850 = params->beta * t246;
  t1860 = t1480 * t354;
  t1864 = t257 * t844;
  t1867 = t637 * t859;
  t1872 = t691 * t354 * t643;
  t1873 = t107 * t1872;
  t1876 = t279 * t859;
  t1877 = t1876 * t264;
  t1878 = t107 * t1877;
  t1881 = t843 * t667;
  t1882 = t107 * t1881;
  t1892 = t660 * t663;
  t1896 = t709 * t1526;
  t1900 = 0.14e2 / 0.9e1 * t42 * t347 * t649 * t98 + 0.74e2 / 0.9e1 * t42 * t632 * t260 - 0.62e2 / 0.9e1 * t42 * t1892 * sigma[2] + 0.8e1 / 0.3e1 * t42 * t1896 * t285;
  t1901 = t251 * t1900;
  t1905 = t360 * t681;
  t1908 = t88 * t660;
  t1911 = t286 * t709;
  t1914 = t707 * t111;
  t1916 = 0.1e1 / t91 / t1914;
  t1917 = t706 * t1916;
  t1925 = t354 * t667;
  t1926 = t882 * t1925;
  t1929 = t289 * t691;
  t1930 = t286 * t1929;
  t1931 = params->gamma * t260;
  t1932 = t1931 * t883;
  t1935 = t274 * t691;
  t1936 = t110 * t1935;
  t1939 = t112 * t1538;
  t1940 = t110 * t1939;
  t1941 = t354 * t643;
  t1942 = t882 * t1941;
  t1945 = t859 * t264;
  t1946 = t882 * t1945;
  t1953 = -0.3e2 * t1905 * t117 - 0.338e3 / 0.9e1 * t1908 * t291 + 0.11e3 / 0.9e1 * t1911 * t711 - 0.8e1 / 0.3e1 * t1917 * t1560 - 0.6e1 * t1873 - 0.32e2 / 0.3e1 * t1864 + 0.4e1 * t1878 + 0.2e1 * t1882 + 0.88e2 / 0.9e1 * t633 - 0.6e1 * t881 * t1926 + 0.16e2 * t1930 * t1932 + 0.48e2 * t1936 * t884 + 0.24e2 * t1940 * t1942 - 0.12e2 * t881 * t1946 - 0.3e1 * t370 * t1589 - 0.9e1 * t361 * t694;
  t1961 = t280 * t260 * t859;
  t1965 = t280 * t663 * t354;
  t1969 = t280 * t98 * t1900;
  t1987 = t115 * t1900;
  t1989 = 0.4e2 * t682 * t365 - 0.16e2 * t275 * t892 + 0.248e3 / 0.9e1 * t687 * t888 - 0.16e2 / 0.3e1 * t290 * t1961 - 0.32e2 / 0.9e1 * t710 * t1965 + 0.2e1 * t113 * t1969 + t370 * t1593 + 0.8e1 / 0.3e1 * t898 * t1597 - 0.24e2 * t870 * t282 + 0.3e1 * t361 * t702 - 0.56e2 / 0.3e1 * t875 * t698 + 0.16e2 / 0.3e1 * t638 - t668 + 0.2e1 * t644 - 0.88e2 / 0.9e1 * t654 * t358 + 0.16e2 / 0.3e1 * t257 * t868 - t107 * t1987;
  t1994 = -0.176e3 / 0.81e2 * t306 * t307 * t633 - 0.32e2 / 0.27e2 * t35 * t1850 * t271 - 0.4e1 / 0.9e1 * t35 * t835 * t676 + 0.2e1 / 0.9e1 * t35 * t835 * t679 + 0.176e3 / 0.81e2 * t35 * t88 * t1860 + 0.64e2 / 0.27e2 * t744 * t1864 - 0.32e2 / 0.27e2 * t35 * t88 * t1867 + 0.4e1 / 0.3e1 * t744 * t1873 - 0.8e1 / 0.9e1 * t744 * t1878 - 0.4e1 / 0.9e1 * t744 * t1882 + 0.2e1 / 0.9e1 * t35 * t88 * t1901 - 0.2e1 / 0.9e1 * t56 * t34 * (t1953 + t1989);
  t1999 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t622 * t377 - t1818 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t905 + t1796 - t1825 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t1994);
  tv3rho2sigma8 = t6 * t1999 + 0.2e1 * t910;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2006 = t5 * t142 * t969 / 0.8e1;
  t2016 = t1100 * t915;
  t2020 = t479 * t915;
  t2021 = t2020 * t166;
  t2022 = t57 * t2021;
  t2025 = t745 * t761;
  t2026 = t57 * t2025;
  t2029 = t425 * t931;
  t2033 = t181 * t931;
  t2034 = t2033 * t166;
  t2035 = t57 * t2034;
  t2048 = t799 * t1141;
  t2051 = t42 * t920 * t155 * t47 / 0.3e1 - t42 * t924 * t148 * t162 / 0.3e1 + 0.5e1 / 0.3e1 * t42 * t757 - t42 * t2048 * sigma[0];
  t2052 = t153 * t2051;
  t2057 = params->beta * t191;
  t2068 = t65 * t2051;
  t2070 = params->beta * t799;
  t2072 = params->gamma * t451;
  t2073 = t2072 * sigma[0];
  t2077 = 0.1e1 / t39 / t1136;
  t2078 = t188 * t2077;
  t2080 = t942 * t176;
  t2083 = t948 * t181;
  t2084 = t1725 * t166;
  t2087 = t323 * t782;
  t2090 = t915 * t166;
  t2091 = t784 * t2090;
  t2094 = t317 * t761;
  t2095 = t784 * t2094;
  t2098 = 0.2e1 * t2035 + 0.23e2 / 0.3e1 * t2057 * t193 - 0.6e1 * t2022 + 0.4e1 * t2026 - 0.16e2 / 0.3e1 * t159 * t937 + 0.8e1 / 0.3e1 * t159 * t940 + 0.4e1 * t430 * t785 - t57 * t2068 - 0.11e2 / 0.3e1 * t2070 * t65 * t2073 + t2078 * t1162 + 0.3e1 * t2080 * t67 + 0.5e1 / 0.2e1 * t2083 * t2084 - 0.18e2 * t2087 * t786 + 0.24e2 * t1730 * t2091 - 0.12e2 * t783 * t2095;
  t2100 = t36 * t332 * t479;
  t2103 = t931 * t166;
  t2104 = t784 * t2103;
  t2108 = t182 * t47 * t2051;
  t2112 = t182 * t162 * t931;
  t2130 = t480 * t162 * t915;
  t2139 = -0.6e1 * t2100 * t1726 - 0.6e1 * t783 * t2104 + 0.2e1 * t63 * t2108 - 0.8e1 / 0.3e1 * t192 * t2112 - t962 * t1212 / 0.2e1 - 0.24e2 * t772 * t328 + 0.24e2 * t177 * t952 - 0.8e1 * t177 * t958 + 0.3e1 / 0.2e1 * t943 * t184 + 0.6e1 * t324 * t794 - 0.56e2 / 0.3e1 * t777 * t790 + 0.8e1 * t192 * t2130 + 0.2e1 * t333 * t1753 + 0.8e1 / 0.3e1 * t800 * t1757 - 0.2e1 * t762 + 0.16e2 / 0.3e1 * t739;
  t2144 = -0.32e2 / 0.27e2 * t35 * t1636 * t321 - 0.8e1 / 0.9e1 * t35 * t735 * t746 + 0.4e1 / 0.9e1 * t35 * t735 * t770 + 0.32e2 / 0.27e2 * t35 * t36 * t2016 + 0.4e1 / 0.3e1 * t744 * t2022 - 0.8e1 / 0.9e1 * t744 * t2026 - 0.16e2 / 0.27e2 * t35 * t36 * t2029 - 0.4e1 / 0.9e1 * t744 * t2035 + 0.2e1 / 0.9e1 * t35 * t36 * t2052 - 0.2e1 / 0.9e1 * t56 * t34 * (t2098 + t2139);
  t2149 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t969 - t2006 - 0.3e1 / 0.8e1 * t5 * t27 * t2144);
  tv3rhosigma20 = t6 * t2149 + t973;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2156 = t5 * t216 * t1031 / 0.8e1;
  t2158 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t1031 - t2156);
  tv3rhosigma25 = t6 * t2158 + t1035;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2164 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t969 - t2006);
  tv3rhosigma26 = t6 * t2164 + t973;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2178 = t1485 * t977;
  t2182 = t691 * t977;
  t2183 = t2182 * t264;
  t2184 = t107 * t2183;
  t2187 = t843 * t859;
  t2188 = t107 * t2187;
  t2191 = t637 * t993;
  t2195 = t279 * t993;
  t2196 = t2195 * t264;
  t2197 = t107 * t2196;
  t2210 = t897 * t1526;
  t2213 = t42 * t982 * t253 * t98 / 0.3e1 - t42 * t986 * t246 * t260 / 0.3e1 + 0.5e1 / 0.3e1 * t42 * t855 - t42 * t2210 * sigma[2];
  t2214 = t251 * t2213;
  t2221 = params->beta * t289;
  t2226 = t115 * t2213;
  t2232 = params->beta * t897;
  t2234 = params->gamma * t663;
  t2235 = t2234 * sigma[2];
  t2239 = 0.1e1 / t91 / t1521;
  t2240 = t286 * t2239;
  t2242 = t1004 * t274;
  t2245 = t1010 * t279;
  t2246 = t1931 * t264;
  t2249 = t977 * t264;
  t2250 = t882 * t2249;
  t2253 = t354 * t859;
  t2254 = t882 * t2253;
  t2258 = t88 * t369 * t691;
  t2261 = -0.6e1 * t2184 + 0.4e1 * t2188 + 0.2e1 * t2197 + 0.23e2 / 0.3e1 * t2221 * t291 + 0.4e1 * t642 * t883 - t107 * t2226 - 0.16e2 / 0.3e1 * t257 * t999 + 0.8e1 / 0.3e1 * t257 * t1002 - 0.11e2 / 0.3e1 * t2232 * t115 * t2235 + t2240 * t1560 + 0.3e1 * t2242 * t117 + 0.5e1 / 0.2e1 * t2245 * t2246 + 0.24e2 * t1940 * t2250 - 0.12e2 * t881 * t2254 - 0.6e1 * t2258 * t1932;
  t2262 = t993 * t264;
  t2263 = t882 * t2262;
  t2266 = t360 * t880;
  t2272 = t692 * t260 * t977;
  t2286 = t280 * t98 * t2213;
  t2290 = t280 * t260 * t993;
  t2301 = -0.6e1 * t881 * t2263 - 0.18e2 * t2266 * t884 - 0.56e2 / 0.3e1 * t875 * t888 + 0.8e1 * t290 * t2272 - 0.24e2 * t870 * t365 + 0.24e2 * t275 * t1014 - 0.8e1 * t275 * t1020 + 0.2e1 * t370 * t1961 + 0.8e1 / 0.3e1 * t898 * t1965 + 0.2e1 * t113 * t2286 - 0.8e1 / 0.3e1 * t290 * t2290 - t1024 * t1597 / 0.2e1 + 0.3e1 / 0.2e1 * t1005 * t282 + 0.6e1 * t361 * t892 - 0.2e1 * t860 + 0.16e2 / 0.3e1 * t839;
  t2306 = -0.32e2 / 0.27e2 * t35 * t1850 * t358 - 0.8e1 / 0.9e1 * t35 * t835 * t844 + 0.4e1 / 0.9e1 * t35 * t835 * t868 + 0.32e2 / 0.27e2 * t35 * t88 * t2178 + 0.4e1 / 0.3e1 * t744 * t2184 - 0.8e1 / 0.9e1 * t744 * t2188 - 0.16e2 / 0.27e2 * t35 * t88 * t2191 - 0.4e1 / 0.9e1 * t744 * t2197 + 0.2e1 / 0.9e1 * t35 * t88 * t2214 - 0.2e1 / 0.9e1 * t56 * t34 * (t2261 + t2301);
  t2311 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t1031 - t2156 - 0.3e1 / 0.8e1 * t5 * t87 * t2306);
  tv3rhosigma211 = t6 * t2311 + t1035;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2319 = t915 * t317;
  t2320 = t1109 * t2319;
  t2324 = t745 * t931;
  t2325 = t57 * t2324;
  t2329 = 0.1e1 / t43 / t187;
  t2334 = 0.1e1 / t187;
  t2346 = 0.3e1 / 0.8e1 * t42 * t2329 * t45 * t47 - 0.3e1 / 0.8e1 * t42 * t2334 * t41 * t162 - t42 * t924 * t332 * t451 / 0.8e1 + 0.3e1 / 0.8e1 * t42 * t961 * t1141;
  t2347 = t153 * t2346;
  t2351 = params->beta * t924;
  t2352 = t2351 * t332;
  t2355 = t1725 * t317;
  t2358 = params->beta * t961;
  t2362 = t182 * t47 * t2346;
  t2366 = 0.1e1 / t39 / t496;
  t2367 = t36 * t2366;
  t2370 = params->beta * t920;
  t2371 = t2370 * t62;
  t2382 = t479 * t2319;
  t2389 = t1184 * t47 * t2319;
  t2392 = t317 * t931;
  t2393 = t784 * t2392;
  t2399 = t65 * t2346;
  t2402 = -0.3e1 / 0.8e1 * t2352 * t193 + 0.15e2 / 0.2e1 * t2083 * t2355 + 0.7e1 / 0.8e1 * t2358 * t499 + 0.2e1 * t63 * t2362 - 0.3e1 / 0.8e1 * t2367 * t1162 + 0.3e1 / 0.8e1 * t2371 * t67 + 0.9e1 / 0.2e1 * t943 * t328 + 0.9e1 * t324 * t958 - 0.9e1 * t333 * t2130 + 0.3e1 * t333 * t2112 - 0.6e1 * t57 * t2382 + 0.6e1 * t2325 - 0.27e2 * t324 * t952 + 0.24e2 * t63 * t2389 - 0.18e2 * t783 * t2393 - 0.3e1 / 0.2e1 * t962 * t1757 - 0.3e1 * t932 - t57 * t2399 + 0.6e1 * t916;
  t2406 = -0.4e1 / 0.3e1 * t35 * t735 * t937 + 0.2e1 / 0.3e1 * t35 * t735 * t940 + 0.4e1 / 0.3e1 * t35 * t36 * t2320 - 0.4e1 / 0.3e1 * t744 * t2325 + 0.2e1 / 0.9e1 * t35 * t36 * t2347 - 0.2e1 / 0.9e1 * t56 * t34 * t2402;
  t2410 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2406);
  tv3sigma30 = t6 * t2410;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2417 = t977 * t354;
  t2418 = t1494 * t2417;
  t2422 = t843 * t993;
  t2423 = t107 * t2422;
  t2427 = 0.1e1 / t94 / t285;
  t2432 = 0.1e1 / t285;
  t2444 = 0.3e1 / 0.8e1 * t42 * t2427 * t96 * t98 - 0.3e1 / 0.8e1 * t42 * t2432 * t93 * t260 - t42 * t986 * t369 * t663 / 0.8e1 + 0.3e1 / 0.8e1 * t42 * t1023 * t1526;
  t2445 = t251 * t2444;
  t2449 = params->beta * t986;
  t2450 = t2449 * t369;
  t2453 = t1931 * t354;
  t2456 = params->beta * t1023;
  t2460 = t280 * t98 * t2444;
  t2464 = 0.1e1 / t91 / t708;
  t2465 = t88 * t2464;
  t2468 = params->beta * t982;
  t2469 = t2468 * t112;
  t2480 = t691 * t2417;
  t2485 = t1539 * t98 * t2417;
  t2488 = t354 * t993;
  t2489 = t882 * t2488;
  t2498 = t115 * t2444;
  t2500 = -0.3e1 / 0.8e1 * t2450 * t291 + 0.15e2 / 0.2e1 * t2245 * t2453 + 0.7e1 / 0.8e1 * t2456 * t711 + 0.2e1 * t113 * t2460 - 0.3e1 / 0.8e1 * t2465 * t1560 + 0.3e1 / 0.8e1 * t2469 * t117 + 0.9e1 / 0.2e1 * t1005 * t365 + 0.9e1 * t361 * t1020 - 0.9e1 * t370 * t2272 + 0.3e1 * t370 * t2290 - 0.6e1 * t107 * t2480 + 0.6e1 * t2423 + 0.24e2 * t113 * t2485 - 0.18e2 * t881 * t2489 - 0.3e1 / 0.2e1 * t1024 * t1965 - 0.27e2 * t361 * t1014 - 0.3e1 * t994 + 0.6e1 * t978 - t107 * t2498;
  t2504 = -0.4e1 / 0.3e1 * t35 * t835 * t999 + 0.2e1 / 0.3e1 * t35 * t835 * t1002 + 0.4e1 / 0.3e1 * t35 * t88 * t2418 - 0.4e1 / 0.3e1 * t744 * t2423 + 0.2e1 / 0.9e1 * t35 * t88 * t2445 - 0.2e1 / 0.9e1 * t56 * t34 * t2500;
  t2508 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * t2504);
  tv3sigma39 = t6 * t2508;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2513 = t5 * t1055 * t141 * t73;
  t2517 = t5 * t398 * t411 * t73;
  t2521 = t5 * t135 * t1078 * t73;
  t2524 = 0.1e1 / t140 / t389;
  t2528 = 0.1e2 / 0.27e2 * t5 * t25 * t2524 * t73;
  t2529 = t19 * t19;
  t2531 = 0.1e1 / t384 / t2529;
  t2532 = t386 * t386;
  t2538 = t394 * t394;
  t2544 = 0.1e1 / t1046 / t6;
  t2545 = t16 * t2544;
  t2548 = my_piecewise5(t10, 0, t14, 0, -0.24e2 * t1047 + 0.24e2 * t2545);
  t2552 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2531 * t2532 - 0.16e2 / 0.9e1 * t1039 * t386 * t394 + 0.4e1 / 0.3e1 * t385 * t2538 + 0.16e2 / 0.9e1 * t1043 * t1051 + 0.4e1 / 0.3e1 * t23 * t2548);
  t2561 = t5 * t1060 * t200;
  t2567 = t5 * t1067 * t200;
  t2569 = t5 * t403 * t506;
  t2575 = t5 * t1079 * t200;
  t2578 = t5 * t412 * t506;
  t2581 = t5 * t142 * t1224;
  t2584 = 0.1e1 / t39 / t189;
  t2589 = t1090 * t65;
  t2594 = t420 * t181;
  t2603 = t148 * t479;
  t2608 = t159 * t1116;
  t2615 = t41 * t1183;
  t2616 = t431 * t431;
  t2623 = t57 * t479 * t431 * t455;
  t2626 = t455 * t455;
  t2632 = t57 * t1115 * t1145;
  t2639 = sigma[0] * t2584;
  t2644 = 0.1e1 / t38 / t798;
  t2649 = 0.1e1 / t1704;
  t2654 = t495 * t189;
  t2656 = 0.1e1 / t39 / t2654;
  t2660 = 0.1e1 / t161 / t1139 / t160;
  t2664 = 0.364e4 / 0.81e2 * t42 * t43 * t332 * t47 + 0.5768e4 / 0.27e2 * t42 * t2639 * t162 - 0.18608e5 / 0.81e2 * t42 * t187 * t2644 * t451 + 0.448e4 / 0.27e2 * t42 * t493 * t2649 * t1141 - 0.128e4 / 0.27e2 * t42 * t1156 * t2656 * t2660;
  t2697 = t1725 * t1189;
  t2706 = t480 * t451 * t431;
  t2710 = t182 * t162 * t1145;
  t2714 = t182 * t451 * t455;
  t2717 = 0.352e3 / 0.3e1 * t442 * t464 + 0.64e2 * t159 * t1167 + 0.24e2 * t57 * t1183 * t2616 + 0.6e1 * t57 * t181 * t2626 + 0.4928e4 / 0.27e2 * t1126 * t173 - 0.176e3 / 0.3e1 * t442 * t467 + 0.32e2 / 0.3e1 * t159 * t1177 - t57 * t65 * t2664 + 0.288e3 * t1712 * t1190 + 0.144e3 * t1730 * t784 * t431 * t455 - 0.24e2 * t783 * t784 * t166 * t1145 + 0.96e2 * t1724 * t2697 + 0.20944e5 / 0.81e2 * t2639 * t51 - 0.64e2 * t2608 - 0.36e2 * t2623 + 0.8e1 * t2632 + 0.64e2 * t498 * t2706 - 0.32e2 / 0.3e1 * t192 * t2710 - 0.64e2 / 0.3e1 * t498 * t2714;
  t2725 = t1184 * t162 * t1110;
  t2741 = t182 * t1141 * t166;
  t2749 = 0.1e1 / t478 / t64;
  t2750 = t2749 * params->gamma;
  t2767 = t495 * t495;
  t2772 = t66 * t2660;
  t2781 = 0.2e1 * t63 * t182 * t47 * t2664 - 0.496e3 * t475 * t1204 - 0.128e3 * t192 * t2725 - 0.96e3 * t1194 * t184 + 0.24e3 * t470 * t490 - 0.32e2 * t177 * t1216 + 0.496e3 / 0.3e1 * t475 * t1208 - 0.27584e5 / 0.27e2 * t1150 * t486 + 0.7808e4 / 0.27e2 * t1153 * t1212 - 0.512e3 / 0.9e1 * t1161 * t2741 - 0.72e3 * t470 * t482 - 0.384e3 * t177 * t1186 - 0.12e3 * t63 * t2750 * t47 * t2616 - 0.18e2 * t63 * t480 * t47 * t2626 + 0.46e5 / 0.81e2 * t494 * t2649 * t499 - 0.2176e4 / 0.9e1 * t1157 * t2656 * t1162 + 0.128e4 / 0.27e2 * params->beta * t1156 * sigma[0] / t38 / t2767 / rho[0] * t2772 - 0.84e3 * t60 * t961 * t67 - 0.9916e5 / 0.81e2 * t188 * t2644 * t193;
  t2786 = -0.41888e5 / 0.729e3 * t35 * t36 * t2584 * t51 - 0.9856e4 / 0.243e3 * t35 * t36 * t2589 * t166 - 0.704e3 / 0.27e2 * t35 * t36 * t2594 * t431 + 0.352e3 / 0.27e2 * t35 * t36 * t1095 * t455 - 0.128e3 / 0.9e1 * t35 * t36 * t2603 * t1110 + 0.128e3 / 0.9e1 * t744 * t2608 - 0.64e2 / 0.27e2 * t35 * t36 * t425 * t1145 - 0.16e2 / 0.3e1 * t35 * t36 * t2615 * t2616 + 0.8e1 * t744 * t2623 - 0.4e1 / 0.3e1 * t35 * t36 * t430 * t2626 - 0.16e2 / 0.9e1 * t744 * t2632 + 0.2e1 / 0.9e1 * t35 * t36 * t153 * t2664 - 0.2e1 / 0.9e1 * t56 * t34 * (t2717 + t2781);
  t2790 = -t2513 / 0.2e1 + t2517 / 0.2e1 - 0.5e1 / 0.9e1 * t2521 + t2528 - 0.3e1 / 0.8e1 * t5 * t2552 * t26 * t73 - 0.3e1 / 0.2e1 * t5 * t1056 * t200 - 0.3e1 / 0.2e1 * t2561 - 0.9e1 / 0.4e1 * t5 * t399 * t506 + t2567 - 0.3e1 / 0.2e1 * t2569 - 0.3e1 / 0.2e1 * t5 * t136 * t1224 - 0.5e1 / 0.9e1 * t2575 + t2578 / 0.2e1 - t2581 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * t2786;
  t2791 = my_piecewise3(t1, 0, t2790);
  t2792 = t82 * t82;
  t2794 = 0.1e1 / t512 / t2792;
  t2795 = t514 * t514;
  t2801 = t520 * t520;
  t2806 = t79 * t2544;
  t2809 = my_piecewise5(t14, 0, t10, 0, 0.24e2 * t1047 + 0.24e2 * t2806);
  t2813 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t2794 * t2795 - 0.16e2 / 0.9e1 * t1231 * t514 * t520 + 0.4e1 / 0.3e1 * t513 * t2801 + 0.16e2 / 0.9e1 * t1235 * t1241 + 0.4e1 / 0.3e1 * t84 * t2809);
  t2820 = t5 * t1245 * t141 * t123;
  t2824 = t5 * t524 * t411 * t123;
  t2828 = t5 * t211 * t1078 * t123;
  t2833 = 0.1e2 / 0.27e2 * t5 * t86 * t2524 * t123;
  t2835 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t2813 * t26 * t123 - t2820 / 0.2e1 + t2824 / 0.2e1 - 0.5e1 / 0.9e1 * t2828 + t2833);
  tv4rho40 = 0.4e1 * t1229 + 0.4e1 * t1263 + t6 * (t2791 + t2835);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2842 = t5 * t1283 * t141 * t73;
  t2846 = t5 * t549 * t411 * t73;
  t2847 = t2846 / 0.4e1;
  t2850 = t5 * t228 * t1078 * t73;
  t2871 = 0.12e2 * t1047;
  t2872 = 0.24e2 * t2545;
  t2874 = my_piecewise5(t10, 0, t14, 0, -t2871 + t2872);
  t2878 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2531 * t225 * t1040 - 0.8e1 / 0.9e1 * t1039 * t545 * t386 - 0.8e1 / 0.9e1 * t1268 * t132 * t394 + 0.4e1 / 0.3e1 * t385 * t1279 * t132 + 0.4e1 / 0.3e1 * t1271 * t394 + 0.4e1 / 0.9e1 * t541 * t1051 + 0.4e1 / 0.3e1 * t23 * t2874);
  t2887 = t5 * t1288 * t200;
  t2893 = t5 * t1295 * t200;
  t2894 = t2893 / 0.4e1;
  t2896 = t5 * t554 * t506;
  t2907 = -0.3e1 / 0.8e1 * t2842 + t2847 - 0.5e1 / 0.36e2 * t2850 - t2513 / 0.8e1 + t2517 / 0.4e1 - 0.5e1 / 0.12e2 * t2521 + t2528 - 0.3e1 / 0.8e1 * t5 * t2878 * t26 * t73 - 0.9e1 / 0.8e1 * t5 * t1284 * t200 - 0.3e1 / 0.4e1 * t2887 - 0.9e1 / 0.8e1 * t5 * t550 * t506 + t2894 - 0.3e1 / 0.8e1 * t2896 - 0.3e1 / 0.8e1 * t5 * t229 * t1224 - 0.3e1 / 0.8e1 * t2561 + t2567 / 0.2e1 - 0.3e1 / 0.8e1 * t2569 - 0.5e1 / 0.12e2 * t2575 + t2578 / 0.4e1 - t2581 / 0.8e1;
  t2908 = my_piecewise3(t1, 0, t2907);
  t2925 = 0.24e2 * t2806;
  t2927 = my_piecewise5(t14, 0, t10, 0, t2871 + t2925);
  t2931 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t2794 * t236 * t1232 - 0.8e1 / 0.9e1 * t1231 * t569 * t514 - 0.8e1 / 0.9e1 * t1312 * t208 * t520 + 0.4e1 / 0.3e1 * t513 * t1322 * t208 + 0.4e1 / 0.3e1 * t1315 * t520 + 0.4e1 / 0.9e1 * t565 * t1241 + 0.4e1 / 0.3e1 * t84 * t2927);
  t2938 = t5 * t1326 * t141 * t123;
  t2942 = t5 * t573 * t411 * t123;
  t2943 = t2942 / 0.4e1;
  t2946 = t5 * t239 * t1078 * t123;
  t2955 = t5 * t1250 * t298;
  t2958 = t5 * t1254 * t298;
  t2959 = t2958 / 0.4e1;
  t2961 = t5 * t1258 * t298;
  t2963 = -0.3e1 / 0.8e1 * t5 * t2931 * t26 * t123 - 0.3e1 / 0.8e1 * t2938 + t2943 - 0.5e1 / 0.36e2 * t2946 - t2820 / 0.8e1 + t2824 / 0.4e1 - 0.5e1 / 0.12e2 * t2828 + t2833 - 0.3e1 / 0.8e1 * t5 * t1246 * t298 - 0.3e1 / 0.8e1 * t2955 + t2959 - 0.5e1 / 0.36e2 * t2961;
  t2964 = my_piecewise3(t78, 0, t2963);
  tv4rho41 = t1229 + t1263 + 0.3e1 * t1311 + 0.3e1 * t1351 + t6 * (t2908 + t2964);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2973 = t5 * t1367 * t141 * t73;
  t2977 = t5 * t604 * t411 * t73;
  t2992 = t545 * t545;
  t3005 = my_piecewise5(t10, 0, t14, 0, t2872);
  t3009 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2531 * t595 * t386 - 0.32e2 / 0.27e2 * t1268 * t132 * t545 - 0.8e1 / 0.27e2 * t1354 * t394 + 0.8e1 / 0.9e1 * t385 * t2992 + 0.8e1 / 0.9e1 * t541 * t1279 - 0.8e1 / 0.27e2 * t1039 * t600 * t386 + 0.8e1 / 0.9e1 * t385 * t1363 * t132 + 0.4e1 / 0.9e1 * t1359 * t394 + 0.4e1 / 0.3e1 * t23 * t3005);
  t3018 = t5 * t1372 * t200;
  t3029 = -t2973 / 0.4e1 + t2977 / 0.12e2 - t2842 / 0.4e1 + t2846 / 0.3e1 - 0.5e1 / 0.18e2 * t2850 + t2517 / 0.12e2 - 0.5e1 / 0.18e2 * t2521 + t2528 - 0.3e1 / 0.8e1 * t5 * t3009 * t26 * t73 - 0.3e1 / 0.4e1 * t5 * t1368 * t200 - t3018 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t605 * t506 - t2887 / 0.2e1 + t2893 / 0.3e1 - t2896 / 0.4e1 + t2567 / 0.6e1 - 0.5e1 / 0.18e2 * t2575 + t2578 / 0.12e2;
  t3030 = my_piecewise3(t1, 0, t3029);
  t3039 = t569 * t569;
  t3052 = my_piecewise5(t14, 0, t10, 0, t2925);
  t3056 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t2794 * t612 * t514 - 0.32e2 / 0.27e2 * t1312 * t208 * t569 - 0.8e1 / 0.27e2 * t1384 * t520 + 0.8e1 / 0.9e1 * t513 * t3039 + 0.8e1 / 0.9e1 * t565 * t1322 - 0.8e1 / 0.27e2 * t1231 * t617 * t514 + 0.8e1 / 0.9e1 * t513 * t1393 * t208 + 0.4e1 / 0.9e1 * t1389 * t520 + 0.4e1 / 0.3e1 * t84 * t3052);
  t3063 = t5 * t1397 * t141 * t123;
  t3067 = t5 * t621 * t411 * t123;
  t3076 = t5 * t1331 * t298;
  t3079 = t5 * t1335 * t298;
  t3090 = t5 * t529 * t718;
  t3093 = t5 * t533 * t718;
  t3095 = -0.3e1 / 0.8e1 * t5 * t3056 * t26 * t123 - t3063 / 0.4e1 + t3067 / 0.12e2 - t2938 / 0.4e1 + t2942 / 0.3e1 - 0.5e1 / 0.18e2 * t2946 - 0.3e1 / 0.4e1 * t5 * t1327 * t298 - t3076 / 0.2e1 + t3079 / 0.6e1 + t2824 / 0.12e2 - 0.5e1 / 0.18e2 * t2828 + t2833 - t2955 / 0.4e1 + t2958 / 0.3e1 - 0.5e1 / 0.18e2 * t2961 - 0.3e1 / 0.8e1 * t5 * t525 * t718 - t3090 / 0.4e1 + t3093 / 0.12e2;
  t3096 = my_piecewise3(t78, 0, t3095);
  tv4rho42 = 0.2e1 * t1311 + 0.2e1 * t1351 + 0.2e1 * t1383 + 0.2e1 * t1422 + t6 * (t3030 + t3096);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t3117 = my_piecewise5(t10, 0, t14, 0, t2871 + t2872);
  t3121 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2531 * t1427 * t132 - 0.8e1 / 0.9e1 * t1354 * t545 - 0.8e1 / 0.9e1 * t1268 * t600 * t132 + 0.4e1 / 0.3e1 * t1271 * t600 + 0.4e1 / 0.3e1 * t541 * t1363 + 0.4e1 / 0.9e1 * t385 * t1434 * t132 + 0.4e1 / 0.3e1 * t23 * t3117);
  t3128 = t5 * t1438 * t141 * t73;
  t3139 = -0.3e1 / 0.8e1 * t5 * t3121 * t26 * t73 - t3128 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1439 * t200 - 0.3e1 / 0.8e1 * t2973 + t2977 / 0.4e1 - 0.3e1 / 0.8e1 * t3018 + t2847 - 0.5e1 / 0.12e2 * t2850 + t2894 - 0.5e1 / 0.36e2 * t2521 + t2528 - 0.5e1 / 0.36e2 * t2575;
  t3140 = my_piecewise3(t1, 0, t3139);
  t3157 = my_piecewise5(t14, 0, t10, 0, -t2871 + t2925);
  t3161 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t2794 * t1447 * t208 - 0.8e1 / 0.9e1 * t1384 * t569 - 0.8e1 / 0.9e1 * t1312 * t617 * t208 + 0.4e1 / 0.3e1 * t1315 * t617 + 0.4e1 / 0.3e1 * t565 * t1393 + 0.4e1 / 0.9e1 * t513 * t1454 * t208 + 0.4e1 / 0.3e1 * t84 * t3157);
  t3168 = t5 * t1458 * t141 * t123;
  t3176 = t5 * t1402 * t298;
  t3185 = t5 * t578 * t718;
  t3195 = t5 * t216 * t1609;
  t3197 = -0.3e1 / 0.8e1 * t5 * t3161 * t26 * t123 - t3168 / 0.8e1 - 0.3e1 / 0.8e1 * t3063 + t3067 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1398 * t298 - 0.3e1 / 0.8e1 * t3176 + t2943 - 0.5e1 / 0.12e2 * t2946 - 0.3e1 / 0.4e1 * t3076 + t3079 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t574 * t718 - 0.3e1 / 0.8e1 * t3185 - 0.5e1 / 0.36e2 * t2828 + t2833 + t2959 - 0.5e1 / 0.12e2 * t2961 - 0.3e1 / 0.8e1 * t3090 + t3093 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t212 * t1609 - t3195 / 0.8e1;
  t3198 = my_piecewise3(t78, 0, t3197);
  tv4rho43 = 0.3e1 * t1383 + 0.3e1 * t1422 + t1446 + t1614 + t6 * (t3140 + t3198);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3203 = t595 * t595;
  t3208 = t600 * t600;
  t3215 = my_piecewise5(t10, 0, t14, 0, 0.24e2 * t1047 + 0.24e2 * t2545);
  t3219 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2531 * t3203 - 0.16e2 / 0.9e1 * t1354 * t600 + 0.4e1 / 0.3e1 * t385 * t3208 + 0.16e2 / 0.9e1 * t541 * t1434 + 0.4e1 / 0.3e1 * t23 * t3215);
  t3228 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t3219 * t26 * t73 - t3128 / 0.2e1 + t2977 / 0.2e1 - 0.5e1 / 0.9e1 * t2850 + t2528);
  t3230 = 0.1e1 / t91 / t287;
  t3235 = t1475 * t115;
  t3240 = t632 * t279;
  t3249 = t246 * t691;
  t3254 = t257 * t1501;
  t3261 = t93 * t1538;
  t3262 = t643 * t643;
  t3269 = t107 * t691 * t643 * t667;
  t3272 = t667 * t667;
  t3278 = t107 * t1500 * t1530;
  t3285 = sigma[2] * t3230;
  t3290 = 0.1e1 / t90 / t896;
  t3295 = 0.1e1 / t1914;
  t3300 = t707 * t287;
  t3302 = 0.1e1 / t91 / t3300;
  t3306 = 0.1e1 / t259 / t1524 / t258;
  t3310 = 0.364e4 / 0.81e2 * t42 * t94 * t369 * t98 + 0.5768e4 / 0.27e2 * t42 * t3285 * t260 - 0.18608e5 / 0.81e2 * t42 * t285 * t3290 * t663 + 0.448e4 / 0.27e2 * t42 * t705 * t3295 * t1526 - 0.128e4 / 0.27e2 * t42 * t1554 * t3302 * t3306;
  t3347 = t707 * t707;
  t3352 = t116 * t3306;
  t3366 = 0.24e2 * t107 * t1538 * t3262 + 0.6e1 * t107 * t279 * t3272 + 0.4928e4 / 0.27e2 * t1511 * t271 - 0.176e3 / 0.3e1 * t654 * t679 + 0.32e2 / 0.3e1 * t257 * t1576 - t107 * t115 * t3310 + 0.352e3 / 0.3e1 * t654 * t676 + 0.64e2 * t257 * t1565 - 0.64e2 * t3254 - 0.36e2 * t3269 + 0.8e1 * t3278 - 0.84e3 * t110 * t1023 * t117 + 0.46e5 / 0.81e2 * t706 * t3295 * t711 - 0.2176e4 / 0.9e1 * t1555 * t3302 * t1560 + 0.128e4 / 0.27e2 * params->beta * t1554 * sigma[2] / t90 / t3347 / rho[1] * t3352 - 0.9916e5 / 0.81e2 * t286 * t3290 * t291 + 0.20944e5 / 0.81e2 * t3285 * t102 + 0.288e3 * t1936 * t1545 + 0.144e3 * t1940 * t882 * t643 * t667;
  t3371 = t1931 * t1544;
  t3379 = 0.1e1 / t690 / t114;
  t3380 = t3379 * params->gamma;
  t3396 = t692 * t663 * t643;
  t3400 = t280 * t260 * t1530;
  t3404 = t280 * t663 * t667;
  t3414 = t1539 * t260 * t1495;
  t3422 = t280 * t1526 * t264;
  t3427 = -0.24e2 * t881 * t882 * t264 * t1530 + 0.96e2 * t1930 * t3371 - 0.72e3 * t682 * t694 - 0.384e3 * t275 * t1541 - 0.12e3 * t113 * t3380 * t98 * t3262 - 0.18e2 * t113 * t692 * t98 * t3272 + 0.24e3 * t682 * t702 - 0.32e2 * t275 * t1601 + 0.496e3 / 0.3e1 * t687 * t1593 + 0.64e2 * t710 * t3396 - 0.32e2 / 0.3e1 * t290 * t3400 - 0.64e2 / 0.3e1 * t710 * t3404 + 0.2e1 * t113 * t280 * t98 * t3310 - 0.496e3 * t687 * t1589 - 0.128e3 * t290 * t3414 - 0.27584e5 / 0.27e2 * t1548 * t698 + 0.7808e4 / 0.27e2 * t1551 * t1597 - 0.512e3 / 0.9e1 * t1559 * t3422 - 0.96e3 * t1579 * t282;
  t3432 = -0.41888e5 / 0.729e3 * t35 * t88 * t3230 * t102 - 0.9856e4 / 0.243e3 * t35 * t88 * t3235 * t264 - 0.704e3 / 0.27e2 * t35 * t88 * t3240 * t643 + 0.352e3 / 0.27e2 * t35 * t88 * t1480 * t667 - 0.128e3 / 0.9e1 * t35 * t88 * t3249 * t1495 + 0.128e3 / 0.9e1 * t744 * t3254 - 0.64e2 / 0.27e2 * t35 * t88 * t637 * t1530 - 0.16e2 / 0.3e1 * t35 * t88 * t3261 * t3262 + 0.8e1 * t744 * t3269 - 0.4e1 / 0.3e1 * t35 * t88 * t642 * t3272 - 0.16e2 / 0.9e1 * t744 * t3278 + 0.2e1 / 0.9e1 * t35 * t88 * t251 * t3310 - 0.2e1 / 0.9e1 * t56 * t34 * (t3366 + t3427);
  t3436 = t612 * t612;
  t3441 = t617 * t617;
  t3448 = my_piecewise5(t14, 0, t10, 0, -0.24e2 * t1047 + 0.24e2 * t2806);
  t3452 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t2794 * t3436 - 0.16e2 / 0.9e1 * t1384 * t617 + 0.4e1 / 0.3e1 * t513 * t3441 + 0.16e2 / 0.9e1 * t565 * t1454 + 0.4e1 / 0.3e1 * t84 * t3448);
  t3474 = -0.3e1 / 0.8e1 * t5 * t87 * t3432 - 0.3e1 / 0.8e1 * t5 * t3452 * t26 * t123 - 0.3e1 / 0.2e1 * t5 * t1459 * t298 - 0.9e1 / 0.4e1 * t5 * t622 * t718 - 0.3e1 / 0.2e1 * t5 * t240 * t1609 - 0.3e1 / 0.2e1 * t3185 - t3195 / 0.2e1 + t3067 / 0.2e1 + t3079 + t3093 / 0.2e1 - t3168 / 0.2e1 - 0.3e1 / 0.2e1 * t3176 - 0.5e1 / 0.9e1 * t2946 - 0.5e1 / 0.9e1 * t2961 + t2833;
  t3475 = my_piecewise3(t78, 0, t3474);
  tv4rho44 = 0.4e1 * t1446 + 0.4e1 * t1614 + t6 * (t3228 + t3475);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t3483 = t5 * t1060 * t340;
  t3489 = t5 * t1067 * t340;
  t3492 = t5 * t403 * t807;
  t3499 = 0.5e1 / 0.36e2 * t5 * t1079 * t340;
  t3501 = t5 * t412 * t807;
  t3504 = t5 * t142 * t1780;
  t3508 = t57 * t479 * t761 * t431;
  t3513 = t57 * t181 * t1686 * t166;
  t3517 = t57 * t1662 * t455;
  t3521 = t57 * t745 * t1145;
  t3528 = t442 * t746;
  t3531 = t159 * t1663;
  t3534 = t159 * t1667;
  t3564 = -0.14e3 / 0.27e2 * t42 * t310 * t1121 * t47 - 0.364e3 / 0.9e1 * t42 * t1090 * t162 + 0.166e4 / 0.27e2 * t42 * t1131 * t451 * sigma[0] - 0.488e3 / 0.9e1 * t42 * t1137 * t1141 * t187 + 0.16e3 / 0.9e1 * t42 * t1160 * t2660 * t493;
  t3567 = t159 * t1658;
  t3571 = t57 * t1183 * t317 * t1110;
  t3586 = 0.1232e4 / 0.27e2 * t1126 * t321 + 0.6e1 * t430 * t1189 - 0.88e2 / 0.3e1 * t442 * t770 + 0.8e1 * t159 * t1773 - t57 * t65 * t3564 + 0.48e2 * t3567 + 0.24e2 * t3571 - 0.32e2 * t3531 - 0.16e2 * t3534 + 0.6e1 * t3513 + 0.6e1 * t3517 + 0.2e1 * t3521 - 0.18e2 * t3508 + 0.176e3 / 0.3e1 * t3528 + 0.18e3 * t323 * t1193 * t67 + 0.8516e4 / 0.27e2 * t36 * t1131 * t193;
  t3587 = t57 * t479;
  t3588 = t785 * t455;
  t3589 = t3587 * t3588;
  t3607 = t182 * t162 * t1686;
  t3611 = t182 * t451 * t761;
  t3615 = t182 * t1141 * t317;
  t3635 = -0.18e2 * t3589 - 0.4652e4 / 0.27e2 * t188 * t1137 * t499 + 0.248e3 / 0.3e1 * t494 * t1160 * t1162 - 0.16e3 / 0.9e1 * t1157 / t38 / t2767 * t2772 + 0.248e3 / 0.3e1 * t475 * t1753 + 0.1952e4 / 0.27e2 * t1153 * t1757 - 0.8e1 * t192 * t3607 - 0.32e2 / 0.3e1 * t498 * t3611 - 0.128e3 / 0.9e1 * t1161 * t3615 + 0.2e1 * t63 * t182 * t47 * t3564 + t333 * t2710 + 0.4e1 * t800 * t2714 - 0.22e3 / 0.3e1 * t1701 * t1212 + 0.16e2 * t1707 * t2741 + 0.18e3 * t1695 * t184 - 0.36e2 * t772 * t490 + 0.3e1 * t324 * t1216;
  t3666 = -0.28e2 * t777 * t1208 - 0.24e2 * t177 * t1761 - 0.12e2 * t800 * t2706 + 0.12e3 * t470 * t794 - 0.6896e4 / 0.27e2 * t1150 * t790 + 0.676e3 / 0.3e1 * t1698 * t486 - 0.24e3 * t1194 * t328 + 0.84e2 * t777 * t1204 + 0.12e2 * t333 * t2725 + 0.108e3 * t772 * t482 + 0.36e2 * t324 * t1186 - 0.1232e4 / 0.27e2 * t1091 + 0.72e2 * t1730 * t784 * t3588 - 0.88e2 / 0.3e1 * t1096 + 0.8e1 * t1105 - t1146 - 0.6e1 * t1111;
  t3688 = t1725 * t1715;
  t3695 = t1725 * t1719;
  t3700 = t2072 * t785;
  t3708 = t60 * t62 * t2749;
  t3714 = t60 * t176 * t1183;
  t3722 = t188 * t191 * t1183;
  t3723 = t1725 * t1731;
  t3726 = -0.16e2 * t1101 - 0.36e3 * t60 * t469 * t479 * t786 + 0.144e3 * t1712 * t1716 + 0.72e2 * t1712 * t1720 - 0.248e3 * t188 * t448 * t479 * t1726 - 0.18e2 * t783 * t784 * t1686 * t166 - 0.18e2 * t783 * t784 * t761 * t455 + 0.48e2 * t1724 * t3688 - 0.6e1 * t783 * t784 * t317 * t1145 + 0.24e2 * t1724 * t3695 + 0.32e2 * t494 * t497 * t479 * t3700 - 0.9e1 * t2100 * t2697 - 0.27e2 * t2087 * t1190 - 0.12e3 * t3708 * t784 * t317 * t1110 - 0.288e3 * t3714 * t1732 + 0.72e2 * t1730 * t784 * t761 * t431 - 0.96e2 * t3722 * t3723;
  t3735 = params->beta * t420;
  t3739 = 0.4e1 * t744 * t3508 - 0.4e1 / 0.3e1 * t744 * t3513 - 0.4e1 / 0.3e1 * t744 * t3517 - 0.4e1 / 0.9e1 * t744 * t3521 - 0.2464e4 / 0.243e3 * t35 * t36 * t2589 * t317 - 0.352e3 / 0.27e2 * t744 * t3528 + 0.64e2 / 0.9e1 * t744 * t3531 + 0.32e2 / 0.9e1 * t744 * t3534 - 0.2e1 / 0.9e1 * t56 * t34 * (t3586 + t3635 + t3666 + t3726) + 0.2464e4 / 0.243e3 * t306 * t307 * t1091 + 0.176e3 / 0.27e2 * t35 * t3735 * t173;
  t3773 = -0.16e2 / 0.9e1 * t35 * t1636 * t467 + 0.2e1 / 0.9e1 * t35 * t735 * t1177 + 0.2e1 / 0.9e1 * t35 * t36 * t153 * t3564 + 0.32e2 / 0.9e1 * t35 * t1636 * t464 + 0.4e1 / 0.3e1 * t35 * t735 * t1167 - 0.4e1 / 0.3e1 * t35 * t735 * t1116 + 0.176e3 / 0.27e2 * t35 * t36 * t1095 * t761 - 0.16e2 / 0.9e1 * t35 * t36 * t425 * t1686 - 0.32e2 / 0.3e1 * t744 * t3567 - 0.16e2 / 0.3e1 * t744 * t3571 + 0.4e1 * t744 * t3589;
  t3779 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1056 * t340 - 0.3e1 / 0.8e1 * t3483 - 0.9e1 / 0.8e1 * t5 * t399 * t807 + t3489 / 0.4e1 - 0.3e1 / 0.4e1 * t3492 - 0.9e1 / 0.8e1 * t5 * t136 * t1780 - t3499 + t3501 / 0.4e1 - 0.3e1 / 0.8e1 * t3504 - 0.3e1 / 0.8e1 * t5 * t27 * (t3739 + t3773));
  tv4rho3sigma0 = t6 * t3779 + 0.3e1 * t1785;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t3786 = t5 * t1250 * t377;
  t3789 = t5 * t1254 * t377;
  t3793 = 0.5e1 / 0.36e2 * t5 * t1258 * t377;
  t3795 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t1246 * t377 - 0.3e1 / 0.8e1 * t3786 + t3789 / 0.4e1 - t3793);
  tv4rho3sigma2 = t6 * t3795 + 0.3e1 * t1798;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t3797 = 0.2e1 * t1812;
  t3803 = t5 * t1288 * t340 / 0.4e1;
  t3808 = t5 * t1295 * t340;
  t3812 = t5 * t554 * t807 / 0.4e1;
  t3821 = -0.3e1 / 0.8e1 * t5 * t1284 * t340 - t3803 - 0.3e1 / 0.4e1 * t5 * t550 * t807 + t3808 / 0.12e2 - t3812 - 0.3e1 / 0.8e1 * t5 * t229 * t1780 - t3483 / 0.8e1 + t3489 / 0.6e1 - t3492 / 0.4e1 - t3499 + t3501 / 0.6e1 - t3504 / 0.8e1;
  t3822 = my_piecewise3(t1, 0, t3821);
  tv4rho3sigma3 = t6 * t3822 + t1785 + t3797;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t3824 = 0.2e1 * t1828;
  t3830 = t5 * t1331 * t377 / 0.4e1;
  t3832 = t5 * t1335 * t377;
  t3841 = t5 * t529 * t905 / 0.4e1;
  t3843 = t5 * t533 * t905;
  t3846 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t1327 * t377 - t3830 + t3832 / 0.12e2 - t3786 / 0.8e1 + t3789 / 0.6e1 - t3793 - 0.3e1 / 0.8e1 * t5 * t525 * t905 - t3841 + t3843 / 0.12e2);
  tv4rho3sigma5 = t6 * t3846 + t1798 + t3824;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t3852 = t5 * t1372 * t340;
  t3861 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1368 * t340 - t3852 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t605 * t807 - t3803 + t3808 / 0.6e1 - t3812 + t3489 / 0.12e2 - t3499 + t3501 / 0.12e2);
  tv4rho3sigma6 = t6 * t3861 + t1836 + t3797;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t3867 = t5 * t1402 * t377;
  t3874 = t5 * t578 * t905;
  t3882 = t5 * t216 * t1994;
  t3884 = -0.3e1 / 0.8e1 * t5 * t1398 * t377 - t3867 / 0.8e1 - t3830 + t3832 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t574 * t905 - t3874 / 0.4e1 + t3789 / 0.12e2 - t3793 - t3841 + t3843 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t212 * t1994 - t3882 / 0.8e1;
  t3885 = my_piecewise3(t78, 0, t3884);
  tv4rho3sigma8 = t6 * t3885 + t1999 + t3824;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t3894 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1439 * t340 - 0.3e1 / 0.8e1 * t3852 + t3808 / 0.4e1 - t3499);
  tv4rho3sigma9 = t6 * t3894 + 0.3e1 * t1836;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t3934 = -0.14e3 / 0.27e2 * t42 * t347 * t1506 * t98 - 0.364e3 / 0.9e1 * t42 * t1475 * t260 + 0.166e4 / 0.27e2 * t42 * t1516 * t663 * sigma[2] - 0.488e3 / 0.9e1 * t42 * t1522 * t1526 * t285 + 0.16e3 / 0.9e1 * t42 * t1558 * t3306 * t705;
  t3953 = t107 * t843 * t1530;
  t3956 = t654 * t844;
  t3959 = t257 * t1877;
  t3962 = t257 * t1881;
  t3967 = t107 * t691 * t859 * t643;
  t3970 = -0.16e2 / 0.9e1 * t35 * t88 * t637 * t1900 + 0.2e1 / 0.9e1 * t35 * t88 * t251 * t3934 + 0.32e2 / 0.9e1 * t35 * t1850 * t676 + 0.4e1 / 0.3e1 * t35 * t835 * t1565 - 0.4e1 / 0.3e1 * t35 * t835 * t1501 + 0.176e3 / 0.27e2 * t35 * t88 * t1480 * t859 - 0.4e1 / 0.9e1 * t744 * t3953 - 0.352e3 / 0.27e2 * t744 * t3956 + 0.64e2 / 0.9e1 * t744 * t3959 + 0.32e2 / 0.9e1 * t744 * t3962 + 0.4e1 * t744 * t3967;
  t3973 = t107 * t279 * t1900 * t264;
  t3977 = t107 * t1876 * t667;
  t3984 = t107 * t691;
  t3985 = t1925 * t264;
  t3986 = t3984 * t3985;
  t4021 = t280 * t260 * t1900;
  t4024 = -0.18e2 * t3986 - 0.4652e4 / 0.27e2 * t286 * t1522 * t711 + 0.248e3 / 0.3e1 * t706 * t1558 * t1560 - 0.16e3 / 0.9e1 * t1555 / t90 / t3347 * t3352 - 0.1232e4 / 0.27e2 * t1476 + 0.248e3 / 0.3e1 * t687 * t1961 + 0.1952e4 / 0.27e2 * t1551 * t1965 - 0.28e2 * t875 * t1593 + 0.84e2 * t875 * t1589 + 0.12e2 * t370 * t3414 + 0.108e3 * t870 * t694 + 0.36e2 * t361 * t1541 - 0.24e3 * t1579 * t365 - 0.36e2 * t870 * t702 + 0.3e1 * t361 * t1601 - 0.8e1 * t290 * t4021;
  t4026 = t280 * t663 * t859;
  t4030 = t280 * t1526 * t354;
  t4069 = -0.32e2 / 0.3e1 * t710 * t4026 - 0.128e3 / 0.9e1 * t1559 * t4030 + 0.2e1 * t113 * t280 * t98 * t3934 + t370 * t3400 + 0.4e1 * t898 * t3404 + 0.18e3 * t1905 * t282 - 0.12e2 * t898 * t3396 + 0.12e3 * t682 * t892 - 0.6896e4 / 0.27e2 * t1548 * t888 + 0.676e3 / 0.3e1 * t1908 * t698 - 0.22e3 / 0.3e1 * t1911 * t1597 + 0.16e2 * t1917 * t3422 - 0.24e2 * t275 * t1969 + 0.72e2 * t1940 * t882 * t3985 + 0.72e2 * t1936 * t1926 - 0.248e3 * t286 * t660 * t691 * t1932 - 0.6e1 * t881 * t882 * t354 * t1530;
  t4071 = t1931 * t1925;
  t4076 = t2234 * t883;
  t4092 = t286 * t289 * t1538;
  t4093 = t1931 * t1941;
  t4104 = t1931 * t1945;
  t4114 = t110 * t274 * t1538;
  t4118 = t110 * t112 * t3379;
  t4127 = 0.24e2 * t1930 * t4071 + 0.32e2 * t706 * t709 * t691 * t4076 - 0.9e1 * t2258 * t3371 - 0.27e2 * t2266 * t1545 - 0.36e3 * t110 * t681 * t691 * t884 + 0.72e2 * t1940 * t882 * t859 * t643 - 0.96e2 * t4092 * t4093 - 0.18e2 * t881 * t882 * t1900 * t264 - 0.18e2 * t881 * t882 * t859 * t667 + 0.48e2 * t1930 * t4104 + 0.8e1 * t257 * t1987 - t107 * t115 * t3934 - 0.88e2 / 0.3e1 * t654 * t868 - 0.288e3 * t4114 * t1942 - 0.12e3 * t4118 * t882 * t354 * t1495 + 0.144e3 * t1936 * t1946 + 0.1232e4 / 0.27e2 * t1511 * t358;
  t4134 = t257 * t1872;
  t4139 = t107 * t1538 * t354 * t1495;
  t4153 = 0.6e1 * t642 * t1544 - 0.88e2 / 0.3e1 * t1481 + 0.8e1 * t1490 - t1531 - 0.6e1 * t1496 - 0.16e2 * t1486 + 0.48e2 * t4134 - 0.18e2 * t3967 + 0.24e2 * t4139 + 0.176e3 / 0.3e1 * t3956 - 0.32e2 * t3959 - 0.16e2 * t3962 + 0.6e1 * t3973 + 0.6e1 * t3977 + 0.2e1 * t3953 + 0.18e3 * t360 * t1578 * t117 + 0.8516e4 / 0.27e2 * t88 * t1516 * t291;
  t4159 = params->beta * t632;
  t4178 = -0.4e1 / 0.3e1 * t744 * t3973 - 0.4e1 / 0.3e1 * t744 * t3977 - 0.2464e4 / 0.243e3 * t35 * t88 * t3235 * t354 - 0.2e1 / 0.9e1 * t56 * t34 * (t4024 + t4069 + t4127 + t4153) + 0.176e3 / 0.27e2 * t35 * t4159 * t271 - 0.16e2 / 0.9e1 * t35 * t1850 * t679 + 0.2e1 / 0.9e1 * t35 * t835 * t1576 + 0.2464e4 / 0.243e3 * t306 * t307 * t1476 - 0.16e2 / 0.3e1 * t744 * t4139 + 0.4e1 * t744 * t3986 - 0.32e2 / 0.3e1 * t744 * t4134;
  t4184 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t1459 * t377 - 0.3e1 / 0.8e1 * t3867 - 0.9e1 / 0.8e1 * t5 * t622 * t905 + t3832 / 0.4e1 - 0.3e1 / 0.4e1 * t3874 - 0.9e1 / 0.8e1 * t5 * t240 * t1994 - t3793 + t3843 / 0.4e1 - 0.3e1 / 0.8e1 * t3882 - 0.3e1 / 0.8e1 * t5 * t87 * (t3970 + t4178));
  tv4rho3sigma11 = t6 * t4184 + 0.3e1 * t1999;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t4191 = t5 * t403 * t969;
  t4198 = t5 * t412 * t969 / 0.12e2;
  t4200 = t5 * t142 * t2144;
  t4229 = -0.7e1 / 0.9e1 * t42 * t920 * t437 * t47 + 0.7e1 / 0.9e1 * t42 * t924 * t420 * t162 - 0.11e2 * t42 * t1678 + 0.47e2 / 0.3e1 * t42 * t1682 * sigma[0] - 0.2e2 / 0.3e1 * t42 * t1706 * t2660 * t187;
  t4241 = t57 * t2020 * t455;
  t4244 = t761 * t761;
  t4250 = t57 * t745 * t1686;
  t4257 = t159 * t2034;
  t4260 = -0.16e2 / 0.9e1 * t35 * t735 * t1663 - 0.8e1 / 0.9e1 * t35 * t735 * t1667 - 0.32e2 / 0.27e2 * t35 * t36 * t425 * t2051 + 0.2e1 / 0.9e1 * t35 * t36 * t153 * t4229 + 0.352e3 / 0.81e2 * t35 * t3735 * t321 + 0.128e3 / 0.27e2 * t35 * t1636 * t746 + 0.4e1 / 0.3e1 * t744 * t4241 - 0.8e1 / 0.9e1 * t35 * t36 * t430 * t4244 - 0.8e1 / 0.9e1 * t744 * t4250 + 0.176e3 / 0.81e2 * t35 * t36 * t1095 * t931 + 0.64e2 / 0.27e2 * t744 * t4257;
  t4263 = t57 * t181 * t2051 * t166;
  t4267 = t57 * t2033 * t455;
  t4277 = t159 * t2021;
  t4280 = t159 * t2025;
  t4309 = t182 * t162 * t2051;
  t4313 = t182 * t451 * t931;
  t4329 = t480 * t451 * t915;
  t4332 = -0.9e1 / 0.2e1 * t943 * t482 - 0.12e2 * t63 * t480 * t47 * t4244 + 0.4e2 * t470 * t958 - 0.16e2 * t177 * t2108 + 0.248e3 / 0.9e1 * t475 * t2112 + 0.44e2 / 0.3e1 * t36 * t799 * t1212 + 0.3e1 / 0.2e1 * t962 * t2706 + 0.12e3 * t1695 * t328 - 0.12e3 * t470 * t952 + 0.2e1 * t63 * t182 * t47 * t4229 - 0.16e2 / 0.3e1 * t192 * t4309 - 0.32e2 / 0.9e1 * t498 * t4313 + 0.32e2 / 0.3e1 * t1707 * t3615 - 0.12e2 * t2080 * t184 + 0.3e1 / 0.2e1 * t943 * t490 + 0.6e1 * t324 * t1761 - 0.112e3 / 0.3e1 * t777 * t1753 - 0.44e3 / 0.9e1 * t1701 * t1757 + 0.32e2 / 0.3e1 * t498 * t4329;
  t4347 = t785 * t761;
  t4365 = t36 * t332 * t1183;
  t4372 = t323 * t1729;
  t4379 = t1725 * t2090;
  t4386 = t1725 * t2094;
  t4389 = 0.2e1 * t333 * t3607 + 0.16e2 / 0.3e1 * t800 * t3611 - t962 * t2714 / 0.2e1 - 0.4e1 * t2078 * t2741 - 0.48e2 * t772 * t794 + 0.1352e4 / 0.9e1 * t1698 * t790 - 0.248e3 / 0.3e1 * t475 * t2130 + 0.96e2 * t1730 * t784 * t4347 - 0.18e2 * t2087 * t1720 + 0.112e3 * t36 * t1723 * t1726 - 0.192e3 * t3714 * t2091 + 0.96e2 * t1712 * t2095 - 0.12e3 * t3708 * t784 * t915 * t431 + 0.24e2 * t4365 * t3723 + 0.24e2 * t1730 * t784 * t931 * t431 + 0.72e2 * t4372 * t1732 + 0.24e2 * t1730 * t784 * t915 * t455 - 0.64e2 * t3722 * t4379 - 0.12e2 * t783 * t784 * t317 * t1686 + 0.32e2 * t1724 * t4386;
  t4409 = t1725 * t2103;
  t4417 = t3587 * t4347;
  t4419 = t2057 * t181;
  t4431 = params->gamma * t1141;
  t4441 = t948 * t479;
  t4448 = -0.12e2 * t2100 * t3688 - 0.6e1 * t2100 * t3695 - 0.16e2 * t188 * t799 * t479 * t3700 + 0.48e2 * t1712 * t2104 - 0.6e1 * t783 * t784 * t931 * t455 - 0.12e2 * t783 * t784 * t2051 * t166 + 0.16e2 * t1724 * t4409 + 0.144e3 * t323 * t1711 * t786 - 0.36e2 * t2087 * t1716 - 0.24e2 * t4417 - 0.92e2 / 0.3e1 * t4419 * t2084 + 0.389e3 / 0.9e1 * params->beta * t497 * t65 * t2073 + 0.5e1 / 0.2e1 * t2083 * t1725 * t455 - 0.79e2 / 0.3e1 * params->beta * t1706 * t65 * t4431 * t187 + 0.2e2 / 0.3e1 * t494 / t38 / t495 / t446 * t2772 - 0.15e2 / 0.2e1 * t4441 * t1725 * t431 + 0.4e1 * t4263 + 0.2e1 * t4267 - 0.64e2 / 0.3e1 * t4280;
  t4454 = t57 * t479 * t931 * t431;
  t4461 = t57 * t1183 * t915 * t431;
  t4489 = -0.6e1 * t4241 + 0.4e1 * t4250 - 0.32e2 / 0.3e1 * t4257 - 0.6e1 * t4454 - 0.473e3 / 0.9e1 * params->beta * t448 * t193 + 0.24e2 * t4461 + 0.32e2 * t4277 + 0.176e3 / 0.9e1 * t442 * t937 + 0.4e1 * t57 * t181 * t4244 - 0.88e2 / 0.9e1 * t442 * t940 - 0.12e2 * t1109 * t1731 + 0.16e2 / 0.3e1 * t159 * t2068 + 0.8e1 * t430 * t1715 - 0.64e2 / 0.3e1 * t1100 * t785 + 0.4e1 * t430 * t1719 - t57 * t65 * t4229 - 0.2e1 * t1687 + 0.32e2 / 0.3e1 * t1653 - 0.176e3 / 0.9e1 * t1646 - 0.15e2 * t942 * t469 * t67;
  t4507 = -0.8e1 / 0.9e1 * t744 * t4263 - 0.4e1 / 0.9e1 * t744 * t4267 + 0.8e1 / 0.3e1 * t35 * t735 * t1658 - 0.352e3 / 0.81e2 * t35 * t36 * t2594 * t915 - 0.64e2 / 0.9e1 * t744 * t4277 + 0.128e3 / 0.27e2 * t744 * t4280 - 0.2e1 / 0.9e1 * t56 * t34 * (t4332 + t4389 + t4448 + t4489) - 0.64e2 / 0.27e2 * t35 * t1636 * t770 + 0.4e1 / 0.9e1 * t35 * t735 * t1773 + 0.4e1 / 0.3e1 * t744 * t4454 - 0.16e2 / 0.3e1 * t744 * t4461 + 0.16e2 / 0.3e1 * t744 * t4417;
  t4513 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t399 * t969 - t4191 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t136 * t2144 + t4198 - t4200 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t4260 + t4507));
  tv4rho2sigma20 = t6 * t4513 + 0.2e1 * t2149;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t4520 = t5 * t529 * t1031;
  t4524 = t5 * t533 * t1031 / 0.12e2;
  t4526 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t525 * t1031 - t4520 / 0.4e1 + t4524);
  tv4rho2sigma25 = t6 * t4526 + 0.2e1 * t2158;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t4532 = t5 * t554 * t969;
  t4540 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t550 * t969 - t4532 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t229 * t2144 - t4191 / 0.8e1 + t4198 - t4200 / 0.8e1);
  tv4rho2sigma26 = t6 * t4540 + t2149 + t2164;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t4546 = t5 * t578 * t1031;
  t4553 = t5 * t216 * t2306;
  t4556 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t574 * t1031 - t4546 / 0.8e1 - t4520 / 0.8e1 + t4524 - 0.3e1 / 0.8e1 * t5 * t212 * t2306 - t4553 / 0.8e1);
  tv4rho2sigma211 = t6 * t4556 + t2158 + t2311;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t4564 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t605 * t969 - t4532 / 0.4e1 + t4198);
  tv4rho2sigma212 = t6 * t4564 + 0.2e1 * t2164;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t4596 = t692 * t663 * t977;
  t4620 = -0.7e1 / 0.9e1 * t42 * t982 * t649 * t98 + 0.7e1 / 0.9e1 * t42 * t986 * t632 * t260 - 0.11e2 * t42 * t1892 + 0.47e2 / 0.3e1 * t42 * t1896 * sigma[2] - 0.2e2 / 0.3e1 * t42 * t1916 * t3306 * t285;
  t4626 = t280 * t260 * t2213;
  t4630 = t280 * t663 * t993;
  t4639 = -0.44e3 / 0.9e1 * t1911 * t1965 - 0.16e2 * t275 * t2286 + 0.248e3 / 0.9e1 * t687 * t2290 + 0.3e1 / 0.2e1 * t1024 * t3396 - 0.9e1 / 0.2e1 * t1005 * t694 - 0.48e2 * t870 * t892 + 0.1352e4 / 0.9e1 * t1908 * t888 - 0.248e3 / 0.3e1 * t687 * t2272 - 0.112e3 / 0.3e1 * t875 * t1961 + 0.6e1 * t361 * t1969 + 0.32e2 / 0.3e1 * t710 * t4596 + 0.16e2 / 0.3e1 * t898 * t4026 + 0.32e2 / 0.3e1 * t1917 * t4030 + 0.2e1 * t113 * t280 * t98 * t4620 - 0.16e2 / 0.3e1 * t290 * t4626 - 0.32e2 / 0.9e1 * t710 * t4630 - t1024 * t3404 / 0.2e1 - 0.12e2 * t2242 * t282 + 0.3e1 / 0.2e1 * t1005 * t702;
  t4640 = t2232 * t279;
  t4655 = t859 * t859;
  t4660 = t257 * t2183;
  t4662 = t257 * t2187;
  t4665 = t107 * t843 * t1900;
  t4667 = t257 * t2196;
  t4671 = t107 * t279 * t2213 * t264;
  t4674 = t107 * t2195 * t667;
  t4681 = t107 * t1538 * t977 * t643;
  t4685 = t107 * t691 * t993 * t643;
  t4688 = t107 * t2182 * t667;
  t4690 = t883 * t859;
  t4697 = t2221 * t279;
  t4700 = 0.44e2 / 0.3e1 * t4640 * t2234 * t264 * sigma[2] - 0.4e1 * t2240 * t3422 + 0.2e1 * t370 * t4021 + 0.4e2 * t682 * t1020 + 0.12e3 * t1905 * t365 - 0.12e3 * t682 * t1014 - 0.12e2 * t113 * t692 * t98 * t4655 + 0.32e2 * t4660 - 0.64e2 / 0.3e1 * t4662 + 0.4e1 * t4665 - 0.32e2 / 0.3e1 * t4667 + 0.4e1 * t4671 + 0.2e1 * t4674 - 0.473e3 / 0.9e1 * params->beta * t660 * t291 + 0.24e2 * t4681 - 0.6e1 * t4685 - 0.6e1 * t4688 + 0.96e2 * t1940 * t882 * t4690 - 0.15e2 * t1004 * t681 * t117 - 0.92e2 / 0.3e1 * t4697 * t2246;
  t4702 = t1010 * t691;
  t4715 = params->gamma * t1526;
  t4725 = t3984 * t4690;
  t4750 = t360 * t1939;
  t4758 = t88 * t369 * t1538;
  t4761 = -0.15e2 / 0.2e1 * t4702 * t1931 * t643 + 0.389e3 / 0.9e1 * params->beta * t709 * t115 * t2235 + 0.5e1 / 0.2e1 * t2245 * t1931 * t667 - 0.79e2 / 0.3e1 * params->beta * t1916 * t115 * t4715 * t285 + 0.2e2 / 0.3e1 * t706 / t90 / t707 / t658 * t3352 - 0.24e2 * t4725 - 0.64e2 / 0.3e1 * t1485 * t883 + 0.4e1 * t642 * t1925 - t107 * t115 * t4620 + 0.16e2 / 0.3e1 * t257 * t2226 + 0.8e1 * t642 * t1945 + 0.4e1 * t107 * t279 * t4655 - 0.88e2 / 0.9e1 * t654 * t1002 - 0.12e2 * t1494 * t1941 + 0.176e3 / 0.9e1 * t654 * t999 + 0.24e2 * t1940 * t882 * t993 * t643 + 0.72e2 * t4750 * t1942 - 0.12e3 * t4118 * t882 * t977 * t643 + 0.24e2 * t4758 * t4093;
  t4793 = t1931 * t2262;
  t4801 = t1931 * t2249;
  t4804 = t1931 * t2253;
  t4814 = 0.48e2 * t1936 * t2263 - 0.6e1 * t881 * t882 * t993 * t667 + 0.144e3 * t360 * t1935 * t884 - 0.18e2 * t2266 * t1926 - 0.192e3 * t4114 * t2250 + 0.96e2 * t1936 * t2254 + 0.24e2 * t1940 * t882 * t977 * t667 - 0.12e2 * t881 * t882 * t354 * t1900 - 0.16e2 * t286 * t897 * t691 * t4076 - 0.12e2 * t881 * t882 * t2213 * t264 + 0.16e2 * t1930 * t4793 - 0.36e2 * t2266 * t1946 + 0.112e3 * t88 * t1929 * t1932 - 0.64e2 * t4092 * t4801 + 0.32e2 * t1930 * t4804 - 0.12e2 * t2258 * t4104 - 0.6e1 * t2258 * t4071 - 0.2e1 * t1901 + 0.32e2 / 0.3e1 * t1867 - 0.176e3 / 0.9e1 * t1860;
  t4850 = -0.2e1 / 0.9e1 * t56 * t34 * (t4639 + t4700 + t4761 + t4814) - 0.64e2 / 0.27e2 * t35 * t1850 * t868 + 0.4e1 / 0.9e1 * t35 * t835 * t1987 + 0.2e1 / 0.9e1 * t35 * t88 * t251 * t4620 + 0.352e3 / 0.81e2 * t35 * t4159 * t358 + 0.128e3 / 0.27e2 * t35 * t1850 * t844 - 0.16e2 / 0.9e1 * t35 * t835 * t1877 - 0.8e1 / 0.9e1 * t35 * t835 * t1881 - 0.32e2 / 0.27e2 * t35 * t88 * t637 * t2213 + 0.128e3 / 0.27e2 * t744 * t4662 + 0.4e1 / 0.3e1 * t744 * t4688;
  t4882 = -0.8e1 / 0.9e1 * t35 * t88 * t642 * t4655 - 0.8e1 / 0.9e1 * t744 * t4665 + 0.176e3 / 0.81e2 * t35 * t88 * t1480 * t993 + 0.64e2 / 0.27e2 * t744 * t4667 - 0.8e1 / 0.9e1 * t744 * t4671 - 0.4e1 / 0.9e1 * t744 * t4674 + 0.8e1 / 0.3e1 * t35 * t835 * t1872 - 0.352e3 / 0.81e2 * t35 * t88 * t3240 * t977 - 0.64e2 / 0.9e1 * t744 * t4660 + 0.4e1 / 0.3e1 * t744 * t4685 - 0.16e2 / 0.3e1 * t744 * t4681 + 0.16e2 / 0.3e1 * t744 * t4725;
  t4888 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t622 * t1031 - t4546 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t240 * t2306 + t4524 - t4553 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * (t4850 + t4882));
  tv4rho2sigma217 = t6 * t4888 + 0.2e1 * t2311;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t4895 = t5 * t142 * t2406 / 0.8e1;
  t4920 = t57 * t1183 * t2319 * t166;
  t4924 = t57 * t2020 * t761;
  t4927 = t159 * t2324;
  t4930 = t2392 * t166;
  t4931 = t3587 * t4930;
  t4935 = t57 * t1662 * t931;
  t4939 = t57 * t745 * t2051;
  t4948 = t57 * t181 * t2346 * t166;
  t4969 = -t42 * t2329 * t155 * t47 / 0.2e1 + t42 * t2334 * t148 * t162 / 0.2e1 + t42 * t924 * t191 * t451 / 0.6e1 - 0.7e1 / 0.2e1 * t42 * t2048 + 0.5e1 / 0.2e1 * t42 * t2077 * t2660 * sigma[0];
  t4993 = t1184 * t162 * t2319;
  t5000 = 0.2e1 * t4948 - 0.15e2 / 0.2e1 * t2070 * t499 + 0.24e2 * t4920 - 0.18e2 * t4924 + 0.6e1 * t4935 + 0.6e1 * t4939 - 0.16e2 * t4927 + 0.9e1 * t324 * t2108 - 0.28e2 * t777 * t2112 - 0.12e2 * t800 * t4329 + 0.3e1 * t333 * t4309 + 0.4e1 * t800 * t4313 - 0.32e2 * t192 * t4993 - 0.3e1 / 0.2e1 * t962 * t3611 - 0.6e1 * t2078 * t3615;
  t5015 = t182 * t162 * t2346;
  t5042 = 0.3e1 / 0.4e1 * t2352 * t486 - 0.45e2 / 0.2e1 * t4441 * t1726 + 0.22e2 * t2070 * t181 * t2072 * t317 * sigma[0] + 0.2e1 * t63 * t182 * t47 * t4969 - 0.8e1 / 0.3e1 * t192 * t5015 + 0.3e1 / 0.4e1 * t2367 * t2741 - 0.3e1 / 0.4e1 * t2371 * t184 + 0.9e1 / 0.2e1 * t943 * t794 - 0.96e2 * t177 * t2389 - 0.8e1 * t177 * t2362 - 0.18e2 * t2080 * t328 - 0.36e2 * t772 * t958 + 0.84e2 * t777 * t2130 + 0.108e3 * t772 * t952 - 0.3e1 / 0.2e1 * t2370 * t176 * t67 + 0.3e1 / 0.2e1 * t2351 * t191 * t193;
  t5050 = t2358 * t181;
  t5085 = -0.46e2 * t4419 * t2355 - 0.18e2 * t4931 + 0.15e2 / 0.2e1 * t2083 * t1725 * t761 - 0.7e1 / 0.4e1 * t5050 * t2072 * t166 + 0.15e2 / 0.2e1 * params->beta * t2077 * t65 * t4431 * sigma[0] - 0.5e1 / 0.2e1 * t188 / t38 / t2654 * t2772 + 0.72e2 * t1730 * t784 * t4930 + 0.6e1 * t430 * t2103 - t57 * t65 * t4969 - 0.18e2 * t1109 * t2090 + 0.12e2 * t430 * t2094 + 0.16e2 * t159 * t2382 + 0.8e1 / 0.3e1 * t159 * t2399 + 0.72e2 * t1712 * t2393 - 0.12e3 * t3708 * t784 * t2319 * t166;
  t5098 = t1725 * t2392;
  t5127 = 0.72e2 * t1730 * t784 * t915 * t761 - 0.18e2 * t783 * t784 * t761 * t931 - 0.18e2 * t783 * t784 * t317 * t2051 + 0.24e2 * t1724 * t5098 + 0.9e1 / 0.2e1 * t36 * t961 * t479 * t3700 - 0.6e1 * t783 * t784 * t2346 * t166 - 0.27e2 / 0.2e1 * t942 * t782 * t786 - 0.27e2 * t2087 * t2104 + 0.36e2 * t4365 * t4379 - 0.18e2 * t2100 * t4386 - 0.9e1 * t2100 * t4409 + 0.108e3 * t4372 * t2091 - 0.54e2 * t2087 * t2095 - 0.3e1 * t2052 + 0.8e1 * t2029 - 0.16e2 * t2016;
  t5133 = 0.32e2 / 0.9e1 * t35 * t1636 * t937 + 0.4e1 * t35 * t735 * t2021 - 0.8e1 / 0.3e1 * t35 * t735 * t2025 - 0.16e2 / 0.9e1 * t35 * t1636 * t940 - 0.4e1 / 0.3e1 * t35 * t735 * t2034 + 0.2e1 / 0.3e1 * t35 * t735 * t2068 - 0.32e2 / 0.9e1 * t35 * t36 * t2603 * t2319 - 0.16e2 / 0.3e1 * t744 * t4920 + 0.4e1 * t744 * t4924 + 0.32e2 / 0.9e1 * t744 * t4927 + 0.4e1 * t744 * t4931 - 0.4e1 / 0.3e1 * t744 * t4935 - 0.4e1 / 0.3e1 * t744 * t4939 - 0.16e2 / 0.27e2 * t35 * t36 * t425 * t2346 - 0.4e1 / 0.9e1 * t744 * t4948 + 0.2e1 / 0.9e1 * t35 * t36 * t153 * t4969 - 0.2e1 / 0.9e1 * t56 * t34 * (t5000 + t5042 + t5085 + t5127);
  t5138 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t136 * t2406 - t4895 - 0.3e1 / 0.8e1 * t5 * t27 * t5133);
  tv4rhosigma30 = t6 * t5138 + t2410;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t5145 = t5 * t216 * t2504 / 0.8e1;
  t5147 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t212 * t2504 - t5145);
  tv4rhosigma39 = t6 * t5147 + t2508;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t5153 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t2406 - t4895);
  tv4rhosigma310 = t6 * t5153 + t2410;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t5182 = t107 * t1538 * t2417 * t264;
  t5186 = t107 * t2182 * t859;
  t5189 = t257 * t2422;
  t5192 = t2488 * t264;
  t5193 = t3984 * t5192;
  t5197 = t107 * t1876 * t993;
  t5201 = t107 * t843 * t2213;
  t5210 = t107 * t279 * t2444 * t264;
  t5231 = -t42 * t2427 * t253 * t98 / 0.2e1 + t42 * t2432 * t246 * t260 / 0.2e1 + t42 * t986 * t289 * t663 / 0.6e1 - 0.7e1 / 0.2e1 * t42 * t2210 + 0.5e1 / 0.2e1 * t42 * t2239 * t3306 * sigma[2];
  t5256 = t2456 * t279;
  t5270 = 0.24e2 * t5182 - 0.18e2 * t5186 + 0.6e1 * t5197 + 0.6e1 * t5201 + 0.2e1 * t5210 - 0.16e2 * t5189 - 0.15e2 / 0.2e1 * t2232 * t711 - 0.3e1 / 0.2e1 * t2468 * t274 * t117 + 0.3e1 / 0.2e1 * t2449 * t289 * t291 - 0.46e2 * t4697 * t2453 - 0.18e2 * t5193 + 0.15e2 / 0.2e1 * t2245 * t1931 * t859 - 0.7e1 / 0.4e1 * t5256 * t2234 * t264 + 0.15e2 / 0.2e1 * params->beta * t2239 * t115 * t4715 * sigma[2] - 0.5e1 / 0.2e1 * t286 / t90 / t3300 * t3352;
  t5307 = 0.6e1 * t642 * t2262 - 0.18e2 * t1494 * t2249 + 0.12e2 * t642 * t2253 - t107 * t115 * t5231 + 0.8e1 / 0.3e1 * t257 * t2498 + 0.16e2 * t257 * t2480 + 0.72e2 * t1940 * t882 * t5192 - 0.6e1 * t881 * t882 * t2444 * t264 + 0.72e2 * t1936 * t2489 + 0.108e3 * t4750 * t2250 - 0.54e2 * t2266 * t2254 - 0.27e2 / 0.2e1 * t1004 * t880 * t884 - 0.27e2 * t2266 * t2263 + 0.36e2 * t4758 * t4801 - 0.18e2 * t2258 * t4804 - 0.9e1 * t2258 * t4793;
  t5325 = t1931 * t2488;
  t5347 = -0.12e3 * t4118 * t882 * t2417 * t264 + 0.72e2 * t1940 * t882 * t977 * t859 - 0.18e2 * t881 * t882 * t859 * t993 - 0.18e2 * t881 * t882 * t354 * t2213 + 0.24e2 * t1930 * t5325 + 0.9e1 / 0.2e1 * t88 * t1023 * t691 * t4076 + 0.108e3 * t870 * t1014 - 0.18e2 * t2242 * t365 - 0.36e2 * t870 * t1020 - 0.3e1 * t2214 + 0.8e1 * t2191 - 0.16e2 * t2178 + 0.84e2 * t875 * t2272 - 0.96e2 * t275 * t2485 - 0.8e1 * t275 * t2460;
  t5359 = t1539 * t260 * t2417;
  t5379 = t280 * t260 * t2444;
  t5388 = 0.9e1 * t361 * t2286 - 0.28e2 * t875 * t2290 - 0.12e2 * t898 * t4596 + 0.3e1 * t370 * t4626 + 0.4e1 * t898 * t4630 - 0.32e2 * t290 * t5359 - 0.3e1 / 0.2e1 * t1024 * t4026 - 0.6e1 * t2240 * t4030 + 0.3e1 / 0.4e1 * t2450 * t698 - 0.45e2 / 0.2e1 * t4702 * t1932 + 0.22e2 * t4640 * t2234 * t354 * sigma[2] + 0.2e1 * t113 * t280 * t98 * t5231 - 0.8e1 / 0.3e1 * t290 * t5379 + 0.3e1 / 0.4e1 * t2465 * t3422 - 0.3e1 / 0.4e1 * t2469 * t282 + 0.9e1 / 0.2e1 * t1005 * t892;
  t5394 = 0.32e2 / 0.9e1 * t35 * t1850 * t999 + 0.4e1 * t35 * t835 * t2183 - 0.8e1 / 0.3e1 * t35 * t835 * t2187 - 0.16e2 / 0.9e1 * t35 * t1850 * t1002 - 0.4e1 / 0.3e1 * t35 * t835 * t2196 + 0.2e1 / 0.3e1 * t35 * t835 * t2226 - 0.32e2 / 0.9e1 * t35 * t88 * t3249 * t2417 - 0.16e2 / 0.3e1 * t744 * t5182 + 0.4e1 * t744 * t5186 + 0.32e2 / 0.9e1 * t744 * t5189 + 0.4e1 * t744 * t5193 - 0.4e1 / 0.3e1 * t744 * t5197 - 0.4e1 / 0.3e1 * t744 * t5201 - 0.16e2 / 0.27e2 * t35 * t88 * t637 * t2444 - 0.4e1 / 0.9e1 * t744 * t5210 + 0.2e1 / 0.9e1 * t35 * t88 * t251 * t5231 - 0.2e1 / 0.9e1 * t56 * t34 * (t5270 + t5307 + t5347 + t5388);
  t5399 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t240 * t2504 - t5145 - 0.3e1 / 0.8e1 * t5 * t87 * t5394);
  tv4rhosigma319 = t6 * t5399 + t2508;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t5410 = t915 * t915;
  t5416 = t57 * t2020 * t931;
  t5419 = t931 * t931;
  t5425 = t57 * t745 * t2346;
  t5450 = -0.15e2 / 0.16e2 * t42 / t43 / t493 * t45 * t47 + 0.15e2 / 0.16e2 * t42 / t493 * t41 * t162 + 0.5e1 / 0.16e2 * t42 * t2334 * t332 * t451 + 0.3e1 / 0.16e2 * t42 * t924 * t961 * t1141 - 0.15e2 / 0.16e2 * t42 * t2366 * t2660;
  t5503 = 0.8e1 * t5425 - 0.27e2 / 0.16e2 * params->beta * t2366 * t1162 - 0.36e2 * t5416 + 0.15e2 / 0.16e2 * t36 / t38 / t1158 * t2772 - 0.9e1 / 0.16e2 * params->beta * t2329 * t62 * t67 + 0.9e1 / 0.16e2 * params->beta * t2334 * t332 * t193 + 0.3e1 / 0.16e2 * t2351 * t961 * t499 - 0.45e2 * t4441 * t1725 * t915 - 0.7e1 * t5050 * t2072 * t317 + 0.15e2 * t2083 * t1725 * t931 - t57 * t65 * t5450 + 0.24e2 * t57 * t1183 * t5410 + 0.24e2 * t430 * t2392 + 0.6e1 * t57 * t181 * t5419 - 0.24e2 * t783 * t784 * t2346 * t317 - 0.108e3 * t2087 * t2393 - 0.36e2 * t2100 * t5098;
  t5544 = 0.144e3 * t1730 * t784 * t915 * t931 - 0.4e1 * t2347 - 0.24e2 * t2320 + 0.48e2 * t333 * t4993 + 0.9e1 * t962 * t4329 - 0.3e1 * t962 * t4313 + 0.144e3 * t324 * t2389 - 0.12e3 * t63 * t2750 * t47 * t5410 - 0.18e2 * t63 * t480 * t47 * t5419 + 0.12e2 * t324 * t2362 - 0.27e2 * t943 * t952 + 0.3e1 * t2352 * t790 + 0.2e1 * t63 * t182 * t47 * t5450 + 0.4e1 * t333 * t5015 + 0.3e1 * t2367 * t3615 - 0.3e1 * t2371 * t328 + 0.9e1 * t943 * t958;
  t5553 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (0.16e2 / 0.3e1 * t35 * t735 * t2382 - 0.16e2 / 0.3e1 * t35 * t735 * t2324 + 0.8e1 / 0.9e1 * t35 * t735 * t2399 - 0.16e2 / 0.3e1 * t35 * t36 * t2615 * t5410 + 0.8e1 * t744 * t5416 - 0.4e1 / 0.3e1 * t35 * t36 * t430 * t5419 - 0.16e2 / 0.9e1 * t744 * t5425 + 0.2e1 / 0.9e1 * t35 * t36 * t153 * t5450 - 0.2e1 / 0.9e1 * t56 * t34 * (t5503 + t5544)));
  tv4sigma40 = t6 * t5553;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t5563 = t977 * t977;
  t5569 = t107 * t2182 * t993;
  t5572 = t993 * t993;
  t5578 = t107 * t843 * t2444;
  t5603 = -0.15e2 / 0.16e2 * t42 / t94 / t705 * t96 * t98 + 0.15e2 / 0.16e2 * t42 / t705 * t93 * t260 + 0.5e1 / 0.16e2 * t42 * t2432 * t369 * t663 + 0.3e1 / 0.16e2 * t42 * t986 * t1023 * t1526 - 0.15e2 / 0.16e2 * t42 * t2464 * t3306;
  t5656 = -0.27e2 / 0.16e2 * params->beta * t2464 * t1560 - 0.36e2 * t5569 + 0.8e1 * t5578 + 0.15e2 * t2245 * t1931 * t993 + 0.15e2 / 0.16e2 * t88 / t90 / t1556 * t3352 - 0.9e1 / 0.16e2 * params->beta * t2427 * t112 * t117 + 0.9e1 / 0.16e2 * params->beta * t2432 * t369 * t291 + 0.3e1 / 0.16e2 * t2449 * t1023 * t711 - 0.45e2 * t4702 * t1931 * t977 - 0.7e1 * t5256 * t2234 * t354 + 0.24e2 * t107 * t1538 * t5563 + 0.24e2 * t642 * t2488 + 0.6e1 * t107 * t279 * t5572 - t107 * t115 * t5603 - 0.24e2 * t881 * t882 * t2444 * t354 - 0.108e3 * t2266 * t2489 - 0.36e2 * t2258 * t5325;
  t5697 = 0.144e3 * t1940 * t882 * t977 * t993 - 0.24e2 * t2418 - 0.4e1 * t2445 + 0.12e2 * t361 * t2460 - 0.27e2 * t1005 * t1014 + 0.48e2 * t370 * t5359 + 0.9e1 * t1024 * t4596 - 0.3e1 * t1024 * t4630 + 0.144e3 * t361 * t2485 - 0.12e3 * t113 * t3380 * t98 * t5563 - 0.18e2 * t113 * t692 * t98 * t5572 + 0.2e1 * t113 * t280 * t98 * t5603 + 0.4e1 * t370 * t5379 + 0.3e1 * t2465 * t4030 - 0.3e1 * t2469 * t365 + 0.9e1 * t1005 * t1020 + 0.3e1 * t2450 * t888;
  t5706 = my_piecewise3(t78, 0, -0.3e1 / 0.8e1 * t5 * t87 * (0.16e2 / 0.3e1 * t35 * t835 * t2480 - 0.16e2 / 0.3e1 * t35 * t835 * t2422 + 0.8e1 / 0.9e1 * t35 * t835 * t2498 - 0.16e2 / 0.3e1 * t35 * t88 * t3261 * t5563 + 0.8e1 * t744 * t5569 - 0.4e1 / 0.3e1 * t35 * t88 * t642 * t5572 - 0.16e2 / 0.9e1 * t744 * t5578 + 0.2e1 / 0.9e1 * t35 * t88 * t251 * t5603 - 0.2e1 / 0.9e1 * t56 * t34 * (t5656 + t5697)));
  tv4sigma414 = t6 * t5706;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

