/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_c_op_xalpha.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t4, t5, t6, t7, t8, t9, t10;
  double t11, t14, t15, t16, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t35, t39, t40, t41, t42, t43, t48, t49;
  double t50, t51, t54, t55, t56, t57, t59, t60;
  double t62, t64, t65, tzk0;


  t1 = 0.1e1 <= p->zeta_threshold;
  t4 = t1 || rho[0] / 0.2e1 <= p->dens_threshold;
  t5 = p->zeta_threshold - 0.1e1;
  t6 = -t5;
  t7 = my_piecewise5(t1, t5, t1, t6, 0);
  t8 = t7 * t7;
  t9 = 0.1e1 - t8;
  t10 = t9 * rho[0];
  t11 = 0.1e1 + t7;
  t14 = t11 * rho[0] / 0.2e1 <= p->dens_threshold;
  t15 = M_CBRT3;
  t16 = t15 * t15;
  t18 = POW_1_3(0.1e1 / M_PI);
  t20 = t16 / t18;
  t21 = M_CBRT4;
  t22 = M_CBRT2;
  t23 = t21 * t22;
  t24 = t11 <= p->zeta_threshold;
  t25 = 0.1e1 - t7;
  t26 = t25 <= p->zeta_threshold;
  t27 = my_piecewise5(t24, t5, t26, t6, t7);
  t28 = 0.1e1 + t27;
  t29 = t28 * rho[0];
  t30 = POW_1_3(t29);
  t35 = my_piecewise3(t14, 0, t20 * t23 / t30 / 0.9e1);
  t39 = t25 * rho[0] / 0.2e1 <= p->dens_threshold;
  t40 = my_piecewise5(t26, t5, t24, t6, -t7);
  t41 = 0.1e1 + t40;
  t42 = t41 * rho[0];
  t43 = POW_1_3(t42);
  t48 = my_piecewise3(t39, 0, t20 * t23 / t43 / 0.9e1);
  t49 = t35 + t48;
  t50 = t49 == 0.e0;
  t51 = my_piecewise3(t50, DBL_EPSILON, t49);
  t54 = 0.390299956e1 / t51 + 0.5764e0;
  t55 = t51 * t51;
  t56 = t55 * t55;
  t57 = 0.1e1 / t56;
  t59 = t55 * t51;
  t60 = 0.1e1 / t59;
  t62 = 0.1e1 / t55;
  t64 = 0.433132090567376656e2 * t57 + 0.190514637481962976e2 * t60 + 0.2094820520028e1 * t62;
  t65 = 0.1e1 / t64;
  tzk0 = my_piecewise3(t4, 0, -0.25e0 * t10 * t54 * t65);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t4, t5, t6, t7, t8, t9, t10;
  double t11, t14, t15, t16, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t35, t39, t40, t41, t42, t43, t48, t49;
  double t50, t51, t54, t55, t56, t57, t59, t60;
  double t62, t64, t65, tzk0;

  double t69, t72, t79, t86, t88, t93, t94, t95;
  double t97, t98, t100, t104, t109, tvrho0, tvsigma0;


  t1 = 0.1e1 <= p->zeta_threshold;
  t4 = t1 || rho[0] / 0.2e1 <= p->dens_threshold;
  t5 = p->zeta_threshold - 0.1e1;
  t6 = -t5;
  t7 = my_piecewise5(t1, t5, t1, t6, 0);
  t8 = t7 * t7;
  t9 = 0.1e1 - t8;
  t10 = t9 * rho[0];
  t11 = 0.1e1 + t7;
  t14 = t11 * rho[0] / 0.2e1 <= p->dens_threshold;
  t15 = M_CBRT3;
  t16 = t15 * t15;
  t18 = POW_1_3(0.1e1 / M_PI);
  t20 = t16 / t18;
  t21 = M_CBRT4;
  t22 = M_CBRT2;
  t23 = t21 * t22;
  t24 = t11 <= p->zeta_threshold;
  t25 = 0.1e1 - t7;
  t26 = t25 <= p->zeta_threshold;
  t27 = my_piecewise5(t24, t5, t26, t6, t7);
  t28 = 0.1e1 + t27;
  t29 = t28 * rho[0];
  t30 = POW_1_3(t29);
  t35 = my_piecewise3(t14, 0, t20 * t23 / t30 / 0.9e1);
  t39 = t25 * rho[0] / 0.2e1 <= p->dens_threshold;
  t40 = my_piecewise5(t26, t5, t24, t6, -t7);
  t41 = 0.1e1 + t40;
  t42 = t41 * rho[0];
  t43 = POW_1_3(t42);
  t48 = my_piecewise3(t39, 0, t20 * t23 / t43 / 0.9e1);
  t49 = t35 + t48;
  t50 = t49 == 0.e0;
  t51 = my_piecewise3(t50, DBL_EPSILON, t49);
  t54 = 0.390299956e1 / t51 + 0.5764e0;
  t55 = t51 * t51;
  t56 = t55 * t55;
  t57 = 0.1e1 / t56;
  t59 = t55 * t51;
  t60 = 0.1e1 / t59;
  t62 = 0.1e1 / t55;
  t64 = 0.433132090567376656e2 * t57 + 0.190514637481962976e2 * t60 + 0.2094820520028e1 * t62;
  t65 = 0.1e1 / t64;
  tzk0 = my_piecewise3(t4, 0, -0.25e0 * t10 * t54 * t65);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t69 = t9 * t54;
  t72 = t20 * t21;
  t79 = my_piecewise3(t14, 0, -t72 * t22 / t30 / t29 * t28 / 0.27e2);
  t86 = my_piecewise3(t39, 0, -t72 * t22 / t43 / t42 * t41 / 0.27e2);
  t88 = my_piecewise3(t50, 0, t79 + t86);
  t93 = t64 * t64;
  t94 = 0.1e1 / t93;
  t95 = t54 * t94;
  t97 = 0.1e1 / t56 / t51;
  t98 = t97 * t88;
  t100 = t57 * t88;
  t104 = -0.1732528362269506624e3 * t98 - 0.571543912445888928e2 * t100 - 0.4189641040056e1 * t60 * t88;
  t109 = my_piecewise3(t4, 0, -0.25e0 * t69 * t65 + 0.97574989e0 * t10 * t62 * t88 * t65 + 0.25e0 * t10 * t95 * t104);
  tvrho0 = rho[0] * t109 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  tvsigma0 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t4, t5, t6, t7, t8, t9, t10;
  double t11, t14, t15, t16, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t35, t39, t40, t41, t42, t43, t48, t49;
  double t50, t51, t54, t55, t56, t57, t59, t60;
  double t62, t64, t65, tzk0;

  double t69, t72, t79, t86, t88, t93, t94, t95;
  double t97, t98, t100, t104, t109, tvrho0, tvsigma0;

  double t112, t113, t119, t124, t125, t133, t134, t142;
  double t144, t149, t150, t151, t155, t156, t157, t162;
  double t163, t167, t175, t180, tv2rho20, tv2rhosigma0, tv2sigma20;


  t1 = 0.1e1 <= p->zeta_threshold;
  t4 = t1 || rho[0] / 0.2e1 <= p->dens_threshold;
  t5 = p->zeta_threshold - 0.1e1;
  t6 = -t5;
  t7 = my_piecewise5(t1, t5, t1, t6, 0);
  t8 = t7 * t7;
  t9 = 0.1e1 - t8;
  t10 = t9 * rho[0];
  t11 = 0.1e1 + t7;
  t14 = t11 * rho[0] / 0.2e1 <= p->dens_threshold;
  t15 = M_CBRT3;
  t16 = t15 * t15;
  t18 = POW_1_3(0.1e1 / M_PI);
  t20 = t16 / t18;
  t21 = M_CBRT4;
  t22 = M_CBRT2;
  t23 = t21 * t22;
  t24 = t11 <= p->zeta_threshold;
  t25 = 0.1e1 - t7;
  t26 = t25 <= p->zeta_threshold;
  t27 = my_piecewise5(t24, t5, t26, t6, t7);
  t28 = 0.1e1 + t27;
  t29 = t28 * rho[0];
  t30 = POW_1_3(t29);
  t35 = my_piecewise3(t14, 0, t20 * t23 / t30 / 0.9e1);
  t39 = t25 * rho[0] / 0.2e1 <= p->dens_threshold;
  t40 = my_piecewise5(t26, t5, t24, t6, -t7);
  t41 = 0.1e1 + t40;
  t42 = t41 * rho[0];
  t43 = POW_1_3(t42);
  t48 = my_piecewise3(t39, 0, t20 * t23 / t43 / 0.9e1);
  t49 = t35 + t48;
  t50 = t49 == 0.e0;
  t51 = my_piecewise3(t50, DBL_EPSILON, t49);
  t54 = 0.390299956e1 / t51 + 0.5764e0;
  t55 = t51 * t51;
  t56 = t55 * t55;
  t57 = 0.1e1 / t56;
  t59 = t55 * t51;
  t60 = 0.1e1 / t59;
  t62 = 0.1e1 / t55;
  t64 = 0.433132090567376656e2 * t57 + 0.190514637481962976e2 * t60 + 0.2094820520028e1 * t62;
  t65 = 0.1e1 / t64;
  tzk0 = my_piecewise3(t4, 0, -0.25e0 * t10 * t54 * t65);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t69 = t9 * t54;
  t72 = t20 * t21;
  t79 = my_piecewise3(t14, 0, -t72 * t22 / t30 / t29 * t28 / 0.27e2);
  t86 = my_piecewise3(t39, 0, -t72 * t22 / t43 / t42 * t41 / 0.27e2);
  t88 = my_piecewise3(t50, 0, t79 + t86);
  t93 = t64 * t64;
  t94 = 0.1e1 / t93;
  t95 = t54 * t94;
  t97 = 0.1e1 / t56 / t51;
  t98 = t97 * t88;
  t100 = t57 * t88;
  t104 = -0.1732528362269506624e3 * t98 - 0.571543912445888928e2 * t100 - 0.4189641040056e1 * t60 * t88;
  t109 = my_piecewise3(t4, 0, -0.25e0 * t69 * t65 + 0.97574989e0 * t10 * t62 * t88 * t65 + 0.25e0 * t10 * t95 * t104);
  tvrho0 = rho[0] * t109 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  tvsigma0 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t112 = t9 * t62;
  t113 = t88 * t65;
  t119 = t88 * t88;
  t124 = t28 * t28;
  t125 = rho[0] * rho[0];
  t133 = my_piecewise3(t14, 0, 0.4e1 / 0.81e2 * t72 * t22 / t30 / t125);
  t134 = t41 * t41;
  t142 = my_piecewise3(t39, 0, 0.4e1 / 0.81e2 * t72 * t22 / t43 / t125);
  t144 = my_piecewise3(t50, 0, t133 + t142);
  t149 = t10 * t62;
  t150 = t88 * t94;
  t151 = t150 * t104;
  t155 = 0.1e1 / t93 / t64;
  t156 = t54 * t155;
  t157 = t104 * t104;
  t162 = 0.1e1 / t56 / t55;
  t163 = t162 * t119;
  t167 = t97 * t119;
  t175 = 0.866264181134753312e3 * t163 - 0.1732528362269506624e3 * t97 * t144 + 0.2286175649783555712e3 * t167 - 0.571543912445888928e2 * t57 * t144 + 0.12568923120168e2 * t57 * t119 - 0.4189641040056e1 * t60 * t144;
  t180 = my_piecewise3(t4, 0, 0.195149978e1 * t112 * t113 + 0.5e0 * t69 * t94 * t104 - 0.195149978e1 * t10 * t60 * t119 * t65 + 0.97574989e0 * t10 * t62 * t144 * t65 - 0.195149978e1 * t149 * t151 - 0.5e0 * t10 * t156 * t157 + 0.25e0 * t10 * t95 * t175);
  tv2rho20 = rho[0] * t180 + 0.2e1 * t109;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  tv2rhosigma0 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t4, t5, t6, t7, t8, t9, t10;
  double t11, t14, t15, t16, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t35, t39, t40, t41, t42, t43, t48, t49;
  double t50, t51, t54, t55, t56, t57, t59, t60;
  double t62, t64, t65, tzk0;

  double t69, t72, t79, t86, t88, t93, t94, t95;
  double t97, t98, t100, t104, t109, tvrho0, tvsigma0;

  double t112, t113, t119, t124, t125, t133, t134, t142;
  double t144, t149, t150, t151, t155, t156, t157, t162;
  double t163, t167, t175, t180, tv2rho20, tv2rhosigma0, tv2sigma20;

  double t183, t184, t192, t193, t201, t202, t210, t212;
  double t218, t219, t222, t239, t247, t248, t251, t252;
  double t255, t256, t259, t262, t263, t265, t269, t271;
  double t280, t281, t284, t285, tv3rho30, tv3rho2sigma0, tv3rhosigma20, tv3sigma30;


  t1 = 0.1e1 <= p->zeta_threshold;
  t4 = t1 || rho[0] / 0.2e1 <= p->dens_threshold;
  t5 = p->zeta_threshold - 0.1e1;
  t6 = -t5;
  t7 = my_piecewise5(t1, t5, t1, t6, 0);
  t8 = t7 * t7;
  t9 = 0.1e1 - t8;
  t10 = t9 * rho[0];
  t11 = 0.1e1 + t7;
  t14 = t11 * rho[0] / 0.2e1 <= p->dens_threshold;
  t15 = M_CBRT3;
  t16 = t15 * t15;
  t18 = POW_1_3(0.1e1 / M_PI);
  t20 = t16 / t18;
  t21 = M_CBRT4;
  t22 = M_CBRT2;
  t23 = t21 * t22;
  t24 = t11 <= p->zeta_threshold;
  t25 = 0.1e1 - t7;
  t26 = t25 <= p->zeta_threshold;
  t27 = my_piecewise5(t24, t5, t26, t6, t7);
  t28 = 0.1e1 + t27;
  t29 = t28 * rho[0];
  t30 = POW_1_3(t29);
  t35 = my_piecewise3(t14, 0, t20 * t23 / t30 / 0.9e1);
  t39 = t25 * rho[0] / 0.2e1 <= p->dens_threshold;
  t40 = my_piecewise5(t26, t5, t24, t6, -t7);
  t41 = 0.1e1 + t40;
  t42 = t41 * rho[0];
  t43 = POW_1_3(t42);
  t48 = my_piecewise3(t39, 0, t20 * t23 / t43 / 0.9e1);
  t49 = t35 + t48;
  t50 = t49 == 0.e0;
  t51 = my_piecewise3(t50, DBL_EPSILON, t49);
  t54 = 0.390299956e1 / t51 + 0.5764e0;
  t55 = t51 * t51;
  t56 = t55 * t55;
  t57 = 0.1e1 / t56;
  t59 = t55 * t51;
  t60 = 0.1e1 / t59;
  t62 = 0.1e1 / t55;
  t64 = 0.433132090567376656e2 * t57 + 0.190514637481962976e2 * t60 + 0.2094820520028e1 * t62;
  t65 = 0.1e1 / t64;
  tzk0 = my_piecewise3(t4, 0, -0.25e0 * t10 * t54 * t65);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t69 = t9 * t54;
  t72 = t20 * t21;
  t79 = my_piecewise3(t14, 0, -t72 * t22 / t30 / t29 * t28 / 0.27e2);
  t86 = my_piecewise3(t39, 0, -t72 * t22 / t43 / t42 * t41 / 0.27e2);
  t88 = my_piecewise3(t50, 0, t79 + t86);
  t93 = t64 * t64;
  t94 = 0.1e1 / t93;
  t95 = t54 * t94;
  t97 = 0.1e1 / t56 / t51;
  t98 = t97 * t88;
  t100 = t57 * t88;
  t104 = -0.1732528362269506624e3 * t98 - 0.571543912445888928e2 * t100 - 0.4189641040056e1 * t60 * t88;
  t109 = my_piecewise3(t4, 0, -0.25e0 * t69 * t65 + 0.97574989e0 * t10 * t62 * t88 * t65 + 0.25e0 * t10 * t95 * t104);
  tvrho0 = rho[0] * t109 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  tvsigma0 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t112 = t9 * t62;
  t113 = t88 * t65;
  t119 = t88 * t88;
  t124 = t28 * t28;
  t125 = rho[0] * rho[0];
  t133 = my_piecewise3(t14, 0, 0.4e1 / 0.81e2 * t72 * t22 / t30 / t125);
  t134 = t41 * t41;
  t142 = my_piecewise3(t39, 0, 0.4e1 / 0.81e2 * t72 * t22 / t43 / t125);
  t144 = my_piecewise3(t50, 0, t133 + t142);
  t149 = t10 * t62;
  t150 = t88 * t94;
  t151 = t150 * t104;
  t155 = 0.1e1 / t93 / t64;
  t156 = t54 * t155;
  t157 = t104 * t104;
  t162 = 0.1e1 / t56 / t55;
  t163 = t162 * t119;
  t167 = t97 * t119;
  t175 = 0.866264181134753312e3 * t163 - 0.1732528362269506624e3 * t97 * t144 + 0.2286175649783555712e3 * t167 - 0.571543912445888928e2 * t57 * t144 + 0.12568923120168e2 * t57 * t119 - 0.4189641040056e1 * t60 * t144;
  t180 = my_piecewise3(t4, 0, 0.195149978e1 * t112 * t113 + 0.5e0 * t69 * t94 * t104 - 0.195149978e1 * t10 * t60 * t119 * t65 + 0.97574989e0 * t10 * t62 * t144 * t65 - 0.195149978e1 * t149 * t151 - 0.5e0 * t10 * t156 * t157 + 0.25e0 * t10 * t95 * t175);
  tv2rho20 = rho[0] * t180 + 0.2e1 * t109;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  tv2rhosigma0 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t183 = t9 * t60;
  t184 = t119 * t65;
  t192 = t124 * t28;
  t193 = t125 * rho[0];
  t201 = my_piecewise3(t14, 0, -0.28e2 / 0.243e3 * t72 * t22 / t30 / t193);
  t202 = t134 * t41;
  t210 = my_piecewise3(t39, 0, -0.28e2 / 0.243e3 * t72 * t22 / t43 / t193);
  t212 = my_piecewise3(t50, 0, t201 + t210);
  t218 = 0.1e1 / t56 / t59;
  t219 = t119 * t88;
  t222 = t162 * t88;
  t239 = -0.5197585086808519872e4 * t218 * t219 + 0.2598792543404259936e4 * t222 * t144 - 0.1732528362269506624e3 * t97 * t212 - 0.1143087824891777856e4 * t162 * t219 + 0.6858526949350667136e3 * t98 * t144 - 0.571543912445888928e2 * t57 * t212 - 0.50275692480672e2 * t97 * t219 + 0.37706769360504e2 * t100 * t144 - 0.4189641040056e1 * t60 * t212;
  t247 = t10 * t60;
  t248 = t113 * t144;
  t251 = t119 * t94;
  t252 = t251 * t104;
  t255 = t144 * t94;
  t256 = t255 * t104;
  t259 = t150 * t175;
  t262 = t93 * t93;
  t263 = 0.1e1 / t262;
  t265 = t157 * t104;
  t269 = t10 * t54;
  t271 = t155 * t104 * t175;
  t280 = t88 * t155;
  t281 = t280 * t157;
  t284 = -0.585449934e1 * t183 * t184 - 0.585449934e1 * t112 * t151 - 0.15e1 * t69 * t155 * t157 + 0.97574989e0 * t10 * t62 * t212 * t65 + 0.25e0 * t10 * t95 * t239 + 0.585449934e1 * t10 * t57 * t219 * t65 - 0.585449934e1 * t247 * t248 + 0.585449934e1 * t247 * t252 - 0.292724967e1 * t149 * t256 - 0.292724967e1 * t149 * t259 + 0.15e1 * t10 * t54 * t263 * t265 - 0.15e1 * t269 * t271 + 0.292724967e1 * t112 * t144 * t65 + 0.75e0 * t69 * t94 * t175 + 0.585449934e1 * t149 * t281;
  t285 = my_piecewise3(t4, 0, t284);
  tv3rho30 = rho[0] * t285 + 0.3e1 * t180;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  tv3rho2sigma0 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3sigma30 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t4, t5, t6, t7, t8, t9, t10;
  double t11, t14, t15, t16, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t35, t39, t40, t41, t42, t43, t48, t49;
  double t50, t51, t54, t55, t56, t57, t59, t60;
  double t62, t64, t65, tzk0;

  double t69, t72, t79, t86, t88, t93, t94, t95;
  double t97, t98, t100, t104, t109, tvrho0, tvsigma0;

  double t112, t113, t119, t124, t125, t133, t134, t142;
  double t144, t149, t150, t151, t155, t156, t157, t162;
  double t163, t167, t175, t180, tv2rho20, tv2rhosigma0, tv2sigma20;

  double t183, t184, t192, t193, t201, t202, t210, t212;
  double t218, t219, t222, t239, t247, t248, t251, t252;
  double t255, t256, t259, t262, t263, t265, t269, t271;
  double t280, t281, t284, t285, tv3rho30, tv3rho2sigma0, tv3rhosigma20, tv3sigma30;

  double t298, t299, t307, t308, t316, t318, t323, t325;
  double t331, t358, t365, t369, t390, t394, t421, t449;
  double t451, tv4rho40, tv4rho3sigma0, tv4rho2sigma20, tv4rhosigma30, tv4sigma40;


  t1 = 0.1e1 <= p->zeta_threshold;
  t4 = t1 || rho[0] / 0.2e1 <= p->dens_threshold;
  t5 = p->zeta_threshold - 0.1e1;
  t6 = -t5;
  t7 = my_piecewise5(t1, t5, t1, t6, 0);
  t8 = t7 * t7;
  t9 = 0.1e1 - t8;
  t10 = t9 * rho[0];
  t11 = 0.1e1 + t7;
  t14 = t11 * rho[0] / 0.2e1 <= p->dens_threshold;
  t15 = M_CBRT3;
  t16 = t15 * t15;
  t18 = POW_1_3(0.1e1 / M_PI);
  t20 = t16 / t18;
  t21 = M_CBRT4;
  t22 = M_CBRT2;
  t23 = t21 * t22;
  t24 = t11 <= p->zeta_threshold;
  t25 = 0.1e1 - t7;
  t26 = t25 <= p->zeta_threshold;
  t27 = my_piecewise5(t24, t5, t26, t6, t7);
  t28 = 0.1e1 + t27;
  t29 = t28 * rho[0];
  t30 = POW_1_3(t29);
  t35 = my_piecewise3(t14, 0, t20 * t23 / t30 / 0.9e1);
  t39 = t25 * rho[0] / 0.2e1 <= p->dens_threshold;
  t40 = my_piecewise5(t26, t5, t24, t6, -t7);
  t41 = 0.1e1 + t40;
  t42 = t41 * rho[0];
  t43 = POW_1_3(t42);
  t48 = my_piecewise3(t39, 0, t20 * t23 / t43 / 0.9e1);
  t49 = t35 + t48;
  t50 = t49 == 0.e0;
  t51 = my_piecewise3(t50, DBL_EPSILON, t49);
  t54 = 0.390299956e1 / t51 + 0.5764e0;
  t55 = t51 * t51;
  t56 = t55 * t55;
  t57 = 0.1e1 / t56;
  t59 = t55 * t51;
  t60 = 0.1e1 / t59;
  t62 = 0.1e1 / t55;
  t64 = 0.433132090567376656e2 * t57 + 0.190514637481962976e2 * t60 + 0.2094820520028e1 * t62;
  t65 = 0.1e1 / t64;
  tzk0 = my_piecewise3(t4, 0, -0.25e0 * t10 * t54 * t65);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t69 = t9 * t54;
  t72 = t20 * t21;
  t79 = my_piecewise3(t14, 0, -t72 * t22 / t30 / t29 * t28 / 0.27e2);
  t86 = my_piecewise3(t39, 0, -t72 * t22 / t43 / t42 * t41 / 0.27e2);
  t88 = my_piecewise3(t50, 0, t79 + t86);
  t93 = t64 * t64;
  t94 = 0.1e1 / t93;
  t95 = t54 * t94;
  t97 = 0.1e1 / t56 / t51;
  t98 = t97 * t88;
  t100 = t57 * t88;
  t104 = -0.1732528362269506624e3 * t98 - 0.571543912445888928e2 * t100 - 0.4189641040056e1 * t60 * t88;
  t109 = my_piecewise3(t4, 0, -0.25e0 * t69 * t65 + 0.97574989e0 * t10 * t62 * t88 * t65 + 0.25e0 * t10 * t95 * t104);
  tvrho0 = rho[0] * t109 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  tvsigma0 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t112 = t9 * t62;
  t113 = t88 * t65;
  t119 = t88 * t88;
  t124 = t28 * t28;
  t125 = rho[0] * rho[0];
  t133 = my_piecewise3(t14, 0, 0.4e1 / 0.81e2 * t72 * t22 / t30 / t125);
  t134 = t41 * t41;
  t142 = my_piecewise3(t39, 0, 0.4e1 / 0.81e2 * t72 * t22 / t43 / t125);
  t144 = my_piecewise3(t50, 0, t133 + t142);
  t149 = t10 * t62;
  t150 = t88 * t94;
  t151 = t150 * t104;
  t155 = 0.1e1 / t93 / t64;
  t156 = t54 * t155;
  t157 = t104 * t104;
  t162 = 0.1e1 / t56 / t55;
  t163 = t162 * t119;
  t167 = t97 * t119;
  t175 = 0.866264181134753312e3 * t163 - 0.1732528362269506624e3 * t97 * t144 + 0.2286175649783555712e3 * t167 - 0.571543912445888928e2 * t57 * t144 + 0.12568923120168e2 * t57 * t119 - 0.4189641040056e1 * t60 * t144;
  t180 = my_piecewise3(t4, 0, 0.195149978e1 * t112 * t113 + 0.5e0 * t69 * t94 * t104 - 0.195149978e1 * t10 * t60 * t119 * t65 + 0.97574989e0 * t10 * t62 * t144 * t65 - 0.195149978e1 * t149 * t151 - 0.5e0 * t10 * t156 * t157 + 0.25e0 * t10 * t95 * t175);
  tv2rho20 = rho[0] * t180 + 0.2e1 * t109;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  tv2rhosigma0 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t183 = t9 * t60;
  t184 = t119 * t65;
  t192 = t124 * t28;
  t193 = t125 * rho[0];
  t201 = my_piecewise3(t14, 0, -0.28e2 / 0.243e3 * t72 * t22 / t30 / t193);
  t202 = t134 * t41;
  t210 = my_piecewise3(t39, 0, -0.28e2 / 0.243e3 * t72 * t22 / t43 / t193);
  t212 = my_piecewise3(t50, 0, t201 + t210);
  t218 = 0.1e1 / t56 / t59;
  t219 = t119 * t88;
  t222 = t162 * t88;
  t239 = -0.5197585086808519872e4 * t218 * t219 + 0.2598792543404259936e4 * t222 * t144 - 0.1732528362269506624e3 * t97 * t212 - 0.1143087824891777856e4 * t162 * t219 + 0.6858526949350667136e3 * t98 * t144 - 0.571543912445888928e2 * t57 * t212 - 0.50275692480672e2 * t97 * t219 + 0.37706769360504e2 * t100 * t144 - 0.4189641040056e1 * t60 * t212;
  t247 = t10 * t60;
  t248 = t113 * t144;
  t251 = t119 * t94;
  t252 = t251 * t104;
  t255 = t144 * t94;
  t256 = t255 * t104;
  t259 = t150 * t175;
  t262 = t93 * t93;
  t263 = 0.1e1 / t262;
  t265 = t157 * t104;
  t269 = t10 * t54;
  t271 = t155 * t104 * t175;
  t280 = t88 * t155;
  t281 = t280 * t157;
  t284 = -0.585449934e1 * t183 * t184 - 0.585449934e1 * t112 * t151 - 0.15e1 * t69 * t155 * t157 + 0.97574989e0 * t10 * t62 * t212 * t65 + 0.25e0 * t10 * t95 * t239 + 0.585449934e1 * t10 * t57 * t219 * t65 - 0.585449934e1 * t247 * t248 + 0.585449934e1 * t247 * t252 - 0.292724967e1 * t149 * t256 - 0.292724967e1 * t149 * t259 + 0.15e1 * t10 * t54 * t263 * t265 - 0.15e1 * t269 * t271 + 0.292724967e1 * t112 * t144 * t65 + 0.75e0 * t69 * t94 * t175 + 0.585449934e1 * t149 * t281;
  t285 = my_piecewise3(t4, 0, t284);
  tv3rho30 = rho[0] * t285 + 0.3e1 * t180;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  tv3rho2sigma0 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3sigma30 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t298 = t124 * t124;
  t299 = t125 * t125;
  t307 = my_piecewise3(t14, 0, 0.28e3 / 0.729e3 * t72 * t22 / t30 / t299);
  t308 = t134 * t134;
  t316 = my_piecewise3(t39, 0, 0.28e3 / 0.729e3 * t72 * t22 / t43 / t299);
  t318 = my_piecewise3(t50, 0, t307 + t316);
  t323 = t56 * t56;
  t325 = t119 * t119;
  t331 = t144 * t144;
  t358 = 0.36383095607659639104e5 / t323 * t325 - 0.31185510520851119232e5 * t218 * t119 * t144 + 0.2598792543404259936e4 * t162 * t331 + 0.3465056724539013248e4 * t222 * t212 - 0.1732528362269506624e3 * t97 * t318 + 0.6858526949350667136e4 * t218 * t325 - 0.6858526949350667136e4 * t163 * t144 + 0.6858526949350667136e3 * t97 * t331 + 0.9144702599134222848e3 * t98 * t212 - 0.571543912445888928e2 * t57 * t318 + 0.25137846240336e3 * t162 * t325 - 0.301654154884032e3 * t167 * t144 + 0.37706769360504e2 * t57 * t331 + 0.50275692480672e2 * t100 * t212 - 0.4189641040056e1 * t60 * t318;
  t365 = t157 * t157;
  t369 = t175 * t175;
  t390 = t10 * t57;
  t394 = -0.2341799736e2 * t183 * t248 + 0.2341799736e2 * t183 * t252 - 0.1170899868e2 * t112 * t256 - 0.1170899868e2 * t112 * t259 - 0.6e1 * t69 * t271 + 0.97574989e0 * t10 * t62 * t318 * t65 + 0.25e0 * t10 * t95 * t358 - 0.6e1 * t10 * t54 / t262 / t64 * t365 - 0.15e1 * t10 * t156 * t369 + 0.2341799736e2 * t112 * t281 - 0.2341799736e2 * t10 * t97 * t325 * t65 - 0.585449934e1 * t10 * t60 * t331 * t65 - 0.2e1 * t269 * t155 * t239 * t104 - 0.390299956e1 * t149 * t150 * t239 + 0.3512699604e2 * t390 * t184 * t144;
  t421 = t212 * t65;
  t449 = -0.2341799736e2 * t390 * t219 * t94 * t104 + 0.1170899868e2 * t247 * t251 * t175 - 0.2341799736e2 * t247 * t119 * t155 * t157 + 0.1170899868e2 * t149 * t144 * t155 * t157 - 0.585449934e1 * t149 * t255 * t175 + 0.9e1 * t269 * t263 * t157 * t175 - 0.2341799736e2 * t149 * t88 * t263 * t265 - 0.780599912e1 * t247 * t421 * t88 - 0.390299956e1 * t149 * t212 * t94 * t104 + 0.2341799736e2 * t9 * t57 * t219 * t65 + 0.6e1 * t69 * t263 * t265 + 0.390299956e1 * t112 * t421 + 0.1e1 * t69 * t94 * t239 + 0.2341799736e2 * t247 * t150 * t144 * t104 + 0.2341799736e2 * t149 * t280 * t175 * t104;
  t451 = my_piecewise3(t4, 0, t394 + t449);
  tv4rho40 = rho[0] * t451 + 0.4e1 * t285;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  tv4rho3sigma0 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho2sigma20 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rhosigma30 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4sigma40 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t11, t13, t14;
  double t16, t17, t18, t19, t20, t21, t24, t27;
  double t28, t29, t32, t33, t34, t36, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t48, t53, t57, t58, t59, t60, t61, t66;
  double t67, t68, t69, t72, t73, t74, t75, t77;
  double t78, t80, t82, t83, t84, tzk0;


  t1 = rho[0] - rho[1];
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t4 = t1 * t3;
  t5 = fabs(t4);
  t11 = 0.1e1 - t5 <= p->zeta_threshold || rho[0] <= p->dens_threshold && rho[1] <= p->dens_threshold;
  t13 = 0.1e1 + t4 <= p->zeta_threshold;
  t14 = p->zeta_threshold - 0.1e1;
  t16 = 0.1e1 - t4 <= p->zeta_threshold;
  t17 = -t14;
  t18 = my_piecewise5(t13, t14, t16, t17, t4);
  t19 = t18 * t18;
  t20 = 0.1e1 - t19;
  t21 = t20 * t2;
  t24 = 0.2e1 * rho[0] * t3 <= p->zeta_threshold;
  t27 = 0.2e1 * rho[1] * t3 <= p->zeta_threshold;
  t28 = my_piecewise5(t24, t14, t27, t17, t4);
  t29 = 0.1e1 + t28;
  t32 = t29 * t2 / 0.2e1 <= p->dens_threshold;
  t33 = M_CBRT3;
  t34 = t33 * t33;
  t36 = POW_1_3(0.1e1 / M_PI);
  t38 = t34 / t36;
  t39 = M_CBRT4;
  t40 = M_CBRT2;
  t41 = t39 * t40;
  t42 = t29 <= p->zeta_threshold;
  t43 = 0.1e1 - t28;
  t44 = t43 <= p->zeta_threshold;
  t45 = my_piecewise5(t42, t14, t44, t17, t28);
  t46 = 0.1e1 + t45;
  t47 = t46 * t2;
  t48 = POW_1_3(t47);
  t53 = my_piecewise3(t32, 0, t38 * t41 / t48 / 0.9e1);
  t57 = t43 * t2 / 0.2e1 <= p->dens_threshold;
  t58 = my_piecewise5(t44, t14, t42, t17, -t28);
  t59 = 0.1e1 + t58;
  t60 = t59 * t2;
  t61 = POW_1_3(t60);
  t66 = my_piecewise3(t57, 0, t38 * t41 / t61 / 0.9e1);
  t67 = t53 + t66;
  t68 = t67 == 0.e0;
  t69 = my_piecewise3(t68, DBL_EPSILON, t67);
  t72 = 0.390299956e1 / t69 + 0.5764e0;
  t73 = t69 * t69;
  t74 = t73 * t73;
  t75 = 0.1e1 / t74;
  t77 = t73 * t69;
  t78 = 0.1e1 / t77;
  t80 = 0.1e1 / t73;
  t82 = 0.433132090567376656e2 * t75 + 0.190514637481962976e2 * t78 + 0.2094820520028e1 * t80;
  t83 = 0.1e1 / t82;
  t84 = t72 * t83;
  tzk0 = my_piecewise3(t11, 0, -0.25e0 * t21 * t84);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t11, t13, t14;
  double t16, t17, t18, t19, t20, t21, t24, t27;
  double t28, t29, t32, t33, t34, t36, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t48, t53, t57, t58, t59, t60, t61, t66;
  double t67, t68, t69, t72, t73, t74, t75, t77;
  double t78, t80, t82, t83, t84, tzk0;

  double t87, t88, t89, t90, t91, t92, t94, t97;
  double t99, t100, t103, t104, t105, t107, t111, t114;
  double t115, t117, t121, t123, t124, t125, t128, t129;
  double t130, t132, t133, t135, t139, t140, t144, tvrho0;
  double t146, t147, t148, t151, t152, t154, t158, t159;
  double t161, t165, t167, t168, t169, t172, t174, t176;
  double t178, t179, t183, tvrho1, tvsigma0, tvsigma1, tvsigma2;


  t1 = rho[0] - rho[1];
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t4 = t1 * t3;
  t5 = fabs(t4);
  t11 = 0.1e1 - t5 <= p->zeta_threshold || rho[0] <= p->dens_threshold && rho[1] <= p->dens_threshold;
  t13 = 0.1e1 + t4 <= p->zeta_threshold;
  t14 = p->zeta_threshold - 0.1e1;
  t16 = 0.1e1 - t4 <= p->zeta_threshold;
  t17 = -t14;
  t18 = my_piecewise5(t13, t14, t16, t17, t4);
  t19 = t18 * t18;
  t20 = 0.1e1 - t19;
  t21 = t20 * t2;
  t24 = 0.2e1 * rho[0] * t3 <= p->zeta_threshold;
  t27 = 0.2e1 * rho[1] * t3 <= p->zeta_threshold;
  t28 = my_piecewise5(t24, t14, t27, t17, t4);
  t29 = 0.1e1 + t28;
  t32 = t29 * t2 / 0.2e1 <= p->dens_threshold;
  t33 = M_CBRT3;
  t34 = t33 * t33;
  t36 = POW_1_3(0.1e1 / M_PI);
  t38 = t34 / t36;
  t39 = M_CBRT4;
  t40 = M_CBRT2;
  t41 = t39 * t40;
  t42 = t29 <= p->zeta_threshold;
  t43 = 0.1e1 - t28;
  t44 = t43 <= p->zeta_threshold;
  t45 = my_piecewise5(t42, t14, t44, t17, t28);
  t46 = 0.1e1 + t45;
  t47 = t46 * t2;
  t48 = POW_1_3(t47);
  t53 = my_piecewise3(t32, 0, t38 * t41 / t48 / 0.9e1);
  t57 = t43 * t2 / 0.2e1 <= p->dens_threshold;
  t58 = my_piecewise5(t44, t14, t42, t17, -t28);
  t59 = 0.1e1 + t58;
  t60 = t59 * t2;
  t61 = POW_1_3(t60);
  t66 = my_piecewise3(t57, 0, t38 * t41 / t61 / 0.9e1);
  t67 = t53 + t66;
  t68 = t67 == 0.e0;
  t69 = my_piecewise3(t68, DBL_EPSILON, t67);
  t72 = 0.390299956e1 / t69 + 0.5764e0;
  t73 = t69 * t69;
  t74 = t73 * t73;
  t75 = 0.1e1 / t74;
  t77 = t73 * t69;
  t78 = 0.1e1 / t77;
  t80 = 0.1e1 / t73;
  t82 = 0.433132090567376656e2 * t75 + 0.190514637481962976e2 * t78 + 0.2094820520028e1 * t80;
  t83 = 0.1e1 / t82;
  t84 = t72 * t83;
  tzk0 = my_piecewise3(t11, 0, -0.25e0 * t21 * t84);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t87 = t2 * t2;
  t88 = 0.1e1 / t87;
  t89 = t1 * t88;
  t90 = t3 - t89;
  t91 = my_piecewise5(t13, 0, t16, 0, t90);
  t92 = t18 * t91;
  t94 = t2 * t72 * t83;
  t97 = t20 * t72;
  t99 = 0.25e0 * t97 * t83;
  t100 = t38 * t39;
  t103 = t40 / t48 / t47;
  t104 = my_piecewise5(t24, 0, t27, 0, t90);
  t105 = my_piecewise5(t42, 0, t44, 0, t104);
  t107 = t105 * t2 + t45 + 0.1e1;
  t111 = my_piecewise3(t32, 0, -t100 * t103 * t107 / 0.27e2);
  t114 = t40 / t61 / t60;
  t115 = my_piecewise5(t44, 0, t42, 0, -t104);
  t117 = t115 * t2 + t58 + 0.1e1;
  t121 = my_piecewise3(t57, 0, -t100 * t114 * t117 / 0.27e2);
  t123 = my_piecewise3(t68, 0, t111 + t121);
  t124 = t80 * t123;
  t125 = t124 * t83;
  t128 = t82 * t82;
  t129 = 0.1e1 / t128;
  t130 = t72 * t129;
  t132 = 0.1e1 / t74 / t69;
  t133 = t132 * t123;
  t135 = t75 * t123;
  t139 = -0.1732528362269506624e3 * t133 - 0.571543912445888928e2 * t135 - 0.4189641040056e1 * t78 * t123;
  t140 = t130 * t139;
  t144 = my_piecewise3(t11, 0, 0.5e0 * t92 * t94 - t99 + 0.97574989e0 * t21 * t125 + 0.25e0 * t21 * t140);
  tvrho0 = t2 * t144 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = -t3 - t89;
  t147 = my_piecewise5(t13, 0, t16, 0, t146);
  t148 = t18 * t147;
  t151 = my_piecewise5(t24, 0, t27, 0, t146);
  t152 = my_piecewise5(t42, 0, t44, 0, t151);
  t154 = t152 * t2 + t45 + 0.1e1;
  t158 = my_piecewise3(t32, 0, -t100 * t103 * t154 / 0.27e2);
  t159 = my_piecewise5(t44, 0, t42, 0, -t151);
  t161 = t159 * t2 + t58 + 0.1e1;
  t165 = my_piecewise3(t57, 0, -t100 * t114 * t161 / 0.27e2);
  t167 = my_piecewise3(t68, 0, t158 + t165);
  t168 = t80 * t167;
  t169 = t168 * t83;
  t172 = t132 * t167;
  t174 = t75 * t167;
  t176 = t78 * t167;
  t178 = -0.1732528362269506624e3 * t172 - 0.571543912445888928e2 * t174 - 0.4189641040056e1 * t176;
  t179 = t130 * t178;
  t183 = my_piecewise3(t11, 0, 0.5e0 * t148 * t94 - t99 + 0.97574989e0 * t21 * t169 + 0.25e0 * t21 * t179);
  tvrho1 = t2 * t183 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  tvsigma0 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  tvsigma2 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t11, t13, t14;
  double t16, t17, t18, t19, t20, t21, t24, t27;
  double t28, t29, t32, t33, t34, t36, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t48, t53, t57, t58, t59, t60, t61, t66;
  double t67, t68, t69, t72, t73, t74, t75, t77;
  double t78, t80, t82, t83, t84, tzk0;

  double t87, t88, t89, t90, t91, t92, t94, t97;
  double t99, t100, t103, t104, t105, t107, t111, t114;
  double t115, t117, t121, t123, t124, t125, t128, t129;
  double t130, t132, t133, t135, t139, t140, t144, tvrho0;
  double t146, t147, t148, t151, t152, t154, t158, t159;
  double t161, t165, t167, t168, t169, t172, t174, t176;
  double t178, t179, t183, tvrho1, tvsigma0, tvsigma1, tvsigma2;

  double t186, t187, t190, t191, t192, t194, t195, t196;
  double t199, t201, t206, t207, t208, t210, t211, t213;
  double t214, t215, t218, t222, t223, t227, t228, t231;
  double t236, t237, t241, t242, t246, t249, t254, t256;
  double t257, t258, t261, t262, t263, t267, t268, t269;
  double t270, t274, t275, t279, t285, t287, t288, t291;
  double t292, tv2rho20, t294, t297, t298, t299, t302, t304;
  double t314, t315, t317, t318, t325, t326, t328, t333;
  double t338, t340, t345, t347, t348, t349, t352, t353;
  double t358, t359, t361, t364, t365, t366, t369, t372;
  double t376, t380, t382, t383, t386, t387, tv2rho21, t390;
  double t391, t395, t396, t397, t407, t408, t409, t412;
  double t416, t417, t420, t425, t426, t430, t433, t438;
  double t440, t441, t442, t445, t448, t449, t452, t454;
  double t456, t458, t460, t462, t464, t465, t468, t469;
  double tv2rho22, tv2rhosigma0, tv2rhosigma1, tv2rhosigma2, tv2rhosigma3, tv2rhosigma4, tv2rhosigma5, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, tv2sigma25;


  t1 = rho[0] - rho[1];
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t4 = t1 * t3;
  t5 = fabs(t4);
  t11 = 0.1e1 - t5 <= p->zeta_threshold || rho[0] <= p->dens_threshold && rho[1] <= p->dens_threshold;
  t13 = 0.1e1 + t4 <= p->zeta_threshold;
  t14 = p->zeta_threshold - 0.1e1;
  t16 = 0.1e1 - t4 <= p->zeta_threshold;
  t17 = -t14;
  t18 = my_piecewise5(t13, t14, t16, t17, t4);
  t19 = t18 * t18;
  t20 = 0.1e1 - t19;
  t21 = t20 * t2;
  t24 = 0.2e1 * rho[0] * t3 <= p->zeta_threshold;
  t27 = 0.2e1 * rho[1] * t3 <= p->zeta_threshold;
  t28 = my_piecewise5(t24, t14, t27, t17, t4);
  t29 = 0.1e1 + t28;
  t32 = t29 * t2 / 0.2e1 <= p->dens_threshold;
  t33 = M_CBRT3;
  t34 = t33 * t33;
  t36 = POW_1_3(0.1e1 / M_PI);
  t38 = t34 / t36;
  t39 = M_CBRT4;
  t40 = M_CBRT2;
  t41 = t39 * t40;
  t42 = t29 <= p->zeta_threshold;
  t43 = 0.1e1 - t28;
  t44 = t43 <= p->zeta_threshold;
  t45 = my_piecewise5(t42, t14, t44, t17, t28);
  t46 = 0.1e1 + t45;
  t47 = t46 * t2;
  t48 = POW_1_3(t47);
  t53 = my_piecewise3(t32, 0, t38 * t41 / t48 / 0.9e1);
  t57 = t43 * t2 / 0.2e1 <= p->dens_threshold;
  t58 = my_piecewise5(t44, t14, t42, t17, -t28);
  t59 = 0.1e1 + t58;
  t60 = t59 * t2;
  t61 = POW_1_3(t60);
  t66 = my_piecewise3(t57, 0, t38 * t41 / t61 / 0.9e1);
  t67 = t53 + t66;
  t68 = t67 == 0.e0;
  t69 = my_piecewise3(t68, DBL_EPSILON, t67);
  t72 = 0.390299956e1 / t69 + 0.5764e0;
  t73 = t69 * t69;
  t74 = t73 * t73;
  t75 = 0.1e1 / t74;
  t77 = t73 * t69;
  t78 = 0.1e1 / t77;
  t80 = 0.1e1 / t73;
  t82 = 0.433132090567376656e2 * t75 + 0.190514637481962976e2 * t78 + 0.2094820520028e1 * t80;
  t83 = 0.1e1 / t82;
  t84 = t72 * t83;
  tzk0 = my_piecewise3(t11, 0, -0.25e0 * t21 * t84);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t87 = t2 * t2;
  t88 = 0.1e1 / t87;
  t89 = t1 * t88;
  t90 = t3 - t89;
  t91 = my_piecewise5(t13, 0, t16, 0, t90);
  t92 = t18 * t91;
  t94 = t2 * t72 * t83;
  t97 = t20 * t72;
  t99 = 0.25e0 * t97 * t83;
  t100 = t38 * t39;
  t103 = t40 / t48 / t47;
  t104 = my_piecewise5(t24, 0, t27, 0, t90);
  t105 = my_piecewise5(t42, 0, t44, 0, t104);
  t107 = t105 * t2 + t45 + 0.1e1;
  t111 = my_piecewise3(t32, 0, -t100 * t103 * t107 / 0.27e2);
  t114 = t40 / t61 / t60;
  t115 = my_piecewise5(t44, 0, t42, 0, -t104);
  t117 = t115 * t2 + t58 + 0.1e1;
  t121 = my_piecewise3(t57, 0, -t100 * t114 * t117 / 0.27e2);
  t123 = my_piecewise3(t68, 0, t111 + t121);
  t124 = t80 * t123;
  t125 = t124 * t83;
  t128 = t82 * t82;
  t129 = 0.1e1 / t128;
  t130 = t72 * t129;
  t132 = 0.1e1 / t74 / t69;
  t133 = t132 * t123;
  t135 = t75 * t123;
  t139 = -0.1732528362269506624e3 * t133 - 0.571543912445888928e2 * t135 - 0.4189641040056e1 * t78 * t123;
  t140 = t130 * t139;
  t144 = my_piecewise3(t11, 0, 0.5e0 * t92 * t94 - t99 + 0.97574989e0 * t21 * t125 + 0.25e0 * t21 * t140);
  tvrho0 = t2 * t144 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = -t3 - t89;
  t147 = my_piecewise5(t13, 0, t16, 0, t146);
  t148 = t18 * t147;
  t151 = my_piecewise5(t24, 0, t27, 0, t146);
  t152 = my_piecewise5(t42, 0, t44, 0, t151);
  t154 = t152 * t2 + t45 + 0.1e1;
  t158 = my_piecewise3(t32, 0, -t100 * t103 * t154 / 0.27e2);
  t159 = my_piecewise5(t44, 0, t42, 0, -t151);
  t161 = t159 * t2 + t58 + 0.1e1;
  t165 = my_piecewise3(t57, 0, -t100 * t114 * t161 / 0.27e2);
  t167 = my_piecewise3(t68, 0, t158 + t165);
  t168 = t80 * t167;
  t169 = t168 * t83;
  t172 = t132 * t167;
  t174 = t75 * t167;
  t176 = t78 * t167;
  t178 = -0.1732528362269506624e3 * t172 - 0.571543912445888928e2 * t174 - 0.4189641040056e1 * t176;
  t179 = t130 * t178;
  t183 = my_piecewise3(t11, 0, 0.5e0 * t148 * t94 - t99 + 0.97574989e0 * t21 * t169 + 0.25e0 * t21 * t179);
  tvrho1 = t2 * t183 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  tvsigma0 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  tvsigma2 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t186 = t91 * t91;
  t187 = t186 * t2;
  t190 = t87 * t2;
  t191 = 0.1e1 / t190;
  t192 = t1 * t191;
  t194 = -0.2e1 * t88 + 0.2e1 * t192;
  t195 = my_piecewise5(t13, 0, t16, 0, t194);
  t196 = t18 * t195;
  t199 = t92 * t84;
  t201 = t92 * t2;
  t206 = t20 * t80;
  t207 = t123 * t83;
  t208 = t206 * t207;
  t210 = t129 * t139;
  t211 = t97 * t210;
  t213 = t123 * t123;
  t214 = t78 * t213;
  t215 = t214 * t83;
  t218 = t46 * t46;
  t222 = t40 / t48 / t218 / t87;
  t223 = t107 * t107;
  t227 = my_piecewise5(t24, 0, t27, 0, t194);
  t228 = my_piecewise5(t42, 0, t44, 0, t227);
  t231 = t228 * t2 + 0.2e1 * t105;
  t236 = my_piecewise3(t32, 0, 0.4e1 / 0.81e2 * t100 * t222 * t223 - t100 * t103 * t231 / 0.27e2);
  t237 = t59 * t59;
  t241 = t40 / t61 / t237 / t87;
  t242 = t117 * t117;
  t246 = my_piecewise5(t44, 0, t42, 0, -t227);
  t249 = t246 * t2 + 0.2e1 * t115;
  t254 = my_piecewise3(t57, 0, 0.4e1 / 0.81e2 * t100 * t241 * t242 - t100 * t114 * t249 / 0.27e2);
  t256 = my_piecewise3(t68, 0, t236 + t254);
  t257 = t80 * t256;
  t258 = t257 * t83;
  t261 = t21 * t80;
  t262 = t123 * t129;
  t263 = t262 * t139;
  t267 = 0.1e1 / t128 / t82;
  t268 = t72 * t267;
  t269 = t139 * t139;
  t270 = t268 * t269;
  t274 = 0.1e1 / t74 / t73;
  t275 = t274 * t213;
  t279 = t132 * t213;
  t285 = t78 * t256;
  t287 = 0.866264181134753312e3 * t275 - 0.1732528362269506624e3 * t132 * t256 + 0.2286175649783555712e3 * t279 - 0.571543912445888928e2 * t75 * t256 + 0.12568923120168e2 * t75 * t213 - 0.4189641040056e1 * t285;
  t288 = t130 * t287;
  t291 = 0.5e0 * t187 * t84 + 0.5e0 * t196 * t94 + 0.1e1 * t199 - 0.390299956e1 * t201 * t125 - 0.1e1 * t201 * t140 + 0.195149978e1 * t208 + 0.5e0 * t211 - 0.195149978e1 * t21 * t215 + 0.97574989e0 * t21 * t258 - 0.195149978e1 * t261 * t263 - 0.5e0 * t21 * t270 + 0.25e0 * t21 * t288;
  t292 = my_piecewise3(t11, 0, t291);
  tv2rho20 = t2 * t292 + 0.2e1 * t144;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t294 = t91 * t147;
  t297 = 0.2e1 * t192;
  t298 = my_piecewise5(t13, 0, t16, 0, t297);
  t299 = t18 * t298;
  t302 = t148 * t84;
  t304 = t148 * t2;
  t314 = t167 * t83;
  t315 = t206 * t314;
  t317 = t21 * t78;
  t318 = t314 * t123;
  t325 = my_piecewise5(t24, 0, t27, 0, t297);
  t326 = my_piecewise5(t42, 0, t44, 0, t325);
  t328 = t326 * t2 + t105 + t152;
  t333 = my_piecewise3(t32, 0, 0.4e1 / 0.81e2 * t100 * t222 * t154 * t107 - t100 * t103 * t328 / 0.27e2);
  t338 = my_piecewise5(t44, 0, t42, 0, -t325);
  t340 = t338 * t2 + t115 + t159;
  t345 = my_piecewise3(t57, 0, 0.4e1 / 0.81e2 * t100 * t241 * t161 * t117 - t100 * t114 * t340 / 0.27e2);
  t347 = my_piecewise3(t68, 0, t333 + t345);
  t348 = t80 * t347;
  t349 = t348 * t83;
  t352 = t167 * t129;
  t353 = t352 * t139;
  t358 = t129 * t178;
  t359 = t97 * t358;
  t361 = t262 * t178;
  t364 = t21 * t72;
  t365 = t267 * t178;
  t366 = t365 * t139;
  t369 = t274 * t167;
  t372 = t132 * t347;
  t376 = t75 * t347;
  t380 = t78 * t347;
  t382 = 0.866264181134753312e3 * t369 * t123 - 0.1732528362269506624e3 * t372 + 0.2286175649783555712e3 * t172 * t123 - 0.571543912445888928e2 * t376 + 0.12568923120168e2 * t174 * t123 - 0.4189641040056e1 * t380;
  t383 = t130 * t382;
  t386 = 0.5e0 * t294 * t94 + 0.5e0 * t299 * t94 + 0.5e0 * t302 - 0.195149978e1 * t304 * t125 - 0.5e0 * t304 * t140 + 0.5e0 * t199 + 0.97574989e0 * t208 + 0.25e0 * t211 - 0.195149978e1 * t201 * t169 + 0.97574989e0 * t315 - 0.195149978e1 * t317 * t318 + 0.97574989e0 * t21 * t349 - 0.97574989e0 * t261 * t353 - 0.5e0 * t201 * t179 + 0.25e0 * t359 - 0.97574989e0 * t261 * t361 - 0.5e0 * t364 * t366 + 0.25e0 * t21 * t383;
  t387 = my_piecewise3(t11, 0, t386);
  tv2rho21 = t2 * t387 + t144 + t183;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t390 = t147 * t147;
  t391 = t390 * t2;
  t395 = 0.2e1 * t88 + 0.2e1 * t192;
  t396 = my_piecewise5(t13, 0, t16, 0, t395);
  t397 = t18 * t396;
  t407 = t167 * t167;
  t408 = t78 * t407;
  t409 = t408 * t83;
  t412 = t154 * t154;
  t416 = my_piecewise5(t24, 0, t27, 0, t395);
  t417 = my_piecewise5(t42, 0, t44, 0, t416);
  t420 = t417 * t2 + 0.2e1 * t152;
  t425 = my_piecewise3(t32, 0, 0.4e1 / 0.81e2 * t100 * t222 * t412 - t100 * t103 * t420 / 0.27e2);
  t426 = t161 * t161;
  t430 = my_piecewise5(t44, 0, t42, 0, -t416);
  t433 = t430 * t2 + 0.2e1 * t159;
  t438 = my_piecewise3(t57, 0, 0.4e1 / 0.81e2 * t100 * t241 * t426 - t100 * t114 * t433 / 0.27e2);
  t440 = my_piecewise3(t68, 0, t425 + t438);
  t441 = t80 * t440;
  t442 = t441 * t83;
  t445 = t352 * t178;
  t448 = t178 * t178;
  t449 = t268 * t448;
  t452 = t274 * t407;
  t454 = t132 * t440;
  t456 = t132 * t407;
  t458 = t75 * t440;
  t460 = t75 * t407;
  t462 = t78 * t440;
  t464 = 0.866264181134753312e3 * t452 - 0.1732528362269506624e3 * t454 + 0.2286175649783555712e3 * t456 - 0.571543912445888928e2 * t458 + 0.12568923120168e2 * t460 - 0.4189641040056e1 * t462;
  t465 = t130 * t464;
  t468 = 0.5e0 * t391 * t84 + 0.5e0 * t397 * t94 + 0.1e1 * t302 - 0.390299956e1 * t304 * t169 - 0.1e1 * t304 * t179 + 0.195149978e1 * t315 + 0.5e0 * t359 - 0.195149978e1 * t21 * t409 + 0.97574989e0 * t21 * t442 - 0.195149978e1 * t261 * t445 - 0.5e0 * t21 * t449 + 0.25e0 * t21 * t465;
  t469 = my_piecewise3(t11, 0, t468);
  tv2rho22 = t2 * t469 + 0.2e1 * t183;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  tv2rhosigma0 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  tv2rhosigma3 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  tv2rhosigma5 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t11, t13, t14;
  double t16, t17, t18, t19, t20, t21, t24, t27;
  double t28, t29, t32, t33, t34, t36, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t48, t53, t57, t58, t59, t60, t61, t66;
  double t67, t68, t69, t72, t73, t74, t75, t77;
  double t78, t80, t82, t83, t84, tzk0;

  double t87, t88, t89, t90, t91, t92, t94, t97;
  double t99, t100, t103, t104, t105, t107, t111, t114;
  double t115, t117, t121, t123, t124, t125, t128, t129;
  double t130, t132, t133, t135, t139, t140, t144, tvrho0;
  double t146, t147, t148, t151, t152, t154, t158, t159;
  double t161, t165, t167, t168, t169, t172, t174, t176;
  double t178, t179, t183, tvrho1, tvsigma0, tvsigma1, tvsigma2;

  double t186, t187, t190, t191, t192, t194, t195, t196;
  double t199, t201, t206, t207, t208, t210, t211, t213;
  double t214, t215, t218, t222, t223, t227, t228, t231;
  double t236, t237, t241, t242, t246, t249, t254, t256;
  double t257, t258, t261, t262, t263, t267, t268, t269;
  double t270, t274, t275, t279, t285, t287, t288, t291;
  double t292, tv2rho20, t294, t297, t298, t299, t302, t304;
  double t314, t315, t317, t318, t325, t326, t328, t333;
  double t338, t340, t345, t347, t348, t349, t352, t353;
  double t358, t359, t361, t364, t365, t366, t369, t372;
  double t376, t380, t382, t383, t386, t387, tv2rho21, t390;
  double t391, t395, t396, t397, t407, t408, t409, t412;
  double t416, t417, t420, t425, t426, t430, t433, t438;
  double t440, t441, t442, t445, t448, t449, t452, t454;
  double t456, t458, t460, t462, t464, t465, t468, t469;
  double tv2rho22, tv2rhosigma0, tv2rhosigma1, tv2rhosigma2, tv2rhosigma3, tv2rhosigma4, tv2rhosigma5, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, tv2sigma25;

  double t472, t473, t475, t476, t479, t483, t486, t495;
  double t498, t499, t506, t507, t510, t511, t513, t515;
  double t516, t517, t518, t520, t521, t523, t524, t529;
  double t530, t531, t535, t539, t540, t541, t543, t544;
  double t545, t548, t553, t557, t558, t559, t563, t567;
  double t570, t575, t577, t579, t583, t584, t587, t604;
  double t605, t608, t609, t610, t611, t612, t616, t619;
  double t627, t628, t631, t633, t635, t637, t640, t642;
  double tv3rho30, t644, t646, t649, t650, t653, t660, t661;
  double t664, t671, t674, t677, t678, t681, t684, t685;
  double t698, t699, t702, t705, t706, t711, t712, t715;
  double t717, t719, t722, t728, t730, t734, t735, t736;
  double t737, t738, t742, t744, t746, t748, t753, t761;
  double t762, t764, t765, t770, t775, t783, t785, t786;
  double t791, t793, t795, t799, t800, t802, t803, t806;
  double t811, t819, t829, t830, t833, t836, t842, t846;
  double t847, t848, t851, t852, t855, t858, t863, t866;
  double t869, t872, tv3rho31, t882, t883, t886, t889, t890;
  double t895, t896, t899, t900, t905, t908, t911, t912;
  double t915, t916, t921, t926, t929, t930, t935, t942;
  double t944, t946, t948, t950, t951, t953, t954, t956;
  double t957, t963, t964, t967, t968, t969, t980, t984;
  double t985, t987, t992, t1001, t1005, t1007, t1012, t1014;
  double t1016, t1019, t1024, t1027, t1035, t1045, t1046, t1049;
  double t1053, t1055, t1057, t1063, t1064, t1067, t1070, t1077;
  double t1080, tv3rho32, t1083, t1086, t1089, t1100, t1103, t1106;
  double t1114, t1123, t1124, t1127, t1129, t1133, t1134, t1135;
  double t1138, t1146, t1147, t1150, t1155, t1156, t1164, t1167;
  double t1172, t1174, t1176, t1179, t1183, t1185, t1189, t1197;
  double t1198, t1201, t1210, t1212, tv3rho33, tv3rho2sigma0, tv3rho2sigma1, tv3rho2sigma2;
  double tv3rho2sigma3, tv3rho2sigma4, tv3rho2sigma5, tv3rho2sigma6, tv3rho2sigma7, tv3rho2sigma8, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, tv3rhosigma211, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, tv3sigma39;


  t1 = rho[0] - rho[1];
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t4 = t1 * t3;
  t5 = fabs(t4);
  t11 = 0.1e1 - t5 <= p->zeta_threshold || rho[0] <= p->dens_threshold && rho[1] <= p->dens_threshold;
  t13 = 0.1e1 + t4 <= p->zeta_threshold;
  t14 = p->zeta_threshold - 0.1e1;
  t16 = 0.1e1 - t4 <= p->zeta_threshold;
  t17 = -t14;
  t18 = my_piecewise5(t13, t14, t16, t17, t4);
  t19 = t18 * t18;
  t20 = 0.1e1 - t19;
  t21 = t20 * t2;
  t24 = 0.2e1 * rho[0] * t3 <= p->zeta_threshold;
  t27 = 0.2e1 * rho[1] * t3 <= p->zeta_threshold;
  t28 = my_piecewise5(t24, t14, t27, t17, t4);
  t29 = 0.1e1 + t28;
  t32 = t29 * t2 / 0.2e1 <= p->dens_threshold;
  t33 = M_CBRT3;
  t34 = t33 * t33;
  t36 = POW_1_3(0.1e1 / M_PI);
  t38 = t34 / t36;
  t39 = M_CBRT4;
  t40 = M_CBRT2;
  t41 = t39 * t40;
  t42 = t29 <= p->zeta_threshold;
  t43 = 0.1e1 - t28;
  t44 = t43 <= p->zeta_threshold;
  t45 = my_piecewise5(t42, t14, t44, t17, t28);
  t46 = 0.1e1 + t45;
  t47 = t46 * t2;
  t48 = POW_1_3(t47);
  t53 = my_piecewise3(t32, 0, t38 * t41 / t48 / 0.9e1);
  t57 = t43 * t2 / 0.2e1 <= p->dens_threshold;
  t58 = my_piecewise5(t44, t14, t42, t17, -t28);
  t59 = 0.1e1 + t58;
  t60 = t59 * t2;
  t61 = POW_1_3(t60);
  t66 = my_piecewise3(t57, 0, t38 * t41 / t61 / 0.9e1);
  t67 = t53 + t66;
  t68 = t67 == 0.e0;
  t69 = my_piecewise3(t68, DBL_EPSILON, t67);
  t72 = 0.390299956e1 / t69 + 0.5764e0;
  t73 = t69 * t69;
  t74 = t73 * t73;
  t75 = 0.1e1 / t74;
  t77 = t73 * t69;
  t78 = 0.1e1 / t77;
  t80 = 0.1e1 / t73;
  t82 = 0.433132090567376656e2 * t75 + 0.190514637481962976e2 * t78 + 0.2094820520028e1 * t80;
  t83 = 0.1e1 / t82;
  t84 = t72 * t83;
  tzk0 = my_piecewise3(t11, 0, -0.25e0 * t21 * t84);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t87 = t2 * t2;
  t88 = 0.1e1 / t87;
  t89 = t1 * t88;
  t90 = t3 - t89;
  t91 = my_piecewise5(t13, 0, t16, 0, t90);
  t92 = t18 * t91;
  t94 = t2 * t72 * t83;
  t97 = t20 * t72;
  t99 = 0.25e0 * t97 * t83;
  t100 = t38 * t39;
  t103 = t40 / t48 / t47;
  t104 = my_piecewise5(t24, 0, t27, 0, t90);
  t105 = my_piecewise5(t42, 0, t44, 0, t104);
  t107 = t105 * t2 + t45 + 0.1e1;
  t111 = my_piecewise3(t32, 0, -t100 * t103 * t107 / 0.27e2);
  t114 = t40 / t61 / t60;
  t115 = my_piecewise5(t44, 0, t42, 0, -t104);
  t117 = t115 * t2 + t58 + 0.1e1;
  t121 = my_piecewise3(t57, 0, -t100 * t114 * t117 / 0.27e2);
  t123 = my_piecewise3(t68, 0, t111 + t121);
  t124 = t80 * t123;
  t125 = t124 * t83;
  t128 = t82 * t82;
  t129 = 0.1e1 / t128;
  t130 = t72 * t129;
  t132 = 0.1e1 / t74 / t69;
  t133 = t132 * t123;
  t135 = t75 * t123;
  t139 = -0.1732528362269506624e3 * t133 - 0.571543912445888928e2 * t135 - 0.4189641040056e1 * t78 * t123;
  t140 = t130 * t139;
  t144 = my_piecewise3(t11, 0, 0.5e0 * t92 * t94 - t99 + 0.97574989e0 * t21 * t125 + 0.25e0 * t21 * t140);
  tvrho0 = t2 * t144 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = -t3 - t89;
  t147 = my_piecewise5(t13, 0, t16, 0, t146);
  t148 = t18 * t147;
  t151 = my_piecewise5(t24, 0, t27, 0, t146);
  t152 = my_piecewise5(t42, 0, t44, 0, t151);
  t154 = t152 * t2 + t45 + 0.1e1;
  t158 = my_piecewise3(t32, 0, -t100 * t103 * t154 / 0.27e2);
  t159 = my_piecewise5(t44, 0, t42, 0, -t151);
  t161 = t159 * t2 + t58 + 0.1e1;
  t165 = my_piecewise3(t57, 0, -t100 * t114 * t161 / 0.27e2);
  t167 = my_piecewise3(t68, 0, t158 + t165);
  t168 = t80 * t167;
  t169 = t168 * t83;
  t172 = t132 * t167;
  t174 = t75 * t167;
  t176 = t78 * t167;
  t178 = -0.1732528362269506624e3 * t172 - 0.571543912445888928e2 * t174 - 0.4189641040056e1 * t176;
  t179 = t130 * t178;
  t183 = my_piecewise3(t11, 0, 0.5e0 * t148 * t94 - t99 + 0.97574989e0 * t21 * t169 + 0.25e0 * t21 * t179);
  tvrho1 = t2 * t183 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  tvsigma0 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  tvsigma2 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t186 = t91 * t91;
  t187 = t186 * t2;
  t190 = t87 * t2;
  t191 = 0.1e1 / t190;
  t192 = t1 * t191;
  t194 = -0.2e1 * t88 + 0.2e1 * t192;
  t195 = my_piecewise5(t13, 0, t16, 0, t194);
  t196 = t18 * t195;
  t199 = t92 * t84;
  t201 = t92 * t2;
  t206 = t20 * t80;
  t207 = t123 * t83;
  t208 = t206 * t207;
  t210 = t129 * t139;
  t211 = t97 * t210;
  t213 = t123 * t123;
  t214 = t78 * t213;
  t215 = t214 * t83;
  t218 = t46 * t46;
  t222 = t40 / t48 / t218 / t87;
  t223 = t107 * t107;
  t227 = my_piecewise5(t24, 0, t27, 0, t194);
  t228 = my_piecewise5(t42, 0, t44, 0, t227);
  t231 = t228 * t2 + 0.2e1 * t105;
  t236 = my_piecewise3(t32, 0, 0.4e1 / 0.81e2 * t100 * t222 * t223 - t100 * t103 * t231 / 0.27e2);
  t237 = t59 * t59;
  t241 = t40 / t61 / t237 / t87;
  t242 = t117 * t117;
  t246 = my_piecewise5(t44, 0, t42, 0, -t227);
  t249 = t246 * t2 + 0.2e1 * t115;
  t254 = my_piecewise3(t57, 0, 0.4e1 / 0.81e2 * t100 * t241 * t242 - t100 * t114 * t249 / 0.27e2);
  t256 = my_piecewise3(t68, 0, t236 + t254);
  t257 = t80 * t256;
  t258 = t257 * t83;
  t261 = t21 * t80;
  t262 = t123 * t129;
  t263 = t262 * t139;
  t267 = 0.1e1 / t128 / t82;
  t268 = t72 * t267;
  t269 = t139 * t139;
  t270 = t268 * t269;
  t274 = 0.1e1 / t74 / t73;
  t275 = t274 * t213;
  t279 = t132 * t213;
  t285 = t78 * t256;
  t287 = 0.866264181134753312e3 * t275 - 0.1732528362269506624e3 * t132 * t256 + 0.2286175649783555712e3 * t279 - 0.571543912445888928e2 * t75 * t256 + 0.12568923120168e2 * t75 * t213 - 0.4189641040056e1 * t285;
  t288 = t130 * t287;
  t291 = 0.5e0 * t187 * t84 + 0.5e0 * t196 * t94 + 0.1e1 * t199 - 0.390299956e1 * t201 * t125 - 0.1e1 * t201 * t140 + 0.195149978e1 * t208 + 0.5e0 * t211 - 0.195149978e1 * t21 * t215 + 0.97574989e0 * t21 * t258 - 0.195149978e1 * t261 * t263 - 0.5e0 * t21 * t270 + 0.25e0 * t21 * t288;
  t292 = my_piecewise3(t11, 0, t291);
  tv2rho20 = t2 * t292 + 0.2e1 * t144;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t294 = t91 * t147;
  t297 = 0.2e1 * t192;
  t298 = my_piecewise5(t13, 0, t16, 0, t297);
  t299 = t18 * t298;
  t302 = t148 * t84;
  t304 = t148 * t2;
  t314 = t167 * t83;
  t315 = t206 * t314;
  t317 = t21 * t78;
  t318 = t314 * t123;
  t325 = my_piecewise5(t24, 0, t27, 0, t297);
  t326 = my_piecewise5(t42, 0, t44, 0, t325);
  t328 = t326 * t2 + t105 + t152;
  t333 = my_piecewise3(t32, 0, 0.4e1 / 0.81e2 * t100 * t222 * t154 * t107 - t100 * t103 * t328 / 0.27e2);
  t338 = my_piecewise5(t44, 0, t42, 0, -t325);
  t340 = t338 * t2 + t115 + t159;
  t345 = my_piecewise3(t57, 0, 0.4e1 / 0.81e2 * t100 * t241 * t161 * t117 - t100 * t114 * t340 / 0.27e2);
  t347 = my_piecewise3(t68, 0, t333 + t345);
  t348 = t80 * t347;
  t349 = t348 * t83;
  t352 = t167 * t129;
  t353 = t352 * t139;
  t358 = t129 * t178;
  t359 = t97 * t358;
  t361 = t262 * t178;
  t364 = t21 * t72;
  t365 = t267 * t178;
  t366 = t365 * t139;
  t369 = t274 * t167;
  t372 = t132 * t347;
  t376 = t75 * t347;
  t380 = t78 * t347;
  t382 = 0.866264181134753312e3 * t369 * t123 - 0.1732528362269506624e3 * t372 + 0.2286175649783555712e3 * t172 * t123 - 0.571543912445888928e2 * t376 + 0.12568923120168e2 * t174 * t123 - 0.4189641040056e1 * t380;
  t383 = t130 * t382;
  t386 = 0.5e0 * t294 * t94 + 0.5e0 * t299 * t94 + 0.5e0 * t302 - 0.195149978e1 * t304 * t125 - 0.5e0 * t304 * t140 + 0.5e0 * t199 + 0.97574989e0 * t208 + 0.25e0 * t211 - 0.195149978e1 * t201 * t169 + 0.97574989e0 * t315 - 0.195149978e1 * t317 * t318 + 0.97574989e0 * t21 * t349 - 0.97574989e0 * t261 * t353 - 0.5e0 * t201 * t179 + 0.25e0 * t359 - 0.97574989e0 * t261 * t361 - 0.5e0 * t364 * t366 + 0.25e0 * t21 * t383;
  t387 = my_piecewise3(t11, 0, t386);
  tv2rho21 = t2 * t387 + t144 + t183;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t390 = t147 * t147;
  t391 = t390 * t2;
  t395 = 0.2e1 * t88 + 0.2e1 * t192;
  t396 = my_piecewise5(t13, 0, t16, 0, t395);
  t397 = t18 * t396;
  t407 = t167 * t167;
  t408 = t78 * t407;
  t409 = t408 * t83;
  t412 = t154 * t154;
  t416 = my_piecewise5(t24, 0, t27, 0, t395);
  t417 = my_piecewise5(t42, 0, t44, 0, t416);
  t420 = t417 * t2 + 0.2e1 * t152;
  t425 = my_piecewise3(t32, 0, 0.4e1 / 0.81e2 * t100 * t222 * t412 - t100 * t103 * t420 / 0.27e2);
  t426 = t161 * t161;
  t430 = my_piecewise5(t44, 0, t42, 0, -t416);
  t433 = t430 * t2 + 0.2e1 * t159;
  t438 = my_piecewise3(t57, 0, 0.4e1 / 0.81e2 * t100 * t241 * t426 - t100 * t114 * t433 / 0.27e2);
  t440 = my_piecewise3(t68, 0, t425 + t438);
  t441 = t80 * t440;
  t442 = t441 * t83;
  t445 = t352 * t178;
  t448 = t178 * t178;
  t449 = t268 * t448;
  t452 = t274 * t407;
  t454 = t132 * t440;
  t456 = t132 * t407;
  t458 = t75 * t440;
  t460 = t75 * t407;
  t462 = t78 * t440;
  t464 = 0.866264181134753312e3 * t452 - 0.1732528362269506624e3 * t454 + 0.2286175649783555712e3 * t456 - 0.571543912445888928e2 * t458 + 0.12568923120168e2 * t460 - 0.4189641040056e1 * t462;
  t465 = t130 * t464;
  t468 = 0.5e0 * t391 * t84 + 0.5e0 * t397 * t94 + 0.1e1 * t302 - 0.390299956e1 * t304 * t169 - 0.1e1 * t304 * t179 + 0.195149978e1 * t315 + 0.5e0 * t359 - 0.195149978e1 * t21 * t409 + 0.97574989e0 * t21 * t442 - 0.195149978e1 * t261 * t445 - 0.5e0 * t21 * t449 + 0.25e0 * t21 * t465;
  t469 = my_piecewise3(t11, 0, t468);
  tv2rho22 = t2 * t469 + 0.2e1 * t183;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  tv2rhosigma0 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  tv2rhosigma3 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  tv2rhosigma5 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t472 = t186 * t72;
  t473 = t472 * t83;
  t475 = t256 * t129;
  t476 = t475 * t139;
  t479 = t262 * t287;
  t483 = t267 * t139 * t287;
  t486 = t196 * t2;
  t495 = t207 * t256;
  t498 = t213 * t129;
  t499 = t498 * t139;
  t506 = t123 * t267;
  t507 = t506 * t269;
  t510 = t267 * t269;
  t511 = t97 * t510;
  t513 = t196 * t84;
  t515 = 0.15e1 * t473 - 0.292724967e1 * t261 * t476 - 0.292724967e1 * t261 * t479 - 0.15e1 * t364 * t483 - 0.15e1 * t486 * t140 - 0.585449934e1 * t486 * t125 - 0.585449934e1 * t201 * t258 - 0.15e1 * t201 * t288 - 0.585449934e1 * t317 * t495 + 0.585449934e1 * t317 * t499 + 0.1170899868e2 * t201 * t215 + 0.3e1 * t201 * t270 + 0.585449934e1 * t261 * t507 - 0.15e1 * t511 + 0.15e1 * t513;
  t516 = t20 * t78;
  t517 = t213 * t83;
  t518 = t516 * t517;
  t520 = t256 * t83;
  t521 = t206 * t520;
  t523 = t129 * t287;
  t524 = t97 * t523;
  t529 = 0.1e1 / t48 / t218 / t46 / t190;
  t530 = t40 * t529;
  t531 = t223 * t107;
  t535 = t107 * t231;
  t539 = t87 * t87;
  t540 = 0.1e1 / t539;
  t541 = t1 * t540;
  t543 = 0.6e1 * t191 - 0.6e1 * t541;
  t544 = my_piecewise5(t24, 0, t27, 0, t543);
  t545 = my_piecewise5(t42, 0, t44, 0, t544);
  t548 = t545 * t2 + 0.3e1 * t228;
  t553 = my_piecewise3(t32, 0, -0.28e2 / 0.243e3 * t100 * t530 * t531 + 0.4e1 / 0.27e2 * t100 * t222 * t535 - t100 * t103 * t548 / 0.27e2);
  t557 = 0.1e1 / t61 / t237 / t59 / t190;
  t558 = t40 * t557;
  t559 = t242 * t117;
  t563 = t117 * t249;
  t567 = my_piecewise5(t44, 0, t42, 0, -t544);
  t570 = t567 * t2 + 0.3e1 * t246;
  t575 = my_piecewise3(t57, 0, -0.28e2 / 0.243e3 * t100 * t558 * t559 + 0.4e1 / 0.27e2 * t100 * t241 * t563 - t100 * t114 * t570 / 0.27e2);
  t577 = my_piecewise3(t68, 0, t553 + t575);
  t579 = t80 * t577 * t83;
  t583 = 0.1e1 / t74 / t77;
  t584 = t213 * t123;
  t587 = t274 * t123;
  t604 = -0.5197585086808519872e4 * t583 * t584 + 0.2598792543404259936e4 * t587 * t256 - 0.1732528362269506624e3 * t132 * t577 - 0.1143087824891777856e4 * t274 * t584 + 0.6858526949350667136e3 * t133 * t256 - 0.571543912445888928e2 * t75 * t577 - 0.50275692480672e2 * t132 * t584 + 0.37706769360504e2 * t135 * t256 - 0.4189641040056e1 * t78 * t577;
  t605 = t130 * t604;
  t608 = t128 * t128;
  t609 = 0.1e1 / t608;
  t610 = t72 * t609;
  t611 = t269 * t139;
  t612 = t610 * t611;
  t616 = t75 * t584 * t83;
  t619 = t91 * t2;
  t627 = my_piecewise5(t13, 0, t16, 0, t543);
  t628 = t18 * t627;
  t631 = t92 * t140;
  t633 = t92 * t125;
  t635 = t206 * t263;
  t637 = t124 * t210;
  t640 = -0.585449934e1 * t518 + 0.292724967e1 * t521 + 0.75e0 * t524 + 0.97574989e0 * t21 * t579 + 0.25e0 * t21 * t605 + 0.15e1 * t21 * t612 + 0.585449934e1 * t21 * t616 + 0.15e1 * t619 * t84 * t195 - 0.15e1 * t187 * t140 - 0.585449934e1 * t187 * t125 + 0.5e0 * t628 * t94 - 0.3e1 * t631 - 0.1170899868e2 * t633 - 0.585449934e1 * t635 + 0.1170899868e2 * t201 * t637;
  t642 = my_piecewise3(t11, 0, t515 + t640);
  tv3rho30 = t2 * t642 + 0.3e1 * t292;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t644 = 0.2e1 * t387;
  t646 = t294 * t2;
  t649 = t167 * t267;
  t650 = t649 * t269;
  t653 = t498 * t178;
  t660 = t21 * t75;
  t661 = t314 * t213;
  t664 = t352 * t287;
  t671 = t475 * t178;
  t674 = t262 * t382;
  t677 = t267 * t382;
  t678 = t677 * t139;
  t681 = t365 * t287;
  t684 = 0.5e0 * t473 - 0.390299956e1 * t646 * t125 + 0.195149978e1 * t261 * t650 + 0.195149978e1 * t317 * t653 + 0.390299956e1 * t304 * t215 + 0.1e1 * t304 * t270 + 0.585449934e1 * t660 * t661 - 0.97574989e0 * t261 * t664 - 0.5e0 * t486 * t179 - 0.1e1 * t201 * t383 - 0.97574989e0 * t261 * t671 - 0.195149978e1 * t261 * t674 - 0.1e1 * t364 * t678 - 0.5e0 * t364 * t681;
  t685 = t299 * t2;
  t698 = t347 * t83;
  t699 = t698 * t123;
  t702 = t314 * t256;
  t705 = t347 * t129;
  t706 = t705 * t139;
  t711 = t609 * t178;
  t712 = t711 * t269;
  t715 = t129 * t382;
  t717 = 0.5e0 * t97 * t715;
  t719 = 0.195149978e1 * t206 * t698;
  t722 = -0.1e1 * t685 * t140 - 0.390299956e1 * t685 * t125 - 0.195149978e1 * t304 * t258 - 0.5e0 * t304 * t288 - 0.195149978e1 * t486 * t169 - 0.390299956e1 * t201 * t349 - 0.390299956e1 * t317 * t699 - 0.195149978e1 * t317 * t702 - 0.195149978e1 * t261 * t706 - 0.1e1 * t646 * t140 + 0.15e1 * t364 * t712 + t717 + t719 - 0.5e0 * t511 + 0.5e0 * t513;
  t728 = 0.1e1 * t299 * t84;
  t730 = 0.1e1 * t294 * t84;
  t734 = 0.2e1 * t191;
  t735 = 0.6e1 * t541;
  t736 = t734 - t735;
  t737 = my_piecewise5(t13, 0, t16, 0, t736);
  t738 = t18 * t737;
  t742 = 0.1e1 * t148 * t140;
  t744 = 0.390299956e1 * t148 * t125;
  t746 = 0.390299956e1 * t516 * t318;
  t748 = 0.195149978e1 * t206 * t353;
  t753 = t328 * t107;
  t761 = my_piecewise5(t24, 0, t27, 0, t736);
  t762 = my_piecewise5(t42, 0, t44, 0, t761);
  t764 = 0.2e1 * t326;
  t765 = t762 * t2 + t228 + t764;
  t770 = my_piecewise3(t32, 0, -0.28e2 / 0.243e3 * t100 * t530 * t154 * t223 + 0.8e1 / 0.81e2 * t100 * t222 * t753 + 0.4e1 / 0.81e2 * t100 * t222 * t154 * t231 - t100 * t103 * t765 / 0.27e2);
  t775 = t340 * t117;
  t783 = my_piecewise5(t44, 0, t42, 0, -t761);
  t785 = 0.2e1 * t338;
  t786 = t783 * t2 + t246 + t785;
  t791 = my_piecewise3(t57, 0, -0.28e2 / 0.243e3 * t100 * t558 * t161 * t242 + 0.8e1 / 0.81e2 * t100 * t241 * t775 + 0.4e1 / 0.81e2 * t100 * t241 * t161 * t249 - t100 * t114 * t786 / 0.27e2);
  t793 = my_piecewise3(t68, 0, t770 + t791);
  t795 = t80 * t793 * t83;
  t799 = 0.1e1 * t97 * t366;
  t800 = -0.195149978e1 * t518 + 0.97574989e0 * t521 + 0.25e0 * t524 + t728 + t730 - 0.1e1 * t631 - 0.390299956e1 * t633 - 0.195149978e1 * t635 + 0.5e0 * t738 * t94 - t742 - t744 - t746 - t748 + 0.97574989e0 * t21 * t795 - t799;
  t802 = 0.195149978e1 * t206 * t361;
  t803 = t583 * t167;
  t806 = t274 * t347;
  t811 = t132 * t793;
  t819 = t75 * t793;
  t829 = -0.5197585086808519872e4 * t803 * t213 + 0.1732528362269506624e4 * t806 * t123 + 0.866264181134753312e3 * t369 * t256 - 0.1732528362269506624e3 * t811 - 0.1143087824891777856e4 * t369 * t213 + 0.4572351299567111424e3 * t372 * t123 + 0.2286175649783555712e3 * t172 * t256 - 0.571543912445888928e2 * t819 - 0.50275692480672e2 * t172 * t213 + 0.25137846240336e2 * t376 * t123 + 0.12568923120168e2 * t174 * t256 - 0.4189641040056e1 * t78 * t793;
  t830 = t130 * t829;
  t833 = t195 * t147;
  t836 = t91 * t298;
  t842 = 0.1e1 * t92 * t179;
  t846 = 0.390299956e1 * t92 * t169;
  t847 = t123 * t139;
  t848 = t352 * t847;
  t851 = t178 * t139;
  t852 = t268 * t851;
  t855 = t124 * t358;
  t858 = t506 * t851;
  t863 = t176 * t207;
  t866 = t168 * t210;
  t869 = -t802 + 0.25e0 * t21 * t830 + 0.5e0 * t833 * t94 + 0.1e1 * t836 * t94 - 0.5e0 * t187 * t179 - t842 - 0.195149978e1 * t187 * t169 - t846 + 0.390299956e1 * t317 * t848 + 0.2e1 * t201 * t852 + 0.390299956e1 * t201 * t855 + 0.390299956e1 * t261 * t858 + 0.390299956e1 * t304 * t637 + 0.780599912e1 * t201 * t863 + 0.390299956e1 * t201 * t866;
  t872 = my_piecewise3(t11, 0, t684 + t722 + t800 + t869);
  tv3rho31 = t2 * t872 + t292 + t644;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t882 = t407 * t83;
  t883 = t882 * t123;
  t886 = t314 * t347;
  t889 = t407 * t129;
  t890 = t889 * t139;
  t895 = t440 * t83;
  t896 = t895 * t123;
  t899 = t440 * t129;
  t900 = t899 * t139;
  t905 = t705 * t178;
  t908 = t352 * t382;
  t911 = t609 * t448;
  t912 = t911 * t139;
  t915 = -0.390299956e1 * t304 * t349 - 0.1e1 * t646 * t179 - 0.1e1 * t685 * t179 - 0.1e1 * t304 * t383 + 0.585449934e1 * t660 * t883 - 0.390299956e1 * t317 * t886 + 0.195149978e1 * t317 * t890 + 0.390299956e1 * t201 * t409 - 0.195149978e1 * t317 * t896 - 0.97574989e0 * t261 * t900 - 0.195149978e1 * t201 * t442 - 0.195149978e1 * t261 * t905 - 0.195149978e1 * t261 * t908 + 0.15e1 * t364 * t912;
  t916 = t397 * t2;
  t921 = t365 * t382;
  t926 = t506 * t448;
  t929 = t267 * t464;
  t930 = t929 * t139;
  t935 = t262 * t464;
  t942 = t397 * t84;
  t944 = t516 * t882;
  t946 = t206 * t895;
  t948 = -0.5e0 * t916 * t140 - 0.195149978e1 * t916 * t125 - 0.1e1 * t364 * t921 + 0.1e1 * t201 * t449 + 0.195149978e1 * t261 * t926 - 0.5e0 * t364 * t930 - 0.5e0 * t201 * t465 - 0.97574989e0 * t261 * t935 - 0.390299956e1 * t646 * t169 - 0.390299956e1 * t685 * t169 + t717 + t719 + 0.5e0 * t942 - 0.195149978e1 * t944 + 0.97574989e0 * t946;
  t950 = t267 * t448;
  t951 = t97 * t950;
  t953 = t129 * t464;
  t954 = t97 * t953;
  t956 = t390 * t72;
  t957 = t956 * t83;
  t963 = -0.5e0 * t951 + 0.25e0 * t954 + t728 + t730 + 0.5e0 * t957 - t742 - t744 - t746 - t748 - t799 - t802 - t842 - t846 - 0.5e0 * t391 * t140 - 0.195149978e1 * t391 * t125;
  t964 = t91 * t396;
  t967 = -t734 - t735;
  t968 = my_piecewise5(t13, 0, t16, 0, t967);
  t969 = t18 * t968;
  t980 = t420 * t107;
  t984 = my_piecewise5(t24, 0, t27, 0, t967);
  t985 = my_piecewise5(t42, 0, t44, 0, t984);
  t987 = t985 * t2 + t417 + t764;
  t992 = my_piecewise3(t32, 0, -0.28e2 / 0.243e3 * t100 * t530 * t412 * t107 + 0.8e1 / 0.81e2 * t100 * t222 * t154 * t328 + 0.4e1 / 0.81e2 * t100 * t222 * t980 - t100 * t103 * t987 / 0.27e2);
  t1001 = t433 * t117;
  t1005 = my_piecewise5(t44, 0, t42, 0, -t984);
  t1007 = t1005 * t2 + t430 + t785;
  t1012 = my_piecewise3(t57, 0, -0.28e2 / 0.243e3 * t100 * t558 * t426 * t117 + 0.8e1 / 0.81e2 * t100 * t241 * t161 * t340 + 0.4e1 / 0.81e2 * t100 * t241 * t1001 - t100 * t114 * t1007 / 0.27e2);
  t1014 = my_piecewise3(t68, 0, t992 + t1012);
  t1016 = t80 * t1014 * t83;
  t1019 = t583 * t407;
  t1024 = t274 * t440;
  t1027 = t132 * t1014;
  t1035 = t75 * t1014;
  t1045 = -0.5197585086808519872e4 * t1019 * t123 + 0.1732528362269506624e4 * t369 * t347 + 0.866264181134753312e3 * t1024 * t123 - 0.1732528362269506624e3 * t1027 - 0.1143087824891777856e4 * t452 * t123 + 0.4572351299567111424e3 * t172 * t347 + 0.2286175649783555712e3 * t454 * t123 - 0.571543912445888928e2 * t1035 - 0.50275692480672e2 * t456 * t123 + 0.25137846240336e2 * t174 * t347 + 0.12568923120168e2 * t458 * t123 - 0.4189641040056e1 * t78 * t1014;
  t1046 = t130 * t1045;
  t1049 = t147 * t2;
  t1053 = t148 * t169;
  t1055 = t148 * t179;
  t1057 = t206 * t445;
  t1063 = t178 * t123;
  t1064 = t352 * t1063;
  t1067 = t649 * t851;
  t1070 = t168 * t358;
  t1077 = 0.5e0 * t964 * t94 + 0.5e0 * t969 * t94 + 0.97574989e0 * t21 * t1016 + 0.25e0 * t21 * t1046 + 0.1e1 * t1049 * t84 * t298 - 0.390299956e1 * t1053 - 0.1e1 * t1055 - 0.195149978e1 * t1057 + 0.2e1 * t304 * t852 + 0.390299956e1 * t304 * t855 + 0.390299956e1 * t317 * t1064 + 0.390299956e1 * t261 * t1067 + 0.390299956e1 * t201 * t1070 + 0.780599912e1 * t304 * t863 + 0.390299956e1 * t304 * t866;
  t1080 = my_piecewise3(t11, 0, t915 + t948 + t963 + t1077);
  tv3rho32 = t2 * t1080 + t469 + t644;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1083 = t899 * t178;
  t1086 = t352 * t464;
  t1089 = t365 * t464;
  t1100 = t314 * t440;
  t1103 = t889 * t178;
  t1106 = t649 * t448;
  t1114 = -0.292724967e1 * t261 * t1083 - 0.292724967e1 * t261 * t1086 - 0.15e1 * t364 * t1089 - 0.15e1 * t916 * t179 - 0.585449934e1 * t916 * t169 - 0.585449934e1 * t304 * t442 - 0.15e1 * t304 * t465 - 0.585449934e1 * t317 * t1100 + 0.585449934e1 * t317 * t1103 + 0.585449934e1 * t261 * t1106 + 0.15e1 * t942 - 0.585449934e1 * t944 + 0.292724967e1 * t946 - 0.15e1 * t951 + 0.75e0 * t954;
  t1123 = t448 * t178;
  t1124 = t610 * t1123;
  t1127 = t407 * t167;
  t1129 = t75 * t1127 * t83;
  t1133 = -0.6e1 * t191 - 0.6e1 * t541;
  t1134 = my_piecewise5(t13, 0, t16, 0, t1133);
  t1135 = t18 * t1134;
  t1138 = t412 * t154;
  t1146 = my_piecewise5(t24, 0, t27, 0, t1133);
  t1147 = my_piecewise5(t42, 0, t44, 0, t1146);
  t1150 = t1147 * t2 + 0.3e1 * t417;
  t1155 = my_piecewise3(t32, 0, -0.28e2 / 0.243e3 * t100 * t530 * t1138 + 0.4e1 / 0.27e2 * t100 * t222 * t154 * t420 - t100 * t103 * t1150 / 0.27e2);
  t1156 = t426 * t161;
  t1164 = my_piecewise5(t44, 0, t42, 0, -t1146);
  t1167 = t1164 * t2 + 0.3e1 * t430;
  t1172 = my_piecewise3(t57, 0, -0.28e2 / 0.243e3 * t100 * t558 * t1156 + 0.4e1 / 0.27e2 * t100 * t241 * t161 * t433 - t100 * t114 * t1167 / 0.27e2);
  t1174 = my_piecewise3(t68, 0, t1155 + t1172);
  t1176 = t80 * t1174 * t83;
  t1179 = t583 * t1127;
  t1183 = t132 * t1174;
  t1185 = t274 * t1127;
  t1189 = t75 * t1174;
  t1197 = -0.5197585086808519872e4 * t1179 + 0.2598792543404259936e4 * t369 * t440 - 0.1732528362269506624e3 * t1183 - 0.1143087824891777856e4 * t1185 + 0.6858526949350667136e3 * t172 * t440 - 0.571543912445888928e2 * t1189 - 0.50275692480672e2 * t132 * t1127 + 0.37706769360504e2 * t174 * t440 - 0.4189641040056e1 * t78 * t1174;
  t1198 = t130 * t1197;
  t1201 = t84 * t396;
  t1210 = 0.1170899868e2 * t304 * t409 + 0.3e1 * t304 * t449 + 0.15e1 * t957 - 0.1170899868e2 * t1053 - 0.3e1 * t1055 - 0.585449934e1 * t1057 + 0.15e1 * t21 * t1124 + 0.585449934e1 * t21 * t1129 + 0.5e0 * t1135 * t94 + 0.97574989e0 * t21 * t1176 + 0.25e0 * t21 * t1198 + 0.15e1 * t1049 * t1201 - 0.15e1 * t391 * t179 - 0.585449934e1 * t391 * t169 + 0.1170899868e2 * t304 * t1070;
  t1212 = my_piecewise3(t11, 0, t1114 + t1210);
  tv3rho33 = t2 * t1212 + 0.3e1 * t469;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  tv3rho2sigma0 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  tv3rho2sigma2 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  tv3rho2sigma3 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  tv3rho2sigma5 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  tv3rho2sigma6 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  tv3rho2sigma8 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rhosigma20 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  tv3sigma30 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t11, t13, t14;
  double t16, t17, t18, t19, t20, t21, t24, t27;
  double t28, t29, t32, t33, t34, t36, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t48, t53, t57, t58, t59, t60, t61, t66;
  double t67, t68, t69, t72, t73, t74, t75, t77;
  double t78, t80, t82, t83, t84, tzk0;

  double t87, t88, t89, t90, t91, t92, t94, t97;
  double t99, t100, t103, t104, t105, t107, t111, t114;
  double t115, t117, t121, t123, t124, t125, t128, t129;
  double t130, t132, t133, t135, t139, t140, t144, tvrho0;
  double t146, t147, t148, t151, t152, t154, t158, t159;
  double t161, t165, t167, t168, t169, t172, t174, t176;
  double t178, t179, t183, tvrho1, tvsigma0, tvsigma1, tvsigma2;

  double t186, t187, t190, t191, t192, t194, t195, t196;
  double t199, t201, t206, t207, t208, t210, t211, t213;
  double t214, t215, t218, t222, t223, t227, t228, t231;
  double t236, t237, t241, t242, t246, t249, t254, t256;
  double t257, t258, t261, t262, t263, t267, t268, t269;
  double t270, t274, t275, t279, t285, t287, t288, t291;
  double t292, tv2rho20, t294, t297, t298, t299, t302, t304;
  double t314, t315, t317, t318, t325, t326, t328, t333;
  double t338, t340, t345, t347, t348, t349, t352, t353;
  double t358, t359, t361, t364, t365, t366, t369, t372;
  double t376, t380, t382, t383, t386, t387, tv2rho21, t390;
  double t391, t395, t396, t397, t407, t408, t409, t412;
  double t416, t417, t420, t425, t426, t430, t433, t438;
  double t440, t441, t442, t445, t448, t449, t452, t454;
  double t456, t458, t460, t462, t464, t465, t468, t469;
  double tv2rho22, tv2rhosigma0, tv2rhosigma1, tv2rhosigma2, tv2rhosigma3, tv2rhosigma4, tv2rhosigma5, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, tv2sigma25;

  double t472, t473, t475, t476, t479, t483, t486, t495;
  double t498, t499, t506, t507, t510, t511, t513, t515;
  double t516, t517, t518, t520, t521, t523, t524, t529;
  double t530, t531, t535, t539, t540, t541, t543, t544;
  double t545, t548, t553, t557, t558, t559, t563, t567;
  double t570, t575, t577, t579, t583, t584, t587, t604;
  double t605, t608, t609, t610, t611, t612, t616, t619;
  double t627, t628, t631, t633, t635, t637, t640, t642;
  double tv3rho30, t644, t646, t649, t650, t653, t660, t661;
  double t664, t671, t674, t677, t678, t681, t684, t685;
  double t698, t699, t702, t705, t706, t711, t712, t715;
  double t717, t719, t722, t728, t730, t734, t735, t736;
  double t737, t738, t742, t744, t746, t748, t753, t761;
  double t762, t764, t765, t770, t775, t783, t785, t786;
  double t791, t793, t795, t799, t800, t802, t803, t806;
  double t811, t819, t829, t830, t833, t836, t842, t846;
  double t847, t848, t851, t852, t855, t858, t863, t866;
  double t869, t872, tv3rho31, t882, t883, t886, t889, t890;
  double t895, t896, t899, t900, t905, t908, t911, t912;
  double t915, t916, t921, t926, t929, t930, t935, t942;
  double t944, t946, t948, t950, t951, t953, t954, t956;
  double t957, t963, t964, t967, t968, t969, t980, t984;
  double t985, t987, t992, t1001, t1005, t1007, t1012, t1014;
  double t1016, t1019, t1024, t1027, t1035, t1045, t1046, t1049;
  double t1053, t1055, t1057, t1063, t1064, t1067, t1070, t1077;
  double t1080, tv3rho32, t1083, t1086, t1089, t1100, t1103, t1106;
  double t1114, t1123, t1124, t1127, t1129, t1133, t1134, t1135;
  double t1138, t1146, t1147, t1150, t1155, t1156, t1164, t1167;
  double t1172, t1174, t1176, t1179, t1183, t1185, t1189, t1197;
  double t1198, t1201, t1210, t1212, tv3rho33, tv3rho2sigma0, tv3rho2sigma1, tv3rho2sigma2;
  double tv3rho2sigma3, tv3rho2sigma4, tv3rho2sigma5, tv3rho2sigma6, tv3rho2sigma7, tv3rho2sigma8, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, tv3rhosigma211, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, tv3sigma39;

  double t1215, t1217, t1219, t1225, t1227, t1229, t1230, t1232;
  double t1235, t1237, t1238, t1241, t1243, t1244, t1245, t1251;
  double t1256, t1260, t1261, t1269, t1279, t1281, t1282, t1283;
  double t1291, t1292, t1296, t1297, t1305, t1313, t1321, t1323;
  double t1346, t1353, t1357, t1359, t1361, t1369, t1370, t1372;
  double t1376, t1380, t1386, t1392, t1396, t1398, t1401, t1402;
  double t1403, t1407, t1411, t1413, t1416, t1418, t1419, t1422;
  double t1425, t1433, t1459, t1467, t1473, t1477, t1481, t1492;
  double t1495, t1501, t1504, t1508, t1511, t1516, t1519, t1522;
  double tv4rho40, t1525, t1526, t1529, t1530, t1541, t1542, t1545;
  double t1554, t1560, t1561, t1570, t1571, t1577, t1578, t1598;
  double t1601, t1607, t1615, t1627, t1629, t1643, t1662, t1666;
  double t1673, t1682, t1683, t1688, t1689, t1691, t1692, t1695;
  double t1698, t1700, t1702, t1704, t1706, t1708, t1709, t1711;
  double t1721, t1728, t1730, t1732, t1734, t1736, t1738, t1740;
  double t1742, t1744, t1754, t1755, t1771, t1772, t1773, t1774;
  double t1775, t1783, t1792, t1808, t1816, t1818, t1823, t1825;
  double t1827, t1829, t1877, t1882, t1891, t1898, t1902, t1904;
  double t1906, t1908, t1910, t1912, t1914, t1916, t1918, t1920;
  double t1929, t1981, t1988, t1993, t2000, t2003, t2005, t2016;
  double t2021, t2026, t2039, t2043, tv4rho41, t2051, t2054, t2077;
  double t2086, t2111, t2114, t2116, t2141, t2144, t2151, t2158;
  double t2161, t2167, t2170, t2176, t2177, t2183, t2186, t2187;
  double t2190, t2196, t2197, t2210, t2214, t2217, t2221, t2224;
  double t2227, t2232, t2236, t2260, t2291, t2297, t2300, t2304;
  double t2307, t2309, t2312, t2314, t2325, t2355, t2359, t2361;
  double t2373, t2380, t2397, t2406, t2410, t2412, t2414, t2417;
  double t2419, t2421, t2422, t2424, t2425, t2427, t2440, t2455;
  double t2457, t2459, t2461, t2463, t2465, t2467, t2469, t2471;
  double t2473, t2475, t2477, t2479, t2481, t2494, t2514, t2515;
  double t2524, t2536, t2556, t2565, t2567, t2572, t2574, t2576;
  double t2578, t2580, t2582, t2584, t2592, t2615, t2645, t2661;
  double t2662, t2664, t2666, t2672, t2674, t2686, t2691, tv4rho42;
  double t2718, t2728, t2734, t2735, t2743, t2756, t2764, t2777;
  double t2790, t2799, t2824, t2826, t2828, t2830, t2832, t2834;
  double t2836, t2838, t2840, t2842, t2844, t2846, t2847, t2852;
  double t2853, t2880, t2881, t2889, t2913, t2921, t2923, t2973;
  double t2988, t3013, t3026, t3033, t3068, t3086, t3091, t3095;
  double t3113, t3124, t3126, t3128, t3131, t3134, t3136, t3138;
  double t3141, t3146, t3167, t3171, tv4rho43, t3216, t3243, t3260;
  double t3262, t3270, t3279, t3280, t3281, t3289, t3290, t3298;
  double t3306, t3314, t3316, t3321, t3326, t3353, t3375, t3379;
  double t3386, t3393, t3410, t3414, t3417, tv4rho44, tv4rho3sigma0, tv4rho3sigma1;
  double tv4rho3sigma2, tv4rho3sigma3, tv4rho3sigma4, tv4rho3sigma5, tv4rho3sigma6, tv4rho3sigma7, tv4rho3sigma8, tv4rho3sigma9;
  double tv4rho3sigma10, tv4rho3sigma11, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, tv4rho2sigma25;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, tv4rho2sigma211, tv4rho2sigma212, tv4rho2sigma213;
  double tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, tv4rho2sigma217, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33;
  double tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, tv4rhosigma39, tv4rhosigma310, tv4rhosigma311;
  double tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, tv4rhosigma319;
  double tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47;
  double tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, tv4sigma414;


  t1 = rho[0] - rho[1];
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t4 = t1 * t3;
  t5 = fabs(t4);
  t11 = 0.1e1 - t5 <= p->zeta_threshold || rho[0] <= p->dens_threshold && rho[1] <= p->dens_threshold;
  t13 = 0.1e1 + t4 <= p->zeta_threshold;
  t14 = p->zeta_threshold - 0.1e1;
  t16 = 0.1e1 - t4 <= p->zeta_threshold;
  t17 = -t14;
  t18 = my_piecewise5(t13, t14, t16, t17, t4);
  t19 = t18 * t18;
  t20 = 0.1e1 - t19;
  t21 = t20 * t2;
  t24 = 0.2e1 * rho[0] * t3 <= p->zeta_threshold;
  t27 = 0.2e1 * rho[1] * t3 <= p->zeta_threshold;
  t28 = my_piecewise5(t24, t14, t27, t17, t4);
  t29 = 0.1e1 + t28;
  t32 = t29 * t2 / 0.2e1 <= p->dens_threshold;
  t33 = M_CBRT3;
  t34 = t33 * t33;
  t36 = POW_1_3(0.1e1 / M_PI);
  t38 = t34 / t36;
  t39 = M_CBRT4;
  t40 = M_CBRT2;
  t41 = t39 * t40;
  t42 = t29 <= p->zeta_threshold;
  t43 = 0.1e1 - t28;
  t44 = t43 <= p->zeta_threshold;
  t45 = my_piecewise5(t42, t14, t44, t17, t28);
  t46 = 0.1e1 + t45;
  t47 = t46 * t2;
  t48 = POW_1_3(t47);
  t53 = my_piecewise3(t32, 0, t38 * t41 / t48 / 0.9e1);
  t57 = t43 * t2 / 0.2e1 <= p->dens_threshold;
  t58 = my_piecewise5(t44, t14, t42, t17, -t28);
  t59 = 0.1e1 + t58;
  t60 = t59 * t2;
  t61 = POW_1_3(t60);
  t66 = my_piecewise3(t57, 0, t38 * t41 / t61 / 0.9e1);
  t67 = t53 + t66;
  t68 = t67 == 0.e0;
  t69 = my_piecewise3(t68, DBL_EPSILON, t67);
  t72 = 0.390299956e1 / t69 + 0.5764e0;
  t73 = t69 * t69;
  t74 = t73 * t73;
  t75 = 0.1e1 / t74;
  t77 = t73 * t69;
  t78 = 0.1e1 / t77;
  t80 = 0.1e1 / t73;
  t82 = 0.433132090567376656e2 * t75 + 0.190514637481962976e2 * t78 + 0.2094820520028e1 * t80;
  t83 = 0.1e1 / t82;
  t84 = t72 * t83;
  tzk0 = my_piecewise3(t11, 0, -0.25e0 * t21 * t84);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t87 = t2 * t2;
  t88 = 0.1e1 / t87;
  t89 = t1 * t88;
  t90 = t3 - t89;
  t91 = my_piecewise5(t13, 0, t16, 0, t90);
  t92 = t18 * t91;
  t94 = t2 * t72 * t83;
  t97 = t20 * t72;
  t99 = 0.25e0 * t97 * t83;
  t100 = t38 * t39;
  t103 = t40 / t48 / t47;
  t104 = my_piecewise5(t24, 0, t27, 0, t90);
  t105 = my_piecewise5(t42, 0, t44, 0, t104);
  t107 = t105 * t2 + t45 + 0.1e1;
  t111 = my_piecewise3(t32, 0, -t100 * t103 * t107 / 0.27e2);
  t114 = t40 / t61 / t60;
  t115 = my_piecewise5(t44, 0, t42, 0, -t104);
  t117 = t115 * t2 + t58 + 0.1e1;
  t121 = my_piecewise3(t57, 0, -t100 * t114 * t117 / 0.27e2);
  t123 = my_piecewise3(t68, 0, t111 + t121);
  t124 = t80 * t123;
  t125 = t124 * t83;
  t128 = t82 * t82;
  t129 = 0.1e1 / t128;
  t130 = t72 * t129;
  t132 = 0.1e1 / t74 / t69;
  t133 = t132 * t123;
  t135 = t75 * t123;
  t139 = -0.1732528362269506624e3 * t133 - 0.571543912445888928e2 * t135 - 0.4189641040056e1 * t78 * t123;
  t140 = t130 * t139;
  t144 = my_piecewise3(t11, 0, 0.5e0 * t92 * t94 - t99 + 0.97574989e0 * t21 * t125 + 0.25e0 * t21 * t140);
  tvrho0 = t2 * t144 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = -t3 - t89;
  t147 = my_piecewise5(t13, 0, t16, 0, t146);
  t148 = t18 * t147;
  t151 = my_piecewise5(t24, 0, t27, 0, t146);
  t152 = my_piecewise5(t42, 0, t44, 0, t151);
  t154 = t152 * t2 + t45 + 0.1e1;
  t158 = my_piecewise3(t32, 0, -t100 * t103 * t154 / 0.27e2);
  t159 = my_piecewise5(t44, 0, t42, 0, -t151);
  t161 = t159 * t2 + t58 + 0.1e1;
  t165 = my_piecewise3(t57, 0, -t100 * t114 * t161 / 0.27e2);
  t167 = my_piecewise3(t68, 0, t158 + t165);
  t168 = t80 * t167;
  t169 = t168 * t83;
  t172 = t132 * t167;
  t174 = t75 * t167;
  t176 = t78 * t167;
  t178 = -0.1732528362269506624e3 * t172 - 0.571543912445888928e2 * t174 - 0.4189641040056e1 * t176;
  t179 = t130 * t178;
  t183 = my_piecewise3(t11, 0, 0.5e0 * t148 * t94 - t99 + 0.97574989e0 * t21 * t169 + 0.25e0 * t21 * t179);
  tvrho1 = t2 * t183 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  tvsigma0 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  tvsigma2 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t186 = t91 * t91;
  t187 = t186 * t2;
  t190 = t87 * t2;
  t191 = 0.1e1 / t190;
  t192 = t1 * t191;
  t194 = -0.2e1 * t88 + 0.2e1 * t192;
  t195 = my_piecewise5(t13, 0, t16, 0, t194);
  t196 = t18 * t195;
  t199 = t92 * t84;
  t201 = t92 * t2;
  t206 = t20 * t80;
  t207 = t123 * t83;
  t208 = t206 * t207;
  t210 = t129 * t139;
  t211 = t97 * t210;
  t213 = t123 * t123;
  t214 = t78 * t213;
  t215 = t214 * t83;
  t218 = t46 * t46;
  t222 = t40 / t48 / t218 / t87;
  t223 = t107 * t107;
  t227 = my_piecewise5(t24, 0, t27, 0, t194);
  t228 = my_piecewise5(t42, 0, t44, 0, t227);
  t231 = t228 * t2 + 0.2e1 * t105;
  t236 = my_piecewise3(t32, 0, 0.4e1 / 0.81e2 * t100 * t222 * t223 - t100 * t103 * t231 / 0.27e2);
  t237 = t59 * t59;
  t241 = t40 / t61 / t237 / t87;
  t242 = t117 * t117;
  t246 = my_piecewise5(t44, 0, t42, 0, -t227);
  t249 = t246 * t2 + 0.2e1 * t115;
  t254 = my_piecewise3(t57, 0, 0.4e1 / 0.81e2 * t100 * t241 * t242 - t100 * t114 * t249 / 0.27e2);
  t256 = my_piecewise3(t68, 0, t236 + t254);
  t257 = t80 * t256;
  t258 = t257 * t83;
  t261 = t21 * t80;
  t262 = t123 * t129;
  t263 = t262 * t139;
  t267 = 0.1e1 / t128 / t82;
  t268 = t72 * t267;
  t269 = t139 * t139;
  t270 = t268 * t269;
  t274 = 0.1e1 / t74 / t73;
  t275 = t274 * t213;
  t279 = t132 * t213;
  t285 = t78 * t256;
  t287 = 0.866264181134753312e3 * t275 - 0.1732528362269506624e3 * t132 * t256 + 0.2286175649783555712e3 * t279 - 0.571543912445888928e2 * t75 * t256 + 0.12568923120168e2 * t75 * t213 - 0.4189641040056e1 * t285;
  t288 = t130 * t287;
  t291 = 0.5e0 * t187 * t84 + 0.5e0 * t196 * t94 + 0.1e1 * t199 - 0.390299956e1 * t201 * t125 - 0.1e1 * t201 * t140 + 0.195149978e1 * t208 + 0.5e0 * t211 - 0.195149978e1 * t21 * t215 + 0.97574989e0 * t21 * t258 - 0.195149978e1 * t261 * t263 - 0.5e0 * t21 * t270 + 0.25e0 * t21 * t288;
  t292 = my_piecewise3(t11, 0, t291);
  tv2rho20 = t2 * t292 + 0.2e1 * t144;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t294 = t91 * t147;
  t297 = 0.2e1 * t192;
  t298 = my_piecewise5(t13, 0, t16, 0, t297);
  t299 = t18 * t298;
  t302 = t148 * t84;
  t304 = t148 * t2;
  t314 = t167 * t83;
  t315 = t206 * t314;
  t317 = t21 * t78;
  t318 = t314 * t123;
  t325 = my_piecewise5(t24, 0, t27, 0, t297);
  t326 = my_piecewise5(t42, 0, t44, 0, t325);
  t328 = t326 * t2 + t105 + t152;
  t333 = my_piecewise3(t32, 0, 0.4e1 / 0.81e2 * t100 * t222 * t154 * t107 - t100 * t103 * t328 / 0.27e2);
  t338 = my_piecewise5(t44, 0, t42, 0, -t325);
  t340 = t338 * t2 + t115 + t159;
  t345 = my_piecewise3(t57, 0, 0.4e1 / 0.81e2 * t100 * t241 * t161 * t117 - t100 * t114 * t340 / 0.27e2);
  t347 = my_piecewise3(t68, 0, t333 + t345);
  t348 = t80 * t347;
  t349 = t348 * t83;
  t352 = t167 * t129;
  t353 = t352 * t139;
  t358 = t129 * t178;
  t359 = t97 * t358;
  t361 = t262 * t178;
  t364 = t21 * t72;
  t365 = t267 * t178;
  t366 = t365 * t139;
  t369 = t274 * t167;
  t372 = t132 * t347;
  t376 = t75 * t347;
  t380 = t78 * t347;
  t382 = 0.866264181134753312e3 * t369 * t123 - 0.1732528362269506624e3 * t372 + 0.2286175649783555712e3 * t172 * t123 - 0.571543912445888928e2 * t376 + 0.12568923120168e2 * t174 * t123 - 0.4189641040056e1 * t380;
  t383 = t130 * t382;
  t386 = 0.5e0 * t294 * t94 + 0.5e0 * t299 * t94 + 0.5e0 * t302 - 0.195149978e1 * t304 * t125 - 0.5e0 * t304 * t140 + 0.5e0 * t199 + 0.97574989e0 * t208 + 0.25e0 * t211 - 0.195149978e1 * t201 * t169 + 0.97574989e0 * t315 - 0.195149978e1 * t317 * t318 + 0.97574989e0 * t21 * t349 - 0.97574989e0 * t261 * t353 - 0.5e0 * t201 * t179 + 0.25e0 * t359 - 0.97574989e0 * t261 * t361 - 0.5e0 * t364 * t366 + 0.25e0 * t21 * t383;
  t387 = my_piecewise3(t11, 0, t386);
  tv2rho21 = t2 * t387 + t144 + t183;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t390 = t147 * t147;
  t391 = t390 * t2;
  t395 = 0.2e1 * t88 + 0.2e1 * t192;
  t396 = my_piecewise5(t13, 0, t16, 0, t395);
  t397 = t18 * t396;
  t407 = t167 * t167;
  t408 = t78 * t407;
  t409 = t408 * t83;
  t412 = t154 * t154;
  t416 = my_piecewise5(t24, 0, t27, 0, t395);
  t417 = my_piecewise5(t42, 0, t44, 0, t416);
  t420 = t417 * t2 + 0.2e1 * t152;
  t425 = my_piecewise3(t32, 0, 0.4e1 / 0.81e2 * t100 * t222 * t412 - t100 * t103 * t420 / 0.27e2);
  t426 = t161 * t161;
  t430 = my_piecewise5(t44, 0, t42, 0, -t416);
  t433 = t430 * t2 + 0.2e1 * t159;
  t438 = my_piecewise3(t57, 0, 0.4e1 / 0.81e2 * t100 * t241 * t426 - t100 * t114 * t433 / 0.27e2);
  t440 = my_piecewise3(t68, 0, t425 + t438);
  t441 = t80 * t440;
  t442 = t441 * t83;
  t445 = t352 * t178;
  t448 = t178 * t178;
  t449 = t268 * t448;
  t452 = t274 * t407;
  t454 = t132 * t440;
  t456 = t132 * t407;
  t458 = t75 * t440;
  t460 = t75 * t407;
  t462 = t78 * t440;
  t464 = 0.866264181134753312e3 * t452 - 0.1732528362269506624e3 * t454 + 0.2286175649783555712e3 * t456 - 0.571543912445888928e2 * t458 + 0.12568923120168e2 * t460 - 0.4189641040056e1 * t462;
  t465 = t130 * t464;
  t468 = 0.5e0 * t391 * t84 + 0.5e0 * t397 * t94 + 0.1e1 * t302 - 0.390299956e1 * t304 * t169 - 0.1e1 * t304 * t179 + 0.195149978e1 * t315 + 0.5e0 * t359 - 0.195149978e1 * t21 * t409 + 0.97574989e0 * t21 * t442 - 0.195149978e1 * t261 * t445 - 0.5e0 * t21 * t449 + 0.25e0 * t21 * t465;
  t469 = my_piecewise3(t11, 0, t468);
  tv2rho22 = t2 * t469 + 0.2e1 * t183;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  tv2rhosigma0 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  tv2rhosigma3 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  tv2rhosigma5 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  tv2sigma20 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t472 = t186 * t72;
  t473 = t472 * t83;
  t475 = t256 * t129;
  t476 = t475 * t139;
  t479 = t262 * t287;
  t483 = t267 * t139 * t287;
  t486 = t196 * t2;
  t495 = t207 * t256;
  t498 = t213 * t129;
  t499 = t498 * t139;
  t506 = t123 * t267;
  t507 = t506 * t269;
  t510 = t267 * t269;
  t511 = t97 * t510;
  t513 = t196 * t84;
  t515 = 0.15e1 * t473 - 0.292724967e1 * t261 * t476 - 0.292724967e1 * t261 * t479 - 0.15e1 * t364 * t483 - 0.15e1 * t486 * t140 - 0.585449934e1 * t486 * t125 - 0.585449934e1 * t201 * t258 - 0.15e1 * t201 * t288 - 0.585449934e1 * t317 * t495 + 0.585449934e1 * t317 * t499 + 0.1170899868e2 * t201 * t215 + 0.3e1 * t201 * t270 + 0.585449934e1 * t261 * t507 - 0.15e1 * t511 + 0.15e1 * t513;
  t516 = t20 * t78;
  t517 = t213 * t83;
  t518 = t516 * t517;
  t520 = t256 * t83;
  t521 = t206 * t520;
  t523 = t129 * t287;
  t524 = t97 * t523;
  t529 = 0.1e1 / t48 / t218 / t46 / t190;
  t530 = t40 * t529;
  t531 = t223 * t107;
  t535 = t107 * t231;
  t539 = t87 * t87;
  t540 = 0.1e1 / t539;
  t541 = t1 * t540;
  t543 = 0.6e1 * t191 - 0.6e1 * t541;
  t544 = my_piecewise5(t24, 0, t27, 0, t543);
  t545 = my_piecewise5(t42, 0, t44, 0, t544);
  t548 = t545 * t2 + 0.3e1 * t228;
  t553 = my_piecewise3(t32, 0, -0.28e2 / 0.243e3 * t100 * t530 * t531 + 0.4e1 / 0.27e2 * t100 * t222 * t535 - t100 * t103 * t548 / 0.27e2);
  t557 = 0.1e1 / t61 / t237 / t59 / t190;
  t558 = t40 * t557;
  t559 = t242 * t117;
  t563 = t117 * t249;
  t567 = my_piecewise5(t44, 0, t42, 0, -t544);
  t570 = t567 * t2 + 0.3e1 * t246;
  t575 = my_piecewise3(t57, 0, -0.28e2 / 0.243e3 * t100 * t558 * t559 + 0.4e1 / 0.27e2 * t100 * t241 * t563 - t100 * t114 * t570 / 0.27e2);
  t577 = my_piecewise3(t68, 0, t553 + t575);
  t579 = t80 * t577 * t83;
  t583 = 0.1e1 / t74 / t77;
  t584 = t213 * t123;
  t587 = t274 * t123;
  t604 = -0.5197585086808519872e4 * t583 * t584 + 0.2598792543404259936e4 * t587 * t256 - 0.1732528362269506624e3 * t132 * t577 - 0.1143087824891777856e4 * t274 * t584 + 0.6858526949350667136e3 * t133 * t256 - 0.571543912445888928e2 * t75 * t577 - 0.50275692480672e2 * t132 * t584 + 0.37706769360504e2 * t135 * t256 - 0.4189641040056e1 * t78 * t577;
  t605 = t130 * t604;
  t608 = t128 * t128;
  t609 = 0.1e1 / t608;
  t610 = t72 * t609;
  t611 = t269 * t139;
  t612 = t610 * t611;
  t616 = t75 * t584 * t83;
  t619 = t91 * t2;
  t627 = my_piecewise5(t13, 0, t16, 0, t543);
  t628 = t18 * t627;
  t631 = t92 * t140;
  t633 = t92 * t125;
  t635 = t206 * t263;
  t637 = t124 * t210;
  t640 = -0.585449934e1 * t518 + 0.292724967e1 * t521 + 0.75e0 * t524 + 0.97574989e0 * t21 * t579 + 0.25e0 * t21 * t605 + 0.15e1 * t21 * t612 + 0.585449934e1 * t21 * t616 + 0.15e1 * t619 * t84 * t195 - 0.15e1 * t187 * t140 - 0.585449934e1 * t187 * t125 + 0.5e0 * t628 * t94 - 0.3e1 * t631 - 0.1170899868e2 * t633 - 0.585449934e1 * t635 + 0.1170899868e2 * t201 * t637;
  t642 = my_piecewise3(t11, 0, t515 + t640);
  tv3rho30 = t2 * t642 + 0.3e1 * t292;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t644 = 0.2e1 * t387;
  t646 = t294 * t2;
  t649 = t167 * t267;
  t650 = t649 * t269;
  t653 = t498 * t178;
  t660 = t21 * t75;
  t661 = t314 * t213;
  t664 = t352 * t287;
  t671 = t475 * t178;
  t674 = t262 * t382;
  t677 = t267 * t382;
  t678 = t677 * t139;
  t681 = t365 * t287;
  t684 = 0.5e0 * t473 - 0.390299956e1 * t646 * t125 + 0.195149978e1 * t261 * t650 + 0.195149978e1 * t317 * t653 + 0.390299956e1 * t304 * t215 + 0.1e1 * t304 * t270 + 0.585449934e1 * t660 * t661 - 0.97574989e0 * t261 * t664 - 0.5e0 * t486 * t179 - 0.1e1 * t201 * t383 - 0.97574989e0 * t261 * t671 - 0.195149978e1 * t261 * t674 - 0.1e1 * t364 * t678 - 0.5e0 * t364 * t681;
  t685 = t299 * t2;
  t698 = t347 * t83;
  t699 = t698 * t123;
  t702 = t314 * t256;
  t705 = t347 * t129;
  t706 = t705 * t139;
  t711 = t609 * t178;
  t712 = t711 * t269;
  t715 = t129 * t382;
  t717 = 0.5e0 * t97 * t715;
  t719 = 0.195149978e1 * t206 * t698;
  t722 = -0.1e1 * t685 * t140 - 0.390299956e1 * t685 * t125 - 0.195149978e1 * t304 * t258 - 0.5e0 * t304 * t288 - 0.195149978e1 * t486 * t169 - 0.390299956e1 * t201 * t349 - 0.390299956e1 * t317 * t699 - 0.195149978e1 * t317 * t702 - 0.195149978e1 * t261 * t706 - 0.1e1 * t646 * t140 + 0.15e1 * t364 * t712 + t717 + t719 - 0.5e0 * t511 + 0.5e0 * t513;
  t728 = 0.1e1 * t299 * t84;
  t730 = 0.1e1 * t294 * t84;
  t734 = 0.2e1 * t191;
  t735 = 0.6e1 * t541;
  t736 = t734 - t735;
  t737 = my_piecewise5(t13, 0, t16, 0, t736);
  t738 = t18 * t737;
  t742 = 0.1e1 * t148 * t140;
  t744 = 0.390299956e1 * t148 * t125;
  t746 = 0.390299956e1 * t516 * t318;
  t748 = 0.195149978e1 * t206 * t353;
  t753 = t328 * t107;
  t761 = my_piecewise5(t24, 0, t27, 0, t736);
  t762 = my_piecewise5(t42, 0, t44, 0, t761);
  t764 = 0.2e1 * t326;
  t765 = t762 * t2 + t228 + t764;
  t770 = my_piecewise3(t32, 0, -0.28e2 / 0.243e3 * t100 * t530 * t154 * t223 + 0.8e1 / 0.81e2 * t100 * t222 * t753 + 0.4e1 / 0.81e2 * t100 * t222 * t154 * t231 - t100 * t103 * t765 / 0.27e2);
  t775 = t340 * t117;
  t783 = my_piecewise5(t44, 0, t42, 0, -t761);
  t785 = 0.2e1 * t338;
  t786 = t783 * t2 + t246 + t785;
  t791 = my_piecewise3(t57, 0, -0.28e2 / 0.243e3 * t100 * t558 * t161 * t242 + 0.8e1 / 0.81e2 * t100 * t241 * t775 + 0.4e1 / 0.81e2 * t100 * t241 * t161 * t249 - t100 * t114 * t786 / 0.27e2);
  t793 = my_piecewise3(t68, 0, t770 + t791);
  t795 = t80 * t793 * t83;
  t799 = 0.1e1 * t97 * t366;
  t800 = -0.195149978e1 * t518 + 0.97574989e0 * t521 + 0.25e0 * t524 + t728 + t730 - 0.1e1 * t631 - 0.390299956e1 * t633 - 0.195149978e1 * t635 + 0.5e0 * t738 * t94 - t742 - t744 - t746 - t748 + 0.97574989e0 * t21 * t795 - t799;
  t802 = 0.195149978e1 * t206 * t361;
  t803 = t583 * t167;
  t806 = t274 * t347;
  t811 = t132 * t793;
  t819 = t75 * t793;
  t829 = -0.5197585086808519872e4 * t803 * t213 + 0.1732528362269506624e4 * t806 * t123 + 0.866264181134753312e3 * t369 * t256 - 0.1732528362269506624e3 * t811 - 0.1143087824891777856e4 * t369 * t213 + 0.4572351299567111424e3 * t372 * t123 + 0.2286175649783555712e3 * t172 * t256 - 0.571543912445888928e2 * t819 - 0.50275692480672e2 * t172 * t213 + 0.25137846240336e2 * t376 * t123 + 0.12568923120168e2 * t174 * t256 - 0.4189641040056e1 * t78 * t793;
  t830 = t130 * t829;
  t833 = t195 * t147;
  t836 = t91 * t298;
  t842 = 0.1e1 * t92 * t179;
  t846 = 0.390299956e1 * t92 * t169;
  t847 = t123 * t139;
  t848 = t352 * t847;
  t851 = t178 * t139;
  t852 = t268 * t851;
  t855 = t124 * t358;
  t858 = t506 * t851;
  t863 = t176 * t207;
  t866 = t168 * t210;
  t869 = -t802 + 0.25e0 * t21 * t830 + 0.5e0 * t833 * t94 + 0.1e1 * t836 * t94 - 0.5e0 * t187 * t179 - t842 - 0.195149978e1 * t187 * t169 - t846 + 0.390299956e1 * t317 * t848 + 0.2e1 * t201 * t852 + 0.390299956e1 * t201 * t855 + 0.390299956e1 * t261 * t858 + 0.390299956e1 * t304 * t637 + 0.780599912e1 * t201 * t863 + 0.390299956e1 * t201 * t866;
  t872 = my_piecewise3(t11, 0, t684 + t722 + t800 + t869);
  tv3rho31 = t2 * t872 + t292 + t644;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t882 = t407 * t83;
  t883 = t882 * t123;
  t886 = t314 * t347;
  t889 = t407 * t129;
  t890 = t889 * t139;
  t895 = t440 * t83;
  t896 = t895 * t123;
  t899 = t440 * t129;
  t900 = t899 * t139;
  t905 = t705 * t178;
  t908 = t352 * t382;
  t911 = t609 * t448;
  t912 = t911 * t139;
  t915 = -0.390299956e1 * t304 * t349 - 0.1e1 * t646 * t179 - 0.1e1 * t685 * t179 - 0.1e1 * t304 * t383 + 0.585449934e1 * t660 * t883 - 0.390299956e1 * t317 * t886 + 0.195149978e1 * t317 * t890 + 0.390299956e1 * t201 * t409 - 0.195149978e1 * t317 * t896 - 0.97574989e0 * t261 * t900 - 0.195149978e1 * t201 * t442 - 0.195149978e1 * t261 * t905 - 0.195149978e1 * t261 * t908 + 0.15e1 * t364 * t912;
  t916 = t397 * t2;
  t921 = t365 * t382;
  t926 = t506 * t448;
  t929 = t267 * t464;
  t930 = t929 * t139;
  t935 = t262 * t464;
  t942 = t397 * t84;
  t944 = t516 * t882;
  t946 = t206 * t895;
  t948 = -0.5e0 * t916 * t140 - 0.195149978e1 * t916 * t125 - 0.1e1 * t364 * t921 + 0.1e1 * t201 * t449 + 0.195149978e1 * t261 * t926 - 0.5e0 * t364 * t930 - 0.5e0 * t201 * t465 - 0.97574989e0 * t261 * t935 - 0.390299956e1 * t646 * t169 - 0.390299956e1 * t685 * t169 + t717 + t719 + 0.5e0 * t942 - 0.195149978e1 * t944 + 0.97574989e0 * t946;
  t950 = t267 * t448;
  t951 = t97 * t950;
  t953 = t129 * t464;
  t954 = t97 * t953;
  t956 = t390 * t72;
  t957 = t956 * t83;
  t963 = -0.5e0 * t951 + 0.25e0 * t954 + t728 + t730 + 0.5e0 * t957 - t742 - t744 - t746 - t748 - t799 - t802 - t842 - t846 - 0.5e0 * t391 * t140 - 0.195149978e1 * t391 * t125;
  t964 = t91 * t396;
  t967 = -t734 - t735;
  t968 = my_piecewise5(t13, 0, t16, 0, t967);
  t969 = t18 * t968;
  t980 = t420 * t107;
  t984 = my_piecewise5(t24, 0, t27, 0, t967);
  t985 = my_piecewise5(t42, 0, t44, 0, t984);
  t987 = t985 * t2 + t417 + t764;
  t992 = my_piecewise3(t32, 0, -0.28e2 / 0.243e3 * t100 * t530 * t412 * t107 + 0.8e1 / 0.81e2 * t100 * t222 * t154 * t328 + 0.4e1 / 0.81e2 * t100 * t222 * t980 - t100 * t103 * t987 / 0.27e2);
  t1001 = t433 * t117;
  t1005 = my_piecewise5(t44, 0, t42, 0, -t984);
  t1007 = t1005 * t2 + t430 + t785;
  t1012 = my_piecewise3(t57, 0, -0.28e2 / 0.243e3 * t100 * t558 * t426 * t117 + 0.8e1 / 0.81e2 * t100 * t241 * t161 * t340 + 0.4e1 / 0.81e2 * t100 * t241 * t1001 - t100 * t114 * t1007 / 0.27e2);
  t1014 = my_piecewise3(t68, 0, t992 + t1012);
  t1016 = t80 * t1014 * t83;
  t1019 = t583 * t407;
  t1024 = t274 * t440;
  t1027 = t132 * t1014;
  t1035 = t75 * t1014;
  t1045 = -0.5197585086808519872e4 * t1019 * t123 + 0.1732528362269506624e4 * t369 * t347 + 0.866264181134753312e3 * t1024 * t123 - 0.1732528362269506624e3 * t1027 - 0.1143087824891777856e4 * t452 * t123 + 0.4572351299567111424e3 * t172 * t347 + 0.2286175649783555712e3 * t454 * t123 - 0.571543912445888928e2 * t1035 - 0.50275692480672e2 * t456 * t123 + 0.25137846240336e2 * t174 * t347 + 0.12568923120168e2 * t458 * t123 - 0.4189641040056e1 * t78 * t1014;
  t1046 = t130 * t1045;
  t1049 = t147 * t2;
  t1053 = t148 * t169;
  t1055 = t148 * t179;
  t1057 = t206 * t445;
  t1063 = t178 * t123;
  t1064 = t352 * t1063;
  t1067 = t649 * t851;
  t1070 = t168 * t358;
  t1077 = 0.5e0 * t964 * t94 + 0.5e0 * t969 * t94 + 0.97574989e0 * t21 * t1016 + 0.25e0 * t21 * t1046 + 0.1e1 * t1049 * t84 * t298 - 0.390299956e1 * t1053 - 0.1e1 * t1055 - 0.195149978e1 * t1057 + 0.2e1 * t304 * t852 + 0.390299956e1 * t304 * t855 + 0.390299956e1 * t317 * t1064 + 0.390299956e1 * t261 * t1067 + 0.390299956e1 * t201 * t1070 + 0.780599912e1 * t304 * t863 + 0.390299956e1 * t304 * t866;
  t1080 = my_piecewise3(t11, 0, t915 + t948 + t963 + t1077);
  tv3rho32 = t2 * t1080 + t469 + t644;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1083 = t899 * t178;
  t1086 = t352 * t464;
  t1089 = t365 * t464;
  t1100 = t314 * t440;
  t1103 = t889 * t178;
  t1106 = t649 * t448;
  t1114 = -0.292724967e1 * t261 * t1083 - 0.292724967e1 * t261 * t1086 - 0.15e1 * t364 * t1089 - 0.15e1 * t916 * t179 - 0.585449934e1 * t916 * t169 - 0.585449934e1 * t304 * t442 - 0.15e1 * t304 * t465 - 0.585449934e1 * t317 * t1100 + 0.585449934e1 * t317 * t1103 + 0.585449934e1 * t261 * t1106 + 0.15e1 * t942 - 0.585449934e1 * t944 + 0.292724967e1 * t946 - 0.15e1 * t951 + 0.75e0 * t954;
  t1123 = t448 * t178;
  t1124 = t610 * t1123;
  t1127 = t407 * t167;
  t1129 = t75 * t1127 * t83;
  t1133 = -0.6e1 * t191 - 0.6e1 * t541;
  t1134 = my_piecewise5(t13, 0, t16, 0, t1133);
  t1135 = t18 * t1134;
  t1138 = t412 * t154;
  t1146 = my_piecewise5(t24, 0, t27, 0, t1133);
  t1147 = my_piecewise5(t42, 0, t44, 0, t1146);
  t1150 = t1147 * t2 + 0.3e1 * t417;
  t1155 = my_piecewise3(t32, 0, -0.28e2 / 0.243e3 * t100 * t530 * t1138 + 0.4e1 / 0.27e2 * t100 * t222 * t154 * t420 - t100 * t103 * t1150 / 0.27e2);
  t1156 = t426 * t161;
  t1164 = my_piecewise5(t44, 0, t42, 0, -t1146);
  t1167 = t1164 * t2 + 0.3e1 * t430;
  t1172 = my_piecewise3(t57, 0, -0.28e2 / 0.243e3 * t100 * t558 * t1156 + 0.4e1 / 0.27e2 * t100 * t241 * t161 * t433 - t100 * t114 * t1167 / 0.27e2);
  t1174 = my_piecewise3(t68, 0, t1155 + t1172);
  t1176 = t80 * t1174 * t83;
  t1179 = t583 * t1127;
  t1183 = t132 * t1174;
  t1185 = t274 * t1127;
  t1189 = t75 * t1174;
  t1197 = -0.5197585086808519872e4 * t1179 + 0.2598792543404259936e4 * t369 * t440 - 0.1732528362269506624e3 * t1183 - 0.1143087824891777856e4 * t1185 + 0.6858526949350667136e3 * t172 * t440 - 0.571543912445888928e2 * t1189 - 0.50275692480672e2 * t132 * t1127 + 0.37706769360504e2 * t174 * t440 - 0.4189641040056e1 * t78 * t1174;
  t1198 = t130 * t1197;
  t1201 = t84 * t396;
  t1210 = 0.1170899868e2 * t304 * t409 + 0.3e1 * t304 * t449 + 0.15e1 * t957 - 0.1170899868e2 * t1053 - 0.3e1 * t1055 - 0.585449934e1 * t1057 + 0.15e1 * t21 * t1124 + 0.585449934e1 * t21 * t1129 + 0.5e0 * t1135 * t94 + 0.97574989e0 * t21 * t1176 + 0.25e0 * t21 * t1198 + 0.15e1 * t1049 * t1201 - 0.15e1 * t391 * t179 - 0.585449934e1 * t391 * t169 + 0.1170899868e2 * t304 * t1070;
  t1212 = my_piecewise3(t11, 0, t1114 + t1210);
  tv3rho33 = t2 * t1212 + 0.3e1 * t469;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  tv3rho2sigma0 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  tv3rho2sigma2 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  tv3rho2sigma3 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  tv3rho2sigma5 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  tv3rho2sigma6 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  tv3rho2sigma8 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rhosigma20 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  tv3sigma30 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1215 = t20 * t75;
  t1217 = t1215 * t584 * t83;
  t1219 = t195 * t195;
  t1225 = t91 * t72 * t83 * t195;
  t1227 = t472 * t210;
  t1229 = t186 * t80;
  t1230 = t1229 * t207;
  t1232 = t628 * t84;
  t1235 = t97 * t609 * t611;
  t1237 = t577 * t83;
  t1238 = t206 * t1237;
  t1241 = t97 * t129 * t604;
  t1243 = t74 * t74;
  t1244 = 0.1e1 / t1243;
  t1245 = t213 * t213;
  t1251 = t256 * t256;
  t1256 = t218 * t218;
  t1260 = t40 / t48 / t1256 / t539;
  t1261 = t223 * t223;
  t1269 = t231 * t231;
  t1279 = t1 / t539 / t2;
  t1281 = -0.24e2 * t540 + 0.24e2 * t1279;
  t1282 = my_piecewise5(t24, 0, t27, 0, t1281);
  t1283 = my_piecewise5(t42, 0, t44, 0, t1282);
  t1291 = my_piecewise3(t32, 0, 0.28e3 / 0.729e3 * t100 * t1260 * t1261 - 0.56e2 / 0.81e2 * t100 * t530 * t223 * t231 + 0.4e1 / 0.27e2 * t100 * t222 * t1269 + 0.16e2 / 0.81e2 * t100 * t222 * t107 * t548 - t100 * t103 * (t1283 * t2 + 0.4e1 * t545) / 0.27e2);
  t1292 = t237 * t237;
  t1296 = t40 / t61 / t1292 / t539;
  t1297 = t242 * t242;
  t1305 = t249 * t249;
  t1313 = my_piecewise5(t44, 0, t42, 0, -t1282);
  t1321 = my_piecewise3(t57, 0, 0.28e3 / 0.729e3 * t100 * t1296 * t1297 - 0.56e2 / 0.81e2 * t100 * t558 * t242 * t249 + 0.4e1 / 0.27e2 * t100 * t241 * t1305 + 0.16e2 / 0.81e2 * t100 * t241 * t117 * t570 - t100 * t114 * (t1313 * t2 + 0.4e1 * t567) / 0.27e2);
  t1323 = my_piecewise3(t68, 0, t1291 + t1321);
  t1346 = 0.36383095607659639104e5 * t1244 * t1245 - 0.31185510520851119232e5 * t583 * t213 * t256 + 0.2598792543404259936e4 * t274 * t1251 + 0.3465056724539013248e4 * t587 * t577 - 0.1732528362269506624e3 * t132 * t1323 + 0.6858526949350667136e4 * t583 * t1245 - 0.6858526949350667136e4 * t275 * t256 + 0.6858526949350667136e3 * t132 * t1251 + 0.9144702599134222848e3 * t133 * t577 - 0.571543912445888928e2 * t75 * t1323 + 0.25137846240336e3 * t274 * t1245 - 0.301654154884032e3 * t279 * t256 + 0.37706769360504e2 * t75 * t1251 + 0.50275692480672e2 * t135 * t577 - 0.4189641040056e1 * t78 * t1323;
  t1353 = my_piecewise5(t13, 0, t16, 0, t1281);
  t1357 = t97 * t483;
  t1359 = t92 * t270;
  t1361 = t206 * t507;
  t1369 = 0.2341799736e2 * t1217 + 0.15e1 * t1219 * t2 * t84 + 0.6e1 * t1225 - 0.6e1 * t1227 - 0.2341799736e2 * t1230 + 0.2e1 * t1232 + 0.6e1 * t1235 + 0.390299956e1 * t1238 + 0.1e1 * t1241 + 0.25e0 * t21 * t130 * t1346 + 0.2e1 * t619 * t84 * t627 + 0.5e0 * t18 * t1353 * t94 - 0.6e1 * t1357 + 0.12e2 * t1359 + 0.2341799736e2 * t1361 + 0.97574989e0 * t21 * t80 * t1323 * t83 + 0.2341799736e2 * t187 * t215;
  t1370 = t92 * t215;
  t1372 = t196 * t125;
  t1376 = t92 * t258;
  t1380 = t92 * t288;
  t1386 = t516 * t495;
  t1392 = t516 * t499;
  t1396 = t206 * t476;
  t1398 = t206 * t479;
  t1401 = 0.1e1 / t608 / t82;
  t1402 = t72 * t1401;
  t1403 = t269 * t269;
  t1407 = t287 * t287;
  t1411 = t196 * t140;
  t1413 = t187 * t80;
  t1416 = 0.4683599472e2 * t1370 - 0.2341799736e2 * t1372 - 0.1170899868e2 * t187 * t258 - 0.2341799736e2 * t1376 - 0.3e1 * t187 * t288 - 0.6e1 * t1380 - 0.2341799736e2 * t21 * t132 * t1245 * t83 - 0.2341799736e2 * t1386 - 0.585449934e1 * t21 * t78 * t1251 * t83 + 0.2341799736e2 * t1392 + 0.6e1 * t187 * t270 - 0.1170899868e2 * t1396 - 0.1170899868e2 * t1398 - 0.6e1 * t21 * t1402 * t1403 - 0.15e1 * t21 * t268 * t1407 - 0.6e1 * t1411 + 0.2341799736e2 * t1413 * t263;
  t1418 = t92 * t80;
  t1419 = t1418 * t263;
  t1422 = t91 * t195 * t2;
  t1425 = t628 * t2;
  t1433 = t584 * t129;
  t1459 = t123 * t609;
  t1467 = 0.4683599472e2 * t1419 - 0.2341799736e2 * t1422 * t125 - 0.780599912e1 * t1425 * t125 - 0.1170899868e2 * t486 * t258 + 0.3512699604e2 * t660 * t517 * t256 - 0.2341799736e2 * t660 * t1433 * t139 - 0.4683599472e2 * t201 * t616 - 0.780599912e1 * t201 * t579 - 0.2e1 * t364 * t267 * t604 * t139 - 0.2e1 * t201 * t605 - 0.390299956e1 * t261 * t262 * t604 - 0.585449934e1 * t261 * t475 * t287 + 0.9e1 * t364 * t609 * t269 * t287 - 0.12e2 * t201 * t612 - 0.2341799736e2 * t261 * t1459 * t611 - 0.6e1 * t1422 * t140 - 0.2e1 * t1425 * t140;
  t1473 = t577 * t129;
  t1477 = t213 * t267;
  t1481 = t256 * t267;
  t1492 = t124 * t510;
  t1495 = t214 * t210;
  t1501 = t257 * t210;
  t1504 = t287 * t139;
  t1508 = t124 * t523;
  t1511 = t268 * t1504;
  t1516 = t285 * t207;
  t1519 = -0.3e1 * t486 * t288 - 0.780599912e1 * t317 * t1237 * t123 - 0.390299956e1 * t261 * t1473 * t139 - 0.2341799736e2 * t317 * t1477 * t269 + 0.1170899868e2 * t261 * t1481 * t269 + 0.1170899868e2 * t317 * t498 * t287 + 0.6e1 * t486 * t270 + 0.2341799736e2 * t486 * t215 - 0.4683599472e2 * t201 * t1492 - 0.4683599472e2 * t201 * t1495 + 0.2341799736e2 * t317 * t475 * t847 + 0.2341799736e2 * t201 * t1501 + 0.2341799736e2 * t261 * t506 * t1504 + 0.2341799736e2 * t201 * t1508 + 0.12e2 * t201 * t1511 + 0.2341799736e2 * t486 * t637 + 0.4683599472e2 * t201 * t1516;
  t1522 = my_piecewise3(t11, 0, t1369 + t1416 + t1467 + t1519);
  tv4rho40 = t2 * t1522 + 0.4e1 * t642;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1525 = t2 * t78;
  t1526 = t92 * t1525;
  t1529 = t2 * t80;
  t1530 = t92 * t1529;
  t1541 = t382 * t139;
  t1542 = t268 * t1541;
  t1545 = t124 * t715;
  t1554 = t257 * t358;
  t1560 = t178 * t269;
  t1561 = t610 * t1560;
  t1570 = -0.2341799736e2 * t1526 * t848 - 0.2341799736e2 * t1530 * t858 + 0.585449934e1 * t1217 + 0.15e1 * t1225 - 0.15e1 * t1227 - 0.585449934e1 * t1230 + 0.5e0 * t1232 + 0.15e1 * t1235 + 0.97574989e0 * t1238 + 0.25e0 * t1241 + 0.6e1 * t201 * t1542 + 0.1170899868e2 * t201 * t1545 + 0.585449934e1 * t317 * t475 * t1063 + 0.585449934e1 * t261 * t1481 * t851 + 0.585449934e1 * t201 * t1554 + 0.1170899868e2 * t261 * t506 * t1541 - 0.9e1 * t201 * t1561 - 0.1756349802e2 * t261 * t1459 * t1560 + 0.45e1 * t364 * t711 * t1504;
  t1571 = t168 * t510;
  t1577 = t178 * t287;
  t1578 = t268 * t1577;
  t1598 = t380 * t207;
  t1601 = t348 * t210;
  t1607 = t256 * t123;
  t1615 = t176 * t520;
  t1627 = -0.1170899868e2 * t201 * t1571 - 0.1170899868e2 * t317 * t1477 * t851 + 0.3e1 * t201 * t1578 + 0.585449934e1 * t261 * t506 * t1577 + 0.1170899868e2 * t685 * t637 + 0.1170899868e2 * t304 * t1516 + 0.585449934e1 * t304 * t1501 + 0.3e1 * t304 * t1511 + 0.585449934e1 * t304 * t1508 + 0.1170899868e2 * t486 * t863 + 0.585449934e1 * t486 * t866 + 0.2341799736e2 * t201 * t1598 + 0.1170899868e2 * t201 * t1601 + 0.1170899868e2 * t317 * t705 * t847 + 0.1756349802e2 * t660 * t314 * t1607 + 0.585449934e1 * t317 * t352 * t256 * t139 + 0.1170899868e2 * t201 * t1615 + 0.1170899868e2 * t646 * t637 + 0.585449934e1 * t317 * t352 * t287 * t123 + 0.585449934e1 * t261 * t649 * t1504;
  t1629 = t168 * t523;
  t1643 = t347 * t267;
  t1662 = t21 * t132;
  t1666 = t167 * t609;
  t1673 = t836 * t2;
  t1682 = 0.585449934e1 * t201 * t1629 + 0.3e1 * t486 * t852 + 0.585449934e1 * t486 * t855 + 0.3e1 * t685 * t270 + 0.1170899868e2 * t685 * t215 + 0.1756349802e2 * t660 * t698 * t213 + 0.585449934e1 * t261 * t1643 * t269 + 0.3e1 * t646 * t270 + 0.1170899868e2 * t646 * t215 + 0.585449934e1 * t317 * t498 * t382 - 0.6e1 * t364 * t1401 * t178 * t611 - 0.1170899868e2 * t304 * t616 - 0.3e1 * t304 * t612 - 0.2341799736e2 * t1662 * t314 * t584 - 0.585449934e1 * t261 * t1666 * t611 - 0.585449934e1 * t660 * t1433 * t178 - 0.3e1 * t1673 * t140 - 0.1170899868e2 * t1673 * t125 + 0.45e1 * t364 * t609 * t382 * t269;
  t1683 = t738 * t2;
  t1688 = t148 * t80;
  t1689 = t1688 * t263;
  t1691 = t516 * t167;
  t1692 = t1691 * t263;
  t1695 = t92 * t78 * t318;
  t1698 = t97 * t129 * t829;
  t1700 = t833 * t84;
  t1702 = t472 * t358;
  t1704 = t1229 * t314;
  t1706 = t738 * t84;
  t1708 = t793 * t83;
  t1709 = t206 * t1708;
  t1711 = t836 * t84;
  t1721 = -0.15e1 * t1683 * t140 - 0.585449934e1 * t1683 * t125 + 0.1170899868e2 * t1689 + 0.1170899868e2 * t1692 + 0.2341799736e2 * t1695 + 0.75e0 * t1698 + 0.15e1 * t1700 - 0.15e1 * t1702 - 0.585449934e1 * t1704 + 0.15e1 * t1706 + 0.292724967e1 * t1709 + 0.3e1 * t1711 - 0.15e1 * t1357 + 0.3e1 * t1359 + 0.585449934e1 * t1361 + 0.1170899868e2 * t1370 - 0.585449934e1 * t1372 - 0.585449934e1 * t1376 - 0.15e1 * t1380 - 0.585449934e1 * t1386;
  t1728 = t196 * t169;
  t1730 = t196 * t179;
  t1732 = t206 * t650;
  t1734 = t516 * t653;
  t1736 = t97 * t712;
  t1738 = t148 * t270;
  t1740 = t148 * t215;
  t1742 = t1215 * t661;
  t1744 = t92 * t349;
  t1754 = t38 * t41;
  t1755 = t529 * t154;
  t1771 = 0.12e2 * t540;
  t1772 = 0.24e2 * t1279;
  t1773 = -t1771 + t1772;
  t1774 = my_piecewise5(t24, 0, t27, 0, t1773);
  t1775 = my_piecewise5(t42, 0, t44, 0, t1774);
  t1783 = my_piecewise3(t32, 0, 0.28e3 / 0.729e3 * t100 * t1260 * t154 * t531 - 0.28e2 / 0.81e2 * t100 * t530 * t328 * t223 - 0.28e2 / 0.81e2 * t1754 * t1755 * t535 + 0.4e1 / 0.27e2 * t100 * t222 * t765 * t107 + 0.4e1 / 0.27e2 * t100 * t222 * t328 * t231 + 0.4e1 / 0.81e2 * t100 * t222 * t154 * t548 - t100 * t103 * (t1775 * t2 + t545 + 0.3e1 * t762) / 0.27e2);
  t1792 = t557 * t161;
  t1808 = my_piecewise5(t44, 0, t42, 0, -t1774);
  t1816 = my_piecewise3(t57, 0, 0.28e3 / 0.729e3 * t100 * t1296 * t161 * t559 - 0.28e2 / 0.81e2 * t100 * t558 * t340 * t242 - 0.28e2 / 0.81e2 * t1754 * t1792 * t563 + 0.4e1 / 0.27e2 * t100 * t241 * t786 * t117 + 0.4e1 / 0.27e2 * t100 * t241 * t340 * t249 + 0.4e1 / 0.81e2 * t100 * t241 * t161 * t570 - t100 * t114 * (t1808 * t2 + t567 + 0.3e1 * t783) / 0.27e2);
  t1818 = my_piecewise3(t68, 0, t1783 + t1816);
  t1823 = t97 * t678;
  t1825 = t97 * t681;
  t1827 = t206 * t671;
  t1829 = t206 * t674;
  t1877 = 0.2286175649783555712e3 * t172 * t577 - 0.150827077442016e3 * t372 * t213 + 0.37706769360504e2 * t819 * t123 + 0.37706769360504e2 * t376 * t256 + 0.12568923120168e2 * t174 * t577 + 0.36383095607659639104e5 * t1244 * t167 * t584 - 0.15592755260425559616e5 * t803 * t1607 + 0.6858526949350667136e4 * t803 * t584 - 0.3429263474675333568e4 * t369 * t1607 + 0.25137846240336e3 * t369 * t584 - 0.150827077442016e3 * t172 * t1607;
  t1882 = 0.585449934e1 * t1392 - 0.292724967e1 * t1396 - 0.292724967e1 * t1398 - 0.15e1 * t1411 - 0.585449934e1 * t1728 - 0.15e1 * t1730 + 0.585449934e1 * t1732 + 0.585449934e1 * t1734 + 0.45e1 * t1736 + 0.3e1 * t1738 + 0.1170899868e2 * t1740 + 0.1756349802e2 * t1742 - 0.1170899868e2 * t1744 + 0.97574989e0 * t21 * t80 * t1818 * t83 - 0.3e1 * t1823 - 0.15e1 * t1825 - 0.292724967e1 * t1827 - 0.585449934e1 * t1829 + 0.25e0 * t21 * t130 * (-0.1732528362269506624e3 * t132 * t1818 - 0.571543912445888928e2 * t75 * t1818 - 0.4189641040056e1 * t78 * t1818 - 0.15592755260425559616e5 * t583 * t347 * t213 + 0.2598792543404259936e4 * t274 * t793 * t123 + 0.2598792543404259936e4 * t806 * t256 + 0.866264181134753312e3 * t369 * t577 - 0.3429263474675333568e4 * t806 * t213 + 0.6858526949350667136e3 * t811 * t123 + 0.6858526949350667136e3 * t372 * t256 + t1877);
  t1891 = t92 * t383;
  t1898 = my_piecewise5(t13, 0, t16, 0, t1773);
  t1902 = t299 * t140;
  t1904 = t299 * t125;
  t1906 = t294 * t140;
  t1908 = t148 * t288;
  t1910 = t294 * t125;
  t1912 = t148 * t258;
  t1914 = t516 * t699;
  t1916 = t516 * t702;
  t1918 = t206 * t706;
  t1920 = t206 * t664;
  t1929 = 0.5e0 * t627 * t147 * t94 + 0.15e1 * t195 * t298 * t94 - 0.15e1 * t187 * t383 - 0.3e1 * t1891 - 0.585449934e1 * t187 * t349 + 0.15e1 * t91 * t737 * t94 + 0.5e0 * t18 * t1898 * t94 - 0.3e1 * t1902 - 0.1170899868e2 * t1904 - 0.3e1 * t1906 - 0.15e1 * t1908 - 0.1170899868e2 * t1910 - 0.585449934e1 * t1912 - 0.1170899868e2 * t1914 - 0.585449934e1 * t1916 - 0.585449934e1 * t1918 - 0.292724967e1 * t1920 + 0.1170899868e2 * t1419 - 0.5e0 * t304 * t605 - 0.585449934e1 * t619 * t80 * t314 * t195;
  t1981 = 0.1170899868e2 * t187 * t78 * t318 + 0.585449934e1 * t1413 * t353 - 0.195149978e1 * t1425 * t169 - 0.585449934e1 * t486 * t349 - 0.585449934e1 * t317 * t698 * t256 - 0.195149978e1 * t317 * t314 * t577 - 0.15e1 * t364 * t677 * t287 - 0.5e0 * t364 * t365 * t604 - 0.15e1 * t685 * t288 - 0.585449934e1 * t685 * t258 - 0.585449934e1 * t646 * t258 - 0.195149978e1 * t304 * t579 - 0.15e1 * t646 * t288 - 0.292724967e1 * t261 * t705 * t287 - 0.97574989e0 * t261 * t352 * t604 - 0.15e1 * t619 * t72 * t358 * t195 + 0.3e1 * t187 * t72 * t366 + 0.585449934e1 * t1413 * t361 - 0.5e0 * t1425 * t179 - 0.15e1 * t486 * t383;
  t1988 = t1418 * t353;
  t1993 = t793 * t129;
  t2000 = t92 * t72 * t366;
  t2003 = t206 * t123 * t366;
  t2005 = t1418 * t361;
  t2016 = t833 * t2;
  t2021 = t214 * t358;
  t2026 = t174 * t517;
  t2039 = -0.97574989e0 * t261 * t1473 * t178 - 0.292724967e1 * t261 * t475 * t382 + 0.1170899868e2 * t1988 - 0.585449934e1 * t317 * t1708 * t123 - 0.292724967e1 * t261 * t1993 * t139 - 0.585449934e1 * t201 * t795 + 0.6e1 * t2000 + 0.1170899868e2 * t2003 + 0.1170899868e2 * t2005 - 0.15e1 * t364 * t267 * t829 * t139 - 0.15e1 * t201 * t830 - 0.292724967e1 * t261 * t262 * t829 - 0.15e1 * t2016 * t140 - 0.585449934e1 * t2016 * t125 - 0.1170899868e2 * t201 * t2021 - 0.1170899868e2 * t304 * t1492 - 0.3512699604e2 * t201 * t2026 - 0.1756349802e2 * t660 * t352 * t213 * t139 - 0.1170899868e2 * t317 * t649 * t123 * t269 - 0.1170899868e2 * t304 * t1495;
  t2043 = my_piecewise3(t11, 0, t1570 + t1627 + t1682 + t1721 + t1882 + t1929 + t1981 + t2039);
  tv4rho41 = t2 * t2043 + t642 + 0.3e1 * t872;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2051 = t148 * t1525;
  t2054 = t148 * t1529;
  t2077 = -0.1561199824e2 * t1526 * t1064 - 0.1561199824e2 * t1530 * t1067 - 0.1561199824e2 * t2051 * t848 - 0.1561199824e2 * t2054 * t858 - 0.1561199824e2 * t21 * t176 * t858 - 0.6e1 * t304 * t1561 - 0.780599912e1 * t304 * t2021 - 0.1170899868e2 * t660 * t352 * t178 * t213 - 0.1170899868e2 * t261 * t1666 * t1560 - 0.2341799736e2 * t304 * t2026 - 0.780599912e1 * t304 * t1571 + 0.2e1 * t304 * t1578;
  t2086 = t124 * t953;
  t2111 = t348 * t358;
  t2114 = 0.780599912e1 * t646 * t855 + 0.780599912e1 * t685 * t855 + 0.390299956e1 * t304 * t1554 + 0.780599912e1 * t304 * t1545 + 0.390299956e1 * t201 * t2086 + 0.780599912e1 * t317 * t705 * t1063 + 0.780599912e1 * t317 * t352 * t382 * t123 + 0.390299956e1 * t317 * t352 * t178 * t256 + 0.780599912e1 * t261 * t1643 * t851 + 0.780599912e1 * t261 * t649 * t1541 + 0.390299956e1 * t261 * t649 * t1577 + 0.390299956e1 * t486 * t1070 + 0.780599912e1 * t201 * t2111;
  t2116 = t168 * t715;
  t2141 = 0.780599912e1 * t201 * t2116 + 0.1561199824e2 * t646 * t863 + 0.1561199824e2 * t685 * t863 + 0.1561199824e2 * t304 * t1598 + 0.780599912e1 * t304 * t1615 + 0.780599912e1 * t646 * t866 + 0.780599912e1 * t685 * t866 + 0.780599912e1 * t304 * t1601 + 0.390299956e1 * t304 * t1629 + 0.4e1 * t646 * t852 + 0.4e1 * t685 * t852 + 0.4e1 * t304 * t1542;
  t2144 = t123 * t347;
  t2151 = t460 * t207;
  t2158 = t176 * t698;
  t2161 = t408 * t210;
  t2167 = t462 * t207;
  t2170 = t441 * t210;
  t2176 = t178 * t382;
  t2177 = t268 * t2176;
  t2183 = 0.390299956e1 * t916 * t637 + 0.2341799736e2 * t660 * t314 * t2144 - 0.1170899868e2 * t660 * t889 * t847 - 0.2341799736e2 * t201 * t2151 + 0.780599912e1 * t317 * t352 * t347 * t139 + 0.1561199824e2 * t201 * t2158 - 0.780599912e1 * t201 * t2161 + 0.390299956e1 * t317 * t899 * t847 + 0.780599912e1 * t201 * t2167 + 0.390299956e1 * t201 * t2170 + 0.6e1 * t364 * t711 * t1541 + 0.4e1 * t201 * t2177 + 0.780599912e1 * t261 * t506 * t2176;
  t2186 = t448 * t139;
  t2187 = t610 * t2186;
  t2190 = t124 * t950;
  t2196 = t464 * t139;
  t2197 = t268 * t2196;
  t2210 = t1049 * t72;
  t2214 = t391 * t80;
  t2217 = t1049 * t80;
  t2221 = t964 * t2;
  t2224 = -0.6e1 * t201 * t2187 - 0.780599912e1 * t201 * t2190 - 0.1170899868e2 * t261 * t1459 * t2186 + 0.2e1 * t201 * t2197 + 0.390299956e1 * t261 * t506 * t2196 - 0.390299956e1 * t2016 * t169 - 0.780599912e1 * t1673 * t169 - 0.195149978e1 * t261 * t262 * t1045 - 0.2e1 * t2210 * t210 * t298 + 0.390299956e1 * t2214 * t263 - 0.780599912e1 * t2217 * t207 * t298 - 0.1e1 * t2221 * t140;
  t2227 = t969 * t2;
  t2232 = t1014 * t83;
  t2236 = t1014 * t129;
  t2260 = -0.390299956e1 * t2221 * t125 - 0.1e1 * t2227 * t140 - 0.390299956e1 * t2227 * t125 - 0.390299956e1 * t317 * t2232 * t123 - 0.195149978e1 * t261 * t2236 * t139 - 0.390299956e1 * t201 * t1016 - 0.1e1 * t364 * t267 * t1045 * t139 - 0.1e1 * t201 * t1046 + 0.390299956e1 * t486 * t409 - 0.195149978e1 * t317 * t895 * t256 - 0.97574989e0 * t261 * t899 * t287 - 0.195149978e1 * t486 * t442 - 0.780599912e1 * t646 * t349;
  t2291 = -0.390299956e1 * t1683 * t169 - 0.780599912e1 * t685 * t349 - 0.390299956e1 * t304 * t795 - 0.1e1 * t2016 * t179 - 0.2e1 * t1673 * t179 - 0.2e1 * t646 * t383 - 0.1e1 * t1683 * t179 - 0.2e1 * t685 * t383 - 0.1e1 * t304 * t830 - 0.1e1 * t364 * t365 * t829 + 0.1e1 * t486 * t449 + 0.195149978e1 * t261 * t1481 * t448 - 0.5e0 * t364 * t929 * t287;
  t2297 = t1691 * t361;
  t2300 = t206 * t167 * t366;
  t2304 = t1418 * t445;
  t2307 = t148 * t78 * t318;
  t2309 = t1688 * t353;
  t2312 = t148 * t72 * t366;
  t2314 = t1688 * t361;
  t2325 = -0.5e0 * t486 * t465 - 0.97574989e0 * t261 * t475 * t464 + 0.780599912e1 * t2297 + 0.780599912e1 * t2300 + 0.390299956e1 * t1413 * t445 + 0.780599912e1 * t2304 + 0.1561199824e2 * t2307 + 0.780599912e1 * t2309 + 0.4e1 * t2312 + 0.780599912e1 * t2314 - 0.195149978e1 * t261 * t1993 * t178 - 0.390299956e1 * t261 * t705 * t382 - 0.195149978e1 * t261 * t352 * t829;
  t2355 = my_piecewise5(t13, 0, t16, 0, t1772);
  t2359 = t397 * t140;
  t2361 = 0.15e1 * t364 * t911 * t287 - 0.5e0 * t916 * t288 - 0.195149978e1 * t916 * t258 + 0.585449934e1 * t660 * t882 * t256 - 0.390299956e1 * t317 * t314 * t793 + 0.195149978e1 * t317 * t889 * t287 - 0.5e0 * t391 * t288 - 0.195149978e1 * t391 * t258 + 0.5e0 * t195 * t396 * t94 + 0.1e1 * t91 * t968 * t94 + 0.5e0 * t18 * t2355 * t94 - 0.1e1 * t2359;
  t2373 = t407 * t267;
  t2380 = t440 * t267;
  t2397 = -0.6e1 * t364 * t1401 * t448 * t269 + 0.1e1 * t916 * t270 + 0.390299956e1 * t916 * t215 - 0.2341799736e2 * t1662 * t882 * t213 - 0.390299956e1 * t317 * t2373 * t269 + 0.585449934e1 * t660 * t895 * t213 + 0.195149978e1 * t261 * t2380 * t269 - 0.390299956e1 * t317 * t1477 * t448 + 0.15e1 * t364 * t609 * t464 * t269 + 0.195149978e1 * t317 * t498 * t464 + 0.780599912e1 * t1689 + 0.780599912e1 * t1692 + 0.1561199824e2 * t1695;
  t2406 = t298 * t298;
  t2410 = t147 * t72;
  t2412 = t2410 * t83 * t298;
  t2414 = t206 * t2232;
  t2417 = t97 * t129 * t1045;
  t2419 = t956 * t210;
  t2421 = t390 * t80;
  t2422 = t2421 * t207;
  t2424 = 0.5e0 * t1698 + 0.1e1 * t1700 - 0.1e1 * t1702 - 0.390299956e1 * t1704 + 0.1e1 * t1706 + 0.195149978e1 * t1709 + 0.2e1 * t1711 + 0.1e1 * t2406 * t2 * t84 + 0.2e1 * t2412 + 0.195149978e1 * t2414 + 0.5e0 * t2417 - 0.1e1 * t2419 - 0.390299956e1 * t2422;
  t2425 = t964 * t84;
  t2427 = t969 * t84;
  t2440 = 0.1e1 * t2425 + 0.1e1 * t2427 - 0.390299956e1 * t1728 - 0.1e1 * t1730 + 0.390299956e1 * t1732 + 0.390299956e1 * t1734 + 0.3e1 * t1736 + 0.2e1 * t1738 + 0.780599912e1 * t1740 + 0.1170899868e2 * t1742 - 0.780599912e1 * t1744 - 0.2e1 * t1823 - 0.1e1 * t1825;
  t2455 = -0.195149978e1 * t1827 - 0.390299956e1 * t1829 - 0.2e1 * t1891 - 0.2e1 * t1902 - 0.780599912e1 * t1904 - 0.2e1 * t1906 - 0.1e1 * t1908 - 0.780599912e1 * t1910 - 0.390299956e1 * t1912 - 0.780599912e1 * t1914 - 0.390299956e1 * t1916 - 0.390299956e1 * t1918;
  t2457 = t148 * t349;
  t2459 = t148 * t383;
  t2461 = t206 * t905;
  t2463 = t206 * t908;
  t2465 = t397 * t125;
  t2467 = t1215 * t883;
  t2469 = t516 * t886;
  t2471 = t516 * t890;
  t2473 = t92 * t409;
  t2475 = t516 * t896;
  t2477 = t206 * t900;
  t2479 = t92 * t442;
  t2481 = -0.195149978e1 * t1920 - 0.780599912e1 * t2457 - 0.2e1 * t2459 - 0.390299956e1 * t2461 - 0.390299956e1 * t2463 - 0.390299956e1 * t2465 + 0.1170899868e2 * t2467 - 0.780599912e1 * t2469 + 0.390299956e1 * t2471 + 0.780599912e1 * t2473 - 0.390299956e1 * t2475 - 0.195149978e1 * t2477 - 0.390299956e1 * t2479;
  t2494 = t328 * t328;
  t2514 = my_piecewise5(t24, 0, t27, 0, t1772);
  t2515 = my_piecewise5(t42, 0, t44, 0, t2514);
  t2524 = my_piecewise3(t32, 0, 0.28e3 / 0.729e3 * t100 * t1260 * t412 * t223 - 0.112e3 / 0.243e3 * t1754 * t1755 * t753 - 0.28e2 / 0.243e3 * t100 * t530 * t412 * t231 + 0.8e1 / 0.81e2 * t100 * t222 * t2494 + 0.8e1 / 0.81e2 * t100 * t222 * t154 * t765 - 0.28e2 / 0.243e3 * t100 * t530 * t420 * t223 + 0.8e1 / 0.81e2 * t100 * t222 * t987 * t107 + 0.4e1 / 0.81e2 * t100 * t222 * t420 * t231 - t100 * t103 * (t2515 * t2 + 0.2e1 * t762 + 0.2e1 * t985) / 0.27e2);
  t2536 = t340 * t340;
  t2556 = my_piecewise5(t44, 0, t42, 0, -t2514);
  t2565 = my_piecewise3(t57, 0, 0.28e3 / 0.729e3 * t100 * t1296 * t426 * t242 - 0.112e3 / 0.243e3 * t1754 * t1792 * t775 - 0.28e2 / 0.243e3 * t100 * t558 * t426 * t249 + 0.8e1 / 0.81e2 * t100 * t241 * t2536 + 0.8e1 / 0.81e2 * t100 * t241 * t161 * t786 - 0.28e2 / 0.243e3 * t100 * t558 * t433 * t242 + 0.8e1 / 0.81e2 * t100 * t241 * t1007 * t117 + 0.4e1 / 0.81e2 * t100 * t241 * t433 * t249 - t100 * t114 * (t2556 * t2 + 0.2e1 * t1005 + 0.2e1 * t783) / 0.27e2);
  t2567 = my_piecewise3(t68, 0, t2524 + t2565);
  t2572 = t97 * t912;
  t2574 = t97 * t921;
  t2576 = t92 * t449;
  t2578 = t206 * t926;
  t2580 = t97 * t930;
  t2582 = t92 * t465;
  t2584 = t206 * t935;
  t2592 = t347 * t347;
  t2615 = -0.571543912445888928e2 * t75 * t2567 - 0.4189641040056e1 * t78 * t2567 - 0.1732528362269506624e3 * t132 * t2567 + 0.1732528362269506624e4 * t274 * t2592 + 0.4572351299567111424e3 * t132 * t2592 + 0.25137846240336e2 * t75 * t2592 - 0.20790340347234079488e5 * t803 * t2144 - 0.4572351299567111424e4 * t369 * t2144 - 0.201102769922688e3 * t172 * t2144 + 0.36383095607659639104e5 * t1244 * t407 * t213 - 0.5197585086808519872e4 * t583 * t440 * t213 + 0.6858526949350667136e4 * t1019 * t213 - 0.1143087824891777856e4 * t1024 * t213;
  t2645 = 0.25137846240336e3 * t452 * t213 - 0.50275692480672e2 * t454 * t213 - 0.5197585086808519872e4 * t1019 * t256 + 0.1732528362269506624e4 * t369 * t793 + 0.1732528362269506624e4 * t274 * t1014 * t123 + 0.866264181134753312e3 * t1024 * t256 - 0.1143087824891777856e4 * t452 * t256 + 0.4572351299567111424e3 * t172 * t793 + 0.4572351299567111424e3 * t1027 * t123 + 0.2286175649783555712e3 * t454 * t256 - 0.50275692480672e2 * t456 * t256 + 0.25137846240336e2 * t174 * t793 + 0.25137846240336e2 * t1035 * t123 + 0.12568923120168e2 * t458 * t256;
  t2661 = 0.97574989e0 * t21 * t80 * t2567 * t83 + 0.3e1 * t2572 - 0.2e1 * t2574 + 0.2e1 * t2576 + 0.390299956e1 * t2578 - 0.1e1 * t2580 - 0.1e1 * t2582 - 0.195149978e1 * t2584 + 0.25e0 * t21 * t130 * (t2615 + t2645) + 0.1e1 * t1049 * t84 * t737 - 0.390299956e1 * t21 * t78 * t2592 * t83 + 0.390299956e1 * t187 * t409 - 0.195149978e1 * t187 * t442;
  t2662 = t299 * t169;
  t2664 = t294 * t179;
  t2666 = t299 * t179;
  t2672 = t294 * t169;
  t2674 = t382 * t382;
  t2686 = -0.780599912e1 * t2662 - 0.2e1 * t2664 - 0.2e1 * t2666 + 0.1e1 * t187 * t449 - 0.5e0 * t187 * t465 - 0.780599912e1 * t2672 - 0.1e1 * t21 * t268 * t2674 + 0.1e1 * t391 * t270 + 0.390299956e1 * t391 * t215 + 0.780599912e1 * t1988 + 0.4e1 * t2000 + 0.780599912e1 * t2003 + 0.780599912e1 * t2005;
  t2691 = my_piecewise3(t11, 0, t2077 + t2114 + t2141 + t2183 + t2224 + t2260 + t2291 + t2325 + t2361 + t2397 + t2424 + t2440 + t2455 + t2481 + t2661 + t2686);
  tv4rho42 = t2 * t2691 + 0.2e1 * t1080 + 0.2e1 * t872;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2718 = t441 * t358;
  t2728 = t168 * t953;
  t2734 = t178 * t464;
  t2735 = t268 * t2734;
  t2743 = -0.2341799736e2 * t2051 * t1064 - 0.2341799736e2 * t2054 * t1067 + 0.3e1 * t304 * t2197 + 0.1170899868e2 * t685 * t1070 + 0.1170899868e2 * t304 * t2111 + 0.1170899868e2 * t304 * t2116 - 0.9e1 * t304 * t2187 + 0.6e1 * t304 * t2177 - 0.1170899868e2 * t304 * t2190 + 0.585449934e1 * t317 * t899 * t1063 + 0.585449934e1 * t261 * t2380 * t851 + 0.585449934e1 * t201 * t2718 + 0.585449934e1 * t317 * t352 * t464 * t123 + 0.585449934e1 * t261 * t649 * t2196 + 0.585449934e1 * t201 * t2728 + 0.45e1 * t364 * t711 * t2196 + 0.3e1 * t201 * t2735 + 0.585449934e1 * t261 * t506 * t2734 + 0.3e1 * t916 * t852;
  t2756 = t440 * t123;
  t2764 = t176 * t895;
  t2777 = t408 * t358;
  t2790 = t168 * t950;
  t2799 = 0.585449934e1 * t916 * t855 + 0.1170899868e2 * t916 * t863 + 0.585449934e1 * t916 * t866 + 0.1170899868e2 * t304 * t2167 + 0.585449934e1 * t304 * t2170 + 0.585449934e1 * t304 * t2086 + 0.1756349802e2 * t660 * t314 * t2756 + 0.585449934e1 * t317 * t352 * t440 * t139 + 0.1170899868e2 * t201 * t2764 - 0.1756349802e2 * t660 * t889 * t1063 + 0.1170899868e2 * t317 * t352 * t178 * t347 - 0.1170899868e2 * t317 * t2373 * t851 - 0.1170899868e2 * t201 * t2777 - 0.1170899868e2 * t317 * t649 * t448 * t123 - 0.1756349802e2 * t261 * t1666 * t2186 + 0.1170899868e2 * t261 * t649 * t2176 - 0.1170899868e2 * t201 * t2790 - 0.3512699604e2 * t304 * t2151 + 0.2341799736e2 * t304 * t2158 - 0.1170899868e2 * t304 * t2161;
  t2824 = t206 * t1083;
  t2826 = t206 * t1086;
  t2828 = t516 * t1103;
  t2830 = t206 * t1106;
  t2832 = t148 * t409;
  t2834 = t148 * t449;
  t2836 = t97 * t1089;
  t2838 = t397 * t179;
  t2840 = t397 * t169;
  t2842 = t148 * t442;
  t2844 = t148 * t465;
  t2846 = 0.1170899868e2 * t646 * t1070 - 0.292724967e1 * t261 * t899 * t382 - 0.292724967e1 * t261 * t705 * t464 - 0.292724967e1 * t261 * t352 * t1045 - 0.6e1 * t364 * t1401 * t1123 * t139 + 0.45e1 * t364 * t911 * t382 - 0.3e1 * t201 * t1124 - 0.585449934e1 * t261 * t1459 * t1123 - 0.292724967e1 * t2824 - 0.292724967e1 * t2826 + 0.585449934e1 * t2828 + 0.585449934e1 * t2830 + 0.1170899868e2 * t2832 + 0.3e1 * t2834 - 0.15e1 * t2836 - 0.15e1 * t2838 - 0.585449934e1 * t2840 - 0.585449934e1 * t2842 - 0.15e1 * t2844;
  t2847 = t516 * t1100;
  t2852 = t1771 + t1772;
  t2853 = my_piecewise5(t13, 0, t16, 0, t2852);
  t2880 = my_piecewise5(t24, 0, t27, 0, t2852);
  t2881 = my_piecewise5(t42, 0, t44, 0, t2880);
  t2889 = my_piecewise3(t32, 0, 0.28e3 / 0.729e3 * t100 * t1260 * t1138 * t107 - 0.28e2 / 0.81e2 * t100 * t530 * t412 * t328 - 0.28e2 / 0.81e2 * t1754 * t1755 * t980 + 0.4e1 / 0.27e2 * t100 * t222 * t328 * t420 + 0.4e1 / 0.27e2 * t100 * t222 * t154 * t987 + 0.4e1 / 0.81e2 * t100 * t222 * t1150 * t107 - t100 * t103 * (t2881 * t2 + t1147 + 0.3e1 * t985) / 0.27e2);
  t2913 = my_piecewise5(t44, 0, t42, 0, -t2880);
  t2921 = my_piecewise3(t57, 0, 0.28e3 / 0.729e3 * t100 * t1296 * t1156 * t117 - 0.28e2 / 0.81e2 * t100 * t558 * t426 * t340 - 0.28e2 / 0.81e2 * t1754 * t1792 * t1001 + 0.4e1 / 0.27e2 * t100 * t241 * t340 * t433 + 0.4e1 / 0.27e2 * t100 * t241 * t161 * t1007 + 0.4e1 / 0.81e2 * t100 * t241 * t1167 * t117 - t100 * t114 * (t2913 * t2 + 0.3e1 * t1005 + t1164) / 0.27e2);
  t2923 = my_piecewise3(t68, 0, t2889 + t2921);
  t2973 = 0.6858526949350667136e3 * t372 * t440 + 0.6858526949350667136e3 * t172 * t1014 + 0.2286175649783555712e3 * t1183 * t123 - 0.571543912445888928e2 * t75 * t2923 + 0.25137846240336e3 * t1185 * t123 - 0.150827077442016e3 * t456 * t347 - 0.150827077442016e3 * t172 * t2756 + 0.37706769360504e2 * t376 * t440 + 0.37706769360504e2 * t174 * t1014 + 0.12568923120168e2 * t1189 * t123 - 0.4189641040056e1 * t78 * t2923;
  t2988 = t1688 * t445;
  t3013 = -0.585449934e1 * t2847 + 0.5e0 * t91 * t1134 * t94 + 0.5e0 * t18 * t2853 * t94 + 0.97574989e0 * t21 * t80 * t2923 * t83 + 0.25e0 * t21 * t130 * (0.36383095607659639104e5 * t1244 * t1127 * t123 - 0.15592755260425559616e5 * t1019 * t347 - 0.15592755260425559616e5 * t803 * t2756 + 0.2598792543404259936e4 * t806 * t440 + 0.2598792543404259936e4 * t369 * t1014 + 0.866264181134753312e3 * t274 * t1174 * t123 - 0.1732528362269506624e3 * t132 * t2923 + 0.6858526949350667136e4 * t1179 * t123 - 0.3429263474675333568e4 * t452 * t347 - 0.3429263474675333568e4 * t369 * t2756 + t2973) + 0.15e1 * t298 * t2 * t1201 + 0.15e1 * t1049 * t84 * t968 - 0.15e1 * t391 * t383 - 0.585449934e1 * t391 * t349 + 0.1170899868e2 * t2988 - 0.292724967e1 * t261 * t2236 * t178 - 0.15e1 * t364 * t677 * t464 - 0.15e1 * t364 * t365 * t1045 - 0.15e1 * t2221 * t179 - 0.15e1 * t2227 * t179 - 0.15e1 * t916 * t383 - 0.585449934e1 * t2221 * t169 - 0.585449934e1 * t2227 * t169 - 0.585449934e1 * t916 * t349 - 0.585449934e1 * t646 * t442;
  t3026 = t1127 * t83;
  t3033 = t1127 * t129;
  t3068 = -0.585449934e1 * t685 * t442 - 0.585449934e1 * t304 * t1016 - 0.15e1 * t646 * t465 - 0.15e1 * t685 * t465 - 0.15e1 * t304 * t1046 - 0.2341799736e2 * t1662 * t3026 * t123 + 0.1756349802e2 * t660 * t882 * t347 - 0.585449934e1 * t660 * t3033 * t139 - 0.1170899868e2 * t201 * t1129 - 0.97574989e0 * t261 * t262 * t1197 - 0.15e1 * t2210 * t129 * t396 * t139 - 0.585449934e1 * t2217 * t207 * t396 - 0.3e1 * t2210 * t358 * t298 + 0.3e1 * t391 * t72 * t366 + 0.585449934e1 * t2214 * t361 - 0.1170899868e2 * t2217 * t314 * t298 + 0.1170899868e2 * t391 * t78 * t318 + 0.585449934e1 * t2214 * t353 - 0.585449934e1 * t317 * t698 * t440;
  t3086 = t1135 * t2;
  t3091 = t1174 * t83;
  t3095 = t1174 * t129;
  t3113 = -0.585449934e1 * t317 * t314 * t1014 + 0.585449934e1 * t317 * t889 * t382 + 0.585449934e1 * t261 * t1643 * t448 + 0.1170899868e2 * t646 * t409 + 0.1170899868e2 * t685 * t409 + 0.3e1 * t646 * t449 + 0.3e1 * t685 * t449 - 0.5e0 * t3086 * t140 - 0.195149978e1 * t3086 * t125 - 0.195149978e1 * t317 * t3091 * t123 - 0.97574989e0 * t261 * t3095 * t139 - 0.195149978e1 * t201 * t1176 - 0.5e0 * t364 * t267 * t1197 * t139 - 0.5e0 * t201 * t1198 + 0.1170899868e2 * t2297 + 0.1170899868e2 * t2300 + 0.1170899868e2 * t2304 + 0.2341799736e2 * t2307 + 0.1170899868e2 * t2309 + 0.6e1 * t2312;
  t3124 = t1215 * t3026;
  t3126 = t1135 * t84;
  t3128 = t206 * t3091;
  t3131 = t97 * t129 * t1197;
  t3134 = t2410 * t83 * t396;
  t3136 = t956 * t358;
  t3138 = t2421 * t314;
  t3141 = t97 * t609 * t1123;
  t3146 = 0.1170899868e2 * t2314 - 0.15e1 * t2359 + 0.3e1 * t2412 + 0.292724967e1 * t2414 + 0.75e0 * t2417 - 0.15e1 * t2419 - 0.585449934e1 * t2422 + 0.15e1 * t2425 + 0.15e1 * t2427 + 0.585449934e1 * t3124 + 0.5e0 * t3126 + 0.97574989e0 * t3128 + 0.25e0 * t3131 + 0.15e1 * t3134 - 0.15e1 * t3136 - 0.585449934e1 * t3138 + 0.15e1 * t3141 - 0.1170899868e2 * t2457 - 0.3e1 * t2459 - 0.585449934e1 * t2461;
  t3167 = -0.585449934e1 * t2463 - 0.585449934e1 * t2465 + 0.1756349802e2 * t2467 - 0.1170899868e2 * t2469 + 0.585449934e1 * t2471 + 0.1170899868e2 * t2473 - 0.585449934e1 * t2475 - 0.292724967e1 * t2477 - 0.585449934e1 * t2479 + 0.45e1 * t2572 - 0.3e1 * t2574 + 0.3e1 * t2576 + 0.585449934e1 * t2578 - 0.15e1 * t2580 - 0.15e1 * t2582 - 0.292724967e1 * t2584 - 0.1170899868e2 * t2662 - 0.3e1 * t2664 - 0.3e1 * t2666 - 0.1170899868e2 * t2672;
  t3171 = my_piecewise3(t11, 0, t2743 + t2799 + t2846 + t3013 + t3068 + t3113 + t3146 + t3167);
  tv4rho43 = t2 * t3171 + 0.3e1 * t1080 + t1212;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3216 = 0.6e1 * t916 * t449 + 0.2341799736e2 * t916 * t409 - 0.2341799736e2 * t317 * t2373 * t448 + 0.2341799736e2 * t2214 * t445 + 0.1170899868e2 * t261 * t2380 * t448 + 0.1170899868e2 * t317 * t889 * t464 + 0.2341799736e2 * t916 * t1070 + 0.4683599472e2 * t304 * t2764 - 0.4683599472e2 * t304 * t2777 - 0.4683599472e2 * t304 * t2790 + 0.2341799736e2 * t317 * t899 * t178 * t167 + 0.2341799736e2 * t304 * t2718 + 0.2341799736e2 * t261 * t649 * t2734 + 0.2341799736e2 * t304 * t2728 + 0.12e2 * t304 * t2735 + 0.3512699604e2 * t660 * t882 * t440 - 0.2341799736e2 * t660 * t3033 * t178;
  t3243 = t147 * t396 * t2;
  t3260 = -0.4683599472e2 * t304 * t1129 - 0.780599912e1 * t317 * t314 * t1174 - 0.390299956e1 * t261 * t3095 * t178 - 0.585449934e1 * t261 * t899 * t464 - 0.390299956e1 * t261 * t352 * t1197 + 0.9e1 * t364 * t911 * t464 - 0.12e2 * t304 * t1124 - 0.2341799736e2 * t261 * t1666 * t1123 - 0.2e1 * t364 * t365 * t1197 - 0.6e1 * t3243 * t179 - 0.2e1 * t3086 * t179 - 0.3e1 * t916 * t465 - 0.2341799736e2 * t3243 * t169 - 0.780599912e1 * t3086 * t169 - 0.1170899868e2 * t916 * t442 - 0.780599912e1 * t304 * t1176 - 0.2e1 * t304 * t1198;
  t3262 = t412 * t412;
  t3270 = t420 * t420;
  t3279 = 0.24e2 * t540 + 0.24e2 * t1279;
  t3280 = my_piecewise5(t24, 0, t27, 0, t3279);
  t3281 = my_piecewise5(t42, 0, t44, 0, t3280);
  t3289 = my_piecewise3(t32, 0, 0.28e3 / 0.729e3 * t100 * t1260 * t3262 - 0.56e2 / 0.81e2 * t100 * t530 * t412 * t420 + 0.4e1 / 0.27e2 * t100 * t222 * t3270 + 0.16e2 / 0.81e2 * t100 * t222 * t154 * t1150 - t100 * t103 * (t3281 * t2 + 0.4e1 * t1147) / 0.27e2);
  t3290 = t426 * t426;
  t3298 = t433 * t433;
  t3306 = my_piecewise5(t44, 0, t42, 0, -t3280);
  t3314 = my_piecewise3(t57, 0, 0.28e3 / 0.729e3 * t100 * t1296 * t3290 - 0.56e2 / 0.81e2 * t100 * t558 * t426 * t433 + 0.4e1 / 0.27e2 * t100 * t241 * t3298 + 0.16e2 / 0.81e2 * t100 * t241 * t161 * t1167 - t100 * t114 * (t3306 * t2 + 0.4e1 * t1164) / 0.27e2);
  t3316 = my_piecewise3(t68, 0, t3289 + t3314);
  t3321 = t407 * t407;
  t3326 = t440 * t440;
  t3353 = 0.36383095607659639104e5 * t1244 * t3321 - 0.31185510520851119232e5 * t1019 * t440 + 0.2598792543404259936e4 * t274 * t3326 + 0.3465056724539013248e4 * t369 * t1174 - 0.1732528362269506624e3 * t132 * t3316 + 0.6858526949350667136e4 * t583 * t3321 - 0.6858526949350667136e4 * t452 * t440 + 0.6858526949350667136e3 * t132 * t3326 + 0.9144702599134222848e3 * t172 * t1174 - 0.571543912445888928e2 * t75 * t3316 + 0.25137846240336e3 * t274 * t3321 - 0.301654154884032e3 * t456 * t440 + 0.37706769360504e2 * t75 * t3326 + 0.50275692480672e2 * t174 * t1174 - 0.4189641040056e1 * t78 * t3316;
  t3375 = t448 * t448;
  t3379 = t464 * t464;
  t3386 = my_piecewise5(t13, 0, t16, 0, t3279);
  t3393 = 0.97574989e0 * t21 * t80 * t3316 * t83 + 0.25e0 * t21 * t130 * t3353 - 0.1170899868e2 * t2824 - 0.1170899868e2 * t2826 + 0.2341799736e2 * t391 * t409 + 0.6e1 * t391 * t449 - 0.1170899868e2 * t391 * t442 - 0.3e1 * t391 * t465 - 0.2341799736e2 * t21 * t132 * t3321 * t83 - 0.585449934e1 * t21 * t78 * t3326 * t83 - 0.6e1 * t21 * t1402 * t3375 - 0.15e1 * t21 * t268 * t3379 + 0.2e1 * t147 * t1134 * t94 + 0.5e0 * t18 * t3386 * t94 + 0.2341799736e2 * t2828 + 0.2341799736e2 * t2830 + 0.4683599472e2 * t2832;
  t3410 = t396 * t396;
  t3414 = 0.12e2 * t2834 - 0.6e1 * t2836 - 0.6e1 * t2838 - 0.2341799736e2 * t2840 - 0.2341799736e2 * t2842 - 0.6e1 * t2844 - 0.2341799736e2 * t2847 + 0.4683599472e2 * t2988 + 0.2341799736e2 * t3124 + 0.2e1 * t3126 + 0.390299956e1 * t3128 + 0.1e1 * t3131 + 0.6e1 * t3134 - 0.6e1 * t3136 - 0.2341799736e2 * t3138 + 0.6e1 * t3141 + 0.15e1 * t3410 * t2 * t84;
  t3417 = my_piecewise3(t11, 0, t3216 + t3260 + t3393 + t3414);
  tv4rho44 = t2 * t3417 + 0.4e1 * t1212;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  tv4rho3sigma0 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  tv4rho3sigma2 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  tv4rho3sigma3 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  tv4rho3sigma5 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  tv4rho3sigma6 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  tv4rho3sigma8 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  tv4rho3sigma9 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  tv4rho3sigma11 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  tv4rho2sigma20 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  tv4rho2sigma26 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  tv4rho2sigma211 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  tv4rho2sigma212 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  tv4rho2sigma217 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  tv4rhosigma30 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  tv4rhosigma310 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  tv4rhosigma319 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  tv4sigma40 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  tv4sigma414 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

