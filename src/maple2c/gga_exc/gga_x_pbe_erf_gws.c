/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_x_pbe_erf_gws.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t9;
  double t10, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t21, t22, t23, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t43, t44, t45, t47, t51, t52, t53, t55;
  double t61, t63, t64, t65, t66, t67, t71, t73;
  double t74, t76, t77, t78, t79, t81, t82, t84;
  double t85, t86, t90, t91, t92, t93, t94, t98;
  double t104, t110, t111, t115, t116, t121, t122, t124;
  double t130, t134, t135, t136, t137, t143, t144, t152;
  double t157, t160, t163, t167, t169, t170, t171, t172;
  double t175, t176, t177, t178, t179, t180, t181, t182;
  double t185, t187, t193, t194, t195, t198, t199, t200;
  double t203, t206, t210, t212, t213, t218, t219, t220;
  double t222, t226, t227, t228, t229, t232, t233, tzk0;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * rho[0];
  t6 = t3 * t5;
  t7 = M_CBRTPI;
  t8 = 0.1e1 / t7;
  t9 = p->cam_omega * p->cam_omega;
  t10 = params->ax * t9;
  t12 = t7 * M_PI;
  t13 = 0.1e1 / t12;
  t14 = 0.2e1 <= p->zeta_threshold;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = M_CBRT2;
  t17 = my_piecewise3(t14, t15, t16);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t20 = t13 * t19;
  t21 = t16 * t16;
  t22 = t4 * t4;
  t23 = 0.1e1 / t22;
  t28 = exp(-t10 * t3 * t20 * t21 * t23 / 0.12e2);
  t29 = params->b_PBE * t28;
  t30 = t29 * sigma[0];
  t31 = params->kappa + 0.1e1;
  t32 = t3 * t31;
  t33 = t3 * t3;
  t34 = t16 * t33;
  t35 = t7 * t7;
  t37 = t34 / t35;
  t38 = 0.1e1 / t4;
  t40 = 0.1e1 / t17;
  t43 = t37 * p->cam_omega * t38 * t40 / 0.6e1;
  t44 = t43 < 0.5e-1;
  t45 = t9 * t3;
  t47 = t12 * t18;
  t51 = (t45 * t21 - 0.7e1 / 0.6e1 * t47 * t22) * t12;
  t52 = t18 * t22;
  t53 = t18 * t17;
  t55 = 0.1e1 / p->cam_omega * t3;
  t61 = erf(t55 * t35 * t17 * t21 * t4 / 0.2e1);
  t63 = M_PI * M_PI;
  t64 = sqrt(M_PI);
  t65 = t64 * t63;
  t66 = t53 * t61 * t65;
  t67 = rho[0] * p->cam_omega;
  t71 = t47 * t21;
  t73 = t3 * t22 * t9;
  t74 = t71 * t73;
  t76 = t18 * t18;
  t77 = t35 * t63;
  t78 = t76 * t77;
  t79 = t78 * t5;
  t81 = t9 * t9;
  t82 = t81 * t33;
  t84 = 0.12e2 * t82 * t16;
  t85 = -0.36e2 * t66 * t34 * t67 + 0.54e2 * t74 + 0.81e2 * t79 - t84;
  t86 = 0.1e1 / t85;
  t90 = 0.1e11 < t43;
  t91 = t63 * t63;
  t92 = t76 * t18;
  t93 = t91 * t92;
  t94 = rho[0] * rho[0];
  t98 = t12 * t16 * t33;
  t104 = t77 * t21 * t3;
  t110 = t81 * t9;
  t111 = 0.1e1 / t110;
  t115 = 0.1e1 / t9;
  t116 = t115 * t33;
  t121 = t116 * t12 * t18 * t16 * t22 / 0.2e1;
  t122 = exp(t121);
  t124 = t122 * t12 * t18;
  t130 = t122 * t16;
  t134 = (0.7e1 * t124 * t22 * t21 * t45 - 0.12e2 * t130 * t82 + 0.11e2 * t74 + 0.6e1 * t79 + t84) * t12;
  t135 = t134 * t52;
  t136 = t21 * t33;
  t137 = t122 * t61;
  t143 = t122 * t76;
  t144 = t77 * t16;
  t152 = t122 * t21;
  t157 = 0.12e2 * t137 * t53 * t65 * t136 * t67 - 0.27e2 * t143 * t144 * t5 - 0.36e2 * t124 * t73 - 0.4e1 * t136 * t81 + 0.4e1 * t152 * t82 + 0.24e2 * t47 * t73;
  t160 = t136 * t115 / t157;
  t163 = my_piecewise5(t44, -0.6e1 * t51 * t52 * t86, t90, (-0.14e3 * t104 * t5 * t9 * t76 + 0.56e4 * t98 * t22 * t81 * t18 - 0.1863e4 * t93 * t94) * t111 / 0.2016e6, -t135 * t160 / 0.18e2);
  t167 = t22 * t94;
  t169 = params->kappa * t167 * t12;
  t170 = 0.27e2 / 0.28e2 * t30 * t32 * t163 + t169;
  t171 = t8 * t170;
  t172 = t6 * t171;
  t175 = my_piecewise3(t14, t15 * p->zeta_threshold, 0.2e1 * t16);
  t176 = 0.135e1 <= t43;
  t177 = 0.135e1 < t43;
  t178 = my_piecewise3(t177, t43, 0.135e1);
  t179 = t178 * t178;
  t180 = t179 * t179;
  t181 = t180 * t179;
  t182 = t180 * t180;
  t185 = t182 * t180;
  t187 = t182 * t179;
  t193 = 0.240888840192e14 * t182 * t181 + 0.19448e5 * t179 - 0.80784e6 * t180 + 0.3055104e8 * t181 - 0.104552448e10 * t182 - 0.90333315072e12 * t185 + 0.3226189824e11 * t187 - 0.429e3;
  t194 = t182 * t182;
  t195 = 0.1e1 / t194;
  t198 = my_piecewise3(t177, 0.135e1, t43);
  t199 = t198 * t198;
  t200 = t199 * t199;
  t203 = 0.32e2 * t200 - 0.16e2 * t199;
  t206 = exp(-0.1e1 / t199 / 0.4e1);
  t210 = 0.1e1 / t198;
  t212 = erf(t210 / 0.2e1);
  t213 = t64 * t212;
  t218 = my_piecewise3(t176, t193 * t195 / 0.8671998246912e15, t203 * t206 / 0.3e1 - 0.32e2 / 0.3e1 * t200 - 0.8e1 / 0.3e1 * t213 * t198 + 0.8e1 * t199 + 0.1e1);
  t219 = t175 * t218;
  t220 = params->b_PBE * t163;
  t222 = t28 * sigma[0] * t3;
  t226 = 0.864e3 * t220 * t222 + 0.896e3 * t169;
  t227 = 0.1e1 / t226;
  t228 = t21 * t227;
  t229 = t219 * t228;
  t232 = my_piecewise3(t2, 0, -0.84e2 * t172 * t229);
  t233 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t232 * t233;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t9;
  double t10, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t21, t22, t23, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t43, t44, t45, t47, t51, t52, t53, t55;
  double t61, t63, t64, t65, t66, t67, t71, t73;
  double t74, t76, t77, t78, t79, t81, t82, t84;
  double t85, t86, t90, t91, t92, t93, t94, t98;
  double t104, t110, t111, t115, t116, t121, t122, t124;
  double t130, t134, t135, t136, t137, t143, t144, t152;
  double t157, t160, t163, t167, t169, t170, t171, t172;
  double t175, t176, t177, t178, t179, t180, t181, t182;
  double t185, t187, t193, t194, t195, t198, t199, t200;
  double t203, t206, t210, t212, t213, t218, t219, t220;
  double t222, t226, t227, t228, t229, t232, t233, tzk0;

  double t235, t236, t243, t244, t245, t247, t248, t249;
  double t256, t260, t261, t262, t263, t264, t271, t272;
  double t273, t275, t277, t305, t306, t309, t312, t314;
  double t315, t316, t317, t318, t319, t321, t322, t328;
  double t329, t339, t340, t352, t354, t358, t363, t365;
  double t366, t367, t370, t371, t372, t376, t377, t380;
  double t381, t384, t387, t396, t400, t401, t405, t406;
  double t407, t409, t411, t414, t415, t416, t420, t427;
  double t428, t429, t432, t433, t434, t435, t438, t439;
  double t440, t443, t447, t448, t449, t453, tvrho0, t454;
  double t456, t457, t459, t460, t461, t462, t465, t466;
  double t467, t468, t469, t473, tvsigma0;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * rho[0];
  t6 = t3 * t5;
  t7 = M_CBRTPI;
  t8 = 0.1e1 / t7;
  t9 = p->cam_omega * p->cam_omega;
  t10 = params->ax * t9;
  t12 = t7 * M_PI;
  t13 = 0.1e1 / t12;
  t14 = 0.2e1 <= p->zeta_threshold;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = M_CBRT2;
  t17 = my_piecewise3(t14, t15, t16);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t20 = t13 * t19;
  t21 = t16 * t16;
  t22 = t4 * t4;
  t23 = 0.1e1 / t22;
  t28 = exp(-t10 * t3 * t20 * t21 * t23 / 0.12e2);
  t29 = params->b_PBE * t28;
  t30 = t29 * sigma[0];
  t31 = params->kappa + 0.1e1;
  t32 = t3 * t31;
  t33 = t3 * t3;
  t34 = t16 * t33;
  t35 = t7 * t7;
  t37 = t34 / t35;
  t38 = 0.1e1 / t4;
  t40 = 0.1e1 / t17;
  t43 = t37 * p->cam_omega * t38 * t40 / 0.6e1;
  t44 = t43 < 0.5e-1;
  t45 = t9 * t3;
  t47 = t12 * t18;
  t51 = (t45 * t21 - 0.7e1 / 0.6e1 * t47 * t22) * t12;
  t52 = t18 * t22;
  t53 = t18 * t17;
  t55 = 0.1e1 / p->cam_omega * t3;
  t61 = erf(t55 * t35 * t17 * t21 * t4 / 0.2e1);
  t63 = M_PI * M_PI;
  t64 = sqrt(M_PI);
  t65 = t64 * t63;
  t66 = t53 * t61 * t65;
  t67 = rho[0] * p->cam_omega;
  t71 = t47 * t21;
  t73 = t3 * t22 * t9;
  t74 = t71 * t73;
  t76 = t18 * t18;
  t77 = t35 * t63;
  t78 = t76 * t77;
  t79 = t78 * t5;
  t81 = t9 * t9;
  t82 = t81 * t33;
  t84 = 0.12e2 * t82 * t16;
  t85 = -0.36e2 * t66 * t34 * t67 + 0.54e2 * t74 + 0.81e2 * t79 - t84;
  t86 = 0.1e1 / t85;
  t90 = 0.1e11 < t43;
  t91 = t63 * t63;
  t92 = t76 * t18;
  t93 = t91 * t92;
  t94 = rho[0] * rho[0];
  t98 = t12 * t16 * t33;
  t104 = t77 * t21 * t3;
  t110 = t81 * t9;
  t111 = 0.1e1 / t110;
  t115 = 0.1e1 / t9;
  t116 = t115 * t33;
  t121 = t116 * t12 * t18 * t16 * t22 / 0.2e1;
  t122 = exp(t121);
  t124 = t122 * t12 * t18;
  t130 = t122 * t16;
  t134 = (0.7e1 * t124 * t22 * t21 * t45 - 0.12e2 * t130 * t82 + 0.11e2 * t74 + 0.6e1 * t79 + t84) * t12;
  t135 = t134 * t52;
  t136 = t21 * t33;
  t137 = t122 * t61;
  t143 = t122 * t76;
  t144 = t77 * t16;
  t152 = t122 * t21;
  t157 = 0.12e2 * t137 * t53 * t65 * t136 * t67 - 0.27e2 * t143 * t144 * t5 - 0.36e2 * t124 * t73 - 0.4e1 * t136 * t81 + 0.4e1 * t152 * t82 + 0.24e2 * t47 * t73;
  t160 = t136 * t115 / t157;
  t163 = my_piecewise5(t44, -0.6e1 * t51 * t52 * t86, t90, (-0.14e3 * t104 * t5 * t9 * t76 + 0.56e4 * t98 * t22 * t81 * t18 - 0.1863e4 * t93 * t94) * t111 / 0.2016e6, -t135 * t160 / 0.18e2);
  t167 = t22 * t94;
  t169 = params->kappa * t167 * t12;
  t170 = 0.27e2 / 0.28e2 * t30 * t32 * t163 + t169;
  t171 = t8 * t170;
  t172 = t6 * t171;
  t175 = my_piecewise3(t14, t15 * p->zeta_threshold, 0.2e1 * t16);
  t176 = 0.135e1 <= t43;
  t177 = 0.135e1 < t43;
  t178 = my_piecewise3(t177, t43, 0.135e1);
  t179 = t178 * t178;
  t180 = t179 * t179;
  t181 = t180 * t179;
  t182 = t180 * t180;
  t185 = t182 * t180;
  t187 = t182 * t179;
  t193 = 0.240888840192e14 * t182 * t181 + 0.19448e5 * t179 - 0.80784e6 * t180 + 0.3055104e8 * t181 - 0.104552448e10 * t182 - 0.90333315072e12 * t185 + 0.3226189824e11 * t187 - 0.429e3;
  t194 = t182 * t182;
  t195 = 0.1e1 / t194;
  t198 = my_piecewise3(t177, 0.135e1, t43);
  t199 = t198 * t198;
  t200 = t199 * t199;
  t203 = 0.32e2 * t200 - 0.16e2 * t199;
  t206 = exp(-0.1e1 / t199 / 0.4e1);
  t210 = 0.1e1 / t198;
  t212 = erf(t210 / 0.2e1);
  t213 = t64 * t212;
  t218 = my_piecewise3(t176, t193 * t195 / 0.8671998246912e15, t203 * t206 / 0.3e1 - 0.32e2 / 0.3e1 * t200 - 0.8e1 / 0.3e1 * t213 * t198 + 0.8e1 * t199 + 0.1e1);
  t219 = t175 * t218;
  t220 = params->b_PBE * t163;
  t222 = t28 * sigma[0] * t3;
  t226 = 0.864e3 * t220 * t222 + 0.896e3 * t169;
  t227 = 0.1e1 / t226;
  t228 = t21 * t227;
  t229 = t219 * t228;
  t232 = my_piecewise3(t2, 0, -0.84e2 * t172 * t229);
  t233 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t232 * t233;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t235 = t3 * t4;
  t236 = t235 * t171;
  t243 = params->b_PBE * params->ax * t9 * t33 * t13 * t19;
  t244 = t22 * rho[0];
  t245 = 0.1e1 / t244;
  t247 = t21 * t245 * t28;
  t248 = sigma[0] * t31;
  t249 = t248 * t163;
  t256 = t18 * t38;
  t260 = t51 * t18;
  t261 = t85 * t85;
  t262 = 0.1e1 / t261;
  t263 = t22 * t262;
  t264 = exp(-t121);
  t271 = t3 * t38;
  t272 = t271 * t9;
  t273 = t71 * t272;
  t275 = t78 * t4;
  t277 = -0.72e2 * t78 * t264 * t4 - 0.36e2 * t66 * t34 * p->cam_omega + 0.36e2 * t273 + 0.108e3 * t275;
  t305 = (0.8e1 * t275 + 0.14e2 * t78 * t4 * t122 - 0.22e2 / 0.3e1 * t124 * t38 * t21 * t45 + 0.22e2 / 0.3e1 * t273) * t12;
  t306 = t305 * t52;
  t309 = t134 * t256;
  t312 = t157 * t157;
  t314 = t115 / t312;
  t315 = t63 * M_PI;
  t316 = pow(M_PI, 0.1e1 / 0.6e1);
  t317 = t316 * t316;
  t318 = t317 * t317;
  t319 = t318 * t316;
  t321 = t55 * t319 * t315;
  t322 = t76 * t17;
  t328 = t122 * t77 * t264;
  t329 = t76 * t16;
  t339 = t116 * t91;
  t340 = t92 * t21;
  t352 = 0.12e2 * t137 * t53 * t65 * t21 * t33 * p->cam_omega - 0.9e1 * t339 * t340 * rho[0] * t122 + 0.24e2 * t321 * t322 * t22 * t137 - 0.72e2 * t143 * t144 * t4 + 0.24e2 * t328 * t329 * t4 - 0.16e2 * t124 * t272 + 0.16e2 * t47 * t272;
  t354 = t136 * t314 * t352;
  t358 = my_piecewise5(t44, 0.14e2 / 0.3e1 * t78 * t4 * t86 - 0.4e1 * t51 * t256 * t86 + 0.6e1 * t260 * t263 * t277, t90, (-0.3726e4 * t93 * rho[0] + 0.112e5 / 0.3e1 * t98 * t38 * t81 * t18 - 0.56e3 / 0.3e1 * t104 * t4 * t9 * t76) * t111 / 0.2016e6, -t306 * t160 / 0.18e2 - t309 * t160 / 0.27e2 + t135 * t354 / 0.18e2);
  t363 = params->kappa * t244 * t12;
  t365 = 0.3e1 / 0.56e2 * t243 * t247 * t249 + 0.27e2 / 0.28e2 * t30 * t32 * t358 + 0.8e1 / 0.3e1 * t363;
  t366 = t8 * t365;
  t367 = t6 * t366;
  t370 = t180 * t178;
  t371 = t182 * t370;
  t372 = 0.1e1 / t5;
  t376 = t37 * p->cam_omega * t372 * t40 / 0.18e2;
  t377 = my_piecewise3(t177, -t376, 0);
  t380 = t179 * t178;
  t381 = t182 * t380;
  t384 = t182 * t178;
  t387 = t180 * t380;
  t396 = 0.38896e5 * t178 * t377 + 0.18330624e9 * t370 * t377 + 0.3372443762688e15 * t371 * t377 - 0.323136e7 * t380 * t377 - 0.1083999780864e14 * t381 * t377 + 0.3226189824e12 * t384 * t377 - 0.836419584e10 * t387 * t377;
  t400 = 0.1e1 / t194 / t178;
  t401 = t193 * t400;
  t405 = t199 * t198;
  t406 = my_piecewise3(t177, 0, -t376);
  t407 = t405 * t406;
  t409 = t198 * t406;
  t411 = 0.128e3 * t407 - 0.32e2 * t409;
  t414 = 0.1e1 / t405;
  t415 = t203 * t414;
  t416 = t406 * t206;
  t420 = t206 * t210;
  t427 = my_piecewise3(t176, t396 * t195 / 0.8671998246912e15 - t401 * t377 / 0.541999890432e14, t411 * t206 / 0.3e1 + t415 * t416 / 0.6e1 - 0.128e3 / 0.3e1 * t407 + 0.8e1 / 0.3e1 * t420 * t406 - 0.8e1 / 0.3e1 * t213 * t406 + 0.16e2 * t409);
  t428 = t175 * t427;
  t429 = t428 * t228;
  t432 = t226 * t226;
  t433 = 0.1e1 / t432;
  t434 = t21 * t433;
  t435 = params->b_PBE * t358;
  t438 = t10 * t33;
  t439 = t220 * t438;
  t440 = t20 * t21;
  t443 = t440 * t245 * t28 * sigma[0];
  t447 = 0.864e3 * t435 * t222 + 0.48e2 * t439 * t443 + 0.7168e4 / 0.3e1 * t363;
  t448 = t434 * t447;
  t449 = t219 * t448;
  t453 = my_piecewise3(t2, 0, -0.84e2 * t172 * t429 + 0.84e2 * t172 * t449 - 0.112e3 * t236 * t229 - 0.84e2 * t367 * t229);
  tvrho0 = 0.2e1 * t453;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t454 = t33 * t5;
  t456 = t8 * params->b_PBE * t28;
  t457 = t454 * t456;
  t459 = t31 * t163 * t175;
  t460 = t218 * t21;
  t461 = t460 * t227;
  t462 = t459 * t461;
  t465 = t171 * t175;
  t466 = t454 * t465;
  t467 = t460 * t433;
  t468 = t220 * t28;
  t469 = t467 * t468;
  t473 = my_piecewise3(t2, 0, -0.81e2 * t457 * t462 + 0.72576e5 * t466 * t469);
  tvsigma0 = 0.2e1 * t473;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t9;
  double t10, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t21, t22, t23, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t43, t44, t45, t47, t51, t52, t53, t55;
  double t61, t63, t64, t65, t66, t67, t71, t73;
  double t74, t76, t77, t78, t79, t81, t82, t84;
  double t85, t86, t90, t91, t92, t93, t94, t98;
  double t104, t110, t111, t115, t116, t121, t122, t124;
  double t130, t134, t135, t136, t137, t143, t144, t152;
  double t157, t160, t163, t167, t169, t170, t171, t172;
  double t175, t176, t177, t178, t179, t180, t181, t182;
  double t185, t187, t193, t194, t195, t198, t199, t200;
  double t203, t206, t210, t212, t213, t218, t219, t220;
  double t222, t226, t227, t228, t229, t232, t233, tzk0;

  double t235, t236, t243, t244, t245, t247, t248, t249;
  double t256, t260, t261, t262, t263, t264, t271, t272;
  double t273, t275, t277, t305, t306, t309, t312, t314;
  double t315, t316, t317, t318, t319, t321, t322, t328;
  double t329, t339, t340, t352, t354, t358, t363, t365;
  double t366, t367, t370, t371, t372, t376, t377, t380;
  double t381, t384, t387, t396, t400, t401, t405, t406;
  double t407, t409, t411, t414, t415, t416, t420, t427;
  double t428, t429, t432, t433, t434, t435, t438, t439;
  double t440, t443, t447, t448, t449, t453, tvrho0, t454;
  double t456, t457, t459, t460, t461, t462, t465, t466;
  double t467, t468, t469, t473, tvsigma0;

  double t474, t475, t478, t485, t487, t491, t493, t495;
  double t497, t498, t500, t502, t506, t513, t517, t521;
  double t526, t527, t528, t532, t536, t540, t541, t543;
  double t545, t575, t576, t579, t584, t590, t591, t592;
  double t594, t601, t603, t607, t608, t613, t623, t624;
  double t625, t626, t627, t639, t641, t645, t650, t652;
  double t653, t654, t661, t665, t669, t670, t696, t699;
  double t703, t704, t710, t711, t713, t714, t717, t719;
  double t722, t725, t726, t727, t730, t734, t735, t749;
  double t750, t751, t752, t755, t759, t760, t761, t762;
  double t763, t766, t769, t774, t777, t778, t779, t780;
  double t783, t787, t788, t789, t792, t793, tv2rho20, t794;
  double t795, t799, t800, t801, t802, t803, t805, t806;
  double t807, t808, t809, t813, t814, t817, t818, t819;
  double t822, t823, t824, t825, t826, t829, t832, t833;
  double t836, t837, t840, t841, t842, t843, t844, t846;
  double t849, t850, t853, t854, t855, t856, t859, t860;
  double t863, t864, tv2rhosigma0, t865, t866, t867, t869, t870;
  double t871, t872, t873, t876, t877, t878, t879, t883;
  double tv2sigma20;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * rho[0];
  t6 = t3 * t5;
  t7 = M_CBRTPI;
  t8 = 0.1e1 / t7;
  t9 = p->cam_omega * p->cam_omega;
  t10 = params->ax * t9;
  t12 = t7 * M_PI;
  t13 = 0.1e1 / t12;
  t14 = 0.2e1 <= p->zeta_threshold;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = M_CBRT2;
  t17 = my_piecewise3(t14, t15, t16);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t20 = t13 * t19;
  t21 = t16 * t16;
  t22 = t4 * t4;
  t23 = 0.1e1 / t22;
  t28 = exp(-t10 * t3 * t20 * t21 * t23 / 0.12e2);
  t29 = params->b_PBE * t28;
  t30 = t29 * sigma[0];
  t31 = params->kappa + 0.1e1;
  t32 = t3 * t31;
  t33 = t3 * t3;
  t34 = t16 * t33;
  t35 = t7 * t7;
  t37 = t34 / t35;
  t38 = 0.1e1 / t4;
  t40 = 0.1e1 / t17;
  t43 = t37 * p->cam_omega * t38 * t40 / 0.6e1;
  t44 = t43 < 0.5e-1;
  t45 = t9 * t3;
  t47 = t12 * t18;
  t51 = (t45 * t21 - 0.7e1 / 0.6e1 * t47 * t22) * t12;
  t52 = t18 * t22;
  t53 = t18 * t17;
  t55 = 0.1e1 / p->cam_omega * t3;
  t61 = erf(t55 * t35 * t17 * t21 * t4 / 0.2e1);
  t63 = M_PI * M_PI;
  t64 = sqrt(M_PI);
  t65 = t64 * t63;
  t66 = t53 * t61 * t65;
  t67 = rho[0] * p->cam_omega;
  t71 = t47 * t21;
  t73 = t3 * t22 * t9;
  t74 = t71 * t73;
  t76 = t18 * t18;
  t77 = t35 * t63;
  t78 = t76 * t77;
  t79 = t78 * t5;
  t81 = t9 * t9;
  t82 = t81 * t33;
  t84 = 0.12e2 * t82 * t16;
  t85 = -0.36e2 * t66 * t34 * t67 + 0.54e2 * t74 + 0.81e2 * t79 - t84;
  t86 = 0.1e1 / t85;
  t90 = 0.1e11 < t43;
  t91 = t63 * t63;
  t92 = t76 * t18;
  t93 = t91 * t92;
  t94 = rho[0] * rho[0];
  t98 = t12 * t16 * t33;
  t104 = t77 * t21 * t3;
  t110 = t81 * t9;
  t111 = 0.1e1 / t110;
  t115 = 0.1e1 / t9;
  t116 = t115 * t33;
  t121 = t116 * t12 * t18 * t16 * t22 / 0.2e1;
  t122 = exp(t121);
  t124 = t122 * t12 * t18;
  t130 = t122 * t16;
  t134 = (0.7e1 * t124 * t22 * t21 * t45 - 0.12e2 * t130 * t82 + 0.11e2 * t74 + 0.6e1 * t79 + t84) * t12;
  t135 = t134 * t52;
  t136 = t21 * t33;
  t137 = t122 * t61;
  t143 = t122 * t76;
  t144 = t77 * t16;
  t152 = t122 * t21;
  t157 = 0.12e2 * t137 * t53 * t65 * t136 * t67 - 0.27e2 * t143 * t144 * t5 - 0.36e2 * t124 * t73 - 0.4e1 * t136 * t81 + 0.4e1 * t152 * t82 + 0.24e2 * t47 * t73;
  t160 = t136 * t115 / t157;
  t163 = my_piecewise5(t44, -0.6e1 * t51 * t52 * t86, t90, (-0.14e3 * t104 * t5 * t9 * t76 + 0.56e4 * t98 * t22 * t81 * t18 - 0.1863e4 * t93 * t94) * t111 / 0.2016e6, -t135 * t160 / 0.18e2);
  t167 = t22 * t94;
  t169 = params->kappa * t167 * t12;
  t170 = 0.27e2 / 0.28e2 * t30 * t32 * t163 + t169;
  t171 = t8 * t170;
  t172 = t6 * t171;
  t175 = my_piecewise3(t14, t15 * p->zeta_threshold, 0.2e1 * t16);
  t176 = 0.135e1 <= t43;
  t177 = 0.135e1 < t43;
  t178 = my_piecewise3(t177, t43, 0.135e1);
  t179 = t178 * t178;
  t180 = t179 * t179;
  t181 = t180 * t179;
  t182 = t180 * t180;
  t185 = t182 * t180;
  t187 = t182 * t179;
  t193 = 0.240888840192e14 * t182 * t181 + 0.19448e5 * t179 - 0.80784e6 * t180 + 0.3055104e8 * t181 - 0.104552448e10 * t182 - 0.90333315072e12 * t185 + 0.3226189824e11 * t187 - 0.429e3;
  t194 = t182 * t182;
  t195 = 0.1e1 / t194;
  t198 = my_piecewise3(t177, 0.135e1, t43);
  t199 = t198 * t198;
  t200 = t199 * t199;
  t203 = 0.32e2 * t200 - 0.16e2 * t199;
  t206 = exp(-0.1e1 / t199 / 0.4e1);
  t210 = 0.1e1 / t198;
  t212 = erf(t210 / 0.2e1);
  t213 = t64 * t212;
  t218 = my_piecewise3(t176, t193 * t195 / 0.8671998246912e15, t203 * t206 / 0.3e1 - 0.32e2 / 0.3e1 * t200 - 0.8e1 / 0.3e1 * t213 * t198 + 0.8e1 * t199 + 0.1e1);
  t219 = t175 * t218;
  t220 = params->b_PBE * t163;
  t222 = t28 * sigma[0] * t3;
  t226 = 0.864e3 * t220 * t222 + 0.896e3 * t169;
  t227 = 0.1e1 / t226;
  t228 = t21 * t227;
  t229 = t219 * t228;
  t232 = my_piecewise3(t2, 0, -0.84e2 * t172 * t229);
  t233 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t232 * t233;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t235 = t3 * t4;
  t236 = t235 * t171;
  t243 = params->b_PBE * params->ax * t9 * t33 * t13 * t19;
  t244 = t22 * rho[0];
  t245 = 0.1e1 / t244;
  t247 = t21 * t245 * t28;
  t248 = sigma[0] * t31;
  t249 = t248 * t163;
  t256 = t18 * t38;
  t260 = t51 * t18;
  t261 = t85 * t85;
  t262 = 0.1e1 / t261;
  t263 = t22 * t262;
  t264 = exp(-t121);
  t271 = t3 * t38;
  t272 = t271 * t9;
  t273 = t71 * t272;
  t275 = t78 * t4;
  t277 = -0.72e2 * t78 * t264 * t4 - 0.36e2 * t66 * t34 * p->cam_omega + 0.36e2 * t273 + 0.108e3 * t275;
  t305 = (0.8e1 * t275 + 0.14e2 * t78 * t4 * t122 - 0.22e2 / 0.3e1 * t124 * t38 * t21 * t45 + 0.22e2 / 0.3e1 * t273) * t12;
  t306 = t305 * t52;
  t309 = t134 * t256;
  t312 = t157 * t157;
  t314 = t115 / t312;
  t315 = t63 * M_PI;
  t316 = pow(M_PI, 0.1e1 / 0.6e1);
  t317 = t316 * t316;
  t318 = t317 * t317;
  t319 = t318 * t316;
  t321 = t55 * t319 * t315;
  t322 = t76 * t17;
  t328 = t122 * t77 * t264;
  t329 = t76 * t16;
  t339 = t116 * t91;
  t340 = t92 * t21;
  t352 = 0.12e2 * t137 * t53 * t65 * t21 * t33 * p->cam_omega - 0.9e1 * t339 * t340 * rho[0] * t122 + 0.24e2 * t321 * t322 * t22 * t137 - 0.72e2 * t143 * t144 * t4 + 0.24e2 * t328 * t329 * t4 - 0.16e2 * t124 * t272 + 0.16e2 * t47 * t272;
  t354 = t136 * t314 * t352;
  t358 = my_piecewise5(t44, 0.14e2 / 0.3e1 * t78 * t4 * t86 - 0.4e1 * t51 * t256 * t86 + 0.6e1 * t260 * t263 * t277, t90, (-0.3726e4 * t93 * rho[0] + 0.112e5 / 0.3e1 * t98 * t38 * t81 * t18 - 0.56e3 / 0.3e1 * t104 * t4 * t9 * t76) * t111 / 0.2016e6, -t306 * t160 / 0.18e2 - t309 * t160 / 0.27e2 + t135 * t354 / 0.18e2);
  t363 = params->kappa * t244 * t12;
  t365 = 0.3e1 / 0.56e2 * t243 * t247 * t249 + 0.27e2 / 0.28e2 * t30 * t32 * t358 + 0.8e1 / 0.3e1 * t363;
  t366 = t8 * t365;
  t367 = t6 * t366;
  t370 = t180 * t178;
  t371 = t182 * t370;
  t372 = 0.1e1 / t5;
  t376 = t37 * p->cam_omega * t372 * t40 / 0.18e2;
  t377 = my_piecewise3(t177, -t376, 0);
  t380 = t179 * t178;
  t381 = t182 * t380;
  t384 = t182 * t178;
  t387 = t180 * t380;
  t396 = 0.38896e5 * t178 * t377 + 0.18330624e9 * t370 * t377 + 0.3372443762688e15 * t371 * t377 - 0.323136e7 * t380 * t377 - 0.1083999780864e14 * t381 * t377 + 0.3226189824e12 * t384 * t377 - 0.836419584e10 * t387 * t377;
  t400 = 0.1e1 / t194 / t178;
  t401 = t193 * t400;
  t405 = t199 * t198;
  t406 = my_piecewise3(t177, 0, -t376);
  t407 = t405 * t406;
  t409 = t198 * t406;
  t411 = 0.128e3 * t407 - 0.32e2 * t409;
  t414 = 0.1e1 / t405;
  t415 = t203 * t414;
  t416 = t406 * t206;
  t420 = t206 * t210;
  t427 = my_piecewise3(t176, t396 * t195 / 0.8671998246912e15 - t401 * t377 / 0.541999890432e14, t411 * t206 / 0.3e1 + t415 * t416 / 0.6e1 - 0.128e3 / 0.3e1 * t407 + 0.8e1 / 0.3e1 * t420 * t406 - 0.8e1 / 0.3e1 * t213 * t406 + 0.16e2 * t409);
  t428 = t175 * t427;
  t429 = t428 * t228;
  t432 = t226 * t226;
  t433 = 0.1e1 / t432;
  t434 = t21 * t433;
  t435 = params->b_PBE * t358;
  t438 = t10 * t33;
  t439 = t220 * t438;
  t440 = t20 * t21;
  t443 = t440 * t245 * t28 * sigma[0];
  t447 = 0.864e3 * t435 * t222 + 0.48e2 * t439 * t443 + 0.7168e4 / 0.3e1 * t363;
  t448 = t434 * t447;
  t449 = t219 * t448;
  t453 = my_piecewise3(t2, 0, -0.84e2 * t172 * t429 + 0.84e2 * t172 * t449 - 0.112e3 * t236 * t229 - 0.84e2 * t367 * t229);
  tvrho0 = 0.2e1 * t453;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t454 = t33 * t5;
  t456 = t8 * params->b_PBE * t28;
  t457 = t454 * t456;
  t459 = t31 * t163 * t175;
  t460 = t218 * t21;
  t461 = t460 * t227;
  t462 = t459 * t461;
  t465 = t171 * t175;
  t466 = t454 * t465;
  t467 = t460 * t433;
  t468 = t220 * t28;
  t469 = t467 * t468;
  t473 = my_piecewise3(t2, 0, -0.81e2 * t457 * t462 + 0.72576e5 * t466 * t469);
  tvsigma0 = 0.2e1 * t473;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t474 = t3 * t23;
  t475 = t474 * t171;
  t478 = t235 * t366;
  t485 = 0.1e1 / t167;
  t487 = t21 * t485 * t28;
  t491 = params->ax * params->ax;
  t493 = 0.1e1 / t77;
  t495 = 0.1e1 / t76;
  t497 = params->b_PBE * t491 * t81 * t493 * t495;
  t498 = t94 * rho[0];
  t500 = 0.1e1 / t4 / t498;
  t502 = t16 * t500 * t28;
  t506 = t248 * t358;
  t513 = t4 * t262;
  t517 = t18 * t372;
  t521 = t38 * t262;
  t526 = 0.1e1 / t261 / t85;
  t527 = t22 * t526;
  t528 = t277 * t277;
  t532 = t93 * t115;
  t536 = t264 * t23;
  t540 = t3 * t372 * t9;
  t541 = t71 * t540;
  t543 = t78 * t23;
  t545 = 0.24e2 * t532 * t34 * t264 - 0.96e2 * t78 * t536 - 0.12e2 * t541 + 0.36e2 * t543;
  t575 = (0.8e1 / 0.3e1 * t543 - 0.1e2 * t78 * t23 * t122 + 0.14e2 / 0.3e1 * t532 * t34 * t122 + 0.22e2 / 0.9e1 * t124 * t372 * t21 * t45 - 0.22e2 / 0.9e1 * t541) * t12;
  t576 = t575 * t52;
  t579 = t305 * t256;
  t584 = t134 * t517;
  t590 = 0.1e1 / t312 / t157;
  t591 = t115 * t590;
  t592 = t352 * t352;
  t594 = t136 * t591 * t592;
  t601 = t9 * p->cam_omega;
  t603 = t91 * M_PI;
  t607 = 0.1e1 / t601 * t316 * t603 * t76 * t53;
  t608 = t4 * t16;
  t613 = t264 * t21;
  t623 = 0.1e1 / t81;
  t624 = t623 * t3;
  t625 = t7 * t603;
  t626 = t624 * t625;
  t627 = t76 * t76;
  t639 = 0.4e2 * t321 * t322 * t38 * t137 + 0.24e2 * t607 * t608 * t137 + 0.8e1 * t339 * t92 * t122 * t613 + 0.32e2 * t328 * t329 * t23 - 0.33e2 * t339 * t340 * t122 - 0.18e2 * t626 * t627 * t22 * t122 - 0.4e2 * t143 * t144 * t23 + 0.16e2 / 0.3e1 * t124 * t540 - 0.16e2 / 0.3e1 * t47 * t540;
  t641 = t136 * t314 * t639;
  t645 = my_piecewise5(t44, 0.14e2 / 0.3e1 * t78 * t23 * t86 - 0.28e2 / 0.3e1 * t78 * t513 * t277 + 0.4e1 / 0.3e1 * t51 * t517 * t86 + 0.8e1 * t260 * t521 * t277 - 0.12e2 * t260 * t527 * t528 + 0.6e1 * t260 * t263 * t545, t90, (-0.3726e4 * t93 - 0.112e5 / 0.9e1 * t98 * t372 * t81 * t18 - 0.56e3 / 0.9e1 * t104 * t23 * t9 * t76) * t111 / 0.2016e6, -t576 * t160 / 0.18e2 - 0.2e1 / 0.27e2 * t579 * t160 + t306 * t354 / 0.9e1 + t584 * t160 / 0.81e2 + 0.2e1 / 0.27e2 * t309 * t354 - t135 * t594 / 0.9e1 + t135 * t641 / 0.18e2);
  t650 = params->kappa * t22 * t12;
  t652 = -0.5e1 / 0.56e2 * t243 * t487 * t249 + t497 * t502 * t249 / 0.56e2 + 0.3e1 / 0.28e2 * t243 * t247 * t506 + 0.27e2 / 0.28e2 * t30 * t32 * t645 + 0.4e2 / 0.9e1 * t650;
  t653 = t8 * t652;
  t654 = t6 * t653;
  t661 = t377 * t377;
  t665 = 0.1e1 / t4 / t94;
  t669 = 0.2e1 / 0.27e2 * t37 * p->cam_omega * t665 * t40;
  t670 = my_piecewise3(t177, t669, 0);
  t696 = 0.38896e5 * t178 * t670 - 0.969408e7 * t179 * t661 + 0.9165312e9 * t180 * t661 - 0.5854937088e11 * t181 * t661 + 0.29035708416e13 * t182 * t661 + 0.43841768914944e16 * t185 * t661 - 0.11923997589504e15 * t187 * t661 + 0.18330624e9 * t370 * t670 + 0.3372443762688e15 * t371 * t670 - 0.323136e7 * t380 * t670 - 0.1083999780864e14 * t381 * t670 + 0.3226189824e12 * t384 * t670 - 0.836419584e10 * t387 * t670 + 0.38896e5 * t661;
  t699 = t396 * t400;
  t703 = 0.1e1 / t194 / t179;
  t704 = t193 * t703;
  t710 = t406 * t406;
  t711 = t199 * t710;
  t713 = my_piecewise3(t177, 0, t669);
  t714 = t405 * t713;
  t717 = t198 * t713;
  t719 = 0.384e3 * t711 + 0.128e3 * t714 - 0.32e2 * t710 - 0.32e2 * t717;
  t722 = t411 * t414;
  t725 = 0.1e1 / t200;
  t726 = t203 * t725;
  t727 = t710 * t206;
  t730 = t713 * t206;
  t734 = 0.1e1 / t200 / t199;
  t735 = t203 * t734;
  t749 = t719 * t206 / 0.3e1 + t722 * t416 / 0.3e1 - t726 * t727 / 0.2e1 + t415 * t730 / 0.6e1 + t735 * t727 / 0.12e2 - 0.128e3 * t711 - 0.128e3 / 0.3e1 * t714 + 0.4e1 / 0.3e1 * t725 * t710 * t206 + 0.8e1 / 0.3e1 * t420 * t713 - 0.8e1 / 0.3e1 * t213 * t713 + 0.16e2 * t710 + 0.16e2 * t717;
  t750 = my_piecewise3(t176, t696 * t195 / 0.8671998246912e15 - t699 * t377 / 0.270999945216e14 + t704 * t661 / 0.31882346496e13 - t401 * t670 / 0.541999890432e14, t749);
  t751 = t175 * t750;
  t752 = t751 * t228;
  t755 = t428 * t448;
  t759 = 0.1e1 / t432 / t226;
  t760 = t21 * t759;
  t761 = t447 * t447;
  t762 = t760 * t761;
  t763 = t219 * t762;
  t766 = params->b_PBE * t645;
  t769 = t435 * t438;
  t774 = t440 * t485 * t28 * sigma[0];
  t777 = t491 * t81;
  t778 = t777 * t493;
  t779 = t220 * t778;
  t780 = t495 * t16;
  t783 = t780 * t500 * t28 * sigma[0];
  t787 = 0.864e3 * t766 * t222 + 0.96e2 * t769 * t443 - 0.8e2 * t439 * t774 + 0.16e2 * t779 * t783 + 0.3584e5 / 0.9e1 * t650;
  t788 = t434 * t787;
  t789 = t219 * t788;
  t792 = -0.112e3 / 0.3e1 * t475 * t229 - 0.224e3 * t478 * t229 - 0.224e3 * t236 * t429 + 0.224e3 * t236 * t449 - 0.84e2 * t654 * t229 - 0.168e3 * t367 * t429 + 0.168e3 * t367 * t449 - 0.84e2 * t172 * t752 + 0.168e3 * t172 * t755 - 0.168e3 * t172 * t763 + 0.84e2 * t172 * t789;
  t793 = my_piecewise3(t2, 0, t792);
  tv2rho20 = 0.2e1 * t793;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t794 = t33 * t4;
  t795 = t794 * t456;
  t799 = 0.1e1 / t35 / M_PI;
  t800 = t38 * t799;
  t801 = t800 * params->b_PBE;
  t802 = t10 * t19;
  t803 = t801 * t802;
  t805 = t16 * t28 * t31;
  t806 = t163 * t175;
  t807 = t218 * t227;
  t808 = t806 * t807;
  t809 = t805 * t808;
  t813 = t31 * t358 * t175;
  t814 = t813 * t461;
  t817 = t427 * t21;
  t818 = t817 * t227;
  t819 = t459 * t818;
  t822 = t454 * t8;
  t823 = t29 * t31;
  t824 = t822 * t823;
  t825 = t806 * t218;
  t826 = t825 * t448;
  t829 = t794 * t465;
  t832 = t366 * t175;
  t833 = t454 * t832;
  t836 = t817 * t433;
  t837 = t836 * t468;
  t840 = t170 * t175;
  t841 = t840 * t218;
  t842 = t822 * t841;
  t843 = t760 * params->b_PBE;
  t844 = t163 * t28;
  t846 = t843 * t844 * t447;
  t849 = t435 * t28;
  t850 = t467 * t849;
  t853 = t800 * t170;
  t854 = t219 * t16;
  t855 = t853 * t854;
  t856 = t433 * params->b_PBE;
  t859 = t10 * t19 * t28;
  t860 = t856 * t163 * t859;
  t863 = -0.81e2 * t457 * t814 - 0.81e2 * t457 * t819 - 0.108e3 * t795 * t462 + 0.72576e5 * t466 * t837 + 0.72576e5 * t466 * t850 + 0.96768e5 * t829 * t469 + 0.72576e5 * t833 * t469 - 0.27e2 * t803 * t809 + 0.81e2 * t824 * t826 - 0.145152e6 * t842 * t846 + 0.24192e5 * t855 * t860;
  t864 = my_piecewise3(t2, 0, t863);
  tv2rhosigma0 = 0.2e1 * t864;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t865 = t5 * t8;
  t866 = params->b_PBE * params->b_PBE;
  t867 = t28 * t28;
  t869 = t866 * t867 * t31;
  t870 = t865 * t869;
  t871 = t163 * t163;
  t872 = t871 * t175;
  t873 = t872 * t467;
  t876 = t865 * t841;
  t877 = t866 * t871;
  t878 = t877 * t867;
  t879 = t760 * t878;
  t883 = my_piecewise3(t2, 0, 0.419904e6 * t870 * t873 - 0.376233984e9 * t876 * t879);
  tv2sigma20 = 0.2e1 * t883;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t9;
  double t10, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t21, t22, t23, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t43, t44, t45, t47, t51, t52, t53, t55;
  double t61, t63, t64, t65, t66, t67, t71, t73;
  double t74, t76, t77, t78, t79, t81, t82, t84;
  double t85, t86, t90, t91, t92, t93, t94, t98;
  double t104, t110, t111, t115, t116, t121, t122, t124;
  double t130, t134, t135, t136, t137, t143, t144, t152;
  double t157, t160, t163, t167, t169, t170, t171, t172;
  double t175, t176, t177, t178, t179, t180, t181, t182;
  double t185, t187, t193, t194, t195, t198, t199, t200;
  double t203, t206, t210, t212, t213, t218, t219, t220;
  double t222, t226, t227, t228, t229, t232, t233, tzk0;

  double t235, t236, t243, t244, t245, t247, t248, t249;
  double t256, t260, t261, t262, t263, t264, t271, t272;
  double t273, t275, t277, t305, t306, t309, t312, t314;
  double t315, t316, t317, t318, t319, t321, t322, t328;
  double t329, t339, t340, t352, t354, t358, t363, t365;
  double t366, t367, t370, t371, t372, t376, t377, t380;
  double t381, t384, t387, t396, t400, t401, t405, t406;
  double t407, t409, t411, t414, t415, t416, t420, t427;
  double t428, t429, t432, t433, t434, t435, t438, t439;
  double t440, t443, t447, t448, t449, t453, tvrho0, t454;
  double t456, t457, t459, t460, t461, t462, t465, t466;
  double t467, t468, t469, t473, tvsigma0;

  double t474, t475, t478, t485, t487, t491, t493, t495;
  double t497, t498, t500, t502, t506, t513, t517, t521;
  double t526, t527, t528, t532, t536, t540, t541, t543;
  double t545, t575, t576, t579, t584, t590, t591, t592;
  double t594, t601, t603, t607, t608, t613, t623, t624;
  double t625, t626, t627, t639, t641, t645, t650, t652;
  double t653, t654, t661, t665, t669, t670, t696, t699;
  double t703, t704, t710, t711, t713, t714, t717, t719;
  double t722, t725, t726, t727, t730, t734, t735, t749;
  double t750, t751, t752, t755, t759, t760, t761, t762;
  double t763, t766, t769, t774, t777, t778, t779, t780;
  double t783, t787, t788, t789, t792, t793, tv2rho20, t794;
  double t795, t799, t800, t801, t802, t803, t805, t806;
  double t807, t808, t809, t813, t814, t817, t818, t819;
  double t822, t823, t824, t825, t826, t829, t832, t833;
  double t836, t837, t840, t841, t842, t843, t844, t846;
  double t849, t850, t853, t854, t855, t856, t859, t860;
  double t863, t864, tv2rhosigma0, t865, t866, t867, t869, t870;
  double t871, t872, t873, t876, t877, t878, t879, t883;
  double tv2sigma20;

  double t887, t898, t902, t906, t913, t914, t915, t916;
  double t920, t924, t925, t926, t939, t940, t942, t944;
  double t948, t968, t972, t973, t979, t981, t982, t984;
  double t987, t988, t999, t1001, t1002, t1016, t1018, t1021;
  double t1026, t1033, t1040, t1041, t1045, t1048, t1049, t1050;
  double t1053, t1061, t1073, t1074, t1077, t1078, t1079, t1082;
  double t1087, t1091, t1094, t1097, t1099, t1102, t1105, t1106;
  double t1107, t1108, t1109, t1110, t1111, t1112, t1114, t1118;
  double t1120, t1121, t1122, t1129, t1132, t1147, t1150, t1153;
  double t1154, t1155, t1156, t1157, t1158, t1162, t1167, t1177;
  double t1179, t1186, t1195, t1196, t1199, t1204, t1211, t1212;
  double t1219, t1222, t1227, t1232, t1237, t1242, t1247, t1253;
  double t1254, t1267, t1271, t1274, t1277, t1283, t1284, t1292;
  double t1297, t1301, t1302, t1303, t1304, t1307, t1308, t1311;
  double t1313, t1314, t1318, t1322, t1325, t1328, t1332, t1337;
  double t1339, t1340, t1351, t1353, t1355, t1357, t1363, t1365;
  double t1366, t1367, t1370, t1371, t1372, t1373, t1376, t1378;
  double tv3rho30, t1379, t1380, t1381, t1382, t1383, t1384, t1387;
  double t1388, t1389, t1393, t1396, t1397, t1398, t1401, t1402;
  double t1405, t1406, t1409, t1410, t1413, t1414, t1415, t1418;
  double t1419, t1420, t1423, t1424, t1425, t1426, t1427, t1430;
  double t1431, t1432, t1435, t1436, t1439, t1442, t1443, t1446;
  double t1447, t1450, t1451, t1454, t1456, t1460, t1463, t1466;
  double t1468, t1471, t1472, t1475, t1476, t1481, t1482, t1489;
  double t1490, t1491, t1494, t1497, t1498, t1501, t1511, t1512;
  double t1515, t1518, t1519, t1522, t1526, t1527, t1528, t1529;
  double t1530, t1531, t1532, t1535, t1536, t1537, t1538, t1539;
  double t1540, t1541, t1542, t1545, t1547, tv3rho2sigma0, t1548, t1549;
  double t1552, t1553, t1554, t1555, t1556, t1559, t1560, t1563;
  double t1564, t1567, t1570, t1571, t1572, t1575, t1578, t1581;
  double t1584, t1585, t1587, t1590, t1591, t1593, t1596, t1599;
  double t1600, tv3rhosigma20, t1601, t1602, t1604, t1605, t1606, t1607;
  double t1609, t1610, t1616, t1620, tv3sigma30;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * rho[0];
  t6 = t3 * t5;
  t7 = M_CBRTPI;
  t8 = 0.1e1 / t7;
  t9 = p->cam_omega * p->cam_omega;
  t10 = params->ax * t9;
  t12 = t7 * M_PI;
  t13 = 0.1e1 / t12;
  t14 = 0.2e1 <= p->zeta_threshold;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = M_CBRT2;
  t17 = my_piecewise3(t14, t15, t16);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t20 = t13 * t19;
  t21 = t16 * t16;
  t22 = t4 * t4;
  t23 = 0.1e1 / t22;
  t28 = exp(-t10 * t3 * t20 * t21 * t23 / 0.12e2);
  t29 = params->b_PBE * t28;
  t30 = t29 * sigma[0];
  t31 = params->kappa + 0.1e1;
  t32 = t3 * t31;
  t33 = t3 * t3;
  t34 = t16 * t33;
  t35 = t7 * t7;
  t37 = t34 / t35;
  t38 = 0.1e1 / t4;
  t40 = 0.1e1 / t17;
  t43 = t37 * p->cam_omega * t38 * t40 / 0.6e1;
  t44 = t43 < 0.5e-1;
  t45 = t9 * t3;
  t47 = t12 * t18;
  t51 = (t45 * t21 - 0.7e1 / 0.6e1 * t47 * t22) * t12;
  t52 = t18 * t22;
  t53 = t18 * t17;
  t55 = 0.1e1 / p->cam_omega * t3;
  t61 = erf(t55 * t35 * t17 * t21 * t4 / 0.2e1);
  t63 = M_PI * M_PI;
  t64 = sqrt(M_PI);
  t65 = t64 * t63;
  t66 = t53 * t61 * t65;
  t67 = rho[0] * p->cam_omega;
  t71 = t47 * t21;
  t73 = t3 * t22 * t9;
  t74 = t71 * t73;
  t76 = t18 * t18;
  t77 = t35 * t63;
  t78 = t76 * t77;
  t79 = t78 * t5;
  t81 = t9 * t9;
  t82 = t81 * t33;
  t84 = 0.12e2 * t82 * t16;
  t85 = -0.36e2 * t66 * t34 * t67 + 0.54e2 * t74 + 0.81e2 * t79 - t84;
  t86 = 0.1e1 / t85;
  t90 = 0.1e11 < t43;
  t91 = t63 * t63;
  t92 = t76 * t18;
  t93 = t91 * t92;
  t94 = rho[0] * rho[0];
  t98 = t12 * t16 * t33;
  t104 = t77 * t21 * t3;
  t110 = t81 * t9;
  t111 = 0.1e1 / t110;
  t115 = 0.1e1 / t9;
  t116 = t115 * t33;
  t121 = t116 * t12 * t18 * t16 * t22 / 0.2e1;
  t122 = exp(t121);
  t124 = t122 * t12 * t18;
  t130 = t122 * t16;
  t134 = (0.7e1 * t124 * t22 * t21 * t45 - 0.12e2 * t130 * t82 + 0.11e2 * t74 + 0.6e1 * t79 + t84) * t12;
  t135 = t134 * t52;
  t136 = t21 * t33;
  t137 = t122 * t61;
  t143 = t122 * t76;
  t144 = t77 * t16;
  t152 = t122 * t21;
  t157 = 0.12e2 * t137 * t53 * t65 * t136 * t67 - 0.27e2 * t143 * t144 * t5 - 0.36e2 * t124 * t73 - 0.4e1 * t136 * t81 + 0.4e1 * t152 * t82 + 0.24e2 * t47 * t73;
  t160 = t136 * t115 / t157;
  t163 = my_piecewise5(t44, -0.6e1 * t51 * t52 * t86, t90, (-0.14e3 * t104 * t5 * t9 * t76 + 0.56e4 * t98 * t22 * t81 * t18 - 0.1863e4 * t93 * t94) * t111 / 0.2016e6, -t135 * t160 / 0.18e2);
  t167 = t22 * t94;
  t169 = params->kappa * t167 * t12;
  t170 = 0.27e2 / 0.28e2 * t30 * t32 * t163 + t169;
  t171 = t8 * t170;
  t172 = t6 * t171;
  t175 = my_piecewise3(t14, t15 * p->zeta_threshold, 0.2e1 * t16);
  t176 = 0.135e1 <= t43;
  t177 = 0.135e1 < t43;
  t178 = my_piecewise3(t177, t43, 0.135e1);
  t179 = t178 * t178;
  t180 = t179 * t179;
  t181 = t180 * t179;
  t182 = t180 * t180;
  t185 = t182 * t180;
  t187 = t182 * t179;
  t193 = 0.240888840192e14 * t182 * t181 + 0.19448e5 * t179 - 0.80784e6 * t180 + 0.3055104e8 * t181 - 0.104552448e10 * t182 - 0.90333315072e12 * t185 + 0.3226189824e11 * t187 - 0.429e3;
  t194 = t182 * t182;
  t195 = 0.1e1 / t194;
  t198 = my_piecewise3(t177, 0.135e1, t43);
  t199 = t198 * t198;
  t200 = t199 * t199;
  t203 = 0.32e2 * t200 - 0.16e2 * t199;
  t206 = exp(-0.1e1 / t199 / 0.4e1);
  t210 = 0.1e1 / t198;
  t212 = erf(t210 / 0.2e1);
  t213 = t64 * t212;
  t218 = my_piecewise3(t176, t193 * t195 / 0.8671998246912e15, t203 * t206 / 0.3e1 - 0.32e2 / 0.3e1 * t200 - 0.8e1 / 0.3e1 * t213 * t198 + 0.8e1 * t199 + 0.1e1);
  t219 = t175 * t218;
  t220 = params->b_PBE * t163;
  t222 = t28 * sigma[0] * t3;
  t226 = 0.864e3 * t220 * t222 + 0.896e3 * t169;
  t227 = 0.1e1 / t226;
  t228 = t21 * t227;
  t229 = t219 * t228;
  t232 = my_piecewise3(t2, 0, -0.84e2 * t172 * t229);
  t233 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t232 * t233;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t235 = t3 * t4;
  t236 = t235 * t171;
  t243 = params->b_PBE * params->ax * t9 * t33 * t13 * t19;
  t244 = t22 * rho[0];
  t245 = 0.1e1 / t244;
  t247 = t21 * t245 * t28;
  t248 = sigma[0] * t31;
  t249 = t248 * t163;
  t256 = t18 * t38;
  t260 = t51 * t18;
  t261 = t85 * t85;
  t262 = 0.1e1 / t261;
  t263 = t22 * t262;
  t264 = exp(-t121);
  t271 = t3 * t38;
  t272 = t271 * t9;
  t273 = t71 * t272;
  t275 = t78 * t4;
  t277 = -0.72e2 * t78 * t264 * t4 - 0.36e2 * t66 * t34 * p->cam_omega + 0.36e2 * t273 + 0.108e3 * t275;
  t305 = (0.8e1 * t275 + 0.14e2 * t78 * t4 * t122 - 0.22e2 / 0.3e1 * t124 * t38 * t21 * t45 + 0.22e2 / 0.3e1 * t273) * t12;
  t306 = t305 * t52;
  t309 = t134 * t256;
  t312 = t157 * t157;
  t314 = t115 / t312;
  t315 = t63 * M_PI;
  t316 = pow(M_PI, 0.1e1 / 0.6e1);
  t317 = t316 * t316;
  t318 = t317 * t317;
  t319 = t318 * t316;
  t321 = t55 * t319 * t315;
  t322 = t76 * t17;
  t328 = t122 * t77 * t264;
  t329 = t76 * t16;
  t339 = t116 * t91;
  t340 = t92 * t21;
  t352 = 0.12e2 * t137 * t53 * t65 * t21 * t33 * p->cam_omega - 0.9e1 * t339 * t340 * rho[0] * t122 + 0.24e2 * t321 * t322 * t22 * t137 - 0.72e2 * t143 * t144 * t4 + 0.24e2 * t328 * t329 * t4 - 0.16e2 * t124 * t272 + 0.16e2 * t47 * t272;
  t354 = t136 * t314 * t352;
  t358 = my_piecewise5(t44, 0.14e2 / 0.3e1 * t78 * t4 * t86 - 0.4e1 * t51 * t256 * t86 + 0.6e1 * t260 * t263 * t277, t90, (-0.3726e4 * t93 * rho[0] + 0.112e5 / 0.3e1 * t98 * t38 * t81 * t18 - 0.56e3 / 0.3e1 * t104 * t4 * t9 * t76) * t111 / 0.2016e6, -t306 * t160 / 0.18e2 - t309 * t160 / 0.27e2 + t135 * t354 / 0.18e2);
  t363 = params->kappa * t244 * t12;
  t365 = 0.3e1 / 0.56e2 * t243 * t247 * t249 + 0.27e2 / 0.28e2 * t30 * t32 * t358 + 0.8e1 / 0.3e1 * t363;
  t366 = t8 * t365;
  t367 = t6 * t366;
  t370 = t180 * t178;
  t371 = t182 * t370;
  t372 = 0.1e1 / t5;
  t376 = t37 * p->cam_omega * t372 * t40 / 0.18e2;
  t377 = my_piecewise3(t177, -t376, 0);
  t380 = t179 * t178;
  t381 = t182 * t380;
  t384 = t182 * t178;
  t387 = t180 * t380;
  t396 = 0.38896e5 * t178 * t377 + 0.18330624e9 * t370 * t377 + 0.3372443762688e15 * t371 * t377 - 0.323136e7 * t380 * t377 - 0.1083999780864e14 * t381 * t377 + 0.3226189824e12 * t384 * t377 - 0.836419584e10 * t387 * t377;
  t400 = 0.1e1 / t194 / t178;
  t401 = t193 * t400;
  t405 = t199 * t198;
  t406 = my_piecewise3(t177, 0, -t376);
  t407 = t405 * t406;
  t409 = t198 * t406;
  t411 = 0.128e3 * t407 - 0.32e2 * t409;
  t414 = 0.1e1 / t405;
  t415 = t203 * t414;
  t416 = t406 * t206;
  t420 = t206 * t210;
  t427 = my_piecewise3(t176, t396 * t195 / 0.8671998246912e15 - t401 * t377 / 0.541999890432e14, t411 * t206 / 0.3e1 + t415 * t416 / 0.6e1 - 0.128e3 / 0.3e1 * t407 + 0.8e1 / 0.3e1 * t420 * t406 - 0.8e1 / 0.3e1 * t213 * t406 + 0.16e2 * t409);
  t428 = t175 * t427;
  t429 = t428 * t228;
  t432 = t226 * t226;
  t433 = 0.1e1 / t432;
  t434 = t21 * t433;
  t435 = params->b_PBE * t358;
  t438 = t10 * t33;
  t439 = t220 * t438;
  t440 = t20 * t21;
  t443 = t440 * t245 * t28 * sigma[0];
  t447 = 0.864e3 * t435 * t222 + 0.48e2 * t439 * t443 + 0.7168e4 / 0.3e1 * t363;
  t448 = t434 * t447;
  t449 = t219 * t448;
  t453 = my_piecewise3(t2, 0, -0.84e2 * t172 * t429 + 0.84e2 * t172 * t449 - 0.112e3 * t236 * t229 - 0.84e2 * t367 * t229);
  tvrho0 = 0.2e1 * t453;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t454 = t33 * t5;
  t456 = t8 * params->b_PBE * t28;
  t457 = t454 * t456;
  t459 = t31 * t163 * t175;
  t460 = t218 * t21;
  t461 = t460 * t227;
  t462 = t459 * t461;
  t465 = t171 * t175;
  t466 = t454 * t465;
  t467 = t460 * t433;
  t468 = t220 * t28;
  t469 = t467 * t468;
  t473 = my_piecewise3(t2, 0, -0.81e2 * t457 * t462 + 0.72576e5 * t466 * t469);
  tvsigma0 = 0.2e1 * t473;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t474 = t3 * t23;
  t475 = t474 * t171;
  t478 = t235 * t366;
  t485 = 0.1e1 / t167;
  t487 = t21 * t485 * t28;
  t491 = params->ax * params->ax;
  t493 = 0.1e1 / t77;
  t495 = 0.1e1 / t76;
  t497 = params->b_PBE * t491 * t81 * t493 * t495;
  t498 = t94 * rho[0];
  t500 = 0.1e1 / t4 / t498;
  t502 = t16 * t500 * t28;
  t506 = t248 * t358;
  t513 = t4 * t262;
  t517 = t18 * t372;
  t521 = t38 * t262;
  t526 = 0.1e1 / t261 / t85;
  t527 = t22 * t526;
  t528 = t277 * t277;
  t532 = t93 * t115;
  t536 = t264 * t23;
  t540 = t3 * t372 * t9;
  t541 = t71 * t540;
  t543 = t78 * t23;
  t545 = 0.24e2 * t532 * t34 * t264 - 0.96e2 * t78 * t536 - 0.12e2 * t541 + 0.36e2 * t543;
  t575 = (0.8e1 / 0.3e1 * t543 - 0.1e2 * t78 * t23 * t122 + 0.14e2 / 0.3e1 * t532 * t34 * t122 + 0.22e2 / 0.9e1 * t124 * t372 * t21 * t45 - 0.22e2 / 0.9e1 * t541) * t12;
  t576 = t575 * t52;
  t579 = t305 * t256;
  t584 = t134 * t517;
  t590 = 0.1e1 / t312 / t157;
  t591 = t115 * t590;
  t592 = t352 * t352;
  t594 = t136 * t591 * t592;
  t601 = t9 * p->cam_omega;
  t603 = t91 * M_PI;
  t607 = 0.1e1 / t601 * t316 * t603 * t76 * t53;
  t608 = t4 * t16;
  t613 = t264 * t21;
  t623 = 0.1e1 / t81;
  t624 = t623 * t3;
  t625 = t7 * t603;
  t626 = t624 * t625;
  t627 = t76 * t76;
  t639 = 0.4e2 * t321 * t322 * t38 * t137 + 0.24e2 * t607 * t608 * t137 + 0.8e1 * t339 * t92 * t122 * t613 + 0.32e2 * t328 * t329 * t23 - 0.33e2 * t339 * t340 * t122 - 0.18e2 * t626 * t627 * t22 * t122 - 0.4e2 * t143 * t144 * t23 + 0.16e2 / 0.3e1 * t124 * t540 - 0.16e2 / 0.3e1 * t47 * t540;
  t641 = t136 * t314 * t639;
  t645 = my_piecewise5(t44, 0.14e2 / 0.3e1 * t78 * t23 * t86 - 0.28e2 / 0.3e1 * t78 * t513 * t277 + 0.4e1 / 0.3e1 * t51 * t517 * t86 + 0.8e1 * t260 * t521 * t277 - 0.12e2 * t260 * t527 * t528 + 0.6e1 * t260 * t263 * t545, t90, (-0.3726e4 * t93 - 0.112e5 / 0.9e1 * t98 * t372 * t81 * t18 - 0.56e3 / 0.9e1 * t104 * t23 * t9 * t76) * t111 / 0.2016e6, -t576 * t160 / 0.18e2 - 0.2e1 / 0.27e2 * t579 * t160 + t306 * t354 / 0.9e1 + t584 * t160 / 0.81e2 + 0.2e1 / 0.27e2 * t309 * t354 - t135 * t594 / 0.9e1 + t135 * t641 / 0.18e2);
  t650 = params->kappa * t22 * t12;
  t652 = -0.5e1 / 0.56e2 * t243 * t487 * t249 + t497 * t502 * t249 / 0.56e2 + 0.3e1 / 0.28e2 * t243 * t247 * t506 + 0.27e2 / 0.28e2 * t30 * t32 * t645 + 0.4e2 / 0.9e1 * t650;
  t653 = t8 * t652;
  t654 = t6 * t653;
  t661 = t377 * t377;
  t665 = 0.1e1 / t4 / t94;
  t669 = 0.2e1 / 0.27e2 * t37 * p->cam_omega * t665 * t40;
  t670 = my_piecewise3(t177, t669, 0);
  t696 = 0.38896e5 * t178 * t670 - 0.969408e7 * t179 * t661 + 0.9165312e9 * t180 * t661 - 0.5854937088e11 * t181 * t661 + 0.29035708416e13 * t182 * t661 + 0.43841768914944e16 * t185 * t661 - 0.11923997589504e15 * t187 * t661 + 0.18330624e9 * t370 * t670 + 0.3372443762688e15 * t371 * t670 - 0.323136e7 * t380 * t670 - 0.1083999780864e14 * t381 * t670 + 0.3226189824e12 * t384 * t670 - 0.836419584e10 * t387 * t670 + 0.38896e5 * t661;
  t699 = t396 * t400;
  t703 = 0.1e1 / t194 / t179;
  t704 = t193 * t703;
  t710 = t406 * t406;
  t711 = t199 * t710;
  t713 = my_piecewise3(t177, 0, t669);
  t714 = t405 * t713;
  t717 = t198 * t713;
  t719 = 0.384e3 * t711 + 0.128e3 * t714 - 0.32e2 * t710 - 0.32e2 * t717;
  t722 = t411 * t414;
  t725 = 0.1e1 / t200;
  t726 = t203 * t725;
  t727 = t710 * t206;
  t730 = t713 * t206;
  t734 = 0.1e1 / t200 / t199;
  t735 = t203 * t734;
  t749 = t719 * t206 / 0.3e1 + t722 * t416 / 0.3e1 - t726 * t727 / 0.2e1 + t415 * t730 / 0.6e1 + t735 * t727 / 0.12e2 - 0.128e3 * t711 - 0.128e3 / 0.3e1 * t714 + 0.4e1 / 0.3e1 * t725 * t710 * t206 + 0.8e1 / 0.3e1 * t420 * t713 - 0.8e1 / 0.3e1 * t213 * t713 + 0.16e2 * t710 + 0.16e2 * t717;
  t750 = my_piecewise3(t176, t696 * t195 / 0.8671998246912e15 - t699 * t377 / 0.270999945216e14 + t704 * t661 / 0.31882346496e13 - t401 * t670 / 0.541999890432e14, t749);
  t751 = t175 * t750;
  t752 = t751 * t228;
  t755 = t428 * t448;
  t759 = 0.1e1 / t432 / t226;
  t760 = t21 * t759;
  t761 = t447 * t447;
  t762 = t760 * t761;
  t763 = t219 * t762;
  t766 = params->b_PBE * t645;
  t769 = t435 * t438;
  t774 = t440 * t485 * t28 * sigma[0];
  t777 = t491 * t81;
  t778 = t777 * t493;
  t779 = t220 * t778;
  t780 = t495 * t16;
  t783 = t780 * t500 * t28 * sigma[0];
  t787 = 0.864e3 * t766 * t222 + 0.96e2 * t769 * t443 - 0.8e2 * t439 * t774 + 0.16e2 * t779 * t783 + 0.3584e5 / 0.9e1 * t650;
  t788 = t434 * t787;
  t789 = t219 * t788;
  t792 = -0.112e3 / 0.3e1 * t475 * t229 - 0.224e3 * t478 * t229 - 0.224e3 * t236 * t429 + 0.224e3 * t236 * t449 - 0.84e2 * t654 * t229 - 0.168e3 * t367 * t429 + 0.168e3 * t367 * t449 - 0.84e2 * t172 * t752 + 0.168e3 * t172 * t755 - 0.168e3 * t172 * t763 + 0.84e2 * t172 * t789;
  t793 = my_piecewise3(t2, 0, t792);
  tv2rho20 = 0.2e1 * t793;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t794 = t33 * t4;
  t795 = t794 * t456;
  t799 = 0.1e1 / t35 / M_PI;
  t800 = t38 * t799;
  t801 = t800 * params->b_PBE;
  t802 = t10 * t19;
  t803 = t801 * t802;
  t805 = t16 * t28 * t31;
  t806 = t163 * t175;
  t807 = t218 * t227;
  t808 = t806 * t807;
  t809 = t805 * t808;
  t813 = t31 * t358 * t175;
  t814 = t813 * t461;
  t817 = t427 * t21;
  t818 = t817 * t227;
  t819 = t459 * t818;
  t822 = t454 * t8;
  t823 = t29 * t31;
  t824 = t822 * t823;
  t825 = t806 * t218;
  t826 = t825 * t448;
  t829 = t794 * t465;
  t832 = t366 * t175;
  t833 = t454 * t832;
  t836 = t817 * t433;
  t837 = t836 * t468;
  t840 = t170 * t175;
  t841 = t840 * t218;
  t842 = t822 * t841;
  t843 = t760 * params->b_PBE;
  t844 = t163 * t28;
  t846 = t843 * t844 * t447;
  t849 = t435 * t28;
  t850 = t467 * t849;
  t853 = t800 * t170;
  t854 = t219 * t16;
  t855 = t853 * t854;
  t856 = t433 * params->b_PBE;
  t859 = t10 * t19 * t28;
  t860 = t856 * t163 * t859;
  t863 = -0.81e2 * t457 * t814 - 0.81e2 * t457 * t819 - 0.108e3 * t795 * t462 + 0.72576e5 * t466 * t837 + 0.72576e5 * t466 * t850 + 0.96768e5 * t829 * t469 + 0.72576e5 * t833 * t469 - 0.27e2 * t803 * t809 + 0.81e2 * t824 * t826 - 0.145152e6 * t842 * t846 + 0.24192e5 * t855 * t860;
  t864 = my_piecewise3(t2, 0, t863);
  tv2rhosigma0 = 0.2e1 * t864;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t865 = t5 * t8;
  t866 = params->b_PBE * params->b_PBE;
  t867 = t28 * t28;
  t869 = t866 * t867 * t31;
  t870 = t865 * t869;
  t871 = t163 * t163;
  t872 = t871 * t175;
  t873 = t872 * t467;
  t876 = t865 * t841;
  t877 = t866 * t871;
  t878 = t877 * t867;
  t879 = t760 * t878;
  t883 = my_piecewise3(t2, 0, 0.419904e6 * t870 * t873 - 0.376233984e9 * t876 * t879);
  tv2sigma20 = 0.2e1 * t883;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t887 = t23 * t262;
  t898 = t18 * t665;
  t902 = t372 * t262;
  t906 = t38 * t526;
  t913 = t261 * t261;
  t914 = 0.1e1 / t913;
  t915 = t22 * t914;
  t916 = t528 * t277;
  t920 = t277 * t545;
  t924 = t627 * t625;
  t925 = t924 * t623;
  t926 = t3 * t21;
  t939 = t3 * t665 * t9;
  t940 = t71 * t939;
  t942 = t78 * t245;
  t944 = 0.32e2 * t532 * t34 * t233 * t264 - 0.24e2 * t925 * t926 * t38 * t264 + 0.64e2 * t78 * t264 * t245 + 0.16e2 * t940 - 0.24e2 * t942;
  t948 = -0.112e3 / 0.27e2 * t78 * t245 * t86 - 0.14e2 * t78 * t887 * t277 + 0.28e2 * t78 * t4 * t526 * t528 - 0.14e2 * t78 * t513 * t545 - 0.16e2 / 0.9e1 * t51 * t898 * t86 - 0.4e1 * t260 * t902 * t277 - 0.24e2 * t260 * t906 * t528 + 0.12e2 * t260 * t521 * t545 + 0.36e2 * t260 * t915 * t916 - 0.36e2 * t260 * t527 * t920 + 0.6e1 * t260 * t263 * t944;
  t968 = t23 * t16;
  t972 = t116 * t93;
  t973 = t233 * t122;
  t979 = t91 * t63;
  t981 = 0.1e1 / t81 / p->cam_omega * t64 * t979;
  t982 = t627 * t17;
  t984 = t136 * t137;
  t987 = t38 * t122;
  t988 = t264 * t3;
  t999 = t35 * t979;
  t1001 = t627 * t18;
  t1002 = t111 * t999 * t1001;
  t1016 = -0.4e2 / 0.3e1 * t321 * t322 * t372 * t137 + 0.48e2 * t607 * t968 * t137 + 0.4e2 / 0.3e1 * t972 * t973 * t613 + 0.8e1 * t981 * t982 * t984 + 0.16e2 * t925 * t987 * t988 - 0.64e2 / 0.3e1 * t328 * t329 * t245 - 0.78e2 * t626 * t627 * t38 * t122 - 0.18e2 * t1002 * t608 * t122 - 0.4e2 / 0.3e1 * t339 * t340 * t973 + 0.32e2 * t143 * t144 * t245 - 0.64e2 / 0.9e1 * t124 * t939 + 0.64e2 / 0.9e1 * t47 * t939;
  t1018 = t136 * t314 * t1016;
  t1021 = t575 * t256;
  t1026 = t305 * t517;
  t1033 = t134 * t898;
  t1040 = t312 * t312;
  t1041 = 0.1e1 / t1040;
  t1045 = t136 * t115 * t1041 * t592 * t352;
  t1048 = t52 * t33;
  t1049 = t134 * t1048;
  t1050 = t21 * t115;
  t1053 = t1050 * t590 * t352 * t639;
  t1061 = t116 * t130;
  t1073 = (-0.16e2 / 0.9e1 * t942 + 0.104e3 / 0.9e1 * t78 * t245 * t122 - 0.1e2 / 0.3e1 * t93 * t233 * t1061 + 0.14e2 / 0.3e1 * t925 * t926 * t987 - 0.88e2 / 0.27e2 * t124 * t665 * t21 * t45 + 0.88e2 / 0.27e2 * t940) * t12;
  t1074 = t1073 * t52;
  t1077 = -t584 * t354 / 0.27e2 + t309 * t641 / 0.9e1 + t135 * t1018 / 0.18e2 - t1021 * t160 / 0.9e1 + t576 * t354 / 0.6e1 + t1026 * t160 / 0.27e2 + 0.2e1 / 0.9e1 * t579 * t354 + t306 * t641 / 0.6e1 - 0.4e1 / 0.243e3 * t1033 * t160 - t306 * t594 / 0.3e1 - 0.2e1 / 0.9e1 * t309 * t594 + t135 * t1045 / 0.3e1 - t1049 * t1053 / 0.3e1 - t1074 * t160 / 0.18e2;
  t1078 = my_piecewise5(t44, t948, t90, (0.448e5 / 0.27e2 * t98 * t665 * t81 * t18 + 0.112e4 / 0.27e2 * t104 * t245 * t9 * t76) * t111 / 0.2016e6, t1077);
  t1079 = params->b_PBE * t1078;
  t1082 = t766 * t438;
  t1087 = t435 * t778;
  t1091 = 0.1e1 / t22 / t498;
  t1094 = t440 * t1091 * t28 * sigma[0];
  t1097 = t94 * t94;
  t1099 = 0.1e1 / t4 / t1097;
  t1102 = t780 * t1099 * t28 * sigma[0];
  t1105 = t491 * params->ax;
  t1106 = t1105 * t110;
  t1107 = 0.1e1 / t91;
  t1108 = t1106 * t1107;
  t1109 = t220 * t1108;
  t1110 = 0.1e1 / t92;
  t1111 = t1097 * rho[0];
  t1112 = 0.1e1 / t1111;
  t1114 = t1110 * t1112 * t222;
  t1118 = params->kappa * t38 * t12;
  t1120 = 0.864e3 * t1079 * t222 + 0.144e3 * t1082 * t443 - 0.24e3 * t769 * t774 + 0.48e2 * t1087 * t783 + 0.64e3 / 0.3e1 * t439 * t1094 - 0.8e2 * t779 * t1102 + 0.16e2 / 0.9e1 * t1109 * t1114 + 0.7168e5 / 0.27e2 * t1118;
  t1121 = t434 * t1120;
  t1122 = t219 * t1121;
  t1129 = t751 * t448;
  t1132 = t428 * t788;
  t1147 = t428 * t762;
  t1150 = 0.84e2 * t172 * t1122 + 0.252e3 * t172 * t1129 + 0.252e3 * t172 * t1132 - 0.504e3 * t172 * t1147 + 0.672e3 * t236 * t755 + 0.336e3 * t236 * t789 + 0.504e3 * t367 * t755 - 0.504e3 * t367 * t763 + 0.252e3 * t367 * t789 + 0.112e3 * t475 * t449 + 0.672e3 * t478 * t449 + 0.252e3 * t654 * t449;
  t1153 = t432 * t432;
  t1154 = 0.1e1 / t1153;
  t1155 = t21 * t1154;
  t1156 = t761 * t447;
  t1157 = t1155 * t1156;
  t1158 = t219 * t1157;
  t1162 = t21 * t1091 * t28;
  t1167 = t16 * t1099 * t28;
  t1177 = params->b_PBE * t1105 * t110 * t1107 * t1110;
  t1179 = t1112 * t3 * t28;
  t1186 = t248 * t645;
  t1195 = t8 * (0.5e1 / 0.21e2 * t243 * t1162 * t249 - 0.5e1 / 0.56e2 * t497 * t1167 * t249 - 0.15e2 / 0.56e2 * t243 * t487 * t506 + t1177 * t1179 * t249 / 0.504e3 + 0.3e1 / 0.56e2 * t497 * t502 * t506 + 0.9e1 / 0.56e2 * t243 * t247 * t1186 + 0.27e2 / 0.28e2 * t30 * t32 * t1078 + 0.8e2 / 0.27e2 * t1118);
  t1196 = t6 * t1195;
  t1199 = t474 * t366;
  t1204 = t235 * t653;
  t1211 = t3 * t245;
  t1212 = t1211 * t171;
  t1219 = t661 * t377;
  t1222 = t185 * t377;
  t1227 = t187 * t377;
  t1232 = t182 * t377;
  t1237 = t181 * t377;
  t1242 = t180 * t377;
  t1247 = t179 * t377;
  t1253 = 0.14e2 / 0.81e2 * t37 * p->cam_omega * t500 * t40;
  t1254 = my_piecewise3(t177, -t1253, 0);
  t1267 = t377 * t670;
  t1271 = -0.1938816e8 * t178 * t1219 - 0.35129622528e12 * t370 * t1219 + 0.36661248e10 * t380 * t1219 + 0.526101226979328e17 * t381 * t1219 - 0.11923997589504e16 * t384 * t1219 + 0.232285667328e14 * t387 * t1219 + 0.131525306744832e17 * t1222 * t670 - 0.35771992768512e15 * t1227 * t670 + 0.87107125248e13 * t1232 * t670 - 0.17564811264e12 * t1237 * t670 + 0.27495936e10 * t1242 * t670 - 0.2908224e8 * t1247 * t670 + 0.38896e5 * t178 * t1254 + 0.18330624e9 * t370 * t1254 + 0.3372443762688e15 * t371 * t1254 - 0.323136e7 * t380 * t1254 - 0.1083999780864e14 * t381 * t1254 + 0.3226189824e12 * t384 * t1254 - 0.836419584e10 * t387 * t1254 + 0.116688e6 * t1267;
  t1274 = t696 * t400;
  t1277 = t396 * t703;
  t1283 = 0.1e1 / t194 / t380;
  t1284 = t193 * t1283;
  t1292 = t719 * t414;
  t1297 = t411 * t734;
  t1301 = 0.1e1 / t200 / t405;
  t1302 = t203 * t1301;
  t1303 = t710 * t406;
  t1304 = t1303 * t206;
  t1307 = my_piecewise3(t177, 0, -t1253);
  t1308 = t1307 * t206;
  t1311 = t200 * t200;
  t1313 = 0.1e1 / t1311 / t198;
  t1314 = t203 * t1313;
  t1318 = 0.1e1 / t200 / t198;
  t1322 = t725 * t406;
  t1325 = t411 * t725;
  t1328 = t203 * t1318;
  t1332 = t416 * t713;
  t1337 = t198 * t1303;
  t1339 = t199 * t406;
  t1340 = t1339 * t713;
  t1351 = t405 * t1307;
  t1353 = t406 * t713;
  t1355 = t198 * t1307;
  t1357 = 0.768e3 * t1337 + 0.1152e4 * t1340 + 0.128e3 * t1351 - 0.96e2 * t1353 - 0.32e2 * t1355;
  t1363 = -0.3e1 / 0.2e1 * t726 * t1332 + t735 * t1332 / 0.4e1 - 0.256e3 * t1337 - 0.384e3 * t1340 + 0.2e1 / 0.3e1 * t1301 * t1303 * t206 + 0.8e1 / 0.3e1 * t420 * t1307 - 0.8e1 / 0.3e1 * t213 * t1307 + t1357 * t206 / 0.3e1 - 0.128e3 / 0.3e1 * t1351 + 0.48e2 * t1353 + 0.16e2 * t1355;
  t1365 = my_piecewise3(t176, t1271 * t195 / 0.8671998246912e15 - t1274 * t377 / 0.180666630144e14 + t1277 * t661 / 0.10627448832e13 - t699 * t670 / 0.180666630144e14 - t1284 * t1219 / 0.1771241472e12 + t704 * t1267 / 0.10627448832e13 - t401 * t1254 / 0.541999890432e14, t1292 * t416 / 0.2e1 + t722 * t730 / 0.2e1 + t1297 * t727 / 0.4e1 - 0.3e1 / 0.4e1 * t1302 * t1304 + t415 * t1308 / 0.6e1 + t1314 * t1304 / 0.24e2 - 0.16e2 / 0.3e1 * t1318 * t1303 * t206 + 0.4e1 * t1322 * t730 - 0.3e1 / 0.2e1 * t1325 * t727 + 0.2e1 * t1328 * t1304 + t1363);
  t1366 = t175 * t1365;
  t1367 = t1366 * t228;
  t1370 = t6 * t465;
  t1371 = t759 * t447;
  t1372 = t1371 * t787;
  t1373 = t460 * t1372;
  t1376 = -0.672e3 * t236 * t763 + 0.504e3 * t172 * t1158 - 0.84e2 * t1196 * t229 - 0.112e3 * t1199 * t229 - 0.112e3 * t475 * t429 - 0.336e3 * t1204 * t229 - 0.672e3 * t478 * t429 - 0.336e3 * t236 * t752 + 0.224e3 / 0.9e1 * t1212 * t229 - 0.252e3 * t654 * t429 - 0.252e3 * t367 * t752 - 0.84e2 * t172 * t1367 - 0.504e3 * t1370 * t1373;
  t1378 = my_piecewise3(t2, 0, t1150 + t1376);
  tv3rho30 = 0.2e1 * t1378;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1379 = 0.1e1 / t94;
  t1380 = 0.1e1 / t315;
  t1381 = t1379 * t1380;
  t1382 = t1381 * t170;
  t1383 = t219 * t433;
  t1384 = t1382 * t1383;
  t1387 = t3 * t28;
  t1388 = t81 * t495 * t1387;
  t1389 = t220 * t491 * t1388;
  t1393 = t856 * t358 * t859;
  t1396 = t372 * t799;
  t1397 = t1396 * t170;
  t1398 = t1397 * t854;
  t1401 = t800 * t365;
  t1402 = t1401 * t854;
  t1405 = t428 * t16;
  t1406 = t853 * t1405;
  t1409 = t1396 * params->b_PBE;
  t1410 = t1409 * t802;
  t1413 = t358 * t175;
  t1414 = t1413 * t807;
  t1415 = t805 * t1414;
  t1418 = t427 * t227;
  t1419 = t806 * t1418;
  t1420 = t805 * t1419;
  t1423 = t1381 * params->b_PBE;
  t1424 = t777 * t495;
  t1425 = t1423 * t1424;
  t1426 = t1387 * t31;
  t1427 = t1426 * t808;
  t1430 = t365 * t175;
  t1431 = t1430 * t218;
  t1432 = t822 * t1431;
  t1435 = t806 * t427;
  t1436 = t1435 * t448;
  t1439 = t825 * t788;
  t1442 = t794 * t8;
  t1443 = t1442 * t823;
  t1446 = t1413 * t218;
  t1447 = t1446 * t448;
  t1450 = t840 * t427;
  t1451 = t822 * t1450;
  t1454 = t358 * t28;
  t1456 = t843 * t1454 * t447;
  t1460 = t843 * t844 * t787;
  t1463 = t1442 * t841;
  t1466 = t1155 * params->b_PBE;
  t1468 = t1466 * t844 * t761;
  t1471 = 0.2688e4 * t1384 * t1389 + 0.48384e5 * t855 * t1393 + 0.24192e5 * t1398 * t860 + 0.48384e5 * t1402 * t860 + 0.48384e5 * t1406 * t860 - 0.27e2 * t1410 * t809 - 0.54e2 * t803 * t1415 - 0.54e2 * t803 * t1420 - 0.3e1 * t1425 * t1427 - 0.290304e6 * t1432 * t846 + 0.162e3 * t824 * t1436 + 0.81e2 * t824 * t1439 + 0.216e3 * t1443 * t826 + 0.162e3 * t824 * t1447 - 0.290304e6 * t1451 * t846 - 0.290304e6 * t842 * t1456 - 0.145152e6 * t842 * t1460 - 0.387072e6 * t1463 * t846 + 0.435456e6 * t842 * t1468;
  t1472 = t825 * t762;
  t1475 = t766 * t28;
  t1476 = t467 * t1475;
  t1481 = t653 * t175;
  t1482 = t454 * t1481;
  t1489 = t750 * t21;
  t1490 = t1489 * t433;
  t1491 = t1490 * t468;
  t1494 = t836 * t849;
  t1497 = t1489 * t227;
  t1498 = t459 * t1497;
  t1501 = t794 * t832;
  t1511 = t31 * t645 * t175;
  t1512 = t1511 * t461;
  t1515 = t813 * t818;
  t1518 = t33 * t23;
  t1519 = t1518 * t465;
  t1522 = t1518 * t456;
  t1526 = t10 * t19 * t16;
  t1527 = t801 * t1526;
  t1528 = t28 * t31;
  t1529 = t1528 * t163;
  t1530 = t433 * t447;
  t1531 = t219 * t1530;
  t1532 = t1529 * t1531;
  t1535 = t16 * t759;
  t1536 = t219 * t1535;
  t1537 = t853 * t1536;
  t1538 = t220 * params->ax;
  t1539 = t9 * t19;
  t1540 = t28 * t447;
  t1541 = t1539 * t1540;
  t1542 = t1538 * t1541;
  t1545 = -0.162e3 * t824 * t1472 + 0.72576e5 * t466 * t1476 + 0.72576e5 * t1482 * t469 + 0.72576e5 * t466 * t1491 + 0.145152e6 * t466 * t1494 - 0.81e2 * t457 * t1498 + 0.193536e6 * t1501 * t469 - 0.81e2 * t457 * t1512 - 0.162e3 * t457 * t1515 + 0.32256e5 * t1519 * t469 - 0.36e2 * t1522 * t462 + 0.54e2 * t1527 * t1532 - 0.96768e5 * t1537 * t1542 - 0.216e3 * t795 * t814 - 0.216e3 * t795 * t819 + 0.193536e6 * t829 * t837 + 0.193536e6 * t829 * t850 + 0.145152e6 * t833 * t837 + 0.145152e6 * t833 * t850;
  t1547 = my_piecewise3(t2, 0, t1471 + t1545);
  tv3rho2sigma0 = 0.2e1 * t1547;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1548 = t4 * t8;
  t1549 = t1548 * t869;
  t1552 = t800 * t866;
  t1553 = t867 * t31;
  t1554 = t1553 * t872;
  t1555 = t1552 * t1554;
  t1556 = t218 * t16;
  t1559 = t10 * t3 * t19;
  t1560 = t1556 * t433 * t1559;
  t1563 = t434 * t358;
  t1564 = t825 * t1563;
  t1567 = t872 * t836;
  t1570 = t872 * t218;
  t1571 = t760 * t447;
  t1572 = t1570 * t1571;
  t1575 = t1548 * t841;
  t1578 = t865 * t1431;
  t1581 = t865 * t1450;
  t1584 = t1155 * t866;
  t1585 = t871 * t867;
  t1587 = t1584 * t1585 * t447;
  t1590 = t760 * t866;
  t1591 = t163 * t867;
  t1593 = t1590 * t1591 * t358;
  t1596 = t878 * t1559;
  t1599 = -0.83607552e8 * t1537 * t1596 + 0.559872e6 * t1549 * t873 + 0.93312e5 * t1555 * t1560 + 0.839808e6 * t870 * t1564 + 0.419904e6 * t870 * t1567 - 0.839808e6 * t870 * t1572 - 0.501645312e9 * t1575 * t879 - 0.376233984e9 * t1578 * t879 - 0.376233984e9 * t1581 * t879 + 0.1128701952e10 * t876 * t1587 - 0.752467968e9 * t876 * t1593;
  t1600 = my_piecewise3(t2, 0, t1599);
  tv3rhosigma20 = 0.2e1 * t1600;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1601 = t866 * params->b_PBE;
  t1602 = t867 * t28;
  t1604 = t1601 * t1602 * t31;
  t1605 = t865 * t1604;
  t1606 = t871 * t163;
  t1607 = t1606 * t175;
  t1609 = t760 * t3;
  t1610 = t1607 * t218 * t1609;
  t1616 = t1155 * t1601 * t1606 * t1602 * t3;
  t1620 = my_piecewise3(t2, 0, -0.1088391168e10 * t1605 * t1610 + 0.975198486528e12 * t876 * t1616);
  tv3sigma30 = 0.2e1 * t1620;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t6, t7, t8, t9;
  double t10, t12, t13, t14, t15, t16, t17, t18;
  double t19, t20, t21, t22, t23, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t43, t44, t45, t47, t51, t52, t53, t55;
  double t61, t63, t64, t65, t66, t67, t71, t73;
  double t74, t76, t77, t78, t79, t81, t82, t84;
  double t85, t86, t90, t91, t92, t93, t94, t98;
  double t104, t110, t111, t115, t116, t121, t122, t124;
  double t130, t134, t135, t136, t137, t143, t144, t152;
  double t157, t160, t163, t167, t169, t170, t171, t172;
  double t175, t176, t177, t178, t179, t180, t181, t182;
  double t185, t187, t193, t194, t195, t198, t199, t200;
  double t203, t206, t210, t212, t213, t218, t219, t220;
  double t222, t226, t227, t228, t229, t232, t233, tzk0;

  double t235, t236, t243, t244, t245, t247, t248, t249;
  double t256, t260, t261, t262, t263, t264, t271, t272;
  double t273, t275, t277, t305, t306, t309, t312, t314;
  double t315, t316, t317, t318, t319, t321, t322, t328;
  double t329, t339, t340, t352, t354, t358, t363, t365;
  double t366, t367, t370, t371, t372, t376, t377, t380;
  double t381, t384, t387, t396, t400, t401, t405, t406;
  double t407, t409, t411, t414, t415, t416, t420, t427;
  double t428, t429, t432, t433, t434, t435, t438, t439;
  double t440, t443, t447, t448, t449, t453, tvrho0, t454;
  double t456, t457, t459, t460, t461, t462, t465, t466;
  double t467, t468, t469, t473, tvsigma0;

  double t474, t475, t478, t485, t487, t491, t493, t495;
  double t497, t498, t500, t502, t506, t513, t517, t521;
  double t526, t527, t528, t532, t536, t540, t541, t543;
  double t545, t575, t576, t579, t584, t590, t591, t592;
  double t594, t601, t603, t607, t608, t613, t623, t624;
  double t625, t626, t627, t639, t641, t645, t650, t652;
  double t653, t654, t661, t665, t669, t670, t696, t699;
  double t703, t704, t710, t711, t713, t714, t717, t719;
  double t722, t725, t726, t727, t730, t734, t735, t749;
  double t750, t751, t752, t755, t759, t760, t761, t762;
  double t763, t766, t769, t774, t777, t778, t779, t780;
  double t783, t787, t788, t789, t792, t793, tv2rho20, t794;
  double t795, t799, t800, t801, t802, t803, t805, t806;
  double t807, t808, t809, t813, t814, t817, t818, t819;
  double t822, t823, t824, t825, t826, t829, t832, t833;
  double t836, t837, t840, t841, t842, t843, t844, t846;
  double t849, t850, t853, t854, t855, t856, t859, t860;
  double t863, t864, tv2rhosigma0, t865, t866, t867, t869, t870;
  double t871, t872, t873, t876, t877, t878, t879, t883;
  double tv2sigma20;

  double t887, t898, t902, t906, t913, t914, t915, t916;
  double t920, t924, t925, t926, t939, t940, t942, t944;
  double t948, t968, t972, t973, t979, t981, t982, t984;
  double t987, t988, t999, t1001, t1002, t1016, t1018, t1021;
  double t1026, t1033, t1040, t1041, t1045, t1048, t1049, t1050;
  double t1053, t1061, t1073, t1074, t1077, t1078, t1079, t1082;
  double t1087, t1091, t1094, t1097, t1099, t1102, t1105, t1106;
  double t1107, t1108, t1109, t1110, t1111, t1112, t1114, t1118;
  double t1120, t1121, t1122, t1129, t1132, t1147, t1150, t1153;
  double t1154, t1155, t1156, t1157, t1158, t1162, t1167, t1177;
  double t1179, t1186, t1195, t1196, t1199, t1204, t1211, t1212;
  double t1219, t1222, t1227, t1232, t1237, t1242, t1247, t1253;
  double t1254, t1267, t1271, t1274, t1277, t1283, t1284, t1292;
  double t1297, t1301, t1302, t1303, t1304, t1307, t1308, t1311;
  double t1313, t1314, t1318, t1322, t1325, t1328, t1332, t1337;
  double t1339, t1340, t1351, t1353, t1355, t1357, t1363, t1365;
  double t1366, t1367, t1370, t1371, t1372, t1373, t1376, t1378;
  double tv3rho30, t1379, t1380, t1381, t1382, t1383, t1384, t1387;
  double t1388, t1389, t1393, t1396, t1397, t1398, t1401, t1402;
  double t1405, t1406, t1409, t1410, t1413, t1414, t1415, t1418;
  double t1419, t1420, t1423, t1424, t1425, t1426, t1427, t1430;
  double t1431, t1432, t1435, t1436, t1439, t1442, t1443, t1446;
  double t1447, t1450, t1451, t1454, t1456, t1460, t1463, t1466;
  double t1468, t1471, t1472, t1475, t1476, t1481, t1482, t1489;
  double t1490, t1491, t1494, t1497, t1498, t1501, t1511, t1512;
  double t1515, t1518, t1519, t1522, t1526, t1527, t1528, t1529;
  double t1530, t1531, t1532, t1535, t1536, t1537, t1538, t1539;
  double t1540, t1541, t1542, t1545, t1547, tv3rho2sigma0, t1548, t1549;
  double t1552, t1553, t1554, t1555, t1556, t1559, t1560, t1563;
  double t1564, t1567, t1570, t1571, t1572, t1575, t1578, t1581;
  double t1584, t1585, t1587, t1590, t1591, t1593, t1596, t1599;
  double t1600, tv3rhosigma20, t1601, t1602, t1604, t1605, t1606, t1607;
  double t1609, t1610, t1616, t1620, tv3sigma30;

  double t1650, t1651, t1663, t1664, t1666, t1684, t1701, t1709;
  double t1741, t1761, t1796, t1798, t1815, t1825, t1830, t1853;
  double t1915, t1917, t1937, t1944, t1950, t1951, t1956, t1958;
  double t1961, t1963, t1966, t1972, t1974, t1979, t2008, t2019;
  double t2020, t2021, t2026, t2061, t2063, t2068, t2069, t2074;
  double t2083, t2109, t2142, t2146, t2149, t2158, t2159, t2161;
  double t2162, t2164, t2166, t2168, t2171, t2174, t2191, t2193;
  double t2201, t2206, t2214, t2258, t2260, t2323, t2328, t2367;
  double t2370, tv4rho40, t2381, t2390, t2413, t2422, t2433, t2467;
  double t2478, t2506, t2512, t2530, t2542, t2548, t2589, t2600;
  double t2621, t2628, t2667, t2668, t2683, t2693, t2701, t2703;
  double t2719, t2738, t2741, t2745, tv4rho3sigma0, t2749, t2759, t2787;
  double t2788, t2841, t2867, t2873, t2904, t2906, tv4rho2sigma20, t2911;
  double t2916, t2920, t2947, t2963, t2964, tv4rhosigma30, t2965, t2966;
  double t2970, t2984, tv4sigma40;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = POW_1_3(rho[0]);
  t5 = t4 * rho[0];
  t6 = t3 * t5;
  t7 = M_CBRTPI;
  t8 = 0.1e1 / t7;
  t9 = p->cam_omega * p->cam_omega;
  t10 = params->ax * t9;
  t12 = t7 * M_PI;
  t13 = 0.1e1 / t12;
  t14 = 0.2e1 <= p->zeta_threshold;
  t15 = POW_1_3(p->zeta_threshold);
  t16 = M_CBRT2;
  t17 = my_piecewise3(t14, t15, t16);
  t18 = t17 * t17;
  t19 = 0.1e1 / t18;
  t20 = t13 * t19;
  t21 = t16 * t16;
  t22 = t4 * t4;
  t23 = 0.1e1 / t22;
  t28 = exp(-t10 * t3 * t20 * t21 * t23 / 0.12e2);
  t29 = params->b_PBE * t28;
  t30 = t29 * sigma[0];
  t31 = params->kappa + 0.1e1;
  t32 = t3 * t31;
  t33 = t3 * t3;
  t34 = t16 * t33;
  t35 = t7 * t7;
  t37 = t34 / t35;
  t38 = 0.1e1 / t4;
  t40 = 0.1e1 / t17;
  t43 = t37 * p->cam_omega * t38 * t40 / 0.6e1;
  t44 = t43 < 0.5e-1;
  t45 = t9 * t3;
  t47 = t12 * t18;
  t51 = (t45 * t21 - 0.7e1 / 0.6e1 * t47 * t22) * t12;
  t52 = t18 * t22;
  t53 = t18 * t17;
  t55 = 0.1e1 / p->cam_omega * t3;
  t61 = erf(t55 * t35 * t17 * t21 * t4 / 0.2e1);
  t63 = M_PI * M_PI;
  t64 = sqrt(M_PI);
  t65 = t64 * t63;
  t66 = t53 * t61 * t65;
  t67 = rho[0] * p->cam_omega;
  t71 = t47 * t21;
  t73 = t3 * t22 * t9;
  t74 = t71 * t73;
  t76 = t18 * t18;
  t77 = t35 * t63;
  t78 = t76 * t77;
  t79 = t78 * t5;
  t81 = t9 * t9;
  t82 = t81 * t33;
  t84 = 0.12e2 * t82 * t16;
  t85 = -0.36e2 * t66 * t34 * t67 + 0.54e2 * t74 + 0.81e2 * t79 - t84;
  t86 = 0.1e1 / t85;
  t90 = 0.1e11 < t43;
  t91 = t63 * t63;
  t92 = t76 * t18;
  t93 = t91 * t92;
  t94 = rho[0] * rho[0];
  t98 = t12 * t16 * t33;
  t104 = t77 * t21 * t3;
  t110 = t81 * t9;
  t111 = 0.1e1 / t110;
  t115 = 0.1e1 / t9;
  t116 = t115 * t33;
  t121 = t116 * t12 * t18 * t16 * t22 / 0.2e1;
  t122 = exp(t121);
  t124 = t122 * t12 * t18;
  t130 = t122 * t16;
  t134 = (0.7e1 * t124 * t22 * t21 * t45 - 0.12e2 * t130 * t82 + 0.11e2 * t74 + 0.6e1 * t79 + t84) * t12;
  t135 = t134 * t52;
  t136 = t21 * t33;
  t137 = t122 * t61;
  t143 = t122 * t76;
  t144 = t77 * t16;
  t152 = t122 * t21;
  t157 = 0.12e2 * t137 * t53 * t65 * t136 * t67 - 0.27e2 * t143 * t144 * t5 - 0.36e2 * t124 * t73 - 0.4e1 * t136 * t81 + 0.4e1 * t152 * t82 + 0.24e2 * t47 * t73;
  t160 = t136 * t115 / t157;
  t163 = my_piecewise5(t44, -0.6e1 * t51 * t52 * t86, t90, (-0.14e3 * t104 * t5 * t9 * t76 + 0.56e4 * t98 * t22 * t81 * t18 - 0.1863e4 * t93 * t94) * t111 / 0.2016e6, -t135 * t160 / 0.18e2);
  t167 = t22 * t94;
  t169 = params->kappa * t167 * t12;
  t170 = 0.27e2 / 0.28e2 * t30 * t32 * t163 + t169;
  t171 = t8 * t170;
  t172 = t6 * t171;
  t175 = my_piecewise3(t14, t15 * p->zeta_threshold, 0.2e1 * t16);
  t176 = 0.135e1 <= t43;
  t177 = 0.135e1 < t43;
  t178 = my_piecewise3(t177, t43, 0.135e1);
  t179 = t178 * t178;
  t180 = t179 * t179;
  t181 = t180 * t179;
  t182 = t180 * t180;
  t185 = t182 * t180;
  t187 = t182 * t179;
  t193 = 0.240888840192e14 * t182 * t181 + 0.19448e5 * t179 - 0.80784e6 * t180 + 0.3055104e8 * t181 - 0.104552448e10 * t182 - 0.90333315072e12 * t185 + 0.3226189824e11 * t187 - 0.429e3;
  t194 = t182 * t182;
  t195 = 0.1e1 / t194;
  t198 = my_piecewise3(t177, 0.135e1, t43);
  t199 = t198 * t198;
  t200 = t199 * t199;
  t203 = 0.32e2 * t200 - 0.16e2 * t199;
  t206 = exp(-0.1e1 / t199 / 0.4e1);
  t210 = 0.1e1 / t198;
  t212 = erf(t210 / 0.2e1);
  t213 = t64 * t212;
  t218 = my_piecewise3(t176, t193 * t195 / 0.8671998246912e15, t203 * t206 / 0.3e1 - 0.32e2 / 0.3e1 * t200 - 0.8e1 / 0.3e1 * t213 * t198 + 0.8e1 * t199 + 0.1e1);
  t219 = t175 * t218;
  t220 = params->b_PBE * t163;
  t222 = t28 * sigma[0] * t3;
  t226 = 0.864e3 * t220 * t222 + 0.896e3 * t169;
  t227 = 0.1e1 / t226;
  t228 = t21 * t227;
  t229 = t219 * t228;
  t232 = my_piecewise3(t2, 0, -0.84e2 * t172 * t229);
  t233 = 0.1e1 / rho[0];
  tzk0 = 0.2e1 * t232 * t233;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t235 = t3 * t4;
  t236 = t235 * t171;
  t243 = params->b_PBE * params->ax * t9 * t33 * t13 * t19;
  t244 = t22 * rho[0];
  t245 = 0.1e1 / t244;
  t247 = t21 * t245 * t28;
  t248 = sigma[0] * t31;
  t249 = t248 * t163;
  t256 = t18 * t38;
  t260 = t51 * t18;
  t261 = t85 * t85;
  t262 = 0.1e1 / t261;
  t263 = t22 * t262;
  t264 = exp(-t121);
  t271 = t3 * t38;
  t272 = t271 * t9;
  t273 = t71 * t272;
  t275 = t78 * t4;
  t277 = -0.72e2 * t78 * t264 * t4 - 0.36e2 * t66 * t34 * p->cam_omega + 0.36e2 * t273 + 0.108e3 * t275;
  t305 = (0.8e1 * t275 + 0.14e2 * t78 * t4 * t122 - 0.22e2 / 0.3e1 * t124 * t38 * t21 * t45 + 0.22e2 / 0.3e1 * t273) * t12;
  t306 = t305 * t52;
  t309 = t134 * t256;
  t312 = t157 * t157;
  t314 = t115 / t312;
  t315 = t63 * M_PI;
  t316 = pow(M_PI, 0.1e1 / 0.6e1);
  t317 = t316 * t316;
  t318 = t317 * t317;
  t319 = t318 * t316;
  t321 = t55 * t319 * t315;
  t322 = t76 * t17;
  t328 = t122 * t77 * t264;
  t329 = t76 * t16;
  t339 = t116 * t91;
  t340 = t92 * t21;
  t352 = 0.12e2 * t137 * t53 * t65 * t21 * t33 * p->cam_omega - 0.9e1 * t339 * t340 * rho[0] * t122 + 0.24e2 * t321 * t322 * t22 * t137 - 0.72e2 * t143 * t144 * t4 + 0.24e2 * t328 * t329 * t4 - 0.16e2 * t124 * t272 + 0.16e2 * t47 * t272;
  t354 = t136 * t314 * t352;
  t358 = my_piecewise5(t44, 0.14e2 / 0.3e1 * t78 * t4 * t86 - 0.4e1 * t51 * t256 * t86 + 0.6e1 * t260 * t263 * t277, t90, (-0.3726e4 * t93 * rho[0] + 0.112e5 / 0.3e1 * t98 * t38 * t81 * t18 - 0.56e3 / 0.3e1 * t104 * t4 * t9 * t76) * t111 / 0.2016e6, -t306 * t160 / 0.18e2 - t309 * t160 / 0.27e2 + t135 * t354 / 0.18e2);
  t363 = params->kappa * t244 * t12;
  t365 = 0.3e1 / 0.56e2 * t243 * t247 * t249 + 0.27e2 / 0.28e2 * t30 * t32 * t358 + 0.8e1 / 0.3e1 * t363;
  t366 = t8 * t365;
  t367 = t6 * t366;
  t370 = t180 * t178;
  t371 = t182 * t370;
  t372 = 0.1e1 / t5;
  t376 = t37 * p->cam_omega * t372 * t40 / 0.18e2;
  t377 = my_piecewise3(t177, -t376, 0);
  t380 = t179 * t178;
  t381 = t182 * t380;
  t384 = t182 * t178;
  t387 = t180 * t380;
  t396 = 0.38896e5 * t178 * t377 + 0.18330624e9 * t370 * t377 + 0.3372443762688e15 * t371 * t377 - 0.323136e7 * t380 * t377 - 0.1083999780864e14 * t381 * t377 + 0.3226189824e12 * t384 * t377 - 0.836419584e10 * t387 * t377;
  t400 = 0.1e1 / t194 / t178;
  t401 = t193 * t400;
  t405 = t199 * t198;
  t406 = my_piecewise3(t177, 0, -t376);
  t407 = t405 * t406;
  t409 = t198 * t406;
  t411 = 0.128e3 * t407 - 0.32e2 * t409;
  t414 = 0.1e1 / t405;
  t415 = t203 * t414;
  t416 = t406 * t206;
  t420 = t206 * t210;
  t427 = my_piecewise3(t176, t396 * t195 / 0.8671998246912e15 - t401 * t377 / 0.541999890432e14, t411 * t206 / 0.3e1 + t415 * t416 / 0.6e1 - 0.128e3 / 0.3e1 * t407 + 0.8e1 / 0.3e1 * t420 * t406 - 0.8e1 / 0.3e1 * t213 * t406 + 0.16e2 * t409);
  t428 = t175 * t427;
  t429 = t428 * t228;
  t432 = t226 * t226;
  t433 = 0.1e1 / t432;
  t434 = t21 * t433;
  t435 = params->b_PBE * t358;
  t438 = t10 * t33;
  t439 = t220 * t438;
  t440 = t20 * t21;
  t443 = t440 * t245 * t28 * sigma[0];
  t447 = 0.864e3 * t435 * t222 + 0.48e2 * t439 * t443 + 0.7168e4 / 0.3e1 * t363;
  t448 = t434 * t447;
  t449 = t219 * t448;
  t453 = my_piecewise3(t2, 0, -0.84e2 * t172 * t429 + 0.84e2 * t172 * t449 - 0.112e3 * t236 * t229 - 0.84e2 * t367 * t229);
  tvrho0 = 0.2e1 * t453;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t454 = t33 * t5;
  t456 = t8 * params->b_PBE * t28;
  t457 = t454 * t456;
  t459 = t31 * t163 * t175;
  t460 = t218 * t21;
  t461 = t460 * t227;
  t462 = t459 * t461;
  t465 = t171 * t175;
  t466 = t454 * t465;
  t467 = t460 * t433;
  t468 = t220 * t28;
  t469 = t467 * t468;
  t473 = my_piecewise3(t2, 0, -0.81e2 * t457 * t462 + 0.72576e5 * t466 * t469);
  tvsigma0 = 0.2e1 * t473;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t474 = t3 * t23;
  t475 = t474 * t171;
  t478 = t235 * t366;
  t485 = 0.1e1 / t167;
  t487 = t21 * t485 * t28;
  t491 = params->ax * params->ax;
  t493 = 0.1e1 / t77;
  t495 = 0.1e1 / t76;
  t497 = params->b_PBE * t491 * t81 * t493 * t495;
  t498 = t94 * rho[0];
  t500 = 0.1e1 / t4 / t498;
  t502 = t16 * t500 * t28;
  t506 = t248 * t358;
  t513 = t4 * t262;
  t517 = t18 * t372;
  t521 = t38 * t262;
  t526 = 0.1e1 / t261 / t85;
  t527 = t22 * t526;
  t528 = t277 * t277;
  t532 = t93 * t115;
  t536 = t264 * t23;
  t540 = t3 * t372 * t9;
  t541 = t71 * t540;
  t543 = t78 * t23;
  t545 = 0.24e2 * t532 * t34 * t264 - 0.96e2 * t78 * t536 - 0.12e2 * t541 + 0.36e2 * t543;
  t575 = (0.8e1 / 0.3e1 * t543 - 0.1e2 * t78 * t23 * t122 + 0.14e2 / 0.3e1 * t532 * t34 * t122 + 0.22e2 / 0.9e1 * t124 * t372 * t21 * t45 - 0.22e2 / 0.9e1 * t541) * t12;
  t576 = t575 * t52;
  t579 = t305 * t256;
  t584 = t134 * t517;
  t590 = 0.1e1 / t312 / t157;
  t591 = t115 * t590;
  t592 = t352 * t352;
  t594 = t136 * t591 * t592;
  t601 = t9 * p->cam_omega;
  t603 = t91 * M_PI;
  t607 = 0.1e1 / t601 * t316 * t603 * t76 * t53;
  t608 = t4 * t16;
  t613 = t264 * t21;
  t623 = 0.1e1 / t81;
  t624 = t623 * t3;
  t625 = t7 * t603;
  t626 = t624 * t625;
  t627 = t76 * t76;
  t639 = 0.4e2 * t321 * t322 * t38 * t137 + 0.24e2 * t607 * t608 * t137 + 0.8e1 * t339 * t92 * t122 * t613 + 0.32e2 * t328 * t329 * t23 - 0.33e2 * t339 * t340 * t122 - 0.18e2 * t626 * t627 * t22 * t122 - 0.4e2 * t143 * t144 * t23 + 0.16e2 / 0.3e1 * t124 * t540 - 0.16e2 / 0.3e1 * t47 * t540;
  t641 = t136 * t314 * t639;
  t645 = my_piecewise5(t44, 0.14e2 / 0.3e1 * t78 * t23 * t86 - 0.28e2 / 0.3e1 * t78 * t513 * t277 + 0.4e1 / 0.3e1 * t51 * t517 * t86 + 0.8e1 * t260 * t521 * t277 - 0.12e2 * t260 * t527 * t528 + 0.6e1 * t260 * t263 * t545, t90, (-0.3726e4 * t93 - 0.112e5 / 0.9e1 * t98 * t372 * t81 * t18 - 0.56e3 / 0.9e1 * t104 * t23 * t9 * t76) * t111 / 0.2016e6, -t576 * t160 / 0.18e2 - 0.2e1 / 0.27e2 * t579 * t160 + t306 * t354 / 0.9e1 + t584 * t160 / 0.81e2 + 0.2e1 / 0.27e2 * t309 * t354 - t135 * t594 / 0.9e1 + t135 * t641 / 0.18e2);
  t650 = params->kappa * t22 * t12;
  t652 = -0.5e1 / 0.56e2 * t243 * t487 * t249 + t497 * t502 * t249 / 0.56e2 + 0.3e1 / 0.28e2 * t243 * t247 * t506 + 0.27e2 / 0.28e2 * t30 * t32 * t645 + 0.4e2 / 0.9e1 * t650;
  t653 = t8 * t652;
  t654 = t6 * t653;
  t661 = t377 * t377;
  t665 = 0.1e1 / t4 / t94;
  t669 = 0.2e1 / 0.27e2 * t37 * p->cam_omega * t665 * t40;
  t670 = my_piecewise3(t177, t669, 0);
  t696 = 0.38896e5 * t178 * t670 - 0.969408e7 * t179 * t661 + 0.9165312e9 * t180 * t661 - 0.5854937088e11 * t181 * t661 + 0.29035708416e13 * t182 * t661 + 0.43841768914944e16 * t185 * t661 - 0.11923997589504e15 * t187 * t661 + 0.18330624e9 * t370 * t670 + 0.3372443762688e15 * t371 * t670 - 0.323136e7 * t380 * t670 - 0.1083999780864e14 * t381 * t670 + 0.3226189824e12 * t384 * t670 - 0.836419584e10 * t387 * t670 + 0.38896e5 * t661;
  t699 = t396 * t400;
  t703 = 0.1e1 / t194 / t179;
  t704 = t193 * t703;
  t710 = t406 * t406;
  t711 = t199 * t710;
  t713 = my_piecewise3(t177, 0, t669);
  t714 = t405 * t713;
  t717 = t198 * t713;
  t719 = 0.384e3 * t711 + 0.128e3 * t714 - 0.32e2 * t710 - 0.32e2 * t717;
  t722 = t411 * t414;
  t725 = 0.1e1 / t200;
  t726 = t203 * t725;
  t727 = t710 * t206;
  t730 = t713 * t206;
  t734 = 0.1e1 / t200 / t199;
  t735 = t203 * t734;
  t749 = t719 * t206 / 0.3e1 + t722 * t416 / 0.3e1 - t726 * t727 / 0.2e1 + t415 * t730 / 0.6e1 + t735 * t727 / 0.12e2 - 0.128e3 * t711 - 0.128e3 / 0.3e1 * t714 + 0.4e1 / 0.3e1 * t725 * t710 * t206 + 0.8e1 / 0.3e1 * t420 * t713 - 0.8e1 / 0.3e1 * t213 * t713 + 0.16e2 * t710 + 0.16e2 * t717;
  t750 = my_piecewise3(t176, t696 * t195 / 0.8671998246912e15 - t699 * t377 / 0.270999945216e14 + t704 * t661 / 0.31882346496e13 - t401 * t670 / 0.541999890432e14, t749);
  t751 = t175 * t750;
  t752 = t751 * t228;
  t755 = t428 * t448;
  t759 = 0.1e1 / t432 / t226;
  t760 = t21 * t759;
  t761 = t447 * t447;
  t762 = t760 * t761;
  t763 = t219 * t762;
  t766 = params->b_PBE * t645;
  t769 = t435 * t438;
  t774 = t440 * t485 * t28 * sigma[0];
  t777 = t491 * t81;
  t778 = t777 * t493;
  t779 = t220 * t778;
  t780 = t495 * t16;
  t783 = t780 * t500 * t28 * sigma[0];
  t787 = 0.864e3 * t766 * t222 + 0.96e2 * t769 * t443 - 0.8e2 * t439 * t774 + 0.16e2 * t779 * t783 + 0.3584e5 / 0.9e1 * t650;
  t788 = t434 * t787;
  t789 = t219 * t788;
  t792 = -0.112e3 / 0.3e1 * t475 * t229 - 0.224e3 * t478 * t229 - 0.224e3 * t236 * t429 + 0.224e3 * t236 * t449 - 0.84e2 * t654 * t229 - 0.168e3 * t367 * t429 + 0.168e3 * t367 * t449 - 0.84e2 * t172 * t752 + 0.168e3 * t172 * t755 - 0.168e3 * t172 * t763 + 0.84e2 * t172 * t789;
  t793 = my_piecewise3(t2, 0, t792);
  tv2rho20 = 0.2e1 * t793;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t794 = t33 * t4;
  t795 = t794 * t456;
  t799 = 0.1e1 / t35 / M_PI;
  t800 = t38 * t799;
  t801 = t800 * params->b_PBE;
  t802 = t10 * t19;
  t803 = t801 * t802;
  t805 = t16 * t28 * t31;
  t806 = t163 * t175;
  t807 = t218 * t227;
  t808 = t806 * t807;
  t809 = t805 * t808;
  t813 = t31 * t358 * t175;
  t814 = t813 * t461;
  t817 = t427 * t21;
  t818 = t817 * t227;
  t819 = t459 * t818;
  t822 = t454 * t8;
  t823 = t29 * t31;
  t824 = t822 * t823;
  t825 = t806 * t218;
  t826 = t825 * t448;
  t829 = t794 * t465;
  t832 = t366 * t175;
  t833 = t454 * t832;
  t836 = t817 * t433;
  t837 = t836 * t468;
  t840 = t170 * t175;
  t841 = t840 * t218;
  t842 = t822 * t841;
  t843 = t760 * params->b_PBE;
  t844 = t163 * t28;
  t846 = t843 * t844 * t447;
  t849 = t435 * t28;
  t850 = t467 * t849;
  t853 = t800 * t170;
  t854 = t219 * t16;
  t855 = t853 * t854;
  t856 = t433 * params->b_PBE;
  t859 = t10 * t19 * t28;
  t860 = t856 * t163 * t859;
  t863 = -0.81e2 * t457 * t814 - 0.81e2 * t457 * t819 - 0.108e3 * t795 * t462 + 0.72576e5 * t466 * t837 + 0.72576e5 * t466 * t850 + 0.96768e5 * t829 * t469 + 0.72576e5 * t833 * t469 - 0.27e2 * t803 * t809 + 0.81e2 * t824 * t826 - 0.145152e6 * t842 * t846 + 0.24192e5 * t855 * t860;
  t864 = my_piecewise3(t2, 0, t863);
  tv2rhosigma0 = 0.2e1 * t864;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t865 = t5 * t8;
  t866 = params->b_PBE * params->b_PBE;
  t867 = t28 * t28;
  t869 = t866 * t867 * t31;
  t870 = t865 * t869;
  t871 = t163 * t163;
  t872 = t871 * t175;
  t873 = t872 * t467;
  t876 = t865 * t841;
  t877 = t866 * t871;
  t878 = t877 * t867;
  t879 = t760 * t878;
  t883 = my_piecewise3(t2, 0, 0.419904e6 * t870 * t873 - 0.376233984e9 * t876 * t879);
  tv2sigma20 = 0.2e1 * t883;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t887 = t23 * t262;
  t898 = t18 * t665;
  t902 = t372 * t262;
  t906 = t38 * t526;
  t913 = t261 * t261;
  t914 = 0.1e1 / t913;
  t915 = t22 * t914;
  t916 = t528 * t277;
  t920 = t277 * t545;
  t924 = t627 * t625;
  t925 = t924 * t623;
  t926 = t3 * t21;
  t939 = t3 * t665 * t9;
  t940 = t71 * t939;
  t942 = t78 * t245;
  t944 = 0.32e2 * t532 * t34 * t233 * t264 - 0.24e2 * t925 * t926 * t38 * t264 + 0.64e2 * t78 * t264 * t245 + 0.16e2 * t940 - 0.24e2 * t942;
  t948 = -0.112e3 / 0.27e2 * t78 * t245 * t86 - 0.14e2 * t78 * t887 * t277 + 0.28e2 * t78 * t4 * t526 * t528 - 0.14e2 * t78 * t513 * t545 - 0.16e2 / 0.9e1 * t51 * t898 * t86 - 0.4e1 * t260 * t902 * t277 - 0.24e2 * t260 * t906 * t528 + 0.12e2 * t260 * t521 * t545 + 0.36e2 * t260 * t915 * t916 - 0.36e2 * t260 * t527 * t920 + 0.6e1 * t260 * t263 * t944;
  t968 = t23 * t16;
  t972 = t116 * t93;
  t973 = t233 * t122;
  t979 = t91 * t63;
  t981 = 0.1e1 / t81 / p->cam_omega * t64 * t979;
  t982 = t627 * t17;
  t984 = t136 * t137;
  t987 = t38 * t122;
  t988 = t264 * t3;
  t999 = t35 * t979;
  t1001 = t627 * t18;
  t1002 = t111 * t999 * t1001;
  t1016 = -0.4e2 / 0.3e1 * t321 * t322 * t372 * t137 + 0.48e2 * t607 * t968 * t137 + 0.4e2 / 0.3e1 * t972 * t973 * t613 + 0.8e1 * t981 * t982 * t984 + 0.16e2 * t925 * t987 * t988 - 0.64e2 / 0.3e1 * t328 * t329 * t245 - 0.78e2 * t626 * t627 * t38 * t122 - 0.18e2 * t1002 * t608 * t122 - 0.4e2 / 0.3e1 * t339 * t340 * t973 + 0.32e2 * t143 * t144 * t245 - 0.64e2 / 0.9e1 * t124 * t939 + 0.64e2 / 0.9e1 * t47 * t939;
  t1018 = t136 * t314 * t1016;
  t1021 = t575 * t256;
  t1026 = t305 * t517;
  t1033 = t134 * t898;
  t1040 = t312 * t312;
  t1041 = 0.1e1 / t1040;
  t1045 = t136 * t115 * t1041 * t592 * t352;
  t1048 = t52 * t33;
  t1049 = t134 * t1048;
  t1050 = t21 * t115;
  t1053 = t1050 * t590 * t352 * t639;
  t1061 = t116 * t130;
  t1073 = (-0.16e2 / 0.9e1 * t942 + 0.104e3 / 0.9e1 * t78 * t245 * t122 - 0.1e2 / 0.3e1 * t93 * t233 * t1061 + 0.14e2 / 0.3e1 * t925 * t926 * t987 - 0.88e2 / 0.27e2 * t124 * t665 * t21 * t45 + 0.88e2 / 0.27e2 * t940) * t12;
  t1074 = t1073 * t52;
  t1077 = -t584 * t354 / 0.27e2 + t309 * t641 / 0.9e1 + t135 * t1018 / 0.18e2 - t1021 * t160 / 0.9e1 + t576 * t354 / 0.6e1 + t1026 * t160 / 0.27e2 + 0.2e1 / 0.9e1 * t579 * t354 + t306 * t641 / 0.6e1 - 0.4e1 / 0.243e3 * t1033 * t160 - t306 * t594 / 0.3e1 - 0.2e1 / 0.9e1 * t309 * t594 + t135 * t1045 / 0.3e1 - t1049 * t1053 / 0.3e1 - t1074 * t160 / 0.18e2;
  t1078 = my_piecewise5(t44, t948, t90, (0.448e5 / 0.27e2 * t98 * t665 * t81 * t18 + 0.112e4 / 0.27e2 * t104 * t245 * t9 * t76) * t111 / 0.2016e6, t1077);
  t1079 = params->b_PBE * t1078;
  t1082 = t766 * t438;
  t1087 = t435 * t778;
  t1091 = 0.1e1 / t22 / t498;
  t1094 = t440 * t1091 * t28 * sigma[0];
  t1097 = t94 * t94;
  t1099 = 0.1e1 / t4 / t1097;
  t1102 = t780 * t1099 * t28 * sigma[0];
  t1105 = t491 * params->ax;
  t1106 = t1105 * t110;
  t1107 = 0.1e1 / t91;
  t1108 = t1106 * t1107;
  t1109 = t220 * t1108;
  t1110 = 0.1e1 / t92;
  t1111 = t1097 * rho[0];
  t1112 = 0.1e1 / t1111;
  t1114 = t1110 * t1112 * t222;
  t1118 = params->kappa * t38 * t12;
  t1120 = 0.864e3 * t1079 * t222 + 0.144e3 * t1082 * t443 - 0.24e3 * t769 * t774 + 0.48e2 * t1087 * t783 + 0.64e3 / 0.3e1 * t439 * t1094 - 0.8e2 * t779 * t1102 + 0.16e2 / 0.9e1 * t1109 * t1114 + 0.7168e5 / 0.27e2 * t1118;
  t1121 = t434 * t1120;
  t1122 = t219 * t1121;
  t1129 = t751 * t448;
  t1132 = t428 * t788;
  t1147 = t428 * t762;
  t1150 = 0.84e2 * t172 * t1122 + 0.252e3 * t172 * t1129 + 0.252e3 * t172 * t1132 - 0.504e3 * t172 * t1147 + 0.672e3 * t236 * t755 + 0.336e3 * t236 * t789 + 0.504e3 * t367 * t755 - 0.504e3 * t367 * t763 + 0.252e3 * t367 * t789 + 0.112e3 * t475 * t449 + 0.672e3 * t478 * t449 + 0.252e3 * t654 * t449;
  t1153 = t432 * t432;
  t1154 = 0.1e1 / t1153;
  t1155 = t21 * t1154;
  t1156 = t761 * t447;
  t1157 = t1155 * t1156;
  t1158 = t219 * t1157;
  t1162 = t21 * t1091 * t28;
  t1167 = t16 * t1099 * t28;
  t1177 = params->b_PBE * t1105 * t110 * t1107 * t1110;
  t1179 = t1112 * t3 * t28;
  t1186 = t248 * t645;
  t1195 = t8 * (0.5e1 / 0.21e2 * t243 * t1162 * t249 - 0.5e1 / 0.56e2 * t497 * t1167 * t249 - 0.15e2 / 0.56e2 * t243 * t487 * t506 + t1177 * t1179 * t249 / 0.504e3 + 0.3e1 / 0.56e2 * t497 * t502 * t506 + 0.9e1 / 0.56e2 * t243 * t247 * t1186 + 0.27e2 / 0.28e2 * t30 * t32 * t1078 + 0.8e2 / 0.27e2 * t1118);
  t1196 = t6 * t1195;
  t1199 = t474 * t366;
  t1204 = t235 * t653;
  t1211 = t3 * t245;
  t1212 = t1211 * t171;
  t1219 = t661 * t377;
  t1222 = t185 * t377;
  t1227 = t187 * t377;
  t1232 = t182 * t377;
  t1237 = t181 * t377;
  t1242 = t180 * t377;
  t1247 = t179 * t377;
  t1253 = 0.14e2 / 0.81e2 * t37 * p->cam_omega * t500 * t40;
  t1254 = my_piecewise3(t177, -t1253, 0);
  t1267 = t377 * t670;
  t1271 = -0.1938816e8 * t178 * t1219 - 0.35129622528e12 * t370 * t1219 + 0.36661248e10 * t380 * t1219 + 0.526101226979328e17 * t381 * t1219 - 0.11923997589504e16 * t384 * t1219 + 0.232285667328e14 * t387 * t1219 + 0.131525306744832e17 * t1222 * t670 - 0.35771992768512e15 * t1227 * t670 + 0.87107125248e13 * t1232 * t670 - 0.17564811264e12 * t1237 * t670 + 0.27495936e10 * t1242 * t670 - 0.2908224e8 * t1247 * t670 + 0.38896e5 * t178 * t1254 + 0.18330624e9 * t370 * t1254 + 0.3372443762688e15 * t371 * t1254 - 0.323136e7 * t380 * t1254 - 0.1083999780864e14 * t381 * t1254 + 0.3226189824e12 * t384 * t1254 - 0.836419584e10 * t387 * t1254 + 0.116688e6 * t1267;
  t1274 = t696 * t400;
  t1277 = t396 * t703;
  t1283 = 0.1e1 / t194 / t380;
  t1284 = t193 * t1283;
  t1292 = t719 * t414;
  t1297 = t411 * t734;
  t1301 = 0.1e1 / t200 / t405;
  t1302 = t203 * t1301;
  t1303 = t710 * t406;
  t1304 = t1303 * t206;
  t1307 = my_piecewise3(t177, 0, -t1253);
  t1308 = t1307 * t206;
  t1311 = t200 * t200;
  t1313 = 0.1e1 / t1311 / t198;
  t1314 = t203 * t1313;
  t1318 = 0.1e1 / t200 / t198;
  t1322 = t725 * t406;
  t1325 = t411 * t725;
  t1328 = t203 * t1318;
  t1332 = t416 * t713;
  t1337 = t198 * t1303;
  t1339 = t199 * t406;
  t1340 = t1339 * t713;
  t1351 = t405 * t1307;
  t1353 = t406 * t713;
  t1355 = t198 * t1307;
  t1357 = 0.768e3 * t1337 + 0.1152e4 * t1340 + 0.128e3 * t1351 - 0.96e2 * t1353 - 0.32e2 * t1355;
  t1363 = -0.3e1 / 0.2e1 * t726 * t1332 + t735 * t1332 / 0.4e1 - 0.256e3 * t1337 - 0.384e3 * t1340 + 0.2e1 / 0.3e1 * t1301 * t1303 * t206 + 0.8e1 / 0.3e1 * t420 * t1307 - 0.8e1 / 0.3e1 * t213 * t1307 + t1357 * t206 / 0.3e1 - 0.128e3 / 0.3e1 * t1351 + 0.48e2 * t1353 + 0.16e2 * t1355;
  t1365 = my_piecewise3(t176, t1271 * t195 / 0.8671998246912e15 - t1274 * t377 / 0.180666630144e14 + t1277 * t661 / 0.10627448832e13 - t699 * t670 / 0.180666630144e14 - t1284 * t1219 / 0.1771241472e12 + t704 * t1267 / 0.10627448832e13 - t401 * t1254 / 0.541999890432e14, t1292 * t416 / 0.2e1 + t722 * t730 / 0.2e1 + t1297 * t727 / 0.4e1 - 0.3e1 / 0.4e1 * t1302 * t1304 + t415 * t1308 / 0.6e1 + t1314 * t1304 / 0.24e2 - 0.16e2 / 0.3e1 * t1318 * t1303 * t206 + 0.4e1 * t1322 * t730 - 0.3e1 / 0.2e1 * t1325 * t727 + 0.2e1 * t1328 * t1304 + t1363);
  t1366 = t175 * t1365;
  t1367 = t1366 * t228;
  t1370 = t6 * t465;
  t1371 = t759 * t447;
  t1372 = t1371 * t787;
  t1373 = t460 * t1372;
  t1376 = -0.672e3 * t236 * t763 + 0.504e3 * t172 * t1158 - 0.84e2 * t1196 * t229 - 0.112e3 * t1199 * t229 - 0.112e3 * t475 * t429 - 0.336e3 * t1204 * t229 - 0.672e3 * t478 * t429 - 0.336e3 * t236 * t752 + 0.224e3 / 0.9e1 * t1212 * t229 - 0.252e3 * t654 * t429 - 0.252e3 * t367 * t752 - 0.84e2 * t172 * t1367 - 0.504e3 * t1370 * t1373;
  t1378 = my_piecewise3(t2, 0, t1150 + t1376);
  tv3rho30 = 0.2e1 * t1378;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1379 = 0.1e1 / t94;
  t1380 = 0.1e1 / t315;
  t1381 = t1379 * t1380;
  t1382 = t1381 * t170;
  t1383 = t219 * t433;
  t1384 = t1382 * t1383;
  t1387 = t3 * t28;
  t1388 = t81 * t495 * t1387;
  t1389 = t220 * t491 * t1388;
  t1393 = t856 * t358 * t859;
  t1396 = t372 * t799;
  t1397 = t1396 * t170;
  t1398 = t1397 * t854;
  t1401 = t800 * t365;
  t1402 = t1401 * t854;
  t1405 = t428 * t16;
  t1406 = t853 * t1405;
  t1409 = t1396 * params->b_PBE;
  t1410 = t1409 * t802;
  t1413 = t358 * t175;
  t1414 = t1413 * t807;
  t1415 = t805 * t1414;
  t1418 = t427 * t227;
  t1419 = t806 * t1418;
  t1420 = t805 * t1419;
  t1423 = t1381 * params->b_PBE;
  t1424 = t777 * t495;
  t1425 = t1423 * t1424;
  t1426 = t1387 * t31;
  t1427 = t1426 * t808;
  t1430 = t365 * t175;
  t1431 = t1430 * t218;
  t1432 = t822 * t1431;
  t1435 = t806 * t427;
  t1436 = t1435 * t448;
  t1439 = t825 * t788;
  t1442 = t794 * t8;
  t1443 = t1442 * t823;
  t1446 = t1413 * t218;
  t1447 = t1446 * t448;
  t1450 = t840 * t427;
  t1451 = t822 * t1450;
  t1454 = t358 * t28;
  t1456 = t843 * t1454 * t447;
  t1460 = t843 * t844 * t787;
  t1463 = t1442 * t841;
  t1466 = t1155 * params->b_PBE;
  t1468 = t1466 * t844 * t761;
  t1471 = 0.2688e4 * t1384 * t1389 + 0.48384e5 * t855 * t1393 + 0.24192e5 * t1398 * t860 + 0.48384e5 * t1402 * t860 + 0.48384e5 * t1406 * t860 - 0.27e2 * t1410 * t809 - 0.54e2 * t803 * t1415 - 0.54e2 * t803 * t1420 - 0.3e1 * t1425 * t1427 - 0.290304e6 * t1432 * t846 + 0.162e3 * t824 * t1436 + 0.81e2 * t824 * t1439 + 0.216e3 * t1443 * t826 + 0.162e3 * t824 * t1447 - 0.290304e6 * t1451 * t846 - 0.290304e6 * t842 * t1456 - 0.145152e6 * t842 * t1460 - 0.387072e6 * t1463 * t846 + 0.435456e6 * t842 * t1468;
  t1472 = t825 * t762;
  t1475 = t766 * t28;
  t1476 = t467 * t1475;
  t1481 = t653 * t175;
  t1482 = t454 * t1481;
  t1489 = t750 * t21;
  t1490 = t1489 * t433;
  t1491 = t1490 * t468;
  t1494 = t836 * t849;
  t1497 = t1489 * t227;
  t1498 = t459 * t1497;
  t1501 = t794 * t832;
  t1511 = t31 * t645 * t175;
  t1512 = t1511 * t461;
  t1515 = t813 * t818;
  t1518 = t33 * t23;
  t1519 = t1518 * t465;
  t1522 = t1518 * t456;
  t1526 = t10 * t19 * t16;
  t1527 = t801 * t1526;
  t1528 = t28 * t31;
  t1529 = t1528 * t163;
  t1530 = t433 * t447;
  t1531 = t219 * t1530;
  t1532 = t1529 * t1531;
  t1535 = t16 * t759;
  t1536 = t219 * t1535;
  t1537 = t853 * t1536;
  t1538 = t220 * params->ax;
  t1539 = t9 * t19;
  t1540 = t28 * t447;
  t1541 = t1539 * t1540;
  t1542 = t1538 * t1541;
  t1545 = -0.162e3 * t824 * t1472 + 0.72576e5 * t466 * t1476 + 0.72576e5 * t1482 * t469 + 0.72576e5 * t466 * t1491 + 0.145152e6 * t466 * t1494 - 0.81e2 * t457 * t1498 + 0.193536e6 * t1501 * t469 - 0.81e2 * t457 * t1512 - 0.162e3 * t457 * t1515 + 0.32256e5 * t1519 * t469 - 0.36e2 * t1522 * t462 + 0.54e2 * t1527 * t1532 - 0.96768e5 * t1537 * t1542 - 0.216e3 * t795 * t814 - 0.216e3 * t795 * t819 + 0.193536e6 * t829 * t837 + 0.193536e6 * t829 * t850 + 0.145152e6 * t833 * t837 + 0.145152e6 * t833 * t850;
  t1547 = my_piecewise3(t2, 0, t1471 + t1545);
  tv3rho2sigma0 = 0.2e1 * t1547;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1548 = t4 * t8;
  t1549 = t1548 * t869;
  t1552 = t800 * t866;
  t1553 = t867 * t31;
  t1554 = t1553 * t872;
  t1555 = t1552 * t1554;
  t1556 = t218 * t16;
  t1559 = t10 * t3 * t19;
  t1560 = t1556 * t433 * t1559;
  t1563 = t434 * t358;
  t1564 = t825 * t1563;
  t1567 = t872 * t836;
  t1570 = t872 * t218;
  t1571 = t760 * t447;
  t1572 = t1570 * t1571;
  t1575 = t1548 * t841;
  t1578 = t865 * t1431;
  t1581 = t865 * t1450;
  t1584 = t1155 * t866;
  t1585 = t871 * t867;
  t1587 = t1584 * t1585 * t447;
  t1590 = t760 * t866;
  t1591 = t163 * t867;
  t1593 = t1590 * t1591 * t358;
  t1596 = t878 * t1559;
  t1599 = -0.83607552e8 * t1537 * t1596 + 0.559872e6 * t1549 * t873 + 0.93312e5 * t1555 * t1560 + 0.839808e6 * t870 * t1564 + 0.419904e6 * t870 * t1567 - 0.839808e6 * t870 * t1572 - 0.501645312e9 * t1575 * t879 - 0.376233984e9 * t1578 * t879 - 0.376233984e9 * t1581 * t879 + 0.1128701952e10 * t876 * t1587 - 0.752467968e9 * t876 * t1593;
  t1600 = my_piecewise3(t2, 0, t1599);
  tv3rhosigma20 = 0.2e1 * t1600;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1601 = t866 * params->b_PBE;
  t1602 = t867 * t28;
  t1604 = t1601 * t1602 * t31;
  t1605 = t865 * t1604;
  t1606 = t871 * t163;
  t1607 = t1606 * t175;
  t1609 = t760 * t3;
  t1610 = t1607 * t218 * t1609;
  t1616 = t1155 * t1601 * t1606 * t1602 * t3;
  t1620 = my_piecewise3(t2, 0, -0.1088391168e10 * t1605 * t1610 + 0.975198486528e12 * t876 * t1616);
  tv3sigma30 = 0.2e1 * t1620;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1650 = t1001 * t999;
  t1651 = t111 * t23;
  t1663 = t3 * t500 * t9;
  t1664 = t71 * t1663;
  t1666 = t78 * t485;
  t1684 = t18 * t500;
  t1701 = t528 * t528;
  t1709 = t545 * t545;
  t1741 = 0.6e1 * t260 * t263 * (-0.24e2 * t925 * t926 * t372 * t264 + 0.48e2 * t1650 * t1651 * t264 - 0.16e3 / 0.3e1 * t532 * t34 * t1379 * t264 - 0.32e3 / 0.3e1 * t78 * t264 * t485 - 0.112e3 / 0.3e1 * t1664 + 0.4e2 * t1666) + 0.56e2 * t78 * t23 * t526 * t528 - 0.112e3 * t78 * t4 * t914 * t916 + 0.112e3 * t275 * t526 * t277 * t545 + 0.112e3 / 0.27e2 * t51 * t1684 * t86 + 0.64e2 / 0.9e1 * t260 * t665 * t262 * t277 - 0.8e1 * t260 * t902 * t545 + 0.16e2 * t260 * t521 * t944 - 0.144e3 * t260 * t22 / t913 / t85 * t1701 + 0.216e3 * t260 * t915 * t528 * t545 - 0.36e2 * t260 * t527 * t1709 - 0.48e2 * t260 * t527 * t277 * t944 + 0.16e2 * t260 * t372 * t526 * t528 + 0.96e2 * t260 * t38 * t914 * t916 - 0.96e2 * t260 * t906 * t920 + 0.224e3 / 0.27e2 * t78 * t485 * t86 + 0.448e3 / 0.27e2 * t78 * t245 * t262 * t277 - 0.28e2 * t78 * t887 * t545 - 0.56e2 / 0.3e1 * t78 * t513 * t944;
  t1761 = t1379 * t122;
  t1796 = t81 * t81;
  t1798 = t91 * t91;
  t1815 = 0.16e3 / 0.9e1 * t321 * t322 * t665 * t137 - 0.136e3 / 0.3e1 * t607 * t245 * t16 * t137 - 0.16e3 / 0.9e1 * t972 * t1761 * t613 + 0.16e2 * t981 * t982 * t233 * t984 + 0.8e2 / 0.3e1 * t925 * t372 * t122 * t988 + 0.16e2 / t81 / t601 * t319 * t91 * t315 * t627 * t53 * t271 * t137 + 0.16e2 * t1002 * t130 * t536 + 0.32e3 / 0.9e1 * t328 * t329 * t485 - 0.2e1 / 0.3e1 * t626 * t627 * t372 * t122 - 0.84e2 * t1002 * t968 * t122 - 0.6e1 / t1796 * t1798 * t627 * t76 * t136 * t122 + 0.24e2 * t339 * t340 * t1761 - 0.544e3 / 0.9e1 * t143 * t144 * t485 + 0.448e3 / 0.27e2 * t124 * t1663 - 0.448e3 / 0.27e2 * t47 * t1663;
  t1825 = t592 * t592;
  t1830 = t639 * t639;
  t1853 = t135 * t136 * t314 * t1815 / 0.18e2 + 0.8e1 / 0.9e1 * t309 * t1045 - 0.4e1 / 0.3e1 * t135 * t136 * t115 / t1040 / t157 * t1825 - t135 * t136 * t591 * t1830 / 0.3e1 - 0.8e1 / 0.9e1 * t579 * t594 + 0.4e1 / 0.3e1 * t306 * t1045 - 0.2e1 / 0.3e1 * t576 * t594 + 0.16e2 / 0.243e3 * t1033 * t354 + 0.4e1 / 0.27e2 * t584 * t594 + 0.4e1 / 0.9e1 * t1021 * t354 + 0.2e1 / 0.9e1 * t1074 * t354 + t576 * t641 / 0.3e1 - 0.4e1 / 0.27e2 * t1026 * t354;
  t1915 = -0.2e1 / 0.27e2 * t584 * t641 + 0.4e1 / 0.9e1 * t579 * t641 + 0.4e1 / 0.27e2 * t309 * t1018 + 0.2e1 / 0.9e1 * t306 * t1018 - 0.4e1 / 0.27e2 * t1073 * t256 * t160 - (0.8e2 / 0.27e2 * t1666 - 0.232e3 / 0.9e1 * t78 * t485 * t122 + 0.194e3 / 0.27e2 * t93 * t1379 * t1061 - 0.44e2 / 0.9e1 * t924 * t372 * t624 * t152 + 0.28e2 / 0.3e1 * t1650 * t1651 * t122 + 0.616e3 / 0.81e2 * t124 * t500 * t21 * t45 - 0.616e3 / 0.81e2 * t1664) * t12 * t52 * t160 / 0.18e2 - 0.16e2 / 0.243e3 * t305 * t898 * t160 + 0.28e2 / 0.729e3 * t134 * t1684 * t160 + 0.2e1 / 0.27e2 * t575 * t517 * t160 + 0.2e1 * t1049 * t1050 * t1041 * t592 * t639 - 0.4e1 / 0.3e1 * t305 * t1048 * t1053 - 0.4e1 / 0.9e1 * t1049 * t1050 * t590 * t1016 * t352 - 0.8e1 / 0.9e1 * t134 * t256 * t33 * t1053;
  t1917 = my_piecewise5(t44, t1741, t90, (-0.3136e6 / 0.81e2 * t98 * t500 * t81 * t18 - 0.56e4 / 0.81e2 * t104 * t485 * t9 * t76) * t111 / 0.2016e6, t1853 + t1915);
  t1937 = 0.1e1 / t22 / t1097;
  t1944 = 0.1e1 / t4 / t1111;
  t1950 = t1097 * t94;
  t1951 = 0.1e1 / t1950;
  t1956 = t491 * t491;
  t1958 = 0.1e1 / t625;
  t1961 = 0.1e1 / t627;
  t1963 = 0.1e1 / t22 / t1950;
  t1966 = t21 * t28;
  t1972 = params->kappa * t372 * t12;
  t1974 = 0.864e3 * params->b_PBE * t1917 * t222 + 0.192e3 * t1079 * t438 * t443 - 0.48e3 * t1082 * t774 + 0.96e2 * t766 * t778 * t783 + 0.256e4 / 0.3e1 * t769 * t1094 - 0.32e3 * t1087 * t1102 + 0.64e2 / 0.9e1 * t435 * t1108 * t1114 - 0.704e4 / 0.9e1 * t439 * t440 * t1937 * t28 * sigma[0] + 0.376e4 / 0.9e1 * t779 * t780 * t1944 * t28 * sigma[0] - 0.16e3 / 0.9e1 * t1109 * t1110 * t1951 * t222 + 0.8e1 / 0.81e2 * t220 * t1956 * t1796 * t1958 * t1961 * t1963 * t33 * t1966 * sigma[0] - 0.7168e5 / 0.81e2 * t1972;
  t1979 = -0.896e3 / 0.9e1 * t1212 * t449 + 0.448e3 * t1199 * t449 + 0.336e3 * t1196 * t449 + 0.504e3 * t172 * t751 * t788 + 0.1008e4 * t654 * t755 + 0.1008e4 * t367 * t1129 + 0.1008e4 * t367 * t1132 + 0.504e3 * t654 * t789 + 0.336e3 * t172 * t1366 * t448 + 0.336e3 * t367 * t1122 + 0.336e3 * t172 * t428 * t1121 + 0.84e2 * t172 * t219 * t434 * t1974;
  t2008 = 0.2016e4 * t172 * t428 * t1157 - 0.1008e4 * t172 * t751 * t762 + 0.1344e4 * t236 * t1129 + 0.1344e4 * t236 * t1132 - 0.2688e4 * t236 * t1147 + 0.2016e4 * t367 * t1158 + 0.1344e4 * t1204 * t449 + 0.448e3 * t475 * t755 - 0.448e3 * t475 * t763 + 0.224e3 * t475 * t789 + 0.2688e4 * t478 * t755 - 0.2688e4 * t478 * t763 - 0.1008e4 * t654 * t763;
  t2019 = 0.1e1 / t1153 / t226;
  t2020 = t21 * t2019;
  t2021 = t761 * t761;
  t2026 = t787 * t787;
  t2061 = t670 * t670;
  t2063 = t661 * t661;
  t2068 = 0.14e3 / 0.243e3 * t37 * p->cam_omega * t1099 * t40;
  t2069 = my_piecewise3(t177, t2068, 0);
  t2074 = -0.11632896e9 * t178 * t661 * t670 - 0.210777735168e13 * t370 * t661 * t670 + 0.219967488e11 * t380 * t661 * t670 + 0.3156607361875968e18 * t381 * t661 * t670 - 0.71543985537024e16 * t384 * t661 * t670 + 0.1393714003968e15 * t387 * t661 * t670 + 0.175367075659776e17 * t1222 * t1254 - 0.47695990358016e15 * t1227 * t1254 + 0.116142833664e14 * t1232 * t1254 - 0.23419748352e12 * t1237 * t1254 + 0.36661248e10 * t1242 * t1254 - 0.3877632e8 * t1247 * t1254 + 0.3372443762688e15 * t371 * t2069 - 0.1083999780864e14 * t381 * t2069 + 0.116688e6 * t2061 - 0.1938816e8 * t2063;
  t2083 = t377 * t1254;
  t2109 = 0.38896e5 * t178 * t2069 - 0.2908224e8 * t179 * t2061 + 0.109983744e11 * t179 * t2063 + 0.27495936e10 * t180 * t2061 - 0.17564811264e13 * t180 * t2063 - 0.17564811264e12 * t181 * t2061 + 0.1625999671296e15 * t181 * t2063 + 0.87107125248e13 * t182 * t2061 - 0.107315978305536e17 * t182 * t2063 + 0.131525306744832e17 * t185 * t2061 - 0.35771992768512e15 * t187 * t2061 + 0.5787113496772608e18 * t187 * t2063 + 0.18330624e9 * t370 * t2069 - 0.323136e7 * t380 * t2069 + 0.3226189824e12 * t384 * t2069 - 0.836419584e10 * t387 * t2069 + 0.155584e6 * t2083;
  t2142 = (t2074 + t2109) * t195 / 0.8671998246912e15 - t1271 * t400 * t377 / 0.135499972608e14 + t696 * t703 * t661 / 0.5313724416e12 - t1274 * t670 / 0.90333315072e13 - t396 * t1283 * t1219 / 0.442810368e11 + t1277 * t1267 / 0.2656862208e12 - t699 * t1254 / 0.135499972608e14 + 0.19e2 / 0.1771241472e12 * t193 / t194 / t180 * t2063 - t1284 * t661 * t670 / 0.295206912e11 + t704 * t2061 / 0.10627448832e13 + t704 * t2083 / 0.7970586624e12 - t401 * t2069 / 0.541999890432e14;
  t2146 = t727 * t713;
  t2149 = t1308 * t406;
  t2158 = t713 * t713;
  t2159 = t199 * t2158;
  t2161 = my_piecewise3(t177, 0, t2068);
  t2162 = t405 * t2161;
  t2164 = t406 * t1307;
  t2166 = t198 * t2161;
  t2168 = t710 * t710;
  t2171 = t198 * t710 * t713;
  t2174 = t1339 * t1307;
  t2191 = 0.1e1 / t1311;
  t2193 = t2168 * t206;
  t2201 = t2158 * t206;
  t2206 = -0.6e1 * t1325 * t1332 + t1297 * t1332 - 0.9e1 / 0.2e1 * t1302 * t2146 - 0.2e1 * t726 * t2149 + t735 * t2149 / 0.3e1 + t1314 * t2146 / 0.4e1 + 0.12e2 * t1328 * t2146 - 0.384e3 * t2159 - 0.128e3 / 0.3e1 * t2162 + 0.64e2 * t2164 + 0.16e2 * t2166 + (0.768e3 * t2168 + 0.4608e4 * t2171 + 0.1152e4 * t2159 + 0.1536e4 * t2174 + 0.128e3 * t2162 - 0.96e2 * t2158 - 0.128e3 * t2164 - 0.32e2 * t2166) * t206 / 0.3e1 + t719 * t734 * t727 / 0.2e1 + 0.2e1 / 0.3e1 * t722 * t1308 - 0.3e1 * t411 * t1301 * t1304 + 0.25e2 / 0.4e1 * t203 * t2191 * t2193 + 0.8e1 * t411 * t1318 * t1304 - 0.1e2 * t735 * t2193 - 0.3e1 / 0.2e1 * t726 * t2201 + t735 * t2201 / 0.4e1;
  t2214 = 0.1e1 / t1311 / t199;
  t2258 = -0.3e1 * t719 * t725 * t727 + t411 * t1313 * t1304 / 0.6e1 - 0.3e1 / 0.4e1 * t203 * t2214 * t2193 + t415 * t2161 * t206 / 0.6e1 + t203 / t1311 / t200 * t2193 / 0.48e2 - 0.32e2 * t1318 * t710 * t730 + 0.16e2 / 0.3e1 * t1322 * t1308 + 0.4e1 * t1301 * t710 * t730 + 0.2e1 / 0.3e1 * t1357 * t414 * t416 + t1292 * t730 - 0.1536e4 * t2171 - 0.512e3 * t2174 + 0.8e2 / 0.3e1 * t734 * t2168 * t206 + 0.4e1 * t725 * t2158 * t206 - 0.22e2 / 0.3e1 * t2191 * t2168 * t206 + t2214 * t2168 * t206 / 0.3e1 + 0.8e1 / 0.3e1 * t420 * t2161 - 0.8e1 / 0.3e1 * t213 * t2161 - 0.256e3 * t2168 + 0.48e2 * t2158;
  t2260 = my_piecewise3(t176, t2142, t2206 + t2258);
  t2323 = -0.55e2 / 0.63e2 * t243 * t21 * t1937 * t28 * t249 + 0.235e3 / 0.504e3 * t497 * t16 * t1944 * t28 * t249 + 0.2e2 / 0.21e2 * t243 * t1162 * t506 - 0.5e1 / 0.252e3 * t1177 * t1951 * t3 * t28 * t249 - 0.5e1 / 0.14e2 * t497 * t1167 * t506 - 0.15e2 / 0.28e2 * t243 * t487 * t1186 + params->b_PBE * t1956 * t1796 * t1958 * t1961 * t1963 * t136 * t28 * t249 / 0.9072e4 + t1177 * t1179 * t506 / 0.126e3 + 0.3e1 / 0.28e2 * t497 * t502 * t1186 + 0.3e1 / 0.14e2 * t243 * t247 * t248 * t1078 + 0.27e2 / 0.28e2 * t30 * t32 * t1917 - 0.8e2 / 0.81e2 * t1972;
  t2328 = -0.2016e4 * t367 * t1147 + 0.1344e4 * t478 * t789 + 0.448e3 * t236 * t1122 + 0.2688e4 * t236 * t1158 - 0.2016e4 * t172 * t219 * t2020 * t2021 - 0.504e3 * t172 * t219 * t760 * t2026 - 0.84e2 * t172 * t175 * t2260 * t228 - 0.336e3 * t367 * t1367 + 0.896e3 / 0.9e1 * t1211 * t366 * t229 + 0.896e3 / 0.9e1 * t1212 * t429 - 0.336e3 * t1196 * t429 - 0.504e3 * t654 * t752 - 0.84e2 * t6 * t8 * t2323 * t229;
  t2367 = -0.224e3 * t474 * t653 * t229 - 0.448e3 * t1199 * t429 - 0.224e3 * t475 * t752 - 0.448e3 * t235 * t1195 * t229 - 0.1344e4 * t1204 * t429 - 0.1344e4 * t478 * t752 - 0.112e4 / 0.27e2 * t3 * t485 * t171 * t229 - 0.448e3 * t236 * t1367 - 0.2016e4 * t6 * t832 * t1373 - 0.2016e4 * t1370 * t817 * t1372 - 0.672e3 * t1370 * t460 * t1371 * t1120 - 0.2688e4 * t235 * t465 * t1373 + 0.3024e4 * t1370 * t460 * t1154 * t761 * t787;
  t2370 = my_piecewise3(t2, 0, t1979 + t2008 + t2328 + t2367);
  tv4rho40 = 0.2e1 * t2370;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2381 = t787 * t447;
  t2390 = t665 * t799;
  t2413 = 0.1e1 / t498 * t1380;
  t2422 = 0.72576e5 * t800 * t652 * t854 * t860 + 0.72576e5 * t855 * t856 * t645 * t859 + 0.72576e5 * t1398 * t1393 + 0.1306368e7 * t842 * t1466 * t844 * t2381 - 0.486e3 * t824 * t825 * t760 * t2381 + 0.24e2 * t2390 * params->b_PBE * t802 * t809 + 0.145152e6 * t1406 * t1393 - 0.81e2 * t803 * t805 * t806 * t750 * t227 + 0.145152e6 * t1401 * t1405 * t860 - 0.21504e5 * t2390 * t170 * t854 * t860 - 0.9e1 * t1425 * t1426 * t1419 + 0.3e1 * t2413 * params->b_PBE * t1424 * t1427 + 0.8064e4 * t1381 * t365 * t1383 * t1389;
  t2433 = t645 * t175;
  t2467 = 0.8064e4 * t1382 * t428 * t433 * t1389 + 0.8064e4 * t1384 * t435 * t491 * t1388 - 0.81e2 * t1410 * t1420 - 0.81e2 * t803 * t805 * t2433 * t807 - 0.162e3 * t803 * t805 * t1413 * t1418 + 0.72576e5 * t1396 * t365 * t854 * t860 + 0.72576e5 * t1397 * t1405 * t860 - 0.81e2 * t1410 * t1415 + 0.145152e6 * t1402 * t1393 + 0.72576e5 * t853 * t751 * t16 * t860 - 0.2688e4 * t2413 * t170 * t1383 * t1389 - 0.9e1 * t1425 * t1426 * t1414 - 0.486e3 * t824 * t1446 * t762;
  t2478 = t1518 * t8;
  t2506 = -0.1741824e7 * t842 * t2020 * params->b_PBE * t844 * t1156 + 0.1306368e7 * t842 * t1466 * t1454 * t761 + 0.486e3 * t824 * t825 * t1157 - 0.1161216e7 * t1442 * t1431 * t846 - 0.486e3 * t824 * t1435 * t762 - 0.1161216e7 * t1442 * t1450 * t846 - 0.193536e6 * t2478 * t841 * t846 + 0.1306368e7 * t1432 * t1468 + 0.648e3 * t1443 * t1436 + 0.324e3 * t1443 * t1439 - 0.648e3 * t1443 * t1472 + 0.1306368e7 * t1451 * t1468 + 0.1741824e7 * t1463 * t1468;
  t2512 = t652 * t175 * t218;
  t2530 = t1430 * t427;
  t2542 = t840 * t750;
  t2548 = 0.486e3 * t824 * t1413 * t427 * t448 - 0.435456e6 * t842 * t843 * t1454 * t787 + 0.243e3 * t824 * t806 * t750 * t448 + 0.243e3 * t824 * t1435 * t788 + 0.243e3 * t824 * t1446 * t788 - 0.435456e6 * t822 * t2512 * t846 - 0.870912e6 * t822 * t2530 * t846 - 0.435456e6 * t822 * t2542 * t846 - 0.870912e6 * t1432 * t1456 - 0.435456e6 * t1432 * t1460 - 0.870912e6 * t1451 * t1456 - 0.1161216e7 * t1463 * t1456 - 0.580608e6 * t1463 * t1460;
  t2589 = -0.435456e6 * t1451 * t1460 + 0.243e3 * t824 * t2433 * t218 * t448 + 0.108e3 * t2478 * t823 * t826 + 0.648e3 * t1443 * t1447 + 0.81e2 * t824 * t825 * t1121 - 0.145152e6 * t842 * t843 * t844 * t1120 - 0.435456e6 * t842 * t843 * t645 * t28 * t447 - 0.324e3 * t795 * t1498 + 0.217728e6 * t1482 * t850 + 0.217728e6 * t833 * t1491 + 0.435456e6 * t833 * t1494 + 0.217728e6 * t466 * t836 * t1475 + 0.72576e5 * t466 * t467 * t1079 * t28;
  t2600 = t33 * t245;
  t2621 = t1365 * t21;
  t2628 = -0.81e2 * t457 * t31 * t1078 * t175 * t461 + 0.72576e5 * t454 * t1195 * t175 * t469 - 0.81e2 * t457 * t459 * t2621 * t227 - 0.243e3 * t457 * t813 * t1497 - 0.243e3 * t457 * t1511 * t818 - 0.21504e5 * t2600 * t465 * t469 + 0.217728e6 * t833 * t1476 + 0.290304e6 * t829 * t1491 + 0.580608e6 * t829 * t1494 + 0.580608e6 * t1501 * t850 - 0.324e3 * t795 * t1512 - 0.648e3 * t795 * t1515 - 0.108e3 * t1522 * t819;
  t2667 = -0.108e3 * t1522 * t814 + 0.96768e5 * t1518 * t832 * t469 + 0.96768e5 * t1519 * t837 + 0.96768e5 * t1519 * t850 + 0.72576e5 * t466 * t2621 * t433 * t468 + 0.217728e6 * t466 * t1490 * t849 + 0.217728e6 * t1482 * t837 + 0.580608e6 * t1501 * t837 + 0.24e2 * t2600 * t456 * t462 + 0.290304e6 * t794 * t1481 * t469 + 0.290304e6 * t829 * t1476 - 0.290304e6 * t1537 * t435 * params->ax * t1541 - 0.145152e6 * t1537 * t1538 * t1539 * t28 * t787;
  t2668 = t1401 * t1536;
  t2683 = t1397 * t1536;
  t2693 = t853 * t219 * t16 * t1154;
  t2701 = t1091 / t7 / t91;
  t2703 = t1110 * t33;
  t2719 = t495 * t3;
  t2738 = t853 * t428 * t1535;
  t2741 = -0.290304e6 * t2668 * t1542 + 0.162e3 * t1527 * t1529 * t428 * t1530 + 0.81e2 * t1527 * t1529 * t219 * t433 * t787 + 0.81e2 * t1409 * t1526 * t1532 - 0.145152e6 * t2683 * t1542 - 0.162e3 * t1527 * t1529 * t219 * t759 * t761 + 0.435456e6 * t2693 * t1538 * t1539 * t28 * t761 - t2701 * params->b_PBE * t1106 * t2703 * t1966 * t31 * t808 / 0.6e1 + 0.448e3 / 0.3e1 * t2701 * t170 * t219 * t856 * t163 * t1105 * t110 * t2703 * t1966 + 0.9e1 * t1423 * t777 * t2719 * t1532 - 0.16128e5 * t1382 * t219 * t759 * params->b_PBE * t163 * t491 * t81 * t2719 * t1540 + 0.162e3 * t1527 * t1528 * t358 * t1531 - 0.290304e6 * t2738 * t1542;
  t2745 = my_piecewise3(t2, 0, t2422 + t2467 + t2506 + t2548 + t2589 + t2628 + t2667 + t2741);
  tv4rho3sigma0 = 0.2e1 * t2745;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t2749 = t777 * t33 * t495;
  t2759 = t867 * t447;
  t2787 = t219 * t21;
  t2788 = t865 * t170 * t2787;
  t2841 = -0.18579456e8 * t1382 * t219 * t759 * t878 * t2749 + 0.20736e5 * t1381 * t866 * t1553 * t871 * t1383 * t2749 + 0.501645312e9 * t2693 * t877 * t2759 * t1559 - 0.334430208e9 * t1537 * t866 * t163 * t867 * t358 * t1559 + 0.373248e6 * t1552 * t1553 * t806 * t1556 * t433 * params->ax * t45 * t19 * t358 - 0.373248e6 * t1555 * t1556 * t759 * params->ax * t45 * t19 * t447 + 0.4514807808e10 * t2788 * t1154 * t866 * t163 * t2759 * t358 - 0.3359232e7 * t865 * t866 * t1553 * t163 * t2787 * t759 * t358 * t447 - 0.4514807808e10 * t876 * t2020 * t866 * t1585 * t761 + 0.2519424e7 * t870 * t1570 * t1155 * t761 + 0.2239488e7 * t1549 * t1564 - 0.2239488e7 * t1549 * t1572 + 0.1679616e7 * t870 * t1435 * t1563 + 0.839808e6 * t870 * t825 * t434 * t645 - 0.1679616e7 * t870 * t872 * t427 * t1571 - 0.1504935936e10 * t1581 * t1593 + 0.1128701952e10 * t876 * t1584 * t1585 * t787 - 0.839808e6 * t870 * t1570 * t760 * t787 + 0.3009871872e10 * t1575 * t1587 - 0.2006581248e10 * t1575 * t1593;
  t2867 = t358 * t358;
  t2873 = t23 * t8;
  t2904 = -0.752467968e9 * t876 * t1590 * t1591 * t645 + 0.2257403904e10 * t1578 * t1587 - 0.1504935936e10 * t1578 * t1593 + 0.2257403904e10 * t1581 * t1587 + 0.186624e6 * t1555 * t427 * t16 * t433 * t1559 - 0.83607552e8 * t2683 * t1596 - 0.167215104e9 * t2668 * t1596 - 0.167215104e9 * t2738 * t1596 + 0.93312e5 * t1396 * t866 * t1554 * t1560 - 0.752467968e9 * t876 * t760 * t866 * t2867 * t867 - 0.167215104e9 * t2873 * t841 * t879 + 0.1119744e7 * t1549 * t1567 + 0.419904e6 * t870 * t872 * t1490 - 0.1003290624e10 * t1548 * t1431 * t879 - 0.1003290624e10 * t1548 * t1450 * t879 - 0.376233984e9 * t865 * t2512 * t879 - 0.752467968e9 * t865 * t2530 * t879 - 0.376233984e9 * t865 * t2542 * t879 + 0.186624e6 * t2873 * t869 * t873 + 0.839808e6 * t870 * t2867 * t175 * t467;
  t2906 = my_piecewise3(t2, 0, t2841 + t2904);
  tv4rho2sigma20 = 0.2e1 * t2906;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t2911 = t1602 * t31;
  t2916 = t33 * params->ax * t1539;
  t2920 = t865 * t1601;
  t2947 = t1602 * t3;
  t2963 = 0.3265173504e10 * t2920 * t2911 * t1606 * t2787 * t1154 * t3 * t447 - 0.362797056e9 * t800 * t1601 * t2911 * t1607 * t1556 * t759 * t2916 - 0.3265173504e10 * t2920 * t2911 * t871 * t2787 * t759 * t3 * t358 + 0.2925595459584e13 * t2788 * t1154 * t1601 * t871 * t2947 * t358 - 0.3900793946112e13 * t2788 * t2019 * t1601 * t1606 * t2947 * t447 + 0.325066162176e12 * t2693 * t1601 * t1606 * t1602 * t2916 - 0.1088391168e10 * t1605 * t1607 * t427 * t1609 - 0.1451188224e10 * t1548 * t1604 * t1610 + 0.1300264648704e13 * t1575 * t1616 + 0.975198486528e12 * t1578 * t1616 + 0.975198486528e12 * t1581 * t1616;
  t2964 = my_piecewise3(t2, 0, t2963);
  tv4rhosigma30 = 0.2e1 * t2964;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t2965 = t866 * t866;
  t2966 = t867 * t867;
  t2970 = t871 * t871;
  t2984 = my_piecewise3(t2, 0, 0.3761479876608e13 * t865 * t2965 * t2966 * t31 * t2970 * t175 * t218 * t1155 * t33 - 0.3370285969440768e16 * t876 * t2020 * t2965 * t2970 * t2966 * t33);
  tv4sigma40 = 0.2e1 * t2984;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t7, t8, t9, t10;
  double t11, t12, t14, t15, t16, t18, t19, t22;
  double t23, t24, t25, t26, t27, t28, t29, t32;
  double t34, t40, t41, t42, t45, t46, t47, t50;
  double t53, t57, t58, t60, t61, t66, t67, t68;
  double t69, t70, t71, t72, t73, t74, t75, t76;
  double t77, t81, t82, t83, t84, t85, t86, t87;
  double t88, t89, t90, t91, t92, t94, t95, t97;
  double t99, t101, t103, t104, t107, t108, t109, t110;
  double t116, t117, t118, t119, t120, t122, t123, t124;
  double t125, t126, t129, t134, t140, t141, t144, t147;
  double t148, t150, t151, t153, t154, t157, t158, t168;
  double t170, t171, t174, t176, t177, t180, t181, t185;
  double t187, t188, t189, t190, t191, t194, t198, t199;
  double t200, t201, t204, t205, t206, t207, t211, t212;
  double t213, t214, t215, t216, t217, t218, t221, t223;
  double t229, t230, t231, t234, t235, t236, t239, t242;
  double t246, t248, t254, t255, t256, t257, t261, t262;
  double t263, t264, t265, t266, t268, t270, t272, t276;
  double t277, t278, t284, t285, t287, t288, t304, t307;
  double t308, t311, t312, t322, t324, t327, t329, t330;
  double t333, t334, t338, t340, t341, t342, t343, t346;
  double t350, t351, t352, t353, t356, tzk0;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = 0.2e1 <= p->zeta_threshold;
  t3 = POW_1_3(p->zeta_threshold);
  t5 = M_CBRT2;
  t7 = my_piecewise3(t2, t3 * p->zeta_threshold, 0.2e1 * t5);
  t8 = M_CBRT3;
  t9 = t7 * t8;
  t10 = t8 * t8;
  t11 = M_CBRTPI;
  t12 = t11 * t11;
  t14 = t10 / t12;
  t15 = POW_1_3(rho[0]);
  t16 = 0.1e1 / t15;
  t18 = my_piecewise3(t2, t3, t5);
  t19 = 0.1e1 / t18;
  t22 = t14 * p->cam_omega * t16 * t19 / 0.6e1;
  t23 = 0.135e1 <= t22;
  t24 = 0.135e1 < t22;
  t25 = my_piecewise3(t24, t22, 0.135e1);
  t26 = t25 * t25;
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = t27 * t27;
  t32 = t29 * t27;
  t34 = t29 * t26;
  t40 = 0.240888840192e14 * t29 * t28 + 0.19448e5 * t26 - 0.80784e6 * t27 + 0.3055104e8 * t28 - 0.104552448e10 * t29 - 0.90333315072e12 * t32 + 0.3226189824e11 * t34 - 0.429e3;
  t41 = t29 * t29;
  t42 = 0.1e1 / t41;
  t45 = my_piecewise3(t24, 0.135e1, t22);
  t46 = t45 * t45;
  t47 = t46 * t46;
  t50 = 0.32e2 * t47 - 0.16e2 * t46;
  t53 = exp(-0.1e1 / t46 / 0.4e1);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t45;
  t60 = erf(t58 / 0.2e1);
  t61 = t57 * t60;
  t66 = my_piecewise3(t23, t40 * t42 / 0.8671998246912e15, t50 * t53 / 0.3e1 - 0.32e2 / 0.3e1 * t47 - 0.8e1 / 0.3e1 * t61 * t45 + 0.8e1 * t46 + 0.1e1);
  t67 = t9 * t66;
  t68 = p->cam_omega * p->cam_omega;
  t69 = params->ax * t68;
  t70 = t69 * t8;
  t71 = t11 * M_PI;
  t72 = 0.1e1 / t71;
  t73 = t18 * t18;
  t74 = 0.1e1 / t73;
  t75 = t72 * t74;
  t76 = t15 * t15;
  t77 = 0.1e1 / t76;
  t81 = exp(-t70 * t75 * t77 / 0.12e2);
  t82 = params->b_PBE * t81;
  t83 = t82 * sigma[0];
  t84 = t5 * t8;
  t85 = params->kappa + 0.1e1;
  t86 = t22 < 0.5e-1;
  t87 = t73 * t73;
  t88 = M_PI * M_PI;
  t89 = t12 * t88;
  t90 = t87 * t89;
  t91 = t15 * rho[0];
  t92 = t90 * t91;
  t94 = t73 * t71;
  t95 = t8 * t76;
  t97 = t94 * t95 * t68;
  t99 = -0.7e1 * t92 + 0.6e1 * t97;
  t101 = t73 * t18;
  t103 = 0.1e1 / p->cam_omega * t8;
  t104 = t12 * t18;
  t107 = erf(t103 * t104 * t15);
  t108 = t101 * t107;
  t109 = t57 * t88;
  t110 = t108 * t109;
  t116 = t68 * t68;
  t117 = t10 * t116;
  t118 = 0.6e1 * t117;
  t119 = 0.36e2 * t110 * t10 * rho[0] * p->cam_omega + t118 - 0.81e2 * t92 - 0.54e2 * t97;
  t120 = 0.1e1 / t119;
  t122 = 0.1e11 < t22;
  t123 = t88 * t88;
  t124 = t87 * t73;
  t125 = t123 * t124;
  t126 = rho[0] * rho[0];
  t129 = t89 * t8;
  t134 = t71 * t10;
  t140 = t116 * t68;
  t141 = 0.1e1 / t140;
  t144 = t71 * t8;
  t147 = t10 * t68;
  t148 = -0.7e1 / 0.6e1 * t94 * t95 + t147;
  t150 = 0.1e1 / t68;
  t151 = t150 * t10;
  t153 = t151 * t94 * t76;
  t154 = exp(t153);
  t157 = t68 * t148 * t154 - 0.11e2 / 0.6e1 * t97 - t92 - t117;
  t158 = t144 * t157;
  t168 = t94 * t76 * t68;
  t170 = t8 * t116;
  t171 = 0.6e1 * t110 * t8 * rho[0] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t91 - 0.9e1 * t168 + t170;
  t174 = t171 * t154 + 0.6e1 * t168 - t170;
  t176 = 0.1e1 / t174 * t150;
  t177 = t73 * t76 * t176;
  t180 = my_piecewise5(t86, t99 * t120, t122, (0.28e4 * t134 * t76 * t116 * t73 - 0.14e3 * t129 * t91 * t68 * t87 - 0.1863e4 * t125 * t126) * t141 / 0.504e5, t158 * t177 / 0.3e1);
  t181 = t85 * t180;
  t185 = t76 * t126;
  t187 = params->kappa * t185 * t71;
  t188 = 0.27e2 / 0.56e2 * t83 * t84 * t181 + t187;
  t189 = t188 * t91;
  t190 = 0.1e1 / t11;
  t191 = params->b_PBE * t180;
  t194 = sigma[0] * t5 * t8;
  t198 = 0.216e3 * t191 * t81 * t194 + 0.448e3 * t187;
  t199 = 0.1e1 / t198;
  t200 = t190 * t199;
  t201 = t189 * t200;
  t204 = my_piecewise3(t1, 0, -0.168e3 * t67 * t201);
  t205 = rho[1] <= p->dens_threshold;
  t206 = POW_1_3(rho[1]);
  t207 = 0.1e1 / t206;
  t211 = t14 * p->cam_omega * t207 * t19 / 0.6e1;
  t212 = 0.135e1 <= t211;
  t213 = 0.135e1 < t211;
  t214 = my_piecewise3(t213, t211, 0.135e1);
  t215 = t214 * t214;
  t216 = t215 * t215;
  t217 = t216 * t215;
  t218 = t216 * t216;
  t221 = t218 * t216;
  t223 = t218 * t215;
  t229 = 0.240888840192e14 * t218 * t217 + 0.19448e5 * t215 - 0.80784e6 * t216 + 0.3055104e8 * t217 - 0.104552448e10 * t218 - 0.90333315072e12 * t221 + 0.3226189824e11 * t223 - 0.429e3;
  t230 = t218 * t218;
  t231 = 0.1e1 / t230;
  t234 = my_piecewise3(t213, 0.135e1, t211);
  t235 = t234 * t234;
  t236 = t235 * t235;
  t239 = 0.32e2 * t236 - 0.16e2 * t235;
  t242 = exp(-0.1e1 / t235 / 0.4e1);
  t246 = 0.1e1 / t234;
  t248 = erf(t246 / 0.2e1);
  t254 = my_piecewise3(t212, t229 * t231 / 0.8671998246912e15, t239 * t242 / 0.3e1 - 0.32e2 / 0.3e1 * t236 - 0.8e1 / 0.3e1 * t248 * t234 * t57 + 0.8e1 * t235 + 0.1e1);
  t255 = t9 * t254;
  t256 = t206 * t206;
  t257 = 0.1e1 / t256;
  t261 = exp(-t70 * t75 * t257 / 0.12e2);
  t262 = params->b_PBE * t261;
  t263 = t262 * sigma[2];
  t264 = t211 < 0.5e-1;
  t265 = t206 * rho[1];
  t266 = t90 * t265;
  t268 = t8 * t256;
  t270 = t94 * t268 * t68;
  t272 = -0.7e1 * t266 + 0.6e1 * t270;
  t276 = erf(t103 * t104 * t206);
  t277 = t101 * t276;
  t278 = t277 * t109;
  t284 = 0.36e2 * t278 * t10 * rho[1] * p->cam_omega + t118 - 0.81e2 * t266 - 0.54e2 * t270;
  t285 = 0.1e1 / t284;
  t287 = 0.1e11 < t211;
  t288 = rho[1] * rho[1];
  t304 = -0.7e1 / 0.6e1 * t94 * t268 + t147;
  t307 = t151 * t94 * t256;
  t308 = exp(t307);
  t311 = t68 * t304 * t308 - 0.11e2 / 0.6e1 * t270 - t266 - t117;
  t312 = t144 * t311;
  t322 = t94 * t256 * t68;
  t324 = 0.6e1 * t278 * t8 * rho[1] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t265 - 0.9e1 * t322 + t170;
  t327 = t324 * t308 - t170 + 0.6e1 * t322;
  t329 = 0.1e1 / t327 * t150;
  t330 = t73 * t256 * t329;
  t333 = my_piecewise5(t264, t272 * t285, t287, (0.28e4 * t134 * t256 * t116 * t73 - 0.14e3 * t129 * t265 * t68 * t87 - 0.1863e4 * t125 * t288) * t141 / 0.504e5, t312 * t330 / 0.3e1);
  t334 = t85 * t333;
  t338 = t256 * t288;
  t340 = params->kappa * t338 * t71;
  t341 = 0.27e2 / 0.56e2 * t263 * t84 * t334 + t340;
  t342 = t341 * t265;
  t343 = params->b_PBE * t333;
  t346 = sigma[2] * t5 * t8;
  t350 = 0.216e3 * t343 * t261 * t346 + 0.448e3 * t340;
  t351 = 0.1e1 / t350;
  t352 = t190 * t351;
  t353 = t342 * t352;
  t356 = my_piecewise3(t205, 0, -0.168e3 * t255 * t353);
  tzk0 = (t204 + t356) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t7, t8, t9, t10;
  double t11, t12, t14, t15, t16, t18, t19, t22;
  double t23, t24, t25, t26, t27, t28, t29, t32;
  double t34, t40, t41, t42, t45, t46, t47, t50;
  double t53, t57, t58, t60, t61, t66, t67, t68;
  double t69, t70, t71, t72, t73, t74, t75, t76;
  double t77, t81, t82, t83, t84, t85, t86, t87;
  double t88, t89, t90, t91, t92, t94, t95, t97;
  double t99, t101, t103, t104, t107, t108, t109, t110;
  double t116, t117, t118, t119, t120, t122, t123, t124;
  double t125, t126, t129, t134, t140, t141, t144, t147;
  double t148, t150, t151, t153, t154, t157, t158, t168;
  double t170, t171, t174, t176, t177, t180, t181, t185;
  double t187, t188, t189, t190, t191, t194, t198, t199;
  double t200, t201, t204, t205, t206, t207, t211, t212;
  double t213, t214, t215, t216, t217, t218, t221, t223;
  double t229, t230, t231, t234, t235, t236, t239, t242;
  double t246, t248, t254, t255, t256, t257, t261, t262;
  double t263, t264, t265, t266, t268, t270, t272, t276;
  double t277, t278, t284, t285, t287, t288, t304, t307;
  double t308, t311, t312, t322, t324, t327, t329, t330;
  double t333, t334, t338, t340, t341, t342, t343, t346;
  double t350, t351, t352, t353, t356, tzk0;

  double t360, t361, t362, t366, t367, t370, t371, t374;
  double t377, t386, t390, t391, t395, t396, t397, t399;
  double t401, t404, t405, t406, t410, t417, t418, t425;
  double t426, t427, t429, t430, t431, t435, t437, t439;
  double t441, t443, t444, t445, t447, t452, t456, t473;
  double t478, t479, t485, t486, t489, t493, t494, t495;
  double t496, t497, t502, t509, t511, t514, t516, t520;
  double t521, t522, t526, t527, t532, t534, t535, t536;
  double t539, t540, t543, t544, t545, t546, t547, t548;
  double t552, t553, t556, t557, t561, t562, t563, tvrho0;
  double t567, t568, t569, t573, t574, t577, t578, t581;
  double t584, t593, t597, t598, t602, t603, t604, t606;
  double t608, t611, t612, t613, t617, t625, t626, t629;
  double t630, t632, t633, t637, t639, t641, t643, t645;
  double t646, t647, t649, t656, t676, t677, t683, t684;
  double t687, t691, t692, t693, t694, t695, t705, t707;
  double t710, t712, t716, t717, t718, t722, t723, t728;
  double t730, t731, t732, t735, t736, t739, t740, t741;
  double t742, t743, t744, t748, t751, t752, t756, t757;
  double t758, tvrho1, t762, t765, t766, t767, t771, t772;
  double t773, t776, tvsigma0, tvsigma1, t782, t783, t784, t788;
  double t789, t790, t793, tvsigma2;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = 0.2e1 <= p->zeta_threshold;
  t3 = POW_1_3(p->zeta_threshold);
  t5 = M_CBRT2;
  t7 = my_piecewise3(t2, t3 * p->zeta_threshold, 0.2e1 * t5);
  t8 = M_CBRT3;
  t9 = t7 * t8;
  t10 = t8 * t8;
  t11 = M_CBRTPI;
  t12 = t11 * t11;
  t14 = t10 / t12;
  t15 = POW_1_3(rho[0]);
  t16 = 0.1e1 / t15;
  t18 = my_piecewise3(t2, t3, t5);
  t19 = 0.1e1 / t18;
  t22 = t14 * p->cam_omega * t16 * t19 / 0.6e1;
  t23 = 0.135e1 <= t22;
  t24 = 0.135e1 < t22;
  t25 = my_piecewise3(t24, t22, 0.135e1);
  t26 = t25 * t25;
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = t27 * t27;
  t32 = t29 * t27;
  t34 = t29 * t26;
  t40 = 0.240888840192e14 * t29 * t28 + 0.19448e5 * t26 - 0.80784e6 * t27 + 0.3055104e8 * t28 - 0.104552448e10 * t29 - 0.90333315072e12 * t32 + 0.3226189824e11 * t34 - 0.429e3;
  t41 = t29 * t29;
  t42 = 0.1e1 / t41;
  t45 = my_piecewise3(t24, 0.135e1, t22);
  t46 = t45 * t45;
  t47 = t46 * t46;
  t50 = 0.32e2 * t47 - 0.16e2 * t46;
  t53 = exp(-0.1e1 / t46 / 0.4e1);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t45;
  t60 = erf(t58 / 0.2e1);
  t61 = t57 * t60;
  t66 = my_piecewise3(t23, t40 * t42 / 0.8671998246912e15, t50 * t53 / 0.3e1 - 0.32e2 / 0.3e1 * t47 - 0.8e1 / 0.3e1 * t61 * t45 + 0.8e1 * t46 + 0.1e1);
  t67 = t9 * t66;
  t68 = p->cam_omega * p->cam_omega;
  t69 = params->ax * t68;
  t70 = t69 * t8;
  t71 = t11 * M_PI;
  t72 = 0.1e1 / t71;
  t73 = t18 * t18;
  t74 = 0.1e1 / t73;
  t75 = t72 * t74;
  t76 = t15 * t15;
  t77 = 0.1e1 / t76;
  t81 = exp(-t70 * t75 * t77 / 0.12e2);
  t82 = params->b_PBE * t81;
  t83 = t82 * sigma[0];
  t84 = t5 * t8;
  t85 = params->kappa + 0.1e1;
  t86 = t22 < 0.5e-1;
  t87 = t73 * t73;
  t88 = M_PI * M_PI;
  t89 = t12 * t88;
  t90 = t87 * t89;
  t91 = t15 * rho[0];
  t92 = t90 * t91;
  t94 = t73 * t71;
  t95 = t8 * t76;
  t97 = t94 * t95 * t68;
  t99 = -0.7e1 * t92 + 0.6e1 * t97;
  t101 = t73 * t18;
  t103 = 0.1e1 / p->cam_omega * t8;
  t104 = t12 * t18;
  t107 = erf(t103 * t104 * t15);
  t108 = t101 * t107;
  t109 = t57 * t88;
  t110 = t108 * t109;
  t116 = t68 * t68;
  t117 = t10 * t116;
  t118 = 0.6e1 * t117;
  t119 = 0.36e2 * t110 * t10 * rho[0] * p->cam_omega + t118 - 0.81e2 * t92 - 0.54e2 * t97;
  t120 = 0.1e1 / t119;
  t122 = 0.1e11 < t22;
  t123 = t88 * t88;
  t124 = t87 * t73;
  t125 = t123 * t124;
  t126 = rho[0] * rho[0];
  t129 = t89 * t8;
  t134 = t71 * t10;
  t140 = t116 * t68;
  t141 = 0.1e1 / t140;
  t144 = t71 * t8;
  t147 = t10 * t68;
  t148 = -0.7e1 / 0.6e1 * t94 * t95 + t147;
  t150 = 0.1e1 / t68;
  t151 = t150 * t10;
  t153 = t151 * t94 * t76;
  t154 = exp(t153);
  t157 = t68 * t148 * t154 - 0.11e2 / 0.6e1 * t97 - t92 - t117;
  t158 = t144 * t157;
  t168 = t94 * t76 * t68;
  t170 = t8 * t116;
  t171 = 0.6e1 * t110 * t8 * rho[0] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t91 - 0.9e1 * t168 + t170;
  t174 = t171 * t154 + 0.6e1 * t168 - t170;
  t176 = 0.1e1 / t174 * t150;
  t177 = t73 * t76 * t176;
  t180 = my_piecewise5(t86, t99 * t120, t122, (0.28e4 * t134 * t76 * t116 * t73 - 0.14e3 * t129 * t91 * t68 * t87 - 0.1863e4 * t125 * t126) * t141 / 0.504e5, t158 * t177 / 0.3e1);
  t181 = t85 * t180;
  t185 = t76 * t126;
  t187 = params->kappa * t185 * t71;
  t188 = 0.27e2 / 0.56e2 * t83 * t84 * t181 + t187;
  t189 = t188 * t91;
  t190 = 0.1e1 / t11;
  t191 = params->b_PBE * t180;
  t194 = sigma[0] * t5 * t8;
  t198 = 0.216e3 * t191 * t81 * t194 + 0.448e3 * t187;
  t199 = 0.1e1 / t198;
  t200 = t190 * t199;
  t201 = t189 * t200;
  t204 = my_piecewise3(t1, 0, -0.168e3 * t67 * t201);
  t205 = rho[1] <= p->dens_threshold;
  t206 = POW_1_3(rho[1]);
  t207 = 0.1e1 / t206;
  t211 = t14 * p->cam_omega * t207 * t19 / 0.6e1;
  t212 = 0.135e1 <= t211;
  t213 = 0.135e1 < t211;
  t214 = my_piecewise3(t213, t211, 0.135e1);
  t215 = t214 * t214;
  t216 = t215 * t215;
  t217 = t216 * t215;
  t218 = t216 * t216;
  t221 = t218 * t216;
  t223 = t218 * t215;
  t229 = 0.240888840192e14 * t218 * t217 + 0.19448e5 * t215 - 0.80784e6 * t216 + 0.3055104e8 * t217 - 0.104552448e10 * t218 - 0.90333315072e12 * t221 + 0.3226189824e11 * t223 - 0.429e3;
  t230 = t218 * t218;
  t231 = 0.1e1 / t230;
  t234 = my_piecewise3(t213, 0.135e1, t211);
  t235 = t234 * t234;
  t236 = t235 * t235;
  t239 = 0.32e2 * t236 - 0.16e2 * t235;
  t242 = exp(-0.1e1 / t235 / 0.4e1);
  t246 = 0.1e1 / t234;
  t248 = erf(t246 / 0.2e1);
  t254 = my_piecewise3(t212, t229 * t231 / 0.8671998246912e15, t239 * t242 / 0.3e1 - 0.32e2 / 0.3e1 * t236 - 0.8e1 / 0.3e1 * t248 * t234 * t57 + 0.8e1 * t235 + 0.1e1);
  t255 = t9 * t254;
  t256 = t206 * t206;
  t257 = 0.1e1 / t256;
  t261 = exp(-t70 * t75 * t257 / 0.12e2);
  t262 = params->b_PBE * t261;
  t263 = t262 * sigma[2];
  t264 = t211 < 0.5e-1;
  t265 = t206 * rho[1];
  t266 = t90 * t265;
  t268 = t8 * t256;
  t270 = t94 * t268 * t68;
  t272 = -0.7e1 * t266 + 0.6e1 * t270;
  t276 = erf(t103 * t104 * t206);
  t277 = t101 * t276;
  t278 = t277 * t109;
  t284 = 0.36e2 * t278 * t10 * rho[1] * p->cam_omega + t118 - 0.81e2 * t266 - 0.54e2 * t270;
  t285 = 0.1e1 / t284;
  t287 = 0.1e11 < t211;
  t288 = rho[1] * rho[1];
  t304 = -0.7e1 / 0.6e1 * t94 * t268 + t147;
  t307 = t151 * t94 * t256;
  t308 = exp(t307);
  t311 = t68 * t304 * t308 - 0.11e2 / 0.6e1 * t270 - t266 - t117;
  t312 = t144 * t311;
  t322 = t94 * t256 * t68;
  t324 = 0.6e1 * t278 * t8 * rho[1] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t265 - 0.9e1 * t322 + t170;
  t327 = t324 * t308 - t170 + 0.6e1 * t322;
  t329 = 0.1e1 / t327 * t150;
  t330 = t73 * t256 * t329;
  t333 = my_piecewise5(t264, t272 * t285, t287, (0.28e4 * t134 * t256 * t116 * t73 - 0.14e3 * t129 * t265 * t68 * t87 - 0.1863e4 * t125 * t288) * t141 / 0.504e5, t312 * t330 / 0.3e1);
  t334 = t85 * t333;
  t338 = t256 * t288;
  t340 = params->kappa * t338 * t71;
  t341 = 0.27e2 / 0.56e2 * t263 * t84 * t334 + t340;
  t342 = t341 * t265;
  t343 = params->b_PBE * t333;
  t346 = sigma[2] * t5 * t8;
  t350 = 0.216e3 * t343 * t261 * t346 + 0.448e3 * t340;
  t351 = 0.1e1 / t350;
  t352 = t190 * t351;
  t353 = t342 * t352;
  t356 = my_piecewise3(t205, 0, -0.168e3 * t255 * t353);
  tzk0 = (t204 + t356) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t360 = t27 * t25;
  t361 = t29 * t360;
  t362 = 0.1e1 / t91;
  t366 = t14 * p->cam_omega * t362 * t19 / 0.18e2;
  t367 = my_piecewise3(t24, -t366, 0);
  t370 = t26 * t25;
  t371 = t29 * t370;
  t374 = t29 * t25;
  t377 = t27 * t370;
  t386 = 0.38896e5 * t25 * t367 + 0.18330624e9 * t360 * t367 + 0.3372443762688e15 * t361 * t367 - 0.323136e7 * t370 * t367 - 0.1083999780864e14 * t371 * t367 + 0.3226189824e12 * t374 * t367 - 0.836419584e10 * t377 * t367;
  t390 = 0.1e1 / t41 / t25;
  t391 = t40 * t390;
  t395 = t46 * t45;
  t396 = my_piecewise3(t24, 0, -t366);
  t397 = t395 * t396;
  t399 = t45 * t396;
  t401 = 0.128e3 * t397 - 0.32e2 * t399;
  t404 = 0.1e1 / t395;
  t405 = t50 * t404;
  t406 = t396 * t53;
  t410 = t53 * t58;
  t417 = my_piecewise3(t23, t386 * t42 / 0.8671998246912e15 - t391 * t367 / 0.541999890432e14, t401 * t53 / 0.3e1 + t405 * t406 / 0.6e1 - 0.128e3 / 0.3e1 * t397 + 0.8e1 / 0.3e1 * t410 * t396 - 0.8e1 / 0.3e1 * t61 * t396 + 0.16e2 * t399);
  t418 = t9 * t417;
  t425 = params->b_PBE * params->ax * t68 * t10 * t72 * t74;
  t426 = t76 * rho[0];
  t427 = 0.1e1 / t426;
  t429 = t427 * t81 * sigma[0];
  t430 = t5 * t85;
  t431 = t430 * t180;
  t435 = t90 * t15;
  t437 = t8 * t16;
  t439 = t94 * t437 * t68;
  t441 = -0.28e2 / 0.3e1 * t435 + 0.4e1 * t439;
  t443 = t119 * t119;
  t444 = 0.1e1 / t443;
  t445 = t99 * t444;
  t447 = exp(-t153);
  t452 = t109 * t10 * p->cam_omega;
  t456 = 0.72e2 * t90 * t447 * t15 + 0.36e2 * t108 * t452 - 0.108e3 * t435 - 0.36e2 * t439;
  t473 = t68 * t71 * t73;
  t478 = t148 * t10 * t71;
  t479 = t73 * t16;
  t485 = -0.7e1 / 0.9e1 * t473 * t437 * t154 + 0.2e1 / 0.3e1 * t478 * t479 * t154 - 0.11e2 / 0.9e1 * t439 - 0.4e1 / 0.3e1 * t435;
  t486 = t144 * t485;
  t489 = t479 * t176;
  t493 = t144 * t157 * t73;
  t494 = t174 * t174;
  t495 = 0.1e1 / t494;
  t496 = t76 * t495;
  t497 = t447 * t10;
  t502 = t109 * t8 * p->cam_omega;
  t509 = t94 * t16 * t68;
  t511 = -0.6e1 * t90 * t10 * t15 + 0.4e1 * t90 * t497 * t15 + 0.6e1 * t108 * t502 - 0.6e1 * t509;
  t514 = t171 * t150 * t10;
  t516 = t94 * t16 * t154;
  t520 = t511 * t154 + 0.2e1 / 0.3e1 * t514 * t516 + 0.4e1 * t509;
  t521 = t150 * t520;
  t522 = t496 * t521;
  t526 = my_piecewise5(t86, t441 * t120 - t445 * t456, t122, (-0.3726e4 * t125 * rho[0] - 0.56e3 / 0.3e1 * t129 * t15 * t68 * t87 + 0.56e4 / 0.3e1 * t134 * t16 * t116 * t73) * t141 / 0.504e5, t486 * t177 / 0.3e1 + 0.2e1 / 0.9e1 * t158 * t489 - t493 * t522 / 0.3e1);
  t527 = t85 * t526;
  t532 = params->kappa * t426 * t71;
  t534 = 0.3e1 / 0.112e3 * t425 * t429 * t431 + 0.27e2 / 0.56e2 * t83 * t84 * t527 + 0.8e1 / 0.3e1 * t532;
  t535 = t534 * t91;
  t536 = t535 * t200;
  t539 = t188 * t15;
  t540 = t539 * t200;
  t543 = t66 * t188;
  t544 = t9 * t543;
  t545 = t91 * t190;
  t546 = t198 * t198;
  t547 = 0.1e1 / t546;
  t548 = params->b_PBE * t526;
  t552 = t69 * t10;
  t553 = t191 * t552;
  t556 = t81 * sigma[0] * t5;
  t557 = t75 * t427 * t556;
  t561 = 0.216e3 * t548 * t81 * t194 + 0.12e2 * t553 * t557 + 0.3584e4 / 0.3e1 * t532;
  t562 = t547 * t561;
  t563 = t545 * t562;
  tvrho0 = my_piecewise3(t1, 0, -0.168e3 * t418 * t201 - 0.168e3 * t67 * t536 - 0.224e3 * t67 * t540 + 0.168e3 * t544 * t563);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t567 = t216 * t214;
  t568 = t218 * t567;
  t569 = 0.1e1 / t265;
  t573 = t14 * p->cam_omega * t569 * t19 / 0.18e2;
  t574 = my_piecewise3(t213, -t573, 0);
  t577 = t215 * t214;
  t578 = t218 * t577;
  t581 = t218 * t214;
  t584 = t216 * t577;
  t593 = 0.38896e5 * t214 * t574 + 0.18330624e9 * t567 * t574 + 0.3372443762688e15 * t568 * t574 - 0.323136e7 * t577 * t574 - 0.1083999780864e14 * t578 * t574 + 0.3226189824e12 * t581 * t574 - 0.836419584e10 * t584 * t574;
  t597 = 0.1e1 / t230 / t214;
  t598 = t229 * t597;
  t602 = t235 * t234;
  t603 = my_piecewise3(t213, 0, -t573);
  t604 = t602 * t603;
  t606 = t234 * t603;
  t608 = 0.128e3 * t604 - 0.32e2 * t606;
  t611 = 0.1e1 / t602;
  t612 = t239 * t611;
  t613 = t603 * t242;
  t617 = t242 * t246;
  t625 = my_piecewise3(t212, t593 * t231 / 0.8671998246912e15 - t598 * t574 / 0.541999890432e14, t608 * t242 / 0.3e1 + t612 * t613 / 0.6e1 - 0.128e3 / 0.3e1 * t604 + 0.8e1 / 0.3e1 * t617 * t603 - 0.8e1 / 0.3e1 * t248 * t603 * t57 + 0.16e2 * t606);
  t626 = t9 * t625;
  t629 = t256 * rho[1];
  t630 = 0.1e1 / t629;
  t632 = t630 * t261 * sigma[2];
  t633 = t430 * t333;
  t637 = t90 * t206;
  t639 = t8 * t207;
  t641 = t94 * t639 * t68;
  t643 = -0.28e2 / 0.3e1 * t637 + 0.4e1 * t641;
  t645 = t284 * t284;
  t646 = 0.1e1 / t645;
  t647 = t272 * t646;
  t649 = exp(-t307);
  t656 = 0.72e2 * t90 * t649 * t206 + 0.36e2 * t277 * t452 - 0.108e3 * t637 - 0.36e2 * t641;
  t676 = t304 * t10 * t71;
  t677 = t73 * t207;
  t683 = -0.7e1 / 0.9e1 * t473 * t639 * t308 + 0.2e1 / 0.3e1 * t676 * t677 * t308 - 0.11e2 / 0.9e1 * t641 - 0.4e1 / 0.3e1 * t637;
  t684 = t144 * t683;
  t687 = t677 * t329;
  t691 = t144 * t311 * t73;
  t692 = t327 * t327;
  t693 = 0.1e1 / t692;
  t694 = t256 * t693;
  t695 = t649 * t10;
  t705 = t94 * t207 * t68;
  t707 = -0.6e1 * t90 * t10 * t206 + 0.4e1 * t90 * t695 * t206 + 0.6e1 * t277 * t502 - 0.6e1 * t705;
  t710 = t324 * t150 * t10;
  t712 = t94 * t207 * t308;
  t716 = t707 * t308 + 0.2e1 / 0.3e1 * t710 * t712 + 0.4e1 * t705;
  t717 = t150 * t716;
  t718 = t694 * t717;
  t722 = my_piecewise5(t264, t643 * t285 - t647 * t656, t287, (-0.3726e4 * t125 * rho[1] - 0.56e3 / 0.3e1 * t129 * t206 * t68 * t87 + 0.56e4 / 0.3e1 * t134 * t207 * t116 * t73) * t141 / 0.504e5, t684 * t330 / 0.3e1 + 0.2e1 / 0.9e1 * t312 * t687 - t691 * t718 / 0.3e1);
  t723 = t85 * t722;
  t728 = params->kappa * t629 * t71;
  t730 = 0.3e1 / 0.112e3 * t425 * t632 * t633 + 0.27e2 / 0.56e2 * t263 * t84 * t723 + 0.8e1 / 0.3e1 * t728;
  t731 = t730 * t265;
  t732 = t731 * t352;
  t735 = t341 * t206;
  t736 = t735 * t352;
  t739 = t254 * t341;
  t740 = t9 * t739;
  t741 = t265 * t190;
  t742 = t350 * t350;
  t743 = 0.1e1 / t742;
  t744 = params->b_PBE * t722;
  t748 = t343 * t552;
  t751 = t261 * sigma[2] * t5;
  t752 = t75 * t630 * t751;
  t756 = 0.216e3 * t744 * t261 * t346 + 0.12e2 * t748 * t752 + 0.3584e4 / 0.3e1 * t728;
  t757 = t743 * t756;
  t758 = t741 * t757;
  tvrho1 = my_piecewise3(t205, 0, -0.168e3 * t255 * t732 - 0.224e3 * t255 * t736 - 0.168e3 * t626 * t353 + 0.168e3 * t740 * t758);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t762 = t7 * t10;
  t765 = t762 * t66 * params->b_PBE * t81;
  t766 = t545 * t199;
  t767 = t431 * t766;
  t771 = t762 * t543 * t91;
  t772 = t190 * t547;
  t773 = t772 * params->b_PBE;
  t776 = t773 * t180 * t81 * t5;
  tvsigma0 = my_piecewise3(t1, 0, -0.81e2 * t765 * t767 + 0.36288e5 * t771 * t776);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t782 = t762 * t254 * params->b_PBE * t261;
  t783 = t741 * t351;
  t784 = t633 * t783;
  t788 = t762 * t739 * t265;
  t789 = t190 * t743;
  t790 = t789 * params->b_PBE;
  t793 = t790 * t333 * t261 * t5;
  tvsigma2 = my_piecewise3(t205, 0, -0.81e2 * t782 * t784 + 0.36288e5 * t788 * t793);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t7, t8, t9, t10;
  double t11, t12, t14, t15, t16, t18, t19, t22;
  double t23, t24, t25, t26, t27, t28, t29, t32;
  double t34, t40, t41, t42, t45, t46, t47, t50;
  double t53, t57, t58, t60, t61, t66, t67, t68;
  double t69, t70, t71, t72, t73, t74, t75, t76;
  double t77, t81, t82, t83, t84, t85, t86, t87;
  double t88, t89, t90, t91, t92, t94, t95, t97;
  double t99, t101, t103, t104, t107, t108, t109, t110;
  double t116, t117, t118, t119, t120, t122, t123, t124;
  double t125, t126, t129, t134, t140, t141, t144, t147;
  double t148, t150, t151, t153, t154, t157, t158, t168;
  double t170, t171, t174, t176, t177, t180, t181, t185;
  double t187, t188, t189, t190, t191, t194, t198, t199;
  double t200, t201, t204, t205, t206, t207, t211, t212;
  double t213, t214, t215, t216, t217, t218, t221, t223;
  double t229, t230, t231, t234, t235, t236, t239, t242;
  double t246, t248, t254, t255, t256, t257, t261, t262;
  double t263, t264, t265, t266, t268, t270, t272, t276;
  double t277, t278, t284, t285, t287, t288, t304, t307;
  double t308, t311, t312, t322, t324, t327, t329, t330;
  double t333, t334, t338, t340, t341, t342, t343, t346;
  double t350, t351, t352, t353, t356, tzk0;

  double t360, t361, t362, t366, t367, t370, t371, t374;
  double t377, t386, t390, t391, t395, t396, t397, t399;
  double t401, t404, t405, t406, t410, t417, t418, t425;
  double t426, t427, t429, t430, t431, t435, t437, t439;
  double t441, t443, t444, t445, t447, t452, t456, t473;
  double t478, t479, t485, t486, t489, t493, t494, t495;
  double t496, t497, t502, t509, t511, t514, t516, t520;
  double t521, t522, t526, t527, t532, t534, t535, t536;
  double t539, t540, t543, t544, t545, t546, t547, t548;
  double t552, t553, t556, t557, t561, t562, t563, tvrho0;
  double t567, t568, t569, t573, t574, t577, t578, t581;
  double t584, t593, t597, t598, t602, t603, t604, t606;
  double t608, t611, t612, t613, t617, t625, t626, t629;
  double t630, t632, t633, t637, t639, t641, t643, t645;
  double t646, t647, t649, t656, t676, t677, t683, t684;
  double t687, t691, t692, t693, t694, t695, t705, t707;
  double t710, t712, t716, t717, t718, t722, t723, t728;
  double t730, t731, t732, t735, t736, t739, t740, t741;
  double t742, t743, t744, t748, t751, t752, t756, t757;
  double t758, tvrho1, t762, t765, t766, t767, t771, t772;
  double t773, t776, tvsigma0, tvsigma1, t782, t783, t784, t788;
  double t789, t790, t793, tvsigma2;

  double t797, t801, t805, t806, t832, t835, t839, t840;
  double t846, t847, t849, t850, t853, t855, t858, t861;
  double t862, t863, t866, t870, t871, t885, t886, t887;
  double t894, t895, t898, t900, t904, t906, t908, t910;
  double t911, t913, t915, t919, t923, t925, t927, t929;
  double t931, t935, t936, t937, t948, t951, t967, t969;
  double t974, t976, t982, t983, t989, t992, t995, t996;
  double t1000, t1001, t1002, t1003, t1004, t1007, t1011, t1018;
  double t1020, t1023, t1027, t1030, t1032, t1036, t1037, t1038;
  double t1042, t1043, t1048, t1050, t1051, t1052, t1055, t1056;
  double t1059, t1060, t1063, t1064, t1067, t1068, t1072, t1073;
  double t1074, t1075, t1078, t1082, t1086, t1089, t1090, t1091;
  double t1093, t1097, t1098, t1099, t1102, tv2rho20, tv2rho21, t1103;
  double t1107, t1111, t1112, t1138, t1141, t1145, t1146, t1152;
  double t1153, t1155, t1156, t1159, t1161, t1164, t1167, t1168;
  double t1169, t1172, t1176, t1177, t1192, t1193, t1194, t1201;
  double t1202, t1205, t1207, t1211, t1213, t1215, t1219, t1223;
  double t1225, t1227, t1229, t1231, t1235, t1236, t1237, t1248;
  double t1266, t1268, t1273, t1275, t1281, t1282, t1288, t1291;
  double t1294, t1295, t1299, t1300, t1301, t1302, t1303, t1309;
  double t1316, t1318, t1321, t1325, t1329, t1333, t1334, t1335;
  double t1339, t1340, t1345, t1347, t1348, t1349, t1352, t1353;
  double t1356, t1357, t1360, t1361, t1364, t1365, t1369, t1370;
  double t1371, t1372, t1375, t1379, t1383, t1386, t1388, t1392;
  double t1393, t1394, t1397, tv2rho22, t1400, t1403, t1404, t1406;
  double t1407, t1408, t1410, t1412, t1413, t1416, t1419, t1420;
  double t1423, t1424, t1425, t1426, t1427, t1428, t1432, t1436;
  double t1440, t1443, t1444, t1445, t1446, t1447, t1448, t1449;
  double t1454, t1457, t1458, t1459, t1460, t1462, t1463, t1464;
  double t1467, tv2rhosigma0, tv2rhosigma1, tv2rhosigma2, tv2rhosigma3, tv2rhosigma4, t1470, t1473;
  double t1474, t1475, t1477, t1479, t1480, t1483, t1486, t1487;
  double t1490, t1491, t1492, t1493, t1494, t1495, t1499, t1503;
  double t1507, t1510, t1511, t1512, t1513, t1514, t1515, t1516;
  double t1521, t1524, t1525, t1526, t1527, t1529, t1530, t1533;
  double tv2rhosigma5, t1534, t1535, t1537, t1538, t1539, t1540, t1541;
  double t1542, t1543, t1546, t1547, t1548, t1549, t1550, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1554, t1556, t1557, t1558;
  double t1559, t1560, t1561, t1564, t1565, t1566, t1567, t1568;
  double tv2sigma25;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = 0.2e1 <= p->zeta_threshold;
  t3 = POW_1_3(p->zeta_threshold);
  t5 = M_CBRT2;
  t7 = my_piecewise3(t2, t3 * p->zeta_threshold, 0.2e1 * t5);
  t8 = M_CBRT3;
  t9 = t7 * t8;
  t10 = t8 * t8;
  t11 = M_CBRTPI;
  t12 = t11 * t11;
  t14 = t10 / t12;
  t15 = POW_1_3(rho[0]);
  t16 = 0.1e1 / t15;
  t18 = my_piecewise3(t2, t3, t5);
  t19 = 0.1e1 / t18;
  t22 = t14 * p->cam_omega * t16 * t19 / 0.6e1;
  t23 = 0.135e1 <= t22;
  t24 = 0.135e1 < t22;
  t25 = my_piecewise3(t24, t22, 0.135e1);
  t26 = t25 * t25;
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = t27 * t27;
  t32 = t29 * t27;
  t34 = t29 * t26;
  t40 = 0.240888840192e14 * t29 * t28 + 0.19448e5 * t26 - 0.80784e6 * t27 + 0.3055104e8 * t28 - 0.104552448e10 * t29 - 0.90333315072e12 * t32 + 0.3226189824e11 * t34 - 0.429e3;
  t41 = t29 * t29;
  t42 = 0.1e1 / t41;
  t45 = my_piecewise3(t24, 0.135e1, t22);
  t46 = t45 * t45;
  t47 = t46 * t46;
  t50 = 0.32e2 * t47 - 0.16e2 * t46;
  t53 = exp(-0.1e1 / t46 / 0.4e1);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t45;
  t60 = erf(t58 / 0.2e1);
  t61 = t57 * t60;
  t66 = my_piecewise3(t23, t40 * t42 / 0.8671998246912e15, t50 * t53 / 0.3e1 - 0.32e2 / 0.3e1 * t47 - 0.8e1 / 0.3e1 * t61 * t45 + 0.8e1 * t46 + 0.1e1);
  t67 = t9 * t66;
  t68 = p->cam_omega * p->cam_omega;
  t69 = params->ax * t68;
  t70 = t69 * t8;
  t71 = t11 * M_PI;
  t72 = 0.1e1 / t71;
  t73 = t18 * t18;
  t74 = 0.1e1 / t73;
  t75 = t72 * t74;
  t76 = t15 * t15;
  t77 = 0.1e1 / t76;
  t81 = exp(-t70 * t75 * t77 / 0.12e2);
  t82 = params->b_PBE * t81;
  t83 = t82 * sigma[0];
  t84 = t5 * t8;
  t85 = params->kappa + 0.1e1;
  t86 = t22 < 0.5e-1;
  t87 = t73 * t73;
  t88 = M_PI * M_PI;
  t89 = t12 * t88;
  t90 = t87 * t89;
  t91 = t15 * rho[0];
  t92 = t90 * t91;
  t94 = t73 * t71;
  t95 = t8 * t76;
  t97 = t94 * t95 * t68;
  t99 = -0.7e1 * t92 + 0.6e1 * t97;
  t101 = t73 * t18;
  t103 = 0.1e1 / p->cam_omega * t8;
  t104 = t12 * t18;
  t107 = erf(t103 * t104 * t15);
  t108 = t101 * t107;
  t109 = t57 * t88;
  t110 = t108 * t109;
  t116 = t68 * t68;
  t117 = t10 * t116;
  t118 = 0.6e1 * t117;
  t119 = 0.36e2 * t110 * t10 * rho[0] * p->cam_omega + t118 - 0.81e2 * t92 - 0.54e2 * t97;
  t120 = 0.1e1 / t119;
  t122 = 0.1e11 < t22;
  t123 = t88 * t88;
  t124 = t87 * t73;
  t125 = t123 * t124;
  t126 = rho[0] * rho[0];
  t129 = t89 * t8;
  t134 = t71 * t10;
  t140 = t116 * t68;
  t141 = 0.1e1 / t140;
  t144 = t71 * t8;
  t147 = t10 * t68;
  t148 = -0.7e1 / 0.6e1 * t94 * t95 + t147;
  t150 = 0.1e1 / t68;
  t151 = t150 * t10;
  t153 = t151 * t94 * t76;
  t154 = exp(t153);
  t157 = t68 * t148 * t154 - 0.11e2 / 0.6e1 * t97 - t92 - t117;
  t158 = t144 * t157;
  t168 = t94 * t76 * t68;
  t170 = t8 * t116;
  t171 = 0.6e1 * t110 * t8 * rho[0] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t91 - 0.9e1 * t168 + t170;
  t174 = t171 * t154 + 0.6e1 * t168 - t170;
  t176 = 0.1e1 / t174 * t150;
  t177 = t73 * t76 * t176;
  t180 = my_piecewise5(t86, t99 * t120, t122, (0.28e4 * t134 * t76 * t116 * t73 - 0.14e3 * t129 * t91 * t68 * t87 - 0.1863e4 * t125 * t126) * t141 / 0.504e5, t158 * t177 / 0.3e1);
  t181 = t85 * t180;
  t185 = t76 * t126;
  t187 = params->kappa * t185 * t71;
  t188 = 0.27e2 / 0.56e2 * t83 * t84 * t181 + t187;
  t189 = t188 * t91;
  t190 = 0.1e1 / t11;
  t191 = params->b_PBE * t180;
  t194 = sigma[0] * t5 * t8;
  t198 = 0.216e3 * t191 * t81 * t194 + 0.448e3 * t187;
  t199 = 0.1e1 / t198;
  t200 = t190 * t199;
  t201 = t189 * t200;
  t204 = my_piecewise3(t1, 0, -0.168e3 * t67 * t201);
  t205 = rho[1] <= p->dens_threshold;
  t206 = POW_1_3(rho[1]);
  t207 = 0.1e1 / t206;
  t211 = t14 * p->cam_omega * t207 * t19 / 0.6e1;
  t212 = 0.135e1 <= t211;
  t213 = 0.135e1 < t211;
  t214 = my_piecewise3(t213, t211, 0.135e1);
  t215 = t214 * t214;
  t216 = t215 * t215;
  t217 = t216 * t215;
  t218 = t216 * t216;
  t221 = t218 * t216;
  t223 = t218 * t215;
  t229 = 0.240888840192e14 * t218 * t217 + 0.19448e5 * t215 - 0.80784e6 * t216 + 0.3055104e8 * t217 - 0.104552448e10 * t218 - 0.90333315072e12 * t221 + 0.3226189824e11 * t223 - 0.429e3;
  t230 = t218 * t218;
  t231 = 0.1e1 / t230;
  t234 = my_piecewise3(t213, 0.135e1, t211);
  t235 = t234 * t234;
  t236 = t235 * t235;
  t239 = 0.32e2 * t236 - 0.16e2 * t235;
  t242 = exp(-0.1e1 / t235 / 0.4e1);
  t246 = 0.1e1 / t234;
  t248 = erf(t246 / 0.2e1);
  t254 = my_piecewise3(t212, t229 * t231 / 0.8671998246912e15, t239 * t242 / 0.3e1 - 0.32e2 / 0.3e1 * t236 - 0.8e1 / 0.3e1 * t248 * t234 * t57 + 0.8e1 * t235 + 0.1e1);
  t255 = t9 * t254;
  t256 = t206 * t206;
  t257 = 0.1e1 / t256;
  t261 = exp(-t70 * t75 * t257 / 0.12e2);
  t262 = params->b_PBE * t261;
  t263 = t262 * sigma[2];
  t264 = t211 < 0.5e-1;
  t265 = t206 * rho[1];
  t266 = t90 * t265;
  t268 = t8 * t256;
  t270 = t94 * t268 * t68;
  t272 = -0.7e1 * t266 + 0.6e1 * t270;
  t276 = erf(t103 * t104 * t206);
  t277 = t101 * t276;
  t278 = t277 * t109;
  t284 = 0.36e2 * t278 * t10 * rho[1] * p->cam_omega + t118 - 0.81e2 * t266 - 0.54e2 * t270;
  t285 = 0.1e1 / t284;
  t287 = 0.1e11 < t211;
  t288 = rho[1] * rho[1];
  t304 = -0.7e1 / 0.6e1 * t94 * t268 + t147;
  t307 = t151 * t94 * t256;
  t308 = exp(t307);
  t311 = t68 * t304 * t308 - 0.11e2 / 0.6e1 * t270 - t266 - t117;
  t312 = t144 * t311;
  t322 = t94 * t256 * t68;
  t324 = 0.6e1 * t278 * t8 * rho[1] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t265 - 0.9e1 * t322 + t170;
  t327 = t324 * t308 - t170 + 0.6e1 * t322;
  t329 = 0.1e1 / t327 * t150;
  t330 = t73 * t256 * t329;
  t333 = my_piecewise5(t264, t272 * t285, t287, (0.28e4 * t134 * t256 * t116 * t73 - 0.14e3 * t129 * t265 * t68 * t87 - 0.1863e4 * t125 * t288) * t141 / 0.504e5, t312 * t330 / 0.3e1);
  t334 = t85 * t333;
  t338 = t256 * t288;
  t340 = params->kappa * t338 * t71;
  t341 = 0.27e2 / 0.56e2 * t263 * t84 * t334 + t340;
  t342 = t341 * t265;
  t343 = params->b_PBE * t333;
  t346 = sigma[2] * t5 * t8;
  t350 = 0.216e3 * t343 * t261 * t346 + 0.448e3 * t340;
  t351 = 0.1e1 / t350;
  t352 = t190 * t351;
  t353 = t342 * t352;
  t356 = my_piecewise3(t205, 0, -0.168e3 * t255 * t353);
  tzk0 = (t204 + t356) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t360 = t27 * t25;
  t361 = t29 * t360;
  t362 = 0.1e1 / t91;
  t366 = t14 * p->cam_omega * t362 * t19 / 0.18e2;
  t367 = my_piecewise3(t24, -t366, 0);
  t370 = t26 * t25;
  t371 = t29 * t370;
  t374 = t29 * t25;
  t377 = t27 * t370;
  t386 = 0.38896e5 * t25 * t367 + 0.18330624e9 * t360 * t367 + 0.3372443762688e15 * t361 * t367 - 0.323136e7 * t370 * t367 - 0.1083999780864e14 * t371 * t367 + 0.3226189824e12 * t374 * t367 - 0.836419584e10 * t377 * t367;
  t390 = 0.1e1 / t41 / t25;
  t391 = t40 * t390;
  t395 = t46 * t45;
  t396 = my_piecewise3(t24, 0, -t366);
  t397 = t395 * t396;
  t399 = t45 * t396;
  t401 = 0.128e3 * t397 - 0.32e2 * t399;
  t404 = 0.1e1 / t395;
  t405 = t50 * t404;
  t406 = t396 * t53;
  t410 = t53 * t58;
  t417 = my_piecewise3(t23, t386 * t42 / 0.8671998246912e15 - t391 * t367 / 0.541999890432e14, t401 * t53 / 0.3e1 + t405 * t406 / 0.6e1 - 0.128e3 / 0.3e1 * t397 + 0.8e1 / 0.3e1 * t410 * t396 - 0.8e1 / 0.3e1 * t61 * t396 + 0.16e2 * t399);
  t418 = t9 * t417;
  t425 = params->b_PBE * params->ax * t68 * t10 * t72 * t74;
  t426 = t76 * rho[0];
  t427 = 0.1e1 / t426;
  t429 = t427 * t81 * sigma[0];
  t430 = t5 * t85;
  t431 = t430 * t180;
  t435 = t90 * t15;
  t437 = t8 * t16;
  t439 = t94 * t437 * t68;
  t441 = -0.28e2 / 0.3e1 * t435 + 0.4e1 * t439;
  t443 = t119 * t119;
  t444 = 0.1e1 / t443;
  t445 = t99 * t444;
  t447 = exp(-t153);
  t452 = t109 * t10 * p->cam_omega;
  t456 = 0.72e2 * t90 * t447 * t15 + 0.36e2 * t108 * t452 - 0.108e3 * t435 - 0.36e2 * t439;
  t473 = t68 * t71 * t73;
  t478 = t148 * t10 * t71;
  t479 = t73 * t16;
  t485 = -0.7e1 / 0.9e1 * t473 * t437 * t154 + 0.2e1 / 0.3e1 * t478 * t479 * t154 - 0.11e2 / 0.9e1 * t439 - 0.4e1 / 0.3e1 * t435;
  t486 = t144 * t485;
  t489 = t479 * t176;
  t493 = t144 * t157 * t73;
  t494 = t174 * t174;
  t495 = 0.1e1 / t494;
  t496 = t76 * t495;
  t497 = t447 * t10;
  t502 = t109 * t8 * p->cam_omega;
  t509 = t94 * t16 * t68;
  t511 = -0.6e1 * t90 * t10 * t15 + 0.4e1 * t90 * t497 * t15 + 0.6e1 * t108 * t502 - 0.6e1 * t509;
  t514 = t171 * t150 * t10;
  t516 = t94 * t16 * t154;
  t520 = t511 * t154 + 0.2e1 / 0.3e1 * t514 * t516 + 0.4e1 * t509;
  t521 = t150 * t520;
  t522 = t496 * t521;
  t526 = my_piecewise5(t86, t441 * t120 - t445 * t456, t122, (-0.3726e4 * t125 * rho[0] - 0.56e3 / 0.3e1 * t129 * t15 * t68 * t87 + 0.56e4 / 0.3e1 * t134 * t16 * t116 * t73) * t141 / 0.504e5, t486 * t177 / 0.3e1 + 0.2e1 / 0.9e1 * t158 * t489 - t493 * t522 / 0.3e1);
  t527 = t85 * t526;
  t532 = params->kappa * t426 * t71;
  t534 = 0.3e1 / 0.112e3 * t425 * t429 * t431 + 0.27e2 / 0.56e2 * t83 * t84 * t527 + 0.8e1 / 0.3e1 * t532;
  t535 = t534 * t91;
  t536 = t535 * t200;
  t539 = t188 * t15;
  t540 = t539 * t200;
  t543 = t66 * t188;
  t544 = t9 * t543;
  t545 = t91 * t190;
  t546 = t198 * t198;
  t547 = 0.1e1 / t546;
  t548 = params->b_PBE * t526;
  t552 = t69 * t10;
  t553 = t191 * t552;
  t556 = t81 * sigma[0] * t5;
  t557 = t75 * t427 * t556;
  t561 = 0.216e3 * t548 * t81 * t194 + 0.12e2 * t553 * t557 + 0.3584e4 / 0.3e1 * t532;
  t562 = t547 * t561;
  t563 = t545 * t562;
  tvrho0 = my_piecewise3(t1, 0, -0.168e3 * t418 * t201 - 0.168e3 * t67 * t536 - 0.224e3 * t67 * t540 + 0.168e3 * t544 * t563);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t567 = t216 * t214;
  t568 = t218 * t567;
  t569 = 0.1e1 / t265;
  t573 = t14 * p->cam_omega * t569 * t19 / 0.18e2;
  t574 = my_piecewise3(t213, -t573, 0);
  t577 = t215 * t214;
  t578 = t218 * t577;
  t581 = t218 * t214;
  t584 = t216 * t577;
  t593 = 0.38896e5 * t214 * t574 + 0.18330624e9 * t567 * t574 + 0.3372443762688e15 * t568 * t574 - 0.323136e7 * t577 * t574 - 0.1083999780864e14 * t578 * t574 + 0.3226189824e12 * t581 * t574 - 0.836419584e10 * t584 * t574;
  t597 = 0.1e1 / t230 / t214;
  t598 = t229 * t597;
  t602 = t235 * t234;
  t603 = my_piecewise3(t213, 0, -t573);
  t604 = t602 * t603;
  t606 = t234 * t603;
  t608 = 0.128e3 * t604 - 0.32e2 * t606;
  t611 = 0.1e1 / t602;
  t612 = t239 * t611;
  t613 = t603 * t242;
  t617 = t242 * t246;
  t625 = my_piecewise3(t212, t593 * t231 / 0.8671998246912e15 - t598 * t574 / 0.541999890432e14, t608 * t242 / 0.3e1 + t612 * t613 / 0.6e1 - 0.128e3 / 0.3e1 * t604 + 0.8e1 / 0.3e1 * t617 * t603 - 0.8e1 / 0.3e1 * t248 * t603 * t57 + 0.16e2 * t606);
  t626 = t9 * t625;
  t629 = t256 * rho[1];
  t630 = 0.1e1 / t629;
  t632 = t630 * t261 * sigma[2];
  t633 = t430 * t333;
  t637 = t90 * t206;
  t639 = t8 * t207;
  t641 = t94 * t639 * t68;
  t643 = -0.28e2 / 0.3e1 * t637 + 0.4e1 * t641;
  t645 = t284 * t284;
  t646 = 0.1e1 / t645;
  t647 = t272 * t646;
  t649 = exp(-t307);
  t656 = 0.72e2 * t90 * t649 * t206 + 0.36e2 * t277 * t452 - 0.108e3 * t637 - 0.36e2 * t641;
  t676 = t304 * t10 * t71;
  t677 = t73 * t207;
  t683 = -0.7e1 / 0.9e1 * t473 * t639 * t308 + 0.2e1 / 0.3e1 * t676 * t677 * t308 - 0.11e2 / 0.9e1 * t641 - 0.4e1 / 0.3e1 * t637;
  t684 = t144 * t683;
  t687 = t677 * t329;
  t691 = t144 * t311 * t73;
  t692 = t327 * t327;
  t693 = 0.1e1 / t692;
  t694 = t256 * t693;
  t695 = t649 * t10;
  t705 = t94 * t207 * t68;
  t707 = -0.6e1 * t90 * t10 * t206 + 0.4e1 * t90 * t695 * t206 + 0.6e1 * t277 * t502 - 0.6e1 * t705;
  t710 = t324 * t150 * t10;
  t712 = t94 * t207 * t308;
  t716 = t707 * t308 + 0.2e1 / 0.3e1 * t710 * t712 + 0.4e1 * t705;
  t717 = t150 * t716;
  t718 = t694 * t717;
  t722 = my_piecewise5(t264, t643 * t285 - t647 * t656, t287, (-0.3726e4 * t125 * rho[1] - 0.56e3 / 0.3e1 * t129 * t206 * t68 * t87 + 0.56e4 / 0.3e1 * t134 * t207 * t116 * t73) * t141 / 0.504e5, t684 * t330 / 0.3e1 + 0.2e1 / 0.9e1 * t312 * t687 - t691 * t718 / 0.3e1);
  t723 = t85 * t722;
  t728 = params->kappa * t629 * t71;
  t730 = 0.3e1 / 0.112e3 * t425 * t632 * t633 + 0.27e2 / 0.56e2 * t263 * t84 * t723 + 0.8e1 / 0.3e1 * t728;
  t731 = t730 * t265;
  t732 = t731 * t352;
  t735 = t341 * t206;
  t736 = t735 * t352;
  t739 = t254 * t341;
  t740 = t9 * t739;
  t741 = t265 * t190;
  t742 = t350 * t350;
  t743 = 0.1e1 / t742;
  t744 = params->b_PBE * t722;
  t748 = t343 * t552;
  t751 = t261 * sigma[2] * t5;
  t752 = t75 * t630 * t751;
  t756 = 0.216e3 * t744 * t261 * t346 + 0.12e2 * t748 * t752 + 0.3584e4 / 0.3e1 * t728;
  t757 = t743 * t756;
  t758 = t741 * t757;
  tvrho1 = my_piecewise3(t205, 0, -0.168e3 * t255 * t732 - 0.224e3 * t255 * t736 - 0.168e3 * t626 * t353 + 0.168e3 * t740 * t758);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t762 = t7 * t10;
  t765 = t762 * t66 * params->b_PBE * t81;
  t766 = t545 * t199;
  t767 = t431 * t766;
  t771 = t762 * t543 * t91;
  t772 = t190 * t547;
  t773 = t772 * params->b_PBE;
  t776 = t773 * t180 * t81 * t5;
  tvsigma0 = my_piecewise3(t1, 0, -0.81e2 * t765 * t767 + 0.36288e5 * t771 * t776);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t782 = t762 * t254 * params->b_PBE * t261;
  t783 = t741 * t351;
  t784 = t633 * t783;
  t788 = t762 * t739 * t265;
  t789 = t190 * t743;
  t790 = t789 * params->b_PBE;
  t793 = t790 * t333 * t261 * t5;
  tvsigma2 = my_piecewise3(t205, 0, -0.81e2 * t782 * t784 + 0.36288e5 * t788 * t793);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t797 = t367 * t367;
  t801 = 0.1e1 / t15 / t126;
  t805 = 0.2e1 / 0.27e2 * t14 * p->cam_omega * t801 * t19;
  t806 = my_piecewise3(t24, t805, 0);
  t832 = 0.38896e5 * t25 * t806 - 0.969408e7 * t26 * t797 + 0.9165312e9 * t27 * t797 - 0.5854937088e11 * t28 * t797 + 0.29035708416e13 * t29 * t797 + 0.43841768914944e16 * t32 * t797 - 0.11923997589504e15 * t34 * t797 + 0.18330624e9 * t360 * t806 + 0.3372443762688e15 * t361 * t806 - 0.323136e7 * t370 * t806 - 0.1083999780864e14 * t371 * t806 + 0.3226189824e12 * t374 * t806 - 0.836419584e10 * t377 * t806 + 0.38896e5 * t797;
  t835 = t386 * t390;
  t839 = 0.1e1 / t41 / t26;
  t840 = t40 * t839;
  t846 = t396 * t396;
  t847 = t46 * t846;
  t849 = my_piecewise3(t24, 0, t805);
  t850 = t395 * t849;
  t853 = t45 * t849;
  t855 = 0.384e3 * t847 + 0.128e3 * t850 - 0.32e2 * t846 - 0.32e2 * t853;
  t858 = t401 * t404;
  t861 = 0.1e1 / t47;
  t862 = t50 * t861;
  t863 = t846 * t53;
  t866 = t849 * t53;
  t870 = 0.1e1 / t47 / t46;
  t871 = t50 * t870;
  t885 = t855 * t53 / 0.3e1 + t858 * t406 / 0.3e1 - t862 * t863 / 0.2e1 + t405 * t866 / 0.6e1 + t871 * t863 / 0.12e2 - 0.128e3 * t847 - 0.128e3 / 0.3e1 * t850 + 0.4e1 / 0.3e1 * t861 * t846 * t53 + 0.8e1 / 0.3e1 * t410 * t849 - 0.8e1 / 0.3e1 * t61 * t849 + 0.16e2 * t846 + 0.16e2 * t853;
  t886 = my_piecewise3(t23, t832 * t42 / 0.8671998246912e15 - t835 * t367 / 0.270999945216e14 + t840 * t797 / 0.31882346496e13 - t391 * t806 / 0.541999890432e14, t885);
  t887 = t9 * t886;
  t894 = t417 * t188;
  t895 = t9 * t894;
  t898 = 0.1e1 / t185;
  t900 = t898 * t81 * sigma[0];
  t904 = params->ax * params->ax;
  t906 = 0.1e1 / t89;
  t908 = 0.1e1 / t87;
  t910 = params->b_PBE * t904 * t116 * t906 * t908;
  t911 = t126 * rho[0];
  t913 = 0.1e1 / t15 / t911;
  t915 = t913 * t81 * sigma[0];
  t919 = t430 * t526;
  t923 = t90 * t77;
  t925 = t8 * t362;
  t927 = t94 * t925 * t68;
  t929 = -0.28e2 / 0.9e1 * t923 - 0.4e1 / 0.3e1 * t927;
  t931 = t441 * t444;
  t935 = 0.1e1 / t443 / t119;
  t936 = t99 * t935;
  t937 = t456 * t456;
  t948 = -0.48e2 * t125 * t151 * t447 + 0.96e2 * t90 * t447 * t77 - 0.36e2 * t923 + 0.12e2 * t927;
  t951 = 0.3726e4 * t125;
  t967 = t90 * t77 * t154;
  t969 = t73 * t362;
  t974 = t148 * t8 * t89;
  t976 = t150 * t154;
  t982 = 0.7e1 / 0.27e2 * t473 * t925 * t154 - 0.28e2 / 0.9e1 * t967 - 0.2e1 / 0.9e1 * t478 * t969 * t154 + 0.4e1 / 0.3e1 * t974 * t87 * t77 * t976 + 0.11e2 / 0.27e2 * t927 - 0.4e1 / 0.9e1 * t923;
  t983 = t144 * t982;
  t989 = t144 * t485 * t73;
  t992 = t969 * t176;
  t995 = t16 * t495;
  t996 = t995 * t521;
  t1000 = 0.1e1 / t494 / t174;
  t1001 = t76 * t1000;
  t1002 = t520 * t520;
  t1003 = t150 * t1002;
  t1004 = t1001 * t1003;
  t1007 = t150 * t8;
  t1011 = t497 * t77;
  t1018 = t94 * t362 * t68;
  t1020 = -0.8e1 * t125 * t1007 * t447 + 0.16e2 / 0.3e1 * t90 * t1011 - 0.2e1 * t90 * t10 * t77 + 0.2e1 * t1018;
  t1023 = t511 * t150 * t10;
  t1027 = t94 * t362 * t154;
  t1030 = 0.1e1 / t116;
  t1032 = t171 * t1030 * t8;
  t1036 = t1020 * t154 + 0.4e1 / 0.3e1 * t1023 * t516 - 0.2e1 / 0.9e1 * t514 * t1027 + 0.4e1 / 0.3e1 * t1032 * t967 - 0.4e1 / 0.3e1 * t1018;
  t1037 = t150 * t1036;
  t1038 = t496 * t1037;
  t1042 = my_piecewise5(t86, t929 * t120 - t445 * t948 - 0.2e1 * t931 * t456 + 0.2e1 * t936 * t937, t122, (-t951 - 0.56e3 / 0.9e1 * t129 * t77 * t68 * t87 - 0.56e4 / 0.9e1 * t134 * t362 * t116 * t73) * t141 / 0.504e5, t983 * t177 / 0.3e1 + 0.4e1 / 0.9e1 * t486 * t489 - 0.2e1 / 0.3e1 * t989 * t522 - 0.2e1 / 0.27e2 * t158 * t992 - 0.4e1 / 0.9e1 * t493 * t996 + 0.2e1 / 0.3e1 * t493 * t1004 - t493 * t1038 / 0.3e1);
  t1043 = t85 * t1042;
  t1048 = params->kappa * t76 * t71;
  t1050 = -0.5e1 / 0.112e3 * t425 * t900 * t431 + t910 * t915 * t431 / 0.224e3 + 0.3e1 / 0.56e2 * t425 * t429 * t919 + 0.27e2 / 0.56e2 * t83 * t84 * t1043 + 0.4e2 / 0.9e1 * t1048;
  t1051 = t1050 * t91;
  t1052 = t1051 * t200;
  t1055 = t534 * t15;
  t1056 = t1055 * t200;
  t1059 = t66 * t534;
  t1060 = t9 * t1059;
  t1063 = t188 * t77;
  t1064 = t1063 * t200;
  t1067 = t15 * t190;
  t1068 = t1067 * t562;
  t1072 = 0.1e1 / t546 / t198;
  t1073 = t561 * t561;
  t1074 = t1072 * t1073;
  t1075 = t545 * t1074;
  t1078 = params->b_PBE * t1042;
  t1082 = t548 * t552;
  t1086 = t75 * t898 * t556;
  t1089 = t904 * t116;
  t1090 = t1089 * t906;
  t1091 = t191 * t1090;
  t1093 = t908 * t913 * t556;
  t1097 = 0.216e3 * t1078 * t81 * t194 + 0.24e2 * t1082 * t557 - 0.2e2 * t553 * t1086 + 0.2e1 * t1091 * t1093 + 0.1792e5 / 0.9e1 * t1048;
  t1098 = t547 * t1097;
  t1099 = t545 * t1098;
  t1102 = -0.168e3 * t887 * t201 - 0.336e3 * t418 * t536 - 0.448e3 * t418 * t540 + 0.336e3 * t895 * t563 - 0.168e3 * t67 * t1052 - 0.448e3 * t67 * t1056 + 0.336e3 * t1060 * t563 - 0.224e3 / 0.3e1 * t67 * t1064 + 0.448e3 * t544 * t1068 - 0.336e3 * t544 * t1075 + 0.168e3 * t544 * t1099;
  tv2rho20 = my_piecewise3(t1, 0, t1102);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  tv2rho21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1103 = t574 * t574;
  t1107 = 0.1e1 / t206 / t288;
  t1111 = 0.2e1 / 0.27e2 * t14 * p->cam_omega * t1107 * t19;
  t1112 = my_piecewise3(t213, t1111, 0);
  t1138 = -0.969408e7 * t215 * t1103 + 0.9165312e9 * t216 * t1103 - 0.5854937088e11 * t217 * t1103 + 0.29035708416e13 * t218 * t1103 + 0.43841768914944e16 * t221 * t1103 - 0.11923997589504e15 * t223 * t1103 + 0.38896e5 * t214 * t1112 + 0.18330624e9 * t567 * t1112 + 0.3372443762688e15 * t568 * t1112 - 0.323136e7 * t577 * t1112 - 0.1083999780864e14 * t578 * t1112 + 0.3226189824e12 * t581 * t1112 - 0.836419584e10 * t584 * t1112 + 0.38896e5 * t1103;
  t1141 = t593 * t597;
  t1145 = 0.1e1 / t230 / t215;
  t1146 = t229 * t1145;
  t1152 = t603 * t603;
  t1153 = t235 * t1152;
  t1155 = my_piecewise3(t213, 0, t1111);
  t1156 = t602 * t1155;
  t1159 = t234 * t1155;
  t1161 = 0.384e3 * t1153 + 0.128e3 * t1156 - 0.32e2 * t1152 - 0.32e2 * t1159;
  t1164 = t608 * t611;
  t1167 = 0.1e1 / t236;
  t1168 = t239 * t1167;
  t1169 = t1152 * t242;
  t1172 = t1155 * t242;
  t1176 = 0.1e1 / t236 / t235;
  t1177 = t239 * t1176;
  t1192 = t1161 * t242 / 0.3e1 + t1164 * t613 / 0.3e1 - t1168 * t1169 / 0.2e1 + t612 * t1172 / 0.6e1 + t1177 * t1169 / 0.12e2 - 0.128e3 * t1153 - 0.128e3 / 0.3e1 * t1156 + 0.4e1 / 0.3e1 * t1167 * t1152 * t242 + 0.8e1 / 0.3e1 * t617 * t1155 - 0.8e1 / 0.3e1 * t248 * t1155 * t57 + 0.16e2 * t1152 + 0.16e2 * t1159;
  t1193 = my_piecewise3(t212, t1138 * t231 / 0.8671998246912e15 - t1141 * t574 / 0.270999945216e14 + t1146 * t1103 / 0.31882346496e13 - t598 * t1112 / 0.541999890432e14, t1192);
  t1194 = t9 * t1193;
  t1201 = t625 * t341;
  t1202 = t9 * t1201;
  t1205 = 0.1e1 / t338;
  t1207 = t1205 * t261 * sigma[2];
  t1211 = t288 * rho[1];
  t1213 = 0.1e1 / t206 / t1211;
  t1215 = t1213 * t261 * sigma[2];
  t1219 = t430 * t722;
  t1223 = t90 * t257;
  t1225 = t8 * t569;
  t1227 = t94 * t1225 * t68;
  t1229 = -0.28e2 / 0.9e1 * t1223 - 0.4e1 / 0.3e1 * t1227;
  t1231 = t643 * t646;
  t1235 = 0.1e1 / t645 / t284;
  t1236 = t272 * t1235;
  t1237 = t656 * t656;
  t1248 = -0.48e2 * t125 * t151 * t649 + 0.96e2 * t90 * t649 * t257 - 0.36e2 * t1223 + 0.12e2 * t1227;
  t1266 = t90 * t257 * t308;
  t1268 = t73 * t569;
  t1273 = t304 * t8 * t89;
  t1275 = t150 * t308;
  t1281 = 0.7e1 / 0.27e2 * t473 * t1225 * t308 - 0.28e2 / 0.9e1 * t1266 - 0.2e1 / 0.9e1 * t676 * t1268 * t308 + 0.4e1 / 0.3e1 * t1273 * t87 * t257 * t1275 + 0.11e2 / 0.27e2 * t1227 - 0.4e1 / 0.9e1 * t1223;
  t1282 = t144 * t1281;
  t1288 = t144 * t683 * t73;
  t1291 = t1268 * t329;
  t1294 = t207 * t693;
  t1295 = t1294 * t717;
  t1299 = 0.1e1 / t692 / t327;
  t1300 = t256 * t1299;
  t1301 = t716 * t716;
  t1302 = t150 * t1301;
  t1303 = t1300 * t1302;
  t1309 = t695 * t257;
  t1316 = t94 * t569 * t68;
  t1318 = -0.8e1 * t125 * t1007 * t649 + 0.16e2 / 0.3e1 * t90 * t1309 - 0.2e1 * t90 * t10 * t257 + 0.2e1 * t1316;
  t1321 = t707 * t150 * t10;
  t1325 = t94 * t569 * t308;
  t1329 = t324 * t1030 * t8;
  t1333 = t1318 * t308 + 0.4e1 / 0.3e1 * t1321 * t712 - 0.2e1 / 0.9e1 * t710 * t1325 + 0.4e1 / 0.3e1 * t1329 * t1266 - 0.4e1 / 0.3e1 * t1316;
  t1334 = t150 * t1333;
  t1335 = t694 * t1334;
  t1339 = my_piecewise5(t264, t1229 * t285 - 0.2e1 * t1231 * t656 + 0.2e1 * t1236 * t1237 - t647 * t1248, t287, (-t951 - 0.56e3 / 0.9e1 * t129 * t257 * t68 * t87 - 0.56e4 / 0.9e1 * t134 * t569 * t116 * t73) * t141 / 0.504e5, t1282 * t330 / 0.3e1 + 0.4e1 / 0.9e1 * t684 * t687 - 0.2e1 / 0.3e1 * t1288 * t718 - 0.2e1 / 0.27e2 * t312 * t1291 - 0.4e1 / 0.9e1 * t691 * t1295 + 0.2e1 / 0.3e1 * t691 * t1303 - t691 * t1335 / 0.3e1);
  t1340 = t85 * t1339;
  t1345 = params->kappa * t256 * t71;
  t1347 = -0.5e1 / 0.112e3 * t425 * t1207 * t633 + t910 * t1215 * t633 / 0.224e3 + 0.3e1 / 0.56e2 * t425 * t632 * t1219 + 0.27e2 / 0.56e2 * t263 * t84 * t1340 + 0.4e2 / 0.9e1 * t1345;
  t1348 = t1347 * t265;
  t1349 = t1348 * t352;
  t1352 = t730 * t206;
  t1353 = t1352 * t352;
  t1356 = t254 * t730;
  t1357 = t9 * t1356;
  t1360 = t341 * t257;
  t1361 = t1360 * t352;
  t1364 = t206 * t190;
  t1365 = t1364 * t757;
  t1369 = 0.1e1 / t742 / t350;
  t1370 = t756 * t756;
  t1371 = t1369 * t1370;
  t1372 = t741 * t1371;
  t1375 = params->b_PBE * t1339;
  t1379 = t744 * t552;
  t1383 = t75 * t1205 * t751;
  t1386 = t343 * t1090;
  t1388 = t908 * t1213 * t751;
  t1392 = 0.216e3 * t1375 * t261 * t346 + 0.24e2 * t1379 * t752 - 0.2e2 * t748 * t1383 + 0.2e1 * t1386 * t1388 + 0.1792e5 / 0.9e1 * t1345;
  t1393 = t743 * t1392;
  t1394 = t741 * t1393;
  t1397 = -0.168e3 * t1194 * t353 - 0.336e3 * t626 * t732 - 0.448e3 * t626 * t736 + 0.336e3 * t1202 * t758 - 0.168e3 * t255 * t1349 - 0.448e3 * t255 * t1353 + 0.336e3 * t1357 * t758 - 0.224e3 / 0.3e1 * t255 * t1361 + 0.448e3 * t740 * t1365 - 0.336e3 * t740 * t1372 + 0.168e3 * t740 * t1394;
  tv2rho22 = my_piecewise3(t205, 0, t1397);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1400 = t762 * t417 * params->b_PBE * t81;
  t1403 = t7 * t66;
  t1404 = t1403 * params->b_PBE;
  t1406 = 0.1e1 / t12 / M_PI;
  t1407 = t69 * t1406;
  t1408 = t1404 * t1407;
  t1410 = t74 * t16 * t81;
  t1412 = t430 * t180 * t199;
  t1413 = t1410 * t1412;
  t1416 = t919 * t766;
  t1419 = t1067 * t199;
  t1420 = t431 * t1419;
  t1423 = t762 * t66;
  t1424 = t82 * t5;
  t1425 = t1423 * t1424;
  t1426 = t181 * t91;
  t1427 = t772 * t561;
  t1428 = t1426 * t1427;
  t1432 = t762 * t894 * t91;
  t1436 = t762 * t1059 * t91;
  t1440 = t762 * t543 * t15;
  t1443 = t189 * t190;
  t1444 = t1423 * t1443;
  t1445 = t1072 * params->b_PBE;
  t1446 = t1445 * t180;
  t1447 = t81 * t5;
  t1448 = t1447 * t561;
  t1449 = t1446 * t1448;
  t1454 = t773 * t526 * t81 * t5;
  t1457 = t1403 * t188;
  t1458 = t16 * t1406;
  t1459 = t1458 * t547;
  t1460 = t1457 * t1459;
  t1462 = t68 * t74;
  t1463 = t1462 * t1447;
  t1464 = t191 * params->ax * t1463;
  t1467 = -0.81e2 * t1400 * t767 - 0.27e2 / 0.2e1 * t1408 * t1413 - 0.81e2 * t765 * t1416 - 0.108e3 * t765 * t1420 + 0.81e2 * t1425 * t1428 + 0.36288e5 * t1432 * t776 + 0.36288e5 * t1436 * t776 + 0.48384e5 * t1440 * t776 - 0.72576e5 * t1444 * t1449 + 0.36288e5 * t771 * t1454 + 0.6048e4 * t1460 * t1464;
  tv2rhosigma0 = my_piecewise3(t1, 0, t1467);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  tv2rhosigma3 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1470 = t762 * t625 * params->b_PBE * t261;
  t1473 = t7 * t254;
  t1474 = t1473 * params->b_PBE;
  t1475 = t1474 * t1407;
  t1477 = t74 * t207 * t261;
  t1479 = t430 * t333 * t351;
  t1480 = t1477 * t1479;
  t1483 = t1219 * t783;
  t1486 = t1364 * t351;
  t1487 = t633 * t1486;
  t1490 = t762 * t254;
  t1491 = t262 * t5;
  t1492 = t1490 * t1491;
  t1493 = t334 * t265;
  t1494 = t789 * t756;
  t1495 = t1493 * t1494;
  t1499 = t762 * t1201 * t265;
  t1503 = t762 * t1356 * t265;
  t1507 = t762 * t739 * t206;
  t1510 = t342 * t190;
  t1511 = t1490 * t1510;
  t1512 = t1369 * params->b_PBE;
  t1513 = t1512 * t333;
  t1514 = t261 * t5;
  t1515 = t1514 * t756;
  t1516 = t1513 * t1515;
  t1521 = t790 * t722 * t261 * t5;
  t1524 = t1473 * t341;
  t1525 = t207 * t1406;
  t1526 = t1525 * t743;
  t1527 = t1524 * t1526;
  t1529 = t1462 * t1514;
  t1530 = t343 * params->ax * t1529;
  t1533 = -0.81e2 * t1470 * t784 - 0.27e2 / 0.2e1 * t1475 * t1480 - 0.81e2 * t782 * t1483 - 0.108e3 * t782 * t1487 + 0.81e2 * t1492 * t1495 + 0.36288e5 * t1499 * t793 + 0.36288e5 * t1503 * t793 + 0.48384e5 * t1507 * t793 - 0.72576e5 * t1511 * t1516 + 0.36288e5 * t788 * t1521 + 0.6048e4 * t1527 * t1530;
  tv2rhosigma5 = my_piecewise3(t205, 0, t1533);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1534 = params->b_PBE * params->b_PBE;
  t1535 = t81 * t81;
  t1537 = t5 * t5;
  t1538 = t1534 * t1535 * t1537;
  t1539 = t1403 * t1538;
  t1540 = t180 * t180;
  t1541 = t85 * t1540;
  t1542 = t545 * t547;
  t1543 = t1541 * t1542;
  t1546 = t1403 * t1443;
  t1547 = t1072 * t1534;
  t1548 = t1540 * t1535;
  t1549 = t1548 * t1537;
  t1550 = t1547 * t1549;
  tv2sigma20 = my_piecewise3(t1, 0, 0.104976e6 * t1539 * t1543 - 0.47029248e8 * t1546 * t1550);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1554 = t261 * t261;
  t1556 = t1534 * t1554 * t1537;
  t1557 = t1473 * t1556;
  t1558 = t333 * t333;
  t1559 = t85 * t1558;
  t1560 = t741 * t743;
  t1561 = t1559 * t1560;
  t1564 = t1473 * t1510;
  t1565 = t1369 * t1534;
  t1566 = t1558 * t1554;
  t1567 = t1566 * t1537;
  t1568 = t1565 * t1567;
  tv2sigma25 = my_piecewise3(t205, 0, 0.104976e6 * t1557 * t1561 - 0.47029248e8 * t1564 * t1568);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t7, t8, t9, t10;
  double t11, t12, t14, t15, t16, t18, t19, t22;
  double t23, t24, t25, t26, t27, t28, t29, t32;
  double t34, t40, t41, t42, t45, t46, t47, t50;
  double t53, t57, t58, t60, t61, t66, t67, t68;
  double t69, t70, t71, t72, t73, t74, t75, t76;
  double t77, t81, t82, t83, t84, t85, t86, t87;
  double t88, t89, t90, t91, t92, t94, t95, t97;
  double t99, t101, t103, t104, t107, t108, t109, t110;
  double t116, t117, t118, t119, t120, t122, t123, t124;
  double t125, t126, t129, t134, t140, t141, t144, t147;
  double t148, t150, t151, t153, t154, t157, t158, t168;
  double t170, t171, t174, t176, t177, t180, t181, t185;
  double t187, t188, t189, t190, t191, t194, t198, t199;
  double t200, t201, t204, t205, t206, t207, t211, t212;
  double t213, t214, t215, t216, t217, t218, t221, t223;
  double t229, t230, t231, t234, t235, t236, t239, t242;
  double t246, t248, t254, t255, t256, t257, t261, t262;
  double t263, t264, t265, t266, t268, t270, t272, t276;
  double t277, t278, t284, t285, t287, t288, t304, t307;
  double t308, t311, t312, t322, t324, t327, t329, t330;
  double t333, t334, t338, t340, t341, t342, t343, t346;
  double t350, t351, t352, t353, t356, tzk0;

  double t360, t361, t362, t366, t367, t370, t371, t374;
  double t377, t386, t390, t391, t395, t396, t397, t399;
  double t401, t404, t405, t406, t410, t417, t418, t425;
  double t426, t427, t429, t430, t431, t435, t437, t439;
  double t441, t443, t444, t445, t447, t452, t456, t473;
  double t478, t479, t485, t486, t489, t493, t494, t495;
  double t496, t497, t502, t509, t511, t514, t516, t520;
  double t521, t522, t526, t527, t532, t534, t535, t536;
  double t539, t540, t543, t544, t545, t546, t547, t548;
  double t552, t553, t556, t557, t561, t562, t563, tvrho0;
  double t567, t568, t569, t573, t574, t577, t578, t581;
  double t584, t593, t597, t598, t602, t603, t604, t606;
  double t608, t611, t612, t613, t617, t625, t626, t629;
  double t630, t632, t633, t637, t639, t641, t643, t645;
  double t646, t647, t649, t656, t676, t677, t683, t684;
  double t687, t691, t692, t693, t694, t695, t705, t707;
  double t710, t712, t716, t717, t718, t722, t723, t728;
  double t730, t731, t732, t735, t736, t739, t740, t741;
  double t742, t743, t744, t748, t751, t752, t756, t757;
  double t758, tvrho1, t762, t765, t766, t767, t771, t772;
  double t773, t776, tvsigma0, tvsigma1, t782, t783, t784, t788;
  double t789, t790, t793, tvsigma2;

  double t797, t801, t805, t806, t832, t835, t839, t840;
  double t846, t847, t849, t850, t853, t855, t858, t861;
  double t862, t863, t866, t870, t871, t885, t886, t887;
  double t894, t895, t898, t900, t904, t906, t908, t910;
  double t911, t913, t915, t919, t923, t925, t927, t929;
  double t931, t935, t936, t937, t948, t951, t967, t969;
  double t974, t976, t982, t983, t989, t992, t995, t996;
  double t1000, t1001, t1002, t1003, t1004, t1007, t1011, t1018;
  double t1020, t1023, t1027, t1030, t1032, t1036, t1037, t1038;
  double t1042, t1043, t1048, t1050, t1051, t1052, t1055, t1056;
  double t1059, t1060, t1063, t1064, t1067, t1068, t1072, t1073;
  double t1074, t1075, t1078, t1082, t1086, t1089, t1090, t1091;
  double t1093, t1097, t1098, t1099, t1102, tv2rho20, tv2rho21, t1103;
  double t1107, t1111, t1112, t1138, t1141, t1145, t1146, t1152;
  double t1153, t1155, t1156, t1159, t1161, t1164, t1167, t1168;
  double t1169, t1172, t1176, t1177, t1192, t1193, t1194, t1201;
  double t1202, t1205, t1207, t1211, t1213, t1215, t1219, t1223;
  double t1225, t1227, t1229, t1231, t1235, t1236, t1237, t1248;
  double t1266, t1268, t1273, t1275, t1281, t1282, t1288, t1291;
  double t1294, t1295, t1299, t1300, t1301, t1302, t1303, t1309;
  double t1316, t1318, t1321, t1325, t1329, t1333, t1334, t1335;
  double t1339, t1340, t1345, t1347, t1348, t1349, t1352, t1353;
  double t1356, t1357, t1360, t1361, t1364, t1365, t1369, t1370;
  double t1371, t1372, t1375, t1379, t1383, t1386, t1388, t1392;
  double t1393, t1394, t1397, tv2rho22, t1400, t1403, t1404, t1406;
  double t1407, t1408, t1410, t1412, t1413, t1416, t1419, t1420;
  double t1423, t1424, t1425, t1426, t1427, t1428, t1432, t1436;
  double t1440, t1443, t1444, t1445, t1446, t1447, t1448, t1449;
  double t1454, t1457, t1458, t1459, t1460, t1462, t1463, t1464;
  double t1467, tv2rhosigma0, tv2rhosigma1, tv2rhosigma2, tv2rhosigma3, tv2rhosigma4, t1470, t1473;
  double t1474, t1475, t1477, t1479, t1480, t1483, t1486, t1487;
  double t1490, t1491, t1492, t1493, t1494, t1495, t1499, t1503;
  double t1507, t1510, t1511, t1512, t1513, t1514, t1515, t1516;
  double t1521, t1524, t1525, t1526, t1527, t1529, t1530, t1533;
  double tv2rhosigma5, t1534, t1535, t1537, t1538, t1539, t1540, t1541;
  double t1542, t1543, t1546, t1547, t1548, t1549, t1550, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1554, t1556, t1557, t1558;
  double t1559, t1560, t1561, t1564, t1565, t1566, t1567, t1568;
  double tv2sigma25;

  double t1573, t1575, t1579, t1581, t1583, t1590, t1592, t1593;
  double t1594, t1595, t1596, t1597, t1599, t1600, t1601, t1602;
  double t1608, t1612, t1614, t1616, t1618, t1620, t1623, t1628;
  double t1629, t1630, t1631, t1634, t1638, t1640, t1641, t1642;
  double t1646, t1647, t1656, t1674, t1677, t1680, t1689, t1696;
  double t1697, t1715, t1717, t1720, t1726, t1730, t1736, t1738;
  double t1743, t1744, t1750, t1757, t1760, t1761, t1764, t1767;
  double t1768, t1769, t1771, t1772, t1775, t1776, t1781, t1782;
  double t1785, t1786, t1792, t1794, t1796, t1801, t1804, t1809;
  double t1814, t1819, t1824, t1829, t1835, t1836, t1849, t1853;
  double t1856, t1859, t1865, t1866, t1875, t1876, t1880, t1885;
  double t1887, t1888, t1890, t1893, t1895, t1896, t1897, t1901;
  double t1905, t1908, t1914, t1917, t1920, t1923, t1926, t1933;
  double t1935, t1937, t1939, t1945, t1947, t1948, t1954, t1958;
  double t1962, t1972, t1973, t1976, t1980, t1985, t1989, t1993;
  double t1996, t1997, t1998, t2001, t2005, t2006, t2007, t2010;
  double t2011, t2016, t2017, t2020, t2021, t2028, t2029, t2034;
  double t2035, t2038, t2041, t2042, t2043, t2044, t2045, t2052;
  double tv3rho30, tv3rho31, tv3rho32, t2055, t2056, t2059, t2062, t2067;
  double t2072, t2077, t2082, t2087, t2093, t2094, t2105, t2111;
  double t2114, t2117, t2123, t2124, t2132, t2133, t2136, t2138;
  double t2139, t2140, t2141, t2145, t2149, t2152, t2157, t2161;
  double t2162, t2165, t2168, t2172, t2177, t2179, t2180, t2192;
  double t2194, t2196, t2198, t2204, t2206, t2207, t2211, t2213;
  double t2217, t2219, t2221, t2228, t2229, t2231, t2232, t2233;
  double t2234, t2240, t2244, t2246, t2248, t2250, t2252, t2255;
  double t2260, t2261, t2262, t2263, t2266, t2273, t2282, t2311;
  double t2313, t2316, t2322, t2326, t2330, t2334, t2336, t2341;
  double t2342, t2346, t2353, t2354, t2357, t2358, t2361, t2368;
  double t2369, t2372, t2373, t2374, t2376, t2377, t2380, t2381;
  double t2389, t2400, t2407, t2408, t2411, t2412, t2418, t2420;
  double t2422, t2436, t2440, t2444, t2447, t2451, t2456, t2460;
  double t2464, t2467, t2470, t2474, t2475, t2476, t2479, t2480;
  double t2485, t2486, t2491, t2492, t2497, t2498, t2503, t2504;
  double t2507, t2510, t2511, t2512, t2513, t2514, t2521, tv3rho33;
  double t2524, t2525, t2528, t2529, t2530, t2534, t2535, t2538;
  double t2539, t2542, t2543, t2546, t2547, t2548, t2552, t2555;
  double t2556, t2558, t2559, t2560, t2561, t2562, t2565, t2567;
  double t2568, t2569, t2570, t2571, t2572, t2574, t2575, t2576;
  double t2580, t2581, t2583, t2584, t2585, t2589, t2590, t2591;
  double t2592, t2593, t2596, t2597, t2598, t2599, t2602, t2603;
  double t2606, t2607, t2614, t2618, t2622, t2627, t2629, t2634;
  double t2639, t2645, t2649, t2653, t2658, t2661, t2662, t2665;
  double t2666, t2669, t2670, t2671, t2674, t2675, t2678, t2679;
  double t2682, t2683, t2686, t2687, t2690, t2693, t2694, t2697;
  double tv3rho2sigma0, tv3rho2sigma1, tv3rho2sigma2, tv3rho2sigma3, tv3rho2sigma4, tv3rho2sigma5, tv3rho2sigma6, tv3rho2sigma7;
  double t2700, t2701, t2704, t2705, t2706, t2709, t2710, t2714;
  double t2715, t2719, t2722, t2723, t2726, t2727, t2728, t2731;
  double t2732, t2734, t2735, t2736, t2737, t2738, t2741, t2742;
  double t2743, t2744, t2745, t2746, t2748, t2749, t2752, t2754;
  double t2755, t2756, t2759, t2760, t2761, t2762, t2766, t2770;
  double t2774, t2777, t2778, t2783, t2788, t2793, t2795, t2803;
  double t2807, t2812, t2817, t2820, t2821, t2824, t2825, t2828;
  double t2829, t2832, t2833, t2836, t2837, t2840, t2841, t2844;
  double t2847, t2848, t2849, t2850, t2853, t2854, t2855, t2858;
  double t2859, t2862, t2863, t2866, tv3rho2sigma8, t2868, t2871, t2872;
  double t2873, t2874, t2876, t2877, t2880, t2881, t2885, t2888;
  double t2889, t2890, t2893, t2896, t2899, t2902, t2903, t2905;
  double t2908, t2910, t2913, t2914, t2915, t2918, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t2919, t2922, t2923, t2924, t2925, t2926, t2929;
  double t2930, t2934, t2937, t2938, t2939, t2942, t2945, t2948;
  double t2951, t2952, t2954, t2957, t2959, t2962, t2963, t2964;
  double t2967, tv3rhosigma211, t2968, t2969, t2971, t2972, t2973, t2974;
  double t2975, t2976, t2979, t2982, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2986, t2988, t2989;
  double t2990, t2991, t2992, t2993, t2996, t2999, tv3sigma39;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = 0.2e1 <= p->zeta_threshold;
  t3 = POW_1_3(p->zeta_threshold);
  t5 = M_CBRT2;
  t7 = my_piecewise3(t2, t3 * p->zeta_threshold, 0.2e1 * t5);
  t8 = M_CBRT3;
  t9 = t7 * t8;
  t10 = t8 * t8;
  t11 = M_CBRTPI;
  t12 = t11 * t11;
  t14 = t10 / t12;
  t15 = POW_1_3(rho[0]);
  t16 = 0.1e1 / t15;
  t18 = my_piecewise3(t2, t3, t5);
  t19 = 0.1e1 / t18;
  t22 = t14 * p->cam_omega * t16 * t19 / 0.6e1;
  t23 = 0.135e1 <= t22;
  t24 = 0.135e1 < t22;
  t25 = my_piecewise3(t24, t22, 0.135e1);
  t26 = t25 * t25;
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = t27 * t27;
  t32 = t29 * t27;
  t34 = t29 * t26;
  t40 = 0.240888840192e14 * t29 * t28 + 0.19448e5 * t26 - 0.80784e6 * t27 + 0.3055104e8 * t28 - 0.104552448e10 * t29 - 0.90333315072e12 * t32 + 0.3226189824e11 * t34 - 0.429e3;
  t41 = t29 * t29;
  t42 = 0.1e1 / t41;
  t45 = my_piecewise3(t24, 0.135e1, t22);
  t46 = t45 * t45;
  t47 = t46 * t46;
  t50 = 0.32e2 * t47 - 0.16e2 * t46;
  t53 = exp(-0.1e1 / t46 / 0.4e1);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t45;
  t60 = erf(t58 / 0.2e1);
  t61 = t57 * t60;
  t66 = my_piecewise3(t23, t40 * t42 / 0.8671998246912e15, t50 * t53 / 0.3e1 - 0.32e2 / 0.3e1 * t47 - 0.8e1 / 0.3e1 * t61 * t45 + 0.8e1 * t46 + 0.1e1);
  t67 = t9 * t66;
  t68 = p->cam_omega * p->cam_omega;
  t69 = params->ax * t68;
  t70 = t69 * t8;
  t71 = t11 * M_PI;
  t72 = 0.1e1 / t71;
  t73 = t18 * t18;
  t74 = 0.1e1 / t73;
  t75 = t72 * t74;
  t76 = t15 * t15;
  t77 = 0.1e1 / t76;
  t81 = exp(-t70 * t75 * t77 / 0.12e2);
  t82 = params->b_PBE * t81;
  t83 = t82 * sigma[0];
  t84 = t5 * t8;
  t85 = params->kappa + 0.1e1;
  t86 = t22 < 0.5e-1;
  t87 = t73 * t73;
  t88 = M_PI * M_PI;
  t89 = t12 * t88;
  t90 = t87 * t89;
  t91 = t15 * rho[0];
  t92 = t90 * t91;
  t94 = t73 * t71;
  t95 = t8 * t76;
  t97 = t94 * t95 * t68;
  t99 = -0.7e1 * t92 + 0.6e1 * t97;
  t101 = t73 * t18;
  t103 = 0.1e1 / p->cam_omega * t8;
  t104 = t12 * t18;
  t107 = erf(t103 * t104 * t15);
  t108 = t101 * t107;
  t109 = t57 * t88;
  t110 = t108 * t109;
  t116 = t68 * t68;
  t117 = t10 * t116;
  t118 = 0.6e1 * t117;
  t119 = 0.36e2 * t110 * t10 * rho[0] * p->cam_omega + t118 - 0.81e2 * t92 - 0.54e2 * t97;
  t120 = 0.1e1 / t119;
  t122 = 0.1e11 < t22;
  t123 = t88 * t88;
  t124 = t87 * t73;
  t125 = t123 * t124;
  t126 = rho[0] * rho[0];
  t129 = t89 * t8;
  t134 = t71 * t10;
  t140 = t116 * t68;
  t141 = 0.1e1 / t140;
  t144 = t71 * t8;
  t147 = t10 * t68;
  t148 = -0.7e1 / 0.6e1 * t94 * t95 + t147;
  t150 = 0.1e1 / t68;
  t151 = t150 * t10;
  t153 = t151 * t94 * t76;
  t154 = exp(t153);
  t157 = t68 * t148 * t154 - 0.11e2 / 0.6e1 * t97 - t92 - t117;
  t158 = t144 * t157;
  t168 = t94 * t76 * t68;
  t170 = t8 * t116;
  t171 = 0.6e1 * t110 * t8 * rho[0] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t91 - 0.9e1 * t168 + t170;
  t174 = t171 * t154 + 0.6e1 * t168 - t170;
  t176 = 0.1e1 / t174 * t150;
  t177 = t73 * t76 * t176;
  t180 = my_piecewise5(t86, t99 * t120, t122, (0.28e4 * t134 * t76 * t116 * t73 - 0.14e3 * t129 * t91 * t68 * t87 - 0.1863e4 * t125 * t126) * t141 / 0.504e5, t158 * t177 / 0.3e1);
  t181 = t85 * t180;
  t185 = t76 * t126;
  t187 = params->kappa * t185 * t71;
  t188 = 0.27e2 / 0.56e2 * t83 * t84 * t181 + t187;
  t189 = t188 * t91;
  t190 = 0.1e1 / t11;
  t191 = params->b_PBE * t180;
  t194 = sigma[0] * t5 * t8;
  t198 = 0.216e3 * t191 * t81 * t194 + 0.448e3 * t187;
  t199 = 0.1e1 / t198;
  t200 = t190 * t199;
  t201 = t189 * t200;
  t204 = my_piecewise3(t1, 0, -0.168e3 * t67 * t201);
  t205 = rho[1] <= p->dens_threshold;
  t206 = POW_1_3(rho[1]);
  t207 = 0.1e1 / t206;
  t211 = t14 * p->cam_omega * t207 * t19 / 0.6e1;
  t212 = 0.135e1 <= t211;
  t213 = 0.135e1 < t211;
  t214 = my_piecewise3(t213, t211, 0.135e1);
  t215 = t214 * t214;
  t216 = t215 * t215;
  t217 = t216 * t215;
  t218 = t216 * t216;
  t221 = t218 * t216;
  t223 = t218 * t215;
  t229 = 0.240888840192e14 * t218 * t217 + 0.19448e5 * t215 - 0.80784e6 * t216 + 0.3055104e8 * t217 - 0.104552448e10 * t218 - 0.90333315072e12 * t221 + 0.3226189824e11 * t223 - 0.429e3;
  t230 = t218 * t218;
  t231 = 0.1e1 / t230;
  t234 = my_piecewise3(t213, 0.135e1, t211);
  t235 = t234 * t234;
  t236 = t235 * t235;
  t239 = 0.32e2 * t236 - 0.16e2 * t235;
  t242 = exp(-0.1e1 / t235 / 0.4e1);
  t246 = 0.1e1 / t234;
  t248 = erf(t246 / 0.2e1);
  t254 = my_piecewise3(t212, t229 * t231 / 0.8671998246912e15, t239 * t242 / 0.3e1 - 0.32e2 / 0.3e1 * t236 - 0.8e1 / 0.3e1 * t248 * t234 * t57 + 0.8e1 * t235 + 0.1e1);
  t255 = t9 * t254;
  t256 = t206 * t206;
  t257 = 0.1e1 / t256;
  t261 = exp(-t70 * t75 * t257 / 0.12e2);
  t262 = params->b_PBE * t261;
  t263 = t262 * sigma[2];
  t264 = t211 < 0.5e-1;
  t265 = t206 * rho[1];
  t266 = t90 * t265;
  t268 = t8 * t256;
  t270 = t94 * t268 * t68;
  t272 = -0.7e1 * t266 + 0.6e1 * t270;
  t276 = erf(t103 * t104 * t206);
  t277 = t101 * t276;
  t278 = t277 * t109;
  t284 = 0.36e2 * t278 * t10 * rho[1] * p->cam_omega + t118 - 0.81e2 * t266 - 0.54e2 * t270;
  t285 = 0.1e1 / t284;
  t287 = 0.1e11 < t211;
  t288 = rho[1] * rho[1];
  t304 = -0.7e1 / 0.6e1 * t94 * t268 + t147;
  t307 = t151 * t94 * t256;
  t308 = exp(t307);
  t311 = t68 * t304 * t308 - 0.11e2 / 0.6e1 * t270 - t266 - t117;
  t312 = t144 * t311;
  t322 = t94 * t256 * t68;
  t324 = 0.6e1 * t278 * t8 * rho[1] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t265 - 0.9e1 * t322 + t170;
  t327 = t324 * t308 - t170 + 0.6e1 * t322;
  t329 = 0.1e1 / t327 * t150;
  t330 = t73 * t256 * t329;
  t333 = my_piecewise5(t264, t272 * t285, t287, (0.28e4 * t134 * t256 * t116 * t73 - 0.14e3 * t129 * t265 * t68 * t87 - 0.1863e4 * t125 * t288) * t141 / 0.504e5, t312 * t330 / 0.3e1);
  t334 = t85 * t333;
  t338 = t256 * t288;
  t340 = params->kappa * t338 * t71;
  t341 = 0.27e2 / 0.56e2 * t263 * t84 * t334 + t340;
  t342 = t341 * t265;
  t343 = params->b_PBE * t333;
  t346 = sigma[2] * t5 * t8;
  t350 = 0.216e3 * t343 * t261 * t346 + 0.448e3 * t340;
  t351 = 0.1e1 / t350;
  t352 = t190 * t351;
  t353 = t342 * t352;
  t356 = my_piecewise3(t205, 0, -0.168e3 * t255 * t353);
  tzk0 = (t204 + t356) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t360 = t27 * t25;
  t361 = t29 * t360;
  t362 = 0.1e1 / t91;
  t366 = t14 * p->cam_omega * t362 * t19 / 0.18e2;
  t367 = my_piecewise3(t24, -t366, 0);
  t370 = t26 * t25;
  t371 = t29 * t370;
  t374 = t29 * t25;
  t377 = t27 * t370;
  t386 = 0.38896e5 * t25 * t367 + 0.18330624e9 * t360 * t367 + 0.3372443762688e15 * t361 * t367 - 0.323136e7 * t370 * t367 - 0.1083999780864e14 * t371 * t367 + 0.3226189824e12 * t374 * t367 - 0.836419584e10 * t377 * t367;
  t390 = 0.1e1 / t41 / t25;
  t391 = t40 * t390;
  t395 = t46 * t45;
  t396 = my_piecewise3(t24, 0, -t366);
  t397 = t395 * t396;
  t399 = t45 * t396;
  t401 = 0.128e3 * t397 - 0.32e2 * t399;
  t404 = 0.1e1 / t395;
  t405 = t50 * t404;
  t406 = t396 * t53;
  t410 = t53 * t58;
  t417 = my_piecewise3(t23, t386 * t42 / 0.8671998246912e15 - t391 * t367 / 0.541999890432e14, t401 * t53 / 0.3e1 + t405 * t406 / 0.6e1 - 0.128e3 / 0.3e1 * t397 + 0.8e1 / 0.3e1 * t410 * t396 - 0.8e1 / 0.3e1 * t61 * t396 + 0.16e2 * t399);
  t418 = t9 * t417;
  t425 = params->b_PBE * params->ax * t68 * t10 * t72 * t74;
  t426 = t76 * rho[0];
  t427 = 0.1e1 / t426;
  t429 = t427 * t81 * sigma[0];
  t430 = t5 * t85;
  t431 = t430 * t180;
  t435 = t90 * t15;
  t437 = t8 * t16;
  t439 = t94 * t437 * t68;
  t441 = -0.28e2 / 0.3e1 * t435 + 0.4e1 * t439;
  t443 = t119 * t119;
  t444 = 0.1e1 / t443;
  t445 = t99 * t444;
  t447 = exp(-t153);
  t452 = t109 * t10 * p->cam_omega;
  t456 = 0.72e2 * t90 * t447 * t15 + 0.36e2 * t108 * t452 - 0.108e3 * t435 - 0.36e2 * t439;
  t473 = t68 * t71 * t73;
  t478 = t148 * t10 * t71;
  t479 = t73 * t16;
  t485 = -0.7e1 / 0.9e1 * t473 * t437 * t154 + 0.2e1 / 0.3e1 * t478 * t479 * t154 - 0.11e2 / 0.9e1 * t439 - 0.4e1 / 0.3e1 * t435;
  t486 = t144 * t485;
  t489 = t479 * t176;
  t493 = t144 * t157 * t73;
  t494 = t174 * t174;
  t495 = 0.1e1 / t494;
  t496 = t76 * t495;
  t497 = t447 * t10;
  t502 = t109 * t8 * p->cam_omega;
  t509 = t94 * t16 * t68;
  t511 = -0.6e1 * t90 * t10 * t15 + 0.4e1 * t90 * t497 * t15 + 0.6e1 * t108 * t502 - 0.6e1 * t509;
  t514 = t171 * t150 * t10;
  t516 = t94 * t16 * t154;
  t520 = t511 * t154 + 0.2e1 / 0.3e1 * t514 * t516 + 0.4e1 * t509;
  t521 = t150 * t520;
  t522 = t496 * t521;
  t526 = my_piecewise5(t86, t441 * t120 - t445 * t456, t122, (-0.3726e4 * t125 * rho[0] - 0.56e3 / 0.3e1 * t129 * t15 * t68 * t87 + 0.56e4 / 0.3e1 * t134 * t16 * t116 * t73) * t141 / 0.504e5, t486 * t177 / 0.3e1 + 0.2e1 / 0.9e1 * t158 * t489 - t493 * t522 / 0.3e1);
  t527 = t85 * t526;
  t532 = params->kappa * t426 * t71;
  t534 = 0.3e1 / 0.112e3 * t425 * t429 * t431 + 0.27e2 / 0.56e2 * t83 * t84 * t527 + 0.8e1 / 0.3e1 * t532;
  t535 = t534 * t91;
  t536 = t535 * t200;
  t539 = t188 * t15;
  t540 = t539 * t200;
  t543 = t66 * t188;
  t544 = t9 * t543;
  t545 = t91 * t190;
  t546 = t198 * t198;
  t547 = 0.1e1 / t546;
  t548 = params->b_PBE * t526;
  t552 = t69 * t10;
  t553 = t191 * t552;
  t556 = t81 * sigma[0] * t5;
  t557 = t75 * t427 * t556;
  t561 = 0.216e3 * t548 * t81 * t194 + 0.12e2 * t553 * t557 + 0.3584e4 / 0.3e1 * t532;
  t562 = t547 * t561;
  t563 = t545 * t562;
  tvrho0 = my_piecewise3(t1, 0, -0.168e3 * t418 * t201 - 0.168e3 * t67 * t536 - 0.224e3 * t67 * t540 + 0.168e3 * t544 * t563);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t567 = t216 * t214;
  t568 = t218 * t567;
  t569 = 0.1e1 / t265;
  t573 = t14 * p->cam_omega * t569 * t19 / 0.18e2;
  t574 = my_piecewise3(t213, -t573, 0);
  t577 = t215 * t214;
  t578 = t218 * t577;
  t581 = t218 * t214;
  t584 = t216 * t577;
  t593 = 0.38896e5 * t214 * t574 + 0.18330624e9 * t567 * t574 + 0.3372443762688e15 * t568 * t574 - 0.323136e7 * t577 * t574 - 0.1083999780864e14 * t578 * t574 + 0.3226189824e12 * t581 * t574 - 0.836419584e10 * t584 * t574;
  t597 = 0.1e1 / t230 / t214;
  t598 = t229 * t597;
  t602 = t235 * t234;
  t603 = my_piecewise3(t213, 0, -t573);
  t604 = t602 * t603;
  t606 = t234 * t603;
  t608 = 0.128e3 * t604 - 0.32e2 * t606;
  t611 = 0.1e1 / t602;
  t612 = t239 * t611;
  t613 = t603 * t242;
  t617 = t242 * t246;
  t625 = my_piecewise3(t212, t593 * t231 / 0.8671998246912e15 - t598 * t574 / 0.541999890432e14, t608 * t242 / 0.3e1 + t612 * t613 / 0.6e1 - 0.128e3 / 0.3e1 * t604 + 0.8e1 / 0.3e1 * t617 * t603 - 0.8e1 / 0.3e1 * t248 * t603 * t57 + 0.16e2 * t606);
  t626 = t9 * t625;
  t629 = t256 * rho[1];
  t630 = 0.1e1 / t629;
  t632 = t630 * t261 * sigma[2];
  t633 = t430 * t333;
  t637 = t90 * t206;
  t639 = t8 * t207;
  t641 = t94 * t639 * t68;
  t643 = -0.28e2 / 0.3e1 * t637 + 0.4e1 * t641;
  t645 = t284 * t284;
  t646 = 0.1e1 / t645;
  t647 = t272 * t646;
  t649 = exp(-t307);
  t656 = 0.72e2 * t90 * t649 * t206 + 0.36e2 * t277 * t452 - 0.108e3 * t637 - 0.36e2 * t641;
  t676 = t304 * t10 * t71;
  t677 = t73 * t207;
  t683 = -0.7e1 / 0.9e1 * t473 * t639 * t308 + 0.2e1 / 0.3e1 * t676 * t677 * t308 - 0.11e2 / 0.9e1 * t641 - 0.4e1 / 0.3e1 * t637;
  t684 = t144 * t683;
  t687 = t677 * t329;
  t691 = t144 * t311 * t73;
  t692 = t327 * t327;
  t693 = 0.1e1 / t692;
  t694 = t256 * t693;
  t695 = t649 * t10;
  t705 = t94 * t207 * t68;
  t707 = -0.6e1 * t90 * t10 * t206 + 0.4e1 * t90 * t695 * t206 + 0.6e1 * t277 * t502 - 0.6e1 * t705;
  t710 = t324 * t150 * t10;
  t712 = t94 * t207 * t308;
  t716 = t707 * t308 + 0.2e1 / 0.3e1 * t710 * t712 + 0.4e1 * t705;
  t717 = t150 * t716;
  t718 = t694 * t717;
  t722 = my_piecewise5(t264, t643 * t285 - t647 * t656, t287, (-0.3726e4 * t125 * rho[1] - 0.56e3 / 0.3e1 * t129 * t206 * t68 * t87 + 0.56e4 / 0.3e1 * t134 * t207 * t116 * t73) * t141 / 0.504e5, t684 * t330 / 0.3e1 + 0.2e1 / 0.9e1 * t312 * t687 - t691 * t718 / 0.3e1);
  t723 = t85 * t722;
  t728 = params->kappa * t629 * t71;
  t730 = 0.3e1 / 0.112e3 * t425 * t632 * t633 + 0.27e2 / 0.56e2 * t263 * t84 * t723 + 0.8e1 / 0.3e1 * t728;
  t731 = t730 * t265;
  t732 = t731 * t352;
  t735 = t341 * t206;
  t736 = t735 * t352;
  t739 = t254 * t341;
  t740 = t9 * t739;
  t741 = t265 * t190;
  t742 = t350 * t350;
  t743 = 0.1e1 / t742;
  t744 = params->b_PBE * t722;
  t748 = t343 * t552;
  t751 = t261 * sigma[2] * t5;
  t752 = t75 * t630 * t751;
  t756 = 0.216e3 * t744 * t261 * t346 + 0.12e2 * t748 * t752 + 0.3584e4 / 0.3e1 * t728;
  t757 = t743 * t756;
  t758 = t741 * t757;
  tvrho1 = my_piecewise3(t205, 0, -0.168e3 * t255 * t732 - 0.224e3 * t255 * t736 - 0.168e3 * t626 * t353 + 0.168e3 * t740 * t758);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t762 = t7 * t10;
  t765 = t762 * t66 * params->b_PBE * t81;
  t766 = t545 * t199;
  t767 = t431 * t766;
  t771 = t762 * t543 * t91;
  t772 = t190 * t547;
  t773 = t772 * params->b_PBE;
  t776 = t773 * t180 * t81 * t5;
  tvsigma0 = my_piecewise3(t1, 0, -0.81e2 * t765 * t767 + 0.36288e5 * t771 * t776);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t782 = t762 * t254 * params->b_PBE * t261;
  t783 = t741 * t351;
  t784 = t633 * t783;
  t788 = t762 * t739 * t265;
  t789 = t190 * t743;
  t790 = t789 * params->b_PBE;
  t793 = t790 * t333 * t261 * t5;
  tvsigma2 = my_piecewise3(t205, 0, -0.81e2 * t782 * t784 + 0.36288e5 * t788 * t793);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t797 = t367 * t367;
  t801 = 0.1e1 / t15 / t126;
  t805 = 0.2e1 / 0.27e2 * t14 * p->cam_omega * t801 * t19;
  t806 = my_piecewise3(t24, t805, 0);
  t832 = 0.38896e5 * t25 * t806 - 0.969408e7 * t26 * t797 + 0.9165312e9 * t27 * t797 - 0.5854937088e11 * t28 * t797 + 0.29035708416e13 * t29 * t797 + 0.43841768914944e16 * t32 * t797 - 0.11923997589504e15 * t34 * t797 + 0.18330624e9 * t360 * t806 + 0.3372443762688e15 * t361 * t806 - 0.323136e7 * t370 * t806 - 0.1083999780864e14 * t371 * t806 + 0.3226189824e12 * t374 * t806 - 0.836419584e10 * t377 * t806 + 0.38896e5 * t797;
  t835 = t386 * t390;
  t839 = 0.1e1 / t41 / t26;
  t840 = t40 * t839;
  t846 = t396 * t396;
  t847 = t46 * t846;
  t849 = my_piecewise3(t24, 0, t805);
  t850 = t395 * t849;
  t853 = t45 * t849;
  t855 = 0.384e3 * t847 + 0.128e3 * t850 - 0.32e2 * t846 - 0.32e2 * t853;
  t858 = t401 * t404;
  t861 = 0.1e1 / t47;
  t862 = t50 * t861;
  t863 = t846 * t53;
  t866 = t849 * t53;
  t870 = 0.1e1 / t47 / t46;
  t871 = t50 * t870;
  t885 = t855 * t53 / 0.3e1 + t858 * t406 / 0.3e1 - t862 * t863 / 0.2e1 + t405 * t866 / 0.6e1 + t871 * t863 / 0.12e2 - 0.128e3 * t847 - 0.128e3 / 0.3e1 * t850 + 0.4e1 / 0.3e1 * t861 * t846 * t53 + 0.8e1 / 0.3e1 * t410 * t849 - 0.8e1 / 0.3e1 * t61 * t849 + 0.16e2 * t846 + 0.16e2 * t853;
  t886 = my_piecewise3(t23, t832 * t42 / 0.8671998246912e15 - t835 * t367 / 0.270999945216e14 + t840 * t797 / 0.31882346496e13 - t391 * t806 / 0.541999890432e14, t885);
  t887 = t9 * t886;
  t894 = t417 * t188;
  t895 = t9 * t894;
  t898 = 0.1e1 / t185;
  t900 = t898 * t81 * sigma[0];
  t904 = params->ax * params->ax;
  t906 = 0.1e1 / t89;
  t908 = 0.1e1 / t87;
  t910 = params->b_PBE * t904 * t116 * t906 * t908;
  t911 = t126 * rho[0];
  t913 = 0.1e1 / t15 / t911;
  t915 = t913 * t81 * sigma[0];
  t919 = t430 * t526;
  t923 = t90 * t77;
  t925 = t8 * t362;
  t927 = t94 * t925 * t68;
  t929 = -0.28e2 / 0.9e1 * t923 - 0.4e1 / 0.3e1 * t927;
  t931 = t441 * t444;
  t935 = 0.1e1 / t443 / t119;
  t936 = t99 * t935;
  t937 = t456 * t456;
  t948 = -0.48e2 * t125 * t151 * t447 + 0.96e2 * t90 * t447 * t77 - 0.36e2 * t923 + 0.12e2 * t927;
  t951 = 0.3726e4 * t125;
  t967 = t90 * t77 * t154;
  t969 = t73 * t362;
  t974 = t148 * t8 * t89;
  t976 = t150 * t154;
  t982 = 0.7e1 / 0.27e2 * t473 * t925 * t154 - 0.28e2 / 0.9e1 * t967 - 0.2e1 / 0.9e1 * t478 * t969 * t154 + 0.4e1 / 0.3e1 * t974 * t87 * t77 * t976 + 0.11e2 / 0.27e2 * t927 - 0.4e1 / 0.9e1 * t923;
  t983 = t144 * t982;
  t989 = t144 * t485 * t73;
  t992 = t969 * t176;
  t995 = t16 * t495;
  t996 = t995 * t521;
  t1000 = 0.1e1 / t494 / t174;
  t1001 = t76 * t1000;
  t1002 = t520 * t520;
  t1003 = t150 * t1002;
  t1004 = t1001 * t1003;
  t1007 = t150 * t8;
  t1011 = t497 * t77;
  t1018 = t94 * t362 * t68;
  t1020 = -0.8e1 * t125 * t1007 * t447 + 0.16e2 / 0.3e1 * t90 * t1011 - 0.2e1 * t90 * t10 * t77 + 0.2e1 * t1018;
  t1023 = t511 * t150 * t10;
  t1027 = t94 * t362 * t154;
  t1030 = 0.1e1 / t116;
  t1032 = t171 * t1030 * t8;
  t1036 = t1020 * t154 + 0.4e1 / 0.3e1 * t1023 * t516 - 0.2e1 / 0.9e1 * t514 * t1027 + 0.4e1 / 0.3e1 * t1032 * t967 - 0.4e1 / 0.3e1 * t1018;
  t1037 = t150 * t1036;
  t1038 = t496 * t1037;
  t1042 = my_piecewise5(t86, t929 * t120 - t445 * t948 - 0.2e1 * t931 * t456 + 0.2e1 * t936 * t937, t122, (-t951 - 0.56e3 / 0.9e1 * t129 * t77 * t68 * t87 - 0.56e4 / 0.9e1 * t134 * t362 * t116 * t73) * t141 / 0.504e5, t983 * t177 / 0.3e1 + 0.4e1 / 0.9e1 * t486 * t489 - 0.2e1 / 0.3e1 * t989 * t522 - 0.2e1 / 0.27e2 * t158 * t992 - 0.4e1 / 0.9e1 * t493 * t996 + 0.2e1 / 0.3e1 * t493 * t1004 - t493 * t1038 / 0.3e1);
  t1043 = t85 * t1042;
  t1048 = params->kappa * t76 * t71;
  t1050 = -0.5e1 / 0.112e3 * t425 * t900 * t431 + t910 * t915 * t431 / 0.224e3 + 0.3e1 / 0.56e2 * t425 * t429 * t919 + 0.27e2 / 0.56e2 * t83 * t84 * t1043 + 0.4e2 / 0.9e1 * t1048;
  t1051 = t1050 * t91;
  t1052 = t1051 * t200;
  t1055 = t534 * t15;
  t1056 = t1055 * t200;
  t1059 = t66 * t534;
  t1060 = t9 * t1059;
  t1063 = t188 * t77;
  t1064 = t1063 * t200;
  t1067 = t15 * t190;
  t1068 = t1067 * t562;
  t1072 = 0.1e1 / t546 / t198;
  t1073 = t561 * t561;
  t1074 = t1072 * t1073;
  t1075 = t545 * t1074;
  t1078 = params->b_PBE * t1042;
  t1082 = t548 * t552;
  t1086 = t75 * t898 * t556;
  t1089 = t904 * t116;
  t1090 = t1089 * t906;
  t1091 = t191 * t1090;
  t1093 = t908 * t913 * t556;
  t1097 = 0.216e3 * t1078 * t81 * t194 + 0.24e2 * t1082 * t557 - 0.2e2 * t553 * t1086 + 0.2e1 * t1091 * t1093 + 0.1792e5 / 0.9e1 * t1048;
  t1098 = t547 * t1097;
  t1099 = t545 * t1098;
  t1102 = -0.168e3 * t887 * t201 - 0.336e3 * t418 * t536 - 0.448e3 * t418 * t540 + 0.336e3 * t895 * t563 - 0.168e3 * t67 * t1052 - 0.448e3 * t67 * t1056 + 0.336e3 * t1060 * t563 - 0.224e3 / 0.3e1 * t67 * t1064 + 0.448e3 * t544 * t1068 - 0.336e3 * t544 * t1075 + 0.168e3 * t544 * t1099;
  tv2rho20 = my_piecewise3(t1, 0, t1102);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  tv2rho21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1103 = t574 * t574;
  t1107 = 0.1e1 / t206 / t288;
  t1111 = 0.2e1 / 0.27e2 * t14 * p->cam_omega * t1107 * t19;
  t1112 = my_piecewise3(t213, t1111, 0);
  t1138 = -0.969408e7 * t215 * t1103 + 0.9165312e9 * t216 * t1103 - 0.5854937088e11 * t217 * t1103 + 0.29035708416e13 * t218 * t1103 + 0.43841768914944e16 * t221 * t1103 - 0.11923997589504e15 * t223 * t1103 + 0.38896e5 * t214 * t1112 + 0.18330624e9 * t567 * t1112 + 0.3372443762688e15 * t568 * t1112 - 0.323136e7 * t577 * t1112 - 0.1083999780864e14 * t578 * t1112 + 0.3226189824e12 * t581 * t1112 - 0.836419584e10 * t584 * t1112 + 0.38896e5 * t1103;
  t1141 = t593 * t597;
  t1145 = 0.1e1 / t230 / t215;
  t1146 = t229 * t1145;
  t1152 = t603 * t603;
  t1153 = t235 * t1152;
  t1155 = my_piecewise3(t213, 0, t1111);
  t1156 = t602 * t1155;
  t1159 = t234 * t1155;
  t1161 = 0.384e3 * t1153 + 0.128e3 * t1156 - 0.32e2 * t1152 - 0.32e2 * t1159;
  t1164 = t608 * t611;
  t1167 = 0.1e1 / t236;
  t1168 = t239 * t1167;
  t1169 = t1152 * t242;
  t1172 = t1155 * t242;
  t1176 = 0.1e1 / t236 / t235;
  t1177 = t239 * t1176;
  t1192 = t1161 * t242 / 0.3e1 + t1164 * t613 / 0.3e1 - t1168 * t1169 / 0.2e1 + t612 * t1172 / 0.6e1 + t1177 * t1169 / 0.12e2 - 0.128e3 * t1153 - 0.128e3 / 0.3e1 * t1156 + 0.4e1 / 0.3e1 * t1167 * t1152 * t242 + 0.8e1 / 0.3e1 * t617 * t1155 - 0.8e1 / 0.3e1 * t248 * t1155 * t57 + 0.16e2 * t1152 + 0.16e2 * t1159;
  t1193 = my_piecewise3(t212, t1138 * t231 / 0.8671998246912e15 - t1141 * t574 / 0.270999945216e14 + t1146 * t1103 / 0.31882346496e13 - t598 * t1112 / 0.541999890432e14, t1192);
  t1194 = t9 * t1193;
  t1201 = t625 * t341;
  t1202 = t9 * t1201;
  t1205 = 0.1e1 / t338;
  t1207 = t1205 * t261 * sigma[2];
  t1211 = t288 * rho[1];
  t1213 = 0.1e1 / t206 / t1211;
  t1215 = t1213 * t261 * sigma[2];
  t1219 = t430 * t722;
  t1223 = t90 * t257;
  t1225 = t8 * t569;
  t1227 = t94 * t1225 * t68;
  t1229 = -0.28e2 / 0.9e1 * t1223 - 0.4e1 / 0.3e1 * t1227;
  t1231 = t643 * t646;
  t1235 = 0.1e1 / t645 / t284;
  t1236 = t272 * t1235;
  t1237 = t656 * t656;
  t1248 = -0.48e2 * t125 * t151 * t649 + 0.96e2 * t90 * t649 * t257 - 0.36e2 * t1223 + 0.12e2 * t1227;
  t1266 = t90 * t257 * t308;
  t1268 = t73 * t569;
  t1273 = t304 * t8 * t89;
  t1275 = t150 * t308;
  t1281 = 0.7e1 / 0.27e2 * t473 * t1225 * t308 - 0.28e2 / 0.9e1 * t1266 - 0.2e1 / 0.9e1 * t676 * t1268 * t308 + 0.4e1 / 0.3e1 * t1273 * t87 * t257 * t1275 + 0.11e2 / 0.27e2 * t1227 - 0.4e1 / 0.9e1 * t1223;
  t1282 = t144 * t1281;
  t1288 = t144 * t683 * t73;
  t1291 = t1268 * t329;
  t1294 = t207 * t693;
  t1295 = t1294 * t717;
  t1299 = 0.1e1 / t692 / t327;
  t1300 = t256 * t1299;
  t1301 = t716 * t716;
  t1302 = t150 * t1301;
  t1303 = t1300 * t1302;
  t1309 = t695 * t257;
  t1316 = t94 * t569 * t68;
  t1318 = -0.8e1 * t125 * t1007 * t649 + 0.16e2 / 0.3e1 * t90 * t1309 - 0.2e1 * t90 * t10 * t257 + 0.2e1 * t1316;
  t1321 = t707 * t150 * t10;
  t1325 = t94 * t569 * t308;
  t1329 = t324 * t1030 * t8;
  t1333 = t1318 * t308 + 0.4e1 / 0.3e1 * t1321 * t712 - 0.2e1 / 0.9e1 * t710 * t1325 + 0.4e1 / 0.3e1 * t1329 * t1266 - 0.4e1 / 0.3e1 * t1316;
  t1334 = t150 * t1333;
  t1335 = t694 * t1334;
  t1339 = my_piecewise5(t264, t1229 * t285 - 0.2e1 * t1231 * t656 + 0.2e1 * t1236 * t1237 - t647 * t1248, t287, (-t951 - 0.56e3 / 0.9e1 * t129 * t257 * t68 * t87 - 0.56e4 / 0.9e1 * t134 * t569 * t116 * t73) * t141 / 0.504e5, t1282 * t330 / 0.3e1 + 0.4e1 / 0.9e1 * t684 * t687 - 0.2e1 / 0.3e1 * t1288 * t718 - 0.2e1 / 0.27e2 * t312 * t1291 - 0.4e1 / 0.9e1 * t691 * t1295 + 0.2e1 / 0.3e1 * t691 * t1303 - t691 * t1335 / 0.3e1);
  t1340 = t85 * t1339;
  t1345 = params->kappa * t256 * t71;
  t1347 = -0.5e1 / 0.112e3 * t425 * t1207 * t633 + t910 * t1215 * t633 / 0.224e3 + 0.3e1 / 0.56e2 * t425 * t632 * t1219 + 0.27e2 / 0.56e2 * t263 * t84 * t1340 + 0.4e2 / 0.9e1 * t1345;
  t1348 = t1347 * t265;
  t1349 = t1348 * t352;
  t1352 = t730 * t206;
  t1353 = t1352 * t352;
  t1356 = t254 * t730;
  t1357 = t9 * t1356;
  t1360 = t341 * t257;
  t1361 = t1360 * t352;
  t1364 = t206 * t190;
  t1365 = t1364 * t757;
  t1369 = 0.1e1 / t742 / t350;
  t1370 = t756 * t756;
  t1371 = t1369 * t1370;
  t1372 = t741 * t1371;
  t1375 = params->b_PBE * t1339;
  t1379 = t744 * t552;
  t1383 = t75 * t1205 * t751;
  t1386 = t343 * t1090;
  t1388 = t908 * t1213 * t751;
  t1392 = 0.216e3 * t1375 * t261 * t346 + 0.24e2 * t1379 * t752 - 0.2e2 * t748 * t1383 + 0.2e1 * t1386 * t1388 + 0.1792e5 / 0.9e1 * t1345;
  t1393 = t743 * t1392;
  t1394 = t741 * t1393;
  t1397 = -0.168e3 * t1194 * t353 - 0.336e3 * t626 * t732 - 0.448e3 * t626 * t736 + 0.336e3 * t1202 * t758 - 0.168e3 * t255 * t1349 - 0.448e3 * t255 * t1353 + 0.336e3 * t1357 * t758 - 0.224e3 / 0.3e1 * t255 * t1361 + 0.448e3 * t740 * t1365 - 0.336e3 * t740 * t1372 + 0.168e3 * t740 * t1394;
  tv2rho22 = my_piecewise3(t205, 0, t1397);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1400 = t762 * t417 * params->b_PBE * t81;
  t1403 = t7 * t66;
  t1404 = t1403 * params->b_PBE;
  t1406 = 0.1e1 / t12 / M_PI;
  t1407 = t69 * t1406;
  t1408 = t1404 * t1407;
  t1410 = t74 * t16 * t81;
  t1412 = t430 * t180 * t199;
  t1413 = t1410 * t1412;
  t1416 = t919 * t766;
  t1419 = t1067 * t199;
  t1420 = t431 * t1419;
  t1423 = t762 * t66;
  t1424 = t82 * t5;
  t1425 = t1423 * t1424;
  t1426 = t181 * t91;
  t1427 = t772 * t561;
  t1428 = t1426 * t1427;
  t1432 = t762 * t894 * t91;
  t1436 = t762 * t1059 * t91;
  t1440 = t762 * t543 * t15;
  t1443 = t189 * t190;
  t1444 = t1423 * t1443;
  t1445 = t1072 * params->b_PBE;
  t1446 = t1445 * t180;
  t1447 = t81 * t5;
  t1448 = t1447 * t561;
  t1449 = t1446 * t1448;
  t1454 = t773 * t526 * t81 * t5;
  t1457 = t1403 * t188;
  t1458 = t16 * t1406;
  t1459 = t1458 * t547;
  t1460 = t1457 * t1459;
  t1462 = t68 * t74;
  t1463 = t1462 * t1447;
  t1464 = t191 * params->ax * t1463;
  t1467 = -0.81e2 * t1400 * t767 - 0.27e2 / 0.2e1 * t1408 * t1413 - 0.81e2 * t765 * t1416 - 0.108e3 * t765 * t1420 + 0.81e2 * t1425 * t1428 + 0.36288e5 * t1432 * t776 + 0.36288e5 * t1436 * t776 + 0.48384e5 * t1440 * t776 - 0.72576e5 * t1444 * t1449 + 0.36288e5 * t771 * t1454 + 0.6048e4 * t1460 * t1464;
  tv2rhosigma0 = my_piecewise3(t1, 0, t1467);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  tv2rhosigma3 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1470 = t762 * t625 * params->b_PBE * t261;
  t1473 = t7 * t254;
  t1474 = t1473 * params->b_PBE;
  t1475 = t1474 * t1407;
  t1477 = t74 * t207 * t261;
  t1479 = t430 * t333 * t351;
  t1480 = t1477 * t1479;
  t1483 = t1219 * t783;
  t1486 = t1364 * t351;
  t1487 = t633 * t1486;
  t1490 = t762 * t254;
  t1491 = t262 * t5;
  t1492 = t1490 * t1491;
  t1493 = t334 * t265;
  t1494 = t789 * t756;
  t1495 = t1493 * t1494;
  t1499 = t762 * t1201 * t265;
  t1503 = t762 * t1356 * t265;
  t1507 = t762 * t739 * t206;
  t1510 = t342 * t190;
  t1511 = t1490 * t1510;
  t1512 = t1369 * params->b_PBE;
  t1513 = t1512 * t333;
  t1514 = t261 * t5;
  t1515 = t1514 * t756;
  t1516 = t1513 * t1515;
  t1521 = t790 * t722 * t261 * t5;
  t1524 = t1473 * t341;
  t1525 = t207 * t1406;
  t1526 = t1525 * t743;
  t1527 = t1524 * t1526;
  t1529 = t1462 * t1514;
  t1530 = t343 * params->ax * t1529;
  t1533 = -0.81e2 * t1470 * t784 - 0.27e2 / 0.2e1 * t1475 * t1480 - 0.81e2 * t782 * t1483 - 0.108e3 * t782 * t1487 + 0.81e2 * t1492 * t1495 + 0.36288e5 * t1499 * t793 + 0.36288e5 * t1503 * t793 + 0.48384e5 * t1507 * t793 - 0.72576e5 * t1511 * t1516 + 0.36288e5 * t788 * t1521 + 0.6048e4 * t1527 * t1530;
  tv2rhosigma5 = my_piecewise3(t205, 0, t1533);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1534 = params->b_PBE * params->b_PBE;
  t1535 = t81 * t81;
  t1537 = t5 * t5;
  t1538 = t1534 * t1535 * t1537;
  t1539 = t1403 * t1538;
  t1540 = t180 * t180;
  t1541 = t85 * t1540;
  t1542 = t545 * t547;
  t1543 = t1541 * t1542;
  t1546 = t1403 * t1443;
  t1547 = t1072 * t1534;
  t1548 = t1540 * t1535;
  t1549 = t1548 * t1537;
  t1550 = t1547 * t1549;
  tv2sigma20 = my_piecewise3(t1, 0, 0.104976e6 * t1539 * t1543 - 0.47029248e8 * t1546 * t1550);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1554 = t261 * t261;
  t1556 = t1534 * t1554 * t1537;
  t1557 = t1473 * t1556;
  t1558 = t333 * t333;
  t1559 = t85 * t1558;
  t1560 = t741 * t743;
  t1561 = t1559 * t1560;
  t1564 = t1473 * t1510;
  t1565 = t1369 * t1534;
  t1566 = t1558 * t1554;
  t1567 = t1566 * t1537;
  t1568 = t1565 * t1567;
  tv2sigma25 = my_piecewise3(t205, 0, 0.104976e6 * t1557 * t1561 - 0.47029248e8 * t1564 * t1568);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1573 = 0.1e1 / t76 / t911;
  t1575 = t1573 * t81 * sigma[0];
  t1579 = t126 * t126;
  t1581 = 0.1e1 / t15 / t1579;
  t1583 = t1581 * t81 * sigma[0];
  t1590 = t904 * params->ax;
  t1592 = params->b_PBE * t1590 * t140;
  t1593 = 0.1e1 / t123;
  t1594 = 0.1e1 / t124;
  t1595 = t1593 * t1594;
  t1596 = t1579 * rho[0];
  t1597 = 0.1e1 / t1596;
  t1599 = t1592 * t1595 * t1597;
  t1600 = t8 * t81;
  t1601 = t1600 * sigma[0];
  t1602 = t1601 * t431;
  t1608 = t430 * t1042;
  t1612 = t90 * t427;
  t1614 = t8 * t801;
  t1616 = t94 * t1614 * t68;
  t1618 = 0.56e2 / 0.27e2 * t1612 + 0.16e2 / 0.9e1 * t1616;
  t1620 = t929 * t444;
  t1623 = t441 * t935;
  t1628 = t443 * t443;
  t1629 = 0.1e1 / t1628;
  t1630 = t99 * t1629;
  t1631 = t937 * t456;
  t1634 = t456 * t948;
  t1638 = t87 * t87;
  t1640 = t11 * t123 * M_PI;
  t1641 = t1638 * t1640;
  t1642 = t1641 * t1030;
  t1646 = t125 * t150;
  t1647 = 0.1e1 / rho[0];
  t1656 = -0.64e2 * t1646 * t10 * t1647 * t447 + 0.96e2 * t1642 * t437 * t447 - 0.64e2 * t90 * t447 * t427 + 0.24e2 * t1612 - 0.16e2 * t1616;
  t1674 = t90 * t427 * t154;
  t1677 = t151 * t154;
  t1680 = t73 * t801;
  t1689 = t148 * t123 * t124;
  t1696 = -0.28e2 / 0.81e2 * t473 * t1614 * t154 + 0.28e2 / 0.9e1 * t1674 - 0.28e2 / 0.9e1 * t125 * t1647 * t1677 + 0.8e1 / 0.27e2 * t478 * t1680 * t154 - 0.4e1 / 0.3e1 * t974 * t87 * t427 * t976 + 0.8e1 / 0.3e1 * t1689 * t1647 * t1030 * t154 - 0.44e2 / 0.81e2 * t1616 + 0.8e1 / 0.27e2 * t1612;
  t1697 = t144 * t1696;
  t1715 = t94 * t801 * t68;
  t1717 = 0.16e2 * t1641 * t1030 * t16 * t447 - 0.32e2 / 0.3e1 * t1646 * t8 * t1647 * t447 - 0.32e2 / 0.9e1 * t90 * t497 * t427 + 0.4e1 / 0.3e1 * t90 * t10 * t427 - 0.8e1 / 0.3e1 * t1715;
  t1720 = t1020 * t150 * t10;
  t1726 = t511 * t1030 * t8;
  t1730 = t94 * t801 * t154;
  t1736 = t171 * t141 * t123;
  t1738 = t124 * t1647 * t154;
  t1743 = t150 * (t1717 * t154 + 0.2e1 * t1720 * t516 - 0.2e1 / 0.3e1 * t1023 * t1027 + 0.4e1 * t1726 * t967 + 0.8e1 / 0.27e2 * t514 * t1730 - 0.4e1 / 0.3e1 * t1032 * t1674 + 0.8e1 / 0.3e1 * t1736 * t1738 + 0.16e2 / 0.9e1 * t1715);
  t1744 = t496 * t1743;
  t1750 = t144 * t982 * t73;
  t1757 = t1680 * t176;
  t1760 = t362 * t495;
  t1761 = t1760 * t521;
  t1764 = t995 * t1037;
  t1767 = t494 * t494;
  t1768 = 0.1e1 / t1767;
  t1769 = t76 * t1768;
  t1771 = t150 * t1002 * t520;
  t1772 = t1769 * t1771;
  t1775 = t521 * t1036;
  t1776 = t1001 * t1775;
  t1781 = t16 * t1000;
  t1782 = t1781 * t1003;
  t1785 = t1697 * t177 / 0.3e1 - t493 * t1744 / 0.3e1 + 0.2e1 / 0.3e1 * t983 * t489 - t1750 * t522 - 0.2e1 / 0.9e1 * t486 * t992 - 0.4e1 / 0.3e1 * t989 * t996 - t989 * t1038 + 0.8e1 / 0.81e2 * t158 * t1757 + 0.2e1 / 0.9e1 * t493 * t1761 - 0.2e1 / 0.3e1 * t493 * t1764 - 0.2e1 * t493 * t1772 + 0.2e1 * t493 * t1776 + 0.2e1 * t989 * t1004 + 0.4e1 / 0.3e1 * t493 * t1782;
  t1786 = my_piecewise5(t86, t1618 * t120 - 0.3e1 * t1620 * t456 + 0.6e1 * t1623 * t937 - 0.6e1 * t1630 * t1631 + 0.6e1 * t936 * t1634 - t445 * t1656 - 0.3e1 * t931 * t948, t122, (0.112e4 / 0.27e2 * t129 * t427 * t68 * t87 + 0.224e5 / 0.27e2 * t134 * t801 * t116 * t73) * t141 / 0.504e5, t1785);
  t1792 = params->kappa * t16 * t71;
  t1794 = 0.5e1 / 0.42e2 * t425 * t1575 * t431 - 0.5e1 / 0.224e3 * t910 * t1583 * t431 - 0.15e2 / 0.112e3 * t425 * t900 * t919 + t1599 * t1602 / 0.4032e4 + 0.3e1 / 0.224e3 * t910 * t915 * t919 + 0.9e1 / 0.112e3 * t425 * t429 * t1608 + 0.27e2 / 0.56e2 * t83 * t84 * t85 * t1786 + 0.8e2 / 0.27e2 * t1792;
  t1796 = t1794 * t91 * t200;
  t1801 = t797 * t367;
  t1804 = t32 * t367;
  t1809 = t34 * t367;
  t1814 = t29 * t367;
  t1819 = t28 * t367;
  t1824 = t27 * t367;
  t1829 = t26 * t367;
  t1835 = 0.14e2 / 0.81e2 * t14 * p->cam_omega * t913 * t19;
  t1836 = my_piecewise3(t24, -t1835, 0);
  t1849 = t367 * t806;
  t1853 = -0.1938816e8 * t25 * t1801 - 0.35129622528e12 * t360 * t1801 + 0.36661248e10 * t370 * t1801 + 0.526101226979328e17 * t371 * t1801 - 0.11923997589504e16 * t374 * t1801 + 0.232285667328e14 * t377 * t1801 + 0.131525306744832e17 * t1804 * t806 - 0.35771992768512e15 * t1809 * t806 + 0.87107125248e13 * t1814 * t806 - 0.17564811264e12 * t1819 * t806 + 0.27495936e10 * t1824 * t806 - 0.2908224e8 * t1829 * t806 + 0.38896e5 * t25 * t1836 + 0.18330624e9 * t360 * t1836 + 0.3372443762688e15 * t361 * t1836 - 0.323136e7 * t370 * t1836 - 0.1083999780864e14 * t371 * t1836 + 0.3226189824e12 * t374 * t1836 - 0.836419584e10 * t377 * t1836 + 0.116688e6 * t1849;
  t1856 = t832 * t390;
  t1859 = t386 * t839;
  t1865 = 0.1e1 / t41 / t370;
  t1866 = t40 * t1865;
  t1875 = 0.1e1 / t47 / t395;
  t1876 = t846 * t396;
  t1880 = my_piecewise3(t24, 0, -t1835);
  t1885 = t45 * t1876;
  t1887 = t46 * t396;
  t1888 = t1887 * t849;
  t1890 = t1880 * t53;
  t1893 = t47 * t47;
  t1895 = 0.1e1 / t1893 / t45;
  t1896 = t50 * t1895;
  t1897 = t1876 * t53;
  t1901 = 0.1e1 / t47 / t45;
  t1905 = t861 * t396;
  t1908 = t855 * t404;
  t1914 = t401 * t870;
  t1917 = t50 * t1875;
  t1920 = t401 * t861;
  t1923 = t50 * t1901;
  t1926 = t406 * t849;
  t1933 = t395 * t1880;
  t1935 = t396 * t849;
  t1937 = t45 * t1880;
  t1939 = 0.768e3 * t1885 + 0.1152e4 * t1888 + 0.128e3 * t1933 - 0.96e2 * t1935 - 0.32e2 * t1937;
  t1945 = t858 * t866 / 0.2e1 + t1914 * t863 / 0.4e1 - 0.3e1 / 0.4e1 * t1917 * t1897 - 0.3e1 / 0.2e1 * t1920 * t863 + 0.2e1 * t1923 * t1897 - 0.3e1 / 0.2e1 * t862 * t1926 + t871 * t1926 / 0.4e1 + t1939 * t53 / 0.3e1 - 0.128e3 / 0.3e1 * t1933 + 0.48e2 * t1935 + 0.16e2 * t1937;
  t1947 = my_piecewise3(t23, t1853 * t42 / 0.8671998246912e15 - t1856 * t367 / 0.180666630144e14 + t1859 * t797 / 0.10627448832e13 - t835 * t806 / 0.180666630144e14 - t1866 * t1801 / 0.1771241472e12 + t840 * t1849 / 0.10627448832e13 - t391 * t1836 / 0.541999890432e14, 0.2e1 / 0.3e1 * t1875 * t1876 * t53 + 0.8e1 / 0.3e1 * t410 * t1880 - 0.8e1 / 0.3e1 * t61 * t1880 - 0.256e3 * t1885 - 0.384e3 * t1888 + t405 * t1890 / 0.6e1 + t1896 * t1897 / 0.24e2 - 0.16e2 / 0.3e1 * t1901 * t1876 * t53 + 0.4e1 * t1905 * t866 + t1908 * t406 / 0.2e1 + t1945);
  t1948 = t9 * t1947;
  t1954 = t188 * t427 * t200;
  t1958 = t534 * t77 * t200;
  t1962 = t1050 * t15 * t200;
  t1972 = t1072 * t561 * t1097;
  t1973 = t545 * t1972;
  t1976 = params->b_PBE * t1786;
  t1980 = t1078 * t552;
  t1985 = t548 * t1090;
  t1989 = t75 * t1573 * t556;
  t1993 = t908 * t1581 * t556;
  t1996 = t1590 * t140;
  t1997 = t1996 * t1593;
  t1998 = t191 * t1997;
  t2001 = t1594 * t1597 * t8 * t556;
  t2005 = 0.216e3 * t1976 * t81 * t194 + 0.36e2 * t1980 * t557 - 0.6e2 * t1082 * t1086 + 0.6e1 * t1985 * t1093 + 0.16e3 / 0.3e1 * t553 * t1989 - 0.1e2 * t1091 * t1993 + t1998 * t2001 / 0.9e1 + 0.3584e5 / 0.27e2 * t1792;
  t2006 = t547 * t2005;
  t2007 = t545 * t2006;
  t2010 = -0.168e3 * t67 * t1796 - 0.504e3 * t418 * t1052 - 0.168e3 * t1948 * t201 - 0.504e3 * t887 * t536 + 0.448e3 / 0.9e1 * t67 * t1954 - 0.224e3 * t67 * t1958 - 0.672e3 * t67 * t1962 - 0.224e3 * t418 * t1064 - 0.672e3 * t887 * t540 - 0.1344e4 * t418 * t1056 - 0.1008e4 * t544 * t1973 + 0.168e3 * t544 * t2007;
  t2011 = t1067 * t1098;
  t2016 = t77 * t190;
  t2017 = t2016 * t562;
  t2020 = t66 * t1050;
  t2021 = t9 * t2020;
  t2028 = t417 * t534;
  t2029 = t9 * t2028;
  t2034 = t886 * t188;
  t2035 = t9 * t2034;
  t2038 = t1067 * t1074;
  t2041 = t546 * t546;
  t2042 = 0.1e1 / t2041;
  t2043 = t1073 * t561;
  t2044 = t2042 * t2043;
  t2045 = t545 * t2044;
  t2052 = 0.1344e4 * t1060 * t1068 - 0.1008e4 * t1060 * t1075 + 0.504e3 * t1060 * t1099 + 0.1344e4 * t895 * t1068 - 0.1008e4 * t895 * t1075 + 0.504e3 * t895 * t1099 + 0.672e3 * t544 * t2011 + 0.224e3 * t544 * t2017 + 0.504e3 * t2021 * t563 + 0.1008e4 * t2029 * t563 + 0.504e3 * t2035 * t563 - 0.1344e4 * t544 * t2038 + 0.1008e4 * t544 * t2045;
  tv3rho30 = my_piecewise3(t1, 0, t2010 + t2052);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  tv3rho31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  tv3rho32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2055 = t1369 * t756 * t1392;
  t2056 = t741 * t2055;
  t2059 = t1103 * t574;
  t2062 = t221 * t574;
  t2067 = t223 * t574;
  t2072 = t218 * t574;
  t2077 = t217 * t574;
  t2082 = t216 * t574;
  t2087 = t215 * t574;
  t2093 = 0.14e2 / 0.81e2 * t14 * p->cam_omega * t1213 * t19;
  t2094 = my_piecewise3(t213, -t2093, 0);
  t2105 = t574 * t1112;
  t2111 = 0.131525306744832e17 * t2062 * t1112 - 0.35771992768512e15 * t2067 * t1112 + 0.87107125248e13 * t2072 * t1112 - 0.17564811264e12 * t2077 * t1112 + 0.27495936e10 * t2082 * t1112 - 0.2908224e8 * t2087 * t1112 - 0.1938816e8 * t214 * t2059 - 0.35129622528e12 * t567 * t2059 + 0.36661248e10 * t577 * t2059 + 0.526101226979328e17 * t578 * t2059 - 0.11923997589504e16 * t581 * t2059 + 0.232285667328e14 * t584 * t2059 + 0.38896e5 * t214 * t2094 + 0.18330624e9 * t567 * t2094 + 0.3372443762688e15 * t568 * t2094 - 0.323136e7 * t577 * t2094 - 0.1083999780864e14 * t578 * t2094 + 0.3226189824e12 * t581 * t2094 - 0.836419584e10 * t584 * t2094 + 0.116688e6 * t2105;
  t2114 = t1138 * t597;
  t2117 = t593 * t1145;
  t2123 = 0.1e1 / t230 / t577;
  t2124 = t229 * t2123;
  t2132 = my_piecewise3(t213, 0, -t2093);
  t2133 = t2132 * t242;
  t2136 = t236 * t236;
  t2138 = 0.1e1 / t2136 / t234;
  t2139 = t239 * t2138;
  t2140 = t1152 * t603;
  t2141 = t2140 * t242;
  t2145 = 0.1e1 / t236 / t234;
  t2149 = t1167 * t603;
  t2152 = t1161 * t611;
  t2157 = t608 * t1176;
  t2161 = 0.1e1 / t236 / t602;
  t2162 = t239 * t2161;
  t2165 = t608 * t1167;
  t2168 = t239 * t2145;
  t2172 = t613 * t1155;
  t2177 = t234 * t2140;
  t2179 = t235 * t603;
  t2180 = t2179 * t1155;
  t2192 = t602 * t2132;
  t2194 = t603 * t1155;
  t2196 = t234 * t2132;
  t2198 = 0.768e3 * t2177 + 0.1152e4 * t2180 + 0.128e3 * t2192 - 0.96e2 * t2194 - 0.32e2 * t2196;
  t2204 = -0.3e1 / 0.2e1 * t1168 * t2172 + t1177 * t2172 / 0.4e1 - 0.256e3 * t2177 - 0.384e3 * t2180 + 0.2e1 / 0.3e1 * t2161 * t2140 * t242 + 0.8e1 / 0.3e1 * t617 * t2132 - 0.8e1 / 0.3e1 * t248 * t2132 * t57 + t2198 * t242 / 0.3e1 - 0.128e3 / 0.3e1 * t2192 + 0.48e2 * t2194 + 0.16e2 * t2196;
  t2206 = my_piecewise3(t212, t2111 * t231 / 0.8671998246912e15 - t2114 * t574 / 0.180666630144e14 + t2117 * t1103 / 0.10627448832e13 - t1141 * t1112 / 0.180666630144e14 - t2124 * t2059 / 0.1771241472e12 + t1146 * t2105 / 0.10627448832e13 - t598 * t2094 / 0.541999890432e14, t612 * t2133 / 0.6e1 + t2139 * t2141 / 0.24e2 - 0.16e2 / 0.3e1 * t2145 * t2140 * t242 + 0.4e1 * t2149 * t1172 + t2152 * t613 / 0.2e1 + t1164 * t1172 / 0.2e1 + t2157 * t1169 / 0.4e1 - 0.3e1 / 0.4e1 * t2162 * t2141 - 0.3e1 / 0.2e1 * t2165 * t1169 + 0.2e1 * t2168 * t2141 + t2204);
  t2207 = t9 * t2206;
  t2211 = 0.1e1 / t256 / t1211;
  t2213 = t2211 * t261 * sigma[2];
  t2217 = t288 * t288;
  t2219 = 0.1e1 / t206 / t2217;
  t2221 = t2219 * t261 * sigma[2];
  t2228 = t2217 * rho[1];
  t2229 = 0.1e1 / t2228;
  t2231 = t1592 * t1595 * t2229;
  t2232 = t8 * t261;
  t2233 = t2232 * sigma[2];
  t2234 = t2233 * t633;
  t2240 = t430 * t1339;
  t2244 = t90 * t630;
  t2246 = t8 * t1107;
  t2248 = t94 * t2246 * t68;
  t2250 = 0.56e2 / 0.27e2 * t2244 + 0.16e2 / 0.9e1 * t2248;
  t2252 = t1229 * t646;
  t2255 = t643 * t1235;
  t2260 = t645 * t645;
  t2261 = 0.1e1 / t2260;
  t2262 = t272 * t2261;
  t2263 = t1237 * t656;
  t2266 = t656 * t1248;
  t2273 = 0.1e1 / rho[1];
  t2282 = -0.64e2 * t1646 * t10 * t2273 * t649 + 0.96e2 * t1642 * t639 * t649 - 0.64e2 * t90 * t649 * t630 + 0.24e2 * t2244 - 0.16e2 * t2248;
  t2311 = t94 * t1107 * t68;
  t2313 = 0.16e2 * t1641 * t1030 * t207 * t649 - 0.32e2 / 0.3e1 * t1646 * t8 * t2273 * t649 - 0.32e2 / 0.9e1 * t90 * t695 * t630 + 0.4e1 / 0.3e1 * t90 * t10 * t630 - 0.8e1 / 0.3e1 * t2311;
  t2316 = t1318 * t150 * t10;
  t2322 = t707 * t1030 * t8;
  t2326 = t94 * t1107 * t308;
  t2330 = t90 * t630 * t308;
  t2334 = t324 * t141 * t123;
  t2336 = t124 * t2273 * t308;
  t2341 = t150 * (t2313 * t308 + 0.2e1 * t2316 * t712 - 0.2e1 / 0.3e1 * t1321 * t1325 + 0.4e1 * t2322 * t1266 + 0.8e1 / 0.27e2 * t710 * t2326 - 0.4e1 / 0.3e1 * t1329 * t2330 + 0.8e1 / 0.3e1 * t2334 * t2336 + 0.16e2 / 0.9e1 * t2311);
  t2342 = t694 * t2341;
  t2346 = t144 * t1281 * t73;
  t2353 = t73 * t1107;
  t2354 = t2353 * t329;
  t2357 = t569 * t693;
  t2358 = t2357 * t717;
  t2361 = t1294 * t1334;
  t2368 = t207 * t1299;
  t2369 = t2368 * t1302;
  t2372 = t692 * t692;
  t2373 = 0.1e1 / t2372;
  t2374 = t256 * t2373;
  t2376 = t150 * t1301 * t716;
  t2377 = t2374 * t2376;
  t2380 = t717 * t1333;
  t2381 = t1300 * t2380;
  t2389 = t151 * t308;
  t2400 = t304 * t123 * t124;
  t2407 = -0.28e2 / 0.81e2 * t473 * t2246 * t308 + 0.28e2 / 0.9e1 * t2330 - 0.28e2 / 0.9e1 * t125 * t2273 * t2389 + 0.8e1 / 0.27e2 * t676 * t2353 * t308 - 0.4e1 / 0.3e1 * t1273 * t87 * t630 * t1275 + 0.8e1 / 0.3e1 * t2400 * t2273 * t1030 * t308 - 0.44e2 / 0.81e2 * t2248 + 0.8e1 / 0.27e2 * t2244;
  t2408 = t144 * t2407;
  t2411 = -t691 * t2342 / 0.3e1 - t2346 * t718 - 0.2e1 / 0.9e1 * t684 * t1291 - 0.4e1 / 0.3e1 * t1288 * t1295 - t1288 * t1335 + 0.8e1 / 0.81e2 * t312 * t2354 + 0.2e1 / 0.9e1 * t691 * t2358 - 0.2e1 / 0.3e1 * t691 * t2361 + 0.2e1 / 0.3e1 * t1282 * t687 + 0.2e1 * t1288 * t1303 + 0.4e1 / 0.3e1 * t691 * t2369 - 0.2e1 * t691 * t2377 + 0.2e1 * t691 * t2381 + t2408 * t330 / 0.3e1;
  t2412 = my_piecewise5(t264, -0.3e1 * t1231 * t1248 + 0.6e1 * t1236 * t2266 + 0.6e1 * t2255 * t1237 + t2250 * t285 - 0.3e1 * t2252 * t656 - 0.6e1 * t2262 * t2263 - t647 * t2282, t287, (0.112e4 / 0.27e2 * t129 * t630 * t68 * t87 + 0.224e5 / 0.27e2 * t134 * t1107 * t116 * t73) * t141 / 0.504e5, t2411);
  t2418 = params->kappa * t207 * t71;
  t2420 = 0.5e1 / 0.42e2 * t425 * t2213 * t633 - 0.5e1 / 0.224e3 * t910 * t2221 * t633 - 0.15e2 / 0.112e3 * t425 * t1207 * t1219 + t2231 * t2234 / 0.4032e4 + 0.3e1 / 0.224e3 * t910 * t1215 * t1219 + 0.9e1 / 0.112e3 * t425 * t632 * t2240 + 0.27e2 / 0.56e2 * t263 * t84 * t85 * t2412 + 0.8e2 / 0.27e2 * t2418;
  t2422 = t2420 * t265 * t352;
  t2436 = t341 * t630 * t352;
  t2440 = t730 * t257 * t352;
  t2444 = t1347 * t206 * t352;
  t2447 = params->b_PBE * t2412;
  t2451 = t1375 * t552;
  t2456 = t744 * t1090;
  t2460 = t75 * t2211 * t751;
  t2464 = t908 * t2219 * t751;
  t2467 = t343 * t1997;
  t2470 = t1594 * t2229 * t8 * t751;
  t2474 = 0.216e3 * t2447 * t261 * t346 + 0.36e2 * t2451 * t752 - 0.6e2 * t1379 * t1383 + 0.6e1 * t2456 * t1388 + 0.16e3 / 0.3e1 * t748 * t2460 - 0.1e2 * t1386 * t2464 + t2467 * t2470 / 0.9e1 + 0.3584e5 / 0.27e2 * t2418;
  t2475 = t743 * t2474;
  t2476 = t741 * t2475;
  t2479 = -0.1008e4 * t740 * t2056 - 0.168e3 * t2207 * t353 - 0.168e3 * t255 * t2422 - 0.504e3 * t1194 * t732 - 0.504e3 * t626 * t1349 - 0.1344e4 * t626 * t1353 - 0.224e3 * t626 * t1361 - 0.672e3 * t1194 * t736 + 0.448e3 / 0.9e1 * t255 * t2436 - 0.224e3 * t255 * t2440 - 0.672e3 * t255 * t2444 + 0.168e3 * t740 * t2476;
  t2480 = t1364 * t1393;
  t2485 = t257 * t190;
  t2486 = t2485 * t757;
  t2491 = t254 * t1347;
  t2492 = t9 * t2491;
  t2497 = t625 * t730;
  t2498 = t9 * t2497;
  t2503 = t1193 * t341;
  t2504 = t9 * t2503;
  t2507 = t1364 * t1371;
  t2510 = t742 * t742;
  t2511 = 0.1e1 / t2510;
  t2512 = t1370 * t756;
  t2513 = t2511 * t2512;
  t2514 = t741 * t2513;
  t2521 = 0.1344e4 * t1202 * t1365 - 0.1008e4 * t1202 * t1372 + 0.504e3 * t1202 * t1394 + 0.1344e4 * t1357 * t1365 - 0.1008e4 * t1357 * t1372 + 0.504e3 * t1357 * t1394 + 0.672e3 * t740 * t2480 + 0.224e3 * t740 * t2486 + 0.504e3 * t2492 * t758 + 0.1008e4 * t2498 * t758 + 0.504e3 * t2504 * t758 - 0.1344e4 * t740 * t2507 + 0.1008e4 * t740 * t2514;
  tv3rho33 = my_piecewise3(t205, 0, t2479 + t2521);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2524 = t74 * t362 * t81;
  t2525 = t2524 * t1412;
  t2528 = t7 * t417;
  t2529 = t2528 * params->b_PBE;
  t2530 = t2529 * t1407;
  t2534 = t430 * t526 * t199;
  t2535 = t1410 * t2534;
  t2538 = t2528 * t188;
  t2539 = t2538 * t1459;
  t2542 = t1403 * t534;
  t2543 = t2542 * t1459;
  t2546 = t362 * t1406;
  t2547 = t2546 * t547;
  t2548 = t1457 * t2547;
  t2552 = t548 * params->ax * t1463;
  t2555 = t1458 * t1445;
  t2556 = t1457 * t2555;
  t2558 = t180 * params->ax * t68;
  t2559 = t74 * t81;
  t2560 = t5 * t561;
  t2561 = t2559 * t2560;
  t2562 = t2558 * t2561;
  t2565 = 0.1e1 / t126;
  t2567 = 0.1e1 / t88 / M_PI;
  t2568 = t2565 * t2567;
  t2569 = t547 * params->b_PBE;
  t2570 = t2568 * t2569;
  t2571 = t1457 * t2570;
  t2572 = t180 * t904;
  t2574 = t908 * t8;
  t2575 = t2574 * t1447;
  t2576 = t2572 * t116 * t2575;
  t2580 = t69 * t1406 * t74;
  t2581 = t1404 * t2580;
  t2583 = t16 * t81 * t5;
  t2584 = t181 * t562;
  t2585 = t2583 * t2584;
  t2589 = t1089 * t2567 * t908;
  t2590 = t1404 * t2589;
  t2591 = t2565 * t8;
  t2592 = t2591 * t81;
  t2593 = t2592 * t1412;
  t2596 = t2042 * params->b_PBE;
  t2597 = t2596 * t180;
  t2598 = t1447 * t1073;
  t2599 = t2597 * t2598;
  t2602 = t1445 * t526;
  t2603 = t2602 * t1448;
  t2606 = t1447 * t1097;
  t2607 = t1446 * t2606;
  t2614 = t773 * t1042 * t81 * t5;
  t2618 = t762 * t2034 * t91;
  t2622 = t762 * t2028 * t91;
  t2627 = -0.27e2 / 0.2e1 * t1408 * t2525 - 0.27e2 * t2530 * t1413 - 0.27e2 * t1408 * t2535 + 0.12096e5 * t2539 * t1464 + 0.12096e5 * t2543 * t1464 + 0.6048e4 * t2548 * t1464 + 0.12096e5 * t1460 * t2552 - 0.24192e5 * t2556 * t2562 + 0.336e3 * t2571 * t2576 + 0.27e2 * t2581 * t2585 - 0.3e1 / 0.4e1 * t2590 * t2593 + 0.217728e6 * t1444 * t2599 - 0.145152e6 * t1444 * t2603 - 0.72576e5 * t1444 * t2607 + 0.96768e5 * t1440 * t1454 + 0.36288e5 * t771 * t2614 + 0.36288e5 * t2618 * t776 + 0.72576e5 * t2622 * t776 + 0.72576e5 * t1432 * t1454;
  t2629 = t762 * t2020 * t91;
  t2634 = t1608 * t766;
  t2639 = t762 * t886 * params->b_PBE * t81;
  t2645 = t762 * t1059 * t15;
  t2649 = t762 * t543 * t77;
  t2653 = t762 * t894 * t15;
  t2658 = t919 * t1419;
  t2661 = t2016 * t199;
  t2662 = t431 * t2661;
  t2665 = t181 * t15;
  t2666 = t2665 * t1427;
  t2669 = t190 * t1072;
  t2670 = t2669 * t1073;
  t2671 = t1426 * t2670;
  t2674 = t535 * t190;
  t2675 = t1423 * t2674;
  t2678 = t539 * t190;
  t2679 = t1423 * t2678;
  t2682 = t772 * t1097;
  t2683 = t1426 * t2682;
  t2686 = t762 * t417;
  t2687 = t2686 * t1443;
  t2690 = t2686 * t1424;
  t2693 = t527 * t91;
  t2694 = t2693 * t1427;
  t2697 = -0.162e3 * t1400 * t1416 - 0.216e3 * t1400 * t1420 + 0.216e3 * t1425 * t2666 - 0.162e3 * t1425 * t2671 + 0.81e2 * t1425 * t2683 + 0.162e3 * t1425 * t2694 + 0.162e3 * t2690 * t1428 + 0.72576e5 * t1436 * t1454 - 0.145152e6 * t2675 * t1449 - 0.193536e6 * t2679 * t1449 - 0.145152e6 * t2687 * t1449 + 0.36288e5 * t2629 * t776 - 0.81e2 * t765 * t2634 - 0.81e2 * t2639 * t767 + 0.96768e5 * t2645 * t776 + 0.16128e5 * t2649 * t776 + 0.96768e5 * t2653 * t776 - 0.216e3 * t765 * t2658 - 0.36e2 * t765 * t2662;
  tv3rho2sigma0 = my_piecewise3(t1, 0, t2627 + t2697);

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  tv3rho2sigma2 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  tv3rho2sigma3 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  tv3rho2sigma5 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  tv3rho2sigma6 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2700 = t74 * t569 * t261;
  t2701 = t2700 * t1479;
  t2704 = t7 * t625;
  t2705 = t2704 * t341;
  t2706 = t2705 * t1526;
  t2709 = t2704 * params->b_PBE;
  t2710 = t2709 * t1407;
  t2714 = t430 * t722 * t351;
  t2715 = t1477 * t2714;
  t2719 = t744 * params->ax * t1529;
  t2722 = t1473 * t730;
  t2723 = t2722 * t1526;
  t2726 = t569 * t1406;
  t2727 = t2726 * t743;
  t2728 = t1524 * t2727;
  t2731 = t1525 * t1512;
  t2732 = t1524 * t2731;
  t2734 = t333 * params->ax * t68;
  t2735 = t74 * t261;
  t2736 = t5 * t756;
  t2737 = t2735 * t2736;
  t2738 = t2734 * t2737;
  t2741 = 0.1e1 / t288;
  t2742 = t2741 * t2567;
  t2743 = t743 * params->b_PBE;
  t2744 = t2742 * t2743;
  t2745 = t1524 * t2744;
  t2746 = t333 * t904;
  t2748 = t2574 * t1514;
  t2749 = t2746 * t116 * t2748;
  t2752 = t1474 * t2580;
  t2754 = t207 * t261 * t5;
  t2755 = t334 * t757;
  t2756 = t2754 * t2755;
  t2759 = t1474 * t2589;
  t2760 = t2741 * t8;
  t2761 = t2760 * t261;
  t2762 = t2761 * t1479;
  t2766 = t762 * t739 * t257;
  t2770 = t762 * t1201 * t206;
  t2774 = t762 * t1356 * t206;
  t2777 = t2485 * t351;
  t2778 = t633 * t2777;
  t2783 = t1219 * t1486;
  t2788 = t790 * t1339 * t261 * t5;
  t2793 = -0.27e2 / 0.2e1 * t1475 * t2701 + 0.12096e5 * t2706 * t1530 - 0.27e2 * t2710 * t1480 - 0.27e2 * t1475 * t2715 + 0.12096e5 * t1527 * t2719 + 0.12096e5 * t2723 * t1530 + 0.6048e4 * t2728 * t1530 - 0.24192e5 * t2732 * t2738 + 0.336e3 * t2745 * t2749 + 0.27e2 * t2752 * t2756 - 0.3e1 / 0.4e1 * t2759 * t2762 + 0.16128e5 * t2766 * t793 + 0.96768e5 * t2770 * t793 + 0.96768e5 * t2774 * t793 - 0.36e2 * t782 * t2778 - 0.216e3 * t1470 * t1487 - 0.216e3 * t782 * t2783 + 0.36288e5 * t788 * t2788 + 0.72576e5 * t1499 * t1521;
  t2795 = t762 * t2491 * t265;
  t2803 = t762 * t2503 * t265;
  t2807 = t762 * t2497 * t265;
  t2812 = t762 * t1193 * params->b_PBE * t261;
  t2817 = t2240 * t783;
  t2820 = t723 * t265;
  t2821 = t2820 * t1494;
  t2824 = t1514 * t1392;
  t2825 = t1513 * t2824;
  t2828 = t762 * t625;
  t2829 = t2828 * t1510;
  t2832 = t731 * t190;
  t2833 = t1490 * t2832;
  t2836 = t334 * t206;
  t2837 = t2836 * t1494;
  t2840 = t789 * t1392;
  t2841 = t1493 * t2840;
  t2844 = t2828 * t1491;
  t2847 = t2511 * params->b_PBE;
  t2848 = t2847 * t333;
  t2849 = t1514 * t1370;
  t2850 = t2848 * t2849;
  t2853 = t190 * t1369;
  t2854 = t2853 * t1370;
  t2855 = t1493 * t2854;
  t2858 = t735 * t190;
  t2859 = t1490 * t2858;
  t2862 = t1512 * t722;
  t2863 = t2862 * t1515;
  t2866 = -0.162e3 * t1470 * t1483 + 0.162e3 * t1492 * t2821 + 0.216e3 * t1492 * t2837 + 0.81e2 * t1492 * t2841 - 0.162e3 * t1492 * t2855 + 0.162e3 * t2844 * t1495 + 0.72576e5 * t1503 * t1521 + 0.96768e5 * t1507 * t1521 - 0.72576e5 * t1511 * t2825 + 0.217728e6 * t1511 * t2850 - 0.145152e6 * t1511 * t2863 - 0.145152e6 * t2829 * t1516 - 0.145152e6 * t2833 * t1516 - 0.193536e6 * t2859 * t1516 + 0.36288e5 * t2795 * t793 + 0.36288e5 * t2803 * t793 + 0.72576e5 * t2807 * t793 - 0.81e2 * t2812 * t784 - 0.81e2 * t782 * t2817;
  tv3rho2sigma8 = my_piecewise3(t205, 0, t2793 + t2866);

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2868 = t2528 * t1538;
  t2871 = t1403 * t1534;
  t2872 = t1535 * t1537;
  t2873 = t2872 * t1541;
  t2874 = t2871 * t2873;
  t2876 = t69 * t8 * t74;
  t2877 = t1459 * t2876;
  t2880 = t772 * t526;
  t2881 = t1426 * t2880;
  t2885 = t1541 * t1067 * t547;
  t2888 = t1541 * t91;
  t2889 = t2669 * t561;
  t2890 = t2888 * t2889;
  t2893 = t2528 * t1443;
  t2896 = t1403 * t2674;
  t2899 = t1403 * t2678;
  t2902 = t2042 * t1534;
  t2903 = t2902 * t1540;
  t2905 = t2903 * t2872 * t561;
  t2908 = t1547 * t180;
  t2910 = t2908 * t2872 * t526;
  t2913 = t1458 * t1547;
  t2914 = t1457 * t2913;
  t2915 = t1549 * t2876;
  t2918 = 0.209952e6 * t1539 * t2881 + 0.139968e6 * t1539 * t2885 - 0.209952e6 * t1539 * t2890 + 0.104976e6 * t2868 * t1543 + 0.141087744e9 * t1546 * t2905 - 0.94058496e8 * t1546 * t2910 - 0.47029248e8 * t2893 * t1550 - 0.47029248e8 * t2896 * t1550 - 0.62705664e8 * t2899 * t1550 + 0.11664e5 * t2874 * t2877 - 0.5225472e7 * t2914 * t2915;
  tv3rhosigma20 = my_piecewise3(t1, 0, t2918);

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2919 = t2704 * t1556;
  t2922 = t1473 * t1534;
  t2923 = t1554 * t1537;
  t2924 = t2923 * t1559;
  t2925 = t2922 * t2924;
  t2926 = t1526 * t2876;
  t2929 = t789 * t722;
  t2930 = t1493 * t2929;
  t2934 = t1559 * t1364 * t743;
  t2937 = t1559 * t265;
  t2938 = t2853 * t756;
  t2939 = t2937 * t2938;
  t2942 = t2704 * t1510;
  t2945 = t1473 * t2832;
  t2948 = t1473 * t2858;
  t2951 = t2511 * t1534;
  t2952 = t2951 * t1558;
  t2954 = t2952 * t2923 * t756;
  t2957 = t1565 * t333;
  t2959 = t2957 * t2923 * t722;
  t2962 = t1525 * t1565;
  t2963 = t1524 * t2962;
  t2964 = t1567 * t2876;
  t2967 = 0.209952e6 * t1557 * t2930 + 0.139968e6 * t1557 * t2934 - 0.209952e6 * t1557 * t2939 + 0.104976e6 * t2919 * t1561 + 0.141087744e9 * t1564 * t2954 - 0.94058496e8 * t1564 * t2959 - 0.47029248e8 * t2942 * t1568 - 0.47029248e8 * t2945 * t1568 - 0.62705664e8 * t2948 * t1568 + 0.11664e5 * t2925 * t2926 - 0.5225472e7 * t2963 * t2964;
  tv3rhosigma211 = my_piecewise3(t205, 0, t2967);

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2968 = t1534 * params->b_PBE;
  t2969 = t1535 * t81;
  t2971 = t2968 * t2969 * t85;
  t2972 = t1403 * t2971;
  t2973 = t1540 * t180;
  t2974 = t2973 * t91;
  t2975 = t2669 * t8;
  t2976 = t2974 * t2975;
  t2979 = t2042 * t2968;
  t2982 = t2979 * t2973 * t2969 * t8;
  tv3sigma30 = my_piecewise3(t1, 0, 0.60949905408e11 * t1546 * t2982 - 0.136048896e9 * t2972 * t2976);

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2986 = t1554 * t261;
  t2988 = t2968 * t2986 * t85;
  t2989 = t1473 * t2988;
  t2990 = t1558 * t333;
  t2991 = t2990 * t265;
  t2992 = t2853 * t8;
  t2993 = t2991 * t2992;
  t2996 = t2511 * t2968;
  t2999 = t2996 * t2990 * t2986 * t8;
  tv3sigma39 = my_piecewise3(t205, 0, 0.60949905408e11 * t1564 * t2999 - 0.136048896e9 * t2989 * t2993);

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t7, t8, t9, t10;
  double t11, t12, t14, t15, t16, t18, t19, t22;
  double t23, t24, t25, t26, t27, t28, t29, t32;
  double t34, t40, t41, t42, t45, t46, t47, t50;
  double t53, t57, t58, t60, t61, t66, t67, t68;
  double t69, t70, t71, t72, t73, t74, t75, t76;
  double t77, t81, t82, t83, t84, t85, t86, t87;
  double t88, t89, t90, t91, t92, t94, t95, t97;
  double t99, t101, t103, t104, t107, t108, t109, t110;
  double t116, t117, t118, t119, t120, t122, t123, t124;
  double t125, t126, t129, t134, t140, t141, t144, t147;
  double t148, t150, t151, t153, t154, t157, t158, t168;
  double t170, t171, t174, t176, t177, t180, t181, t185;
  double t187, t188, t189, t190, t191, t194, t198, t199;
  double t200, t201, t204, t205, t206, t207, t211, t212;
  double t213, t214, t215, t216, t217, t218, t221, t223;
  double t229, t230, t231, t234, t235, t236, t239, t242;
  double t246, t248, t254, t255, t256, t257, t261, t262;
  double t263, t264, t265, t266, t268, t270, t272, t276;
  double t277, t278, t284, t285, t287, t288, t304, t307;
  double t308, t311, t312, t322, t324, t327, t329, t330;
  double t333, t334, t338, t340, t341, t342, t343, t346;
  double t350, t351, t352, t353, t356, tzk0;

  double t360, t361, t362, t366, t367, t370, t371, t374;
  double t377, t386, t390, t391, t395, t396, t397, t399;
  double t401, t404, t405, t406, t410, t417, t418, t425;
  double t426, t427, t429, t430, t431, t435, t437, t439;
  double t441, t443, t444, t445, t447, t452, t456, t473;
  double t478, t479, t485, t486, t489, t493, t494, t495;
  double t496, t497, t502, t509, t511, t514, t516, t520;
  double t521, t522, t526, t527, t532, t534, t535, t536;
  double t539, t540, t543, t544, t545, t546, t547, t548;
  double t552, t553, t556, t557, t561, t562, t563, tvrho0;
  double t567, t568, t569, t573, t574, t577, t578, t581;
  double t584, t593, t597, t598, t602, t603, t604, t606;
  double t608, t611, t612, t613, t617, t625, t626, t629;
  double t630, t632, t633, t637, t639, t641, t643, t645;
  double t646, t647, t649, t656, t676, t677, t683, t684;
  double t687, t691, t692, t693, t694, t695, t705, t707;
  double t710, t712, t716, t717, t718, t722, t723, t728;
  double t730, t731, t732, t735, t736, t739, t740, t741;
  double t742, t743, t744, t748, t751, t752, t756, t757;
  double t758, tvrho1, t762, t765, t766, t767, t771, t772;
  double t773, t776, tvsigma0, tvsigma1, t782, t783, t784, t788;
  double t789, t790, t793, tvsigma2;

  double t797, t801, t805, t806, t832, t835, t839, t840;
  double t846, t847, t849, t850, t853, t855, t858, t861;
  double t862, t863, t866, t870, t871, t885, t886, t887;
  double t894, t895, t898, t900, t904, t906, t908, t910;
  double t911, t913, t915, t919, t923, t925, t927, t929;
  double t931, t935, t936, t937, t948, t951, t967, t969;
  double t974, t976, t982, t983, t989, t992, t995, t996;
  double t1000, t1001, t1002, t1003, t1004, t1007, t1011, t1018;
  double t1020, t1023, t1027, t1030, t1032, t1036, t1037, t1038;
  double t1042, t1043, t1048, t1050, t1051, t1052, t1055, t1056;
  double t1059, t1060, t1063, t1064, t1067, t1068, t1072, t1073;
  double t1074, t1075, t1078, t1082, t1086, t1089, t1090, t1091;
  double t1093, t1097, t1098, t1099, t1102, tv2rho20, tv2rho21, t1103;
  double t1107, t1111, t1112, t1138, t1141, t1145, t1146, t1152;
  double t1153, t1155, t1156, t1159, t1161, t1164, t1167, t1168;
  double t1169, t1172, t1176, t1177, t1192, t1193, t1194, t1201;
  double t1202, t1205, t1207, t1211, t1213, t1215, t1219, t1223;
  double t1225, t1227, t1229, t1231, t1235, t1236, t1237, t1248;
  double t1266, t1268, t1273, t1275, t1281, t1282, t1288, t1291;
  double t1294, t1295, t1299, t1300, t1301, t1302, t1303, t1309;
  double t1316, t1318, t1321, t1325, t1329, t1333, t1334, t1335;
  double t1339, t1340, t1345, t1347, t1348, t1349, t1352, t1353;
  double t1356, t1357, t1360, t1361, t1364, t1365, t1369, t1370;
  double t1371, t1372, t1375, t1379, t1383, t1386, t1388, t1392;
  double t1393, t1394, t1397, tv2rho22, t1400, t1403, t1404, t1406;
  double t1407, t1408, t1410, t1412, t1413, t1416, t1419, t1420;
  double t1423, t1424, t1425, t1426, t1427, t1428, t1432, t1436;
  double t1440, t1443, t1444, t1445, t1446, t1447, t1448, t1449;
  double t1454, t1457, t1458, t1459, t1460, t1462, t1463, t1464;
  double t1467, tv2rhosigma0, tv2rhosigma1, tv2rhosigma2, tv2rhosigma3, tv2rhosigma4, t1470, t1473;
  double t1474, t1475, t1477, t1479, t1480, t1483, t1486, t1487;
  double t1490, t1491, t1492, t1493, t1494, t1495, t1499, t1503;
  double t1507, t1510, t1511, t1512, t1513, t1514, t1515, t1516;
  double t1521, t1524, t1525, t1526, t1527, t1529, t1530, t1533;
  double tv2rhosigma5, t1534, t1535, t1537, t1538, t1539, t1540, t1541;
  double t1542, t1543, t1546, t1547, t1548, t1549, t1550, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t1554, t1556, t1557, t1558;
  double t1559, t1560, t1561, t1564, t1565, t1566, t1567, t1568;
  double tv2sigma25;

  double t1573, t1575, t1579, t1581, t1583, t1590, t1592, t1593;
  double t1594, t1595, t1596, t1597, t1599, t1600, t1601, t1602;
  double t1608, t1612, t1614, t1616, t1618, t1620, t1623, t1628;
  double t1629, t1630, t1631, t1634, t1638, t1640, t1641, t1642;
  double t1646, t1647, t1656, t1674, t1677, t1680, t1689, t1696;
  double t1697, t1715, t1717, t1720, t1726, t1730, t1736, t1738;
  double t1743, t1744, t1750, t1757, t1760, t1761, t1764, t1767;
  double t1768, t1769, t1771, t1772, t1775, t1776, t1781, t1782;
  double t1785, t1786, t1792, t1794, t1796, t1801, t1804, t1809;
  double t1814, t1819, t1824, t1829, t1835, t1836, t1849, t1853;
  double t1856, t1859, t1865, t1866, t1875, t1876, t1880, t1885;
  double t1887, t1888, t1890, t1893, t1895, t1896, t1897, t1901;
  double t1905, t1908, t1914, t1917, t1920, t1923, t1926, t1933;
  double t1935, t1937, t1939, t1945, t1947, t1948, t1954, t1958;
  double t1962, t1972, t1973, t1976, t1980, t1985, t1989, t1993;
  double t1996, t1997, t1998, t2001, t2005, t2006, t2007, t2010;
  double t2011, t2016, t2017, t2020, t2021, t2028, t2029, t2034;
  double t2035, t2038, t2041, t2042, t2043, t2044, t2045, t2052;
  double tv3rho30, tv3rho31, tv3rho32, t2055, t2056, t2059, t2062, t2067;
  double t2072, t2077, t2082, t2087, t2093, t2094, t2105, t2111;
  double t2114, t2117, t2123, t2124, t2132, t2133, t2136, t2138;
  double t2139, t2140, t2141, t2145, t2149, t2152, t2157, t2161;
  double t2162, t2165, t2168, t2172, t2177, t2179, t2180, t2192;
  double t2194, t2196, t2198, t2204, t2206, t2207, t2211, t2213;
  double t2217, t2219, t2221, t2228, t2229, t2231, t2232, t2233;
  double t2234, t2240, t2244, t2246, t2248, t2250, t2252, t2255;
  double t2260, t2261, t2262, t2263, t2266, t2273, t2282, t2311;
  double t2313, t2316, t2322, t2326, t2330, t2334, t2336, t2341;
  double t2342, t2346, t2353, t2354, t2357, t2358, t2361, t2368;
  double t2369, t2372, t2373, t2374, t2376, t2377, t2380, t2381;
  double t2389, t2400, t2407, t2408, t2411, t2412, t2418, t2420;
  double t2422, t2436, t2440, t2444, t2447, t2451, t2456, t2460;
  double t2464, t2467, t2470, t2474, t2475, t2476, t2479, t2480;
  double t2485, t2486, t2491, t2492, t2497, t2498, t2503, t2504;
  double t2507, t2510, t2511, t2512, t2513, t2514, t2521, tv3rho33;
  double t2524, t2525, t2528, t2529, t2530, t2534, t2535, t2538;
  double t2539, t2542, t2543, t2546, t2547, t2548, t2552, t2555;
  double t2556, t2558, t2559, t2560, t2561, t2562, t2565, t2567;
  double t2568, t2569, t2570, t2571, t2572, t2574, t2575, t2576;
  double t2580, t2581, t2583, t2584, t2585, t2589, t2590, t2591;
  double t2592, t2593, t2596, t2597, t2598, t2599, t2602, t2603;
  double t2606, t2607, t2614, t2618, t2622, t2627, t2629, t2634;
  double t2639, t2645, t2649, t2653, t2658, t2661, t2662, t2665;
  double t2666, t2669, t2670, t2671, t2674, t2675, t2678, t2679;
  double t2682, t2683, t2686, t2687, t2690, t2693, t2694, t2697;
  double tv3rho2sigma0, tv3rho2sigma1, tv3rho2sigma2, tv3rho2sigma3, tv3rho2sigma4, tv3rho2sigma5, tv3rho2sigma6, tv3rho2sigma7;
  double t2700, t2701, t2704, t2705, t2706, t2709, t2710, t2714;
  double t2715, t2719, t2722, t2723, t2726, t2727, t2728, t2731;
  double t2732, t2734, t2735, t2736, t2737, t2738, t2741, t2742;
  double t2743, t2744, t2745, t2746, t2748, t2749, t2752, t2754;
  double t2755, t2756, t2759, t2760, t2761, t2762, t2766, t2770;
  double t2774, t2777, t2778, t2783, t2788, t2793, t2795, t2803;
  double t2807, t2812, t2817, t2820, t2821, t2824, t2825, t2828;
  double t2829, t2832, t2833, t2836, t2837, t2840, t2841, t2844;
  double t2847, t2848, t2849, t2850, t2853, t2854, t2855, t2858;
  double t2859, t2862, t2863, t2866, tv3rho2sigma8, t2868, t2871, t2872;
  double t2873, t2874, t2876, t2877, t2880, t2881, t2885, t2888;
  double t2889, t2890, t2893, t2896, t2899, t2902, t2903, t2905;
  double t2908, t2910, t2913, t2914, t2915, t2918, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t2919, t2922, t2923, t2924, t2925, t2926, t2929;
  double t2930, t2934, t2937, t2938, t2939, t2942, t2945, t2948;
  double t2951, t2952, t2954, t2957, t2959, t2962, t2963, t2964;
  double t2967, tv3rhosigma211, t2968, t2969, t2971, t2972, t2973, t2974;
  double t2975, t2976, t2979, t2982, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2986, t2988, t2989;
  double t2990, t2991, t2992, t2993, t2996, t2999, tv3sigma39;

  double t3018, t3025, t3034, t3035, t3046, t3048, t3049, t3050;
  double t3051, t3052, t3054, t3068, t3072, t3074, t3076, t3098;
  double t3104, t3117, t3132, t3150, t3158, t3164, t3182, t3209;
  double t3222, t3254, t3262, t3277, t3281, t3286, t3319, t3321;
  double t3327, t3329, t3351, t3355, t3356, t3360, t3364, t3415;
  double t3423, t3433, t3448, t3457, t3458, t3463, t3472, t3493;
  double t3495, t3500, t3501, t3514, t3530, t3571, t3604, t3605;
  double t3607, t3609, t3614, t3631, t3641, t3654, t3657, t3659;
  double t3669, t3680, t3682, t3684, t3686, t3690, t3693, t3720;
  double t3722, t3736, tv4rho40, tv4rho41, tv4rho42, tv4rho43, t3744, t3751;
  double t3760, t3761, t3773, t3787, t3791, t3793, t3795, t3817;
  double t3823, t3847, t3859, t3871, t3894, t3939, t3978, t3985;
  double t4005, t4026, t4031, t4033, t4039, t4041, t4070, t4072;
  double t4093, t4094, t4105, t4107, t4148, t4181, t4182, t4184;
  double t4186, t4196, t4203, t4213, t4232, t4236, t4243, t4252;
  double t4257, t4259, t4261, t4263, t4267, t4270, t4298, t4300;
  double t4304, t4338, t4340, t4393, t4402, t4408, t4412, t4416;
  double t4417, t4437, t4438, t4443, t4457, tv4rho44, t4460, t4482;
  double t4484, t4510, t4527, t4565, t4574, t4578, t4611, t4615;
  double t4616, t4629, t4661, t4701, t4745, t4755, t4789, t4794;
  double t4817, t4838, tv4rho3sigma0, tv4rho3sigma1, tv4rho3sigma2, tv4rho3sigma3, tv4rho3sigma4, tv4rho3sigma5;
  double tv4rho3sigma6, tv4rho3sigma7, tv4rho3sigma8, tv4rho3sigma9, tv4rho3sigma10, t4877, t4904, t4958;
  double t4995, t5038, t5078, t5079, t5086, t5112, t5119, t5126;
  double t5141, t5163, t5167, t5203, t5214, tv4rho3sigma11, t5222, t5237;
  double t5251, t5302, t5354, t5380, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, tv4rho2sigma25, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, tv4rho2sigma211;
  double tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t5400, t5465, t5524;
  double t5541, tv4rho2sigma217, t5552, t5581, t5598, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32;
  double tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, tv4rhosigma39, tv4rhosigma310;
  double tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318;
  double t5635, t5652, tv4rhosigma319, t5653, t5654, t5658, tv4sigma40, tv4sigma41;
  double tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49;
  double tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t5674, t5678, tv4sigma414;

  gga_x_pbe_erf_gws_params *params;
  assert(p->params != NULL);
  params = (gga_x_pbe_erf_gws_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = 0.2e1 <= p->zeta_threshold;
  t3 = POW_1_3(p->zeta_threshold);
  t5 = M_CBRT2;
  t7 = my_piecewise3(t2, t3 * p->zeta_threshold, 0.2e1 * t5);
  t8 = M_CBRT3;
  t9 = t7 * t8;
  t10 = t8 * t8;
  t11 = M_CBRTPI;
  t12 = t11 * t11;
  t14 = t10 / t12;
  t15 = POW_1_3(rho[0]);
  t16 = 0.1e1 / t15;
  t18 = my_piecewise3(t2, t3, t5);
  t19 = 0.1e1 / t18;
  t22 = t14 * p->cam_omega * t16 * t19 / 0.6e1;
  t23 = 0.135e1 <= t22;
  t24 = 0.135e1 < t22;
  t25 = my_piecewise3(t24, t22, 0.135e1);
  t26 = t25 * t25;
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = t27 * t27;
  t32 = t29 * t27;
  t34 = t29 * t26;
  t40 = 0.240888840192e14 * t29 * t28 + 0.19448e5 * t26 - 0.80784e6 * t27 + 0.3055104e8 * t28 - 0.104552448e10 * t29 - 0.90333315072e12 * t32 + 0.3226189824e11 * t34 - 0.429e3;
  t41 = t29 * t29;
  t42 = 0.1e1 / t41;
  t45 = my_piecewise3(t24, 0.135e1, t22);
  t46 = t45 * t45;
  t47 = t46 * t46;
  t50 = 0.32e2 * t47 - 0.16e2 * t46;
  t53 = exp(-0.1e1 / t46 / 0.4e1);
  t57 = sqrt(M_PI);
  t58 = 0.1e1 / t45;
  t60 = erf(t58 / 0.2e1);
  t61 = t57 * t60;
  t66 = my_piecewise3(t23, t40 * t42 / 0.8671998246912e15, t50 * t53 / 0.3e1 - 0.32e2 / 0.3e1 * t47 - 0.8e1 / 0.3e1 * t61 * t45 + 0.8e1 * t46 + 0.1e1);
  t67 = t9 * t66;
  t68 = p->cam_omega * p->cam_omega;
  t69 = params->ax * t68;
  t70 = t69 * t8;
  t71 = t11 * M_PI;
  t72 = 0.1e1 / t71;
  t73 = t18 * t18;
  t74 = 0.1e1 / t73;
  t75 = t72 * t74;
  t76 = t15 * t15;
  t77 = 0.1e1 / t76;
  t81 = exp(-t70 * t75 * t77 / 0.12e2);
  t82 = params->b_PBE * t81;
  t83 = t82 * sigma[0];
  t84 = t5 * t8;
  t85 = params->kappa + 0.1e1;
  t86 = t22 < 0.5e-1;
  t87 = t73 * t73;
  t88 = M_PI * M_PI;
  t89 = t12 * t88;
  t90 = t87 * t89;
  t91 = t15 * rho[0];
  t92 = t90 * t91;
  t94 = t73 * t71;
  t95 = t8 * t76;
  t97 = t94 * t95 * t68;
  t99 = -0.7e1 * t92 + 0.6e1 * t97;
  t101 = t73 * t18;
  t103 = 0.1e1 / p->cam_omega * t8;
  t104 = t12 * t18;
  t107 = erf(t103 * t104 * t15);
  t108 = t101 * t107;
  t109 = t57 * t88;
  t110 = t108 * t109;
  t116 = t68 * t68;
  t117 = t10 * t116;
  t118 = 0.6e1 * t117;
  t119 = 0.36e2 * t110 * t10 * rho[0] * p->cam_omega + t118 - 0.81e2 * t92 - 0.54e2 * t97;
  t120 = 0.1e1 / t119;
  t122 = 0.1e11 < t22;
  t123 = t88 * t88;
  t124 = t87 * t73;
  t125 = t123 * t124;
  t126 = rho[0] * rho[0];
  t129 = t89 * t8;
  t134 = t71 * t10;
  t140 = t116 * t68;
  t141 = 0.1e1 / t140;
  t144 = t71 * t8;
  t147 = t10 * t68;
  t148 = -0.7e1 / 0.6e1 * t94 * t95 + t147;
  t150 = 0.1e1 / t68;
  t151 = t150 * t10;
  t153 = t151 * t94 * t76;
  t154 = exp(t153);
  t157 = t68 * t148 * t154 - 0.11e2 / 0.6e1 * t97 - t92 - t117;
  t158 = t144 * t157;
  t168 = t94 * t76 * t68;
  t170 = t8 * t116;
  t171 = 0.6e1 * t110 * t8 * rho[0] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t91 - 0.9e1 * t168 + t170;
  t174 = t171 * t154 + 0.6e1 * t168 - t170;
  t176 = 0.1e1 / t174 * t150;
  t177 = t73 * t76 * t176;
  t180 = my_piecewise5(t86, t99 * t120, t122, (0.28e4 * t134 * t76 * t116 * t73 - 0.14e3 * t129 * t91 * t68 * t87 - 0.1863e4 * t125 * t126) * t141 / 0.504e5, t158 * t177 / 0.3e1);
  t181 = t85 * t180;
  t185 = t76 * t126;
  t187 = params->kappa * t185 * t71;
  t188 = 0.27e2 / 0.56e2 * t83 * t84 * t181 + t187;
  t189 = t188 * t91;
  t190 = 0.1e1 / t11;
  t191 = params->b_PBE * t180;
  t194 = sigma[0] * t5 * t8;
  t198 = 0.216e3 * t191 * t81 * t194 + 0.448e3 * t187;
  t199 = 0.1e1 / t198;
  t200 = t190 * t199;
  t201 = t189 * t200;
  t204 = my_piecewise3(t1, 0, -0.168e3 * t67 * t201);
  t205 = rho[1] <= p->dens_threshold;
  t206 = POW_1_3(rho[1]);
  t207 = 0.1e1 / t206;
  t211 = t14 * p->cam_omega * t207 * t19 / 0.6e1;
  t212 = 0.135e1 <= t211;
  t213 = 0.135e1 < t211;
  t214 = my_piecewise3(t213, t211, 0.135e1);
  t215 = t214 * t214;
  t216 = t215 * t215;
  t217 = t216 * t215;
  t218 = t216 * t216;
  t221 = t218 * t216;
  t223 = t218 * t215;
  t229 = 0.240888840192e14 * t218 * t217 + 0.19448e5 * t215 - 0.80784e6 * t216 + 0.3055104e8 * t217 - 0.104552448e10 * t218 - 0.90333315072e12 * t221 + 0.3226189824e11 * t223 - 0.429e3;
  t230 = t218 * t218;
  t231 = 0.1e1 / t230;
  t234 = my_piecewise3(t213, 0.135e1, t211);
  t235 = t234 * t234;
  t236 = t235 * t235;
  t239 = 0.32e2 * t236 - 0.16e2 * t235;
  t242 = exp(-0.1e1 / t235 / 0.4e1);
  t246 = 0.1e1 / t234;
  t248 = erf(t246 / 0.2e1);
  t254 = my_piecewise3(t212, t229 * t231 / 0.8671998246912e15, t239 * t242 / 0.3e1 - 0.32e2 / 0.3e1 * t236 - 0.8e1 / 0.3e1 * t248 * t234 * t57 + 0.8e1 * t235 + 0.1e1);
  t255 = t9 * t254;
  t256 = t206 * t206;
  t257 = 0.1e1 / t256;
  t261 = exp(-t70 * t75 * t257 / 0.12e2);
  t262 = params->b_PBE * t261;
  t263 = t262 * sigma[2];
  t264 = t211 < 0.5e-1;
  t265 = t206 * rho[1];
  t266 = t90 * t265;
  t268 = t8 * t256;
  t270 = t94 * t268 * t68;
  t272 = -0.7e1 * t266 + 0.6e1 * t270;
  t276 = erf(t103 * t104 * t206);
  t277 = t101 * t276;
  t278 = t277 * t109;
  t284 = 0.36e2 * t278 * t10 * rho[1] * p->cam_omega + t118 - 0.81e2 * t266 - 0.54e2 * t270;
  t285 = 0.1e1 / t284;
  t287 = 0.1e11 < t211;
  t288 = rho[1] * rho[1];
  t304 = -0.7e1 / 0.6e1 * t94 * t268 + t147;
  t307 = t151 * t94 * t256;
  t308 = exp(t307);
  t311 = t68 * t304 * t308 - 0.11e2 / 0.6e1 * t270 - t266 - t117;
  t312 = t144 * t311;
  t322 = t94 * t256 * t68;
  t324 = 0.6e1 * t278 * t8 * rho[1] * p->cam_omega - 0.9e1 / 0.2e1 * t90 * t10 * t265 - 0.9e1 * t322 + t170;
  t327 = t324 * t308 - t170 + 0.6e1 * t322;
  t329 = 0.1e1 / t327 * t150;
  t330 = t73 * t256 * t329;
  t333 = my_piecewise5(t264, t272 * t285, t287, (0.28e4 * t134 * t256 * t116 * t73 - 0.14e3 * t129 * t265 * t68 * t87 - 0.1863e4 * t125 * t288) * t141 / 0.504e5, t312 * t330 / 0.3e1);
  t334 = t85 * t333;
  t338 = t256 * t288;
  t340 = params->kappa * t338 * t71;
  t341 = 0.27e2 / 0.56e2 * t263 * t84 * t334 + t340;
  t342 = t341 * t265;
  t343 = params->b_PBE * t333;
  t346 = sigma[2] * t5 * t8;
  t350 = 0.216e3 * t343 * t261 * t346 + 0.448e3 * t340;
  t351 = 0.1e1 / t350;
  t352 = t190 * t351;
  t353 = t342 * t352;
  t356 = my_piecewise3(t205, 0, -0.168e3 * t255 * t353);
  tzk0 = (t204 + t356) / (rho[0] + rho[1]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t360 = t27 * t25;
  t361 = t29 * t360;
  t362 = 0.1e1 / t91;
  t366 = t14 * p->cam_omega * t362 * t19 / 0.18e2;
  t367 = my_piecewise3(t24, -t366, 0);
  t370 = t26 * t25;
  t371 = t29 * t370;
  t374 = t29 * t25;
  t377 = t27 * t370;
  t386 = 0.38896e5 * t25 * t367 + 0.18330624e9 * t360 * t367 + 0.3372443762688e15 * t361 * t367 - 0.323136e7 * t370 * t367 - 0.1083999780864e14 * t371 * t367 + 0.3226189824e12 * t374 * t367 - 0.836419584e10 * t377 * t367;
  t390 = 0.1e1 / t41 / t25;
  t391 = t40 * t390;
  t395 = t46 * t45;
  t396 = my_piecewise3(t24, 0, -t366);
  t397 = t395 * t396;
  t399 = t45 * t396;
  t401 = 0.128e3 * t397 - 0.32e2 * t399;
  t404 = 0.1e1 / t395;
  t405 = t50 * t404;
  t406 = t396 * t53;
  t410 = t53 * t58;
  t417 = my_piecewise3(t23, t386 * t42 / 0.8671998246912e15 - t391 * t367 / 0.541999890432e14, t401 * t53 / 0.3e1 + t405 * t406 / 0.6e1 - 0.128e3 / 0.3e1 * t397 + 0.8e1 / 0.3e1 * t410 * t396 - 0.8e1 / 0.3e1 * t61 * t396 + 0.16e2 * t399);
  t418 = t9 * t417;
  t425 = params->b_PBE * params->ax * t68 * t10 * t72 * t74;
  t426 = t76 * rho[0];
  t427 = 0.1e1 / t426;
  t429 = t427 * t81 * sigma[0];
  t430 = t5 * t85;
  t431 = t430 * t180;
  t435 = t90 * t15;
  t437 = t8 * t16;
  t439 = t94 * t437 * t68;
  t441 = -0.28e2 / 0.3e1 * t435 + 0.4e1 * t439;
  t443 = t119 * t119;
  t444 = 0.1e1 / t443;
  t445 = t99 * t444;
  t447 = exp(-t153);
  t452 = t109 * t10 * p->cam_omega;
  t456 = 0.72e2 * t90 * t447 * t15 + 0.36e2 * t108 * t452 - 0.108e3 * t435 - 0.36e2 * t439;
  t473 = t68 * t71 * t73;
  t478 = t148 * t10 * t71;
  t479 = t73 * t16;
  t485 = -0.7e1 / 0.9e1 * t473 * t437 * t154 + 0.2e1 / 0.3e1 * t478 * t479 * t154 - 0.11e2 / 0.9e1 * t439 - 0.4e1 / 0.3e1 * t435;
  t486 = t144 * t485;
  t489 = t479 * t176;
  t493 = t144 * t157 * t73;
  t494 = t174 * t174;
  t495 = 0.1e1 / t494;
  t496 = t76 * t495;
  t497 = t447 * t10;
  t502 = t109 * t8 * p->cam_omega;
  t509 = t94 * t16 * t68;
  t511 = -0.6e1 * t90 * t10 * t15 + 0.4e1 * t90 * t497 * t15 + 0.6e1 * t108 * t502 - 0.6e1 * t509;
  t514 = t171 * t150 * t10;
  t516 = t94 * t16 * t154;
  t520 = t511 * t154 + 0.2e1 / 0.3e1 * t514 * t516 + 0.4e1 * t509;
  t521 = t150 * t520;
  t522 = t496 * t521;
  t526 = my_piecewise5(t86, t441 * t120 - t445 * t456, t122, (-0.3726e4 * t125 * rho[0] - 0.56e3 / 0.3e1 * t129 * t15 * t68 * t87 + 0.56e4 / 0.3e1 * t134 * t16 * t116 * t73) * t141 / 0.504e5, t486 * t177 / 0.3e1 + 0.2e1 / 0.9e1 * t158 * t489 - t493 * t522 / 0.3e1);
  t527 = t85 * t526;
  t532 = params->kappa * t426 * t71;
  t534 = 0.3e1 / 0.112e3 * t425 * t429 * t431 + 0.27e2 / 0.56e2 * t83 * t84 * t527 + 0.8e1 / 0.3e1 * t532;
  t535 = t534 * t91;
  t536 = t535 * t200;
  t539 = t188 * t15;
  t540 = t539 * t200;
  t543 = t66 * t188;
  t544 = t9 * t543;
  t545 = t91 * t190;
  t546 = t198 * t198;
  t547 = 0.1e1 / t546;
  t548 = params->b_PBE * t526;
  t552 = t69 * t10;
  t553 = t191 * t552;
  t556 = t81 * sigma[0] * t5;
  t557 = t75 * t427 * t556;
  t561 = 0.216e3 * t548 * t81 * t194 + 0.12e2 * t553 * t557 + 0.3584e4 / 0.3e1 * t532;
  t562 = t547 * t561;
  t563 = t545 * t562;
  tvrho0 = my_piecewise3(t1, 0, -0.168e3 * t418 * t201 - 0.168e3 * t67 * t536 - 0.224e3 * t67 * t540 + 0.168e3 * t544 * t563);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t567 = t216 * t214;
  t568 = t218 * t567;
  t569 = 0.1e1 / t265;
  t573 = t14 * p->cam_omega * t569 * t19 / 0.18e2;
  t574 = my_piecewise3(t213, -t573, 0);
  t577 = t215 * t214;
  t578 = t218 * t577;
  t581 = t218 * t214;
  t584 = t216 * t577;
  t593 = 0.38896e5 * t214 * t574 + 0.18330624e9 * t567 * t574 + 0.3372443762688e15 * t568 * t574 - 0.323136e7 * t577 * t574 - 0.1083999780864e14 * t578 * t574 + 0.3226189824e12 * t581 * t574 - 0.836419584e10 * t584 * t574;
  t597 = 0.1e1 / t230 / t214;
  t598 = t229 * t597;
  t602 = t235 * t234;
  t603 = my_piecewise3(t213, 0, -t573);
  t604 = t602 * t603;
  t606 = t234 * t603;
  t608 = 0.128e3 * t604 - 0.32e2 * t606;
  t611 = 0.1e1 / t602;
  t612 = t239 * t611;
  t613 = t603 * t242;
  t617 = t242 * t246;
  t625 = my_piecewise3(t212, t593 * t231 / 0.8671998246912e15 - t598 * t574 / 0.541999890432e14, t608 * t242 / 0.3e1 + t612 * t613 / 0.6e1 - 0.128e3 / 0.3e1 * t604 + 0.8e1 / 0.3e1 * t617 * t603 - 0.8e1 / 0.3e1 * t248 * t603 * t57 + 0.16e2 * t606);
  t626 = t9 * t625;
  t629 = t256 * rho[1];
  t630 = 0.1e1 / t629;
  t632 = t630 * t261 * sigma[2];
  t633 = t430 * t333;
  t637 = t90 * t206;
  t639 = t8 * t207;
  t641 = t94 * t639 * t68;
  t643 = -0.28e2 / 0.3e1 * t637 + 0.4e1 * t641;
  t645 = t284 * t284;
  t646 = 0.1e1 / t645;
  t647 = t272 * t646;
  t649 = exp(-t307);
  t656 = 0.72e2 * t90 * t649 * t206 + 0.36e2 * t277 * t452 - 0.108e3 * t637 - 0.36e2 * t641;
  t676 = t304 * t10 * t71;
  t677 = t73 * t207;
  t683 = -0.7e1 / 0.9e1 * t473 * t639 * t308 + 0.2e1 / 0.3e1 * t676 * t677 * t308 - 0.11e2 / 0.9e1 * t641 - 0.4e1 / 0.3e1 * t637;
  t684 = t144 * t683;
  t687 = t677 * t329;
  t691 = t144 * t311 * t73;
  t692 = t327 * t327;
  t693 = 0.1e1 / t692;
  t694 = t256 * t693;
  t695 = t649 * t10;
  t705 = t94 * t207 * t68;
  t707 = -0.6e1 * t90 * t10 * t206 + 0.4e1 * t90 * t695 * t206 + 0.6e1 * t277 * t502 - 0.6e1 * t705;
  t710 = t324 * t150 * t10;
  t712 = t94 * t207 * t308;
  t716 = t707 * t308 + 0.2e1 / 0.3e1 * t710 * t712 + 0.4e1 * t705;
  t717 = t150 * t716;
  t718 = t694 * t717;
  t722 = my_piecewise5(t264, t643 * t285 - t647 * t656, t287, (-0.3726e4 * t125 * rho[1] - 0.56e3 / 0.3e1 * t129 * t206 * t68 * t87 + 0.56e4 / 0.3e1 * t134 * t207 * t116 * t73) * t141 / 0.504e5, t684 * t330 / 0.3e1 + 0.2e1 / 0.9e1 * t312 * t687 - t691 * t718 / 0.3e1);
  t723 = t85 * t722;
  t728 = params->kappa * t629 * t71;
  t730 = 0.3e1 / 0.112e3 * t425 * t632 * t633 + 0.27e2 / 0.56e2 * t263 * t84 * t723 + 0.8e1 / 0.3e1 * t728;
  t731 = t730 * t265;
  t732 = t731 * t352;
  t735 = t341 * t206;
  t736 = t735 * t352;
  t739 = t254 * t341;
  t740 = t9 * t739;
  t741 = t265 * t190;
  t742 = t350 * t350;
  t743 = 0.1e1 / t742;
  t744 = params->b_PBE * t722;
  t748 = t343 * t552;
  t751 = t261 * sigma[2] * t5;
  t752 = t75 * t630 * t751;
  t756 = 0.216e3 * t744 * t261 * t346 + 0.12e2 * t748 * t752 + 0.3584e4 / 0.3e1 * t728;
  t757 = t743 * t756;
  t758 = t741 * t757;
  tvrho1 = my_piecewise3(t205, 0, -0.168e3 * t255 * t732 - 0.224e3 * t255 * t736 - 0.168e3 * t626 * t353 + 0.168e3 * t740 * t758);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t762 = t7 * t10;
  t765 = t762 * t66 * params->b_PBE * t81;
  t766 = t545 * t199;
  t767 = t431 * t766;
  t771 = t762 * t543 * t91;
  t772 = t190 * t547;
  t773 = t772 * params->b_PBE;
  t776 = t773 * t180 * t81 * t5;
  tvsigma0 = my_piecewise3(t1, 0, -0.81e2 * t765 * t767 + 0.36288e5 * t771 * t776);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t782 = t762 * t254 * params->b_PBE * t261;
  t783 = t741 * t351;
  t784 = t633 * t783;
  t788 = t762 * t739 * t265;
  t789 = t190 * t743;
  t790 = t789 * params->b_PBE;
  t793 = t790 * t333 * t261 * t5;
  tvsigma2 = my_piecewise3(t205, 0, -0.81e2 * t782 * t784 + 0.36288e5 * t788 * t793);

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t797 = t367 * t367;
  t801 = 0.1e1 / t15 / t126;
  t805 = 0.2e1 / 0.27e2 * t14 * p->cam_omega * t801 * t19;
  t806 = my_piecewise3(t24, t805, 0);
  t832 = 0.38896e5 * t25 * t806 - 0.969408e7 * t26 * t797 + 0.9165312e9 * t27 * t797 - 0.5854937088e11 * t28 * t797 + 0.29035708416e13 * t29 * t797 + 0.43841768914944e16 * t32 * t797 - 0.11923997589504e15 * t34 * t797 + 0.18330624e9 * t360 * t806 + 0.3372443762688e15 * t361 * t806 - 0.323136e7 * t370 * t806 - 0.1083999780864e14 * t371 * t806 + 0.3226189824e12 * t374 * t806 - 0.836419584e10 * t377 * t806 + 0.38896e5 * t797;
  t835 = t386 * t390;
  t839 = 0.1e1 / t41 / t26;
  t840 = t40 * t839;
  t846 = t396 * t396;
  t847 = t46 * t846;
  t849 = my_piecewise3(t24, 0, t805);
  t850 = t395 * t849;
  t853 = t45 * t849;
  t855 = 0.384e3 * t847 + 0.128e3 * t850 - 0.32e2 * t846 - 0.32e2 * t853;
  t858 = t401 * t404;
  t861 = 0.1e1 / t47;
  t862 = t50 * t861;
  t863 = t846 * t53;
  t866 = t849 * t53;
  t870 = 0.1e1 / t47 / t46;
  t871 = t50 * t870;
  t885 = t855 * t53 / 0.3e1 + t858 * t406 / 0.3e1 - t862 * t863 / 0.2e1 + t405 * t866 / 0.6e1 + t871 * t863 / 0.12e2 - 0.128e3 * t847 - 0.128e3 / 0.3e1 * t850 + 0.4e1 / 0.3e1 * t861 * t846 * t53 + 0.8e1 / 0.3e1 * t410 * t849 - 0.8e1 / 0.3e1 * t61 * t849 + 0.16e2 * t846 + 0.16e2 * t853;
  t886 = my_piecewise3(t23, t832 * t42 / 0.8671998246912e15 - t835 * t367 / 0.270999945216e14 + t840 * t797 / 0.31882346496e13 - t391 * t806 / 0.541999890432e14, t885);
  t887 = t9 * t886;
  t894 = t417 * t188;
  t895 = t9 * t894;
  t898 = 0.1e1 / t185;
  t900 = t898 * t81 * sigma[0];
  t904 = params->ax * params->ax;
  t906 = 0.1e1 / t89;
  t908 = 0.1e1 / t87;
  t910 = params->b_PBE * t904 * t116 * t906 * t908;
  t911 = t126 * rho[0];
  t913 = 0.1e1 / t15 / t911;
  t915 = t913 * t81 * sigma[0];
  t919 = t430 * t526;
  t923 = t90 * t77;
  t925 = t8 * t362;
  t927 = t94 * t925 * t68;
  t929 = -0.28e2 / 0.9e1 * t923 - 0.4e1 / 0.3e1 * t927;
  t931 = t441 * t444;
  t935 = 0.1e1 / t443 / t119;
  t936 = t99 * t935;
  t937 = t456 * t456;
  t948 = -0.48e2 * t125 * t151 * t447 + 0.96e2 * t90 * t447 * t77 - 0.36e2 * t923 + 0.12e2 * t927;
  t951 = 0.3726e4 * t125;
  t967 = t90 * t77 * t154;
  t969 = t73 * t362;
  t974 = t148 * t8 * t89;
  t976 = t150 * t154;
  t982 = 0.7e1 / 0.27e2 * t473 * t925 * t154 - 0.28e2 / 0.9e1 * t967 - 0.2e1 / 0.9e1 * t478 * t969 * t154 + 0.4e1 / 0.3e1 * t974 * t87 * t77 * t976 + 0.11e2 / 0.27e2 * t927 - 0.4e1 / 0.9e1 * t923;
  t983 = t144 * t982;
  t989 = t144 * t485 * t73;
  t992 = t969 * t176;
  t995 = t16 * t495;
  t996 = t995 * t521;
  t1000 = 0.1e1 / t494 / t174;
  t1001 = t76 * t1000;
  t1002 = t520 * t520;
  t1003 = t150 * t1002;
  t1004 = t1001 * t1003;
  t1007 = t150 * t8;
  t1011 = t497 * t77;
  t1018 = t94 * t362 * t68;
  t1020 = -0.8e1 * t125 * t1007 * t447 + 0.16e2 / 0.3e1 * t90 * t1011 - 0.2e1 * t90 * t10 * t77 + 0.2e1 * t1018;
  t1023 = t511 * t150 * t10;
  t1027 = t94 * t362 * t154;
  t1030 = 0.1e1 / t116;
  t1032 = t171 * t1030 * t8;
  t1036 = t1020 * t154 + 0.4e1 / 0.3e1 * t1023 * t516 - 0.2e1 / 0.9e1 * t514 * t1027 + 0.4e1 / 0.3e1 * t1032 * t967 - 0.4e1 / 0.3e1 * t1018;
  t1037 = t150 * t1036;
  t1038 = t496 * t1037;
  t1042 = my_piecewise5(t86, t929 * t120 - t445 * t948 - 0.2e1 * t931 * t456 + 0.2e1 * t936 * t937, t122, (-t951 - 0.56e3 / 0.9e1 * t129 * t77 * t68 * t87 - 0.56e4 / 0.9e1 * t134 * t362 * t116 * t73) * t141 / 0.504e5, t983 * t177 / 0.3e1 + 0.4e1 / 0.9e1 * t486 * t489 - 0.2e1 / 0.3e1 * t989 * t522 - 0.2e1 / 0.27e2 * t158 * t992 - 0.4e1 / 0.9e1 * t493 * t996 + 0.2e1 / 0.3e1 * t493 * t1004 - t493 * t1038 / 0.3e1);
  t1043 = t85 * t1042;
  t1048 = params->kappa * t76 * t71;
  t1050 = -0.5e1 / 0.112e3 * t425 * t900 * t431 + t910 * t915 * t431 / 0.224e3 + 0.3e1 / 0.56e2 * t425 * t429 * t919 + 0.27e2 / 0.56e2 * t83 * t84 * t1043 + 0.4e2 / 0.9e1 * t1048;
  t1051 = t1050 * t91;
  t1052 = t1051 * t200;
  t1055 = t534 * t15;
  t1056 = t1055 * t200;
  t1059 = t66 * t534;
  t1060 = t9 * t1059;
  t1063 = t188 * t77;
  t1064 = t1063 * t200;
  t1067 = t15 * t190;
  t1068 = t1067 * t562;
  t1072 = 0.1e1 / t546 / t198;
  t1073 = t561 * t561;
  t1074 = t1072 * t1073;
  t1075 = t545 * t1074;
  t1078 = params->b_PBE * t1042;
  t1082 = t548 * t552;
  t1086 = t75 * t898 * t556;
  t1089 = t904 * t116;
  t1090 = t1089 * t906;
  t1091 = t191 * t1090;
  t1093 = t908 * t913 * t556;
  t1097 = 0.216e3 * t1078 * t81 * t194 + 0.24e2 * t1082 * t557 - 0.2e2 * t553 * t1086 + 0.2e1 * t1091 * t1093 + 0.1792e5 / 0.9e1 * t1048;
  t1098 = t547 * t1097;
  t1099 = t545 * t1098;
  t1102 = -0.168e3 * t887 * t201 - 0.336e3 * t418 * t536 - 0.448e3 * t418 * t540 + 0.336e3 * t895 * t563 - 0.168e3 * t67 * t1052 - 0.448e3 * t67 * t1056 + 0.336e3 * t1060 * t563 - 0.224e3 / 0.3e1 * t67 * t1064 + 0.448e3 * t544 * t1068 - 0.336e3 * t544 * t1075 + 0.168e3 * t544 * t1099;
  tv2rho20 = my_piecewise3(t1, 0, t1102);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  tv2rho21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1103 = t574 * t574;
  t1107 = 0.1e1 / t206 / t288;
  t1111 = 0.2e1 / 0.27e2 * t14 * p->cam_omega * t1107 * t19;
  t1112 = my_piecewise3(t213, t1111, 0);
  t1138 = -0.969408e7 * t215 * t1103 + 0.9165312e9 * t216 * t1103 - 0.5854937088e11 * t217 * t1103 + 0.29035708416e13 * t218 * t1103 + 0.43841768914944e16 * t221 * t1103 - 0.11923997589504e15 * t223 * t1103 + 0.38896e5 * t214 * t1112 + 0.18330624e9 * t567 * t1112 + 0.3372443762688e15 * t568 * t1112 - 0.323136e7 * t577 * t1112 - 0.1083999780864e14 * t578 * t1112 + 0.3226189824e12 * t581 * t1112 - 0.836419584e10 * t584 * t1112 + 0.38896e5 * t1103;
  t1141 = t593 * t597;
  t1145 = 0.1e1 / t230 / t215;
  t1146 = t229 * t1145;
  t1152 = t603 * t603;
  t1153 = t235 * t1152;
  t1155 = my_piecewise3(t213, 0, t1111);
  t1156 = t602 * t1155;
  t1159 = t234 * t1155;
  t1161 = 0.384e3 * t1153 + 0.128e3 * t1156 - 0.32e2 * t1152 - 0.32e2 * t1159;
  t1164 = t608 * t611;
  t1167 = 0.1e1 / t236;
  t1168 = t239 * t1167;
  t1169 = t1152 * t242;
  t1172 = t1155 * t242;
  t1176 = 0.1e1 / t236 / t235;
  t1177 = t239 * t1176;
  t1192 = t1161 * t242 / 0.3e1 + t1164 * t613 / 0.3e1 - t1168 * t1169 / 0.2e1 + t612 * t1172 / 0.6e1 + t1177 * t1169 / 0.12e2 - 0.128e3 * t1153 - 0.128e3 / 0.3e1 * t1156 + 0.4e1 / 0.3e1 * t1167 * t1152 * t242 + 0.8e1 / 0.3e1 * t617 * t1155 - 0.8e1 / 0.3e1 * t248 * t1155 * t57 + 0.16e2 * t1152 + 0.16e2 * t1159;
  t1193 = my_piecewise3(t212, t1138 * t231 / 0.8671998246912e15 - t1141 * t574 / 0.270999945216e14 + t1146 * t1103 / 0.31882346496e13 - t598 * t1112 / 0.541999890432e14, t1192);
  t1194 = t9 * t1193;
  t1201 = t625 * t341;
  t1202 = t9 * t1201;
  t1205 = 0.1e1 / t338;
  t1207 = t1205 * t261 * sigma[2];
  t1211 = t288 * rho[1];
  t1213 = 0.1e1 / t206 / t1211;
  t1215 = t1213 * t261 * sigma[2];
  t1219 = t430 * t722;
  t1223 = t90 * t257;
  t1225 = t8 * t569;
  t1227 = t94 * t1225 * t68;
  t1229 = -0.28e2 / 0.9e1 * t1223 - 0.4e1 / 0.3e1 * t1227;
  t1231 = t643 * t646;
  t1235 = 0.1e1 / t645 / t284;
  t1236 = t272 * t1235;
  t1237 = t656 * t656;
  t1248 = -0.48e2 * t125 * t151 * t649 + 0.96e2 * t90 * t649 * t257 - 0.36e2 * t1223 + 0.12e2 * t1227;
  t1266 = t90 * t257 * t308;
  t1268 = t73 * t569;
  t1273 = t304 * t8 * t89;
  t1275 = t150 * t308;
  t1281 = 0.7e1 / 0.27e2 * t473 * t1225 * t308 - 0.28e2 / 0.9e1 * t1266 - 0.2e1 / 0.9e1 * t676 * t1268 * t308 + 0.4e1 / 0.3e1 * t1273 * t87 * t257 * t1275 + 0.11e2 / 0.27e2 * t1227 - 0.4e1 / 0.9e1 * t1223;
  t1282 = t144 * t1281;
  t1288 = t144 * t683 * t73;
  t1291 = t1268 * t329;
  t1294 = t207 * t693;
  t1295 = t1294 * t717;
  t1299 = 0.1e1 / t692 / t327;
  t1300 = t256 * t1299;
  t1301 = t716 * t716;
  t1302 = t150 * t1301;
  t1303 = t1300 * t1302;
  t1309 = t695 * t257;
  t1316 = t94 * t569 * t68;
  t1318 = -0.8e1 * t125 * t1007 * t649 + 0.16e2 / 0.3e1 * t90 * t1309 - 0.2e1 * t90 * t10 * t257 + 0.2e1 * t1316;
  t1321 = t707 * t150 * t10;
  t1325 = t94 * t569 * t308;
  t1329 = t324 * t1030 * t8;
  t1333 = t1318 * t308 + 0.4e1 / 0.3e1 * t1321 * t712 - 0.2e1 / 0.9e1 * t710 * t1325 + 0.4e1 / 0.3e1 * t1329 * t1266 - 0.4e1 / 0.3e1 * t1316;
  t1334 = t150 * t1333;
  t1335 = t694 * t1334;
  t1339 = my_piecewise5(t264, t1229 * t285 - 0.2e1 * t1231 * t656 + 0.2e1 * t1236 * t1237 - t647 * t1248, t287, (-t951 - 0.56e3 / 0.9e1 * t129 * t257 * t68 * t87 - 0.56e4 / 0.9e1 * t134 * t569 * t116 * t73) * t141 / 0.504e5, t1282 * t330 / 0.3e1 + 0.4e1 / 0.9e1 * t684 * t687 - 0.2e1 / 0.3e1 * t1288 * t718 - 0.2e1 / 0.27e2 * t312 * t1291 - 0.4e1 / 0.9e1 * t691 * t1295 + 0.2e1 / 0.3e1 * t691 * t1303 - t691 * t1335 / 0.3e1);
  t1340 = t85 * t1339;
  t1345 = params->kappa * t256 * t71;
  t1347 = -0.5e1 / 0.112e3 * t425 * t1207 * t633 + t910 * t1215 * t633 / 0.224e3 + 0.3e1 / 0.56e2 * t425 * t632 * t1219 + 0.27e2 / 0.56e2 * t263 * t84 * t1340 + 0.4e2 / 0.9e1 * t1345;
  t1348 = t1347 * t265;
  t1349 = t1348 * t352;
  t1352 = t730 * t206;
  t1353 = t1352 * t352;
  t1356 = t254 * t730;
  t1357 = t9 * t1356;
  t1360 = t341 * t257;
  t1361 = t1360 * t352;
  t1364 = t206 * t190;
  t1365 = t1364 * t757;
  t1369 = 0.1e1 / t742 / t350;
  t1370 = t756 * t756;
  t1371 = t1369 * t1370;
  t1372 = t741 * t1371;
  t1375 = params->b_PBE * t1339;
  t1379 = t744 * t552;
  t1383 = t75 * t1205 * t751;
  t1386 = t343 * t1090;
  t1388 = t908 * t1213 * t751;
  t1392 = 0.216e3 * t1375 * t261 * t346 + 0.24e2 * t1379 * t752 - 0.2e2 * t748 * t1383 + 0.2e1 * t1386 * t1388 + 0.1792e5 / 0.9e1 * t1345;
  t1393 = t743 * t1392;
  t1394 = t741 * t1393;
  t1397 = -0.168e3 * t1194 * t353 - 0.336e3 * t626 * t732 - 0.448e3 * t626 * t736 + 0.336e3 * t1202 * t758 - 0.168e3 * t255 * t1349 - 0.448e3 * t255 * t1353 + 0.336e3 * t1357 * t758 - 0.224e3 / 0.3e1 * t255 * t1361 + 0.448e3 * t740 * t1365 - 0.336e3 * t740 * t1372 + 0.168e3 * t740 * t1394;
  tv2rho22 = my_piecewise3(t205, 0, t1397);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1400 = t762 * t417 * params->b_PBE * t81;
  t1403 = t7 * t66;
  t1404 = t1403 * params->b_PBE;
  t1406 = 0.1e1 / t12 / M_PI;
  t1407 = t69 * t1406;
  t1408 = t1404 * t1407;
  t1410 = t74 * t16 * t81;
  t1412 = t430 * t180 * t199;
  t1413 = t1410 * t1412;
  t1416 = t919 * t766;
  t1419 = t1067 * t199;
  t1420 = t431 * t1419;
  t1423 = t762 * t66;
  t1424 = t82 * t5;
  t1425 = t1423 * t1424;
  t1426 = t181 * t91;
  t1427 = t772 * t561;
  t1428 = t1426 * t1427;
  t1432 = t762 * t894 * t91;
  t1436 = t762 * t1059 * t91;
  t1440 = t762 * t543 * t15;
  t1443 = t189 * t190;
  t1444 = t1423 * t1443;
  t1445 = t1072 * params->b_PBE;
  t1446 = t1445 * t180;
  t1447 = t81 * t5;
  t1448 = t1447 * t561;
  t1449 = t1446 * t1448;
  t1454 = t773 * t526 * t81 * t5;
  t1457 = t1403 * t188;
  t1458 = t16 * t1406;
  t1459 = t1458 * t547;
  t1460 = t1457 * t1459;
  t1462 = t68 * t74;
  t1463 = t1462 * t1447;
  t1464 = t191 * params->ax * t1463;
  t1467 = -0.81e2 * t1400 * t767 - 0.27e2 / 0.2e1 * t1408 * t1413 - 0.81e2 * t765 * t1416 - 0.108e3 * t765 * t1420 + 0.81e2 * t1425 * t1428 + 0.36288e5 * t1432 * t776 + 0.36288e5 * t1436 * t776 + 0.48384e5 * t1440 * t776 - 0.72576e5 * t1444 * t1449 + 0.36288e5 * t771 * t1454 + 0.6048e4 * t1460 * t1464;
  tv2rhosigma0 = my_piecewise3(t1, 0, t1467);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  tv2rhosigma2 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  tv2rhosigma3 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1470 = t762 * t625 * params->b_PBE * t261;
  t1473 = t7 * t254;
  t1474 = t1473 * params->b_PBE;
  t1475 = t1474 * t1407;
  t1477 = t74 * t207 * t261;
  t1479 = t430 * t333 * t351;
  t1480 = t1477 * t1479;
  t1483 = t1219 * t783;
  t1486 = t1364 * t351;
  t1487 = t633 * t1486;
  t1490 = t762 * t254;
  t1491 = t262 * t5;
  t1492 = t1490 * t1491;
  t1493 = t334 * t265;
  t1494 = t789 * t756;
  t1495 = t1493 * t1494;
  t1499 = t762 * t1201 * t265;
  t1503 = t762 * t1356 * t265;
  t1507 = t762 * t739 * t206;
  t1510 = t342 * t190;
  t1511 = t1490 * t1510;
  t1512 = t1369 * params->b_PBE;
  t1513 = t1512 * t333;
  t1514 = t261 * t5;
  t1515 = t1514 * t756;
  t1516 = t1513 * t1515;
  t1521 = t790 * t722 * t261 * t5;
  t1524 = t1473 * t341;
  t1525 = t207 * t1406;
  t1526 = t1525 * t743;
  t1527 = t1524 * t1526;
  t1529 = t1462 * t1514;
  t1530 = t343 * params->ax * t1529;
  t1533 = -0.81e2 * t1470 * t784 - 0.27e2 / 0.2e1 * t1475 * t1480 - 0.81e2 * t782 * t1483 - 0.108e3 * t782 * t1487 + 0.81e2 * t1492 * t1495 + 0.36288e5 * t1499 * t793 + 0.36288e5 * t1503 * t793 + 0.48384e5 * t1507 * t793 - 0.72576e5 * t1511 * t1516 + 0.36288e5 * t788 * t1521 + 0.6048e4 * t1527 * t1530;
  tv2rhosigma5 = my_piecewise3(t205, 0, t1533);

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1534 = params->b_PBE * params->b_PBE;
  t1535 = t81 * t81;
  t1537 = t5 * t5;
  t1538 = t1534 * t1535 * t1537;
  t1539 = t1403 * t1538;
  t1540 = t180 * t180;
  t1541 = t85 * t1540;
  t1542 = t545 * t547;
  t1543 = t1541 * t1542;
  t1546 = t1403 * t1443;
  t1547 = t1072 * t1534;
  t1548 = t1540 * t1535;
  t1549 = t1548 * t1537;
  t1550 = t1547 * t1549;
  tv2sigma20 = my_piecewise3(t1, 0, 0.104976e6 * t1539 * t1543 - 0.47029248e8 * t1546 * t1550);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1554 = t261 * t261;
  t1556 = t1534 * t1554 * t1537;
  t1557 = t1473 * t1556;
  t1558 = t333 * t333;
  t1559 = t85 * t1558;
  t1560 = t741 * t743;
  t1561 = t1559 * t1560;
  t1564 = t1473 * t1510;
  t1565 = t1369 * t1534;
  t1566 = t1558 * t1554;
  t1567 = t1566 * t1537;
  t1568 = t1565 * t1567;
  tv2sigma25 = my_piecewise3(t205, 0, 0.104976e6 * t1557 * t1561 - 0.47029248e8 * t1564 * t1568);

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1573 = 0.1e1 / t76 / t911;
  t1575 = t1573 * t81 * sigma[0];
  t1579 = t126 * t126;
  t1581 = 0.1e1 / t15 / t1579;
  t1583 = t1581 * t81 * sigma[0];
  t1590 = t904 * params->ax;
  t1592 = params->b_PBE * t1590 * t140;
  t1593 = 0.1e1 / t123;
  t1594 = 0.1e1 / t124;
  t1595 = t1593 * t1594;
  t1596 = t1579 * rho[0];
  t1597 = 0.1e1 / t1596;
  t1599 = t1592 * t1595 * t1597;
  t1600 = t8 * t81;
  t1601 = t1600 * sigma[0];
  t1602 = t1601 * t431;
  t1608 = t430 * t1042;
  t1612 = t90 * t427;
  t1614 = t8 * t801;
  t1616 = t94 * t1614 * t68;
  t1618 = 0.56e2 / 0.27e2 * t1612 + 0.16e2 / 0.9e1 * t1616;
  t1620 = t929 * t444;
  t1623 = t441 * t935;
  t1628 = t443 * t443;
  t1629 = 0.1e1 / t1628;
  t1630 = t99 * t1629;
  t1631 = t937 * t456;
  t1634 = t456 * t948;
  t1638 = t87 * t87;
  t1640 = t11 * t123 * M_PI;
  t1641 = t1638 * t1640;
  t1642 = t1641 * t1030;
  t1646 = t125 * t150;
  t1647 = 0.1e1 / rho[0];
  t1656 = -0.64e2 * t1646 * t10 * t1647 * t447 + 0.96e2 * t1642 * t437 * t447 - 0.64e2 * t90 * t447 * t427 + 0.24e2 * t1612 - 0.16e2 * t1616;
  t1674 = t90 * t427 * t154;
  t1677 = t151 * t154;
  t1680 = t73 * t801;
  t1689 = t148 * t123 * t124;
  t1696 = -0.28e2 / 0.81e2 * t473 * t1614 * t154 + 0.28e2 / 0.9e1 * t1674 - 0.28e2 / 0.9e1 * t125 * t1647 * t1677 + 0.8e1 / 0.27e2 * t478 * t1680 * t154 - 0.4e1 / 0.3e1 * t974 * t87 * t427 * t976 + 0.8e1 / 0.3e1 * t1689 * t1647 * t1030 * t154 - 0.44e2 / 0.81e2 * t1616 + 0.8e1 / 0.27e2 * t1612;
  t1697 = t144 * t1696;
  t1715 = t94 * t801 * t68;
  t1717 = 0.16e2 * t1641 * t1030 * t16 * t447 - 0.32e2 / 0.3e1 * t1646 * t8 * t1647 * t447 - 0.32e2 / 0.9e1 * t90 * t497 * t427 + 0.4e1 / 0.3e1 * t90 * t10 * t427 - 0.8e1 / 0.3e1 * t1715;
  t1720 = t1020 * t150 * t10;
  t1726 = t511 * t1030 * t8;
  t1730 = t94 * t801 * t154;
  t1736 = t171 * t141 * t123;
  t1738 = t124 * t1647 * t154;
  t1743 = t150 * (t1717 * t154 + 0.2e1 * t1720 * t516 - 0.2e1 / 0.3e1 * t1023 * t1027 + 0.4e1 * t1726 * t967 + 0.8e1 / 0.27e2 * t514 * t1730 - 0.4e1 / 0.3e1 * t1032 * t1674 + 0.8e1 / 0.3e1 * t1736 * t1738 + 0.16e2 / 0.9e1 * t1715);
  t1744 = t496 * t1743;
  t1750 = t144 * t982 * t73;
  t1757 = t1680 * t176;
  t1760 = t362 * t495;
  t1761 = t1760 * t521;
  t1764 = t995 * t1037;
  t1767 = t494 * t494;
  t1768 = 0.1e1 / t1767;
  t1769 = t76 * t1768;
  t1771 = t150 * t1002 * t520;
  t1772 = t1769 * t1771;
  t1775 = t521 * t1036;
  t1776 = t1001 * t1775;
  t1781 = t16 * t1000;
  t1782 = t1781 * t1003;
  t1785 = t1697 * t177 / 0.3e1 - t493 * t1744 / 0.3e1 + 0.2e1 / 0.3e1 * t983 * t489 - t1750 * t522 - 0.2e1 / 0.9e1 * t486 * t992 - 0.4e1 / 0.3e1 * t989 * t996 - t989 * t1038 + 0.8e1 / 0.81e2 * t158 * t1757 + 0.2e1 / 0.9e1 * t493 * t1761 - 0.2e1 / 0.3e1 * t493 * t1764 - 0.2e1 * t493 * t1772 + 0.2e1 * t493 * t1776 + 0.2e1 * t989 * t1004 + 0.4e1 / 0.3e1 * t493 * t1782;
  t1786 = my_piecewise5(t86, t1618 * t120 - 0.3e1 * t1620 * t456 + 0.6e1 * t1623 * t937 - 0.6e1 * t1630 * t1631 + 0.6e1 * t936 * t1634 - t445 * t1656 - 0.3e1 * t931 * t948, t122, (0.112e4 / 0.27e2 * t129 * t427 * t68 * t87 + 0.224e5 / 0.27e2 * t134 * t801 * t116 * t73) * t141 / 0.504e5, t1785);
  t1792 = params->kappa * t16 * t71;
  t1794 = 0.5e1 / 0.42e2 * t425 * t1575 * t431 - 0.5e1 / 0.224e3 * t910 * t1583 * t431 - 0.15e2 / 0.112e3 * t425 * t900 * t919 + t1599 * t1602 / 0.4032e4 + 0.3e1 / 0.224e3 * t910 * t915 * t919 + 0.9e1 / 0.112e3 * t425 * t429 * t1608 + 0.27e2 / 0.56e2 * t83 * t84 * t85 * t1786 + 0.8e2 / 0.27e2 * t1792;
  t1796 = t1794 * t91 * t200;
  t1801 = t797 * t367;
  t1804 = t32 * t367;
  t1809 = t34 * t367;
  t1814 = t29 * t367;
  t1819 = t28 * t367;
  t1824 = t27 * t367;
  t1829 = t26 * t367;
  t1835 = 0.14e2 / 0.81e2 * t14 * p->cam_omega * t913 * t19;
  t1836 = my_piecewise3(t24, -t1835, 0);
  t1849 = t367 * t806;
  t1853 = -0.1938816e8 * t25 * t1801 - 0.35129622528e12 * t360 * t1801 + 0.36661248e10 * t370 * t1801 + 0.526101226979328e17 * t371 * t1801 - 0.11923997589504e16 * t374 * t1801 + 0.232285667328e14 * t377 * t1801 + 0.131525306744832e17 * t1804 * t806 - 0.35771992768512e15 * t1809 * t806 + 0.87107125248e13 * t1814 * t806 - 0.17564811264e12 * t1819 * t806 + 0.27495936e10 * t1824 * t806 - 0.2908224e8 * t1829 * t806 + 0.38896e5 * t25 * t1836 + 0.18330624e9 * t360 * t1836 + 0.3372443762688e15 * t361 * t1836 - 0.323136e7 * t370 * t1836 - 0.1083999780864e14 * t371 * t1836 + 0.3226189824e12 * t374 * t1836 - 0.836419584e10 * t377 * t1836 + 0.116688e6 * t1849;
  t1856 = t832 * t390;
  t1859 = t386 * t839;
  t1865 = 0.1e1 / t41 / t370;
  t1866 = t40 * t1865;
  t1875 = 0.1e1 / t47 / t395;
  t1876 = t846 * t396;
  t1880 = my_piecewise3(t24, 0, -t1835);
  t1885 = t45 * t1876;
  t1887 = t46 * t396;
  t1888 = t1887 * t849;
  t1890 = t1880 * t53;
  t1893 = t47 * t47;
  t1895 = 0.1e1 / t1893 / t45;
  t1896 = t50 * t1895;
  t1897 = t1876 * t53;
  t1901 = 0.1e1 / t47 / t45;
  t1905 = t861 * t396;
  t1908 = t855 * t404;
  t1914 = t401 * t870;
  t1917 = t50 * t1875;
  t1920 = t401 * t861;
  t1923 = t50 * t1901;
  t1926 = t406 * t849;
  t1933 = t395 * t1880;
  t1935 = t396 * t849;
  t1937 = t45 * t1880;
  t1939 = 0.768e3 * t1885 + 0.1152e4 * t1888 + 0.128e3 * t1933 - 0.96e2 * t1935 - 0.32e2 * t1937;
  t1945 = t858 * t866 / 0.2e1 + t1914 * t863 / 0.4e1 - 0.3e1 / 0.4e1 * t1917 * t1897 - 0.3e1 / 0.2e1 * t1920 * t863 + 0.2e1 * t1923 * t1897 - 0.3e1 / 0.2e1 * t862 * t1926 + t871 * t1926 / 0.4e1 + t1939 * t53 / 0.3e1 - 0.128e3 / 0.3e1 * t1933 + 0.48e2 * t1935 + 0.16e2 * t1937;
  t1947 = my_piecewise3(t23, t1853 * t42 / 0.8671998246912e15 - t1856 * t367 / 0.180666630144e14 + t1859 * t797 / 0.10627448832e13 - t835 * t806 / 0.180666630144e14 - t1866 * t1801 / 0.1771241472e12 + t840 * t1849 / 0.10627448832e13 - t391 * t1836 / 0.541999890432e14, 0.2e1 / 0.3e1 * t1875 * t1876 * t53 + 0.8e1 / 0.3e1 * t410 * t1880 - 0.8e1 / 0.3e1 * t61 * t1880 - 0.256e3 * t1885 - 0.384e3 * t1888 + t405 * t1890 / 0.6e1 + t1896 * t1897 / 0.24e2 - 0.16e2 / 0.3e1 * t1901 * t1876 * t53 + 0.4e1 * t1905 * t866 + t1908 * t406 / 0.2e1 + t1945);
  t1948 = t9 * t1947;
  t1954 = t188 * t427 * t200;
  t1958 = t534 * t77 * t200;
  t1962 = t1050 * t15 * t200;
  t1972 = t1072 * t561 * t1097;
  t1973 = t545 * t1972;
  t1976 = params->b_PBE * t1786;
  t1980 = t1078 * t552;
  t1985 = t548 * t1090;
  t1989 = t75 * t1573 * t556;
  t1993 = t908 * t1581 * t556;
  t1996 = t1590 * t140;
  t1997 = t1996 * t1593;
  t1998 = t191 * t1997;
  t2001 = t1594 * t1597 * t8 * t556;
  t2005 = 0.216e3 * t1976 * t81 * t194 + 0.36e2 * t1980 * t557 - 0.6e2 * t1082 * t1086 + 0.6e1 * t1985 * t1093 + 0.16e3 / 0.3e1 * t553 * t1989 - 0.1e2 * t1091 * t1993 + t1998 * t2001 / 0.9e1 + 0.3584e5 / 0.27e2 * t1792;
  t2006 = t547 * t2005;
  t2007 = t545 * t2006;
  t2010 = -0.168e3 * t67 * t1796 - 0.504e3 * t418 * t1052 - 0.168e3 * t1948 * t201 - 0.504e3 * t887 * t536 + 0.448e3 / 0.9e1 * t67 * t1954 - 0.224e3 * t67 * t1958 - 0.672e3 * t67 * t1962 - 0.224e3 * t418 * t1064 - 0.672e3 * t887 * t540 - 0.1344e4 * t418 * t1056 - 0.1008e4 * t544 * t1973 + 0.168e3 * t544 * t2007;
  t2011 = t1067 * t1098;
  t2016 = t77 * t190;
  t2017 = t2016 * t562;
  t2020 = t66 * t1050;
  t2021 = t9 * t2020;
  t2028 = t417 * t534;
  t2029 = t9 * t2028;
  t2034 = t886 * t188;
  t2035 = t9 * t2034;
  t2038 = t1067 * t1074;
  t2041 = t546 * t546;
  t2042 = 0.1e1 / t2041;
  t2043 = t1073 * t561;
  t2044 = t2042 * t2043;
  t2045 = t545 * t2044;
  t2052 = 0.1344e4 * t1060 * t1068 - 0.1008e4 * t1060 * t1075 + 0.504e3 * t1060 * t1099 + 0.1344e4 * t895 * t1068 - 0.1008e4 * t895 * t1075 + 0.504e3 * t895 * t1099 + 0.672e3 * t544 * t2011 + 0.224e3 * t544 * t2017 + 0.504e3 * t2021 * t563 + 0.1008e4 * t2029 * t563 + 0.504e3 * t2035 * t563 - 0.1344e4 * t544 * t2038 + 0.1008e4 * t544 * t2045;
  tv3rho30 = my_piecewise3(t1, 0, t2010 + t2052);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  tv3rho31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  tv3rho32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2055 = t1369 * t756 * t1392;
  t2056 = t741 * t2055;
  t2059 = t1103 * t574;
  t2062 = t221 * t574;
  t2067 = t223 * t574;
  t2072 = t218 * t574;
  t2077 = t217 * t574;
  t2082 = t216 * t574;
  t2087 = t215 * t574;
  t2093 = 0.14e2 / 0.81e2 * t14 * p->cam_omega * t1213 * t19;
  t2094 = my_piecewise3(t213, -t2093, 0);
  t2105 = t574 * t1112;
  t2111 = 0.131525306744832e17 * t2062 * t1112 - 0.35771992768512e15 * t2067 * t1112 + 0.87107125248e13 * t2072 * t1112 - 0.17564811264e12 * t2077 * t1112 + 0.27495936e10 * t2082 * t1112 - 0.2908224e8 * t2087 * t1112 - 0.1938816e8 * t214 * t2059 - 0.35129622528e12 * t567 * t2059 + 0.36661248e10 * t577 * t2059 + 0.526101226979328e17 * t578 * t2059 - 0.11923997589504e16 * t581 * t2059 + 0.232285667328e14 * t584 * t2059 + 0.38896e5 * t214 * t2094 + 0.18330624e9 * t567 * t2094 + 0.3372443762688e15 * t568 * t2094 - 0.323136e7 * t577 * t2094 - 0.1083999780864e14 * t578 * t2094 + 0.3226189824e12 * t581 * t2094 - 0.836419584e10 * t584 * t2094 + 0.116688e6 * t2105;
  t2114 = t1138 * t597;
  t2117 = t593 * t1145;
  t2123 = 0.1e1 / t230 / t577;
  t2124 = t229 * t2123;
  t2132 = my_piecewise3(t213, 0, -t2093);
  t2133 = t2132 * t242;
  t2136 = t236 * t236;
  t2138 = 0.1e1 / t2136 / t234;
  t2139 = t239 * t2138;
  t2140 = t1152 * t603;
  t2141 = t2140 * t242;
  t2145 = 0.1e1 / t236 / t234;
  t2149 = t1167 * t603;
  t2152 = t1161 * t611;
  t2157 = t608 * t1176;
  t2161 = 0.1e1 / t236 / t602;
  t2162 = t239 * t2161;
  t2165 = t608 * t1167;
  t2168 = t239 * t2145;
  t2172 = t613 * t1155;
  t2177 = t234 * t2140;
  t2179 = t235 * t603;
  t2180 = t2179 * t1155;
  t2192 = t602 * t2132;
  t2194 = t603 * t1155;
  t2196 = t234 * t2132;
  t2198 = 0.768e3 * t2177 + 0.1152e4 * t2180 + 0.128e3 * t2192 - 0.96e2 * t2194 - 0.32e2 * t2196;
  t2204 = -0.3e1 / 0.2e1 * t1168 * t2172 + t1177 * t2172 / 0.4e1 - 0.256e3 * t2177 - 0.384e3 * t2180 + 0.2e1 / 0.3e1 * t2161 * t2140 * t242 + 0.8e1 / 0.3e1 * t617 * t2132 - 0.8e1 / 0.3e1 * t248 * t2132 * t57 + t2198 * t242 / 0.3e1 - 0.128e3 / 0.3e1 * t2192 + 0.48e2 * t2194 + 0.16e2 * t2196;
  t2206 = my_piecewise3(t212, t2111 * t231 / 0.8671998246912e15 - t2114 * t574 / 0.180666630144e14 + t2117 * t1103 / 0.10627448832e13 - t1141 * t1112 / 0.180666630144e14 - t2124 * t2059 / 0.1771241472e12 + t1146 * t2105 / 0.10627448832e13 - t598 * t2094 / 0.541999890432e14, t612 * t2133 / 0.6e1 + t2139 * t2141 / 0.24e2 - 0.16e2 / 0.3e1 * t2145 * t2140 * t242 + 0.4e1 * t2149 * t1172 + t2152 * t613 / 0.2e1 + t1164 * t1172 / 0.2e1 + t2157 * t1169 / 0.4e1 - 0.3e1 / 0.4e1 * t2162 * t2141 - 0.3e1 / 0.2e1 * t2165 * t1169 + 0.2e1 * t2168 * t2141 + t2204);
  t2207 = t9 * t2206;
  t2211 = 0.1e1 / t256 / t1211;
  t2213 = t2211 * t261 * sigma[2];
  t2217 = t288 * t288;
  t2219 = 0.1e1 / t206 / t2217;
  t2221 = t2219 * t261 * sigma[2];
  t2228 = t2217 * rho[1];
  t2229 = 0.1e1 / t2228;
  t2231 = t1592 * t1595 * t2229;
  t2232 = t8 * t261;
  t2233 = t2232 * sigma[2];
  t2234 = t2233 * t633;
  t2240 = t430 * t1339;
  t2244 = t90 * t630;
  t2246 = t8 * t1107;
  t2248 = t94 * t2246 * t68;
  t2250 = 0.56e2 / 0.27e2 * t2244 + 0.16e2 / 0.9e1 * t2248;
  t2252 = t1229 * t646;
  t2255 = t643 * t1235;
  t2260 = t645 * t645;
  t2261 = 0.1e1 / t2260;
  t2262 = t272 * t2261;
  t2263 = t1237 * t656;
  t2266 = t656 * t1248;
  t2273 = 0.1e1 / rho[1];
  t2282 = -0.64e2 * t1646 * t10 * t2273 * t649 + 0.96e2 * t1642 * t639 * t649 - 0.64e2 * t90 * t649 * t630 + 0.24e2 * t2244 - 0.16e2 * t2248;
  t2311 = t94 * t1107 * t68;
  t2313 = 0.16e2 * t1641 * t1030 * t207 * t649 - 0.32e2 / 0.3e1 * t1646 * t8 * t2273 * t649 - 0.32e2 / 0.9e1 * t90 * t695 * t630 + 0.4e1 / 0.3e1 * t90 * t10 * t630 - 0.8e1 / 0.3e1 * t2311;
  t2316 = t1318 * t150 * t10;
  t2322 = t707 * t1030 * t8;
  t2326 = t94 * t1107 * t308;
  t2330 = t90 * t630 * t308;
  t2334 = t324 * t141 * t123;
  t2336 = t124 * t2273 * t308;
  t2341 = t150 * (t2313 * t308 + 0.2e1 * t2316 * t712 - 0.2e1 / 0.3e1 * t1321 * t1325 + 0.4e1 * t2322 * t1266 + 0.8e1 / 0.27e2 * t710 * t2326 - 0.4e1 / 0.3e1 * t1329 * t2330 + 0.8e1 / 0.3e1 * t2334 * t2336 + 0.16e2 / 0.9e1 * t2311);
  t2342 = t694 * t2341;
  t2346 = t144 * t1281 * t73;
  t2353 = t73 * t1107;
  t2354 = t2353 * t329;
  t2357 = t569 * t693;
  t2358 = t2357 * t717;
  t2361 = t1294 * t1334;
  t2368 = t207 * t1299;
  t2369 = t2368 * t1302;
  t2372 = t692 * t692;
  t2373 = 0.1e1 / t2372;
  t2374 = t256 * t2373;
  t2376 = t150 * t1301 * t716;
  t2377 = t2374 * t2376;
  t2380 = t717 * t1333;
  t2381 = t1300 * t2380;
  t2389 = t151 * t308;
  t2400 = t304 * t123 * t124;
  t2407 = -0.28e2 / 0.81e2 * t473 * t2246 * t308 + 0.28e2 / 0.9e1 * t2330 - 0.28e2 / 0.9e1 * t125 * t2273 * t2389 + 0.8e1 / 0.27e2 * t676 * t2353 * t308 - 0.4e1 / 0.3e1 * t1273 * t87 * t630 * t1275 + 0.8e1 / 0.3e1 * t2400 * t2273 * t1030 * t308 - 0.44e2 / 0.81e2 * t2248 + 0.8e1 / 0.27e2 * t2244;
  t2408 = t144 * t2407;
  t2411 = -t691 * t2342 / 0.3e1 - t2346 * t718 - 0.2e1 / 0.9e1 * t684 * t1291 - 0.4e1 / 0.3e1 * t1288 * t1295 - t1288 * t1335 + 0.8e1 / 0.81e2 * t312 * t2354 + 0.2e1 / 0.9e1 * t691 * t2358 - 0.2e1 / 0.3e1 * t691 * t2361 + 0.2e1 / 0.3e1 * t1282 * t687 + 0.2e1 * t1288 * t1303 + 0.4e1 / 0.3e1 * t691 * t2369 - 0.2e1 * t691 * t2377 + 0.2e1 * t691 * t2381 + t2408 * t330 / 0.3e1;
  t2412 = my_piecewise5(t264, -0.3e1 * t1231 * t1248 + 0.6e1 * t1236 * t2266 + 0.6e1 * t2255 * t1237 + t2250 * t285 - 0.3e1 * t2252 * t656 - 0.6e1 * t2262 * t2263 - t647 * t2282, t287, (0.112e4 / 0.27e2 * t129 * t630 * t68 * t87 + 0.224e5 / 0.27e2 * t134 * t1107 * t116 * t73) * t141 / 0.504e5, t2411);
  t2418 = params->kappa * t207 * t71;
  t2420 = 0.5e1 / 0.42e2 * t425 * t2213 * t633 - 0.5e1 / 0.224e3 * t910 * t2221 * t633 - 0.15e2 / 0.112e3 * t425 * t1207 * t1219 + t2231 * t2234 / 0.4032e4 + 0.3e1 / 0.224e3 * t910 * t1215 * t1219 + 0.9e1 / 0.112e3 * t425 * t632 * t2240 + 0.27e2 / 0.56e2 * t263 * t84 * t85 * t2412 + 0.8e2 / 0.27e2 * t2418;
  t2422 = t2420 * t265 * t352;
  t2436 = t341 * t630 * t352;
  t2440 = t730 * t257 * t352;
  t2444 = t1347 * t206 * t352;
  t2447 = params->b_PBE * t2412;
  t2451 = t1375 * t552;
  t2456 = t744 * t1090;
  t2460 = t75 * t2211 * t751;
  t2464 = t908 * t2219 * t751;
  t2467 = t343 * t1997;
  t2470 = t1594 * t2229 * t8 * t751;
  t2474 = 0.216e3 * t2447 * t261 * t346 + 0.36e2 * t2451 * t752 - 0.6e2 * t1379 * t1383 + 0.6e1 * t2456 * t1388 + 0.16e3 / 0.3e1 * t748 * t2460 - 0.1e2 * t1386 * t2464 + t2467 * t2470 / 0.9e1 + 0.3584e5 / 0.27e2 * t2418;
  t2475 = t743 * t2474;
  t2476 = t741 * t2475;
  t2479 = -0.1008e4 * t740 * t2056 - 0.168e3 * t2207 * t353 - 0.168e3 * t255 * t2422 - 0.504e3 * t1194 * t732 - 0.504e3 * t626 * t1349 - 0.1344e4 * t626 * t1353 - 0.224e3 * t626 * t1361 - 0.672e3 * t1194 * t736 + 0.448e3 / 0.9e1 * t255 * t2436 - 0.224e3 * t255 * t2440 - 0.672e3 * t255 * t2444 + 0.168e3 * t740 * t2476;
  t2480 = t1364 * t1393;
  t2485 = t257 * t190;
  t2486 = t2485 * t757;
  t2491 = t254 * t1347;
  t2492 = t9 * t2491;
  t2497 = t625 * t730;
  t2498 = t9 * t2497;
  t2503 = t1193 * t341;
  t2504 = t9 * t2503;
  t2507 = t1364 * t1371;
  t2510 = t742 * t742;
  t2511 = 0.1e1 / t2510;
  t2512 = t1370 * t756;
  t2513 = t2511 * t2512;
  t2514 = t741 * t2513;
  t2521 = 0.1344e4 * t1202 * t1365 - 0.1008e4 * t1202 * t1372 + 0.504e3 * t1202 * t1394 + 0.1344e4 * t1357 * t1365 - 0.1008e4 * t1357 * t1372 + 0.504e3 * t1357 * t1394 + 0.672e3 * t740 * t2480 + 0.224e3 * t740 * t2486 + 0.504e3 * t2492 * t758 + 0.1008e4 * t2498 * t758 + 0.504e3 * t2504 * t758 - 0.1344e4 * t740 * t2507 + 0.1008e4 * t740 * t2514;
  tv3rho33 = my_piecewise3(t205, 0, t2479 + t2521);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2524 = t74 * t362 * t81;
  t2525 = t2524 * t1412;
  t2528 = t7 * t417;
  t2529 = t2528 * params->b_PBE;
  t2530 = t2529 * t1407;
  t2534 = t430 * t526 * t199;
  t2535 = t1410 * t2534;
  t2538 = t2528 * t188;
  t2539 = t2538 * t1459;
  t2542 = t1403 * t534;
  t2543 = t2542 * t1459;
  t2546 = t362 * t1406;
  t2547 = t2546 * t547;
  t2548 = t1457 * t2547;
  t2552 = t548 * params->ax * t1463;
  t2555 = t1458 * t1445;
  t2556 = t1457 * t2555;
  t2558 = t180 * params->ax * t68;
  t2559 = t74 * t81;
  t2560 = t5 * t561;
  t2561 = t2559 * t2560;
  t2562 = t2558 * t2561;
  t2565 = 0.1e1 / t126;
  t2567 = 0.1e1 / t88 / M_PI;
  t2568 = t2565 * t2567;
  t2569 = t547 * params->b_PBE;
  t2570 = t2568 * t2569;
  t2571 = t1457 * t2570;
  t2572 = t180 * t904;
  t2574 = t908 * t8;
  t2575 = t2574 * t1447;
  t2576 = t2572 * t116 * t2575;
  t2580 = t69 * t1406 * t74;
  t2581 = t1404 * t2580;
  t2583 = t16 * t81 * t5;
  t2584 = t181 * t562;
  t2585 = t2583 * t2584;
  t2589 = t1089 * t2567 * t908;
  t2590 = t1404 * t2589;
  t2591 = t2565 * t8;
  t2592 = t2591 * t81;
  t2593 = t2592 * t1412;
  t2596 = t2042 * params->b_PBE;
  t2597 = t2596 * t180;
  t2598 = t1447 * t1073;
  t2599 = t2597 * t2598;
  t2602 = t1445 * t526;
  t2603 = t2602 * t1448;
  t2606 = t1447 * t1097;
  t2607 = t1446 * t2606;
  t2614 = t773 * t1042 * t81 * t5;
  t2618 = t762 * t2034 * t91;
  t2622 = t762 * t2028 * t91;
  t2627 = -0.27e2 / 0.2e1 * t1408 * t2525 - 0.27e2 * t2530 * t1413 - 0.27e2 * t1408 * t2535 + 0.12096e5 * t2539 * t1464 + 0.12096e5 * t2543 * t1464 + 0.6048e4 * t2548 * t1464 + 0.12096e5 * t1460 * t2552 - 0.24192e5 * t2556 * t2562 + 0.336e3 * t2571 * t2576 + 0.27e2 * t2581 * t2585 - 0.3e1 / 0.4e1 * t2590 * t2593 + 0.217728e6 * t1444 * t2599 - 0.145152e6 * t1444 * t2603 - 0.72576e5 * t1444 * t2607 + 0.96768e5 * t1440 * t1454 + 0.36288e5 * t771 * t2614 + 0.36288e5 * t2618 * t776 + 0.72576e5 * t2622 * t776 + 0.72576e5 * t1432 * t1454;
  t2629 = t762 * t2020 * t91;
  t2634 = t1608 * t766;
  t2639 = t762 * t886 * params->b_PBE * t81;
  t2645 = t762 * t1059 * t15;
  t2649 = t762 * t543 * t77;
  t2653 = t762 * t894 * t15;
  t2658 = t919 * t1419;
  t2661 = t2016 * t199;
  t2662 = t431 * t2661;
  t2665 = t181 * t15;
  t2666 = t2665 * t1427;
  t2669 = t190 * t1072;
  t2670 = t2669 * t1073;
  t2671 = t1426 * t2670;
  t2674 = t535 * t190;
  t2675 = t1423 * t2674;
  t2678 = t539 * t190;
  t2679 = t1423 * t2678;
  t2682 = t772 * t1097;
  t2683 = t1426 * t2682;
  t2686 = t762 * t417;
  t2687 = t2686 * t1443;
  t2690 = t2686 * t1424;
  t2693 = t527 * t91;
  t2694 = t2693 * t1427;
  t2697 = -0.162e3 * t1400 * t1416 - 0.216e3 * t1400 * t1420 + 0.216e3 * t1425 * t2666 - 0.162e3 * t1425 * t2671 + 0.81e2 * t1425 * t2683 + 0.162e3 * t1425 * t2694 + 0.162e3 * t2690 * t1428 + 0.72576e5 * t1436 * t1454 - 0.145152e6 * t2675 * t1449 - 0.193536e6 * t2679 * t1449 - 0.145152e6 * t2687 * t1449 + 0.36288e5 * t2629 * t776 - 0.81e2 * t765 * t2634 - 0.81e2 * t2639 * t767 + 0.96768e5 * t2645 * t776 + 0.16128e5 * t2649 * t776 + 0.96768e5 * t2653 * t776 - 0.216e3 * t765 * t2658 - 0.36e2 * t765 * t2662;
  tv3rho2sigma0 = my_piecewise3(t1, 0, t2627 + t2697);

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  tv3rho2sigma2 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  tv3rho2sigma3 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  tv3rho2sigma5 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  tv3rho2sigma6 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2700 = t74 * t569 * t261;
  t2701 = t2700 * t1479;
  t2704 = t7 * t625;
  t2705 = t2704 * t341;
  t2706 = t2705 * t1526;
  t2709 = t2704 * params->b_PBE;
  t2710 = t2709 * t1407;
  t2714 = t430 * t722 * t351;
  t2715 = t1477 * t2714;
  t2719 = t744 * params->ax * t1529;
  t2722 = t1473 * t730;
  t2723 = t2722 * t1526;
  t2726 = t569 * t1406;
  t2727 = t2726 * t743;
  t2728 = t1524 * t2727;
  t2731 = t1525 * t1512;
  t2732 = t1524 * t2731;
  t2734 = t333 * params->ax * t68;
  t2735 = t74 * t261;
  t2736 = t5 * t756;
  t2737 = t2735 * t2736;
  t2738 = t2734 * t2737;
  t2741 = 0.1e1 / t288;
  t2742 = t2741 * t2567;
  t2743 = t743 * params->b_PBE;
  t2744 = t2742 * t2743;
  t2745 = t1524 * t2744;
  t2746 = t333 * t904;
  t2748 = t2574 * t1514;
  t2749 = t2746 * t116 * t2748;
  t2752 = t1474 * t2580;
  t2754 = t207 * t261 * t5;
  t2755 = t334 * t757;
  t2756 = t2754 * t2755;
  t2759 = t1474 * t2589;
  t2760 = t2741 * t8;
  t2761 = t2760 * t261;
  t2762 = t2761 * t1479;
  t2766 = t762 * t739 * t257;
  t2770 = t762 * t1201 * t206;
  t2774 = t762 * t1356 * t206;
  t2777 = t2485 * t351;
  t2778 = t633 * t2777;
  t2783 = t1219 * t1486;
  t2788 = t790 * t1339 * t261 * t5;
  t2793 = -0.27e2 / 0.2e1 * t1475 * t2701 + 0.12096e5 * t2706 * t1530 - 0.27e2 * t2710 * t1480 - 0.27e2 * t1475 * t2715 + 0.12096e5 * t1527 * t2719 + 0.12096e5 * t2723 * t1530 + 0.6048e4 * t2728 * t1530 - 0.24192e5 * t2732 * t2738 + 0.336e3 * t2745 * t2749 + 0.27e2 * t2752 * t2756 - 0.3e1 / 0.4e1 * t2759 * t2762 + 0.16128e5 * t2766 * t793 + 0.96768e5 * t2770 * t793 + 0.96768e5 * t2774 * t793 - 0.36e2 * t782 * t2778 - 0.216e3 * t1470 * t1487 - 0.216e3 * t782 * t2783 + 0.36288e5 * t788 * t2788 + 0.72576e5 * t1499 * t1521;
  t2795 = t762 * t2491 * t265;
  t2803 = t762 * t2503 * t265;
  t2807 = t762 * t2497 * t265;
  t2812 = t762 * t1193 * params->b_PBE * t261;
  t2817 = t2240 * t783;
  t2820 = t723 * t265;
  t2821 = t2820 * t1494;
  t2824 = t1514 * t1392;
  t2825 = t1513 * t2824;
  t2828 = t762 * t625;
  t2829 = t2828 * t1510;
  t2832 = t731 * t190;
  t2833 = t1490 * t2832;
  t2836 = t334 * t206;
  t2837 = t2836 * t1494;
  t2840 = t789 * t1392;
  t2841 = t1493 * t2840;
  t2844 = t2828 * t1491;
  t2847 = t2511 * params->b_PBE;
  t2848 = t2847 * t333;
  t2849 = t1514 * t1370;
  t2850 = t2848 * t2849;
  t2853 = t190 * t1369;
  t2854 = t2853 * t1370;
  t2855 = t1493 * t2854;
  t2858 = t735 * t190;
  t2859 = t1490 * t2858;
  t2862 = t1512 * t722;
  t2863 = t2862 * t1515;
  t2866 = -0.162e3 * t1470 * t1483 + 0.162e3 * t1492 * t2821 + 0.216e3 * t1492 * t2837 + 0.81e2 * t1492 * t2841 - 0.162e3 * t1492 * t2855 + 0.162e3 * t2844 * t1495 + 0.72576e5 * t1503 * t1521 + 0.96768e5 * t1507 * t1521 - 0.72576e5 * t1511 * t2825 + 0.217728e6 * t1511 * t2850 - 0.145152e6 * t1511 * t2863 - 0.145152e6 * t2829 * t1516 - 0.145152e6 * t2833 * t1516 - 0.193536e6 * t2859 * t1516 + 0.36288e5 * t2795 * t793 + 0.36288e5 * t2803 * t793 + 0.72576e5 * t2807 * t793 - 0.81e2 * t2812 * t784 - 0.81e2 * t782 * t2817;
  tv3rho2sigma8 = my_piecewise3(t205, 0, t2793 + t2866);

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2868 = t2528 * t1538;
  t2871 = t1403 * t1534;
  t2872 = t1535 * t1537;
  t2873 = t2872 * t1541;
  t2874 = t2871 * t2873;
  t2876 = t69 * t8 * t74;
  t2877 = t1459 * t2876;
  t2880 = t772 * t526;
  t2881 = t1426 * t2880;
  t2885 = t1541 * t1067 * t547;
  t2888 = t1541 * t91;
  t2889 = t2669 * t561;
  t2890 = t2888 * t2889;
  t2893 = t2528 * t1443;
  t2896 = t1403 * t2674;
  t2899 = t1403 * t2678;
  t2902 = t2042 * t1534;
  t2903 = t2902 * t1540;
  t2905 = t2903 * t2872 * t561;
  t2908 = t1547 * t180;
  t2910 = t2908 * t2872 * t526;
  t2913 = t1458 * t1547;
  t2914 = t1457 * t2913;
  t2915 = t1549 * t2876;
  t2918 = 0.209952e6 * t1539 * t2881 + 0.139968e6 * t1539 * t2885 - 0.209952e6 * t1539 * t2890 + 0.104976e6 * t2868 * t1543 + 0.141087744e9 * t1546 * t2905 - 0.94058496e8 * t1546 * t2910 - 0.47029248e8 * t2893 * t1550 - 0.47029248e8 * t2896 * t1550 - 0.62705664e8 * t2899 * t1550 + 0.11664e5 * t2874 * t2877 - 0.5225472e7 * t2914 * t2915;
  tv3rhosigma20 = my_piecewise3(t1, 0, t2918);

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2919 = t2704 * t1556;
  t2922 = t1473 * t1534;
  t2923 = t1554 * t1537;
  t2924 = t2923 * t1559;
  t2925 = t2922 * t2924;
  t2926 = t1526 * t2876;
  t2929 = t789 * t722;
  t2930 = t1493 * t2929;
  t2934 = t1559 * t1364 * t743;
  t2937 = t1559 * t265;
  t2938 = t2853 * t756;
  t2939 = t2937 * t2938;
  t2942 = t2704 * t1510;
  t2945 = t1473 * t2832;
  t2948 = t1473 * t2858;
  t2951 = t2511 * t1534;
  t2952 = t2951 * t1558;
  t2954 = t2952 * t2923 * t756;
  t2957 = t1565 * t333;
  t2959 = t2957 * t2923 * t722;
  t2962 = t1525 * t1565;
  t2963 = t1524 * t2962;
  t2964 = t1567 * t2876;
  t2967 = 0.209952e6 * t1557 * t2930 + 0.139968e6 * t1557 * t2934 - 0.209952e6 * t1557 * t2939 + 0.104976e6 * t2919 * t1561 + 0.141087744e9 * t1564 * t2954 - 0.94058496e8 * t1564 * t2959 - 0.47029248e8 * t2942 * t1568 - 0.47029248e8 * t2945 * t1568 - 0.62705664e8 * t2948 * t1568 + 0.11664e5 * t2925 * t2926 - 0.5225472e7 * t2963 * t2964;
  tv3rhosigma211 = my_piecewise3(t205, 0, t2967);

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2968 = t1534 * params->b_PBE;
  t2969 = t1535 * t81;
  t2971 = t2968 * t2969 * t85;
  t2972 = t1403 * t2971;
  t2973 = t1540 * t180;
  t2974 = t2973 * t91;
  t2975 = t2669 * t8;
  t2976 = t2974 * t2975;
  t2979 = t2042 * t2968;
  t2982 = t2979 * t2973 * t2969 * t8;
  tv3sigma30 = my_piecewise3(t1, 0, 0.60949905408e11 * t1546 * t2982 - 0.136048896e9 * t2972 * t2976);

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2986 = t1554 * t261;
  t2988 = t2968 * t2986 * t85;
  t2989 = t1473 * t2988;
  t2990 = t1558 * t333;
  t2991 = t2990 * t265;
  t2992 = t2853 * t8;
  t2993 = t2991 * t2992;
  t2996 = t2511 * t2968;
  t2999 = t2996 * t2990 * t2986 * t8;
  tv3sigma39 = my_piecewise3(t205, 0, 0.60949905408e11 * t1564 * t2999 - 0.136048896e9 * t2989 * t2993);

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t3018 = 0.1e1 / t76 / t1579;
  t3025 = 0.1e1 / t15 / t1596;
  t3034 = t1579 * t126;
  t3035 = 0.1e1 / t3034;
  t3046 = t904 * t904;
  t3048 = t116 * t116;
  t3049 = params->b_PBE * t3046 * t3048;
  t3050 = 0.1e1 / t1640;
  t3051 = 0.1e1 / t1638;
  t3052 = t3050 * t3051;
  t3054 = 0.1e1 / t76 / t3034;
  t3068 = t430 * t1786;
  t3072 = t90 * t898;
  t3074 = t8 * t913;
  t3076 = t94 * t3074 * t68;
  t3098 = t937 * t937;
  t3104 = t948 * t948;
  t3117 = t1638 * t73 * t12 * t123 * t88;
  t3132 = (-0.28e3 / 0.81e2 * t3072 - 0.112e3 / 0.27e2 * t3076) * t120 - 0.4e1 * t1618 * t444 * t456 + 0.12e2 * t929 * t935 * t937 - 0.6e1 * t1620 * t948 - 0.24e2 * t441 * t1629 * t1631 + 0.24e2 * t1623 * t1634 - 0.4e1 * t931 * t1656 + 0.24e2 * t99 / t1628 / t119 * t3098 - 0.36e2 * t1630 * t937 * t948 + 0.6e1 * t936 * t3104 + 0.8e1 * t936 * t456 * t1656 - t445 * (-0.4e2 * t3072 + 0.96e2 * t1642 * t925 * t447 - 0.192e3 * t3117 * t141 * t77 * t447 + 0.32e3 / 0.3e1 * t1646 * t10 * t2565 * t447 + 0.32e3 / 0.3e1 * t90 * t447 * t898 + 0.112e3 / 0.3e1 * t3076);
  t3150 = t73 * t913;
  t3158 = t90 * t898 * t154;
  t3164 = t1030 * t8;
  t3182 = t10 * t154;
  t3209 = t3117 * t141;
  t3222 = t94 * t913 * t68;
  t3254 = 0.1e1 / t3048;
  t3262 = (0.16e2 * t1641 * t1030 * t362 * t447 - 0.32e2 / 0.3e1 * t3209 * t1011 + 0.16e3 / 0.9e1 * t1646 * t2591 * t447 + 0.16e3 / 0.27e2 * t90 * t497 * t898 - 0.2e2 / 0.9e1 * t90 * t10 * t898 + 0.56e2 / 0.9e1 * t3222) * t154 + 0.8e1 / 0.3e1 * t1717 * t150 * t10 * t516 - 0.4e1 / 0.3e1 * t1720 * t1027 + 0.8e1 * t1020 * t1030 * t8 * t967 + 0.32e2 / 0.27e2 * t1023 * t1730 - 0.16e2 / 0.3e1 * t1726 * t1674 + 0.32e2 / 0.3e1 * t511 * t141 * t123 * t1738 - 0.56e2 / 0.81e2 * t514 * t94 * t913 * t154 + 0.76e2 / 0.27e2 * t1032 * t3158 - 0.16e2 / 0.3e1 * t1736 * t124 * t2565 * t154 + 0.16e2 / 0.9e1 * t171 * t3254 * t1640 * t1638 * t362 * t3182 - 0.112e3 / 0.27e2 * t3222;
  t3277 = -0.4e1 / 0.9e1 * t983 * t992 + 0.32e2 / 0.81e2 * t486 * t1757 + 0.8e1 / 0.9e1 * t1697 * t489 - 0.56e2 / 0.243e3 * t158 * t3150 * t176 + t144 * (0.196e3 / 0.243e3 * t473 * t3074 * t154 - 0.532e3 / 0.81e2 * t3158 + 0.56e2 / 0.9e1 * t125 * t2565 * t1677 - 0.224e3 / 0.27e2 * t1641 * t362 * t3164 * t154 - 0.56e2 / 0.81e2 * t478 * t3150 * t154 + 0.76e2 / 0.27e2 * t974 * t87 * t898 * t976 - 0.16e2 / 0.3e1 * t1689 * t2565 * t1030 * t154 + 0.16e2 / 0.9e1 * t148 * t1640 * t1638 * t362 * t141 * t3182 + 0.308e3 / 0.243e3 * t3076 - 0.4e2 / 0.81e2 * t3072) * t177 / 0.3e1 + 0.16e2 / 0.3e1 * t493 * t1781 * t1775 - 0.12e2 * t493 * t1769 * t1003 * t1036 + 0.8e1 * t989 * t1776 + 0.8e1 / 0.3e1 * t493 * t1001 * t1743 * t520 - t493 * t496 * t150 * t3262 / 0.3e1 - 0.4e1 / 0.3e1 * t144 * t1696 * t73 * t522 - 0.4e1 / 0.3e1 * t989 * t1744 - 0.16e2 / 0.3e1 * t493 * t16 * t1768 * t1771;
  t3281 = t1002 * t1002;
  t3286 = t1036 * t1036;
  t3319 = 0.8e1 * t493 * t76 / t1767 / t174 * t150 * t3281 + 0.2e1 * t493 * t1001 * t150 * t3286 + 0.4e1 * t1750 * t1004 + 0.16e2 / 0.3e1 * t989 * t1782 - 0.8e1 / 0.9e1 * t493 * t362 * t1000 * t1003 - 0.8e1 / 0.9e1 * t493 * t995 * t1743 + 0.8e1 / 0.9e1 * t989 * t1761 - 0.8e1 / 0.3e1 * t989 * t1764 - 0.32e2 / 0.81e2 * t493 * t801 * t495 * t521 + 0.4e1 / 0.9e1 * t493 * t1760 * t1037 - 0.8e1 * t989 * t1772 - 0.8e1 / 0.3e1 * t1750 * t996 - 0.2e1 * t1750 * t1038;
  t3321 = my_piecewise5(t86, t3132, t122, (-0.56e4 / 0.81e2 * t129 * t898 * t68 * t87 - 0.1568e6 / 0.81e2 * t134 * t913 * t116 * t73) * t141 / 0.504e5, t3277 + t3319);
  t3327 = params->kappa * t362 * t71;
  t3329 = -0.55e2 / 0.126e3 * t425 * t3018 * t81 * sigma[0] * t431 + 0.235e3 / 0.2016e4 * t910 * t3025 * t81 * sigma[0] * t431 + 0.1e2 / 0.21e2 * t425 * t1575 * t919 - 0.5e1 / 0.2016e4 * t1592 * t1595 * t3035 * t1602 - 0.5e1 / 0.56e2 * t910 * t1583 * t919 - 0.15e2 / 0.56e2 * t425 * t900 * t1608 + t3049 * t3052 * t3054 * t10 * t81 * sigma[0] * t431 / 0.72576e5 + t1599 * t1601 * t919 / 0.1008e4 + 0.3e1 / 0.112e3 * t910 * t915 * t1608 + 0.3e1 / 0.28e2 * t425 * t429 * t3068 + 0.27e2 / 0.56e2 * t83 * t84 * t85 * t3321 - 0.8e2 / 0.81e2 * t3327;
  t3351 = t1947 * t188;
  t3355 = -0.896e3 * t1948 * t540 - 0.2688e4 * t887 * t1056 - 0.896e3 * t67 * t1794 * t15 * t200 - 0.2688e4 * t418 * t1962 - 0.224e4 / 0.27e2 * t67 * t188 * t898 * t200 - 0.168e3 * t67 * t3329 * t91 * t200 + 0.6048e4 * t544 * t545 * t2042 * t1073 * t1097 - 0.4032e4 * t895 * t1973 - 0.5376e4 * t544 * t1067 * t1972 - 0.4032e4 * t1060 * t1973 - 0.1344e4 * t544 * t545 * t1072 * t2005 * t561 + 0.672e3 * t9 * t3351 * t563;
  t3356 = t886 * t534;
  t3360 = t66 * t1794;
  t3364 = t417 * t1050;
  t3415 = t3046 * t3048 * t3050;
  t3423 = 0.216e3 * params->b_PBE * t3321 * t81 * t194 + 0.48e2 * t1976 * t552 * t557 - 0.12e3 * t1980 * t1086 + 0.12e2 * t1078 * t1090 * t1093 + 0.64e3 / 0.3e1 * t1082 * t1989 - 0.4e2 * t1985 * t1993 + 0.4e1 / 0.9e1 * t548 * t1997 * t2001 - 0.176e4 / 0.9e1 * t553 * t75 * t3018 * t556 + 0.47e3 / 0.9e1 * t1091 * t908 * t3025 * t556 - 0.1e2 / 0.9e1 * t1998 * t1594 * t3035 * t8 * t556 + t191 * t3415 * t3051 * t3054 * t10 * t556 / 0.162e3 - 0.3584e5 / 0.81e2 * t3327;
  t3433 = 0.168e3 * t544 * t545 * t547 * t3423 - 0.896e3 * t544 * t2016 * t1074 + 0.2016e4 * t9 * t3356 * t563 + 0.672e3 * t9 * t3360 * t563 + 0.2016e4 * t9 * t3364 * t563 + 0.672e3 * t1060 * t2007 + 0.2688e4 * t1060 * t2011 + 0.896e3 * t1060 * t2017 + 0.1008e4 * t2021 * t1099 + 0.2016e4 * t2029 * t1099 + 0.672e3 * t895 * t2007 + 0.2688e4 * t895 * t2011 + 0.896e3 * t895 * t2017;
  t3448 = t427 * t190;
  t3457 = 0.1e1 / t2041 / t198;
  t3458 = t1073 * t1073;
  t3463 = t1097 * t1097;
  t3472 = 0.2688e4 * t2021 * t1068 - 0.2016e4 * t2021 * t1075 + 0.896e3 * t544 * t1067 * t2006 + 0.2688e4 * t2035 * t1068 + 0.1008e4 * t2035 * t1099 + 0.5376e4 * t2029 * t1068 - 0.1792e4 / 0.9e1 * t544 * t3448 * t562 + 0.4032e4 * t895 * t2045 + 0.4032e4 * t1060 * t2045 - 0.4032e4 * t544 * t545 * t3457 * t3458 - 0.1008e4 * t544 * t545 * t1072 * t3463 - 0.5376e4 * t895 * t2038 - 0.2016e4 * t2035 * t1075;
  t3493 = t806 * t806;
  t3495 = t797 * t797;
  t3500 = 0.14e3 / 0.243e3 * t14 * p->cam_omega * t1581 * t19;
  t3501 = my_piecewise3(t24, t3500, 0);
  t3514 = t367 * t1836;
  t3530 = 0.38896e5 * t25 * t3501 + 0.1625999671296e15 * t28 * t3495 + 0.87107125248e13 * t29 * t3493 - 0.107315978305536e17 * t29 * t3495 + 0.131525306744832e17 * t32 * t3493 - 0.35771992768512e15 * t34 * t3493 + 0.5787113496772608e18 * t34 * t3495 + 0.18330624e9 * t360 * t3501 + 0.3372443762688e15 * t361 * t3501 - 0.323136e7 * t370 * t3501 - 0.1083999780864e14 * t371 * t3501 + 0.3226189824e12 * t374 * t3501 - 0.836419584e10 * t377 * t3501 + 0.116688e6 * t3493 - 0.1938816e8 * t3495 + 0.155584e6 * t3514;
  t3571 = -0.11632896e9 * t25 * t797 * t806 - 0.210777735168e13 * t360 * t797 * t806 + 0.219967488e11 * t370 * t797 * t806 + 0.3156607361875968e18 * t371 * t797 * t806 - 0.71543985537024e16 * t374 * t797 * t806 + 0.1393714003968e15 * t377 * t797 * t806 + 0.175367075659776e17 * t1804 * t1836 - 0.47695990358016e15 * t1809 * t1836 + 0.116142833664e14 * t1814 * t1836 - 0.23419748352e12 * t1819 * t1836 + 0.36661248e10 * t1824 * t1836 - 0.3877632e8 * t1829 * t1836 - 0.2908224e8 * t26 * t3493 + 0.109983744e11 * t26 * t3495 + 0.27495936e10 * t27 * t3493 - 0.17564811264e13 * t27 * t3495 - 0.17564811264e12 * t28 * t3493;
  t3604 = (t3530 + t3571) * t42 / 0.8671998246912e15 - t1853 * t390 * t367 / 0.135499972608e14 + t832 * t839 * t797 / 0.5313724416e12 - t1856 * t806 / 0.90333315072e13 - t386 * t1865 * t1801 / 0.442810368e11 + t1859 * t1849 / 0.2656862208e12 - t835 * t1836 / 0.135499972608e14 + 0.19e2 / 0.1771241472e12 * t40 / t41 / t27 * t3495 - t1866 * t797 * t806 / 0.295206912e11 + t840 * t3493 / 0.10627448832e13 + t840 * t3514 / 0.7970586624e12 - t391 * t3501 / 0.541999890432e14;
  t3605 = t846 * t846;
  t3607 = t849 * t849;
  t3609 = t1890 * t396;
  t3614 = t863 * t849;
  t3631 = my_piecewise3(t24, 0, t3500);
  t3641 = t3605 * t53;
  t3654 = t3607 * t53;
  t3657 = -0.256e3 * t3605 + 0.48e2 * t3607 - 0.2e1 * t862 * t3609 + t871 * t3609 / 0.3e1 + t1896 * t3614 / 0.4e1 - 0.6e1 * t1920 * t1926 + t1914 * t1926 - 0.9e1 / 0.2e1 * t1917 * t3614 + 0.12e2 * t1923 * t3614 + 0.4e1 * t1875 * t846 * t866 + 0.16e2 / 0.3e1 * t1905 * t1890 + 0.2e1 / 0.3e1 * t858 * t1890 + t405 * t3631 * t53 / 0.6e1 + t401 * t1895 * t1897 / 0.6e1 + t50 / t1893 / t47 * t3641 / 0.48e2 - 0.32e2 * t1901 * t846 * t866 + 0.2e1 / 0.3e1 * t1939 * t404 * t406 + t1908 * t866 + t855 * t870 * t863 / 0.2e1 + t871 * t3654 / 0.4e1;
  t3659 = 0.1e1 / t1893 / t46;
  t3669 = 0.1e1 / t1893;
  t3680 = t46 * t3607;
  t3682 = t395 * t3631;
  t3684 = t396 * t1880;
  t3686 = t45 * t3631;
  t3690 = t45 * t846 * t849;
  t3693 = t1887 * t1880;
  t3720 = -0.3e1 / 0.4e1 * t50 * t3659 * t3641 - 0.3e1 * t855 * t861 * t863 - 0.3e1 * t401 * t1875 * t1897 + 0.25e2 / 0.4e1 * t50 * t3669 * t3641 + 0.8e1 * t401 * t1901 * t1897 - 0.1e2 * t871 * t3641 - 0.3e1 / 0.2e1 * t862 * t3654 - 0.384e3 * t3680 - 0.128e3 / 0.3e1 * t3682 + 0.64e2 * t3684 + 0.16e2 * t3686 + (0.768e3 * t3605 + 0.4608e4 * t3690 + 0.1152e4 * t3680 + 0.1536e4 * t3693 + 0.128e3 * t3682 - 0.96e2 * t3607 - 0.128e3 * t3684 - 0.32e2 * t3686) * t53 / 0.3e1 - 0.1536e4 * t3690 - 0.512e3 * t3693 + t3659 * t3605 * t53 / 0.3e1 + 0.8e1 / 0.3e1 * t410 * t3631 - 0.8e1 / 0.3e1 * t61 * t3631 - 0.22e2 / 0.3e1 * t3669 * t3605 * t53 + 0.8e2 / 0.3e1 * t870 * t3605 * t53 + 0.4e1 * t861 * t3607 * t53;
  t3722 = my_piecewise3(t23, t3604, t3657 + t3720);
  t3736 = 0.5376e4 * t544 * t1067 * t2044 - 0.5376e4 * t1060 * t2038 - 0.4032e4 * t2029 * t1075 + 0.448e3 * t544 * t2016 * t1098 + 0.1792e4 / 0.9e1 * t418 * t1954 + 0.1792e4 / 0.9e1 * t67 * t534 * t427 * t200 - 0.672e3 * t1948 * t536 - 0.1008e4 * t887 * t1052 - 0.168e3 * t9 * t3722 * t201 - 0.672e3 * t418 * t1796 - 0.448e3 * t887 * t1064 - 0.896e3 * t418 * t1958 - 0.448e3 * t67 * t1050 * t77 * t200;
  tv4rho40 = my_piecewise3(t1, 0, t3355 + t3433 + t3472 + t3736);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  tv4rho41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  tv4rho42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  tv4rho43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3744 = 0.1e1 / t256 / t2217;
  t3751 = 0.1e1 / t206 / t2228;
  t3760 = t2217 * t288;
  t3761 = 0.1e1 / t3760;
  t3773 = 0.1e1 / t256 / t3760;
  t3787 = t430 * t2412;
  t3791 = t90 * t1205;
  t3793 = t8 * t1213;
  t3795 = t94 * t3793 * t68;
  t3817 = t1237 * t1237;
  t3823 = t1248 * t1248;
  t3847 = (-0.28e3 / 0.81e2 * t3791 - 0.112e3 / 0.27e2 * t3795) * t285 - 0.4e1 * t2250 * t646 * t656 + 0.12e2 * t1229 * t1235 * t1237 - 0.6e1 * t2252 * t1248 - 0.24e2 * t643 * t2261 * t2263 + 0.24e2 * t2255 * t2266 - 0.4e1 * t1231 * t2282 + 0.24e2 * t272 / t2260 / t284 * t3817 - 0.36e2 * t2262 * t1237 * t1248 + 0.6e1 * t1236 * t3823 + 0.8e1 * t1236 * t656 * t2282 - t647 * (-0.4e2 * t3791 + 0.96e2 * t1642 * t1225 * t649 - 0.192e3 * t3117 * t141 * t257 * t649 + 0.32e3 / 0.3e1 * t1646 * t10 * t2741 * t649 + 0.32e3 / 0.3e1 * t90 * t649 * t1205 + 0.112e3 / 0.3e1 * t3795);
  t3859 = t73 * t1213;
  t3871 = t90 * t1205 * t308;
  t3894 = t10 * t308;
  t3939 = t94 * t1213 * t68;
  t3978 = (0.16e2 * t1641 * t1030 * t569 * t649 - 0.32e2 / 0.3e1 * t3209 * t1309 + 0.16e3 / 0.9e1 * t1646 * t2760 * t649 + 0.16e3 / 0.27e2 * t90 * t695 * t1205 - 0.2e2 / 0.9e1 * t90 * t10 * t1205 + 0.56e2 / 0.9e1 * t3939) * t308 + 0.8e1 / 0.3e1 * t2313 * t150 * t10 * t712 - 0.4e1 / 0.3e1 * t2316 * t1325 + 0.8e1 * t1318 * t1030 * t8 * t1266 + 0.32e2 / 0.27e2 * t1321 * t2326 - 0.16e2 / 0.3e1 * t2322 * t2330 + 0.32e2 / 0.3e1 * t707 * t141 * t123 * t2336 - 0.56e2 / 0.81e2 * t710 * t94 * t1213 * t308 + 0.76e2 / 0.27e2 * t1329 * t3871 - 0.16e2 / 0.3e1 * t2334 * t124 * t2741 * t308 + 0.16e2 / 0.9e1 * t324 * t3254 * t1640 * t1638 * t569 * t3894 - 0.112e3 / 0.27e2 * t3939;
  t3985 = -0.56e2 / 0.243e3 * t312 * t3859 * t329 - 0.4e1 / 0.9e1 * t1282 * t1291 + 0.8e1 / 0.9e1 * t2408 * t687 + t144 * (0.196e3 / 0.243e3 * t473 * t3793 * t308 - 0.532e3 / 0.81e2 * t3871 + 0.56e2 / 0.9e1 * t125 * t2741 * t2389 - 0.224e3 / 0.27e2 * t1641 * t569 * t3164 * t308 - 0.56e2 / 0.81e2 * t676 * t3859 * t308 + 0.76e2 / 0.27e2 * t1273 * t87 * t1205 * t1275 - 0.16e2 / 0.3e1 * t2400 * t2741 * t1030 * t308 + 0.16e2 / 0.9e1 * t304 * t1640 * t1638 * t569 * t141 * t3894 + 0.308e3 / 0.243e3 * t3795 - 0.4e2 / 0.81e2 * t3791) * t330 / 0.3e1 + 0.32e2 / 0.81e2 * t684 * t2354 - 0.12e2 * t691 * t2374 * t1302 * t1333 + 0.8e1 * t1288 * t2381 + 0.16e2 / 0.3e1 * t691 * t2368 * t2380 + 0.8e1 / 0.3e1 * t691 * t1300 * t2341 * t716 - 0.2e1 * t2346 * t1335 - 0.4e1 / 0.3e1 * t1288 * t2342 - t691 * t694 * t150 * t3978 / 0.3e1 + 0.8e1 / 0.9e1 * t1288 * t2358;
  t4005 = t1333 * t1333;
  t4026 = t1301 * t1301;
  t4031 = -0.8e1 / 0.3e1 * t1288 * t2361 - 0.32e2 / 0.81e2 * t691 * t1107 * t693 * t717 + 0.4e1 / 0.9e1 * t691 * t2357 * t1334 - 0.4e1 / 0.3e1 * t144 * t2407 * t73 * t718 - 0.8e1 / 0.3e1 * t2346 * t1295 + 0.4e1 * t2346 * t1303 + 0.16e2 / 0.3e1 * t1288 * t2369 + 0.2e1 * t691 * t1300 * t150 * t4005 - 0.8e1 / 0.9e1 * t691 * t569 * t1299 * t1302 - 0.8e1 * t1288 * t2377 - 0.8e1 / 0.9e1 * t691 * t1294 * t2341 - 0.16e2 / 0.3e1 * t691 * t207 * t2373 * t2376 + 0.8e1 * t691 * t256 / t2372 / t327 * t150 * t4026;
  t4033 = my_piecewise5(t264, t3847, t287, (-0.56e4 / 0.81e2 * t129 * t1205 * t68 * t87 - 0.1568e6 / 0.81e2 * t134 * t1213 * t116 * t73) * t141 / 0.504e5, t3985 + t4031);
  t4039 = params->kappa * t569 * t71;
  t4041 = -0.55e2 / 0.126e3 * t425 * t3744 * t261 * sigma[2] * t633 + 0.235e3 / 0.2016e4 * t910 * t3751 * t261 * sigma[2] * t633 + 0.1e2 / 0.21e2 * t425 * t2213 * t1219 - 0.5e1 / 0.2016e4 * t1592 * t1595 * t3761 * t2234 - 0.5e1 / 0.56e2 * t910 * t2221 * t1219 - 0.15e2 / 0.56e2 * t425 * t1207 * t2240 + t3049 * t3052 * t3773 * t10 * t261 * sigma[2] * t633 / 0.72576e5 + t2231 * t2233 * t1219 / 0.1008e4 + 0.3e1 / 0.112e3 * t910 * t1215 * t2240 + 0.3e1 / 0.28e2 * t425 * t632 * t3787 + 0.27e2 / 0.56e2 * t263 * t84 * t85 * t4033 - 0.8e2 / 0.81e2 * t4039;
  t4070 = t1112 * t1112;
  t4072 = t1103 * t1103;
  t4093 = 0.14e3 / 0.243e3 * t14 * p->cam_omega * t2219 * t19;
  t4094 = my_piecewise3(t213, t4093, 0);
  t4105 = t574 * t2094;
  t4107 = -0.2908224e8 * t215 * t4070 + 0.109983744e11 * t215 * t4072 + 0.27495936e10 * t216 * t4070 - 0.17564811264e13 * t216 * t4072 - 0.17564811264e12 * t217 * t4070 + 0.1625999671296e15 * t217 * t4072 + 0.87107125248e13 * t218 * t4070 - 0.35771992768512e15 * t223 * t4070 + 0.18330624e9 * t567 * t4094 - 0.323136e7 * t577 * t4094 - 0.1083999780864e14 * t578 * t4094 + 0.3226189824e12 * t581 * t4094 - 0.836419584e10 * t584 * t4094 + 0.116688e6 * t4070 - 0.1938816e8 * t4072 + 0.155584e6 * t4105;
  t4148 = -0.11632896e9 * t214 * t1103 * t1112 - 0.210777735168e13 * t567 * t1103 * t1112 + 0.219967488e11 * t577 * t1103 * t1112 + 0.3156607361875968e18 * t578 * t1103 * t1112 - 0.71543985537024e16 * t581 * t1103 * t1112 + 0.1393714003968e15 * t584 * t1103 * t1112 + 0.175367075659776e17 * t2062 * t2094 - 0.47695990358016e15 * t2067 * t2094 + 0.116142833664e14 * t2072 * t2094 - 0.23419748352e12 * t2077 * t2094 + 0.36661248e10 * t2082 * t2094 - 0.3877632e8 * t2087 * t2094 + 0.38896e5 * t214 * t4094 - 0.107315978305536e17 * t218 * t4072 + 0.131525306744832e17 * t221 * t4070 + 0.5787113496772608e18 * t223 * t4072 + 0.3372443762688e15 * t568 * t4094;
  t4181 = (t4107 + t4148) * t231 / 0.8671998246912e15 - t2111 * t597 * t574 / 0.135499972608e14 + t1138 * t1145 * t1103 / 0.5313724416e12 - t2114 * t1112 / 0.90333315072e13 - t593 * t2123 * t2059 / 0.442810368e11 + t2117 * t2105 / 0.2656862208e12 - t1141 * t2094 / 0.135499972608e14 + 0.19e2 / 0.1771241472e12 * t229 / t230 / t216 * t4072 - t2124 * t1103 * t1112 / 0.295206912e11 + t1146 * t4070 / 0.10627448832e13 + t1146 * t4105 / 0.7970586624e12 - t598 * t4094 / 0.541999890432e14;
  t4182 = t1155 * t1155;
  t4184 = t1152 * t1152;
  t4186 = t1169 * t1155;
  t4196 = t2133 * t603;
  t4203 = my_piecewise3(t213, 0, t4093);
  t4213 = t4184 * t242;
  t4232 = 0.1e1 / t2136 / t235;
  t4236 = 0.48e2 * t4182 - 0.256e3 * t4184 + t2139 * t4186 / 0.4e1 - 0.6e1 * t2165 * t2172 + t2157 * t2172 - 0.9e1 / 0.2e1 * t2162 * t4186 + 0.12e2 * t2168 * t4186 - 0.2e1 * t1168 * t4196 + t1177 * t4196 / 0.3e1 + 0.2e1 / 0.3e1 * t1164 * t2133 + t612 * t4203 * t242 / 0.6e1 + t608 * t2138 * t2141 / 0.6e1 + t239 / t2136 / t236 * t4213 / 0.48e2 - 0.32e2 * t2145 * t1152 * t1172 + 0.16e2 / 0.3e1 * t2149 * t2133 + 0.4e1 * t2161 * t1152 * t1172 + 0.2e1 / 0.3e1 * t2198 * t611 * t613 + t2152 * t1172 + t1161 * t1176 * t1169 / 0.2e1 - 0.3e1 / 0.4e1 * t239 * t4232 * t4213;
  t4243 = 0.1e1 / t2136;
  t4252 = t4182 * t242;
  t4257 = t235 * t4182;
  t4259 = t602 * t4203;
  t4261 = t603 * t2132;
  t4263 = t234 * t4203;
  t4267 = t234 * t1152 * t1155;
  t4270 = t2179 * t2132;
  t4298 = -0.3e1 * t1161 * t1167 * t1169 - 0.3e1 * t608 * t2161 * t2141 + 0.25e2 / 0.4e1 * t239 * t4243 * t4213 + 0.8e1 * t608 * t2145 * t2141 - 0.1e2 * t1177 * t4213 - 0.3e1 / 0.2e1 * t1168 * t4252 + t1177 * t4252 / 0.4e1 - 0.384e3 * t4257 - 0.128e3 / 0.3e1 * t4259 + 0.64e2 * t4261 + 0.16e2 * t4263 + (0.768e3 * t4184 + 0.4608e4 * t4267 + 0.1152e4 * t4257 + 0.1536e4 * t4270 + 0.128e3 * t4259 - 0.96e2 * t4182 - 0.128e3 * t4261 - 0.32e2 * t4263) * t242 / 0.3e1 - 0.1536e4 * t4267 - 0.512e3 * t4270 + t4232 * t4184 * t242 / 0.3e1 + 0.8e1 / 0.3e1 * t617 * t4203 - 0.8e1 / 0.3e1 * t248 * t4203 * t57 - 0.22e2 / 0.3e1 * t4243 * t4184 * t242 + 0.8e2 / 0.3e1 * t1176 * t4184 * t242 + 0.4e1 * t1167 * t4182 * t242;
  t4300 = my_piecewise3(t212, t4181, t4236 + t4298);
  t4304 = -0.224e4 / 0.27e2 * t255 * t341 * t1205 * t352 - 0.168e3 * t255 * t4041 * t265 * t352 - 0.896e3 * t2207 * t736 - 0.448e3 * t1194 * t1361 - 0.2688e4 * t1194 * t1353 - 0.2688e4 * t626 * t2444 - 0.896e3 * t255 * t2420 * t206 * t352 - 0.896e3 * t626 * t2440 - 0.448e3 * t255 * t1347 * t257 * t352 + 0.1792e4 / 0.9e1 * t626 * t2436 + 0.1792e4 / 0.9e1 * t255 * t730 * t630 * t352 - 0.168e3 * t9 * t4300 * t353;
  t4338 = -0.1344e4 * t740 * t741 * t1369 * t2474 * t756 + 0.6048e4 * t740 * t741 * t2511 * t1370 * t1392 - 0.5376e4 * t740 * t1364 * t2055 - 0.1008e4 * t1194 * t1349 - 0.4032e4 * t1202 * t2056 + 0.896e3 * t1202 * t2486 - 0.4032e4 * t1357 * t2056 + 0.896e3 * t1357 * t2486 + 0.2688e4 * t2492 * t1365 + 0.5376e4 * t2498 * t1365 + 0.1008e4 * t2492 * t1394 - 0.672e3 * t2207 * t732 - 0.672e3 * t626 * t2422;
  t4340 = t630 * t190;
  t4393 = 0.216e3 * params->b_PBE * t4033 * t261 * t346 + 0.48e2 * t2447 * t552 * t752 - 0.12e3 * t2451 * t1383 + 0.12e2 * t1375 * t1090 * t1388 + 0.64e3 / 0.3e1 * t1379 * t2460 - 0.4e2 * t2456 * t2464 + 0.4e1 / 0.9e1 * t744 * t1997 * t2470 - 0.176e4 / 0.9e1 * t748 * t75 * t3744 * t751 + 0.47e3 / 0.9e1 * t1386 * t908 * t3751 * t751 - 0.1e2 / 0.9e1 * t2467 * t1594 * t3761 * t8 * t751 + t343 * t3415 * t3051 * t3773 * t10 * t751 / 0.162e3 - 0.3584e5 / 0.81e2 * t4039;
  t4402 = t2206 * t341;
  t4408 = t1193 * t730;
  t4412 = t625 * t1347;
  t4416 = -0.1792e4 / 0.9e1 * t740 * t4340 * t757 + 0.2688e4 * t1202 * t2480 + 0.2688e4 * t1357 * t2480 + 0.2016e4 * t2498 * t1394 + 0.672e3 * t1202 * t2476 + 0.672e3 * t1357 * t2476 + 0.168e3 * t740 * t741 * t743 * t4393 + 0.4032e4 * t1202 * t2514 + 0.4032e4 * t1357 * t2514 + 0.672e3 * t9 * t4402 * t758 + 0.2688e4 * t2504 * t1365 + 0.2016e4 * t9 * t4408 * t758 + 0.2016e4 * t9 * t4412 * t758;
  t4417 = t254 * t2420;
  t4437 = 0.1e1 / t2510 / t350;
  t4438 = t1370 * t1370;
  t4443 = t1392 * t1392;
  t4457 = -0.1008e4 * t740 * t741 * t1369 * t4443 - 0.4032e4 * t740 * t741 * t4437 * t4438 + 0.896e3 * t740 * t1364 * t2475 + 0.5376e4 * t740 * t1364 * t2513 - 0.896e3 * t740 * t2485 * t1371 + 0.448e3 * t740 * t2485 * t1393 + 0.672e3 * t9 * t4417 * t758 - 0.5376e4 * t1202 * t2507 - 0.5376e4 * t1357 * t2507 - 0.2016e4 * t2492 * t1372 - 0.4032e4 * t2498 * t1372 - 0.2016e4 * t2504 * t1372 + 0.1008e4 * t2504 * t1394;
  tv4rho44 = my_piecewise3(t205, 0, t4304 + t4338 + t4416 + t4457);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4460 = 0.1e1 / t911;
  t4482 = 0.1e1 / t11 / t123;
  t4484 = t1996 * t4482 * t1594;
  t4510 = t1594 * t10;
  t4527 = -0.336e3 * t1457 * t4460 * t2567 * t2569 * t2576 + 0.108864e6 * t1457 * t1458 * t2596 * t2558 * t2559 * t5 * t1073 - 0.72576e5 * t2556 * t526 * params->ax * t68 * t2561 - 0.9e1 / 0.4e1 * t2590 * t2592 * t2534 - t1404 * t4484 * t1573 * t10 * t81 * t1412 / 0.24e2 + 0.3e1 / 0.4e1 * t2590 * t4460 * t8 * t81 * t1412 - 0.9e1 / 0.4e1 * t2529 * t2589 * t2593 + 0.1008e4 * t2538 * t2570 * t2576 + 0.1008e4 * t2542 * t2570 * t2576 + 0.56e2 / 0.3e1 * t1457 * t1573 * t4482 * t2569 * t180 * t1590 * t140 * t4510 * t1447 + 0.81e2 * t2529 * t2580 * t2585 + 0.81e2 * t2581 * t2583 * t527 * t562 + 0.81e2 / 0.2e1 * t2581 * t362 * t81 * t5 * t2584;
  t4565 = t762 * t886;
  t4574 = -0.72576e5 * t2542 * t2555 * t2562 + 0.81e2 / 0.2e1 * t2581 * t2583 * t181 * t1098 - 0.72576e5 * t2538 * t2555 * t2562 + 0.1008e4 * t2571 * t526 * t904 * t116 * t2575 - 0.36288e5 * t2556 * t2558 * t2559 * t5 * t1097 - 0.36288e5 * t1457 * t2546 * t1445 * t2562 - 0.81e2 * t2581 * t2583 * t181 * t1074 - 0.435456e6 * t2686 * t2674 * t1449 - 0.435456e6 * t2687 * t2603 - 0.217728e6 * t1444 * t1445 * t1042 * t1448 - 0.217728e6 * t4565 * t1443 * t1449 + 0.243e3 * t4565 * t1424 * t1428 + 0.486e3 * t2690 * t2694;
  t4578 = t1051 * t190;
  t4611 = t1063 * t190;
  t4615 = 0.243e3 * t1425 * t1043 * t91 * t1427 + 0.81e2 * t1425 * t1426 * t772 * t2005 - 0.72576e5 * t1444 * t1446 * t1447 * t2005 + 0.653184e6 * t1444 * t2596 * t526 * t2598 - 0.217728e6 * t1423 * t4578 * t1449 - 0.96768e5 * t1423 * t4611 * t1449 - 0.580608e6 * t2686 * t2678 * t1449 + 0.653184e6 * t2675 * t2599 + 0.653184e6 * t2687 * t2599 - 0.435456e6 * t2675 * t2603 - 0.217728e6 * t2675 * t2607 - 0.217728e6 * t2687 * t2607 + 0.243e3 * t2690 * t2683;
  t4616 = t1055 * t190;
  t4629 = t116 * t908;
  t4661 = -0.580608e6 * t1423 * t4616 * t1449 - 0.217728e6 * t1444 * t2602 * t2606 + 0.9e1 / 0.4e1 * t2590 * t2591 * t1447 * t2584 - 0.2016e4 * t1457 * t2568 * t1445 * t2572 * t4629 * t1600 * t2560 + 0.290304e6 * t2653 * t1454 + 0.290304e6 * t2645 * t1454 + 0.48384e5 * t762 * t894 * t77 * t776 - 0.81e2 * t765 * t3068 * t766 - 0.81e2 * t762 * t1947 * params->b_PBE * t81 * t767 - 0.243e3 * t2639 * t1416 + 0.108864e6 * t2629 * t1454 - 0.243e3 * t1400 * t2634 + 0.108864e6 * t762 * t3364 * t91 * t776;
  t4701 = 0.36288e5 * t771 * t773 * t1786 * t81 * t5 + 0.145152e6 * t762 * t2034 * t15 * t776 + 0.36288e5 * t762 * t3351 * t91 * t776 + 0.108864e6 * t762 * t3356 * t91 * t776 + 0.36288e5 * t762 * t3360 * t91 * t776 - 0.648e3 * t1400 * t2658 - 0.324e3 * t2639 * t1420 + 0.108864e6 * t1432 * t2614 + 0.108864e6 * t1436 * t2614 + 0.145152e6 * t1440 * t2614 + 0.108864e6 * t2618 * t1454 + 0.217728e6 * t2622 * t1454 + 0.48384e5 * t2649 * t1454;
  t4745 = 0.48384e5 * t762 * t1059 * t77 * t776 + 0.648e3 * t1425 * t527 * t15 * t1427 + 0.108e3 * t1425 * t181 * t77 * t1427 + 0.145152e6 * t762 * t2020 * t15 * t776 + 0.290304e6 * t762 * t2028 * t15 * t776 + 0.24e2 * t765 * t431 * t3448 * t199 - 0.10752e5 * t762 * t543 * t427 * t776 - 0.324e3 * t765 * t1608 * t1419 + 0.243e3 * t1425 * t2693 * t2682 - 0.108e3 * t765 * t919 * t2661 - 0.108e3 * t1400 * t2662 - 0.290304e6 * t2679 * t2607 + 0.648e3 * t2690 * t2666;
  t4755 = t190 * t2042;
  t4789 = t7 * t886;
  t4794 = -0.870912e6 * t1444 * t3457 * params->b_PBE * t180 * t1447 * t2043 + 0.870912e6 * t2679 * t2599 + 0.486e3 * t1425 * t1426 * t4755 * t2043 - 0.486e3 * t1425 * t2693 * t2670 - 0.648e3 * t1425 * t2665 * t2670 - 0.486e3 * t2690 * t2671 + 0.324e3 * t1425 * t2665 * t2682 - 0.580608e6 * t2679 * t2603 - 0.5376e4 * t1457 * t801 * t1406 * t547 * t1464 + 0.36288e5 * t2543 * t2552 - 0.81e2 / 0.2e1 * t1408 * t1410 * t430 * t1042 * t199 + 0.18144e5 * t1403 * t1050 * t1459 * t1464 + 0.18144e5 * t4789 * t188 * t1459 * t1464;
  t4817 = t1097 * t561;
  t4838 = 0.36288e5 * t2528 * t534 * t1459 * t1464 + 0.36288e5 * t2539 * t2552 + 0.18144e5 * t2548 * t2552 + 0.18144e5 * t1460 * t1078 * params->ax * t1463 + 0.12e2 * t1408 * t74 * t801 * t81 * t1412 - 0.81e2 / 0.2e1 * t2530 * t2525 - 0.81e2 / 0.2e1 * t1408 * t2524 * t2534 - 0.486e3 * t1425 * t1426 * t2669 * t4817 + 0.653184e6 * t1444 * t2597 * t1447 * t4817 - 0.81e2 / 0.2e1 * t4789 * params->b_PBE * t1407 * t1413 - 0.81e2 * t2530 * t2535 + 0.18144e5 * t2538 * t2547 * t1464 + 0.18144e5 * t2542 * t2547 * t1464;
  tv4rho3sigma0 = my_piecewise3(t1, 0, t4527 + t4574 + t4615 + t4661 + t4701 + t4745 + t4794 + t4838);

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  tv4rho3sigma2 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  tv4rho3sigma3 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  tv4rho3sigma5 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  tv4rho3sigma6 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  tv4rho3sigma8 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  tv4rho3sigma9 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t4877 = 0.1e1 / t1211;
  t4904 = 0.1008e4 * t2745 * t722 * t904 * t116 * t2748 - 0.72576e5 * t2722 * t2731 * t2738 + 0.1008e4 * t2722 * t2744 * t2749 - 0.36288e5 * t1524 * t2726 * t1512 * t2738 - 0.72576e5 * t2732 * t722 * params->ax * t68 * t2737 - t1474 * t4484 * t2211 * t10 * t261 * t1479 / 0.24e2 + 0.56e2 / 0.3e1 * t1524 * t2211 * t4482 * t2743 * t333 * t1590 * t140 * t4510 * t1514 + 0.3e1 / 0.4e1 * t2759 * t4877 * t8 * t261 * t1479 + 0.81e2 / 0.2e1 * t2752 * t569 * t261 * t5 * t2755 + 0.81e2 / 0.2e1 * t2752 * t2754 * t334 * t1393 + 0.81e2 * t2752 * t2754 * t723 * t757 - 0.9e1 / 0.4e1 * t2759 * t2761 * t2714 - 0.36288e5 * t2732 * t2734 * t2735 * t5 * t1392;
  t4958 = 0.1008e4 * t2705 * t2744 * t2749 + 0.81e2 * t2709 * t2580 * t2756 - 0.9e1 / 0.4e1 * t2709 * t2589 * t2762 - 0.336e3 * t1524 * t4877 * t2567 * t2743 * t2749 + 0.108864e6 * t1524 * t1525 * t2847 * t2734 * t2735 * t5 * t1370 - 0.81e2 * t2752 * t2754 * t334 * t1371 - 0.72576e5 * t2705 * t2731 * t2738 + 0.9e1 / 0.4e1 * t2759 * t2760 * t1514 * t2755 - 0.2016e4 * t1524 * t2742 * t1512 * t2746 * t4629 * t2232 * t2736 - 0.10752e5 * t762 * t739 * t630 * t793 + 0.48384e5 * t762 * t1201 * t257 * t793 + 0.48384e5 * t762 * t1356 * t257 * t793 + 0.48384e5 * t2766 * t1521;
  t4995 = 0.36288e5 * t788 * t790 * t2412 * t261 * t5 + 0.145152e6 * t762 * t2491 * t206 * t793 + 0.36288e5 * t762 * t4417 * t265 * t793 - 0.108e3 * t782 * t1219 * t2777 - 0.324e3 * t782 * t2240 * t1486 - 0.108e3 * t1470 * t2778 - 0.648e3 * t1470 * t2783 - 0.324e3 * t2812 * t1487 + 0.108864e6 * t1499 * t2788 + 0.108864e6 * t1503 * t2788 + 0.108864e6 * t2795 * t1521 + 0.108864e6 * t2803 * t1521 + 0.217728e6 * t2807 * t1521;
  t5038 = -0.81e2 * t762 * t2206 * params->b_PBE * t261 * t784 + 0.290304e6 * t762 * t2497 * t206 * t793 + 0.145152e6 * t762 * t2503 * t206 * t793 + 0.36288e5 * t762 * t4402 * t265 * t793 + 0.108864e6 * t762 * t4408 * t265 * t793 + 0.108864e6 * t762 * t4412 * t265 * t793 + 0.24e2 * t782 * t633 * t4340 * t351 - 0.81e2 * t782 * t3787 * t783 - 0.243e3 * t1470 * t2817 - 0.243e3 * t2812 * t1483 + 0.145152e6 * t1507 * t2788 + 0.290304e6 * t2770 * t1521 + 0.290304e6 * t2774 * t1521;
  t5078 = 0.18144e5 * t2728 * t2719 - 0.81e2 / 0.2e1 * t1475 * t2700 * t2714 - 0.81e2 / 0.2e1 * t2710 * t2701 + 0.18144e5 * t2722 * t2727 * t1530 - 0.5376e4 * t1524 * t1107 * t1406 * t743 * t1530 + 0.36288e5 * t2723 * t2719 + 0.653184e6 * t1511 * t2847 * t722 * t2849 - 0.486e3 * t2844 * t2855 - 0.486e3 * t1492 * t2820 * t2854 + 0.653184e6 * t2829 * t2850 + 0.653184e6 * t2833 * t2850 - 0.217728e6 * t1511 * t1512 * t1339 * t1515 - 0.217728e6 * t1511 * t2862 * t2824;
  t5079 = t1360 * t190;
  t5086 = t1352 * t190;
  t5112 = t762 * t1193;
  t5119 = -0.870912e6 * t1511 * t4437 * params->b_PBE * t333 * t1514 * t2512 - 0.72576e5 * t1511 * t1513 * t1514 * t2474 - 0.96768e5 * t1490 * t5079 * t1516 - 0.580608e6 * t1490 * t5086 * t1516 - 0.217728e6 * t5112 * t1510 * t1516 - 0.435456e6 * t2828 * t2832 * t1516 - 0.580608e6 * t2828 * t2858 * t1516 - 0.217728e6 * t2833 * t2825 - 0.290304e6 * t2859 * t2825 - 0.435456e6 * t2829 * t2863 - 0.435456e6 * t2833 * t2863 + 0.870912e6 * t2859 * t2850 - 0.580608e6 * t2859 * t2863;
  t5126 = t190 * t2511;
  t5141 = t1348 * t190;
  t5163 = 0.243e3 * t1492 * t1340 * t265 * t1494 + 0.81e2 * t1492 * t1493 * t789 * t2474 + 0.486e3 * t1492 * t1493 * t5126 * t2512 + 0.648e3 * t1492 * t723 * t206 * t1494 + 0.108e3 * t1492 * t334 * t257 * t1494 - 0.217728e6 * t1490 * t5141 * t1516 + 0.243e3 * t5112 * t1491 * t1495 + 0.324e3 * t1492 * t2836 * t2840 - 0.648e3 * t1492 * t2836 * t2854 + 0.486e3 * t2844 * t2821 - 0.217728e6 * t2829 * t2825 + 0.648e3 * t2844 * t2837 + 0.243e3 * t2844 * t2841;
  t5167 = t756 * t1392;
  t5203 = t7 * t1193;
  t5214 = 0.243e3 * t1492 * t2820 * t2840 + 0.653184e6 * t1511 * t2848 * t1514 * t5167 - 0.486e3 * t1492 * t1493 * t2853 * t5167 + 0.18144e5 * t2705 * t2727 * t1530 + 0.18144e5 * t1527 * t1375 * params->ax * t1529 + 0.36288e5 * t2704 * t730 * t1526 * t1530 + 0.18144e5 * t1473 * t1347 * t1526 * t1530 + 0.36288e5 * t2706 * t2719 + 0.12e2 * t1475 * t74 * t1107 * t261 * t1479 - 0.81e2 / 0.2e1 * t1475 * t1477 * t430 * t1339 * t351 + 0.18144e5 * t5203 * t341 * t1526 * t1530 - 0.81e2 / 0.2e1 * t5203 * params->b_PBE * t1407 * t1480 - 0.81e2 * t2710 * t2715;
  tv4rho3sigma11 = my_piecewise3(t205, 0, t4904 + t4958 + t4995 + t5038 + t5078 + t5119 + t5163 + t5214);

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t5222 = t68 * t8;
  t5237 = t1537 * t561;
  t5251 = t1089 * t10 * t908;
  t5302 = 0.46656e5 * t2871 * t2872 * t181 * t1458 * t547 * params->ax * t5222 * t74 * t526 - 0.46656e5 * t2874 * t1458 * t1072 * params->ax * t5222 * t74 * t561 + 0.31352832e8 * t1457 * t1458 * t2902 * t1548 * t5237 * t2876 - 0.20901888e8 * t2914 * t180 * t1535 * t1537 * t526 * t2876 - 0.580608e6 * t1457 * t2568 * t1547 * t1549 * t5251 + 0.1296e4 * t2874 * t2568 * t547 * t5251 - 0.10450944e8 * t2538 * t2913 * t2915 - 0.10450944e8 * t2542 * t2913 * t2915 - 0.5225472e7 * t1457 * t2546 * t1547 * t2915 + 0.11664e5 * t2874 * t2547 * t2876 + 0.23328e5 * t2528 * t1534 * t2873 * t2877 + 0.209952e6 * t1539 * t1426 * t772 * t1042 - 0.559872e6 * t1539 * t1541 * t15 * t2889 - 0.188116992e9 * t2896 * t2910 + 0.376233984e9 * t2899 * t2905 - 0.250822656e9 * t2899 * t2910 + 0.141087744e9 * t1546 * t2903 * t2872 * t1097 - 0.209952e6 * t1539 * t2888 * t2669 * t1097 + 0.282175488e9 * t2893 * t2905 - 0.188116992e9 * t2893 * t2910;
  t5354 = t526 * t526;
  t5380 = 0.419904e6 * t2868 * t2881 - 0.419904e6 * t2868 * t2890 - 0.564350976e9 * t1546 * t3457 * t1534 * t1540 * t2872 * t1073 + 0.629856e6 * t1539 * t2888 * t4755 * t1073 + 0.559872e6 * t1539 * t2665 * t2880 - 0.94058496e8 * t1546 * t2908 * t2872 * t1042 + 0.282175488e9 * t2896 * t2905 - 0.839808e6 * t2871 * t2872 * t85 * t180 * t91 * t190 * t1072 * t526 * t561 + 0.564350976e9 * t1457 * t545 * t2042 * t1534 * t180 * t1535 * t5237 * t526 - 0.125411328e9 * t1403 * t4616 * t1550 - 0.20901888e8 * t1403 * t4611 * t1550 - 0.125411328e9 * t2528 * t2678 * t1550 + 0.279936e6 * t2868 * t2885 + 0.209952e6 * t1539 * t85 * t5354 * t1542 + 0.46656e5 * t1539 * t1541 * t2016 * t547 - 0.47029248e8 * t4789 * t1443 * t1550 - 0.94058496e8 * t2528 * t2674 * t1550 - 0.47029248e8 * t1403 * t4578 * t1550 + 0.104976e6 * t4789 * t1538 * t1543 - 0.94058496e8 * t1546 * t1547 * t5354 * t1535 * t1537;
  tv4rho2sigma20 = my_piecewise3(t1, 0, t5302 + t5380);

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  tv4rho2sigma26 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  tv4rho2sigma211 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  tv4rho2sigma212 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t5400 = t1537 * t756;
  t5465 = 0.46656e5 * t2922 * t2923 * t334 * t1525 * t743 * params->ax * t5222 * t74 * t722 - 0.46656e5 * t2925 * t1525 * t1369 * params->ax * t5222 * t74 * t756 + 0.31352832e8 * t1524 * t1525 * t2951 * t1566 * t5400 * t2876 - 0.20901888e8 * t2963 * t333 * t1554 * t1537 * t722 * t2876 - 0.10450944e8 * t2705 * t2962 * t2964 - 0.10450944e8 * t2722 * t2962 * t2964 - 0.5225472e7 * t1524 * t2726 * t1565 * t2964 + 0.23328e5 * t2704 * t1534 * t2924 * t2926 + 0.11664e5 * t2925 * t2727 * t2876 - 0.580608e6 * t1524 * t2742 * t1565 * t1567 * t5251 + 0.1296e4 * t2925 * t2742 * t743 * t5251 + 0.209952e6 * t1557 * t1493 * t789 * t1339 - 0.559872e6 * t1557 * t1559 * t206 * t2938 - 0.94058496e8 * t1564 * t2957 * t2923 * t1339 + 0.376233984e9 * t2948 * t2954 - 0.250822656e9 * t2948 * t2959 + 0.141087744e9 * t1564 * t2952 * t2923 * t1392 - 0.209952e6 * t1557 * t2937 * t2853 * t1392 + 0.282175488e9 * t2942 * t2954 - 0.188116992e9 * t2942 * t2959;
  t5524 = t722 * t722;
  t5541 = 0.419904e6 * t2919 * t2930 - 0.419904e6 * t2919 * t2939 - 0.564350976e9 * t1564 * t4437 * t1534 * t1558 * t2923 * t1370 + 0.559872e6 * t1557 * t2836 * t2929 + 0.629856e6 * t1557 * t2937 * t5126 * t1370 + 0.282175488e9 * t2945 * t2954 - 0.188116992e9 * t2945 * t2959 + 0.564350976e9 * t1524 * t741 * t2511 * t1534 * t333 * t1554 * t5400 * t722 - 0.839808e6 * t2922 * t2923 * t85 * t333 * t265 * t190 * t1369 * t722 * t756 - 0.94058496e8 * t2704 * t2832 * t1568 - 0.47029248e8 * t1473 * t5141 * t1568 + 0.104976e6 * t5203 * t1556 * t1561 - 0.125411328e9 * t1473 * t5086 * t1568 - 0.20901888e8 * t1473 * t5079 * t1568 - 0.125411328e9 * t2704 * t2858 * t1568 + 0.279936e6 * t2919 * t2934 + 0.209952e6 * t1557 * t85 * t5524 * t1560 + 0.46656e5 * t1557 * t1559 * t2485 * t743 - 0.94058496e8 * t1564 * t1565 * t5524 * t1554 * t1537 - 0.47029248e8 * t5203 * t1510 * t1568;
  tv4rho2sigma217 = my_piecewise3(t205, 0, t5465 + t5541);

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t5552 = t10 * params->ax * t1462;
  t5581 = t2969 * t8;
  t5598 = -0.136048896e9 * t2528 * t2971 * t2976 - 0.22674816e8 * t1403 * t2968 * t2969 * t85 * t2973 * t1458 * t1072 * t5552 - 0.408146688e9 * t2972 * t1540 * t91 * t190 * t1072 * t8 * t526 - 0.181398528e9 * t2972 * t2973 * t15 * t2975 + 0.408146688e9 * t2972 * t2974 * t190 * t2042 * t8 * t561 + 0.60949905408e11 * t2893 * t2982 + 0.60949905408e11 * t2896 * t2982 + 0.81266540544e11 * t2899 * t2982 - 0.243799621632e12 * t1546 * t3457 * t2968 * t2973 * t5581 * t561 + 0.182849716224e12 * t1546 * t2979 * t1540 * t5581 * t526 + 0.10158317568e11 * t1457 * t1458 * t2042 * t2968 * t2973 * t2969 * t5552;
  tv4rhosigma30 = my_piecewise3(t1, 0, t5598);

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  tv4rhosigma310 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t5635 = t2986 * t8;
  t5652 = -0.136048896e9 * t2704 * t2988 * t2993 - 0.22674816e8 * t1473 * t2968 * t2986 * t85 * t2990 * t1525 * t1369 * t5552 - 0.408146688e9 * t2989 * t1558 * t265 * t190 * t1369 * t8 * t722 - 0.181398528e9 * t2989 * t2990 * t206 * t2992 + 0.408146688e9 * t2989 * t2991 * t190 * t2511 * t8 * t756 + 0.60949905408e11 * t2942 * t2999 + 0.60949905408e11 * t2945 * t2999 + 0.81266540544e11 * t2948 * t2999 - 0.243799621632e12 * t1564 * t4437 * t2968 * t2990 * t5635 * t756 + 0.182849716224e12 * t1564 * t2996 * t1558 * t5635 * t722 + 0.10158317568e11 * t1524 * t1525 * t2511 * t2968 * t2990 * t2986 * t5552;
  tv4rhosigma319 = my_piecewise3(t205, 0, t5652);

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t5653 = t1534 * t1534;
  t5654 = t1535 * t1535;
  t5658 = t1540 * t1540;
  tv4sigma40 = my_piecewise3(t1, 0, 0.117546246144e12 * t1403 * t5653 * t5654 * t85 * t5658 * t91 * t190 * t2042 * t10 * t5 - 0.52660718272512e14 * t1546 * t3457 * t5653 * t5658 * t5654 * t10 * t5);

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t5674 = t1554 * t1554;
  t5678 = t1558 * t1558;
  tv4sigma414 = my_piecewise3(t205, 0, 0.117546246144e12 * t1473 * t5653 * t5674 * t85 * t5678 * t265 * t190 * t2511 * t10 * t5 - 0.52660718272512e14 * t1564 * t4437 * t5653 * t5678 * t5674 * t10 * t5);

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

