/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2022 (X86 64 LINUX)
  Maple source      : ./maple/gga_exc/gga_xc_th1.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  double t136, t142, t147, t152, t157, t158, t164, t166;
  double t167, t170, t186, tvrho0, t190, t218, tvsigma0;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t136 = 0.1e1 / t22;
  t142 = 0.1e1 / t7 / t93;
  t147 = 0.1e1 / t93;
  t152 = 0.1e1 / t109;
  t157 = 0.1e1 / t29;
  t158 = t85 * t157;
  t164 = t93 * rho[0];
  t166 = 0.1e1 / t28 / t164;
  t167 = sigma[0] * t166;
  t170 = -0.8e1 / 0.3e1 * t167 * t64 + 0.8e1 / 0.3e1 * t167;
  t186 = t113 * rho[0];
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t43 * t80 * t34 * t38 / 0.24e2 + t49 * t86 * t34 * t38 / 0.12e2 + t55 * t136 * t34 * t38 / 0.8e1 - 0.7e1 / 0.48e2 * t61 * t142 * sigma[0] * t64 - t69 * t147 * sigma[0] * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * sigma[0] * t64 - t158 * t88 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t98 + t92 * t23 * t170 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t98 + t103 * t29 * t170 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t98 + t108 * t109 * t170 / 0.2e1 + t186 * t98 + t114 * t170 / 0.2e1 + t117;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t190 = 0.1e1 / t34;
  t218 = t95 * t64 - t95;
  tvsigma0 = t33 * t190 * t38 / 0.8e1 + t43 * t7 * t190 * t38 / 0.8e1 + t49 * t15 * t190 * t38 / 0.8e1 + t55 * t22 * t190 * t38 / 0.8e1 + t61 * t62 * t64 / 0.8e1 + t69 * t70 * t64 / 0.8e1 + t76 * t80 * t64 / 0.8e1 + t87 * t64 / 0.8e1 + t92 * t23 * t218 / 0.2e1 + t103 * t29 * t218 / 0.2e1 + t108 * t109 * t218 / 0.2e1 + t114 * t218 / 0.2e1;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  double t136, t142, t147, t152, t157, t158, t164, t166;
  double t167, t170, t186, tvrho0, t190, t218, tvsigma0;

  double t230, t236, t238, t239, t242, t264, t267, t281;
  double t287, t292, t298, t309, t313, tv2rho20, t342, tv2rhosigma0;
  double t362, tv2sigma20;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t136 = 0.1e1 / t22;
  t142 = 0.1e1 / t7 / t93;
  t147 = 0.1e1 / t93;
  t152 = 0.1e1 / t109;
  t157 = 0.1e1 / t29;
  t158 = t85 * t157;
  t164 = t93 * rho[0];
  t166 = 0.1e1 / t28 / t164;
  t167 = sigma[0] * t166;
  t170 = -0.8e1 / 0.3e1 * t167 * t64 + 0.8e1 / 0.3e1 * t167;
  t186 = t113 * rho[0];
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t43 * t80 * t34 * t38 / 0.24e2 + t49 * t86 * t34 * t38 / 0.12e2 + t55 * t136 * t34 * t38 / 0.8e1 - 0.7e1 / 0.48e2 * t61 * t142 * sigma[0] * t64 - t69 * t147 * sigma[0] * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * sigma[0] * t64 - t158 * t88 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t98 + t92 * t23 * t170 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t98 + t103 * t29 * t170 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t98 + t108 * t109 * t170 / 0.2e1 + t186 * t98 + t114 * t170 / 0.2e1 + t117;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t190 = 0.1e1 / t34;
  t218 = t95 * t64 - t95;
  tvsigma0 = t33 * t190 * t38 / 0.8e1 + t43 * t7 * t190 * t38 / 0.8e1 + t49 * t15 * t190 * t38 / 0.8e1 + t55 * t22 * t190 * t38 / 0.8e1 + t61 * t62 * t64 / 0.8e1 + t69 * t70 * t64 / 0.8e1 + t76 * t80 * t64 / 0.8e1 + t87 * t64 / 0.8e1 + t92 * t23 * t218 / 0.2e1 + t103 * t29 * t218 / 0.2e1 + t108 * t109 * t218 / 0.2e1 + t114 * t218 / 0.2e1;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t230 = t85 * t95;
  t236 = t93 * t93;
  t238 = 0.1e1 / t28 / t236;
  t239 = sigma[0] * t238;
  t242 = 0.88e2 / 0.9e1 * t239 * t64 - 0.88e2 / 0.9e1 * t239;
  t264 = 0.1e1 / t15;
  t267 = 0.5e1 / 0.36e2 * t230 * t88 + 0.3e1 / 0.2e1 * t92 * t22 * t170 + t92 * t23 * t242 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t28 * t170 + t103 * t29 * t242 / 0.2e1 + 0.11e2 / 0.6e1 * t108 * t79 * t170 + t108 * t109 * t242 / 0.2e1 + 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t136 + 0.5e1 / 0.9e1 * t27 * t264;
  t281 = 0.1e1 / t23;
  t287 = 0.1e1 / t7 / t164;
  t292 = 0.1e1 / t164;
  t298 = 0.1e1 / t79 / t93;
  t309 = 0.1e1 / t7;
  t313 = t113 * t98 + 0.2e1 * t186 * t170 + t114 * t242 / 0.2e1 - 0.5e1 / 0.144e3 * t43 * t152 * t34 * t38 - t49 * t157 * t34 * t38 / 0.18e2 - t55 * t281 * t34 * t38 / 0.16e2 + 0.91e2 / 0.288e3 * t61 * t287 * sigma[0] * t64 + t69 * t292 * sigma[0] * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t298 * sigma[0] * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t98 + 0.5e1 / 0.9e1 * t103 * t264 * t98 + 0.55e2 / 0.72e2 * t108 * t309 * t98;
  tv2rho20 = t267 + t313;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t342 = -0.8e1 / 0.3e1 * t166 * t64 + 0.8e1 / 0.3e1 * t166;
  tv2rhosigma0 = t43 * t80 * t190 * t38 / 0.48e2 + t49 * t86 * t190 * t38 / 0.24e2 + t55 * t136 * t190 * t38 / 0.16e2 - 0.7e1 / 0.48e2 * t61 * t142 * t64 - t69 * t147 * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * t64 - t158 * t64 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t218 + t92 * t23 * t342 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t218 + t103 * t29 * t342 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t218 + t108 * t109 * t342 / 0.2e1 + t186 * t218 + t114 * t342 / 0.2e1;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t362 = 0.1e1 / t34 / sigma[0];
  tv2sigma20 = -t49 * t15 * t362 * t38 / 0.16e2 - t55 * t22 * t362 * t38 / 0.16e2 - t43 * t7 * t362 * t38 / 0.16e2 - t33 * t362 * t38 / 0.16e2;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  double t136, t142, t147, t152, t157, t158, t164, t166;
  double t167, t170, t186, tvrho0, t190, t218, tvsigma0;

  double t230, t236, t238, t239, t242, t264, t267, t281;
  double t287, t292, t298, t309, t313, tv2rho20, t342, tv2rhosigma0;
  double t362, tv2sigma20;

  double t381, t386, t388, t389, t392, t404, t410, t415;
  double t421, t428, t456, t468, tv3rho30, t500, tv3rho2sigma0, tv3rhosigma20;
  double t539, t541, tv3sigma30;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t136 = 0.1e1 / t22;
  t142 = 0.1e1 / t7 / t93;
  t147 = 0.1e1 / t93;
  t152 = 0.1e1 / t109;
  t157 = 0.1e1 / t29;
  t158 = t85 * t157;
  t164 = t93 * rho[0];
  t166 = 0.1e1 / t28 / t164;
  t167 = sigma[0] * t166;
  t170 = -0.8e1 / 0.3e1 * t167 * t64 + 0.8e1 / 0.3e1 * t167;
  t186 = t113 * rho[0];
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t43 * t80 * t34 * t38 / 0.24e2 + t49 * t86 * t34 * t38 / 0.12e2 + t55 * t136 * t34 * t38 / 0.8e1 - 0.7e1 / 0.48e2 * t61 * t142 * sigma[0] * t64 - t69 * t147 * sigma[0] * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * sigma[0] * t64 - t158 * t88 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t98 + t92 * t23 * t170 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t98 + t103 * t29 * t170 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t98 + t108 * t109 * t170 / 0.2e1 + t186 * t98 + t114 * t170 / 0.2e1 + t117;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t190 = 0.1e1 / t34;
  t218 = t95 * t64 - t95;
  tvsigma0 = t33 * t190 * t38 / 0.8e1 + t43 * t7 * t190 * t38 / 0.8e1 + t49 * t15 * t190 * t38 / 0.8e1 + t55 * t22 * t190 * t38 / 0.8e1 + t61 * t62 * t64 / 0.8e1 + t69 * t70 * t64 / 0.8e1 + t76 * t80 * t64 / 0.8e1 + t87 * t64 / 0.8e1 + t92 * t23 * t218 / 0.2e1 + t103 * t29 * t218 / 0.2e1 + t108 * t109 * t218 / 0.2e1 + t114 * t218 / 0.2e1;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t230 = t85 * t95;
  t236 = t93 * t93;
  t238 = 0.1e1 / t28 / t236;
  t239 = sigma[0] * t238;
  t242 = 0.88e2 / 0.9e1 * t239 * t64 - 0.88e2 / 0.9e1 * t239;
  t264 = 0.1e1 / t15;
  t267 = 0.5e1 / 0.36e2 * t230 * t88 + 0.3e1 / 0.2e1 * t92 * t22 * t170 + t92 * t23 * t242 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t28 * t170 + t103 * t29 * t242 / 0.2e1 + 0.11e2 / 0.6e1 * t108 * t79 * t170 + t108 * t109 * t242 / 0.2e1 + 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t136 + 0.5e1 / 0.9e1 * t27 * t264;
  t281 = 0.1e1 / t23;
  t287 = 0.1e1 / t7 / t164;
  t292 = 0.1e1 / t164;
  t298 = 0.1e1 / t79 / t93;
  t309 = 0.1e1 / t7;
  t313 = t113 * t98 + 0.2e1 * t186 * t170 + t114 * t242 / 0.2e1 - 0.5e1 / 0.144e3 * t43 * t152 * t34 * t38 - t49 * t157 * t34 * t38 / 0.18e2 - t55 * t281 * t34 * t38 / 0.16e2 + 0.91e2 / 0.288e3 * t61 * t287 * sigma[0] * t64 + t69 * t292 * sigma[0] * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t298 * sigma[0] * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t98 + 0.5e1 / 0.9e1 * t103 * t264 * t98 + 0.55e2 / 0.72e2 * t108 * t309 * t98;
  tv2rho20 = t267 + t313;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t342 = -0.8e1 / 0.3e1 * t166 * t64 + 0.8e1 / 0.3e1 * t166;
  tv2rhosigma0 = t43 * t80 * t190 * t38 / 0.48e2 + t49 * t86 * t190 * t38 / 0.24e2 + t55 * t136 * t190 * t38 / 0.16e2 - 0.7e1 / 0.48e2 * t61 * t142 * t64 - t69 * t147 * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * t64 - t158 * t64 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t218 + t92 * t23 * t342 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t218 + t103 * t29 * t342 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t218 + t108 * t109 * t342 / 0.2e1 + t186 * t218 + t114 * t342 / 0.2e1;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t362 = 0.1e1 / t34 / sigma[0];
  tv2sigma20 = -t49 * t15 * t362 * t38 / 0.16e2 - t55 * t22 * t362 * t38 / 0.16e2 - t43 * t7 * t362 * t38 / 0.16e2 - t33 * t362 * t38 / 0.16e2;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t381 = 0.1e1 / t16;
  t386 = t236 * rho[0];
  t388 = 0.1e1 / t28 / t386;
  t389 = sigma[0] * t388;
  t392 = -0.1232e4 / 0.27e2 * t389 * t64 + 0.1232e4 / 0.27e2 * t389;
  t404 = 0.1e1 / t22 / t93;
  t410 = 0.1e1 / t7 / t236;
  t415 = 0.1e1 / t236;
  t421 = 0.1e1 / t79 / t164;
  t428 = -0.35e2 / 0.432e3 * t6 * t152 - 0.4e1 / 0.27e2 * t14 * t157 - 0.3e1 / 0.16e2 * t21 * t281 - 0.5e1 / 0.27e2 * t27 * t381 + 0.3e1 * t186 * t242 + t114 * t392 / 0.2e1 + 0.55e2 / 0.864e3 * t43 * t298 * t34 * t38 + 0.5e1 / 0.54e2 * t49 * t95 * t34 * t38 + 0.3e1 / 0.32e2 * t55 * t404 * t34 * t38 - 0.1729e4 / 0.1728e4 * t61 * t410 * sigma[0] * t64 - 0.3e1 / 0.4e1 * t69 * t415 * sigma[0] * t64 - 0.935e3 / 0.1728e4 * t76 * t421 * sigma[0] * t64 + 0.3e1 * t113 * t170;
  t456 = t85 * t166;
  t468 = 0.55e2 / 0.24e2 * t108 * t309 * t170 - 0.3e1 / 0.16e2 * t92 * t281 * t98 - 0.5e1 / 0.27e2 * t103 * t381 * t98 - 0.55e2 / 0.432e3 * t108 * t62 * t98 + t92 * t23 * t392 / 0.2e1 + 0.5e1 / 0.2e1 * t103 * t28 * t242 + t103 * t29 * t392 / 0.2e1 + 0.11e2 / 0.4e1 * t108 * t79 * t242 + t108 * t109 * t392 / 0.2e1 - 0.1e2 / 0.27e2 * t456 * t88 + 0.9e1 / 0.4e1 * t92 * t22 * t242 + 0.9e1 / 0.8e1 * t92 * t136 * t170 + 0.5e1 / 0.3e1 * t103 * t264 * t170;
  tv3rho30 = t428 + t468;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t500 = 0.88e2 / 0.9e1 * t238 * t64 - 0.88e2 / 0.9e1 * t238;
  tv3rho2sigma0 = -0.5e1 / 0.288e3 * t43 * t152 * t190 * t38 - t49 * t157 * t190 * t38 / 0.36e2 - t55 * t281 * t190 * t38 / 0.32e2 + 0.91e2 / 0.288e3 * t61 * t287 * t64 + t69 * t292 * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t298 * t64 + 0.5e1 / 0.36e2 * t230 * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t218 + 0.3e1 / 0.2e1 * t92 * t22 * t342 + t92 * t23 * t500 / 0.2e1 + 0.5e1 / 0.9e1 * t103 * t264 * t218 + 0.5e1 / 0.3e1 * t103 * t28 * t342 + t103 * t29 * t500 / 0.2e1 + 0.55e2 / 0.72e2 * t108 * t309 * t218 + 0.11e2 / 0.6e1 * t108 * t79 * t342 + t108 * t109 * t500 / 0.2e1 + t113 * t218 + 0.2e1 * t186 * t342 + t114 * t500 / 0.2e1;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = -t43 * t80 * t362 * t38 / 0.96e2 - t49 * t86 * t362 * t38 / 0.48e2 - t55 * t136 * t362 * t38 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t539 = sigma[0] * sigma[0];
  t541 = 0.1e1 / t34 / t539;
  tv3sigma30 = 0.3e1 / 0.32e2 * t49 * t15 * t541 * t38 + 0.3e1 / 0.32e2 * t55 * t22 * t541 * t38 + 0.3e1 / 0.32e2 * t43 * t7 * t541 * t38 + 0.3e1 / 0.32e2 * t33 * t541 * t38;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t12, t13;
  double t14, t15, t16, t20, t21, t22, t23, t27;
  double t28, t29, t33, t34, t36, t38, t43, t49;
  double t55, t61, t62, t64, t69, t70, t76, t77;
  double t78, t79, t80, t85, t86, t87, t88, t92;
  double t93, t95, t96, t98, t103, t108, t109, t113;
  double t114, t117, t119, tzk0;

  double t136, t142, t147, t152, t157, t158, t164, t166;
  double t167, t170, t186, tvrho0, t190, t218, tvsigma0;

  double t230, t236, t238, t239, t242, t264, t267, t281;
  double t287, t292, t298, t309, t313, tv2rho20, t342, tv2rhosigma0;
  double t362, tv2sigma20;

  double t381, t386, t388, t389, t392, t404, t410, t415;
  double t421, t428, t456, t468, tv3rho30, t500, tv3rho2sigma0, tv3rhosigma20;
  double t539, t541, tv3sigma30;

  double t561, t569, t572, t611, t657, tv4rho40, t664, t693;
  double t727, tv4rho3sigma0, tv4rho2sigma20, tv4rhosigma30, t754, tv4sigma40;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t2 = pow(0.2e1, 0.1e1 / 0.6e1);
  t3 = t2 * t2;
  t4 = t3 * t3;
  t6 = params->omega[0] * t4 * t2;
  t7 = pow(rho[0], 0.1e1 / 0.6e1);
  t8 = t7 * rho[0];
  t12 = M_CBRT2;
  t13 = t12 * t12;
  t14 = params->omega[1] * t13;
  t15 = POW_1_3(rho[0]);
  t16 = t15 * rho[0];
  t20 = M_SQRT2;
  t21 = params->omega[2] * t20;
  t22 = sqrt(rho[0]);
  t23 = t22 * rho[0];
  t27 = params->omega[3] * t12;
  t28 = t15 * t15;
  t29 = t28 * rho[0];
  t33 = params->omega[4] * t13;
  t34 = sqrt(sigma[0]);
  t36 = POW_1_3(p->zeta_threshold);
  t38 = my_piecewise3(0.1e1 <= p->zeta_threshold, t36 * p->zeta_threshold, 1);
  t43 = params->omega[5] * t20;
  t49 = params->omega[6] * t12;
  t55 = params->omega[7] * t2;
  t61 = params->omega[8] * t20;
  t62 = 0.1e1 / t8;
  t64 = t38 * t38;
  t69 = params->omega[9] * t12;
  t70 = 0.1e1 / rho[0];
  t76 = params->omega[10] * t2;
  t77 = t7 * t7;
  t78 = t77 * t77;
  t79 = t78 * t7;
  t80 = 0.1e1 / t79;
  t85 = params->omega[11];
  t86 = 0.1e1 / t28;
  t87 = t85 * t86;
  t88 = sigma[0] * t64;
  t92 = params->omega[12] * t20;
  t93 = rho[0] * rho[0];
  t95 = 0.1e1 / t28 / t93;
  t96 = sigma[0] * t95;
  t98 = t96 * t64 - t96;
  t103 = params->omega[13] * t12;
  t108 = params->omega[14] * t2;
  t109 = t79 * rho[0];
  t113 = params->omega[15];
  t114 = t113 * t93;
  t117 = params->omega[20];
  t119 = t6 * t8 / 0.2e1 + t14 * t16 / 0.2e1 + t21 * t23 / 0.2e1 + t27 * t29 / 0.2e1 + t33 * t34 * t38 / 0.4e1 + t43 * t7 * t34 * t38 / 0.4e1 + t49 * t15 * t34 * t38 / 0.4e1 + t55 * t22 * t34 * t38 / 0.4e1 + t61 * t62 * sigma[0] * t64 / 0.8e1 + t69 * t70 * sigma[0] * t64 / 0.8e1 + t76 * t80 * sigma[0] * t64 / 0.8e1 + t87 * t88 / 0.8e1 + t92 * t23 * t98 / 0.2e1 + t103 * t29 * t98 / 0.2e1 + t108 * t109 * t98 / 0.2e1 + t114 * t98 / 0.2e1 + t117 * rho[0];
  tzk0 = t119 * t70;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t136 = 0.1e1 / t22;
  t142 = 0.1e1 / t7 / t93;
  t147 = 0.1e1 / t93;
  t152 = 0.1e1 / t109;
  t157 = 0.1e1 / t29;
  t158 = t85 * t157;
  t164 = t93 * rho[0];
  t166 = 0.1e1 / t28 / t164;
  t167 = sigma[0] * t166;
  t170 = -0.8e1 / 0.3e1 * t167 * t64 + 0.8e1 / 0.3e1 * t167;
  t186 = t113 * rho[0];
  tvrho0 = 0.7e1 / 0.12e2 * t6 * t7 + 0.2e1 / 0.3e1 * t14 * t15 + 0.3e1 / 0.4e1 * t21 * t22 + 0.5e1 / 0.6e1 * t27 * t28 + t43 * t80 * t34 * t38 / 0.24e2 + t49 * t86 * t34 * t38 / 0.12e2 + t55 * t136 * t34 * t38 / 0.8e1 - 0.7e1 / 0.48e2 * t61 * t142 * sigma[0] * t64 - t69 * t147 * sigma[0] * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * sigma[0] * t64 - t158 * t88 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t98 + t92 * t23 * t170 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t98 + t103 * t29 * t170 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t98 + t108 * t109 * t170 / 0.2e1 + t186 * t98 + t114 * t170 / 0.2e1 + t117;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t190 = 0.1e1 / t34;
  t218 = t95 * t64 - t95;
  tvsigma0 = t33 * t190 * t38 / 0.8e1 + t43 * t7 * t190 * t38 / 0.8e1 + t49 * t15 * t190 * t38 / 0.8e1 + t55 * t22 * t190 * t38 / 0.8e1 + t61 * t62 * t64 / 0.8e1 + t69 * t70 * t64 / 0.8e1 + t76 * t80 * t64 / 0.8e1 + t87 * t64 / 0.8e1 + t92 * t23 * t218 / 0.2e1 + t103 * t29 * t218 / 0.2e1 + t108 * t109 * t218 / 0.2e1 + t114 * t218 / 0.2e1;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t230 = t85 * t95;
  t236 = t93 * t93;
  t238 = 0.1e1 / t28 / t236;
  t239 = sigma[0] * t238;
  t242 = 0.88e2 / 0.9e1 * t239 * t64 - 0.88e2 / 0.9e1 * t239;
  t264 = 0.1e1 / t15;
  t267 = 0.5e1 / 0.36e2 * t230 * t88 + 0.3e1 / 0.2e1 * t92 * t22 * t170 + t92 * t23 * t242 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t28 * t170 + t103 * t29 * t242 / 0.2e1 + 0.11e2 / 0.6e1 * t108 * t79 * t170 + t108 * t109 * t242 / 0.2e1 + 0.7e1 / 0.72e2 * t6 * t80 + 0.2e1 / 0.9e1 * t14 * t86 + 0.3e1 / 0.8e1 * t21 * t136 + 0.5e1 / 0.9e1 * t27 * t264;
  t281 = 0.1e1 / t23;
  t287 = 0.1e1 / t7 / t164;
  t292 = 0.1e1 / t164;
  t298 = 0.1e1 / t79 / t93;
  t309 = 0.1e1 / t7;
  t313 = t113 * t98 + 0.2e1 * t186 * t170 + t114 * t242 / 0.2e1 - 0.5e1 / 0.144e3 * t43 * t152 * t34 * t38 - t49 * t157 * t34 * t38 / 0.18e2 - t55 * t281 * t34 * t38 / 0.16e2 + 0.91e2 / 0.288e3 * t61 * t287 * sigma[0] * t64 + t69 * t292 * sigma[0] * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t298 * sigma[0] * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t98 + 0.5e1 / 0.9e1 * t103 * t264 * t98 + 0.55e2 / 0.72e2 * t108 * t309 * t98;
  tv2rho20 = t267 + t313;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t342 = -0.8e1 / 0.3e1 * t166 * t64 + 0.8e1 / 0.3e1 * t166;
  tv2rhosigma0 = t43 * t80 * t190 * t38 / 0.48e2 + t49 * t86 * t190 * t38 / 0.24e2 + t55 * t136 * t190 * t38 / 0.16e2 - 0.7e1 / 0.48e2 * t61 * t142 * t64 - t69 * t147 * t64 / 0.8e1 - 0.5e1 / 0.48e2 * t76 * t152 * t64 - t158 * t64 / 0.12e2 + 0.3e1 / 0.4e1 * t92 * t22 * t218 + t92 * t23 * t342 / 0.2e1 + 0.5e1 / 0.6e1 * t103 * t28 * t218 + t103 * t29 * t342 / 0.2e1 + 0.11e2 / 0.12e2 * t108 * t79 * t218 + t108 * t109 * t342 / 0.2e1 + t186 * t218 + t114 * t342 / 0.2e1;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t362 = 0.1e1 / t34 / sigma[0];
  tv2sigma20 = -t49 * t15 * t362 * t38 / 0.16e2 - t55 * t22 * t362 * t38 / 0.16e2 - t43 * t7 * t362 * t38 / 0.16e2 - t33 * t362 * t38 / 0.16e2;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t381 = 0.1e1 / t16;
  t386 = t236 * rho[0];
  t388 = 0.1e1 / t28 / t386;
  t389 = sigma[0] * t388;
  t392 = -0.1232e4 / 0.27e2 * t389 * t64 + 0.1232e4 / 0.27e2 * t389;
  t404 = 0.1e1 / t22 / t93;
  t410 = 0.1e1 / t7 / t236;
  t415 = 0.1e1 / t236;
  t421 = 0.1e1 / t79 / t164;
  t428 = -0.35e2 / 0.432e3 * t6 * t152 - 0.4e1 / 0.27e2 * t14 * t157 - 0.3e1 / 0.16e2 * t21 * t281 - 0.5e1 / 0.27e2 * t27 * t381 + 0.3e1 * t186 * t242 + t114 * t392 / 0.2e1 + 0.55e2 / 0.864e3 * t43 * t298 * t34 * t38 + 0.5e1 / 0.54e2 * t49 * t95 * t34 * t38 + 0.3e1 / 0.32e2 * t55 * t404 * t34 * t38 - 0.1729e4 / 0.1728e4 * t61 * t410 * sigma[0] * t64 - 0.3e1 / 0.4e1 * t69 * t415 * sigma[0] * t64 - 0.935e3 / 0.1728e4 * t76 * t421 * sigma[0] * t64 + 0.3e1 * t113 * t170;
  t456 = t85 * t166;
  t468 = 0.55e2 / 0.24e2 * t108 * t309 * t170 - 0.3e1 / 0.16e2 * t92 * t281 * t98 - 0.5e1 / 0.27e2 * t103 * t381 * t98 - 0.55e2 / 0.432e3 * t108 * t62 * t98 + t92 * t23 * t392 / 0.2e1 + 0.5e1 / 0.2e1 * t103 * t28 * t242 + t103 * t29 * t392 / 0.2e1 + 0.11e2 / 0.4e1 * t108 * t79 * t242 + t108 * t109 * t392 / 0.2e1 - 0.1e2 / 0.27e2 * t456 * t88 + 0.9e1 / 0.4e1 * t92 * t22 * t242 + 0.9e1 / 0.8e1 * t92 * t136 * t170 + 0.5e1 / 0.3e1 * t103 * t264 * t170;
  tv3rho30 = t428 + t468;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t500 = 0.88e2 / 0.9e1 * t238 * t64 - 0.88e2 / 0.9e1 * t238;
  tv3rho2sigma0 = -0.5e1 / 0.288e3 * t43 * t152 * t190 * t38 - t49 * t157 * t190 * t38 / 0.36e2 - t55 * t281 * t190 * t38 / 0.32e2 + 0.91e2 / 0.288e3 * t61 * t287 * t64 + t69 * t292 * t64 / 0.4e1 + 0.55e2 / 0.288e3 * t76 * t298 * t64 + 0.5e1 / 0.36e2 * t230 * t64 + 0.3e1 / 0.8e1 * t92 * t136 * t218 + 0.3e1 / 0.2e1 * t92 * t22 * t342 + t92 * t23 * t500 / 0.2e1 + 0.5e1 / 0.9e1 * t103 * t264 * t218 + 0.5e1 / 0.3e1 * t103 * t28 * t342 + t103 * t29 * t500 / 0.2e1 + 0.55e2 / 0.72e2 * t108 * t309 * t218 + 0.11e2 / 0.6e1 * t108 * t79 * t342 + t108 * t109 * t500 / 0.2e1 + t113 * t218 + 0.2e1 * t186 * t342 + t114 * t500 / 0.2e1;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = -t43 * t80 * t362 * t38 / 0.96e2 - t49 * t86 * t362 * t38 / 0.48e2 - t55 * t136 * t362 * t38 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t539 = sigma[0] * sigma[0];
  t541 = 0.1e1 / t34 / t539;
  tv3sigma30 = 0.3e1 / 0.32e2 * t49 * t15 * t541 * t38 + 0.3e1 / 0.32e2 * t55 * t22 * t541 * t38 + 0.3e1 / 0.32e2 * t43 * t7 * t541 * t38 + 0.3e1 / 0.32e2 * t33 * t541 * t38;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t561 = 0.1e1 / t15 / t93;
  t569 = sigma[0] / t28 / t236 / t93;
  t572 = 0.20944e5 / 0.81e2 * t569 * t64 - 0.20944e5 / 0.81e2 * t569;
  t611 = 0.385e3 / 0.2592e4 * t6 * t298 + 0.2e2 / 0.81e2 * t14 * t95 + 0.9e1 / 0.32e2 * t21 * t404 + 0.2e2 / 0.81e2 * t27 * t561 + 0.4e1 * t186 * t392 + t114 * t572 / 0.2e1 - 0.935e3 / 0.5184e4 * t43 * t421 * t34 * t38 - 0.2e2 / 0.81e2 * t49 * t166 * t34 * t38 - 0.15e2 / 0.64e2 * t55 / t22 / t164 * t34 * t38 + 0.43225e5 / 0.10368e5 * t61 / t7 / t386 * sigma[0] * t64 + 0.3e1 * t69 / t386 * sigma[0] * t64 + 0.21505e5 / 0.10368e5 * t76 / t79 / t236 * sigma[0] * t64 + 0.6e1 * t113 * t242 + t92 * t23 * t572 / 0.2e1;
  t657 = 0.1e2 / 0.3e1 * t103 * t28 * t392 - 0.3e1 / 0.4e1 * t92 * t281 * t170 - 0.2e2 / 0.27e2 * t103 * t381 * t170 - 0.55e2 / 0.108e3 * t108 * t62 * t170 + 0.9e1 / 0.32e2 * t92 * t404 * t98 + 0.2e2 / 0.81e2 * t103 * t561 * t98 + 0.385e3 / 0.2592e4 * t108 * t142 * t98 + 0.3e1 * t92 * t22 * t392 + t103 * t29 * t572 / 0.2e1 + 0.11e2 / 0.3e1 * t108 * t79 * t392 + t108 * t109 * t572 / 0.2e1 + 0.11e3 / 0.81e2 * t85 * t238 * t88 + 0.9e1 / 0.4e1 * t92 * t136 * t242 + 0.1e2 / 0.3e1 * t103 * t264 * t242 + 0.55e2 / 0.12e2 * t108 * t309 * t242;
  tv4rho40 = t611 + t657;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t664 = -0.1232e4 / 0.27e2 * t388 * t64 + 0.1232e4 / 0.27e2 * t388;
  t693 = -0.1e2 / 0.27e2 * t456 * t64 + 0.3e1 * t186 * t500 + t114 * t664 / 0.2e1 - 0.55e2 / 0.432e3 * t108 * t62 * t218 + 0.55e2 / 0.1728e4 * t43 * t298 * t190 * t38 + 0.5e1 / 0.108e3 * t49 * t95 * t190 * t38 + 0.3e1 / 0.64e2 * t55 * t404 * t190 * t38 - 0.3e1 / 0.16e2 * t92 * t281 * t218 - 0.5e1 / 0.27e2 * t103 * t381 * t218 + 0.3e1 * t113 * t342 - 0.1729e4 / 0.1728e4 * t61 * t410 * t64;
  t727 = -0.3e1 / 0.4e1 * t69 * t415 * t64 - 0.935e3 / 0.1728e4 * t76 * t421 * t64 + 0.9e1 / 0.8e1 * t92 * t136 * t342 + 0.9e1 / 0.4e1 * t92 * t22 * t500 + t92 * t23 * t664 / 0.2e1 + 0.5e1 / 0.3e1 * t103 * t264 * t342 + 0.5e1 / 0.2e1 * t103 * t28 * t500 + t103 * t29 * t664 / 0.2e1 + 0.55e2 / 0.24e2 * t108 * t309 * t342 + 0.11e2 / 0.4e1 * t108 * t79 * t500 + t108 * t109 * t664 / 0.2e1;
  tv4rho3sigma0 = t693 + t727;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho2sigma20 = 0.5e1 / 0.576e3 * t43 * t152 * t362 * t38 + t49 * t157 * t362 * t38 / 0.72e2 + t55 * t281 * t362 * t38 / 0.64e2;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rhosigma30 = t43 * t80 * t541 * t38 / 0.64e2 + t49 * t86 * t541 * t38 / 0.32e2 + 0.3e1 / 0.64e2 * t55 * t136 * t541 * t38;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t754 = 0.1e1 / t34 / t539 / sigma[0];
  tv4sigma40 = -0.15e2 / 0.64e2 * t49 * t15 * t754 * t38 - 0.15e2 / 0.64e2 * t55 * t22 * t754 * t38 - 0.15e2 / 0.64e2 * t43 * t7 * t754 * t38 - 0.15e2 / 0.64e2 * t33 * t754 * t38;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t168, t170, t171, t172, t174, t175, t176, t179;
  double t180, t181, t183, t184, t187, t188, t189, t191;
  double t194, t199, t204, t209, t211, t213, t214, t216;
  double t220, t224, t228, t232, t233, t236, t239, t242;
  double t245, t246, t251, t256, t261, t266, t270, t272;
  double t273, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t316, t317, t318, t320, t322, t323, t324, t326;
  double t329, t330, t331, t333, t336, t341, t343, t347;
  double t351, t355, t358, t362, t363, t366, t369, t372;
  double t377, t380, t383, t388, t393, t398, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t168 = t86 * rho[0];
  t170 = 0.1e1 / t23 / t168;
  t171 = sigma[0] * t170;
  t172 = t171 * t91;
  t174 = t44 * t45;
  t175 = t34 * t144;
  t176 = t36 - t175;
  t179 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t176);
  t180 = t174 * t179;
  t181 = t89 * t180;
  t183 = t56 * t45;
  t184 = -t176;
  t187 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t184);
  t188 = t183 * t187;
  t189 = t96 * t188;
  t191 = -t172 / 0.3e1 + t181 / 0.4e1 + t189 / 0.4e1;
  t194 = t104 * t23;
  t199 = t109 * t74;
  t204 = t113 * rho[0];
  t209 = t124 * t35;
  t211 = 0.1e1 / t126 / t209;
  t213 = 0.8e1 / 0.3e1 * t123 * t211;
  t214 = -0.2e1 / 0.3e1 * t172 + t181 / 0.2e1 + t189 / 0.2e1 + t213;
  t216 = t118 * t16;
  t220 = t132 * t23;
  t224 = t135 * t74;
  t228 = t138 * rho[0];
  t232 = 0.1e1 / t9 / t86;
  t233 = t31 * t232;
  t236 = t179 * t46;
  t239 = t187 * t46;
  t242 = -t233 * t47 / 0.3e1 + t33 * t236 / 0.4e1 + t51 * t239 / 0.4e1;
  t245 = t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + t105 * t191 / 0.2e1 + 0.5e1 / 0.6e1 * t194 * t101 + t110 * t191 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t101 + t115 * t191 / 0.2e1 + t204 * t101 + t119 * t214 + 0.3e1 / 0.2e1 * t216 * t130 + t133 * t214 + 0.5e1 / 0.3e1 * t220 * t130 + t136 * t214 + 0.11e2 / 0.6e1 * t224 * t130 + t139 * t214 + 0.2e1 * t228 * t130 + t30 * t242 / 0.2e1;
  t246 = t29 * t9;
  t251 = t63 * t16;
  t256 = t67 * t23;
  t261 = t71 * t74;
  t266 = t84 * t16;
  t270 = 0.2e1 * t142 * t175;
  t272 = 0.1e1 / t209;
  t273 = t143 * t272;
  t275 = 0.2e1 * t142 * t273;
  t277 = 0.2e1 * t148 * t175;
  t279 = 0.2e1 * t148 * t273;
  t281 = 0.2e1 * t151 * t175;
  t283 = 0.2e1 * t151 * t273;
  t285 = 0.2e1 * t154 * t175;
  t287 = 0.2e1 * t154 * t273;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = -t275 + t277 - t279 + t281 - t283 + t285 - t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t245 + 0.2e1 / 0.3e1 * t246 * t60 + t64 * t242 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t60 + t68 * t242 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t60 + t81 * t242 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t60 + t85 * t191 / 0.2e1 + 0.3e1 / 0.4e1 * t266 * t101 + t270 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t310 = t109 * t78;
  t313 = -t36 - t175;
  t316 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t313);
  t317 = t174 * t316;
  t318 = t89 * t317;
  t320 = t93 * rho[1];
  t322 = 0.1e1 / t25 / t320;
  t323 = sigma[2] * t322;
  t324 = t323 * t98;
  t326 = -t313;
  t329 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t326);
  t330 = t183 * t329;
  t331 = t96 * t330;
  t333 = t318 / 0.4e1 - t324 / 0.3e1 + t331 / 0.4e1;
  t336 = t113 * rho[1];
  t341 = t318 / 0.2e1 - 0.2e1 / 0.3e1 * t324 + t331 / 0.2e1 + t213;
  t343 = t118 * t18;
  t347 = t132 * t25;
  t351 = t135 * t78;
  t355 = t138 * rho[1];
  t358 = t316 * t46;
  t362 = 0.1e1 / t11 / t93;
  t363 = t49 * t362;
  t366 = t329 * t46;
  t369 = t33 * t358 / 0.4e1 - t363 * t57 / 0.3e1 + t51 * t366 / 0.4e1;
  t372 = t29 * t11;
  t377 = t63 * t18;
  t380 = t156 + 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + 0.11e2 / 0.12e2 * t310 * t101 + t115 * t333 / 0.2e1 + t336 * t101 + t119 * t341 + 0.3e1 / 0.2e1 * t343 * t130 + t133 * t341 + 0.5e1 / 0.3e1 * t347 * t130 + t136 * t341 + 0.11e2 / 0.6e1 * t351 * t130 + t139 * t341 + 0.2e1 * t355 * t130 + t30 * t369 / 0.2e1 + 0.2e1 / 0.3e1 * t372 * t60 + t64 * t369 / 0.2e1 + 0.3e1 / 0.4e1 * t377 * t60;
  t383 = t67 * t25;
  t388 = t71 * t78;
  t393 = t84 * t18;
  t398 = t104 * t25;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = -t275 - t277 - t279 - t281 - t283 - t285 - t287 + 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145;
  tvrho1 = t380 + t68 * t369 / 0.2e1 + 0.5e1 / 0.6e1 * t383 * t60 + t81 * t369 / 0.2e1 + 0.11e2 / 0.12e2 * t388 * t60 + t85 * t333 / 0.2e1 + 0.3e1 / 0.4e1 * t393 * t101 + t105 * t333 / 0.2e1 + 0.5e1 / 0.6e1 * t398 * t101 + t110 * t333 / 0.2e1 - t270 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t128 * t133 - 0.2e1 * t128 * t136 - 0.2e1 * t128 * t139;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t168, t170, t171, t172, t174, t175, t176, t179;
  double t180, t181, t183, t184, t187, t188, t189, t191;
  double t194, t199, t204, t209, t211, t213, t214, t216;
  double t220, t224, t228, t232, t233, t236, t239, t242;
  double t245, t246, t251, t256, t261, t266, t270, t272;
  double t273, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t316, t317, t318, t320, t322, t323, t324, t326;
  double t329, t330, t331, t333, t336, t341, t343, t347;
  double t351, t355, t358, t362, t363, t366, t369, t372;
  double t377, t380, t383, t388, t393, t398, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  double t488, t489, t494, t495, t496, t499, t501, t505;
  double t506, t509, t510, t511, t514, t518, t519, t522;
  double t535, t537, t538, t539, t541, t543, t544, t545;
  double t547, t548, t550, t551, t552, t554, t555, t557;
  double t580, t582, t584, t585, t587, t599, t600, t603;
  double t604, t607, t608, t611, t612, t615, t618, t621;
  double t624, t627, t630, t632, t636, t638, t640, t642;
  double t643, t645, t646, t658, t659, t660, t662, t663;
  double t666, t668, t669, t671, t674, t676, t678, t681;
  double t683, t685, t688, t690, t693, t695, t697, t699;
  double t701, t703, t704, tv2rho20, t706, t708, t709, t710;
  double t712, t715, t719, t720, t721, t723, t725, t726;
  double t727, t729, t732, t736, t737, t738, t740, t753;
  double t758, t761, t780, t793, t816, t832, t837, t839;
  double t841, t843, t845, t847, t849, t851, t853, tv2rho21;
  double t857, t858, t859, t861, t865, t869, t870, t871;
  double t873, t875, t876, t877, t879, t881, t882, t883;
  double t885, t888, t892, t893, t894, t896, t900, t901;
  double t904, t905, t908, t909, t912, t913, t916, t919;
  double t922, t925, t928, t931, t934, t938, t939, t944;
  double t947, t954, t971, t992, t997, t1006, t1015, t1018;
  double t1021, t1024, t1027, tv2rho22, t1030, t1032, t1035, t1036;
  double t1050, t1052, t1055, t1058, t1061, t1072, t1074, t1075;
  double t1078, t1079, t1082, t1083, t1086, t1087, t1090, t1093;
  double t1097, t1106, t1109, t1113, t1122, tv2rhosigma0, t1126, t1130;
  double t1134, t1138, tv2rhosigma1, t1139, t1143, t1146, t1151, t1156;
  double t1163, t1168, t1171, t1174, t1179, t1184, t1187, t1198;
  double tv2rhosigma2, t1199, t1203, t1206, t1211, t1216, t1229, t1240;
  double t1243, t1254, tv2rhosigma3, tv2rhosigma4, t1264, t1266, t1269, t1283;
  double t1285, t1288, t1291, t1294, t1305, t1307, t1308, t1311;
  double t1312, t1315, t1316, t1319, t1320, t1330, t1342, t1351;
  double tv2rhosigma5, t1353, t1354, t1356, t1358, t1360, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1364, t1365, t1367, t1369, t1371;
  double tv2sigma25;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t168 = t86 * rho[0];
  t170 = 0.1e1 / t23 / t168;
  t171 = sigma[0] * t170;
  t172 = t171 * t91;
  t174 = t44 * t45;
  t175 = t34 * t144;
  t176 = t36 - t175;
  t179 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t176);
  t180 = t174 * t179;
  t181 = t89 * t180;
  t183 = t56 * t45;
  t184 = -t176;
  t187 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t184);
  t188 = t183 * t187;
  t189 = t96 * t188;
  t191 = -t172 / 0.3e1 + t181 / 0.4e1 + t189 / 0.4e1;
  t194 = t104 * t23;
  t199 = t109 * t74;
  t204 = t113 * rho[0];
  t209 = t124 * t35;
  t211 = 0.1e1 / t126 / t209;
  t213 = 0.8e1 / 0.3e1 * t123 * t211;
  t214 = -0.2e1 / 0.3e1 * t172 + t181 / 0.2e1 + t189 / 0.2e1 + t213;
  t216 = t118 * t16;
  t220 = t132 * t23;
  t224 = t135 * t74;
  t228 = t138 * rho[0];
  t232 = 0.1e1 / t9 / t86;
  t233 = t31 * t232;
  t236 = t179 * t46;
  t239 = t187 * t46;
  t242 = -t233 * t47 / 0.3e1 + t33 * t236 / 0.4e1 + t51 * t239 / 0.4e1;
  t245 = t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + t105 * t191 / 0.2e1 + 0.5e1 / 0.6e1 * t194 * t101 + t110 * t191 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t101 + t115 * t191 / 0.2e1 + t204 * t101 + t119 * t214 + 0.3e1 / 0.2e1 * t216 * t130 + t133 * t214 + 0.5e1 / 0.3e1 * t220 * t130 + t136 * t214 + 0.11e2 / 0.6e1 * t224 * t130 + t139 * t214 + 0.2e1 * t228 * t130 + t30 * t242 / 0.2e1;
  t246 = t29 * t9;
  t251 = t63 * t16;
  t256 = t67 * t23;
  t261 = t71 * t74;
  t266 = t84 * t16;
  t270 = 0.2e1 * t142 * t175;
  t272 = 0.1e1 / t209;
  t273 = t143 * t272;
  t275 = 0.2e1 * t142 * t273;
  t277 = 0.2e1 * t148 * t175;
  t279 = 0.2e1 * t148 * t273;
  t281 = 0.2e1 * t151 * t175;
  t283 = 0.2e1 * t151 * t273;
  t285 = 0.2e1 * t154 * t175;
  t287 = 0.2e1 * t154 * t273;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = -t275 + t277 - t279 + t281 - t283 + t285 - t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t245 + 0.2e1 / 0.3e1 * t246 * t60 + t64 * t242 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t60 + t68 * t242 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t60 + t81 * t242 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t60 + t85 * t191 / 0.2e1 + 0.3e1 / 0.4e1 * t266 * t101 + t270 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t310 = t109 * t78;
  t313 = -t36 - t175;
  t316 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t313);
  t317 = t174 * t316;
  t318 = t89 * t317;
  t320 = t93 * rho[1];
  t322 = 0.1e1 / t25 / t320;
  t323 = sigma[2] * t322;
  t324 = t323 * t98;
  t326 = -t313;
  t329 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t326);
  t330 = t183 * t329;
  t331 = t96 * t330;
  t333 = t318 / 0.4e1 - t324 / 0.3e1 + t331 / 0.4e1;
  t336 = t113 * rho[1];
  t341 = t318 / 0.2e1 - 0.2e1 / 0.3e1 * t324 + t331 / 0.2e1 + t213;
  t343 = t118 * t18;
  t347 = t132 * t25;
  t351 = t135 * t78;
  t355 = t138 * rho[1];
  t358 = t316 * t46;
  t362 = 0.1e1 / t11 / t93;
  t363 = t49 * t362;
  t366 = t329 * t46;
  t369 = t33 * t358 / 0.4e1 - t363 * t57 / 0.3e1 + t51 * t366 / 0.4e1;
  t372 = t29 * t11;
  t377 = t63 * t18;
  t380 = t156 + 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + 0.11e2 / 0.12e2 * t310 * t101 + t115 * t333 / 0.2e1 + t336 * t101 + t119 * t341 + 0.3e1 / 0.2e1 * t343 * t130 + t133 * t341 + 0.5e1 / 0.3e1 * t347 * t130 + t136 * t341 + 0.11e2 / 0.6e1 * t351 * t130 + t139 * t341 + 0.2e1 * t355 * t130 + t30 * t369 / 0.2e1 + 0.2e1 / 0.3e1 * t372 * t60 + t64 * t369 / 0.2e1 + 0.3e1 / 0.4e1 * t377 * t60;
  t383 = t67 * t25;
  t388 = t71 * t78;
  t393 = t84 * t18;
  t398 = t104 * t25;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = -t275 - t277 - t279 - t281 - t283 - t285 - t287 + 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145;
  tvrho1 = t380 + t68 * t369 / 0.2e1 + 0.5e1 / 0.6e1 * t383 * t60 + t81 * t369 / 0.2e1 + 0.11e2 / 0.12e2 * t388 * t60 + t85 * t333 / 0.2e1 + 0.3e1 / 0.4e1 * t393 * t101 + t105 * t333 / 0.2e1 + 0.5e1 / 0.6e1 * t398 * t101 + t110 * t333 / 0.2e1 - t270 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t128 * t133 - 0.2e1 * t128 * t136 - 0.2e1 * t128 * t139;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t488 = 0.1e1 / t9 / t168;
  t489 = t31 * t488;
  t494 = t42 * t42;
  t495 = 0.1e1 / t494;
  t496 = t176 * t176;
  t499 = t34 * t272;
  t501 = -0.2e1 * t144 + 0.2e1 * t499;
  t505 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t495 * t496 + 0.4e1 / 0.3e1 * t42 * t501);
  t506 = t505 * t46;
  t509 = t54 * t54;
  t510 = 0.1e1 / t509;
  t511 = t184 * t184;
  t514 = -t501;
  t518 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t510 * t511 + 0.4e1 / 0.3e1 * t54 * t514);
  t519 = t518 * t46;
  t522 = 0.7e1 / 0.9e1 * t489 * t47 - 0.2e1 / 0.3e1 * t233 * t236 + t33 * t506 / 0.4e1 + t51 * t519 / 0.4e1;
  t535 = t86 * t86;
  t537 = 0.1e1 / t23 / t535;
  t538 = sigma[0] * t537;
  t539 = t538 * t91;
  t541 = t171 * t180;
  t543 = t179 * t179;
  t544 = t543 * t45;
  t545 = t89 * t544;
  t547 = t174 * t505;
  t548 = t89 * t547;
  t550 = t187 * t187;
  t551 = t550 * t45;
  t552 = t96 * t551;
  t554 = t183 * t518;
  t555 = t96 * t554;
  t557 = 0.11e2 / 0.9e1 * t539 - 0.4e1 / 0.3e1 * t541 + t545 / 0.4e1 + t548 / 0.4e1 + t552 / 0.4e1 + t555 / 0.4e1;
  t580 = t124 * t124;
  t582 = 0.1e1 / t126 / t580;
  t584 = 0.88e2 / 0.9e1 * t123 * t582;
  t585 = 0.22e2 / 0.9e1 * t539 - 0.8e1 / 0.3e1 * t541 + t545 / 0.2e1 + t548 / 0.2e1 + t552 / 0.2e1 + t555 / 0.2e1 - t584;
  t587 = 0.4e1 / 0.3e1 * t246 * t242 + t64 * t522 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t242 + t68 * t522 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t242 + t81 * t522 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t242 + t85 * t557 / 0.2e1 + 0.3e1 / 0.2e1 * t266 * t191 + t105 * t557 / 0.2e1 + 0.5e1 / 0.3e1 * t194 * t191 + t110 * t557 / 0.2e1 + 0.11e2 / 0.6e1 * t199 * t191 + t115 * t557 / 0.2e1 + 0.2e1 * t204 * t191 + t119 * t585;
  t599 = 0.1e1 / t23;
  t600 = t29 * t599;
  t603 = 0.1e1 / t16;
  t604 = t63 * t603;
  t607 = 0.1e1 / t9;
  t608 = t67 * t607;
  t611 = 0.1e1 / t2;
  t612 = t71 * t611;
  t615 = t84 * t603;
  t618 = t104 * t607;
  t621 = t109 * t611;
  t624 = t118 * t603;
  t627 = t132 * t607;
  t630 = 0.3e1 * t216 * t214 + t133 * t585 + 0.1e2 / 0.3e1 * t220 * t214 + t136 * t585 + 0.11e2 / 0.3e1 * t224 * t214 + t139 * t585 + 0.4e1 * t228 * t214 + 0.2e1 / 0.9e1 * t600 * t60 + 0.3e1 / 0.8e1 * t604 * t60 + 0.5e1 / 0.9e1 * t608 * t60 + 0.55e2 / 0.72e2 * t612 * t60 + 0.3e1 / 0.8e1 * t615 * t101 + 0.5e1 / 0.9e1 * t618 * t101 + 0.55e2 / 0.72e2 * t621 * t101 + 0.3e1 / 0.4e1 * t624 * t130 + 0.1e2 / 0.9e1 * t627 * t130;
  t632 = t135 * t611;
  t636 = 0.2e1 * t142 * t144;
  t638 = 0.2e1 * t148 * t144;
  t640 = 0.2e1 * t151 * t144;
  t642 = 0.2e1 * t154 * t144;
  t643 = t113 * t101;
  t645 = 0.2e1 * t138 * t130;
  t646 = 0.1e1 / t74;
  t658 = 0.8e1 * t154 * t499;
  t659 = 0.1e1 / t580;
  t660 = t143 * t659;
  t662 = 0.6e1 * t154 * t660;
  t663 = t141 * t646;
  t666 = t288 * t175;
  t668 = 0.55e2 / 0.36e2 * t632 * t130 + t636 + t638 + t640 + t642 + t643 + t645 + 0.7e1 / 0.36e2 * t1 * t646 + 0.4e1 / 0.9e1 * t8 * t599 + 0.3e1 / 0.4e1 * t15 * t603 + 0.1e2 / 0.9e1 * t22 * t607 + t30 * t522 / 0.2e1 - t658 + t662 + 0.7e1 / 0.36e2 * t663 * t145 + 0.14e2 / 0.3e1 * t666;
  t669 = t288 * t273;
  t671 = t147 * t599;
  t674 = t291 * t175;
  t676 = t291 * t273;
  t678 = t150 * t603;
  t681 = t294 * t175;
  t683 = t294 * t273;
  t685 = t153 * t607;
  t688 = t297 * t175;
  t690 = t297 * t273;
  t693 = 0.8e1 * t142 * t499;
  t695 = 0.6e1 * t142 * t660;
  t697 = 0.8e1 * t148 * t499;
  t699 = 0.6e1 * t148 * t660;
  t701 = 0.8e1 * t151 * t499;
  t703 = 0.6e1 * t151 * t660;
  t704 = -0.14e2 / 0.3e1 * t669 + 0.4e1 / 0.9e1 * t671 * t145 + 0.16e2 / 0.3e1 * t674 - 0.16e2 / 0.3e1 * t676 + 0.3e1 / 0.4e1 * t678 * t145 + 0.6e1 * t681 - 0.6e1 * t683 + 0.1e2 / 0.9e1 * t685 * t145 + 0.2e2 / 0.3e1 * t688 - 0.2e2 / 0.3e1 * t690 - t693 + t695 - t697 + t699 - t701 + t703;
  tv2rho20 = t587 + t630 + t668 + t704;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t706 = t171 * t317;
  t708 = t179 * t45;
  t709 = t708 * t316;
  t710 = t89 * t709;
  t712 = t495 * t313;
  t715 = t42 * t34;
  t719 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t712 * t176 + 0.8e1 / 0.3e1 * t715 * t272);
  t720 = t174 * t719;
  t721 = t89 * t720;
  t723 = t323 * t188;
  t725 = t187 * t45;
  t726 = t725 * t329;
  t727 = t96 * t726;
  t729 = t510 * t326;
  t732 = t54 * t34;
  t736 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t729 * t184 - 0.8e1 / 0.3e1 * t732 * t272);
  t737 = t183 * t736;
  t738 = t96 * t737;
  t740 = -0.4e1 / 0.3e1 * t706 + t710 / 0.2e1 + t721 / 0.2e1 - 0.4e1 / 0.3e1 * t723 + t727 / 0.2e1 + t738 / 0.2e1 - t584;
  t753 = t719 * t46;
  t758 = t736 * t46;
  t761 = -t233 * t358 / 0.3e1 + t33 * t753 / 0.4e1 - t363 * t239 / 0.3e1 + t51 * t758 / 0.4e1;
  t780 = t136 * t740 + 0.11e2 / 0.6e1 * t224 * t341 + 0.11e2 / 0.6e1 * t351 * t214 + t139 * t740 + 0.2e1 * t228 * t341 + 0.2e1 * t355 * t214 + t30 * t761 / 0.2e1 + 0.2e1 / 0.3e1 * t246 * t369 + 0.2e1 / 0.3e1 * t372 * t242 + t64 * t761 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t369 + 0.3e1 / 0.4e1 * t377 * t242 + t68 * t761 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t369 + 0.5e1 / 0.6e1 * t383 * t242;
  t793 = -0.2e1 / 0.3e1 * t706 + t710 / 0.4e1 + t721 / 0.4e1 - 0.2e1 / 0.3e1 * t723 + t727 / 0.4e1 + t738 / 0.4e1;
  t816 = t81 * t761 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t369 + 0.11e2 / 0.12e2 * t388 * t242 + t85 * t793 / 0.2e1 + 0.3e1 / 0.4e1 * t266 * t333 + 0.3e1 / 0.4e1 * t393 * t191 + t105 * t793 / 0.2e1 + 0.5e1 / 0.6e1 * t194 * t333 + 0.5e1 / 0.6e1 * t398 * t191 + t110 * t793 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t333 + 0.11e2 / 0.12e2 * t310 * t191 + t115 * t793 / 0.2e1 + t204 * t333 + t336 * t191;
  t832 = t119 * t740 + 0.3e1 / 0.2e1 * t216 * t341 + 0.3e1 / 0.2e1 * t343 * t214 + t133 * t740 + 0.5e1 / 0.3e1 * t220 * t341 + 0.5e1 / 0.3e1 * t347 * t214 - t636 - t638 - t640 - t642 + t662 - 0.7e1 / 0.3e1 * t666 - 0.7e1 / 0.3e1 * t669 - 0.8e1 / 0.3e1 * t674 - 0.8e1 / 0.3e1 * t676;
  t837 = t404 * t175;
  t839 = t404 * t273;
  t841 = t407 * t175;
  t843 = t407 * t273;
  t845 = t410 * t175;
  t847 = t410 * t273;
  t849 = t413 * t175;
  t851 = t413 * t273;
  t853 = -0.3e1 * t681 - 0.3e1 * t683 - 0.1e2 / 0.3e1 * t688 - 0.1e2 / 0.3e1 * t690 + t695 + t699 + t703 + 0.7e1 / 0.3e1 * t837 - 0.7e1 / 0.3e1 * t839 + 0.8e1 / 0.3e1 * t841 - 0.8e1 / 0.3e1 * t843 + 0.3e1 * t845 - 0.3e1 * t847 + 0.1e2 / 0.3e1 * t849 - 0.1e2 / 0.3e1 * t851;
  tv2rho21 = t780 + t816 + t832 + t853;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t857 = t316 * t316;
  t858 = t857 * t45;
  t859 = t89 * t858;
  t861 = t313 * t313;
  t865 = 0.2e1 * t144 + 0.2e1 * t499;
  t869 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t495 * t861 + 0.4e1 / 0.3e1 * t42 * t865);
  t870 = t174 * t869;
  t871 = t89 * t870;
  t873 = t93 * t93;
  t875 = 0.1e1 / t25 / t873;
  t876 = sigma[2] * t875;
  t877 = t876 * t98;
  t879 = t323 * t330;
  t881 = t329 * t329;
  t882 = t881 * t45;
  t883 = t96 * t882;
  t885 = t326 * t326;
  t888 = -t865;
  t892 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t510 * t885 + 0.4e1 / 0.3e1 * t54 * t888);
  t893 = t183 * t892;
  t894 = t96 * t893;
  t896 = t859 / 0.2e1 + t871 / 0.2e1 + 0.22e2 / 0.9e1 * t877 - 0.8e1 / 0.3e1 * t879 + t883 / 0.2e1 + t894 / 0.2e1 - t584;
  t900 = 0.1e1 / t4;
  t901 = t135 * t900;
  t904 = 0.1e1 / t25;
  t905 = t29 * t904;
  t908 = 0.1e1 / t18;
  t909 = t63 * t908;
  t912 = 0.1e1 / t11;
  t913 = t67 * t912;
  t916 = t71 * t900;
  t919 = t84 * t908;
  t922 = t104 * t912;
  t925 = t109 * t900;
  t928 = t118 * t908;
  t931 = t132 * t912;
  t934 = t869 * t46;
  t938 = 0.1e1 / t11 / t320;
  t939 = t49 * t938;
  t944 = t892 * t46;
  t947 = t33 * t934 / 0.4e1 + 0.7e1 / 0.9e1 * t939 * t57 - 0.2e1 / 0.3e1 * t363 * t366 + t51 * t944 / 0.4e1;
  t954 = 0.11e2 / 0.3e1 * t351 * t341 + t139 * t896 + 0.4e1 * t355 * t341 + 0.55e2 / 0.36e2 * t901 * t130 + 0.2e1 / 0.9e1 * t905 * t60 + 0.3e1 / 0.8e1 * t909 * t60 + 0.5e1 / 0.9e1 * t913 * t60 + 0.55e2 / 0.72e2 * t916 * t60 + 0.3e1 / 0.8e1 * t919 * t101 + 0.5e1 / 0.9e1 * t922 * t101 + 0.55e2 / 0.72e2 * t925 * t101 + 0.3e1 / 0.4e1 * t928 * t130 + 0.1e2 / 0.9e1 * t931 * t130 + t30 * t947 / 0.2e1 + 0.4e1 / 0.3e1 * t372 * t369 + t64 * t947 / 0.2e1;
  t971 = t859 / 0.4e1 + t871 / 0.4e1 + 0.11e2 / 0.9e1 * t877 - 0.4e1 / 0.3e1 * t879 + t883 / 0.4e1 + t894 / 0.4e1;
  t992 = 0.3e1 / 0.2e1 * t377 * t369 + t68 * t947 / 0.2e1 + 0.5e1 / 0.3e1 * t383 * t369 + t81 * t947 / 0.2e1 + 0.11e2 / 0.6e1 * t388 * t369 + t85 * t971 / 0.2e1 + 0.3e1 / 0.2e1 * t393 * t333 + t105 * t971 / 0.2e1 + 0.5e1 / 0.3e1 * t398 * t333 + t110 * t971 / 0.2e1 + 0.11e2 / 0.6e1 * t310 * t333 + t115 * t971 / 0.2e1 + 0.2e1 * t336 * t333 + t119 * t896 + 0.3e1 * t343 * t341 + t133 * t896;
  t997 = 0.1e1 / t78;
  t1006 = 0.1e2 / 0.3e1 * t347 * t341 + t136 * t896 + t636 + t638 + t640 + t642 + 0.7e1 / 0.36e2 * t1 * t997 + 0.4e1 / 0.9e1 * t8 * t904 + 0.3e1 / 0.4e1 * t15 * t908 + 0.1e2 / 0.9e1 * t22 * t912 + t643 + t645 + t658 + t662 + t693 + t695;
  t1015 = t141 * t997;
  t1018 = t147 * t904;
  t1021 = t150 * t908;
  t1024 = t153 * t912;
  t1027 = t697 + t699 + t701 + t703 - 0.14e2 / 0.3e1 * t837 - 0.14e2 / 0.3e1 * t839 - 0.16e2 / 0.3e1 * t841 - 0.16e2 / 0.3e1 * t843 - 0.6e1 * t845 - 0.6e1 * t847 - 0.2e2 / 0.3e1 * t849 - 0.2e2 / 0.3e1 * t851 + 0.7e1 / 0.36e2 * t1015 * t145 + 0.4e1 / 0.9e1 * t1018 * t145 + 0.3e1 / 0.4e1 * t1021 * t145 + 0.1e2 / 0.9e1 * t1024 * t145;
  tv2rho22 = t954 + t992 + t1006 + t1027;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1030 = t170 * t90 * t45;
  t1032 = t88 * t44;
  t1035 = 0.8e1 / 0.3e1 * t211;
  t1036 = -0.2e1 / 0.3e1 * t1030 + t1032 * t708 / 0.2e1 + t1035;
  t1050 = t29 / rho[0];
  t1052 = t418 * t44 * t46;
  t1055 = t63 * t646;
  t1058 = t67 * t599;
  t1061 = t71 * t603;
  t1072 = t119 * t1036 + 0.3e1 / 0.2e1 * t216 * t444 + t133 * t1036 + 0.5e1 / 0.3e1 * t220 * t444 + t136 * t1036 + 0.11e2 / 0.6e1 * t224 * t444 + t139 * t1036 + 0.2e1 * t228 * t444 + t1050 * t1052 / 0.12e2 + 0.3e1 / 0.32e2 * t1055 * t1052 + 0.5e1 / 0.48e2 * t1058 * t1052 + 0.11e2 / 0.96e2 * t1061 * t1052 - t110 * t1030 / 0.6e1 - t115 * t1030 / 0.6e1 - t85 * t1030 / 0.6e1 - t105 * t1030 / 0.6e1;
  t1074 = 0.1e1 / t2 / t86;
  t1075 = t84 * t1074;
  t1078 = 0.1e1 / t86;
  t1079 = t104 * t1078;
  t1082 = 0.1e1 / t75;
  t1083 = t109 * t1082;
  t1086 = 0.1e1 / t24;
  t1087 = t113 * t1086;
  t1090 = t110 * t88;
  t1093 = t115 * t88;
  t1097 = t32 * t179 * t46;
  t1106 = t85 * t88;
  t1109 = t105 * t88;
  t1113 = t232 * t44 * t46;
  t1122 = 0.3e1 / 0.32e2 * t1075 * t91 + 0.5e1 / 0.48e2 * t1079 * t91 + 0.11e2 / 0.96e2 * t1083 * t91 + t1087 * t91 / 0.8e1 + t1090 * t180 / 0.8e1 + t1093 * t180 / 0.8e1 + t419 * t1097 / 0.16e2 + t424 * t1097 / 0.16e2 + t427 * t1097 / 0.16e2 + t430 * t1097 / 0.16e2 + t1106 * t180 / 0.8e1 + t1109 * t180 / 0.8e1 - t424 * t1113 / 0.12e2 - t427 * t1113 / 0.12e2 - t430 * t1113 / 0.12e2 - t419 * t1113 / 0.12e2;
  tv2rhosigma0 = t1072 + t1122;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1126 = 0.16e2 / 0.3e1 * t119 * t211;
  t1130 = 0.16e2 / 0.3e1 * t133 * t211;
  t1134 = 0.16e2 / 0.3e1 * t136 * t211;
  t1138 = 0.16e2 / 0.3e1 * t139 * t211;
  tv2rhosigma1 = -0.3e1 * t216 * t128 + t1126 - 0.1e2 / 0.3e1 * t220 * t128 + t1130 - 0.11e2 / 0.3e1 * t224 * t128 + t1134 - 0.4e1 * t228 * t128 + t1138;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1139 = t246 * t454;
  t1143 = t50 * t187 * t46;
  t1146 = t251 * t454;
  t1151 = t256 * t454;
  t1156 = t261 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t266 * t470 + t1163 * t188 / 0.8e1 + 0.5e1 / 0.48e2 * t194 * t470 + t1168 * t188 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t725 / 0.2e1 + t1035;
  t1198 = 0.11e2 / 0.96e2 * t199 * t470 + t1174 * t188 / 0.8e1 + t204 * t470 / 0.8e1 + t1179 * t188 / 0.8e1 + 0.3e1 / 0.2e1 * t216 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t220 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t224 * t480 + t136 * t1187 + 0.2e1 * t228 * t480 + t139 * t1187;
  tv2rhosigma2 = t1171 + t1198;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1199 = t372 * t418;
  t1203 = t32 * t316 * t46;
  t1206 = t377 * t418;
  t1211 = t383 * t418;
  t1216 = t388 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t393 * t434 + t1106 * t317 / 0.8e1 + 0.5e1 / 0.48e2 * t398 * t434 + t1109 * t317 / 0.8e1;
  t1240 = t45 * t316;
  t1243 = t1032 * t1240 / 0.2e1 + t1035;
  t1254 = 0.11e2 / 0.96e2 * t310 * t434 + t1090 * t317 / 0.8e1 + t336 * t434 / 0.8e1 + t1093 * t317 / 0.8e1 + 0.3e1 / 0.2e1 * t343 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t347 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t351 * t444 + t136 * t1243 + 0.2e1 * t355 * t444 + t139 * t1243;
  tv2rhosigma3 = t1229 + t1254;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.3e1 * t343 * t128 + t1126 - 0.1e2 / 0.3e1 * t347 * t128 + t1130 - 0.11e2 / 0.3e1 * t351 * t128 + t1134 - 0.4e1 * t355 * t128 + t1138;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1264 = t322 * t97 * t45;
  t1266 = t45 * t329;
  t1269 = -0.2e1 / 0.3e1 * t1264 + t1184 * t1266 / 0.2e1 + t1035;
  t1283 = t29 / rho[1];
  t1285 = t454 * t56 * t46;
  t1288 = t63 * t997;
  t1291 = t67 * t904;
  t1294 = t71 * t908;
  t1305 = t119 * t1269 + 0.3e1 / 0.2e1 * t343 * t480 + t133 * t1269 + 0.5e1 / 0.3e1 * t347 * t480 + t136 * t1269 + 0.11e2 / 0.6e1 * t351 * t480 + t139 * t1269 + 0.2e1 * t355 * t480 + t1283 * t1285 / 0.12e2 + 0.3e1 / 0.32e2 * t1288 * t1285 + 0.5e1 / 0.48e2 * t1291 * t1285 + 0.11e2 / 0.96e2 * t1294 * t1285 - t105 * t1264 / 0.6e1 - t110 * t1264 / 0.6e1 - t115 * t1264 / 0.6e1 - t85 * t1264 / 0.6e1;
  t1307 = 0.1e1 / t4 / t93;
  t1308 = t84 * t1307;
  t1311 = 0.1e1 / t93;
  t1312 = t104 * t1311;
  t1315 = 0.1e1 / t79;
  t1316 = t109 * t1315;
  t1319 = 0.1e1 / t26;
  t1320 = t113 * t1319;
  t1330 = t50 * t329 * t46;
  t1342 = t362 * t56 * t46;
  t1351 = 0.3e1 / 0.32e2 * t1308 * t98 + 0.5e1 / 0.48e2 * t1312 * t98 + 0.11e2 / 0.96e2 * t1316 * t98 + t1320 * t98 / 0.8e1 + t1168 * t330 / 0.8e1 + t1174 * t330 / 0.8e1 + t1179 * t330 / 0.8e1 + t455 * t1330 / 0.16e2 + t460 * t1330 / 0.16e2 + t463 * t1330 / 0.16e2 + t466 * t1330 / 0.16e2 + t1163 * t330 / 0.8e1 - t455 * t1342 / 0.12e2 - t460 * t1342 / 0.12e2 - t463 * t1342 / 0.12e2 - t466 * t1342 / 0.12e2;
  tv2rhosigma5 = t1305 + t1351;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  tv2sigma20 = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  tv2sigma25 = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t168, t170, t171, t172, t174, t175, t176, t179;
  double t180, t181, t183, t184, t187, t188, t189, t191;
  double t194, t199, t204, t209, t211, t213, t214, t216;
  double t220, t224, t228, t232, t233, t236, t239, t242;
  double t245, t246, t251, t256, t261, t266, t270, t272;
  double t273, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t316, t317, t318, t320, t322, t323, t324, t326;
  double t329, t330, t331, t333, t336, t341, t343, t347;
  double t351, t355, t358, t362, t363, t366, t369, t372;
  double t377, t380, t383, t388, t393, t398, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  double t488, t489, t494, t495, t496, t499, t501, t505;
  double t506, t509, t510, t511, t514, t518, t519, t522;
  double t535, t537, t538, t539, t541, t543, t544, t545;
  double t547, t548, t550, t551, t552, t554, t555, t557;
  double t580, t582, t584, t585, t587, t599, t600, t603;
  double t604, t607, t608, t611, t612, t615, t618, t621;
  double t624, t627, t630, t632, t636, t638, t640, t642;
  double t643, t645, t646, t658, t659, t660, t662, t663;
  double t666, t668, t669, t671, t674, t676, t678, t681;
  double t683, t685, t688, t690, t693, t695, t697, t699;
  double t701, t703, t704, tv2rho20, t706, t708, t709, t710;
  double t712, t715, t719, t720, t721, t723, t725, t726;
  double t727, t729, t732, t736, t737, t738, t740, t753;
  double t758, t761, t780, t793, t816, t832, t837, t839;
  double t841, t843, t845, t847, t849, t851, t853, tv2rho21;
  double t857, t858, t859, t861, t865, t869, t870, t871;
  double t873, t875, t876, t877, t879, t881, t882, t883;
  double t885, t888, t892, t893, t894, t896, t900, t901;
  double t904, t905, t908, t909, t912, t913, t916, t919;
  double t922, t925, t928, t931, t934, t938, t939, t944;
  double t947, t954, t971, t992, t997, t1006, t1015, t1018;
  double t1021, t1024, t1027, tv2rho22, t1030, t1032, t1035, t1036;
  double t1050, t1052, t1055, t1058, t1061, t1072, t1074, t1075;
  double t1078, t1079, t1082, t1083, t1086, t1087, t1090, t1093;
  double t1097, t1106, t1109, t1113, t1122, tv2rhosigma0, t1126, t1130;
  double t1134, t1138, tv2rhosigma1, t1139, t1143, t1146, t1151, t1156;
  double t1163, t1168, t1171, t1174, t1179, t1184, t1187, t1198;
  double tv2rhosigma2, t1199, t1203, t1206, t1211, t1216, t1229, t1240;
  double t1243, t1254, tv2rhosigma3, tv2rhosigma4, t1264, t1266, t1269, t1283;
  double t1285, t1288, t1291, t1294, t1305, t1307, t1308, t1311;
  double t1312, t1315, t1316, t1319, t1320, t1330, t1342, t1351;
  double tv2rhosigma5, t1353, t1354, t1356, t1358, t1360, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1364, t1365, t1367, t1369, t1371;
  double tv2sigma25;

  double t1374, t1376, t1377, t1378, t1380, t1382, t1384, t1386;
  double t1387, t1390, t1391, t1394, t1397, t1399, t1403, t1404;
  double t1405, t1407, t1408, t1411, t1412, t1415, t1418, t1422;
  double t1423, t1424, t1426, t1447, t1449, t1451, t1452, t1466;
  double t1468, t1470, t1472, t1480, t1496, t1499, t1500, t1503;
  double t1506, t1507, t1510, t1511, t1514, t1517, t1520, t1523;
  double t1526, t1529, t1530, t1531, t1532, t1534, t1535, t1541;
  double t1544, t1547, t1554, t1571, t1572, t1573, t1574, t1584;
  double t1586, t1588, t1589, t1591, t1592, t1594, t1596, t1599;
  double t1601, t1603, t1605, t1607, t1609, t1612, t1614, t1616;
  double t1618, t1620, t1623, t1625, t1627, t1629, t1630, t1632;
  double t1633, t1635, t1636, t1637, t1639, t1640, t1641, t1643;
  double t1644, t1645, t1646, t1649, t1651, t1653, tv3rho30, t1658;
  double t1660, t1662, t1664, t1665, t1666, t1668, t1669, t1670;
  double t1673, t1684, t1685, t1686, t1688, t1690, t1692, t1693;
  double t1694, t1696, t1697, t1698, t1701, t1712, t1713, t1714;
  double t1716, t1726, t1731, t1734, t1749, t1771, t1784, t1805;
  double t1815, t1823, t1840, t1842, t1844, t1846, t1847, t1848;
  double t1849, t1850, t1851, t1852, t1859, t1866, t1867, t1868;
  double t1869, t1870, t1873, t1875, t1877, t1879, t1881, t1883;
  double t1885, t1887, t1889, tv3rho31, t1894, t1896, t1897, t1898;
  double t1900, t1901, t1903, t1908, t1913, t1917, t1918, t1919;
  double t1921, t1923, t1925, t1927, t1928, t1929, t1930, t1932;
  double t1937, t1940, t1944, t1945, t1946, t1948, t1967, t1974;
  double t1981, t1984, t2003, t2022, t2039, t2060, t2074, t2081;
  double t2087, t2091, t2093, t2095, t2097, t2099, t2101, t2103;
  double t2105, t2107, tv3rho32, t2112, t2113, t2116, t2119, t2120;
  double t2123, t2141, t2142, t2144, t2150, t2154, t2155, t2156;
  double t2158, t2160, t2161, t2162, t2164, t2166, t2168, t2170;
  double t2171, t2173, t2178, t2182, t2183, t2184, t2186, t2207;
  double t2212, t2222, t2226, t2227, t2233, t2236, t2249, t2258;
  double t2261, t2264, t2267, t2270, t2273, t2278, t2290, t2293;
  double t2296, t2299, t2302, t2313, t2329, tv3rho33, t2333, t2335;
  double t2339, t2343, t2344, t2369, t2372, t2375, t2378, t2381;
  double t2393, t2404, t2413, t2414, t2417, t2418, t2422, t2425;
  double t2426, t2430, t2432, t2441, t2446, t2447, t2452, t2457;
  double t2463, t2467, t2482, tv3rho2sigma0, t2486, t2489, t2492, t2495;
  double t2498, t2501, t2503, t2504, t2507, tv3rho2sigma1, t2517, t2521;
  double t2546, t2547, t2550, t2551, t2554, t2559, t2564, t2572;
  double t2587, t2590, t2593, t2596, t2599, t2602, tv3rho2sigma2, t2607;
  double t2610, t2613, t2636, t2642, t2662, t2669, t2673, t2683;
  double t2698, t2703, t2722, t2729, t2734, tv3rho2sigma3, t2736, t2739;
  double t2742, t2745, tv3rho2sigma4, t2750, t2753, t2756, t2759, t2779;
  double t2784, t2805, t2814, t2816, t2826, t2847, t2850, t2860;
  double t2877, t2880, tv3rho2sigma5, t2883, t2885, t2888, t2921, t2924;
  double t2927, t2928, t2948, t2965, t2969, tv3rho2sigma6, tv3rho2sigma7, t2981;
  double t2986, t2988, t2991, t3016, t3021, t3024, t3027, t3030;
  double t3038, t3051, t3060, t3064, t3085, t3093, t3107, t3108;
  double t3112, t3113, t3118, t3121, tv3rho2sigma8, t3124, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t3149, t3154, t3159, t3164, tv3rhosigma25;
  double t3169, t3174, t3179, t3184, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t3190, tv3rhosigma211, t3215, t3217, t3218, t3220, t3222;
  double t3224, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t3227, t3229, t3230, t3232, t3234, t3236;
  double tv3sigma39;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t168 = t86 * rho[0];
  t170 = 0.1e1 / t23 / t168;
  t171 = sigma[0] * t170;
  t172 = t171 * t91;
  t174 = t44 * t45;
  t175 = t34 * t144;
  t176 = t36 - t175;
  t179 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t176);
  t180 = t174 * t179;
  t181 = t89 * t180;
  t183 = t56 * t45;
  t184 = -t176;
  t187 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t184);
  t188 = t183 * t187;
  t189 = t96 * t188;
  t191 = -t172 / 0.3e1 + t181 / 0.4e1 + t189 / 0.4e1;
  t194 = t104 * t23;
  t199 = t109 * t74;
  t204 = t113 * rho[0];
  t209 = t124 * t35;
  t211 = 0.1e1 / t126 / t209;
  t213 = 0.8e1 / 0.3e1 * t123 * t211;
  t214 = -0.2e1 / 0.3e1 * t172 + t181 / 0.2e1 + t189 / 0.2e1 + t213;
  t216 = t118 * t16;
  t220 = t132 * t23;
  t224 = t135 * t74;
  t228 = t138 * rho[0];
  t232 = 0.1e1 / t9 / t86;
  t233 = t31 * t232;
  t236 = t179 * t46;
  t239 = t187 * t46;
  t242 = -t233 * t47 / 0.3e1 + t33 * t236 / 0.4e1 + t51 * t239 / 0.4e1;
  t245 = t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + t105 * t191 / 0.2e1 + 0.5e1 / 0.6e1 * t194 * t101 + t110 * t191 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t101 + t115 * t191 / 0.2e1 + t204 * t101 + t119 * t214 + 0.3e1 / 0.2e1 * t216 * t130 + t133 * t214 + 0.5e1 / 0.3e1 * t220 * t130 + t136 * t214 + 0.11e2 / 0.6e1 * t224 * t130 + t139 * t214 + 0.2e1 * t228 * t130 + t30 * t242 / 0.2e1;
  t246 = t29 * t9;
  t251 = t63 * t16;
  t256 = t67 * t23;
  t261 = t71 * t74;
  t266 = t84 * t16;
  t270 = 0.2e1 * t142 * t175;
  t272 = 0.1e1 / t209;
  t273 = t143 * t272;
  t275 = 0.2e1 * t142 * t273;
  t277 = 0.2e1 * t148 * t175;
  t279 = 0.2e1 * t148 * t273;
  t281 = 0.2e1 * t151 * t175;
  t283 = 0.2e1 * t151 * t273;
  t285 = 0.2e1 * t154 * t175;
  t287 = 0.2e1 * t154 * t273;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = -t275 + t277 - t279 + t281 - t283 + t285 - t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t245 + 0.2e1 / 0.3e1 * t246 * t60 + t64 * t242 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t60 + t68 * t242 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t60 + t81 * t242 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t60 + t85 * t191 / 0.2e1 + 0.3e1 / 0.4e1 * t266 * t101 + t270 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t310 = t109 * t78;
  t313 = -t36 - t175;
  t316 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t313);
  t317 = t174 * t316;
  t318 = t89 * t317;
  t320 = t93 * rho[1];
  t322 = 0.1e1 / t25 / t320;
  t323 = sigma[2] * t322;
  t324 = t323 * t98;
  t326 = -t313;
  t329 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t326);
  t330 = t183 * t329;
  t331 = t96 * t330;
  t333 = t318 / 0.4e1 - t324 / 0.3e1 + t331 / 0.4e1;
  t336 = t113 * rho[1];
  t341 = t318 / 0.2e1 - 0.2e1 / 0.3e1 * t324 + t331 / 0.2e1 + t213;
  t343 = t118 * t18;
  t347 = t132 * t25;
  t351 = t135 * t78;
  t355 = t138 * rho[1];
  t358 = t316 * t46;
  t362 = 0.1e1 / t11 / t93;
  t363 = t49 * t362;
  t366 = t329 * t46;
  t369 = t33 * t358 / 0.4e1 - t363 * t57 / 0.3e1 + t51 * t366 / 0.4e1;
  t372 = t29 * t11;
  t377 = t63 * t18;
  t380 = t156 + 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + 0.11e2 / 0.12e2 * t310 * t101 + t115 * t333 / 0.2e1 + t336 * t101 + t119 * t341 + 0.3e1 / 0.2e1 * t343 * t130 + t133 * t341 + 0.5e1 / 0.3e1 * t347 * t130 + t136 * t341 + 0.11e2 / 0.6e1 * t351 * t130 + t139 * t341 + 0.2e1 * t355 * t130 + t30 * t369 / 0.2e1 + 0.2e1 / 0.3e1 * t372 * t60 + t64 * t369 / 0.2e1 + 0.3e1 / 0.4e1 * t377 * t60;
  t383 = t67 * t25;
  t388 = t71 * t78;
  t393 = t84 * t18;
  t398 = t104 * t25;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = -t275 - t277 - t279 - t281 - t283 - t285 - t287 + 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145;
  tvrho1 = t380 + t68 * t369 / 0.2e1 + 0.5e1 / 0.6e1 * t383 * t60 + t81 * t369 / 0.2e1 + 0.11e2 / 0.12e2 * t388 * t60 + t85 * t333 / 0.2e1 + 0.3e1 / 0.4e1 * t393 * t101 + t105 * t333 / 0.2e1 + 0.5e1 / 0.6e1 * t398 * t101 + t110 * t333 / 0.2e1 - t270 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t128 * t133 - 0.2e1 * t128 * t136 - 0.2e1 * t128 * t139;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t488 = 0.1e1 / t9 / t168;
  t489 = t31 * t488;
  t494 = t42 * t42;
  t495 = 0.1e1 / t494;
  t496 = t176 * t176;
  t499 = t34 * t272;
  t501 = -0.2e1 * t144 + 0.2e1 * t499;
  t505 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t495 * t496 + 0.4e1 / 0.3e1 * t42 * t501);
  t506 = t505 * t46;
  t509 = t54 * t54;
  t510 = 0.1e1 / t509;
  t511 = t184 * t184;
  t514 = -t501;
  t518 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t510 * t511 + 0.4e1 / 0.3e1 * t54 * t514);
  t519 = t518 * t46;
  t522 = 0.7e1 / 0.9e1 * t489 * t47 - 0.2e1 / 0.3e1 * t233 * t236 + t33 * t506 / 0.4e1 + t51 * t519 / 0.4e1;
  t535 = t86 * t86;
  t537 = 0.1e1 / t23 / t535;
  t538 = sigma[0] * t537;
  t539 = t538 * t91;
  t541 = t171 * t180;
  t543 = t179 * t179;
  t544 = t543 * t45;
  t545 = t89 * t544;
  t547 = t174 * t505;
  t548 = t89 * t547;
  t550 = t187 * t187;
  t551 = t550 * t45;
  t552 = t96 * t551;
  t554 = t183 * t518;
  t555 = t96 * t554;
  t557 = 0.11e2 / 0.9e1 * t539 - 0.4e1 / 0.3e1 * t541 + t545 / 0.4e1 + t548 / 0.4e1 + t552 / 0.4e1 + t555 / 0.4e1;
  t580 = t124 * t124;
  t582 = 0.1e1 / t126 / t580;
  t584 = 0.88e2 / 0.9e1 * t123 * t582;
  t585 = 0.22e2 / 0.9e1 * t539 - 0.8e1 / 0.3e1 * t541 + t545 / 0.2e1 + t548 / 0.2e1 + t552 / 0.2e1 + t555 / 0.2e1 - t584;
  t587 = 0.4e1 / 0.3e1 * t246 * t242 + t64 * t522 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t242 + t68 * t522 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t242 + t81 * t522 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t242 + t85 * t557 / 0.2e1 + 0.3e1 / 0.2e1 * t266 * t191 + t105 * t557 / 0.2e1 + 0.5e1 / 0.3e1 * t194 * t191 + t110 * t557 / 0.2e1 + 0.11e2 / 0.6e1 * t199 * t191 + t115 * t557 / 0.2e1 + 0.2e1 * t204 * t191 + t119 * t585;
  t599 = 0.1e1 / t23;
  t600 = t29 * t599;
  t603 = 0.1e1 / t16;
  t604 = t63 * t603;
  t607 = 0.1e1 / t9;
  t608 = t67 * t607;
  t611 = 0.1e1 / t2;
  t612 = t71 * t611;
  t615 = t84 * t603;
  t618 = t104 * t607;
  t621 = t109 * t611;
  t624 = t118 * t603;
  t627 = t132 * t607;
  t630 = 0.3e1 * t216 * t214 + t133 * t585 + 0.1e2 / 0.3e1 * t220 * t214 + t136 * t585 + 0.11e2 / 0.3e1 * t224 * t214 + t139 * t585 + 0.4e1 * t228 * t214 + 0.2e1 / 0.9e1 * t600 * t60 + 0.3e1 / 0.8e1 * t604 * t60 + 0.5e1 / 0.9e1 * t608 * t60 + 0.55e2 / 0.72e2 * t612 * t60 + 0.3e1 / 0.8e1 * t615 * t101 + 0.5e1 / 0.9e1 * t618 * t101 + 0.55e2 / 0.72e2 * t621 * t101 + 0.3e1 / 0.4e1 * t624 * t130 + 0.1e2 / 0.9e1 * t627 * t130;
  t632 = t135 * t611;
  t636 = 0.2e1 * t142 * t144;
  t638 = 0.2e1 * t148 * t144;
  t640 = 0.2e1 * t151 * t144;
  t642 = 0.2e1 * t154 * t144;
  t643 = t113 * t101;
  t645 = 0.2e1 * t138 * t130;
  t646 = 0.1e1 / t74;
  t658 = 0.8e1 * t154 * t499;
  t659 = 0.1e1 / t580;
  t660 = t143 * t659;
  t662 = 0.6e1 * t154 * t660;
  t663 = t141 * t646;
  t666 = t288 * t175;
  t668 = 0.55e2 / 0.36e2 * t632 * t130 + t636 + t638 + t640 + t642 + t643 + t645 + 0.7e1 / 0.36e2 * t1 * t646 + 0.4e1 / 0.9e1 * t8 * t599 + 0.3e1 / 0.4e1 * t15 * t603 + 0.1e2 / 0.9e1 * t22 * t607 + t30 * t522 / 0.2e1 - t658 + t662 + 0.7e1 / 0.36e2 * t663 * t145 + 0.14e2 / 0.3e1 * t666;
  t669 = t288 * t273;
  t671 = t147 * t599;
  t674 = t291 * t175;
  t676 = t291 * t273;
  t678 = t150 * t603;
  t681 = t294 * t175;
  t683 = t294 * t273;
  t685 = t153 * t607;
  t688 = t297 * t175;
  t690 = t297 * t273;
  t693 = 0.8e1 * t142 * t499;
  t695 = 0.6e1 * t142 * t660;
  t697 = 0.8e1 * t148 * t499;
  t699 = 0.6e1 * t148 * t660;
  t701 = 0.8e1 * t151 * t499;
  t703 = 0.6e1 * t151 * t660;
  t704 = -0.14e2 / 0.3e1 * t669 + 0.4e1 / 0.9e1 * t671 * t145 + 0.16e2 / 0.3e1 * t674 - 0.16e2 / 0.3e1 * t676 + 0.3e1 / 0.4e1 * t678 * t145 + 0.6e1 * t681 - 0.6e1 * t683 + 0.1e2 / 0.9e1 * t685 * t145 + 0.2e2 / 0.3e1 * t688 - 0.2e2 / 0.3e1 * t690 - t693 + t695 - t697 + t699 - t701 + t703;
  tv2rho20 = t587 + t630 + t668 + t704;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t706 = t171 * t317;
  t708 = t179 * t45;
  t709 = t708 * t316;
  t710 = t89 * t709;
  t712 = t495 * t313;
  t715 = t42 * t34;
  t719 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t712 * t176 + 0.8e1 / 0.3e1 * t715 * t272);
  t720 = t174 * t719;
  t721 = t89 * t720;
  t723 = t323 * t188;
  t725 = t187 * t45;
  t726 = t725 * t329;
  t727 = t96 * t726;
  t729 = t510 * t326;
  t732 = t54 * t34;
  t736 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t729 * t184 - 0.8e1 / 0.3e1 * t732 * t272);
  t737 = t183 * t736;
  t738 = t96 * t737;
  t740 = -0.4e1 / 0.3e1 * t706 + t710 / 0.2e1 + t721 / 0.2e1 - 0.4e1 / 0.3e1 * t723 + t727 / 0.2e1 + t738 / 0.2e1 - t584;
  t753 = t719 * t46;
  t758 = t736 * t46;
  t761 = -t233 * t358 / 0.3e1 + t33 * t753 / 0.4e1 - t363 * t239 / 0.3e1 + t51 * t758 / 0.4e1;
  t780 = t136 * t740 + 0.11e2 / 0.6e1 * t224 * t341 + 0.11e2 / 0.6e1 * t351 * t214 + t139 * t740 + 0.2e1 * t228 * t341 + 0.2e1 * t355 * t214 + t30 * t761 / 0.2e1 + 0.2e1 / 0.3e1 * t246 * t369 + 0.2e1 / 0.3e1 * t372 * t242 + t64 * t761 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t369 + 0.3e1 / 0.4e1 * t377 * t242 + t68 * t761 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t369 + 0.5e1 / 0.6e1 * t383 * t242;
  t793 = -0.2e1 / 0.3e1 * t706 + t710 / 0.4e1 + t721 / 0.4e1 - 0.2e1 / 0.3e1 * t723 + t727 / 0.4e1 + t738 / 0.4e1;
  t816 = t81 * t761 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t369 + 0.11e2 / 0.12e2 * t388 * t242 + t85 * t793 / 0.2e1 + 0.3e1 / 0.4e1 * t266 * t333 + 0.3e1 / 0.4e1 * t393 * t191 + t105 * t793 / 0.2e1 + 0.5e1 / 0.6e1 * t194 * t333 + 0.5e1 / 0.6e1 * t398 * t191 + t110 * t793 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t333 + 0.11e2 / 0.12e2 * t310 * t191 + t115 * t793 / 0.2e1 + t204 * t333 + t336 * t191;
  t832 = t119 * t740 + 0.3e1 / 0.2e1 * t216 * t341 + 0.3e1 / 0.2e1 * t343 * t214 + t133 * t740 + 0.5e1 / 0.3e1 * t220 * t341 + 0.5e1 / 0.3e1 * t347 * t214 - t636 - t638 - t640 - t642 + t662 - 0.7e1 / 0.3e1 * t666 - 0.7e1 / 0.3e1 * t669 - 0.8e1 / 0.3e1 * t674 - 0.8e1 / 0.3e1 * t676;
  t837 = t404 * t175;
  t839 = t404 * t273;
  t841 = t407 * t175;
  t843 = t407 * t273;
  t845 = t410 * t175;
  t847 = t410 * t273;
  t849 = t413 * t175;
  t851 = t413 * t273;
  t853 = -0.3e1 * t681 - 0.3e1 * t683 - 0.1e2 / 0.3e1 * t688 - 0.1e2 / 0.3e1 * t690 + t695 + t699 + t703 + 0.7e1 / 0.3e1 * t837 - 0.7e1 / 0.3e1 * t839 + 0.8e1 / 0.3e1 * t841 - 0.8e1 / 0.3e1 * t843 + 0.3e1 * t845 - 0.3e1 * t847 + 0.1e2 / 0.3e1 * t849 - 0.1e2 / 0.3e1 * t851;
  tv2rho21 = t780 + t816 + t832 + t853;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t857 = t316 * t316;
  t858 = t857 * t45;
  t859 = t89 * t858;
  t861 = t313 * t313;
  t865 = 0.2e1 * t144 + 0.2e1 * t499;
  t869 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t495 * t861 + 0.4e1 / 0.3e1 * t42 * t865);
  t870 = t174 * t869;
  t871 = t89 * t870;
  t873 = t93 * t93;
  t875 = 0.1e1 / t25 / t873;
  t876 = sigma[2] * t875;
  t877 = t876 * t98;
  t879 = t323 * t330;
  t881 = t329 * t329;
  t882 = t881 * t45;
  t883 = t96 * t882;
  t885 = t326 * t326;
  t888 = -t865;
  t892 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t510 * t885 + 0.4e1 / 0.3e1 * t54 * t888);
  t893 = t183 * t892;
  t894 = t96 * t893;
  t896 = t859 / 0.2e1 + t871 / 0.2e1 + 0.22e2 / 0.9e1 * t877 - 0.8e1 / 0.3e1 * t879 + t883 / 0.2e1 + t894 / 0.2e1 - t584;
  t900 = 0.1e1 / t4;
  t901 = t135 * t900;
  t904 = 0.1e1 / t25;
  t905 = t29 * t904;
  t908 = 0.1e1 / t18;
  t909 = t63 * t908;
  t912 = 0.1e1 / t11;
  t913 = t67 * t912;
  t916 = t71 * t900;
  t919 = t84 * t908;
  t922 = t104 * t912;
  t925 = t109 * t900;
  t928 = t118 * t908;
  t931 = t132 * t912;
  t934 = t869 * t46;
  t938 = 0.1e1 / t11 / t320;
  t939 = t49 * t938;
  t944 = t892 * t46;
  t947 = t33 * t934 / 0.4e1 + 0.7e1 / 0.9e1 * t939 * t57 - 0.2e1 / 0.3e1 * t363 * t366 + t51 * t944 / 0.4e1;
  t954 = 0.11e2 / 0.3e1 * t351 * t341 + t139 * t896 + 0.4e1 * t355 * t341 + 0.55e2 / 0.36e2 * t901 * t130 + 0.2e1 / 0.9e1 * t905 * t60 + 0.3e1 / 0.8e1 * t909 * t60 + 0.5e1 / 0.9e1 * t913 * t60 + 0.55e2 / 0.72e2 * t916 * t60 + 0.3e1 / 0.8e1 * t919 * t101 + 0.5e1 / 0.9e1 * t922 * t101 + 0.55e2 / 0.72e2 * t925 * t101 + 0.3e1 / 0.4e1 * t928 * t130 + 0.1e2 / 0.9e1 * t931 * t130 + t30 * t947 / 0.2e1 + 0.4e1 / 0.3e1 * t372 * t369 + t64 * t947 / 0.2e1;
  t971 = t859 / 0.4e1 + t871 / 0.4e1 + 0.11e2 / 0.9e1 * t877 - 0.4e1 / 0.3e1 * t879 + t883 / 0.4e1 + t894 / 0.4e1;
  t992 = 0.3e1 / 0.2e1 * t377 * t369 + t68 * t947 / 0.2e1 + 0.5e1 / 0.3e1 * t383 * t369 + t81 * t947 / 0.2e1 + 0.11e2 / 0.6e1 * t388 * t369 + t85 * t971 / 0.2e1 + 0.3e1 / 0.2e1 * t393 * t333 + t105 * t971 / 0.2e1 + 0.5e1 / 0.3e1 * t398 * t333 + t110 * t971 / 0.2e1 + 0.11e2 / 0.6e1 * t310 * t333 + t115 * t971 / 0.2e1 + 0.2e1 * t336 * t333 + t119 * t896 + 0.3e1 * t343 * t341 + t133 * t896;
  t997 = 0.1e1 / t78;
  t1006 = 0.1e2 / 0.3e1 * t347 * t341 + t136 * t896 + t636 + t638 + t640 + t642 + 0.7e1 / 0.36e2 * t1 * t997 + 0.4e1 / 0.9e1 * t8 * t904 + 0.3e1 / 0.4e1 * t15 * t908 + 0.1e2 / 0.9e1 * t22 * t912 + t643 + t645 + t658 + t662 + t693 + t695;
  t1015 = t141 * t997;
  t1018 = t147 * t904;
  t1021 = t150 * t908;
  t1024 = t153 * t912;
  t1027 = t697 + t699 + t701 + t703 - 0.14e2 / 0.3e1 * t837 - 0.14e2 / 0.3e1 * t839 - 0.16e2 / 0.3e1 * t841 - 0.16e2 / 0.3e1 * t843 - 0.6e1 * t845 - 0.6e1 * t847 - 0.2e2 / 0.3e1 * t849 - 0.2e2 / 0.3e1 * t851 + 0.7e1 / 0.36e2 * t1015 * t145 + 0.4e1 / 0.9e1 * t1018 * t145 + 0.3e1 / 0.4e1 * t1021 * t145 + 0.1e2 / 0.9e1 * t1024 * t145;
  tv2rho22 = t954 + t992 + t1006 + t1027;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1030 = t170 * t90 * t45;
  t1032 = t88 * t44;
  t1035 = 0.8e1 / 0.3e1 * t211;
  t1036 = -0.2e1 / 0.3e1 * t1030 + t1032 * t708 / 0.2e1 + t1035;
  t1050 = t29 / rho[0];
  t1052 = t418 * t44 * t46;
  t1055 = t63 * t646;
  t1058 = t67 * t599;
  t1061 = t71 * t603;
  t1072 = t119 * t1036 + 0.3e1 / 0.2e1 * t216 * t444 + t133 * t1036 + 0.5e1 / 0.3e1 * t220 * t444 + t136 * t1036 + 0.11e2 / 0.6e1 * t224 * t444 + t139 * t1036 + 0.2e1 * t228 * t444 + t1050 * t1052 / 0.12e2 + 0.3e1 / 0.32e2 * t1055 * t1052 + 0.5e1 / 0.48e2 * t1058 * t1052 + 0.11e2 / 0.96e2 * t1061 * t1052 - t110 * t1030 / 0.6e1 - t115 * t1030 / 0.6e1 - t85 * t1030 / 0.6e1 - t105 * t1030 / 0.6e1;
  t1074 = 0.1e1 / t2 / t86;
  t1075 = t84 * t1074;
  t1078 = 0.1e1 / t86;
  t1079 = t104 * t1078;
  t1082 = 0.1e1 / t75;
  t1083 = t109 * t1082;
  t1086 = 0.1e1 / t24;
  t1087 = t113 * t1086;
  t1090 = t110 * t88;
  t1093 = t115 * t88;
  t1097 = t32 * t179 * t46;
  t1106 = t85 * t88;
  t1109 = t105 * t88;
  t1113 = t232 * t44 * t46;
  t1122 = 0.3e1 / 0.32e2 * t1075 * t91 + 0.5e1 / 0.48e2 * t1079 * t91 + 0.11e2 / 0.96e2 * t1083 * t91 + t1087 * t91 / 0.8e1 + t1090 * t180 / 0.8e1 + t1093 * t180 / 0.8e1 + t419 * t1097 / 0.16e2 + t424 * t1097 / 0.16e2 + t427 * t1097 / 0.16e2 + t430 * t1097 / 0.16e2 + t1106 * t180 / 0.8e1 + t1109 * t180 / 0.8e1 - t424 * t1113 / 0.12e2 - t427 * t1113 / 0.12e2 - t430 * t1113 / 0.12e2 - t419 * t1113 / 0.12e2;
  tv2rhosigma0 = t1072 + t1122;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1126 = 0.16e2 / 0.3e1 * t119 * t211;
  t1130 = 0.16e2 / 0.3e1 * t133 * t211;
  t1134 = 0.16e2 / 0.3e1 * t136 * t211;
  t1138 = 0.16e2 / 0.3e1 * t139 * t211;
  tv2rhosigma1 = -0.3e1 * t216 * t128 + t1126 - 0.1e2 / 0.3e1 * t220 * t128 + t1130 - 0.11e2 / 0.3e1 * t224 * t128 + t1134 - 0.4e1 * t228 * t128 + t1138;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1139 = t246 * t454;
  t1143 = t50 * t187 * t46;
  t1146 = t251 * t454;
  t1151 = t256 * t454;
  t1156 = t261 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t266 * t470 + t1163 * t188 / 0.8e1 + 0.5e1 / 0.48e2 * t194 * t470 + t1168 * t188 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t725 / 0.2e1 + t1035;
  t1198 = 0.11e2 / 0.96e2 * t199 * t470 + t1174 * t188 / 0.8e1 + t204 * t470 / 0.8e1 + t1179 * t188 / 0.8e1 + 0.3e1 / 0.2e1 * t216 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t220 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t224 * t480 + t136 * t1187 + 0.2e1 * t228 * t480 + t139 * t1187;
  tv2rhosigma2 = t1171 + t1198;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1199 = t372 * t418;
  t1203 = t32 * t316 * t46;
  t1206 = t377 * t418;
  t1211 = t383 * t418;
  t1216 = t388 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t393 * t434 + t1106 * t317 / 0.8e1 + 0.5e1 / 0.48e2 * t398 * t434 + t1109 * t317 / 0.8e1;
  t1240 = t45 * t316;
  t1243 = t1032 * t1240 / 0.2e1 + t1035;
  t1254 = 0.11e2 / 0.96e2 * t310 * t434 + t1090 * t317 / 0.8e1 + t336 * t434 / 0.8e1 + t1093 * t317 / 0.8e1 + 0.3e1 / 0.2e1 * t343 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t347 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t351 * t444 + t136 * t1243 + 0.2e1 * t355 * t444 + t139 * t1243;
  tv2rhosigma3 = t1229 + t1254;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.3e1 * t343 * t128 + t1126 - 0.1e2 / 0.3e1 * t347 * t128 + t1130 - 0.11e2 / 0.3e1 * t351 * t128 + t1134 - 0.4e1 * t355 * t128 + t1138;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1264 = t322 * t97 * t45;
  t1266 = t45 * t329;
  t1269 = -0.2e1 / 0.3e1 * t1264 + t1184 * t1266 / 0.2e1 + t1035;
  t1283 = t29 / rho[1];
  t1285 = t454 * t56 * t46;
  t1288 = t63 * t997;
  t1291 = t67 * t904;
  t1294 = t71 * t908;
  t1305 = t119 * t1269 + 0.3e1 / 0.2e1 * t343 * t480 + t133 * t1269 + 0.5e1 / 0.3e1 * t347 * t480 + t136 * t1269 + 0.11e2 / 0.6e1 * t351 * t480 + t139 * t1269 + 0.2e1 * t355 * t480 + t1283 * t1285 / 0.12e2 + 0.3e1 / 0.32e2 * t1288 * t1285 + 0.5e1 / 0.48e2 * t1291 * t1285 + 0.11e2 / 0.96e2 * t1294 * t1285 - t105 * t1264 / 0.6e1 - t110 * t1264 / 0.6e1 - t115 * t1264 / 0.6e1 - t85 * t1264 / 0.6e1;
  t1307 = 0.1e1 / t4 / t93;
  t1308 = t84 * t1307;
  t1311 = 0.1e1 / t93;
  t1312 = t104 * t1311;
  t1315 = 0.1e1 / t79;
  t1316 = t109 * t1315;
  t1319 = 0.1e1 / t26;
  t1320 = t113 * t1319;
  t1330 = t50 * t329 * t46;
  t1342 = t362 * t56 * t46;
  t1351 = 0.3e1 / 0.32e2 * t1308 * t98 + 0.5e1 / 0.48e2 * t1312 * t98 + 0.11e2 / 0.96e2 * t1316 * t98 + t1320 * t98 / 0.8e1 + t1168 * t330 / 0.8e1 + t1174 * t330 / 0.8e1 + t1179 * t330 / 0.8e1 + t455 * t1330 / 0.16e2 + t460 * t1330 / 0.16e2 + t463 * t1330 / 0.16e2 + t466 * t1330 / 0.16e2 + t1163 * t330 / 0.8e1 - t455 * t1342 / 0.12e2 - t460 * t1342 / 0.12e2 - t463 * t1342 / 0.12e2 - t466 * t1342 / 0.12e2;
  tv2rhosigma5 = t1305 + t1351;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  tv2sigma20 = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  tv2sigma25 = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1374 = t535 * rho[0];
  t1376 = 0.1e1 / t23 / t1374;
  t1377 = sigma[0] * t1376;
  t1378 = t1377 * t91;
  t1380 = t538 * t180;
  t1382 = t171 * t544;
  t1384 = t171 * t547;
  t1386 = t708 * t505;
  t1387 = t89 * t1386;
  t1390 = 0.1e1 / t494 / t38;
  t1391 = t496 * t176;
  t1394 = t495 * t176;
  t1397 = t34 * t659;
  t1399 = 0.6e1 * t272 - 0.6e1 * t1397;
  t1403 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1390 * t1391 + 0.4e1 / 0.3e1 * t1394 * t501 + 0.4e1 / 0.3e1 * t42 * t1399);
  t1404 = t174 * t1403;
  t1405 = t89 * t1404;
  t1407 = t725 * t518;
  t1408 = t96 * t1407;
  t1411 = 0.1e1 / t509 / t52;
  t1412 = t511 * t184;
  t1415 = t510 * t184;
  t1418 = -t1399;
  t1422 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1411 * t1412 + 0.4e1 / 0.3e1 * t1415 * t514 + 0.4e1 / 0.3e1 * t54 * t1418);
  t1423 = t183 * t1422;
  t1424 = t96 * t1423;
  t1426 = -0.154e3 / 0.27e2 * t1378 + 0.22e2 / 0.3e1 * t1380 - 0.2e1 * t1382 - 0.2e1 * t1384 + 0.3e1 / 0.4e1 * t1387 + t1405 / 0.4e1 + 0.3e1 / 0.4e1 * t1408 + t1424 / 0.4e1;
  t1447 = t580 * t35;
  t1449 = 0.1e1 / t126 / t1447;
  t1451 = 0.1232e4 / 0.27e2 * t123 * t1449;
  t1452 = -0.308e3 / 0.27e2 * t1378 + 0.44e2 / 0.3e1 * t1380 - 0.4e1 * t1382 - 0.4e1 * t1384 + 0.3e1 / 0.2e1 * t1387 + t1405 / 0.2e1 + 0.3e1 / 0.2e1 * t1408 + t1424 / 0.2e1 + t1451;
  t1466 = t288 * t144;
  t1468 = t291 * t144;
  t1470 = t294 * t144;
  t1472 = t297 * t144;
  t1480 = t136 * t1452 + 0.11e2 / 0.2e1 * t224 * t585 + t139 * t1452 + 0.6e1 * t228 * t585 + 0.7e1 * t1466 + 0.8e1 * t1468 + 0.9e1 * t1470 + 0.1e2 * t1472 + 0.2e1 / 0.3e1 * t600 * t242 + 0.9e1 / 0.8e1 * t604 * t242 + 0.5e1 / 0.3e1 * t608 * t242;
  t1496 = t29 * t1086;
  t1499 = 0.1e1 / t17;
  t1500 = t63 * t1499;
  t1503 = t67 * t32;
  t1506 = 0.1e1 / t3;
  t1507 = t71 * t1506;
  t1510 = 0.55e2 / 0.24e2 * t612 * t242 + 0.9e1 / 0.8e1 * t615 * t191 + 0.5e1 / 0.3e1 * t618 * t191 + 0.55e2 / 0.24e2 * t621 * t191 + 0.9e1 / 0.4e1 * t624 * t214 + 0.1e2 / 0.3e1 * t627 * t214 + 0.55e2 / 0.12e2 * t632 * t214 - 0.4e1 / 0.27e2 * t1496 * t60 - 0.3e1 / 0.16e2 * t1500 * t60 - 0.5e1 / 0.27e2 * t1503 * t60 - 0.55e2 / 0.432e3 * t1507 * t60;
  t1511 = t84 * t1499;
  t1514 = t104 * t32;
  t1517 = t109 * t1506;
  t1520 = t118 * t1499;
  t1523 = t132 * t32;
  t1526 = t135 * t1506;
  t1529 = t142 * t272;
  t1530 = 0.12e2 * t1529;
  t1531 = t148 * t272;
  t1532 = 0.12e2 * t1531;
  t1534 = 0.1e1 / t9 / t535;
  t1535 = t31 * t1534;
  t1541 = t1403 * t46;
  t1544 = t1422 * t46;
  t1547 = -0.7e2 / 0.27e2 * t1535 * t47 + 0.7e1 / 0.3e1 * t489 * t236 - t233 * t506 + t33 * t1541 / 0.4e1 + t51 * t1544 / 0.4e1;
  t1554 = -0.3e1 / 0.16e2 * t1511 * t101 - 0.5e1 / 0.27e2 * t1514 * t101 - 0.55e2 / 0.432e3 * t1517 * t101 - 0.3e1 / 0.8e1 * t1520 * t130 - 0.1e2 / 0.27e2 * t1523 * t130 - 0.55e2 / 0.216e3 * t1526 * t130 - t1530 - t1532 + t30 * t1547 / 0.2e1 + 0.2e1 * t246 * t522 + t64 * t1547 / 0.2e1;
  t1571 = t151 * t272;
  t1572 = 0.12e2 * t1571;
  t1573 = t154 * t272;
  t1574 = 0.12e2 * t1573;
  t1584 = t113 * t191;
  t1586 = t138 * t214;
  t1588 = 0.1e1 / t1447;
  t1589 = t143 * t1588;
  t1591 = 0.24e2 * t154 * t1589;
  t1592 = t288 * t499;
  t1594 = t288 * t660;
  t1596 = t147 * t1086;
  t1599 = t671 * t175;
  t1601 = t671 * t273;
  t1603 = -0.8e1 / 0.27e2 * t8 * t1086 - 0.3e1 / 0.8e1 * t15 * t1499 - 0.1e2 / 0.27e2 * t22 * t32 + 0.3e1 * t1584 + 0.6e1 * t1586 - t1591 - 0.28e2 * t1592 + 0.21e2 * t1594 - 0.8e1 / 0.27e2 * t1596 * t145 + 0.8e1 / 0.3e1 * t1599 - 0.8e1 / 0.3e1 * t1601;
  t1605 = t291 * t499;
  t1607 = t291 * t660;
  t1609 = t150 * t1499;
  t1612 = t678 * t175;
  t1614 = t678 * t273;
  t1616 = t294 * t499;
  t1618 = t294 * t660;
  t1620 = t153 * t32;
  t1623 = t685 * t175;
  t1625 = t685 * t273;
  t1627 = t297 * t499;
  t1629 = -0.32e2 * t1605 + 0.24e2 * t1607 - 0.3e1 / 0.8e1 * t1609 * t145 + 0.9e1 / 0.2e1 * t1612 - 0.9e1 / 0.2e1 * t1614 - 0.36e2 * t1616 + 0.27e2 * t1618 - 0.1e2 / 0.27e2 * t1620 * t145 + 0.2e2 / 0.3e1 * t1623 - 0.2e2 / 0.3e1 * t1625 - 0.4e2 * t1627;
  t1630 = t297 * t660;
  t1632 = t142 * t1397;
  t1633 = 0.36e2 * t1632;
  t1635 = 0.24e2 * t142 * t1589;
  t1636 = t148 * t1397;
  t1637 = 0.36e2 * t1636;
  t1639 = 0.24e2 * t148 * t1589;
  t1640 = t151 * t1397;
  t1641 = 0.36e2 * t1640;
  t1643 = 0.24e2 * t151 * t1589;
  t1644 = t154 * t1397;
  t1645 = 0.36e2 * t1644;
  t1646 = t141 * t1082;
  t1649 = t663 * t175;
  t1651 = t663 * t273;
  t1653 = 0.3e2 * t1630 + t1633 - t1635 + t1637 - t1639 + t1641 - t1643 + t1645 - 0.35e2 / 0.216e3 * t1646 * t145 + 0.7e1 / 0.6e1 * t1649 - 0.7e1 / 0.6e1 * t1651;
  tv3rho30 = 0.9e1 / 0.4e1 * t266 * t557 - 0.35e2 / 0.216e3 * t1 * t1082 + 0.5e1 * t220 * t585 + t105 * t1426 / 0.2e1 + 0.5e1 / 0.2e1 * t194 * t557 + t110 * t1426 / 0.2e1 + 0.11e2 / 0.4e1 * t199 * t557 + t115 * t1426 / 0.2e1 + 0.3e1 * t204 * t557 + t119 * t1452 + 0.9e1 / 0.2e1 * t216 * t585 + t133 * t1452 + 0.9e1 / 0.4e1 * t251 * t522 + t68 * t1547 / 0.2e1 + 0.5e1 / 0.2e1 * t256 * t522 + t81 * t1547 / 0.2e1 + 0.11e2 / 0.4e1 * t261 * t522 + t85 * t1426 / 0.2e1 + t1653 + t1629 + t1603 - t1574 - t1572 + t1554 + t1510 + t1480;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1658 = t538 * t317;
  t1660 = t171 * t709;
  t1662 = t171 * t720;
  t1664 = t505 * t45;
  t1665 = t1664 * t316;
  t1666 = t89 * t1665;
  t1668 = t708 * t719;
  t1669 = t89 * t1668;
  t1670 = t1390 * t313;
  t1673 = t495 * t34;
  t1684 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1670 * t496 + 0.16e2 / 0.9e1 * t1673 * t272 * t176 + 0.4e1 / 0.9e1 * t712 * t501 + 0.8e1 / 0.3e1 * t42 * t272 - 0.8e1 * t715 * t659);
  t1685 = t174 * t1684;
  t1686 = t89 * t1685;
  t1688 = t323 * t551;
  t1690 = t323 * t554;
  t1692 = t518 * t45;
  t1693 = t1692 * t329;
  t1694 = t96 * t1693;
  t1696 = t725 * t736;
  t1697 = t96 * t1696;
  t1698 = t1411 * t326;
  t1701 = t510 * t34;
  t1712 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1698 * t511 - 0.16e2 / 0.9e1 * t1701 * t272 * t184 + 0.4e1 / 0.9e1 * t729 * t514 - 0.8e1 / 0.3e1 * t54 * t272 + 0.8e1 * t732 * t659);
  t1713 = t183 * t1712;
  t1714 = t96 * t1713;
  t1716 = 0.44e2 / 0.9e1 * t1658 - 0.8e1 / 0.3e1 * t1660 - 0.8e1 / 0.3e1 * t1662 + t1666 / 0.2e1 + t1669 + t1686 / 0.2e1 - 0.4e1 / 0.3e1 * t1688 - 0.4e1 / 0.3e1 * t1690 + t1694 / 0.2e1 + t1697 + t1714 / 0.2e1 + t1451;
  t1726 = t1684 * t46;
  t1731 = t1712 * t46;
  t1734 = 0.7e1 / 0.9e1 * t489 * t358 - 0.2e1 / 0.3e1 * t233 * t753 + t33 * t1726 / 0.4e1 - t363 * t519 / 0.3e1 + t51 * t1731 / 0.4e1;
  t1749 = 0.11e2 / 0.6e1 * t351 * t585 + t139 * t1716 + 0.4e1 * t228 * t740 + 0.2e1 * t355 * t585 + t30 * t1734 / 0.2e1 + 0.4e1 / 0.3e1 * t246 * t761 + 0.2e1 / 0.3e1 * t372 * t522 + t64 * t1734 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t761 + 0.3e1 / 0.4e1 * t377 * t522 + t68 * t1734 / 0.2e1;
  t1771 = 0.22e2 / 0.9e1 * t1658 - 0.4e1 / 0.3e1 * t1660 - 0.4e1 / 0.3e1 * t1662 + t1666 / 0.4e1 + t1669 / 0.2e1 + t1686 / 0.4e1 - 0.2e1 / 0.3e1 * t1688 - 0.2e1 / 0.3e1 * t1690 + t1694 / 0.4e1 + t1697 / 0.2e1 + t1714 / 0.4e1;
  t1784 = 0.5e1 / 0.3e1 * t256 * t761 + 0.5e1 / 0.6e1 * t383 * t522 + t81 * t1734 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t761 + 0.11e2 / 0.12e2 * t388 * t522 + t85 * t1771 / 0.2e1 + 0.3e1 / 0.2e1 * t266 * t793 + 0.3e1 / 0.4e1 * t393 * t557 + t105 * t1771 / 0.2e1 + 0.5e1 / 0.3e1 * t194 * t793 + 0.5e1 / 0.6e1 * t398 * t557;
  t1805 = t110 * t1771 / 0.2e1 + 0.11e2 / 0.6e1 * t199 * t793 + 0.11e2 / 0.12e2 * t310 * t557 + t115 * t1771 / 0.2e1 + 0.2e1 * t204 * t793 + t336 * t557 + t119 * t1716 + 0.3e1 * t216 * t740 + 0.3e1 / 0.2e1 * t343 * t585 + t133 * t1716 + 0.1e2 / 0.3e1 * t220 * t740;
  t1815 = t413 * t144;
  t1823 = 0.5e1 / 0.3e1 * t347 * t585 + t136 * t1716 + 0.11e2 / 0.3e1 * t224 * t740 - 0.14e2 / 0.3e1 * t1466 - 0.16e2 / 0.3e1 * t1468 - 0.6e1 * t1470 - 0.2e2 / 0.3e1 * t1472 + 0.1e2 / 0.3e1 * t1815 + 0.2e1 / 0.9e1 * t600 * t369 + 0.3e1 / 0.8e1 * t604 * t369 + 0.5e1 / 0.9e1 * t608 * t369;
  t1840 = t404 * t144;
  t1842 = t407 * t144;
  t1844 = t410 * t144;
  t1846 = 0.4e1 * t1529;
  t1847 = 0.55e2 / 0.72e2 * t612 * t369 + 0.3e1 / 0.8e1 * t615 * t333 + 0.5e1 / 0.9e1 * t618 * t333 + 0.55e2 / 0.72e2 * t621 * t333 + 0.3e1 / 0.4e1 * t624 * t341 + 0.1e2 / 0.9e1 * t627 * t341 + 0.55e2 / 0.36e2 * t632 * t341 + 0.7e1 / 0.3e1 * t1840 + 0.8e1 / 0.3e1 * t1842 + 0.3e1 * t1844 + t1846;
  t1848 = 0.4e1 * t1531;
  t1849 = 0.4e1 * t1571;
  t1850 = 0.4e1 * t1573;
  t1851 = t113 * t333;
  t1852 = t138 * t341;
  t1859 = t1848 + t1849 + t1850 + t1851 + 0.2e1 * t1852 - t1591 + 0.14e2 * t1594 - 0.8e1 / 0.9e1 * t1599 - 0.8e1 / 0.9e1 * t1601 + 0.16e2 * t1607 - 0.3e1 / 0.2e1 * t1612;
  t1866 = 0.12e2 * t1632;
  t1867 = 0.12e2 * t1636;
  t1868 = 0.12e2 * t1640;
  t1869 = -0.3e1 / 0.2e1 * t1614 + 0.18e2 * t1618 - 0.2e2 / 0.9e1 * t1623 - 0.2e2 / 0.9e1 * t1625 + 0.2e2 * t1630 + t1866 - t1635 + t1867 - t1639 + t1868 - t1643;
  t1870 = 0.12e2 * t1644;
  t1873 = t404 * t499;
  t1875 = t404 * t660;
  t1877 = t407 * t499;
  t1879 = t407 * t660;
  t1881 = t410 * t499;
  t1883 = t410 * t660;
  t1885 = t413 * t499;
  t1887 = t413 * t660;
  t1889 = t1870 - 0.7e1 / 0.18e2 * t1649 - 0.7e1 / 0.18e2 * t1651 - 0.28e2 / 0.3e1 * t1873 + 0.7e1 * t1875 - 0.32e2 / 0.3e1 * t1877 + 0.8e1 * t1879 - 0.12e2 * t1881 + 0.9e1 * t1883 - 0.4e2 / 0.3e1 * t1885 + 0.1e2 * t1887;
  tv3rho31 = t1749 + t1784 + t1805 + t1823 + t1847 + t1859 + t1869 + t1889;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1894 = t171 * t858;
  t1896 = t1240 * t719;
  t1897 = t89 * t1896;
  t1898 = t171 * t870;
  t1900 = t708 * t869;
  t1901 = t89 * t1900;
  t1903 = t1390 * t861;
  t1908 = t495 * t865;
  t1913 = -0.2e1 * t272 - 0.6e1 * t1397;
  t1917 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1903 * t176 + 0.16e2 / 0.9e1 * t712 * t499 + 0.4e1 / 0.9e1 * t1908 * t176 + 0.4e1 / 0.3e1 * t42 * t1913);
  t1918 = t174 * t1917;
  t1919 = t89 * t1918;
  t1921 = t876 * t188;
  t1923 = t323 * t726;
  t1925 = t323 * t737;
  t1927 = t1266 * t736;
  t1928 = t96 * t1927;
  t1929 = t725 * t892;
  t1930 = t96 * t1929;
  t1932 = t1411 * t885;
  t1937 = t510 * t888;
  t1940 = -t1913;
  t1944 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1932 * t184 - 0.16e2 / 0.9e1 * t729 * t499 + 0.4e1 / 0.9e1 * t1937 * t184 + 0.4e1 / 0.3e1 * t54 * t1940);
  t1945 = t183 * t1944;
  t1946 = t96 * t1945;
  t1948 = -0.4e1 / 0.3e1 * t1894 + t1897 - 0.4e1 / 0.3e1 * t1898 + t1901 / 0.2e1 + t1919 / 0.2e1 + 0.44e2 / 0.9e1 * t1921 - 0.8e1 / 0.3e1 * t1923 - 0.8e1 / 0.3e1 * t1925 + t1928 + t1930 / 0.2e1 + t1946 / 0.2e1 + t1451;
  t1967 = 0.1e2 / 0.3e1 * t347 * t740 + t136 * t1948 + 0.11e2 / 0.6e1 * t224 * t896 + 0.11e2 / 0.3e1 * t351 * t740 + t139 * t1948 + 0.2e1 * t228 * t896 + 0.4e1 * t355 * t740 + 0.55e2 / 0.36e2 * t901 * t214 + 0.2e1 / 0.9e1 * t905 * t242 + 0.3e1 / 0.8e1 * t909 * t242 + 0.5e1 / 0.9e1 * t913 * t242;
  t1974 = t1917 * t46;
  t1981 = t1944 * t46;
  t1984 = -t233 * t934 / 0.3e1 + t33 * t1974 / 0.4e1 + 0.7e1 / 0.9e1 * t939 * t239 - 0.2e1 / 0.3e1 * t363 * t758 + t51 * t1981 / 0.4e1;
  t2003 = 0.55e2 / 0.72e2 * t916 * t242 + 0.3e1 / 0.8e1 * t919 * t191 + t30 * t1984 / 0.2e1 + 0.2e1 / 0.3e1 * t246 * t947 + 0.4e1 / 0.3e1 * t372 * t761 + t64 * t1984 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t947 + 0.3e1 / 0.2e1 * t377 * t761 + t68 * t1984 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t947 + 0.5e1 / 0.3e1 * t383 * t761;
  t2022 = -0.2e1 / 0.3e1 * t1894 + t1897 / 0.2e1 - 0.2e1 / 0.3e1 * t1898 + t1901 / 0.4e1 + t1919 / 0.4e1 + 0.22e2 / 0.9e1 * t1921 - 0.4e1 / 0.3e1 * t1923 - 0.4e1 / 0.3e1 * t1925 + t1928 / 0.2e1 + t1930 / 0.4e1 + t1946 / 0.4e1;
  t2039 = t81 * t1984 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t947 + 0.11e2 / 0.6e1 * t388 * t761 + t85 * t2022 / 0.2e1 + 0.3e1 / 0.4e1 * t266 * t971 + 0.3e1 / 0.2e1 * t393 * t793 + 0.5e1 / 0.9e1 * t922 * t191 + 0.55e2 / 0.72e2 * t925 * t191 + 0.3e1 / 0.4e1 * t928 * t214 + 0.1e2 / 0.9e1 * t931 * t214 + t105 * t2022 / 0.2e1;
  t2060 = 0.5e1 / 0.6e1 * t194 * t971 + 0.5e1 / 0.3e1 * t398 * t793 + t110 * t2022 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t971 + 0.11e2 / 0.6e1 * t310 * t793 + t115 * t2022 / 0.2e1 + t204 * t971 + 0.2e1 * t336 * t793 + t119 * t1948 + 0.3e1 / 0.2e1 * t216 * t896 + 0.3e1 * t343 * t740;
  t2074 = t133 * t1948 + 0.5e1 / 0.3e1 * t220 * t896 + 0.7e1 / 0.3e1 * t1466 + 0.8e1 / 0.3e1 * t1468 + 0.3e1 * t1470 + 0.1e2 / 0.3e1 * t1472 - 0.2e2 / 0.3e1 * t1815 - 0.14e2 / 0.3e1 * t1840 - 0.16e2 / 0.3e1 * t1842 - 0.6e1 * t1844 + t1846;
  t2081 = t1848 + t1849 + t1850 + t1584 + 0.2e1 * t1586 - t1591 + 0.28e2 / 0.3e1 * t1592 + 0.7e1 * t1594 + 0.32e2 / 0.3e1 * t1605 + 0.8e1 * t1607 + 0.12e2 * t1616;
  t2087 = 0.9e1 * t1618 + 0.4e2 / 0.3e1 * t1627 + 0.1e2 * t1630 - t1866 - t1635 - t1867 - t1639 - t1868 - t1643 - t1870 + 0.14e2 * t1875;
  t2091 = t1015 * t175;
  t2093 = t1015 * t273;
  t2095 = t1018 * t175;
  t2097 = t1018 * t273;
  t2099 = t1021 * t175;
  t2101 = t1021 * t273;
  t2103 = t1024 * t175;
  t2105 = t1024 * t273;
  t2107 = 0.16e2 * t1879 + 0.18e2 * t1883 + 0.2e2 * t1887 + 0.7e1 / 0.18e2 * t2091 - 0.7e1 / 0.18e2 * t2093 + 0.8e1 / 0.9e1 * t2095 - 0.8e1 / 0.9e1 * t2097 + 0.3e1 / 0.2e1 * t2099 - 0.3e1 / 0.2e1 * t2101 + 0.2e2 / 0.9e1 * t2103 - 0.2e2 / 0.9e1 * t2105;
  tv3rho32 = t1967 + t2003 + t2039 + t2060 + t2074 + t2081 + t2087 + t2107;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2112 = 0.1e1 / t5;
  t2113 = t135 * t2112;
  t2116 = t29 * t1319;
  t2119 = 0.1e1 / t19;
  t2120 = t63 * t2119;
  t2123 = t67 * t50;
  t2141 = t1240 * t869;
  t2142 = t89 * t2141;
  t2144 = t861 * t313;
  t2150 = -0.6e1 * t272 - 0.6e1 * t1397;
  t2154 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1390 * t2144 + 0.4e1 / 0.3e1 * t712 * t865 + 0.4e1 / 0.3e1 * t42 * t2150);
  t2155 = t174 * t2154;
  t2156 = t89 * t2155;
  t2158 = t873 * rho[1];
  t2160 = 0.1e1 / t25 / t2158;
  t2161 = sigma[2] * t2160;
  t2162 = t2161 * t98;
  t2164 = t876 * t330;
  t2166 = t323 * t882;
  t2168 = t323 * t893;
  t2170 = t1266 * t892;
  t2171 = t96 * t2170;
  t2173 = t885 * t326;
  t2178 = -t2150;
  t2182 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1411 * t2173 + 0.4e1 / 0.3e1 * t729 * t888 + 0.4e1 / 0.3e1 * t54 * t2178);
  t2183 = t183 * t2182;
  t2184 = t96 * t2183;
  t2186 = 0.3e1 / 0.4e1 * t2142 + t2156 / 0.4e1 - 0.154e3 / 0.27e2 * t2162 + 0.22e2 / 0.3e1 * t2164 - 0.2e1 * t2166 - 0.2e1 * t2168 + 0.3e1 / 0.4e1 * t2171 + t2184 / 0.4e1;
  t2207 = 0.3e1 / 0.2e1 * t2142 + t2156 / 0.2e1 - 0.308e3 / 0.27e2 * t2162 + 0.44e2 / 0.3e1 * t2164 - 0.4e1 * t2166 - 0.4e1 * t2168 + 0.3e1 / 0.2e1 * t2171 + t2184 / 0.2e1 + t1451;
  t2212 = 0.5e1 / 0.3e1 * t922 * t333 + 0.55e2 / 0.24e2 * t925 * t333 + t105 * t2186 / 0.2e1 + 0.5e1 / 0.2e1 * t398 * t971 + t110 * t2186 / 0.2e1 + 0.11e2 / 0.4e1 * t310 * t971 + t115 * t2186 / 0.2e1 + 0.3e1 * t336 * t971 + t119 * t2207 + 0.9e1 / 0.2e1 * t343 * t896 + t133 * t2207;
  t2222 = t2154 * t46;
  t2226 = 0.1e1 / t11 / t873;
  t2227 = t49 * t2226;
  t2233 = t2182 * t46;
  t2236 = t33 * t2222 / 0.4e1 - 0.7e2 / 0.27e2 * t2227 * t57 + 0.7e1 / 0.3e1 * t939 * t366 - t363 * t944 + t51 * t2233 / 0.4e1;
  t2249 = 0.5e1 * t347 * t896 + t136 * t2207 + 0.11e2 / 0.2e1 * t351 * t896 + t139 * t2207 + 0.6e1 * t355 * t896 + t30 * t2236 / 0.2e1 + 0.2e1 * t372 * t947 + t64 * t2236 / 0.2e1 + 0.9e1 / 0.4e1 * t377 * t947 + t68 * t2236 / 0.2e1 + 0.5e1 / 0.2e1 * t383 * t947;
  t2258 = t71 * t2112;
  t2261 = t84 * t2119;
  t2264 = t104 * t50;
  t2267 = t109 * t2112;
  t2270 = t118 * t2119;
  t2273 = t132 * t50;
  t2278 = t81 * t2236 / 0.2e1 + 0.11e2 / 0.4e1 * t388 * t947 + t85 * t2186 / 0.2e1 + 0.9e1 / 0.4e1 * t393 * t971 - 0.55e2 / 0.432e3 * t2258 * t60 - 0.3e1 / 0.16e2 * t2261 * t101 - 0.5e1 / 0.27e2 * t2264 * t101 - 0.55e2 / 0.432e3 * t2267 * t101 - 0.3e1 / 0.8e1 * t2270 * t130 - 0.1e2 / 0.27e2 * t2273 * t130 + 0.9e1 / 0.4e1 * t928 * t341;
  t2290 = t141 * t1315;
  t2293 = t147 * t1319;
  t2296 = t150 * t2119;
  t2299 = t153 * t50;
  t2302 = 0.6e1 * t1852 - 0.35e2 / 0.216e3 * t2290 * t145 - 0.8e1 / 0.27e2 * t2293 * t145 - 0.3e1 / 0.8e1 * t2296 * t145 - 0.1e2 / 0.27e2 * t2299 * t145 - t1591 - t1633 - t1635 - t1637 - t1639 - t1641;
  t2313 = -t1643 - t1645 + 0.28e2 * t1873 + 0.21e2 * t1875 + 0.32e2 * t1877 + 0.24e2 * t1879 + 0.36e2 * t1881 + 0.27e2 * t1883 + 0.4e2 * t1885 + 0.3e2 * t1887 - 0.7e1 / 0.6e1 * t2091;
  t2329 = -0.7e1 / 0.6e1 * t2093 - 0.8e1 / 0.3e1 * t2095 - 0.8e1 / 0.3e1 * t2097 - 0.9e1 / 0.2e1 * t2099 - 0.9e1 / 0.2e1 * t2101 - 0.2e2 / 0.3e1 * t2103 - 0.2e2 / 0.3e1 * t2105 - 0.8e1 / 0.27e2 * t8 * t1319 - 0.3e1 / 0.8e1 * t15 * t2119 - 0.1e2 / 0.27e2 * t22 * t50 - 0.35e2 / 0.216e3 * t1 * t1315;
  tv3rho33 = 0.1e2 / 0.3e1 * t931 * t341 + 0.55e2 / 0.12e2 * t901 * t341 - 0.55e2 / 0.216e3 * t2113 * t130 - 0.4e1 / 0.27e2 * t2116 * t60 - 0.3e1 / 0.16e2 * t2120 * t60 - 0.5e1 / 0.27e2 * t2123 * t60 + 0.2e1 / 0.3e1 * t905 * t369 + 0.9e1 / 0.8e1 * t909 * t369 + 0.5e1 / 0.3e1 * t913 * t369 + 0.55e2 / 0.24e2 * t916 * t369 + 0.9e1 / 0.8e1 * t919 * t333 + t2329 + t2313 + t2302 + t2278 + t2249 + t2212 + 0.3e1 * t1851 + 0.9e1 * t1844 + 0.7e1 * t1840 + 0.8e1 * t1842 + 0.1e2 * t1815 - t1574 - t1572 - t1532 - t1530;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2333 = t537 * t90 * t45;
  t2335 = t170 * t44;
  t2339 = t88 * t543 * t45;
  t2343 = 0.88e2 / 0.9e1 * t582;
  t2344 = 0.22e2 / 0.9e1 * t2333 - 0.8e1 / 0.3e1 * t2335 * t708 + t2339 / 0.2e1 + t1032 * t1664 / 0.2e1 - t2343;
  t2369 = t139 * t2344 + 0.4e1 * t228 * t1036 + t119 * t2344 + 0.3e1 * t216 * t1036 + t133 * t2344 + 0.1e2 / 0.3e1 * t220 * t1036 + t136 * t2344 + 0.11e2 / 0.3e1 * t224 * t1036 + 0.3e1 / 0.4e1 * t624 * t444 + 0.1e2 / 0.9e1 * t627 * t444 + 0.55e2 / 0.36e2 * t632 * t444 + 0.11e2 / 0.18e2 * t85 * t2333 + t85 * t2339 / 0.8e1 + 0.11e2 / 0.18e2 * t105 * t2333;
  t2372 = t29 * t1078;
  t2375 = t63 * t1082;
  t2378 = t67 * t1086;
  t2381 = t71 * t1499;
  t2393 = t418 * t179 * t46;
  t2404 = t105 * t2339 / 0.8e1 - 0.7e1 / 0.36e2 * t2372 * t1052 - 0.13e2 / 0.64e2 * t2375 * t1052 - 0.5e1 / 0.24e2 * t2378 * t1052 - 0.121e3 / 0.576e3 * t2381 * t1052 + 0.11e2 / 0.18e2 * t110 * t2333 + t110 * t2339 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2333 + t115 * t2339 / 0.8e1 + 0.3e1 / 0.16e2 * t1055 * t2393 + 0.5e1 / 0.24e2 * t1058 * t2393 + 0.11e2 / 0.48e2 * t1061 * t2393 + 0.11e2 / 0.24e2 * t1083 * t180 + t1087 * t180 / 0.2e1;
  t2413 = 0.1e1 / t74 / t86;
  t2414 = t109 * t2413;
  t2417 = t113 * t88;
  t2418 = t2417 * t91;
  t2422 = t84 / t2 / t168;
  t2425 = 0.1e1 / t168;
  t2426 = t104 * t2425;
  t2430 = 0.2e1 * t138 * t444;
  t2432 = t32 * t505 * t46;
  t2441 = t85 * t170;
  t2446 = 0.3e1 / 0.8e1 * t1075 * t180 + 0.5e1 / 0.12e2 * t1079 * t180 + t1050 * t2393 / 0.6e1 - 0.33e2 / 0.64e2 * t2414 * t91 - 0.13e2 / 0.24e2 * t2418 - 0.29e2 / 0.64e2 * t2422 * t91 - 0.35e2 / 0.72e2 * t2426 * t91 + t2430 + t419 * t2432 / 0.16e2 + t424 * t2432 / 0.16e2 + t427 * t2432 / 0.16e2 + t430 * t2432 / 0.16e2 - 0.2e1 / 0.3e1 * t2441 * t180 + t1106 * t547 / 0.8e1;
  t2447 = t105 * t170;
  t2452 = t110 * t170;
  t2457 = t115 * t170;
  t2463 = t232 * t179 * t46;
  t2467 = t488 * t44 * t46;
  t2482 = -0.2e1 / 0.3e1 * t2447 * t180 + t1109 * t547 / 0.8e1 - 0.2e1 / 0.3e1 * t2452 * t180 + t1090 * t547 / 0.8e1 - 0.2e1 / 0.3e1 * t2457 * t180 + t1093 * t547 / 0.8e1 - t430 * t2463 / 0.6e1 + 0.7e1 / 0.36e2 * t424 * t2467 + 0.7e1 / 0.36e2 * t427 * t2467 + 0.7e1 / 0.36e2 * t430 * t2467 + 0.7e1 / 0.36e2 * t419 * t2467 - t419 * t2463 / 0.6e1 - t424 * t2463 / 0.6e1 - t427 * t2463 / 0.6e1;
  tv3rho2sigma0 = t2369 + t2404 + t2446 + t2482;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t2486 = t216 * t211;
  t2489 = 0.176e3 / 0.9e1 * t119 * t582;
  t2492 = t220 * t211;
  t2495 = 0.176e3 / 0.9e1 * t133 * t582;
  t2498 = t224 * t211;
  t2501 = 0.176e3 / 0.9e1 * t136 * t582;
  t2503 = 0.4e1 * t138 * t128;
  t2504 = t228 * t211;
  t2507 = 0.176e3 / 0.9e1 * t139 * t582;
  tv3rho2sigma1 = -0.3e1 / 0.2e1 * t624 * t128 + 0.16e2 * t2486 - t2489 - 0.2e2 / 0.9e1 * t627 * t128 + 0.16e3 / 0.9e1 * t2492 - t2495 - 0.55e2 / 0.18e2 * t632 * t128 + 0.176e3 / 0.9e1 * t2498 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2517 = t95 * t550 * t45;
  t2521 = t2517 / 0.2e1 + t1184 * t1692 / 0.2e1 - t2343;
  t2546 = t113 * t95;
  t2547 = t2546 * t98;
  t2550 = 0.2e1 * t138 * t480;
  t2551 = 0.3e1 / 0.4e1 * t624 * t480 + 0.1e2 / 0.9e1 * t627 * t480 + 0.55e2 / 0.36e2 * t632 * t480 + 0.11e2 / 0.3e1 * t224 * t1187 + t136 * t2521 + 0.4e1 * t228 * t1187 + t139 * t2521 + 0.3e1 * t216 * t1187 + t119 * t2521 + 0.1e2 / 0.3e1 * t220 * t1187 + t133 * t2521 + 0.5e1 / 0.72e2 * t618 * t470 + t105 * t2517 / 0.8e1 + 0.55e2 / 0.576e3 * t621 * t470 + t110 * t2517 / 0.8e1 + t115 * t2517 / 0.8e1 + 0.3e1 / 0.64e2 * t615 * t470 + t85 * t2517 / 0.8e1 + t2547 / 0.8e1 + t2550;
  t2554 = t194 * t95;
  t2559 = t199 * t95;
  t2564 = t204 * t95;
  t2572 = t50 * t518 * t46;
  t2587 = t266 * t95;
  t2590 = t604 * t454;
  t2593 = t608 * t454;
  t2596 = t612 * t454;
  t2599 = t600 * t454;
  t2602 = t1163 * t554 / 0.8e1 + 0.5e1 / 0.12e2 * t2554 * t188 + t1168 * t554 / 0.8e1 + 0.11e2 / 0.24e2 * t2559 * t188 + t1174 * t554 / 0.8e1 + t2564 * t188 / 0.2e1 + t1179 * t554 / 0.8e1 + t1139 * t1143 / 0.6e1 + t455 * t2572 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t1143 + t460 * t2572 / 0.16e2 + 0.5e1 / 0.24e2 * t1151 * t1143 + t463 * t2572 / 0.16e2 + 0.11e2 / 0.48e2 * t1156 * t1143 + t466 * t2572 / 0.16e2 + 0.3e1 / 0.8e1 * t2587 * t188 + 0.3e1 / 0.64e2 * t2590 * t457 + 0.5e1 / 0.72e2 * t2593 * t457 + 0.55e2 / 0.576e3 * t2596 * t457 + t2599 * t457 / 0.36e2;
  tv3rho2sigma2 = t2551 + t2602;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2607 = t88 * t179;
  t2610 = t45 * t719;
  t2613 = -0.4e1 / 0.3e1 * t2335 * t1240 + t2607 * t1240 / 0.2e1 + t1032 * t2610 / 0.2e1 - t2343;
  t2636 = 0.3e1 / 0.2e1 * t343 * t1036 + t119 * t2613 + 0.3e1 / 0.2e1 * t216 * t1243 + 0.5e1 / 0.3e1 * t347 * t1036 + t133 * t2613 + 0.5e1 / 0.3e1 * t220 * t1243 + 0.11e2 / 0.6e1 * t351 * t1036 + t136 * t2613 + 0.11e2 / 0.6e1 * t224 * t1243 + 0.2e1 * t355 * t1036 + t139 * t2613 + 0.2e1 * t228 * t1243 - 0.5e1 / 0.18e2 * t398 * t1030 - 0.11e2 / 0.36e2 * t310 * t1030;
  t2642 = t418 * t316 * t46;
  t2662 = t232 * t316 * t46;
  t2669 = -t336 * t1030 / 0.3e1 - t393 * t1030 / 0.4e1 + t1050 * t2642 / 0.12e2 + 0.3e1 / 0.32e2 * t1055 * t2642 + 0.5e1 / 0.48e2 * t1058 * t2642 + 0.11e2 / 0.96e2 * t1061 * t2642 + 0.3e1 / 0.16e2 * t1075 * t317 + 0.5e1 / 0.24e2 * t1079 * t317 + 0.11e2 / 0.48e2 * t1083 * t317 + t1087 * t317 / 0.4e1 - t1206 * t1113 / 0.8e1 - t424 * t2662 / 0.12e2 - 0.5e1 / 0.36e2 * t1211 * t1113 - t427 * t2662 / 0.12e2;
  t2673 = t336 * t88;
  t2683 = t32 * t719 * t46;
  t2698 = t393 * t88;
  t2703 = t1090 * t720 / 0.8e1 + t2673 * t180 / 0.4e1 + t1093 * t709 / 0.8e1 + t1093 * t720 / 0.8e1 + t1199 * t1097 / 0.12e2 + t419 * t2683 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t1097 + t424 * t2683 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t1097 + t427 * t2683 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t1097 + t430 * t2683 / 0.16e2 + 0.3e1 / 0.16e2 * t2698 * t180 - 0.11e2 / 0.72e2 * t1216 * t1113;
  t2722 = t398 * t88;
  t2729 = t310 * t88;
  t2734 = -t430 * t2662 / 0.12e2 - t2441 * t317 / 0.3e1 - t2447 * t317 / 0.3e1 - t2452 * t317 / 0.3e1 - t2457 * t317 / 0.3e1 - t1199 * t1113 / 0.9e1 - t419 * t2662 / 0.12e2 + t1106 * t709 / 0.8e1 + t1106 * t720 / 0.8e1 + 0.5e1 / 0.24e2 * t2722 * t180 + t1109 * t709 / 0.8e1 + t1109 * t720 / 0.8e1 + 0.11e2 / 0.48e2 * t2729 * t180 + t1090 * t709 / 0.8e1;
  tv3rho2sigma3 = t2636 + t2669 + t2703 + t2734;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t2736 = t343 * t211;
  t2739 = t347 * t211;
  t2742 = t351 * t211;
  t2745 = t355 * t211;
  tv3rho2sigma4 = 0.8e1 * t2736 + 0.8e1 * t2486 - t2489 + 0.8e2 / 0.9e1 * t2739 + 0.8e2 / 0.9e1 * t2492 - t2495 + 0.88e2 / 0.9e1 * t2742 + 0.88e2 / 0.9e1 * t2498 - t2501 + 0.32e2 / 0.3e1 * t2745 + 0.32e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2750 = t322 * t56;
  t2753 = t95 * t187;
  t2756 = t45 * t736;
  t2759 = -0.4e1 / 0.3e1 * t2750 * t725 + t2753 * t1266 / 0.2e1 + t1184 * t2756 / 0.2e1 - t2343;
  t2779 = t454 * t187 * t46;
  t2784 = 0.3e1 / 0.2e1 * t343 * t1187 + t133 * t2759 + 0.5e1 / 0.3e1 * t220 * t1269 + 0.5e1 / 0.3e1 * t347 * t1187 + t136 * t2759 + 0.11e2 / 0.6e1 * t224 * t1269 + 0.11e2 / 0.6e1 * t351 * t1187 + t139 * t2759 + 0.2e1 * t228 * t1269 + 0.2e1 * t355 * t1187 + t119 * t2759 + 0.3e1 / 0.2e1 * t216 * t1269 + t1283 * t2779 / 0.12e2 + 0.3e1 / 0.32e2 * t1288 * t2779;
  t2805 = t105 * t322;
  t2814 = 0.5e1 / 0.48e2 * t1291 * t2779 + 0.11e2 / 0.96e2 * t1294 * t2779 - 0.5e1 / 0.18e2 * t194 * t1264 - 0.11e2 / 0.36e2 * t199 * t1264 - t204 * t1264 / 0.3e1 - t266 * t1264 / 0.4e1 + 0.3e1 / 0.16e2 * t1308 * t188 + 0.5e1 / 0.24e2 * t1312 * t188 + 0.11e2 / 0.48e2 * t1316 * t188 + t1320 * t188 / 0.4e1 - t2805 * t188 / 0.3e1 + t1168 * t726 / 0.8e1 + t1168 * t737 / 0.8e1 + 0.5e1 / 0.24e2 * t2554 * t330;
  t2816 = t110 * t322;
  t2826 = t362 * t187 * t46;
  t2847 = -t2816 * t188 / 0.3e1 + t1163 * t726 / 0.8e1 + t1163 * t737 / 0.8e1 + 0.3e1 / 0.16e2 * t2587 * t330 - t455 * t2826 / 0.12e2 - t1139 * t1342 / 0.9e1 - t460 * t2826 / 0.12e2 - t1146 * t1342 / 0.8e1 - t463 * t2826 / 0.12e2 - 0.5e1 / 0.36e2 * t1151 * t1342 - t466 * t2826 / 0.12e2 - 0.11e2 / 0.72e2 * t1156 * t1342 + t1174 * t726 / 0.8e1 + t1174 * t737 / 0.8e1;
  t2850 = t115 * t322;
  t2860 = t50 * t736 * t46;
  t2877 = t85 * t322;
  t2880 = 0.11e2 / 0.48e2 * t2559 * t330 - t2850 * t188 / 0.3e1 + t1179 * t726 / 0.8e1 + t1179 * t737 / 0.8e1 + t2564 * t330 / 0.4e1 + t455 * t2860 / 0.16e2 + t1139 * t1330 / 0.12e2 + t460 * t2860 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t1330 + t463 * t2860 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t1330 + t466 * t2860 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t1330 - t2877 * t188 / 0.3e1;
  tv3rho2sigma5 = t2784 + t2814 + t2847 + t2880;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2883 = t88 * t857 * t45;
  t2885 = t45 * t869;
  t2888 = t2883 / 0.2e1 + t1032 * t2885 / 0.2e1 - t2343;
  t2921 = t909 * t418;
  t2924 = t913 * t418;
  t2927 = t133 * t2888 + 0.11e2 / 0.3e1 * t351 * t1243 + t136 * t2888 + 0.4e1 * t355 * t1243 + t139 * t2888 + 0.3e1 * t343 * t1243 + t119 * t2888 + 0.1e2 / 0.3e1 * t347 * t1243 + 0.3e1 / 0.4e1 * t928 * t444 + 0.1e2 / 0.9e1 * t931 * t444 + 0.55e2 / 0.36e2 * t901 * t444 + t85 * t2883 / 0.8e1 + 0.5e1 / 0.72e2 * t922 * t434 + t105 * t2883 / 0.8e1 + 0.55e2 / 0.576e3 * t925 * t434 + t110 * t2883 / 0.8e1 + t115 * t2883 / 0.8e1 + 0.3e1 / 0.64e2 * t919 * t434 + 0.3e1 / 0.64e2 * t2921 * t421 + 0.5e1 / 0.72e2 * t2924 * t421;
  t2928 = t916 * t418;
  t2948 = t32 * t869 * t46;
  t2965 = t905 * t418;
  t2969 = 0.55e2 / 0.576e3 * t2928 * t421 + t1106 * t870 / 0.8e1 + 0.5e1 / 0.12e2 * t2722 * t317 + t1109 * t870 / 0.8e1 + 0.11e2 / 0.24e2 * t2729 * t317 + t1090 * t870 / 0.8e1 + t2673 * t317 / 0.2e1 + t1093 * t870 / 0.8e1 + t1199 * t1203 / 0.6e1 + t419 * t2948 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t1203 + t424 * t2948 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t1203 + t427 * t2948 / 0.16e2 + 0.11e2 / 0.48e2 * t1216 * t1203 + t430 * t2948 / 0.16e2 + 0.3e1 / 0.8e1 * t2698 * t317 + t2965 * t421 / 0.36e2 + t2418 / 0.8e1 + t2430;
  tv3rho2sigma6 = t2927 + t2969;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = -0.3e1 / 0.2e1 * t928 * t128 + 0.16e2 * t2736 - t2489 - 0.2e2 / 0.9e1 * t931 * t128 + 0.16e3 / 0.9e1 * t2739 - t2495 - 0.55e2 / 0.18e2 * t901 * t128 + 0.176e3 / 0.9e1 * t2742 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2745 - t2507;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2981 = t875 * t97 * t45;
  t2986 = t95 * t881 * t45;
  t2988 = t45 * t892;
  t2991 = 0.22e2 / 0.9e1 * t2981 - 0.8e1 / 0.3e1 * t2750 * t1266 + t2986 / 0.2e1 + t1184 * t2988 / 0.2e1 - t2343;
  t3016 = t139 * t2991 + 0.4e1 * t355 * t1269 + t119 * t2991 + 0.3e1 * t343 * t1269 + 0.3e1 / 0.4e1 * t928 * t480 + 0.1e2 / 0.9e1 * t931 * t480 + 0.55e2 / 0.36e2 * t901 * t480 + t133 * t2991 + 0.1e2 / 0.3e1 * t347 * t1269 + t136 * t2991 + 0.11e2 / 0.3e1 * t351 * t1269 + 0.11e2 / 0.18e2 * t110 * t2981 + t110 * t2986 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2981;
  t3021 = t29 * t1311;
  t3024 = t63 * t1315;
  t3027 = t67 * t1319;
  t3030 = t71 * t2119;
  t3038 = t454 * t329 * t46;
  t3051 = t115 * t2986 / 0.8e1 + 0.11e2 / 0.18e2 * t85 * t2981 - 0.7e1 / 0.36e2 * t3021 * t1285 - 0.13e2 / 0.64e2 * t3024 * t1285 - 0.5e1 / 0.24e2 * t3027 * t1285 - 0.121e3 / 0.576e3 * t3030 * t1285 + 0.11e2 / 0.18e2 * t105 * t2981 + t105 * t2986 / 0.8e1 + t1283 * t3038 / 0.6e1 + 0.3e1 / 0.16e2 * t1288 * t3038 + 0.5e1 / 0.24e2 * t1291 * t3038 + 0.11e2 / 0.48e2 * t1294 * t3038 + 0.5e1 / 0.12e2 * t1312 * t330 + 0.11e2 / 0.24e2 * t1316 * t330;
  t3060 = t938 * t56 * t46;
  t3064 = t362 * t329 * t46;
  t3085 = t1320 * t330 / 0.2e1 + 0.3e1 / 0.8e1 * t1308 * t330 + t85 * t2986 / 0.8e1 + 0.7e1 / 0.36e2 * t466 * t3060 - t455 * t3064 / 0.6e1 - t460 * t3064 / 0.6e1 - t463 * t3064 / 0.6e1 - t466 * t3064 / 0.6e1 + 0.7e1 / 0.36e2 * t455 * t3060 + 0.7e1 / 0.36e2 * t460 * t3060 + 0.7e1 / 0.36e2 * t463 * t3060 + t1163 * t893 / 0.8e1 + t1168 * t893 / 0.8e1 - 0.2e1 / 0.3e1 * t2816 * t330;
  t3093 = t50 * t892 * t46;
  t3107 = 0.1e1 / t320;
  t3108 = t104 * t3107;
  t3112 = 0.1e1 / t78 / t93;
  t3113 = t109 * t3112;
  t3118 = t84 / t4 / t320;
  t3121 = t1174 * t893 / 0.8e1 - 0.2e1 / 0.3e1 * t2850 * t330 + t1179 * t893 / 0.8e1 + t455 * t3093 / 0.16e2 + t460 * t3093 / 0.16e2 + t463 * t3093 / 0.16e2 + t466 * t3093 / 0.16e2 - 0.2e1 / 0.3e1 * t2877 * t330 - 0.2e1 / 0.3e1 * t2805 * t330 - 0.13e2 / 0.24e2 * t2547 + t2550 - 0.35e2 / 0.72e2 * t3108 * t98 - 0.33e2 / 0.64e2 * t3113 * t98 - 0.29e2 / 0.64e2 * t3118 * t98;
  tv3rho2sigma8 = t3016 + t3051 + t3085 + t3121;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t3124 = t1353 * t44 * t46;
  tv3rhosigma20 = -t1050 * t3124 / 0.24e2 + t1354 * t1113 / 0.24e2 - t1354 * t1097 / 0.32e2 - 0.3e1 / 0.64e2 * t1055 * t3124 + t1356 * t1113 / 0.24e2 - t1356 * t1097 / 0.32e2 - 0.5e1 / 0.96e2 * t1058 * t3124 + t1358 * t1113 / 0.24e2 - t1358 * t1097 / 0.32e2 - 0.11e2 / 0.192e3 * t1061 * t3124 + t1360 * t1113 / 0.24e2 - t1360 * t1097 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t3149 = t246 * t1364;
  t3154 = t251 * t1364;
  t3159 = t256 * t1364;
  t3164 = t261 * t1364;
  tv3rhosigma25 = -t3149 * t457 / 0.24e2 - t1365 * t1143 / 0.32e2 - 0.3e1 / 0.64e2 * t3154 * t457 - t1367 * t1143 / 0.32e2 - 0.5e1 / 0.96e2 * t3159 * t457 - t1369 * t1143 / 0.32e2 - 0.11e2 / 0.192e3 * t3164 * t457 - t1371 * t1143 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t3169 = t372 * t1353;
  t3174 = t377 * t1353;
  t3179 = t383 * t1353;
  t3184 = t388 * t1353;
  tv3rhosigma26 = -t3169 * t421 / 0.24e2 - t1354 * t1203 / 0.32e2 - 0.3e1 / 0.64e2 * t3174 * t421 - t1356 * t1203 / 0.32e2 - 0.5e1 / 0.96e2 * t3179 * t421 - t1358 * t1203 / 0.32e2 - 0.11e2 / 0.192e3 * t3184 * t421 - t1360 * t1203 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t3190 = t1364 * t56 * t46;
  tv3rhosigma211 = -t1283 * t3190 / 0.24e2 + t1365 * t1342 / 0.24e2 - t1365 * t1330 / 0.32e2 - 0.3e1 / 0.64e2 * t1288 * t3190 + t1367 * t1342 / 0.24e2 - t1367 * t1330 / 0.32e2 - 0.5e1 / 0.96e2 * t1291 * t3190 + t1369 * t1342 / 0.24e2 - t1369 * t1330 / 0.32e2 - 0.11e2 / 0.192e3 * t1294 * t3190 + t1371 * t1342 / 0.24e2 - t1371 * t1330 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t3215 = sigma[0] * sigma[0];
  t3217 = 0.1e1 / t31 / t3215;
  t3218 = t30 * t3217;
  t3220 = t64 * t3217;
  t3222 = t68 * t3217;
  t3224 = t81 * t3217;
  tv3sigma30 = 0.3e1 / 0.64e2 * t3218 * t421 + 0.3e1 / 0.64e2 * t3220 * t421 + 0.3e1 / 0.64e2 * t3222 * t421 + 0.3e1 / 0.64e2 * t3224 * t421;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t3227 = sigma[2] * sigma[2];
  t3229 = 0.1e1 / t49 / t3227;
  t3230 = t30 * t3229;
  t3232 = t64 * t3229;
  t3234 = t68 * t3229;
  t3236 = t81 * t3229;
  tv3sigma39 = 0.3e1 / 0.64e2 * t3230 * t457 + 0.3e1 / 0.64e2 * t3232 * t457 + 0.3e1 / 0.64e2 * t3234 * t457 + 0.3e1 / 0.64e2 * t3236 * t457;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t6, t8, t9;
  double t10, t11, t12, t13, t15, t16, t17, t18;
  double t19, t20, t22, t23, t24, t25, t26, t27;
  double t29, t30, t31, t32, t33, t34, t35, t36;
  double t37, t38, t39, t40, t41, t42, t44, t45;
  double t46, t47, t49, t50, t51, t52, t53, t54;
  double t56, t57, t60, t63, t64, t67, t68, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79;
  double t80, t81, t84, t85, t86, t88, t89, t90;
  double t91, t92, t93, t95, t96, t97, t98, t99;
  double t101, t104, t105, t109, t110, t113, t114, t115;
  double t118, t119, t123, t124, t125, t126, t128, t130;
  double t132, t133, t135, t136, t138, t139, t141, t142;
  double t143, t144, t145, t147, t148, t150, t151, t153;
  double t154, t156, t158, tzk0;

  double t168, t170, t171, t172, t174, t175, t176, t179;
  double t180, t181, t183, t184, t187, t188, t189, t191;
  double t194, t199, t204, t209, t211, t213, t214, t216;
  double t220, t224, t228, t232, t233, t236, t239, t242;
  double t245, t246, t251, t256, t261, t266, t270, t272;
  double t273, t275, t277, t279, t281, t283, t285, t287;
  double t288, t291, t294, t297, t300, tvrho0, t310, t313;
  double t316, t317, t318, t320, t322, t323, t324, t326;
  double t329, t330, t331, t333, t336, t341, t343, t347;
  double t351, t355, t358, t362, t363, t366, t369, t372;
  double t377, t380, t383, t388, t393, t398, t404, t407;
  double t410, t413, t416, tvrho1, t418, t419, t421, t424;
  double t427, t430, t434, t444, tvsigma0, tvsigma1, t454, t455;
  double t457, t460, t463, t466, t470, t480, tvsigma2;

  double t488, t489, t494, t495, t496, t499, t501, t505;
  double t506, t509, t510, t511, t514, t518, t519, t522;
  double t535, t537, t538, t539, t541, t543, t544, t545;
  double t547, t548, t550, t551, t552, t554, t555, t557;
  double t580, t582, t584, t585, t587, t599, t600, t603;
  double t604, t607, t608, t611, t612, t615, t618, t621;
  double t624, t627, t630, t632, t636, t638, t640, t642;
  double t643, t645, t646, t658, t659, t660, t662, t663;
  double t666, t668, t669, t671, t674, t676, t678, t681;
  double t683, t685, t688, t690, t693, t695, t697, t699;
  double t701, t703, t704, tv2rho20, t706, t708, t709, t710;
  double t712, t715, t719, t720, t721, t723, t725, t726;
  double t727, t729, t732, t736, t737, t738, t740, t753;
  double t758, t761, t780, t793, t816, t832, t837, t839;
  double t841, t843, t845, t847, t849, t851, t853, tv2rho21;
  double t857, t858, t859, t861, t865, t869, t870, t871;
  double t873, t875, t876, t877, t879, t881, t882, t883;
  double t885, t888, t892, t893, t894, t896, t900, t901;
  double t904, t905, t908, t909, t912, t913, t916, t919;
  double t922, t925, t928, t931, t934, t938, t939, t944;
  double t947, t954, t971, t992, t997, t1006, t1015, t1018;
  double t1021, t1024, t1027, tv2rho22, t1030, t1032, t1035, t1036;
  double t1050, t1052, t1055, t1058, t1061, t1072, t1074, t1075;
  double t1078, t1079, t1082, t1083, t1086, t1087, t1090, t1093;
  double t1097, t1106, t1109, t1113, t1122, tv2rhosigma0, t1126, t1130;
  double t1134, t1138, tv2rhosigma1, t1139, t1143, t1146, t1151, t1156;
  double t1163, t1168, t1171, t1174, t1179, t1184, t1187, t1198;
  double tv2rhosigma2, t1199, t1203, t1206, t1211, t1216, t1229, t1240;
  double t1243, t1254, tv2rhosigma3, tv2rhosigma4, t1264, t1266, t1269, t1283;
  double t1285, t1288, t1291, t1294, t1305, t1307, t1308, t1311;
  double t1312, t1315, t1316, t1319, t1320, t1330, t1342, t1351;
  double tv2rhosigma5, t1353, t1354, t1356, t1358, t1360, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1364, t1365, t1367, t1369, t1371;
  double tv2sigma25;

  double t1374, t1376, t1377, t1378, t1380, t1382, t1384, t1386;
  double t1387, t1390, t1391, t1394, t1397, t1399, t1403, t1404;
  double t1405, t1407, t1408, t1411, t1412, t1415, t1418, t1422;
  double t1423, t1424, t1426, t1447, t1449, t1451, t1452, t1466;
  double t1468, t1470, t1472, t1480, t1496, t1499, t1500, t1503;
  double t1506, t1507, t1510, t1511, t1514, t1517, t1520, t1523;
  double t1526, t1529, t1530, t1531, t1532, t1534, t1535, t1541;
  double t1544, t1547, t1554, t1571, t1572, t1573, t1574, t1584;
  double t1586, t1588, t1589, t1591, t1592, t1594, t1596, t1599;
  double t1601, t1603, t1605, t1607, t1609, t1612, t1614, t1616;
  double t1618, t1620, t1623, t1625, t1627, t1629, t1630, t1632;
  double t1633, t1635, t1636, t1637, t1639, t1640, t1641, t1643;
  double t1644, t1645, t1646, t1649, t1651, t1653, tv3rho30, t1658;
  double t1660, t1662, t1664, t1665, t1666, t1668, t1669, t1670;
  double t1673, t1684, t1685, t1686, t1688, t1690, t1692, t1693;
  double t1694, t1696, t1697, t1698, t1701, t1712, t1713, t1714;
  double t1716, t1726, t1731, t1734, t1749, t1771, t1784, t1805;
  double t1815, t1823, t1840, t1842, t1844, t1846, t1847, t1848;
  double t1849, t1850, t1851, t1852, t1859, t1866, t1867, t1868;
  double t1869, t1870, t1873, t1875, t1877, t1879, t1881, t1883;
  double t1885, t1887, t1889, tv3rho31, t1894, t1896, t1897, t1898;
  double t1900, t1901, t1903, t1908, t1913, t1917, t1918, t1919;
  double t1921, t1923, t1925, t1927, t1928, t1929, t1930, t1932;
  double t1937, t1940, t1944, t1945, t1946, t1948, t1967, t1974;
  double t1981, t1984, t2003, t2022, t2039, t2060, t2074, t2081;
  double t2087, t2091, t2093, t2095, t2097, t2099, t2101, t2103;
  double t2105, t2107, tv3rho32, t2112, t2113, t2116, t2119, t2120;
  double t2123, t2141, t2142, t2144, t2150, t2154, t2155, t2156;
  double t2158, t2160, t2161, t2162, t2164, t2166, t2168, t2170;
  double t2171, t2173, t2178, t2182, t2183, t2184, t2186, t2207;
  double t2212, t2222, t2226, t2227, t2233, t2236, t2249, t2258;
  double t2261, t2264, t2267, t2270, t2273, t2278, t2290, t2293;
  double t2296, t2299, t2302, t2313, t2329, tv3rho33, t2333, t2335;
  double t2339, t2343, t2344, t2369, t2372, t2375, t2378, t2381;
  double t2393, t2404, t2413, t2414, t2417, t2418, t2422, t2425;
  double t2426, t2430, t2432, t2441, t2446, t2447, t2452, t2457;
  double t2463, t2467, t2482, tv3rho2sigma0, t2486, t2489, t2492, t2495;
  double t2498, t2501, t2503, t2504, t2507, tv3rho2sigma1, t2517, t2521;
  double t2546, t2547, t2550, t2551, t2554, t2559, t2564, t2572;
  double t2587, t2590, t2593, t2596, t2599, t2602, tv3rho2sigma2, t2607;
  double t2610, t2613, t2636, t2642, t2662, t2669, t2673, t2683;
  double t2698, t2703, t2722, t2729, t2734, tv3rho2sigma3, t2736, t2739;
  double t2742, t2745, tv3rho2sigma4, t2750, t2753, t2756, t2759, t2779;
  double t2784, t2805, t2814, t2816, t2826, t2847, t2850, t2860;
  double t2877, t2880, tv3rho2sigma5, t2883, t2885, t2888, t2921, t2924;
  double t2927, t2928, t2948, t2965, t2969, tv3rho2sigma6, tv3rho2sigma7, t2981;
  double t2986, t2988, t2991, t3016, t3021, t3024, t3027, t3030;
  double t3038, t3051, t3060, t3064, t3085, t3093, t3107, t3108;
  double t3112, t3113, t3118, t3121, tv3rho2sigma8, t3124, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t3149, t3154, t3159, t3164, tv3rhosigma25;
  double t3169, t3174, t3179, t3184, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t3190, tv3rhosigma211, t3215, t3217, t3218, t3220, t3222;
  double t3224, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t3227, t3229, t3230, t3232, t3234, t3236;
  double tv3sigma39;

  double t3252, t3254, t3255, t3261, t3266, t3268, t3272, t3276;
  double t3278, t3279, t3285, t3294, t3298, t3311, t3313, t3315;
  double t3317, t3319, t3321, t3323, t3325, t3328, t3330, t3332;
  double t3334, t3337, t3339, t3341, t3358, t3371, t3375, t3376;
  double t3402, t3412, t3432, t3434, t3436, t3437, t3438, t3439;
  double t3440, t3442, t3443, t3444, t3446, t3447, t3448, t3450;
  double t3454, t3456, t3458, t3459, t3461, t3462, t3464, t3466;
  double t3468, t3470, t3476, t3478, t3480, t3482, t3484, t3486;
  double t3491, t3493, t3495, t3497, t3499, t3501, t3502, t3507;
  double t3509, t3511, t3513, t3524, t3526, t3528, t3529, t3530;
  double t3531, t3532, t3533, t3534, t3536, t3537, t3538, t3540;
  double t3542, t3544, t3546, t3548, t3562, t3579, t3581, t3591;
  double tv4rho40, t3595, t3597, t3598, t3599, t3600, t3602, t3603;
  double t3604, t3606, t3607, t3608, t3610, t3611, t3612, t3614;
  double t3616, t3617, t3618, t3619, t3622, t3623, t3627, t3631;
  double t3636, t3642, t3643, t3645, t3647, t3649, t3655, t3681;
  double t3683, t3685, t3687, t3689, t3691, t3693, t3695, t3697;
  double t3699, t3702, t3705, t3731, t3733, t3735, t3737, t3739;
  double t3741, t3743, t3746, t3748, t3750, t3761, t3781, t3802;
  double t3818, t3843, t3871, t3882, t3883, t3884, t3885, t3886;
  double t3887, t3888, t3889, t3900, tv4rho41, t3903, t3905, t3906;
  double t3908, t3910, t3912, t3914, t3916, t3918, t3920, t3926;
  double t3938, t3954, t3995, t4028, t4032, t4041, t4060, t4062;
  double t4065, t4068, t4071, t4073, t4075, t4077, t4079, t4081;
  double t4083, t4085, t4088, t4091, t4094, t4097, t4099, t4101;
  double t4103, t4105, t4108, t4110, t4112, t4136, t4137, t4141;
  double t4169, t4199, t4210, t4212, t4214, t4216, t4227, tv4rho42;
  double t4230, t4232, t4234, t4236, t4238, t4240, t4242, t4244;
  double t4249, t4256, t4261, t4272, t4301, t4305, t4334, t4338;
  double t4357, t4360, t4363, t4365, t4368, t4371, t4373, t4375;
  double t4377, t4379, t4381, t4383, t4386, t4389, t4392, t4395;
  double t4397, t4400, t4427, t4466, t4470, t4496, tv4rho43, t4502;
  double t4526, t4541, t4550, t4559, t4580, t4582, t4585, t4587;
  double t4592, t4598, t4602, t4604, t4610, t4612, t4614, t4616;
  double t4618, t4620, t4622, t4624, t4627, t4629, t4634, t4643;
  double t4645, t4647, t4654, t4678, t4705, t4710, t4738, t4777;
  double tv4rho44, t4780, t4783, t4786, t4820, t4824, t4834, t4846;
  double t4860, t4864, t4873, t4876, t4883, t4887, t4906, t4918;
  double t4924, t4936, t4950, t4960, t4961, t4987, tv4rho3sigma0, t4992;
  double t4994, t4997, t5000, t5002, t5005, t5008, t5010, t5013;
  double t5014, t5015, t5016, t5019, tv4rho3sigma1, t5020, t5026, t5038;
  double t5047, t5055, t5066, t5075, t5080, t5112, t5119, t5142;
  double tv4rho3sigma2, t5144, t5151, t5170, t5189, t5197, t5215, t5224;
  double t5232, t5244, t5255, t5282, t5290, t5305, t5311, t5315;
  double t5326, t5339, t5356, t5377, tv4rho3sigma3, t5380, t5384, t5388;
  double t5392, t5394, tv4rho3sigma4, t5396, t5399, t5411, t5422, t5427;
  double t5447, t5457, t5471, t5474, t5482, t5501, t5526, t5527;
  double t5552, t5554, t5556, t5564, t5582, t5588, t5610, tv4rho3sigma5;
  double t5622, t5634, t5637, t5661, t5672, t5687, t5704, t5713;
  double t5731, t5740, t5747, t5760, t5767, t5785, t5794, t5800;
  double t5822, tv4rho3sigma6, t5825, t5829, t5833, tv4rho3sigma7, t5862, t5872;
  double t5891, t5904, t5912, t5917, t5939, t5946, t5959, t5974;
  double t5975, t5989, t6004, t6009, t6032, t6035, t6043, t6050;
  double t6071, tv4rho3sigma8, t6091, t6100, t6130, t6161, t6179, t6192;
  double tv4rho3sigma9, tv4rho3sigma10, t6235, t6239, t6250, t6254, t6277, t6281;
  double t6289, t6299, t6322, t6347, t6386, t6405, tv4rho3sigma11, t6441;
  double tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, tv4rho2sigma25, t6483, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t6521, tv4rho2sigma211, tv4rho2sigma212, tv4rho2sigma213;
  double tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t6615, tv4rho2sigma217, t6633, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, tv4rhosigma39;
  double tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317;
  double tv4rhosigma318, t6699, tv4rhosigma319, t6726, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43;
  double tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411;
  double tv4sigma412, tv4sigma413, t6738, tv4sigma414;

  gga_xc_th1_params *params;

  assert(p->params != NULL);
  params = (gga_xc_th1_params * )(p->params);

  t1 = params->omega[0];
  t2 = pow(rho[0], 0.1e1 / 0.6e1);
  t3 = t2 * rho[0];
  t4 = pow(rho[1], 0.1e1 / 0.6e1);
  t5 = t4 * rho[1];
  t6 = t3 + t5;
  t8 = params->omega[1];
  t9 = POW_1_3(rho[0]);
  t10 = t9 * rho[0];
  t11 = POW_1_3(rho[1]);
  t12 = t11 * rho[1];
  t13 = t10 + t12;
  t15 = params->omega[2];
  t16 = sqrt(rho[0]);
  t17 = t16 * rho[0];
  t18 = sqrt(rho[1]);
  t19 = t18 * rho[1];
  t20 = t17 + t19;
  t22 = params->omega[3];
  t23 = t9 * t9;
  t24 = t23 * rho[0];
  t25 = t11 * t11;
  t26 = t25 * rho[1];
  t27 = t24 + t26;
  t29 = params->omega[4];
  t30 = t29 * t13;
  t31 = sqrt(sigma[0]);
  t32 = 0.1e1 / t10;
  t33 = t31 * t32;
  t34 = rho[0] - rho[1];
  t35 = rho[0] + rho[1];
  t36 = 0.1e1 / t35;
  t37 = t34 * t36;
  t38 = 0.1e1 + t37;
  t39 = t38 <= p->zeta_threshold;
  t40 = POW_1_3(p->zeta_threshold);
  t41 = t40 * p->zeta_threshold;
  t42 = POW_1_3(t38);
  t44 = my_piecewise3(t39, t41, t42 * t38);
  t45 = M_CBRT2;
  t46 = t45 * t45;
  t47 = t44 * t46;
  t49 = sqrt(sigma[2]);
  t50 = 0.1e1 / t12;
  t51 = t49 * t50;
  t52 = 0.1e1 - t37;
  t53 = t52 <= p->zeta_threshold;
  t54 = POW_1_3(t52);
  t56 = my_piecewise3(t53, t41, t54 * t52);
  t57 = t56 * t46;
  t60 = t33 * t47 / 0.4e1 + t51 * t57 / 0.4e1;
  t63 = params->omega[5];
  t64 = t63 * t20;
  t67 = params->omega[6];
  t68 = t67 * t27;
  t71 = params->omega[7];
  t72 = t2 * t2;
  t73 = t72 * t72;
  t74 = t73 * t2;
  t75 = t74 * rho[0];
  t76 = t4 * t4;
  t77 = t76 * t76;
  t78 = t77 * t4;
  t79 = t78 * rho[1];
  t80 = t75 + t79;
  t81 = t71 * t80;
  t84 = params->omega[8];
  t85 = t84 * t20;
  t86 = rho[0] * rho[0];
  t88 = 0.1e1 / t23 / t86;
  t89 = sigma[0] * t88;
  t90 = t44 * t44;
  t91 = t90 * t45;
  t92 = t89 * t91;
  t93 = rho[1] * rho[1];
  t95 = 0.1e1 / t25 / t93;
  t96 = sigma[2] * t95;
  t97 = t56 * t56;
  t98 = t97 * t45;
  t99 = t96 * t98;
  t101 = t92 / 0.8e1 + t99 / 0.8e1;
  t104 = params->omega[9];
  t105 = t104 * t27;
  t109 = params->omega[10];
  t110 = t109 * t80;
  t113 = params->omega[11];
  t114 = t86 + t93;
  t115 = t113 * t114;
  t118 = params->omega[12];
  t119 = t118 * t20;
  t123 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t124 = t35 * t35;
  t125 = POW_1_3(t35);
  t126 = t125 * t125;
  t128 = 0.1e1 / t126 / t124;
  t130 = t92 / 0.4e1 + t99 / 0.4e1 - t123 * t128;
  t132 = params->omega[13];
  t133 = t132 * t27;
  t135 = params->omega[14];
  t136 = t135 * t80;
  t138 = params->omega[15];
  t139 = t138 * t114;
  t141 = params->omega[16];
  t142 = t141 * t6;
  t143 = t34 * t34;
  t144 = 0.1e1 / t124;
  t145 = t143 * t144;
  t147 = params->omega[17];
  t148 = t147 * t13;
  t150 = params->omega[18];
  t151 = t150 * t20;
  t153 = params->omega[19];
  t154 = t153 * t27;
  t156 = params->omega[20];
  t158 = t110 * t101 / 0.2e1 + t115 * t101 / 0.2e1 + t119 * t130 + t133 * t130 + t136 * t130 + t139 * t130 + t142 * t145 + t148 * t145 + t151 * t145 + t154 * t145 + t156 * t35;
  tzk0 = (t1 * t6 + t8 * t13 + t15 * t20 + t22 * t27 + t30 * t60 / 0.2e1 + t64 * t60 / 0.2e1 + t68 * t60 / 0.2e1 + t81 * t60 / 0.2e1 + t85 * t101 / 0.2e1 + t105 * t101 / 0.2e1 + t158) * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t168 = t86 * rho[0];
  t170 = 0.1e1 / t23 / t168;
  t171 = sigma[0] * t170;
  t172 = t171 * t91;
  t174 = t44 * t45;
  t175 = t34 * t144;
  t176 = t36 - t175;
  t179 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t176);
  t180 = t174 * t179;
  t181 = t89 * t180;
  t183 = t56 * t45;
  t184 = -t176;
  t187 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t184);
  t188 = t183 * t187;
  t189 = t96 * t188;
  t191 = -t172 / 0.3e1 + t181 / 0.4e1 + t189 / 0.4e1;
  t194 = t104 * t23;
  t199 = t109 * t74;
  t204 = t113 * rho[0];
  t209 = t124 * t35;
  t211 = 0.1e1 / t126 / t209;
  t213 = 0.8e1 / 0.3e1 * t123 * t211;
  t214 = -0.2e1 / 0.3e1 * t172 + t181 / 0.2e1 + t189 / 0.2e1 + t213;
  t216 = t118 * t16;
  t220 = t132 * t23;
  t224 = t135 * t74;
  t228 = t138 * rho[0];
  t232 = 0.1e1 / t9 / t86;
  t233 = t31 * t232;
  t236 = t179 * t46;
  t239 = t187 * t46;
  t242 = -t233 * t47 / 0.3e1 + t33 * t236 / 0.4e1 + t51 * t239 / 0.4e1;
  t245 = t156 + 0.7e1 / 0.6e1 * t1 * t2 + 0.4e1 / 0.3e1 * t8 * t9 + 0.3e1 / 0.2e1 * t15 * t16 + 0.5e1 / 0.3e1 * t22 * t23 + t105 * t191 / 0.2e1 + 0.5e1 / 0.6e1 * t194 * t101 + t110 * t191 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t101 + t115 * t191 / 0.2e1 + t204 * t101 + t119 * t214 + 0.3e1 / 0.2e1 * t216 * t130 + t133 * t214 + 0.5e1 / 0.3e1 * t220 * t130 + t136 * t214 + 0.11e2 / 0.6e1 * t224 * t130 + t139 * t214 + 0.2e1 * t228 * t130 + t30 * t242 / 0.2e1;
  t246 = t29 * t9;
  t251 = t63 * t16;
  t256 = t67 * t23;
  t261 = t71 * t74;
  t266 = t84 * t16;
  t270 = 0.2e1 * t142 * t175;
  t272 = 0.1e1 / t209;
  t273 = t143 * t272;
  t275 = 0.2e1 * t142 * t273;
  t277 = 0.2e1 * t148 * t175;
  t279 = 0.2e1 * t148 * t273;
  t281 = 0.2e1 * t151 * t175;
  t283 = 0.2e1 * t151 * t273;
  t285 = 0.2e1 * t154 * t175;
  t287 = 0.2e1 * t154 * t273;
  t288 = t141 * t2;
  t291 = t147 * t9;
  t294 = t150 * t16;
  t297 = t153 * t23;
  t300 = -t275 + t277 - t279 + t281 - t283 + t285 - t287 + 0.7e1 / 0.6e1 * t288 * t145 + 0.4e1 / 0.3e1 * t291 * t145 + 0.3e1 / 0.2e1 * t294 * t145 + 0.5e1 / 0.3e1 * t297 * t145;
  tvrho0 = t245 + 0.2e1 / 0.3e1 * t246 * t60 + t64 * t242 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t60 + t68 * t242 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t60 + t81 * t242 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t60 + t85 * t191 / 0.2e1 + 0.3e1 / 0.4e1 * t266 * t101 + t270 + t300;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t310 = t109 * t78;
  t313 = -t36 - t175;
  t316 = my_piecewise3(t39, 0, 0.4e1 / 0.3e1 * t42 * t313);
  t317 = t174 * t316;
  t318 = t89 * t317;
  t320 = t93 * rho[1];
  t322 = 0.1e1 / t25 / t320;
  t323 = sigma[2] * t322;
  t324 = t323 * t98;
  t326 = -t313;
  t329 = my_piecewise3(t53, 0, 0.4e1 / 0.3e1 * t54 * t326);
  t330 = t183 * t329;
  t331 = t96 * t330;
  t333 = t318 / 0.4e1 - t324 / 0.3e1 + t331 / 0.4e1;
  t336 = t113 * rho[1];
  t341 = t318 / 0.2e1 - 0.2e1 / 0.3e1 * t324 + t331 / 0.2e1 + t213;
  t343 = t118 * t18;
  t347 = t132 * t25;
  t351 = t135 * t78;
  t355 = t138 * rho[1];
  t358 = t316 * t46;
  t362 = 0.1e1 / t11 / t93;
  t363 = t49 * t362;
  t366 = t329 * t46;
  t369 = t33 * t358 / 0.4e1 - t363 * t57 / 0.3e1 + t51 * t366 / 0.4e1;
  t372 = t29 * t11;
  t377 = t63 * t18;
  t380 = t156 + 0.7e1 / 0.6e1 * t1 * t4 + 0.4e1 / 0.3e1 * t8 * t11 + 0.3e1 / 0.2e1 * t15 * t18 + 0.5e1 / 0.3e1 * t22 * t25 + 0.11e2 / 0.12e2 * t310 * t101 + t115 * t333 / 0.2e1 + t336 * t101 + t119 * t341 + 0.3e1 / 0.2e1 * t343 * t130 + t133 * t341 + 0.5e1 / 0.3e1 * t347 * t130 + t136 * t341 + 0.11e2 / 0.6e1 * t351 * t130 + t139 * t341 + 0.2e1 * t355 * t130 + t30 * t369 / 0.2e1 + 0.2e1 / 0.3e1 * t372 * t60 + t64 * t369 / 0.2e1 + 0.3e1 / 0.4e1 * t377 * t60;
  t383 = t67 * t25;
  t388 = t71 * t78;
  t393 = t84 * t18;
  t398 = t104 * t25;
  t404 = t141 * t4;
  t407 = t147 * t11;
  t410 = t150 * t18;
  t413 = t153 * t25;
  t416 = -t275 - t277 - t279 - t281 - t283 - t285 - t287 + 0.7e1 / 0.6e1 * t404 * t145 + 0.4e1 / 0.3e1 * t407 * t145 + 0.3e1 / 0.2e1 * t410 * t145 + 0.5e1 / 0.3e1 * t413 * t145;
  tvrho1 = t380 + t68 * t369 / 0.2e1 + 0.5e1 / 0.6e1 * t383 * t60 + t81 * t369 / 0.2e1 + 0.11e2 / 0.12e2 * t388 * t60 + t85 * t333 / 0.2e1 + 0.3e1 / 0.4e1 * t393 * t101 + t105 * t333 / 0.2e1 + 0.5e1 / 0.6e1 * t398 * t101 + t110 * t333 / 0.2e1 - t270 + t416;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t418 = 0.1e1 / t31;
  t419 = t30 * t418;
  t421 = t32 * t44 * t46;
  t424 = t64 * t418;
  t427 = t68 * t418;
  t430 = t81 * t418;
  t434 = t88 * t90 * t45;
  t444 = t434 / 0.4e1 - t128;
  tvsigma0 = t419 * t421 / 0.16e2 + t424 * t421 / 0.16e2 + t427 * t421 / 0.16e2 + t430 * t421 / 0.16e2 + t85 * t434 / 0.16e2 + t105 * t434 / 0.16e2 + t110 * t434 / 0.16e2 + t115 * t434 / 0.16e2 + t119 * t444 + t133 * t444 + t136 * t444 + t139 * t444;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = -0.2e1 * t119 * t128 - 0.2e1 * t128 * t133 - 0.2e1 * t128 * t136 - 0.2e1 * t128 * t139;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t454 = 0.1e1 / t49;
  t455 = t30 * t454;
  t457 = t50 * t56 * t46;
  t460 = t64 * t454;
  t463 = t68 * t454;
  t466 = t81 * t454;
  t470 = t95 * t97 * t45;
  t480 = t470 / 0.4e1 - t128;
  tvsigma2 = t455 * t457 / 0.16e2 + t460 * t457 / 0.16e2 + t463 * t457 / 0.16e2 + t466 * t457 / 0.16e2 + t85 * t470 / 0.16e2 + t105 * t470 / 0.16e2 + t110 * t470 / 0.16e2 + t115 * t470 / 0.16e2 + t119 * t480 + t133 * t480 + t136 * t480 + t139 * t480;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t488 = 0.1e1 / t9 / t168;
  t489 = t31 * t488;
  t494 = t42 * t42;
  t495 = 0.1e1 / t494;
  t496 = t176 * t176;
  t499 = t34 * t272;
  t501 = -0.2e1 * t144 + 0.2e1 * t499;
  t505 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t495 * t496 + 0.4e1 / 0.3e1 * t42 * t501);
  t506 = t505 * t46;
  t509 = t54 * t54;
  t510 = 0.1e1 / t509;
  t511 = t184 * t184;
  t514 = -t501;
  t518 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t510 * t511 + 0.4e1 / 0.3e1 * t54 * t514);
  t519 = t518 * t46;
  t522 = 0.7e1 / 0.9e1 * t489 * t47 - 0.2e1 / 0.3e1 * t233 * t236 + t33 * t506 / 0.4e1 + t51 * t519 / 0.4e1;
  t535 = t86 * t86;
  t537 = 0.1e1 / t23 / t535;
  t538 = sigma[0] * t537;
  t539 = t538 * t91;
  t541 = t171 * t180;
  t543 = t179 * t179;
  t544 = t543 * t45;
  t545 = t89 * t544;
  t547 = t174 * t505;
  t548 = t89 * t547;
  t550 = t187 * t187;
  t551 = t550 * t45;
  t552 = t96 * t551;
  t554 = t183 * t518;
  t555 = t96 * t554;
  t557 = 0.11e2 / 0.9e1 * t539 - 0.4e1 / 0.3e1 * t541 + t545 / 0.4e1 + t548 / 0.4e1 + t552 / 0.4e1 + t555 / 0.4e1;
  t580 = t124 * t124;
  t582 = 0.1e1 / t126 / t580;
  t584 = 0.88e2 / 0.9e1 * t123 * t582;
  t585 = 0.22e2 / 0.9e1 * t539 - 0.8e1 / 0.3e1 * t541 + t545 / 0.2e1 + t548 / 0.2e1 + t552 / 0.2e1 + t555 / 0.2e1 - t584;
  t587 = 0.4e1 / 0.3e1 * t246 * t242 + t64 * t522 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t242 + t68 * t522 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t242 + t81 * t522 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t242 + t85 * t557 / 0.2e1 + 0.3e1 / 0.2e1 * t266 * t191 + t105 * t557 / 0.2e1 + 0.5e1 / 0.3e1 * t194 * t191 + t110 * t557 / 0.2e1 + 0.11e2 / 0.6e1 * t199 * t191 + t115 * t557 / 0.2e1 + 0.2e1 * t204 * t191 + t119 * t585;
  t599 = 0.1e1 / t23;
  t600 = t29 * t599;
  t603 = 0.1e1 / t16;
  t604 = t63 * t603;
  t607 = 0.1e1 / t9;
  t608 = t67 * t607;
  t611 = 0.1e1 / t2;
  t612 = t71 * t611;
  t615 = t84 * t603;
  t618 = t104 * t607;
  t621 = t109 * t611;
  t624 = t118 * t603;
  t627 = t132 * t607;
  t630 = 0.3e1 * t216 * t214 + t133 * t585 + 0.1e2 / 0.3e1 * t220 * t214 + t136 * t585 + 0.11e2 / 0.3e1 * t224 * t214 + t139 * t585 + 0.4e1 * t228 * t214 + 0.2e1 / 0.9e1 * t600 * t60 + 0.3e1 / 0.8e1 * t604 * t60 + 0.5e1 / 0.9e1 * t608 * t60 + 0.55e2 / 0.72e2 * t612 * t60 + 0.3e1 / 0.8e1 * t615 * t101 + 0.5e1 / 0.9e1 * t618 * t101 + 0.55e2 / 0.72e2 * t621 * t101 + 0.3e1 / 0.4e1 * t624 * t130 + 0.1e2 / 0.9e1 * t627 * t130;
  t632 = t135 * t611;
  t636 = 0.2e1 * t142 * t144;
  t638 = 0.2e1 * t148 * t144;
  t640 = 0.2e1 * t151 * t144;
  t642 = 0.2e1 * t154 * t144;
  t643 = t113 * t101;
  t645 = 0.2e1 * t138 * t130;
  t646 = 0.1e1 / t74;
  t658 = 0.8e1 * t154 * t499;
  t659 = 0.1e1 / t580;
  t660 = t143 * t659;
  t662 = 0.6e1 * t154 * t660;
  t663 = t141 * t646;
  t666 = t288 * t175;
  t668 = 0.55e2 / 0.36e2 * t632 * t130 + t636 + t638 + t640 + t642 + t643 + t645 + 0.7e1 / 0.36e2 * t1 * t646 + 0.4e1 / 0.9e1 * t8 * t599 + 0.3e1 / 0.4e1 * t15 * t603 + 0.1e2 / 0.9e1 * t22 * t607 + t30 * t522 / 0.2e1 - t658 + t662 + 0.7e1 / 0.36e2 * t663 * t145 + 0.14e2 / 0.3e1 * t666;
  t669 = t288 * t273;
  t671 = t147 * t599;
  t674 = t291 * t175;
  t676 = t291 * t273;
  t678 = t150 * t603;
  t681 = t294 * t175;
  t683 = t294 * t273;
  t685 = t153 * t607;
  t688 = t297 * t175;
  t690 = t297 * t273;
  t693 = 0.8e1 * t142 * t499;
  t695 = 0.6e1 * t142 * t660;
  t697 = 0.8e1 * t148 * t499;
  t699 = 0.6e1 * t148 * t660;
  t701 = 0.8e1 * t151 * t499;
  t703 = 0.6e1 * t151 * t660;
  t704 = -0.14e2 / 0.3e1 * t669 + 0.4e1 / 0.9e1 * t671 * t145 + 0.16e2 / 0.3e1 * t674 - 0.16e2 / 0.3e1 * t676 + 0.3e1 / 0.4e1 * t678 * t145 + 0.6e1 * t681 - 0.6e1 * t683 + 0.1e2 / 0.9e1 * t685 * t145 + 0.2e2 / 0.3e1 * t688 - 0.2e2 / 0.3e1 * t690 - t693 + t695 - t697 + t699 - t701 + t703;
  tv2rho20 = t587 + t630 + t668 + t704;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t706 = t171 * t317;
  t708 = t179 * t45;
  t709 = t708 * t316;
  t710 = t89 * t709;
  t712 = t495 * t313;
  t715 = t42 * t34;
  t719 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t712 * t176 + 0.8e1 / 0.3e1 * t715 * t272);
  t720 = t174 * t719;
  t721 = t89 * t720;
  t723 = t323 * t188;
  t725 = t187 * t45;
  t726 = t725 * t329;
  t727 = t96 * t726;
  t729 = t510 * t326;
  t732 = t54 * t34;
  t736 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t729 * t184 - 0.8e1 / 0.3e1 * t732 * t272);
  t737 = t183 * t736;
  t738 = t96 * t737;
  t740 = -0.4e1 / 0.3e1 * t706 + t710 / 0.2e1 + t721 / 0.2e1 - 0.4e1 / 0.3e1 * t723 + t727 / 0.2e1 + t738 / 0.2e1 - t584;
  t753 = t719 * t46;
  t758 = t736 * t46;
  t761 = -t233 * t358 / 0.3e1 + t33 * t753 / 0.4e1 - t363 * t239 / 0.3e1 + t51 * t758 / 0.4e1;
  t780 = t136 * t740 + 0.11e2 / 0.6e1 * t224 * t341 + 0.11e2 / 0.6e1 * t351 * t214 + t139 * t740 + 0.2e1 * t228 * t341 + 0.2e1 * t355 * t214 + t30 * t761 / 0.2e1 + 0.2e1 / 0.3e1 * t246 * t369 + 0.2e1 / 0.3e1 * t372 * t242 + t64 * t761 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t369 + 0.3e1 / 0.4e1 * t377 * t242 + t68 * t761 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t369 + 0.5e1 / 0.6e1 * t383 * t242;
  t793 = -0.2e1 / 0.3e1 * t706 + t710 / 0.4e1 + t721 / 0.4e1 - 0.2e1 / 0.3e1 * t723 + t727 / 0.4e1 + t738 / 0.4e1;
  t816 = t81 * t761 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t369 + 0.11e2 / 0.12e2 * t388 * t242 + t85 * t793 / 0.2e1 + 0.3e1 / 0.4e1 * t266 * t333 + 0.3e1 / 0.4e1 * t393 * t191 + t105 * t793 / 0.2e1 + 0.5e1 / 0.6e1 * t194 * t333 + 0.5e1 / 0.6e1 * t398 * t191 + t110 * t793 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t333 + 0.11e2 / 0.12e2 * t310 * t191 + t115 * t793 / 0.2e1 + t204 * t333 + t336 * t191;
  t832 = t119 * t740 + 0.3e1 / 0.2e1 * t216 * t341 + 0.3e1 / 0.2e1 * t343 * t214 + t133 * t740 + 0.5e1 / 0.3e1 * t220 * t341 + 0.5e1 / 0.3e1 * t347 * t214 - t636 - t638 - t640 - t642 + t662 - 0.7e1 / 0.3e1 * t666 - 0.7e1 / 0.3e1 * t669 - 0.8e1 / 0.3e1 * t674 - 0.8e1 / 0.3e1 * t676;
  t837 = t404 * t175;
  t839 = t404 * t273;
  t841 = t407 * t175;
  t843 = t407 * t273;
  t845 = t410 * t175;
  t847 = t410 * t273;
  t849 = t413 * t175;
  t851 = t413 * t273;
  t853 = -0.3e1 * t681 - 0.3e1 * t683 - 0.1e2 / 0.3e1 * t688 - 0.1e2 / 0.3e1 * t690 + t695 + t699 + t703 + 0.7e1 / 0.3e1 * t837 - 0.7e1 / 0.3e1 * t839 + 0.8e1 / 0.3e1 * t841 - 0.8e1 / 0.3e1 * t843 + 0.3e1 * t845 - 0.3e1 * t847 + 0.1e2 / 0.3e1 * t849 - 0.1e2 / 0.3e1 * t851;
  tv2rho21 = t780 + t816 + t832 + t853;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t857 = t316 * t316;
  t858 = t857 * t45;
  t859 = t89 * t858;
  t861 = t313 * t313;
  t865 = 0.2e1 * t144 + 0.2e1 * t499;
  t869 = my_piecewise3(t39, 0, 0.4e1 / 0.9e1 * t495 * t861 + 0.4e1 / 0.3e1 * t42 * t865);
  t870 = t174 * t869;
  t871 = t89 * t870;
  t873 = t93 * t93;
  t875 = 0.1e1 / t25 / t873;
  t876 = sigma[2] * t875;
  t877 = t876 * t98;
  t879 = t323 * t330;
  t881 = t329 * t329;
  t882 = t881 * t45;
  t883 = t96 * t882;
  t885 = t326 * t326;
  t888 = -t865;
  t892 = my_piecewise3(t53, 0, 0.4e1 / 0.9e1 * t510 * t885 + 0.4e1 / 0.3e1 * t54 * t888);
  t893 = t183 * t892;
  t894 = t96 * t893;
  t896 = t859 / 0.2e1 + t871 / 0.2e1 + 0.22e2 / 0.9e1 * t877 - 0.8e1 / 0.3e1 * t879 + t883 / 0.2e1 + t894 / 0.2e1 - t584;
  t900 = 0.1e1 / t4;
  t901 = t135 * t900;
  t904 = 0.1e1 / t25;
  t905 = t29 * t904;
  t908 = 0.1e1 / t18;
  t909 = t63 * t908;
  t912 = 0.1e1 / t11;
  t913 = t67 * t912;
  t916 = t71 * t900;
  t919 = t84 * t908;
  t922 = t104 * t912;
  t925 = t109 * t900;
  t928 = t118 * t908;
  t931 = t132 * t912;
  t934 = t869 * t46;
  t938 = 0.1e1 / t11 / t320;
  t939 = t49 * t938;
  t944 = t892 * t46;
  t947 = t33 * t934 / 0.4e1 + 0.7e1 / 0.9e1 * t939 * t57 - 0.2e1 / 0.3e1 * t363 * t366 + t51 * t944 / 0.4e1;
  t954 = 0.11e2 / 0.3e1 * t351 * t341 + t139 * t896 + 0.4e1 * t355 * t341 + 0.55e2 / 0.36e2 * t901 * t130 + 0.2e1 / 0.9e1 * t905 * t60 + 0.3e1 / 0.8e1 * t909 * t60 + 0.5e1 / 0.9e1 * t913 * t60 + 0.55e2 / 0.72e2 * t916 * t60 + 0.3e1 / 0.8e1 * t919 * t101 + 0.5e1 / 0.9e1 * t922 * t101 + 0.55e2 / 0.72e2 * t925 * t101 + 0.3e1 / 0.4e1 * t928 * t130 + 0.1e2 / 0.9e1 * t931 * t130 + t30 * t947 / 0.2e1 + 0.4e1 / 0.3e1 * t372 * t369 + t64 * t947 / 0.2e1;
  t971 = t859 / 0.4e1 + t871 / 0.4e1 + 0.11e2 / 0.9e1 * t877 - 0.4e1 / 0.3e1 * t879 + t883 / 0.4e1 + t894 / 0.4e1;
  t992 = 0.3e1 / 0.2e1 * t377 * t369 + t68 * t947 / 0.2e1 + 0.5e1 / 0.3e1 * t383 * t369 + t81 * t947 / 0.2e1 + 0.11e2 / 0.6e1 * t388 * t369 + t85 * t971 / 0.2e1 + 0.3e1 / 0.2e1 * t393 * t333 + t105 * t971 / 0.2e1 + 0.5e1 / 0.3e1 * t398 * t333 + t110 * t971 / 0.2e1 + 0.11e2 / 0.6e1 * t310 * t333 + t115 * t971 / 0.2e1 + 0.2e1 * t336 * t333 + t119 * t896 + 0.3e1 * t343 * t341 + t133 * t896;
  t997 = 0.1e1 / t78;
  t1006 = 0.1e2 / 0.3e1 * t347 * t341 + t136 * t896 + t636 + t638 + t640 + t642 + 0.7e1 / 0.36e2 * t1 * t997 + 0.4e1 / 0.9e1 * t8 * t904 + 0.3e1 / 0.4e1 * t15 * t908 + 0.1e2 / 0.9e1 * t22 * t912 + t643 + t645 + t658 + t662 + t693 + t695;
  t1015 = t141 * t997;
  t1018 = t147 * t904;
  t1021 = t150 * t908;
  t1024 = t153 * t912;
  t1027 = t697 + t699 + t701 + t703 - 0.14e2 / 0.3e1 * t837 - 0.14e2 / 0.3e1 * t839 - 0.16e2 / 0.3e1 * t841 - 0.16e2 / 0.3e1 * t843 - 0.6e1 * t845 - 0.6e1 * t847 - 0.2e2 / 0.3e1 * t849 - 0.2e2 / 0.3e1 * t851 + 0.7e1 / 0.36e2 * t1015 * t145 + 0.4e1 / 0.9e1 * t1018 * t145 + 0.3e1 / 0.4e1 * t1021 * t145 + 0.1e2 / 0.9e1 * t1024 * t145;
  tv2rho22 = t954 + t992 + t1006 + t1027;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1030 = t170 * t90 * t45;
  t1032 = t88 * t44;
  t1035 = 0.8e1 / 0.3e1 * t211;
  t1036 = -0.2e1 / 0.3e1 * t1030 + t1032 * t708 / 0.2e1 + t1035;
  t1050 = t29 / rho[0];
  t1052 = t418 * t44 * t46;
  t1055 = t63 * t646;
  t1058 = t67 * t599;
  t1061 = t71 * t603;
  t1072 = t119 * t1036 + 0.3e1 / 0.2e1 * t216 * t444 + t133 * t1036 + 0.5e1 / 0.3e1 * t220 * t444 + t136 * t1036 + 0.11e2 / 0.6e1 * t224 * t444 + t139 * t1036 + 0.2e1 * t228 * t444 + t1050 * t1052 / 0.12e2 + 0.3e1 / 0.32e2 * t1055 * t1052 + 0.5e1 / 0.48e2 * t1058 * t1052 + 0.11e2 / 0.96e2 * t1061 * t1052 - t110 * t1030 / 0.6e1 - t115 * t1030 / 0.6e1 - t85 * t1030 / 0.6e1 - t105 * t1030 / 0.6e1;
  t1074 = 0.1e1 / t2 / t86;
  t1075 = t84 * t1074;
  t1078 = 0.1e1 / t86;
  t1079 = t104 * t1078;
  t1082 = 0.1e1 / t75;
  t1083 = t109 * t1082;
  t1086 = 0.1e1 / t24;
  t1087 = t113 * t1086;
  t1090 = t110 * t88;
  t1093 = t115 * t88;
  t1097 = t32 * t179 * t46;
  t1106 = t85 * t88;
  t1109 = t105 * t88;
  t1113 = t232 * t44 * t46;
  t1122 = 0.3e1 / 0.32e2 * t1075 * t91 + 0.5e1 / 0.48e2 * t1079 * t91 + 0.11e2 / 0.96e2 * t1083 * t91 + t1087 * t91 / 0.8e1 + t1090 * t180 / 0.8e1 + t1093 * t180 / 0.8e1 + t419 * t1097 / 0.16e2 + t424 * t1097 / 0.16e2 + t427 * t1097 / 0.16e2 + t430 * t1097 / 0.16e2 + t1106 * t180 / 0.8e1 + t1109 * t180 / 0.8e1 - t424 * t1113 / 0.12e2 - t427 * t1113 / 0.12e2 - t430 * t1113 / 0.12e2 - t419 * t1113 / 0.12e2;
  tv2rhosigma0 = t1072 + t1122;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1126 = 0.16e2 / 0.3e1 * t119 * t211;
  t1130 = 0.16e2 / 0.3e1 * t133 * t211;
  t1134 = 0.16e2 / 0.3e1 * t136 * t211;
  t1138 = 0.16e2 / 0.3e1 * t139 * t211;
  tv2rhosigma1 = -0.3e1 * t216 * t128 + t1126 - 0.1e2 / 0.3e1 * t220 * t128 + t1130 - 0.11e2 / 0.3e1 * t224 * t128 + t1134 - 0.4e1 * t228 * t128 + t1138;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1139 = t246 * t454;
  t1143 = t50 * t187 * t46;
  t1146 = t251 * t454;
  t1151 = t256 * t454;
  t1156 = t261 * t454;
  t1163 = t85 * t95;
  t1168 = t105 * t95;
  t1171 = t1139 * t457 / 0.12e2 + t455 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t457 + t460 * t1143 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t457 + t463 * t1143 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t457 + t466 * t1143 / 0.16e2 + 0.3e1 / 0.32e2 * t266 * t470 + t1163 * t188 / 0.8e1 + 0.5e1 / 0.48e2 * t194 * t470 + t1168 * t188 / 0.8e1;
  t1174 = t110 * t95;
  t1179 = t115 * t95;
  t1184 = t95 * t56;
  t1187 = t1184 * t725 / 0.2e1 + t1035;
  t1198 = 0.11e2 / 0.96e2 * t199 * t470 + t1174 * t188 / 0.8e1 + t204 * t470 / 0.8e1 + t1179 * t188 / 0.8e1 + 0.3e1 / 0.2e1 * t216 * t480 + t119 * t1187 + 0.5e1 / 0.3e1 * t220 * t480 + t133 * t1187 + 0.11e2 / 0.6e1 * t224 * t480 + t136 * t1187 + 0.2e1 * t228 * t480 + t139 * t1187;
  tv2rhosigma2 = t1171 + t1198;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1199 = t372 * t418;
  t1203 = t32 * t316 * t46;
  t1206 = t377 * t418;
  t1211 = t383 * t418;
  t1216 = t388 * t418;
  t1229 = t1199 * t421 / 0.12e2 + t419 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t421 + t424 * t1203 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t421 + t427 * t1203 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t421 + t430 * t1203 / 0.16e2 + 0.3e1 / 0.32e2 * t393 * t434 + t1106 * t317 / 0.8e1 + 0.5e1 / 0.48e2 * t398 * t434 + t1109 * t317 / 0.8e1;
  t1240 = t45 * t316;
  t1243 = t1032 * t1240 / 0.2e1 + t1035;
  t1254 = 0.11e2 / 0.96e2 * t310 * t434 + t1090 * t317 / 0.8e1 + t336 * t434 / 0.8e1 + t1093 * t317 / 0.8e1 + 0.3e1 / 0.2e1 * t343 * t444 + t119 * t1243 + 0.5e1 / 0.3e1 * t347 * t444 + t133 * t1243 + 0.11e2 / 0.6e1 * t351 * t444 + t136 * t1243 + 0.2e1 * t355 * t444 + t139 * t1243;
  tv2rhosigma3 = t1229 + t1254;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = -0.3e1 * t343 * t128 + t1126 - 0.1e2 / 0.3e1 * t347 * t128 + t1130 - 0.11e2 / 0.3e1 * t351 * t128 + t1134 - 0.4e1 * t355 * t128 + t1138;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1264 = t322 * t97 * t45;
  t1266 = t45 * t329;
  t1269 = -0.2e1 / 0.3e1 * t1264 + t1184 * t1266 / 0.2e1 + t1035;
  t1283 = t29 / rho[1];
  t1285 = t454 * t56 * t46;
  t1288 = t63 * t997;
  t1291 = t67 * t904;
  t1294 = t71 * t908;
  t1305 = t119 * t1269 + 0.3e1 / 0.2e1 * t343 * t480 + t133 * t1269 + 0.5e1 / 0.3e1 * t347 * t480 + t136 * t1269 + 0.11e2 / 0.6e1 * t351 * t480 + t139 * t1269 + 0.2e1 * t355 * t480 + t1283 * t1285 / 0.12e2 + 0.3e1 / 0.32e2 * t1288 * t1285 + 0.5e1 / 0.48e2 * t1291 * t1285 + 0.11e2 / 0.96e2 * t1294 * t1285 - t105 * t1264 / 0.6e1 - t110 * t1264 / 0.6e1 - t115 * t1264 / 0.6e1 - t85 * t1264 / 0.6e1;
  t1307 = 0.1e1 / t4 / t93;
  t1308 = t84 * t1307;
  t1311 = 0.1e1 / t93;
  t1312 = t104 * t1311;
  t1315 = 0.1e1 / t79;
  t1316 = t109 * t1315;
  t1319 = 0.1e1 / t26;
  t1320 = t113 * t1319;
  t1330 = t50 * t329 * t46;
  t1342 = t362 * t56 * t46;
  t1351 = 0.3e1 / 0.32e2 * t1308 * t98 + 0.5e1 / 0.48e2 * t1312 * t98 + 0.11e2 / 0.96e2 * t1316 * t98 + t1320 * t98 / 0.8e1 + t1168 * t330 / 0.8e1 + t1174 * t330 / 0.8e1 + t1179 * t330 / 0.8e1 + t455 * t1330 / 0.16e2 + t460 * t1330 / 0.16e2 + t463 * t1330 / 0.16e2 + t466 * t1330 / 0.16e2 + t1163 * t330 / 0.8e1 - t455 * t1342 / 0.12e2 - t460 * t1342 / 0.12e2 - t463 * t1342 / 0.12e2 - t466 * t1342 / 0.12e2;
  tv2rhosigma5 = t1305 + t1351;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1353 = 0.1e1 / t31 / sigma[0];
  t1354 = t30 * t1353;
  t1356 = t64 * t1353;
  t1358 = t68 * t1353;
  t1360 = t81 * t1353;
  tv2sigma20 = -t1354 * t421 / 0.32e2 - t1356 * t421 / 0.32e2 - t1358 * t421 / 0.32e2 - t1360 * t421 / 0.32e2;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1364 = 0.1e1 / t49 / sigma[2];
  t1365 = t30 * t1364;
  t1367 = t64 * t1364;
  t1369 = t68 * t1364;
  t1371 = t81 * t1364;
  tv2sigma25 = -t1365 * t457 / 0.32e2 - t1367 * t457 / 0.32e2 - t1369 * t457 / 0.32e2 - t1371 * t457 / 0.32e2;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1374 = t535 * rho[0];
  t1376 = 0.1e1 / t23 / t1374;
  t1377 = sigma[0] * t1376;
  t1378 = t1377 * t91;
  t1380 = t538 * t180;
  t1382 = t171 * t544;
  t1384 = t171 * t547;
  t1386 = t708 * t505;
  t1387 = t89 * t1386;
  t1390 = 0.1e1 / t494 / t38;
  t1391 = t496 * t176;
  t1394 = t495 * t176;
  t1397 = t34 * t659;
  t1399 = 0.6e1 * t272 - 0.6e1 * t1397;
  t1403 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1390 * t1391 + 0.4e1 / 0.3e1 * t1394 * t501 + 0.4e1 / 0.3e1 * t42 * t1399);
  t1404 = t174 * t1403;
  t1405 = t89 * t1404;
  t1407 = t725 * t518;
  t1408 = t96 * t1407;
  t1411 = 0.1e1 / t509 / t52;
  t1412 = t511 * t184;
  t1415 = t510 * t184;
  t1418 = -t1399;
  t1422 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1411 * t1412 + 0.4e1 / 0.3e1 * t1415 * t514 + 0.4e1 / 0.3e1 * t54 * t1418);
  t1423 = t183 * t1422;
  t1424 = t96 * t1423;
  t1426 = -0.154e3 / 0.27e2 * t1378 + 0.22e2 / 0.3e1 * t1380 - 0.2e1 * t1382 - 0.2e1 * t1384 + 0.3e1 / 0.4e1 * t1387 + t1405 / 0.4e1 + 0.3e1 / 0.4e1 * t1408 + t1424 / 0.4e1;
  t1447 = t580 * t35;
  t1449 = 0.1e1 / t126 / t1447;
  t1451 = 0.1232e4 / 0.27e2 * t123 * t1449;
  t1452 = -0.308e3 / 0.27e2 * t1378 + 0.44e2 / 0.3e1 * t1380 - 0.4e1 * t1382 - 0.4e1 * t1384 + 0.3e1 / 0.2e1 * t1387 + t1405 / 0.2e1 + 0.3e1 / 0.2e1 * t1408 + t1424 / 0.2e1 + t1451;
  t1466 = t288 * t144;
  t1468 = t291 * t144;
  t1470 = t294 * t144;
  t1472 = t297 * t144;
  t1480 = t136 * t1452 + 0.11e2 / 0.2e1 * t224 * t585 + t139 * t1452 + 0.6e1 * t228 * t585 + 0.7e1 * t1466 + 0.8e1 * t1468 + 0.9e1 * t1470 + 0.1e2 * t1472 + 0.2e1 / 0.3e1 * t600 * t242 + 0.9e1 / 0.8e1 * t604 * t242 + 0.5e1 / 0.3e1 * t608 * t242;
  t1496 = t29 * t1086;
  t1499 = 0.1e1 / t17;
  t1500 = t63 * t1499;
  t1503 = t67 * t32;
  t1506 = 0.1e1 / t3;
  t1507 = t71 * t1506;
  t1510 = 0.55e2 / 0.24e2 * t612 * t242 + 0.9e1 / 0.8e1 * t615 * t191 + 0.5e1 / 0.3e1 * t618 * t191 + 0.55e2 / 0.24e2 * t621 * t191 + 0.9e1 / 0.4e1 * t624 * t214 + 0.1e2 / 0.3e1 * t627 * t214 + 0.55e2 / 0.12e2 * t632 * t214 - 0.4e1 / 0.27e2 * t1496 * t60 - 0.3e1 / 0.16e2 * t1500 * t60 - 0.5e1 / 0.27e2 * t1503 * t60 - 0.55e2 / 0.432e3 * t1507 * t60;
  t1511 = t84 * t1499;
  t1514 = t104 * t32;
  t1517 = t109 * t1506;
  t1520 = t118 * t1499;
  t1523 = t132 * t32;
  t1526 = t135 * t1506;
  t1529 = t142 * t272;
  t1530 = 0.12e2 * t1529;
  t1531 = t148 * t272;
  t1532 = 0.12e2 * t1531;
  t1534 = 0.1e1 / t9 / t535;
  t1535 = t31 * t1534;
  t1541 = t1403 * t46;
  t1544 = t1422 * t46;
  t1547 = -0.7e2 / 0.27e2 * t1535 * t47 + 0.7e1 / 0.3e1 * t489 * t236 - t233 * t506 + t33 * t1541 / 0.4e1 + t51 * t1544 / 0.4e1;
  t1554 = -0.3e1 / 0.16e2 * t1511 * t101 - 0.5e1 / 0.27e2 * t1514 * t101 - 0.55e2 / 0.432e3 * t1517 * t101 - 0.3e1 / 0.8e1 * t1520 * t130 - 0.1e2 / 0.27e2 * t1523 * t130 - 0.55e2 / 0.216e3 * t1526 * t130 - t1530 - t1532 + t30 * t1547 / 0.2e1 + 0.2e1 * t246 * t522 + t64 * t1547 / 0.2e1;
  t1571 = t151 * t272;
  t1572 = 0.12e2 * t1571;
  t1573 = t154 * t272;
  t1574 = 0.12e2 * t1573;
  t1584 = t113 * t191;
  t1586 = t138 * t214;
  t1588 = 0.1e1 / t1447;
  t1589 = t143 * t1588;
  t1591 = 0.24e2 * t154 * t1589;
  t1592 = t288 * t499;
  t1594 = t288 * t660;
  t1596 = t147 * t1086;
  t1599 = t671 * t175;
  t1601 = t671 * t273;
  t1603 = -0.8e1 / 0.27e2 * t8 * t1086 - 0.3e1 / 0.8e1 * t15 * t1499 - 0.1e2 / 0.27e2 * t22 * t32 + 0.3e1 * t1584 + 0.6e1 * t1586 - t1591 - 0.28e2 * t1592 + 0.21e2 * t1594 - 0.8e1 / 0.27e2 * t1596 * t145 + 0.8e1 / 0.3e1 * t1599 - 0.8e1 / 0.3e1 * t1601;
  t1605 = t291 * t499;
  t1607 = t291 * t660;
  t1609 = t150 * t1499;
  t1612 = t678 * t175;
  t1614 = t678 * t273;
  t1616 = t294 * t499;
  t1618 = t294 * t660;
  t1620 = t153 * t32;
  t1623 = t685 * t175;
  t1625 = t685 * t273;
  t1627 = t297 * t499;
  t1629 = -0.32e2 * t1605 + 0.24e2 * t1607 - 0.3e1 / 0.8e1 * t1609 * t145 + 0.9e1 / 0.2e1 * t1612 - 0.9e1 / 0.2e1 * t1614 - 0.36e2 * t1616 + 0.27e2 * t1618 - 0.1e2 / 0.27e2 * t1620 * t145 + 0.2e2 / 0.3e1 * t1623 - 0.2e2 / 0.3e1 * t1625 - 0.4e2 * t1627;
  t1630 = t297 * t660;
  t1632 = t142 * t1397;
  t1633 = 0.36e2 * t1632;
  t1635 = 0.24e2 * t142 * t1589;
  t1636 = t148 * t1397;
  t1637 = 0.36e2 * t1636;
  t1639 = 0.24e2 * t148 * t1589;
  t1640 = t151 * t1397;
  t1641 = 0.36e2 * t1640;
  t1643 = 0.24e2 * t151 * t1589;
  t1644 = t154 * t1397;
  t1645 = 0.36e2 * t1644;
  t1646 = t141 * t1082;
  t1649 = t663 * t175;
  t1651 = t663 * t273;
  t1653 = 0.3e2 * t1630 + t1633 - t1635 + t1637 - t1639 + t1641 - t1643 + t1645 - 0.35e2 / 0.216e3 * t1646 * t145 + 0.7e1 / 0.6e1 * t1649 - 0.7e1 / 0.6e1 * t1651;
  tv3rho30 = 0.9e1 / 0.4e1 * t266 * t557 - 0.35e2 / 0.216e3 * t1 * t1082 + 0.5e1 * t220 * t585 + t105 * t1426 / 0.2e1 + 0.5e1 / 0.2e1 * t194 * t557 + t110 * t1426 / 0.2e1 + 0.11e2 / 0.4e1 * t199 * t557 + t115 * t1426 / 0.2e1 + 0.3e1 * t204 * t557 + t119 * t1452 + 0.9e1 / 0.2e1 * t216 * t585 + t133 * t1452 + 0.9e1 / 0.4e1 * t251 * t522 + t68 * t1547 / 0.2e1 + 0.5e1 / 0.2e1 * t256 * t522 + t81 * t1547 / 0.2e1 + 0.11e2 / 0.4e1 * t261 * t522 + t85 * t1426 / 0.2e1 + t1653 + t1629 + t1603 - t1574 - t1572 + t1554 + t1510 + t1480;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1658 = t538 * t317;
  t1660 = t171 * t709;
  t1662 = t171 * t720;
  t1664 = t505 * t45;
  t1665 = t1664 * t316;
  t1666 = t89 * t1665;
  t1668 = t708 * t719;
  t1669 = t89 * t1668;
  t1670 = t1390 * t313;
  t1673 = t495 * t34;
  t1684 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1670 * t496 + 0.16e2 / 0.9e1 * t1673 * t272 * t176 + 0.4e1 / 0.9e1 * t712 * t501 + 0.8e1 / 0.3e1 * t42 * t272 - 0.8e1 * t715 * t659);
  t1685 = t174 * t1684;
  t1686 = t89 * t1685;
  t1688 = t323 * t551;
  t1690 = t323 * t554;
  t1692 = t518 * t45;
  t1693 = t1692 * t329;
  t1694 = t96 * t1693;
  t1696 = t725 * t736;
  t1697 = t96 * t1696;
  t1698 = t1411 * t326;
  t1701 = t510 * t34;
  t1712 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1698 * t511 - 0.16e2 / 0.9e1 * t1701 * t272 * t184 + 0.4e1 / 0.9e1 * t729 * t514 - 0.8e1 / 0.3e1 * t54 * t272 + 0.8e1 * t732 * t659);
  t1713 = t183 * t1712;
  t1714 = t96 * t1713;
  t1716 = 0.44e2 / 0.9e1 * t1658 - 0.8e1 / 0.3e1 * t1660 - 0.8e1 / 0.3e1 * t1662 + t1666 / 0.2e1 + t1669 + t1686 / 0.2e1 - 0.4e1 / 0.3e1 * t1688 - 0.4e1 / 0.3e1 * t1690 + t1694 / 0.2e1 + t1697 + t1714 / 0.2e1 + t1451;
  t1726 = t1684 * t46;
  t1731 = t1712 * t46;
  t1734 = 0.7e1 / 0.9e1 * t489 * t358 - 0.2e1 / 0.3e1 * t233 * t753 + t33 * t1726 / 0.4e1 - t363 * t519 / 0.3e1 + t51 * t1731 / 0.4e1;
  t1749 = 0.11e2 / 0.6e1 * t351 * t585 + t139 * t1716 + 0.4e1 * t228 * t740 + 0.2e1 * t355 * t585 + t30 * t1734 / 0.2e1 + 0.4e1 / 0.3e1 * t246 * t761 + 0.2e1 / 0.3e1 * t372 * t522 + t64 * t1734 / 0.2e1 + 0.3e1 / 0.2e1 * t251 * t761 + 0.3e1 / 0.4e1 * t377 * t522 + t68 * t1734 / 0.2e1;
  t1771 = 0.22e2 / 0.9e1 * t1658 - 0.4e1 / 0.3e1 * t1660 - 0.4e1 / 0.3e1 * t1662 + t1666 / 0.4e1 + t1669 / 0.2e1 + t1686 / 0.4e1 - 0.2e1 / 0.3e1 * t1688 - 0.2e1 / 0.3e1 * t1690 + t1694 / 0.4e1 + t1697 / 0.2e1 + t1714 / 0.4e1;
  t1784 = 0.5e1 / 0.3e1 * t256 * t761 + 0.5e1 / 0.6e1 * t383 * t522 + t81 * t1734 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t761 + 0.11e2 / 0.12e2 * t388 * t522 + t85 * t1771 / 0.2e1 + 0.3e1 / 0.2e1 * t266 * t793 + 0.3e1 / 0.4e1 * t393 * t557 + t105 * t1771 / 0.2e1 + 0.5e1 / 0.3e1 * t194 * t793 + 0.5e1 / 0.6e1 * t398 * t557;
  t1805 = t110 * t1771 / 0.2e1 + 0.11e2 / 0.6e1 * t199 * t793 + 0.11e2 / 0.12e2 * t310 * t557 + t115 * t1771 / 0.2e1 + 0.2e1 * t204 * t793 + t336 * t557 + t119 * t1716 + 0.3e1 * t216 * t740 + 0.3e1 / 0.2e1 * t343 * t585 + t133 * t1716 + 0.1e2 / 0.3e1 * t220 * t740;
  t1815 = t413 * t144;
  t1823 = 0.5e1 / 0.3e1 * t347 * t585 + t136 * t1716 + 0.11e2 / 0.3e1 * t224 * t740 - 0.14e2 / 0.3e1 * t1466 - 0.16e2 / 0.3e1 * t1468 - 0.6e1 * t1470 - 0.2e2 / 0.3e1 * t1472 + 0.1e2 / 0.3e1 * t1815 + 0.2e1 / 0.9e1 * t600 * t369 + 0.3e1 / 0.8e1 * t604 * t369 + 0.5e1 / 0.9e1 * t608 * t369;
  t1840 = t404 * t144;
  t1842 = t407 * t144;
  t1844 = t410 * t144;
  t1846 = 0.4e1 * t1529;
  t1847 = 0.55e2 / 0.72e2 * t612 * t369 + 0.3e1 / 0.8e1 * t615 * t333 + 0.5e1 / 0.9e1 * t618 * t333 + 0.55e2 / 0.72e2 * t621 * t333 + 0.3e1 / 0.4e1 * t624 * t341 + 0.1e2 / 0.9e1 * t627 * t341 + 0.55e2 / 0.36e2 * t632 * t341 + 0.7e1 / 0.3e1 * t1840 + 0.8e1 / 0.3e1 * t1842 + 0.3e1 * t1844 + t1846;
  t1848 = 0.4e1 * t1531;
  t1849 = 0.4e1 * t1571;
  t1850 = 0.4e1 * t1573;
  t1851 = t113 * t333;
  t1852 = t138 * t341;
  t1859 = t1848 + t1849 + t1850 + t1851 + 0.2e1 * t1852 - t1591 + 0.14e2 * t1594 - 0.8e1 / 0.9e1 * t1599 - 0.8e1 / 0.9e1 * t1601 + 0.16e2 * t1607 - 0.3e1 / 0.2e1 * t1612;
  t1866 = 0.12e2 * t1632;
  t1867 = 0.12e2 * t1636;
  t1868 = 0.12e2 * t1640;
  t1869 = -0.3e1 / 0.2e1 * t1614 + 0.18e2 * t1618 - 0.2e2 / 0.9e1 * t1623 - 0.2e2 / 0.9e1 * t1625 + 0.2e2 * t1630 + t1866 - t1635 + t1867 - t1639 + t1868 - t1643;
  t1870 = 0.12e2 * t1644;
  t1873 = t404 * t499;
  t1875 = t404 * t660;
  t1877 = t407 * t499;
  t1879 = t407 * t660;
  t1881 = t410 * t499;
  t1883 = t410 * t660;
  t1885 = t413 * t499;
  t1887 = t413 * t660;
  t1889 = t1870 - 0.7e1 / 0.18e2 * t1649 - 0.7e1 / 0.18e2 * t1651 - 0.28e2 / 0.3e1 * t1873 + 0.7e1 * t1875 - 0.32e2 / 0.3e1 * t1877 + 0.8e1 * t1879 - 0.12e2 * t1881 + 0.9e1 * t1883 - 0.4e2 / 0.3e1 * t1885 + 0.1e2 * t1887;
  tv3rho31 = t1749 + t1784 + t1805 + t1823 + t1847 + t1859 + t1869 + t1889;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1894 = t171 * t858;
  t1896 = t1240 * t719;
  t1897 = t89 * t1896;
  t1898 = t171 * t870;
  t1900 = t708 * t869;
  t1901 = t89 * t1900;
  t1903 = t1390 * t861;
  t1908 = t495 * t865;
  t1913 = -0.2e1 * t272 - 0.6e1 * t1397;
  t1917 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1903 * t176 + 0.16e2 / 0.9e1 * t712 * t499 + 0.4e1 / 0.9e1 * t1908 * t176 + 0.4e1 / 0.3e1 * t42 * t1913);
  t1918 = t174 * t1917;
  t1919 = t89 * t1918;
  t1921 = t876 * t188;
  t1923 = t323 * t726;
  t1925 = t323 * t737;
  t1927 = t1266 * t736;
  t1928 = t96 * t1927;
  t1929 = t725 * t892;
  t1930 = t96 * t1929;
  t1932 = t1411 * t885;
  t1937 = t510 * t888;
  t1940 = -t1913;
  t1944 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1932 * t184 - 0.16e2 / 0.9e1 * t729 * t499 + 0.4e1 / 0.9e1 * t1937 * t184 + 0.4e1 / 0.3e1 * t54 * t1940);
  t1945 = t183 * t1944;
  t1946 = t96 * t1945;
  t1948 = -0.4e1 / 0.3e1 * t1894 + t1897 - 0.4e1 / 0.3e1 * t1898 + t1901 / 0.2e1 + t1919 / 0.2e1 + 0.44e2 / 0.9e1 * t1921 - 0.8e1 / 0.3e1 * t1923 - 0.8e1 / 0.3e1 * t1925 + t1928 + t1930 / 0.2e1 + t1946 / 0.2e1 + t1451;
  t1967 = 0.1e2 / 0.3e1 * t347 * t740 + t136 * t1948 + 0.11e2 / 0.6e1 * t224 * t896 + 0.11e2 / 0.3e1 * t351 * t740 + t139 * t1948 + 0.2e1 * t228 * t896 + 0.4e1 * t355 * t740 + 0.55e2 / 0.36e2 * t901 * t214 + 0.2e1 / 0.9e1 * t905 * t242 + 0.3e1 / 0.8e1 * t909 * t242 + 0.5e1 / 0.9e1 * t913 * t242;
  t1974 = t1917 * t46;
  t1981 = t1944 * t46;
  t1984 = -t233 * t934 / 0.3e1 + t33 * t1974 / 0.4e1 + 0.7e1 / 0.9e1 * t939 * t239 - 0.2e1 / 0.3e1 * t363 * t758 + t51 * t1981 / 0.4e1;
  t2003 = 0.55e2 / 0.72e2 * t916 * t242 + 0.3e1 / 0.8e1 * t919 * t191 + t30 * t1984 / 0.2e1 + 0.2e1 / 0.3e1 * t246 * t947 + 0.4e1 / 0.3e1 * t372 * t761 + t64 * t1984 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t947 + 0.3e1 / 0.2e1 * t377 * t761 + t68 * t1984 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t947 + 0.5e1 / 0.3e1 * t383 * t761;
  t2022 = -0.2e1 / 0.3e1 * t1894 + t1897 / 0.2e1 - 0.2e1 / 0.3e1 * t1898 + t1901 / 0.4e1 + t1919 / 0.4e1 + 0.22e2 / 0.9e1 * t1921 - 0.4e1 / 0.3e1 * t1923 - 0.4e1 / 0.3e1 * t1925 + t1928 / 0.2e1 + t1930 / 0.4e1 + t1946 / 0.4e1;
  t2039 = t81 * t1984 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t947 + 0.11e2 / 0.6e1 * t388 * t761 + t85 * t2022 / 0.2e1 + 0.3e1 / 0.4e1 * t266 * t971 + 0.3e1 / 0.2e1 * t393 * t793 + 0.5e1 / 0.9e1 * t922 * t191 + 0.55e2 / 0.72e2 * t925 * t191 + 0.3e1 / 0.4e1 * t928 * t214 + 0.1e2 / 0.9e1 * t931 * t214 + t105 * t2022 / 0.2e1;
  t2060 = 0.5e1 / 0.6e1 * t194 * t971 + 0.5e1 / 0.3e1 * t398 * t793 + t110 * t2022 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t971 + 0.11e2 / 0.6e1 * t310 * t793 + t115 * t2022 / 0.2e1 + t204 * t971 + 0.2e1 * t336 * t793 + t119 * t1948 + 0.3e1 / 0.2e1 * t216 * t896 + 0.3e1 * t343 * t740;
  t2074 = t133 * t1948 + 0.5e1 / 0.3e1 * t220 * t896 + 0.7e1 / 0.3e1 * t1466 + 0.8e1 / 0.3e1 * t1468 + 0.3e1 * t1470 + 0.1e2 / 0.3e1 * t1472 - 0.2e2 / 0.3e1 * t1815 - 0.14e2 / 0.3e1 * t1840 - 0.16e2 / 0.3e1 * t1842 - 0.6e1 * t1844 + t1846;
  t2081 = t1848 + t1849 + t1850 + t1584 + 0.2e1 * t1586 - t1591 + 0.28e2 / 0.3e1 * t1592 + 0.7e1 * t1594 + 0.32e2 / 0.3e1 * t1605 + 0.8e1 * t1607 + 0.12e2 * t1616;
  t2087 = 0.9e1 * t1618 + 0.4e2 / 0.3e1 * t1627 + 0.1e2 * t1630 - t1866 - t1635 - t1867 - t1639 - t1868 - t1643 - t1870 + 0.14e2 * t1875;
  t2091 = t1015 * t175;
  t2093 = t1015 * t273;
  t2095 = t1018 * t175;
  t2097 = t1018 * t273;
  t2099 = t1021 * t175;
  t2101 = t1021 * t273;
  t2103 = t1024 * t175;
  t2105 = t1024 * t273;
  t2107 = 0.16e2 * t1879 + 0.18e2 * t1883 + 0.2e2 * t1887 + 0.7e1 / 0.18e2 * t2091 - 0.7e1 / 0.18e2 * t2093 + 0.8e1 / 0.9e1 * t2095 - 0.8e1 / 0.9e1 * t2097 + 0.3e1 / 0.2e1 * t2099 - 0.3e1 / 0.2e1 * t2101 + 0.2e2 / 0.9e1 * t2103 - 0.2e2 / 0.9e1 * t2105;
  tv3rho32 = t1967 + t2003 + t2039 + t2060 + t2074 + t2081 + t2087 + t2107;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2112 = 0.1e1 / t5;
  t2113 = t135 * t2112;
  t2116 = t29 * t1319;
  t2119 = 0.1e1 / t19;
  t2120 = t63 * t2119;
  t2123 = t67 * t50;
  t2141 = t1240 * t869;
  t2142 = t89 * t2141;
  t2144 = t861 * t313;
  t2150 = -0.6e1 * t272 - 0.6e1 * t1397;
  t2154 = my_piecewise3(t39, 0, -0.8e1 / 0.27e2 * t1390 * t2144 + 0.4e1 / 0.3e1 * t712 * t865 + 0.4e1 / 0.3e1 * t42 * t2150);
  t2155 = t174 * t2154;
  t2156 = t89 * t2155;
  t2158 = t873 * rho[1];
  t2160 = 0.1e1 / t25 / t2158;
  t2161 = sigma[2] * t2160;
  t2162 = t2161 * t98;
  t2164 = t876 * t330;
  t2166 = t323 * t882;
  t2168 = t323 * t893;
  t2170 = t1266 * t892;
  t2171 = t96 * t2170;
  t2173 = t885 * t326;
  t2178 = -t2150;
  t2182 = my_piecewise3(t53, 0, -0.8e1 / 0.27e2 * t1411 * t2173 + 0.4e1 / 0.3e1 * t729 * t888 + 0.4e1 / 0.3e1 * t54 * t2178);
  t2183 = t183 * t2182;
  t2184 = t96 * t2183;
  t2186 = 0.3e1 / 0.4e1 * t2142 + t2156 / 0.4e1 - 0.154e3 / 0.27e2 * t2162 + 0.22e2 / 0.3e1 * t2164 - 0.2e1 * t2166 - 0.2e1 * t2168 + 0.3e1 / 0.4e1 * t2171 + t2184 / 0.4e1;
  t2207 = 0.3e1 / 0.2e1 * t2142 + t2156 / 0.2e1 - 0.308e3 / 0.27e2 * t2162 + 0.44e2 / 0.3e1 * t2164 - 0.4e1 * t2166 - 0.4e1 * t2168 + 0.3e1 / 0.2e1 * t2171 + t2184 / 0.2e1 + t1451;
  t2212 = 0.5e1 / 0.3e1 * t922 * t333 + 0.55e2 / 0.24e2 * t925 * t333 + t105 * t2186 / 0.2e1 + 0.5e1 / 0.2e1 * t398 * t971 + t110 * t2186 / 0.2e1 + 0.11e2 / 0.4e1 * t310 * t971 + t115 * t2186 / 0.2e1 + 0.3e1 * t336 * t971 + t119 * t2207 + 0.9e1 / 0.2e1 * t343 * t896 + t133 * t2207;
  t2222 = t2154 * t46;
  t2226 = 0.1e1 / t11 / t873;
  t2227 = t49 * t2226;
  t2233 = t2182 * t46;
  t2236 = t33 * t2222 / 0.4e1 - 0.7e2 / 0.27e2 * t2227 * t57 + 0.7e1 / 0.3e1 * t939 * t366 - t363 * t944 + t51 * t2233 / 0.4e1;
  t2249 = 0.5e1 * t347 * t896 + t136 * t2207 + 0.11e2 / 0.2e1 * t351 * t896 + t139 * t2207 + 0.6e1 * t355 * t896 + t30 * t2236 / 0.2e1 + 0.2e1 * t372 * t947 + t64 * t2236 / 0.2e1 + 0.9e1 / 0.4e1 * t377 * t947 + t68 * t2236 / 0.2e1 + 0.5e1 / 0.2e1 * t383 * t947;
  t2258 = t71 * t2112;
  t2261 = t84 * t2119;
  t2264 = t104 * t50;
  t2267 = t109 * t2112;
  t2270 = t118 * t2119;
  t2273 = t132 * t50;
  t2278 = t81 * t2236 / 0.2e1 + 0.11e2 / 0.4e1 * t388 * t947 + t85 * t2186 / 0.2e1 + 0.9e1 / 0.4e1 * t393 * t971 - 0.55e2 / 0.432e3 * t2258 * t60 - 0.3e1 / 0.16e2 * t2261 * t101 - 0.5e1 / 0.27e2 * t2264 * t101 - 0.55e2 / 0.432e3 * t2267 * t101 - 0.3e1 / 0.8e1 * t2270 * t130 - 0.1e2 / 0.27e2 * t2273 * t130 + 0.9e1 / 0.4e1 * t928 * t341;
  t2290 = t141 * t1315;
  t2293 = t147 * t1319;
  t2296 = t150 * t2119;
  t2299 = t153 * t50;
  t2302 = 0.6e1 * t1852 - 0.35e2 / 0.216e3 * t2290 * t145 - 0.8e1 / 0.27e2 * t2293 * t145 - 0.3e1 / 0.8e1 * t2296 * t145 - 0.1e2 / 0.27e2 * t2299 * t145 - t1591 - t1633 - t1635 - t1637 - t1639 - t1641;
  t2313 = -t1643 - t1645 + 0.28e2 * t1873 + 0.21e2 * t1875 + 0.32e2 * t1877 + 0.24e2 * t1879 + 0.36e2 * t1881 + 0.27e2 * t1883 + 0.4e2 * t1885 + 0.3e2 * t1887 - 0.7e1 / 0.6e1 * t2091;
  t2329 = -0.7e1 / 0.6e1 * t2093 - 0.8e1 / 0.3e1 * t2095 - 0.8e1 / 0.3e1 * t2097 - 0.9e1 / 0.2e1 * t2099 - 0.9e1 / 0.2e1 * t2101 - 0.2e2 / 0.3e1 * t2103 - 0.2e2 / 0.3e1 * t2105 - 0.8e1 / 0.27e2 * t8 * t1319 - 0.3e1 / 0.8e1 * t15 * t2119 - 0.1e2 / 0.27e2 * t22 * t50 - 0.35e2 / 0.216e3 * t1 * t1315;
  tv3rho33 = 0.1e2 / 0.3e1 * t931 * t341 + 0.55e2 / 0.12e2 * t901 * t341 - 0.55e2 / 0.216e3 * t2113 * t130 - 0.4e1 / 0.27e2 * t2116 * t60 - 0.3e1 / 0.16e2 * t2120 * t60 - 0.5e1 / 0.27e2 * t2123 * t60 + 0.2e1 / 0.3e1 * t905 * t369 + 0.9e1 / 0.8e1 * t909 * t369 + 0.5e1 / 0.3e1 * t913 * t369 + 0.55e2 / 0.24e2 * t916 * t369 + 0.9e1 / 0.8e1 * t919 * t333 + t2329 + t2313 + t2302 + t2278 + t2249 + t2212 + 0.3e1 * t1851 + 0.9e1 * t1844 + 0.7e1 * t1840 + 0.8e1 * t1842 + 0.1e2 * t1815 - t1574 - t1572 - t1532 - t1530;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2333 = t537 * t90 * t45;
  t2335 = t170 * t44;
  t2339 = t88 * t543 * t45;
  t2343 = 0.88e2 / 0.9e1 * t582;
  t2344 = 0.22e2 / 0.9e1 * t2333 - 0.8e1 / 0.3e1 * t2335 * t708 + t2339 / 0.2e1 + t1032 * t1664 / 0.2e1 - t2343;
  t2369 = t139 * t2344 + 0.4e1 * t228 * t1036 + t119 * t2344 + 0.3e1 * t216 * t1036 + t133 * t2344 + 0.1e2 / 0.3e1 * t220 * t1036 + t136 * t2344 + 0.11e2 / 0.3e1 * t224 * t1036 + 0.3e1 / 0.4e1 * t624 * t444 + 0.1e2 / 0.9e1 * t627 * t444 + 0.55e2 / 0.36e2 * t632 * t444 + 0.11e2 / 0.18e2 * t85 * t2333 + t85 * t2339 / 0.8e1 + 0.11e2 / 0.18e2 * t105 * t2333;
  t2372 = t29 * t1078;
  t2375 = t63 * t1082;
  t2378 = t67 * t1086;
  t2381 = t71 * t1499;
  t2393 = t418 * t179 * t46;
  t2404 = t105 * t2339 / 0.8e1 - 0.7e1 / 0.36e2 * t2372 * t1052 - 0.13e2 / 0.64e2 * t2375 * t1052 - 0.5e1 / 0.24e2 * t2378 * t1052 - 0.121e3 / 0.576e3 * t2381 * t1052 + 0.11e2 / 0.18e2 * t110 * t2333 + t110 * t2339 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2333 + t115 * t2339 / 0.8e1 + 0.3e1 / 0.16e2 * t1055 * t2393 + 0.5e1 / 0.24e2 * t1058 * t2393 + 0.11e2 / 0.48e2 * t1061 * t2393 + 0.11e2 / 0.24e2 * t1083 * t180 + t1087 * t180 / 0.2e1;
  t2413 = 0.1e1 / t74 / t86;
  t2414 = t109 * t2413;
  t2417 = t113 * t88;
  t2418 = t2417 * t91;
  t2422 = t84 / t2 / t168;
  t2425 = 0.1e1 / t168;
  t2426 = t104 * t2425;
  t2430 = 0.2e1 * t138 * t444;
  t2432 = t32 * t505 * t46;
  t2441 = t85 * t170;
  t2446 = 0.3e1 / 0.8e1 * t1075 * t180 + 0.5e1 / 0.12e2 * t1079 * t180 + t1050 * t2393 / 0.6e1 - 0.33e2 / 0.64e2 * t2414 * t91 - 0.13e2 / 0.24e2 * t2418 - 0.29e2 / 0.64e2 * t2422 * t91 - 0.35e2 / 0.72e2 * t2426 * t91 + t2430 + t419 * t2432 / 0.16e2 + t424 * t2432 / 0.16e2 + t427 * t2432 / 0.16e2 + t430 * t2432 / 0.16e2 - 0.2e1 / 0.3e1 * t2441 * t180 + t1106 * t547 / 0.8e1;
  t2447 = t105 * t170;
  t2452 = t110 * t170;
  t2457 = t115 * t170;
  t2463 = t232 * t179 * t46;
  t2467 = t488 * t44 * t46;
  t2482 = -0.2e1 / 0.3e1 * t2447 * t180 + t1109 * t547 / 0.8e1 - 0.2e1 / 0.3e1 * t2452 * t180 + t1090 * t547 / 0.8e1 - 0.2e1 / 0.3e1 * t2457 * t180 + t1093 * t547 / 0.8e1 - t430 * t2463 / 0.6e1 + 0.7e1 / 0.36e2 * t424 * t2467 + 0.7e1 / 0.36e2 * t427 * t2467 + 0.7e1 / 0.36e2 * t430 * t2467 + 0.7e1 / 0.36e2 * t419 * t2467 - t419 * t2463 / 0.6e1 - t424 * t2463 / 0.6e1 - t427 * t2463 / 0.6e1;
  tv3rho2sigma0 = t2369 + t2404 + t2446 + t2482;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t2486 = t216 * t211;
  t2489 = 0.176e3 / 0.9e1 * t119 * t582;
  t2492 = t220 * t211;
  t2495 = 0.176e3 / 0.9e1 * t133 * t582;
  t2498 = t224 * t211;
  t2501 = 0.176e3 / 0.9e1 * t136 * t582;
  t2503 = 0.4e1 * t138 * t128;
  t2504 = t228 * t211;
  t2507 = 0.176e3 / 0.9e1 * t139 * t582;
  tv3rho2sigma1 = -0.3e1 / 0.2e1 * t624 * t128 + 0.16e2 * t2486 - t2489 - 0.2e2 / 0.9e1 * t627 * t128 + 0.16e3 / 0.9e1 * t2492 - t2495 - 0.55e2 / 0.18e2 * t632 * t128 + 0.176e3 / 0.9e1 * t2498 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2517 = t95 * t550 * t45;
  t2521 = t2517 / 0.2e1 + t1184 * t1692 / 0.2e1 - t2343;
  t2546 = t113 * t95;
  t2547 = t2546 * t98;
  t2550 = 0.2e1 * t138 * t480;
  t2551 = 0.3e1 / 0.4e1 * t624 * t480 + 0.1e2 / 0.9e1 * t627 * t480 + 0.55e2 / 0.36e2 * t632 * t480 + 0.11e2 / 0.3e1 * t224 * t1187 + t136 * t2521 + 0.4e1 * t228 * t1187 + t139 * t2521 + 0.3e1 * t216 * t1187 + t119 * t2521 + 0.1e2 / 0.3e1 * t220 * t1187 + t133 * t2521 + 0.5e1 / 0.72e2 * t618 * t470 + t105 * t2517 / 0.8e1 + 0.55e2 / 0.576e3 * t621 * t470 + t110 * t2517 / 0.8e1 + t115 * t2517 / 0.8e1 + 0.3e1 / 0.64e2 * t615 * t470 + t85 * t2517 / 0.8e1 + t2547 / 0.8e1 + t2550;
  t2554 = t194 * t95;
  t2559 = t199 * t95;
  t2564 = t204 * t95;
  t2572 = t50 * t518 * t46;
  t2587 = t266 * t95;
  t2590 = t604 * t454;
  t2593 = t608 * t454;
  t2596 = t612 * t454;
  t2599 = t600 * t454;
  t2602 = t1163 * t554 / 0.8e1 + 0.5e1 / 0.12e2 * t2554 * t188 + t1168 * t554 / 0.8e1 + 0.11e2 / 0.24e2 * t2559 * t188 + t1174 * t554 / 0.8e1 + t2564 * t188 / 0.2e1 + t1179 * t554 / 0.8e1 + t1139 * t1143 / 0.6e1 + t455 * t2572 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t1143 + t460 * t2572 / 0.16e2 + 0.5e1 / 0.24e2 * t1151 * t1143 + t463 * t2572 / 0.16e2 + 0.11e2 / 0.48e2 * t1156 * t1143 + t466 * t2572 / 0.16e2 + 0.3e1 / 0.8e1 * t2587 * t188 + 0.3e1 / 0.64e2 * t2590 * t457 + 0.5e1 / 0.72e2 * t2593 * t457 + 0.55e2 / 0.576e3 * t2596 * t457 + t2599 * t457 / 0.36e2;
  tv3rho2sigma2 = t2551 + t2602;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2607 = t88 * t179;
  t2610 = t45 * t719;
  t2613 = -0.4e1 / 0.3e1 * t2335 * t1240 + t2607 * t1240 / 0.2e1 + t1032 * t2610 / 0.2e1 - t2343;
  t2636 = 0.3e1 / 0.2e1 * t343 * t1036 + t119 * t2613 + 0.3e1 / 0.2e1 * t216 * t1243 + 0.5e1 / 0.3e1 * t347 * t1036 + t133 * t2613 + 0.5e1 / 0.3e1 * t220 * t1243 + 0.11e2 / 0.6e1 * t351 * t1036 + t136 * t2613 + 0.11e2 / 0.6e1 * t224 * t1243 + 0.2e1 * t355 * t1036 + t139 * t2613 + 0.2e1 * t228 * t1243 - 0.5e1 / 0.18e2 * t398 * t1030 - 0.11e2 / 0.36e2 * t310 * t1030;
  t2642 = t418 * t316 * t46;
  t2662 = t232 * t316 * t46;
  t2669 = -t336 * t1030 / 0.3e1 - t393 * t1030 / 0.4e1 + t1050 * t2642 / 0.12e2 + 0.3e1 / 0.32e2 * t1055 * t2642 + 0.5e1 / 0.48e2 * t1058 * t2642 + 0.11e2 / 0.96e2 * t1061 * t2642 + 0.3e1 / 0.16e2 * t1075 * t317 + 0.5e1 / 0.24e2 * t1079 * t317 + 0.11e2 / 0.48e2 * t1083 * t317 + t1087 * t317 / 0.4e1 - t1206 * t1113 / 0.8e1 - t424 * t2662 / 0.12e2 - 0.5e1 / 0.36e2 * t1211 * t1113 - t427 * t2662 / 0.12e2;
  t2673 = t336 * t88;
  t2683 = t32 * t719 * t46;
  t2698 = t393 * t88;
  t2703 = t1090 * t720 / 0.8e1 + t2673 * t180 / 0.4e1 + t1093 * t709 / 0.8e1 + t1093 * t720 / 0.8e1 + t1199 * t1097 / 0.12e2 + t419 * t2683 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t1097 + t424 * t2683 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t1097 + t427 * t2683 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t1097 + t430 * t2683 / 0.16e2 + 0.3e1 / 0.16e2 * t2698 * t180 - 0.11e2 / 0.72e2 * t1216 * t1113;
  t2722 = t398 * t88;
  t2729 = t310 * t88;
  t2734 = -t430 * t2662 / 0.12e2 - t2441 * t317 / 0.3e1 - t2447 * t317 / 0.3e1 - t2452 * t317 / 0.3e1 - t2457 * t317 / 0.3e1 - t1199 * t1113 / 0.9e1 - t419 * t2662 / 0.12e2 + t1106 * t709 / 0.8e1 + t1106 * t720 / 0.8e1 + 0.5e1 / 0.24e2 * t2722 * t180 + t1109 * t709 / 0.8e1 + t1109 * t720 / 0.8e1 + 0.11e2 / 0.48e2 * t2729 * t180 + t1090 * t709 / 0.8e1;
  tv3rho2sigma3 = t2636 + t2669 + t2703 + t2734;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t2736 = t343 * t211;
  t2739 = t347 * t211;
  t2742 = t351 * t211;
  t2745 = t355 * t211;
  tv3rho2sigma4 = 0.8e1 * t2736 + 0.8e1 * t2486 - t2489 + 0.8e2 / 0.9e1 * t2739 + 0.8e2 / 0.9e1 * t2492 - t2495 + 0.88e2 / 0.9e1 * t2742 + 0.88e2 / 0.9e1 * t2498 - t2501 + 0.32e2 / 0.3e1 * t2745 + 0.32e2 / 0.3e1 * t2504 - t2507;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2750 = t322 * t56;
  t2753 = t95 * t187;
  t2756 = t45 * t736;
  t2759 = -0.4e1 / 0.3e1 * t2750 * t725 + t2753 * t1266 / 0.2e1 + t1184 * t2756 / 0.2e1 - t2343;
  t2779 = t454 * t187 * t46;
  t2784 = 0.3e1 / 0.2e1 * t343 * t1187 + t133 * t2759 + 0.5e1 / 0.3e1 * t220 * t1269 + 0.5e1 / 0.3e1 * t347 * t1187 + t136 * t2759 + 0.11e2 / 0.6e1 * t224 * t1269 + 0.11e2 / 0.6e1 * t351 * t1187 + t139 * t2759 + 0.2e1 * t228 * t1269 + 0.2e1 * t355 * t1187 + t119 * t2759 + 0.3e1 / 0.2e1 * t216 * t1269 + t1283 * t2779 / 0.12e2 + 0.3e1 / 0.32e2 * t1288 * t2779;
  t2805 = t105 * t322;
  t2814 = 0.5e1 / 0.48e2 * t1291 * t2779 + 0.11e2 / 0.96e2 * t1294 * t2779 - 0.5e1 / 0.18e2 * t194 * t1264 - 0.11e2 / 0.36e2 * t199 * t1264 - t204 * t1264 / 0.3e1 - t266 * t1264 / 0.4e1 + 0.3e1 / 0.16e2 * t1308 * t188 + 0.5e1 / 0.24e2 * t1312 * t188 + 0.11e2 / 0.48e2 * t1316 * t188 + t1320 * t188 / 0.4e1 - t2805 * t188 / 0.3e1 + t1168 * t726 / 0.8e1 + t1168 * t737 / 0.8e1 + 0.5e1 / 0.24e2 * t2554 * t330;
  t2816 = t110 * t322;
  t2826 = t362 * t187 * t46;
  t2847 = -t2816 * t188 / 0.3e1 + t1163 * t726 / 0.8e1 + t1163 * t737 / 0.8e1 + 0.3e1 / 0.16e2 * t2587 * t330 - t455 * t2826 / 0.12e2 - t1139 * t1342 / 0.9e1 - t460 * t2826 / 0.12e2 - t1146 * t1342 / 0.8e1 - t463 * t2826 / 0.12e2 - 0.5e1 / 0.36e2 * t1151 * t1342 - t466 * t2826 / 0.12e2 - 0.11e2 / 0.72e2 * t1156 * t1342 + t1174 * t726 / 0.8e1 + t1174 * t737 / 0.8e1;
  t2850 = t115 * t322;
  t2860 = t50 * t736 * t46;
  t2877 = t85 * t322;
  t2880 = 0.11e2 / 0.48e2 * t2559 * t330 - t2850 * t188 / 0.3e1 + t1179 * t726 / 0.8e1 + t1179 * t737 / 0.8e1 + t2564 * t330 / 0.4e1 + t455 * t2860 / 0.16e2 + t1139 * t1330 / 0.12e2 + t460 * t2860 / 0.16e2 + 0.3e1 / 0.32e2 * t1146 * t1330 + t463 * t2860 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t1330 + t466 * t2860 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t1330 - t2877 * t188 / 0.3e1;
  tv3rho2sigma5 = t2784 + t2814 + t2847 + t2880;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2883 = t88 * t857 * t45;
  t2885 = t45 * t869;
  t2888 = t2883 / 0.2e1 + t1032 * t2885 / 0.2e1 - t2343;
  t2921 = t909 * t418;
  t2924 = t913 * t418;
  t2927 = t133 * t2888 + 0.11e2 / 0.3e1 * t351 * t1243 + t136 * t2888 + 0.4e1 * t355 * t1243 + t139 * t2888 + 0.3e1 * t343 * t1243 + t119 * t2888 + 0.1e2 / 0.3e1 * t347 * t1243 + 0.3e1 / 0.4e1 * t928 * t444 + 0.1e2 / 0.9e1 * t931 * t444 + 0.55e2 / 0.36e2 * t901 * t444 + t85 * t2883 / 0.8e1 + 0.5e1 / 0.72e2 * t922 * t434 + t105 * t2883 / 0.8e1 + 0.55e2 / 0.576e3 * t925 * t434 + t110 * t2883 / 0.8e1 + t115 * t2883 / 0.8e1 + 0.3e1 / 0.64e2 * t919 * t434 + 0.3e1 / 0.64e2 * t2921 * t421 + 0.5e1 / 0.72e2 * t2924 * t421;
  t2928 = t916 * t418;
  t2948 = t32 * t869 * t46;
  t2965 = t905 * t418;
  t2969 = 0.55e2 / 0.576e3 * t2928 * t421 + t1106 * t870 / 0.8e1 + 0.5e1 / 0.12e2 * t2722 * t317 + t1109 * t870 / 0.8e1 + 0.11e2 / 0.24e2 * t2729 * t317 + t1090 * t870 / 0.8e1 + t2673 * t317 / 0.2e1 + t1093 * t870 / 0.8e1 + t1199 * t1203 / 0.6e1 + t419 * t2948 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t1203 + t424 * t2948 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t1203 + t427 * t2948 / 0.16e2 + 0.11e2 / 0.48e2 * t1216 * t1203 + t430 * t2948 / 0.16e2 + 0.3e1 / 0.8e1 * t2698 * t317 + t2965 * t421 / 0.36e2 + t2418 / 0.8e1 + t2430;
  tv3rho2sigma6 = t2927 + t2969;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = -0.3e1 / 0.2e1 * t928 * t128 + 0.16e2 * t2736 - t2489 - 0.2e2 / 0.9e1 * t931 * t128 + 0.16e3 / 0.9e1 * t2739 - t2495 - 0.55e2 / 0.18e2 * t901 * t128 + 0.176e3 / 0.9e1 * t2742 - t2501 - t2503 + 0.64e2 / 0.3e1 * t2745 - t2507;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2981 = t875 * t97 * t45;
  t2986 = t95 * t881 * t45;
  t2988 = t45 * t892;
  t2991 = 0.22e2 / 0.9e1 * t2981 - 0.8e1 / 0.3e1 * t2750 * t1266 + t2986 / 0.2e1 + t1184 * t2988 / 0.2e1 - t2343;
  t3016 = t139 * t2991 + 0.4e1 * t355 * t1269 + t119 * t2991 + 0.3e1 * t343 * t1269 + 0.3e1 / 0.4e1 * t928 * t480 + 0.1e2 / 0.9e1 * t931 * t480 + 0.55e2 / 0.36e2 * t901 * t480 + t133 * t2991 + 0.1e2 / 0.3e1 * t347 * t1269 + t136 * t2991 + 0.11e2 / 0.3e1 * t351 * t1269 + 0.11e2 / 0.18e2 * t110 * t2981 + t110 * t2986 / 0.8e1 + 0.11e2 / 0.18e2 * t115 * t2981;
  t3021 = t29 * t1311;
  t3024 = t63 * t1315;
  t3027 = t67 * t1319;
  t3030 = t71 * t2119;
  t3038 = t454 * t329 * t46;
  t3051 = t115 * t2986 / 0.8e1 + 0.11e2 / 0.18e2 * t85 * t2981 - 0.7e1 / 0.36e2 * t3021 * t1285 - 0.13e2 / 0.64e2 * t3024 * t1285 - 0.5e1 / 0.24e2 * t3027 * t1285 - 0.121e3 / 0.576e3 * t3030 * t1285 + 0.11e2 / 0.18e2 * t105 * t2981 + t105 * t2986 / 0.8e1 + t1283 * t3038 / 0.6e1 + 0.3e1 / 0.16e2 * t1288 * t3038 + 0.5e1 / 0.24e2 * t1291 * t3038 + 0.11e2 / 0.48e2 * t1294 * t3038 + 0.5e1 / 0.12e2 * t1312 * t330 + 0.11e2 / 0.24e2 * t1316 * t330;
  t3060 = t938 * t56 * t46;
  t3064 = t362 * t329 * t46;
  t3085 = t1320 * t330 / 0.2e1 + 0.3e1 / 0.8e1 * t1308 * t330 + t85 * t2986 / 0.8e1 + 0.7e1 / 0.36e2 * t466 * t3060 - t455 * t3064 / 0.6e1 - t460 * t3064 / 0.6e1 - t463 * t3064 / 0.6e1 - t466 * t3064 / 0.6e1 + 0.7e1 / 0.36e2 * t455 * t3060 + 0.7e1 / 0.36e2 * t460 * t3060 + 0.7e1 / 0.36e2 * t463 * t3060 + t1163 * t893 / 0.8e1 + t1168 * t893 / 0.8e1 - 0.2e1 / 0.3e1 * t2816 * t330;
  t3093 = t50 * t892 * t46;
  t3107 = 0.1e1 / t320;
  t3108 = t104 * t3107;
  t3112 = 0.1e1 / t78 / t93;
  t3113 = t109 * t3112;
  t3118 = t84 / t4 / t320;
  t3121 = t1174 * t893 / 0.8e1 - 0.2e1 / 0.3e1 * t2850 * t330 + t1179 * t893 / 0.8e1 + t455 * t3093 / 0.16e2 + t460 * t3093 / 0.16e2 + t463 * t3093 / 0.16e2 + t466 * t3093 / 0.16e2 - 0.2e1 / 0.3e1 * t2877 * t330 - 0.2e1 / 0.3e1 * t2805 * t330 - 0.13e2 / 0.24e2 * t2547 + t2550 - 0.35e2 / 0.72e2 * t3108 * t98 - 0.33e2 / 0.64e2 * t3113 * t98 - 0.29e2 / 0.64e2 * t3118 * t98;
  tv3rho2sigma8 = t3016 + t3051 + t3085 + t3121;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t3124 = t1353 * t44 * t46;
  tv3rhosigma20 = -t1050 * t3124 / 0.24e2 + t1354 * t1113 / 0.24e2 - t1354 * t1097 / 0.32e2 - 0.3e1 / 0.64e2 * t1055 * t3124 + t1356 * t1113 / 0.24e2 - t1356 * t1097 / 0.32e2 - 0.5e1 / 0.96e2 * t1058 * t3124 + t1358 * t1113 / 0.24e2 - t1358 * t1097 / 0.32e2 - 0.11e2 / 0.192e3 * t1061 * t3124 + t1360 * t1113 / 0.24e2 - t1360 * t1097 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t3149 = t246 * t1364;
  t3154 = t251 * t1364;
  t3159 = t256 * t1364;
  t3164 = t261 * t1364;
  tv3rhosigma25 = -t3149 * t457 / 0.24e2 - t1365 * t1143 / 0.32e2 - 0.3e1 / 0.64e2 * t3154 * t457 - t1367 * t1143 / 0.32e2 - 0.5e1 / 0.96e2 * t3159 * t457 - t1369 * t1143 / 0.32e2 - 0.11e2 / 0.192e3 * t3164 * t457 - t1371 * t1143 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t3169 = t372 * t1353;
  t3174 = t377 * t1353;
  t3179 = t383 * t1353;
  t3184 = t388 * t1353;
  tv3rhosigma26 = -t3169 * t421 / 0.24e2 - t1354 * t1203 / 0.32e2 - 0.3e1 / 0.64e2 * t3174 * t421 - t1356 * t1203 / 0.32e2 - 0.5e1 / 0.96e2 * t3179 * t421 - t1358 * t1203 / 0.32e2 - 0.11e2 / 0.192e3 * t3184 * t421 - t1360 * t1203 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t3190 = t1364 * t56 * t46;
  tv3rhosigma211 = -t1283 * t3190 / 0.24e2 + t1365 * t1342 / 0.24e2 - t1365 * t1330 / 0.32e2 - 0.3e1 / 0.64e2 * t1288 * t3190 + t1367 * t1342 / 0.24e2 - t1367 * t1330 / 0.32e2 - 0.5e1 / 0.96e2 * t1291 * t3190 + t1369 * t1342 / 0.24e2 - t1369 * t1330 / 0.32e2 - 0.11e2 / 0.192e3 * t1294 * t3190 + t1371 * t1342 / 0.24e2 - t1371 * t1330 / 0.32e2;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t3215 = sigma[0] * sigma[0];
  t3217 = 0.1e1 / t31 / t3215;
  t3218 = t30 * t3217;
  t3220 = t64 * t3217;
  t3222 = t68 * t3217;
  t3224 = t81 * t3217;
  tv3sigma30 = 0.3e1 / 0.64e2 * t3218 * t421 + 0.3e1 / 0.64e2 * t3220 * t421 + 0.3e1 / 0.64e2 * t3222 * t421 + 0.3e1 / 0.64e2 * t3224 * t421;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t3227 = sigma[2] * sigma[2];
  t3229 = 0.1e1 / t49 / t3227;
  t3230 = t30 * t3229;
  t3232 = t64 * t3229;
  t3234 = t68 * t3229;
  t3236 = t81 * t3229;
  tv3sigma39 = 0.3e1 / 0.64e2 * t3230 * t457 + 0.3e1 / 0.64e2 * t3232 * t457 + 0.3e1 / 0.64e2 * t3234 * t457 + 0.3e1 / 0.64e2 * t3236 * t457;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t3252 = t38 * t38;
  t3254 = 0.1e1 / t494 / t3252;
  t3255 = t496 * t496;
  t3261 = t501 * t501;
  t3266 = t34 * t1588;
  t3268 = -0.24e2 * t659 + 0.24e2 * t3266;
  t3272 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3254 * t3255 - 0.16e2 / 0.9e1 * t1390 * t496 * t501 + 0.4e1 / 0.3e1 * t495 * t3261 + 0.16e2 / 0.9e1 * t1394 * t1399 + 0.4e1 / 0.3e1 * t42 * t3268);
  t3276 = t52 * t52;
  t3278 = 0.1e1 / t509 / t3276;
  t3279 = t511 * t511;
  t3285 = t514 * t514;
  t3294 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3278 * t3279 - 0.16e2 / 0.9e1 * t1411 * t511 * t514 + 0.4e1 / 0.3e1 * t510 * t3285 + 0.16e2 / 0.9e1 * t1415 * t1418 - 0.4e1 / 0.3e1 * t54 * t3268);
  t3298 = 0.91e3 / 0.81e2 * t31 / t9 / t1374 * t47 - 0.28e3 / 0.27e2 * t1535 * t236 + 0.14e2 / 0.3e1 * t489 * t506 - 0.4e1 / 0.3e1 * t233 * t1541 + t33 * t3272 * t46 / 0.4e1 + t51 * t3294 * t46 / 0.4e1;
  t3311 = sigma[0] / t23 / t535 / t86 * t91;
  t3313 = t1377 * t180;
  t3315 = t538 * t544;
  t3317 = t538 * t547;
  t3319 = t171 * t1386;
  t3321 = t171 * t1404;
  t3323 = t505 * t505;
  t3325 = t89 * t3323 * t45;
  t3328 = t89 * t708 * t1403;
  t3330 = t89 * t174 * t3272;
  t3332 = t518 * t518;
  t3334 = t96 * t3332 * t45;
  t3337 = t96 * t725 * t1422;
  t3339 = t96 * t183 * t3294;
  t3341 = 0.2618e4 / 0.81e2 * t3311 - 0.1232e4 / 0.27e2 * t3313 + 0.44e2 / 0.3e1 * t3315 + 0.44e2 / 0.3e1 * t3317 - 0.8e1 * t3319 - 0.8e1 / 0.3e1 * t3321 + 0.3e1 / 0.4e1 * t3325 + t3328 + t3330 / 0.4e1 + 0.3e1 / 0.4e1 * t3334 + t3337 + t3339 / 0.4e1;
  t3358 = 0.8e1 * t228 * t1452 + t68 * t3298 / 0.2e1 + 0.1e2 / 0.3e1 * t256 * t1547 + t81 * t3298 / 0.2e1 + 0.11e2 / 0.3e1 * t261 * t1547 + t85 * t3341 / 0.2e1 + 0.3e1 * t266 * t1426 + t105 * t3341 / 0.2e1 + 0.1e2 / 0.3e1 * t194 * t1426 + t110 * t3341 / 0.2e1 + 0.11e2 / 0.3e1 * t199 * t1426 + t115 * t3341 / 0.2e1 + 0.4e1 * t204 * t1426;
  t3371 = t580 * t124;
  t3375 = 0.20944e5 / 0.81e2 * t123 / t126 / t3371;
  t3376 = 0.5236e4 / 0.81e2 * t3311 - 0.2464e4 / 0.27e2 * t3313 + 0.88e2 / 0.3e1 * t3315 + 0.88e2 / 0.3e1 * t3317 - 0.16e2 * t3319 - 0.16e2 / 0.3e1 * t3321 + 0.3e1 / 0.2e1 * t3325 + 0.2e1 * t3328 + t3330 / 0.2e1 + 0.3e1 / 0.2e1 * t3334 + 0.2e1 * t3337 + t3339 / 0.2e1 - t3375;
  t3402 = t119 * t3376 + 0.6e1 * t216 * t1452 + t133 * t3376 + 0.2e2 / 0.3e1 * t220 * t1452 + t136 * t3376 + 0.22e2 / 0.3e1 * t224 * t1452 - 0.16e2 / 0.27e2 * t1496 * t242 - 0.3e1 / 0.4e1 * t1500 * t242 - 0.2e2 / 0.27e2 * t1503 * t242 - 0.55e2 / 0.108e3 * t1507 * t242 - 0.3e1 / 0.4e1 * t1511 * t191 - 0.2e2 / 0.27e2 * t1514 * t191 - 0.55e2 / 0.108e3 * t1517 * t191 - 0.3e1 / 0.2e1 * t1520 * t214;
  t3412 = 0.1e1 / t16 / t86;
  t3432 = t297 * t1397;
  t3434 = t297 * t1589;
  t3436 = t142 * t3266;
  t3437 = 0.192e3 * t3436;
  t3438 = -0.4e2 / 0.27e2 * t1523 * t214 - 0.55e2 / 0.54e2 * t1526 * t214 + 0.2e2 / 0.81e2 * t29 * t88 * t60 + 0.9e1 / 0.32e2 * t63 * t3412 * t60 + 0.2e2 / 0.81e2 * t67 * t232 * t60 + 0.385e3 / 0.2592e4 * t71 * t1074 * t60 + 0.9e1 / 0.32e2 * t84 * t3412 * t101 + 0.2e2 / 0.81e2 * t104 * t232 * t101 + 0.385e3 / 0.2592e4 * t109 * t1074 * t101 + t139 * t3376 + 0.24e3 * t3432 - 0.16e3 * t3434 - t3437;
  t3439 = 0.1e1 / t3371;
  t3440 = t143 * t3439;
  t3442 = 0.12e3 * t142 * t3440;
  t3443 = t148 * t3266;
  t3444 = 0.192e3 * t3443;
  t3446 = 0.12e3 * t148 * t3440;
  t3447 = t151 * t3266;
  t3448 = 0.192e3 * t3447;
  t3450 = 0.12e3 * t151 * t3440;
  t3454 = t1646 * t175;
  t3456 = t1646 * t273;
  t3458 = t154 * t3266;
  t3459 = 0.192e3 * t3458;
  t3461 = 0.12e3 * t154 * t3440;
  t3462 = t663 * t499;
  t3464 = t288 * t1397;
  t3466 = t663 * t660;
  t3468 = t288 * t1589;
  t3470 = t3442 - t3444 + t3446 - t3448 + t3450 + 0.385e3 / 0.1296e4 * t141 * t2413 * t145 - 0.35e2 / 0.27e2 * t3454 + 0.35e2 / 0.27e2 * t3456 - t3459 + t3461 - 0.28e2 / 0.3e1 * t3462 + 0.168e3 * t3464 + 0.7e1 * t3466 - 0.112e3 * t3468;
  t3476 = t1596 * t175;
  t3478 = t1596 * t273;
  t3480 = t671 * t499;
  t3482 = t671 * t660;
  t3484 = t291 * t1397;
  t3486 = t291 * t1589;
  t3491 = t1609 * t175;
  t3493 = t1609 * t273;
  t3495 = t678 * t499;
  t3497 = t678 * t660;
  t3499 = t294 * t1397;
  t3501 = 0.4e2 / 0.81e2 * t147 * t88 * t145 - 0.64e2 / 0.27e2 * t3476 + 0.64e2 / 0.27e2 * t3478 - 0.64e2 / 0.3e1 * t3480 + 0.16e2 * t3482 + 0.192e3 * t3484 - 0.128e3 * t3486 + 0.9e1 / 0.16e2 * t150 * t3412 * t145 - 0.3e1 * t3491 + 0.3e1 * t3493 - 0.36e2 * t3495 + 0.27e2 * t3497 + 0.216e3 * t3499;
  t3502 = t294 * t1589;
  t3507 = t1620 * t175;
  t3509 = t1620 * t273;
  t3511 = t685 * t499;
  t3513 = t685 * t660;
  t3524 = t685 * t144;
  t3526 = t297 * t272;
  t3528 = t142 * t659;
  t3529 = 0.72e2 * t3528;
  t3530 = t148 * t659;
  t3531 = 0.72e2 * t3530;
  t3532 = t151 * t659;
  t3533 = 0.72e2 * t3532;
  t3534 = -0.144e3 * t3502 + 0.4e2 / 0.81e2 * t153 * t232 * t145 - 0.8e2 / 0.27e2 * t3507 + 0.8e2 / 0.27e2 * t3509 - 0.16e3 / 0.3e1 * t3511 + 0.4e2 * t3513 + 0.9e1 / 0.16e2 * t118 * t3412 * t130 + 0.4e2 / 0.81e2 * t132 * t232 * t130 + 0.385e3 / 0.1296e4 * t135 * t1074 * t130 + 0.4e2 / 0.3e1 * t3524 - 0.8e2 * t3526 + t3529 + t3531 + t3533;
  t3536 = t154 * t659;
  t3537 = 0.72e2 * t3536;
  t3538 = t663 * t144;
  t3540 = t288 * t272;
  t3542 = t671 * t144;
  t3544 = t291 * t272;
  t3546 = t678 * t144;
  t3548 = t294 * t272;
  t3562 = t3537 + 0.7e1 / 0.3e1 * t3538 - 0.56e2 * t3540 + 0.16e2 / 0.3e1 * t3542 - 0.64e2 * t3544 + 0.9e1 * t3546 - 0.72e2 * t3548 + 0.2e2 / 0.3e1 * t627 * t585 + 0.55e2 / 0.6e1 * t632 * t585 + t30 * t3298 / 0.2e1 + 0.8e1 / 0.3e1 * t246 * t1547 + t64 * t3298 / 0.2e1 + 0.3e1 * t251 * t1547;
  t3579 = t138 * t585;
  t3581 = t113 * t557;
  t3591 = 0.4e1 / 0.3e1 * t600 * t522 + 0.9e1 / 0.4e1 * t604 * t522 + 0.1e2 / 0.3e1 * t608 * t522 + 0.55e2 / 0.12e2 * t612 * t522 + 0.9e1 / 0.4e1 * t615 * t557 + 0.1e2 / 0.3e1 * t618 * t557 + 0.55e2 / 0.12e2 * t621 * t557 + 0.9e1 / 0.2e1 * t624 * t585 + 0.12e2 * t3579 + 0.6e1 * t3581 + 0.385e3 / 0.1296e4 * t1 * t2413 + 0.4e2 / 0.81e2 * t8 * t88 + 0.9e1 / 0.16e2 * t15 * t3412 + 0.4e2 / 0.81e2 * t22 * t232;
  tv4rho40 = t3358 + t3402 + t3438 + t3470 + t3501 + t3534 + t3562 + t3591;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t3595 = 0.3e1 * t113 * t793;
  t3597 = 0.6e1 * t138 * t740;
  t3598 = t404 * t1397;
  t3599 = 0.42e2 * t3598;
  t3600 = t404 * t1589;
  t3602 = t407 * t1397;
  t3603 = 0.48e2 * t3602;
  t3604 = t407 * t1589;
  t3606 = t410 * t1397;
  t3607 = 0.54e2 * t3606;
  t3608 = t410 * t1589;
  t3610 = t413 * t1397;
  t3611 = 0.6e2 * t3610;
  t3612 = t413 * t1589;
  t3614 = 0.6e2 * t3432;
  t3616 = 0.96e2 * t3436;
  t3617 = t3595 + t3597 + t3599 - 0.28e2 * t3600 + t3603 - 0.32e2 * t3604 + t3607 - 0.36e2 * t3608 + t3611 - 0.4e2 * t3612 + t3614 - 0.12e3 * t3434 - t3616;
  t3618 = 0.96e2 * t3443;
  t3619 = 0.96e2 * t3447;
  t3622 = 0.96e2 * t3458;
  t3623 = 0.42e2 * t3464;
  t3627 = t3442 - t3618 + t3446 - t3619 + t3450 + 0.35e2 / 0.108e3 * t3454 + 0.35e2 / 0.108e3 * t3456 - t3622 + t3461 + t3623 + 0.7e1 / 0.2e1 * t3466 - 0.84e2 * t3468 + 0.16e2 / 0.27e2 * t3476;
  t3631 = 0.48e2 * t3484;
  t3636 = 0.54e2 * t3499;
  t3642 = 0.16e2 / 0.27e2 * t3478 + 0.8e1 * t3482 + t3631 - 0.96e2 * t3486 + 0.3e1 / 0.4e1 * t3491 + 0.3e1 / 0.4e1 * t3493 + 0.27e2 / 0.2e1 * t3497 + t3636 - 0.108e3 * t3502 + 0.2e2 / 0.27e2 * t3507 + 0.2e2 / 0.27e2 * t3509 + 0.2e2 * t3513 - 0.2e2 / 0.3e1 * t3524;
  t3643 = 0.2e2 * t3526;
  t3645 = 0.14e2 * t3540;
  t3647 = 0.16e2 * t3544;
  t3649 = 0.18e2 * t3548;
  t3655 = t96 * t725 * t1712;
  t3681 = 0.32e2 * t732 * t1588;
  t3683 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3278 * t326 * t1412 + 0.16e2 / 0.9e1 * t1411 * t34 * t272 * t511 - 0.8e1 / 0.9e1 * t1698 * t184 * t514 - 0.8e1 / 0.3e1 * t510 * t272 * t184 + 0.8e1 * t1701 * t659 * t184 - 0.8e1 / 0.3e1 * t1701 * t272 * t514 + 0.4e1 / 0.9e1 * t729 * t1418 + 0.16e2 * t54 * t659 - t3681);
  t3685 = t96 * t183 * t3683;
  t3687 = t538 * t709;
  t3689 = t538 * t720;
  t3691 = t171 * t1665;
  t3693 = t171 * t1668;
  t3695 = t171 * t1685;
  t3697 = t1403 * t45;
  t3699 = t89 * t3697 * t316;
  t3702 = t89 * t1664 * t719;
  t3705 = t89 * t708 * t1684;
  t3731 = 0.32e2 * t715 * t1588;
  t3733 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3254 * t313 * t1391 - 0.16e2 / 0.9e1 * t1390 * t34 * t272 * t496 - 0.8e1 / 0.9e1 * t1670 * t176 * t501 + 0.8e1 / 0.3e1 * t495 * t272 * t176 - 0.8e1 * t1673 * t659 * t176 + 0.8e1 / 0.3e1 * t1673 * t272 * t501 + 0.4e1 / 0.9e1 * t712 * t1399 - 0.16e2 * t42 * t659 + t3731);
  t3735 = t89 * t174 * t3733;
  t3737 = t323 * t1407;
  t3739 = t323 * t1423;
  t3741 = t1422 * t45;
  t3743 = t96 * t3741 * t329;
  t3746 = t96 * t1692 * t736;
  t3748 = t1377 * t317;
  t3750 = 0.3e1 / 0.4e1 * t3655 + t3685 / 0.4e1 + 0.22e2 / 0.3e1 * t3687 + 0.22e2 / 0.3e1 * t3689 - 0.2e1 * t3691 - 0.4e1 * t3693 - 0.2e1 * t3695 + t3699 / 0.4e1 + 0.3e1 / 0.4e1 * t3702 + 0.3e1 / 0.4e1 * t3705 + t3735 / 0.4e1 - 0.2e1 * t3737 - 0.2e1 / 0.3e1 * t3739 + t3743 / 0.4e1 + 0.3e1 / 0.4e1 * t3746 - 0.308e3 / 0.27e2 * t3748;
  t3761 = t3643 - 0.7e1 / 0.6e1 * t3538 + t3645 - 0.8e1 / 0.3e1 * t3542 + t3647 - 0.9e1 / 0.2e1 * t3546 + t3649 + 0.2e1 * t355 * t1452 + 0.5e1 / 0.6e1 * t398 * t1426 + t110 * t3750 / 0.2e1 + 0.11e2 / 0.4e1 * t199 * t1771 + 0.11e2 / 0.12e2 * t310 * t1426 + t115 * t3750 / 0.2e1 + 0.3e1 * t204 * t1771;
  t3781 = 0.3e1 / 0.2e1 * t3655 + t3685 / 0.2e1 + 0.44e2 / 0.3e1 * t3687 + 0.44e2 / 0.3e1 * t3689 - 0.4e1 * t3691 - 0.8e1 * t3693 - 0.4e1 * t3695 + t3699 / 0.2e1 + 0.3e1 / 0.2e1 * t3702 + 0.3e1 / 0.2e1 * t3705 + t3735 / 0.2e1 - 0.4e1 * t3737 - 0.4e1 / 0.3e1 * t3739 + t3743 / 0.2e1 + 0.3e1 / 0.2e1 * t3746 - t3375 - 0.616e3 / 0.27e2 * t3748;
  t3802 = t336 * t1426 + t119 * t3781 + 0.9e1 / 0.2e1 * t216 * t1716 + 0.3e1 / 0.2e1 * t343 * t1452 + t133 * t3781 + 0.5e1 * t220 * t1716 + 0.5e1 / 0.3e1 * t347 * t1452 + t136 * t3781 + 0.11e2 / 0.2e1 * t224 * t1716 + 0.11e2 / 0.6e1 * t351 * t1452 + t139 * t3781 + 0.6e1 * t228 * t1716 + 0.2e1 * t246 * t1734;
  t3818 = -0.7e2 / 0.27e2 * t1535 * t358 + 0.7e1 / 0.3e1 * t489 * t753 - t233 * t1726 + t33 * t3733 * t46 / 0.4e1 - t363 * t1544 / 0.3e1 + t51 * t3683 * t46 / 0.4e1;
  t3843 = 0.2e1 / 0.3e1 * t372 * t1547 + t64 * t3818 / 0.2e1 + 0.9e1 / 0.4e1 * t251 * t1734 + 0.3e1 / 0.4e1 * t377 * t1547 + t68 * t3818 / 0.2e1 + 0.5e1 / 0.2e1 * t256 * t1734 + 0.5e1 / 0.6e1 * t383 * t1547 + t81 * t3818 / 0.2e1 + 0.11e2 / 0.4e1 * t261 * t1734 + 0.11e2 / 0.12e2 * t388 * t1547 + t85 * t3750 / 0.2e1 + 0.9e1 / 0.4e1 * t266 * t1771 + 0.3e1 / 0.4e1 * t393 * t1426;
  t3871 = t105 * t3750 / 0.2e1 + 0.5e1 / 0.2e1 * t194 * t1771 + 0.2e1 / 0.3e1 * t600 * t761 + 0.9e1 / 0.8e1 * t604 * t761 + 0.5e1 / 0.3e1 * t608 * t761 + 0.55e2 / 0.24e2 * t612 * t761 + 0.9e1 / 0.8e1 * t615 * t793 + 0.5e1 / 0.3e1 * t618 * t793 + 0.55e2 / 0.24e2 * t621 * t793 + 0.9e1 / 0.4e1 * t624 * t740 + 0.1e2 / 0.3e1 * t627 * t740 + 0.55e2 / 0.12e2 * t632 * t740 + t30 * t3818 / 0.2e1;
  t3882 = t404 * t272;
  t3883 = 0.14e2 * t3882;
  t3884 = t407 * t272;
  t3885 = 0.16e2 * t3884;
  t3886 = t410 * t272;
  t3887 = 0.18e2 * t3886;
  t3888 = t413 * t272;
  t3889 = 0.2e2 * t3888;
  t3900 = -0.5e1 / 0.27e2 * t1514 * t333 - 0.55e2 / 0.432e3 * t1517 * t333 - 0.3e1 / 0.8e1 * t1520 * t341 - 0.1e2 / 0.27e2 * t1523 * t341 - 0.55e2 / 0.216e3 * t1526 * t341 - t3883 - t3885 - t3887 - t3889 - 0.4e1 / 0.27e2 * t1496 * t369 - 0.3e1 / 0.16e2 * t1500 * t369 - 0.5e1 / 0.27e2 * t1503 * t369 - 0.55e2 / 0.432e3 * t1507 * t369 - 0.3e1 / 0.16e2 * t1511 * t333;
  tv4rho41 = t3617 + t3627 + t3642 + t3761 + t3802 + t3843 + t3871 + t3900;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t3903 = t138 * t896;
  t3905 = t113 * t971;
  t3906 = t1015 * t499;
  t3908 = t1015 * t660;
  t3910 = t1018 * t499;
  t3912 = t1018 * t660;
  t3914 = t1021 * t499;
  t3916 = t1021 * t660;
  t3918 = t1024 * t499;
  t3920 = t1024 * t660;
  t3926 = 0.2e1 * t3903 + t3905 - 0.14e2 / 0.9e1 * t3906 + 0.7e1 / 0.6e1 * t3908 - 0.32e2 / 0.9e1 * t3910 + 0.8e1 / 0.3e1 * t3912 - 0.6e1 * t3914 + 0.9e1 / 0.2e1 * t3916 - 0.8e2 / 0.9e1 * t3918 + 0.2e2 / 0.3e1 * t3920 + 0.28e2 * t3598 - 0.56e2 * t3600 + 0.32e2 * t3602 - 0.64e2 * t3604;
  t3938 = 0.36e2 * t3606 - 0.72e2 * t3608 + 0.4e2 * t3610 - 0.8e2 * t3612 - 0.4e2 * t3432 - 0.8e2 * t3434 + t3442 + t3446 + t3450 + t3461 + 0.14e2 / 0.9e1 * t3462 - 0.28e2 * t3464 + 0.7e1 / 0.6e1 * t3466 - 0.56e2 * t3468 + 0.32e2 / 0.9e1 * t3480;
  t3954 = 0.8e1 / 0.3e1 * t3482 - 0.32e2 * t3484 - 0.64e2 * t3486 + 0.6e1 * t3495 + 0.9e1 / 0.2e1 * t3497 - 0.36e2 * t3499 - 0.72e2 * t3502 + 0.8e2 / 0.9e1 * t3511 + 0.2e2 / 0.3e1 * t3513 + 0.2e2 / 0.9e1 * t3524 + 0.4e2 / 0.3e1 * t3526 - 0.24e2 * t3528 - 0.24e2 * t3530 - 0.24e2 * t3532;
  t3995 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3254 * t861 * t496 - 0.64e2 / 0.27e2 * t1670 * t176 * t34 * t272 - 0.8e1 / 0.27e2 * t1903 * t501 + 0.32e2 / 0.9e1 * t495 * t143 * t3439 + 0.16e2 / 0.9e1 * t712 * t272 - 0.16e2 / 0.3e1 * t712 * t1397 - 0.8e1 / 0.27e2 * t1390 * t865 * t496 + 0.8e1 / 0.9e1 * t495 * t1913 * t176 + 0.4e1 / 0.9e1 * t1908 * t501 + t3731);
  t4028 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3278 * t885 * t511 + 0.64e2 / 0.27e2 * t1698 * t184 * t34 * t272 - 0.8e1 / 0.27e2 * t1932 * t514 + 0.32e2 / 0.9e1 * t510 * t143 * t3439 - 0.16e2 / 0.9e1 * t729 * t272 + 0.16e2 / 0.3e1 * t729 * t1397 - 0.8e1 / 0.27e2 * t1411 * t888 * t511 + 0.8e1 / 0.9e1 * t510 * t1940 * t184 + 0.4e1 / 0.9e1 * t1937 * t514 - t3681);
  t4032 = 0.7e1 / 0.9e1 * t489 * t934 - 0.2e1 / 0.3e1 * t233 * t1974 + t33 * t3995 * t46 / 0.4e1 + 0.7e1 / 0.9e1 * t939 * t519 - 0.2e1 / 0.3e1 * t363 * t1731 + t51 * t4028 * t46 / 0.4e1;
  t4041 = -0.24e2 * t3536 + 0.7e1 / 0.18e2 * t3538 + 0.28e2 / 0.3e1 * t3540 + 0.8e1 / 0.9e1 * t3542 + 0.32e2 / 0.3e1 * t3544 + 0.3e1 / 0.2e1 * t3546 + 0.12e2 * t3548 + 0.28e2 / 0.3e1 * t3882 + 0.32e2 / 0.3e1 * t3884 + 0.12e2 * t3886 + 0.4e2 / 0.3e1 * t3888 + t30 * t4032 / 0.2e1 + 0.4e1 / 0.3e1 * t246 * t1984 + 0.4e1 / 0.3e1 * t372 * t1734 + t64 * t4032 / 0.2e1;
  t4060 = t171 * t1900;
  t4062 = t171 * t1918;
  t4065 = t89 * t1664 * t869;
  t4068 = t89 * t708 * t1917;
  t4071 = t89 * t174 * t3995;
  t4073 = t876 * t551;
  t4075 = t876 * t554;
  t4077 = t323 * t1693;
  t4079 = t323 * t1696;
  t4081 = t323 * t1713;
  t4083 = t736 * t736;
  t4085 = t96 * t4083 * t45;
  t4088 = t96 * t1266 * t1712;
  t4091 = t96 * t1692 * t892;
  t4094 = t96 * t725 * t1944;
  t4097 = t96 * t183 * t4028;
  t4099 = t538 * t858;
  t4101 = t171 * t1896;
  t4103 = t719 * t719;
  t4105 = t89 * t4103 * t45;
  t4108 = t89 * t1240 * t1684;
  t4110 = t538 * t870;
  t4112 = -0.4e1 / 0.3e1 * t4060 - 0.4e1 / 0.3e1 * t4062 + t4065 / 0.4e1 + t4068 / 0.2e1 + t4071 / 0.4e1 + 0.22e2 / 0.9e1 * t4073 + 0.22e2 / 0.9e1 * t4075 - 0.4e1 / 0.3e1 * t4077 - 0.8e1 / 0.3e1 * t4079 - 0.4e1 / 0.3e1 * t4081 + t4085 / 0.2e1 + t4088 / 0.2e1 + t4091 / 0.4e1 + t4094 / 0.2e1 + t4097 / 0.4e1 + 0.22e2 / 0.9e1 * t4099 - 0.8e1 / 0.3e1 * t4101 + t4105 / 0.2e1 + t4108 / 0.2e1 + 0.22e2 / 0.9e1 * t4110;
  t4136 = t4085 + t4088 + t4091 / 0.2e1 + t4094 + t4097 / 0.2e1 + 0.44e2 / 0.9e1 * t4099 - 0.16e2 / 0.3e1 * t4101 + t4105 + t4108 - t3375 + 0.44e2 / 0.9e1 * t4110;
  t4137 = -0.8e1 / 0.3e1 * t4060 - 0.8e1 / 0.3e1 * t4062 + t4065 / 0.2e1 + t4068 + t4071 / 0.2e1 + 0.44e2 / 0.9e1 * t4073 + 0.44e2 / 0.9e1 * t4075 - 0.8e1 / 0.3e1 * t4077 - 0.16e2 / 0.3e1 * t4079 - 0.8e1 / 0.3e1 * t4081 + t4136;
  t4141 = 0.3e1 / 0.2e1 * t251 * t1984 + 0.3e1 / 0.2e1 * t377 * t1734 + t68 * t4032 / 0.2e1 + 0.5e1 / 0.3e1 * t256 * t1984 + 0.5e1 / 0.3e1 * t383 * t1734 + t81 * t4032 / 0.2e1 + 0.11e2 / 0.6e1 * t261 * t1984 + 0.11e2 / 0.6e1 * t388 * t1734 + t85 * t4112 / 0.2e1 + 0.3e1 / 0.2e1 * t266 * t2022 + 0.3e1 / 0.2e1 * t393 * t1771 + 0.2e1 * t336 * t1771 + t119 * t4137 + 0.3e1 * t216 * t1948;
  t4169 = 0.3e1 * t343 * t1716 + t133 * t4137 + 0.1e2 / 0.3e1 * t220 * t1948 + 0.1e2 / 0.3e1 * t347 * t1716 + t136 * t4137 + 0.11e2 / 0.3e1 * t224 * t1948 + 0.11e2 / 0.3e1 * t351 * t1716 + t139 * t4137 + 0.4e1 * t228 * t1948 + 0.4e1 * t355 * t1716 + 0.55e2 / 0.36e2 * t901 * t585 + 0.2e1 / 0.9e1 * t905 * t522 + 0.3e1 / 0.8e1 * t909 * t522 + 0.5e1 / 0.9e1 * t913 * t522 + 0.55e2 / 0.72e2 * t916 * t522;
  t4199 = 0.3e1 / 0.8e1 * t919 * t557 + 0.5e1 / 0.9e1 * t922 * t557 + 0.55e2 / 0.72e2 * t925 * t557 + 0.3e1 / 0.4e1 * t928 * t585 + 0.1e2 / 0.9e1 * t931 * t585 + t105 * t4112 / 0.2e1 + 0.5e1 / 0.3e1 * t194 * t2022 + 0.5e1 / 0.3e1 * t398 * t1771 + t110 * t4112 / 0.2e1 + 0.11e2 / 0.6e1 * t199 * t2022 + 0.11e2 / 0.6e1 * t310 * t1771 + t115 * t4112 / 0.2e1 + 0.2e1 * t204 * t2022 + 0.55e2 / 0.36e2 * t632 * t896;
  t4210 = t1015 * t144;
  t4212 = t1018 * t144;
  t4214 = t1021 * t144;
  t4216 = t1024 * t144;
  t4227 = 0.2e1 / 0.9e1 * t600 * t947 + 0.3e1 / 0.8e1 * t604 * t947 + 0.5e1 / 0.9e1 * t608 * t947 + 0.55e2 / 0.72e2 * t612 * t947 + 0.3e1 / 0.8e1 * t615 * t971 + 0.7e1 / 0.18e2 * t4210 + 0.8e1 / 0.9e1 * t4212 + 0.3e1 / 0.2e1 * t4214 + 0.2e2 / 0.9e1 * t4216 + 0.5e1 / 0.9e1 * t618 * t971 + 0.55e2 / 0.72e2 * t621 * t971 + 0.3e1 / 0.4e1 * t624 * t896 + 0.1e2 / 0.9e1 * t627 * t896 + 0.2e1 * t3579 + t3581;
  tv4rho42 = t3926 + t3938 + t3954 + t4041 + t4141 + t4169 + t4199 + t4227;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t4230 = t2290 * t175;
  t4232 = t2290 * t273;
  t4234 = t2293 * t175;
  t4236 = t2293 * t273;
  t4238 = t2296 * t175;
  t4240 = t2296 * t273;
  t4242 = t2299 * t175;
  t4244 = t2299 * t273;
  t4249 = -0.35e2 / 0.108e3 * t4230 + 0.35e2 / 0.108e3 * t4232 - 0.16e2 / 0.27e2 * t4234 + 0.16e2 / 0.27e2 * t4236 - 0.3e1 / 0.4e1 * t4238 + 0.3e1 / 0.4e1 * t4240 - 0.2e2 / 0.27e2 * t4242 + 0.2e2 / 0.27e2 * t4244 + t3595 + t3597 + 0.7e1 / 0.2e1 * t3908 + 0.8e1 * t3912 + 0.27e2 / 0.2e1 * t3916;
  t4256 = 0.2e2 * t3920 - t3599 - 0.84e2 * t3600 - t3603 - 0.96e2 * t3604 - t3607 - 0.108e3 * t3608 - t3611 - 0.12e3 * t3612 - t3614 - 0.4e2 * t3434 + t3616 + t3442;
  t4261 = t3618 + t3446 + t3619 + t3450 + t3622 + t3461 - t3623 - 0.28e2 * t3468 - t3631 - 0.32e2 * t3486 - t3636 - 0.36e2 * t3502 - t3643;
  t4272 = -t3645 - t3647 - t3649 + t3883 + t3885 + t3887 + t3889 - 0.7e1 / 0.6e1 * t4210 - 0.8e1 / 0.3e1 * t4212 - 0.9e1 / 0.2e1 * t4214 - 0.2e2 / 0.3e1 * t4216 + 0.9e1 / 0.8e1 * t909 * t761 + 0.5e1 / 0.3e1 * t913 * t761 + 0.55e2 / 0.24e2 * t916 * t761;
  t4301 = 0.12e2 * t659 + 0.24e2 * t3266;
  t4305 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3254 * t2144 * t176 - 0.16e2 / 0.9e1 * t1903 * t499 - 0.8e1 / 0.9e1 * t1670 * t865 * t176 + 0.8e1 / 0.3e1 * t1673 * t272 * t865 + 0.4e1 / 0.3e1 * t712 * t1913 + 0.4e1 / 0.9e1 * t495 * t2150 * t176 + 0.4e1 / 0.3e1 * t42 * t4301);
  t4334 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3278 * t2173 * t184 + 0.16e2 / 0.9e1 * t1932 * t499 - 0.8e1 / 0.9e1 * t1698 * t888 * t184 - 0.8e1 / 0.3e1 * t1701 * t272 * t888 + 0.4e1 / 0.3e1 * t729 * t1940 + 0.4e1 / 0.9e1 * t510 * t2178 * t184 - 0.4e1 / 0.3e1 * t54 * t4301);
  t4338 = -t233 * t2222 / 0.3e1 + t33 * t4305 * t46 / 0.4e1 - 0.7e2 / 0.27e2 * t2227 * t239 + 0.7e1 / 0.3e1 * t939 * t758 - t363 * t1981 + t51 * t4334 * t46 / 0.4e1;
  t4357 = t171 * t2141;
  t4360 = t89 * t2610 * t869;
  t4363 = t89 * t1240 * t1917;
  t4365 = t171 * t2155;
  t4368 = t89 * t708 * t2154;
  t4371 = t89 * t174 * t4305;
  t4373 = t2161 * t188;
  t4375 = t876 * t726;
  t4377 = t876 * t737;
  t4379 = t323 * t1927;
  t4381 = t323 * t1929;
  t4383 = t323 * t1945;
  t4386 = t96 * t2756 * t892;
  t4389 = t96 * t1266 * t1944;
  t4392 = t96 * t725 * t2182;
  t4395 = t96 * t183 * t4334;
  t4397 = -0.2e1 * t4357 + 0.3e1 / 0.4e1 * t4360 + 0.3e1 / 0.4e1 * t4363 - 0.2e1 / 0.3e1 * t4365 + t4368 / 0.4e1 + t4371 / 0.4e1 - 0.308e3 / 0.27e2 * t4373 + 0.22e2 / 0.3e1 * t4375 + 0.22e2 / 0.3e1 * t4377 - 0.4e1 * t4379 - 0.2e1 * t4381 - 0.2e1 * t4383 + 0.3e1 / 0.4e1 * t4386 + 0.3e1 / 0.4e1 * t4389 + t4392 / 0.4e1 + t4395 / 0.4e1;
  t4400 = 0.9e1 / 0.8e1 * t919 * t793 + 0.5e1 / 0.3e1 * t922 * t793 + 0.55e2 / 0.24e2 * t925 * t793 + t64 * t4338 / 0.2e1 + 0.3e1 / 0.4e1 * t251 * t2236 + 0.9e1 / 0.4e1 * t377 * t1984 + t68 * t4338 / 0.2e1 + 0.5e1 / 0.6e1 * t256 * t2236 + 0.5e1 / 0.2e1 * t383 * t1984 + t81 * t4338 / 0.2e1 + 0.11e2 / 0.12e2 * t261 * t2236 + 0.11e2 / 0.4e1 * t388 * t1984 + t85 * t4397 / 0.2e1;
  t4427 = 0.3e1 / 0.4e1 * t266 * t2186 + 0.9e1 / 0.4e1 * t393 * t2022 - 0.55e2 / 0.432e3 * t2258 * t242 - 0.3e1 / 0.16e2 * t2261 * t191 - 0.5e1 / 0.27e2 * t2264 * t191 - 0.55e2 / 0.432e3 * t2267 * t191 - 0.3e1 / 0.8e1 * t2270 * t214 - 0.1e2 / 0.27e2 * t2273 * t214 + 0.9e1 / 0.4e1 * t928 * t740 + 0.1e2 / 0.3e1 * t931 * t740 + 0.55e2 / 0.12e2 * t901 * t740 - 0.55e2 / 0.216e3 * t2113 * t214 - 0.4e1 / 0.27e2 * t2116 * t242;
  t4466 = -0.4e1 * t4357 + 0.3e1 / 0.2e1 * t4360 + 0.3e1 / 0.2e1 * t4363 - 0.4e1 / 0.3e1 * t4365 + t4368 / 0.2e1 + t4371 / 0.2e1 - 0.616e3 / 0.27e2 * t4373 + 0.44e2 / 0.3e1 * t4375 + 0.44e2 / 0.3e1 * t4377 - 0.8e1 * t4379 - 0.4e1 * t4381 - 0.4e1 * t4383 + 0.3e1 / 0.2e1 * t4386 + 0.3e1 / 0.2e1 * t4389 + t4392 / 0.2e1 + t4395 / 0.2e1 - t3375;
  t4470 = -0.3e1 / 0.16e2 * t2120 * t242 - 0.5e1 / 0.27e2 * t2123 * t242 + 0.2e1 / 0.3e1 * t905 * t761 + 0.5e1 / 0.6e1 * t194 * t2186 + 0.5e1 / 0.2e1 * t398 * t2022 + t110 * t4397 / 0.2e1 + 0.11e2 / 0.12e2 * t199 * t2186 + 0.11e2 / 0.4e1 * t310 * t2022 + t115 * t4397 / 0.2e1 + t204 * t2186 + 0.3e1 * t336 * t2022 + t119 * t4466 + 0.3e1 / 0.2e1 * t216 * t2207;
  t4496 = 0.9e1 / 0.2e1 * t343 * t1948 + t133 * t4466 + 0.5e1 / 0.3e1 * t220 * t2207 + 0.5e1 * t347 * t1948 + t136 * t4466 + 0.11e2 / 0.6e1 * t224 * t2207 + 0.11e2 / 0.2e1 * t351 * t1948 + t139 * t4466 + 0.2e1 * t228 * t2207 + 0.6e1 * t355 * t1948 + t30 * t4338 / 0.2e1 + 0.2e1 / 0.3e1 * t246 * t2236 + 0.2e1 * t372 * t1984 + t105 * t4397 / 0.2e1;
  tv4rho43 = t4249 + t4256 + t4261 + t4272 + t4400 + t4427 + t4470 + t4496;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t4502 = 0.1e1 / t18 / t93;
  t4526 = 0.4e2 / 0.81e2 * t8 * t95 + 0.9e1 / 0.16e2 * t15 * t4502 + 0.4e2 / 0.81e2 * t22 * t362 + 0.385e3 / 0.1296e4 * t1 * t3112 + 0.12e2 * t3903 + 0.6e1 * t3905 + 0.385e3 / 0.1296e4 * t141 * t3112 * t145 + 0.4e2 / 0.81e2 * t147 * t95 * t145 + 0.9e1 / 0.16e2 * t150 * t4502 * t145 + 0.4e2 / 0.81e2 * t153 * t362 * t145 + 0.35e2 / 0.27e2 * t4230 + 0.35e2 / 0.27e2 * t4232 + 0.64e2 / 0.27e2 * t4234;
  t4541 = 0.64e2 / 0.27e2 * t4236 + 0.3e1 * t4238 + 0.3e1 * t4240 + 0.8e2 / 0.27e2 * t4242 + 0.8e2 / 0.27e2 * t4244 + 0.28e2 / 0.3e1 * t3906 + 0.7e1 * t3908 + 0.64e2 / 0.3e1 * t3910 + 0.16e2 * t3912 + 0.36e2 * t3914 + 0.27e2 * t3916 + 0.16e3 / 0.3e1 * t3918 + 0.4e2 * t3920 - 0.168e3 * t3598;
  t4550 = -0.112e3 * t3600 - 0.192e3 * t3602 - 0.128e3 * t3604 - 0.216e3 * t3606 - 0.144e3 * t3608 - 0.24e3 * t3610 - 0.16e3 * t3612 + t3437 + t3442 + t3444 + t3446 + t3448 + t3450;
  t4559 = t3459 + t3461 + t3529 + t3531 + t3533 + t3537 - 0.56e2 * t3882 - 0.64e2 * t3884 - 0.72e2 * t3886 - 0.8e2 * t3888 + 0.7e1 / 0.3e1 * t4210 + 0.16e2 / 0.3e1 * t4212 + 0.9e1 * t4214 + 0.4e2 / 0.3e1 * t4216;
  t4580 = t869 * t869;
  t4582 = t89 * t4580 * t45;
  t4585 = t89 * t1240 * t2154;
  t4587 = t861 * t861;
  t4592 = t865 * t865;
  t4598 = 0.24e2 * t659 + 0.24e2 * t3266;
  t4602 = my_piecewise3(t39, 0, 0.4e2 / 0.81e2 * t3254 * t4587 - 0.16e2 / 0.9e1 * t1903 * t865 + 0.4e1 / 0.3e1 * t495 * t4592 + 0.16e2 / 0.9e1 * t712 * t2150 + 0.4e1 / 0.3e1 * t42 * t4598);
  t4604 = t89 * t174 * t4602;
  t4610 = sigma[2] / t25 / t873 / t93 * t98;
  t4612 = t2161 * t330;
  t4614 = t876 * t882;
  t4616 = t876 * t893;
  t4618 = t323 * t2170;
  t4620 = t323 * t2183;
  t4622 = t892 * t892;
  t4624 = t96 * t4622 * t45;
  t4627 = t96 * t1266 * t2182;
  t4629 = t885 * t885;
  t4634 = t888 * t888;
  t4643 = my_piecewise3(t53, 0, 0.4e2 / 0.81e2 * t3278 * t4629 - 0.16e2 / 0.9e1 * t1932 * t888 + 0.4e1 / 0.3e1 * t510 * t4634 + 0.16e2 / 0.9e1 * t729 * t2178 - 0.4e1 / 0.3e1 * t54 * t4598);
  t4645 = t96 * t183 * t4643;
  t4647 = 0.3e1 / 0.2e1 * t4582 + 0.2e1 * t4585 + t4604 / 0.2e1 + 0.5236e4 / 0.81e2 * t4610 - 0.2464e4 / 0.27e2 * t4612 + 0.88e2 / 0.3e1 * t4614 + 0.88e2 / 0.3e1 * t4616 - 0.16e2 * t4618 - 0.16e2 / 0.3e1 * t4620 + 0.3e1 / 0.2e1 * t4624 + 0.2e1 * t4627 + t4645 / 0.2e1 - t3375;
  t4654 = -0.55e2 / 0.108e3 * t2258 * t369 - 0.3e1 / 0.4e1 * t2261 * t333 - 0.2e2 / 0.27e2 * t2264 * t333 - 0.55e2 / 0.108e3 * t2267 * t333 - 0.3e1 / 0.2e1 * t2270 * t341 - 0.4e2 / 0.27e2 * t2273 * t341 - 0.16e2 / 0.27e2 * t2116 * t369 - 0.3e1 / 0.4e1 * t2120 * t369 - 0.2e2 / 0.27e2 * t2123 * t369 + t119 * t4647 + 0.6e1 * t343 * t2207 + t133 * t4647 + 0.2e2 / 0.3e1 * t347 * t2207;
  t4678 = t33 * t4602 * t46 / 0.4e1 + 0.91e3 / 0.81e2 * t49 / t11 / t2158 * t57 - 0.28e3 / 0.27e2 * t2227 * t366 + 0.14e2 / 0.3e1 * t939 * t944 - 0.4e1 / 0.3e1 * t363 * t2233 + t51 * t4643 * t46 / 0.4e1;
  t4705 = 0.3e1 / 0.4e1 * t4582 + t4585 + t4604 / 0.4e1 + 0.2618e4 / 0.81e2 * t4610 - 0.1232e4 / 0.27e2 * t4612 + 0.44e2 / 0.3e1 * t4614 + 0.44e2 / 0.3e1 * t4616 - 0.8e1 * t4618 - 0.8e1 / 0.3e1 * t4620 + 0.3e1 / 0.4e1 * t4624 + t4627 + t4645 / 0.4e1;
  t4710 = t136 * t4647 + 0.22e2 / 0.3e1 * t351 * t2207 + t139 * t4647 + 0.8e1 * t355 * t2207 + t30 * t4678 / 0.2e1 + 0.8e1 / 0.3e1 * t372 * t2236 + t64 * t4678 / 0.2e1 + 0.3e1 * t377 * t2236 + t68 * t4678 / 0.2e1 + 0.1e2 / 0.3e1 * t383 * t2236 + t81 * t4678 / 0.2e1 + 0.11e2 / 0.3e1 * t388 * t2236 + t85 * t4705 / 0.2e1 + 0.3e1 * t393 * t2186;
  t4738 = t105 * t4705 / 0.2e1 + 0.1e2 / 0.3e1 * t398 * t2186 + t110 * t4705 / 0.2e1 + 0.11e2 / 0.3e1 * t310 * t2186 + t115 * t4705 / 0.2e1 + 0.4e1 * t336 * t2186 + 0.9e1 / 0.2e1 * t928 * t896 + 0.2e2 / 0.3e1 * t931 * t896 + 0.55e2 / 0.6e1 * t901 * t896 + 0.4e1 / 0.3e1 * t905 * t947 + 0.9e1 / 0.4e1 * t909 * t947 + 0.1e2 / 0.3e1 * t913 * t947 + 0.55e2 / 0.12e2 * t916 * t947;
  t4777 = 0.9e1 / 0.4e1 * t919 * t971 + 0.385e3 / 0.2592e4 * t71 * t1307 * t60 + 0.9e1 / 0.32e2 * t84 * t4502 * t101 + 0.2e2 / 0.81e2 * t104 * t362 * t101 + 0.385e3 / 0.2592e4 * t109 * t1307 * t101 + 0.9e1 / 0.16e2 * t118 * t4502 * t130 + 0.4e2 / 0.81e2 * t132 * t362 * t130 - 0.55e2 / 0.54e2 * t2113 * t341 + 0.385e3 / 0.1296e4 * t135 * t1307 * t130 + 0.2e2 / 0.81e2 * t29 * t95 * t60 + 0.9e1 / 0.32e2 * t63 * t4502 * t60 + 0.2e2 / 0.81e2 * t67 * t362 * t60 + 0.1e2 / 0.3e1 * t922 * t971 + 0.55e2 / 0.12e2 * t925 * t971;
  tv4rho44 = t4526 + t4541 + t4550 + t4559 + t4654 + t4710 + t4738 + t4777;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t4780 = t138 * t1036;
  t4783 = t170 * t543 * t45;
  t4786 = t1376 * t90 * t45;
  t4820 = t2417 * t180;
  t4824 = 0.6e1 * t4780 - t110 * t4783 - 0.77e2 / 0.27e2 * t115 * t4786 - t115 * t4783 - 0.77e2 / 0.27e2 * t105 * t4786 - t105 * t4783 + 0.35e2 / 0.54e2 * t29 * t2425 * t1052 + 0.85e2 / 0.128e3 * t63 * t2413 * t1052 + 0.145e3 / 0.216e3 * t67 * t88 * t1052 + 0.2321e4 / 0.3456e4 * t71 * t3412 * t1052 - 0.77e2 / 0.27e2 * t110 * t4786 - 0.7e1 / 0.12e2 * t2372 * t2393 - 0.77e2 / 0.27e2 * t85 * t4786 - t85 * t4783 - 0.39e2 / 0.64e2 * t2375 * t2393 - 0.5e1 / 0.8e1 * t2378 * t2393 - 0.121e3 / 0.192e3 * t2381 * t2393 - 0.99e2 / 0.32e2 * t2414 * t180 - 0.13e2 / 0.4e1 * t4820 - 0.87e2 / 0.32e2 * t2422 * t180;
  t4834 = t418 * t505 * t46;
  t4846 = t232 * t505 * t46;
  t4860 = t110 * t537;
  t4864 = t32 * t1403 * t46;
  t4873 = t85 * t537;
  t4876 = -t424 * t4846 / 0.4e1 - t427 * t4846 / 0.4e1 - t430 * t4846 / 0.4e1 + 0.3e1 / 0.8e1 * t1109 * t1386 + t1109 * t1404 / 0.8e1 + 0.11e2 / 0.3e1 * t4860 * t180 + t419 * t4864 / 0.16e2 + t424 * t4864 / 0.16e2 + t427 * t4864 / 0.16e2 + t430 * t4864 / 0.16e2 + 0.11e2 / 0.3e1 * t4873 * t180;
  t4883 = t488 * t179 * t46;
  t4887 = t1534 * t44 * t46;
  t4906 = t115 * t537;
  t4918 = t105 * t537;
  t4924 = 0.3e1 / 0.8e1 * t1090 * t1386 + t1090 * t1404 / 0.8e1 + 0.11e2 / 0.3e1 * t4906 * t180 - t2457 * t547 + 0.3e1 / 0.8e1 * t1093 * t1386 + t1093 * t1404 / 0.8e1 + 0.7e1 / 0.12e2 * t424 * t4883 + t1106 * t1404 / 0.8e1 + 0.11e2 / 0.3e1 * t4918 * t180 - t2447 * t547 + 0.3e1 / 0.4e1 * t1087 * t544;
  t4936 = t113 * t170 * t91;
  t4950 = t537 * t44;
  t4960 = 0.1232e4 / 0.27e2 * t1449;
  t4961 = -0.308e3 / 0.27e2 * t4786 + 0.44e2 / 0.3e1 * t4950 * t708 - 0.4e1 * t4783 - 0.4e1 * t2335 * t1664 + 0.3e1 / 0.2e1 * t2607 * t1664 + t1032 * t3697 / 0.2e1 + t4960;
  t4987 = 0.9e1 / 0.2e1 * t216 * t2344 + t133 * t4961 + 0.5e1 * t220 * t2344 + t136 * t4961 + 0.11e2 / 0.2e1 * t224 * t2344 + 0.9e1 / 0.4e1 * t624 * t1036 + 0.1e2 / 0.3e1 * t627 * t1036 + 0.55e2 / 0.12e2 * t632 * t1036 - 0.3e1 / 0.8e1 * t1520 * t444 - 0.1e2 / 0.27e2 * t1523 * t444 - 0.55e2 / 0.216e3 * t1526 * t444;
  tv4rho3sigma0 = t4824 + t4876 + 0.7e1 / 0.12e2 * t419 * t4883 - t2452 * t547 + 0.9e1 / 0.16e2 * t1075 * t544 + 0.5e1 / 0.8e1 * t1079 * t544 + 0.11e2 / 0.16e2 * t1083 * t544 + t139 * t4961 + 0.6e1 * t228 * t2344 + t119 * t4961 - 0.35e2 / 0.12e2 * t2426 * t180 + 0.3e1 / 0.4e1 * t1087 * t547 + 0.9e1 / 0.16e2 * t1075 * t547 + 0.5e1 / 0.8e1 * t1079 * t547 + t1050 * t4834 / 0.4e1 + 0.9e1 / 0.32e2 * t1055 * t4834 + 0.5e1 / 0.16e2 * t1058 * t4834 + 0.11e2 / 0.32e2 * t1061 * t4834 + 0.11e2 / 0.16e2 * t1083 * t547 - t419 * t4846 / 0.4e1 - t2441 * t547 + 0.3e1 / 0.8e1 * t1106 * t1386 + 0.7e1 / 0.12e2 * t430 * t4883 - 0.35e2 / 0.54e2 * t424 * t4887 - 0.35e2 / 0.54e2 * t427 * t4887 - 0.35e2 / 0.54e2 * t430 * t4887 - 0.35e2 / 0.54e2 * t419 * t4887 + 0.7e1 / 0.12e2 * t427 * t4883 + t4987 + 0.8e1 / 0.3e1 * t4936 + t4924 + 0.8921e4 / 0.3456e4 * t109 / t74 / t168 * t91 + 0.301e3 / 0.128e3 * t84 / t2 / t535 * t91 + 0.535e3 / 0.216e3 * t104 / t535 * t91;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t4992 = t624 * t211;
  t4994 = t216 * t582;
  t4997 = 0.2464e4 / 0.27e2 * t119 * t1449;
  t5000 = t627 * t211;
  t5002 = t220 * t582;
  t5005 = 0.2464e4 / 0.27e2 * t133 * t1449;
  t5008 = t632 * t211;
  t5010 = t224 * t582;
  t5013 = 0.2464e4 / 0.27e2 * t136 * t1449;
  t5014 = t138 * t211;
  t5015 = 0.32e2 * t5014;
  t5016 = t228 * t582;
  t5019 = 0.2464e4 / 0.27e2 * t139 * t1449;
  tv4rho3sigma1 = 0.3e1 / 0.4e1 * t1520 * t128 + 0.12e2 * t4992 - 0.88e2 * t4994 + t4997 + 0.2e2 / 0.27e2 * t1523 * t128 + 0.16e3 / 0.9e1 * t5000 - 0.88e3 / 0.9e1 * t5002 + t5005 + 0.55e2 / 0.108e3 * t1526 * t128 + 0.22e3 / 0.9e1 * t5008 - 0.968e3 / 0.9e1 * t5010 + t5013 + t5015 - 0.352e3 / 0.3e1 * t5016 + t5019;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t5020 = t138 * t1187;
  t5026 = t2546 * t188;
  t5038 = t615 * t95;
  t5047 = 0.6e1 * t5020 - 0.3e1 / 0.128e3 * t1511 * t470 + 0.9e1 / 0.16e2 * t266 * t2517 + 0.3e1 / 0.4e1 * t5026 + 0.3e1 / 0.4e1 * t204 * t2517 - 0.5e1 / 0.216e3 * t1514 * t470 + 0.5e1 / 0.8e1 * t194 * t2517 - 0.55e2 / 0.3456e4 * t1517 * t470 + 0.11e2 / 0.16e2 * t199 * t2517 + 0.9e1 / 0.32e2 * t5038 * t188 + 0.3e1 / 0.8e1 * t1174 * t1407 + t1174 * t1423 / 0.8e1 + 0.3e1 / 0.4e1 * t2564 * t554;
  t5055 = t50 * t1422 * t46;
  t5066 = t618 * t95;
  t5075 = t621 * t95;
  t5080 = 0.3e1 / 0.8e1 * t1179 * t1407 + t1179 * t1423 / 0.8e1 + t1139 * t2572 / 0.4e1 + t455 * t5055 / 0.16e2 + 0.9e1 / 0.32e2 * t1146 * t2572 + 0.3e1 / 0.8e1 * t1163 * t1407 + t1163 * t1423 / 0.8e1 + 0.9e1 / 0.16e2 * t2587 * t554 + 0.5e1 / 0.12e2 * t5066 * t188 + 0.5e1 / 0.8e1 * t2554 * t554 + 0.3e1 / 0.8e1 * t1168 * t1407 + t1168 * t1423 / 0.8e1 + 0.55e2 / 0.96e2 * t5075 * t188 + 0.11e2 / 0.16e2 * t2559 * t554;
  t5112 = -0.5e1 / 0.216e3 * t1503 * t454 * t457 - 0.55e2 / 0.3456e4 * t1507 * t454 * t457 - t1496 * t454 * t457 / 0.54e2 + 0.9e1 / 0.64e2 * t2590 * t1143 + 0.5e1 / 0.24e2 * t2593 * t1143 + 0.55e2 / 0.192e3 * t2596 * t1143 - 0.3e1 / 0.128e3 * t1500 * t454 * t457 + t2599 * t1143 / 0.12e2 + t460 * t5055 / 0.16e2 + 0.5e1 / 0.16e2 * t1151 * t2572 + t463 * t5055 / 0.16e2 + 0.11e2 / 0.32e2 * t1156 * t2572 + t466 * t5055 / 0.16e2;
  t5119 = 0.3e1 / 0.2e1 * t2753 * t1692 + t1184 * t3741 / 0.2e1 + t4960;
  t5142 = 0.6e1 * t228 * t2521 + t139 * t5119 + 0.9e1 / 0.2e1 * t216 * t2521 + t119 * t5119 + 0.5e1 * t220 * t2521 + t133 * t5119 + 0.9e1 / 0.4e1 * t624 * t1187 + 0.1e2 / 0.3e1 * t627 * t1187 + 0.55e2 / 0.12e2 * t632 * t1187 + 0.11e2 / 0.2e1 * t224 * t2521 + t136 * t5119 - 0.3e1 / 0.8e1 * t1520 * t480 - 0.1e2 / 0.27e2 * t1523 * t480 - 0.55e2 / 0.216e3 * t1526 * t480;
  tv4rho3sigma2 = t5047 + t5080 + t5112 + t5142;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t5144 = t138 * t1243;
  t5151 = t418 * t719 * t46;
  t5170 = 0.2e1 * t5144 + t1087 * t709 / 0.2e1 + t1087 * t720 / 0.2e1 + t1050 * t5151 / 0.6e1 + 0.3e1 / 0.16e2 * t1055 * t5151 + 0.5e1 / 0.24e2 * t1058 * t5151 + 0.11e2 / 0.48e2 * t1061 * t5151 + 0.3e1 / 0.8e1 * t1075 * t709 + 0.3e1 / 0.8e1 * t1075 * t720 + 0.5e1 / 0.12e2 * t1079 * t709 + 0.5e1 / 0.12e2 * t1079 * t720 + 0.11e2 / 0.24e2 * t1083 * t709;
  t5189 = t2417 * t317;
  t5197 = 0.11e2 / 0.24e2 * t1083 * t720 + 0.3e1 / 0.16e2 * t393 * t2339 - 0.7e1 / 0.36e2 * t2372 * t2642 - 0.13e2 / 0.64e2 * t2375 * t2642 - 0.5e1 / 0.24e2 * t2378 * t2642 - 0.121e3 / 0.576e3 * t2381 * t2642 - 0.29e2 / 0.32e2 * t2422 * t317 - 0.35e2 / 0.36e2 * t2426 * t317 - 0.33e2 / 0.32e2 * t2414 * t317 - 0.13e2 / 0.12e2 * t5189 + 0.11e2 / 0.12e2 * t393 * t2333 + 0.121e3 / 0.108e3 * t310 * t2333 + 0.11e2 / 0.48e2 * t310 * t2339;
  t5215 = t398 * t170;
  t5224 = 0.11e2 / 0.9e1 * t336 * t2333 + t336 * t2339 / 0.4e1 + 0.55e2 / 0.54e2 * t398 * t2333 + 0.5e1 / 0.24e2 * t398 * t2339 - 0.2e1 / 0.3e1 * t2452 * t709 + t1106 * t1665 / 0.8e1 + t1106 * t1668 / 0.4e1 + t1106 * t1685 / 0.8e1 - 0.1e2 / 0.9e1 * t5215 * t180 + 0.5e1 / 0.24e2 * t2722 * t547 + t1093 * t1668 / 0.4e1 + 0.11e2 / 0.9e1 * t4918 * t317;
  t5232 = t488 * t316 * t46;
  t5244 = t232 * t719 * t46;
  t5255 = 0.11e2 / 0.9e1 * t4860 * t317 + 0.11e2 / 0.9e1 * t4906 * t317 + 0.7e1 / 0.27e2 * t1199 * t2467 + 0.7e1 / 0.36e2 * t419 * t5232 + 0.7e1 / 0.24e2 * t1206 * t2467 + 0.7e1 / 0.36e2 * t424 * t5232 + 0.35e2 / 0.108e3 * t1211 * t2467 + 0.7e1 / 0.36e2 * t427 * t5232 - t427 * t5244 / 0.6e1 - 0.11e2 / 0.36e2 * t1216 * t2463 - t430 * t5244 / 0.6e1 + 0.77e2 / 0.216e3 * t1216 * t2467 + 0.7e1 / 0.36e2 * t430 * t5232;
  t5282 = 0.11e2 / 0.9e1 * t4873 * t317 - 0.2e1 / 0.3e1 * t2452 * t720 - 0.2e1 / 0.3e1 * t2457 * t709 - 0.2e1 / 0.3e1 * t2457 * t720 - 0.2e1 / 0.9e1 * t1199 * t2463 - t419 * t5244 / 0.6e1 - t1206 * t2463 / 0.4e1 - t424 * t5244 / 0.6e1 - 0.5e1 / 0.18e2 * t1211 * t2463 - 0.2e1 / 0.3e1 * t2441 * t709 - 0.2e1 / 0.3e1 * t2441 * t720 - 0.2e1 / 0.3e1 * t2447 * t709;
  t5290 = t32 * t1684 * t46;
  t5305 = t393 * t170;
  t5311 = -0.2e1 / 0.3e1 * t2447 * t720 + t1093 * t1685 / 0.8e1 + t1199 * t2432 / 0.12e2 + t419 * t5290 / 0.16e2 + 0.3e1 / 0.32e2 * t1206 * t2432 + t424 * t5290 / 0.16e2 + 0.5e1 / 0.48e2 * t1211 * t2432 + t427 * t5290 / 0.16e2 + 0.11e2 / 0.96e2 * t1216 * t2432 + t430 * t5290 / 0.16e2 - t5305 * t180 + t1109 * t1665 / 0.8e1 + t1109 * t1668 / 0.4e1;
  t5315 = t310 * t170;
  t5326 = t336 * t170;
  t5339 = t1109 * t1685 / 0.8e1 - 0.11e2 / 0.9e1 * t5315 * t180 + 0.11e2 / 0.48e2 * t2729 * t547 + t1090 * t1665 / 0.8e1 + t1090 * t1668 / 0.4e1 + t1090 * t1685 / 0.8e1 - 0.4e1 / 0.3e1 * t5326 * t180 + t2673 * t547 / 0.4e1 + t1093 * t1665 / 0.8e1 + 0.3e1 / 0.16e2 * t2698 * t547 + 0.3e1 / 0.4e1 * t624 * t1243 + 0.1e2 / 0.9e1 * t627 * t1243;
  t5356 = 0.44e2 / 0.9e1 * t4950 * t1240 - 0.8e1 / 0.3e1 * t170 * t179 * t1240 - 0.8e1 / 0.3e1 * t2335 * t2610 + t88 * t505 * t1240 / 0.2e1 + t2607 * t2610 + t1032 * t45 * t1684 / 0.2e1 + t4960;
  t5377 = 0.55e2 / 0.36e2 * t632 * t1243 + t139 * t5356 + 0.4e1 * t228 * t2613 + 0.3e1 / 0.2e1 * t343 * t2344 + t119 * t5356 + 0.3e1 * t216 * t2613 + 0.5e1 / 0.3e1 * t347 * t2344 + t133 * t5356 + 0.1e2 / 0.3e1 * t220 * t2613 + 0.11e2 / 0.6e1 * t351 * t2344 + t136 * t5356 + 0.11e2 / 0.3e1 * t224 * t2613 + 0.2e1 * t355 * t2344;
  tv4rho3sigma3 = t5170 + t5197 + t5224 + t5255 + t5282 + t5311 + t5339 + t5377;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  t5380 = t343 * t582;
  t5384 = t347 * t582;
  t5388 = t351 * t582;
  t5392 = t355 * t582;
  t5394 = 0.32e2 / 0.3e1 * t5014;
  tv4rho3sigma4 = -0.88e2 / 0.3e1 * t5380 + 0.4e1 * t4992 - 0.176e3 / 0.3e1 * t4994 + t4997 - 0.88e3 / 0.27e2 * t5384 + 0.16e3 / 0.27e2 * t5000 - 0.176e4 / 0.27e2 * t5002 + t5005 - 0.968e3 / 0.27e2 * t5388 + 0.22e3 / 0.27e2 * t5008 - 0.1936e4 / 0.27e2 * t5010 + t5013 - 0.352e3 / 0.9e1 * t5392 + t5394 - 0.704e3 / 0.9e1 * t5016 + t5019;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t5396 = t138 * t1269;
  t5399 = t454 * t518 * t46;
  t5411 = t322 * t550 * t45;
  t5422 = 0.2e1 * t5396 + 0.3e1 / 0.32e2 * t1288 * t5399 + 0.5e1 / 0.48e2 * t1291 * t5399 + 0.11e2 / 0.96e2 * t1294 * t5399 + 0.3e1 / 0.16e2 * t1308 * t554 + 0.5e1 / 0.24e2 * t1312 * t554 - t110 * t5411 / 0.3e1 - t615 * t1264 / 0.8e1 - t105 * t5411 / 0.3e1 - t85 * t5411 / 0.3e1 - 0.5e1 / 0.27e2 * t618 * t1264;
  t5427 = t2546 * t330;
  t5447 = -0.55e2 / 0.216e3 * t621 * t1264 - t115 * t5411 / 0.3e1 + t5427 / 0.4e1 + 0.11e2 / 0.48e2 * t1316 * t554 + t1320 * t554 / 0.4e1 + t1283 * t5399 / 0.12e2 + 0.3e1 / 0.64e2 * t2590 * t1330 + 0.5e1 / 0.72e2 * t2593 * t1330 + 0.55e2 / 0.576e3 * t2596 * t1330 - 0.55e2 / 0.432e3 * t2596 * t1342 + 0.55e2 / 0.288e3 * t5075 * t330 + t2599 * t1330 / 0.36e2;
  t5457 = t204 * t322;
  t5471 = t50 * t1712 * t46;
  t5474 = 0.3e1 / 0.32e2 * t5038 * t330 - t2599 * t1342 / 0.27e2 - t2590 * t1342 / 0.16e2 - 0.5e1 / 0.54e2 * t2593 * t1342 - 0.4e1 / 0.3e1 * t5457 * t188 + t1179 * t1693 / 0.8e1 + t1179 * t1696 / 0.4e1 + t2564 * t726 / 0.2e1 + t1179 * t1713 / 0.8e1 + t2564 * t737 / 0.2e1 + t455 * t5471 / 0.16e2;
  t5482 = t362 * t518 * t46;
  t5501 = t1139 * t2860 / 0.6e1 + t460 * t5471 / 0.16e2 + 0.3e1 / 0.16e2 * t1146 * t2860 - t460 * t5482 / 0.12e2 - t1146 * t2826 / 0.4e1 - t463 * t5482 / 0.12e2 - 0.5e1 / 0.18e2 * t1151 * t2826 - t466 * t5482 / 0.12e2 - 0.11e2 / 0.36e2 * t1156 * t2826 + t1174 * t1693 / 0.8e1 + t1174 * t1696 / 0.4e1 + 0.11e2 / 0.24e2 * t2559 * t726;
  t5526 = t1174 * t1713 / 0.8e1 + 0.11e2 / 0.24e2 * t2559 * t737 + t1163 * t1693 / 0.8e1 + t1163 * t1696 / 0.4e1 + 0.3e1 / 0.8e1 * t2587 * t726 + t1163 * t1713 / 0.8e1 + 0.3e1 / 0.8e1 * t2587 * t737 - t455 * t5482 / 0.12e2 - 0.2e1 / 0.9e1 * t1139 * t2826 + 0.5e1 / 0.36e2 * t5066 * t330 - t2816 * t554 / 0.3e1;
  t5527 = t199 * t322;
  t5552 = -0.11e2 / 0.9e1 * t5527 * t188 - t2805 * t554 / 0.3e1 + t1168 * t1693 / 0.8e1 + t1168 * t1696 / 0.4e1 + 0.5e1 / 0.12e2 * t2554 * t726 + t1168 * t1713 / 0.8e1 + 0.5e1 / 0.12e2 * t2554 * t737 + t463 * t5471 / 0.16e2 + 0.5e1 / 0.24e2 * t1151 * t2860 + t466 * t5471 / 0.16e2 + 0.11e2 / 0.48e2 * t1156 * t2860 - t2877 * t554 / 0.3e1;
  t5554 = t266 * t322;
  t5556 = t194 * t322;
  t5564 = t113 * t322 * t98;
  t5582 = -0.4e1 / 0.3e1 * t5411 - 0.4e1 / 0.3e1 * t2750 * t1692 + t95 * t518 * t1266 / 0.2e1 + t2753 * t2756 + t1184 * t45 * t1712 / 0.2e1 + t4960;
  t5588 = -t5554 * t188 - 0.1e2 / 0.9e1 * t5556 * t188 - t2850 * t554 / 0.3e1 + t1320 * t551 / 0.4e1 - t5564 / 0.3e1 + 0.3e1 / 0.16e2 * t1308 * t551 + 0.5e1 / 0.24e2 * t1312 * t551 + 0.11e2 / 0.48e2 * t1316 * t551 + t139 * t5582 + 0.4e1 * t228 * t2759 + 0.2e1 * t355 * t2521;
  t5610 = t119 * t5582 + 0.3e1 * t216 * t2759 + 0.3e1 / 0.2e1 * t343 * t2521 + t133 * t5582 + 0.1e2 / 0.3e1 * t220 * t2759 + 0.5e1 / 0.3e1 * t347 * t2521 + t136 * t5582 + 0.11e2 / 0.3e1 * t224 * t2759 + 0.11e2 / 0.6e1 * t351 * t2521 + 0.3e1 / 0.4e1 * t624 * t1269 + 0.1e2 / 0.9e1 * t627 * t1269 + 0.55e2 / 0.36e2 * t632 * t1269;
  tv4rho3sigma5 = t5422 + t5447 + t5474 + t5501 + t5526 + t5552 + t5588 + t5610;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t5622 = t418 * t869 * t46;
  t5634 = t170 * t857 * t45;
  t5637 = 0.2e1 * t4780 + t4820 / 0.4e1 + 0.5e1 / 0.24e2 * t1079 * t870 + 0.11e2 / 0.48e2 * t1083 * t870 + t1087 * t870 / 0.4e1 + t1050 * t5622 / 0.12e2 + 0.3e1 / 0.32e2 * t1055 * t5622 + 0.5e1 / 0.48e2 * t1058 * t5622 + 0.11e2 / 0.96e2 * t1061 * t5622 + 0.3e1 / 0.16e2 * t1075 * t870 - t85 * t5634 / 0.3e1;
  t5661 = -0.5e1 / 0.27e2 * t922 * t1030 - t105 * t5634 / 0.3e1 - t919 * t1030 / 0.8e1 - 0.55e2 / 0.216e3 * t925 * t1030 - t110 * t5634 / 0.3e1 - t115 * t5634 / 0.3e1 - t5305 * t317 - t2965 * t1113 / 0.27e2 - t2921 * t1113 / 0.16e2 - 0.5e1 / 0.54e2 * t2924 * t1113 - 0.55e2 / 0.432e3 * t2928 * t1113 - 0.11e2 / 0.9e1 * t5315 * t317;
  t5672 = t232 * t869 * t46;
  t5687 = -t2452 * t870 / 0.3e1 - 0.4e1 / 0.3e1 * t5326 * t317 - t2457 * t870 / 0.3e1 - 0.2e1 / 0.9e1 * t1199 * t2662 - t419 * t5672 / 0.12e2 - t1206 * t2662 / 0.4e1 - t424 * t5672 / 0.12e2 - 0.5e1 / 0.18e2 * t1211 * t2662 - t2441 * t870 / 0.3e1 - 0.1e2 / 0.9e1 * t5215 * t317 - t2447 * t870 / 0.3e1;
  t5704 = t922 * t88;
  t5713 = t2673 * t709 / 0.2e1 + t2673 * t720 / 0.2e1 + t1093 * t1896 / 0.4e1 + t1093 * t1900 / 0.8e1 + t1093 * t1918 / 0.8e1 + t1106 * t1896 / 0.4e1 + t1106 * t1900 / 0.8e1 + t1106 * t1918 / 0.8e1 + 0.5e1 / 0.36e2 * t5704 * t180 + 0.5e1 / 0.12e2 * t2722 * t709 + 0.5e1 / 0.12e2 * t2722 * t720 - t427 * t5672 / 0.12e2;
  t5731 = t32 * t1917 * t46;
  t5740 = -0.11e2 / 0.36e2 * t1216 * t2662 - t430 * t5672 / 0.12e2 + t2965 * t1097 / 0.36e2 + 0.3e1 / 0.64e2 * t2921 * t1097 + 0.5e1 / 0.72e2 * t2924 * t1097 + 0.55e2 / 0.576e3 * t2928 * t1097 + t1199 * t2683 / 0.6e1 + t419 * t5731 / 0.16e2 + 0.3e1 / 0.16e2 * t1206 * t2683 + t424 * t5731 / 0.16e2 + 0.5e1 / 0.24e2 * t1211 * t2683;
  t5747 = t919 * t88;
  t5760 = t925 * t88;
  t5767 = t427 * t5731 / 0.16e2 + 0.11e2 / 0.48e2 * t1216 * t2683 + t430 * t5731 / 0.16e2 + 0.3e1 / 0.32e2 * t5747 * t180 + 0.3e1 / 0.8e1 * t2698 * t709 + 0.3e1 / 0.8e1 * t2698 * t720 + t1109 * t1896 / 0.4e1 + t1109 * t1900 / 0.8e1 + t1109 * t1918 / 0.8e1 + 0.55e2 / 0.288e3 * t5760 * t180 + 0.11e2 / 0.24e2 * t2729 * t709 + 0.11e2 / 0.24e2 * t2729 * t720;
  t5785 = t88 * t316;
  t5794 = -0.4e1 / 0.3e1 * t5634 + t5785 * t2610 - 0.4e1 / 0.3e1 * t2335 * t2885 + t2607 * t2885 / 0.2e1 + t1032 * t45 * t1917 / 0.2e1 + t4960;
  t5800 = t1090 * t1896 / 0.4e1 + t1090 * t1900 / 0.8e1 + t1090 * t1918 / 0.8e1 + 0.3e1 / 0.16e2 * t1075 * t858 + 0.5e1 / 0.24e2 * t1079 * t858 + 0.11e2 / 0.48e2 * t1083 * t858 + t1087 * t858 / 0.4e1 - t4936 / 0.3e1 + t133 * t5794 + 0.5e1 / 0.3e1 * t220 * t2888 + 0.11e2 / 0.3e1 * t351 * t2613;
  t5822 = t136 * t5794 + 0.11e2 / 0.6e1 * t224 * t2888 + 0.4e1 * t355 * t2613 + t139 * t5794 + 0.2e1 * t228 * t2888 + 0.3e1 * t343 * t2613 + t119 * t5794 + 0.3e1 / 0.2e1 * t216 * t2888 + 0.1e2 / 0.3e1 * t347 * t2613 + 0.3e1 / 0.4e1 * t928 * t1036 + 0.1e2 / 0.9e1 * t931 * t1036 + 0.55e2 / 0.36e2 * t901 * t1036;
  tv4rho3sigma6 = t5637 + t5661 + t5687 + t5713 + t5740 + t5767 + t5800 + t5822;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  t5825 = t928 * t211;
  t5829 = t931 * t211;
  t5833 = t901 * t211;
  tv4rho3sigma7 = 0.4e1 * t5825 - 0.176e3 / 0.3e1 * t5380 - 0.88e2 / 0.3e1 * t4994 + t4997 + 0.16e3 / 0.27e2 * t5829 - 0.176e4 / 0.27e2 * t5384 - 0.88e3 / 0.27e2 * t5002 + t5005 + 0.22e3 / 0.27e2 * t5833 - 0.1936e4 / 0.27e2 * t5388 - 0.968e3 / 0.27e2 * t5010 + t5013 + t5394 - 0.704e3 / 0.9e1 * t5392 - 0.352e3 / 0.9e1 * t5016 + t5019;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t5862 = 0.2e1 * t5020 + 0.121e3 / 0.108e3 * t199 * t2981 + 0.11e2 / 0.48e2 * t199 * t2986 + 0.11e2 / 0.9e1 * t204 * t2981 + t204 * t2986 / 0.4e1 + 0.11e2 / 0.12e2 * t266 * t2981 - 0.7e1 / 0.36e2 * t3021 * t2779 - 0.13e2 / 0.64e2 * t3024 * t2779 - 0.5e1 / 0.24e2 * t3027 * t2779 - 0.121e3 / 0.576e3 * t3030 * t2779 + 0.55e2 / 0.54e2 * t194 * t2981 - 0.35e2 / 0.36e2 * t3108 * t188;
  t5872 = t454 * t736 * t46;
  t5891 = -0.33e2 / 0.32e2 * t3113 * t188 - 0.29e2 / 0.32e2 * t3118 * t188 + 0.3e1 / 0.16e2 * t266 * t2986 + 0.5e1 / 0.24e2 * t194 * t2986 + t1283 * t5872 / 0.6e1 + 0.3e1 / 0.16e2 * t1288 * t5872 + 0.5e1 / 0.24e2 * t1291 * t5872 + 0.11e2 / 0.48e2 * t1294 * t5872 + 0.5e1 / 0.12e2 * t1312 * t726 + 0.5e1 / 0.12e2 * t1312 * t737 + 0.11e2 / 0.24e2 * t1316 * t726 + 0.11e2 / 0.24e2 * t1316 * t737 + t1320 * t726 / 0.2e1;
  t5904 = t115 * t875;
  t5912 = t105 * t875;
  t5917 = t1320 * t737 / 0.2e1 + 0.3e1 / 0.8e1 * t1308 * t726 + 0.3e1 / 0.8e1 * t1308 * t737 - 0.13e2 / 0.12e2 * t5026 + t1174 * t1945 / 0.8e1 + 0.11e2 / 0.48e2 * t2559 * t893 + 0.11e2 / 0.9e1 * t5904 * t188 + t1163 * t1927 / 0.4e1 - 0.2e1 / 0.3e1 * t2877 * t737 - t5554 * t330 + 0.11e2 / 0.9e1 * t5912 * t188 - 0.2e1 / 0.3e1 * t2805 * t726;
  t5939 = t50 * t1944 * t46;
  t5946 = -0.2e1 / 0.3e1 * t2805 * t737 - 0.1e2 / 0.9e1 * t5556 * t330 + t1168 * t1927 / 0.4e1 - 0.2e1 / 0.3e1 * t2850 * t726 - 0.2e1 / 0.3e1 * t2850 * t737 - 0.4e1 / 0.3e1 * t5457 * t330 + t1179 * t1927 / 0.4e1 + t1179 * t1929 / 0.8e1 + t1179 * t1945 / 0.8e1 + t2564 * t893 / 0.4e1 + t455 * t5939 / 0.16e2 + t1139 * t3093 / 0.12e2 + t460 * t5939 / 0.16e2;
  t5959 = t85 * t875;
  t5974 = 0.3e1 / 0.32e2 * t1146 * t3093 + t463 * t5939 / 0.16e2 + 0.5e1 / 0.48e2 * t1151 * t3093 + t466 * t5939 / 0.16e2 + 0.11e2 / 0.96e2 * t1156 * t3093 + 0.11e2 / 0.9e1 * t5959 * t188 + t1163 * t1929 / 0.8e1 + t1163 * t1945 / 0.8e1 + 0.3e1 / 0.16e2 * t2587 * t893 + t1168 * t1929 / 0.8e1 + t1168 * t1945 / 0.8e1 + 0.5e1 / 0.24e2 * t2554 * t893;
  t5975 = t110 * t875;
  t5989 = t938 * t187 * t46;
  t6004 = 0.11e2 / 0.9e1 * t5975 * t188 - 0.2e1 / 0.3e1 * t2816 * t726 - 0.2e1 / 0.3e1 * t2816 * t737 - 0.11e2 / 0.9e1 * t5527 * t330 + t1174 * t1927 / 0.4e1 + t1174 * t1929 / 0.8e1 + 0.7e1 / 0.36e2 * t455 * t5989 + 0.7e1 / 0.27e2 * t1139 * t3060 + 0.7e1 / 0.36e2 * t460 * t5989 + 0.7e1 / 0.24e2 * t1146 * t3060 + 0.7e1 / 0.36e2 * t463 * t5989 + 0.35e2 / 0.108e3 * t1151 * t3060 + 0.7e1 / 0.36e2 * t466 * t5989;
  t6009 = t362 * t736 * t46;
  t6032 = 0.77e2 / 0.216e3 * t1156 * t3060 - t455 * t6009 / 0.6e1 - 0.2e1 / 0.9e1 * t1139 * t3064 - t460 * t6009 / 0.6e1 - t1146 * t3064 / 0.4e1 - t463 * t6009 / 0.6e1 - 0.5e1 / 0.18e2 * t1151 * t3064 - t466 * t6009 / 0.6e1 - 0.11e2 / 0.36e2 * t1156 * t3064 - 0.2e1 / 0.3e1 * t2877 * t726 + 0.3e1 / 0.4e1 * t928 * t1187 + 0.1e2 / 0.9e1 * t931 * t1187;
  t6035 = t875 * t56;
  t6043 = t95 * t329;
  t6050 = 0.44e2 / 0.9e1 * t6035 * t725 - 0.8e1 / 0.3e1 * t322 * t187 * t1266 - 0.8e1 / 0.3e1 * t2750 * t2756 + t6043 * t2756 + t2753 * t2988 / 0.2e1 + t1184 * t45 * t1944 / 0.2e1 + t4960;
  t6071 = 0.55e2 / 0.36e2 * t901 * t1187 + t133 * t6050 + 0.5e1 / 0.3e1 * t220 * t2991 + 0.1e2 / 0.3e1 * t347 * t2759 + t136 * t6050 + 0.11e2 / 0.6e1 * t224 * t2991 + 0.11e2 / 0.3e1 * t351 * t2759 + t139 * t6050 + 0.2e1 * t228 * t2991 + 0.4e1 * t355 * t2759 + t119 * t6050 + 0.3e1 / 0.2e1 * t216 * t2991 + 0.3e1 * t343 * t2759;
  tv4rho3sigma8 = t5862 + t5891 + t5917 + t5946 + t5974 + t6004 + t6032 + t6071;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t6091 = t32 * t2154 * t46;
  t6100 = 0.6e1 * t5144 - 0.3e1 / 0.128e3 * t2261 * t434 + 0.9e1 / 0.16e2 * t393 * t2883 + 0.5e1 / 0.8e1 * t398 * t2883 - 0.55e2 / 0.3456e4 * t2267 * t434 + 0.11e2 / 0.16e2 * t310 * t2883 + 0.3e1 / 0.4e1 * t336 * t2883 - 0.5e1 / 0.216e3 * t2264 * t434 + 0.3e1 / 0.4e1 * t5189 + t427 * t6091 / 0.16e2 + 0.11e2 / 0.32e2 * t1216 * t2948 + 0.5e1 / 0.8e1 * t2722 * t870 + 0.3e1 / 0.8e1 * t1109 * t2141;
  t6130 = t1109 * t2155 / 0.8e1 + 0.55e2 / 0.96e2 * t5760 * t317 + 0.11e2 / 0.16e2 * t2729 * t870 + 0.3e1 / 0.8e1 * t1090 * t2141 + t1090 * t2155 / 0.8e1 + 0.3e1 / 0.4e1 * t2673 * t870 + 0.3e1 / 0.8e1 * t1106 * t2141 + t1106 * t2155 / 0.8e1 + 0.9e1 / 0.16e2 * t2698 * t870 + 0.5e1 / 0.12e2 * t5704 * t317 + t430 * t6091 / 0.16e2 + 0.9e1 / 0.32e2 * t5747 * t317 + 0.55e2 / 0.192e3 * t2928 * t1203 - t2116 * t418 * t421 / 0.54e2;
  t6161 = -0.3e1 / 0.128e3 * t2120 * t418 * t421 - 0.5e1 / 0.216e3 * t2123 * t418 * t421 - 0.55e2 / 0.3456e4 * t2258 * t418 * t421 + t2965 * t1203 / 0.12e2 + 0.9e1 / 0.64e2 * t2921 * t1203 + 0.5e1 / 0.24e2 * t2924 * t1203 + 0.3e1 / 0.8e1 * t1093 * t2141 + t1093 * t2155 / 0.8e1 + t1199 * t2948 / 0.4e1 + t419 * t6091 / 0.16e2 + 0.9e1 / 0.32e2 * t1206 * t2948 + t424 * t6091 / 0.16e2 + 0.5e1 / 0.16e2 * t1211 * t2948;
  t6179 = 0.3e1 / 0.2e1 * t5785 * t2885 + t1032 * t45 * t2154 / 0.2e1 + t4960;
  t6192 = 0.55e2 / 0.12e2 * t901 * t1243 + 0.9e1 / 0.4e1 * t928 * t1243 + 0.1e2 / 0.3e1 * t931 * t1243 - 0.3e1 / 0.8e1 * t2270 * t444 - 0.1e2 / 0.27e2 * t2273 * t444 - 0.55e2 / 0.216e3 * t2113 * t444 + t133 * t6179 + 0.5e1 * t347 * t2888 + 0.11e2 / 0.2e1 * t351 * t2888 + t136 * t6179 + 0.6e1 * t355 * t2888 + t139 * t6179 + 0.9e1 / 0.2e1 * t343 * t2888 + t119 * t6179;
  tv4rho3sigma9 = t6100 + t6130 + t6161 + t6192;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.3e1 / 0.4e1 * t2270 * t128 + 0.12e2 * t5825 - 0.88e2 * t5380 + t4997 + 0.2e2 / 0.27e2 * t2273 * t128 + 0.16e3 / 0.9e1 * t5829 - 0.88e3 / 0.9e1 * t5384 + t5005 + 0.55e2 / 0.108e3 * t2113 * t128 + 0.22e3 / 0.9e1 * t5833 - 0.968e3 / 0.9e1 * t5388 + t5013 + t5015 - 0.352e3 / 0.3e1 * t5392 + t5019;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t6235 = t2160 * t97 * t45;
  t6239 = t322 * t881 * t45;
  t6250 = 0.6e1 * t5396 - 0.121e3 / 0.192e3 * t3030 * t3038 - 0.35e2 / 0.12e2 * t3108 * t330 - 0.99e2 / 0.32e2 * t3113 * t330 - 0.87e2 / 0.32e2 * t3118 * t330 + 0.9e1 / 0.16e2 * t1308 * t893 + 0.5e1 / 0.8e1 * t1312 * t893 + 0.11e2 / 0.16e2 * t1316 * t893 + 0.35e2 / 0.54e2 * t29 * t3107 * t1285 + 0.85e2 / 0.128e3 * t63 * t3112 * t1285 + 0.145e3 / 0.216e3 * t67 * t95 * t1285 + 0.2321e4 / 0.3456e4 * t71 * t4502 * t1285 - 0.77e2 / 0.27e2 * t105 * t6235 - t105 * t6239 - 0.77e2 / 0.27e2 * t115 * t6235 - t115 * t6239 - 0.77e2 / 0.27e2 * t85 * t6235 - t85 * t6239 - 0.77e2 / 0.27e2 * t110 * t6235 - t110 * t6239;
  t6254 = t454 * t892 * t46;
  t6277 = t938 * t329 * t46;
  t6281 = t2226 * t56 * t46;
  t6289 = t362 * t892 * t46;
  t6299 = -t2816 * t893 + 0.3e1 / 0.8e1 * t1174 * t2170 + 0.7e1 / 0.12e2 * t463 * t6277 - 0.35e2 / 0.54e2 * t455 * t6281 - 0.35e2 / 0.54e2 * t460 * t6281 - 0.35e2 / 0.54e2 * t463 * t6281 - t466 * t6289 / 0.4e1 - 0.35e2 / 0.54e2 * t466 * t6281 + 0.7e1 / 0.12e2 * t455 * t6277 + 0.7e1 / 0.12e2 * t460 * t6277 - t2805 * t893;
  t6322 = t50 * t2182 * t46;
  t6347 = t455 * t6322 / 0.16e2 + t460 * t6322 / 0.16e2 + t463 * t6322 / 0.16e2 + t466 * t6322 / 0.16e2 + 0.11e2 / 0.3e1 * t5959 * t330 + 0.3e1 / 0.8e1 * t1163 * t2170 + t1163 * t2183 / 0.8e1 + 0.3e1 / 0.8e1 * t1168 * t2170 + t1168 * t2183 / 0.8e1 + 0.7e1 / 0.12e2 * t466 * t6277 + 0.535e3 / 0.216e3 * t104 / t873 * t98;
  t6386 = -0.308e3 / 0.27e2 * t6235 + 0.44e2 / 0.3e1 * t6035 * t1266 - 0.4e1 * t6239 - 0.4e1 * t2750 * t2988 + 0.3e1 / 0.2e1 * t6043 * t2988 + t1184 * t45 * t2182 / 0.2e1 + t4960;
  t6405 = t133 * t6386 + 0.5e1 * t347 * t2991 + t136 * t6386 + 0.11e2 / 0.2e1 * t351 * t2991 + t139 * t6386 + 0.6e1 * t355 * t2991 + t119 * t6386 + 0.9e1 / 0.2e1 * t343 * t2991 - 0.3e1 / 0.8e1 * t2270 * t480 - 0.1e2 / 0.27e2 * t2273 * t480 - 0.55e2 / 0.216e3 * t2113 * t480;
  tv4rho3sigma11 = -t460 * t6289 / 0.4e1 - t463 * t6289 / 0.4e1 - 0.5e1 / 0.8e1 * t3027 * t3038 + 0.11e2 / 0.3e1 * t5975 * t330 + 0.3e1 / 0.4e1 * t1320 * t893 + t1283 * t6254 / 0.4e1 + 0.9e1 / 0.32e2 * t1288 * t6254 + 0.5e1 / 0.16e2 * t1291 * t6254 + 0.11e2 / 0.32e2 * t1294 * t6254 - 0.7e1 / 0.12e2 * t3021 * t3038 - 0.39e2 / 0.64e2 * t3024 * t3038 + 0.5e1 / 0.8e1 * t1312 * t882 + 0.9e1 / 0.4e1 * t928 * t1269 + 0.1e2 / 0.3e1 * t931 * t1269 + 0.55e2 / 0.12e2 * t901 * t1269 + 0.9e1 / 0.16e2 * t1308 * t882 + 0.11e2 / 0.16e2 * t1316 * t882 + 0.3e1 / 0.4e1 * t1320 * t882 - t2877 * t893 + 0.11e2 / 0.3e1 * t5912 * t330 + t1174 * t2183 / 0.8e1 + 0.11e2 / 0.3e1 * t5904 * t330 - t2850 * t893 + 0.3e1 / 0.8e1 * t1179 * t2170 + t1179 * t2183 / 0.8e1 - t455 * t6289 / 0.4e1 + t6405 + t6347 + t6299 + t6250 + 0.8e1 / 0.3e1 * t5564 - 0.13e2 / 0.4e1 * t5427 + 0.8921e4 / 0.3456e4 * t109 / t78 / t320 * t98 + 0.301e3 / 0.128e3 * t84 / t4 / t873 * t98;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t6441 = t1353 * t179 * t46;
  tv4rho2sigma20 = -t1356 * t2432 / 0.32e2 + 0.5e1 / 0.48e2 * t2378 * t3124 + t1358 * t2463 / 0.12e2 - t1358 * t2432 / 0.32e2 + 0.121e3 / 0.1152e4 * t2381 * t3124 + t1360 * t2463 / 0.12e2 - t1360 * t2432 / 0.32e2 + 0.7e1 / 0.72e2 * t2372 * t3124 + t1354 * t2463 / 0.12e2 - t1354 * t2432 / 0.32e2 + 0.13e2 / 0.128e3 * t2375 * t3124 + t1356 * t2463 / 0.12e2 - 0.7e1 / 0.72e2 * t1358 * t2467 - 0.7e1 / 0.72e2 * t1360 * t2467 - 0.7e1 / 0.72e2 * t1354 * t2467 - 0.7e1 / 0.72e2 * t1356 * t2467 - t1050 * t6441 / 0.12e2 - 0.3e1 / 0.32e2 * t1055 * t6441 - 0.5e1 / 0.48e2 * t1058 * t6441 - 0.11e2 / 0.96e2 * t1061 * t6441;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = -t600 * t1364 * t457 / 0.72e2 - t3149 * t1143 / 0.12e2 - t1365 * t2572 / 0.32e2 - 0.3e1 / 0.128e3 * t604 * t1364 * t457 - 0.3e1 / 0.32e2 * t3154 * t1143 - t1367 * t2572 / 0.32e2 - 0.5e1 / 0.144e3 * t608 * t1364 * t457 - 0.5e1 / 0.48e2 * t3159 * t1143 - t1369 * t2572 / 0.32e2 - 0.55e2 / 0.1152e4 * t612 * t1364 * t457 - 0.11e2 / 0.96e2 * t3164 * t1143 - t1371 * t2572 / 0.32e2;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t6483 = t1353 * t316 * t46;
  tv4rho2sigma26 = t3169 * t1113 / 0.18e2 - t3169 * t1097 / 0.24e2 - t1050 * t6483 / 0.24e2 + t1354 * t2662 / 0.24e2 - t1354 * t2683 / 0.32e2 + t3174 * t1113 / 0.16e2 - 0.3e1 / 0.64e2 * t3174 * t1097 - 0.3e1 / 0.64e2 * t1055 * t6483 + t1356 * t2662 / 0.24e2 - t1356 * t2683 / 0.32e2 + 0.5e1 / 0.72e2 * t3179 * t1113 - 0.5e1 / 0.96e2 * t3179 * t1097 - 0.5e1 / 0.96e2 * t1058 * t6483 + t1358 * t2662 / 0.24e2 - t1358 * t2683 / 0.32e2 + 0.11e2 / 0.144e3 * t3184 * t1113 - 0.11e2 / 0.192e3 * t3184 * t1097 - 0.11e2 / 0.192e3 * t1061 * t6483 + t1360 * t2662 / 0.24e2 - t1360 * t2683 / 0.32e2;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t6521 = t1364 * t187 * t46;
  tv4rho2sigma211 = -t1283 * t6521 / 0.24e2 + t3149 * t1342 / 0.18e2 + t1365 * t2826 / 0.24e2 - t3149 * t1330 / 0.24e2 - t1365 * t2860 / 0.32e2 - 0.3e1 / 0.64e2 * t1288 * t6521 + t3154 * t1342 / 0.16e2 + t1367 * t2826 / 0.24e2 - 0.3e1 / 0.64e2 * t3154 * t1330 - t1367 * t2860 / 0.32e2 - 0.5e1 / 0.96e2 * t1291 * t6521 + 0.5e1 / 0.72e2 * t3159 * t1342 + t1369 * t2826 / 0.24e2 - 0.5e1 / 0.96e2 * t3159 * t1330 - t1369 * t2860 / 0.32e2 - 0.11e2 / 0.192e3 * t1294 * t6521 + 0.11e2 / 0.144e3 * t3164 * t1342 + t1371 * t2826 / 0.24e2 - 0.11e2 / 0.192e3 * t3164 * t1330 - t1371 * t2860 / 0.32e2;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  tv4rho2sigma212 = -t905 * t1353 * t421 / 0.72e2 - t3169 * t1203 / 0.12e2 - t1354 * t2948 / 0.32e2 - 0.3e1 / 0.128e3 * t909 * t1353 * t421 - 0.3e1 / 0.32e2 * t3174 * t1203 - t1356 * t2948 / 0.32e2 - 0.5e1 / 0.144e3 * t913 * t1353 * t421 - 0.5e1 / 0.48e2 * t3179 * t1203 - t1358 * t2948 / 0.32e2 - 0.55e2 / 0.1152e4 * t916 * t1353 * t421 - 0.11e2 / 0.96e2 * t3184 * t1203 - t1360 * t2948 / 0.32e2;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t6615 = t1364 * t329 * t46;
  tv4rho2sigma217 = t1371 * t3064 / 0.12e2 - t1371 * t3093 / 0.32e2 + 0.7e1 / 0.72e2 * t3021 * t3190 + t1365 * t3064 / 0.12e2 - t1365 * t3093 / 0.32e2 + 0.13e2 / 0.128e3 * t3024 * t3190 + t1367 * t3064 / 0.12e2 - t1367 * t3093 / 0.32e2 + 0.5e1 / 0.48e2 * t3027 * t3190 + t1369 * t3064 / 0.12e2 - t1369 * t3093 / 0.32e2 + 0.121e3 / 0.1152e4 * t3030 * t3190 - t1283 * t6615 / 0.12e2 - 0.3e1 / 0.32e2 * t1288 * t6615 - 0.5e1 / 0.48e2 * t1291 * t6615 - 0.11e2 / 0.96e2 * t1294 * t6615 - 0.7e1 / 0.72e2 * t1369 * t3060 - 0.7e1 / 0.72e2 * t1371 * t3060 - 0.7e1 / 0.72e2 * t1365 * t3060 - 0.7e1 / 0.72e2 * t1367 * t3060;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t6633 = t3217 * t44 * t46;
  tv4rhosigma30 = t1050 * t6633 / 0.16e2 - t3218 * t1113 / 0.16e2 + 0.3e1 / 0.64e2 * t3218 * t1097 + 0.9e1 / 0.128e3 * t1055 * t6633 - t3220 * t1113 / 0.16e2 + 0.3e1 / 0.64e2 * t3220 * t1097 + 0.5e1 / 0.64e2 * t1058 * t6633 - t3222 * t1113 / 0.16e2 + 0.3e1 / 0.64e2 * t3222 * t1097 + 0.11e2 / 0.128e3 * t1061 * t6633 - t3224 * t1113 / 0.16e2 + 0.3e1 / 0.64e2 * t3224 * t1097;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = t246 * t3229 * t457 / 0.16e2 + 0.3e1 / 0.64e2 * t3230 * t1143 + 0.9e1 / 0.128e3 * t251 * t3229 * t457 + 0.3e1 / 0.64e2 * t3232 * t1143 + 0.5e1 / 0.64e2 * t256 * t3229 * t457 + 0.3e1 / 0.64e2 * t3234 * t1143 + 0.11e2 / 0.128e3 * t261 * t3229 * t457 + 0.3e1 / 0.64e2 * t3236 * t1143;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  tv4rhosigma310 = t372 * t3217 * t421 / 0.16e2 + 0.3e1 / 0.64e2 * t3218 * t1203 + 0.9e1 / 0.128e3 * t377 * t3217 * t421 + 0.3e1 / 0.64e2 * t3220 * t1203 + 0.5e1 / 0.64e2 * t383 * t3217 * t421 + 0.3e1 / 0.64e2 * t3222 * t1203 + 0.11e2 / 0.128e3 * t388 * t3217 * t421 + 0.3e1 / 0.64e2 * t3224 * t1203;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t6699 = t3229 * t56 * t46;
  tv4rhosigma319 = t1283 * t6699 / 0.16e2 - t3230 * t1342 / 0.16e2 + 0.3e1 / 0.64e2 * t3230 * t1330 + 0.9e1 / 0.128e3 * t1288 * t6699 - t3232 * t1342 / 0.16e2 + 0.3e1 / 0.64e2 * t3232 * t1330 + 0.5e1 / 0.64e2 * t1291 * t6699 - t3234 * t1342 / 0.16e2 + 0.3e1 / 0.64e2 * t3234 * t1330 + 0.11e2 / 0.128e3 * t1294 * t6699 - t3236 * t1342 / 0.16e2 + 0.3e1 / 0.64e2 * t3236 * t1330;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t6726 = 0.1e1 / t31 / t3215 / sigma[0];
  tv4sigma40 = -0.15e2 / 0.128e3 * t30 * t6726 * t421 - 0.15e2 / 0.128e3 * t64 * t6726 * t421 - 0.15e2 / 0.128e3 * t68 * t6726 * t421 - 0.15e2 / 0.128e3 * t81 * t6726 * t421;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t6738 = 0.1e1 / t49 / t3227 / sigma[2];
  tv4sigma414 = -0.15e2 / 0.128e3 * t30 * t6738 * t457 - 0.15e2 / 0.128e3 * t64 * t6738 * t457 - 0.15e2 / 0.128e3 * t68 * t6738 * t457 - 0.15e2 / 0.128e3 * t81 * t6738 * t457;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

