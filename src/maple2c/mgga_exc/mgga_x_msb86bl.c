/*
  This file was generated automatically with scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : License expires in 15 days
  Maple source      : ./maple/mgga_exc/mgga_x_msb86bl.mpl
  Type of functional: mgga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t39, t40, t41, t42, t43;
  double t44, t46, t47, t49, t51, t52, t54, t55;
  double t56, t59, t62, t63, t64, t66, t67, t68;
  double t69, t70, t71, t73, t75, t76, t78, t80;
  double t81, t82, t85, t87, t88, t89, t90, t91;
  double t93, t95, t99, tzk0;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = t26 * sigma[0];
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t19 * t19;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = 0.1e1 / params->kappa;
  t39 = 0.1e1 + 0.5e1 / 0.972e3 * t27 * t34 * t35;
  t40 = pow(t39, 0.1e1 / 0.5e1);
  t41 = t40 * t40;
  t42 = t41 * t41;
  t43 = 0.1e1 / t42;
  t44 = t34 * t43;
  t46 = 0.5e1 / 0.972e3 * t27 * t44;
  t47 = tau[0] * t29;
  t49 = 0.1e1 / t31 / rho[0];
  t51 = sigma[0] * t29;
  t52 = t51 * t33;
  t54 = t47 * t49 - t52 / 0.8e1;
  t55 = t54 * t54;
  t56 = t21 * t21;
  t59 = params->eta * sigma[0];
  t62 = 0.3e1 / 0.1e2 * t56 * t24 + t59 * t34 / 0.8e1;
  t63 = t62 * t62;
  t64 = 0.1e1 / t63;
  t66 = -t55 * t64 + 0.1e1;
  t67 = t66 * t66;
  t68 = t67 * t66;
  t69 = t55 * t54;
  t70 = t63 * t62;
  t71 = 0.1e1 / t70;
  t73 = t55 * t55;
  t75 = params->b * t73 * t55;
  t76 = t63 * t63;
  t78 = 0.1e1 / t76 / t63;
  t80 = t69 * t71 + t75 * t78 + 0.1e1;
  t81 = 0.1e1 / t80;
  t82 = t68 * t81;
  t85 = 0.5e1 / 0.972e3 * t26 * t52 + params->c;
  t87 = t85 * t35 + 0.1e1;
  t88 = pow(t87, 0.1e1 / 0.5e1);
  t89 = t88 * t88;
  t90 = t89 * t89;
  t91 = 0.1e1 / t90;
  t93 = t85 * t91 - t46;
  t95 = t82 * t93 + t46 + 0.1e1;
  t99 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t39, t40, t41, t42, t43;
  double t44, t46, t47, t49, t51, t52, t54, t55;
  double t56, t59, t62, t63, t64, t66, t67, t68;
  double t69, t70, t71, t73, t75, t76, t78, t80;
  double t81, t82, t85, t87, t88, t89, t90, t91;
  double t93, t95, t99, tzk0;

  double t101, t105, t107, t108, t109, t111, t113, t114;
  double t115, t116, t117, t118, t120, t121, t123, t124;
  double t127, t128, t129, t132, t134, t137, t138, t141;
  double t142, t145, t146, t147, t150, t151, t152, t155;
  double t156, t160, t161, t162, t165, t166, t168, t172;
  double t173, t174, t175, t179, t181, t186, tvrho0, t190;
  double t192, t194, t195, t198, t199, t200, t201, t204;
  double t205, t208, t212, t214, t218, t219, t224, t225;
  double t230, t232, t236, tvsigma0, tvlapl0, t238, t239, t240;
  double t248, t249, t251, t255, tvtau0;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = t26 * sigma[0];
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t19 * t19;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = 0.1e1 / params->kappa;
  t39 = 0.1e1 + 0.5e1 / 0.972e3 * t27 * t34 * t35;
  t40 = pow(t39, 0.1e1 / 0.5e1);
  t41 = t40 * t40;
  t42 = t41 * t41;
  t43 = 0.1e1 / t42;
  t44 = t34 * t43;
  t46 = 0.5e1 / 0.972e3 * t27 * t44;
  t47 = tau[0] * t29;
  t49 = 0.1e1 / t31 / rho[0];
  t51 = sigma[0] * t29;
  t52 = t51 * t33;
  t54 = t47 * t49 - t52 / 0.8e1;
  t55 = t54 * t54;
  t56 = t21 * t21;
  t59 = params->eta * sigma[0];
  t62 = 0.3e1 / 0.1e2 * t56 * t24 + t59 * t34 / 0.8e1;
  t63 = t62 * t62;
  t64 = 0.1e1 / t63;
  t66 = -t55 * t64 + 0.1e1;
  t67 = t66 * t66;
  t68 = t67 * t66;
  t69 = t55 * t54;
  t70 = t63 * t62;
  t71 = 0.1e1 / t70;
  t73 = t55 * t55;
  t75 = params->b * t73 * t55;
  t76 = t63 * t63;
  t78 = 0.1e1 / t76 / t63;
  t80 = t69 * t71 + t75 * t78 + 0.1e1;
  t81 = 0.1e1 / t80;
  t82 = t68 * t81;
  t85 = 0.5e1 / 0.972e3 * t26 * t52 + params->c;
  t87 = t85 * t35 + 0.1e1;
  t88 = pow(t87, 0.1e1 / 0.5e1);
  t89 = t88 * t88;
  t90 = t89 * t89;
  t91 = 0.1e1 / t90;
  t93 = t85 * t91 - t46;
  t95 = t82 * t93 + t46 + 0.1e1;
  t99 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t101 = t18 / t31;
  t105 = t30 * rho[0];
  t107 = 0.1e1 / t31 / t105;
  t108 = t29 * t107;
  t109 = t108 * t43;
  t111 = 0.1e2 / 0.729e3 * t27 * t109;
  t113 = 0.1e1 / t23 / t22;
  t114 = t56 * t113;
  t115 = sigma[0] * sigma[0];
  t116 = t114 * t115;
  t117 = t30 * t30;
  t118 = t117 * t30;
  t120 = 0.1e1 / t19 / t118;
  t121 = t28 * t120;
  t123 = 0.1e1 / t42 / t39;
  t124 = t123 * t35;
  t127 = 0.2e2 / 0.177147e6 * t116 * t121 * t124;
  t128 = t67 * t81;
  t129 = t54 * t64;
  t132 = t51 * t107;
  t134 = -0.5e1 / 0.3e1 * t47 * t33 + t132 / 0.3e1;
  t137 = t55 * t71;
  t138 = t137 * params->eta;
  t141 = -0.2e1 * t129 * t134 - 0.2e1 / 0.3e1 * t138 * t132;
  t142 = t93 * t141;
  t145 = t80 * t80;
  t146 = 0.1e1 / t145;
  t147 = t68 * t146;
  t150 = 0.1e1 / t76;
  t151 = t69 * t150;
  t152 = t151 * params->eta;
  t155 = params->b * t73 * t54;
  t156 = t78 * t134;
  t160 = 0.1e1 / t76 / t70;
  t161 = t75 * t160;
  t162 = t59 * t108;
  t165 = t152 * t132 + 0.3e1 * t137 * t134 + 0.6e1 * t155 * t156 + 0.2e1 * t161 * t162;
  t166 = t93 * t165;
  t168 = t108 * t91;
  t172 = 0.1e1 / t90 / t87;
  t173 = t85 * t172;
  t174 = t173 * t26;
  t175 = t107 * t35;
  t179 = -0.1e2 / 0.729e3 * t27 * t168 + 0.8e1 / 0.729e3 * t174 * t51 * t175 + t111 - t127;
  t181 = 0.3e1 * t128 * t142 - t147 * t166 + t82 * t179 - t111 + t127;
  t186 = my_piecewise3(t3, 0, -t7 * t101 * t95 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t181);
  tvrho0 = 0.2e1 * rho[0] * t186 + 0.2e1 * t99;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t190 = 0.5e1 / 0.972e3 * t26 * t44;
  t192 = t117 * rho[0];
  t194 = 0.1e1 / t19 / t192;
  t195 = t28 * t194;
  t198 = 0.5e1 / 0.118098e6 * t114 * sigma[0] * t195 * t124;
  t199 = t129 * t34;
  t200 = params->eta * t29;
  t201 = t200 * t33;
  t204 = t137 * t201 / 0.4e1 + t199 / 0.4e1;
  t205 = t93 * t204;
  t208 = t137 * t34;
  t212 = t78 * t29;
  t214 = t155 * t212 * t33;
  t218 = -0.3e1 / 0.8e1 * t208 - 0.3e1 / 0.8e1 * t151 * t201 - 0.3e1 / 0.4e1 * t214 - 0.3e1 / 0.4e1 * t161 * t201;
  t219 = t93 * t218;
  t224 = t173 * t21;
  t225 = t25 * t29;
  t230 = 0.5e1 / 0.972e3 * t26 * t34 * t91 - t224 * t225 * t33 * t35 / 0.243e3 - t190 + t198;
  t232 = 0.3e1 * t128 * t205 - t147 * t219 + t82 * t230 + t190 - t198;
  t236 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t232);
  tvsigma0 = 0.2e1 * rho[0] * t236;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t238 = t128 * t93;
  t239 = t29 * t49;
  t240 = t129 * t239;
  t248 = 0.6e1 * t155 * t212 * t49 + 0.3e1 * t137 * t239;
  t249 = t93 * t248;
  t251 = -t147 * t249 - 0.6e1 * t238 * t240;
  t255 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t251);
  tvtau0 = 0.2e1 * rho[0] * t255;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t39, t40, t41, t42, t43;
  double t44, t46, t47, t49, t51, t52, t54, t55;
  double t56, t59, t62, t63, t64, t66, t67, t68;
  double t69, t70, t71, t73, t75, t76, t78, t80;
  double t81, t82, t85, t87, t88, t89, t90, t91;
  double t93, t95, t99, tzk0;

  double t101, t105, t107, t108, t109, t111, t113, t114;
  double t115, t116, t117, t118, t120, t121, t123, t124;
  double t127, t128, t129, t132, t134, t137, t138, t141;
  double t142, t145, t146, t147, t150, t151, t152, t155;
  double t156, t160, t161, t162, t165, t166, t168, t172;
  double t173, t174, t175, t179, t181, t186, tvrho0, t190;
  double t192, t194, t195, t198, t199, t200, t201, t204;
  double t205, t208, t212, t214, t218, t219, t224, t225;
  double t230, t232, t236, tvsigma0, tvlapl0, t238, t239, t240;
  double t248, t249, t251, t255, tvtau0;

  double t258, t266, t267, t268, t270, t271, t273, t274;
  double t277, t278, t279, t280, t281, t282, t283, t284;
  double t285, t287, t289, t290, t293, t294, t295, t296;
  double t299, t303, t306, t309, t310, t315, t317, t320;
  double t321, t322, t323, t324, t329, t330, t334, t335;
  double t336, t337, t340, t345, t351, t352, t353, t358;
  double t359, t362, t363, t369, t370, t371, t372, t373;
  double t376, t379, t382, t385, t389, t391, t392, t393;
  double t394, t398, t402, t404, t409, tv2rho20, t416, t417;
  double t418, t419, t422, t423, t424, t425, t429, t433;
  double t436, t439, t440, t442, t443, t444, t447, t449;
  double t450, t453, t456, t459, t460, t469, t471, t473;
  double t474, t476, t477, t482, t483, t485, t487, t490;
  double t496, t503, t504, t506, t509, t513, t517, t524;
  double t526, t531, tv2rhosigma0, tv2rholapl0, t537, t538, t539, t540;
  double t541, t544, t546, t549, t552, t555, t556, t557;
  double t558, t559, t570, t572, t584, t585, t587, t592;
  double tv2rhotau0, t598, t599, t600, t604, t605, t606, t609;
  double t612, t615, t617, t620, t623, t624, t627, t628;
  double t631, t634, t636, t640, t642, t644, t648, t649;
  double t655, t656, t661, t663, t667, tv2sigma20, tv2sigmalapl0, t669;
  double t670, t673, t674, t677, t681, t682, t683, t684;
  double t686, t687, t690, t696, t698, t700, t704, t708;
  double t709, t711, t715, tv2sigmatau0, tv2lapl20, tv2lapltau0, t717, t719;
  double t720, t721, t724, t725, t728, t731, t732, t740;
  double t741, t743, t747, tv2tau20;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = t26 * sigma[0];
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t19 * t19;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = 0.1e1 / params->kappa;
  t39 = 0.1e1 + 0.5e1 / 0.972e3 * t27 * t34 * t35;
  t40 = pow(t39, 0.1e1 / 0.5e1);
  t41 = t40 * t40;
  t42 = t41 * t41;
  t43 = 0.1e1 / t42;
  t44 = t34 * t43;
  t46 = 0.5e1 / 0.972e3 * t27 * t44;
  t47 = tau[0] * t29;
  t49 = 0.1e1 / t31 / rho[0];
  t51 = sigma[0] * t29;
  t52 = t51 * t33;
  t54 = t47 * t49 - t52 / 0.8e1;
  t55 = t54 * t54;
  t56 = t21 * t21;
  t59 = params->eta * sigma[0];
  t62 = 0.3e1 / 0.1e2 * t56 * t24 + t59 * t34 / 0.8e1;
  t63 = t62 * t62;
  t64 = 0.1e1 / t63;
  t66 = -t55 * t64 + 0.1e1;
  t67 = t66 * t66;
  t68 = t67 * t66;
  t69 = t55 * t54;
  t70 = t63 * t62;
  t71 = 0.1e1 / t70;
  t73 = t55 * t55;
  t75 = params->b * t73 * t55;
  t76 = t63 * t63;
  t78 = 0.1e1 / t76 / t63;
  t80 = t69 * t71 + t75 * t78 + 0.1e1;
  t81 = 0.1e1 / t80;
  t82 = t68 * t81;
  t85 = 0.5e1 / 0.972e3 * t26 * t52 + params->c;
  t87 = t85 * t35 + 0.1e1;
  t88 = pow(t87, 0.1e1 / 0.5e1);
  t89 = t88 * t88;
  t90 = t89 * t89;
  t91 = 0.1e1 / t90;
  t93 = t85 * t91 - t46;
  t95 = t82 * t93 + t46 + 0.1e1;
  t99 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t101 = t18 / t31;
  t105 = t30 * rho[0];
  t107 = 0.1e1 / t31 / t105;
  t108 = t29 * t107;
  t109 = t108 * t43;
  t111 = 0.1e2 / 0.729e3 * t27 * t109;
  t113 = 0.1e1 / t23 / t22;
  t114 = t56 * t113;
  t115 = sigma[0] * sigma[0];
  t116 = t114 * t115;
  t117 = t30 * t30;
  t118 = t117 * t30;
  t120 = 0.1e1 / t19 / t118;
  t121 = t28 * t120;
  t123 = 0.1e1 / t42 / t39;
  t124 = t123 * t35;
  t127 = 0.2e2 / 0.177147e6 * t116 * t121 * t124;
  t128 = t67 * t81;
  t129 = t54 * t64;
  t132 = t51 * t107;
  t134 = -0.5e1 / 0.3e1 * t47 * t33 + t132 / 0.3e1;
  t137 = t55 * t71;
  t138 = t137 * params->eta;
  t141 = -0.2e1 * t129 * t134 - 0.2e1 / 0.3e1 * t138 * t132;
  t142 = t93 * t141;
  t145 = t80 * t80;
  t146 = 0.1e1 / t145;
  t147 = t68 * t146;
  t150 = 0.1e1 / t76;
  t151 = t69 * t150;
  t152 = t151 * params->eta;
  t155 = params->b * t73 * t54;
  t156 = t78 * t134;
  t160 = 0.1e1 / t76 / t70;
  t161 = t75 * t160;
  t162 = t59 * t108;
  t165 = t152 * t132 + 0.3e1 * t137 * t134 + 0.6e1 * t155 * t156 + 0.2e1 * t161 * t162;
  t166 = t93 * t165;
  t168 = t108 * t91;
  t172 = 0.1e1 / t90 / t87;
  t173 = t85 * t172;
  t174 = t173 * t26;
  t175 = t107 * t35;
  t179 = -0.1e2 / 0.729e3 * t27 * t168 + 0.8e1 / 0.729e3 * t174 * t51 * t175 + t111 - t127;
  t181 = 0.3e1 * t128 * t142 - t147 * t166 + t82 * t179 - t111 + t127;
  t186 = my_piecewise3(t3, 0, -t7 * t101 * t95 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t181);
  tvrho0 = 0.2e1 * rho[0] * t186 + 0.2e1 * t99;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t190 = 0.5e1 / 0.972e3 * t26 * t44;
  t192 = t117 * rho[0];
  t194 = 0.1e1 / t19 / t192;
  t195 = t28 * t194;
  t198 = 0.5e1 / 0.118098e6 * t114 * sigma[0] * t195 * t124;
  t199 = t129 * t34;
  t200 = params->eta * t29;
  t201 = t200 * t33;
  t204 = t137 * t201 / 0.4e1 + t199 / 0.4e1;
  t205 = t93 * t204;
  t208 = t137 * t34;
  t212 = t78 * t29;
  t214 = t155 * t212 * t33;
  t218 = -0.3e1 / 0.8e1 * t208 - 0.3e1 / 0.8e1 * t151 * t201 - 0.3e1 / 0.4e1 * t214 - 0.3e1 / 0.4e1 * t161 * t201;
  t219 = t93 * t218;
  t224 = t173 * t21;
  t225 = t25 * t29;
  t230 = 0.5e1 / 0.972e3 * t26 * t34 * t91 - t224 * t225 * t33 * t35 / 0.243e3 - t190 + t198;
  t232 = 0.3e1 * t128 * t205 - t147 * t219 + t82 * t230 + t190 - t198;
  t236 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t232);
  tvsigma0 = 0.2e1 * rho[0] * t236;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t238 = t128 * t93;
  t239 = t29 * t49;
  t240 = t129 * t239;
  t248 = 0.6e1 * t155 * t212 * t49 + 0.3e1 * t137 * t239;
  t249 = t93 * t248;
  t251 = -t147 * t249 - 0.6e1 * t238 * t240;
  t255 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t251);
  tvtau0 = 0.2e1 * rho[0] * t255;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t258 = t18 * t49;
  t266 = 0.1e1 / t31 / t117;
  t267 = t29 * t266;
  t268 = t267 * t43;
  t270 = 0.11e3 / 0.2187e4 * t27 * t268;
  t271 = t117 * t105;
  t273 = 0.1e1 / t19 / t271;
  t274 = t28 * t273;
  t277 = 0.2e2 / 0.19683e5 * t116 * t274 * t124;
  t278 = t22 * t22;
  t279 = 0.1e1 / t278;
  t280 = t115 * sigma[0];
  t281 = t279 * t280;
  t282 = t117 * t117;
  t283 = t282 * t30;
  t284 = 0.1e1 / t283;
  t285 = t39 * t39;
  t287 = 0.1e1 / t42 / t285;
  t289 = params->kappa * params->kappa;
  t290 = 0.1e1 / t289;
  t293 = 0.16e3 / 0.4782969e7 * t281 * t284 * t287 * t290;
  t294 = t66 * t81;
  t295 = t141 * t141;
  t296 = t93 * t295;
  t299 = t67 * t146;
  t303 = t179 * t141;
  t306 = t134 * t134;
  t309 = t54 * t71;
  t310 = t309 * t134;
  t315 = t51 * t266;
  t317 = 0.4e2 / 0.9e1 * t47 * t107 - 0.11e2 / 0.9e1 * t315;
  t320 = t55 * t150;
  t321 = params->eta * params->eta;
  t322 = t320 * t321;
  t323 = t115 * t28;
  t324 = t323 * t273;
  t329 = -0.2e1 * t306 * t64 - 0.8e1 / 0.3e1 * t310 * t162 - 0.2e1 * t129 * t317 - 0.4e1 / 0.3e1 * t322 * t324 + 0.22e2 / 0.9e1 * t138 * t315;
  t330 = t93 * t329;
  t334 = 0.1e1 / t145 / t80;
  t335 = t68 * t334;
  t336 = t165 * t165;
  t337 = t93 * t336;
  t340 = t179 * t165;
  t345 = t320 * t134;
  t351 = 0.1e1 / t76 / t62;
  t352 = t69 * t351;
  t353 = t352 * t321;
  t358 = params->b * t73;
  t359 = t78 * t306;
  t362 = t160 * t134;
  t363 = t155 * t362;
  t369 = t76 * t76;
  t370 = 0.1e1 / t369;
  t371 = t75 * t370;
  t372 = t321 * t115;
  t373 = t372 * t274;
  t376 = t59 * t267;
  t379 = 0.6e1 * t309 * t306 + 0.6e1 * t345 * t162 + 0.3e1 * t137 * t317 + 0.8e1 / 0.3e1 * t353 * t324 - 0.11e2 / 0.3e1 * t152 * t315 + 0.3e2 * t358 * t359 + 0.24e2 * t363 * t162 + 0.6e1 * t155 * t78 * t317 + 0.28e2 / 0.3e1 * t371 * t373 - 0.22e2 / 0.3e1 * t161 * t376;
  t382 = t267 * t91;
  t385 = t172 * t35;
  t389 = t87 * t87;
  t391 = 0.1e1 / t90 / t389;
  t392 = t85 * t391;
  t393 = t392 * t114;
  t394 = t273 * t290;
  t398 = t266 * t35;
  t402 = 0.11e3 / 0.2187e4 * t27 * t382 - 0.32e3 / 0.531441e6 * t116 * t274 * t385 + 0.32e2 / 0.59049e5 * t393 * t323 * t394 - 0.88e2 / 0.2187e4 * t174 * t51 * t398 - t270 + t277 - t293;
  t404 = -0.6e1 * t299 * t142 * t165 - t147 * t93 * t379 + 0.6e1 * t128 * t303 + 0.3e1 * t128 * t330 - 0.2e1 * t147 * t340 + 0.6e1 * t294 * t296 + 0.2e1 * t335 * t337 + t82 * t402 + t270 - t277 + t293;
  t409 = my_piecewise3(t3, 0, t7 * t258 * t95 / 0.12e2 - t7 * t101 * t181 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t404);
  tv2rho20 = 0.2e1 * rho[0] * t409 + 0.4e1 * t186;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t416 = 0.1e2 / 0.729e3 * t26 * t109;
  t417 = t114 * t28;
  t418 = t120 * t123;
  t419 = sigma[0] * t35;
  t422 = 0.2e2 / 0.59049e5 * t417 * t418 * t419;
  t423 = t279 * t115;
  t424 = t282 * rho[0];
  t425 = 0.1e1 / t424;
  t429 = 0.2e2 / 0.1594323e7 * t423 * t425 * t287 * t290;
  t433 = t205 * t165;
  t436 = t179 * t204;
  t439 = t134 * t64;
  t440 = t439 * t34;
  t442 = t309 * t28;
  t443 = t120 * params->eta;
  t444 = t443 * sigma[0];
  t447 = t129 * t108;
  t449 = t309 * params->eta;
  t450 = t34 * t134;
  t453 = t121 * sigma[0];
  t456 = t200 * t107;
  t459 = t440 / 0.4e1 + t442 * t444 / 0.3e1 - 0.2e1 / 0.3e1 * t447 + t449 * t450 / 0.2e1 + t322 * t453 / 0.2e1 - 0.2e1 / 0.3e1 * t137 * t456;
  t460 = t93 * t459;
  t469 = t179 * t218;
  t471 = t309 * t450;
  t473 = t320 * t28;
  t474 = t473 * t444;
  t476 = t137 * t108;
  t477 = t320 * params->eta;
  t482 = t358 * t78;
  t483 = t482 * t450;
  t485 = t155 * t160;
  t487 = t485 * t121 * t59;
  t490 = t155 * t212 * t107;
  t496 = t321 * t28;
  t503 = -0.3e1 / 0.4e1 * t471 - 0.3e1 / 0.4e1 * t474 + t476 - 0.9e1 / 0.8e1 * t477 * t450 - t353 * t453 + t151 * t456 - 0.15e2 / 0.4e1 * t483 - 0.3e1 * t487 + 0.2e1 * t490 - 0.9e1 / 0.2e1 * t485 * t200 * t33 * t134 - 0.7e1 / 0.2e1 * t371 * t496 * t120 * sigma[0] + 0.2e1 * t161 * t456;
  t504 = t93 * t503;
  t506 = t230 * t141;
  t509 = t230 * t165;
  t513 = t120 * t172;
  t517 = t290 * sigma[0];
  t524 = -0.1e2 / 0.729e3 * t26 * t168 + 0.4e2 / 0.177147e6 * t417 * t513 * t419 - 0.4e1 / 0.19683e5 * t393 * t121 * t517 + 0.8e1 / 0.729e3 * t224 * t225 * t175 + t416 - t422 + t429;
  t526 = 0.6e1 * t294 * t205 * t141 - 0.3e1 * t299 * t219 * t141 + 0.2e1 * t335 * t219 * t165 + 0.3e1 * t128 * t436 + 0.3e1 * t128 * t460 + 0.3e1 * t128 * t506 - t147 * t469 - t147 * t504 - t147 * t509 - 0.3e1 * t299 * t433 + t82 * t524 - t416 + t422 - t429;
  t531 = my_piecewise3(t3, 0, -t7 * t101 * t232 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t526);
  tv2rhosigma0 = 0.2e1 * rho[0] * t531 + 0.2e1 * t236;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  t537 = t93 * t54;
  t538 = t294 * t537;
  t539 = t64 * t29;
  t540 = t49 * t141;
  t541 = t539 * t540;
  t544 = t299 * t537;
  t546 = t539 * t49 * t165;
  t549 = t128 * t179;
  t552 = t439 * t239;
  t555 = t128 * t537;
  t556 = t71 * t28;
  t557 = t194 * params->eta;
  t558 = t557 * sigma[0];
  t559 = t556 * t558;
  t570 = t179 * t248;
  t572 = t239 * t134;
  t584 = 0.24e2 * t485 * t195 * t59 + 0.6e1 * t309 * t572 + 0.6e1 * t473 * t558 + 0.3e2 * t482 * t572 - 0.5e1 * t208 - 0.1e2 * t214;
  t585 = t93 * t584;
  t587 = -0.3e1 * t299 * t249 * t141 + 0.2e1 * t335 * t249 * t165 - t147 * t570 - t147 * t585 + 0.1e2 * t238 * t199 - 0.6e1 * t238 * t552 - 0.6e1 * t549 * t240 - 0.12e2 * t538 * t541 + 0.6e1 * t544 * t546 - 0.8e1 * t555 * t559;
  t592 = my_piecewise3(t3, 0, -t7 * t101 * t251 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t587);
  tv2rhotau0 = 0.2e1 * rho[0] * t592 + 0.2e1 * t255;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t598 = 0.5e1 / 0.59049e5 * t417 * t194 * t123 * t35;
  t599 = t279 * sigma[0];
  t600 = 0.1e1 / t282;
  t604 = 0.5e1 / 0.1062882e7 * t599 * t600 * t287 * t290;
  t605 = t204 * t204;
  t606 = t93 * t605;
  t609 = t205 * t218;
  t612 = t230 * t204;
  t615 = t195 * t64;
  t617 = t195 * params->eta;
  t620 = t496 * t194;
  t623 = -t615 / 0.16e2 - t309 * t617 / 0.4e1 - 0.3e1 / 0.16e2 * t320 * t620;
  t624 = t93 * t623;
  t627 = t218 * t218;
  t628 = t93 * t627;
  t631 = t230 * t218;
  t634 = t309 * t195;
  t636 = t320 * t617;
  t640 = t78 * t28;
  t642 = t358 * t640 * t194;
  t644 = t485 * t617;
  t648 = 0.3e1 / 0.16e2 * t634 + 0.9e1 / 0.16e2 * t636 + 0.3e1 / 0.8e1 * t352 * t620 + 0.15e2 / 0.16e2 * t642 + 0.9e1 / 0.4e1 * t644 + 0.21e2 / 0.16e2 * t371 * t620;
  t649 = t93 * t648;
  t655 = t392 * t56;
  t656 = t113 * t28;
  t661 = -0.5e1 / 0.59049e5 * t417 * t194 * t172 * t35 + t655 * t656 * t194 * t290 / 0.13122e5 + t598 - t604;
  t663 = 0.6e1 * t128 * t612 + 0.3e1 * t128 * t624 - 0.2e1 * t147 * t631 - t147 * t649 + 0.6e1 * t294 * t606 - 0.6e1 * t299 * t609 + 0.2e1 * t335 * t628 + t82 * t661 - t598 + t604;
  t667 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t663);
  tv2sigma20 = 0.2e1 * rho[0] * t667;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  t669 = t49 * t204;
  t670 = t539 * t669;
  t673 = t49 * t218;
  t674 = t539 * t673;
  t677 = t128 * t230;
  t681 = 0.1e1 / t19 / t117;
  t682 = t28 * t681;
  t683 = t682 * t64;
  t684 = t238 * t683;
  t686 = t681 * params->eta;
  t687 = t556 * t686;
  t690 = t249 * t204;
  t696 = t230 * t248;
  t698 = t309 * t682;
  t700 = t682 * params->eta;
  t704 = t358 * t640 * t681;
  t708 = -0.3e1 / 0.2e1 * t698 - 0.9e1 / 0.4e1 * t320 * t700 - 0.15e2 / 0.2e1 * t704 - 0.9e1 * t485 * t700;
  t709 = t93 * t708;
  t711 = -0.12e2 * t538 * t670 + 0.6e1 * t544 * t674 - 0.6e1 * t677 * t240 + 0.3e1 / 0.2e1 * t684 + 0.3e1 * t555 * t687 - 0.3e1 * t299 * t690 + 0.2e1 * t335 * t249 * t218 - t147 * t696 - t147 * t709;
  t715 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t711);
  tv2sigmatau0 = 0.2e1 * rho[0] * t715;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  t717 = t294 * t93;
  t719 = 0.1e1 / t19 / t105;
  t720 = t28 * t719;
  t721 = t320 * t720;
  t724 = t49 * t248;
  t725 = t539 * t724;
  t728 = t720 * t64;
  t731 = t248 * t248;
  t732 = t93 * t731;
  t740 = 0.6e2 * t358 * t640 * t719 + 0.12e2 * t309 * t720;
  t741 = t93 * t740;
  t743 = -t147 * t741 - 0.12e2 * t238 * t728 + 0.2e1 * t335 * t732 + 0.12e2 * t544 * t725 + 0.48e2 * t717 * t721;
  t747 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t743);
  tv2tau20 = 0.2e1 * rho[0] * t747;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t39, t40, t41, t42, t43;
  double t44, t46, t47, t49, t51, t52, t54, t55;
  double t56, t59, t62, t63, t64, t66, t67, t68;
  double t69, t70, t71, t73, t75, t76, t78, t80;
  double t81, t82, t85, t87, t88, t89, t90, t91;
  double t93, t95, t99, tzk0;

  double t101, t105, t107, t108, t109, t111, t113, t114;
  double t115, t116, t117, t118, t120, t121, t123, t124;
  double t127, t128, t129, t132, t134, t137, t138, t141;
  double t142, t145, t146, t147, t150, t151, t152, t155;
  double t156, t160, t161, t162, t165, t166, t168, t172;
  double t173, t174, t175, t179, t181, t186, tvrho0, t190;
  double t192, t194, t195, t198, t199, t200, t201, t204;
  double t205, t208, t212, t214, t218, t219, t224, t225;
  double t230, t232, t236, tvsigma0, tvlapl0, t238, t239, t240;
  double t248, t249, t251, t255, tvtau0;

  double t258, t266, t267, t268, t270, t271, t273, t274;
  double t277, t278, t279, t280, t281, t282, t283, t284;
  double t285, t287, t289, t290, t293, t294, t295, t296;
  double t299, t303, t306, t309, t310, t315, t317, t320;
  double t321, t322, t323, t324, t329, t330, t334, t335;
  double t336, t337, t340, t345, t351, t352, t353, t358;
  double t359, t362, t363, t369, t370, t371, t372, t373;
  double t376, t379, t382, t385, t389, t391, t392, t393;
  double t394, t398, t402, t404, t409, tv2rho20, t416, t417;
  double t418, t419, t422, t423, t424, t425, t429, t433;
  double t436, t439, t440, t442, t443, t444, t447, t449;
  double t450, t453, t456, t459, t460, t469, t471, t473;
  double t474, t476, t477, t482, t483, t485, t487, t490;
  double t496, t503, t504, t506, t509, t513, t517, t524;
  double t526, t531, tv2rhosigma0, tv2rholapl0, t537, t538, t539, t540;
  double t541, t544, t546, t549, t552, t555, t556, t557;
  double t558, t559, t570, t572, t584, t585, t587, t592;
  double tv2rhotau0, t598, t599, t600, t604, t605, t606, t609;
  double t612, t615, t617, t620, t623, t624, t627, t628;
  double t631, t634, t636, t640, t642, t644, t648, t649;
  double t655, t656, t661, t663, t667, tv2sigma20, tv2sigmalapl0, t669;
  double t670, t673, t674, t677, t681, t682, t683, t684;
  double t686, t687, t690, t696, t698, t700, t704, t708;
  double t709, t711, t715, tv2sigmatau0, tv2lapl20, tv2lapltau0, t717, t719;
  double t720, t721, t724, t725, t728, t731, t732, t740;
  double t741, t743, t747, tv2tau20;

  double t750, t761, t762, t763, t767, t768, t772, t773;
  double t780, t781, t782, t783, t785, t793, t797, t799;
  double t802, t806, t807, t808, t809, t811, t814, t815;
  double t818, t820, t821, t823, t839, t840, t841, t842;
  double t843, t849, t853, t857, t862, t864, t867, t868;
  double t869, t870, t873, t881, t882, t885, t886, t889;
  double t892, t893, t896, t901, t908, t912, t915, t918;
  double t924, t929, t932, t933, t936, t939, t942, t947;
  double t948, t951, t954, t967, t968, t977, t978, t983;
  double tv3rho30, t998, t1001, t1004, t1006, t1008, t1009, t1011;
  double t1012, t1013, t1015, t1016, t1019, t1023, t1025, t1026;
  double t1030, t1032, t1033, t1039, t1040, t1041, t1043, t1044;
  double t1045, t1050, t1053, t1054, t1056, t1058, t1059, t1060;
  double t1061, t1064, t1065, t1066, t1067, t1068, t1071, t1073;
  double t1086, t1093, t1094, t1096, t1097, t1098, t1100, t1103;
  double t1105, t1108, t1109, t1111, t1112, t1115, t1121, t1125;
  double t1138, t1139, t1142, t1145, t1151, t1157, t1169, t1191;
  double t1193, t1195, t1203, t1210, t1212, t1216, t1217, t1218;
  double t1219, t1222, t1223, t1224, t1227, t1230, t1233, t1238;
  double t1241, t1251, t1253, t1254, t1259, tv3rho2sigma0, tv3rho2lapl0, t1269;
  double t1270, t1271, t1272, t1273, t1276, t1277, t1278, t1279;
  double t1282, t1284, t1285, t1288, t1289, t1292, t1295, t1297;
  double t1302, t1303, t1307, t1310, t1311, t1328, t1329, t1331;
  double t1358, t1359, t1360, t1365, t1370, t1377, t1380, t1381;
  double t1384, t1386, t1390, t1393, t1396, t1399, t1400, t1403;
  double t1406, t1409, t1410, t1413, t1414, t1417, t1418, t1423;
  double tv3rho2tau0, t1438, t1441, t1477, t1478, t1479, t1481, t1482;
  double t1483, t1484, t1487, t1493, t1494, t1507, t1509, t1510;
  double t1513, t1514, t1516, t1518, t1520, t1521, t1522, t1524;
  double t1526, t1528, t1529, t1531, t1532, t1534, t1537, t1538;
  double t1541, t1544, t1546, t1549, t1551, t1553, t1555, t1557;
  double t1566, t1567, t1569, t1574, t1577, t1580, t1583, t1586;
  double t1589, t1591, t1592, t1605, t1606, t1609, t1612, t1615;
  double t1618, t1619, t1624, tv3rhosigma20, tv3rhosigmalapl0, t1651, t1653, t1654;
  double t1658, t1662, t1666, t1669, t1671, t1675, t1678, t1679;
  double t1682, t1685, t1686, t1689, t1690, t1693, t1697, t1698;
  double t1699, t1701, t1702, t1703, t1704, t1706, t1707, t1708;
  double t1710, t1713, t1730, t1731, t1732, t1735, t1742, t1743;
  double t1748, t1751, t1752, t1755, t1758, t1761, t1762, t1765;
  double t1766, t1769, t1772, t1773, t1774, t1777, t1778, t1779;
  double t1782, t1784, t1786, t1788, t1790, t1791, t1792, t1798;
  double t1799, t1804, t1806, t1815, t1816, t1818, t1820, t1825;
  double tv3rhosigmatau0, tv3rholapl20, tv3rholapltau0, t1834, t1838, t1841, t1844, t1847;
  double t1850, t1851, t1852, t1855, t1858, t1862, t1865, t1869;
  double t1870, t1880, t1881, t1883, t1884, t1885, t1888, t1889;
  double t1890, t1891, t1898, t1899, t1902, t1903, t1904, t1905;
  double t1909, t1927, t1928, t1929, t1932, t1933, t1938, tv3rhotau20;
  double t1945, t1949, t1950, t1957, t1958, t1960, t1963, t1975;
  double t1976, t1982, t1983, t1986, t1989, t1992, t1995, t1997;
  double t1999, t2002, t2003, t2006, t2009, t2012, t2016, t2018;
  double t2022, t2023, t2027, t2031, t2033, t2037, t2038, t2040;
  double t2044, tv3sigma30, tv3sigma2lapl0, t2046, t2050, t2052, t2055, t2056;
  double t2060, t2066, t2067, t2069, t2071, t2072, t2077, t2080;
  double t2082, t2086, t2089, t2090, t2091, t2093, t2094, t2095;
  double t2097, t2100, t2103, t2106, t2108, t2109, t2111, t2114;
  double t2115, t2120, t2121, t2126, t2127, t2136, t2154, t2155;
  double t2159, tv3sigma2tau0, tv3sigmalapl20, tv3sigmalapltau0, t2161, t2162, t2165, t2166;
  double t2169, t2172, t2173, t2174, t2176, t2177, t2181, t2185;
  double t2190, t2191, t2192, t2194, t2196, t2199, t2200, t2203;
  double t2204, t2207, t2212, t2213, t2222, t2234, t2239, t2240;
  double t2246, t2247, t2249, t2250, t2254, tv3sigmatau20, tv3lapl30, tv3lapl2tau0;
  double tv3lapltau20, t2256, t2257, t2261, t2262, t2265, t2268, t2269;
  double t2272, t2275, t2276, t2279, t2280, t2288, t2291, t2292;
  double t2294, t2298, tv3tau30;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = t26 * sigma[0];
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t19 * t19;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = 0.1e1 / params->kappa;
  t39 = 0.1e1 + 0.5e1 / 0.972e3 * t27 * t34 * t35;
  t40 = pow(t39, 0.1e1 / 0.5e1);
  t41 = t40 * t40;
  t42 = t41 * t41;
  t43 = 0.1e1 / t42;
  t44 = t34 * t43;
  t46 = 0.5e1 / 0.972e3 * t27 * t44;
  t47 = tau[0] * t29;
  t49 = 0.1e1 / t31 / rho[0];
  t51 = sigma[0] * t29;
  t52 = t51 * t33;
  t54 = t47 * t49 - t52 / 0.8e1;
  t55 = t54 * t54;
  t56 = t21 * t21;
  t59 = params->eta * sigma[0];
  t62 = 0.3e1 / 0.1e2 * t56 * t24 + t59 * t34 / 0.8e1;
  t63 = t62 * t62;
  t64 = 0.1e1 / t63;
  t66 = -t55 * t64 + 0.1e1;
  t67 = t66 * t66;
  t68 = t67 * t66;
  t69 = t55 * t54;
  t70 = t63 * t62;
  t71 = 0.1e1 / t70;
  t73 = t55 * t55;
  t75 = params->b * t73 * t55;
  t76 = t63 * t63;
  t78 = 0.1e1 / t76 / t63;
  t80 = t69 * t71 + t75 * t78 + 0.1e1;
  t81 = 0.1e1 / t80;
  t82 = t68 * t81;
  t85 = 0.5e1 / 0.972e3 * t26 * t52 + params->c;
  t87 = t85 * t35 + 0.1e1;
  t88 = pow(t87, 0.1e1 / 0.5e1);
  t89 = t88 * t88;
  t90 = t89 * t89;
  t91 = 0.1e1 / t90;
  t93 = t85 * t91 - t46;
  t95 = t82 * t93 + t46 + 0.1e1;
  t99 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t101 = t18 / t31;
  t105 = t30 * rho[0];
  t107 = 0.1e1 / t31 / t105;
  t108 = t29 * t107;
  t109 = t108 * t43;
  t111 = 0.1e2 / 0.729e3 * t27 * t109;
  t113 = 0.1e1 / t23 / t22;
  t114 = t56 * t113;
  t115 = sigma[0] * sigma[0];
  t116 = t114 * t115;
  t117 = t30 * t30;
  t118 = t117 * t30;
  t120 = 0.1e1 / t19 / t118;
  t121 = t28 * t120;
  t123 = 0.1e1 / t42 / t39;
  t124 = t123 * t35;
  t127 = 0.2e2 / 0.177147e6 * t116 * t121 * t124;
  t128 = t67 * t81;
  t129 = t54 * t64;
  t132 = t51 * t107;
  t134 = -0.5e1 / 0.3e1 * t47 * t33 + t132 / 0.3e1;
  t137 = t55 * t71;
  t138 = t137 * params->eta;
  t141 = -0.2e1 * t129 * t134 - 0.2e1 / 0.3e1 * t138 * t132;
  t142 = t93 * t141;
  t145 = t80 * t80;
  t146 = 0.1e1 / t145;
  t147 = t68 * t146;
  t150 = 0.1e1 / t76;
  t151 = t69 * t150;
  t152 = t151 * params->eta;
  t155 = params->b * t73 * t54;
  t156 = t78 * t134;
  t160 = 0.1e1 / t76 / t70;
  t161 = t75 * t160;
  t162 = t59 * t108;
  t165 = t152 * t132 + 0.3e1 * t137 * t134 + 0.6e1 * t155 * t156 + 0.2e1 * t161 * t162;
  t166 = t93 * t165;
  t168 = t108 * t91;
  t172 = 0.1e1 / t90 / t87;
  t173 = t85 * t172;
  t174 = t173 * t26;
  t175 = t107 * t35;
  t179 = -0.1e2 / 0.729e3 * t27 * t168 + 0.8e1 / 0.729e3 * t174 * t51 * t175 + t111 - t127;
  t181 = 0.3e1 * t128 * t142 - t147 * t166 + t82 * t179 - t111 + t127;
  t186 = my_piecewise3(t3, 0, -t7 * t101 * t95 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t181);
  tvrho0 = 0.2e1 * rho[0] * t186 + 0.2e1 * t99;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t190 = 0.5e1 / 0.972e3 * t26 * t44;
  t192 = t117 * rho[0];
  t194 = 0.1e1 / t19 / t192;
  t195 = t28 * t194;
  t198 = 0.5e1 / 0.118098e6 * t114 * sigma[0] * t195 * t124;
  t199 = t129 * t34;
  t200 = params->eta * t29;
  t201 = t200 * t33;
  t204 = t137 * t201 / 0.4e1 + t199 / 0.4e1;
  t205 = t93 * t204;
  t208 = t137 * t34;
  t212 = t78 * t29;
  t214 = t155 * t212 * t33;
  t218 = -0.3e1 / 0.8e1 * t208 - 0.3e1 / 0.8e1 * t151 * t201 - 0.3e1 / 0.4e1 * t214 - 0.3e1 / 0.4e1 * t161 * t201;
  t219 = t93 * t218;
  t224 = t173 * t21;
  t225 = t25 * t29;
  t230 = 0.5e1 / 0.972e3 * t26 * t34 * t91 - t224 * t225 * t33 * t35 / 0.243e3 - t190 + t198;
  t232 = 0.3e1 * t128 * t205 - t147 * t219 + t82 * t230 + t190 - t198;
  t236 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t232);
  tvsigma0 = 0.2e1 * rho[0] * t236;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t238 = t128 * t93;
  t239 = t29 * t49;
  t240 = t129 * t239;
  t248 = 0.6e1 * t155 * t212 * t49 + 0.3e1 * t137 * t239;
  t249 = t93 * t248;
  t251 = -t147 * t249 - 0.6e1 * t238 * t240;
  t255 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t251);
  tvtau0 = 0.2e1 * rho[0] * t255;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t258 = t18 * t49;
  t266 = 0.1e1 / t31 / t117;
  t267 = t29 * t266;
  t268 = t267 * t43;
  t270 = 0.11e3 / 0.2187e4 * t27 * t268;
  t271 = t117 * t105;
  t273 = 0.1e1 / t19 / t271;
  t274 = t28 * t273;
  t277 = 0.2e2 / 0.19683e5 * t116 * t274 * t124;
  t278 = t22 * t22;
  t279 = 0.1e1 / t278;
  t280 = t115 * sigma[0];
  t281 = t279 * t280;
  t282 = t117 * t117;
  t283 = t282 * t30;
  t284 = 0.1e1 / t283;
  t285 = t39 * t39;
  t287 = 0.1e1 / t42 / t285;
  t289 = params->kappa * params->kappa;
  t290 = 0.1e1 / t289;
  t293 = 0.16e3 / 0.4782969e7 * t281 * t284 * t287 * t290;
  t294 = t66 * t81;
  t295 = t141 * t141;
  t296 = t93 * t295;
  t299 = t67 * t146;
  t303 = t179 * t141;
  t306 = t134 * t134;
  t309 = t54 * t71;
  t310 = t309 * t134;
  t315 = t51 * t266;
  t317 = 0.4e2 / 0.9e1 * t47 * t107 - 0.11e2 / 0.9e1 * t315;
  t320 = t55 * t150;
  t321 = params->eta * params->eta;
  t322 = t320 * t321;
  t323 = t115 * t28;
  t324 = t323 * t273;
  t329 = -0.2e1 * t306 * t64 - 0.8e1 / 0.3e1 * t310 * t162 - 0.2e1 * t129 * t317 - 0.4e1 / 0.3e1 * t322 * t324 + 0.22e2 / 0.9e1 * t138 * t315;
  t330 = t93 * t329;
  t334 = 0.1e1 / t145 / t80;
  t335 = t68 * t334;
  t336 = t165 * t165;
  t337 = t93 * t336;
  t340 = t179 * t165;
  t345 = t320 * t134;
  t351 = 0.1e1 / t76 / t62;
  t352 = t69 * t351;
  t353 = t352 * t321;
  t358 = params->b * t73;
  t359 = t78 * t306;
  t362 = t160 * t134;
  t363 = t155 * t362;
  t369 = t76 * t76;
  t370 = 0.1e1 / t369;
  t371 = t75 * t370;
  t372 = t321 * t115;
  t373 = t372 * t274;
  t376 = t59 * t267;
  t379 = 0.6e1 * t309 * t306 + 0.6e1 * t345 * t162 + 0.3e1 * t137 * t317 + 0.8e1 / 0.3e1 * t353 * t324 - 0.11e2 / 0.3e1 * t152 * t315 + 0.3e2 * t358 * t359 + 0.24e2 * t363 * t162 + 0.6e1 * t155 * t78 * t317 + 0.28e2 / 0.3e1 * t371 * t373 - 0.22e2 / 0.3e1 * t161 * t376;
  t382 = t267 * t91;
  t385 = t172 * t35;
  t389 = t87 * t87;
  t391 = 0.1e1 / t90 / t389;
  t392 = t85 * t391;
  t393 = t392 * t114;
  t394 = t273 * t290;
  t398 = t266 * t35;
  t402 = 0.11e3 / 0.2187e4 * t27 * t382 - 0.32e3 / 0.531441e6 * t116 * t274 * t385 + 0.32e2 / 0.59049e5 * t393 * t323 * t394 - 0.88e2 / 0.2187e4 * t174 * t51 * t398 - t270 + t277 - t293;
  t404 = -0.6e1 * t299 * t142 * t165 - t147 * t93 * t379 + 0.6e1 * t128 * t303 + 0.3e1 * t128 * t330 - 0.2e1 * t147 * t340 + 0.6e1 * t294 * t296 + 0.2e1 * t335 * t337 + t82 * t402 + t270 - t277 + t293;
  t409 = my_piecewise3(t3, 0, t7 * t258 * t95 / 0.12e2 - t7 * t101 * t181 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t404);
  tv2rho20 = 0.2e1 * rho[0] * t409 + 0.4e1 * t186;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t416 = 0.1e2 / 0.729e3 * t26 * t109;
  t417 = t114 * t28;
  t418 = t120 * t123;
  t419 = sigma[0] * t35;
  t422 = 0.2e2 / 0.59049e5 * t417 * t418 * t419;
  t423 = t279 * t115;
  t424 = t282 * rho[0];
  t425 = 0.1e1 / t424;
  t429 = 0.2e2 / 0.1594323e7 * t423 * t425 * t287 * t290;
  t433 = t205 * t165;
  t436 = t179 * t204;
  t439 = t134 * t64;
  t440 = t439 * t34;
  t442 = t309 * t28;
  t443 = t120 * params->eta;
  t444 = t443 * sigma[0];
  t447 = t129 * t108;
  t449 = t309 * params->eta;
  t450 = t34 * t134;
  t453 = t121 * sigma[0];
  t456 = t200 * t107;
  t459 = t440 / 0.4e1 + t442 * t444 / 0.3e1 - 0.2e1 / 0.3e1 * t447 + t449 * t450 / 0.2e1 + t322 * t453 / 0.2e1 - 0.2e1 / 0.3e1 * t137 * t456;
  t460 = t93 * t459;
  t469 = t179 * t218;
  t471 = t309 * t450;
  t473 = t320 * t28;
  t474 = t473 * t444;
  t476 = t137 * t108;
  t477 = t320 * params->eta;
  t482 = t358 * t78;
  t483 = t482 * t450;
  t485 = t155 * t160;
  t487 = t485 * t121 * t59;
  t490 = t155 * t212 * t107;
  t496 = t321 * t28;
  t503 = -0.3e1 / 0.4e1 * t471 - 0.3e1 / 0.4e1 * t474 + t476 - 0.9e1 / 0.8e1 * t477 * t450 - t353 * t453 + t151 * t456 - 0.15e2 / 0.4e1 * t483 - 0.3e1 * t487 + 0.2e1 * t490 - 0.9e1 / 0.2e1 * t485 * t200 * t33 * t134 - 0.7e1 / 0.2e1 * t371 * t496 * t120 * sigma[0] + 0.2e1 * t161 * t456;
  t504 = t93 * t503;
  t506 = t230 * t141;
  t509 = t230 * t165;
  t513 = t120 * t172;
  t517 = t290 * sigma[0];
  t524 = -0.1e2 / 0.729e3 * t26 * t168 + 0.4e2 / 0.177147e6 * t417 * t513 * t419 - 0.4e1 / 0.19683e5 * t393 * t121 * t517 + 0.8e1 / 0.729e3 * t224 * t225 * t175 + t416 - t422 + t429;
  t526 = 0.6e1 * t294 * t205 * t141 - 0.3e1 * t299 * t219 * t141 + 0.2e1 * t335 * t219 * t165 + 0.3e1 * t128 * t436 + 0.3e1 * t128 * t460 + 0.3e1 * t128 * t506 - t147 * t469 - t147 * t504 - t147 * t509 - 0.3e1 * t299 * t433 + t82 * t524 - t416 + t422 - t429;
  t531 = my_piecewise3(t3, 0, -t7 * t101 * t232 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t526);
  tv2rhosigma0 = 0.2e1 * rho[0] * t531 + 0.2e1 * t236;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  t537 = t93 * t54;
  t538 = t294 * t537;
  t539 = t64 * t29;
  t540 = t49 * t141;
  t541 = t539 * t540;
  t544 = t299 * t537;
  t546 = t539 * t49 * t165;
  t549 = t128 * t179;
  t552 = t439 * t239;
  t555 = t128 * t537;
  t556 = t71 * t28;
  t557 = t194 * params->eta;
  t558 = t557 * sigma[0];
  t559 = t556 * t558;
  t570 = t179 * t248;
  t572 = t239 * t134;
  t584 = 0.24e2 * t485 * t195 * t59 + 0.6e1 * t309 * t572 + 0.6e1 * t473 * t558 + 0.3e2 * t482 * t572 - 0.5e1 * t208 - 0.1e2 * t214;
  t585 = t93 * t584;
  t587 = -0.3e1 * t299 * t249 * t141 + 0.2e1 * t335 * t249 * t165 - t147 * t570 - t147 * t585 + 0.1e2 * t238 * t199 - 0.6e1 * t238 * t552 - 0.6e1 * t549 * t240 - 0.12e2 * t538 * t541 + 0.6e1 * t544 * t546 - 0.8e1 * t555 * t559;
  t592 = my_piecewise3(t3, 0, -t7 * t101 * t251 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t587);
  tv2rhotau0 = 0.2e1 * rho[0] * t592 + 0.2e1 * t255;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t598 = 0.5e1 / 0.59049e5 * t417 * t194 * t123 * t35;
  t599 = t279 * sigma[0];
  t600 = 0.1e1 / t282;
  t604 = 0.5e1 / 0.1062882e7 * t599 * t600 * t287 * t290;
  t605 = t204 * t204;
  t606 = t93 * t605;
  t609 = t205 * t218;
  t612 = t230 * t204;
  t615 = t195 * t64;
  t617 = t195 * params->eta;
  t620 = t496 * t194;
  t623 = -t615 / 0.16e2 - t309 * t617 / 0.4e1 - 0.3e1 / 0.16e2 * t320 * t620;
  t624 = t93 * t623;
  t627 = t218 * t218;
  t628 = t93 * t627;
  t631 = t230 * t218;
  t634 = t309 * t195;
  t636 = t320 * t617;
  t640 = t78 * t28;
  t642 = t358 * t640 * t194;
  t644 = t485 * t617;
  t648 = 0.3e1 / 0.16e2 * t634 + 0.9e1 / 0.16e2 * t636 + 0.3e1 / 0.8e1 * t352 * t620 + 0.15e2 / 0.16e2 * t642 + 0.9e1 / 0.4e1 * t644 + 0.21e2 / 0.16e2 * t371 * t620;
  t649 = t93 * t648;
  t655 = t392 * t56;
  t656 = t113 * t28;
  t661 = -0.5e1 / 0.59049e5 * t417 * t194 * t172 * t35 + t655 * t656 * t194 * t290 / 0.13122e5 + t598 - t604;
  t663 = 0.6e1 * t128 * t612 + 0.3e1 * t128 * t624 - 0.2e1 * t147 * t631 - t147 * t649 + 0.6e1 * t294 * t606 - 0.6e1 * t299 * t609 + 0.2e1 * t335 * t628 + t82 * t661 - t598 + t604;
  t667 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t663);
  tv2sigma20 = 0.2e1 * rho[0] * t667;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  t669 = t49 * t204;
  t670 = t539 * t669;
  t673 = t49 * t218;
  t674 = t539 * t673;
  t677 = t128 * t230;
  t681 = 0.1e1 / t19 / t117;
  t682 = t28 * t681;
  t683 = t682 * t64;
  t684 = t238 * t683;
  t686 = t681 * params->eta;
  t687 = t556 * t686;
  t690 = t249 * t204;
  t696 = t230 * t248;
  t698 = t309 * t682;
  t700 = t682 * params->eta;
  t704 = t358 * t640 * t681;
  t708 = -0.3e1 / 0.2e1 * t698 - 0.9e1 / 0.4e1 * t320 * t700 - 0.15e2 / 0.2e1 * t704 - 0.9e1 * t485 * t700;
  t709 = t93 * t708;
  t711 = -0.12e2 * t538 * t670 + 0.6e1 * t544 * t674 - 0.6e1 * t677 * t240 + 0.3e1 / 0.2e1 * t684 + 0.3e1 * t555 * t687 - 0.3e1 * t299 * t690 + 0.2e1 * t335 * t249 * t218 - t147 * t696 - t147 * t709;
  t715 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t711);
  tv2sigmatau0 = 0.2e1 * rho[0] * t715;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  t717 = t294 * t93;
  t719 = 0.1e1 / t19 / t105;
  t720 = t28 * t719;
  t721 = t320 * t720;
  t724 = t49 * t248;
  t725 = t539 * t724;
  t728 = t720 * t64;
  t731 = t248 * t248;
  t732 = t93 * t731;
  t740 = 0.6e2 * t358 * t640 * t719 + 0.12e2 * t309 * t720;
  t741 = t93 * t740;
  t743 = -t147 * t741 - 0.12e2 * t238 * t728 + 0.2e1 * t335 * t732 + 0.12e2 * t544 * t725 + 0.48e2 * t717 * t721;
  t747 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t743);
  tv2tau20 = 0.2e1 * rho[0] * t747;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  t750 = t18 * t33;
  t761 = 0.1e1 / t31 / t192;
  t762 = t29 * t761;
  t763 = t762 * t91;
  t767 = 0.1e1 / t19 / t282;
  t768 = t28 * t767;
  t772 = t282 * t105;
  t773 = 0.1e1 / t772;
  t780 = 0.1e1 / t90 / t389 / t87;
  t781 = t85 * t780;
  t782 = t781 * t279;
  t783 = t280 * t773;
  t785 = 0.1e1 / t289 / params->kappa;
  t793 = t761 * t35;
  t797 = t762 * t43;
  t799 = 0.154e4 / 0.6561e4 * t27 * t797;
  t802 = 0.1364e5 / 0.1594323e7 * t116 * t768 * t124;
  t806 = 0.304e4 / 0.4782969e7 * t281 * t773 * t287 * t290;
  t807 = t115 * t115;
  t808 = t279 * t807;
  t809 = t282 * t192;
  t811 = 0.1e1 / t31 / t809;
  t814 = 0.1e1 / t42 / t285 / t39;
  t815 = t811 * t814;
  t818 = t785 * t21 * t225;
  t820 = 0.448e4 / 0.3486784401e10 * t808 * t815 * t818;
  t821 = -0.154e4 / 0.6561e4 * t27 * t763 + 0.352e4 / 0.531441e6 * t116 * t768 * t385 - 0.128e4 / 0.4782969e7 * t281 * t773 * t391 * t290 + 0.3584e4 / 0.14348907e8 * t782 * t783 * t785 - 0.352e3 / 0.59049e5 * t393 * t323 * t767 * t290 + 0.1232e4 / 0.6561e4 * t174 * t51 * t793 + t799 - t802 + t806 - t820;
  t823 = t66 * t146;
  t839 = t145 * t145;
  t840 = 0.1e1 / t839;
  t841 = t68 * t840;
  t842 = t336 * t165;
  t843 = t93 * t842;
  t849 = t67 * t334;
  t853 = 0.18e2 * t294 * t142 * t329 - 0.9e1 * t299 * t142 * t379 + 0.18e2 * t849 * t142 * t336 - 0.18e2 * t823 * t296 * t165 - 0.18e2 * t299 * t303 * t165 - 0.9e1 * t299 * t330 * t165 + 0.6e1 * t335 * t166 * t379 + t82 * t821 - 0.6e1 * t841 * t843 - t799 - t806;
  t857 = t306 * t134;
  t862 = t51 * t761;
  t864 = -0.44e3 / 0.27e2 * t47 * t266 + 0.154e3 / 0.27e2 * t862;
  t867 = t69 * t78;
  t868 = t321 * params->eta;
  t869 = t868 * t280;
  t870 = t869 * t773;
  t873 = params->b * t69;
  t881 = 0.1e1 / t369 / t62;
  t882 = t75 * t881;
  t885 = t54 * t150;
  t886 = t885 * t306;
  t889 = t320 * t317;
  t892 = t55 * t351;
  t893 = t892 * t134;
  t896 = t323 * t767;
  t901 = t134 * t317;
  t908 = t155 * t160 * t317;
  t912 = t155 * t370 * t134;
  t915 = t372 * t768;
  t918 = t59 * t762;
  t924 = t358 * t160 * t306;
  t929 = 0.6e1 * t857 * t71 + 0.3e1 * t137 * t864 + 0.8e2 / 0.9e1 * t867 * t870 + 0.12e3 * t873 * t78 * t857 + 0.9e2 * t358 * t156 * t317 + 0.448e3 / 0.9e1 * t882 * t870 + 0.18e2 * t886 * t162 + 0.9e1 * t889 * t162 + 0.24e2 * t893 * t373 - 0.88e2 / 0.3e1 * t353 * t896 + 0.154e3 / 0.9e1 * t152 * t862 + 0.18e2 * t309 * t901 + 0.6e1 * t155 * t78 * t864 + 0.36e2 * t908 * t162 + 0.168e3 * t912 * t373 - 0.308e3 / 0.3e1 * t371 * t915 + 0.308e3 / 0.9e1 * t161 * t918 - 0.33e2 * t345 * t376 + 0.18e3 * t924 * t162 - 0.132e3 * t363 * t376;
  t932 = t295 * t141;
  t933 = t932 * t81;
  t936 = t179 * t295;
  t939 = t402 * t141;
  t942 = t179 * t329;
  t947 = t306 * t71;
  t948 = t947 * params->eta;
  t951 = t885 * t134;
  t954 = t309 * t317;
  t967 = -0.6e1 * t439 * t317 - 0.4e1 * t948 * t132 - 0.8e1 * t951 * t373 - 0.4e1 * t954 * t162 + 0.44e2 / 0.3e1 * t310 * t376 - 0.2e1 * t129 * t864 - 0.32e2 / 0.9e1 * t892 * t870 + 0.44e2 / 0.3e1 * t322 * t896 - 0.308e3 / 0.27e2 * t138 * t862;
  t968 = t93 * t967;
  t977 = -0.3e1 * t147 * t402 * t165 - 0.3e1 * t147 * t179 * t379 - t147 * t93 * t929 + 0.6e1 * t335 * t179 * t336 + 0.9e1 * t128 * t939 + 0.9e1 * t128 * t942 + 0.3e1 * t128 * t968 + 0.18e2 * t294 * t936 + 0.6e1 * t933 * t93 + t802 + t820;
  t978 = t853 + t977;
  t983 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t750 * t95 + t7 * t258 * t181 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t101 * t404 - 0.3e1 / 0.8e1 * t7 * t20 * t978);
  tv3rho30 = 0.2e1 * rho[0] * t983 + 0.6e1 * t409;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t998 = t524 * t141;
  t1001 = t230 * t329;
  t1004 = t947 * t34;
  t1006 = t137 * t267;
  t1008 = t34 * t317;
  t1009 = t309 * t1008;
  t1011 = t284 * t321;
  t1012 = t1011 * t115;
  t1013 = t892 * t1012;
  t1015 = t868 * t284;
  t1016 = t1015 * t115;
  t1019 = t200 * t266;
  t1023 = t155 * t212 * t266;
  t1025 = t108 * t134;
  t1026 = t309 * t1025;
  t1030 = t482 * t1008;
  t1032 = t155 * t370;
  t1033 = t1032 * t1012;
  t1039 = t273 * params->eta;
  t1040 = t1039 * sigma[0];
  t1041 = t473 * t1040;
  t1043 = -0.3e1 / 0.4e1 * t1004 - 0.11e2 / 0.3e1 * t1006 - 0.3e1 / 0.4e1 * t1009 - 0.2e1 * t1013 - 0.1e2 / 0.3e1 * t867 * t1016 - 0.11e2 / 0.3e1 * t151 * t1019 - 0.22e2 / 0.3e1 * t1023 + 0.4e1 * t1026 - 0.9e1 / 0.8e1 * t477 * t1008 - 0.15e2 / 0.4e1 * t1030 - 0.14e2 * t1033 - 0.56e2 / 0.3e1 * t882 * t1016 - 0.22e2 / 0.3e1 * t161 * t1019 + 0.27e2 / 0.4e1 * t1041;
  t1044 = t885 * params->eta;
  t1045 = t34 * t306;
  t1050 = t274 * sigma[0];
  t1053 = t873 * t78;
  t1054 = t1053 * t1045;
  t1056 = t482 * t1025;
  t1058 = t370 * t321;
  t1059 = t155 * t1058;
  t1060 = t134 * sigma[0];
  t1061 = t121 * t1060;
  t1064 = t160 * t28;
  t1065 = t358 * t1064;
  t1066 = t120 * t134;
  t1067 = t1066 * t59;
  t1068 = t1065 * t1067;
  t1071 = t485 * t274 * t59;
  t1073 = t358 * t160;
  t1086 = t892 * t321;
  t1093 = t885 * t28;
  t1094 = t1093 * t1067;
  t1096 = -0.9e1 / 0.4e1 * t1044 * t1045 + 0.6e1 * t477 * t1025 + 0.9e1 * t353 * t1050 - 0.15e2 * t1054 + 0.2e2 * t1056 - 0.42e2 * t1059 * t1061 - 0.3e2 * t1068 + 0.27e2 * t1071 - 0.45e2 / 0.2e1 * t1073 * t200 * t33 * t306 + 0.24e2 * t485 * t200 * t107 * t134 + 0.63e2 / 0.2e1 * t371 * t496 * t273 * sigma[0] - 0.6e1 * t1086 * t1061 - 0.9e1 / 0.2e1 * t485 * t200 * t33 * t317 - 0.3e1 * t1094;
  t1097 = t1043 + t1096;
  t1098 = t93 * t1097;
  t1100 = t179 * t503;
  t1103 = t402 * t218;
  t1105 = t179 * t459;
  t1108 = t317 * t64;
  t1109 = t1108 * t34;
  t1111 = t134 * t71;
  t1112 = t1111 * t28;
  t1115 = t439 * t108;
  t1121 = t129 * t267;
  t1125 = t885 * t321;
  t1138 = t1109 / 0.4e1 + 0.2e1 / 0.3e1 * t1112 * t444 - 0.4e1 / 0.3e1 * t1115 + 0.2e1 / 0.3e1 * t885 * t1012 - 0.3e1 * t442 * t1040 + 0.22e2 / 0.9e1 * t1121 + t947 * t201 / 0.2e1 + 0.2e1 * t1125 * t1061 - 0.8e1 / 0.3e1 * t449 * t1025 + t449 * t1008 / 0.2e1 + 0.4e1 / 0.3e1 * t892 * t1016 - 0.9e1 / 0.2e1 * t322 * t1050 + 0.22e2 / 0.9e1 * t137 * t1019;
  t1139 = t93 * t1138;
  t1142 = t402 * t204;
  t1145 = t295 * t81;
  t1151 = t230 * t295;
  t1157 = t205 * t329;
  t1169 = 0.12e2 * t294 * t436 * t141 - 0.2e1 * t147 * t524 * t165 - t147 * t230 * t379 - 0.6e1 * t299 * t436 * t165 - 0.6e1 * t299 * t460 * t165 - 0.3e1 * t299 * t205 * t379 + 0.2e1 * t335 * t230 * t336 + 0.3e1 * t128 * t1001 - t147 * t1098 - 0.2e1 * t147 * t1100 - t147 * t1103 + 0.6e1 * t128 * t1105 + 0.3e1 * t128 * t1139 + 0.3e1 * t128 * t1142 + 0.6e1 * t1145 * t205 + 0.6e1 * t294 * t1151 + 0.6e1 * t294 * t1157 + 0.6e1 * t128 * t998;
  t1191 = t279 * t284;
  t1193 = t287 * t115 * t290;
  t1195 = 0.34e3 / 0.1594323e7 * t1191 * t1193;
  t1203 = 0.11e3 / 0.2187e4 * t26 * t268;
  t1210 = t282 * t117;
  t1212 = 0.1e1 / t31 / t1210;
  t1216 = 0.56e3 / 0.1162261467e10 * t281 * t1212 * t814 * t818;
  t1217 = t849 * t93;
  t1218 = t218 * t141;
  t1219 = t1218 * t165;
  t1222 = t823 * t93;
  t1223 = t204 * t141;
  t1224 = t1223 * t165;
  t1227 = t273 * t123;
  t1230 = 0.13e4 / 0.531441e6 * t417 * t1227 * t419;
  t1233 = t273 * t172;
  t1238 = t391 * t115 * t290;
  t1241 = t284 * t785;
  t1251 = 0.11e3 / 0.2187e4 * t26 * t382 - 0.4e2 / 0.19683e5 * t417 * t1233 * t419 + 0.16e3 / 0.1594323e7 * t1191 * t1238 - 0.448e3 / 0.4782969e7 * t782 * t1241 * t115 + 0.4e1 / 0.2187e4 * t393 * t274 * t517 - 0.88e2 / 0.2187e4 * t224 * t225 * t398 - t1203 + t1230 - t1195 + t1216;
  t1253 = 0.12e2 * t294 * t460 * t141 - 0.6e1 * t299 * t469 * t141 - 0.6e1 * t299 * t504 * t141 - 0.6e1 * t299 * t506 * t165 + 0.4e1 * t335 * t469 * t165 + 0.4e1 * t335 * t504 * t165 + 0.6e1 * t849 * t205 * t336 - 0.6e1 * t823 * t219 * t295 - 0.3e1 * t299 * t219 * t329 + 0.2e1 * t335 * t219 * t379 - 0.6e1 * t841 * t219 * t336 + 0.12e2 * t1217 * t1219 - 0.12e2 * t1222 * t1224 + t82 * t1251 + t1195 + t1203 - t1216 - t1230;
  t1254 = t1169 + t1253;
  t1259 = my_piecewise3(t3, 0, t7 * t258 * t232 / 0.12e2 - t7 * t101 * t526 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1254);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t1259 + 0.4e1 * t531;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2lapl0 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  t1269 = t537 * t71;
  t1270 = t294 * t1269;
  t1271 = t141 * params->eta;
  t1272 = t1271 * sigma[0];
  t1273 = t195 * t1272;
  t1276 = t299 * t1269;
  t1277 = t165 * params->eta;
  t1278 = t1277 * sigma[0];
  t1279 = t195 * t1278;
  t1282 = t402 * t248;
  t1284 = t179 * t54;
  t1285 = t128 * t1284;
  t1288 = t93 * t134;
  t1289 = t128 * t1288;
  t1292 = t556 * t444;
  t1295 = t823 * t537;
  t1297 = t539 * t540 * t165;
  t1302 = t194 * t134;
  t1303 = t1302 * t59;
  t1307 = t239 * t317;
  t1310 = t425 * t321;
  t1311 = t1310 * t115;
  t1328 = 0.6e1 * t947 * t239 + 0.24e2 * t1093 * t1303 - 0.2e2 * t471 + 0.6e1 * t309 * t1307 + 0.16e2 * t892 * t1311 - 0.42e2 * t474 + 0.4e2 / 0.3e1 * t476 + 0.12e3 * t1053 * t239 * t306 + 0.24e3 * t1065 * t1303 - 0.1e3 * t483 + 0.3e2 * t482 * t1307 + 0.112e3 * t1032 * t1311 - 0.168e3 * t487 + 0.8e2 / 0.3e1 * t490;
  t1329 = t93 * t1328;
  t1331 = t179 * t584;
  t1358 = -0.6e1 * t299 * t570 * t141 - 0.6e1 * t299 * t585 * t141 + 0.4e1 * t335 * t570 * t165 + 0.4e1 * t335 * t585 * t165 - 0.6e1 * t823 * t249 * t295 - 0.3e1 * t299 * t249 * t329 + 0.2e1 * t335 * t249 * t379 - 0.6e1 * t841 * t249 * t336 - 0.32e2 * t1270 * t1273 + 0.16e2 * t1276 * t1279 - t147 * t1282 - 0.16e2 * t1285 * t559 - 0.16e2 * t1289 * t559 + 0.56e2 * t555 * t1292 + 0.24e2 * t1295 * t1297 - t147 * t1329 - 0.2e1 * t147 * t1331;
  t1359 = t248 * t141;
  t1360 = t1359 * t165;
  t1365 = t128 * t402;
  t1370 = t1108 * t239;
  t1377 = t1145 * t93;
  t1380 = t33 * t141;
  t1381 = t539 * t1380;
  t1384 = t849 * t537;
  t1386 = t539 * t49 * t336;
  t1390 = t539 * t33 * t165;
  t1393 = t294 * t1284;
  t1396 = t294 * t1288;
  t1399 = t49 * t329;
  t1400 = t539 * t1399;
  t1403 = t299 * t1284;
  t1406 = t299 * t1288;
  t1409 = t49 * t379;
  t1410 = t539 * t1409;
  t1413 = t150 * t425;
  t1414 = t1413 * t372;
  t1417 = 0.12e2 * t1217 * t1360 + 0.2e2 * t238 * t440 - 0.6e1 * t1365 * t240 - 0.12e2 * t549 * t552 - 0.6e1 * t238 * t1370 + 0.2e2 * t549 * t199 - 0.8e2 / 0.3e1 * t238 * t447 - 0.12e2 * t1377 * t240 + 0.4e2 * t538 * t1381 - 0.12e2 * t1384 * t1386 - 0.2e2 * t544 * t1390 - 0.24e2 * t1393 * t541 - 0.24e2 * t1396 * t541 - 0.12e2 * t538 * t1400 + 0.12e2 * t1403 * t546 + 0.12e2 * t1406 * t546 + 0.6e1 * t544 * t1410 - 0.16e2 * t555 * t1414;
  t1418 = t1358 + t1417;
  t1423 = my_piecewise3(t3, 0, t7 * t258 * t251 / 0.12e2 - t7 * t101 * t587 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1418);
  tv3rho2tau0 = 0.2e1 * rho[0] * t1423 + 0.4e1 * t592;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  t1438 = t606 * t165;
  t1441 = t205 * t459;
  t1477 = t279 * t425;
  t1478 = t287 * t290;
  t1479 = t1478 * sigma[0];
  t1481 = 0.1e3 / 0.1594323e7 * t1477 * t1479;
  t1482 = 0.12e2 * t294 * t612 * t141 + 0.6e1 * t294 * t624 * t141 - 0.6e1 * t299 * t631 * t141 - 0.3e1 * t299 * t649 * t141 + 0.6e1 * t849 * t628 * t141 - 0.6e1 * t299 * t612 * t165 - 0.3e1 * t299 * t624 * t165 + 0.4e1 * t335 * t631 * t165 + 0.2e1 * t335 * t649 * t165 - 0.6e1 * t841 * t628 * t165 - 0.6e1 * t299 * t205 * t503 - 0.6e1 * t299 * t436 * t218 - 0.6e1 * t299 * t460 * t218 + 0.4e1 * t335 * t219 * t503 - 0.6e1 * t823 * t1438 + 0.12e2 * t294 * t1441 - t1481;
  t1483 = t204 * t218;
  t1484 = t1483 * t141;
  t1487 = t1483 * t165;
  t1493 = t391 * t290;
  t1494 = t1493 * sigma[0];
  t1507 = 0.8e2 / 0.177147e6 * t417 * t418 * t35;
  t1509 = 0.1e1 / t31 / t772;
  t1510 = t1509 * t814;
  t1513 = 0.7e2 / 0.387420489e9 * t423 * t1510 * t818;
  t1514 = 0.8e2 / 0.177147e6 * t417 * t513 * t35 - 0.2e2 / 0.531441e6 * t1477 * t1494 + 0.56e2 / 0.1594323e7 * t782 * t425 * t785 * sigma[0] - 0.8e1 / 0.19683e5 * t655 * t656 * t120 * t290 - t1507 + t1481 - t1513;
  t1516 = t179 * t648;
  t1518 = t1111 * t195;
  t1520 = t425 * params->eta;
  t1521 = t1520 * sigma[0];
  t1522 = t885 * t1521;
  t1524 = t309 * t121;
  t1526 = t1093 * t557 * t134;
  t1528 = t1310 * sigma[0];
  t1529 = t892 * t1528;
  t1531 = t121 * params->eta;
  t1532 = t320 * t1531;
  t1534 = t195 * t134;
  t1537 = t868 * t425;
  t1538 = t1537 * sigma[0];
  t1541 = t496 * t120;
  t1544 = t1053 * t1534;
  t1546 = t1073 * t1521;
  t1549 = t358 * t640 * t120;
  t1551 = params->eta * t134;
  t1553 = t1073 * t195 * t1551;
  t1555 = t1032 * t1528;
  t1557 = t485 * t1531;
  t1566 = 0.3e1 / 0.16e2 * t1518 + 0.3e1 / 0.8e1 * t1522 - t1524 + 0.9e1 / 0.8e1 * t1526 + 0.3e1 / 0.2e1 * t1529 - 0.3e1 * t1532 + 0.9e1 / 0.8e1 * t1086 * t1534 + 0.5e1 / 0.4e1 * t867 * t1538 - 0.2e1 * t352 * t1541 + 0.15e2 / 0.4e1 * t1544 + 0.15e2 / 0.4e1 * t1546 - 0.5e1 * t1549 + 0.45e2 / 0.4e1 * t1553 + 0.21e2 / 0.2e1 * t1555 - 0.12e2 * t1557 + 0.63e2 / 0.8e1 * t1032 * t496 * t1302 + 0.7e1 * t882 * t1538 - 0.7e1 * t371 * t1541;
  t1567 = t93 * t1566;
  t1569 = t661 * t141;
  t1574 = t141 * t81;
  t1577 = t179 * t605;
  t1580 = t524 * t204;
  t1583 = t230 * t459;
  t1586 = t179 * t623;
  t1589 = t121 * t64;
  t1591 = t425 * t71;
  t1592 = t1591 * t59;
  t1605 = t1589 / 0.3e1 - t1592 / 0.12e2 - t1111 * t617 / 0.4e1 - t885 * t1528 / 0.2e1 + 0.4e1 / 0.3e1 * t309 * t1531 - 0.3e1 / 0.8e1 * t1125 * t1534 - t892 * t1538 / 0.2e1 + t320 * t1541;
  t1606 = t93 * t1605;
  t1609 = t179 * t627;
  t1612 = t524 * t218;
  t1615 = t230 * t503;
  t1618 = -t147 * t661 * t165 + 0.12e2 * t1217 * t1487 - 0.12e2 * t1222 * t1484 + 0.3e1 * t128 * t1569 + 0.6e1 * t128 * t1580 + 0.6e1 * t128 * t1583 + 0.3e1 * t128 * t1586 + 0.3e1 * t128 * t1606 - t147 * t1516 - t147 * t1567 - 0.2e1 * t147 * t1612 - 0.2e1 * t147 * t1615 + t82 * t1514 + 0.6e1 * t1574 * t606 + 0.6e1 * t294 * t1577 + 0.2e1 * t335 * t1609 + t1507 + t1513;
  t1619 = t1482 + t1618;
  t1624 = my_piecewise3(t3, 0, -t7 * t101 * t663 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1619);
  tv3rhosigma20 = 0.2e1 * rho[0] * t1624 + 0.2e1 * t667;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigmalapl0 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  t1651 = t238 * t615;
  t1653 = t230 * t54;
  t1654 = t128 * t1653;
  t1658 = t556 * t686 * t141;
  t1662 = t556 * t686 * t165;
  t1666 = t539 * t669 * t165;
  t1669 = 0.2e1 * t335 * t585 * t218 + 0.2e1 * t335 * t249 * t503 - 0.3e1 * t299 * t249 * t459 + 0.2e1 * t335 * t570 * t218 + 0.2e1 * t335 * t709 * t165 - 0.3e1 * t299 * t570 * t204 - 0.3e1 * t299 * t585 * t204 - 0.13e2 / 0.2e1 * t1651 - 0.8e1 * t1654 * t559 + 0.6e1 * t538 * t1658 - 0.3e1 * t544 * t1662 + 0.12e2 * t1295 * t1666;
  t1671 = t539 * t673 * t141;
  t1675 = t539 * t673 * t165;
  t1678 = t248 * t204;
  t1679 = t1678 * t141;
  t1682 = t1678 * t165;
  t1685 = t248 * t218;
  t1686 = t1685 * t141;
  t1689 = t841 * t93;
  t1690 = t1685 * t165;
  t1693 = t549 * t683;
  t1697 = t64 * t141;
  t1698 = t682 * t1697;
  t1699 = t717 * t1698;
  t1701 = t299 * t93;
  t1702 = t64 * t165;
  t1703 = t682 * t1702;
  t1704 = t1701 * t1703;
  t1706 = t600 * t71;
  t1707 = t1706 * t59;
  t1708 = t238 * t1707;
  t1710 = t128 * t524;
  t1713 = 0.12e2 * t1295 * t1671 - 0.12e2 * t1384 * t1675 - 0.6e1 * t1222 * t1679 + 0.6e1 * t1217 * t1682 + 0.6e1 * t1217 * t1686 - 0.6e1 * t1689 * t1690 + 0.3e1 / 0.2e1 * t1693 + 0.1e2 * t677 * t199 + 0.3e1 * t1699 - 0.3e1 / 0.2e1 * t1704 + 0.2e1 * t1708 - 0.6e1 * t1710 * t240;
  t1730 = t150 * t600;
  t1731 = t321 * sigma[0];
  t1732 = t1730 * t1731;
  t1735 = t1574 * t537;
  t1742 = t49 * t459;
  t1743 = t539 * t1742;
  t1748 = -0.3e1 * t299 * t696 * t141 - 0.3e1 * t299 * t709 * t141 + 0.2e1 * t335 * t696 * t165 + 0.3e1 * t1285 * t687 + 0.3e1 * t1289 * t687 - 0.12e2 * t1393 * t670 - 0.12e2 * t1396 * t670 + 0.6e1 * t1403 * t674 + 0.6e1 * t555 * t1732 - 0.12e2 * t1735 * t670 - 0.12e2 * t538 * t1743 - 0.6e1 * t677 * t552;
  t1751 = t49 * t503;
  t1752 = t539 * t1751;
  t1755 = t294 * t1653;
  t1758 = t299 * t1653;
  t1761 = t33 * t204;
  t1762 = t539 * t1761;
  t1765 = t33 * t218;
  t1766 = t539 * t1765;
  t1769 = t556 * t557;
  t1772 = t204 * params->eta;
  t1773 = t1772 * sigma[0];
  t1774 = t195 * t1773;
  t1777 = t218 * params->eta;
  t1778 = t1777 * sigma[0];
  t1779 = t195 * t1778;
  t1782 = t524 * t248;
  t1784 = t230 * t584;
  t1786 = t179 * t708;
  t1788 = t1111 * t682;
  t1790 = t600 * params->eta;
  t1791 = t1790 * sigma[0];
  t1792 = t885 * t1791;
  t1798 = t600 * t321;
  t1799 = t1798 * sigma[0];
  t1804 = t1053 * t682 * t134;
  t1806 = t1073 * t1791;
  t1815 = -0.3e1 / 0.2e1 * t1788 - 0.3e1 * t1792 + 0.13e2 / 0.2e1 * t634 - 0.9e1 / 0.2e1 * t1093 * t686 * t134 - 0.6e1 * t892 * t1799 + 0.39e2 / 0.4e1 * t636 - 0.3e2 * t1804 - 0.3e2 * t1806 + 0.65e2 / 0.2e1 * t642 - 0.45e2 * t1073 * t682 * t1551 - 0.42e2 * t1032 * t1799 + 0.39e2 * t644;
  t1816 = t93 * t1815;
  t1818 = -0.16e2 * t1270 * t1774 + 0.8e1 * t1276 * t1779 + 0.6e1 * t1406 * t674 - t147 * t1782 - t147 * t1784 - t147 * t1786 - t147 * t1816 + 0.6e1 * t544 * t1752 - 0.12e2 * t1755 * t541 + 0.6e1 * t1758 * t546 + 0.2e2 * t538 * t1762 - 0.1e2 * t544 * t1766 - 0.13e2 * t555 * t1769;
  t1820 = t1669 + t1713 + t1748 + t1818;
  t1825 = my_piecewise3(t3, 0, -t7 * t101 * t711 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1820);
  tv3rhosigmatau0 = 0.2e1 * rho[0] * t1825 + 0.2e1 * t715;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  t1834 = t539 * t724 * t141;
  t1838 = t539 * t724 * t165;
  t1841 = t320 * t682;
  t1844 = t720 * t1697;
  t1847 = t720 * t1702;
  t1850 = 0.1e1 / t271;
  t1851 = t1850 * t71;
  t1852 = t1851 * t59;
  t1855 = t1574 * t93;
  t1858 = t294 * t179;
  t1862 = t179 * t731;
  t1865 = t179 * t740;
  t1869 = t1850 * params->eta;
  t1870 = t1869 * sigma[0];
  t1880 = 0.24e3 * t1053 * t720 * t134 + 0.24e3 * t1073 * t1870 + 0.12e2 * t1111 * t720 + 0.24e2 * t885 * t1870 - 0.4e2 * t698 - 0.2e3 * t704;
  t1881 = t93 * t1880;
  t1883 = 0.24e2 * t1295 * t1834 - 0.24e2 * t1384 * t1838 - t147 * t1865 - t147 * t1881 + 0.12e2 * t1701 * t1847 - 0.16e3 * t717 * t1841 - 0.24e2 * t717 * t1844 - 0.16e2 * t238 * t1852 + 0.48e2 * t1855 * t721 + 0.48e2 * t1858 * t721 + 0.2e1 * t335 * t1862 - 0.12e2 * t549 * t728 + 0.4e2 * t684;
  t1884 = t33 * t248;
  t1885 = t539 * t1884;
  t1888 = t93 * t55;
  t1889 = t294 * t1888;
  t1890 = t351 * t1850;
  t1891 = t1890 * t59;
  t1898 = t49 * t584;
  t1899 = t539 * t1898;
  t1902 = t823 * t1888;
  t1903 = t150 * t28;
  t1904 = t719 * t165;
  t1905 = t1903 * t1904;
  t1909 = t1903 * t719 * t134;
  t1927 = t248 * params->eta;
  t1928 = t1927 * sigma[0];
  t1929 = t195 * t1928;
  t1932 = -0.3e1 * t299 * t741 * t141 + 0.6e1 * t849 * t732 * t141 + 0.2e1 * t335 * t741 * t165 - 0.6e1 * t841 * t732 * t165 + 0.4e1 * t335 * t249 * t584 + 0.16e2 * t1276 * t1929 + 0.12e2 * t1403 * t725 + 0.12e2 * t1406 * t725 - 0.2e2 * t544 * t1885 + 0.128e3 * t1889 * t1891 + 0.12e2 * t544 * t1899 - 0.48e2 * t1902 * t1905 + 0.96e2 * t538 * t1909;
  t1933 = t1883 + t1932;
  t1938 = my_piecewise3(t3, 0, -t7 * t101 * t743 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1933);
  tv3rhotau20 = 0.2e1 * rho[0] * t1938 + 0.2e1 * t747;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  t1945 = 0.1e1 / t31 / t283;
  t1949 = 0.35e2 / 0.516560652e9 * t599 * t1945 * t814 * t818;
  t1950 = t279 * t600;
  t1957 = 0.5e1 / 0.354294e6 * t1950 * t1478;
  t1958 = 0.5e1 / 0.354294e6 * t1950 * t1493 - 0.7e1 / 0.531441e6 * t781 * t1950 * t785 - t1957 + t1949;
  t1960 = t606 * t218;
  t1963 = t205 * t623;
  t1975 = t627 * t218;
  t1976 = t93 * t1975;
  t1982 = t605 * t204;
  t1983 = t1982 * t81;
  t1986 = t230 * t605;
  t1989 = t661 * t204;
  t1992 = t230 * t623;
  t1995 = t1706 * params->eta;
  t1997 = t885 * t1798;
  t1999 = t868 * t600;
  t2002 = 0.3e1 / 0.32e2 * t1995 + 0.9e1 / 0.32e2 * t1997 + 0.3e1 / 0.16e2 * t892 * t1999;
  t2003 = t93 * t2002;
  t2006 = t230 * t627;
  t2009 = t661 * t218;
  t2012 = t230 * t648;
  t2016 = t885 * t1790;
  t2018 = t892 * t1798;
  t2022 = t78 * t600;
  t2023 = t873 * t2022;
  t2027 = t358 * t160 * t600 * params->eta;
  t2031 = t155 * t370 * t600 * t321;
  t2033 = t881 * t868;
  t2037 = -0.3e1 / 0.64e2 * t1706 - 0.27e2 / 0.64e2 * t2016 - 0.27e2 / 0.32e2 * t2018 - 0.15e2 / 0.32e2 * t867 * t1999 - 0.15e2 / 0.16e2 * t2023 - 0.135e3 / 0.32e2 * t2027 - 0.189e3 / 0.32e2 * t2031 - 0.21e2 / 0.8e1 * t75 * t2033 * t600;
  t2038 = t93 * t2037;
  t2040 = 0.18e2 * t849 * t205 * t627 - t1949 + t82 * t1958 - 0.18e2 * t823 * t1960 + 0.18e2 * t294 * t1963 - 0.18e2 * t299 * t612 * t218 - 0.9e1 * t299 * t624 * t218 - 0.9e1 * t299 * t205 * t648 - 0.6e1 * t841 * t1976 + 0.6e1 * t335 * t219 * t648 + t1957 + 0.6e1 * t1983 * t93 + 0.18e2 * t294 * t1986 + 0.9e1 * t128 * t1989 + 0.9e1 * t128 * t1992 + 0.3e1 * t128 * t2003 + 0.6e1 * t335 * t2006 - 0.3e1 * t147 * t2009 - 0.3e1 * t147 * t2012 - t147 * t2038;
  t2044 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t2040);
  tv3sigma30 = 0.2e1 * rho[0] * t2044;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma2lapl0 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  t2046 = t230 * t708;
  t2050 = t885 * t1869;
  t2052 = t1850 * t321;
  t2055 = t78 * t1850;
  t2056 = t873 * t2055;
  t2060 = t358 * t160 * t1850 * params->eta;
  t2066 = 0.3e1 / 0.8e1 * t1851 + 0.9e1 / 0.4e1 * t2050 + 0.9e1 / 0.4e1 * t892 * t2052 + 0.15e2 / 0.2e1 * t2056 + 0.45e2 / 0.2e1 * t2060 + 0.63e2 / 0.4e1 * t155 * t370 * t1850 * t321;
  t2067 = t93 * t2066;
  t2069 = t661 * t248;
  t2071 = t605 * t81;
  t2072 = t2071 * t93;
  t2077 = t556 * t681 * t204 * params->eta;
  t2080 = t681 * t218;
  t2082 = t556 * t2080 * params->eta;
  t2086 = t539 * t669 * t218;
  t2089 = t64 * t204;
  t2090 = t682 * t2089;
  t2091 = t717 * t2090;
  t2093 = t64 * t218;
  t2094 = t682 * t2093;
  t2095 = t1701 * t2094;
  t2097 = t128 * t661;
  t2100 = t885 * t2052;
  t2103 = t1678 * t218;
  t2106 = t677 * t683;
  t2108 = t1851 * params->eta;
  t2109 = t238 * t2108;
  t2111 = -0.2e1 * t147 * t2046 - t147 * t2067 - t147 * t2069 - 0.12e2 * t2072 * t240 + 0.12e2 * t538 * t2077 - 0.6e1 * t544 * t2082 + 0.24e2 * t1295 * t2086 + 0.6e1 * t2091 - 0.3e1 * t2095 - 0.6e1 * t2097 * t240 - 0.9e1 / 0.4e1 * t238 * t2100 + 0.12e2 * t1217 * t2103 + 0.3e1 * t2106 - 0.3e1 / 0.2e1 * t2109;
  t2114 = t49 * t623;
  t2115 = t539 * t2114;
  t2120 = t49 * t648;
  t2121 = t539 * t2120;
  t2126 = t49 * t627;
  t2127 = t539 * t2126;
  t2136 = t249 * t605;
  t2154 = -0.6e1 * t299 * t696 * t204 - 0.6e1 * t299 * t709 * t204 + 0.4e1 * t335 * t696 * t218 + 0.4e1 * t335 * t709 * t218 - 0.3e1 * t299 * t249 * t623 + 0.2e1 * t335 * t249 * t648 - 0.6e1 * t841 * t249 * t627 - 0.12e2 * t1384 * t2127 + 0.6e1 * t1654 * t687 - 0.24e2 * t1755 * t670 + 0.12e2 * t1758 * t674 - 0.12e2 * t538 * t2115 + 0.6e1 * t544 * t2121 - 0.6e1 * t823 * t2136;
  t2155 = t2111 + t2154;
  t2159 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t2155);
  tv3sigma2tau0 = 0.2e1 * rho[0] * t2159;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  t2161 = t204 * t81;
  t2162 = t2161 * t93;
  t2165 = t719 * t218;
  t2166 = t1903 * t2165;
  t2169 = t294 * t230;
  t2172 = 0.1e1 / t118;
  t2173 = t885 * t2172;
  t2174 = t717 * t2173;
  t2176 = t2172 * params->eta;
  t2177 = t892 * t2176;
  t2181 = t539 * t724 * t204;
  t2185 = t539 * t724 * t218;
  t2190 = t64 * t248;
  t2191 = t682 * t2190;
  t2192 = t1701 * t2191;
  t2194 = t681 * t248;
  t2196 = t556 * t2194 * params->eta;
  t2199 = t49 * t708;
  t2200 = t539 * t2199;
  t2203 = 0.24e2 * t1295 * t2181 - 0.24e2 * t1384 * t2185 + 0.12e2 * t1758 * t725 - 0.48e2 * t1902 * t2166 + 0.48e2 * t2162 * t721 + 0.48e2 * t2169 * t721 - 0.48e2 * t717 * t2177 - 0.6e1 * t544 * t2196 + 0.12e2 * t544 * t2200 - 0.24e2 * t2174 - 0.3e1 * t2192;
  t2204 = t720 * t2089;
  t2207 = t720 * t2093;
  t2212 = t2172 * t71;
  t2213 = t2212 * params->eta;
  t2222 = t230 * t731;
  t2234 = t230 * t740;
  t2239 = t78 * t2172;
  t2240 = t873 * t2239;
  t2246 = -0.9e2 * t358 * t160 * t2172 * params->eta - 0.9e1 * t885 * t2176 - 0.3e1 * t2212 - 0.6e2 * t2240;
  t2247 = t93 * t2246;
  t2249 = -0.3e1 * t299 * t741 * t204 + 0.6e1 * t849 * t732 * t204 + 0.2e1 * t335 * t741 * t218 - 0.6e1 * t841 * t732 * t218 + 0.4e1 * t335 * t249 * t708 - t147 * t2234 - t147 * t2247 + 0.12e2 * t1701 * t2207 - 0.24e2 * t717 * t2204 + 0.6e1 * t238 * t2213 + 0.2e1 * t335 * t2222 - 0.12e2 * t677 * t728;
  t2250 = t2203 + t2249;
  t2254 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t2250);
  tv3sigmatau20 = 0.2e1 * rho[0] * t2254;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  t2256 = 0.1e1 / t192;
  t2257 = t2256 * t81;
  t2261 = t719 * t248;
  t2262 = t1903 * t2261;
  t2265 = t885 * t2256;
  t2268 = t49 * t731;
  t2269 = t539 * t2268;
  t2272 = t720 * t2190;
  t2275 = t49 * t740;
  t2276 = t539 * t2275;
  t2279 = t731 * t248;
  t2280 = t93 * t2279;
  t2288 = t78 * t2256;
  t2291 = 0.24e2 * t2256 * t71 + 0.48e3 * t873 * t2288;
  t2292 = t93 * t2291;
  t2294 = -0.192e3 * t867 * t2257 * t93 + 0.6e1 * t335 * t249 * t740 - 0.36e2 * t1384 * t2269 - t147 * t2292 + 0.36e2 * t1701 * t2272 - 0.144e3 * t1902 * t2262 + 0.288e3 * t717 * t2265 + 0.18e2 * t544 * t2276 - 0.6e1 * t841 * t2280;
  t2298 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t2294);
  tv3tau30 = 0.2e1 * rho[0] * t2298;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t3, t4, t5, t7, t8, t9, t11, t12;
  double t14, t16, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t35, t39, t40, t41, t42, t43;
  double t44, t46, t47, t49, t51, t52, t54, t55;
  double t56, t59, t62, t63, t64, t66, t67, t68;
  double t69, t70, t71, t73, t75, t76, t78, t80;
  double t81, t82, t85, t87, t88, t89, t90, t91;
  double t93, t95, t99, tzk0;

  double t101, t105, t107, t108, t109, t111, t113, t114;
  double t115, t116, t117, t118, t120, t121, t123, t124;
  double t127, t128, t129, t132, t134, t137, t138, t141;
  double t142, t145, t146, t147, t150, t151, t152, t155;
  double t156, t160, t161, t162, t165, t166, t168, t172;
  double t173, t174, t175, t179, t181, t186, tvrho0, t190;
  double t192, t194, t195, t198, t199, t200, t201, t204;
  double t205, t208, t212, t214, t218, t219, t224, t225;
  double t230, t232, t236, tvsigma0, tvlapl0, t238, t239, t240;
  double t248, t249, t251, t255, tvtau0;

  double t258, t266, t267, t268, t270, t271, t273, t274;
  double t277, t278, t279, t280, t281, t282, t283, t284;
  double t285, t287, t289, t290, t293, t294, t295, t296;
  double t299, t303, t306, t309, t310, t315, t317, t320;
  double t321, t322, t323, t324, t329, t330, t334, t335;
  double t336, t337, t340, t345, t351, t352, t353, t358;
  double t359, t362, t363, t369, t370, t371, t372, t373;
  double t376, t379, t382, t385, t389, t391, t392, t393;
  double t394, t398, t402, t404, t409, tv2rho20, t416, t417;
  double t418, t419, t422, t423, t424, t425, t429, t433;
  double t436, t439, t440, t442, t443, t444, t447, t449;
  double t450, t453, t456, t459, t460, t469, t471, t473;
  double t474, t476, t477, t482, t483, t485, t487, t490;
  double t496, t503, t504, t506, t509, t513, t517, t524;
  double t526, t531, tv2rhosigma0, tv2rholapl0, t537, t538, t539, t540;
  double t541, t544, t546, t549, t552, t555, t556, t557;
  double t558, t559, t570, t572, t584, t585, t587, t592;
  double tv2rhotau0, t598, t599, t600, t604, t605, t606, t609;
  double t612, t615, t617, t620, t623, t624, t627, t628;
  double t631, t634, t636, t640, t642, t644, t648, t649;
  double t655, t656, t661, t663, t667, tv2sigma20, tv2sigmalapl0, t669;
  double t670, t673, t674, t677, t681, t682, t683, t684;
  double t686, t687, t690, t696, t698, t700, t704, t708;
  double t709, t711, t715, tv2sigmatau0, tv2lapl20, tv2lapltau0, t717, t719;
  double t720, t721, t724, t725, t728, t731, t732, t740;
  double t741, t743, t747, tv2tau20;

  double t750, t761, t762, t763, t767, t768, t772, t773;
  double t780, t781, t782, t783, t785, t793, t797, t799;
  double t802, t806, t807, t808, t809, t811, t814, t815;
  double t818, t820, t821, t823, t839, t840, t841, t842;
  double t843, t849, t853, t857, t862, t864, t867, t868;
  double t869, t870, t873, t881, t882, t885, t886, t889;
  double t892, t893, t896, t901, t908, t912, t915, t918;
  double t924, t929, t932, t933, t936, t939, t942, t947;
  double t948, t951, t954, t967, t968, t977, t978, t983;
  double tv3rho30, t998, t1001, t1004, t1006, t1008, t1009, t1011;
  double t1012, t1013, t1015, t1016, t1019, t1023, t1025, t1026;
  double t1030, t1032, t1033, t1039, t1040, t1041, t1043, t1044;
  double t1045, t1050, t1053, t1054, t1056, t1058, t1059, t1060;
  double t1061, t1064, t1065, t1066, t1067, t1068, t1071, t1073;
  double t1086, t1093, t1094, t1096, t1097, t1098, t1100, t1103;
  double t1105, t1108, t1109, t1111, t1112, t1115, t1121, t1125;
  double t1138, t1139, t1142, t1145, t1151, t1157, t1169, t1191;
  double t1193, t1195, t1203, t1210, t1212, t1216, t1217, t1218;
  double t1219, t1222, t1223, t1224, t1227, t1230, t1233, t1238;
  double t1241, t1251, t1253, t1254, t1259, tv3rho2sigma0, tv3rho2lapl0, t1269;
  double t1270, t1271, t1272, t1273, t1276, t1277, t1278, t1279;
  double t1282, t1284, t1285, t1288, t1289, t1292, t1295, t1297;
  double t1302, t1303, t1307, t1310, t1311, t1328, t1329, t1331;
  double t1358, t1359, t1360, t1365, t1370, t1377, t1380, t1381;
  double t1384, t1386, t1390, t1393, t1396, t1399, t1400, t1403;
  double t1406, t1409, t1410, t1413, t1414, t1417, t1418, t1423;
  double tv3rho2tau0, t1438, t1441, t1477, t1478, t1479, t1481, t1482;
  double t1483, t1484, t1487, t1493, t1494, t1507, t1509, t1510;
  double t1513, t1514, t1516, t1518, t1520, t1521, t1522, t1524;
  double t1526, t1528, t1529, t1531, t1532, t1534, t1537, t1538;
  double t1541, t1544, t1546, t1549, t1551, t1553, t1555, t1557;
  double t1566, t1567, t1569, t1574, t1577, t1580, t1583, t1586;
  double t1589, t1591, t1592, t1605, t1606, t1609, t1612, t1615;
  double t1618, t1619, t1624, tv3rhosigma20, tv3rhosigmalapl0, t1651, t1653, t1654;
  double t1658, t1662, t1666, t1669, t1671, t1675, t1678, t1679;
  double t1682, t1685, t1686, t1689, t1690, t1693, t1697, t1698;
  double t1699, t1701, t1702, t1703, t1704, t1706, t1707, t1708;
  double t1710, t1713, t1730, t1731, t1732, t1735, t1742, t1743;
  double t1748, t1751, t1752, t1755, t1758, t1761, t1762, t1765;
  double t1766, t1769, t1772, t1773, t1774, t1777, t1778, t1779;
  double t1782, t1784, t1786, t1788, t1790, t1791, t1792, t1798;
  double t1799, t1804, t1806, t1815, t1816, t1818, t1820, t1825;
  double tv3rhosigmatau0, tv3rholapl20, tv3rholapltau0, t1834, t1838, t1841, t1844, t1847;
  double t1850, t1851, t1852, t1855, t1858, t1862, t1865, t1869;
  double t1870, t1880, t1881, t1883, t1884, t1885, t1888, t1889;
  double t1890, t1891, t1898, t1899, t1902, t1903, t1904, t1905;
  double t1909, t1927, t1928, t1929, t1932, t1933, t1938, tv3rhotau20;
  double t1945, t1949, t1950, t1957, t1958, t1960, t1963, t1975;
  double t1976, t1982, t1983, t1986, t1989, t1992, t1995, t1997;
  double t1999, t2002, t2003, t2006, t2009, t2012, t2016, t2018;
  double t2022, t2023, t2027, t2031, t2033, t2037, t2038, t2040;
  double t2044, tv3sigma30, tv3sigma2lapl0, t2046, t2050, t2052, t2055, t2056;
  double t2060, t2066, t2067, t2069, t2071, t2072, t2077, t2080;
  double t2082, t2086, t2089, t2090, t2091, t2093, t2094, t2095;
  double t2097, t2100, t2103, t2106, t2108, t2109, t2111, t2114;
  double t2115, t2120, t2121, t2126, t2127, t2136, t2154, t2155;
  double t2159, tv3sigma2tau0, tv3sigmalapl20, tv3sigmalapltau0, t2161, t2162, t2165, t2166;
  double t2169, t2172, t2173, t2174, t2176, t2177, t2181, t2185;
  double t2190, t2191, t2192, t2194, t2196, t2199, t2200, t2203;
  double t2204, t2207, t2212, t2213, t2222, t2234, t2239, t2240;
  double t2246, t2247, t2249, t2250, t2254, tv3sigmatau20, tv3lapl30, tv3lapl2tau0;
  double tv3lapltau20, t2256, t2257, t2261, t2262, t2265, t2268, t2269;
  double t2272, t2275, t2276, t2279, t2280, t2288, t2291, t2292;
  double t2294, t2298, tv3tau30;

  double t2320, t2321, t2325, t2335, t2336, t2338, t2343, t2347;
  double t2348, t2357, t2361, t2362, t2366, t2367, t2368, t2369;
  double t2371, t2373, t2377, t2378, t2395, t2397, t2413, t2416;
  double t2419, t2426, t2432, t2442, t2446, t2464, t2477, t2512;
  double t2519, t2523, t2526, t2530, t2556, t2559, t2561, t2562;
  double t2564, t2582, t2585, t2589, t2592, t2596, t2598, t2602;
  double t2604, t2605, t2615, t2621, t2622, t2626, t2648, t2649;
  double t2657, t2681, t2688, t2695, tv4rho40, t2765, t2774, t2778;
  double t2782, t2785, t2788, t2793, t2800, t2806, t2809, t2811;
  double t2818, t2825, t2828, t2844, t2846, t2850, t2854, t2858;
  double t2861, t2865, t2869, t2872, t2876, t2881, t2888, t2894;
  double t2898, t2902, t2923, t2935, t2944, t2984, t3006, t3020;
  double t3026, t3057, t3059, t3067, t3075, t3076, t3090, t3094;
  double t3108, t3114, t3115, t3129, t3152, t3153, t3175, t3188;
  double t3191, t3199, t3206, t3219, t3226, t3234, tv4rho3sigma0, tv4rho3lapl0;
  double t3250, t3264, t3265, t3275, t3280, t3287, t3304, t3307;
  double t3308, t3311, t3312, t3317, t3322, t3340, t3347, t3356;
  double t3359, t3362, t3363, t3374, t3378, t3379, t3386, t3396;
  double t3404, t3408, t3415, t3418, t3428, t3459, t3493, t3496;
  double t3525, t3528, t3534, t3537, t3540, t3542, t3543, t3546;
  double t3547, t3558, t3567, t3570, t3585, t3604, t3621, t3629;
  double tv4rho3tau0, t3654, t3662, t3664, t3667, t3670, t3675, t3678;
  double t3681, t3685, t3688, t3691, t3694, t3720, t3741, t3750;
  double t3758, t3776, t3789, t3812, t3832, t3835, t3872, t3884;
  double t3911, t3914, t3916, t3931, t3939, t3940, t3943, t3959;
  double t3963, t3970, t3973, t3984, t3988, t4026, t4045, t4067;
  double t4080, t4103, t4137, t4145, tv4rho2sigma20, tv4rho2sigmalapl0, t4169, t4176;
  double t4189, t4217, t4222, t4229, t4243, t4255, t4292, t4302;
  double t4303, t4331, t4332, t4333, t4336, t4349, t4358, t4367;
  double t4378, t4388, t4400, t4409, t4413, t4421, t4425, t4427;
  double t4454, t4458, t4465, t4469, t4498, t4540, t4547, t4552;
  double t4553, t4556, t4557, t4560, t4563, t4568, t4581, t4587;
  double t4617, t4635, t4646, t4659, t4660, t4661, t4665, t4666;
  double t4668, t4671, t4674, t4679, t4680, t4683, t4686, t4689;
  double t4692, t4719, t4724, t4745, t4779, t4788, tv4rho2sigmatau0, tv4rho2lapl20;
  double tv4rho2lapltau0, t4829, t4847, t4863, t4869, t4879, t4891, t4911;
  double t4912, t4916, t4923, t4928, t4940, t4941, t4949, t4953;
  double t4964, t5001, t5033, t5042, t5046, t5052, t5080, t5112;
  double t5119, t5127, tv4rho2tau20, t5146, t5155, t5156, t5161, t5166;
  double t5170, t5175, t5179, t5184, t5223, t5276, t5288, t5294;
  double t5295, t5305, t5312, t5316, t5344, t5406, t5414, t5451;
  double t5457, t5479, t5486, tv4rhosigma30, tv4rhosigma2lapl0, t5500, t5532, t5543;
  double t5547, t5569, t5577, t5587, t5601, t5606, t5644, t5667;
  double t5668, t5679, t5686, t5692, t5697, t5700, t5706, t5733;
  double t5740, t5744, t5758, t5804, t5811, t5824, t5891, t5934;
  double t5941, t5945, t5955, t5959, t5965, t5988, t6016, t6025;
  double tv4rhosigma2tau0, tv4rhosigmalapl20, tv4rhosigmalapltau0, t6067, t6071, t6080, t6092, t6108;
  double t6122, t6129, t6156, t6160, t6167, t6186, t6209, t6215;
  double t6247, t6257, t6261, t6297, t6312, t6339, t6356, t6388;
  double t6415, t6427, t6435, t6440, t6459, t6467, tv4rhosigmatau20, tv4rholapl30;
  double tv4rholapl2tau0, tv4rholapltau20, t6484, t6511, t6530, t6536, t6566, t6571;
  double t6613, t6632, t6640, t6644, t6645, t6655, t6662, tv4rhotau30;
  double t6670, t6673, t6677, t6700, t6728, t6738, t6743, t6759;
  double t6798, t6817, t6821, t6825, t6830, tv4sigma40, tv4sigma3lapl0, t6887;
  double t6941, t6957, t6969, t6973, t6991, t6995, t7016, t7065;
  double t7071, tv4sigma3tau0, tv4sigma2lapl20, tv4sigma2lapltau0, t7112, t7122, t7125, t7140;
  double t7203, t7235, t7260, t7315, t7321, tv4sigma2tau20, tv4sigmalapl30, tv4sigmalapl2tau0;
  double tv4sigmalapltau20, t7323, t7335, t7340, t7362, t7402, t7440, t7451;
  double t7487, t7493, tv4sigmatau30, tv4lapl40, tv4lapl3tau0, tv4lapl2tau20, tv4lapltau30, t7523;
  double t7530, t7553, t7557, tv4tau40;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t14 * p->zeta_threshold, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t21 * t25;
  t27 = t26 * sigma[0];
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t19 * t19;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t35 = 0.1e1 / params->kappa;
  t39 = 0.1e1 + 0.5e1 / 0.972e3 * t27 * t34 * t35;
  t40 = pow(t39, 0.1e1 / 0.5e1);
  t41 = t40 * t40;
  t42 = t41 * t41;
  t43 = 0.1e1 / t42;
  t44 = t34 * t43;
  t46 = 0.5e1 / 0.972e3 * t27 * t44;
  t47 = tau[0] * t29;
  t49 = 0.1e1 / t31 / rho[0];
  t51 = sigma[0] * t29;
  t52 = t51 * t33;
  t54 = t47 * t49 - t52 / 0.8e1;
  t55 = t54 * t54;
  t56 = t21 * t21;
  t59 = params->eta * sigma[0];
  t62 = 0.3e1 / 0.1e2 * t56 * t24 + t59 * t34 / 0.8e1;
  t63 = t62 * t62;
  t64 = 0.1e1 / t63;
  t66 = -t55 * t64 + 0.1e1;
  t67 = t66 * t66;
  t68 = t67 * t66;
  t69 = t55 * t54;
  t70 = t63 * t62;
  t71 = 0.1e1 / t70;
  t73 = t55 * t55;
  t75 = params->b * t73 * t55;
  t76 = t63 * t63;
  t78 = 0.1e1 / t76 / t63;
  t80 = t69 * t71 + t75 * t78 + 0.1e1;
  t81 = 0.1e1 / t80;
  t82 = t68 * t81;
  t85 = 0.5e1 / 0.972e3 * t26 * t52 + params->c;
  t87 = t85 * t35 + 0.1e1;
  t88 = pow(t87, 0.1e1 / 0.5e1);
  t89 = t88 * t88;
  t90 = t89 * t89;
  t91 = 0.1e1 / t90;
  t93 = t85 * t91 - t46;
  t95 = t82 * t93 + t46 + 0.1e1;
  t99 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t95);
  tzk0 = 0.2e1 * t99;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t101 = t18 / t31;
  t105 = t30 * rho[0];
  t107 = 0.1e1 / t31 / t105;
  t108 = t29 * t107;
  t109 = t108 * t43;
  t111 = 0.1e2 / 0.729e3 * t27 * t109;
  t113 = 0.1e1 / t23 / t22;
  t114 = t56 * t113;
  t115 = sigma[0] * sigma[0];
  t116 = t114 * t115;
  t117 = t30 * t30;
  t118 = t117 * t30;
  t120 = 0.1e1 / t19 / t118;
  t121 = t28 * t120;
  t123 = 0.1e1 / t42 / t39;
  t124 = t123 * t35;
  t127 = 0.2e2 / 0.177147e6 * t116 * t121 * t124;
  t128 = t67 * t81;
  t129 = t54 * t64;
  t132 = t51 * t107;
  t134 = -0.5e1 / 0.3e1 * t47 * t33 + t132 / 0.3e1;
  t137 = t55 * t71;
  t138 = t137 * params->eta;
  t141 = -0.2e1 * t129 * t134 - 0.2e1 / 0.3e1 * t138 * t132;
  t142 = t93 * t141;
  t145 = t80 * t80;
  t146 = 0.1e1 / t145;
  t147 = t68 * t146;
  t150 = 0.1e1 / t76;
  t151 = t69 * t150;
  t152 = t151 * params->eta;
  t155 = params->b * t73 * t54;
  t156 = t78 * t134;
  t160 = 0.1e1 / t76 / t70;
  t161 = t75 * t160;
  t162 = t59 * t108;
  t165 = t152 * t132 + 0.3e1 * t137 * t134 + 0.6e1 * t155 * t156 + 0.2e1 * t161 * t162;
  t166 = t93 * t165;
  t168 = t108 * t91;
  t172 = 0.1e1 / t90 / t87;
  t173 = t85 * t172;
  t174 = t173 * t26;
  t175 = t107 * t35;
  t179 = -0.1e2 / 0.729e3 * t27 * t168 + 0.8e1 / 0.729e3 * t174 * t51 * t175 + t111 - t127;
  t181 = 0.3e1 * t128 * t142 - t147 * t166 + t82 * t179 - t111 + t127;
  t186 = my_piecewise3(t3, 0, -t7 * t101 * t95 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t181);
  tvrho0 = 0.2e1 * rho[0] * t186 + 0.2e1 * t99;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t190 = 0.5e1 / 0.972e3 * t26 * t44;
  t192 = t117 * rho[0];
  t194 = 0.1e1 / t19 / t192;
  t195 = t28 * t194;
  t198 = 0.5e1 / 0.118098e6 * t114 * sigma[0] * t195 * t124;
  t199 = t129 * t34;
  t200 = params->eta * t29;
  t201 = t200 * t33;
  t204 = t137 * t201 / 0.4e1 + t199 / 0.4e1;
  t205 = t93 * t204;
  t208 = t137 * t34;
  t212 = t78 * t29;
  t214 = t155 * t212 * t33;
  t218 = -0.3e1 / 0.8e1 * t208 - 0.3e1 / 0.8e1 * t151 * t201 - 0.3e1 / 0.4e1 * t214 - 0.3e1 / 0.4e1 * t161 * t201;
  t219 = t93 * t218;
  t224 = t173 * t21;
  t225 = t25 * t29;
  t230 = 0.5e1 / 0.972e3 * t26 * t34 * t91 - t224 * t225 * t33 * t35 / 0.243e3 - t190 + t198;
  t232 = 0.3e1 * t128 * t205 - t147 * t219 + t82 * t230 + t190 - t198;
  t236 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t232);
  tvsigma0 = 0.2e1 * rho[0] * t236;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  t238 = t128 * t93;
  t239 = t29 * t49;
  t240 = t129 * t239;
  t248 = 0.6e1 * t155 * t212 * t49 + 0.3e1 * t137 * t239;
  t249 = t93 * t248;
  t251 = -t147 * t249 - 0.6e1 * t238 * t240;
  t255 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t251);
  tvtau0 = 0.2e1 * rho[0] * t255;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t258 = t18 * t49;
  t266 = 0.1e1 / t31 / t117;
  t267 = t29 * t266;
  t268 = t267 * t43;
  t270 = 0.11e3 / 0.2187e4 * t27 * t268;
  t271 = t117 * t105;
  t273 = 0.1e1 / t19 / t271;
  t274 = t28 * t273;
  t277 = 0.2e2 / 0.19683e5 * t116 * t274 * t124;
  t278 = t22 * t22;
  t279 = 0.1e1 / t278;
  t280 = t115 * sigma[0];
  t281 = t279 * t280;
  t282 = t117 * t117;
  t283 = t282 * t30;
  t284 = 0.1e1 / t283;
  t285 = t39 * t39;
  t287 = 0.1e1 / t42 / t285;
  t289 = params->kappa * params->kappa;
  t290 = 0.1e1 / t289;
  t293 = 0.16e3 / 0.4782969e7 * t281 * t284 * t287 * t290;
  t294 = t66 * t81;
  t295 = t141 * t141;
  t296 = t93 * t295;
  t299 = t67 * t146;
  t303 = t179 * t141;
  t306 = t134 * t134;
  t309 = t54 * t71;
  t310 = t309 * t134;
  t315 = t51 * t266;
  t317 = 0.4e2 / 0.9e1 * t47 * t107 - 0.11e2 / 0.9e1 * t315;
  t320 = t55 * t150;
  t321 = params->eta * params->eta;
  t322 = t320 * t321;
  t323 = t115 * t28;
  t324 = t323 * t273;
  t329 = -0.2e1 * t306 * t64 - 0.8e1 / 0.3e1 * t310 * t162 - 0.2e1 * t129 * t317 - 0.4e1 / 0.3e1 * t322 * t324 + 0.22e2 / 0.9e1 * t138 * t315;
  t330 = t93 * t329;
  t334 = 0.1e1 / t145 / t80;
  t335 = t68 * t334;
  t336 = t165 * t165;
  t337 = t93 * t336;
  t340 = t179 * t165;
  t345 = t320 * t134;
  t351 = 0.1e1 / t76 / t62;
  t352 = t69 * t351;
  t353 = t352 * t321;
  t358 = params->b * t73;
  t359 = t78 * t306;
  t362 = t160 * t134;
  t363 = t155 * t362;
  t369 = t76 * t76;
  t370 = 0.1e1 / t369;
  t371 = t75 * t370;
  t372 = t321 * t115;
  t373 = t372 * t274;
  t376 = t59 * t267;
  t379 = 0.6e1 * t309 * t306 + 0.6e1 * t345 * t162 + 0.3e1 * t137 * t317 + 0.8e1 / 0.3e1 * t353 * t324 - 0.11e2 / 0.3e1 * t152 * t315 + 0.3e2 * t358 * t359 + 0.24e2 * t363 * t162 + 0.6e1 * t155 * t78 * t317 + 0.28e2 / 0.3e1 * t371 * t373 - 0.22e2 / 0.3e1 * t161 * t376;
  t382 = t267 * t91;
  t385 = t172 * t35;
  t389 = t87 * t87;
  t391 = 0.1e1 / t90 / t389;
  t392 = t85 * t391;
  t393 = t392 * t114;
  t394 = t273 * t290;
  t398 = t266 * t35;
  t402 = 0.11e3 / 0.2187e4 * t27 * t382 - 0.32e3 / 0.531441e6 * t116 * t274 * t385 + 0.32e2 / 0.59049e5 * t393 * t323 * t394 - 0.88e2 / 0.2187e4 * t174 * t51 * t398 - t270 + t277 - t293;
  t404 = -0.6e1 * t299 * t142 * t165 - t147 * t93 * t379 + 0.6e1 * t128 * t303 + 0.3e1 * t128 * t330 - 0.2e1 * t147 * t340 + 0.6e1 * t294 * t296 + 0.2e1 * t335 * t337 + t82 * t402 + t270 - t277 + t293;
  t409 = my_piecewise3(t3, 0, t7 * t258 * t95 / 0.12e2 - t7 * t101 * t181 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t404);
  tv2rho20 = 0.2e1 * rho[0] * t409 + 0.4e1 * t186;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t416 = 0.1e2 / 0.729e3 * t26 * t109;
  t417 = t114 * t28;
  t418 = t120 * t123;
  t419 = sigma[0] * t35;
  t422 = 0.2e2 / 0.59049e5 * t417 * t418 * t419;
  t423 = t279 * t115;
  t424 = t282 * rho[0];
  t425 = 0.1e1 / t424;
  t429 = 0.2e2 / 0.1594323e7 * t423 * t425 * t287 * t290;
  t433 = t205 * t165;
  t436 = t179 * t204;
  t439 = t134 * t64;
  t440 = t439 * t34;
  t442 = t309 * t28;
  t443 = t120 * params->eta;
  t444 = t443 * sigma[0];
  t447 = t129 * t108;
  t449 = t309 * params->eta;
  t450 = t34 * t134;
  t453 = t121 * sigma[0];
  t456 = t200 * t107;
  t459 = t440 / 0.4e1 + t442 * t444 / 0.3e1 - 0.2e1 / 0.3e1 * t447 + t449 * t450 / 0.2e1 + t322 * t453 / 0.2e1 - 0.2e1 / 0.3e1 * t137 * t456;
  t460 = t93 * t459;
  t469 = t179 * t218;
  t471 = t309 * t450;
  t473 = t320 * t28;
  t474 = t473 * t444;
  t476 = t137 * t108;
  t477 = t320 * params->eta;
  t482 = t358 * t78;
  t483 = t482 * t450;
  t485 = t155 * t160;
  t487 = t485 * t121 * t59;
  t490 = t155 * t212 * t107;
  t496 = t321 * t28;
  t503 = -0.3e1 / 0.4e1 * t471 - 0.3e1 / 0.4e1 * t474 + t476 - 0.9e1 / 0.8e1 * t477 * t450 - t353 * t453 + t151 * t456 - 0.15e2 / 0.4e1 * t483 - 0.3e1 * t487 + 0.2e1 * t490 - 0.9e1 / 0.2e1 * t485 * t200 * t33 * t134 - 0.7e1 / 0.2e1 * t371 * t496 * t120 * sigma[0] + 0.2e1 * t161 * t456;
  t504 = t93 * t503;
  t506 = t230 * t141;
  t509 = t230 * t165;
  t513 = t120 * t172;
  t517 = t290 * sigma[0];
  t524 = -0.1e2 / 0.729e3 * t26 * t168 + 0.4e2 / 0.177147e6 * t417 * t513 * t419 - 0.4e1 / 0.19683e5 * t393 * t121 * t517 + 0.8e1 / 0.729e3 * t224 * t225 * t175 + t416 - t422 + t429;
  t526 = 0.6e1 * t294 * t205 * t141 - 0.3e1 * t299 * t219 * t141 + 0.2e1 * t335 * t219 * t165 + 0.3e1 * t128 * t436 + 0.3e1 * t128 * t460 + 0.3e1 * t128 * t506 - t147 * t469 - t147 * t504 - t147 * t509 - 0.3e1 * t299 * t433 + t82 * t524 - t416 + t422 - t429;
  t531 = my_piecewise3(t3, 0, -t7 * t101 * t232 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t526);
  tv2rhosigma0 = 0.2e1 * rho[0] * t531 + 0.2e1 * t236;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  t537 = t93 * t54;
  t538 = t294 * t537;
  t539 = t64 * t29;
  t540 = t49 * t141;
  t541 = t539 * t540;
  t544 = t299 * t537;
  t546 = t539 * t49 * t165;
  t549 = t128 * t179;
  t552 = t439 * t239;
  t555 = t128 * t537;
  t556 = t71 * t28;
  t557 = t194 * params->eta;
  t558 = t557 * sigma[0];
  t559 = t556 * t558;
  t570 = t179 * t248;
  t572 = t239 * t134;
  t584 = 0.24e2 * t485 * t195 * t59 + 0.6e1 * t309 * t572 + 0.6e1 * t473 * t558 + 0.3e2 * t482 * t572 - 0.5e1 * t208 - 0.1e2 * t214;
  t585 = t93 * t584;
  t587 = -0.3e1 * t299 * t249 * t141 + 0.2e1 * t335 * t249 * t165 - t147 * t570 - t147 * t585 + 0.1e2 * t238 * t199 - 0.6e1 * t238 * t552 - 0.6e1 * t549 * t240 - 0.12e2 * t538 * t541 + 0.6e1 * t544 * t546 - 0.8e1 * t555 * t559;
  t592 = my_piecewise3(t3, 0, -t7 * t101 * t251 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t587);
  tv2rhotau0 = 0.2e1 * rho[0] * t592 + 0.2e1 * t255;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t598 = 0.5e1 / 0.59049e5 * t417 * t194 * t123 * t35;
  t599 = t279 * sigma[0];
  t600 = 0.1e1 / t282;
  t604 = 0.5e1 / 0.1062882e7 * t599 * t600 * t287 * t290;
  t605 = t204 * t204;
  t606 = t93 * t605;
  t609 = t205 * t218;
  t612 = t230 * t204;
  t615 = t195 * t64;
  t617 = t195 * params->eta;
  t620 = t496 * t194;
  t623 = -t615 / 0.16e2 - t309 * t617 / 0.4e1 - 0.3e1 / 0.16e2 * t320 * t620;
  t624 = t93 * t623;
  t627 = t218 * t218;
  t628 = t93 * t627;
  t631 = t230 * t218;
  t634 = t309 * t195;
  t636 = t320 * t617;
  t640 = t78 * t28;
  t642 = t358 * t640 * t194;
  t644 = t485 * t617;
  t648 = 0.3e1 / 0.16e2 * t634 + 0.9e1 / 0.16e2 * t636 + 0.3e1 / 0.8e1 * t352 * t620 + 0.15e2 / 0.16e2 * t642 + 0.9e1 / 0.4e1 * t644 + 0.21e2 / 0.16e2 * t371 * t620;
  t649 = t93 * t648;
  t655 = t392 * t56;
  t656 = t113 * t28;
  t661 = -0.5e1 / 0.59049e5 * t417 * t194 * t172 * t35 + t655 * t656 * t194 * t290 / 0.13122e5 + t598 - t604;
  t663 = 0.6e1 * t128 * t612 + 0.3e1 * t128 * t624 - 0.2e1 * t147 * t631 - t147 * t649 + 0.6e1 * t294 * t606 - 0.6e1 * t299 * t609 + 0.2e1 * t335 * t628 + t82 * t661 - t598 + t604;
  t667 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t663);
  tv2sigma20 = 0.2e1 * rho[0] * t667;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  t669 = t49 * t204;
  t670 = t539 * t669;
  t673 = t49 * t218;
  t674 = t539 * t673;
  t677 = t128 * t230;
  t681 = 0.1e1 / t19 / t117;
  t682 = t28 * t681;
  t683 = t682 * t64;
  t684 = t238 * t683;
  t686 = t681 * params->eta;
  t687 = t556 * t686;
  t690 = t249 * t204;
  t696 = t230 * t248;
  t698 = t309 * t682;
  t700 = t682 * params->eta;
  t704 = t358 * t640 * t681;
  t708 = -0.3e1 / 0.2e1 * t698 - 0.9e1 / 0.4e1 * t320 * t700 - 0.15e2 / 0.2e1 * t704 - 0.9e1 * t485 * t700;
  t709 = t93 * t708;
  t711 = -0.12e2 * t538 * t670 + 0.6e1 * t544 * t674 - 0.6e1 * t677 * t240 + 0.3e1 / 0.2e1 * t684 + 0.3e1 * t555 * t687 - 0.3e1 * t299 * t690 + 0.2e1 * t335 * t249 * t218 - t147 * t696 - t147 * t709;
  t715 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t711);
  tv2sigmatau0 = 0.2e1 * rho[0] * t715;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  t717 = t294 * t93;
  t719 = 0.1e1 / t19 / t105;
  t720 = t28 * t719;
  t721 = t320 * t720;
  t724 = t49 * t248;
  t725 = t539 * t724;
  t728 = t720 * t64;
  t731 = t248 * t248;
  t732 = t93 * t731;
  t740 = 0.6e2 * t358 * t640 * t719 + 0.12e2 * t309 * t720;
  t741 = t93 * t740;
  t743 = -t147 * t741 - 0.12e2 * t238 * t728 + 0.2e1 * t335 * t732 + 0.12e2 * t544 * t725 + 0.48e2 * t717 * t721;
  t747 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t743);
  tv2tau20 = 0.2e1 * rho[0] * t747;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  t750 = t18 * t33;
  t761 = 0.1e1 / t31 / t192;
  t762 = t29 * t761;
  t763 = t762 * t91;
  t767 = 0.1e1 / t19 / t282;
  t768 = t28 * t767;
  t772 = t282 * t105;
  t773 = 0.1e1 / t772;
  t780 = 0.1e1 / t90 / t389 / t87;
  t781 = t85 * t780;
  t782 = t781 * t279;
  t783 = t280 * t773;
  t785 = 0.1e1 / t289 / params->kappa;
  t793 = t761 * t35;
  t797 = t762 * t43;
  t799 = 0.154e4 / 0.6561e4 * t27 * t797;
  t802 = 0.1364e5 / 0.1594323e7 * t116 * t768 * t124;
  t806 = 0.304e4 / 0.4782969e7 * t281 * t773 * t287 * t290;
  t807 = t115 * t115;
  t808 = t279 * t807;
  t809 = t282 * t192;
  t811 = 0.1e1 / t31 / t809;
  t814 = 0.1e1 / t42 / t285 / t39;
  t815 = t811 * t814;
  t818 = t785 * t21 * t225;
  t820 = 0.448e4 / 0.3486784401e10 * t808 * t815 * t818;
  t821 = -0.154e4 / 0.6561e4 * t27 * t763 + 0.352e4 / 0.531441e6 * t116 * t768 * t385 - 0.128e4 / 0.4782969e7 * t281 * t773 * t391 * t290 + 0.3584e4 / 0.14348907e8 * t782 * t783 * t785 - 0.352e3 / 0.59049e5 * t393 * t323 * t767 * t290 + 0.1232e4 / 0.6561e4 * t174 * t51 * t793 + t799 - t802 + t806 - t820;
  t823 = t66 * t146;
  t839 = t145 * t145;
  t840 = 0.1e1 / t839;
  t841 = t68 * t840;
  t842 = t336 * t165;
  t843 = t93 * t842;
  t849 = t67 * t334;
  t853 = 0.18e2 * t294 * t142 * t329 - 0.9e1 * t299 * t142 * t379 + 0.18e2 * t849 * t142 * t336 - 0.18e2 * t823 * t296 * t165 - 0.18e2 * t299 * t303 * t165 - 0.9e1 * t299 * t330 * t165 + 0.6e1 * t335 * t166 * t379 + t82 * t821 - 0.6e1 * t841 * t843 - t799 - t806;
  t857 = t306 * t134;
  t862 = t51 * t761;
  t864 = -0.44e3 / 0.27e2 * t47 * t266 + 0.154e3 / 0.27e2 * t862;
  t867 = t69 * t78;
  t868 = t321 * params->eta;
  t869 = t868 * t280;
  t870 = t869 * t773;
  t873 = params->b * t69;
  t881 = 0.1e1 / t369 / t62;
  t882 = t75 * t881;
  t885 = t54 * t150;
  t886 = t885 * t306;
  t889 = t320 * t317;
  t892 = t55 * t351;
  t893 = t892 * t134;
  t896 = t323 * t767;
  t901 = t134 * t317;
  t908 = t155 * t160 * t317;
  t912 = t155 * t370 * t134;
  t915 = t372 * t768;
  t918 = t59 * t762;
  t924 = t358 * t160 * t306;
  t929 = 0.6e1 * t857 * t71 + 0.3e1 * t137 * t864 + 0.8e2 / 0.9e1 * t867 * t870 + 0.12e3 * t873 * t78 * t857 + 0.9e2 * t358 * t156 * t317 + 0.448e3 / 0.9e1 * t882 * t870 + 0.18e2 * t886 * t162 + 0.9e1 * t889 * t162 + 0.24e2 * t893 * t373 - 0.88e2 / 0.3e1 * t353 * t896 + 0.154e3 / 0.9e1 * t152 * t862 + 0.18e2 * t309 * t901 + 0.6e1 * t155 * t78 * t864 + 0.36e2 * t908 * t162 + 0.168e3 * t912 * t373 - 0.308e3 / 0.3e1 * t371 * t915 + 0.308e3 / 0.9e1 * t161 * t918 - 0.33e2 * t345 * t376 + 0.18e3 * t924 * t162 - 0.132e3 * t363 * t376;
  t932 = t295 * t141;
  t933 = t932 * t81;
  t936 = t179 * t295;
  t939 = t402 * t141;
  t942 = t179 * t329;
  t947 = t306 * t71;
  t948 = t947 * params->eta;
  t951 = t885 * t134;
  t954 = t309 * t317;
  t967 = -0.6e1 * t439 * t317 - 0.4e1 * t948 * t132 - 0.8e1 * t951 * t373 - 0.4e1 * t954 * t162 + 0.44e2 / 0.3e1 * t310 * t376 - 0.2e1 * t129 * t864 - 0.32e2 / 0.9e1 * t892 * t870 + 0.44e2 / 0.3e1 * t322 * t896 - 0.308e3 / 0.27e2 * t138 * t862;
  t968 = t93 * t967;
  t977 = -0.3e1 * t147 * t402 * t165 - 0.3e1 * t147 * t179 * t379 - t147 * t93 * t929 + 0.6e1 * t335 * t179 * t336 + 0.9e1 * t128 * t939 + 0.9e1 * t128 * t942 + 0.3e1 * t128 * t968 + 0.18e2 * t294 * t936 + 0.6e1 * t933 * t93 + t802 + t820;
  t978 = t853 + t977;
  t983 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t750 * t95 + t7 * t258 * t181 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t101 * t404 - 0.3e1 / 0.8e1 * t7 * t20 * t978);
  tv3rho30 = 0.2e1 * rho[0] * t983 + 0.6e1 * t409;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t998 = t524 * t141;
  t1001 = t230 * t329;
  t1004 = t947 * t34;
  t1006 = t137 * t267;
  t1008 = t34 * t317;
  t1009 = t309 * t1008;
  t1011 = t284 * t321;
  t1012 = t1011 * t115;
  t1013 = t892 * t1012;
  t1015 = t868 * t284;
  t1016 = t1015 * t115;
  t1019 = t200 * t266;
  t1023 = t155 * t212 * t266;
  t1025 = t108 * t134;
  t1026 = t309 * t1025;
  t1030 = t482 * t1008;
  t1032 = t155 * t370;
  t1033 = t1032 * t1012;
  t1039 = t273 * params->eta;
  t1040 = t1039 * sigma[0];
  t1041 = t473 * t1040;
  t1043 = -0.3e1 / 0.4e1 * t1004 - 0.11e2 / 0.3e1 * t1006 - 0.3e1 / 0.4e1 * t1009 - 0.2e1 * t1013 - 0.1e2 / 0.3e1 * t867 * t1016 - 0.11e2 / 0.3e1 * t151 * t1019 - 0.22e2 / 0.3e1 * t1023 + 0.4e1 * t1026 - 0.9e1 / 0.8e1 * t477 * t1008 - 0.15e2 / 0.4e1 * t1030 - 0.14e2 * t1033 - 0.56e2 / 0.3e1 * t882 * t1016 - 0.22e2 / 0.3e1 * t161 * t1019 + 0.27e2 / 0.4e1 * t1041;
  t1044 = t885 * params->eta;
  t1045 = t34 * t306;
  t1050 = t274 * sigma[0];
  t1053 = t873 * t78;
  t1054 = t1053 * t1045;
  t1056 = t482 * t1025;
  t1058 = t370 * t321;
  t1059 = t155 * t1058;
  t1060 = t134 * sigma[0];
  t1061 = t121 * t1060;
  t1064 = t160 * t28;
  t1065 = t358 * t1064;
  t1066 = t120 * t134;
  t1067 = t1066 * t59;
  t1068 = t1065 * t1067;
  t1071 = t485 * t274 * t59;
  t1073 = t358 * t160;
  t1086 = t892 * t321;
  t1093 = t885 * t28;
  t1094 = t1093 * t1067;
  t1096 = -0.9e1 / 0.4e1 * t1044 * t1045 + 0.6e1 * t477 * t1025 + 0.9e1 * t353 * t1050 - 0.15e2 * t1054 + 0.2e2 * t1056 - 0.42e2 * t1059 * t1061 - 0.3e2 * t1068 + 0.27e2 * t1071 - 0.45e2 / 0.2e1 * t1073 * t200 * t33 * t306 + 0.24e2 * t485 * t200 * t107 * t134 + 0.63e2 / 0.2e1 * t371 * t496 * t273 * sigma[0] - 0.6e1 * t1086 * t1061 - 0.9e1 / 0.2e1 * t485 * t200 * t33 * t317 - 0.3e1 * t1094;
  t1097 = t1043 + t1096;
  t1098 = t93 * t1097;
  t1100 = t179 * t503;
  t1103 = t402 * t218;
  t1105 = t179 * t459;
  t1108 = t317 * t64;
  t1109 = t1108 * t34;
  t1111 = t134 * t71;
  t1112 = t1111 * t28;
  t1115 = t439 * t108;
  t1121 = t129 * t267;
  t1125 = t885 * t321;
  t1138 = t1109 / 0.4e1 + 0.2e1 / 0.3e1 * t1112 * t444 - 0.4e1 / 0.3e1 * t1115 + 0.2e1 / 0.3e1 * t885 * t1012 - 0.3e1 * t442 * t1040 + 0.22e2 / 0.9e1 * t1121 + t947 * t201 / 0.2e1 + 0.2e1 * t1125 * t1061 - 0.8e1 / 0.3e1 * t449 * t1025 + t449 * t1008 / 0.2e1 + 0.4e1 / 0.3e1 * t892 * t1016 - 0.9e1 / 0.2e1 * t322 * t1050 + 0.22e2 / 0.9e1 * t137 * t1019;
  t1139 = t93 * t1138;
  t1142 = t402 * t204;
  t1145 = t295 * t81;
  t1151 = t230 * t295;
  t1157 = t205 * t329;
  t1169 = 0.12e2 * t294 * t436 * t141 - 0.2e1 * t147 * t524 * t165 - t147 * t230 * t379 - 0.6e1 * t299 * t436 * t165 - 0.6e1 * t299 * t460 * t165 - 0.3e1 * t299 * t205 * t379 + 0.2e1 * t335 * t230 * t336 + 0.3e1 * t128 * t1001 - t147 * t1098 - 0.2e1 * t147 * t1100 - t147 * t1103 + 0.6e1 * t128 * t1105 + 0.3e1 * t128 * t1139 + 0.3e1 * t128 * t1142 + 0.6e1 * t1145 * t205 + 0.6e1 * t294 * t1151 + 0.6e1 * t294 * t1157 + 0.6e1 * t128 * t998;
  t1191 = t279 * t284;
  t1193 = t287 * t115 * t290;
  t1195 = 0.34e3 / 0.1594323e7 * t1191 * t1193;
  t1203 = 0.11e3 / 0.2187e4 * t26 * t268;
  t1210 = t282 * t117;
  t1212 = 0.1e1 / t31 / t1210;
  t1216 = 0.56e3 / 0.1162261467e10 * t281 * t1212 * t814 * t818;
  t1217 = t849 * t93;
  t1218 = t218 * t141;
  t1219 = t1218 * t165;
  t1222 = t823 * t93;
  t1223 = t204 * t141;
  t1224 = t1223 * t165;
  t1227 = t273 * t123;
  t1230 = 0.13e4 / 0.531441e6 * t417 * t1227 * t419;
  t1233 = t273 * t172;
  t1238 = t391 * t115 * t290;
  t1241 = t284 * t785;
  t1251 = 0.11e3 / 0.2187e4 * t26 * t382 - 0.4e2 / 0.19683e5 * t417 * t1233 * t419 + 0.16e3 / 0.1594323e7 * t1191 * t1238 - 0.448e3 / 0.4782969e7 * t782 * t1241 * t115 + 0.4e1 / 0.2187e4 * t393 * t274 * t517 - 0.88e2 / 0.2187e4 * t224 * t225 * t398 - t1203 + t1230 - t1195 + t1216;
  t1253 = 0.12e2 * t294 * t460 * t141 - 0.6e1 * t299 * t469 * t141 - 0.6e1 * t299 * t504 * t141 - 0.6e1 * t299 * t506 * t165 + 0.4e1 * t335 * t469 * t165 + 0.4e1 * t335 * t504 * t165 + 0.6e1 * t849 * t205 * t336 - 0.6e1 * t823 * t219 * t295 - 0.3e1 * t299 * t219 * t329 + 0.2e1 * t335 * t219 * t379 - 0.6e1 * t841 * t219 * t336 + 0.12e2 * t1217 * t1219 - 0.12e2 * t1222 * t1224 + t82 * t1251 + t1195 + t1203 - t1216 - t1230;
  t1254 = t1169 + t1253;
  t1259 = my_piecewise3(t3, 0, t7 * t258 * t232 / 0.12e2 - t7 * t101 * t526 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1254);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t1259 + 0.4e1 * t531;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2lapl0 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  t1269 = t537 * t71;
  t1270 = t294 * t1269;
  t1271 = t141 * params->eta;
  t1272 = t1271 * sigma[0];
  t1273 = t195 * t1272;
  t1276 = t299 * t1269;
  t1277 = t165 * params->eta;
  t1278 = t1277 * sigma[0];
  t1279 = t195 * t1278;
  t1282 = t402 * t248;
  t1284 = t179 * t54;
  t1285 = t128 * t1284;
  t1288 = t93 * t134;
  t1289 = t128 * t1288;
  t1292 = t556 * t444;
  t1295 = t823 * t537;
  t1297 = t539 * t540 * t165;
  t1302 = t194 * t134;
  t1303 = t1302 * t59;
  t1307 = t239 * t317;
  t1310 = t425 * t321;
  t1311 = t1310 * t115;
  t1328 = 0.6e1 * t947 * t239 + 0.24e2 * t1093 * t1303 - 0.2e2 * t471 + 0.6e1 * t309 * t1307 + 0.16e2 * t892 * t1311 - 0.42e2 * t474 + 0.4e2 / 0.3e1 * t476 + 0.12e3 * t1053 * t239 * t306 + 0.24e3 * t1065 * t1303 - 0.1e3 * t483 + 0.3e2 * t482 * t1307 + 0.112e3 * t1032 * t1311 - 0.168e3 * t487 + 0.8e2 / 0.3e1 * t490;
  t1329 = t93 * t1328;
  t1331 = t179 * t584;
  t1358 = -0.6e1 * t299 * t570 * t141 - 0.6e1 * t299 * t585 * t141 + 0.4e1 * t335 * t570 * t165 + 0.4e1 * t335 * t585 * t165 - 0.6e1 * t823 * t249 * t295 - 0.3e1 * t299 * t249 * t329 + 0.2e1 * t335 * t249 * t379 - 0.6e1 * t841 * t249 * t336 - 0.32e2 * t1270 * t1273 + 0.16e2 * t1276 * t1279 - t147 * t1282 - 0.16e2 * t1285 * t559 - 0.16e2 * t1289 * t559 + 0.56e2 * t555 * t1292 + 0.24e2 * t1295 * t1297 - t147 * t1329 - 0.2e1 * t147 * t1331;
  t1359 = t248 * t141;
  t1360 = t1359 * t165;
  t1365 = t128 * t402;
  t1370 = t1108 * t239;
  t1377 = t1145 * t93;
  t1380 = t33 * t141;
  t1381 = t539 * t1380;
  t1384 = t849 * t537;
  t1386 = t539 * t49 * t336;
  t1390 = t539 * t33 * t165;
  t1393 = t294 * t1284;
  t1396 = t294 * t1288;
  t1399 = t49 * t329;
  t1400 = t539 * t1399;
  t1403 = t299 * t1284;
  t1406 = t299 * t1288;
  t1409 = t49 * t379;
  t1410 = t539 * t1409;
  t1413 = t150 * t425;
  t1414 = t1413 * t372;
  t1417 = 0.12e2 * t1217 * t1360 + 0.2e2 * t238 * t440 - 0.6e1 * t1365 * t240 - 0.12e2 * t549 * t552 - 0.6e1 * t238 * t1370 + 0.2e2 * t549 * t199 - 0.8e2 / 0.3e1 * t238 * t447 - 0.12e2 * t1377 * t240 + 0.4e2 * t538 * t1381 - 0.12e2 * t1384 * t1386 - 0.2e2 * t544 * t1390 - 0.24e2 * t1393 * t541 - 0.24e2 * t1396 * t541 - 0.12e2 * t538 * t1400 + 0.12e2 * t1403 * t546 + 0.12e2 * t1406 * t546 + 0.6e1 * t544 * t1410 - 0.16e2 * t555 * t1414;
  t1418 = t1358 + t1417;
  t1423 = my_piecewise3(t3, 0, t7 * t258 * t251 / 0.12e2 - t7 * t101 * t587 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1418);
  tv3rho2tau0 = 0.2e1 * rho[0] * t1423 + 0.4e1 * t592;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  t1438 = t606 * t165;
  t1441 = t205 * t459;
  t1477 = t279 * t425;
  t1478 = t287 * t290;
  t1479 = t1478 * sigma[0];
  t1481 = 0.1e3 / 0.1594323e7 * t1477 * t1479;
  t1482 = 0.12e2 * t294 * t612 * t141 + 0.6e1 * t294 * t624 * t141 - 0.6e1 * t299 * t631 * t141 - 0.3e1 * t299 * t649 * t141 + 0.6e1 * t849 * t628 * t141 - 0.6e1 * t299 * t612 * t165 - 0.3e1 * t299 * t624 * t165 + 0.4e1 * t335 * t631 * t165 + 0.2e1 * t335 * t649 * t165 - 0.6e1 * t841 * t628 * t165 - 0.6e1 * t299 * t205 * t503 - 0.6e1 * t299 * t436 * t218 - 0.6e1 * t299 * t460 * t218 + 0.4e1 * t335 * t219 * t503 - 0.6e1 * t823 * t1438 + 0.12e2 * t294 * t1441 - t1481;
  t1483 = t204 * t218;
  t1484 = t1483 * t141;
  t1487 = t1483 * t165;
  t1493 = t391 * t290;
  t1494 = t1493 * sigma[0];
  t1507 = 0.8e2 / 0.177147e6 * t417 * t418 * t35;
  t1509 = 0.1e1 / t31 / t772;
  t1510 = t1509 * t814;
  t1513 = 0.7e2 / 0.387420489e9 * t423 * t1510 * t818;
  t1514 = 0.8e2 / 0.177147e6 * t417 * t513 * t35 - 0.2e2 / 0.531441e6 * t1477 * t1494 + 0.56e2 / 0.1594323e7 * t782 * t425 * t785 * sigma[0] - 0.8e1 / 0.19683e5 * t655 * t656 * t120 * t290 - t1507 + t1481 - t1513;
  t1516 = t179 * t648;
  t1518 = t1111 * t195;
  t1520 = t425 * params->eta;
  t1521 = t1520 * sigma[0];
  t1522 = t885 * t1521;
  t1524 = t309 * t121;
  t1526 = t1093 * t557 * t134;
  t1528 = t1310 * sigma[0];
  t1529 = t892 * t1528;
  t1531 = t121 * params->eta;
  t1532 = t320 * t1531;
  t1534 = t195 * t134;
  t1537 = t868 * t425;
  t1538 = t1537 * sigma[0];
  t1541 = t496 * t120;
  t1544 = t1053 * t1534;
  t1546 = t1073 * t1521;
  t1549 = t358 * t640 * t120;
  t1551 = params->eta * t134;
  t1553 = t1073 * t195 * t1551;
  t1555 = t1032 * t1528;
  t1557 = t485 * t1531;
  t1566 = 0.3e1 / 0.16e2 * t1518 + 0.3e1 / 0.8e1 * t1522 - t1524 + 0.9e1 / 0.8e1 * t1526 + 0.3e1 / 0.2e1 * t1529 - 0.3e1 * t1532 + 0.9e1 / 0.8e1 * t1086 * t1534 + 0.5e1 / 0.4e1 * t867 * t1538 - 0.2e1 * t352 * t1541 + 0.15e2 / 0.4e1 * t1544 + 0.15e2 / 0.4e1 * t1546 - 0.5e1 * t1549 + 0.45e2 / 0.4e1 * t1553 + 0.21e2 / 0.2e1 * t1555 - 0.12e2 * t1557 + 0.63e2 / 0.8e1 * t1032 * t496 * t1302 + 0.7e1 * t882 * t1538 - 0.7e1 * t371 * t1541;
  t1567 = t93 * t1566;
  t1569 = t661 * t141;
  t1574 = t141 * t81;
  t1577 = t179 * t605;
  t1580 = t524 * t204;
  t1583 = t230 * t459;
  t1586 = t179 * t623;
  t1589 = t121 * t64;
  t1591 = t425 * t71;
  t1592 = t1591 * t59;
  t1605 = t1589 / 0.3e1 - t1592 / 0.12e2 - t1111 * t617 / 0.4e1 - t885 * t1528 / 0.2e1 + 0.4e1 / 0.3e1 * t309 * t1531 - 0.3e1 / 0.8e1 * t1125 * t1534 - t892 * t1538 / 0.2e1 + t320 * t1541;
  t1606 = t93 * t1605;
  t1609 = t179 * t627;
  t1612 = t524 * t218;
  t1615 = t230 * t503;
  t1618 = -t147 * t661 * t165 + 0.12e2 * t1217 * t1487 - 0.12e2 * t1222 * t1484 + 0.3e1 * t128 * t1569 + 0.6e1 * t128 * t1580 + 0.6e1 * t128 * t1583 + 0.3e1 * t128 * t1586 + 0.3e1 * t128 * t1606 - t147 * t1516 - t147 * t1567 - 0.2e1 * t147 * t1612 - 0.2e1 * t147 * t1615 + t82 * t1514 + 0.6e1 * t1574 * t606 + 0.6e1 * t294 * t1577 + 0.2e1 * t335 * t1609 + t1507 + t1513;
  t1619 = t1482 + t1618;
  t1624 = my_piecewise3(t3, 0, -t7 * t101 * t663 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1619);
  tv3rhosigma20 = 0.2e1 * rho[0] * t1624 + 0.2e1 * t667;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigmalapl0 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  t1651 = t238 * t615;
  t1653 = t230 * t54;
  t1654 = t128 * t1653;
  t1658 = t556 * t686 * t141;
  t1662 = t556 * t686 * t165;
  t1666 = t539 * t669 * t165;
  t1669 = 0.2e1 * t335 * t585 * t218 + 0.2e1 * t335 * t249 * t503 - 0.3e1 * t299 * t249 * t459 + 0.2e1 * t335 * t570 * t218 + 0.2e1 * t335 * t709 * t165 - 0.3e1 * t299 * t570 * t204 - 0.3e1 * t299 * t585 * t204 - 0.13e2 / 0.2e1 * t1651 - 0.8e1 * t1654 * t559 + 0.6e1 * t538 * t1658 - 0.3e1 * t544 * t1662 + 0.12e2 * t1295 * t1666;
  t1671 = t539 * t673 * t141;
  t1675 = t539 * t673 * t165;
  t1678 = t248 * t204;
  t1679 = t1678 * t141;
  t1682 = t1678 * t165;
  t1685 = t248 * t218;
  t1686 = t1685 * t141;
  t1689 = t841 * t93;
  t1690 = t1685 * t165;
  t1693 = t549 * t683;
  t1697 = t64 * t141;
  t1698 = t682 * t1697;
  t1699 = t717 * t1698;
  t1701 = t299 * t93;
  t1702 = t64 * t165;
  t1703 = t682 * t1702;
  t1704 = t1701 * t1703;
  t1706 = t600 * t71;
  t1707 = t1706 * t59;
  t1708 = t238 * t1707;
  t1710 = t128 * t524;
  t1713 = 0.12e2 * t1295 * t1671 - 0.12e2 * t1384 * t1675 - 0.6e1 * t1222 * t1679 + 0.6e1 * t1217 * t1682 + 0.6e1 * t1217 * t1686 - 0.6e1 * t1689 * t1690 + 0.3e1 / 0.2e1 * t1693 + 0.1e2 * t677 * t199 + 0.3e1 * t1699 - 0.3e1 / 0.2e1 * t1704 + 0.2e1 * t1708 - 0.6e1 * t1710 * t240;
  t1730 = t150 * t600;
  t1731 = t321 * sigma[0];
  t1732 = t1730 * t1731;
  t1735 = t1574 * t537;
  t1742 = t49 * t459;
  t1743 = t539 * t1742;
  t1748 = -0.3e1 * t299 * t696 * t141 - 0.3e1 * t299 * t709 * t141 + 0.2e1 * t335 * t696 * t165 + 0.3e1 * t1285 * t687 + 0.3e1 * t1289 * t687 - 0.12e2 * t1393 * t670 - 0.12e2 * t1396 * t670 + 0.6e1 * t1403 * t674 + 0.6e1 * t555 * t1732 - 0.12e2 * t1735 * t670 - 0.12e2 * t538 * t1743 - 0.6e1 * t677 * t552;
  t1751 = t49 * t503;
  t1752 = t539 * t1751;
  t1755 = t294 * t1653;
  t1758 = t299 * t1653;
  t1761 = t33 * t204;
  t1762 = t539 * t1761;
  t1765 = t33 * t218;
  t1766 = t539 * t1765;
  t1769 = t556 * t557;
  t1772 = t204 * params->eta;
  t1773 = t1772 * sigma[0];
  t1774 = t195 * t1773;
  t1777 = t218 * params->eta;
  t1778 = t1777 * sigma[0];
  t1779 = t195 * t1778;
  t1782 = t524 * t248;
  t1784 = t230 * t584;
  t1786 = t179 * t708;
  t1788 = t1111 * t682;
  t1790 = t600 * params->eta;
  t1791 = t1790 * sigma[0];
  t1792 = t885 * t1791;
  t1798 = t600 * t321;
  t1799 = t1798 * sigma[0];
  t1804 = t1053 * t682 * t134;
  t1806 = t1073 * t1791;
  t1815 = -0.3e1 / 0.2e1 * t1788 - 0.3e1 * t1792 + 0.13e2 / 0.2e1 * t634 - 0.9e1 / 0.2e1 * t1093 * t686 * t134 - 0.6e1 * t892 * t1799 + 0.39e2 / 0.4e1 * t636 - 0.3e2 * t1804 - 0.3e2 * t1806 + 0.65e2 / 0.2e1 * t642 - 0.45e2 * t1073 * t682 * t1551 - 0.42e2 * t1032 * t1799 + 0.39e2 * t644;
  t1816 = t93 * t1815;
  t1818 = -0.16e2 * t1270 * t1774 + 0.8e1 * t1276 * t1779 + 0.6e1 * t1406 * t674 - t147 * t1782 - t147 * t1784 - t147 * t1786 - t147 * t1816 + 0.6e1 * t544 * t1752 - 0.12e2 * t1755 * t541 + 0.6e1 * t1758 * t546 + 0.2e2 * t538 * t1762 - 0.1e2 * t544 * t1766 - 0.13e2 * t555 * t1769;
  t1820 = t1669 + t1713 + t1748 + t1818;
  t1825 = my_piecewise3(t3, 0, -t7 * t101 * t711 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1820);
  tv3rhosigmatau0 = 0.2e1 * rho[0] * t1825 + 0.2e1 * t715;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  t1834 = t539 * t724 * t141;
  t1838 = t539 * t724 * t165;
  t1841 = t320 * t682;
  t1844 = t720 * t1697;
  t1847 = t720 * t1702;
  t1850 = 0.1e1 / t271;
  t1851 = t1850 * t71;
  t1852 = t1851 * t59;
  t1855 = t1574 * t93;
  t1858 = t294 * t179;
  t1862 = t179 * t731;
  t1865 = t179 * t740;
  t1869 = t1850 * params->eta;
  t1870 = t1869 * sigma[0];
  t1880 = 0.24e3 * t1053 * t720 * t134 + 0.24e3 * t1073 * t1870 + 0.12e2 * t1111 * t720 + 0.24e2 * t885 * t1870 - 0.4e2 * t698 - 0.2e3 * t704;
  t1881 = t93 * t1880;
  t1883 = 0.24e2 * t1295 * t1834 - 0.24e2 * t1384 * t1838 - t147 * t1865 - t147 * t1881 + 0.12e2 * t1701 * t1847 - 0.16e3 * t717 * t1841 - 0.24e2 * t717 * t1844 - 0.16e2 * t238 * t1852 + 0.48e2 * t1855 * t721 + 0.48e2 * t1858 * t721 + 0.2e1 * t335 * t1862 - 0.12e2 * t549 * t728 + 0.4e2 * t684;
  t1884 = t33 * t248;
  t1885 = t539 * t1884;
  t1888 = t93 * t55;
  t1889 = t294 * t1888;
  t1890 = t351 * t1850;
  t1891 = t1890 * t59;
  t1898 = t49 * t584;
  t1899 = t539 * t1898;
  t1902 = t823 * t1888;
  t1903 = t150 * t28;
  t1904 = t719 * t165;
  t1905 = t1903 * t1904;
  t1909 = t1903 * t719 * t134;
  t1927 = t248 * params->eta;
  t1928 = t1927 * sigma[0];
  t1929 = t195 * t1928;
  t1932 = -0.3e1 * t299 * t741 * t141 + 0.6e1 * t849 * t732 * t141 + 0.2e1 * t335 * t741 * t165 - 0.6e1 * t841 * t732 * t165 + 0.4e1 * t335 * t249 * t584 + 0.16e2 * t1276 * t1929 + 0.12e2 * t1403 * t725 + 0.12e2 * t1406 * t725 - 0.2e2 * t544 * t1885 + 0.128e3 * t1889 * t1891 + 0.12e2 * t544 * t1899 - 0.48e2 * t1902 * t1905 + 0.96e2 * t538 * t1909;
  t1933 = t1883 + t1932;
  t1938 = my_piecewise3(t3, 0, -t7 * t101 * t743 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t1933);
  tv3rhotau20 = 0.2e1 * rho[0] * t1938 + 0.2e1 * t747;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  t1945 = 0.1e1 / t31 / t283;
  t1949 = 0.35e2 / 0.516560652e9 * t599 * t1945 * t814 * t818;
  t1950 = t279 * t600;
  t1957 = 0.5e1 / 0.354294e6 * t1950 * t1478;
  t1958 = 0.5e1 / 0.354294e6 * t1950 * t1493 - 0.7e1 / 0.531441e6 * t781 * t1950 * t785 - t1957 + t1949;
  t1960 = t606 * t218;
  t1963 = t205 * t623;
  t1975 = t627 * t218;
  t1976 = t93 * t1975;
  t1982 = t605 * t204;
  t1983 = t1982 * t81;
  t1986 = t230 * t605;
  t1989 = t661 * t204;
  t1992 = t230 * t623;
  t1995 = t1706 * params->eta;
  t1997 = t885 * t1798;
  t1999 = t868 * t600;
  t2002 = 0.3e1 / 0.32e2 * t1995 + 0.9e1 / 0.32e2 * t1997 + 0.3e1 / 0.16e2 * t892 * t1999;
  t2003 = t93 * t2002;
  t2006 = t230 * t627;
  t2009 = t661 * t218;
  t2012 = t230 * t648;
  t2016 = t885 * t1790;
  t2018 = t892 * t1798;
  t2022 = t78 * t600;
  t2023 = t873 * t2022;
  t2027 = t358 * t160 * t600 * params->eta;
  t2031 = t155 * t370 * t600 * t321;
  t2033 = t881 * t868;
  t2037 = -0.3e1 / 0.64e2 * t1706 - 0.27e2 / 0.64e2 * t2016 - 0.27e2 / 0.32e2 * t2018 - 0.15e2 / 0.32e2 * t867 * t1999 - 0.15e2 / 0.16e2 * t2023 - 0.135e3 / 0.32e2 * t2027 - 0.189e3 / 0.32e2 * t2031 - 0.21e2 / 0.8e1 * t75 * t2033 * t600;
  t2038 = t93 * t2037;
  t2040 = 0.18e2 * t849 * t205 * t627 - t1949 + t82 * t1958 - 0.18e2 * t823 * t1960 + 0.18e2 * t294 * t1963 - 0.18e2 * t299 * t612 * t218 - 0.9e1 * t299 * t624 * t218 - 0.9e1 * t299 * t205 * t648 - 0.6e1 * t841 * t1976 + 0.6e1 * t335 * t219 * t648 + t1957 + 0.6e1 * t1983 * t93 + 0.18e2 * t294 * t1986 + 0.9e1 * t128 * t1989 + 0.9e1 * t128 * t1992 + 0.3e1 * t128 * t2003 + 0.6e1 * t335 * t2006 - 0.3e1 * t147 * t2009 - 0.3e1 * t147 * t2012 - t147 * t2038;
  t2044 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t2040);
  tv3sigma30 = 0.2e1 * rho[0] * t2044;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma2lapl0 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  t2046 = t230 * t708;
  t2050 = t885 * t1869;
  t2052 = t1850 * t321;
  t2055 = t78 * t1850;
  t2056 = t873 * t2055;
  t2060 = t358 * t160 * t1850 * params->eta;
  t2066 = 0.3e1 / 0.8e1 * t1851 + 0.9e1 / 0.4e1 * t2050 + 0.9e1 / 0.4e1 * t892 * t2052 + 0.15e2 / 0.2e1 * t2056 + 0.45e2 / 0.2e1 * t2060 + 0.63e2 / 0.4e1 * t155 * t370 * t1850 * t321;
  t2067 = t93 * t2066;
  t2069 = t661 * t248;
  t2071 = t605 * t81;
  t2072 = t2071 * t93;
  t2077 = t556 * t681 * t204 * params->eta;
  t2080 = t681 * t218;
  t2082 = t556 * t2080 * params->eta;
  t2086 = t539 * t669 * t218;
  t2089 = t64 * t204;
  t2090 = t682 * t2089;
  t2091 = t717 * t2090;
  t2093 = t64 * t218;
  t2094 = t682 * t2093;
  t2095 = t1701 * t2094;
  t2097 = t128 * t661;
  t2100 = t885 * t2052;
  t2103 = t1678 * t218;
  t2106 = t677 * t683;
  t2108 = t1851 * params->eta;
  t2109 = t238 * t2108;
  t2111 = -0.2e1 * t147 * t2046 - t147 * t2067 - t147 * t2069 - 0.12e2 * t2072 * t240 + 0.12e2 * t538 * t2077 - 0.6e1 * t544 * t2082 + 0.24e2 * t1295 * t2086 + 0.6e1 * t2091 - 0.3e1 * t2095 - 0.6e1 * t2097 * t240 - 0.9e1 / 0.4e1 * t238 * t2100 + 0.12e2 * t1217 * t2103 + 0.3e1 * t2106 - 0.3e1 / 0.2e1 * t2109;
  t2114 = t49 * t623;
  t2115 = t539 * t2114;
  t2120 = t49 * t648;
  t2121 = t539 * t2120;
  t2126 = t49 * t627;
  t2127 = t539 * t2126;
  t2136 = t249 * t605;
  t2154 = -0.6e1 * t299 * t696 * t204 - 0.6e1 * t299 * t709 * t204 + 0.4e1 * t335 * t696 * t218 + 0.4e1 * t335 * t709 * t218 - 0.3e1 * t299 * t249 * t623 + 0.2e1 * t335 * t249 * t648 - 0.6e1 * t841 * t249 * t627 - 0.12e2 * t1384 * t2127 + 0.6e1 * t1654 * t687 - 0.24e2 * t1755 * t670 + 0.12e2 * t1758 * t674 - 0.12e2 * t538 * t2115 + 0.6e1 * t544 * t2121 - 0.6e1 * t823 * t2136;
  t2155 = t2111 + t2154;
  t2159 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t2155);
  tv3sigma2tau0 = 0.2e1 * rho[0] * t2159;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  t2161 = t204 * t81;
  t2162 = t2161 * t93;
  t2165 = t719 * t218;
  t2166 = t1903 * t2165;
  t2169 = t294 * t230;
  t2172 = 0.1e1 / t118;
  t2173 = t885 * t2172;
  t2174 = t717 * t2173;
  t2176 = t2172 * params->eta;
  t2177 = t892 * t2176;
  t2181 = t539 * t724 * t204;
  t2185 = t539 * t724 * t218;
  t2190 = t64 * t248;
  t2191 = t682 * t2190;
  t2192 = t1701 * t2191;
  t2194 = t681 * t248;
  t2196 = t556 * t2194 * params->eta;
  t2199 = t49 * t708;
  t2200 = t539 * t2199;
  t2203 = 0.24e2 * t1295 * t2181 - 0.24e2 * t1384 * t2185 + 0.12e2 * t1758 * t725 - 0.48e2 * t1902 * t2166 + 0.48e2 * t2162 * t721 + 0.48e2 * t2169 * t721 - 0.48e2 * t717 * t2177 - 0.6e1 * t544 * t2196 + 0.12e2 * t544 * t2200 - 0.24e2 * t2174 - 0.3e1 * t2192;
  t2204 = t720 * t2089;
  t2207 = t720 * t2093;
  t2212 = t2172 * t71;
  t2213 = t2212 * params->eta;
  t2222 = t230 * t731;
  t2234 = t230 * t740;
  t2239 = t78 * t2172;
  t2240 = t873 * t2239;
  t2246 = -0.9e2 * t358 * t160 * t2172 * params->eta - 0.9e1 * t885 * t2176 - 0.3e1 * t2212 - 0.6e2 * t2240;
  t2247 = t93 * t2246;
  t2249 = -0.3e1 * t299 * t741 * t204 + 0.6e1 * t849 * t732 * t204 + 0.2e1 * t335 * t741 * t218 - 0.6e1 * t841 * t732 * t218 + 0.4e1 * t335 * t249 * t708 - t147 * t2234 - t147 * t2247 + 0.12e2 * t1701 * t2207 - 0.24e2 * t717 * t2204 + 0.6e1 * t238 * t2213 + 0.2e1 * t335 * t2222 - 0.12e2 * t677 * t728;
  t2250 = t2203 + t2249;
  t2254 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t2250);
  tv3sigmatau20 = 0.2e1 * rho[0] * t2254;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  t2256 = 0.1e1 / t192;
  t2257 = t2256 * t81;
  t2261 = t719 * t248;
  t2262 = t1903 * t2261;
  t2265 = t885 * t2256;
  t2268 = t49 * t731;
  t2269 = t539 * t2268;
  t2272 = t720 * t2190;
  t2275 = t49 * t740;
  t2276 = t539 * t2275;
  t2279 = t731 * t248;
  t2280 = t93 * t2279;
  t2288 = t78 * t2256;
  t2291 = 0.24e2 * t2256 * t71 + 0.48e3 * t873 * t2288;
  t2292 = t93 * t2291;
  t2294 = -0.192e3 * t867 * t2257 * t93 + 0.6e1 * t335 * t249 * t740 - 0.36e2 * t1384 * t2269 - t147 * t2292 + 0.36e2 * t1701 * t2272 - 0.144e3 * t1902 * t2262 + 0.288e3 * t717 * t2265 + 0.18e2 * t544 * t2276 - 0.6e1 * t841 * t2280;
  t2298 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t2294);
  tv3tau30 = 0.2e1 * rho[0] * t2298;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

  t2320 = params->b * t55;
  t2321 = t306 * t306;
  t2325 = t317 * t317;
  t2335 = 0.1e1 / t31 / t118;
  t2336 = t51 * t2335;
  t2338 = 0.616e4 / 0.81e2 * t47 * t761 - 0.2618e4 / 0.81e2 * t2336;
  t2343 = t317 * params->eta;
  t2347 = 0.1e1 / t1210;
  t2348 = t869 * t2347;
  t2357 = t857 * t150;
  t2361 = t55 * t78;
  t2362 = t2361 * t868;
  t2366 = t69 * t160;
  t2367 = t321 * t321;
  t2368 = t2366 * t2367;
  t2369 = t282 * t118;
  t2371 = 0.1e1 / t31 / t2369;
  t2373 = t807 * t2371 * t29;
  t2377 = 0.1e1 / t19 / t424;
  t2378 = t323 * t2377;
  t2395 = 0.36e3 * t2320 * t78 * t2321 + 0.9e2 * t358 * t78 * t2325 + 0.24e2 * t309 * t864 * t134 + 0.6e1 * t155 * t78 * t2338 + 0.72e3 * t358 * t362 * t2343 * t132 - 0.176e4 / 0.9e1 * t867 * t2348 + 0.72e3 * t873 * t359 * t317 + 0.12e3 * t358 * t156 * t864 + 0.24e2 * t2357 * params->eta * t132 + 0.32e3 / 0.3e1 * t2362 * t783 * t134 + 0.16e3 / 0.9e1 * t2368 * t2373 + 0.7832e4 / 0.27e2 * t353 * t2378 - 0.2618e4 / 0.27e2 * t152 * t2336 - 0.9856e4 / 0.9e1 * t882 * t2348 - 0.264e3 * t908 * t376 + 0.168e4 * t358 * t370 * t306 * t373 - 0.2464e4 * t912 * t915 - 0.132e4 * t924 * t376;
  t2397 = t107 * t317;
  t2413 = t160 * params->eta;
  t2416 = t51 * t761 * t134;
  t2419 = t155 * t881;
  t2426 = t75 / t369 / t63;
  t2432 = t54 * t351;
  t2442 = t28 * t2377;
  t2446 = t29 * t2335;
  t2464 = 0.72e2 * t885 * t1551 * t51 * t2397 + 0.48e2 * t155 * t160 * t864 * t162 + 0.96e3 * t873 * t160 * t857 * t162 + 0.336e3 * t155 * t370 * t317 * t373 + 0.2464e4 / 0.3e1 * t155 * t2413 * t2416 + 0.3584e4 / 0.3e1 * t2419 * t869 * t773 * t134 + 0.448e3 / 0.3e1 * t2426 * t2367 * t807 * t2371 * t29 + 0.96e2 * t2432 * t306 * t373 - 0.132e3 * t886 * t376 - 0.66e2 * t889 * t376 - 0.352e3 * t893 * t915 + 0.27412e5 / 0.27e2 * t371 * t372 * t2442 - 0.5236e4 / 0.27e2 * t161 * t59 * t2446 + 0.48e2 * t892 * t317 * t373 + 0.616e3 / 0.3e1 * t477 * t2416 + 0.12e2 * t320 * t864 * t162 + 0.3e1 * t137 * t2338 + 0.36e2 * t947 * t317 + 0.18e2 * t309 * t2325;
  t2477 = t67 * t840;
  t2512 = 0.41008e6 / 0.43046721e8 * t281 * t2347 * t287 * t290;
  t2519 = t66 * t334;
  t2523 = t932 * t146;
  t2526 = 0.24e2 * t294 * t142 * t967 - 0.36e2 * t299 * t939 * t165 - 0.36e2 * t299 * t942 * t165 - 0.72e2 * t823 * t936 * t165 + 0.72e2 * t2519 * t296 * t336 + 0.72e2 * t294 * t303 * t329 - 0.36e2 * t823 * t296 * t379 + 0.72e2 * t849 * t303 * t336 + 0.36e2 * t849 * t330 * t336 - 0.24e2 * t2523 * t166 + t2512;
  t2530 = t329 * t329;
  t2556 = t389 * t389;
  t2559 = t85 / t90 / t2556;
  t2561 = t289 * t289;
  t2562 = 0.1e1 / t2561;
  t2564 = t26 * t29;
  t2582 = 0.2618e5 / 0.19683e5 * t27 * t2446 * t43;
  t2585 = 0.12188e6 / 0.1594323e7 * t116 * t2442 * t124;
  t2589 = 0.43904e6 / 0.10460353203e11 * t808 * t2371 * t814 * t818;
  t2592 = t282 * t282;
  t2596 = t285 * t285;
  t2598 = 0.1e1 / t42 / t2596;
  t2602 = t2562 * t56 * t656;
  t2604 = 0.34048e6 / 0.2541865828329e13 * t279 * t807 * sigma[0] / t19 / t2592 / rho[0] * t2598 * t2602;
  t2605 = 0.2618e5 / 0.19683e5 * t27 * t2446 * t91 - 0.31328e6 / 0.4782969e7 * t116 * t2442 * t385 + 0.2816e5 / 0.4782969e7 * t281 * t2347 * t391 * t290 - 0.14336e6 / 0.10460353203e11 * t808 * t2371 * t780 * t818 + 0.136192e6 / 0.10460353203e11 * t2559 * t808 * t2371 * t2562 * t2564 - 0.78848e5 / 0.14348907e8 * t782 * t280 * t2347 * t785 + 0.31328e5 / 0.531441e6 * t393 * t323 * t2377 * t290 - 0.20944e5 / 0.19683e5 * t174 * t51 * t2335 * t35 - t2582 + t2585 - t2512 + t2589 - t2604;
  t2615 = t141 * t165;
  t2621 = t68 / t839 / t80;
  t2622 = t336 * t336;
  t2626 = t379 * t379;
  t2648 = t306 * t150;
  t2649 = t2648 * t321;
  t2657 = t2361 * t2367;
  t2681 = 0.352e3 / 0.3e1 * t951 * t915 + 0.88e2 / 0.3e1 * t954 * t376 - 0.2464e4 / 0.27e2 * t310 * t918 - 0.16e2 * t2649 * t324 - 0.256e3 / 0.9e1 * t2432 * t134 * t870 + 0.704e3 / 0.9e1 * t892 * t2348 - 0.16e3 / 0.27e2 * t2657 * t2373 - 0.6e1 * t2325 * t64 - 0.8e1 * t439 * t864 - 0.2e1 * t129 * t2338 - 0.16e2 / 0.3e1 * t309 * t864 * t162 - 0.3916e4 / 0.27e2 * t322 * t2378 + 0.5236e4 / 0.81e2 * t138 * t2336 - 0.16e2 * t1111 * t317 * t162 + 0.88e2 / 0.3e1 * t948 * t315 - 0.16e2 * t885 * t317 * t373;
  t2688 = -0.72e2 * t1222 * t2615 * t329 + 0.12e2 * t128 * t821 * t141 + 0.12e2 * t128 * t179 * t967 + 0.3e1 * t128 * t93 * t2681 - 0.4e1 * t147 * t821 * t165 - 0.24e2 * t841 * t179 * t842 + 0.24e2 * t2621 * t93 * t2622 + 0.6e1 * t335 * t93 * t2626 + 0.12e2 * t335 * t402 * t336 - t2585 + t2604;
  t2695 = my_piecewise3(t3, 0, 0.1e2 / 0.27e2 * t7 * t18 * t107 * t95 - 0.5e1 / 0.9e1 * t7 * t750 * t181 + t7 * t258 * t404 / 0.2e1 - t7 * t101 * t978 / 0.2e1 - 0.3e1 / 0.8e1 * t7 * t20 * (-0.6e1 * t147 * t402 * t379 - 0.4e1 * t147 * t179 * t929 - t147 * t93 * (t2395 + t2464) + 0.36e2 * t294 * t402 * t295 + 0.18e2 * t128 * t402 * t329 - 0.12e2 * t299 * t142 * t929 - 0.72e2 * t2477 * t843 * t141 - 0.18e2 * t299 * t330 * t379 - 0.36e2 * t299 * t303 * t379 - 0.12e2 * t299 * t968 * t165 + t2526 + 0.72e2 * t1217 * t141 * t379 * t165 + 0.8e1 * t335 * t166 * t929 + 0.18e2 * t294 * t93 * t2530 + 0.24e2 * t335 * t340 * t379 - 0.36e2 * t841 * t337 * t379 + 0.36e2 * t1145 * t330 + 0.24e2 * t933 * t179 + t82 * t2605 + t2582 - t2589 + t2688));
  tv4rho40 = 0.2e1 * rho[0] * t2695 + 0.8e1 * t983;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2765 = 0.36e2 * t294 * t1105 * t141 + 0.9e1 * t128 * t179 * t1138 + 0.18e2 * t294 * t1142 * t141 - 0.3e1 * t147 * t1251 * t165 + 0.3e1 * t128 * t821 * t204 + 0.9e1 * t128 * t402 * t459 - 0.3e1 * t147 * t524 * t379 + 0.18e2 * t294 * t524 * t295 + 0.18e2 * t294 * t436 * t329 - 0.18e2 * t823 * t469 * t295 - 0.18e2 * t823 * t504 * t295 + 0.6e1 * t335 * t524 * t336 + 0.6e1 * t335 * t509 * t379 + 0.18e2 * t849 * t436 * t336 + 0.18e2 * t849 * t460 * t336 - 0.18e2 * t841 * t469 * t336 - 0.18e2 * t841 * t504 * t336 + 0.18e2 * t1145 * t436 + 0.18e2 * t1145 * t460 + 0.18e2 * t1574 * t1157;
  t2774 = t267 * t134;
  t2778 = t773 * t321 * t115;
  t2782 = t868 * t773 * t115;
  t2785 = t200 * t761;
  t2788 = t108 * t317;
  t2793 = t34 * t864;
  t2800 = t873 * t1064;
  t2806 = t284 * t115 * t134;
  t2809 = -0.9e1 / 0.4e1 * t2357 * t201 + 0.308e3 / 0.9e1 * t155 * t212 * t761 - 0.22e2 * t309 * t2774 + 0.38e2 * t892 * t2778 + 0.19e3 / 0.3e1 * t867 * t2782 + 0.154e3 / 0.9e1 * t151 * t2785 + 0.6e1 * t309 * t2788 - 0.9e1 / 0.4e1 * t1111 * t1008 - 0.3e1 / 0.4e1 * t309 * t2793 + 0.6e1 * t947 * t108 + 0.154e3 / 0.9e1 * t137 * t762 - 0.18e3 * t2800 * t120 * t306 * t59 - 0.3e2 * t2362 * t2806;
  t2811 = t811 * t280 * t29;
  t2818 = t768 * sigma[0];
  t2825 = t108 * t306;
  t2828 = t2320 * t78;
  t2844 = -0.2e2 / 0.3e1 * t2368 * t2811 - 0.9e1 / 0.8e1 * t477 * t2793 - 0.33e2 * t477 * t2774 - 0.682e3 / 0.9e1 * t353 * t2818 - 0.15e2 / 0.4e1 * t482 * t2793 + 0.308e3 / 0.9e1 * t161 * t2785 + 0.18e2 * t1044 * t2825 - 0.45e2 * t2828 * t34 * t857 + 0.12e3 * t1053 * t2825 + 0.1064e4 / 0.3e1 * t882 * t2782 + 0.9e1 * t477 * t2788 + 0.3e2 * t482 * t2788 + 0.266e3 * t1032 * t2778 - 0.11e3 * t482 * t2774;
  t2846 = t2648 * t28;
  t2850 = t372 * t134;
  t2854 = t869 * t29;
  t2858 = t767 * params->eta * sigma[0];
  t2861 = t274 * t1060;
  t2865 = t121 * t317 * sigma[0];
  t2869 = t120 * t317 * t59;
  t2872 = t1039 * t1060;
  t2876 = t34 * t901;
  t2881 = t121 * t306 * sigma[0];
  t2888 = t2432 * t321;
  t2894 = t280 * t29;
  t2898 = -0.9e1 / 0.2e1 * t2846 * t444 - 0.12e2 * t2432 * t284 * t2850 - 0.1e2 / 0.3e1 * t2361 * t811 * t2854 - 0.341e3 / 0.6e1 * t473 * t2858 + 0.567e3 * t1059 * t2861 - 0.63e2 * t1059 * t2865 - 0.45e2 * t1065 * t2869 + 0.405e3 * t1065 * t2872 - 0.135e3 / 0.2e1 * t358 * t2413 * t2876 - 0.315e3 * t358 * t1058 * t2881 - 0.9e1 / 0.2e1 * t485 * t200 * t33 * t864 - 0.18e2 * t2888 * t2881 + 0.81e2 * t1086 * t2861 - 0.112e3 / 0.3e1 * t2419 * t811 * t868 * t2894;
  t2902 = t115 * t134;
  t2923 = t358 * t370;
  t2935 = t873 * t160;
  t2944 = -0.682e3 / 0.3e1 * t485 * t768 * t59 - 0.336e3 * t2419 * t1015 * t2902 - 0.56e2 * t2426 * t2367 * t811 * t2894 + 0.81e2 / 0.2e1 * t1093 * t2872 + 0.36e2 * t485 * t200 * t2397 - 0.9e1 / 0.2e1 * t1093 * t2869 - 0.27e2 / 0.4e1 * t1044 * t2876 - 0.9e1 * t1086 * t2865 - 0.45e2 * t1053 * t2876 - 0.21e3 * t2923 * t1011 * t2902 - 0.132e3 * t485 * t200 * t266 * t134 - 0.2387e4 / 0.9e1 * t371 * t496 * t767 * sigma[0] - 0.9e2 * t2935 * t200 * t33 * t857 + 0.18e3 * t1073 * t200 * t107 * t306;
  t2984 = t2477 * t93;
  t3006 = 0.6e1 * t335 * t1098 * t165 + 0.12e2 * t335 * t1100 * t165 + 0.6e1 * t335 * t1103 * t165 - 0.18e2 * t823 * t1151 * t165 - 0.54e2 * t2984 * t1218 * t336 - 0.3e1 * t299 * t219 * t967 + 0.2e1 * t335 * t219 * t929 - 0.9e1 * t299 * t504 * t329 + 0.6e1 * t335 * t469 * t379 + 0.6e1 * t335 * t504 * t379 + 0.6e1 * t933 * t230;
  t3020 = 0.4984e5 / 0.3486784401e10 * t281 * t815 * t818;
  t3026 = 0.4256e5 / 0.847288609443e12 * t808 / t19 / t2592 * t2598 * t2602;
  t3057 = t279 * t773;
  t3059 = 0.41e5 / 0.14348907e8 * t3057 * t1193;
  t3067 = t2519 * t93;
  t3075 = 0.36e2 * t1217 * t503 * t141 * t165 + 0.36e2 * t3067 * t218 * t295 * t165 - 0.9e1 * t299 * t1098 * t141 - 0.18e2 * t299 * t1100 * t141 - 0.9e1 * t299 * t1103 * t141 - 0.18e2 * t299 * t1105 * t165 + 0.18e2 * t294 * t1139 * t141 - 0.9e1 * t299 * t1139 * t165 - 0.9e1 * t299 * t1142 * t165 - 0.18e2 * t1222 * t1218 * t329 - 0.18e2 * t2477 * t205 * t842 + 0.6e1 * t294 * t205 * t967 - 0.3e1 * t299 * t205 * t929 + 0.18e2 * t294 * t460 * t329 - 0.9e1 * t299 * t469 * t329 - 0.9e1 * t299 * t436 * t379 - 0.9e1 * t299 * t460 * t379 + t3020 - t3026 - t3059;
  t3076 = t849 * t179;
  t3090 = t204 * t165;
  t3094 = t823 * t179;
  t3108 = t218 * t165;
  t3114 = 0.154e4 / 0.6561e4 * t26 * t797;
  t3115 = t295 * t146;
  t3129 = t279 * t811;
  t3152 = 0.1012e5 / 0.531441e6 * t417 * t767 * t123 * t419;
  t3153 = -0.154e4 / 0.6561e4 * t26 * t763 + 0.2728e5 / 0.1594323e7 * t417 * t767 * t172 * t419 - 0.304e4 / 0.1594323e7 * t3057 * t1238 + 0.1792e5 / 0.3486784401e10 * t3129 * t780 * t280 * t818 - 0.17024e5 / 0.3486784401e10 * t2559 * t3129 * t2562 * t280 * t2564 + 0.8512e4 / 0.4782969e7 * t782 * t773 * t785 * t115 - 0.2728e4 / 0.177147e6 * t393 * t768 * t517 + 0.1232e4 / 0.6561e4 * t224 * t225 * t793 + t3114 - t3152 + t3059 - t3020 + t3026;
  t3175 = t2432 * t868;
  t3188 = t317 * t71;
  t3191 = -0.27e2 * t1125 * t2861 + 0.3e1 / 0.2e1 * t1111 * params->eta * t1008 - 0.4e1 * t947 * t456 + 0.3e1 * t2649 * t453 + 0.8e1 * t3175 * t2806 - 0.4e1 * t449 * t2788 + t449 * t2793 / 0.2e1 - 0.76e2 / 0.3e1 * t892 * t2782 + 0.2e2 / 0.9e1 * t2657 * t2811 - 0.308e3 / 0.27e2 * t137 * t2785 + t3188 * t28 * t444;
  t3199 = t134 * t150;
  t3206 = t864 * t64;
  t3219 = -0.38e2 / 0.3e1 * t885 * t2778 + 0.8e1 / 0.9e1 * t2432 * t811 * t2854 - 0.2e1 * t1108 * t108 + 0.2e1 * t3199 * t1012 + 0.22e2 / 0.3e1 * t439 * t267 - 0.308e3 / 0.27e2 * t129 * t762 + t3206 * t34 / 0.4e1 + 0.3e1 * t1125 * t2865 + 0.44e2 / 0.3e1 * t449 * t2774 + 0.341e3 / 0.9e1 * t322 * t2818 - 0.9e1 * t1112 * t1040 + 0.682e3 / 0.27e2 * t442 * t2858;
  t3226 = -t3114 - 0.18e2 * t3115 * t433 + 0.24e2 * t2621 * t219 * t842 + t82 * t3153 + 0.18e2 * t849 * t506 * t336 - 0.3e1 * t147 * t179 * t1097 - t147 * t821 * t218 - 0.3e1 * t147 * t402 * t503 + 0.3e1 * t128 * t93 * (t3191 + t3219) - t147 * t230 * t929 + t3152;
  t3234 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t750 * t232 + t7 * t258 * t526 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t101 * t1254 - 0.3e1 / 0.8e1 * t7 * t20 * (t2765 + 0.3e1 * t128 * t230 * t967 - t147 * t93 * (t2809 + t2844 + t2898 + t2944) + 0.9e1 * t128 * t524 * t329 - 0.6e1 * t2523 * t219 - 0.6e1 * t841 * t230 * t842 - 0.9e1 * t299 * t506 * t379 - 0.18e2 * t299 * t998 * t165 - 0.9e1 * t299 * t1001 * t165 + 0.9e1 * t128 * t1251 * t141 + 0.18e2 * t294 * t506 * t329 + t3006 + 0.18e2 * t1217 * t218 * t329 * t165 - 0.36e2 * t1222 * t459 * t141 * t165 - 0.18e2 * t1222 * t204 * t329 * t165 + 0.36e2 * t3067 * t204 * t336 * t141 + 0.18e2 * t1217 * t1218 * t379 + 0.18e2 * t1217 * t3090 * t379 - 0.18e2 * t1222 * t1223 * t379 - 0.18e2 * t1689 * t3108 * t379 + 0.36e2 * t3076 * t1219 - 0.36e2 * t3094 * t1224 + t3075 + t3226));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t3234 + 0.6e1 * t1259;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3lapl0 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 0] += tv4rho3lapl0;

  t3250 = t248 * t165;
  t3264 = t93 * t317;
  t3265 = t128 * t3264;
  t3275 = t849 * t1284;
  t3280 = t849 * t1288;
  t3287 = 0.36e2 * t1217 * t584 * t141 * t165 + 0.18e2 * t1217 * t248 * t329 * t165 + 0.36e2 * t3067 * t248 * t295 * t165 - 0.3e2 * t544 * t539 * t33 * t379 + 0.18e2 * t1217 * t1359 * t379 - 0.18e2 * t1222 * t1359 * t329 - 0.18e2 * t1689 * t3250 * t379 + 0.36e2 * t3076 * t1360 - 0.36e2 * t3275 * t1386 - 0.36e2 * t3280 * t1386 - 0.6e2 * t1403 * t1390 - 0.24e2 * t3265 * t559;
  t3304 = t3115 * t537;
  t3307 = t402 * t54;
  t3308 = t294 * t3307;
  t3311 = t179 * t134;
  t3312 = t294 * t3311;
  t3317 = t294 * t3264;
  t3322 = 0.256e3 * t555 * t150 * t284 * t372 + 0.6e2 * t538 * t539 * t33 * t329 + 0.12e3 * t1393 * t1381 + 0.12e3 * t1396 * t1381 - 0.6e2 * t1406 * t1390 - 0.36e2 * t1393 * t1400 - 0.36e2 * t1396 * t1400 - 0.36e2 * t1735 * t1400 + 0.36e2 * t3304 * t546 - 0.36e2 * t3308 * t541 - 0.72e2 * t3312 * t541 - 0.36e2 * t3317 * t541;
  t3340 = t823 * t1269;
  t3347 = t299 * t3264;
  t3356 = t299 * t3307;
  t3359 = t299 * t3311;
  t3362 = -0.16e3 * t538 * t539 * t107 * t141 + 0.8e2 * t544 * t539 * t107 * t165 + 0.96e2 * t3340 * t195 * t141 * t1278 - 0.12e2 * t538 * t539 * t49 * t967 + 0.6e1 * t544 * t539 * t49 * t929 - 0.48e2 * t1285 * t1414 - 0.48e2 * t1289 * t1414 + 0.18e2 * t1403 * t1410 + 0.18e2 * t1406 * t1410 + 0.18e2 * t3347 * t546 + 0.18e2 * t3356 * t546 + 0.36e2 * t3359 * t546;
  t3363 = t2477 * t537;
  t3374 = t194 * t306;
  t3378 = t194 * t317;
  t3379 = t3378 * t59;
  t3386 = t239 * t864;
  t3396 = 0.144e4 * t2800 * t3374 * t59 + 0.36e3 * t1065 * t3379 - 0.3e2 * t1004 - 0.44e3 / 0.9e1 * t1006 + 0.18e2 * t1111 * t1307 + 0.6e1 * t309 * t3386 - 0.3e2 * t1009 - 0.256e3 * t1013 - 0.88e3 / 0.9e1 * t1023 + 0.8e2 * t1026 - 0.15e3 * t1030 - 0.1792e4 * t1033 + 0.878e3 / 0.3e1 * t1041;
  t3404 = t425 * t134;
  t3408 = t1212 * t868;
  t3415 = t2432 * t425;
  t3418 = t2361 * t1212;
  t3428 = -0.6e3 * t1054 + 0.4e3 * t1056 + 0.36e2 * t1093 * t3379 + 0.36e3 * t1053 * t239 * t901 + 0.168e4 * t2923 * t3404 * t372 + 0.896e3 / 0.3e1 * t2419 * t3408 * t2894 - 0.252e4 * t1068 + 0.36e2 * t2846 * t558 + 0.96e2 * t3415 * t2850 + 0.8e2 / 0.3e1 * t3418 * t2854 + 0.3e2 * t482 * t3386 + 0.36e3 * t2828 * t239 * t857 + 0.3512e4 / 0.3e1 * t1071 - 0.252e3 * t1094;
  t3459 = 0.36e2 * t3363 * t539 * t49 * t842 + 0.6e2 * t1384 * t539 * t33 * t336 - 0.6e1 * t2523 * t249 - t147 * t93 * (t3396 + t3428) + 0.6e1 * t335 * t1282 * t165 - 0.18e2 * t299 * t1331 * t141 - 0.54e2 * t2984 * t1359 * t336 - 0.9e1 * t299 * t1282 * t141 + 0.2e1 * t335 * t249 * t929 + 0.6e1 * t335 * t585 * t379 - 0.3e1 * t299 * t249 * t967 + 0.6e1 * t335 * t570 * t379 - 0.9e1 * t299 * t585 * t329;
  t3493 = t823 * t1288;
  t3496 = -0.18e2 * t841 * t585 * t336 - 0.9e1 * t299 * t570 * t329 - 0.18e2 * t823 * t585 * t295 - 0.18e2 * t841 * t570 * t336 + 0.6e1 * t335 * t1329 * t165 - 0.18e2 * t823 * t570 * t295 + 0.88e3 / 0.9e1 * t238 * t1121 + 0.6e2 * t1377 * t199 - 0.9e1 * t299 * t1329 * t141 + 0.12e2 * t335 * t1331 * t165 + 0.24e2 * t2621 * t249 * t842 + 0.72e2 * t3493 * t1297;
  t3525 = t128 * t3307;
  t3528 = t128 * t3311;
  t3534 = t1145 * t537;
  t3537 = t823 * t1284;
  t3540 = 0.36e2 * t1295 * t539 * t1399 * t165 + 0.36e2 * t1295 * t539 * t1409 * t141 - 0.36e2 * t1384 * t539 * t1409 * t165 + 0.168e3 * t1285 * t1292 + 0.168e3 * t1289 * t1292 - 0.96e2 * t538 * t1413 * t372 * t141 + 0.48e2 * t544 * t1413 * t372 * t165 - 0.64e2 / 0.3e1 * t555 * t351 * t1212 * t2854 - 0.24e2 * t3525 * t559 - 0.48e2 * t3528 * t559 - 0.3512e4 / 0.9e1 * t555 * t556 * t1040 - 0.48e2 * t3534 * t559 + 0.72e2 * t3537 * t1297;
  t3542 = t1284 * t71;
  t3543 = t299 * t3542;
  t3546 = t1288 * t71;
  t3547 = t299 * t3546;
  t3558 = t849 * t1269;
  t3567 = t294 * t3542;
  t3570 = t294 * t3546;
  t3585 = -0.48e2 * t1270 * t195 * t329 * params->eta * sigma[0] + 0.24e2 * t1276 * t195 * t379 * params->eta * sigma[0] - 0.48e2 * t3558 * t195 * t336 * params->eta * sigma[0] + 0.336e3 * t1270 * t121 * t1272 - 0.168e3 * t1276 * t121 * t1278 - 0.6e1 * t238 * t3206 * t239 - 0.96e2 * t3567 * t1273 - 0.96e2 * t3570 * t1273 + 0.48e2 * t3543 * t1279 + 0.48e2 * t3547 * t1279 - 0.18e2 * t1365 * t552 - 0.18e2 * t549 * t1370;
  t3604 = t2519 * t537;
  t3621 = -0.12e3 * t1295 * t539 * t1380 * t165 - 0.72e2 * t3604 * t539 * t540 * t336 - 0.36e2 * t1145 * t179 * t240 - 0.6e1 * t128 * t821 * t240 - 0.3e1 * t147 * t179 * t1328 - t147 * t821 * t248 - 0.3e1 * t147 * t402 * t584 + 0.3e2 * t238 * t1109 - 0.8e2 * t238 * t1115 + 0.3e2 * t1365 * t199 - 0.36e2 * t1377 * t552 + 0.6e2 * t549 * t440 - 0.8e2 * t549 * t447;
  t3629 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t750 * t251 + t7 * t258 * t587 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t101 * t1418 - 0.3e1 / 0.8e1 * t7 * t20 * (t3287 + t3322 + t3362 + t3459 + t3496 + t3540 + t3585 + t3621));
  tv4rho3tau0 = 0.2e1 * rho[0] * t3629 + 0.6e1 * t1423;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 0] += tv4rho3tau0;

  t3654 = t372 * t29;
  t3662 = t2432 * t1212;
  t3664 = t868 * t115 * t29;
  t3667 = t1011 * sigma[0];
  t3670 = t274 * params->eta;
  t3675 = t3404 * sigma[0];
  t3678 = t121 * t134;
  t3681 = t195 * t317;
  t3685 = t1212 * t115 * t29;
  t3688 = t1015 * sigma[0];
  t3691 = t496 * t273;
  t3694 = -0.19e2 / 0.9e1 * t274 * t64 + 0.43e2 / 0.36e2 * t284 * t71 * t59 - t1212 * t150 * t3654 / 0.12e2 - t3188 * t617 / 0.4e1 - t3199 * t1528 + 0.8e1 / 0.3e1 * t1111 * t1531 - 0.2e1 / 0.3e1 * t3662 * t3664 + 0.43e2 / 0.6e1 * t885 * t3667 - 0.76e2 / 0.9e1 * t309 * t3670 - 0.3e1 / 0.8e1 * t2648 * t620 - 0.2e1 * t3175 * t3675 + 0.4e1 * t1125 * t3678 - 0.3e1 / 0.8e1 * t1125 * t3681 - 0.5e1 / 0.6e1 * t2657 * t3685 + 0.43e2 / 0.6e1 * t892 * t3688 - 0.19e2 / 0.3e1 * t320 * t3691;
  t3720 = t284 * params->eta * sigma[0];
  t3741 = t321 * t134 * sigma[0];
  t3750 = -0.2e1 * t1111 * t121 + 0.19e2 / 0.3e1 * t309 * t274 + 0.3e1 / 0.16e2 * t3188 * t195 + 0.19e2 * t320 * t3670 - 0.215e3 / 0.12e2 * t867 * t3688 + 0.38e2 / 0.3e1 * t352 * t3691 + 0.95e2 / 0.3e1 * t358 * t640 * t273 - 0.43e2 / 0.8e1 * t885 * t3720 + 0.9e1 / 0.8e1 * t2648 * t617 - 0.43e2 / 0.2e1 * t892 * t3667 + 0.9e1 / 0.8e1 * t1086 * t3681 + 0.15e2 / 0.2e1 * t2362 * t3675 + 0.5e1 / 0.2e1 * t2368 * t3685 + 0.15e2 / 0.4e1 * t1053 * t3681 + t3662 * t3654 / 0.2e1 + 0.9e1 / 0.8e1 * t1093 * t557 * t317 + 0.6e1 * t3415 * t3741 + 0.5e1 / 0.2e1 * t3418 * t3664 - 0.301e3 / 0.2e1 * t1032 * t3667 + 0.76e2 * t485 * t3670;
  t3758 = t195 * t306;
  t3776 = t115 * t29;
  t3789 = params->eta * t306;
  t3812 = 0.35e2 / 0.4e1 * t2923 * t1212 * t321 * t3776 - 0.12e3 * t1073 * t121 * t1551 + 0.315e3 / 0.8e1 * t2923 * t496 * t3374 - 0.84e2 * t1032 * t496 * t1066 + 0.45e2 * t2935 * t195 * t3789 + 0.45e2 / 0.4e1 * t1073 * t195 * t2343 + 0.105e3 * t2923 * t1310 * t1060 + 0.28e2 * t2419 * t3408 * t3776 + 0.63e2 / 0.8e1 * t1032 * t496 * t3378 + 0.84e2 * t2419 * t1537 * t1060 + 0.21e2 * t2426 * t2367 * t1212 * t3776;
  t3832 = 0.6e1 * t128 * t230 * t1138 + 0.3e1 * t128 * t402 * t623 + 0.6e1 * t128 * t179 * t1605 + 0.3e1 * t128 * t93 * t3694 + 0.2e1 * t335 * t402 * t627 - 0.2e1 * t147 * t1251 * t218 - t147 * t93 * (t3750 - 0.301e3 / 0.3e1 * t882 * t3688 + 0.133e3 / 0.3e1 * t371 * t3691 - 0.12e2 * t1093 * t443 * t134 + 0.9e1 / 0.4e1 * t2888 * t3758 - 0.12e2 * t1086 * t3678 + 0.45e2 / 0.4e1 * t2828 * t3758 - 0.4e2 * t1053 * t3678 - 0.215e3 / 0.4e1 * t1073 * t3720 + 0.3e1 / 0.4e1 * t3199 * t1521 + 0.3e2 * t2935 * t3404 * t59 + t3812) - 0.4e1 * t147 * t524 * t503 - 0.2e1 * t147 * t179 * t1566 - 0.2e1 * t147 * t230 * t1097 + 0.6e1 * t128 * t1514 * t141 - 0.2e1 * t147 * t1514 * t165;
  t3835 = t503 * t503;
  t3872 = -0.6e1 * t299 * t1516 * t141 - 0.6e1 * t299 * t1567 * t141 + 0.24e2 * t294 * t1583 * t141 + 0.12e2 * t294 * t1586 * t141 + 0.12e2 * t294 * t1606 * t141 - t147 * t402 * t648 + 0.4e1 * t335 * t1516 * t165 + 0.4e1 * t335 * t1567 * t165 - 0.12e2 * t299 * t1583 * t165 - 0.6e1 * t299 * t1586 * t165 - 0.6e1 * t299 * t1606 * t165 + 0.2e1 * t335 * t661 * t336 + 0.4e1 * t335 * t93 * t3835;
  t3884 = t849 * t230;
  t3911 = t141 * t146;
  t3914 = 0.12e2 * t1217 * t648 * t141 * t165 - 0.36e2 * t2984 * t627 * t141 * t165 + 0.24e2 * t1217 * t1218 * t503 - 0.24e2 * t1222 * t3090 * t459 + 0.24e2 * t294 * t1580 * t141 - 0.12e2 * t823 * t1577 * t165 - 0.12e2 * t299 * t1580 * t165 - 0.24e2 * t1689 * t3108 * t503 + 0.6e1 * t294 * t661 * t295 + 0.24e2 * t294 * t436 * t459 + 0.24e2 * t3884 * t1219 - 0.12e2 * t3911 * t1438 + 0.24e2 * t1574 * t1441;
  t3916 = 0.334e4 / 0.4782969e7 * t1191 * t1479;
  t3931 = t823 * t230;
  t3939 = t279 * t1212;
  t3940 = t780 * t785;
  t3943 = t115 * t21 * t225;
  t3959 = 0.152e4 / 0.531441e6 * t417 * t1227 * t35;
  t3963 = 0.175e4 / 0.387420489e9 * t3939 * t814 * t785 * t3943;
  t3970 = 0.532e4 / 0.282429536481e12 * t281 / t19 / t282 / t271 * t2598 * t2602;
  t3973 = t204 * t503;
  t3984 = t459 * t218;
  t3988 = t3916 - 0.6e1 * t299 * t1569 * t165 + 0.6e1 * t1145 * t624 + 0.12e2 * t1145 * t612 - 0.12e2 * t1222 * t623 * t141 * t165 + 0.12e2 * t849 * t612 * t336 - 0.24e2 * t3931 * t1224 + t82 * (-0.152e4 / 0.531441e6 * t417 * t1233 * t35 + 0.86e3 / 0.1594323e7 * t1191 * t1494 - 0.224e4 / 0.1162261467e10 * t3939 * t3940 * t3943 + 0.2128e4 / 0.1162261467e10 * t2559 * t3939 * t2562 * t115 * t2564 - 0.2408e4 / 0.4782969e7 * t782 * t1241 * sigma[0] + 0.152e3 / 0.59049e5 * t655 * t656 * t394 + t3959 - t3916 + t3963 - t3970) - 0.24e2 * t1222 * t3973 * t141 - 0.12e2 * t1222 * t1483 * t329 + 0.24e2 * t3076 * t1487 - 0.24e2 * t3094 * t1484 - 0.24e2 * t1222 * t3984 * t141;
  t4026 = 0.4e1 * t335 * t219 * t1097 + 0.3e1 * t128 * t661 * t329 + 0.8e1 * t335 * t1615 * t165 + 0.12e2 * t294 * t612 * t329 + 0.6e1 * t294 * t624 * t329 - 0.6e1 * t299 * t631 * t329 - 0.6e1 * t299 * t612 * t379 - 0.3e1 * t299 * t624 * t379 + 0.6e1 * t849 * t628 * t329 + 0.4e1 * t335 * t631 * t379 - 0.6e1 * t841 * t628 * t379 - 0.12e2 * t3115 * t609;
  t4045 = t459 * t459;
  t4067 = -0.6e1 * t299 * t205 * t1097 - 0.12e2 * t299 * t1105 * t218 - 0.6e1 * t299 * t1139 * t218 - 0.6e1 * t299 * t1142 * t218 + 0.12e2 * t849 * t1609 * t141 - 0.12e2 * t299 * t1612 * t141 - 0.12e2 * t299 * t1615 * t141 - 0.12e2 * t841 * t1609 * t165 + 0.8e1 * t335 * t1612 * t165 + 0.12e2 * t294 * t93 * t4045 - 0.12e2 * t299 * t436 * t503 - 0.12e2 * t299 * t460 * t503 + 0.8e1 * t335 * t469 * t503;
  t4080 = t329 * t81;
  t4103 = 0.12e2 * t294 * t205 * t1138 + 0.12e2 * t1217 * t1483 * t379 + 0.24e2 * t1217 * t3973 * t165 + 0.6e1 * t128 * t1251 * t204 + 0.12e2 * t128 * t524 * t459 - t147 * t661 * t379 - 0.36e2 * t2984 * t1483 * t336 + 0.6e1 * t294 * t402 * t605 + 0.2e1 * t335 * t649 * t379 - 0.6e1 * t823 * t606 * t379 + 0.12e2 * t1574 * t1577 + 0.6e1 * t4080 * t606 - t3959;
  t4137 = 0.24e2 * t1217 * t3984 * t165 + 0.48e2 * t3067 * t1483 * t2615 + 0.12e2 * t2519 * t628 * t295 + 0.12e2 * t2519 * t606 * t336 + 0.24e2 * t2621 * t628 * t336 - 0.12e2 * t823 * t631 * t295 - 0.6e1 * t823 * t649 * t295 - 0.3e1 * t299 * t649 * t329 + 0.6e1 * t849 * t624 * t336 - 0.12e2 * t841 * t631 * t336 - 0.6e1 * t841 * t649 * t336 - t3963 + t3970;
  t4145 = my_piecewise3(t3, 0, t7 * t258 * t663 / 0.12e2 - t7 * t101 * t1619 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * (t3832 + t3872 + t3914 + t3988 + t4026 + t4067 + t4103 + t4137));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t4145 + 0.4e1 * t1624;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigmalapl0 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 0] += tv4rho2sigmalapl0;

  t4169 = t195 * t218;
  t4176 = t195 * t204;
  t4189 = -0.3e1 * t299 * t249 * t1138 - t147 * t1251 * t248 + 0.32e2 * t3340 * t4169 * t1272 + 0.32e2 * t3340 * t4176 * t1278 - 0.32e2 * t3558 * t4169 * t1278 - 0.3e1 * t299 * t1329 * t204 - 0.6e1 * t299 * t1331 * t204 - 0.2e1 * t147 * t179 * t1815 - 0.2e1 * t147 * t524 * t584 - 0.6e1 * t299 * t570 * t459 - 0.6e1 * t299 * t585 * t459;
  t4217 = t299 * t179;
  t4222 = -0.3e1 * t299 * t1282 * t204 - 0.6e1 * t299 * t1786 * t141 - 0.6e1 * t299 * t1816 * t141 + 0.4e1 * t335 * t1784 * t165 + 0.4e1 * t335 * t1786 * t165 + 0.4e1 * t335 * t1816 * t165 - 0.3e1 * t299 * t709 * t329 + 0.2e1 * t335 * t696 * t379 + 0.2e1 * t335 * t709 * t379 - 0.3e1 * t4217 * t1703 + 0.4e1 * t549 * t1707;
  t4229 = t64 * t329;
  t4243 = t64 * t379;
  t4255 = 0.24e2 * t3067 * t1678 * t2615 - 0.6e1 * t677 * t1370 + 0.3e1 * t717 * t682 * t4229 + 0.6e1 * t1858 * t1698 - 0.6e1 * t128 * t1251 * t240 - 0.12e2 * t1710 * t552 - 0.36e2 * t2984 * t1685 * t2615 - 0.3e1 / 0.2e1 * t1701 * t682 * t4243 - 0.26e2 * t717 * t195 * t1697 - 0.74e2 / 0.3e1 * t238 * t1592 + 0.4e1 * t335 * t1782 * t165;
  t4292 = 0.2e1 * t335 * t249 * t1097 + 0.2e1 * t335 * t1282 * t218 + 0.2e1 * t335 * t1329 * t218 + 0.4e1 * t335 * t1331 * t218 - 0.6e1 * t299 * t1782 * t141 - 0.6e1 * t299 * t1784 * t141 - 0.6e1 * t823 * t709 * t295 - 0.3e1 * t299 * t696 * t329 + 0.4e1 * t335 * t570 * t503 + 0.4e1 * t335 * t585 * t503 - 0.6e1 * t841 * t696 * t336 - 0.6e1 * t841 * t709 * t336;
  t4302 = t537 * t64;
  t4303 = t2519 * t4302;
  t4331 = -0.32e2 * t1270 * t195 * t459 * params->eta * sigma[0] + 0.16e2 * t1276 * t195 * t503 * params->eta * sigma[0] - 0.12e2 * t3340 * t682 * t1271 * t165 + 0.112e3 * t1270 * t121 * t1773 - 0.56e2 * t1276 * t121 * t1778 - 0.48e2 * t4303 * t239 * t1219 - 0.32e2 * t1574 * t1269 * t1774 - 0.32e2 * t3567 * t1774 - 0.32e2 * t3570 * t1774 + 0.16e2 * t3543 * t1779 + 0.16e2 * t3547 * t1779;
  t4332 = t1653 * t71;
  t4333 = t294 * t4332;
  t4336 = t299 * t4332;
  t4349 = t2432 * t1509;
  t4358 = t2361 * t1509;
  t4367 = 0.37e2 * t1522 + 0.74e2 * t1529 - 0.52e2 * t1532 - 0.52e3 / 0.3e1 * t1549 - 0.9e2 * t2828 * t682 * t306 - 0.4e1 * t4349 * t3654 - 0.9e1 / 0.2e1 * t1093 * t686 * t317 - 0.24e2 * t2432 * t600 * t3741 - 0.1e2 * t4358 * t3664 - 0.3e2 * t1053 * t682 * t317 + 0.37e3 * t1546 + 0.518e3 * t1555 - 0.208e3 * t1557;
  t4378 = t1509 * t321;
  t4388 = t1509 * t868;
  t4400 = 0.39e2 * t1526 + 0.26e3 * t1544 - 0.6e1 * t3199 * t1791 - 0.9e1 / 0.2e1 * t2648 * t700 - 0.24e3 * t2935 * t600 * t134 * t59 - 0.7e2 * t2923 * t4378 * t3776 - 0.45e2 * t1073 * t682 * t2343 - 0.42e3 * t2923 * t1798 * t1060 - 0.112e3 * t2419 * t4388 * t3776 - 0.18e3 * t2935 * t682 * t3789 - 0.3e1 / 0.2e1 * t3188 * t682 + 0.39e3 * t1553 + 0.13e2 * t1518 - 0.104e3 / 0.3e1 * t1524;
  t4409 = t584 * t218;
  t4413 = t248 * t503;
  t4421 = t584 * t204;
  t4425 = -0.32e2 * t4333 * t1273 + 0.16e2 * t4336 * t1279 - 0.6e1 * t823 * t696 * t295 - t147 * t93 * (t4367 + t4400) + 0.6e1 * t1217 * t1685 * t329 + 0.12e2 * t3076 * t1686 + 0.12e2 * t1217 * t4409 * t141 + 0.12e2 * t1217 * t4413 * t141 + 0.3e1 * t1377 * t683 - 0.13e2 * t549 * t615 + 0.12e2 * t1217 * t4421 * t165;
  t4427 = t248 * t459;
  t4454 = t2621 * t93;
  t4458 = 0.12e2 * t1217 * t4427 * t165 + 0.6e1 * t1217 * t1678 * t379 - 0.12e2 * t1222 * t4427 * t141 - 0.6e1 * t1222 * t1678 * t329 + 0.12e2 * t3076 * t1682 - 0.12e2 * t3094 * t1679 - 0.12e2 * t1222 * t4421 * t141 - 0.18e2 * t2984 * t1678 * t336 + 0.3e1 / 0.2e1 * t1365 * t683 + 0.104e3 / 0.3e1 * t238 * t1589 + 0.24e2 * t4454 * t1685 * t336;
  t4465 = t64 * t336;
  t4469 = t3911 * t537;
  t4498 = 0.24e2 * t1295 * t539 * t1742 * t165 + 0.12e2 * t1295 * t539 * t669 * t379 + 0.4e2 * t1384 * t539 * t1765 * t165 + 0.6e1 * t1384 * t556 * t686 * t336 - 0.52e2 * t538 * t556 * t557 * t141 + 0.3e1 * t1217 * t682 * t4465 + 0.12e2 * t3067 * t1685 * t295 + 0.13e2 * t1701 * t195 * t1702 + 0.56e2 * t1654 * t1292 + 0.24e2 * t3493 * t1666 + 0.24e2 * t3537 * t1666 + 0.24e2 * t4469 * t1666;
  t4540 = -0.4e2 * t1295 * t539 * t1765 * t141 - 0.4e2 * t1295 * t539 * t1761 * t165 + 0.12e2 * t1295 * t539 * t673 * t329 - 0.24e2 * t1384 * t539 * t1751 * t165 - 0.12e2 * t1384 * t539 * t673 * t379 + 0.26e2 * t544 * t556 * t557 * t165 + 0.36e2 * t3363 * t539 * t673 * t336 - 0.24e2 * t3604 * t539 * t669 * t336 + 0.12e2 * t1393 * t1658 - 0.24e2 * t3275 * t1675 - 0.24e2 * t3280 * t1675;
  t4547 = t321 * t141;
  t4552 = t524 * t54;
  t4553 = t128 * t4552;
  t4556 = t230 * t134;
  t4557 = t128 * t4556;
  t4560 = t823 * t1653;
  t4563 = t204 * t321;
  t4568 = t218 * t321;
  t4581 = -0.32e2 * t538 * t1413 * t4563 * t115 + 0.16e2 * t544 * t1413 * t4568 * t115 + 0.8e1 * t555 * t351 * t1509 * t3664 + 0.24e2 * t538 * t1730 * t4547 * sigma[0] + 0.6e1 * t538 * t556 * t686 * t329 + 0.24e2 * t4560 * t1297 + 0.12e2 * t1396 * t1658 - 0.6e1 * t1403 * t1662 - 0.6e1 * t1406 * t1662 - 0.16e2 * t4553 * t559 - 0.16e2 * t4557 * t559;
  t4587 = t321 * t165;
  t4617 = -0.3e1 * t544 * t556 * t686 * t379 - 0.12e2 * t544 * t1730 * t4587 * sigma[0] + 0.24e2 * t3537 * t1671 + 0.24e2 * t3493 * t1671 + 0.24e2 * t1295 * t539 * t1751 * t141 - 0.16e3 / 0.3e1 * t538 * t539 * t107 * t204 + 0.12e2 * t3304 * t674 + 0.6e1 * t3534 * t687 + 0.8e2 / 0.3e1 * t544 * t539 * t107 * t218 - 0.2e2 * t1758 * t1390 + 0.208e3 / 0.3e1 * t555 * t556 * t443;
  t4635 = t849 * t1653;
  t4646 = -0.6e1 * t3115 * t690 + 0.2e2 * t677 * t440 + 0.2e2 * t1710 * t199 - 0.8e2 / 0.3e1 * t677 * t447 - 0.12e2 * t1145 * t230 * t240 - t147 * t230 * t1328 - t147 * t402 * t708 + 0.4e2 * t1755 * t1381 - 0.12e2 * t4635 * t1386 + 0.4e2 * t538 * t539 * t33 * t459 - 0.2e2 * t1403 * t1766 - 0.2e2 * t1406 * t1766;
  t4659 = t93 * t28;
  t4660 = t823 * t4659;
  t4661 = t681 * t64;
  t4665 = t93 * t600;
  t4666 = t299 * t4665;
  t4668 = t71 * t165 * t59;
  t4671 = t294 * t4665;
  t4674 = t71 * params->eta * sigma[0] * t141;
  t4679 = t150 * t321;
  t4680 = t4679 * t3776;
  t4683 = t299 * t4552;
  t4686 = t294 * t4556;
  t4689 = t299 * t4556;
  t4692 = 0.2e1 * t128 * t93 * t1509 * t4680 - 0.2e2 * t544 * t539 * t33 * t503 - 0.6e1 * t4660 * t4661 * t2615 - 0.26e2 * t1285 * t1769 - 0.26e2 * t1289 * t1769 - 0.16e2 * t1654 * t1414 - 0.4e1 * t4666 * t4668 + 0.8e1 * t4671 * t4674 + 0.12e2 * t4683 * t546 - 0.24e2 * t4686 * t541 + 0.12e2 * t4689 * t546;
  t4719 = 0.6e1 * t544 * t539 * t49 * t1097 - 0.74e2 * t555 * t1413 * t1731 - 0.12e2 * t4080 * t537 * t670 + 0.12e2 * t1285 * t1732 + 0.12e2 * t1289 * t1732 + 0.4e2 * t1393 * t1762 + 0.4e2 * t1396 * t1762 + 0.4e2 * t1735 * t1762 + 0.3e1 * t3265 * t687 + 0.3e1 * t3525 * t687 + 0.6e1 * t3528 * t687;
  t4724 = t294 * t4552;
  t4745 = -0.24e2 * t1574 * t1284 * t670 - 0.24e2 * t1393 * t1743 + 0.12e2 * t1403 * t1752 + 0.12e2 * t1406 * t1752 - 0.24e2 * t1735 * t1743 - 0.12e2 * t3308 * t670 - 0.24e2 * t3312 * t670 + 0.6e1 * t3347 * t674 + 0.6e1 * t3356 * t674 + 0.12e2 * t3359 * t674 - 0.24e2 * t4724 * t541;
  t4779 = -0.12e2 * t538 * t539 * t49 * t1138 + 0.12e2 * t1217 * t708 * t141 * t165 - 0.24e2 * t1574 * t1288 * t670 - 0.12e2 * t1689 * t4409 * t165 - 0.12e2 * t1689 * t4413 * t165 - 0.6e1 * t1689 * t1685 * t379 - 0.12e2 * t841 * t179 * t1690 + 0.12e2 * t3884 * t1360 - 0.24e2 * t1396 * t1743 - 0.12e2 * t1755 * t1400 + 0.6e1 * t1758 * t1410 - 0.12e2 * t3317 * t670;
  t4788 = my_piecewise3(t3, 0, t7 * t258 * t711 / 0.12e2 - t7 * t101 * t1820 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * (t4189 + t4222 + t4255 + t4292 + t4331 + t4425 + t4458 + t4498 + t4540 + t4581 + t4617 + t4646 + t4692 + t4719 + t4745 + t4779));
  tv4rho2sigmatau0 = 0.2e1 * rho[0] * t4788 + 0.4e1 * t1825;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 0] += tv4rho2sigmatau0;

  tv4rho2lapl20 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 0] += tv4rho2lapl20;

  tv4rho2lapltau0 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 0] += tv4rho2lapltau0;

  t4829 = 0.2e1 * t335 * t741 * t379 + 0.4e1 * t335 * t1865 * t165 + 0.4e1 * t335 * t1881 * t165 - 0.3e1 * t299 * t741 * t329 - 0.6e1 * t299 * t1865 * t141 - 0.6e1 * t299 * t1881 * t141 + 0.4e1 * t335 * t249 * t1328 - 0.6e1 * t841 * t732 * t379 + 0.8e1 * t335 * t570 * t584 - 0.12e2 * t841 * t1862 * t165 - 0.52e3 / 0.3e1 * t1651;
  t4847 = t2432 * t1945;
  t4863 = t1945 * t321;
  t4869 = 0.12e2 * t3188 * t720 + 0.48e2 * t3199 * t1870 - 0.8e2 * t1788 + 0.32e2 * t4847 * t3654 - 0.248e3 * t1792 + 0.52e3 / 0.3e1 * t634 + 0.72e3 * t2828 * t720 * t306 + 0.192e4 * t2935 * t1850 * t134 * t59 - 0.16e4 * t1804 + 0.24e3 * t1053 * t720 * t317 + 0.56e3 * t2923 * t4863 * t3776 - 0.248e4 * t1806 + 0.26e4 / 0.3e1 * t642;
  t4879 = t584 * t584;
  t4891 = 0.12e2 * t849 * t1862 * t141 - 0.2e1 * t147 * t179 * t1880 - t147 * t402 * t740 - t147 * t93 * t4869 + 0.12e2 * t2519 * t732 * t295 + 0.24e2 * t2621 * t732 * t336 - 0.6e1 * t823 * t741 * t295 + 0.6e1 * t849 * t732 * t329 + 0.2e1 * t335 * t402 * t731 + 0.4e1 * t335 * t93 * t4879 - 0.6e1 * t841 * t741 * t336 + 0.8e2 * t1693;
  t4911 = t93 * t1850;
  t4912 = t299 * t4911;
  t4916 = t128 * t93 * t1945;
  t4923 = 0.16e3 * t1699 - 0.8e2 * t1704 + 0.496e3 / 0.3e1 * t1708 - 0.112e3 * t1276 * t121 * t1928 + 0.32e2 * t3543 * t1929 + 0.32e2 * t3547 * t1929 + 0.32e2 * t1276 * t195 * t584 * params->eta * sigma[0] - 0.96e2 * t4303 * t239 * t1360 + 0.32e2 * t4912 * t4668 - 0.16e2 * t4916 * t4680 - 0.4e2 * t1403 * t1885 - 0.4e2 * t1406 * t1885;
  t4928 = t3911 * t1888;
  t4940 = t179 * t55;
  t4941 = t823 * t4940;
  t4949 = t719 * t64;
  t4953 = t294 * t4911;
  t4964 = 0.32e3 * t1902 * t1903 * t681 * t165 - 0.48e2 * t1902 * t1903 * t719 * t379 + 0.96e2 * t538 * t1903 * t719 * t317 - 0.4e2 * t544 * t539 * t33 * t584 + 0.256e3 * t1574 * t1888 * t1891 + 0.256e3 * t294 * t4940 * t1891 + 0.48e2 * t4660 * t4949 * t2615 + 0.192e3 * t1393 * t1909 + 0.192e3 * t1735 * t1909 - 0.96e2 * t4928 * t1905 - 0.96e2 * t4941 * t1905 - 0.64e2 * t4953 * t4674;
  t5001 = -0.64e3 * t538 * t1903 * t681 * t134 - 0.3968e4 / 0.3e1 * t1889 * t351 * t600 * t59 + 0.12e2 * t3356 * t725 + 0.24e2 * t3359 * t725 + 0.24e2 * t1403 * t1899 + 0.12e2 * t3347 * t725 + 0.24e2 * t1406 * t1899 + 0.12e2 * t544 * t539 * t49 * t1328 - 0.192e3 * t1295 * t1903 * t1904 * t134 + 0.48e2 * t3537 * t1834 + 0.48e2 * t3493 * t1834 + 0.48e2 * t1295 * t539 * t1898 * t141;
  t5033 = t248 * t321;
  t5042 = t78 * t1945;
  t5046 = 0.24e2 * t1295 * t539 * t724 * t329 - 0.48e2 * t3275 * t1838 - 0.48e2 * t3280 * t1838 - 0.48e2 * t1384 * t539 * t1898 * t165 - 0.24e2 * t1384 * t539 * t724 * t379 - 0.256e3 * t1902 * t1890 * t1278 - 0.8e2 * t1295 * t539 * t1884 * t141 + 0.72e2 * t3363 * t539 * t724 * t336 + 0.8e2 * t1384 * t539 * t1884 * t165 + 0.32e2 * t544 * t1413 * t5033 * t115 + 0.512e3 * t538 * t1890 * t59 * t134 + 0.64e3 / 0.3e1 * t1889 * t5042 * t3654;
  t5052 = t2519 * t1888;
  t5080 = 0.16e3 / 0.3e1 * t544 * t539 * t107 * t248 + 0.96e2 * t5052 * t1903 * t719 * t336 + 0.24e2 * t3304 * t725 - 0.24e2 * t1377 * t728 - 0.32e3 * t1855 * t1841 - 0.24e2 * t1217 * t720 * t4465 - 0.32e3 * t1858 * t1841 + 0.208e4 / 0.3e1 * t717 * t320 * t195 - 0.48e2 * t1858 * t1844 + 0.24e2 * t4217 * t1847 - 0.32e2 * t549 * t1852 + 0.96e2 * t717 * t2648 * t720;
  t5112 = t195 * t248;
  t5119 = 0.12e2 * t1217 * t740 * t141 * t165 - 0.36e2 * t2984 * t731 * t141 * t165 + 0.24e2 * t1217 * t1359 * t584 + 0.64e2 * t3340 * t5112 * t1272 - 0.64e2 * t3558 * t5112 * t1278 + 0.96e2 * t1574 * t179 * t721 - 0.24e2 * t1689 * t3250 * t584 + 0.12e2 * t1701 * t720 * t4243 + 0.48e2 * t294 * t402 * t721 + 0.48e2 * t4080 * t93 * t721 - 0.24e2 * t717 * t720 * t4229 - 0.12e2 * t1365 * t728;
  t5127 = my_piecewise3(t3, 0, t7 * t258 * t743 / 0.12e2 - t7 * t101 * t1933 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * (t4829 + t4891 + t4923 + t4964 + t5001 + t5046 + t5080 + t5119));
  tv4rho2tau20 = 0.2e1 * rho[0] * t5127 + 0.4e1 * t1938;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 0] += tv4rho2tau20;

  t5146 = t1982 * t146;
  t5155 = t1509 * t150;
  t5156 = t59 * t29;
  t5161 = t1731 * t29;
  t5166 = t1798 * t134;
  t5170 = t868 * sigma[0] * t29;
  t5175 = t1999 * t134;
  t5179 = t1509 * sigma[0] * t29;
  t5184 = 0.3e1 / 0.8e1 * t1591 - 0.3e1 / 0.64e2 * t5155 * t5156 - 0.27e2 / 0.64e2 * t3199 * t1790 - 0.9e1 / 0.16e2 * t4349 * t5161 + 0.27e2 / 0.8e1 * t885 * t1520 - 0.27e2 / 0.16e2 * t2432 * t5166 - 0.45e2 / 0.32e2 * t4358 * t5170 + 0.27e2 / 0.4e1 * t892 * t1310 - 0.45e2 / 0.32e2 * t2361 * t5175 - 0.15e2 / 0.16e2 * t2368 * t5179 + 0.15e2 / 0.4e1 * t867 * t1537;
  t5223 = -0.45e2 / 0.16e2 * t2320 * t2022 * t134 - 0.15e2 / 0.8e1 * t2935 * t1509 * params->eta * t51 + 0.15e2 / 0.2e1 * t873 * t78 * t425 - 0.135e3 / 0.8e1 * t2935 * t1790 * t134 - 0.315e3 / 0.32e2 * t2923 * t4378 * t51 + 0.135e3 / 0.4e1 * t358 * t160 * t425 * params->eta - 0.945e3 / 0.32e2 * t2923 * t5166 - 0.63e2 / 0.4e1 * t2419 * t4388 * t51 + 0.189e3 / 0.4e1 * t155 * t370 * t425 * t321 - 0.63e2 / 0.4e1 * t2419 * t5175 - 0.63e2 / 0.8e1 * t2426 * t2367 * t1509 * t51 + 0.21e2 * t75 * t2033 * t425;
  t5276 = 0.9e1 * t128 * t661 * t459 + 0.18e2 * t1574 * t1986 + 0.18e2 * t294 * t524 * t605 + 0.9e1 * t128 * t1514 * t204 + 0.18e2 * t2071 * t460 - 0.6e1 * t5146 * t166 - t147 * t1958 * t165 - 0.6e1 * t841 * t179 * t1975 - t147 * t93 * (t5184 + t5223) + 0.3e1 * t128 * t1958 * t141 - t147 * t179 * t2037 - 0.3e1 * t147 * t230 * t1566 - 0.3e1 * t147 * t524 * t648 - 0.3e1 * t147 * t661 * t503 + 0.6e1 * t335 * t524 * t627 - 0.3e1 * t147 * t1514 * t218 + 0.3e1 * t128 * t179 * t2002 + 0.3e1 * t128 * t93 * (-0.3e1 / 0.4e1 * t1591 * params->eta + 0.3e1 / 0.32e2 * t5155 * t5161 + 0.9e1 / 0.32e2 * t3199 * t1798 + 0.3e1 / 0.8e1 * t4349 * t5170 - 0.9e1 / 0.4e1 * t885 * t1310 + 0.3e1 / 0.8e1 * t2432 * t5175 + 0.5e1 / 0.16e2 * t2657 * t5179 - 0.3e1 / 0.2e1 * t892 * t1537) + 0.9e1 * t128 * t524 * t623 + 0.9e1 * t128 * t230 * t1605;
  t5288 = 0.49e3 / 0.387420489e9 * t599 * t1510 * t818;
  t5294 = 0.665e3 / 0.94143178827e11 * t423 / t19 / t2369 * t2598 * t2602;
  t5295 = t204 * t627;
  t5305 = t218 * t648;
  t5312 = t204 * t648;
  t5316 = t623 * t218;
  t5344 = -0.18e2 * t841 * t2006 * t165 + 0.12e2 * t335 * t631 * t503 + 0.18e2 * t849 * t2006 * t141 + t5288 - t5294 + 0.36e2 * t3067 * t5295 * t141 - 0.54e2 * t2984 * t5295 * t165 + 0.36e2 * t1217 * t1483 * t503 + 0.18e2 * t1217 * t5305 * t141 - 0.18e2 * t1689 * t5305 * t165 + 0.18e2 * t1217 * t5312 * t165 - 0.18e2 * t1222 * t5316 * t141 + 0.18e2 * t1217 * t5316 * t165 - 0.18e2 * t1222 * t5312 * t141 - 0.36e2 * t3931 * t1484 + 0.36e2 * t3884 * t1487 + 0.36e2 * t3067 * t605 * t218 * t165 - 0.36e2 * t1222 * t1483 * t459 - 0.18e2 * t1222 * t204 * t623 * t165 + 0.18e2 * t849 * t460 * t627;
  t5406 = -0.18e2 * t2477 * t1976 * t141 + 0.18e2 * t294 * t1989 * t141 + 0.18e2 * t294 * t1992 * t141 + 0.6e1 * t294 * t2003 * t141 - 0.9e1 * t299 * t205 * t1566 + 0.6e1 * t335 * t219 * t1566 - 0.9e1 * t299 * t1606 * t218 + 0.24e2 * t2621 * t1976 * t165 - 0.18e2 * t823 * t1986 * t165 - 0.9e1 * t299 * t1989 * t165 - 0.9e1 * t299 * t1992 * t165 - 0.3e1 * t299 * t2003 * t165 + 0.36e2 * t294 * t612 * t459 - 0.9e1 * t299 * t436 * t648 - 0.9e1 * t299 * t460 * t648 - 0.9e1 * t299 * t624 * t503 + 0.6e1 * t335 * t469 * t648 + 0.6e1 * t335 * t504 * t648 + 0.18e2 * t849 * t436 * t627 - 0.18e2 * t841 * t628 * t503;
  t5414 = 0.2e2 / 0.177147e6 * t1477 * t1478;
  t5451 = t279 * t1509;
  t5457 = t2562 * t21;
  t5479 = -0.9e1 * t299 * t1586 * t218 - 0.18e2 * t299 * t612 * t503 - t5414 - 0.18e2 * t299 * t1583 * t218 + 0.18e2 * t294 * t205 * t1605 - 0.18e2 * t299 * t1580 * t218 + 0.18e2 * t294 * t460 * t623 + 0.18e2 * t1574 * t1963 + 0.18e2 * t294 * t436 * t623 - 0.18e2 * t823 * t606 * t503 - 0.18e2 * t823 * t1577 * t218 - 0.18e2 * t3911 * t1960 + 0.2e1 * t335 * t2038 * t165 - 0.3e1 * t299 * t2038 * t141 + 0.6e1 * t335 * t2012 * t165 + t82 * (-0.2e2 / 0.177147e6 * t1477 * t1493 + 0.28e3 / 0.387420489e9 * t5451 * t3940 * t26 * t51 - 0.266e3 / 0.387420489e9 * t2559 * t5451 * t5457 * t25 * sigma[0] * t29 + 0.56e2 / 0.531441e6 * t781 * t1477 * t785 + t5414 - t5288 + t5294) + 0.6e1 * t1983 * t179 - 0.9e1 * t299 * t2009 * t141 + 0.6e1 * t335 * t2009 * t165 - 0.9e1 * t299 * t2012 * t141;
  t5486 = my_piecewise3(t3, 0, -t7 * t101 * t2040 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * (t5276 + t5344 + t5406 + t5479));
  tv4rhosigma30 = 0.2e1 * rho[0] * t5486 + 0.2e1 * t2044;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma2lapl0 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 0] += tv4rhosigma2lapl0;

  t5500 = t299 * t230;
  t5532 = t64 * t503;
  t5543 = t64 * t459;
  t5547 = 0.2e1 * t335 * t570 * t648 + 0.2e1 * t335 * t585 * t648 + 0.6e1 * t2169 * t1698 - 0.3e1 * t5500 * t1703 + 0.2e1 * t335 * t249 * t1566 - 0.6e1 * t3911 * t2136 - 0.12e2 * t2071 * t179 * t240 - 0.12e2 * t2072 * t552 - 0.3e1 * t717 * t1851 * t1271 + 0.3e1 / 0.2e1 * t1701 * t1851 * t1277 + 0.24e2 * t3067 * t1678 * t1218 - 0.36e2 * t2984 * t1678 * t3108 - 0.6e1 * t2097 * t552 - 0.9e1 / 0.4e1 * t549 * t2100 - 0.9e1 / 0.4e1 * t238 * t3199 * t2052 - 0.3e1 * t1701 * t682 * t5532 - 0.6e1 * t128 * t1514 * t240 + 0.6e1 * t1855 * t2090 + 0.6e1 * t1858 * t2090 + 0.6e1 * t717 * t682 * t5543;
  t5569 = t1945 * t150;
  t5577 = t2052 * t134;
  t5587 = t1945 * params->eta;
  t5601 = t1945 * t868;
  t5606 = -0.21e2 / 0.8e1 * t1706 + 0.3e1 / 0.8e1 * t5569 * t5156 + 0.9e1 / 0.4e1 * t3199 * t1869 + 0.3e1 * t4847 * t5161 - 0.63e2 / 0.4e1 * t2016 + 0.9e1 / 0.2e1 * t2432 * t5577 + 0.15e2 / 0.4e1 * t2361 * t1945 * t5170 - 0.63e2 / 0.4e1 * t2018 + 0.45e2 / 0.2e1 * t2320 * t2055 * t134 + 0.15e2 * t2935 * t5587 * t51 - 0.105e3 / 0.2e1 * t2023 + 0.9e2 * t2935 * t1869 * t134 + 0.105e3 / 0.2e1 * t2923 * t4863 * t51 - 0.315e3 / 0.2e1 * t2027 + 0.315e3 / 0.4e1 * t2923 * t5577 + 0.42e2 * t2419 * t5601 * t51 - 0.441e3 / 0.4e1 * t2031;
  t5644 = -0.3e1 * t4217 * t2094 - 0.3e1 * t299 * t570 * t623 - 0.3e1 * t299 * t585 * t623 - 0.6e1 * t299 * t1816 * t204 - 0.6e1 * t299 * t709 * t459 - 0.6e1 * t299 * t696 * t459 - 0.6e1 * t299 * t1786 * t204 - t147 * t93 * t5606 - 0.6e1 * t299 * t1782 * t204 - 0.6e1 * t299 * t1784 * t204 - 0.3e1 * t299 * t2067 * t141 + 0.2e1 * t335 * t2067 * t165 + 0.2e1 * t335 * t2069 * t165 - 0.6e1 * t299 * t2046 * t141 + 0.4e1 * t335 * t2046 * t165 + 0.13e2 * t1701 * t195 * t2093 + 0.4e1 * t677 * t1707 - 0.26e2 * t717 * t195 * t2089 + 0.2e2 * t538 * t539 * t33 * t623 - 0.2e2 * t1758 * t1766;
  t5667 = t661 * t54;
  t5668 = t299 * t5667;
  t5679 = t4679 * t51;
  t5686 = t71 * t204 * t59;
  t5692 = t849 * t4659;
  t5697 = t71 * t218 * t59;
  t5700 = t294 * t5667;
  t5706 = -0.26e2 * t1654 * t1769 + 0.2e2 * t1384 * t539 * t33 * t627 + 0.4e2 * t1755 * t1762 - 0.1e2 * t544 * t539 * t33 * t648 - 0.6e1 * t823 * t570 * t605 - 0.6e1 * t823 * t585 * t605 - 0.6e1 * t841 * t570 * t627 + 0.6e1 * t5668 * t546 + 0.12e2 * t4689 * t674 + 0.12e2 * t1758 * t1752 + 0.6e1 * t1403 * t2121 + 0.6e1 * t1406 * t2121 - 0.3e1 / 0.2e1 * t4916 * t5679 - 0.6e1 * t4660 * t4661 * t3090 + 0.8e1 * t4671 * t5686 - 0.6e1 * t4660 * t4661 * t1218 + 0.6e1 * t5692 * t4661 * t3108 - 0.4e1 * t4666 * t5697 - 0.12e2 * t5700 * t541 - 0.24e2 * t1574 * t1653 * t670;
  t5733 = t150 * t1850;
  t5740 = t2161 * t537;
  t5744 = t605 * t146 * t537;
  t5758 = -0.24e2 * t4724 * t670 - 0.24e2 * t4686 * t670 - 0.24e2 * t1755 * t1743 - 0.12e2 * t1735 * t2115 - 0.12e2 * t1393 * t2115 - 0.12e2 * t1396 * t2115 - 0.12e2 * t538 * t539 * t49 * t1605 + 0.12e2 * t4683 * t674 + 0.6e1 * t4557 * t687 + 0.12e2 * t1654 * t1732 - 0.12e2 * t3275 * t2127 - 0.12e2 * t3280 * t2127 - 0.9e1 / 0.2e1 * t538 * t5733 * t4547 + 0.9e1 / 0.4e1 * t544 * t5733 * t4587 - 0.24e2 * t5740 * t1743 + 0.12e2 * t5744 * t546 + 0.6e1 * t544 * t539 * t49 * t1566 + 0.6e1 * t4553 * t687 - t147 * t179 * t2066 - 0.2e1 * t147 * t230 * t1815;
  t5804 = t128 * t5667;
  t5811 = t2071 * t537;
  t5824 = -0.2e1 * t147 * t524 * t708 - t147 * t661 * t584 - t147 * t1514 * t248 - 0.48e2 * t4303 * t239 * t1487 - 0.32e2 * t4333 * t1774 - 0.16e2 * t1270 * t195 * t623 * params->eta * sigma[0] + 0.16e2 * t4336 * t1779 + 0.8e1 * t1276 * t195 * t648 * params->eta * sigma[0] - 0.12e2 * t3340 * t682 * t1772 * t165 - 0.16e2 * t3558 * t195 * t627 * params->eta * sigma[0] - 0.12e2 * t3340 * t682 * t1777 * t141 + 0.12e2 * t3558 * t682 * t1777 * t165 - 0.6e1 * t1406 * t2082 - 0.8e1 * t5804 * t559 - 0.3e1 * t555 * t351 * t1945 * t5170 - 0.16e2 * t5811 * t559 + 0.24e2 * t4560 * t1666 + 0.12e2 * t1295 * t539 * t2114 * t165 + 0.24e2 * t4560 * t1671 - 0.24e2 * t4635 * t1675;
  t5891 = 0.12e2 * t1755 * t1658 - 0.6e1 * t1758 * t1662 + 0.12e2 * t1735 * t2077 + 0.12e2 * t1393 * t2077 + 0.12e2 * t1396 * t2077 + 0.12e2 * t538 * t556 * t681 * t459 * params->eta + 0.24e2 * t538 * t1730 * t4563 * sigma[0] - 0.24e2 * t3604 * t539 * t2126 * t141 + 0.36e2 * t3363 * t539 * t2126 * t165 - 0.24e2 * t1384 * t539 * t673 * t503 - 0.6e1 * t1403 * t2082 - 0.52e2 * t538 * t556 * t194 * t204 * params->eta + 0.26e2 * t544 * t556 * t194 * t218 * params->eta - 0.4e2 * t1295 * t539 * t1761 * t218 - 0.6e1 * t544 * t556 * t681 * t503 * params->eta - 0.12e2 * t544 * t1730 * t4568 * sigma[0] + 0.24e2 * t4469 * t2086 + 0.24e2 * t3537 * t2086 + 0.24e2 * t3493 * t2086 + 0.24e2 * t1295 * t539 * t1742 * t218;
  t5934 = t248 * t605;
  t5941 = t708 * t218;
  t5945 = t248 * t648;
  t5955 = 0.24e2 * t1295 * t539 * t669 * t503 + 0.12e2 * t1295 * t539 * t2120 * t141 - 0.12e2 * t1384 * t539 * t2120 * t165 + 0.4e1 * t335 * t709 * t503 + 0.4e1 * t335 * t1786 * t218 + 0.4e1 * t335 * t1816 * t218 + 0.4e1 * t335 * t1784 * t218 + 0.4e1 * t335 * t696 * t503 + 0.4e1 * t335 * t1782 * t218 - 0.3e1 * t299 * t249 * t1605 + 0.1e2 * t2097 * t199 + 0.63e2 / 0.4e1 * t238 * t1997 + 0.2e2 * t2072 * t199 - 0.3e1 / 0.2e1 * t549 * t2108 + 0.12e2 * t3067 * t5934 * t165 - 0.12e2 * t1222 * t1678 * t459 - 0.12e2 * t1689 * t5941 * t165 + 0.6e1 * t1217 * t5945 * t141 - 0.6e1 * t1689 * t5945 * t165 - 0.12e2 * t841 * t230 * t1690;
  t5959 = t248 * t623;
  t5965 = t708 * t204;
  t5988 = t248 * t627;
  t6016 = 0.12e2 * t1217 * t1678 * t503 - 0.18e2 * t2984 * t5988 * t141 + 0.24e2 * t4454 * t5988 * t165 + 0.12e2 * t1217 * t4421 * t218 + 0.12e2 * t1217 * t4427 * t218 + 0.12e2 * t3076 * t2103 - 0.6e1 * t841 * t585 * t627 - 0.3e1 * t299 * t2069 * t141 - 0.13e2 * t677 * t615 + 0.21e2 / 0.2e1 * t238 * t1995 + 0.32e2 * t3340 * t4176 * t1778;
  t6025 = my_piecewise3(t3, 0, -t7 * t101 * t2155 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * (0.12e2 * t1217 * t5941 * t141 + 0.6e1 * t1217 * t5959 * t165 + 0.12e2 * t1217 * t5965 * t165 - 0.6e1 * t1222 * t5959 * t141 - 0.12e2 * t1222 * t5965 * t141 - 0.12e2 * t1689 * t1685 * t503 - 0.12e2 * t3931 * t1679 + 0.12e2 * t3884 * t1682 + 0.12e2 * t3884 * t1686 + 0.3e1 * t1710 * t683 + t5547 + t5644 + t5706 + t5758 + t5824 + t5891 + t5955 + t6016));
  tv4rhosigma2tau0 = 0.2e1 * rho[0] * t6025 + 0.2e1 * t2159;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 0] += tv4rhosigma2tau0;

  tv4rhosigmalapl20 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 0] += tv4rhosigmalapl20;

  tv4rhosigmalapltau0 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 0] += tv4rhosigmalapltau0;

  t6067 = t230 * t55;
  t6071 = t351 * t2172;
  t6080 = 0.144e3 * t717 * t885 * t1850 - 0.3e1 * t299 * t1881 * t204 - 0.3e1 * t299 * t741 * t459 + 0.4e1 * t335 * t249 * t1815 - 0.3e1 * t299 * t1865 * t204 + 0.4e1 * t335 * t585 * t708 + 0.4e1 * t335 * t696 * t584 + 0.4e1 * t335 * t570 * t708 - 0.6e1 * t841 * t2222 * t165 - 0.6e1 * t841 * t732 * t503 + 0.6e1 * t849 * t2222 * t141 - 0.6e1 * t841 * t1862 * t218 + 0.128e3 * t294 * t6067 * t1891 + 0.48e2 * t1902 * t6071 * t1277 - 0.96e2 * t538 * t6071 * t1551 + 0.12e2 * t4683 * t725;
  t6092 = t204 * t146 * t1888;
  t6108 = t823 * t6067;
  t6122 = t740 * t218;
  t6129 = 0.12e2 * t4689 * t725 + 0.12e2 * t1758 * t1899 - 0.6e1 * t4660 * t4661 * t1359 + 0.6e1 * t5692 * t4661 * t3250 - 0.48e2 * t6092 * t1905 + 0.96e2 * t5740 * t1909 + 0.128e3 * t2161 * t1888 * t1891 - 0.48e2 * t4928 * t2166 - 0.48e2 * t4941 * t2166 - 0.48e2 * t1902 * t1903 * t719 * t503 - 0.48e2 * t6108 * t1905 + 0.96e2 * t1755 * t1909 - 0.2e2 * t1758 * t1885 + 0.16e3 * t1902 * t1903 * t2080 - 0.2e2 * t544 * t539 * t33 * t708 + 0.6e1 * t1217 * t6122 * t141 - 0.6e1 * t1689 * t6122 * t165;
  t6156 = t248 * t708;
  t6160 = t740 * t204;
  t6167 = t731 * t218;
  t6186 = 0.16e2 * t1276 * t195 * t708 * params->eta * sigma[0] - 0.48e2 * t4303 * t239 * t1682 - 0.48e2 * t4303 * t239 * t1686 + 0.72e2 * t2477 * t4302 * t239 * t1690 + 0.16e2 * t4336 * t1929 - 0.12e2 * t3340 * t682 * t1927 * t141 + 0.12e2 * t3558 * t682 * t1927 * t165 - 0.12e2 * t1689 * t6156 * t165 - 0.6e1 * t1222 * t6160 * t141 + 0.6e1 * t1217 * t6160 * t165 - 0.18e2 * t2984 * t6167 * t141 + 0.24e2 * t4454 * t6167 * t165 - 0.12e2 * t1689 * t1685 * t584 + 0.12e2 * t1217 * t6156 * t141 + 0.6e1 * t849 * t732 * t459 + 0.12e2 * t1217 * t1678 * t584;
  t6209 = 0.1e1 / t31 / t424;
  t6215 = t71 * t248 * t59;
  t6247 = 0.12e2 * t1403 * t2200 + 0.12e2 * t1406 * t2200 + 0.12e2 * t544 * t539 * t49 * t1815 + 0.24e2 * t4660 * t4949 * t3090 - 0.32e2 * t4953 * t5686 + 0.24e2 * t4660 * t4949 * t1218 - 0.24e2 * t5692 * t4949 * t3108 + 0.16e2 * t4912 * t5697 + 0.6e1 * t128 * t93 * t6209 * t5679 - 0.4e1 * t4666 * t6215 - 0.4e2 * t1295 * t539 * t1884 * t204 + 0.4e2 * t1384 * t539 * t1884 * t218 + 0.26e2 * t544 * t556 * t194 * t248 * params->eta - 0.12e2 * t544 * t1730 * t5033 * sigma[0] + 0.24e2 * t1295 * t539 * t2199 * t141 - 0.24e2 * t1384 * t539 * t2199 * t165 + 0.96e2 * t5052 * t1903 * t2165 * t165;
  t6257 = t351 * t6209;
  t6261 = t78 * t6209;
  t6297 = -0.96e2 * t1295 * t1903 * t2165 * t134 - 0.128e3 * t1902 * t1890 * t1778 - 0.32e2 * t538 * t6257 * t5156 - 0.8e2 * t1889 * t6261 * t5161 + 0.24e2 * t4469 * t2181 + 0.24e2 * t3537 * t2181 + 0.24e2 * t3493 * t2181 + 0.24e2 * t1295 * t539 * t1898 * t204 + 0.24e2 * t1295 * t539 * t724 * t459 - 0.24e2 * t3275 * t2185 - 0.24e2 * t3280 * t2185 - 0.24e2 * t1384 * t539 * t1898 * t218 - 0.24e2 * t1384 * t539 * t724 * t503 + 0.24e2 * t4560 * t1834 - 0.24e2 * t4635 * t1838 - 0.6e1 * t1403 * t2196;
  t6312 = t731 * t204;
  t6339 = -0.6e1 * t1406 * t2196 - 0.6e1 * t544 * t556 * t681 * t584 * params->eta + 0.8e2 * t2091 - 0.4e2 * t2095 + 0.288e3 * t717 * t892 * t1869 - 0.16e3 * t2169 * t1841 + 0.12e2 * t3067 * t6312 * t141 - 0.18e2 * t2984 * t6312 * t165 - 0.24e2 * t1855 * t2173 - 0.24e2 * t1858 * t2173 - 0.24e2 * t717 * t3199 * t2172 - 0.12e2 * t1710 * t728 + 0.6e1 * t549 * t2213 - 0.16e3 * t2162 * t1841 + 0.12e2 * t5500 * t1847 + 0.12e2 * t4217 * t2207 + 0.12e2 * t1701 * t720 * t5532;
  t6356 = t64 * t584;
  t6388 = -0.24e2 * t2169 * t1844 - 0.24e2 * t1855 * t2204 - 0.24e2 * t1858 * t2204 - 0.24e2 * t717 * t720 * t5543 - 0.48e2 * t1855 * t2177 - 0.48e2 * t1858 * t2177 - 0.3e1 * t4217 * t2191 - 0.3e1 * t1701 * t682 * t6356 + 0.48e2 * t2161 * t179 * t721 + 0.48e2 * t1574 * t230 * t721 + 0.48e2 * t294 * t524 * t721 + 0.24e2 * t1222 * t885 * t2172 * t165 - 0.16e2 * t677 * t1852 + 0.12e2 * t717 * t2212 * t1271 - 0.6e1 * t1701 * t2212 * t1277 + 0.48e2 * t459 * t81 * t93 * t721 + 0.2e1 * t335 * t2247 * t165;
  t6415 = t6209 * t150;
  t6427 = t6209 * params->eta;
  t6435 = t6209 * t321;
  t6440 = -0.36e3 * t2935 * t2176 * t134 - 0.18e3 * t2320 * t2239 * t134 - 0.12e2 * t2432 * t6209 * t5161 - 0.21e3 * t2923 * t6435 * t51 - 0.12e3 * t2935 * t6427 * t51 - 0.9e1 * t3199 * t2176 - 0.3e1 * t6415 * t5156 + 0.18e2 * t1851 + 0.54e2 * t2050 + 0.36e3 * t2056 + 0.54e3 * t2060;
  t6459 = 0.6e1 * t849 * t1862 * t204 - 0.3e1 * t299 * t2247 * t141 + 0.2e1 * t335 * t2234 * t165 + 0.2e1 * t335 * t741 * t503 - 0.3e1 * t299 * t2234 * t141 + 0.2e1 * t335 * t1865 * t218 + 0.2e1 * t335 * t1881 * t218 + 0.4e2 * t2106 - 0.36e2 * t2109 - t147 * t179 * t2246 - t147 * t93 * t6440 + 0.2e1 * t335 * t524 * t731 - t147 * t524 * t740 - t147 * t230 * t1880 - 0.32e2 * t3558 * t5112 * t1778 + 0.32e2 * t3340 * t5112 * t1773 + 0.13e2 * t1701 * t195 * t2190;
  t6467 = my_piecewise3(t3, 0, -t7 * t101 * t2250 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * (t6080 + t6129 + t6186 + t6247 + t6297 + t6339 + t6388 + t6459));
  tv4rhosigmatau20 = 0.2e1 * rho[0] * t6467 + 0.2e1 * t2254;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 0] += tv4rhosigmatau20;

  tv4rholapl30 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 0] += tv4rholapl30;

  tv4rholapl2tau0 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 0] += tv4rholapl2tau0;

  tv4rholapltau20 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 0] += tv4rholapltau20;

  t6484 = 0.1e1 / t31 / t282;
  t6511 = -0.3e2 * t544 * t539 * t33 * t740 + 0.18e2 * t1406 * t2276 + 0.18e2 * t544 * t539 * t49 * t1880 - 0.384e3 * t2366 * t6484 * t81 * t93 * params->eta * t51 - 0.144e3 * t4928 * t2262 - 0.144e3 * t4941 * t2262 - 0.144e3 * t1902 * t1903 * t719 * t584 - 0.36e2 * t3275 * t2269 - 0.36e2 * t3280 * t2269 + 0.72e2 * t4660 * t4949 * t1359 - 0.72e2 * t5692 * t4949 * t3250 + 0.48e2 * t4912 * t6215;
  t6530 = t6484 * t150;
  t6536 = t6484 * params->eta;
  t6566 = 0.18e2 * t1403 * t2276 + 0.48e3 * t1902 * t1903 * t2194 + 0.6e2 * t1384 * t539 * t33 * t731 - 0.12e3 * t2192 + 0.36e2 * t4217 * t2272 - 0.6e1 * t841 * t179 * t2279 - t147 * t179 * t2291 - t147 * t93 * (0.144e4 * t2320 * t2288 * t134 + 0.96e3 * t2935 * t6536 * t51 + 0.24e2 * t6530 * t5156 - 0.12e3 * t2212 - 0.24e4 * t2240) - 0.48e2 * t3558 * t195 * t731 * params->eta * sigma[0] + 0.24e2 * t1276 * t195 * t740 * params->eta * sigma[0] - 0.288e3 * t1222 * t885 * t2256 * t165 + 0.288e3 * t5052 * t1903 * t2261 * t165 - 0.288e3 * t1295 * t1903 * t2261 * t134;
  t6571 = t351 * t6484;
  t6613 = 0.36e2 * t1295 * t539 * t2275 * t141 - 0.36e2 * t1384 * t539 * t2275 * t165 - 0.72e2 * t1384 * t539 * t724 * t584 - 0.72e2 * t3604 * t539 * t2268 * t141 + 0.108e3 * t3363 * t539 * t2268 * t165 - 0.18e2 * t2477 * t2280 * t141 - 0.3e1 * t299 * t2292 * t141 + 0.24e2 * t2621 * t2280 * t165 + 0.2e1 * t335 * t2292 * t165 - 0.192e3 * t867 * t2257 * t179 + 0.6e1 * t335 * t249 * t1880 - 0.384e3 * t1902 * t1890 * t1928 + 0.384e3 * t538 * t6571 * t5156;
  t6632 = t248 * t740;
  t6640 = t81 * t93;
  t6644 = t867 * t2256;
  t6645 = t146 * t93;
  t6655 = 0.6e1 * t335 * t585 * t740 - 0.18e2 * t841 * t732 * t584 + 0.6e1 * t335 * t570 * t740 + 0.96e3 * t867 * t2172 * t81 * t93 + 0.288e3 * t1858 * t2265 + 0.288e3 * t717 * t3199 * t2256 + 0.18e2 * t1217 * t6632 * t141 - 0.18e2 * t1689 * t6632 * t165 - 0.576e3 * t2361 * t2256 * t6640 * t134 + 0.192e3 * t6644 * t6645 * t165 + 0.288e3 * t1855 * t2265 - 0.144e4 * t2174 + 0.36e2 * t1701 * t720 * t6356;
  t6662 = my_piecewise3(t3, 0, -t7 * t101 * t2294 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * (t6511 + t6566 + t6613 + t6655));
  tv4rhotau30 = 0.2e1 * rho[0] * t6662 + 0.2e1 * t2298;

  if(out->v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 0] += tv4rhotau30;

  t6670 = t4863 * t29;
  t6673 = t5601 * t29;
  t6677 = t2367 * t1945 * t29;
  t6700 = 0.665e3 / 0.251048476872e12 * t599 / t19 / t809 * t2598 * t2602;
  t6728 = t279 * t1945;
  t6738 = 0.35e2 / 0.129140163e9 * t6728 * t814 * t818;
  t6743 = t648 * t648;
  t6759 = -0.4e1 * t147 * t230 * t2037 - t147 * t93 * (0.9e1 / 0.128e3 * t5569 * t200 + 0.27e2 / 0.64e2 * t2432 * t6670 + 0.45e2 / 0.64e2 * t2361 * t6673 + 0.45e2 / 0.128e3 * t2366 * t6677 + 0.45e2 / 0.128e3 * t2320 * t5042 * t29 + 0.45e2 / 0.16e2 * t2935 * t5587 * t29 + 0.945e3 / 0.128e3 * t2923 * t6670 + 0.63e2 / 0.8e1 * t2419 * t6673 + 0.189e3 / 0.64e2 * t2426 * t6677) + t6700 - 0.72e2 * t2477 * t205 * t1975 + 0.72e2 * t2519 * t606 * t627 + 0.36e2 * t849 * t624 * t627 + 0.72e2 * t849 * t612 * t627 + 0.8e1 * t335 * t219 * t2037 + 0.24e2 * t335 * t631 * t648 - 0.36e2 * t841 * t628 * t648 - 0.12e2 * t299 * t205 * t2037 - 0.18e2 * t299 * t624 * t648 + t82 * (-0.35e2 / 0.129140163e9 * t6728 * t780 * t818 + 0.133e3 / 0.516560652e9 * t2559 * t6728 * t5457 * t225 + t6738 - t6700) + 0.24e2 * t1983 * t230 + 0.6e1 * t335 * t93 * t6743 - 0.12e2 * t299 * t2003 * t218 - 0.36e2 * t299 * t612 * t648 - 0.36e2 * t299 * t1992 * t218 + 0.24e2 * t294 * t205 * t2002;
  t6798 = t321 * t29;
  t6817 = t623 * t623;
  t6821 = t627 * t627;
  t6825 = -0.36e2 * t299 * t1989 * t218 + 0.72e2 * t294 * t612 * t623 - 0.36e2 * t823 * t606 * t648 - 0.24e2 * t5146 * t219 - 0.72e2 * t823 * t1986 * t218 + 0.72e2 * t1217 * t1483 * t648 - 0.72e2 * t1222 * t1483 * t623 + 0.12e2 * t128 * t1958 * t204 - 0.4e1 * t147 * t1958 * t218 - 0.24e2 * t841 * t230 * t1975 + 0.36e2 * t294 * t661 * t605 + 0.18e2 * t128 * t661 * t623 + 0.12e2 * t128 * t230 * t2002 + 0.3e1 * t128 * t93 * (-0.9e1 / 0.128e3 * t5569 * t6798 - 0.3e1 / 0.16e2 * t2432 * t6673 - 0.15e2 / 0.128e3 * t2361 * t6677) + 0.12e2 * t335 * t661 * t627 - 0.6e1 * t147 * t661 * t648 - t6738 + 0.36e2 * t2071 * t624 + 0.18e2 * t294 * t93 * t6817 + 0.24e2 * t2621 * t93 * t6821;
  t6830 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (t6759 + t6825));
  tv4sigma40 = 0.2e1 * rho[0] * t6830;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma3lapl0 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 0] += tv4sigma3lapl0;

  t6887 = -0.6e1 * t5146 * t249 - t147 * t1958 * t248 + 0.2e1 * t335 * t249 * t2037 + 0.6e1 * t335 * t2067 * t218 + 0.6e1 * t335 * t709 * t648 + 0.12e2 * t335 * t2046 * t218 + 0.6e1 * t335 * t696 * t648 - 0.36e2 * t3340 * t682 * t1772 * t218 + 0.18e2 * t1384 * t556 * t681 * t627 * params->eta - 0.18e2 * t1758 * t2082 + 0.36e2 * t1295 * t539 * t2120 * t204 - 0.36e2 * t1384 * t539 * t2120 * t218 - 0.9e1 * t544 * t556 * t681 * t648 * params->eta - 0.72e2 * t3604 * t539 * t2126 * t204 + 0.72e2 * t4560 * t2086 + 0.36e2 * t1755 * t2077 + 0.36e2 * t1295 * t539 * t2114 * t218;
  t6941 = 0.18e2 * t538 * t556 * t681 * t623 * params->eta - 0.9e1 * t299 * t709 * t623 - 0.3e1 * t299 * t249 * t2002 + 0.6e1 * t335 * t2069 * t218 - 0.9e1 * t299 * t696 * t623 - 0.9e1 * t299 * t2067 * t204 - 0.18e2 * t299 * t2046 * t204 + 0.24e2 * t2621 * t249 * t1975 - 0.18e2 * t841 * t709 * t627 + 0.9e1 * t2072 * t683 - 0.54e2 * t2984 * t1678 * t627 + 0.9e1 / 0.2e1 * t2097 * t683 - 0.9e1 / 0.2e1 * t677 * t2108 + 0.36e2 * t3067 * t5934 * t218 + 0.18e2 * t1217 * t5945 * t204 - 0.18e2 * t1689 * t5945 * t218 + 0.36e2 * t1217 * t5965 * t218 - 0.18e2 * t1222 * t5959 * t204;
  t6957 = t64 * t627;
  t6969 = t6435 * t29;
  t6973 = t6209 * t868 * t29;
  t6991 = t64 * t623;
  t6995 = t64 * t648;
  t7016 = 0.18e2 * t1217 * t5959 * t218 + 0.36e2 * t3884 * t2103 - 0.18e2 * t841 * t696 * t627 - 0.18e2 * t823 * t709 * t605 - 0.18e2 * t823 * t696 * t605 + 0.9e1 * t1217 * t682 * t6957 - 0.3e1 * t147 * t661 * t708 - 0.3e1 * t147 * t230 * t2066 - t147 * t93 * (-0.27e2 / 0.64e2 * t6415 * t200 - 0.27e2 / 0.16e2 * t2432 * t6969 - 0.45e2 / 0.32e2 * t2361 * t6973 - 0.45e2 / 0.16e2 * t2320 * t6261 * t29 - 0.135e3 / 0.8e1 * t2935 * t6427 * t29 - 0.945e3 / 0.32e2 * t2923 * t6969 - 0.63e2 / 0.4e1 * t2419 * t6973) - 0.27e2 / 0.4e1 * t677 * t2100 + 0.9e1 * t717 * t682 * t6991 - 0.9e1 / 0.2e1 * t1701 * t682 * t6995 - 0.6e1 * t128 * t1958 * t240 - 0.36e2 * t2071 * t230 * t240 - 0.9e1 * t717 * t1851 * t1772 + 0.9e1 / 0.2e1 * t1701 * t1851 * t1777 + 0.27e2 / 0.32e2 * t238 * t6415 * t6798 + 0.18e2 * t2169 * t2090;
  t7065 = -0.9e1 * t5500 * t2094 + 0.36e2 * t3363 * t539 * t49 * t1975 - 0.36e2 * t4635 * t2127 + 0.18e2 * t1758 * t2121 + 0.6e1 * t544 * t539 * t49 * t2037 + 0.9e1 / 0.8e1 * t555 * t6257 * t868 * t29 - 0.36e2 * t5740 * t2115 + 0.36e2 * t5744 * t674 + 0.18e2 * t5811 * t687 - 0.36e2 * t1755 * t2115 - 0.12e2 * t538 * t539 * t49 * t2002 - 0.18e2 * t4660 * t4661 * t1483 - 0.36e2 * t5700 * t670 + 0.18e2 * t5668 * t674 + 0.9e1 * t5804 * t687 - 0.27e2 / 0.2e1 * t538 * t5733 * t4563 + 0.27e2 / 0.4e1 * t544 * t5733 * t4568 - 0.9e1 * t299 * t2069 * t204;
  t7071 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (t6887 + t6941 + t7016 + t7065));
  tv4sigma3tau0 = 0.2e1 * rho[0] * t7071;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 0] += tv4sigma3tau0;

  tv4sigma2lapl20 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 0] += tv4sigma2lapl20;

  tv4sigma2lapltau0 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 0] += tv4sigma2lapltau0;

  t7112 = t64 * t708;
  t7122 = t6484 * t321 * t29;
  t7125 = t78 * t6484;
  t7140 = 0.48e2 * t294 * t661 * t721 - 0.96e2 * t2169 * t2177 - 0.6e1 * t5500 * t2191 + 0.12e2 * t1701 * t720 * t6995 - 0.12e2 * t1701 * t2212 * t1777 + 0.48e2 * t623 * t81 * t93 * t721 + 0.96e2 * t2161 * t230 * t721 - 0.96e2 * t2162 * t2177 + 0.48e2 * t1222 * t885 * t2172 * t218 - 0.48e2 * t2169 * t2204 - 0.24e2 * t717 * t720 * t6991 + 0.24e2 * t717 * t2212 * t1772 + 0.24e2 * t5500 * t2207 - 0.9e1 / 0.4e1 * t238 * t6530 * t6798 - 0.6e1 * t1701 * t682 * t7112 + 0.3e1 * t1701 * t1851 * t1927 - t147 * t93 * (0.9e1 / 0.4e1 * t6530 * t200 + 0.9e1 / 0.2e1 * t2432 * t7122 + 0.45e2 / 0.2e1 * t2320 * t7125 * t29 + 0.9e2 * t2935 * t6536 * t29 + 0.315e3 / 0.4e1 * t2923 * t7122) - 0.96e2 * t4303 * t239 * t2103;
  t7203 = -0.24e2 * t3340 * t682 * t1678 * params->eta + 0.24e2 * t3558 * t682 * t1685 * params->eta + 0.2e1 * t335 * t661 * t731 - t147 * t661 * t740 - 0.2e1 * t147 * t230 * t2246 + 0.72e2 * t3363 * t539 * t724 * t627 - 0.48e2 * t1384 * t539 * t2199 * t218 - 0.24e2 * t1384 * t539 * t724 * t648 - 0.12e2 * t1758 * t2196 - 0.12e2 * t544 * t556 * t681 * t708 * params->eta + 0.48e2 * t4560 * t2181 + 0.48e2 * t1295 * t539 * t2199 * t204 + 0.24e2 * t1295 * t539 * t724 * t623 - 0.48e2 * t4635 * t2185 + 0.2e1 * t335 * t741 * t648 + 0.4e1 * t335 * t2247 * t218 - 0.3e1 * t299 * t741 * t623 + 0.4e1 * t335 * t2234 * t218 - 0.6e1 * t299 * t2234 * t204;
  t7235 = t708 * t708;
  t7260 = -0.6e1 * t299 * t2247 * t204 + 0.4e1 * t335 * t249 * t2066 - 0.6e1 * t841 * t732 * t648 + 0.8e1 * t335 * t696 * t708 - 0.12e2 * t841 * t2222 * t218 + 0.12e2 * t849 * t2222 * t204 + 0.6e1 * t849 * t732 * t623 + 0.24e2 * t2621 * t732 * t627 + 0.12e2 * t2519 * t732 * t605 - 0.24e2 * t1217 * t720 * t6957 + 0.4e1 * t335 * t93 * t7235 - 0.6e1 * t841 * t741 * t627 - 0.6e1 * t823 * t741 * t605 - 0.24e2 * t2072 * t728 - 0.24e2 * t1689 * t1685 * t708 - 0.36e2 * t2984 * t6312 * t218 + 0.24e2 * t1217 * t1678 * t708 - 0.12e2 * t2097 * t728 + 0.12e2 * t677 * t2213;
  t7315 = -0.48e2 * t2162 * t2173 - 0.48e2 * t2169 * t2173 + 0.3e1 * t717 * t29 * t6484 * t150 + 0.12e2 * t1217 * t6160 * t218 + 0.9e1 / 0.2e1 * t544 * t5733 * t5033 + 0.12e2 * t544 * t539 * t49 * t2066 + 0.48e2 * t4660 * t4949 * t1483 - 0.96e2 * t6108 * t2166 - 0.48e2 * t1902 * t1903 * t719 * t648 + 0.96e2 * t1902 * t6071 * t1777 + 0.24e2 * t538 * t6571 * t200 + 0.3e2 * t1889 * t7125 * t6798 - 0.12e2 * t4660 * t4661 * t1678 + 0.12e2 * t5692 * t4661 * t1685 + 0.12e2 * t5668 * t725 + 0.24e2 * t1758 * t2200 - 0.96e2 * t6092 * t2166 + 0.96e2 * t5052 * t1903 * t719 * t627 + 0.24e2 * t5744 * t725;
  t7321 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (t7140 + t7203 + t7260 + t7315));
  tv4sigma2tau20 = 0.2e1 * rho[0] * t7321;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 0] += tv4sigma2tau20;

  tv4sigmalapl30 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 0] += tv4sigmalapl30;

  tv4sigmalapl2tau0 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 0] += tv4sigmalapl2tau0;

  tv4sigmalapltau20 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 0] += tv4sigmalapltau20;

  t7323 = t64 * t731;
  t7335 = t64 * t740;
  t7340 = 0.1e1 / t31 / t271;
  t7362 = 0.9e1 * t1217 * t682 * t7323 + 0.36e2 * t5500 * t2272 + 0.36e2 * t1701 * t720 * t7112 - 0.18e2 * t1701 * t2212 * t1927 - 0.9e1 / 0.2e1 * t1701 * t682 * t7335 + 0.144e3 * t2366 * t7340 * t6640 * t200 + 0.72e2 * t1222 * t885 * t2172 * t248 - 0.288e3 * t1222 * t885 * t2256 * t218 - 0.192e3 * t867 * t2257 * t230 - 0.18e2 * t2477 * t2280 * t204 - 0.3e1 * t299 * t2292 * t204;
  t7402 = -0.9e1 * t544 * t556 * t681 * t740 * params->eta + 0.36e2 * t1295 * t539 * t2275 * t204 - 0.36e2 * t1384 * t539 * t2275 * t218 + 0.288e3 * t5052 * t1903 * t2261 * t218 - 0.72e2 * t3604 * t539 * t2268 * t204 + 0.24e2 * t2621 * t2280 * t218 + 0.2e1 * t335 * t2292 * t218 + 0.6e1 * t335 * t249 * t2246 + 0.6e1 * t335 * t696 * t740 + 0.6e1 * t335 * t709 * t740 - 0.18e2 * t841 * t732 * t708;
  t7440 = t6640 * t29;
  t7451 = 0.108e3 * t3363 * t539 * t2268 * t218 - 0.72e2 * t1384 * t539 * t724 * t708 + 0.18e2 * t1384 * t556 * t681 * t731 * params->eta - 0.6e1 * t841 * t230 * t2279 - t147 * t230 * t2291 - t147 * t93 * (-0.18e3 * t2320 * t78 * t7340 * t29 - 0.36e3 * t2935 * t7340 * params->eta * t29 - 0.9e1 * t7340 * t150 * t200) - 0.18e2 * t1689 * t6632 * t218 + 0.72e2 * t2361 * t7340 * t7440 + 0.288e3 * t2162 * t2265 + 0.288e3 * t2169 * t2265 - 0.36e2 * t717 * t29 * t7340 * t150;
  t7487 = 0.18e2 * t1217 * t6632 * t204 + 0.192e3 * t6644 * t6645 * t218 - 0.144e3 * t6092 * t2262 - 0.144e3 * t6108 * t2262 - 0.144e3 * t1902 * t1903 * t719 * t708 + 0.144e3 * t1902 * t6071 * t1927 - 0.144e3 * t538 * t351 * t7340 * t200 - 0.36e2 * t4635 * t2269 + 0.72e2 * t4660 * t4949 * t1678 - 0.72e2 * t5692 * t4949 * t1685 + 0.18e2 * t1758 * t2276 + 0.18e2 * t544 * t539 * t49 * t2246;
  t7493 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * (t7362 + t7402 + t7451 + t7487));
  tv4sigmatau30 = 0.2e1 * rho[0] * t7493;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 0] += tv4sigmatau30;

  tv4lapl40 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 0] += tv4lapl40;

  tv4lapl3tau0 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 0] += tv4lapl3tau0;

  tv4lapl2tau20 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 0] += tv4lapl2tau20;

  tv4lapltau30 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 0] += tv4lapltau30;

  t7523 = t731 * t731;
  t7530 = t740 * t740;
  t7553 = 0.288e3 * t717 * t2446 * t150 - 0.144e3 * t1217 * t720 * t7323 + 0.72e2 * t1701 * t720 * t7335 - 0.1152e4 * t2361 * t2335 * t7440 - 0.1152e4 * t1222 * t885 * t2256 * t248 + 0.144e3 * t3363 * t539 * t49 * t2279 - 0.144e3 * t1384 * t539 * t724 * t740 + 0.576e3 * t5052 * t1903 * t719 * t731 + 0.24e2 * t2621 * t93 * t7523 - 0.36e2 * t841 * t732 * t740 + 0.6e1 * t335 * t93 * t7530 + 0.8e1 * t335 * t249 * t2291 + 0.768e3 * t6644 * t6645 * t248 - 0.288e3 * t1902 * t1903 * t719 * t740 + 0.24e2 * t544 * t539 * t49 * t2291 - 0.144e4 * t147 * t93 * params->b * t2361 * t2446;
  t7557 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t7553);
  tv4tau40 = 0.2e1 * rho[0] * t7557;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 0] += tv4tau40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t11, t12;
  double t15, t16, t17, t19, t20, t21, t22, t23;
  double t24, t26, t27, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t45, t46, t47, t48, t49, t52, t54, t57;
  double t58, t59, t61, t62, t65, t66, t67, t69;
  double t70, t71, t72, t73, t74, t76, t78, t79;
  double t81, t83, t84, t85, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t104, t106;
  double t107, t108, t109, t111, t112, t113, t114, t115;
  double t117, t118, t122, t123, t124, t125, t126, t129;
  double t131, t134, t135, t136, t139, t140, t141, t143;
  double t144, t145, t146, t147, t148, t150, t152, t153;
  double t155, t157, t158, t159, t162, t164, t165, t166;
  double t167, t168, t170, t172, t176, tzk0;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = sigma[0] * t39;
  t41 = 0.1e1 / params->kappa;
  t45 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t40 * t41;
  t46 = pow(t45, 0.1e1 / 0.5e1);
  t47 = t46 * t46;
  t48 = t47 * t47;
  t49 = 0.1e1 / t48;
  t52 = 0.5e1 / 0.972e3 * t34 * t40 * t49;
  t54 = 0.1e1 / t37 / rho[0];
  t57 = tau[0] * t54 - t40 / 0.8e1;
  t58 = t57 * t57;
  t59 = t29 * t29;
  t61 = 0.3e1 / 0.1e2 * t59 * t32;
  t62 = params->eta * sigma[0];
  t65 = t61 + t62 * t39 / 0.8e1;
  t66 = t65 * t65;
  t67 = 0.1e1 / t66;
  t69 = -t58 * t67 + 0.1e1;
  t70 = t69 * t69;
  t71 = t70 * t69;
  t72 = t58 * t57;
  t73 = t66 * t65;
  t74 = 0.1e1 / t73;
  t76 = t58 * t58;
  t78 = params->b * t76 * t58;
  t79 = t66 * t66;
  t81 = 0.1e1 / t79 / t66;
  t83 = t72 * t74 + t78 * t81 + 0.1e1;
  t84 = 0.1e1 / t83;
  t85 = t71 * t84;
  t88 = 0.5e1 / 0.972e3 * t34 * t40 + params->c;
  t90 = t41 * t88 + 0.1e1;
  t91 = pow(t90, 0.1e1 / 0.5e1);
  t92 = t91 * t91;
  t93 = t92 * t92;
  t94 = 0.1e1 / t93;
  t96 = t88 * t94 - t52;
  t98 = t85 * t96 + t52 + 0.1e1;
  t102 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t98);
  t103 = rho[1] <= p->dens_threshold;
  t104 = -t17;
  t106 = my_piecewise5(t15, t12, t11, t16, t104 * t8);
  t107 = 0.1e1 + t106;
  t108 = t107 <= p->zeta_threshold;
  t109 = POW_1_3(t107);
  t111 = my_piecewise3(t108, t23, t109 * t107);
  t112 = t111 * t27;
  t113 = rho[1] * rho[1];
  t114 = POW_1_3(rho[1]);
  t115 = t114 * t114;
  t117 = 0.1e1 / t115 / t113;
  t118 = sigma[2] * t117;
  t122 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t118 * t41;
  t123 = pow(t122, 0.1e1 / 0.5e1);
  t124 = t123 * t123;
  t125 = t124 * t124;
  t126 = 0.1e1 / t125;
  t129 = 0.5e1 / 0.972e3 * t34 * t118 * t126;
  t131 = 0.1e1 / t115 / rho[1];
  t134 = tau[1] * t131 - t118 / 0.8e1;
  t135 = t134 * t134;
  t136 = params->eta * sigma[2];
  t139 = t61 + t136 * t117 / 0.8e1;
  t140 = t139 * t139;
  t141 = 0.1e1 / t140;
  t143 = -t135 * t141 + 0.1e1;
  t144 = t143 * t143;
  t145 = t144 * t143;
  t146 = t135 * t134;
  t147 = t140 * t139;
  t148 = 0.1e1 / t147;
  t150 = t135 * t135;
  t152 = params->b * t150 * t135;
  t153 = t140 * t140;
  t155 = 0.1e1 / t153 / t140;
  t157 = t146 * t148 + t152 * t155 + 0.1e1;
  t158 = 0.1e1 / t157;
  t159 = t145 * t158;
  t162 = 0.5e1 / 0.972e3 * t34 * t118 + params->c;
  t164 = t162 * t41 + 0.1e1;
  t165 = pow(t164, 0.1e1 / 0.5e1);
  t166 = t165 * t165;
  t167 = t166 * t166;
  t168 = 0.1e1 / t167;
  t170 = t162 * t168 - t129;
  t172 = t159 * t170 + t129 + 0.1e1;
  t176 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t172);
  tzk0 = t102 + t176;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t11, t12;
  double t15, t16, t17, t19, t20, t21, t22, t23;
  double t24, t26, t27, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t45, t46, t47, t48, t49, t52, t54, t57;
  double t58, t59, t61, t62, t65, t66, t67, t69;
  double t70, t71, t72, t73, t74, t76, t78, t79;
  double t81, t83, t84, t85, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t104, t106;
  double t107, t108, t109, t111, t112, t113, t114, t115;
  double t117, t118, t122, t123, t124, t125, t126, t129;
  double t131, t134, t135, t136, t139, t140, t141, t143;
  double t144, t145, t146, t147, t148, t150, t152, t153;
  double t155, t157, t158, t159, t162, t164, t165, t166;
  double t167, t168, t170, t172, t176, tzk0;

  double t177, t178, t179, t181, t184, t185, t189, t190;
  double t191, t194, t195, t197, t198, t201, t203, t204;
  double t205, t206, t207, t208, t210, t212, t214, t216;
  double t217, t218, t222, t225, t226, t229, t230, t233;
  double t234, t235, t238, t239, t242, t243, t247, t248;
  double t251, t252, t258, t260, t261, t266, t268, t273;
  double t274, t276, t279, t280, t284, t287, t289, tvrho0;
  double t293, t296, t297, t302, t304, t307, t308, t312;
  double t314, t315, t318, t319, t320, t321, t322, t324;
  double t326, t328, t330, t331, t332, t336, t339, t340;
  double t343, t344, t347, t348, t349, t352, t353, t356;
  double t357, t361, t362, t365, t366, t372, t374, t375;
  double t380, t382, t387, tvrho1, t392, t394, t396, t398;
  double t400, t401, t402, t405, t406, t409, t413, t414;
  double t416, t420, t421, t430, t432, t436, tvsigma0, tvsigma1;
  double t439, t441, t443, t445, t447, t448, t449, t452;
  double t453, t456, t460, t461, t463, t467, t468, t477;
  double t479, t483, tvsigma2, tvlapl0, tvlapl1, t484, t485, t490;
  double t493, t494, t496, t500, tvtau0, t501, t502, t507;
  double t510, t511, t513, t517, tvtau1;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = sigma[0] * t39;
  t41 = 0.1e1 / params->kappa;
  t45 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t40 * t41;
  t46 = pow(t45, 0.1e1 / 0.5e1);
  t47 = t46 * t46;
  t48 = t47 * t47;
  t49 = 0.1e1 / t48;
  t52 = 0.5e1 / 0.972e3 * t34 * t40 * t49;
  t54 = 0.1e1 / t37 / rho[0];
  t57 = tau[0] * t54 - t40 / 0.8e1;
  t58 = t57 * t57;
  t59 = t29 * t29;
  t61 = 0.3e1 / 0.1e2 * t59 * t32;
  t62 = params->eta * sigma[0];
  t65 = t61 + t62 * t39 / 0.8e1;
  t66 = t65 * t65;
  t67 = 0.1e1 / t66;
  t69 = -t58 * t67 + 0.1e1;
  t70 = t69 * t69;
  t71 = t70 * t69;
  t72 = t58 * t57;
  t73 = t66 * t65;
  t74 = 0.1e1 / t73;
  t76 = t58 * t58;
  t78 = params->b * t76 * t58;
  t79 = t66 * t66;
  t81 = 0.1e1 / t79 / t66;
  t83 = t72 * t74 + t78 * t81 + 0.1e1;
  t84 = 0.1e1 / t83;
  t85 = t71 * t84;
  t88 = 0.5e1 / 0.972e3 * t34 * t40 + params->c;
  t90 = t41 * t88 + 0.1e1;
  t91 = pow(t90, 0.1e1 / 0.5e1);
  t92 = t91 * t91;
  t93 = t92 * t92;
  t94 = 0.1e1 / t93;
  t96 = t88 * t94 - t52;
  t98 = t85 * t96 + t52 + 0.1e1;
  t102 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t98);
  t103 = rho[1] <= p->dens_threshold;
  t104 = -t17;
  t106 = my_piecewise5(t15, t12, t11, t16, t104 * t8);
  t107 = 0.1e1 + t106;
  t108 = t107 <= p->zeta_threshold;
  t109 = POW_1_3(t107);
  t111 = my_piecewise3(t108, t23, t109 * t107);
  t112 = t111 * t27;
  t113 = rho[1] * rho[1];
  t114 = POW_1_3(rho[1]);
  t115 = t114 * t114;
  t117 = 0.1e1 / t115 / t113;
  t118 = sigma[2] * t117;
  t122 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t118 * t41;
  t123 = pow(t122, 0.1e1 / 0.5e1);
  t124 = t123 * t123;
  t125 = t124 * t124;
  t126 = 0.1e1 / t125;
  t129 = 0.5e1 / 0.972e3 * t34 * t118 * t126;
  t131 = 0.1e1 / t115 / rho[1];
  t134 = tau[1] * t131 - t118 / 0.8e1;
  t135 = t134 * t134;
  t136 = params->eta * sigma[2];
  t139 = t61 + t136 * t117 / 0.8e1;
  t140 = t139 * t139;
  t141 = 0.1e1 / t140;
  t143 = -t135 * t141 + 0.1e1;
  t144 = t143 * t143;
  t145 = t144 * t143;
  t146 = t135 * t134;
  t147 = t140 * t139;
  t148 = 0.1e1 / t147;
  t150 = t135 * t135;
  t152 = params->b * t150 * t135;
  t153 = t140 * t140;
  t155 = 0.1e1 / t153 / t140;
  t157 = t146 * t148 + t152 * t155 + 0.1e1;
  t158 = 0.1e1 / t157;
  t159 = t145 * t158;
  t162 = 0.5e1 / 0.972e3 * t34 * t118 + params->c;
  t164 = t162 * t41 + 0.1e1;
  t165 = pow(t164, 0.1e1 / 0.5e1);
  t166 = t165 * t165;
  t167 = t166 * t166;
  t168 = 0.1e1 / t167;
  t170 = t162 * t168 - t129;
  t172 = t159 * t170 + t129 + 0.1e1;
  t176 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t172);
  tzk0 = t102 + t176;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t177 = t7 * t7;
  t178 = 0.1e1 / t177;
  t179 = t17 * t178;
  t181 = my_piecewise5(t11, 0, t15, 0, t8 - t179);
  t184 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t181);
  t185 = t184 * t27;
  t189 = t27 * t27;
  t190 = 0.1e1 / t189;
  t191 = t26 * t190;
  t194 = t6 * t191 * t98 / 0.8e1;
  t195 = t35 * rho[0];
  t197 = 0.1e1 / t37 / t195;
  t198 = sigma[0] * t197;
  t201 = 0.1e2 / 0.729e3 * t34 * t198 * t49;
  t203 = 0.1e1 / t31 / t30;
  t204 = t59 * t203;
  t205 = sigma[0] * sigma[0];
  t206 = t204 * t205;
  t207 = t35 * t35;
  t208 = t207 * t35;
  t210 = 0.1e1 / t36 / t208;
  t212 = 0.1e1 / t48 / t45;
  t214 = t210 * t212 * t41;
  t216 = 0.1e2 / 0.177147e6 * t206 * t214;
  t217 = t70 * t84;
  t218 = t57 * t67;
  t222 = -0.5e1 / 0.3e1 * tau[0] * t39 + t198 / 0.3e1;
  t225 = t58 * t74;
  t226 = t62 * t197;
  t229 = -0.2e1 * t218 * t222 - 0.2e1 / 0.3e1 * t225 * t226;
  t230 = t96 * t229;
  t233 = t83 * t83;
  t234 = 0.1e1 / t233;
  t235 = t71 * t234;
  t238 = 0.1e1 / t79;
  t239 = t72 * t238;
  t242 = params->b * t76 * t57;
  t243 = t81 * t222;
  t247 = 0.1e1 / t79 / t73;
  t248 = t78 * t247;
  t251 = 0.3e1 * t222 * t225 + t226 * t239 + 0.2e1 * t226 * t248 + 0.6e1 * t242 * t243;
  t252 = t96 * t251;
  t258 = 0.1e1 / t93 / t90;
  t260 = t88 * t258 * t29;
  t261 = t33 * sigma[0];
  t266 = -0.1e2 / 0.729e3 * t34 * t198 * t94 + 0.8e1 / 0.729e3 * t260 * t261 * t197 * t41 + t201 - t216;
  t268 = 0.3e1 * t217 * t230 - t235 * t252 + t266 * t85 - t201 + t216;
  t273 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t98 - t194 - 0.3e1 / 0.8e1 * t6 * t28 * t268);
  t274 = t104 * t178;
  t276 = my_piecewise5(t15, 0, t11, 0, -t8 - t274);
  t279 = my_piecewise3(t108, 0, 0.4e1 / 0.3e1 * t109 * t276);
  t280 = t279 * t27;
  t284 = t111 * t190;
  t287 = t6 * t284 * t172 / 0.8e1;
  t289 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t172 - t287);
  tvrho0 = t102 + t176 + t7 * (t273 + t289);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t293 = my_piecewise5(t11, 0, t15, 0, -t8 - t179);
  t296 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t293);
  t297 = t296 * t27;
  t302 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t98 - t194);
  t304 = my_piecewise5(t15, 0, t11, 0, t8 - t274);
  t307 = my_piecewise3(t108, 0, 0.4e1 / 0.3e1 * t109 * t304);
  t308 = t307 * t27;
  t312 = t113 * rho[1];
  t314 = 0.1e1 / t115 / t312;
  t315 = sigma[2] * t314;
  t318 = 0.1e2 / 0.729e3 * t34 * t315 * t126;
  t319 = sigma[2] * sigma[2];
  t320 = t204 * t319;
  t321 = t113 * t113;
  t322 = t321 * t113;
  t324 = 0.1e1 / t114 / t322;
  t326 = 0.1e1 / t125 / t122;
  t328 = t324 * t326 * t41;
  t330 = 0.1e2 / 0.177147e6 * t320 * t328;
  t331 = t144 * t158;
  t332 = t134 * t141;
  t336 = -0.5e1 / 0.3e1 * tau[1] * t117 + t315 / 0.3e1;
  t339 = t135 * t148;
  t340 = t136 * t314;
  t343 = -0.2e1 * t332 * t336 - 0.2e1 / 0.3e1 * t339 * t340;
  t344 = t170 * t343;
  t347 = t157 * t157;
  t348 = 0.1e1 / t347;
  t349 = t145 * t348;
  t352 = 0.1e1 / t153;
  t353 = t146 * t352;
  t356 = params->b * t150 * t134;
  t357 = t155 * t336;
  t361 = 0.1e1 / t153 / t147;
  t362 = t152 * t361;
  t365 = 0.3e1 * t336 * t339 + t340 * t353 + 0.2e1 * t340 * t362 + 0.6e1 * t356 * t357;
  t366 = t170 * t365;
  t372 = 0.1e1 / t167 / t164;
  t374 = t162 * t372 * t29;
  t375 = t33 * sigma[2];
  t380 = -0.1e2 / 0.729e3 * t34 * t315 * t168 + 0.8e1 / 0.729e3 * t374 * t375 * t314 * t41 + t318 - t330;
  t382 = t159 * t380 + 0.3e1 * t331 * t344 - t349 * t366 - t318 + t330;
  t387 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t172 - t287 - 0.3e1 / 0.8e1 * t6 * t112 * t382);
  tvrho1 = t102 + t176 + t7 * (t302 + t387);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t392 = 0.5e1 / 0.972e3 * t34 * t39 * t49;
  t394 = t207 * rho[0];
  t396 = 0.1e1 / t36 / t394;
  t398 = t396 * t212 * t41;
  t400 = 0.5e1 / 0.236196e6 * t204 * sigma[0] * t398;
  t401 = t218 * t39;
  t402 = params->eta * t39;
  t405 = t225 * t402 / 0.4e1 + t401 / 0.4e1;
  t406 = t96 * t405;
  t409 = t225 * t39;
  t413 = t81 * t39;
  t414 = t242 * t413;
  t416 = t247 * params->eta;
  t420 = -0.3e1 / 0.8e1 * t409 - 0.3e1 / 0.8e1 * t239 * t402 - 0.3e1 / 0.4e1 * t414 - 0.3e1 / 0.4e1 * t78 * t416 * t39;
  t421 = t96 * t420;
  t430 = 0.5e1 / 0.972e3 * t34 * t39 * t94 - t260 * t33 * t39 * t41 / 0.243e3 - t392 + t400;
  t432 = 0.3e1 * t217 * t406 - t235 * t421 + t430 * t85 + t392 - t400;
  t436 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t432);
  tvsigma0 = t7 * t436;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t439 = 0.5e1 / 0.972e3 * t34 * t117 * t126;
  t441 = t321 * rho[1];
  t443 = 0.1e1 / t114 / t441;
  t445 = t443 * t326 * t41;
  t447 = 0.5e1 / 0.236196e6 * t204 * sigma[2] * t445;
  t448 = t332 * t117;
  t449 = params->eta * t117;
  t452 = t339 * t449 / 0.4e1 + t448 / 0.4e1;
  t453 = t170 * t452;
  t456 = t339 * t117;
  t460 = t155 * t117;
  t461 = t356 * t460;
  t463 = t361 * params->eta;
  t467 = -0.3e1 / 0.8e1 * t456 - 0.3e1 / 0.8e1 * t353 * t449 - 0.3e1 / 0.4e1 * t461 - 0.3e1 / 0.4e1 * t152 * t463 * t117;
  t468 = t170 * t467;
  t477 = 0.5e1 / 0.972e3 * t34 * t117 * t168 - t374 * t33 * t117 * t41 / 0.243e3 - t439 + t447;
  t479 = t159 * t477 + 0.3e1 * t331 * t453 - t349 * t468 + t439 - t447;
  t483 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t479);
  tvsigma2 = t7 * t483;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvlapl1 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  t484 = t217 * t96;
  t485 = t218 * t54;
  t490 = t81 * t54;
  t493 = 0.3e1 * t225 * t54 + 0.6e1 * t242 * t490;
  t494 = t96 * t493;
  t496 = -t235 * t494 - 0.6e1 * t484 * t485;
  t500 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t496);
  tvtau0 = t7 * t500;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t501 = t331 * t170;
  t502 = t332 * t131;
  t507 = t155 * t131;
  t510 = 0.3e1 * t131 * t339 + 0.6e1 * t356 * t507;
  t511 = t170 * t510;
  t513 = -t349 * t511 - 0.6e1 * t501 * t502;
  t517 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t513);
  tvtau1 = t7 * t517;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t11, t12;
  double t15, t16, t17, t19, t20, t21, t22, t23;
  double t24, t26, t27, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t45, t46, t47, t48, t49, t52, t54, t57;
  double t58, t59, t61, t62, t65, t66, t67, t69;
  double t70, t71, t72, t73, t74, t76, t78, t79;
  double t81, t83, t84, t85, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t104, t106;
  double t107, t108, t109, t111, t112, t113, t114, t115;
  double t117, t118, t122, t123, t124, t125, t126, t129;
  double t131, t134, t135, t136, t139, t140, t141, t143;
  double t144, t145, t146, t147, t148, t150, t152, t153;
  double t155, t157, t158, t159, t162, t164, t165, t166;
  double t167, t168, t170, t172, t176, tzk0;

  double t177, t178, t179, t181, t184, t185, t189, t190;
  double t191, t194, t195, t197, t198, t201, t203, t204;
  double t205, t206, t207, t208, t210, t212, t214, t216;
  double t217, t218, t222, t225, t226, t229, t230, t233;
  double t234, t235, t238, t239, t242, t243, t247, t248;
  double t251, t252, t258, t260, t261, t266, t268, t273;
  double t274, t276, t279, t280, t284, t287, t289, tvrho0;
  double t293, t296, t297, t302, t304, t307, t308, t312;
  double t314, t315, t318, t319, t320, t321, t322, t324;
  double t326, t328, t330, t331, t332, t336, t339, t340;
  double t343, t344, t347, t348, t349, t352, t353, t356;
  double t357, t361, t362, t365, t366, t372, t374, t375;
  double t380, t382, t387, tvrho1, t392, t394, t396, t398;
  double t400, t401, t402, t405, t406, t409, t413, t414;
  double t416, t420, t421, t430, t432, t436, tvsigma0, tvsigma1;
  double t439, t441, t443, t445, t447, t448, t449, t452;
  double t453, t456, t460, t461, t463, t467, t468, t477;
  double t479, t483, tvsigma2, tvlapl0, tvlapl1, t484, t485, t490;
  double t493, t494, t496, t500, tvtau0, t501, t502, t507;
  double t510, t511, t513, t517, tvtau1;

  double t520, t521, t522, t525, t526, t527, t530, t534;
  double t535, t539, t541, t547, t548, t551, t553, t556;
  double t557, t560, t561, t563, t565, t567, t568, t569;
  double t570, t571, t572, t573, t574, t575, t577, t579;
  double t580, t583, t584, t585, t586, t589, t593, t596;
  double t599, t600, t606, t609, t610, t611, t612, t615;
  double t618, t619, t623, t624, t625, t626, t629, t634;
  double t640, t641, t646, t647, t650, t651, t658, t659;
  double t660, t665, t672, t675, t677, t679, t680, t689;
  double t691, t696, t697, t698, t699, t702, t705, t709;
  double t710, t714, t716, t718, t721, t723, tv2rho20, t726;
  double t730, t734, t735, t739, t741, t749, t750, t754;
  double t758, t759, t763, t765, t772, t775, tv2rho21, t780;
  double t785, t789, t790, t796, t797, t802, t806, t807;
  double t817, t818, t821, t822, t824, t826, t828, t829;
  double t830, t831, t832, t833, t834, t836, t840, t841;
  double t842, t843, t846, t850, t853, t856, t857, t863;
  double t866, t867, t868, t871, t874, t875, t879, t880;
  double t881, t882, t885, t890, t896, t897, t902, t903;
  double t906, t907, t914, t915, t916, t921, t928, t931;
  double t933, t935, t936, t945, t947, t952, tv2rho22, t960;
  double t963, t964, t966, t968, t969, t970, t971, t975;
  double t979, t982, t985, t986, t988, t989, t992, t994;
  double t997, t998, t1001, t1004, t1005, t1014, t1017, t1019;
  double t1021, t1028, t1030, t1032, t1033, t1042, t1043, t1045;
  double t1048, t1054, t1057, t1058, t1066, t1068, t1073, tv2rhosigma0;
  double tv2rhosigma1, t1080, t1082, tv2rhosigma2, t1088, tv2rhosigma3, tv2rhosigma4, t1095;
  double t1096, t1098, t1100, t1101, t1102, t1103, t1107, t1111;
  double t1114, t1117, t1118, t1120, t1121, t1124, t1126, t1129;
  double t1130, t1133, t1136, t1137, t1146, t1148, t1149, t1151;
  double t1153, t1160, t1162, t1164, t1165, t1174, t1175, t1177;
  double t1186, t1189, t1190, t1198, t1200, t1205, tv2rhosigma5, tv2rholapl0;
  double tv2rholapl1, tv2rholapl2, tv2rholapl3, t1212, t1213, t1214, t1215, t1218;
  double t1219, t1220, t1223, t1226, t1229, t1230, t1231, t1232;
  double t1243, t1245, t1248, t1249, t1259, t1260, t1262, t1267;
  double tv2rhotau0, t1274, t1276, tv2rhotau1, t1282, tv2rhotau2, t1287, t1288;
  double t1289, t1292, t1293, t1294, t1297, t1300, t1303, t1304;
  double t1305, t1306, t1317, t1319, t1322, t1323, t1333, t1334;
  double t1336, t1341, tv2rhotau3, t1344, t1345, t1346, t1350, t1351;
  double t1352, t1355, t1358, t1361, t1363, t1365, t1368, t1369;
  double t1372, t1373, t1376, t1379, t1381, t1385, t1386, t1390;
  double t1392, t1396, t1397, t1407, t1409, t1413, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1415, t1416, t1417, t1421, t1422;
  double t1423, t1426, t1429, t1432, t1434, t1436, t1439, t1440;
  double t1443, t1444, t1447, t1450, t1452, t1456, t1457, t1461;
  double t1463, t1467, t1468, t1478, t1480, t1484, tv2sigma25, tv2sigmalapl0;
  double tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4, tv2sigmalapl5, t1485, t1486, t1489;
  double t1490, t1493, t1497, t1499, t1500, t1502, t1503, t1506;
  double t1512, t1514, t1518, t1519, t1525, t1526, t1528, t1532;
  double tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3, tv2sigmatau4, t1533, t1534, t1537;
  double t1538, t1541, t1545, t1547, t1548, t1550, t1551, t1554;
  double t1560, t1562, t1566, t1567, t1573, t1574, t1576, t1580;
  double tv2sigmatau5, tv2lapl20, tv2lapl21, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2, tv2lapltau3;
  double t1582, t1583, t1586, t1587, t1591, t1594, t1595, t1600;
  double t1603, t1604, t1606, t1610, tv2tau20, tv2tau21, t1612, t1613;
  double t1616, t1617, t1621, t1624, t1625, t1630, t1633, t1634;
  double t1636, t1640, tv2tau22;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = sigma[0] * t39;
  t41 = 0.1e1 / params->kappa;
  t45 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t40 * t41;
  t46 = pow(t45, 0.1e1 / 0.5e1);
  t47 = t46 * t46;
  t48 = t47 * t47;
  t49 = 0.1e1 / t48;
  t52 = 0.5e1 / 0.972e3 * t34 * t40 * t49;
  t54 = 0.1e1 / t37 / rho[0];
  t57 = tau[0] * t54 - t40 / 0.8e1;
  t58 = t57 * t57;
  t59 = t29 * t29;
  t61 = 0.3e1 / 0.1e2 * t59 * t32;
  t62 = params->eta * sigma[0];
  t65 = t61 + t62 * t39 / 0.8e1;
  t66 = t65 * t65;
  t67 = 0.1e1 / t66;
  t69 = -t58 * t67 + 0.1e1;
  t70 = t69 * t69;
  t71 = t70 * t69;
  t72 = t58 * t57;
  t73 = t66 * t65;
  t74 = 0.1e1 / t73;
  t76 = t58 * t58;
  t78 = params->b * t76 * t58;
  t79 = t66 * t66;
  t81 = 0.1e1 / t79 / t66;
  t83 = t72 * t74 + t78 * t81 + 0.1e1;
  t84 = 0.1e1 / t83;
  t85 = t71 * t84;
  t88 = 0.5e1 / 0.972e3 * t34 * t40 + params->c;
  t90 = t41 * t88 + 0.1e1;
  t91 = pow(t90, 0.1e1 / 0.5e1);
  t92 = t91 * t91;
  t93 = t92 * t92;
  t94 = 0.1e1 / t93;
  t96 = t88 * t94 - t52;
  t98 = t85 * t96 + t52 + 0.1e1;
  t102 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t98);
  t103 = rho[1] <= p->dens_threshold;
  t104 = -t17;
  t106 = my_piecewise5(t15, t12, t11, t16, t104 * t8);
  t107 = 0.1e1 + t106;
  t108 = t107 <= p->zeta_threshold;
  t109 = POW_1_3(t107);
  t111 = my_piecewise3(t108, t23, t109 * t107);
  t112 = t111 * t27;
  t113 = rho[1] * rho[1];
  t114 = POW_1_3(rho[1]);
  t115 = t114 * t114;
  t117 = 0.1e1 / t115 / t113;
  t118 = sigma[2] * t117;
  t122 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t118 * t41;
  t123 = pow(t122, 0.1e1 / 0.5e1);
  t124 = t123 * t123;
  t125 = t124 * t124;
  t126 = 0.1e1 / t125;
  t129 = 0.5e1 / 0.972e3 * t34 * t118 * t126;
  t131 = 0.1e1 / t115 / rho[1];
  t134 = tau[1] * t131 - t118 / 0.8e1;
  t135 = t134 * t134;
  t136 = params->eta * sigma[2];
  t139 = t61 + t136 * t117 / 0.8e1;
  t140 = t139 * t139;
  t141 = 0.1e1 / t140;
  t143 = -t135 * t141 + 0.1e1;
  t144 = t143 * t143;
  t145 = t144 * t143;
  t146 = t135 * t134;
  t147 = t140 * t139;
  t148 = 0.1e1 / t147;
  t150 = t135 * t135;
  t152 = params->b * t150 * t135;
  t153 = t140 * t140;
  t155 = 0.1e1 / t153 / t140;
  t157 = t146 * t148 + t152 * t155 + 0.1e1;
  t158 = 0.1e1 / t157;
  t159 = t145 * t158;
  t162 = 0.5e1 / 0.972e3 * t34 * t118 + params->c;
  t164 = t162 * t41 + 0.1e1;
  t165 = pow(t164, 0.1e1 / 0.5e1);
  t166 = t165 * t165;
  t167 = t166 * t166;
  t168 = 0.1e1 / t167;
  t170 = t162 * t168 - t129;
  t172 = t159 * t170 + t129 + 0.1e1;
  t176 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t172);
  tzk0 = t102 + t176;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t177 = t7 * t7;
  t178 = 0.1e1 / t177;
  t179 = t17 * t178;
  t181 = my_piecewise5(t11, 0, t15, 0, t8 - t179);
  t184 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t181);
  t185 = t184 * t27;
  t189 = t27 * t27;
  t190 = 0.1e1 / t189;
  t191 = t26 * t190;
  t194 = t6 * t191 * t98 / 0.8e1;
  t195 = t35 * rho[0];
  t197 = 0.1e1 / t37 / t195;
  t198 = sigma[0] * t197;
  t201 = 0.1e2 / 0.729e3 * t34 * t198 * t49;
  t203 = 0.1e1 / t31 / t30;
  t204 = t59 * t203;
  t205 = sigma[0] * sigma[0];
  t206 = t204 * t205;
  t207 = t35 * t35;
  t208 = t207 * t35;
  t210 = 0.1e1 / t36 / t208;
  t212 = 0.1e1 / t48 / t45;
  t214 = t210 * t212 * t41;
  t216 = 0.1e2 / 0.177147e6 * t206 * t214;
  t217 = t70 * t84;
  t218 = t57 * t67;
  t222 = -0.5e1 / 0.3e1 * tau[0] * t39 + t198 / 0.3e1;
  t225 = t58 * t74;
  t226 = t62 * t197;
  t229 = -0.2e1 * t218 * t222 - 0.2e1 / 0.3e1 * t225 * t226;
  t230 = t96 * t229;
  t233 = t83 * t83;
  t234 = 0.1e1 / t233;
  t235 = t71 * t234;
  t238 = 0.1e1 / t79;
  t239 = t72 * t238;
  t242 = params->b * t76 * t57;
  t243 = t81 * t222;
  t247 = 0.1e1 / t79 / t73;
  t248 = t78 * t247;
  t251 = 0.3e1 * t222 * t225 + t226 * t239 + 0.2e1 * t226 * t248 + 0.6e1 * t242 * t243;
  t252 = t96 * t251;
  t258 = 0.1e1 / t93 / t90;
  t260 = t88 * t258 * t29;
  t261 = t33 * sigma[0];
  t266 = -0.1e2 / 0.729e3 * t34 * t198 * t94 + 0.8e1 / 0.729e3 * t260 * t261 * t197 * t41 + t201 - t216;
  t268 = 0.3e1 * t217 * t230 - t235 * t252 + t266 * t85 - t201 + t216;
  t273 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t98 - t194 - 0.3e1 / 0.8e1 * t6 * t28 * t268);
  t274 = t104 * t178;
  t276 = my_piecewise5(t15, 0, t11, 0, -t8 - t274);
  t279 = my_piecewise3(t108, 0, 0.4e1 / 0.3e1 * t109 * t276);
  t280 = t279 * t27;
  t284 = t111 * t190;
  t287 = t6 * t284 * t172 / 0.8e1;
  t289 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t172 - t287);
  tvrho0 = t102 + t176 + t7 * (t273 + t289);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t293 = my_piecewise5(t11, 0, t15, 0, -t8 - t179);
  t296 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t293);
  t297 = t296 * t27;
  t302 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t98 - t194);
  t304 = my_piecewise5(t15, 0, t11, 0, t8 - t274);
  t307 = my_piecewise3(t108, 0, 0.4e1 / 0.3e1 * t109 * t304);
  t308 = t307 * t27;
  t312 = t113 * rho[1];
  t314 = 0.1e1 / t115 / t312;
  t315 = sigma[2] * t314;
  t318 = 0.1e2 / 0.729e3 * t34 * t315 * t126;
  t319 = sigma[2] * sigma[2];
  t320 = t204 * t319;
  t321 = t113 * t113;
  t322 = t321 * t113;
  t324 = 0.1e1 / t114 / t322;
  t326 = 0.1e1 / t125 / t122;
  t328 = t324 * t326 * t41;
  t330 = 0.1e2 / 0.177147e6 * t320 * t328;
  t331 = t144 * t158;
  t332 = t134 * t141;
  t336 = -0.5e1 / 0.3e1 * tau[1] * t117 + t315 / 0.3e1;
  t339 = t135 * t148;
  t340 = t136 * t314;
  t343 = -0.2e1 * t332 * t336 - 0.2e1 / 0.3e1 * t339 * t340;
  t344 = t170 * t343;
  t347 = t157 * t157;
  t348 = 0.1e1 / t347;
  t349 = t145 * t348;
  t352 = 0.1e1 / t153;
  t353 = t146 * t352;
  t356 = params->b * t150 * t134;
  t357 = t155 * t336;
  t361 = 0.1e1 / t153 / t147;
  t362 = t152 * t361;
  t365 = 0.3e1 * t336 * t339 + t340 * t353 + 0.2e1 * t340 * t362 + 0.6e1 * t356 * t357;
  t366 = t170 * t365;
  t372 = 0.1e1 / t167 / t164;
  t374 = t162 * t372 * t29;
  t375 = t33 * sigma[2];
  t380 = -0.1e2 / 0.729e3 * t34 * t315 * t168 + 0.8e1 / 0.729e3 * t374 * t375 * t314 * t41 + t318 - t330;
  t382 = t159 * t380 + 0.3e1 * t331 * t344 - t349 * t366 - t318 + t330;
  t387 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t172 - t287 - 0.3e1 / 0.8e1 * t6 * t112 * t382);
  tvrho1 = t102 + t176 + t7 * (t302 + t387);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t392 = 0.5e1 / 0.972e3 * t34 * t39 * t49;
  t394 = t207 * rho[0];
  t396 = 0.1e1 / t36 / t394;
  t398 = t396 * t212 * t41;
  t400 = 0.5e1 / 0.236196e6 * t204 * sigma[0] * t398;
  t401 = t218 * t39;
  t402 = params->eta * t39;
  t405 = t225 * t402 / 0.4e1 + t401 / 0.4e1;
  t406 = t96 * t405;
  t409 = t225 * t39;
  t413 = t81 * t39;
  t414 = t242 * t413;
  t416 = t247 * params->eta;
  t420 = -0.3e1 / 0.8e1 * t409 - 0.3e1 / 0.8e1 * t239 * t402 - 0.3e1 / 0.4e1 * t414 - 0.3e1 / 0.4e1 * t78 * t416 * t39;
  t421 = t96 * t420;
  t430 = 0.5e1 / 0.972e3 * t34 * t39 * t94 - t260 * t33 * t39 * t41 / 0.243e3 - t392 + t400;
  t432 = 0.3e1 * t217 * t406 - t235 * t421 + t430 * t85 + t392 - t400;
  t436 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t432);
  tvsigma0 = t7 * t436;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t439 = 0.5e1 / 0.972e3 * t34 * t117 * t126;
  t441 = t321 * rho[1];
  t443 = 0.1e1 / t114 / t441;
  t445 = t443 * t326 * t41;
  t447 = 0.5e1 / 0.236196e6 * t204 * sigma[2] * t445;
  t448 = t332 * t117;
  t449 = params->eta * t117;
  t452 = t339 * t449 / 0.4e1 + t448 / 0.4e1;
  t453 = t170 * t452;
  t456 = t339 * t117;
  t460 = t155 * t117;
  t461 = t356 * t460;
  t463 = t361 * params->eta;
  t467 = -0.3e1 / 0.8e1 * t456 - 0.3e1 / 0.8e1 * t353 * t449 - 0.3e1 / 0.4e1 * t461 - 0.3e1 / 0.4e1 * t152 * t463 * t117;
  t468 = t170 * t467;
  t477 = 0.5e1 / 0.972e3 * t34 * t117 * t168 - t374 * t33 * t117 * t41 / 0.243e3 - t439 + t447;
  t479 = t159 * t477 + 0.3e1 * t331 * t453 - t349 * t468 + t439 - t447;
  t483 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t479);
  tvsigma2 = t7 * t483;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvlapl1 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  t484 = t217 * t96;
  t485 = t218 * t54;
  t490 = t81 * t54;
  t493 = 0.3e1 * t225 * t54 + 0.6e1 * t242 * t490;
  t494 = t96 * t493;
  t496 = -t235 * t494 - 0.6e1 * t484 * t485;
  t500 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t496);
  tvtau0 = t7 * t500;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t501 = t331 * t170;
  t502 = t332 * t131;
  t507 = t155 * t131;
  t510 = 0.3e1 * t131 * t339 + 0.6e1 * t356 * t507;
  t511 = t170 * t510;
  t513 = -t349 * t511 - 0.6e1 * t501 * t502;
  t517 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t513);
  tvtau1 = t7 * t517;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

  t520 = t24 * t24;
  t521 = 0.1e1 / t520;
  t522 = t181 * t181;
  t525 = t177 * t7;
  t526 = 0.1e1 / t525;
  t527 = t17 * t526;
  t530 = my_piecewise5(t11, 0, t15, 0, -0.2e1 * t178 + 0.2e1 * t527);
  t534 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t521 * t522 + 0.4e1 / 0.3e1 * t24 * t530);
  t535 = t534 * t27;
  t539 = t184 * t190;
  t541 = t6 * t539 * t98;
  t547 = 0.1e1 / t189 / t7;
  t548 = t26 * t547;
  t551 = t6 * t548 * t98 / 0.12e2;
  t553 = t6 * t191 * t268;
  t556 = 0.1e1 / t37 / t207;
  t557 = sigma[0] * t556;
  t560 = 0.11e3 / 0.2187e4 * t34 * t557 * t49;
  t561 = t207 * t195;
  t563 = 0.1e1 / t36 / t561;
  t565 = t563 * t212 * t41;
  t567 = 0.1e2 / 0.19683e5 * t206 * t565;
  t568 = t30 * t30;
  t569 = 0.1e1 / t568;
  t570 = t205 * sigma[0];
  t571 = t569 * t570;
  t572 = t207 * t207;
  t573 = t572 * t35;
  t574 = 0.1e1 / t573;
  t575 = t45 * t45;
  t577 = 0.1e1 / t48 / t575;
  t579 = params->kappa * params->kappa;
  t580 = 0.1e1 / t579;
  t583 = 0.4e2 / 0.4782969e7 * t571 * t574 * t577 * t580;
  t584 = t69 * t84;
  t585 = t229 * t229;
  t586 = t96 * t585;
  t589 = t70 * t234;
  t593 = t266 * t229;
  t596 = t222 * t222;
  t599 = t57 * t74;
  t600 = t599 * t222;
  t606 = 0.4e2 / 0.9e1 * tau[0] * t197 - 0.11e2 / 0.9e1 * t557;
  t609 = t58 * t238;
  t610 = params->eta * params->eta;
  t611 = t610 * t205;
  t612 = t611 * t563;
  t615 = t62 * t556;
  t618 = -0.2e1 * t596 * t67 - 0.8e1 / 0.3e1 * t600 * t226 - 0.2e1 * t218 * t606 - 0.2e1 / 0.3e1 * t609 * t612 + 0.22e2 / 0.9e1 * t225 * t615;
  t619 = t96 * t618;
  t623 = 0.1e1 / t233 / t83;
  t624 = t71 * t623;
  t625 = t251 * t251;
  t626 = t96 * t625;
  t629 = t266 * t251;
  t634 = t609 * t222;
  t640 = 0.1e1 / t79 / t65;
  t641 = t72 * t640;
  t646 = params->b * t76;
  t647 = t81 * t596;
  t650 = t242 * t247;
  t651 = t222 * params->eta;
  t658 = t79 * t79;
  t659 = 0.1e1 / t658;
  t660 = t78 * t659;
  t665 = 0.6e1 * t599 * t596 + 0.6e1 * t634 * t226 + 0.3e1 * t225 * t606 + 0.4e1 / 0.3e1 * t641 * t612 - 0.11e2 / 0.3e1 * t239 * t615 + 0.3e2 * t646 * t647 + 0.24e2 * t650 * t651 * t198 + 0.6e1 * t242 * t81 * t606 + 0.14e2 / 0.3e1 * t660 * t612 - 0.22e2 / 0.3e1 * t248 * t615;
  t672 = t563 * t258 * t41;
  t675 = t90 * t90;
  t677 = 0.1e1 / t93 / t675;
  t679 = t88 * t677 * t59;
  t680 = t203 * t205;
  t689 = 0.11e3 / 0.2187e4 * t34 * t557 * t94 - 0.16e3 / 0.531441e6 * t206 * t672 + 0.16e2 / 0.59049e5 * t679 * t680 * t563 * t580 - 0.88e2 / 0.2187e4 * t260 * t261 * t556 * t41 - t560 + t567 - t583;
  t691 = -0.6e1 * t230 * t251 * t589 - t235 * t665 * t96 + 0.6e1 * t217 * t593 + 0.3e1 * t217 * t619 - 0.2e1 * t235 * t629 + 0.6e1 * t584 * t586 + 0.2e1 * t624 * t626 + t689 * t85 + t560 - t567 + t583;
  t696 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t98 - t541 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t268 + t551 - t553 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t691);
  t697 = t109 * t109;
  t698 = 0.1e1 / t697;
  t699 = t276 * t276;
  t702 = t104 * t526;
  t705 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t178 + 0.2e1 * t702);
  t709 = my_piecewise3(t108, 0, 0.4e1 / 0.9e1 * t698 * t699 + 0.4e1 / 0.3e1 * t109 * t705);
  t710 = t709 * t27;
  t714 = t279 * t190;
  t716 = t6 * t714 * t172;
  t718 = t111 * t547;
  t721 = t6 * t718 * t172 / 0.12e2;
  t723 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t172 - t716 / 0.4e1 + t721);
  tv2rho20 = 0.2e1 * t273 + 0.2e1 * t289 + t7 * (t696 + t723);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t726 = t521 * t293;
  t730 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t527);
  t734 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t726 * t181 + 0.4e1 / 0.3e1 * t24 * t730);
  t735 = t734 * t27;
  t739 = t296 * t190;
  t741 = t6 * t739 * t98;
  t749 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t98 - t741 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t268 - t541 / 0.8e1 + t551 - t553 / 0.8e1);
  t750 = t698 * t304;
  t754 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t702);
  t758 = my_piecewise3(t108, 0, 0.4e1 / 0.9e1 * t750 * t276 + 0.4e1 / 0.3e1 * t109 * t754);
  t759 = t758 * t27;
  t763 = t307 * t190;
  t765 = t6 * t763 * t172;
  t772 = t6 * t284 * t382;
  t775 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t172 - t765 / 0.8e1 - t716 / 0.8e1 + t721 - 0.3e1 / 0.8e1 * t6 * t280 * t382 - t772 / 0.8e1);
  tv2rho21 = t273 + t289 + t302 + t387 + t7 * (t749 + t775);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t780 = t293 * t293;
  t785 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t178 + 0.2e1 * t527);
  t789 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t521 * t780 + 0.4e1 / 0.3e1 * t24 * t785);
  t790 = t789 * t27;
  t796 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t98 - t741 / 0.4e1 + t551);
  t797 = t304 * t304;
  t802 = my_piecewise5(t15, 0, t11, 0, -0.2e1 * t178 + 0.2e1 * t702);
  t806 = my_piecewise3(t108, 0, 0.4e1 / 0.9e1 * t698 * t797 + 0.4e1 / 0.3e1 * t109 * t802);
  t807 = t806 * t27;
  t817 = 0.1e1 / t115 / t321;
  t818 = sigma[2] * t817;
  t821 = 0.11e3 / 0.2187e4 * t34 * t818 * t126;
  t822 = t321 * t312;
  t824 = 0.1e1 / t114 / t822;
  t826 = t824 * t326 * t41;
  t828 = 0.1e2 / 0.19683e5 * t320 * t826;
  t829 = t319 * sigma[2];
  t830 = t569 * t829;
  t831 = t321 * t321;
  t832 = t831 * t113;
  t833 = 0.1e1 / t832;
  t834 = t122 * t122;
  t836 = 0.1e1 / t125 / t834;
  t840 = 0.4e2 / 0.4782969e7 * t830 * t833 * t836 * t580;
  t841 = t143 * t158;
  t842 = t343 * t343;
  t843 = t170 * t842;
  t846 = t144 * t348;
  t850 = t380 * t343;
  t853 = t336 * t336;
  t856 = t134 * t148;
  t857 = t856 * t336;
  t863 = 0.4e2 / 0.9e1 * tau[1] * t314 - 0.11e2 / 0.9e1 * t818;
  t866 = t135 * t352;
  t867 = t610 * t319;
  t868 = t867 * t824;
  t871 = t136 * t817;
  t874 = -0.2e1 * t853 * t141 - 0.8e1 / 0.3e1 * t857 * t340 - 0.2e1 * t332 * t863 - 0.2e1 / 0.3e1 * t866 * t868 + 0.22e2 / 0.9e1 * t339 * t871;
  t875 = t170 * t874;
  t879 = 0.1e1 / t347 / t157;
  t880 = t145 * t879;
  t881 = t365 * t365;
  t882 = t170 * t881;
  t885 = t380 * t365;
  t890 = t866 * t336;
  t896 = 0.1e1 / t153 / t139;
  t897 = t146 * t896;
  t902 = params->b * t150;
  t903 = t155 * t853;
  t906 = t356 * t361;
  t907 = t336 * params->eta;
  t914 = t153 * t153;
  t915 = 0.1e1 / t914;
  t916 = t152 * t915;
  t921 = 0.6e1 * t856 * t853 + 0.6e1 * t890 * t340 + 0.3e1 * t339 * t863 + 0.4e1 / 0.3e1 * t897 * t868 - 0.11e2 / 0.3e1 * t353 * t871 + 0.3e2 * t902 * t903 + 0.24e2 * t906 * t907 * t315 + 0.6e1 * t356 * t155 * t863 + 0.14e2 / 0.3e1 * t916 * t868 - 0.22e2 / 0.3e1 * t362 * t871;
  t928 = t824 * t372 * t41;
  t931 = t164 * t164;
  t933 = 0.1e1 / t167 / t931;
  t935 = t162 * t933 * t59;
  t936 = t203 * t319;
  t945 = 0.11e3 / 0.2187e4 * t34 * t818 * t168 - 0.16e3 / 0.531441e6 * t320 * t928 + 0.16e2 / 0.59049e5 * t935 * t936 * t824 * t580 - 0.88e2 / 0.2187e4 * t374 * t375 * t817 * t41 - t821 + t828 - t840;
  t947 = -t170 * t349 * t921 - 0.6e1 * t344 * t365 * t846 + t159 * t945 + 0.6e1 * t331 * t850 + 0.3e1 * t331 * t875 - 0.2e1 * t349 * t885 + 0.6e1 * t841 * t843 + 0.2e1 * t880 * t882 + t821 - t828 + t840;
  t952 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t172 - t765 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t382 + t721 - t772 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * t947);
  tv2rho22 = 0.2e1 * t302 + 0.2e1 * t387 + t7 * (t796 + t952);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t960 = t6 * t191 * t432 / 0.8e1;
  t963 = 0.1e2 / 0.729e3 * t34 * t197 * t49;
  t964 = t204 * t210;
  t966 = t212 * sigma[0] * t41;
  t968 = 0.1e2 / 0.59049e5 * t964 * t966;
  t969 = t569 * t205;
  t970 = t572 * rho[0];
  t971 = 0.1e1 / t970;
  t975 = 0.5e1 / 0.1594323e7 * t969 * t971 * t577 * t580;
  t979 = t406 * t251;
  t982 = t266 * t405;
  t985 = t222 * t67;
  t986 = t985 * t39;
  t988 = t210 * params->eta;
  t989 = t988 * sigma[0];
  t992 = t218 * t197;
  t994 = t402 * t222;
  t997 = t610 * t210;
  t998 = t997 * sigma[0];
  t1001 = params->eta * t197;
  t1004 = t986 / 0.4e1 + t599 * t989 / 0.6e1 - 0.2e1 / 0.3e1 * t992 + t599 * t994 / 0.2e1 + t609 * t998 / 0.4e1 - 0.2e1 / 0.3e1 * t225 * t1001;
  t1005 = t96 * t1004;
  t1014 = t266 * t420;
  t1017 = t599 * t39 * t222;
  t1019 = t609 * t989;
  t1021 = t225 * t197;
  t1028 = t646 * t413 * t222;
  t1030 = t650 * t989;
  t1032 = t81 * t197;
  t1033 = t242 * t1032;
  t1042 = -0.3e1 / 0.4e1 * t1017 - 0.3e1 / 0.8e1 * t1019 + t1021 - 0.9e1 / 0.8e1 * t609 * t994 - t641 * t998 / 0.2e1 + t239 * t1001 - 0.15e2 / 0.4e1 * t1028 - 0.3e1 / 0.2e1 * t1030 + 0.2e1 * t1033 - 0.9e1 / 0.2e1 * t650 * t994 - 0.7e1 / 0.4e1 * t660 * t998 + 0.2e1 * t78 * t416 * t197;
  t1043 = t96 * t1042;
  t1045 = t430 * t229;
  t1048 = t430 * t251;
  t1054 = t258 * sigma[0] * t41;
  t1057 = t203 * t210;
  t1058 = t580 * sigma[0];
  t1066 = -0.1e2 / 0.729e3 * t34 * t197 * t94 + 0.2e2 / 0.177147e6 * t964 * t1054 - 0.2e1 / 0.19683e5 * t679 * t1057 * t1058 + 0.8e1 / 0.729e3 * t260 * t33 * t197 * t41 + t963 - t968 + t975;
  t1068 = 0.6e1 * t229 * t406 * t584 - 0.3e1 * t229 * t421 * t589 + 0.2e1 * t251 * t421 * t624 + 0.3e1 * t1005 * t217 - t1014 * t235 - t1043 * t235 + 0.3e1 * t1045 * t217 - t1048 * t235 + t1066 * t85 + 0.3e1 * t217 * t982 - 0.3e1 * t589 * t979 - t963 + t968 - t975;
  t1073 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t432 - t960 - 0.3e1 / 0.8e1 * t6 * t28 * t1068);
  tv2rhosigma0 = t1073 * t7 + t436;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1080 = t6 * t284 * t479 / 0.8e1;
  t1082 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t479 - t1080);
  tv2rhosigma2 = t1082 * t7 + t483;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1088 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t432 - t960);
  tv2rhosigma3 = t1088 * t7 + t436;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1095 = 0.1e2 / 0.729e3 * t34 * t314 * t126;
  t1096 = t204 * t324;
  t1098 = t326 * sigma[2] * t41;
  t1100 = 0.1e2 / 0.59049e5 * t1096 * t1098;
  t1101 = t569 * t319;
  t1102 = t831 * rho[1];
  t1103 = 0.1e1 / t1102;
  t1107 = 0.5e1 / 0.1594323e7 * t1101 * t1103 * t836 * t580;
  t1111 = t453 * t365;
  t1114 = t380 * t452;
  t1117 = t336 * t141;
  t1118 = t1117 * t117;
  t1120 = t324 * params->eta;
  t1121 = t1120 * sigma[2];
  t1124 = t332 * t314;
  t1126 = t449 * t336;
  t1129 = t610 * t324;
  t1130 = t1129 * sigma[2];
  t1133 = params->eta * t314;
  t1136 = t1118 / 0.4e1 + t856 * t1121 / 0.6e1 - 0.2e1 / 0.3e1 * t1124 + t856 * t1126 / 0.2e1 + t866 * t1130 / 0.4e1 - 0.2e1 / 0.3e1 * t339 * t1133;
  t1137 = t170 * t1136;
  t1146 = t380 * t467;
  t1148 = t117 * t336;
  t1149 = t856 * t1148;
  t1151 = t866 * t1121;
  t1153 = t339 * t314;
  t1160 = t902 * t460 * t336;
  t1162 = t906 * t1121;
  t1164 = t155 * t314;
  t1165 = t356 * t1164;
  t1174 = -0.3e1 / 0.4e1 * t1149 - 0.3e1 / 0.8e1 * t1151 + t1153 - 0.9e1 / 0.8e1 * t866 * t1126 - t897 * t1130 / 0.2e1 + t353 * t1133 - 0.15e2 / 0.4e1 * t1160 - 0.3e1 / 0.2e1 * t1162 + 0.2e1 * t1165 - 0.9e1 / 0.2e1 * t906 * t1126 - 0.7e1 / 0.4e1 * t916 * t1130 + 0.2e1 * t152 * t463 * t314;
  t1175 = t170 * t1174;
  t1177 = t477 * t343;
  t1186 = t372 * sigma[2] * t41;
  t1189 = t203 * t324;
  t1190 = t580 * sigma[2];
  t1198 = -0.1e2 / 0.729e3 * t34 * t314 * t168 + 0.2e2 / 0.177147e6 * t1096 * t1186 - 0.2e1 / 0.19683e5 * t935 * t1189 * t1190 + 0.8e1 / 0.729e3 * t374 * t33 * t314 * t41 + t1095 - t1100 + t1107;
  t1200 = 0.6e1 * t343 * t453 * t841 - 0.3e1 * t343 * t468 * t846 - t349 * t365 * t477 + 0.2e1 * t365 * t468 * t880 - 0.3e1 * t1111 * t846 + 0.3e1 * t1114 * t331 + 0.3e1 * t1137 * t331 - t1146 * t349 - t1175 * t349 + 0.3e1 * t1177 * t331 + t1198 * t159 - t1095 + t1100 - t1107;
  t1205 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t479 - t1080 - 0.3e1 / 0.8e1 * t6 * t112 * t1200);
  tv2rhosigma5 = t1205 * t7 + t483;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  tv2rholapl1 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 1] += tv2rholapl1;

  tv2rholapl2 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 2] += tv2rholapl2;

  tv2rholapl3 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 3] += tv2rholapl3;

  t1212 = t6 * t191 * t496 / 0.8e1;
  t1213 = t584 * t96;
  t1214 = t54 * t229;
  t1215 = t218 * t1214;
  t1218 = t589 * t96;
  t1219 = t54 * t251;
  t1220 = t218 * t1219;
  t1223 = t217 * t266;
  t1226 = t985 * t54;
  t1229 = t96 * t57;
  t1230 = t217 * t1229;
  t1231 = t74 * t396;
  t1232 = t1231 * t62;
  t1243 = t266 * t493;
  t1245 = t54 * t222;
  t1248 = t396 * params->eta;
  t1249 = t1248 * sigma[0];
  t1259 = 0.3e2 * t222 * t490 * t646 + 0.6e1 * t1245 * t599 + 0.3e1 * t1249 * t609 + 0.12e2 * t1249 * t650 - 0.5e1 * t409 - 0.1e2 * t414;
  t1260 = t96 * t1259;
  t1262 = -0.3e1 * t229 * t494 * t589 + 0.2e1 * t251 * t494 * t624 - 0.12e2 * t1213 * t1215 + 0.6e1 * t1218 * t1220 - 0.6e1 * t1223 * t485 - 0.6e1 * t1226 * t484 - 0.4e1 * t1230 * t1232 - t1243 * t235 - t1260 * t235 + 0.1e2 * t401 * t484;
  t1267 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t496 - t1212 - 0.3e1 / 0.8e1 * t6 * t28 * t1262);
  tv2rhotau0 = t1267 * t7 + t500;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t1274 = t6 * t284 * t513 / 0.8e1;
  t1276 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t513 - t1274);
  tv2rhotau1 = t1276 * t7 + t517;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 1] += tv2rhotau1;

  t1282 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t496 - t1212);
  tv2rhotau2 = t1282 * t7 + t500;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 2] += tv2rhotau2;

  t1287 = t841 * t170;
  t1288 = t131 * t343;
  t1289 = t332 * t1288;
  t1292 = t846 * t170;
  t1293 = t131 * t365;
  t1294 = t332 * t1293;
  t1297 = t331 * t380;
  t1300 = t1117 * t131;
  t1303 = t170 * t134;
  t1304 = t331 * t1303;
  t1305 = t148 * t443;
  t1306 = t1305 * t136;
  t1317 = t380 * t510;
  t1319 = t131 * t336;
  t1322 = t443 * params->eta;
  t1323 = t1322 * sigma[2];
  t1333 = 0.3e2 * t336 * t507 * t902 + 0.6e1 * t1319 * t856 + 0.3e1 * t1323 * t866 + 0.12e2 * t1323 * t906 - 0.5e1 * t456 - 0.1e2 * t461;
  t1334 = t170 * t1333;
  t1336 = -0.3e1 * t343 * t511 * t846 + 0.2e1 * t365 * t511 * t880 - 0.12e2 * t1287 * t1289 + 0.6e1 * t1292 * t1294 - 0.6e1 * t1297 * t502 - 0.6e1 * t1300 * t501 - 0.4e1 * t1304 * t1306 - t1317 * t349 - t1334 * t349 + 0.1e2 * t448 * t501;
  t1341 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t513 - t1274 - 0.3e1 / 0.8e1 * t6 * t112 * t1336);
  tv2rhotau3 = t1341 * t7 + t517;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 3] += tv2rhotau3;

  t1344 = 0.5e1 / 0.118098e6 * t204 * t398;
  t1345 = t569 * sigma[0];
  t1346 = 0.1e1 / t572;
  t1350 = 0.5e1 / 0.4251528e7 * t1345 * t1346 * t577 * t580;
  t1351 = t405 * t405;
  t1352 = t96 * t1351;
  t1355 = t406 * t420;
  t1358 = t430 * t405;
  t1361 = t396 * t67;
  t1363 = t599 * t1248;
  t1365 = t610 * t396;
  t1368 = -t1361 / 0.32e2 - t1363 / 0.8e1 - 0.3e1 / 0.32e2 * t609 * t1365;
  t1369 = t96 * t1368;
  t1372 = t420 * t420;
  t1373 = t96 * t1372;
  t1376 = t430 * t420;
  t1379 = t599 * t396;
  t1381 = t609 * t1248;
  t1385 = t81 * t396;
  t1386 = t646 * t1385;
  t1390 = t242 * t247 * t396 * params->eta;
  t1392 = t659 * t610;
  t1396 = 0.3e1 / 0.32e2 * t1379 + 0.9e1 / 0.32e2 * t1381 + 0.3e1 / 0.16e2 * t641 * t1365 + 0.15e2 / 0.32e2 * t1386 + 0.9e1 / 0.8e1 * t1390 + 0.21e2 / 0.32e2 * t78 * t1392 * t396;
  t1397 = t96 * t1396;
  t1407 = -0.5e1 / 0.118098e6 * t204 * t396 * t258 * t41 + t679 * t203 * t396 * t580 / 0.26244e5 + t1344 - t1350;
  t1409 = 0.6e1 * t1352 * t584 - 0.6e1 * t1355 * t589 + 0.6e1 * t1358 * t217 + 0.3e1 * t1369 * t217 + 0.2e1 * t1373 * t624 - 0.2e1 * t1376 * t235 - t1397 * t235 + t1407 * t85 - t1344 + t1350;
  t1413 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t1409);
  tv2sigma20 = t7 * t1413;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1415 = 0.5e1 / 0.118098e6 * t204 * t445;
  t1416 = t569 * sigma[2];
  t1417 = 0.1e1 / t831;
  t1421 = 0.5e1 / 0.4251528e7 * t1416 * t1417 * t836 * t580;
  t1422 = t452 * t452;
  t1423 = t170 * t1422;
  t1426 = t453 * t467;
  t1429 = t477 * t452;
  t1432 = t443 * t141;
  t1434 = t856 * t1322;
  t1436 = t610 * t443;
  t1439 = -t1432 / 0.32e2 - t1434 / 0.8e1 - 0.3e1 / 0.32e2 * t866 * t1436;
  t1440 = t170 * t1439;
  t1443 = t467 * t467;
  t1444 = t170 * t1443;
  t1447 = t477 * t467;
  t1450 = t856 * t443;
  t1452 = t866 * t1322;
  t1456 = t155 * t443;
  t1457 = t902 * t1456;
  t1461 = t356 * t361 * t443 * params->eta;
  t1463 = t915 * t610;
  t1467 = 0.3e1 / 0.32e2 * t1450 + 0.9e1 / 0.32e2 * t1452 + 0.3e1 / 0.16e2 * t897 * t1436 + 0.15e2 / 0.32e2 * t1457 + 0.9e1 / 0.8e1 * t1461 + 0.21e2 / 0.32e2 * t152 * t1463 * t443;
  t1468 = t170 * t1467;
  t1478 = -0.5e1 / 0.118098e6 * t204 * t443 * t372 * t41 + t935 * t203 * t443 * t580 / 0.26244e5 + t1415 - t1421;
  t1480 = 0.6e1 * t1423 * t841 - 0.6e1 * t1426 * t846 + 0.6e1 * t1429 * t331 + 0.3e1 * t1440 * t331 + 0.2e1 * t1444 * t880 - 0.2e1 * t1447 * t349 - t1468 * t349 + t1478 * t159 - t1415 + t1421;
  t1484 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t1480);
  tv2sigma25 = t7 * t1484;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 4] += tv2sigmalapl4;

  tv2sigmalapl5 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 5] += tv2sigmalapl5;

  t1485 = t54 * t405;
  t1486 = t218 * t1485;
  t1489 = t54 * t420;
  t1490 = t218 * t1489;
  t1493 = t217 * t430;
  t1497 = 0.1e1 / t36 / t207;
  t1499 = t96 * t1497 * t67;
  t1500 = t217 * t1499;
  t1502 = t1497 * params->eta;
  t1503 = t599 * t1502;
  t1506 = t494 * t405;
  t1512 = t430 * t493;
  t1514 = t599 * t1497;
  t1518 = t81 * t1497;
  t1519 = t646 * t1518;
  t1525 = -0.3e1 / 0.4e1 * t1514 - 0.9e1 / 0.8e1 * t609 * t1502 - 0.15e2 / 0.4e1 * t1519 - 0.9e1 / 0.2e1 * t242 * t247 * t1497 * params->eta;
  t1526 = t96 * t1525;
  t1528 = -0.12e2 * t1213 * t1486 + 0.6e1 * t1218 * t1490 - 0.6e1 * t1493 * t485 + 0.3e1 / 0.4e1 * t1500 + 0.3e1 / 0.2e1 * t484 * t1503 - 0.3e1 * t589 * t1506 + 0.2e1 * t624 * t494 * t420 - t235 * t1512 - t235 * t1526;
  t1532 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t1528);
  tv2sigmatau0 = t7 * t1532;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 4] += tv2sigmatau4;

  t1533 = t131 * t452;
  t1534 = t332 * t1533;
  t1537 = t131 * t467;
  t1538 = t332 * t1537;
  t1541 = t331 * t477;
  t1545 = 0.1e1 / t114 / t321;
  t1547 = t170 * t1545 * t141;
  t1548 = t331 * t1547;
  t1550 = t1545 * params->eta;
  t1551 = t856 * t1550;
  t1554 = t511 * t452;
  t1560 = t477 * t510;
  t1562 = t856 * t1545;
  t1566 = t155 * t1545;
  t1567 = t902 * t1566;
  t1573 = -0.3e1 / 0.4e1 * t1562 - 0.9e1 / 0.8e1 * t866 * t1550 - 0.15e2 / 0.4e1 * t1567 - 0.9e1 / 0.2e1 * t356 * t361 * t1545 * params->eta;
  t1574 = t170 * t1573;
  t1576 = -0.12e2 * t1287 * t1534 + 0.6e1 * t1292 * t1538 - 0.6e1 * t1541 * t502 + 0.3e1 / 0.4e1 * t1548 + 0.3e1 / 0.2e1 * t501 * t1551 - 0.3e1 * t846 * t1554 + 0.2e1 * t880 * t511 * t467 - t349 * t1560 - t349 * t1574;
  t1580 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t1576);
  tv2sigmatau5 = t7 * t1580;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 5] += tv2sigmatau5;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 1] += tv2lapl21;

  tv2lapl22 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 3] += tv2lapltau3;

  t1582 = 0.1e1 / t36 / t195;
  t1583 = t609 * t1582;
  t1586 = t54 * t493;
  t1587 = t218 * t1586;
  t1591 = t96 * t1582 * t67;
  t1594 = t493 * t493;
  t1595 = t96 * t1594;
  t1600 = t81 * t1582;
  t1603 = 0.6e1 * t1582 * t599 + 0.3e2 * t1600 * t646;
  t1604 = t96 * t1603;
  t1606 = 0.24e2 * t1213 * t1583 + 0.12e2 * t1218 * t1587 - 0.6e1 * t1591 * t217 + 0.2e1 * t1595 * t624 - t1604 * t235;
  t1610 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t1606);
  tv2tau20 = t7 * t1610;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 1] += tv2tau21;

  t1612 = 0.1e1 / t114 / t312;
  t1613 = t866 * t1612;
  t1616 = t131 * t510;
  t1617 = t332 * t1616;
  t1621 = t170 * t1612 * t141;
  t1624 = t510 * t510;
  t1625 = t170 * t1624;
  t1630 = t155 * t1612;
  t1633 = 0.6e1 * t1612 * t856 + 0.3e2 * t1630 * t902;
  t1634 = t170 * t1633;
  t1636 = 0.24e2 * t1287 * t1613 + 0.12e2 * t1292 * t1617 - 0.6e1 * t1621 * t331 + 0.2e1 * t1625 * t880 - t1634 * t349;
  t1640 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t1636);
  tv2tau22 = t7 * t1640;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 2] += tv2tau22;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t11, t12;
  double t15, t16, t17, t19, t20, t21, t22, t23;
  double t24, t26, t27, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t45, t46, t47, t48, t49, t52, t54, t57;
  double t58, t59, t61, t62, t65, t66, t67, t69;
  double t70, t71, t72, t73, t74, t76, t78, t79;
  double t81, t83, t84, t85, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t104, t106;
  double t107, t108, t109, t111, t112, t113, t114, t115;
  double t117, t118, t122, t123, t124, t125, t126, t129;
  double t131, t134, t135, t136, t139, t140, t141, t143;
  double t144, t145, t146, t147, t148, t150, t152, t153;
  double t155, t157, t158, t159, t162, t164, t165, t166;
  double t167, t168, t170, t172, t176, tzk0;

  double t177, t178, t179, t181, t184, t185, t189, t190;
  double t191, t194, t195, t197, t198, t201, t203, t204;
  double t205, t206, t207, t208, t210, t212, t214, t216;
  double t217, t218, t222, t225, t226, t229, t230, t233;
  double t234, t235, t238, t239, t242, t243, t247, t248;
  double t251, t252, t258, t260, t261, t266, t268, t273;
  double t274, t276, t279, t280, t284, t287, t289, tvrho0;
  double t293, t296, t297, t302, t304, t307, t308, t312;
  double t314, t315, t318, t319, t320, t321, t322, t324;
  double t326, t328, t330, t331, t332, t336, t339, t340;
  double t343, t344, t347, t348, t349, t352, t353, t356;
  double t357, t361, t362, t365, t366, t372, t374, t375;
  double t380, t382, t387, tvrho1, t392, t394, t396, t398;
  double t400, t401, t402, t405, t406, t409, t413, t414;
  double t416, t420, t421, t430, t432, t436, tvsigma0, tvsigma1;
  double t439, t441, t443, t445, t447, t448, t449, t452;
  double t453, t456, t460, t461, t463, t467, t468, t477;
  double t479, t483, tvsigma2, tvlapl0, tvlapl1, t484, t485, t490;
  double t493, t494, t496, t500, tvtau0, t501, t502, t507;
  double t510, t511, t513, t517, tvtau1;

  double t520, t521, t522, t525, t526, t527, t530, t534;
  double t535, t539, t541, t547, t548, t551, t553, t556;
  double t557, t560, t561, t563, t565, t567, t568, t569;
  double t570, t571, t572, t573, t574, t575, t577, t579;
  double t580, t583, t584, t585, t586, t589, t593, t596;
  double t599, t600, t606, t609, t610, t611, t612, t615;
  double t618, t619, t623, t624, t625, t626, t629, t634;
  double t640, t641, t646, t647, t650, t651, t658, t659;
  double t660, t665, t672, t675, t677, t679, t680, t689;
  double t691, t696, t697, t698, t699, t702, t705, t709;
  double t710, t714, t716, t718, t721, t723, tv2rho20, t726;
  double t730, t734, t735, t739, t741, t749, t750, t754;
  double t758, t759, t763, t765, t772, t775, tv2rho21, t780;
  double t785, t789, t790, t796, t797, t802, t806, t807;
  double t817, t818, t821, t822, t824, t826, t828, t829;
  double t830, t831, t832, t833, t834, t836, t840, t841;
  double t842, t843, t846, t850, t853, t856, t857, t863;
  double t866, t867, t868, t871, t874, t875, t879, t880;
  double t881, t882, t885, t890, t896, t897, t902, t903;
  double t906, t907, t914, t915, t916, t921, t928, t931;
  double t933, t935, t936, t945, t947, t952, tv2rho22, t960;
  double t963, t964, t966, t968, t969, t970, t971, t975;
  double t979, t982, t985, t986, t988, t989, t992, t994;
  double t997, t998, t1001, t1004, t1005, t1014, t1017, t1019;
  double t1021, t1028, t1030, t1032, t1033, t1042, t1043, t1045;
  double t1048, t1054, t1057, t1058, t1066, t1068, t1073, tv2rhosigma0;
  double tv2rhosigma1, t1080, t1082, tv2rhosigma2, t1088, tv2rhosigma3, tv2rhosigma4, t1095;
  double t1096, t1098, t1100, t1101, t1102, t1103, t1107, t1111;
  double t1114, t1117, t1118, t1120, t1121, t1124, t1126, t1129;
  double t1130, t1133, t1136, t1137, t1146, t1148, t1149, t1151;
  double t1153, t1160, t1162, t1164, t1165, t1174, t1175, t1177;
  double t1186, t1189, t1190, t1198, t1200, t1205, tv2rhosigma5, tv2rholapl0;
  double tv2rholapl1, tv2rholapl2, tv2rholapl3, t1212, t1213, t1214, t1215, t1218;
  double t1219, t1220, t1223, t1226, t1229, t1230, t1231, t1232;
  double t1243, t1245, t1248, t1249, t1259, t1260, t1262, t1267;
  double tv2rhotau0, t1274, t1276, tv2rhotau1, t1282, tv2rhotau2, t1287, t1288;
  double t1289, t1292, t1293, t1294, t1297, t1300, t1303, t1304;
  double t1305, t1306, t1317, t1319, t1322, t1323, t1333, t1334;
  double t1336, t1341, tv2rhotau3, t1344, t1345, t1346, t1350, t1351;
  double t1352, t1355, t1358, t1361, t1363, t1365, t1368, t1369;
  double t1372, t1373, t1376, t1379, t1381, t1385, t1386, t1390;
  double t1392, t1396, t1397, t1407, t1409, t1413, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1415, t1416, t1417, t1421, t1422;
  double t1423, t1426, t1429, t1432, t1434, t1436, t1439, t1440;
  double t1443, t1444, t1447, t1450, t1452, t1456, t1457, t1461;
  double t1463, t1467, t1468, t1478, t1480, t1484, tv2sigma25, tv2sigmalapl0;
  double tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4, tv2sigmalapl5, t1485, t1486, t1489;
  double t1490, t1493, t1497, t1499, t1500, t1502, t1503, t1506;
  double t1512, t1514, t1518, t1519, t1525, t1526, t1528, t1532;
  double tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3, tv2sigmatau4, t1533, t1534, t1537;
  double t1538, t1541, t1545, t1547, t1548, t1550, t1551, t1554;
  double t1560, t1562, t1566, t1567, t1573, t1574, t1576, t1580;
  double tv2sigmatau5, tv2lapl20, tv2lapl21, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2, tv2lapltau3;
  double t1582, t1583, t1586, t1587, t1591, t1594, t1595, t1600;
  double t1603, t1604, t1606, t1610, tv2tau20, tv2tau21, t1612, t1613;
  double t1616, t1617, t1621, t1624, t1625, t1630, t1633, t1634;
  double t1636, t1640, tv2tau22;

  double t1644, t1645, t1648, t1651, t1652, t1653, t1656, t1660;
  double t1661, t1665, t1667, t1672, t1674, t1677, t1683, t1684;
  double t1687, t1689, t1692, t1694, t1699, t1700, t1703, t1705;
  double t1709, t1710, t1711, t1712, t1713, t1720, t1721, t1725;
  double t1726, t1742, t1756, t1757, t1758, t1761, t1773, t1774;
  double t1775, t1777, t1781, t1783, t1785, t1786, t1788, t1789;
  double t1792, t1795, t1798, t1803, t1806, t1807, t1810, t1818;
  double t1821, t1822, t1823, t1824, t1827, t1830, t1833, t1834;
  double t1850, t1851, t1854, t1857, t1860, t1867, t1870, t1871;
  double t1882, t1890, t1891, t1895, t1896, t1899, t1900, t1901;
  double t1909, t1912, t1913, t1918, t1920, t1921, t1924, t1927;
  double t1930, t1934, t1935, t1939, t1941, t1943, t1945, t1947;
  double t1950, t1952, tv3rho30, t1955, t1956, t1957, t1960, t1965;
  double t1966, t1968, t1972, t1973, t1977, t1980, t1984, t1986;
  double t1990, t1999, t2000, t2001, t2004, t2009, t2011, t2015;
  double t2016, t2020, t2023, t2024, t2026, t2035, t2037, t2040;
  double tv3rho31, t2043, t2048, t2052, t2056, t2057, t2061, t2063;
  double t2072, t2073, t2078, t2082, t2086, t2087, t2091, t2093;
  double t2100, t2108, t2110, t2111, tv3rho32, t2116, t2123, t2127;
  double t2128, t2135, t2136, t2143, t2147, t2148, t2163, t2164;
  double t2168, t2169, t2185, t2186, t2187, t2188, t2189, t2195;
  double t2200, t2201, t2204, t2206, t2210, t2211, t2225, t2226;
  double t2227, t2228, t2240, t2241, t2242, t2244, t2248, t2250;
  double t2252, t2253, t2255, t2256, t2259, t2262, t2265, t2270;
  double t2273, t2274, t2277, t2285, t2288, t2289, t2290, t2293;
  double t2296, t2299, t2300, t2312, t2315, t2316, t2327, t2328;
  double t2331, t2334, t2337, t2348, t2358, t2359, t2363, t2364;
  double t2367, t2368, t2369, t2375, t2378, t2379, t2384, tv3rho33;
  double t2392, t2399, t2401, t2427, t2436, t2438, t2440, t2456;
  double t2457, t2458, t2461, t2462, t2464, t2465, t2466, t2467;
  double t2470, t2472, t2475, t2481, t2484, t2487, t2490, t2491;
  double t2492, t2494, t2497, t2498, t2502, t2504, t2505, t2506;
  double t2508, t2511, t2514, t2515, t2519, t2522, t2527, t2529;
  double t2531, t2535, t2537, t2544, t2545, t2548, t2554, t2555;
  double t2556, t2559, t2561, t2564, t2565, t2567, t2568, t2570;
  double t2572, t2574, t2575, t2576, t2578, t2579, t2581, t2584;
  double t2590, t2594, t2606, t2607, t2610, t2612, t2615, t2624;
  double t2627, t2631, t2641, t2642, t2644, t2647, t2650, t2653;
  double t2654, t2659, tv3rho2sigma0, tv3rho2sigma1, t2666, t2670, t2672, tv3rho2sigma2;
  double t2678, t2686, tv3rho2sigma3, tv3rho2sigma4, t2692, t2699, t2702, tv3rho2sigma5;
  double t2710, tv3rho2sigma6, tv3rho2sigma7, t2721, t2769, t2771, t2773, t2774;
  double t2775, t2776, t2779, t2780, t2781, t2782, t2785, t2787;
  double t2788, t2790, t2793, t2794, t2800, t2803, t2806, t2809;
  double t2810, t2812, t2815, t2817, t2818, t2821, t2822, t2825;
  double t2829, t2830, t2831, t2833, t2836, t2839, t2840, t2843;
  double t2844, t2847, t2850, t2851, t2854, t2860, t2865, t2868;
  double t2873, t2875, t2881, t2883, t2889, t2895, t2896, t2897;
  double t2898, t2900, t2905, t2912, t2914, t2920, t2921, t2924;
  double t2926, t2927, t2929, t2931, t2933, t2934, t2935, t2937;
  double t2940, t2942, t2947, t2954, t2957, t2961, t2969, t2971;
  double t2972, t2977, tv3rho2sigma8, tv3rho2lapl0, tv3rho2lapl1, tv3rho2lapl2, tv3rho2lapl3, tv3rho2lapl4;
  double tv3rho2lapl5, t2984, t2991, t2993, t2995, t2997, t2998, t2999;
  double t3000, t3003, t3004, t3005, t3006, t3033, t3036, t3039;
  double t3040, t3043, t3044, t3047, t3048, t3051, t3052, t3055;
  double t3056, t3059, t3062, t3063, t3072, t3075, t3080, t3083;
  double t3084, t3087, t3088, t3089, t3090, t3093, t3094, t3097;
  double t3098, t3101, t3102, t3105, t3106, t3109, t3114, t3118;
  double t3121, t3122, t3142, t3143, t3145, t3146, t3151, tv3rho2tau0;
  double t3158, t3162, t3164, tv3rho2tau1, t3170, t3178, tv3rho2tau2, t3184;
  double t3191, t3194, tv3rho2tau3, t3202, tv3rho2tau4, t3237, t3238, t3239;
  double t3240, t3243, t3244, t3245, t3246, t3251, t3260, t3263;
  double t3264, t3267, t3268, t3271, t3272, t3275, t3276, t3279;
  double t3280, t3283, t3284, t3287, t3290, t3293, t3294, t3297;
  double t3300, t3303, t3304, t3307, t3308, t3311, t3312, t3315;
  double t3316, t3319, t3320, t3321, t3322, t3325, t3330, t3334;
  double t3337, t3338, t3358, t3359, t3361, t3363, t3364, t3369;
  double tv3rho2tau5, t3376, t3377, t3378, t3381, t3385, t3388, t3391;
  double t3392, t3394, t3396, t3399, t3401, t3404, t3405, t3410;
  double t3411, t3414, t3417, t3420, t3423, t3425, t3426, t3427;
  double t3429, t3431, t3432, t3434, t3436, t3444, t3446, t3448;
  double t3449, t3451, t3453, t3457, t3466, t3467, t3469, t3474;
  double t3477, t3480, t3483, t3485, t3488, t3495, t3496, t3497;
  double t3508, t3509, t3510, t3512, t3513, t3515, t3537, t3540;
  double t3564, t3565, t3570, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24;
  double t3577, t3579, tv3rhosigma25, t3585, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t3590, t3591, t3594, t3598, t3601, t3605, t3606;
  double t3607, t3609, t3611, t3645, t3652, t3655, t3658, t3663;
  double t3666, t3669, t3672, t3675, t3680, t3681, t3683, t3685;
  double t3688, t3690, t3693, t3694, t3699, t3700, t3703, t3706;
  double t3709, t3712, t3714, t3716, t3717, t3718, t3720, t3722;
  double t3723, t3725, t3727, t3735, t3737, t3739, t3740, t3742;
  double t3744, t3748, t3757, t3758, t3764, t3765, t3775, t3777;
  double t3778, t3783, tv3rhosigma211, tv3rhosigmalapl0, tv3rhosigmalapl1, tv3rhosigmalapl2, tv3rhosigmalapl3, tv3rhosigmalapl4;
  double tv3rhosigmalapl5, tv3rhosigmalapl6, tv3rhosigmalapl7, tv3rhosigmalapl8, tv3rhosigmalapl9, tv3rhosigmalapl10, tv3rhosigmalapl11, t3790;
  double t3793, t3796, t3797, t3798, t3800, t3801, t3804, t3805;
  double t3810, t3813, t3814, t3819, t3822, t3823, t3826, t3829;
  double t3832, t3835, t3838, t3839, t3840, t3843, t3844, t3845;
  double t3848, t3849, t3852, t3855, t3856, t3857, t3860, t3861;
  double t3864, t3865, t3868, t3871, t3872, t3873, t3876, t3880;
  double t3911, t3916, t3917, t3919, t3921, t3923, t3924, t3925;
  double t3928, t3931, t3932, t3937, t3939, t3947, t3948, t3950;
  double t3954, t3955, t3956, t3958, t3959, t3961, t3962, t3965;
  double t3968, t3969, t3972, t3973, t3976, t3981, t3983, t3988;
  double tv3rhosigmatau0, tv3rhosigmatau1, tv3rhosigmatau2, tv3rhosigmatau3, tv3rhosigmatau4, t3995, t3997, tv3rhosigmatau5;
  double t4003, tv3rhosigmatau6, tv3rhosigmatau7, tv3rhosigmatau8, tv3rhosigmatau9, tv3rhosigmatau10, t4008, t4009;
  double t4010, t4013, t4014, t4015, t4018, t4019, t4022, t4025;
  double t4026, t4027, t4030, t4031, t4034, t4035, t4038, t4041;
  double t4042, t4043, t4046, t4048, t4049, t4050, t4053, t4056;
  double t4057, t4062, t4064, t4072, t4073, t4075, t4077, t4079;
  double t4080, t4084, t4109, t4117, t4126, t4127, t4128, t4130;
  double t4131, t4134, t4137, t4138, t4141, t4142, t4145, t4148;
  double t4149, t4151, t4152, t4157, t4158, t4159, t4160, t4164;
  double t4167, t4168, t4171, t4172, t4175, t4178, t4181, t4186;
  double t4189, t4190, t4195, t4198, t4200, t4205, tv3rhosigmatau11, tv3rholapl20;
  double tv3rholapl21, tv3rholapl22, tv3rholapl23, tv3rholapl24, tv3rholapl25, tv3rholapltau0, tv3rholapltau1, tv3rholapltau2;
  double tv3rholapltau3, tv3rholapltau4, tv3rholapltau5, tv3rholapltau6, tv3rholapltau7, t4212, t4213, t4214;
  double t4215, t4218, t4221, t4225, t4226, t4227, t4237, t4238;
  double t4240, t4241, t4242, t4243, t4246, t4249, t4250, t4272;
  double t4273, t4280, t4281, t4284, t4290, t4293, t4294, t4297;
  double t4298, t4302, t4306, t4309, t4310, t4313, t4314, t4319;
  double tv3rhotau20, tv3rhotau21, t4326, t4328, tv3rhotau22, t4334, tv3rhotau23, tv3rhotau24;
  double t4339, t4340, t4341, t4344, t4347, t4348, t4351, t4352;
  double t4353, t4354, t4355, t4377, t4380, t4381, t4384, t4387;
  double t4393, t4394, t4397, t4398, t4401, t4402, t4406, t4410;
  double t4415, t4418, t4421, t4425, t4426, t4436, t4437, t4439;
  double t4440, t4445, tv3rhotau25, t4447, t4450, t4453, t4457, t4459;
  double t4461, t4464, t4465, t4469, t4473, t4475, t4479, t4480;
  double t4485, t4486, t4492, t4495, t4507, t4514, t4516, t4519;
  double t4520, t4522, t4523, t4526, t4529, t4532, t4535, t4537;
  double t4541, t4542, t4545, t4549, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t4550, t4557, t4559;
  double t4562, t4563, t4565, t4568, t4571, t4573, t4575, t4578;
  double t4579, t4582, t4585, t4588, t4592, t4594, t4598, t4599;
  double t4603, t4607, t4609, t4613, t4614, t4616, t4617, t4620;
  double t4626, t4629, t4641, t4642, t4648, t4652, tv3sigma39, tv3sigma2lapl0;
  double tv3sigma2lapl1, tv3sigma2lapl2, tv3sigma2lapl3, tv3sigma2lapl4, tv3sigma2lapl5, tv3sigma2lapl6, tv3sigma2lapl7, tv3sigma2lapl8;
  double tv3sigma2lapl9, tv3sigma2lapl10, tv3sigma2lapl11, t4656, t4661, t4669, t4672, t4675;
  double t4690, t4693, t4694, t4697, t4698, t4699, t4701, t4702;
  double t4704, t4707, t4708, t4711, t4713, t4716, t4717, t4721;
  double t4727, t4728, t4730, t4732, t4737, t4738, t4743, t4746;
  double t4747, t4752, t4753, t4756, t4757, t4761, tv3sigma2tau0, tv3sigma2tau1;
  double tv3sigma2tau2, tv3sigma2tau3, tv3sigma2tau4, tv3sigma2tau5, tv3sigma2tau6, tv3sigma2tau7, tv3sigma2tau8, tv3sigma2tau9;
  double tv3sigma2tau10, t4765, t4782, t4790, t4793, t4796, t4799, t4801;
  double t4804, t4806, t4808, t4811, t4812, t4816, t4822, t4823;
  double t4825, t4826, t4829, t4832, t4833, t4835, t4838, t4839;
  double t4841, t4842, t4846, t4851, t4852, t4857, t4858, t4861;
  double t4862, t4865, t4866, t4870, tv3sigma2tau11, tv3sigmalapl20, tv3sigmalapl21, tv3sigmalapl22;
  double tv3sigmalapl23, tv3sigmalapl24, tv3sigmalapl25, tv3sigmalapl26, tv3sigmalapl27, tv3sigmalapl28, tv3sigmalapltau0, tv3sigmalapltau1;
  double tv3sigmalapltau2, tv3sigmalapltau3, tv3sigmalapltau4, tv3sigmalapltau5, tv3sigmalapltau6, tv3sigmalapltau7, tv3sigmalapltau8, tv3sigmalapltau9;
  double tv3sigmalapltau10, tv3sigmalapltau11, t4871, t4872, t4876, t4881, t4882, t4883;
  double t4885, t4886, t4889, t4892, t4897, t4898, t4900, t4903;
  double t4904, t4907, t4908, t4911, t4918, t4919, t4928, t4940;
  double t4945, t4946, t4952, t4953, t4955, t4956, t4960, tv3sigmatau20;
  double tv3sigmatau21, tv3sigmatau22, tv3sigmatau23, tv3sigmatau24, tv3sigmatau25, tv3sigmatau26, tv3sigmatau27, t4961;
  double t4962, t4966, t4971, t4972, t4973, t4975, t4976, t4979;
  double t4982, t4987, t4988, t4990, t4993, t4994, t4997, t4998;
  double t5001, t5008, t5009, t5018, t5030, t5035, t5036, t5042;
  double t5043, t5045, t5046, t5050, tv3sigmatau28, tv3lapl30, tv3lapl31, tv3lapl32;
  double tv3lapl33, tv3lapl2tau0, tv3lapl2tau1, tv3lapl2tau2, tv3lapl2tau3, tv3lapl2tau4, tv3lapl2tau5, tv3lapltau20;
  double tv3lapltau21, tv3lapltau22, tv3lapltau23, tv3lapltau24, tv3lapltau25, t5051, t5052, t5057;
  double t5060, t5063, t5064, t5067, t5070, t5071, t5074, t5075;
  double t5083, t5086, t5087, t5089, t5093, tv3tau30, tv3tau31, tv3tau32;
  double t5094, t5095, t5100, t5103, t5106, t5107, t5110, t5113;
  double t5114, t5117, t5118, t5126, t5129, t5130, t5132, t5136;
  double tv3tau33;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = sigma[0] * t39;
  t41 = 0.1e1 / params->kappa;
  t45 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t40 * t41;
  t46 = pow(t45, 0.1e1 / 0.5e1);
  t47 = t46 * t46;
  t48 = t47 * t47;
  t49 = 0.1e1 / t48;
  t52 = 0.5e1 / 0.972e3 * t34 * t40 * t49;
  t54 = 0.1e1 / t37 / rho[0];
  t57 = tau[0] * t54 - t40 / 0.8e1;
  t58 = t57 * t57;
  t59 = t29 * t29;
  t61 = 0.3e1 / 0.1e2 * t59 * t32;
  t62 = params->eta * sigma[0];
  t65 = t61 + t62 * t39 / 0.8e1;
  t66 = t65 * t65;
  t67 = 0.1e1 / t66;
  t69 = -t58 * t67 + 0.1e1;
  t70 = t69 * t69;
  t71 = t70 * t69;
  t72 = t58 * t57;
  t73 = t66 * t65;
  t74 = 0.1e1 / t73;
  t76 = t58 * t58;
  t78 = params->b * t76 * t58;
  t79 = t66 * t66;
  t81 = 0.1e1 / t79 / t66;
  t83 = t72 * t74 + t78 * t81 + 0.1e1;
  t84 = 0.1e1 / t83;
  t85 = t71 * t84;
  t88 = 0.5e1 / 0.972e3 * t34 * t40 + params->c;
  t90 = t41 * t88 + 0.1e1;
  t91 = pow(t90, 0.1e1 / 0.5e1);
  t92 = t91 * t91;
  t93 = t92 * t92;
  t94 = 0.1e1 / t93;
  t96 = t88 * t94 - t52;
  t98 = t85 * t96 + t52 + 0.1e1;
  t102 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t98);
  t103 = rho[1] <= p->dens_threshold;
  t104 = -t17;
  t106 = my_piecewise5(t15, t12, t11, t16, t104 * t8);
  t107 = 0.1e1 + t106;
  t108 = t107 <= p->zeta_threshold;
  t109 = POW_1_3(t107);
  t111 = my_piecewise3(t108, t23, t109 * t107);
  t112 = t111 * t27;
  t113 = rho[1] * rho[1];
  t114 = POW_1_3(rho[1]);
  t115 = t114 * t114;
  t117 = 0.1e1 / t115 / t113;
  t118 = sigma[2] * t117;
  t122 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t118 * t41;
  t123 = pow(t122, 0.1e1 / 0.5e1);
  t124 = t123 * t123;
  t125 = t124 * t124;
  t126 = 0.1e1 / t125;
  t129 = 0.5e1 / 0.972e3 * t34 * t118 * t126;
  t131 = 0.1e1 / t115 / rho[1];
  t134 = tau[1] * t131 - t118 / 0.8e1;
  t135 = t134 * t134;
  t136 = params->eta * sigma[2];
  t139 = t61 + t136 * t117 / 0.8e1;
  t140 = t139 * t139;
  t141 = 0.1e1 / t140;
  t143 = -t135 * t141 + 0.1e1;
  t144 = t143 * t143;
  t145 = t144 * t143;
  t146 = t135 * t134;
  t147 = t140 * t139;
  t148 = 0.1e1 / t147;
  t150 = t135 * t135;
  t152 = params->b * t150 * t135;
  t153 = t140 * t140;
  t155 = 0.1e1 / t153 / t140;
  t157 = t146 * t148 + t152 * t155 + 0.1e1;
  t158 = 0.1e1 / t157;
  t159 = t145 * t158;
  t162 = 0.5e1 / 0.972e3 * t34 * t118 + params->c;
  t164 = t162 * t41 + 0.1e1;
  t165 = pow(t164, 0.1e1 / 0.5e1);
  t166 = t165 * t165;
  t167 = t166 * t166;
  t168 = 0.1e1 / t167;
  t170 = t162 * t168 - t129;
  t172 = t159 * t170 + t129 + 0.1e1;
  t176 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t172);
  tzk0 = t102 + t176;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t177 = t7 * t7;
  t178 = 0.1e1 / t177;
  t179 = t17 * t178;
  t181 = my_piecewise5(t11, 0, t15, 0, t8 - t179);
  t184 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t181);
  t185 = t184 * t27;
  t189 = t27 * t27;
  t190 = 0.1e1 / t189;
  t191 = t26 * t190;
  t194 = t6 * t191 * t98 / 0.8e1;
  t195 = t35 * rho[0];
  t197 = 0.1e1 / t37 / t195;
  t198 = sigma[0] * t197;
  t201 = 0.1e2 / 0.729e3 * t34 * t198 * t49;
  t203 = 0.1e1 / t31 / t30;
  t204 = t59 * t203;
  t205 = sigma[0] * sigma[0];
  t206 = t204 * t205;
  t207 = t35 * t35;
  t208 = t207 * t35;
  t210 = 0.1e1 / t36 / t208;
  t212 = 0.1e1 / t48 / t45;
  t214 = t210 * t212 * t41;
  t216 = 0.1e2 / 0.177147e6 * t206 * t214;
  t217 = t70 * t84;
  t218 = t57 * t67;
  t222 = -0.5e1 / 0.3e1 * tau[0] * t39 + t198 / 0.3e1;
  t225 = t58 * t74;
  t226 = t62 * t197;
  t229 = -0.2e1 * t218 * t222 - 0.2e1 / 0.3e1 * t225 * t226;
  t230 = t96 * t229;
  t233 = t83 * t83;
  t234 = 0.1e1 / t233;
  t235 = t71 * t234;
  t238 = 0.1e1 / t79;
  t239 = t72 * t238;
  t242 = params->b * t76 * t57;
  t243 = t81 * t222;
  t247 = 0.1e1 / t79 / t73;
  t248 = t78 * t247;
  t251 = 0.3e1 * t222 * t225 + t226 * t239 + 0.2e1 * t226 * t248 + 0.6e1 * t242 * t243;
  t252 = t96 * t251;
  t258 = 0.1e1 / t93 / t90;
  t260 = t88 * t258 * t29;
  t261 = t33 * sigma[0];
  t266 = -0.1e2 / 0.729e3 * t34 * t198 * t94 + 0.8e1 / 0.729e3 * t260 * t261 * t197 * t41 + t201 - t216;
  t268 = 0.3e1 * t217 * t230 - t235 * t252 + t266 * t85 - t201 + t216;
  t273 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t98 - t194 - 0.3e1 / 0.8e1 * t6 * t28 * t268);
  t274 = t104 * t178;
  t276 = my_piecewise5(t15, 0, t11, 0, -t8 - t274);
  t279 = my_piecewise3(t108, 0, 0.4e1 / 0.3e1 * t109 * t276);
  t280 = t279 * t27;
  t284 = t111 * t190;
  t287 = t6 * t284 * t172 / 0.8e1;
  t289 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t172 - t287);
  tvrho0 = t102 + t176 + t7 * (t273 + t289);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t293 = my_piecewise5(t11, 0, t15, 0, -t8 - t179);
  t296 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t293);
  t297 = t296 * t27;
  t302 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t98 - t194);
  t304 = my_piecewise5(t15, 0, t11, 0, t8 - t274);
  t307 = my_piecewise3(t108, 0, 0.4e1 / 0.3e1 * t109 * t304);
  t308 = t307 * t27;
  t312 = t113 * rho[1];
  t314 = 0.1e1 / t115 / t312;
  t315 = sigma[2] * t314;
  t318 = 0.1e2 / 0.729e3 * t34 * t315 * t126;
  t319 = sigma[2] * sigma[2];
  t320 = t204 * t319;
  t321 = t113 * t113;
  t322 = t321 * t113;
  t324 = 0.1e1 / t114 / t322;
  t326 = 0.1e1 / t125 / t122;
  t328 = t324 * t326 * t41;
  t330 = 0.1e2 / 0.177147e6 * t320 * t328;
  t331 = t144 * t158;
  t332 = t134 * t141;
  t336 = -0.5e1 / 0.3e1 * tau[1] * t117 + t315 / 0.3e1;
  t339 = t135 * t148;
  t340 = t136 * t314;
  t343 = -0.2e1 * t332 * t336 - 0.2e1 / 0.3e1 * t339 * t340;
  t344 = t170 * t343;
  t347 = t157 * t157;
  t348 = 0.1e1 / t347;
  t349 = t145 * t348;
  t352 = 0.1e1 / t153;
  t353 = t146 * t352;
  t356 = params->b * t150 * t134;
  t357 = t155 * t336;
  t361 = 0.1e1 / t153 / t147;
  t362 = t152 * t361;
  t365 = 0.3e1 * t336 * t339 + t340 * t353 + 0.2e1 * t340 * t362 + 0.6e1 * t356 * t357;
  t366 = t170 * t365;
  t372 = 0.1e1 / t167 / t164;
  t374 = t162 * t372 * t29;
  t375 = t33 * sigma[2];
  t380 = -0.1e2 / 0.729e3 * t34 * t315 * t168 + 0.8e1 / 0.729e3 * t374 * t375 * t314 * t41 + t318 - t330;
  t382 = t159 * t380 + 0.3e1 * t331 * t344 - t349 * t366 - t318 + t330;
  t387 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t172 - t287 - 0.3e1 / 0.8e1 * t6 * t112 * t382);
  tvrho1 = t102 + t176 + t7 * (t302 + t387);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t392 = 0.5e1 / 0.972e3 * t34 * t39 * t49;
  t394 = t207 * rho[0];
  t396 = 0.1e1 / t36 / t394;
  t398 = t396 * t212 * t41;
  t400 = 0.5e1 / 0.236196e6 * t204 * sigma[0] * t398;
  t401 = t218 * t39;
  t402 = params->eta * t39;
  t405 = t225 * t402 / 0.4e1 + t401 / 0.4e1;
  t406 = t96 * t405;
  t409 = t225 * t39;
  t413 = t81 * t39;
  t414 = t242 * t413;
  t416 = t247 * params->eta;
  t420 = -0.3e1 / 0.8e1 * t409 - 0.3e1 / 0.8e1 * t239 * t402 - 0.3e1 / 0.4e1 * t414 - 0.3e1 / 0.4e1 * t78 * t416 * t39;
  t421 = t96 * t420;
  t430 = 0.5e1 / 0.972e3 * t34 * t39 * t94 - t260 * t33 * t39 * t41 / 0.243e3 - t392 + t400;
  t432 = 0.3e1 * t217 * t406 - t235 * t421 + t430 * t85 + t392 - t400;
  t436 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t432);
  tvsigma0 = t7 * t436;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t439 = 0.5e1 / 0.972e3 * t34 * t117 * t126;
  t441 = t321 * rho[1];
  t443 = 0.1e1 / t114 / t441;
  t445 = t443 * t326 * t41;
  t447 = 0.5e1 / 0.236196e6 * t204 * sigma[2] * t445;
  t448 = t332 * t117;
  t449 = params->eta * t117;
  t452 = t339 * t449 / 0.4e1 + t448 / 0.4e1;
  t453 = t170 * t452;
  t456 = t339 * t117;
  t460 = t155 * t117;
  t461 = t356 * t460;
  t463 = t361 * params->eta;
  t467 = -0.3e1 / 0.8e1 * t456 - 0.3e1 / 0.8e1 * t353 * t449 - 0.3e1 / 0.4e1 * t461 - 0.3e1 / 0.4e1 * t152 * t463 * t117;
  t468 = t170 * t467;
  t477 = 0.5e1 / 0.972e3 * t34 * t117 * t168 - t374 * t33 * t117 * t41 / 0.243e3 - t439 + t447;
  t479 = t159 * t477 + 0.3e1 * t331 * t453 - t349 * t468 + t439 - t447;
  t483 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t479);
  tvsigma2 = t7 * t483;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvlapl1 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  t484 = t217 * t96;
  t485 = t218 * t54;
  t490 = t81 * t54;
  t493 = 0.3e1 * t225 * t54 + 0.6e1 * t242 * t490;
  t494 = t96 * t493;
  t496 = -t235 * t494 - 0.6e1 * t484 * t485;
  t500 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t496);
  tvtau0 = t7 * t500;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t501 = t331 * t170;
  t502 = t332 * t131;
  t507 = t155 * t131;
  t510 = 0.3e1 * t131 * t339 + 0.6e1 * t356 * t507;
  t511 = t170 * t510;
  t513 = -t349 * t511 - 0.6e1 * t501 * t502;
  t517 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t513);
  tvtau1 = t7 * t517;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

  t520 = t24 * t24;
  t521 = 0.1e1 / t520;
  t522 = t181 * t181;
  t525 = t177 * t7;
  t526 = 0.1e1 / t525;
  t527 = t17 * t526;
  t530 = my_piecewise5(t11, 0, t15, 0, -0.2e1 * t178 + 0.2e1 * t527);
  t534 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t521 * t522 + 0.4e1 / 0.3e1 * t24 * t530);
  t535 = t534 * t27;
  t539 = t184 * t190;
  t541 = t6 * t539 * t98;
  t547 = 0.1e1 / t189 / t7;
  t548 = t26 * t547;
  t551 = t6 * t548 * t98 / 0.12e2;
  t553 = t6 * t191 * t268;
  t556 = 0.1e1 / t37 / t207;
  t557 = sigma[0] * t556;
  t560 = 0.11e3 / 0.2187e4 * t34 * t557 * t49;
  t561 = t207 * t195;
  t563 = 0.1e1 / t36 / t561;
  t565 = t563 * t212 * t41;
  t567 = 0.1e2 / 0.19683e5 * t206 * t565;
  t568 = t30 * t30;
  t569 = 0.1e1 / t568;
  t570 = t205 * sigma[0];
  t571 = t569 * t570;
  t572 = t207 * t207;
  t573 = t572 * t35;
  t574 = 0.1e1 / t573;
  t575 = t45 * t45;
  t577 = 0.1e1 / t48 / t575;
  t579 = params->kappa * params->kappa;
  t580 = 0.1e1 / t579;
  t583 = 0.4e2 / 0.4782969e7 * t571 * t574 * t577 * t580;
  t584 = t69 * t84;
  t585 = t229 * t229;
  t586 = t96 * t585;
  t589 = t70 * t234;
  t593 = t266 * t229;
  t596 = t222 * t222;
  t599 = t57 * t74;
  t600 = t599 * t222;
  t606 = 0.4e2 / 0.9e1 * tau[0] * t197 - 0.11e2 / 0.9e1 * t557;
  t609 = t58 * t238;
  t610 = params->eta * params->eta;
  t611 = t610 * t205;
  t612 = t611 * t563;
  t615 = t62 * t556;
  t618 = -0.2e1 * t596 * t67 - 0.8e1 / 0.3e1 * t600 * t226 - 0.2e1 * t218 * t606 - 0.2e1 / 0.3e1 * t609 * t612 + 0.22e2 / 0.9e1 * t225 * t615;
  t619 = t96 * t618;
  t623 = 0.1e1 / t233 / t83;
  t624 = t71 * t623;
  t625 = t251 * t251;
  t626 = t96 * t625;
  t629 = t266 * t251;
  t634 = t609 * t222;
  t640 = 0.1e1 / t79 / t65;
  t641 = t72 * t640;
  t646 = params->b * t76;
  t647 = t81 * t596;
  t650 = t242 * t247;
  t651 = t222 * params->eta;
  t658 = t79 * t79;
  t659 = 0.1e1 / t658;
  t660 = t78 * t659;
  t665 = 0.6e1 * t599 * t596 + 0.6e1 * t634 * t226 + 0.3e1 * t225 * t606 + 0.4e1 / 0.3e1 * t641 * t612 - 0.11e2 / 0.3e1 * t239 * t615 + 0.3e2 * t646 * t647 + 0.24e2 * t650 * t651 * t198 + 0.6e1 * t242 * t81 * t606 + 0.14e2 / 0.3e1 * t660 * t612 - 0.22e2 / 0.3e1 * t248 * t615;
  t672 = t563 * t258 * t41;
  t675 = t90 * t90;
  t677 = 0.1e1 / t93 / t675;
  t679 = t88 * t677 * t59;
  t680 = t203 * t205;
  t689 = 0.11e3 / 0.2187e4 * t34 * t557 * t94 - 0.16e3 / 0.531441e6 * t206 * t672 + 0.16e2 / 0.59049e5 * t679 * t680 * t563 * t580 - 0.88e2 / 0.2187e4 * t260 * t261 * t556 * t41 - t560 + t567 - t583;
  t691 = -0.6e1 * t230 * t251 * t589 - t235 * t665 * t96 + 0.6e1 * t217 * t593 + 0.3e1 * t217 * t619 - 0.2e1 * t235 * t629 + 0.6e1 * t584 * t586 + 0.2e1 * t624 * t626 + t689 * t85 + t560 - t567 + t583;
  t696 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t98 - t541 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t268 + t551 - t553 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t691);
  t697 = t109 * t109;
  t698 = 0.1e1 / t697;
  t699 = t276 * t276;
  t702 = t104 * t526;
  t705 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t178 + 0.2e1 * t702);
  t709 = my_piecewise3(t108, 0, 0.4e1 / 0.9e1 * t698 * t699 + 0.4e1 / 0.3e1 * t109 * t705);
  t710 = t709 * t27;
  t714 = t279 * t190;
  t716 = t6 * t714 * t172;
  t718 = t111 * t547;
  t721 = t6 * t718 * t172 / 0.12e2;
  t723 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t172 - t716 / 0.4e1 + t721);
  tv2rho20 = 0.2e1 * t273 + 0.2e1 * t289 + t7 * (t696 + t723);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t726 = t521 * t293;
  t730 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t527);
  t734 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t726 * t181 + 0.4e1 / 0.3e1 * t24 * t730);
  t735 = t734 * t27;
  t739 = t296 * t190;
  t741 = t6 * t739 * t98;
  t749 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t98 - t741 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t268 - t541 / 0.8e1 + t551 - t553 / 0.8e1);
  t750 = t698 * t304;
  t754 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t702);
  t758 = my_piecewise3(t108, 0, 0.4e1 / 0.9e1 * t750 * t276 + 0.4e1 / 0.3e1 * t109 * t754);
  t759 = t758 * t27;
  t763 = t307 * t190;
  t765 = t6 * t763 * t172;
  t772 = t6 * t284 * t382;
  t775 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t172 - t765 / 0.8e1 - t716 / 0.8e1 + t721 - 0.3e1 / 0.8e1 * t6 * t280 * t382 - t772 / 0.8e1);
  tv2rho21 = t273 + t289 + t302 + t387 + t7 * (t749 + t775);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t780 = t293 * t293;
  t785 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t178 + 0.2e1 * t527);
  t789 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t521 * t780 + 0.4e1 / 0.3e1 * t24 * t785);
  t790 = t789 * t27;
  t796 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t98 - t741 / 0.4e1 + t551);
  t797 = t304 * t304;
  t802 = my_piecewise5(t15, 0, t11, 0, -0.2e1 * t178 + 0.2e1 * t702);
  t806 = my_piecewise3(t108, 0, 0.4e1 / 0.9e1 * t698 * t797 + 0.4e1 / 0.3e1 * t109 * t802);
  t807 = t806 * t27;
  t817 = 0.1e1 / t115 / t321;
  t818 = sigma[2] * t817;
  t821 = 0.11e3 / 0.2187e4 * t34 * t818 * t126;
  t822 = t321 * t312;
  t824 = 0.1e1 / t114 / t822;
  t826 = t824 * t326 * t41;
  t828 = 0.1e2 / 0.19683e5 * t320 * t826;
  t829 = t319 * sigma[2];
  t830 = t569 * t829;
  t831 = t321 * t321;
  t832 = t831 * t113;
  t833 = 0.1e1 / t832;
  t834 = t122 * t122;
  t836 = 0.1e1 / t125 / t834;
  t840 = 0.4e2 / 0.4782969e7 * t830 * t833 * t836 * t580;
  t841 = t143 * t158;
  t842 = t343 * t343;
  t843 = t170 * t842;
  t846 = t144 * t348;
  t850 = t380 * t343;
  t853 = t336 * t336;
  t856 = t134 * t148;
  t857 = t856 * t336;
  t863 = 0.4e2 / 0.9e1 * tau[1] * t314 - 0.11e2 / 0.9e1 * t818;
  t866 = t135 * t352;
  t867 = t610 * t319;
  t868 = t867 * t824;
  t871 = t136 * t817;
  t874 = -0.2e1 * t853 * t141 - 0.8e1 / 0.3e1 * t857 * t340 - 0.2e1 * t332 * t863 - 0.2e1 / 0.3e1 * t866 * t868 + 0.22e2 / 0.9e1 * t339 * t871;
  t875 = t170 * t874;
  t879 = 0.1e1 / t347 / t157;
  t880 = t145 * t879;
  t881 = t365 * t365;
  t882 = t170 * t881;
  t885 = t380 * t365;
  t890 = t866 * t336;
  t896 = 0.1e1 / t153 / t139;
  t897 = t146 * t896;
  t902 = params->b * t150;
  t903 = t155 * t853;
  t906 = t356 * t361;
  t907 = t336 * params->eta;
  t914 = t153 * t153;
  t915 = 0.1e1 / t914;
  t916 = t152 * t915;
  t921 = 0.6e1 * t856 * t853 + 0.6e1 * t890 * t340 + 0.3e1 * t339 * t863 + 0.4e1 / 0.3e1 * t897 * t868 - 0.11e2 / 0.3e1 * t353 * t871 + 0.3e2 * t902 * t903 + 0.24e2 * t906 * t907 * t315 + 0.6e1 * t356 * t155 * t863 + 0.14e2 / 0.3e1 * t916 * t868 - 0.22e2 / 0.3e1 * t362 * t871;
  t928 = t824 * t372 * t41;
  t931 = t164 * t164;
  t933 = 0.1e1 / t167 / t931;
  t935 = t162 * t933 * t59;
  t936 = t203 * t319;
  t945 = 0.11e3 / 0.2187e4 * t34 * t818 * t168 - 0.16e3 / 0.531441e6 * t320 * t928 + 0.16e2 / 0.59049e5 * t935 * t936 * t824 * t580 - 0.88e2 / 0.2187e4 * t374 * t375 * t817 * t41 - t821 + t828 - t840;
  t947 = -t170 * t349 * t921 - 0.6e1 * t344 * t365 * t846 + t159 * t945 + 0.6e1 * t331 * t850 + 0.3e1 * t331 * t875 - 0.2e1 * t349 * t885 + 0.6e1 * t841 * t843 + 0.2e1 * t880 * t882 + t821 - t828 + t840;
  t952 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t172 - t765 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t382 + t721 - t772 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * t947);
  tv2rho22 = 0.2e1 * t302 + 0.2e1 * t387 + t7 * (t796 + t952);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t960 = t6 * t191 * t432 / 0.8e1;
  t963 = 0.1e2 / 0.729e3 * t34 * t197 * t49;
  t964 = t204 * t210;
  t966 = t212 * sigma[0] * t41;
  t968 = 0.1e2 / 0.59049e5 * t964 * t966;
  t969 = t569 * t205;
  t970 = t572 * rho[0];
  t971 = 0.1e1 / t970;
  t975 = 0.5e1 / 0.1594323e7 * t969 * t971 * t577 * t580;
  t979 = t406 * t251;
  t982 = t266 * t405;
  t985 = t222 * t67;
  t986 = t985 * t39;
  t988 = t210 * params->eta;
  t989 = t988 * sigma[0];
  t992 = t218 * t197;
  t994 = t402 * t222;
  t997 = t610 * t210;
  t998 = t997 * sigma[0];
  t1001 = params->eta * t197;
  t1004 = t986 / 0.4e1 + t599 * t989 / 0.6e1 - 0.2e1 / 0.3e1 * t992 + t599 * t994 / 0.2e1 + t609 * t998 / 0.4e1 - 0.2e1 / 0.3e1 * t225 * t1001;
  t1005 = t96 * t1004;
  t1014 = t266 * t420;
  t1017 = t599 * t39 * t222;
  t1019 = t609 * t989;
  t1021 = t225 * t197;
  t1028 = t646 * t413 * t222;
  t1030 = t650 * t989;
  t1032 = t81 * t197;
  t1033 = t242 * t1032;
  t1042 = -0.3e1 / 0.4e1 * t1017 - 0.3e1 / 0.8e1 * t1019 + t1021 - 0.9e1 / 0.8e1 * t609 * t994 - t641 * t998 / 0.2e1 + t239 * t1001 - 0.15e2 / 0.4e1 * t1028 - 0.3e1 / 0.2e1 * t1030 + 0.2e1 * t1033 - 0.9e1 / 0.2e1 * t650 * t994 - 0.7e1 / 0.4e1 * t660 * t998 + 0.2e1 * t78 * t416 * t197;
  t1043 = t96 * t1042;
  t1045 = t430 * t229;
  t1048 = t430 * t251;
  t1054 = t258 * sigma[0] * t41;
  t1057 = t203 * t210;
  t1058 = t580 * sigma[0];
  t1066 = -0.1e2 / 0.729e3 * t34 * t197 * t94 + 0.2e2 / 0.177147e6 * t964 * t1054 - 0.2e1 / 0.19683e5 * t679 * t1057 * t1058 + 0.8e1 / 0.729e3 * t260 * t33 * t197 * t41 + t963 - t968 + t975;
  t1068 = 0.6e1 * t229 * t406 * t584 - 0.3e1 * t229 * t421 * t589 + 0.2e1 * t251 * t421 * t624 + 0.3e1 * t1005 * t217 - t1014 * t235 - t1043 * t235 + 0.3e1 * t1045 * t217 - t1048 * t235 + t1066 * t85 + 0.3e1 * t217 * t982 - 0.3e1 * t589 * t979 - t963 + t968 - t975;
  t1073 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t432 - t960 - 0.3e1 / 0.8e1 * t6 * t28 * t1068);
  tv2rhosigma0 = t1073 * t7 + t436;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1080 = t6 * t284 * t479 / 0.8e1;
  t1082 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t479 - t1080);
  tv2rhosigma2 = t1082 * t7 + t483;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1088 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t432 - t960);
  tv2rhosigma3 = t1088 * t7 + t436;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1095 = 0.1e2 / 0.729e3 * t34 * t314 * t126;
  t1096 = t204 * t324;
  t1098 = t326 * sigma[2] * t41;
  t1100 = 0.1e2 / 0.59049e5 * t1096 * t1098;
  t1101 = t569 * t319;
  t1102 = t831 * rho[1];
  t1103 = 0.1e1 / t1102;
  t1107 = 0.5e1 / 0.1594323e7 * t1101 * t1103 * t836 * t580;
  t1111 = t453 * t365;
  t1114 = t380 * t452;
  t1117 = t336 * t141;
  t1118 = t1117 * t117;
  t1120 = t324 * params->eta;
  t1121 = t1120 * sigma[2];
  t1124 = t332 * t314;
  t1126 = t449 * t336;
  t1129 = t610 * t324;
  t1130 = t1129 * sigma[2];
  t1133 = params->eta * t314;
  t1136 = t1118 / 0.4e1 + t856 * t1121 / 0.6e1 - 0.2e1 / 0.3e1 * t1124 + t856 * t1126 / 0.2e1 + t866 * t1130 / 0.4e1 - 0.2e1 / 0.3e1 * t339 * t1133;
  t1137 = t170 * t1136;
  t1146 = t380 * t467;
  t1148 = t117 * t336;
  t1149 = t856 * t1148;
  t1151 = t866 * t1121;
  t1153 = t339 * t314;
  t1160 = t902 * t460 * t336;
  t1162 = t906 * t1121;
  t1164 = t155 * t314;
  t1165 = t356 * t1164;
  t1174 = -0.3e1 / 0.4e1 * t1149 - 0.3e1 / 0.8e1 * t1151 + t1153 - 0.9e1 / 0.8e1 * t866 * t1126 - t897 * t1130 / 0.2e1 + t353 * t1133 - 0.15e2 / 0.4e1 * t1160 - 0.3e1 / 0.2e1 * t1162 + 0.2e1 * t1165 - 0.9e1 / 0.2e1 * t906 * t1126 - 0.7e1 / 0.4e1 * t916 * t1130 + 0.2e1 * t152 * t463 * t314;
  t1175 = t170 * t1174;
  t1177 = t477 * t343;
  t1186 = t372 * sigma[2] * t41;
  t1189 = t203 * t324;
  t1190 = t580 * sigma[2];
  t1198 = -0.1e2 / 0.729e3 * t34 * t314 * t168 + 0.2e2 / 0.177147e6 * t1096 * t1186 - 0.2e1 / 0.19683e5 * t935 * t1189 * t1190 + 0.8e1 / 0.729e3 * t374 * t33 * t314 * t41 + t1095 - t1100 + t1107;
  t1200 = 0.6e1 * t343 * t453 * t841 - 0.3e1 * t343 * t468 * t846 - t349 * t365 * t477 + 0.2e1 * t365 * t468 * t880 - 0.3e1 * t1111 * t846 + 0.3e1 * t1114 * t331 + 0.3e1 * t1137 * t331 - t1146 * t349 - t1175 * t349 + 0.3e1 * t1177 * t331 + t1198 * t159 - t1095 + t1100 - t1107;
  t1205 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t479 - t1080 - 0.3e1 / 0.8e1 * t6 * t112 * t1200);
  tv2rhosigma5 = t1205 * t7 + t483;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  tv2rholapl1 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 1] += tv2rholapl1;

  tv2rholapl2 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 2] += tv2rholapl2;

  tv2rholapl3 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 3] += tv2rholapl3;

  t1212 = t6 * t191 * t496 / 0.8e1;
  t1213 = t584 * t96;
  t1214 = t54 * t229;
  t1215 = t218 * t1214;
  t1218 = t589 * t96;
  t1219 = t54 * t251;
  t1220 = t218 * t1219;
  t1223 = t217 * t266;
  t1226 = t985 * t54;
  t1229 = t96 * t57;
  t1230 = t217 * t1229;
  t1231 = t74 * t396;
  t1232 = t1231 * t62;
  t1243 = t266 * t493;
  t1245 = t54 * t222;
  t1248 = t396 * params->eta;
  t1249 = t1248 * sigma[0];
  t1259 = 0.3e2 * t222 * t490 * t646 + 0.6e1 * t1245 * t599 + 0.3e1 * t1249 * t609 + 0.12e2 * t1249 * t650 - 0.5e1 * t409 - 0.1e2 * t414;
  t1260 = t96 * t1259;
  t1262 = -0.3e1 * t229 * t494 * t589 + 0.2e1 * t251 * t494 * t624 - 0.12e2 * t1213 * t1215 + 0.6e1 * t1218 * t1220 - 0.6e1 * t1223 * t485 - 0.6e1 * t1226 * t484 - 0.4e1 * t1230 * t1232 - t1243 * t235 - t1260 * t235 + 0.1e2 * t401 * t484;
  t1267 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t496 - t1212 - 0.3e1 / 0.8e1 * t6 * t28 * t1262);
  tv2rhotau0 = t1267 * t7 + t500;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t1274 = t6 * t284 * t513 / 0.8e1;
  t1276 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t513 - t1274);
  tv2rhotau1 = t1276 * t7 + t517;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 1] += tv2rhotau1;

  t1282 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t496 - t1212);
  tv2rhotau2 = t1282 * t7 + t500;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 2] += tv2rhotau2;

  t1287 = t841 * t170;
  t1288 = t131 * t343;
  t1289 = t332 * t1288;
  t1292 = t846 * t170;
  t1293 = t131 * t365;
  t1294 = t332 * t1293;
  t1297 = t331 * t380;
  t1300 = t1117 * t131;
  t1303 = t170 * t134;
  t1304 = t331 * t1303;
  t1305 = t148 * t443;
  t1306 = t1305 * t136;
  t1317 = t380 * t510;
  t1319 = t131 * t336;
  t1322 = t443 * params->eta;
  t1323 = t1322 * sigma[2];
  t1333 = 0.3e2 * t336 * t507 * t902 + 0.6e1 * t1319 * t856 + 0.3e1 * t1323 * t866 + 0.12e2 * t1323 * t906 - 0.5e1 * t456 - 0.1e2 * t461;
  t1334 = t170 * t1333;
  t1336 = -0.3e1 * t343 * t511 * t846 + 0.2e1 * t365 * t511 * t880 - 0.12e2 * t1287 * t1289 + 0.6e1 * t1292 * t1294 - 0.6e1 * t1297 * t502 - 0.6e1 * t1300 * t501 - 0.4e1 * t1304 * t1306 - t1317 * t349 - t1334 * t349 + 0.1e2 * t448 * t501;
  t1341 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t513 - t1274 - 0.3e1 / 0.8e1 * t6 * t112 * t1336);
  tv2rhotau3 = t1341 * t7 + t517;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 3] += tv2rhotau3;

  t1344 = 0.5e1 / 0.118098e6 * t204 * t398;
  t1345 = t569 * sigma[0];
  t1346 = 0.1e1 / t572;
  t1350 = 0.5e1 / 0.4251528e7 * t1345 * t1346 * t577 * t580;
  t1351 = t405 * t405;
  t1352 = t96 * t1351;
  t1355 = t406 * t420;
  t1358 = t430 * t405;
  t1361 = t396 * t67;
  t1363 = t599 * t1248;
  t1365 = t610 * t396;
  t1368 = -t1361 / 0.32e2 - t1363 / 0.8e1 - 0.3e1 / 0.32e2 * t609 * t1365;
  t1369 = t96 * t1368;
  t1372 = t420 * t420;
  t1373 = t96 * t1372;
  t1376 = t430 * t420;
  t1379 = t599 * t396;
  t1381 = t609 * t1248;
  t1385 = t81 * t396;
  t1386 = t646 * t1385;
  t1390 = t242 * t247 * t396 * params->eta;
  t1392 = t659 * t610;
  t1396 = 0.3e1 / 0.32e2 * t1379 + 0.9e1 / 0.32e2 * t1381 + 0.3e1 / 0.16e2 * t641 * t1365 + 0.15e2 / 0.32e2 * t1386 + 0.9e1 / 0.8e1 * t1390 + 0.21e2 / 0.32e2 * t78 * t1392 * t396;
  t1397 = t96 * t1396;
  t1407 = -0.5e1 / 0.118098e6 * t204 * t396 * t258 * t41 + t679 * t203 * t396 * t580 / 0.26244e5 + t1344 - t1350;
  t1409 = 0.6e1 * t1352 * t584 - 0.6e1 * t1355 * t589 + 0.6e1 * t1358 * t217 + 0.3e1 * t1369 * t217 + 0.2e1 * t1373 * t624 - 0.2e1 * t1376 * t235 - t1397 * t235 + t1407 * t85 - t1344 + t1350;
  t1413 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t1409);
  tv2sigma20 = t7 * t1413;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1415 = 0.5e1 / 0.118098e6 * t204 * t445;
  t1416 = t569 * sigma[2];
  t1417 = 0.1e1 / t831;
  t1421 = 0.5e1 / 0.4251528e7 * t1416 * t1417 * t836 * t580;
  t1422 = t452 * t452;
  t1423 = t170 * t1422;
  t1426 = t453 * t467;
  t1429 = t477 * t452;
  t1432 = t443 * t141;
  t1434 = t856 * t1322;
  t1436 = t610 * t443;
  t1439 = -t1432 / 0.32e2 - t1434 / 0.8e1 - 0.3e1 / 0.32e2 * t866 * t1436;
  t1440 = t170 * t1439;
  t1443 = t467 * t467;
  t1444 = t170 * t1443;
  t1447 = t477 * t467;
  t1450 = t856 * t443;
  t1452 = t866 * t1322;
  t1456 = t155 * t443;
  t1457 = t902 * t1456;
  t1461 = t356 * t361 * t443 * params->eta;
  t1463 = t915 * t610;
  t1467 = 0.3e1 / 0.32e2 * t1450 + 0.9e1 / 0.32e2 * t1452 + 0.3e1 / 0.16e2 * t897 * t1436 + 0.15e2 / 0.32e2 * t1457 + 0.9e1 / 0.8e1 * t1461 + 0.21e2 / 0.32e2 * t152 * t1463 * t443;
  t1468 = t170 * t1467;
  t1478 = -0.5e1 / 0.118098e6 * t204 * t443 * t372 * t41 + t935 * t203 * t443 * t580 / 0.26244e5 + t1415 - t1421;
  t1480 = 0.6e1 * t1423 * t841 - 0.6e1 * t1426 * t846 + 0.6e1 * t1429 * t331 + 0.3e1 * t1440 * t331 + 0.2e1 * t1444 * t880 - 0.2e1 * t1447 * t349 - t1468 * t349 + t1478 * t159 - t1415 + t1421;
  t1484 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t1480);
  tv2sigma25 = t7 * t1484;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 4] += tv2sigmalapl4;

  tv2sigmalapl5 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 5] += tv2sigmalapl5;

  t1485 = t54 * t405;
  t1486 = t218 * t1485;
  t1489 = t54 * t420;
  t1490 = t218 * t1489;
  t1493 = t217 * t430;
  t1497 = 0.1e1 / t36 / t207;
  t1499 = t96 * t1497 * t67;
  t1500 = t217 * t1499;
  t1502 = t1497 * params->eta;
  t1503 = t599 * t1502;
  t1506 = t494 * t405;
  t1512 = t430 * t493;
  t1514 = t599 * t1497;
  t1518 = t81 * t1497;
  t1519 = t646 * t1518;
  t1525 = -0.3e1 / 0.4e1 * t1514 - 0.9e1 / 0.8e1 * t609 * t1502 - 0.15e2 / 0.4e1 * t1519 - 0.9e1 / 0.2e1 * t242 * t247 * t1497 * params->eta;
  t1526 = t96 * t1525;
  t1528 = -0.12e2 * t1213 * t1486 + 0.6e1 * t1218 * t1490 - 0.6e1 * t1493 * t485 + 0.3e1 / 0.4e1 * t1500 + 0.3e1 / 0.2e1 * t484 * t1503 - 0.3e1 * t589 * t1506 + 0.2e1 * t624 * t494 * t420 - t235 * t1512 - t235 * t1526;
  t1532 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t1528);
  tv2sigmatau0 = t7 * t1532;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 4] += tv2sigmatau4;

  t1533 = t131 * t452;
  t1534 = t332 * t1533;
  t1537 = t131 * t467;
  t1538 = t332 * t1537;
  t1541 = t331 * t477;
  t1545 = 0.1e1 / t114 / t321;
  t1547 = t170 * t1545 * t141;
  t1548 = t331 * t1547;
  t1550 = t1545 * params->eta;
  t1551 = t856 * t1550;
  t1554 = t511 * t452;
  t1560 = t477 * t510;
  t1562 = t856 * t1545;
  t1566 = t155 * t1545;
  t1567 = t902 * t1566;
  t1573 = -0.3e1 / 0.4e1 * t1562 - 0.9e1 / 0.8e1 * t866 * t1550 - 0.15e2 / 0.4e1 * t1567 - 0.9e1 / 0.2e1 * t356 * t361 * t1545 * params->eta;
  t1574 = t170 * t1573;
  t1576 = -0.12e2 * t1287 * t1534 + 0.6e1 * t1292 * t1538 - 0.6e1 * t1541 * t502 + 0.3e1 / 0.4e1 * t1548 + 0.3e1 / 0.2e1 * t501 * t1551 - 0.3e1 * t846 * t1554 + 0.2e1 * t880 * t511 * t467 - t349 * t1560 - t349 * t1574;
  t1580 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t1576);
  tv2sigmatau5 = t7 * t1580;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 5] += tv2sigmatau5;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 1] += tv2lapl21;

  tv2lapl22 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 3] += tv2lapltau3;

  t1582 = 0.1e1 / t36 / t195;
  t1583 = t609 * t1582;
  t1586 = t54 * t493;
  t1587 = t218 * t1586;
  t1591 = t96 * t1582 * t67;
  t1594 = t493 * t493;
  t1595 = t96 * t1594;
  t1600 = t81 * t1582;
  t1603 = 0.6e1 * t1582 * t599 + 0.3e2 * t1600 * t646;
  t1604 = t96 * t1603;
  t1606 = 0.24e2 * t1213 * t1583 + 0.12e2 * t1218 * t1587 - 0.6e1 * t1591 * t217 + 0.2e1 * t1595 * t624 - t1604 * t235;
  t1610 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t1606);
  tv2tau20 = t7 * t1610;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 1] += tv2tau21;

  t1612 = 0.1e1 / t114 / t312;
  t1613 = t866 * t1612;
  t1616 = t131 * t510;
  t1617 = t332 * t1616;
  t1621 = t170 * t1612 * t141;
  t1624 = t510 * t510;
  t1625 = t170 * t1624;
  t1630 = t155 * t1612;
  t1633 = 0.6e1 * t1612 * t856 + 0.3e2 * t1630 * t902;
  t1634 = t170 * t1633;
  t1636 = 0.24e2 * t1287 * t1613 + 0.12e2 * t1292 * t1617 - 0.6e1 * t1621 * t331 + 0.2e1 * t1625 * t880 - t1634 * t349;
  t1640 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t1636);
  tv2tau22 = t7 * t1640;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 2] += tv2tau22;

  t1644 = 0.1e1 / t520 / t20;
  t1645 = t522 * t181;
  t1648 = t521 * t181;
  t1651 = t177 * t177;
  t1652 = 0.1e1 / t1651;
  t1653 = t17 * t1652;
  t1656 = my_piecewise5(t11, 0, t15, 0, 0.6e1 * t526 - 0.6e1 * t1653);
  t1660 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1644 * t1645 + 0.4e1 / 0.3e1 * t1648 * t530 + 0.4e1 / 0.3e1 * t24 * t1656);
  t1661 = t1660 * t27;
  t1665 = t534 * t190;
  t1667 = t6 * t1665 * t98;
  t1672 = t184 * t547;
  t1674 = t6 * t1672 * t98;
  t1677 = t6 * t539 * t268;
  t1683 = 0.1e1 / t189 / t177;
  t1684 = t26 * t1683;
  t1687 = 0.5e1 / 0.36e2 * t6 * t1684 * t98;
  t1689 = t6 * t548 * t268;
  t1692 = t6 * t191 * t691;
  t1694 = t70 * t623;
  t1699 = 0.1e1 / t37 / t394;
  t1700 = sigma[0] * t1699;
  t1703 = 0.154e4 / 0.6561e4 * t34 * t1700 * t49;
  t1705 = 0.1e1 / t36 / t572;
  t1709 = 0.682e4 / 0.1594323e7 * t206 * t1705 * t212 * t41;
  t1710 = t233 * t233;
  t1711 = 0.1e1 / t1710;
  t1712 = t71 * t1711;
  t1713 = t625 * t251;
  t1720 = t572 * t195;
  t1721 = 0.1e1 / t1720;
  t1725 = 0.76e3 / 0.4782969e7 * t571 * t1721 * t577 * t580;
  t1726 = t69 * t234;
  t1742 = 0.18e2 * t1694 * t230 * t625 - 0.6e1 * t1712 * t1713 * t96 - 0.18e2 * t1726 * t251 * t586 + 0.18e2 * t230 * t584 * t618 - 0.9e1 * t230 * t589 * t665 - 0.18e2 * t251 * t589 * t593 - 0.9e1 * t251 * t589 * t619 + 0.6e1 * t252 * t624 * t665 - t1703 + t1709 - t1725;
  t1756 = 0.1e1 / t93 / t675 / t90;
  t1757 = t88 * t1756;
  t1758 = t1757 * t569;
  t1761 = 0.1e1 / t579 / params->kappa;
  t1773 = t205 * t205;
  t1774 = t569 * t1773;
  t1775 = t572 * t394;
  t1777 = 0.1e1 / t37 / t1775;
  t1781 = 0.1e1 / t48 / t575 / t45;
  t1783 = t1781 * t1761 * t34;
  t1785 = 0.112e4 / 0.3486784401e10 * t1774 * t1777 * t1783;
  t1786 = -0.154e4 / 0.6561e4 * t34 * t1700 * t94 + 0.176e4 / 0.531441e6 * t206 * t1705 * t258 * t41 - 0.32e3 / 0.4782969e7 * t571 * t1721 * t677 * t580 + 0.896e3 / 0.14348907e8 * t1758 * t570 * t1721 * t1761 - 0.176e3 / 0.59049e5 * t679 * t680 * t1705 * t580 + 0.1232e4 / 0.6561e4 * t260 * t261 * t1699 * t41 + t1703 - t1709 + t1725 - t1785;
  t1788 = t585 * t229;
  t1789 = t1788 * t84;
  t1792 = t266 * t585;
  t1795 = t689 * t229;
  t1798 = t266 * t618;
  t1803 = t596 * t74;
  t1806 = t57 * t238;
  t1807 = t1806 * t222;
  t1810 = t599 * t606;
  t1818 = -0.44e3 / 0.27e2 * tau[0] * t556 + 0.154e3 / 0.27e2 * t1700;
  t1821 = t58 * t640;
  t1822 = t610 * params->eta;
  t1823 = t1822 * t570;
  t1824 = t1823 * t1721;
  t1827 = t611 * t1705;
  t1830 = t62 * t1699;
  t1833 = -0.6e1 * t985 * t606 - 0.4e1 * t1803 * t226 - 0.4e1 * t1807 * t612 - 0.4e1 * t1810 * t226 + 0.44e2 / 0.3e1 * t600 * t615 - 0.2e1 * t218 * t1818 - 0.8e1 / 0.9e1 * t1821 * t1824 + 0.22e2 / 0.3e1 * t609 * t1827 - 0.308e3 / 0.27e2 * t225 * t1830;
  t1834 = t96 * t1833;
  t1850 = 0.1e1 / t658 / t65;
  t1851 = t78 * t1850;
  t1854 = t1806 * t596;
  t1857 = t609 * t606;
  t1860 = t1821 * t222;
  t1867 = t72 * t81;
  t1870 = params->b * t72;
  t1871 = t596 * t222;
  t1882 = t222 * t606;
  t1890 = t646 * t247;
  t1891 = t596 * params->eta;
  t1895 = t606 * params->eta;
  t1896 = t1895 * t198;
  t1899 = t242 * t659;
  t1900 = t222 * t610;
  t1901 = t205 * t563;
  t1909 = -0.132e3 * t650 * t651 * t557 + 0.112e3 / 0.9e1 * t1851 * t1824 + 0.18e2 * t1854 * t226 + 0.9e1 * t1857 * t226 + 0.12e2 * t1860 * t612 - 0.44e2 / 0.3e1 * t641 * t1827 + 0.154e3 / 0.9e1 * t239 * t1830 + 0.2e2 / 0.9e1 * t1867 * t1824 + 0.12e3 * t1870 * t81 * t1871 + 0.9e2 * t646 * t243 * t606 + 0.6e1 * t1871 * t74 + 0.3e1 * t225 * t1818 + 0.18e2 * t599 * t1882 + 0.6e1 * t242 * t81 * t1818 - 0.33e2 * t634 * t615 + 0.18e3 * t1890 * t1891 * t198 + 0.36e2 * t650 * t1896 + 0.84e2 * t1899 * t1900 * t1901 - 0.154e3 / 0.3e1 * t660 * t1827 + 0.308e3 / 0.9e1 * t248 * t1830;
  t1912 = -t1909 * t235 * t96 - 0.3e1 * t235 * t251 * t689 - 0.3e1 * t235 * t266 * t665 + 0.6e1 * t266 * t624 * t625 + t1786 * t85 + 0.6e1 * t1789 * t96 + 0.18e2 * t1792 * t584 + 0.9e1 * t1795 * t217 + 0.9e1 * t1798 * t217 + 0.3e1 * t1834 * t217 + t1785;
  t1913 = t1742 + t1912;
  t1918 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1661 * t98 - 0.3e1 / 0.8e1 * t1667 - 0.9e1 / 0.8e1 * t6 * t535 * t268 + t1674 / 0.4e1 - 0.3e1 / 0.4e1 * t1677 - 0.9e1 / 0.8e1 * t6 * t185 * t691 - t1687 + t1689 / 0.4e1 - 0.3e1 / 0.8e1 * t1692 - 0.3e1 / 0.8e1 * t6 * t28 * t1913);
  t1920 = 0.1e1 / t697 / t107;
  t1921 = t699 * t276;
  t1924 = t698 * t276;
  t1927 = t104 * t1652;
  t1930 = my_piecewise5(t15, 0, t11, 0, -0.6e1 * t526 - 0.6e1 * t1927);
  t1934 = my_piecewise3(t108, 0, -0.8e1 / 0.27e2 * t1920 * t1921 + 0.4e1 / 0.3e1 * t1924 * t705 + 0.4e1 / 0.3e1 * t109 * t1930);
  t1935 = t1934 * t27;
  t1939 = t709 * t190;
  t1941 = t6 * t1939 * t172;
  t1943 = t279 * t547;
  t1945 = t6 * t1943 * t172;
  t1947 = t111 * t1683;
  t1950 = 0.5e1 / 0.36e2 * t6 * t1947 * t172;
  t1952 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t1935 * t172 - 0.3e1 / 0.8e1 * t1941 + t1945 / 0.4e1 - t1950);
  tv3rho30 = 0.3e1 * t696 + 0.3e1 * t723 + t7 * (t1918 + t1952);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1955 = 0.2e1 * t749;
  t1956 = 0.2e1 * t775;
  t1957 = t1644 * t293;
  t1960 = t521 * t730;
  t1965 = 0.2e1 * t526;
  t1966 = 0.6e1 * t1653;
  t1968 = my_piecewise5(t11, 0, t15, 0, t1965 - t1966);
  t1972 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1957 * t522 + 0.8e1 / 0.9e1 * t1960 * t181 + 0.4e1 / 0.9e1 * t726 * t530 + 0.4e1 / 0.3e1 * t24 * t1968);
  t1973 = t1972 * t27;
  t1977 = t734 * t190;
  t1980 = t6 * t1977 * t98 / 0.4e1;
  t1984 = t296 * t547;
  t1986 = t6 * t1984 * t98;
  t1990 = t6 * t739 * t268 / 0.4e1;
  t1999 = -0.3e1 / 0.8e1 * t6 * t1973 * t98 - t1980 - 0.3e1 / 0.4e1 * t6 * t735 * t268 + t1986 / 0.12e2 - t1990 - 0.3e1 / 0.8e1 * t6 * t297 * t691 - t1667 / 0.8e1 + t1674 / 0.6e1 - t1677 / 0.4e1 - t1687 + t1689 / 0.6e1 - t1692 / 0.8e1;
  t2000 = my_piecewise3(t2, 0, t1999);
  t2001 = t1920 * t304;
  t2004 = t698 * t754;
  t2009 = 0.6e1 * t1927;
  t2011 = my_piecewise5(t15, 0, t11, 0, -t1965 - t2009);
  t2015 = my_piecewise3(t108, 0, -0.8e1 / 0.27e2 * t2001 * t699 + 0.8e1 / 0.9e1 * t2004 * t276 + 0.4e1 / 0.9e1 * t750 * t705 + 0.4e1 / 0.3e1 * t109 * t2011);
  t2016 = t2015 * t27;
  t2020 = t758 * t190;
  t2023 = t6 * t2020 * t172 / 0.4e1;
  t2024 = t307 * t547;
  t2026 = t6 * t2024 * t172;
  t2035 = t6 * t714 * t382 / 0.4e1;
  t2037 = t6 * t718 * t382;
  t2040 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t2016 * t172 - t2023 + t2026 / 0.12e2 - t1941 / 0.8e1 + t1945 / 0.6e1 - t1950 - 0.3e1 / 0.8e1 * t6 * t710 * t382 - t2035 + t2037 / 0.12e2);
  tv3rho31 = t696 + t723 + t1955 + t1956 + t7 * (t2000 + t2040);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2043 = t1644 * t780;
  t2048 = t521 * t785;
  t2052 = my_piecewise5(t11, 0, t15, 0, -t1965 - t1966);
  t2056 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t2043 * t181 + 0.8e1 / 0.9e1 * t726 * t730 + 0.4e1 / 0.9e1 * t2048 * t181 + 0.4e1 / 0.3e1 * t24 * t2052);
  t2057 = t2056 * t27;
  t2061 = t789 * t190;
  t2063 = t6 * t2061 * t98;
  t2072 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2057 * t98 - t2063 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t790 * t268 - t1980 + t1986 / 0.6e1 - t1990 + t1674 / 0.12e2 - t1687 + t1689 / 0.12e2);
  t2073 = t1920 * t797;
  t2078 = t698 * t802;
  t2082 = my_piecewise5(t15, 0, t11, 0, t1965 - t2009);
  t2086 = my_piecewise3(t108, 0, -0.8e1 / 0.27e2 * t2073 * t276 + 0.8e1 / 0.9e1 * t750 * t754 + 0.4e1 / 0.9e1 * t2078 * t276 + 0.4e1 / 0.3e1 * t109 * t2082);
  t2087 = t2086 * t27;
  t2091 = t806 * t190;
  t2093 = t6 * t2091 * t172;
  t2100 = t6 * t763 * t382;
  t2108 = t6 * t284 * t947;
  t2110 = -0.3e1 / 0.8e1 * t6 * t2087 * t172 - t2093 / 0.8e1 - t2023 + t2026 / 0.6e1 - 0.3e1 / 0.4e1 * t6 * t759 * t382 - t2100 / 0.4e1 + t1945 / 0.12e2 - t1950 - t2035 + t2037 / 0.6e1 - 0.3e1 / 0.8e1 * t6 * t280 * t947 - t2108 / 0.8e1;
  t2111 = my_piecewise3(t103, 0, t2110);
  tv3rho32 = t1955 + t1956 + t796 + t952 + t7 * (t2072 + t2111);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2116 = t780 * t293;
  t2123 = my_piecewise5(t11, 0, t15, 0, -0.6e1 * t526 - 0.6e1 * t1653);
  t2127 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1644 * t2116 + 0.4e1 / 0.3e1 * t726 * t785 + 0.4e1 / 0.3e1 * t24 * t2123);
  t2128 = t2127 * t27;
  t2135 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2128 * t98 - 0.3e1 / 0.8e1 * t2063 + t1986 / 0.4e1 - t1687);
  t2136 = t797 * t304;
  t2143 = my_piecewise5(t15, 0, t11, 0, 0.6e1 * t526 - 0.6e1 * t1927);
  t2147 = my_piecewise3(t108, 0, -0.8e1 / 0.27e2 * t1920 * t2136 + 0.4e1 / 0.3e1 * t750 * t802 + 0.4e1 / 0.3e1 * t109 * t2143);
  t2148 = t2147 * t27;
  t2163 = t831 * t312;
  t2164 = 0.1e1 / t2163;
  t2168 = 0.76e3 / 0.4782969e7 * t830 * t2164 * t836 * t580;
  t2169 = t143 * t348;
  t2185 = t347 * t347;
  t2186 = 0.1e1 / t2185;
  t2187 = t145 * t2186;
  t2188 = t881 * t365;
  t2189 = t170 * t2188;
  t2195 = t144 * t879;
  t2200 = 0.1e1 / t115 / t441;
  t2201 = sigma[2] * t2200;
  t2204 = 0.154e4 / 0.6561e4 * t34 * t2201 * t126;
  t2206 = 0.1e1 / t114 / t831;
  t2210 = 0.682e4 / 0.1594323e7 * t320 * t2206 * t326 * t41;
  t2211 = -0.18e2 * t2169 * t365 * t843 + 0.18e2 * t2195 * t344 * t881 + 0.18e2 * t344 * t841 * t874 - 0.9e1 * t344 * t846 * t921 - 0.18e2 * t365 * t846 * t850 - 0.9e1 * t365 * t846 * t875 + 0.6e1 * t366 * t880 * t921 - 0.6e1 * t2187 * t2189 - t2168 - t2204 + t2210;
  t2225 = 0.1e1 / t167 / t931 / t164;
  t2226 = t162 * t2225;
  t2227 = t2226 * t569;
  t2228 = t829 * t2164;
  t2240 = t319 * t319;
  t2241 = t569 * t2240;
  t2242 = t831 * t441;
  t2244 = 0.1e1 / t115 / t2242;
  t2248 = 0.1e1 / t125 / t834 / t122;
  t2250 = t2248 * t1761 * t34;
  t2252 = 0.112e4 / 0.3486784401e10 * t2241 * t2244 * t2250;
  t2253 = -0.154e4 / 0.6561e4 * t34 * t2201 * t168 + 0.176e4 / 0.531441e6 * t320 * t2206 * t372 * t41 - 0.32e3 / 0.4782969e7 * t830 * t2164 * t933 * t580 + 0.896e3 / 0.14348907e8 * t2227 * t2228 * t1761 - 0.176e3 / 0.59049e5 * t935 * t936 * t2206 * t580 + 0.1232e4 / 0.6561e4 * t374 * t375 * t2200 * t41 + t2204 - t2210 + t2168 - t2252;
  t2255 = t842 * t343;
  t2256 = t2255 * t158;
  t2259 = t380 * t842;
  t2262 = t945 * t343;
  t2265 = t380 * t874;
  t2270 = t853 * t148;
  t2273 = t134 * t352;
  t2274 = t2273 * t336;
  t2277 = t856 * t863;
  t2285 = -0.44e3 / 0.27e2 * tau[1] * t817 + 0.154e3 / 0.27e2 * t2201;
  t2288 = t135 * t896;
  t2289 = t1822 * t829;
  t2290 = t2289 * t2164;
  t2293 = t867 * t2206;
  t2296 = t136 * t2200;
  t2299 = -0.6e1 * t1117 * t863 - 0.4e1 * t2270 * t340 - 0.4e1 * t2274 * t868 - 0.4e1 * t2277 * t340 + 0.44e2 / 0.3e1 * t857 * t871 - 0.2e1 * t332 * t2285 - 0.8e1 / 0.9e1 * t2288 * t2290 + 0.22e2 / 0.3e1 * t866 * t2293 - 0.308e3 / 0.27e2 * t339 * t2296;
  t2300 = t170 * t2299;
  t2312 = t146 * t155;
  t2315 = params->b * t146;
  t2316 = t853 * t336;
  t2327 = 0.1e1 / t914 / t139;
  t2328 = t152 * t2327;
  t2331 = t2273 * t853;
  t2334 = t866 * t863;
  t2337 = t2288 * t336;
  t2348 = t336 * t863;
  t2358 = t902 * t361;
  t2359 = t853 * params->eta;
  t2363 = t863 * params->eta;
  t2364 = t2363 * t315;
  t2367 = t356 * t915;
  t2368 = t336 * t610;
  t2369 = t319 * t824;
  t2375 = 0.2e2 / 0.9e1 * t2312 * t2290 + 0.12e3 * t2315 * t155 * t2316 + 0.9e2 * t902 * t357 * t863 - 0.132e3 * t906 * t907 * t818 + 0.112e3 / 0.9e1 * t2328 * t2290 + 0.18e2 * t2331 * t340 + 0.9e1 * t2334 * t340 + 0.12e2 * t2337 * t868 - 0.44e2 / 0.3e1 * t897 * t2293 + 0.154e3 / 0.9e1 * t353 * t2296 + 0.6e1 * t2316 * t148 + 0.3e1 * t339 * t2285 + 0.18e2 * t856 * t2348 + 0.6e1 * t356 * t155 * t2285 + 0.308e3 / 0.9e1 * t362 * t2296 - 0.33e2 * t890 * t871 + 0.18e3 * t2358 * t2359 * t315 + 0.36e2 * t906 * t2364 + 0.84e2 * t2367 * t2368 * t2369 - 0.154e3 / 0.3e1 * t916 * t2293;
  t2378 = -t170 * t2375 * t349 - 0.3e1 * t349 * t365 * t945 - 0.3e1 * t349 * t380 * t921 + 0.6e1 * t380 * t880 * t881 + t159 * t2253 + 0.6e1 * t170 * t2256 + 0.18e2 * t2259 * t841 + 0.9e1 * t2262 * t331 + 0.9e1 * t2265 * t331 + 0.3e1 * t2300 * t331 + t2252;
  t2379 = t2211 + t2378;
  t2384 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t2148 * t172 - 0.3e1 / 0.8e1 * t2093 - 0.9e1 / 0.8e1 * t6 * t807 * t382 + t2026 / 0.4e1 - 0.3e1 / 0.4e1 * t2100 - 0.9e1 / 0.8e1 * t6 * t308 * t947 - t1950 + t2037 / 0.4e1 - 0.3e1 / 0.8e1 * t2108 - 0.3e1 / 0.8e1 * t6 * t112 * t2379);
  tv3rho33 = 0.3e1 * t796 + 0.3e1 * t952 + t7 * (t2135 + t2384);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2392 = t6 * t539 * t432;
  t2399 = t6 * t548 * t432 / 0.12e2;
  t2401 = t6 * t191 * t1068;
  t2427 = t406 * t618;
  t2436 = t569 * t574;
  t2438 = t577 * t205 * t580;
  t2440 = 0.85e2 / 0.1594323e7 * t2436 * t2438;
  t2456 = t1694 * t96;
  t2457 = t420 * t229;
  t2458 = t2457 * t251;
  t2461 = 0.12e2 * t1005 * t229 * t584 - 0.6e1 * t1005 * t251 * t589 - 0.6e1 * t1014 * t229 * t589 + 0.4e1 * t1014 * t251 * t624 - 0.6e1 * t1043 * t229 * t589 + 0.4e1 * t1043 * t251 * t624 - 0.6e1 * t1045 * t251 * t589 + 0.6e1 * t1694 * t406 * t625 - 0.6e1 * t1712 * t421 * t625 - 0.6e1 * t1726 * t421 * t585 + 0.12e2 * t229 * t584 * t982 - 0.6e1 * t251 * t589 * t982 - 0.3e1 * t406 * t589 * t665 - 0.3e1 * t421 * t589 * t618 + 0.2e1 * t421 * t624 * t665 + 0.6e1 * t2427 * t584 + 0.12e2 * t2456 * t2458 + t2440;
  t2462 = t204 * t563;
  t2464 = 0.65e3 / 0.531441e6 * t2462 * t966;
  t2465 = t1726 * t96;
  t2466 = t405 * t229;
  t2467 = t2466 * t251;
  t2470 = t572 * t207;
  t2472 = 0.1e1 / t37 / t2470;
  t2475 = 0.14e3 / 0.1162261467e10 * t571 * t2472 * t1783;
  t2481 = t1066 * t229;
  t2484 = t430 * t618;
  t2487 = t266 * t1042;
  t2490 = t574 * t610;
  t2491 = t2490 * t205;
  t2492 = t1821 * t2491;
  t2494 = t402 * t606;
  t2497 = t1822 * t574;
  t2498 = t2497 * t205;
  t2502 = t646 * t413 * t606;
  t2504 = t563 * params->eta;
  t2505 = t2504 * sigma[0];
  t2506 = t609 * t2505;
  t2508 = t402 * t596;
  t2511 = t1001 * t222;
  t2514 = t610 * t563;
  t2515 = t2514 * sigma[0];
  t2519 = t1870 * t413 * t596;
  t2522 = t646 * t1032 * t222;
  t2527 = t210 * t222;
  t2529 = t1890 * t2527 * t62;
  t2531 = t222 * sigma[0];
  t2535 = t650 * t2505;
  t2537 = -t2492 / 0.2e1 - 0.9e1 / 0.8e1 * t609 * t2494 - 0.5e1 / 0.6e1 * t1867 * t2498 - 0.15e2 / 0.4e1 * t2502 + 0.27e2 / 0.8e1 * t2506 - 0.9e1 / 0.4e1 * t1806 * t2508 + 0.6e1 * t609 * t2511 + 0.9e1 / 0.2e1 * t641 * t2515 - 0.15e2 * t2519 + 0.2e2 * t2522 - 0.22e2 / 0.3e1 * t78 * t416 * t556 - 0.15e2 * t2529 - 0.21e2 * t1899 * t997 * t2531 + 0.27e2 / 0.2e1 * t2535;
  t2544 = t1821 * t610;
  t2545 = t2527 * sigma[0];
  t2548 = t1899 * t2491;
  t2554 = t1806 * t210;
  t2555 = t651 * sigma[0];
  t2556 = t2554 * t2555;
  t2559 = t599 * t197 * t222;
  t2561 = params->eta * t556;
  t2564 = t81 * t556;
  t2565 = t242 * t2564;
  t2567 = t39 * t606;
  t2568 = t599 * t2567;
  t2570 = t1803 * t39;
  t2572 = t225 * t556;
  t2574 = -0.45e2 / 0.2e1 * t1890 * t2508 + 0.24e2 * t650 * t2511 + 0.63e2 / 0.4e1 * t660 * t2515 - 0.3e1 * t2544 * t2545 - 0.7e1 / 0.2e1 * t2548 - 0.9e1 / 0.2e1 * t650 * t2494 - 0.14e2 / 0.3e1 * t1851 * t2498 - 0.3e1 / 0.2e1 * t2556 + 0.4e1 * t2559 - 0.11e2 / 0.3e1 * t239 * t2561 - 0.22e2 / 0.3e1 * t2565 - 0.3e1 / 0.4e1 * t2568 - 0.3e1 / 0.4e1 * t2570 - 0.11e2 / 0.3e1 * t2572;
  t2575 = t2537 + t2574;
  t2576 = t96 * t2575;
  t2578 = t606 * t67;
  t2579 = t2578 * t39;
  t2581 = t222 * t74;
  t2584 = t985 * t197;
  t2590 = t218 * t556;
  t2594 = t1806 * t610;
  t2606 = t2579 / 0.4e1 + t2581 * t989 / 0.3e1 - 0.4e1 / 0.3e1 * t2584 + t1806 * t2491 / 0.6e1 - 0.3e1 / 0.2e1 * t599 * t2505 + 0.22e2 / 0.9e1 * t2590 + t1803 * t402 / 0.2e1 + t2594 * t2545 - 0.8e1 / 0.3e1 * t599 * t2511 + t599 * t2494 / 0.2e1 + t1821 * t2498 / 0.3e1 - 0.9e1 / 0.4e1 * t609 * t2515 + 0.22e2 / 0.9e1 * t225 * t2561;
  t2607 = t96 * t2606;
  t2610 = t689 * t420;
  t2612 = t689 * t405;
  t2615 = t266 * t1004;
  t2624 = t677 * t205 * t580;
  t2627 = t574 * t1761;
  t2631 = t203 * t563;
  t2641 = 0.11e3 / 0.2187e4 * t34 * t556 * t49;
  t2642 = 0.11e3 / 0.2187e4 * t34 * t556 * t94 - 0.2e2 / 0.19683e5 * t2462 * t1054 + 0.4e2 / 0.1594323e7 * t2436 * t2624 - 0.112e3 / 0.4782969e7 * t1758 * t2627 * t205 + 0.2e1 / 0.2187e4 * t679 * t2631 * t1058 - 0.88e2 / 0.2187e4 * t260 * t33 * t556 * t41 - t2641 + t2464 - t2440 + t2475;
  t2644 = t430 * t625;
  t2647 = t430 * t585;
  t2650 = t585 * t84;
  t2653 = -0.2e1 * t1066 * t235 * t251 - t235 * t430 * t665 + 0.6e1 * t217 * t2481 + 0.3e1 * t217 * t2484 + 0.3e1 * t217 * t2607 + 0.3e1 * t217 * t2612 + 0.6e1 * t217 * t2615 - 0.2e1 * t235 * t2487 - t235 * t2576 - t235 * t2610 - 0.12e2 * t2465 * t2467 + t2642 * t85 + 0.2e1 * t2644 * t624 + 0.6e1 * t2647 * t584 + 0.6e1 * t2650 * t406 - t2464 - t2475 + t2641;
  t2654 = t2461 + t2653;
  t2659 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t432 - t2392 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t1068 + t2399 - t2401 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t2654);
  tv3rho2sigma0 = t2659 * t7 + 0.2e1 * t1073;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2666 = t6 * t714 * t479;
  t2670 = t6 * t718 * t479 / 0.12e2;
  t2672 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t479 - t2666 / 0.4e1 + t2670);
  tv3rho2sigma2 = t2672 * t7 + 0.2e1 * t1082;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2678 = t6 * t739 * t432;
  t2686 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t432 - t2678 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t1068 - t2392 / 0.8e1 + t2399 - t2401 / 0.8e1);
  tv3rho2sigma3 = t2686 * t7 + t1073 + t1088;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2692 = t6 * t763 * t479;
  t2699 = t6 * t284 * t1200;
  t2702 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t479 - t2692 / 0.8e1 - t2666 / 0.8e1 + t2670 - 0.3e1 / 0.8e1 * t6 * t280 * t1200 - t2699 / 0.8e1);
  tv3rho2sigma5 = t2702 * t7 + t1082 + t1205;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2710 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t432 - t2678 / 0.4e1 + t2399);
  tv3rho2sigma6 = t2710 * t7 + 0.2e1 * t1088;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2721 = t453 * t874;
  t2769 = t569 * t833;
  t2771 = t836 * t319 * t580;
  t2773 = 0.85e2 / 0.1594323e7 * t2769 * t2771;
  t2774 = t2169 * t170;
  t2775 = t452 * t343;
  t2776 = t2775 * t365;
  t2779 = 0.12e2 * t1114 * t343 * t841 - 0.6e1 * t1114 * t365 * t846 + 0.12e2 * t1137 * t343 * t841 - 0.6e1 * t1137 * t365 * t846 - 0.6e1 * t1146 * t343 * t846 + 0.4e1 * t1146 * t365 * t880 - 0.6e1 * t1175 * t343 * t846 + 0.4e1 * t1175 * t365 * t880 - 0.6e1 * t1177 * t365 * t846 - 0.6e1 * t2169 * t468 * t842 - 0.6e1 * t2187 * t468 * t881 + 0.6e1 * t2195 * t453 * t881 - 0.3e1 * t453 * t846 * t921 - 0.3e1 * t468 * t846 * t874 + 0.2e1 * t468 * t880 * t921 + 0.6e1 * t2721 * t841 - 0.12e2 * t2774 * t2776 + t2773;
  t2780 = t2195 * t170;
  t2781 = t467 * t343;
  t2782 = t2781 * t365;
  t2785 = t204 * t824;
  t2787 = 0.65e3 / 0.531441e6 * t2785 * t1098;
  t2788 = t831 * t321;
  t2790 = 0.1e1 / t115 / t2788;
  t2793 = 0.14e3 / 0.1162261467e10 * t830 * t2790 * t2250;
  t2794 = t842 * t158;
  t2800 = t477 * t842;
  t2803 = t945 * t452;
  t2806 = t380 * t1136;
  t2809 = t863 * t141;
  t2810 = t2809 * t117;
  t2812 = t336 * t148;
  t2815 = t1117 * t314;
  t2817 = t833 * t610;
  t2818 = t2817 * t319;
  t2821 = t824 * params->eta;
  t2822 = t2821 * sigma[2];
  t2825 = t332 * t817;
  t2829 = t2273 * t610;
  t2830 = t324 * t336;
  t2831 = t2830 * sigma[2];
  t2833 = t1133 * t336;
  t2836 = t449 * t863;
  t2839 = t1822 * t833;
  t2840 = t2839 * t319;
  t2843 = t610 * t824;
  t2844 = t2843 * sigma[2];
  t2847 = params->eta * t817;
  t2850 = t2810 / 0.4e1 + t2812 * t1121 / 0.3e1 - 0.4e1 / 0.3e1 * t2815 + t2273 * t2818 / 0.6e1 - 0.3e1 / 0.2e1 * t856 * t2822 + 0.22e2 / 0.9e1 * t2825 + t2270 * t449 / 0.2e1 + t2829 * t2831 - 0.8e1 / 0.3e1 * t856 * t2833 + t856 * t2836 / 0.2e1 + t2288 * t2840 / 0.3e1 - 0.9e1 / 0.4e1 * t866 * t2844 + 0.22e2 / 0.9e1 * t339 * t2847;
  t2851 = t170 * t2850;
  t2854 = t477 * t874;
  t2860 = t477 * t921;
  t2865 = t2315 * t460 * t853;
  t2868 = t902 * t1164 * t336;
  t2873 = t866 * t2822;
  t2875 = t449 * t853;
  t2881 = t902 * t460 * t863;
  t2883 = t2288 * t2818;
  t2889 = t2367 * t2818;
  t2895 = 0.9e1 / 0.2e1 * t897 * t2844 - 0.15e2 * t2865 + 0.2e2 * t2868 - 0.22e2 / 0.3e1 * t152 * t463 * t817 + 0.27e2 / 0.8e1 * t2873 - 0.9e1 / 0.4e1 * t2273 * t2875 + 0.6e1 * t866 * t2833 - 0.15e2 / 0.4e1 * t2881 - t2883 / 0.2e1 - 0.9e1 / 0.8e1 * t866 * t2836 - 0.5e1 / 0.6e1 * t2312 * t2840 - 0.7e1 / 0.2e1 * t2889 - 0.9e1 / 0.2e1 * t906 * t2836 - 0.14e2 / 0.3e1 * t2328 * t2840;
  t2896 = t2273 * t324;
  t2897 = t907 * sigma[2];
  t2898 = t2896 * t2897;
  t2900 = t2288 * t610;
  t2905 = t906 * t2822;
  t2912 = t2358 * t2830 * t136;
  t2914 = t336 * sigma[2];
  t2920 = t155 * t817;
  t2921 = t356 * t2920;
  t2924 = t856 * t314 * t336;
  t2926 = t117 * t863;
  t2927 = t856 * t2926;
  t2929 = t2270 * t117;
  t2931 = t339 * t817;
  t2933 = -0.3e1 / 0.2e1 * t2898 - 0.3e1 * t2900 * t2831 + 0.63e2 / 0.4e1 * t916 * t2844 + 0.27e2 / 0.2e1 * t2905 - 0.45e2 / 0.2e1 * t2358 * t2875 + 0.24e2 * t906 * t2833 - 0.15e2 * t2912 - 0.21e2 * t2367 * t1129 * t2914 - 0.11e2 / 0.3e1 * t353 * t2847 - 0.22e2 / 0.3e1 * t2921 + 0.4e1 * t2924 - 0.3e1 / 0.4e1 * t2927 - 0.3e1 / 0.4e1 * t2929 - 0.11e2 / 0.3e1 * t2931;
  t2934 = t2895 + t2933;
  t2935 = t170 * t2934;
  t2937 = t1198 * t343;
  t2940 = t945 * t467;
  t2942 = t380 * t1174;
  t2947 = 0.11e3 / 0.2187e4 * t34 * t817 * t126;
  t2954 = t933 * t319 * t580;
  t2957 = t833 * t1761;
  t2961 = t203 * t824;
  t2969 = 0.11e3 / 0.2187e4 * t34 * t817 * t168 - 0.2e2 / 0.19683e5 * t2785 * t1186 + 0.4e2 / 0.1594323e7 * t2769 * t2954 - 0.112e3 / 0.4782969e7 * t2227 * t2957 * t319 + 0.2e1 / 0.2187e4 * t935 * t2961 * t1190 - 0.88e2 / 0.2187e4 * t374 * t33 * t817 * t41 - t2947 + t2787 - t2773 + t2793;
  t2971 = -0.2e1 * t1198 * t349 * t365 + 0.2e1 * t477 * t880 * t881 + t159 * t2969 + 0.12e2 * t2780 * t2782 + 0.6e1 * t2794 * t453 + 0.6e1 * t2800 * t841 + 0.3e1 * t2803 * t331 + 0.6e1 * t2806 * t331 + 0.3e1 * t2851 * t331 + 0.3e1 * t2854 * t331 - t2860 * t349 - t2935 * t349 + 0.6e1 * t2937 * t331 - t2940 * t349 - 0.2e1 * t2942 * t349 - t2787 - t2793 + t2947;
  t2972 = t2779 + t2971;
  t2977 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t479 - t2692 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t1200 + t2670 - t2699 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * t2972);
  tv3rho2sigma8 = t2977 * t7 + 0.2e1 * t1205;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rho2lapl0 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  tv3rho2lapl1 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 1] += tv3rho2lapl1;

  tv3rho2lapl2 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 2] += tv3rho2lapl2;

  tv3rho2lapl3 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 3] += tv3rho2lapl3;

  tv3rho2lapl4 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 4] += tv3rho2lapl4;

  tv3rho2lapl5 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 5] += tv3rho2lapl5;

  t2984 = t6 * t539 * t496;
  t2991 = t6 * t548 * t496 / 0.12e2;
  t2993 = t6 * t191 * t1262;
  t2995 = t689 * t493;
  t2997 = t584 * t1229;
  t2998 = t229 * params->eta;
  t2999 = t2998 * sigma[0];
  t3000 = t1231 * t2999;
  t3003 = t589 * t1229;
  t3004 = t251 * params->eta;
  t3005 = t3004 * sigma[0];
  t3006 = t1231 * t3005;
  t3033 = t589 * t266;
  t3036 = t985 * t1219;
  t3039 = t54 * t665;
  t3040 = t218 * t3039;
  t3043 = t39 * t229;
  t3044 = t218 * t3043;
  t3047 = t54 * t625;
  t3048 = t218 * t3047;
  t3051 = t39 * t251;
  t3052 = t218 * t3051;
  t3055 = -0.6e1 * t1243 * t229 * t589 + 0.4e1 * t1243 * t251 * t624 - 0.6e1 * t1260 * t229 * t589 + 0.4e1 * t1260 * t251 * t624 - 0.6e1 * t1712 * t494 * t625 - 0.6e1 * t1726 * t494 * t585 - 0.3e1 * t494 * t589 * t618 + 0.2e1 * t494 * t624 * t665 + 0.4e2 * t1213 * t3044 + 0.12e2 * t1218 * t3036 + 0.6e1 * t1218 * t3040 - 0.2e2 * t1218 * t3052 + 0.12e2 * t1220 * t3033 - t235 * t2995 - 0.12e2 * t2456 * t3048 - 0.16e2 * t2997 * t3000 + 0.8e1 * t3003 * t3006;
  t3056 = t584 * t266;
  t3059 = t985 * t1214;
  t3062 = t54 * t618;
  t3063 = t218 * t3062;
  t3072 = t2650 * t96;
  t3075 = t217 * t689;
  t3080 = t2578 * t54;
  t3083 = t493 * t229;
  t3084 = t3083 * t251;
  t3087 = t1726 * t1229;
  t3088 = t67 * t54;
  t3089 = t229 * t251;
  t3090 = t3088 * t3089;
  t3093 = t266 * t57;
  t3094 = t217 * t3093;
  t3097 = t96 * t222;
  t3098 = t217 * t3097;
  t3101 = t238 * t971;
  t3102 = t3101 * t611;
  t3105 = t74 * t210;
  t3106 = t3105 * t62;
  t3109 = t266 * t1259;
  t3114 = t1806 * t396;
  t3118 = t54 * t606;
  t3121 = t971 * t610;
  t3122 = t3121 * t205;
  t3142 = 0.6e1 * t1803 * t54 + 0.12e2 * t3114 * t2555 - 0.2e2 * t1017 + 0.6e1 * t599 * t3118 + 0.4e1 * t1821 * t3122 - 0.21e2 * t1019 + 0.4e2 / 0.3e1 * t1021 + 0.12e3 * t1870 * t490 * t596 + 0.12e3 * t1890 * t396 * t222 * t62 - 0.1e3 * t1028 + 0.3e2 * t646 * t490 * t606 + 0.28e2 * t1899 * t3122 - 0.84e2 * t1030 + 0.8e2 / 0.3e1 * t1033;
  t3143 = t96 * t3142;
  t3145 = -0.24e2 * t3056 * t1215 - 0.24e2 * t1213 * t3059 - 0.12e2 * t1213 * t3063 + 0.2e2 * t1223 * t401 + 0.2e2 * t484 * t986 - 0.8e2 / 0.3e1 * t484 * t992 - 0.12e2 * t3072 * t485 - 0.6e1 * t3075 * t485 - 0.12e2 * t1223 * t1226 - 0.6e1 * t484 * t3080 + 0.12e2 * t2456 * t3084 + 0.24e2 * t3087 * t3090 - 0.8e1 * t3094 * t1232 - 0.8e1 * t3098 * t1232 - 0.4e1 * t1230 * t3102 + 0.28e2 * t1230 * t3106 - 0.2e1 * t235 * t3109 - t235 * t3143;
  t3146 = t3055 + t3145;
  t3151 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t496 - t2984 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t1262 + t2991 - t2993 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t3146);
  tv3rho2tau0 = t3151 * t7 + 0.2e1 * t1267;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  t3158 = t6 * t714 * t513;
  t3162 = t6 * t718 * t513 / 0.12e2;
  t3164 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t513 - t3158 / 0.4e1 + t3162);
  tv3rho2tau1 = t3164 * t7 + 0.2e1 * t1276;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 1] += tv3rho2tau1;

  t3170 = t6 * t739 * t496;
  t3178 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t496 - t3170 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t1262 - t2984 / 0.8e1 + t2991 - t2993 / 0.8e1);
  tv3rho2tau2 = t3178 * t7 + t1267 + t1282;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 2] += tv3rho2tau2;

  t3184 = t6 * t763 * t513;
  t3191 = t6 * t284 * t1336;
  t3194 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t513 - t3184 / 0.8e1 - t3158 / 0.8e1 + t3162 - 0.3e1 / 0.8e1 * t6 * t280 * t1336 - t3191 / 0.8e1);
  tv3rho2tau3 = t3194 * t7 + t1276 + t1341;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 3] += tv3rho2tau3;

  t3202 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t496 - t3170 / 0.4e1 + t2991);
  tv3rho2tau4 = t3202 * t7 + 0.2e1 * t1282;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 4] += tv3rho2tau4;

  t3237 = t841 * t1303;
  t3238 = t343 * params->eta;
  t3239 = t3238 * sigma[2];
  t3240 = t1305 * t3239;
  t3243 = t846 * t1303;
  t3244 = t365 * params->eta;
  t3245 = t3244 * sigma[2];
  t3246 = t1305 * t3245;
  t3251 = t2809 * t131;
  t3260 = t2794 * t170;
  t3263 = t510 * t343;
  t3264 = t3263 * t365;
  t3267 = -0.6e1 * t2169 * t511 * t842 - 0.6e1 * t2187 * t511 * t881 + 0.4e1 * t880 * t1334 * t365 + 0.2e1 * t880 * t511 * t921 - 0.6e1 * t846 * t1317 * t343 - 0.6e1 * t846 * t1334 * t343 - 0.3e1 * t846 * t511 * t874 + 0.4e1 * t880 * t1317 * t365 - 0.16e2 * t3237 * t3240 + 0.8e1 * t3243 * t3246 - 0.12e2 * t1297 * t1300 - 0.6e1 * t501 * t3251 + 0.2e2 * t1297 * t448 + 0.2e2 * t501 * t1118 - 0.8e2 / 0.3e1 * t501 * t1124 - 0.12e2 * t3260 * t502 + 0.12e2 * t2780 * t3264;
  t3268 = t331 * t945;
  t3271 = t131 * t921;
  t3272 = t332 * t3271;
  t3275 = t117 * t343;
  t3276 = t332 * t3275;
  t3279 = t131 * t881;
  t3280 = t332 * t3279;
  t3283 = t117 * t365;
  t3284 = t332 * t3283;
  t3287 = t841 * t380;
  t3290 = t1117 * t1288;
  t3293 = t131 * t874;
  t3294 = t332 * t3293;
  t3297 = t846 * t380;
  t3300 = t1117 * t1293;
  t3303 = t148 * t324;
  t3304 = t3303 * t136;
  t3307 = t380 * t134;
  t3308 = t331 * t3307;
  t3311 = t170 * t336;
  t3312 = t331 * t3311;
  t3315 = t352 * t1103;
  t3316 = t3315 * t867;
  t3319 = t2169 * t1303;
  t3320 = t141 * t131;
  t3321 = t343 * t365;
  t3322 = t3320 * t3321;
  t3325 = t380 * t1333;
  t3330 = t2273 * t443;
  t3334 = t131 * t863;
  t3337 = t1103 * t610;
  t3338 = t3337 * t319;
  t3358 = 0.6e1 * t2270 * t131 + 0.12e2 * t3330 * t2897 - 0.2e2 * t1149 + 0.6e1 * t856 * t3334 + 0.4e1 * t2288 * t3338 - 0.21e2 * t1151 + 0.4e2 / 0.3e1 * t1153 + 0.12e3 * t2315 * t507 * t853 + 0.12e3 * t2358 * t443 * t336 * t136 - 0.1e3 * t1160 + 0.3e2 * t902 * t507 * t863 + 0.28e2 * t2367 * t3338 - 0.84e2 * t1162 + 0.8e2 / 0.3e1 * t1165;
  t3359 = t170 * t3358;
  t3361 = t945 * t510;
  t3363 = 0.4e2 * t1287 * t3276 - 0.24e2 * t1287 * t3290 - 0.12e2 * t1287 * t3294 - 0.24e2 * t1289 * t3287 + 0.6e1 * t1292 * t3272 - 0.2e2 * t1292 * t3284 + 0.12e2 * t1292 * t3300 + 0.12e2 * t1294 * t3297 + 0.28e2 * t1304 * t3304 - 0.4e1 * t1304 * t3316 - 0.8e1 * t1306 * t3308 - 0.8e1 * t1306 * t3312 - 0.12e2 * t2780 * t3280 - 0.6e1 * t3268 * t502 + 0.24e2 * t3319 * t3322 - 0.2e1 * t3325 * t349 - t3359 * t349 - t3361 * t349;
  t3364 = t3267 + t3363;
  t3369 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t513 - t3184 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t1336 + t3162 - t3191 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * t3364);
  tv3rho2tau5 = t3369 * t7 + 0.2e1 * t1341;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 5] += tv3rho2tau5;

  t3376 = t6 * t191 * t1409 / 0.8e1;
  t3377 = t405 * t420;
  t3378 = t3377 * t229;
  t3381 = t3377 * t251;
  t3385 = 0.1e1 / t37 / t1720;
  t3388 = 0.35e2 / 0.774840978e9 * t969 * t3385 * t1783;
  t3391 = t971 * t74;
  t3392 = t3391 * t62;
  t3394 = t2581 * t1248;
  t3396 = t3121 * sigma[0];
  t3399 = t599 * t988;
  t3401 = t1365 * t222;
  t3404 = t1822 * t971;
  t3405 = t3404 * sigma[0];
  t3410 = t210 * t67 / 0.6e1 - t3392 / 0.48e2 - t3394 / 0.8e1 - t1806 * t3396 / 0.8e1 + 0.2e1 / 0.3e1 * t3399 - 0.3e1 / 0.16e2 * t1806 * t3401 - t1821 * t3405 / 0.8e1 + t609 * t997 / 0.2e1;
  t3411 = t96 * t3410;
  t3414 = t1066 * t405;
  t3417 = t430 * t1004;
  t3420 = t266 * t1368;
  t3423 = t2581 * t396;
  t3425 = t971 * params->eta;
  t3426 = t3425 * sigma[0];
  t3427 = t1806 * t3426;
  t3429 = t599 * t210;
  t3431 = t1248 * t222;
  t3432 = t1806 * t3431;
  t3434 = t1821 * t3396;
  t3436 = t609 * t988;
  t3444 = t1870 * t1385 * t222;
  t3446 = t1890 * t3426;
  t3448 = t81 * t210;
  t3449 = t646 * t3448;
  t3451 = t1890 * t3431;
  t3453 = t1899 * t3396;
  t3457 = t242 * t247 * t210 * params->eta;
  t3466 = 0.3e1 / 0.32e2 * t3423 + 0.3e1 / 0.32e2 * t3427 - t3429 / 0.2e1 + 0.9e1 / 0.16e2 * t3432 + 0.3e1 / 0.8e1 * t3434 - 0.3e1 / 0.2e1 * t3436 + 0.9e1 / 0.16e2 * t1821 * t3401 + 0.5e1 / 0.16e2 * t1867 * t3405 - t641 * t997 + 0.15e2 / 0.8e1 * t3444 + 0.15e2 / 0.16e2 * t3446 - 0.5e1 / 0.2e1 * t3449 + 0.45e2 / 0.8e1 * t3451 + 0.21e2 / 0.8e1 * t3453 - 0.6e1 * t3457 + 0.63e2 / 0.16e2 * t1899 * t3401 + 0.7e1 / 0.4e1 * t1851 * t3405 - 0.7e1 / 0.2e1 * t78 * t1392 * t210;
  t3467 = t96 * t3466;
  t3469 = t1407 * t229;
  t3474 = t229 * t84;
  t3477 = t266 * t1351;
  t3480 = t430 * t1042;
  t3483 = t266 * t1396;
  t3485 = t266 * t1372;
  t3488 = t1066 * t420;
  t3495 = t569 * t971;
  t3496 = t677 * t580;
  t3497 = t3496 * sigma[0];
  t3508 = 0.4e2 / 0.177147e6 * t204 * t214;
  t3509 = t577 * t580;
  t3510 = t3509 * sigma[0];
  t3512 = 0.25e2 / 0.1594323e7 * t3495 * t3510;
  t3513 = 0.4e2 / 0.177147e6 * t204 * t210 * t258 * t41 - 0.5e1 / 0.531441e6 * t3495 * t3497 + 0.14e2 / 0.1594323e7 * t1758 * t971 * t1761 * sigma[0] - 0.4e1 / 0.19683e5 * t679 * t1057 * t580 - t3508 + t3512 - t3388;
  t3515 = -t1407 * t235 * t251 + 0.6e1 * t1352 * t3474 + 0.3e1 * t217 * t3411 + 0.6e1 * t217 * t3414 + 0.6e1 * t217 * t3417 + 0.3e1 * t217 * t3420 + 0.3e1 * t217 * t3469 - t235 * t3467 - 0.2e1 * t235 * t3480 - t235 * t3483 - 0.2e1 * t235 * t3488 + 0.12e2 * t2456 * t3381 - 0.12e2 * t2465 * t3378 + 0.6e1 * t3477 * t584 + 0.2e1 * t3485 * t624 + t3513 * t85 + t3388;
  t3537 = t406 * t1004;
  t3540 = t1352 * t251;
  t3564 = -0.6e1 * t1005 * t420 * t589 - 0.6e1 * t1042 * t406 * t589 + 0.4e1 * t1042 * t421 * t624 + 0.12e2 * t1358 * t229 * t584 - 0.6e1 * t1358 * t251 * t589 + 0.6e1 * t1369 * t229 * t584 - 0.3e1 * t1369 * t251 * t589 + 0.6e1 * t1373 * t1694 * t229 - 0.6e1 * t1373 * t1712 * t251 - 0.6e1 * t1376 * t229 * t589 + 0.4e1 * t1376 * t251 * t624 - 0.3e1 * t1397 * t229 * t589 + 0.2e1 * t1397 * t251 * t624 - 0.6e1 * t420 * t589 * t982 - 0.6e1 * t1726 * t3540 + 0.12e2 * t3537 * t584 + t3508 - t3512;
  t3565 = t3515 + t3564;
  t3570 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t1409 - t3376 - 0.3e1 / 0.8e1 * t6 * t28 * t3565);
  tv3rhosigma20 = t3570 * t7 + t1413;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t3577 = t6 * t284 * t1480 / 0.8e1;
  t3579 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t1480 - t3577);
  tv3rhosigma25 = t3579 * t7 + t1484;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t3585 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t1409 - t3376);
  tv3rhosigma26 = t3585 * t7 + t1413;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t3590 = t452 * t467;
  t3591 = t3590 * t343;
  t3594 = t3590 * t365;
  t3598 = 0.1e1 / t115 / t2163;
  t3601 = 0.35e2 / 0.774840978e9 * t1101 * t3598 * t2250;
  t3605 = t569 * t1103;
  t3606 = t836 * t580;
  t3607 = t3606 * sigma[2];
  t3609 = 0.25e2 / 0.1594323e7 * t3605 * t3607;
  t3611 = 0.4e2 / 0.177147e6 * t204 * t328;
  t3645 = -0.6e1 * t1114 * t467 * t846 + 0.4e1 * t1174 * t468 * t880 + 0.12e2 * t1429 * t343 * t841 - 0.6e1 * t1429 * t365 * t846 + 0.6e1 * t1440 * t343 * t841 - 0.3e1 * t1440 * t365 * t846 - 0.6e1 * t1444 * t2187 * t365 + 0.6e1 * t1444 * t2195 * t343 - 0.6e1 * t1447 * t343 * t846 + 0.4e1 * t1447 * t365 * t880 - 0.3e1 * t1468 * t343 * t846 + 0.2e1 * t1468 * t365 * t880 - 0.12e2 * t2774 * t3591 + 0.12e2 * t2780 * t3594 + t3601 - t3609 + t3611;
  t3652 = t1423 * t365;
  t3655 = t453 * t1136;
  t3658 = t1478 * t343;
  t3663 = t343 * t158;
  t3666 = t380 * t1422;
  t3669 = t1198 * t452;
  t3672 = t477 * t1136;
  t3675 = t380 * t1439;
  t3680 = t1103 * t148;
  t3681 = t3680 * t136;
  t3683 = t2812 * t1322;
  t3685 = t3337 * sigma[2];
  t3688 = t856 * t1120;
  t3690 = t1436 * t336;
  t3693 = t1822 * t1103;
  t3694 = t3693 * sigma[2];
  t3699 = t324 * t141 / 0.6e1 - t3681 / 0.48e2 - t3683 / 0.8e1 - t2273 * t3685 / 0.8e1 + 0.2e1 / 0.3e1 * t3688 - 0.3e1 / 0.16e2 * t2273 * t3690 - t2288 * t3694 / 0.8e1 + t866 * t1129 / 0.2e1;
  t3700 = t170 * t3699;
  t3703 = t380 * t1443;
  t3706 = t1198 * t467;
  t3709 = t477 * t1174;
  t3712 = t380 * t1467;
  t3714 = t2812 * t443;
  t3716 = t1103 * params->eta;
  t3717 = t3716 * sigma[2];
  t3718 = t2273 * t3717;
  t3720 = t856 * t324;
  t3722 = t1322 * t336;
  t3723 = t2273 * t3722;
  t3725 = t2288 * t3685;
  t3727 = t866 * t1120;
  t3735 = t2315 * t1456 * t336;
  t3737 = t2358 * t3717;
  t3739 = t155 * t324;
  t3740 = t902 * t3739;
  t3742 = t2358 * t3722;
  t3744 = t2367 * t3685;
  t3748 = t356 * t361 * t324 * params->eta;
  t3757 = 0.3e1 / 0.32e2 * t3714 + 0.3e1 / 0.32e2 * t3718 - t3720 / 0.2e1 + 0.9e1 / 0.16e2 * t3723 + 0.3e1 / 0.8e1 * t3725 - 0.3e1 / 0.2e1 * t3727 + 0.9e1 / 0.16e2 * t2288 * t3690 + 0.5e1 / 0.16e2 * t2312 * t3694 - t897 * t1129 + 0.15e2 / 0.8e1 * t3735 + 0.15e2 / 0.16e2 * t3737 - 0.5e1 / 0.2e1 * t3740 + 0.45e2 / 0.8e1 * t3742 + 0.21e2 / 0.8e1 * t3744 - 0.6e1 * t3748 + 0.63e2 / 0.16e2 * t2367 * t3690 + 0.7e1 / 0.4e1 * t2328 * t3694 - 0.7e1 / 0.2e1 * t152 * t1463 * t324;
  t3758 = t170 * t3757;
  t3764 = t933 * t580;
  t3765 = t3764 * sigma[2];
  t3775 = 0.4e2 / 0.177147e6 * t204 * t324 * t372 * t41 - 0.5e1 / 0.531441e6 * t3605 * t3765 + 0.14e2 / 0.1594323e7 * t2227 * t1103 * t1761 * sigma[2] - 0.4e1 / 0.19683e5 * t935 * t1189 * t580 - t3611 + t3609 - t3601;
  t3777 = -0.6e1 * t1137 * t467 * t846 - 0.6e1 * t1174 * t453 * t846 - t1478 * t349 * t365 + 0.6e1 * t1423 * t3663 + t159 * t3775 - 0.6e1 * t2169 * t3652 + 0.3e1 * t331 * t3658 + 0.6e1 * t331 * t3669 + 0.6e1 * t331 * t3672 + 0.3e1 * t331 * t3675 + 0.3e1 * t331 * t3700 - 0.2e1 * t349 * t3706 - 0.2e1 * t349 * t3709 - t349 * t3712 - t349 * t3758 + 0.12e2 * t3655 * t841 + 0.6e1 * t3666 * t841 + 0.2e1 * t3703 * t880;
  t3778 = t3645 + t3777;
  t3783 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t1480 - t3577 - 0.3e1 / 0.8e1 * t6 * t112 * t3778);
  tv3rhosigma211 = t3783 * t7 + t1484;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  tv3rhosigmalapl0 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmalapl1 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 1] += tv3rhosigmalapl1;

  tv3rhosigmalapl2 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 2] += tv3rhosigmalapl2;

  tv3rhosigmalapl3 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 3] += tv3rhosigmalapl3;

  tv3rhosigmalapl4 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 4] += tv3rhosigmalapl4;

  tv3rhosigmalapl5 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 5] += tv3rhosigmalapl5;

  tv3rhosigmalapl6 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 6] += tv3rhosigmalapl6;

  tv3rhosigmalapl7 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 7] += tv3rhosigmalapl7;

  tv3rhosigmalapl8 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 8] += tv3rhosigmalapl8;

  tv3rhosigmalapl9 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 9] += tv3rhosigmalapl9;

  tv3rhosigmalapl10 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 10] += tv3rhosigmalapl10;

  tv3rhosigmalapl11 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 11] += tv3rhosigmalapl11;

  t3790 = t6 * t191 * t1528 / 0.8e1;
  t3793 = t589 * t430;
  t3796 = t1346 * t74;
  t3797 = t3796 * t62;
  t3798 = t484 * t3797;
  t3800 = t39 * t405;
  t3801 = t218 * t3800;
  t3804 = t39 * t420;
  t3805 = t218 * t3804;
  t3810 = t985 * t1485;
  t3813 = t54 * t1004;
  t3814 = t218 * t3813;
  t3819 = t985 * t1489;
  t3822 = t54 * t1042;
  t3823 = t218 * t3822;
  t3826 = t584 * t430;
  t3829 = -0.13e2 / 0.2e1 * t484 * t1363 + 0.6e1 * t3793 * t1220 + t3798 / 0.2e1 + 0.2e2 * t1213 * t3801 - 0.1e2 * t1218 * t3805 - 0.12e2 * t3056 * t1486 - 0.12e2 * t1213 * t3810 - 0.12e2 * t1213 * t3814 + 0.6e1 * t3033 * t1490 + 0.6e1 * t1218 * t3819 + 0.6e1 * t1218 * t3823 - 0.12e2 * t3826 * t1215;
  t3832 = t2581 * t1502;
  t3835 = t3474 * t96;
  t3838 = t405 * params->eta;
  t3839 = t3838 * sigma[0];
  t3840 = t1231 * t3839;
  t3843 = t420 * params->eta;
  t3844 = t3843 * sigma[0];
  t3845 = t1231 * t3844;
  t3848 = t405 * t251;
  t3849 = t3088 * t3848;
  t3852 = t3088 * t2457;
  t3855 = t1694 * t1229;
  t3856 = t420 * t251;
  t3857 = t3088 * t3856;
  t3860 = t430 * t57;
  t3861 = t217 * t3860;
  t3864 = t74 * t1497;
  t3865 = t3864 * t2998;
  t3868 = t3864 * t3004;
  t3871 = t238 * t1346;
  t3872 = t610 * sigma[0];
  t3873 = t3871 * t3872;
  t3876 = 0.3e1 / 0.2e1 * t1223 * t1503 + 0.3e1 / 0.2e1 * t484 * t3832 - 0.12e2 * t3835 * t1486 - 0.8e1 * t2997 * t3840 + 0.4e1 * t3003 * t3845 + 0.12e2 * t3087 * t3849 + 0.12e2 * t3087 * t3852 - 0.12e2 * t3855 * t3857 - 0.4e1 * t3861 * t1232 + 0.3e1 * t2997 * t3865 - 0.3e1 / 0.2e1 * t3003 * t3868 + 0.3e1 / 0.2e1 * t1230 * t3873;
  t3880 = t217 * t96 * t396 * t67;
  t3911 = t217 * t266 * t1497 * t67;
  t3916 = -0.13e2 / 0.4e1 * t3880 + 0.2e1 * t624 * t1512 * t251 - 0.3e1 * t589 * t1526 * t229 + 0.2e1 * t624 * t1526 * t251 + 0.2e1 * t624 * t1260 * t420 + 0.2e1 * t624 * t494 * t1042 - 0.3e1 * t589 * t1512 * t229 - 0.3e1 * t589 * t1260 * t405 - 0.3e1 * t589 * t494 * t1004 + 0.2e1 * t624 * t1243 * t420 + 0.3e1 / 0.4e1 * t3911 - 0.3e1 * t589 * t1243 * t405;
  t3917 = t1066 * t493;
  t3919 = t266 * t1525;
  t3921 = t2581 * t1497;
  t3923 = t1346 * params->eta;
  t3924 = t3923 * sigma[0];
  t3925 = t1806 * t3924;
  t3928 = t1502 * t222;
  t3931 = t1346 * t610;
  t3932 = t3931 * sigma[0];
  t3937 = t1870 * t1518 * t222;
  t3939 = t1890 * t3924;
  t3947 = -0.3e1 / 0.4e1 * t3921 - 0.3e1 / 0.4e1 * t3925 + 0.13e2 / 0.4e1 * t1379 - 0.9e1 / 0.4e1 * t1806 * t3928 - 0.3e1 / 0.2e1 * t1821 * t3932 + 0.39e2 / 0.8e1 * t1381 - 0.15e2 * t3937 - 0.15e2 / 0.2e1 * t3939 + 0.65e2 / 0.4e1 * t1386 - 0.45e2 / 0.2e1 * t1890 * t3928 - 0.21e2 / 0.2e1 * t1899 * t3932 + 0.39e2 / 0.2e1 * t1390;
  t3948 = t96 * t3947;
  t3950 = t430 * t1259;
  t3954 = t1497 * t67;
  t3955 = t3954 * t229;
  t3956 = t1213 * t3955;
  t3958 = t3954 * t251;
  t3959 = t1218 * t3958;
  t3961 = t493 * t405;
  t3962 = t3961 * t229;
  t3965 = t3961 * t251;
  t3968 = t493 * t420;
  t3969 = t3968 * t229;
  t3972 = t1712 * t96;
  t3973 = t3968 * t251;
  t3976 = t217 * t1066;
  t3981 = -t235 * t3917 - t235 * t3919 - t235 * t3948 - t235 * t3950 + 0.1e2 * t1493 * t401 + 0.3e1 / 0.2e1 * t3956 - 0.3e1 / 0.4e1 * t3959 - 0.6e1 * t2465 * t3962 + 0.6e1 * t2456 * t3965 + 0.6e1 * t2456 * t3969 - 0.6e1 * t3972 * t3973 - 0.6e1 * t3976 * t485 - 0.6e1 * t1493 * t1226;
  t3983 = t3829 + t3876 + t3916 + t3981;
  t3988 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t1528 - t3790 - 0.3e1 / 0.8e1 * t6 * t28 * t3983);
  tv3rhosigmatau0 = t3988 * t7 + t1532;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rhosigmatau1 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 1] += tv3rhosigmatau1;

  tv3rhosigmatau2 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 2] += tv3rhosigmatau2;

  tv3rhosigmatau3 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 3] += tv3rhosigmatau3;

  tv3rhosigmatau4 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 4] += tv3rhosigmatau4;

  t3995 = t6 * t284 * t1576 / 0.8e1;
  t3997 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t1576 - t3995);
  tv3rhosigmatau5 = t3997 * t7 + t1580;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 5] += tv3rhosigmatau5;

  t4003 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t1528 - t3790);
  tv3rhosigmatau6 = t4003 * t7 + t1532;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 6] += tv3rhosigmatau6;

  tv3rhosigmatau7 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 7] += tv3rhosigmatau7;

  tv3rhosigmatau8 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 8] += tv3rhosigmatau8;

  tv3rhosigmatau9 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 9] += tv3rhosigmatau9;

  tv3rhosigmatau10 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 10] += tv3rhosigmatau10;

  t4008 = t452 * params->eta;
  t4009 = t4008 * sigma[2];
  t4010 = t1305 * t4009;
  t4013 = t467 * params->eta;
  t4014 = t4013 * sigma[2];
  t4015 = t1305 * t4014;
  t4018 = t452 * t365;
  t4019 = t3320 * t4018;
  t4022 = t3320 * t2781;
  t4025 = t2195 * t1303;
  t4026 = t467 * t365;
  t4027 = t3320 * t4026;
  t4030 = t477 * t134;
  t4031 = t331 * t4030;
  t4034 = t148 * t1545;
  t4035 = t4034 * t3238;
  t4038 = t4034 * t3244;
  t4041 = t352 * t1417;
  t4042 = t610 * sigma[2];
  t4043 = t4041 * t4042;
  t4046 = t2812 * t1545;
  t4048 = t1417 * params->eta;
  t4049 = t4048 * sigma[2];
  t4050 = t2273 * t4049;
  t4053 = t1550 * t336;
  t4056 = t1417 * t610;
  t4057 = t4056 * sigma[2];
  t4062 = t2315 * t1566 * t336;
  t4064 = t2358 * t4049;
  t4072 = -0.3e1 / 0.4e1 * t4046 - 0.3e1 / 0.4e1 * t4050 + 0.13e2 / 0.4e1 * t1450 - 0.9e1 / 0.4e1 * t2273 * t4053 - 0.3e1 / 0.2e1 * t2288 * t4057 + 0.39e2 / 0.8e1 * t1452 - 0.15e2 * t4062 - 0.15e2 / 0.2e1 * t4064 + 0.65e2 / 0.4e1 * t1457 - 0.45e2 / 0.2e1 * t2358 * t4053 - 0.21e2 / 0.2e1 * t2367 * t4057 + 0.39e2 / 0.2e1 * t1461;
  t4073 = t170 * t4072;
  t4075 = t1198 * t510;
  t4077 = t477 * t1333;
  t4079 = -0.8e1 * t3237 * t4010 + 0.4e1 * t3243 * t4015 + 0.12e2 * t3319 * t4019 + 0.12e2 * t3319 * t4022 - 0.12e2 * t4025 * t4027 - 0.4e1 * t4031 * t1306 + 0.3e1 * t3237 * t4035 - 0.3e1 / 0.2e1 * t3243 * t4038 + 0.3e1 / 0.2e1 * t1304 * t4043 - t349 * t4073 - t349 * t4075 - t349 * t4077;
  t4080 = t380 * t1573;
  t4084 = t331 * t170 * t443 * t141;
  t4109 = t331 * t380 * t1545 * t141;
  t4117 = -t349 * t4080 - 0.13e2 / 0.4e1 * t4084 + 0.2e1 * t880 * t1560 * t365 - 0.3e1 * t846 * t1574 * t343 + 0.2e1 * t880 * t1574 * t365 + 0.2e1 * t880 * t1317 * t467 + 0.2e1 * t880 * t1334 * t467 + 0.2e1 * t880 * t511 * t1174 - 0.3e1 * t846 * t1560 * t343 + 0.3e1 / 0.4e1 * t4109 - 0.3e1 * t846 * t1317 * t452 - 0.3e1 * t846 * t1334 * t452;
  t4126 = t1545 * t141;
  t4127 = t4126 * t365;
  t4128 = t1292 * t4127;
  t4130 = t510 * t452;
  t4131 = t4130 * t343;
  t4134 = t4130 * t365;
  t4137 = t510 * t467;
  t4138 = t4137 * t343;
  t4141 = t2187 * t170;
  t4142 = t4137 * t365;
  t4145 = t331 * t1198;
  t4148 = t4126 * t343;
  t4149 = t1287 * t4148;
  t4151 = t117 * t467;
  t4152 = t332 * t4151;
  t4157 = -0.3e1 * t846 * t511 * t1136 + 0.1e2 * t1541 * t448 - 0.6e1 * t1541 * t1300 - 0.3e1 / 0.4e1 * t4128 - 0.6e1 * t2774 * t4131 + 0.6e1 * t2780 * t4134 + 0.6e1 * t2780 * t4138 - 0.6e1 * t4141 * t4142 - 0.6e1 * t4145 * t502 + 0.3e1 / 0.2e1 * t4149 - 0.1e2 * t1292 * t4152 - 0.13e2 / 0.2e1 * t501 * t1434;
  t4158 = t1417 * t148;
  t4159 = t4158 * t136;
  t4160 = t501 * t4159;
  t4164 = t2812 * t1550;
  t4167 = t117 * t452;
  t4168 = t332 * t4167;
  t4171 = t131 * t1174;
  t4172 = t332 * t4171;
  t4175 = t841 * t477;
  t4178 = t846 * t477;
  t4181 = t3663 * t170;
  t4186 = t1117 * t1533;
  t4189 = t131 * t1136;
  t4190 = t332 * t4189;
  t4195 = t1117 * t1537;
  t4198 = t4160 / 0.2e1 + 0.3e1 / 0.2e1 * t1297 * t1551 + 0.3e1 / 0.2e1 * t501 * t4164 + 0.2e2 * t1287 * t4168 + 0.6e1 * t1292 * t4172 - 0.12e2 * t4175 * t1289 + 0.6e1 * t4178 * t1294 - 0.12e2 * t4181 * t1534 - 0.12e2 * t3287 * t1534 - 0.12e2 * t1287 * t4186 - 0.12e2 * t1287 * t4190 + 0.6e1 * t3297 * t1538 + 0.6e1 * t1292 * t4195;
  t4200 = t4079 + t4117 + t4157 + t4198;
  t4205 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t1576 - t3995 - 0.3e1 / 0.8e1 * t6 * t112 * t4200);
  tv3rhosigmatau11 = t4205 * t7 + t1580;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 11] += tv3rhosigmatau11;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapl21 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 1] += tv3rholapl21;

  tv3rholapl22 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 2] += tv3rholapl22;

  tv3rholapl23 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 3] += tv3rholapl23;

  tv3rholapl24 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 4] += tv3rholapl24;

  tv3rholapl25 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 5] += tv3rholapl25;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  tv3rholapltau1 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 1] += tv3rholapltau1;

  tv3rholapltau2 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 2] += tv3rholapltau2;

  tv3rholapltau3 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 3] += tv3rholapltau3;

  tv3rholapltau4 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 4] += tv3rholapltau4;

  tv3rholapltau5 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 5] += tv3rholapltau5;

  tv3rholapltau6 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 6] += tv3rholapltau6;

  tv3rholapltau7 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 7] += tv3rholapltau7;

  t4212 = t6 * t191 * t1606 / 0.8e1;
  t4213 = t493 * params->eta;
  t4214 = t4213 * sigma[0];
  t4215 = t1231 * t4214;
  t4218 = t266 * t1594;
  t4221 = t266 * t1603;
  t4225 = 0.1e1 / t561;
  t4226 = t4225 * params->eta;
  t4227 = t4226 * sigma[0];
  t4237 = 0.12e3 * t1600 * t1870 * t222 + 0.6e1 * t1582 * t2581 + 0.6e1 * t1806 * t4227 + 0.6e2 * t1890 * t4227 - 0.2e2 * t1514 - 0.1e3 * t1519;
  t4238 = t96 * t4237;
  t4240 = t96 * t58;
  t4241 = t584 * t4240;
  t4242 = t640 * t4225;
  t4243 = t4242 * t62;
  t4246 = t3088 * t3083;
  t4249 = t493 * t251;
  t4250 = t3088 * t4249;
  t4272 = -0.6e1 * t1582 * t217 * t266 * t67 + 0.4e1 * t1259 * t494 * t624 + 0.6e1 * t1595 * t1694 * t229 - 0.6e1 * t1595 * t1712 * t251 - 0.3e1 * t1604 * t229 * t589 + 0.2e1 * t1604 * t251 * t624 - t235 * t4221 - t235 * t4238 + 0.8e1 * t3003 * t4215 + 0.24e2 * t3087 * t4246 - 0.24e2 * t3855 * t4250 + 0.2e1 * t4218 * t624 + 0.32e2 * t4241 * t4243;
  t4273 = t609 * t1497;
  t4280 = t1582 * t67;
  t4281 = t4280 * t229;
  t4284 = t4280 * t251;
  t4290 = t985 * t1586;
  t4293 = t54 * t1259;
  t4294 = t218 * t4293;
  t4297 = t4225 * t74;
  t4298 = t4297 * t62;
  t4302 = t609 * t1582 * t251;
  t4306 = t1806 * t1582 * t222;
  t4309 = t39 * t493;
  t4310 = t218 * t4309;
  t4313 = -0.8e2 * t1213 * t4273 - 0.12e2 * t1213 * t4281 + 0.48e2 * t1213 * t4306 + 0.6e1 * t1218 * t4284 + 0.12e2 * t1218 * t4290 + 0.12e2 * t1218 * t4294 - 0.2e2 * t1218 * t4310 + 0.24e2 * t1583 * t3056 + 0.24e2 * t1583 * t3835 + 0.12e2 * t1587 * t3033 - 0.24e2 * t2465 * t4302 - 0.4e1 * t4298 * t484 + 0.2e2 * t1500;
  t4314 = t4272 + t4313;
  t4319 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t1606 - t4212 - 0.3e1 / 0.8e1 * t6 * t28 * t4314);
  tv3rhotau20 = t4319 * t7 + t1610;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  tv3rhotau21 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 1] += tv3rhotau21;

  t4326 = t6 * t284 * t1636 / 0.8e1;
  t4328 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t1636 - t4326);
  tv3rhotau22 = t4328 * t7 + t1640;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 2] += tv3rhotau22;

  t4334 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t1606 - t4212);
  tv3rhotau23 = t4334 * t7 + t1610;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 3] += tv3rhotau23;

  tv3rhotau24 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 4] += tv3rhotau24;

  t4339 = t510 * params->eta;
  t4340 = t4339 * sigma[2];
  t4341 = t1305 * t4340;
  t4344 = t3320 * t3263;
  t4347 = t510 * t365;
  t4348 = t3320 * t4347;
  t4351 = t170 * t135;
  t4352 = t841 * t4351;
  t4353 = 0.1e1 / t822;
  t4354 = t896 * t4353;
  t4355 = t4354 * t136;
  t4377 = t866 * t1545;
  t4380 = t1612 * t141;
  t4381 = t4380 * t343;
  t4384 = t4380 * t365;
  t4387 = -0.6e1 * t141 * t1612 * t331 * t380 + 0.4e1 * t1333 * t511 * t880 - 0.6e1 * t1625 * t2187 * t365 + 0.6e1 * t1625 * t2195 * t343 - 0.3e1 * t1634 * t343 * t846 + 0.2e1 * t1634 * t365 * t880 - 0.8e2 * t1287 * t4377 - 0.12e2 * t1287 * t4381 + 0.6e1 * t1292 * t4384 + 0.8e1 * t3243 * t4341 + 0.24e2 * t3319 * t4344 - 0.24e2 * t4025 * t4348 + 0.32e2 * t4352 * t4355;
  t4393 = t131 * t1333;
  t4394 = t332 * t4393;
  t4397 = t4353 * t148;
  t4398 = t4397 * t136;
  t4401 = t117 * t510;
  t4402 = t332 * t4401;
  t4406 = t866 * t1612 * t365;
  t4410 = t2273 * t1612 * t336;
  t4415 = t1117 * t1616;
  t4418 = t380 * t1624;
  t4421 = t380 * t1633;
  t4425 = t4353 * params->eta;
  t4426 = t4425 * sigma[2];
  t4436 = 0.12e3 * t1630 * t2315 * t336 + 0.6e1 * t1612 * t2812 + 0.6e1 * t2273 * t4426 + 0.6e2 * t2358 * t4426 - 0.2e2 * t1562 - 0.1e3 * t1567;
  t4437 = t170 * t4436;
  t4439 = 0.48e2 * t1287 * t4410 + 0.12e2 * t1292 * t4394 - 0.2e2 * t1292 * t4402 + 0.12e2 * t1292 * t4415 + 0.24e2 * t1613 * t3287 + 0.24e2 * t1613 * t4181 + 0.12e2 * t1617 * t3297 - 0.24e2 * t2774 * t4406 - t349 * t4421 - t349 * t4437 - 0.4e1 * t4398 * t501 + 0.2e1 * t4418 * t880 + 0.2e2 * t1548;
  t4440 = t4387 + t4439;
  t4445 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t1636 - t4326 - 0.3e1 / 0.8e1 * t6 * t112 * t4440);
  tv3rhotau25 = t4445 * t7 + t1640;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 5] += tv3rhotau25;

  t4447 = t430 * t1372;
  t4450 = t1407 * t420;
  t4453 = t430 * t1396;
  t4457 = t1806 * t3923;
  t4459 = t1821 * t3931;
  t4461 = t1822 * t1346;
  t4464 = t81 * t1346;
  t4465 = t1870 * t4464;
  t4469 = t646 * t247 * t1346 * params->eta;
  t4473 = t242 * t659 * t1346 * t610;
  t4475 = t1850 * t1822;
  t4479 = -0.3e1 / 0.256e3 * t3796 - 0.27e2 / 0.256e3 * t4457 - 0.27e2 / 0.128e3 * t4459 - 0.15e2 / 0.128e3 * t1867 * t4461 - 0.15e2 / 0.64e2 * t4465 - 0.135e3 / 0.128e3 * t4469 - 0.189e3 / 0.128e3 * t4473 - 0.21e2 / 0.32e2 * t78 * t4475 * t1346;
  t4480 = t96 * t4479;
  t4485 = t1372 * t420;
  t4486 = t96 * t4485;
  t4492 = t1352 * t420;
  t4495 = t406 * t1368;
  t4507 = t569 * t1346;
  t4514 = 0.5e1 / 0.1417176e7 * t4507 * t3509;
  t4516 = 0.1e1 / t37 / t573;
  t4519 = 0.35e2 / 0.2066242608e10 * t1345 * t4516 * t1783;
  t4520 = 0.5e1 / 0.1417176e7 * t4507 * t3496 - 0.7e1 / 0.2125764e7 * t1757 * t4507 * t1761 - t4514 + t4519;
  t4522 = t1351 * t405;
  t4523 = t4522 * t84;
  t4526 = t430 * t1351;
  t4529 = t1407 * t405;
  t4532 = t430 * t1368;
  t4535 = t3796 * params->eta;
  t4537 = t1806 * t3931;
  t4541 = 0.3e1 / 0.128e3 * t4535 + 0.9e1 / 0.128e3 * t4537 + 0.3e1 / 0.64e2 * t1821 * t4461;
  t4542 = t96 * t4541;
  t4545 = 0.6e1 * t624 * t4447 - 0.3e1 * t235 * t4450 - 0.3e1 * t235 * t4453 - t235 * t4480 + 0.18e2 * t1694 * t406 * t1372 - 0.6e1 * t1712 * t4486 + 0.6e1 * t624 * t421 * t1396 - 0.18e2 * t1726 * t4492 + 0.18e2 * t584 * t4495 - 0.18e2 * t589 * t1358 * t420 - 0.9e1 * t589 * t1369 * t420 - 0.9e1 * t589 * t406 * t1396 + t85 * t4520 + t4514 + 0.6e1 * t4523 * t96 + 0.18e2 * t584 * t4526 + 0.9e1 * t217 * t4529 + 0.9e1 * t217 * t4532 + 0.3e1 * t217 * t4542 - t4519;
  t4549 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t4545);
  tv3sigma30 = t7 * t4549;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t4550 = t569 * t1417;
  t4557 = 0.5e1 / 0.1417176e7 * t4550 * t3606;
  t4559 = 0.1e1 / t115 / t832;
  t4562 = 0.35e2 / 0.2066242608e10 * t1416 * t4559 * t2250;
  t4563 = 0.5e1 / 0.1417176e7 * t4550 * t3764 - 0.7e1 / 0.2125764e7 * t2226 * t4550 * t1761 - t4557 + t4562;
  t4565 = t1478 * t452;
  t4568 = t477 * t1439;
  t4571 = t4158 * params->eta;
  t4573 = t2273 * t4056;
  t4575 = t1822 * t1417;
  t4578 = 0.3e1 / 0.128e3 * t4571 + 0.9e1 / 0.128e3 * t4573 + 0.3e1 / 0.64e2 * t2288 * t4575;
  t4579 = t170 * t4578;
  t4582 = t477 * t1443;
  t4585 = t1478 * t467;
  t4588 = t477 * t1467;
  t4592 = t2273 * t4048;
  t4594 = t2288 * t4056;
  t4598 = t155 * t1417;
  t4599 = t2315 * t4598;
  t4603 = t902 * t361 * t1417 * params->eta;
  t4607 = t356 * t915 * t1417 * t610;
  t4609 = t2327 * t1822;
  t4613 = -0.3e1 / 0.256e3 * t4158 - 0.27e2 / 0.256e3 * t4592 - 0.27e2 / 0.128e3 * t4594 - 0.15e2 / 0.128e3 * t2312 * t4575 - 0.15e2 / 0.64e2 * t4599 - 0.135e3 / 0.128e3 * t4603 - 0.189e3 / 0.128e3 * t4607 - 0.21e2 / 0.32e2 * t152 * t4609 * t1417;
  t4614 = t170 * t4613;
  t4616 = t1422 * t452;
  t4617 = t4616 * t158;
  t4620 = t477 * t1422;
  t4626 = t1423 * t467;
  t4629 = t453 * t1439;
  t4641 = t1443 * t467;
  t4642 = t170 * t4641;
  t4648 = t159 * t4563 + 0.9e1 * t331 * t4565 + 0.9e1 * t331 * t4568 + 0.3e1 * t331 * t4579 + 0.6e1 * t880 * t4582 - 0.3e1 * t349 * t4585 - 0.3e1 * t349 * t4588 - t349 * t4614 + t4557 + 0.6e1 * t4617 * t170 + 0.18e2 * t841 * t4620 + 0.18e2 * t2195 * t453 * t1443 - 0.18e2 * t2169 * t4626 + 0.18e2 * t841 * t4629 - 0.18e2 * t846 * t1429 * t467 - 0.9e1 * t846 * t1440 * t467 - 0.9e1 * t846 * t453 * t1467 - 0.6e1 * t2187 * t4642 + 0.6e1 * t880 * t468 * t1467 - t4562;
  t4652 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t4648);
  tv3sigma39 = t7 * t4652;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  tv3sigma2lapl0 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2lapl1 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 1] += tv3sigma2lapl1;

  tv3sigma2lapl2 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 2] += tv3sigma2lapl2;

  tv3sigma2lapl3 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 3] += tv3sigma2lapl3;

  tv3sigma2lapl4 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 4] += tv3sigma2lapl4;

  tv3sigma2lapl5 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 5] += tv3sigma2lapl5;

  tv3sigma2lapl6 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 6] += tv3sigma2lapl6;

  tv3sigma2lapl7 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 7] += tv3sigma2lapl7;

  tv3sigma2lapl8 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 8] += tv3sigma2lapl8;

  tv3sigma2lapl9 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 9] += tv3sigma2lapl9;

  tv3sigma2lapl10 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 10] += tv3sigma2lapl10;

  tv3sigma2lapl11 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 11] += tv3sigma2lapl11;

  t4656 = t494 * t1351;
  t4661 = t217 * t430 * t1497 * t67;
  t4669 = t3088 * t3377;
  t4672 = t3864 * t3838;
  t4675 = t3864 * t3843;
  t4690 = t3961 * t420;
  t4693 = t1351 * t84;
  t4694 = t4693 * t96;
  t4697 = -0.6e1 * t1712 * t494 * t1372 - 0.6e1 * t1726 * t4656 + 0.3e1 / 0.2e1 * t4661 - 0.6e1 * t589 * t1512 * t405 - 0.6e1 * t589 * t1526 * t405 + 0.24e2 * t3087 * t4669 + 0.6e1 * t2997 * t4672 - 0.3e1 * t3003 * t4675 + 0.4e1 * t624 * t1526 * t420 + 0.2e1 * t624 * t494 * t1396 - 0.3e1 * t589 * t494 * t1368 + 0.4e1 * t624 * t1512 * t420 + 0.12e2 * t2456 * t4690 - 0.12e2 * t4694 * t485;
  t4698 = t3954 * t405;
  t4699 = t1213 * t4698;
  t4701 = t3954 * t420;
  t4702 = t1218 * t4701;
  t4704 = t217 * t1407;
  t4707 = t4297 * params->eta;
  t4708 = t484 * t4707;
  t4711 = t1806 * t4226;
  t4713 = t4225 * t610;
  t4716 = t81 * t4225;
  t4717 = t1870 * t4716;
  t4721 = t646 * t247 * t4225 * params->eta;
  t4727 = 0.3e1 / 0.32e2 * t4297 + 0.9e1 / 0.16e2 * t4711 + 0.9e1 / 0.16e2 * t1821 * t4713 + 0.15e2 / 0.8e1 * t4717 + 0.45e2 / 0.8e1 * t4721 + 0.63e2 / 0.16e2 * t242 * t659 * t4225 * t610;
  t4728 = t96 * t4727;
  t4730 = t1407 * t493;
  t4732 = t430 * t1525;
  t4737 = t54 * t1396;
  t4738 = t218 * t4737;
  t4743 = t1806 * t4713;
  t4746 = t54 * t1372;
  t4747 = t218 * t4746;
  t4752 = t54 * t1368;
  t4753 = t218 * t4752;
  t4756 = 0.3e1 * t4699 - 0.3e1 / 0.2e1 * t4702 - 0.6e1 * t4704 * t485 - 0.3e1 / 0.8e1 * t4708 - t235 * t4728 - t235 * t4730 - 0.2e1 * t235 * t4732 + 0.12e2 * t3793 * t1490 + 0.6e1 * t1218 * t4738 + 0.3e1 * t1493 * t1503 - 0.9e1 / 0.16e2 * t484 * t4743 - 0.12e2 * t2456 * t4747 - 0.24e2 * t3826 * t1486 - 0.12e2 * t1213 * t4753;
  t4757 = t4697 + t4756;
  t4761 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t4757);
  tv3sigma2tau0 = t7 * t4761;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2tau1 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 1] += tv3sigma2tau1;

  tv3sigma2tau2 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 2] += tv3sigma2tau2;

  tv3sigma2tau3 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 3] += tv3sigma2tau3;

  tv3sigma2tau4 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 4] += tv3sigma2tau4;

  tv3sigma2tau5 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 5] += tv3sigma2tau5;

  tv3sigma2tau6 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 6] += tv3sigma2tau6;

  tv3sigma2tau7 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 7] += tv3sigma2tau7;

  tv3sigma2tau8 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 8] += tv3sigma2tau8;

  tv3sigma2tau9 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 9] += tv3sigma2tau9;

  tv3sigma2tau10 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 10] += tv3sigma2tau10;

  t4765 = t511 * t1422;
  t4782 = t331 * t477 * t1545 * t141;
  t4790 = t4034 * t4013;
  t4793 = t3320 * t3590;
  t4796 = t4034 * t4008;
  t4799 = t1478 * t510;
  t4801 = t477 * t1573;
  t4804 = -0.6e1 * t2187 * t511 * t1443 - 0.6e1 * t2169 * t4765 - 0.3e1 * t846 * t511 * t1439 + 0.4e1 * t880 * t1560 * t467 + 0.4e1 * t880 * t1574 * t467 + 0.2e1 * t880 * t511 * t1467 + 0.3e1 / 0.2e1 * t4782 - 0.6e1 * t846 * t1560 * t452 - 0.6e1 * t846 * t1574 * t452 - 0.3e1 * t3243 * t4790 + 0.24e2 * t3319 * t4793 + 0.6e1 * t3237 * t4796 - t349 * t4799 - 0.2e1 * t349 * t4801;
  t4806 = t2273 * t4425;
  t4808 = t4353 * t610;
  t4811 = t155 * t4353;
  t4812 = t2315 * t4811;
  t4816 = t902 * t361 * t4353 * params->eta;
  t4822 = 0.3e1 / 0.32e2 * t4397 + 0.9e1 / 0.16e2 * t4806 + 0.9e1 / 0.16e2 * t2288 * t4808 + 0.15e2 / 0.8e1 * t4812 + 0.45e2 / 0.8e1 * t4816 + 0.63e2 / 0.16e2 * t356 * t915 * t4353 * t610;
  t4823 = t170 * t4822;
  t4825 = t1422 * t158;
  t4826 = t4825 * t170;
  t4829 = t331 * t1478;
  t4832 = t4397 * params->eta;
  t4833 = t501 * t4832;
  t4835 = t4130 * t467;
  t4838 = t4126 * t452;
  t4839 = t1287 * t4838;
  t4841 = t4126 * t467;
  t4842 = t1292 * t4841;
  t4846 = t2273 * t4808;
  t4851 = t131 * t1439;
  t4852 = t332 * t4851;
  t4857 = t131 * t1467;
  t4858 = t332 * t4857;
  t4861 = t131 * t1443;
  t4862 = t332 * t4861;
  t4865 = -t349 * t4823 - 0.12e2 * t4826 * t502 - 0.6e1 * t4829 * t502 - 0.3e1 / 0.8e1 * t4833 + 0.12e2 * t2780 * t4835 + 0.3e1 * t4839 - 0.3e1 / 0.2e1 * t4842 + 0.3e1 * t1541 * t1551 - 0.9e1 / 0.16e2 * t501 * t4846 - 0.24e2 * t4175 * t1534 - 0.12e2 * t1287 * t4852 + 0.12e2 * t4178 * t1538 + 0.6e1 * t1292 * t4858 - 0.12e2 * t2780 * t4862;
  t4866 = t4804 + t4865;
  t4870 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t4866);
  tv3sigma2tau11 = t7 * t4870;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 11] += tv3sigma2tau11;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapl21 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 1] += tv3sigmalapl21;

  tv3sigmalapl22 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 2] += tv3sigmalapl22;

  tv3sigmalapl23 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 3] += tv3sigmalapl23;

  tv3sigmalapl24 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 4] += tv3sigmalapl24;

  tv3sigmalapl25 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 5] += tv3sigmalapl25;

  tv3sigmalapl26 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 6] += tv3sigmalapl26;

  tv3sigmalapl27 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 7] += tv3sigmalapl27;

  tv3sigmalapl28 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 8] += tv3sigmalapl28;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalapltau1 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 1] += tv3sigmalapltau1;

  tv3sigmalapltau2 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 2] += tv3sigmalapltau2;

  tv3sigmalapltau3 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 3] += tv3sigmalapltau3;

  tv3sigmalapltau4 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 4] += tv3sigmalapltau4;

  tv3sigmalapltau5 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 5] += tv3sigmalapltau5;

  tv3sigmalapltau6 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 6] += tv3sigmalapltau6;

  tv3sigmalapltau7 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 7] += tv3sigmalapltau7;

  tv3sigmalapltau8 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 8] += tv3sigmalapltau8;

  tv3sigmalapltau9 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 9] += tv3sigmalapltau9;

  tv3sigmalapltau10 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 10] += tv3sigmalapltau10;

  tv3sigmalapltau11 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 11] += tv3sigmalapltau11;

  t4871 = t405 * t84;
  t4872 = t4871 * t96;
  t4876 = t609 * t1582 * t420;
  t4881 = 0.1e1 / t208;
  t4882 = t1806 * t4881;
  t4883 = t1213 * t4882;
  t4885 = t4881 * params->eta;
  t4886 = t1821 * t4885;
  t4889 = t3088 * t3961;
  t4892 = t3088 * t3968;
  t4897 = t3954 * t493;
  t4898 = t1218 * t4897;
  t4900 = t3864 * t4213;
  t4903 = t54 * t1525;
  t4904 = t218 * t4903;
  t4907 = 0.24e2 * t4872 * t1583 - 0.24e2 * t2465 * t4876 + 0.24e2 * t3826 * t1583 - 0.6e1 * t4883 - 0.12e2 * t1213 * t4886 + 0.24e2 * t3087 * t4889 - 0.24e2 * t3855 * t4892 + 0.12e2 * t3793 * t1587 - 0.3e1 / 0.2e1 * t4898 - 0.3e1 * t3003 * t4900 + 0.12e2 * t1218 * t4904;
  t4908 = t4280 * t405;
  t4911 = t4280 * t420;
  t4918 = t4881 * t74;
  t4919 = t4918 * params->eta;
  t4928 = t430 * t1594;
  t4940 = t430 * t1603;
  t4945 = t81 * t4881;
  t4946 = t1870 * t4945;
  t4952 = -0.3e1 / 0.4e1 * t4918 - 0.9e1 / 0.4e1 * t1806 * t4885 - 0.15e2 * t4946 - 0.45e2 / 0.2e1 * t646 * t247 * t4881 * params->eta;
  t4953 = t96 * t4952;
  t4955 = -0.12e2 * t1213 * t4908 + 0.6e1 * t1218 * t4911 - 0.6e1 * t217 * t430 * t1582 * t67 + 0.3e1 / 0.2e1 * t484 * t4919 + 0.6e1 * t1694 * t1595 * t405 - 0.6e1 * t1712 * t1595 * t420 + 0.2e1 * t624 * t4928 + 0.4e1 * t624 * t494 * t1525 - 0.3e1 * t589 * t1604 * t405 + 0.2e1 * t624 * t1604 * t420 - t235 * t4940 - t235 * t4953;
  t4956 = t4907 + t4955;
  t4960 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t4956);
  tv3sigmatau20 = t7 * t4960;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  tv3sigmatau21 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 1] += tv3sigmatau21;

  tv3sigmatau22 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 2] += tv3sigmatau22;

  tv3sigmatau23 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 3] += tv3sigmatau23;

  tv3sigmatau24 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 4] += tv3sigmatau24;

  tv3sigmatau25 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 5] += tv3sigmatau25;

  tv3sigmatau26 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 6] += tv3sigmatau26;

  tv3sigmatau27 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 7] += tv3sigmatau27;

  t4961 = t452 * t158;
  t4962 = t4961 * t170;
  t4966 = t866 * t1612 * t467;
  t4971 = 0.1e1 / t322;
  t4972 = t2273 * t4971;
  t4973 = t1287 * t4972;
  t4975 = t4971 * params->eta;
  t4976 = t2288 * t4975;
  t4979 = t3320 * t4130;
  t4982 = t3320 * t4137;
  t4987 = t4126 * t510;
  t4988 = t1292 * t4987;
  t4990 = t4034 * t4339;
  t4993 = t131 * t1573;
  t4994 = t332 * t4993;
  t4997 = 0.24e2 * t4962 * t1613 - 0.24e2 * t2774 * t4966 + 0.24e2 * t4175 * t1613 - 0.6e1 * t4973 - 0.12e2 * t1287 * t4976 + 0.24e2 * t3319 * t4979 - 0.24e2 * t4025 * t4982 + 0.12e2 * t4178 * t1617 - 0.3e1 / 0.2e1 * t4988 - 0.3e1 * t3243 * t4990 + 0.12e2 * t1292 * t4994;
  t4998 = t4380 * t452;
  t5001 = t4380 * t467;
  t5008 = t4971 * t148;
  t5009 = t5008 * params->eta;
  t5018 = t477 * t1624;
  t5030 = t477 * t1633;
  t5035 = t155 * t4971;
  t5036 = t2315 * t5035;
  t5042 = -0.3e1 / 0.4e1 * t5008 - 0.9e1 / 0.4e1 * t2273 * t4975 - 0.15e2 * t5036 - 0.45e2 / 0.2e1 * t902 * t361 * t4971 * params->eta;
  t5043 = t170 * t5042;
  t5045 = -0.12e2 * t1287 * t4998 + 0.6e1 * t1292 * t5001 - 0.6e1 * t331 * t477 * t1612 * t141 + 0.3e1 / 0.2e1 * t501 * t5009 + 0.6e1 * t2195 * t1625 * t452 - 0.6e1 * t2187 * t1625 * t467 + 0.2e1 * t880 * t5018 + 0.4e1 * t880 * t511 * t1573 - 0.3e1 * t846 * t1634 * t452 + 0.2e1 * t880 * t1634 * t467 - t349 * t5030 - t349 * t5043;
  t5046 = t4997 + t5045;
  t5050 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t5046);
  tv3sigmatau28 = t7 * t5050;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 8] += tv3sigmatau28;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl31 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 1] += tv3lapl31;

  tv3lapl32 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 2] += tv3lapl32;

  tv3lapl33 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 3] += tv3lapl33;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2tau1 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 1] += tv3lapl2tau1;

  tv3lapl2tau2 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 2] += tv3lapl2tau2;

  tv3lapl2tau3 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 3] += tv3lapl2tau3;

  tv3lapl2tau4 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 4] += tv3lapl2tau4;

  tv3lapl2tau5 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 5] += tv3lapl2tau5;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltau21 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 1] += tv3lapltau21;

  tv3lapltau22 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 2] += tv3lapltau22;

  tv3lapltau23 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 3] += tv3lapltau23;

  tv3lapltau24 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 4] += tv3lapltau24;

  tv3lapltau25 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 5] += tv3lapltau25;

  t5051 = 0.1e1 / t394;
  t5052 = t5051 * t84;
  t5057 = t609 * t1582 * t493;
  t5060 = t1806 * t5051;
  t5063 = t54 * t1594;
  t5064 = t218 * t5063;
  t5067 = t4280 * t493;
  t5070 = t54 * t1603;
  t5071 = t218 * t5070;
  t5074 = t1594 * t493;
  t5075 = t96 * t5074;
  t5083 = t81 * t5051;
  t5086 = 0.12e3 * t1870 * t5083 + 0.6e1 * t5051 * t74;
  t5087 = t96 * t5086;
  t5089 = 0.6e1 * t1603 * t494 * t624 - 0.48e2 * t1867 * t5052 * t96 + 0.72e2 * t1213 * t5060 + 0.18e2 * t1218 * t5067 + 0.18e2 * t1218 * t5071 - 0.6e1 * t1712 * t5075 - t235 * t5087 - 0.36e2 * t2456 * t5064 - 0.72e2 * t2465 * t5057;
  t5093 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t5089);
  tv3tau30 = t7 * t5093;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

  tv3tau31 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 1] += tv3tau31;

  tv3tau32 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 2] += tv3tau32;

  t5094 = 0.1e1 / t441;
  t5095 = t5094 * t158;
  t5100 = t866 * t1612 * t510;
  t5103 = t2273 * t5094;
  t5106 = t131 * t1624;
  t5107 = t332 * t5106;
  t5110 = t4380 * t510;
  t5113 = t131 * t1633;
  t5114 = t332 * t5113;
  t5117 = t1624 * t510;
  t5118 = t170 * t5117;
  t5126 = t155 * t5094;
  t5129 = 0.6e1 * t148 * t5094 + 0.12e3 * t2315 * t5126;
  t5130 = t170 * t5129;
  t5132 = 0.6e1 * t1633 * t511 * t880 - 0.48e2 * t170 * t2312 * t5095 + 0.72e2 * t1287 * t5103 + 0.18e2 * t1292 * t5110 + 0.18e2 * t1292 * t5114 - 0.6e1 * t2187 * t5118 - 0.72e2 * t2774 * t5100 - 0.36e2 * t2780 * t5107 - t349 * t5130;
  t5136 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t5132);
  tv3tau33 = t7 * t5136;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 3] += tv3tau33;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, const double *lapl, const double *tau, xc_mgga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t11, t12;
  double t15, t16, t17, t19, t20, t21, t22, t23;
  double t24, t26, t27, t28, t29, t30, t31, t32;
  double t33, t34, t35, t36, t37, t39, t40, t41;
  double t45, t46, t47, t48, t49, t52, t54, t57;
  double t58, t59, t61, t62, t65, t66, t67, t69;
  double t70, t71, t72, t73, t74, t76, t78, t79;
  double t81, t83, t84, t85, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t104, t106;
  double t107, t108, t109, t111, t112, t113, t114, t115;
  double t117, t118, t122, t123, t124, t125, t126, t129;
  double t131, t134, t135, t136, t139, t140, t141, t143;
  double t144, t145, t146, t147, t148, t150, t152, t153;
  double t155, t157, t158, t159, t162, t164, t165, t166;
  double t167, t168, t170, t172, t176, tzk0;

  double t177, t178, t179, t181, t184, t185, t189, t190;
  double t191, t194, t195, t197, t198, t201, t203, t204;
  double t205, t206, t207, t208, t210, t212, t214, t216;
  double t217, t218, t222, t225, t226, t229, t230, t233;
  double t234, t235, t238, t239, t242, t243, t247, t248;
  double t251, t252, t258, t260, t261, t266, t268, t273;
  double t274, t276, t279, t280, t284, t287, t289, tvrho0;
  double t293, t296, t297, t302, t304, t307, t308, t312;
  double t314, t315, t318, t319, t320, t321, t322, t324;
  double t326, t328, t330, t331, t332, t336, t339, t340;
  double t343, t344, t347, t348, t349, t352, t353, t356;
  double t357, t361, t362, t365, t366, t372, t374, t375;
  double t380, t382, t387, tvrho1, t392, t394, t396, t398;
  double t400, t401, t402, t405, t406, t409, t413, t414;
  double t416, t420, t421, t430, t432, t436, tvsigma0, tvsigma1;
  double t439, t441, t443, t445, t447, t448, t449, t452;
  double t453, t456, t460, t461, t463, t467, t468, t477;
  double t479, t483, tvsigma2, tvlapl0, tvlapl1, t484, t485, t490;
  double t493, t494, t496, t500, tvtau0, t501, t502, t507;
  double t510, t511, t513, t517, tvtau1;

  double t520, t521, t522, t525, t526, t527, t530, t534;
  double t535, t539, t541, t547, t548, t551, t553, t556;
  double t557, t560, t561, t563, t565, t567, t568, t569;
  double t570, t571, t572, t573, t574, t575, t577, t579;
  double t580, t583, t584, t585, t586, t589, t593, t596;
  double t599, t600, t606, t609, t610, t611, t612, t615;
  double t618, t619, t623, t624, t625, t626, t629, t634;
  double t640, t641, t646, t647, t650, t651, t658, t659;
  double t660, t665, t672, t675, t677, t679, t680, t689;
  double t691, t696, t697, t698, t699, t702, t705, t709;
  double t710, t714, t716, t718, t721, t723, tv2rho20, t726;
  double t730, t734, t735, t739, t741, t749, t750, t754;
  double t758, t759, t763, t765, t772, t775, tv2rho21, t780;
  double t785, t789, t790, t796, t797, t802, t806, t807;
  double t817, t818, t821, t822, t824, t826, t828, t829;
  double t830, t831, t832, t833, t834, t836, t840, t841;
  double t842, t843, t846, t850, t853, t856, t857, t863;
  double t866, t867, t868, t871, t874, t875, t879, t880;
  double t881, t882, t885, t890, t896, t897, t902, t903;
  double t906, t907, t914, t915, t916, t921, t928, t931;
  double t933, t935, t936, t945, t947, t952, tv2rho22, t960;
  double t963, t964, t966, t968, t969, t970, t971, t975;
  double t979, t982, t985, t986, t988, t989, t992, t994;
  double t997, t998, t1001, t1004, t1005, t1014, t1017, t1019;
  double t1021, t1028, t1030, t1032, t1033, t1042, t1043, t1045;
  double t1048, t1054, t1057, t1058, t1066, t1068, t1073, tv2rhosigma0;
  double tv2rhosigma1, t1080, t1082, tv2rhosigma2, t1088, tv2rhosigma3, tv2rhosigma4, t1095;
  double t1096, t1098, t1100, t1101, t1102, t1103, t1107, t1111;
  double t1114, t1117, t1118, t1120, t1121, t1124, t1126, t1129;
  double t1130, t1133, t1136, t1137, t1146, t1148, t1149, t1151;
  double t1153, t1160, t1162, t1164, t1165, t1174, t1175, t1177;
  double t1186, t1189, t1190, t1198, t1200, t1205, tv2rhosigma5, tv2rholapl0;
  double tv2rholapl1, tv2rholapl2, tv2rholapl3, t1212, t1213, t1214, t1215, t1218;
  double t1219, t1220, t1223, t1226, t1229, t1230, t1231, t1232;
  double t1243, t1245, t1248, t1249, t1259, t1260, t1262, t1267;
  double tv2rhotau0, t1274, t1276, tv2rhotau1, t1282, tv2rhotau2, t1287, t1288;
  double t1289, t1292, t1293, t1294, t1297, t1300, t1303, t1304;
  double t1305, t1306, t1317, t1319, t1322, t1323, t1333, t1334;
  double t1336, t1341, tv2rhotau3, t1344, t1345, t1346, t1350, t1351;
  double t1352, t1355, t1358, t1361, t1363, t1365, t1368, t1369;
  double t1372, t1373, t1376, t1379, t1381, t1385, t1386, t1390;
  double t1392, t1396, t1397, t1407, t1409, t1413, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1415, t1416, t1417, t1421, t1422;
  double t1423, t1426, t1429, t1432, t1434, t1436, t1439, t1440;
  double t1443, t1444, t1447, t1450, t1452, t1456, t1457, t1461;
  double t1463, t1467, t1468, t1478, t1480, t1484, tv2sigma25, tv2sigmalapl0;
  double tv2sigmalapl1, tv2sigmalapl2, tv2sigmalapl3, tv2sigmalapl4, tv2sigmalapl5, t1485, t1486, t1489;
  double t1490, t1493, t1497, t1499, t1500, t1502, t1503, t1506;
  double t1512, t1514, t1518, t1519, t1525, t1526, t1528, t1532;
  double tv2sigmatau0, tv2sigmatau1, tv2sigmatau2, tv2sigmatau3, tv2sigmatau4, t1533, t1534, t1537;
  double t1538, t1541, t1545, t1547, t1548, t1550, t1551, t1554;
  double t1560, t1562, t1566, t1567, t1573, t1574, t1576, t1580;
  double tv2sigmatau5, tv2lapl20, tv2lapl21, tv2lapl22, tv2lapltau0, tv2lapltau1, tv2lapltau2, tv2lapltau3;
  double t1582, t1583, t1586, t1587, t1591, t1594, t1595, t1600;
  double t1603, t1604, t1606, t1610, tv2tau20, tv2tau21, t1612, t1613;
  double t1616, t1617, t1621, t1624, t1625, t1630, t1633, t1634;
  double t1636, t1640, tv2tau22;

  double t1644, t1645, t1648, t1651, t1652, t1653, t1656, t1660;
  double t1661, t1665, t1667, t1672, t1674, t1677, t1683, t1684;
  double t1687, t1689, t1692, t1694, t1699, t1700, t1703, t1705;
  double t1709, t1710, t1711, t1712, t1713, t1720, t1721, t1725;
  double t1726, t1742, t1756, t1757, t1758, t1761, t1773, t1774;
  double t1775, t1777, t1781, t1783, t1785, t1786, t1788, t1789;
  double t1792, t1795, t1798, t1803, t1806, t1807, t1810, t1818;
  double t1821, t1822, t1823, t1824, t1827, t1830, t1833, t1834;
  double t1850, t1851, t1854, t1857, t1860, t1867, t1870, t1871;
  double t1882, t1890, t1891, t1895, t1896, t1899, t1900, t1901;
  double t1909, t1912, t1913, t1918, t1920, t1921, t1924, t1927;
  double t1930, t1934, t1935, t1939, t1941, t1943, t1945, t1947;
  double t1950, t1952, tv3rho30, t1955, t1956, t1957, t1960, t1965;
  double t1966, t1968, t1972, t1973, t1977, t1980, t1984, t1986;
  double t1990, t1999, t2000, t2001, t2004, t2009, t2011, t2015;
  double t2016, t2020, t2023, t2024, t2026, t2035, t2037, t2040;
  double tv3rho31, t2043, t2048, t2052, t2056, t2057, t2061, t2063;
  double t2072, t2073, t2078, t2082, t2086, t2087, t2091, t2093;
  double t2100, t2108, t2110, t2111, tv3rho32, t2116, t2123, t2127;
  double t2128, t2135, t2136, t2143, t2147, t2148, t2163, t2164;
  double t2168, t2169, t2185, t2186, t2187, t2188, t2189, t2195;
  double t2200, t2201, t2204, t2206, t2210, t2211, t2225, t2226;
  double t2227, t2228, t2240, t2241, t2242, t2244, t2248, t2250;
  double t2252, t2253, t2255, t2256, t2259, t2262, t2265, t2270;
  double t2273, t2274, t2277, t2285, t2288, t2289, t2290, t2293;
  double t2296, t2299, t2300, t2312, t2315, t2316, t2327, t2328;
  double t2331, t2334, t2337, t2348, t2358, t2359, t2363, t2364;
  double t2367, t2368, t2369, t2375, t2378, t2379, t2384, tv3rho33;
  double t2392, t2399, t2401, t2427, t2436, t2438, t2440, t2456;
  double t2457, t2458, t2461, t2462, t2464, t2465, t2466, t2467;
  double t2470, t2472, t2475, t2481, t2484, t2487, t2490, t2491;
  double t2492, t2494, t2497, t2498, t2502, t2504, t2505, t2506;
  double t2508, t2511, t2514, t2515, t2519, t2522, t2527, t2529;
  double t2531, t2535, t2537, t2544, t2545, t2548, t2554, t2555;
  double t2556, t2559, t2561, t2564, t2565, t2567, t2568, t2570;
  double t2572, t2574, t2575, t2576, t2578, t2579, t2581, t2584;
  double t2590, t2594, t2606, t2607, t2610, t2612, t2615, t2624;
  double t2627, t2631, t2641, t2642, t2644, t2647, t2650, t2653;
  double t2654, t2659, tv3rho2sigma0, tv3rho2sigma1, t2666, t2670, t2672, tv3rho2sigma2;
  double t2678, t2686, tv3rho2sigma3, tv3rho2sigma4, t2692, t2699, t2702, tv3rho2sigma5;
  double t2710, tv3rho2sigma6, tv3rho2sigma7, t2721, t2769, t2771, t2773, t2774;
  double t2775, t2776, t2779, t2780, t2781, t2782, t2785, t2787;
  double t2788, t2790, t2793, t2794, t2800, t2803, t2806, t2809;
  double t2810, t2812, t2815, t2817, t2818, t2821, t2822, t2825;
  double t2829, t2830, t2831, t2833, t2836, t2839, t2840, t2843;
  double t2844, t2847, t2850, t2851, t2854, t2860, t2865, t2868;
  double t2873, t2875, t2881, t2883, t2889, t2895, t2896, t2897;
  double t2898, t2900, t2905, t2912, t2914, t2920, t2921, t2924;
  double t2926, t2927, t2929, t2931, t2933, t2934, t2935, t2937;
  double t2940, t2942, t2947, t2954, t2957, t2961, t2969, t2971;
  double t2972, t2977, tv3rho2sigma8, tv3rho2lapl0, tv3rho2lapl1, tv3rho2lapl2, tv3rho2lapl3, tv3rho2lapl4;
  double tv3rho2lapl5, t2984, t2991, t2993, t2995, t2997, t2998, t2999;
  double t3000, t3003, t3004, t3005, t3006, t3033, t3036, t3039;
  double t3040, t3043, t3044, t3047, t3048, t3051, t3052, t3055;
  double t3056, t3059, t3062, t3063, t3072, t3075, t3080, t3083;
  double t3084, t3087, t3088, t3089, t3090, t3093, t3094, t3097;
  double t3098, t3101, t3102, t3105, t3106, t3109, t3114, t3118;
  double t3121, t3122, t3142, t3143, t3145, t3146, t3151, tv3rho2tau0;
  double t3158, t3162, t3164, tv3rho2tau1, t3170, t3178, tv3rho2tau2, t3184;
  double t3191, t3194, tv3rho2tau3, t3202, tv3rho2tau4, t3237, t3238, t3239;
  double t3240, t3243, t3244, t3245, t3246, t3251, t3260, t3263;
  double t3264, t3267, t3268, t3271, t3272, t3275, t3276, t3279;
  double t3280, t3283, t3284, t3287, t3290, t3293, t3294, t3297;
  double t3300, t3303, t3304, t3307, t3308, t3311, t3312, t3315;
  double t3316, t3319, t3320, t3321, t3322, t3325, t3330, t3334;
  double t3337, t3338, t3358, t3359, t3361, t3363, t3364, t3369;
  double tv3rho2tau5, t3376, t3377, t3378, t3381, t3385, t3388, t3391;
  double t3392, t3394, t3396, t3399, t3401, t3404, t3405, t3410;
  double t3411, t3414, t3417, t3420, t3423, t3425, t3426, t3427;
  double t3429, t3431, t3432, t3434, t3436, t3444, t3446, t3448;
  double t3449, t3451, t3453, t3457, t3466, t3467, t3469, t3474;
  double t3477, t3480, t3483, t3485, t3488, t3495, t3496, t3497;
  double t3508, t3509, t3510, t3512, t3513, t3515, t3537, t3540;
  double t3564, t3565, t3570, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24;
  double t3577, t3579, tv3rhosigma25, t3585, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, t3590, t3591, t3594, t3598, t3601, t3605, t3606;
  double t3607, t3609, t3611, t3645, t3652, t3655, t3658, t3663;
  double t3666, t3669, t3672, t3675, t3680, t3681, t3683, t3685;
  double t3688, t3690, t3693, t3694, t3699, t3700, t3703, t3706;
  double t3709, t3712, t3714, t3716, t3717, t3718, t3720, t3722;
  double t3723, t3725, t3727, t3735, t3737, t3739, t3740, t3742;
  double t3744, t3748, t3757, t3758, t3764, t3765, t3775, t3777;
  double t3778, t3783, tv3rhosigma211, tv3rhosigmalapl0, tv3rhosigmalapl1, tv3rhosigmalapl2, tv3rhosigmalapl3, tv3rhosigmalapl4;
  double tv3rhosigmalapl5, tv3rhosigmalapl6, tv3rhosigmalapl7, tv3rhosigmalapl8, tv3rhosigmalapl9, tv3rhosigmalapl10, tv3rhosigmalapl11, t3790;
  double t3793, t3796, t3797, t3798, t3800, t3801, t3804, t3805;
  double t3810, t3813, t3814, t3819, t3822, t3823, t3826, t3829;
  double t3832, t3835, t3838, t3839, t3840, t3843, t3844, t3845;
  double t3848, t3849, t3852, t3855, t3856, t3857, t3860, t3861;
  double t3864, t3865, t3868, t3871, t3872, t3873, t3876, t3880;
  double t3911, t3916, t3917, t3919, t3921, t3923, t3924, t3925;
  double t3928, t3931, t3932, t3937, t3939, t3947, t3948, t3950;
  double t3954, t3955, t3956, t3958, t3959, t3961, t3962, t3965;
  double t3968, t3969, t3972, t3973, t3976, t3981, t3983, t3988;
  double tv3rhosigmatau0, tv3rhosigmatau1, tv3rhosigmatau2, tv3rhosigmatau3, tv3rhosigmatau4, t3995, t3997, tv3rhosigmatau5;
  double t4003, tv3rhosigmatau6, tv3rhosigmatau7, tv3rhosigmatau8, tv3rhosigmatau9, tv3rhosigmatau10, t4008, t4009;
  double t4010, t4013, t4014, t4015, t4018, t4019, t4022, t4025;
  double t4026, t4027, t4030, t4031, t4034, t4035, t4038, t4041;
  double t4042, t4043, t4046, t4048, t4049, t4050, t4053, t4056;
  double t4057, t4062, t4064, t4072, t4073, t4075, t4077, t4079;
  double t4080, t4084, t4109, t4117, t4126, t4127, t4128, t4130;
  double t4131, t4134, t4137, t4138, t4141, t4142, t4145, t4148;
  double t4149, t4151, t4152, t4157, t4158, t4159, t4160, t4164;
  double t4167, t4168, t4171, t4172, t4175, t4178, t4181, t4186;
  double t4189, t4190, t4195, t4198, t4200, t4205, tv3rhosigmatau11, tv3rholapl20;
  double tv3rholapl21, tv3rholapl22, tv3rholapl23, tv3rholapl24, tv3rholapl25, tv3rholapltau0, tv3rholapltau1, tv3rholapltau2;
  double tv3rholapltau3, tv3rholapltau4, tv3rholapltau5, tv3rholapltau6, tv3rholapltau7, t4212, t4213, t4214;
  double t4215, t4218, t4221, t4225, t4226, t4227, t4237, t4238;
  double t4240, t4241, t4242, t4243, t4246, t4249, t4250, t4272;
  double t4273, t4280, t4281, t4284, t4290, t4293, t4294, t4297;
  double t4298, t4302, t4306, t4309, t4310, t4313, t4314, t4319;
  double tv3rhotau20, tv3rhotau21, t4326, t4328, tv3rhotau22, t4334, tv3rhotau23, tv3rhotau24;
  double t4339, t4340, t4341, t4344, t4347, t4348, t4351, t4352;
  double t4353, t4354, t4355, t4377, t4380, t4381, t4384, t4387;
  double t4393, t4394, t4397, t4398, t4401, t4402, t4406, t4410;
  double t4415, t4418, t4421, t4425, t4426, t4436, t4437, t4439;
  double t4440, t4445, tv3rhotau25, t4447, t4450, t4453, t4457, t4459;
  double t4461, t4464, t4465, t4469, t4473, t4475, t4479, t4480;
  double t4485, t4486, t4492, t4495, t4507, t4514, t4516, t4519;
  double t4520, t4522, t4523, t4526, t4529, t4532, t4535, t4537;
  double t4541, t4542, t4545, t4549, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t4550, t4557, t4559;
  double t4562, t4563, t4565, t4568, t4571, t4573, t4575, t4578;
  double t4579, t4582, t4585, t4588, t4592, t4594, t4598, t4599;
  double t4603, t4607, t4609, t4613, t4614, t4616, t4617, t4620;
  double t4626, t4629, t4641, t4642, t4648, t4652, tv3sigma39, tv3sigma2lapl0;
  double tv3sigma2lapl1, tv3sigma2lapl2, tv3sigma2lapl3, tv3sigma2lapl4, tv3sigma2lapl5, tv3sigma2lapl6, tv3sigma2lapl7, tv3sigma2lapl8;
  double tv3sigma2lapl9, tv3sigma2lapl10, tv3sigma2lapl11, t4656, t4661, t4669, t4672, t4675;
  double t4690, t4693, t4694, t4697, t4698, t4699, t4701, t4702;
  double t4704, t4707, t4708, t4711, t4713, t4716, t4717, t4721;
  double t4727, t4728, t4730, t4732, t4737, t4738, t4743, t4746;
  double t4747, t4752, t4753, t4756, t4757, t4761, tv3sigma2tau0, tv3sigma2tau1;
  double tv3sigma2tau2, tv3sigma2tau3, tv3sigma2tau4, tv3sigma2tau5, tv3sigma2tau6, tv3sigma2tau7, tv3sigma2tau8, tv3sigma2tau9;
  double tv3sigma2tau10, t4765, t4782, t4790, t4793, t4796, t4799, t4801;
  double t4804, t4806, t4808, t4811, t4812, t4816, t4822, t4823;
  double t4825, t4826, t4829, t4832, t4833, t4835, t4838, t4839;
  double t4841, t4842, t4846, t4851, t4852, t4857, t4858, t4861;
  double t4862, t4865, t4866, t4870, tv3sigma2tau11, tv3sigmalapl20, tv3sigmalapl21, tv3sigmalapl22;
  double tv3sigmalapl23, tv3sigmalapl24, tv3sigmalapl25, tv3sigmalapl26, tv3sigmalapl27, tv3sigmalapl28, tv3sigmalapltau0, tv3sigmalapltau1;
  double tv3sigmalapltau2, tv3sigmalapltau3, tv3sigmalapltau4, tv3sigmalapltau5, tv3sigmalapltau6, tv3sigmalapltau7, tv3sigmalapltau8, tv3sigmalapltau9;
  double tv3sigmalapltau10, tv3sigmalapltau11, t4871, t4872, t4876, t4881, t4882, t4883;
  double t4885, t4886, t4889, t4892, t4897, t4898, t4900, t4903;
  double t4904, t4907, t4908, t4911, t4918, t4919, t4928, t4940;
  double t4945, t4946, t4952, t4953, t4955, t4956, t4960, tv3sigmatau20;
  double tv3sigmatau21, tv3sigmatau22, tv3sigmatau23, tv3sigmatau24, tv3sigmatau25, tv3sigmatau26, tv3sigmatau27, t4961;
  double t4962, t4966, t4971, t4972, t4973, t4975, t4976, t4979;
  double t4982, t4987, t4988, t4990, t4993, t4994, t4997, t4998;
  double t5001, t5008, t5009, t5018, t5030, t5035, t5036, t5042;
  double t5043, t5045, t5046, t5050, tv3sigmatau28, tv3lapl30, tv3lapl31, tv3lapl32;
  double tv3lapl33, tv3lapl2tau0, tv3lapl2tau1, tv3lapl2tau2, tv3lapl2tau3, tv3lapl2tau4, tv3lapl2tau5, tv3lapltau20;
  double tv3lapltau21, tv3lapltau22, tv3lapltau23, tv3lapltau24, tv3lapltau25, t5051, t5052, t5057;
  double t5060, t5063, t5064, t5067, t5070, t5071, t5074, t5075;
  double t5083, t5086, t5087, t5089, t5093, tv3tau30, tv3tau31, tv3tau32;
  double t5094, t5095, t5100, t5103, t5106, t5107, t5110, t5113;
  double t5114, t5117, t5118, t5126, t5129, t5130, t5132, t5136;
  double tv3tau33;

  double t5141, t5145, t5148, t5152, t5155, t5157, t5159, t5160;
  double t5166, t5172, t5173, t5176, t5180, t5189, t5195, t5197;
  double t5203, t5206, t5209, t5214, t5215, t5220, t5225, t5230;
  double t5232, t5233, t5238, t5241, t5243, t5244, t5263, t5267;
  double t5271, t5273, t5276, t5281, t5285, t5287, t5288, t5290;
  double t5296, t5297, t5301, t5312, t5315, t5327, t5328, t5341;
  double t5342, t5343, t5345, t5348, t5358, t5362, t5365, t5368;
  double t5373, t5390, t5399, t5411, t5420, t5425, t5434, t5438;
  double t5464, t5481, t5516, t5564, t5568, t5572, t5578, t5579;
  double t5580, t5582, t5583, t5589, t5594, t5597, t5601, t5608;
  double t5612, t5616, t5621, t5623, tv4rho40, t5630, t5634, t5635;
  double t5638, t5644, t5665, t5666, t5668, t5672, t5681, t5687;
  double t5688, t5695, t5696, t5713, t5715, t5719, t5726, t5730;
  double t5731, t5734, t5743, t5746, t5747, t5749, t5751, t5752;
  double tv4rho41, t5761, t5765, t5780, t5793, t5797, t5806, t5817;
  double t5818, t5827, t5840, t5844, t5851, t5855, t5864, t5867;
  double t5878, t5881, t5883, t5884, tv4rho42, t5905, t5909, t5916;
  double t5927, t5928, t5945, t5949, t5956, t5964, t5973, t5983;
  double t5985, t5986, tv4rho43, t5991, t5996, t6003, t6007, t6016;
  double t6032, t6033, t6038, t6043, t6048, t6050, t6051, t6056;
  double t6059, t6079, t6083, t6087, t6089, t6092, t6097, t6101;
  double t6103, t6104, t6108, t6114, t6121, t6129, t6141, t6142;
  double t6148, t6151, t6158, t6161, t6162, t6167, t6168, t6170;
  double t6173, t6180, t6188, t6199, t6216, t6225, t6237, t6244;
  double t6254, t6291, t6317, t6323, t6324, t6328, t6335, t6337;
  double t6378, t6391, t6397, t6402, t6409, t6413, t6421, t6422;
  double tv4rho44, t6430, t6436, t6439, t6446, t6448, t6451, t6458;
  double t6462, t6465, t6468, t6471, t6492, t6494, t6497, t6502;
  double t6503, t6527, t6531, t6534, t6535, t6538, t6539, t6540;
  double t6543, t6547, t6551, t6560, t6561, t6564, t6568, t6571;
  double t6574, t6577, t6581, t6584, t6585, t6588, t6597, t6602;
  double t6609, t6613, t6620, t6624, t6629, t6635, t6636, t6650;
  double t6691, t6727, t6753, t6825, t6829, t6834, t6837, t6842;
  double t6850, t6853, t6857, t6886, t6923, t6958, t6965, t6973;
  double tv4rho3sigma0, tv4rho3sigma1, t6980, t6983, t6987, t6989, tv4rho3sigma2, t6991;
  double t6997, t7002, t7006, t7015, t7016, tv4rho3sigma3, tv4rho3sigma4, t7018;
  double t7024, t7026, t7035, t7037, t7040, tv4rho3sigma5, t7046, t7055;
  double tv4rho3sigma6, tv4rho3sigma7, t7061, t7068, t7076, t7078, t7079, tv4rho3sigma8;
  double t7088, tv4rho3sigma9, tv4rho3sigma10, t7120, t7122, t7165, t7210, t7225;
  double t7227, t7228, t7232, t7235, t7239, t7242, t7246, t7263;
  double t7266, t7268, t7272, t7294, t7297, t7300, t7304, t7313;
  double t7316, t7320, t7323, t7324, t7327, t7328, t7330, t7333;
  double t7337, t7341, t7347, t7351, t7354, t7355, t7358, t7367;
  double t7378, t7403, t7410, t7432, t7434, t7438, t7449, t7454;
  double t7464, t7471, t7508, t7541, t7565, t7570, t7598, t7614;
  double t7622, tv4rho3sigma11, tv4rho3lapl0, tv4rho3lapl1, tv4rho3lapl2, tv4rho3lapl3, tv4rho3lapl4, tv4rho3lapl5;
  double tv4rho3lapl6, tv4rho3lapl7, t7629, t7635, t7638, t7645, t7647, t7650;
  double t7654, t7659, t7662, t7665, t7670, t7675, t7678, t7681;
  double t7692, t7697, t7717, t7718, t7719, t7732, t7748, t7752;
  double t7764, t7765, t7789, t7792, t7828, t7831, t7832, t7870;
  double t7902, t7906, t7910, t7926, t7942, t7944, t7973, t7976;
  double t7979, t8016, t8021, t8028, t8036, tv4rho3tau0, t8043, t8046;
  double t8050, t8052, tv4rho3tau1, t8054, t8060, t8065, t8069, t8078;
  double t8079, tv4rho3tau2, t8081, t8087, t8089, t8098, t8100, t8103;
  double tv4rho3tau3, t8109, t8118, tv4rho3tau4, t8124, t8131, t8139, t8141;
  double t8142, tv4rho3tau5, t8151, tv4rho3tau6, t8188, t8197, t8198, t8204;
  double t8222, t8226, t8242, t8243, t8257, t8294, t8331, t8334;
  double t8335, t8355, t8360, t8364, t8372, t8375, t8380, t8385;
  double t8388, t8391, t8394, t8399, t8404, t8418, t8425, t8433;
  double t8437, t8465, t8499, t8502, t8503, t8527, t8542, t8550;
  double tv4rho3tau7, t8557, t8564, t8566, t8570, t8602, t8612, t8619;
  double t8625, t8629, t8642, t8645, t8653, t8660, t8673, t8686;
  double t8718, t8725, t8764, t8782, t8803, t8814, t8817, t8819;
  double t8825, t8846, t8849, t8856, t8859, t8862, t8866, t8869;
  double t8874, t8893, t8910, t8913, t8918, t8937, t8940, t8958;
  double t8961, t9004, t9014, t9051, t9059, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22;
  double tv4rho2sigma23, tv4rho2sigma24, t9066, t9070, t9072, tv4rho2sigma25, t9078, t9086;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t9092, t9099, t9102;
  double tv4rho2sigma211, t9110, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t9124;
  double t9131, t9144, t9146, t9156, t9196, t9230, t9236, t9243;
  double t9247, t9254, t9262, t9271, t9277, t9283, t9317, t9357;
  double t9367, t9371, t9374, t9376, t9385, t9390, t9396, t9399;
  double t9402, t9405, t9409, t9418, t9421, t9424, t9438, t9441;
  double t9446, t9451, t9465, t9500, t9514, t9563, t9604, t9612;
  double tv4rho2sigma217, tv4rho2sigmalapl0, tv4rho2sigmalapl1, tv4rho2sigmalapl2, tv4rho2sigmalapl3, tv4rho2sigmalapl4, tv4rho2sigmalapl5, tv4rho2sigmalapl6;
  double tv4rho2sigmalapl7, tv4rho2sigmalapl8, tv4rho2sigmalapl9, tv4rho2sigmalapl10, tv4rho2sigmalapl11, tv4rho2sigmalapl12, tv4rho2sigmalapl13, tv4rho2sigmalapl14;
  double tv4rho2sigmalapl15, tv4rho2sigmalapl16, tv4rho2sigmalapl17, t9619, t9626, t9628, t9661, t9675;
  double t9689, t9701, t9712, t9713, t9716, t9719, t9720, t9740;
  double t9763, t9779, t9780, t9793, t9794, t9796, t9799, t9801;
  double t9817, t9828, t9833, t9851, t9863, t9867, t9871, t9890;
  double t9904, t9924, t9960, t9998, t10015, t10020, t10029, t10034;
  double t10036, t10059, t10062, t10068, t10071, t10075, t10076, t10104;
  double t10108, t10114, t10126, t10144, t10174, t10177, t10180, t10204;
  double t10208, t10211, t10224, t10234, t10243, tv4rho2sigmatau0, tv4rho2sigmatau1, tv4rho2sigmatau2;
  double tv4rho2sigmatau3, tv4rho2sigmatau4, t10250, t10254, t10256, tv4rho2sigmatau5, t10262, t10270;
  double tv4rho2sigmatau6, tv4rho2sigmatau7, tv4rho2sigmatau8, tv4rho2sigmatau9, tv4rho2sigmatau10, t10276, t10283, t10286;
  double tv4rho2sigmatau11, t10294, tv4rho2sigmatau12, tv4rho2sigmatau13, tv4rho2sigmatau14, tv4rho2sigmatau15, tv4rho2sigmatau16, t10312;
  double t10313, t10315, t10318, t10319, t10331, t10359, t10383, t10388;
  double t10402, t10422, t10430, t10431, t10433, t10436, t10438, t10448;
  double t10460, t10467, t10477, t10496, t10500, t10503, t10507, t10535;
  double t10548, t10554, t10557, t10566, t10594, t10597, t10598, t10611;
  double t10630, t10661, t10694, t10729, t10767, t10772, t10777, t10782;
  double t10785, t10788, t10795, t10800, t10808, t10822, t10829, t10835;
  double t10844, t10852, t10856, t10877, t10911, t10920, tv4rho2sigmatau17, tv4rho2lapl20;
  double tv4rho2lapl21, tv4rho2lapl22, tv4rho2lapl23, tv4rho2lapl24, tv4rho2lapl25, tv4rho2lapl26, tv4rho2lapl27, tv4rho2lapl28;
  double tv4rho2lapltau0, tv4rho2lapltau1, tv4rho2lapltau2, tv4rho2lapltau3, tv4rho2lapltau4, tv4rho2lapltau5, tv4rho2lapltau6, tv4rho2lapltau7;
  double tv4rho2lapltau8, tv4rho2lapltau9, tv4rho2lapltau10, tv4rho2lapltau11, t10927, t10934, t10936, t10946;
  double t10957, t10958, t10961, t10970, t10978, t11009, t11047, t11082;
  double t11085, t11117, t11120, t11149, t11153, t11157, t11164, t11181;
  double t11190, t11191, t11211, t11217, t11230, t11235, t11240, t11252;
  double t11260, tv4rho2tau20, tv4rho2tau21, t11267, t11271, t11273, tv4rho2tau22, t11279;
  double t11287, tv4rho2tau23, tv4rho2tau24, t11293, t11300, t11303, tv4rho2tau25, t11311;
  double tv4rho2tau26, tv4rho2tau27, t11322, t11355, t11374, t11385, t11386, t11406;
  double t11417, t11441, t11446, t11451, t11458, t11495, t11524, t11528;
  double t11532, t11559, t11565, t11592, t11593, t11605, t11606, t11609;
  double t11612, t11630, t11637, t11645, tv4rho2tau28, t11652, t11654, t11659;
  double t11661, t11662, t11666, t11675, t11680, t11734, t11793, t11807;
  double t11822, t11832, t11846, t11853, t11873, t11878, t11881, t11886;
  double t11890, t11895, t11930, t11944, t11990, t11997, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t12004;
  double t12006, tv4rhosigma39, t12012, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314;
  double tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t12025, t12038, t12043, t12046;
  double t12051, t12055, t12060, t12095, t12153, t12154, t12158, t12176;
  double t12183, t12200, t12202, t12204, t12209, t12211, t12231, t12293;
  double t12352, t12359, tv4rhosigma319, tv4rhosigma2lapl0, tv4rhosigma2lapl1, tv4rhosigma2lapl2, tv4rhosigma2lapl3, tv4rhosigma2lapl4;
  double tv4rhosigma2lapl5, tv4rhosigma2lapl6, tv4rhosigma2lapl7, tv4rhosigma2lapl8, tv4rhosigma2lapl9, tv4rhosigma2lapl10, tv4rhosigma2lapl11, tv4rhosigma2lapl12;
  double tv4rhosigma2lapl13, tv4rhosigma2lapl14, tv4rhosigma2lapl15, tv4rhosigma2lapl16, tv4rhosigma2lapl17, tv4rhosigma2lapl18, tv4rhosigma2lapl19, tv4rhosigma2lapl20;
  double tv4rhosigma2lapl21, tv4rhosigma2lapl22, tv4rhosigma2lapl23, t12366, t12372, t12376, t12379, t12380;
  double t12403, t12419, t12439, t12442, t12460, t12501, t12508, t12571;
  double t12583, t12602, t12609, t12641, t12667, t12671, t12681, t12697;
  double t12701, t12727, t12743, t12756, t12782, t12817, t12829, t12842;
  double t12846, t12878, t12887, tv4rhosigma2tau0, tv4rhosigma2tau1, tv4rhosigma2tau2, tv4rhosigma2tau3, tv4rhosigma2tau4;
  double tv4rhosigma2tau5, tv4rhosigma2tau6, tv4rhosigma2tau7, tv4rhosigma2tau8, tv4rhosigma2tau9, tv4rhosigma2tau10, t12894, t12896;
  double tv4rhosigma2tau11, t12902, tv4rhosigma2tau12, tv4rhosigma2tau13, tv4rhosigma2tau14, tv4rhosigma2tau15, tv4rhosigma2tau16, tv4rhosigma2tau17;
  double tv4rhosigma2tau18, tv4rhosigma2tau19, tv4rhosigma2tau20, tv4rhosigma2tau21, tv4rhosigma2tau22, t12932, t12947, t12951;
  double t12958, t12964, t12975, t13001, t13013, t13018, t13051, t13064;
  double t13067, t13073, t13112, t13116, t13119, t13120, t13143, t13153;
  double t13166, t13184, t13191, t13233, t13293, t13324, t13354, t13369;
  double t13388, t13392, t13418, t13427, tv4rhosigma2tau23, tv4rhosigmalapl20, tv4rhosigmalapl21, tv4rhosigmalapl22;
  double tv4rhosigmalapl23, tv4rhosigmalapl24, tv4rhosigmalapl25, tv4rhosigmalapl26, tv4rhosigmalapl27, tv4rhosigmalapl28, tv4rhosigmalapl29, tv4rhosigmalapl210;
  double tv4rhosigmalapl211, tv4rhosigmalapl212, tv4rhosigmalapl213, tv4rhosigmalapl214, tv4rhosigmalapl215, tv4rhosigmalapl216, tv4rhosigmalapl217, tv4rhosigmalapltau0;
  double tv4rhosigmalapltau1, tv4rhosigmalapltau2, tv4rhosigmalapltau3, tv4rhosigmalapltau4, tv4rhosigmalapltau5, tv4rhosigmalapltau6, tv4rhosigmalapltau7, tv4rhosigmalapltau8;
  double tv4rhosigmalapltau9, tv4rhosigmalapltau10, tv4rhosigmalapltau11, tv4rhosigmalapltau12, tv4rhosigmalapltau13, tv4rhosigmalapltau14, tv4rhosigmalapltau15, tv4rhosigmalapltau16;
  double tv4rhosigmalapltau17, tv4rhosigmalapltau18, tv4rhosigmalapltau19, tv4rhosigmalapltau20, tv4rhosigmalapltau21, tv4rhosigmalapltau22, tv4rhosigmalapltau23, t13434;
  double t13437, t13438, t13443, t13444, t13462, t13505, t13552, t13560;
  double t13605, t13611, t13618, t13625, t13635, t13647, t13660, t13699;
  double t13726, t13749, t13758, t13774, t13781, t13801, t13846, t13848;
  double t13856, tv4rhosigmatau20, tv4rhosigmatau21, tv4rhosigmatau22, tv4rhosigmatau23, tv4rhosigmatau24, tv4rhosigmatau25, tv4rhosigmatau26;
  double tv4rhosigmatau27, t13863, t13865, tv4rhosigmatau28, t13871, tv4rhosigmatau29, tv4rhosigmatau210, tv4rhosigmatau211;
  double tv4rhosigmatau212, tv4rhosigmatau213, tv4rhosigmatau214, tv4rhosigmatau215, tv4rhosigmatau216, t13925, t13960, t13973;
  double t14003, t14004, t14020, t14058, t14072, t14076, t14082, t14089;
  double t14097, t14107, t14126, t14163, t14164, t14182, t14189, t14211;
  double t14234, t14235, t14251, t14258, t14289, t14297, tv4rhosigmatau217, tv4rholapl30;
  double tv4rholapl31, tv4rholapl32, tv4rholapl33, tv4rholapl34, tv4rholapl35, tv4rholapl36, tv4rholapl37, tv4rholapl2tau0;
  double tv4rholapl2tau1, tv4rholapl2tau2, tv4rholapl2tau3, tv4rholapl2tau4, tv4rholapl2tau5, tv4rholapl2tau6, tv4rholapl2tau7, tv4rholapl2tau8;
  double tv4rholapl2tau9, tv4rholapl2tau10, tv4rholapl2tau11, tv4rholapltau20, tv4rholapltau21, tv4rholapltau22, tv4rholapltau23, tv4rholapltau24;
  double tv4rholapltau25, tv4rholapltau26, tv4rholapltau27, tv4rholapltau28, tv4rholapltau29, tv4rholapltau210, tv4rholapltau211, t14304;
  double t14336, t14338, t14344, t14357, t14378, t14379, t14388, t14393;
  double t14399, t14410, t14415, t14440, t14485, t14492, tv4rhotau30, tv4rhotau31;
  double tv4rhotau32, t14499, t14501, tv4rhotau33, t14507, tv4rhotau34, tv4rhotau35, tv4rhotau36;
  double t14514, t14515, t14521, t14538, t14558, t14562, t14563, t14564;
  double t14571, t14576, t14608, t14647, t14692, t14699, tv4rhotau37, t14718;
  double t14769, t14773, t14783, t14784, t14786, t14796, t14802, t14860;
  double t14864, t14869, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45;
  double tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413;
  double t14870, t14881, t14886, t14898, t14909, t14946, t14986, t14990;
  double t15032, t15037, tv4sigma414, tv4sigma3lapl0, tv4sigma3lapl1, tv4sigma3lapl2, tv4sigma3lapl3, tv4sigma3lapl4;
  double tv4sigma3lapl5, tv4sigma3lapl6, tv4sigma3lapl7, tv4sigma3lapl8, tv4sigma3lapl9, tv4sigma3lapl10, tv4sigma3lapl11, tv4sigma3lapl12;
  double tv4sigma3lapl13, tv4sigma3lapl14, tv4sigma3lapl15, tv4sigma3lapl16, tv4sigma3lapl17, tv4sigma3lapl18, tv4sigma3lapl19, t15047;
  double t15105, t15156, t15210, t15261, t15267, tv4sigma3tau0, tv4sigma3tau1, tv4sigma3tau2;
  double tv4sigma3tau3, tv4sigma3tau4, tv4sigma3tau5, tv4sigma3tau6, tv4sigma3tau7, tv4sigma3tau8, tv4sigma3tau9, tv4sigma3tau10;
  double tv4sigma3tau11, tv4sigma3tau12, tv4sigma3tau13, tv4sigma3tau14, tv4sigma3tau15, tv4sigma3tau16, tv4sigma3tau17, tv4sigma3tau18;
  double t15278, t15338, t15391, t15443, t15491, t15497, tv4sigma3tau19, tv4sigma2lapl20;
  double tv4sigma2lapl21, tv4sigma2lapl22, tv4sigma2lapl23, tv4sigma2lapl24, tv4sigma2lapl25, tv4sigma2lapl26, tv4sigma2lapl27, tv4sigma2lapl28;
  double tv4sigma2lapl29, tv4sigma2lapl210, tv4sigma2lapl211, tv4sigma2lapl212, tv4sigma2lapl213, tv4sigma2lapl214, tv4sigma2lapl215, tv4sigma2lapl216;
  double tv4sigma2lapl217, tv4sigma2lapltau0, tv4sigma2lapltau1, tv4sigma2lapltau2, tv4sigma2lapltau3, tv4sigma2lapltau4, tv4sigma2lapltau5, tv4sigma2lapltau6;
  double tv4sigma2lapltau7, tv4sigma2lapltau8, tv4sigma2lapltau9, tv4sigma2lapltau10, tv4sigma2lapltau11, tv4sigma2lapltau12, tv4sigma2lapltau13, tv4sigma2lapltau14;
  double tv4sigma2lapltau15, tv4sigma2lapltau16, tv4sigma2lapltau17, tv4sigma2lapltau18, tv4sigma2lapltau19, tv4sigma2lapltau20, tv4sigma2lapltau21, tv4sigma2lapltau22;
  double tv4sigma2lapltau23, t15552, t15608, t15659, t15679, t15730, t15734, t15740;
  double tv4sigma2tau20, tv4sigma2tau21, tv4sigma2tau22, tv4sigma2tau23, tv4sigma2tau24, tv4sigma2tau25, tv4sigma2tau26, tv4sigma2tau27;
  double tv4sigma2tau28, tv4sigma2tau29, tv4sigma2tau210, tv4sigma2tau211, tv4sigma2tau212, tv4sigma2tau213, tv4sigma2tau214, tv4sigma2tau215;
  double tv4sigma2tau216, t15796, t15848, t15866, t15921, t15941, t15977, t15983;
  double tv4sigma2tau217, tv4sigmalapl30, tv4sigmalapl31, tv4sigmalapl32, tv4sigmalapl33, tv4sigmalapl34, tv4sigmalapl35, tv4sigmalapl36;
  double tv4sigmalapl37, tv4sigmalapl38, tv4sigmalapl39, tv4sigmalapl310, tv4sigmalapl311, tv4sigmalapl2tau0, tv4sigmalapl2tau1, tv4sigmalapl2tau2;
  double tv4sigmalapl2tau3, tv4sigmalapl2tau4, tv4sigmalapl2tau5, tv4sigmalapl2tau6, tv4sigmalapl2tau7, tv4sigmalapl2tau8, tv4sigmalapl2tau9, tv4sigmalapl2tau10;
  double tv4sigmalapl2tau11, tv4sigmalapl2tau12, tv4sigmalapl2tau13, tv4sigmalapl2tau14, tv4sigmalapl2tau15, tv4sigmalapl2tau16, tv4sigmalapl2tau17, tv4sigmalapltau20;
  double tv4sigmalapltau21, tv4sigmalapltau22, tv4sigmalapltau23, tv4sigmalapltau24, tv4sigmalapltau25, tv4sigmalapltau26, tv4sigmalapltau27, tv4sigmalapltau28;
  double tv4sigmalapltau29, tv4sigmalapltau210, tv4sigmalapltau211, tv4sigmalapltau212, tv4sigmalapltau213, tv4sigmalapltau214, tv4sigmalapltau215, tv4sigmalapltau216;
  double tv4sigmalapltau217, t16002, t16016, t16060, t16096, t16135, t16141, tv4sigmatau30;
  double tv4sigmatau31, tv4sigmatau32, tv4sigmatau33, tv4sigmatau34, tv4sigmatau35, tv4sigmatau36, tv4sigmatau37, tv4sigmatau38;
  double tv4sigmatau39, tv4sigmatau310, t16143, t16185, t16218, t16253, t16293, t16299;
  double tv4sigmatau311, tv4lapl40, tv4lapl41, tv4lapl42, tv4lapl43, tv4lapl44, tv4lapl3tau0, tv4lapl3tau1;
  double tv4lapl3tau2, tv4lapl3tau3, tv4lapl3tau4, tv4lapl3tau5, tv4lapl3tau6, tv4lapl3tau7, tv4lapl2tau20, tv4lapl2tau21;
  double tv4lapl2tau22, tv4lapl2tau23, tv4lapl2tau24, tv4lapl2tau25, tv4lapl2tau26, tv4lapl2tau27, tv4lapl2tau28, tv4lapltau30;
  double tv4lapltau31, tv4lapltau32, tv4lapltau33, tv4lapltau34, tv4lapltau35, tv4lapltau36, tv4lapltau37, t16314;
  double t16321, t16359, t16363, tv4tau40, tv4tau41, tv4tau42, tv4tau43, t16378;
  double t16385, t16423, t16427, tv4tau44;

  mgga_x_msb86bl_params *params;

  assert(p->params != NULL);
  params = (mgga_x_msb86bl_params * ) (p->params);

  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t19 = my_piecewise5(t11, t12, t15, t16, t17 * t8);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = sigma[0] * t39;
  t41 = 0.1e1 / params->kappa;
  t45 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t40 * t41;
  t46 = pow(t45, 0.1e1 / 0.5e1);
  t47 = t46 * t46;
  t48 = t47 * t47;
  t49 = 0.1e1 / t48;
  t52 = 0.5e1 / 0.972e3 * t34 * t40 * t49;
  t54 = 0.1e1 / t37 / rho[0];
  t57 = tau[0] * t54 - t40 / 0.8e1;
  t58 = t57 * t57;
  t59 = t29 * t29;
  t61 = 0.3e1 / 0.1e2 * t59 * t32;
  t62 = params->eta * sigma[0];
  t65 = t61 + t62 * t39 / 0.8e1;
  t66 = t65 * t65;
  t67 = 0.1e1 / t66;
  t69 = -t58 * t67 + 0.1e1;
  t70 = t69 * t69;
  t71 = t70 * t69;
  t72 = t58 * t57;
  t73 = t66 * t65;
  t74 = 0.1e1 / t73;
  t76 = t58 * t58;
  t78 = params->b * t76 * t58;
  t79 = t66 * t66;
  t81 = 0.1e1 / t79 / t66;
  t83 = t72 * t74 + t78 * t81 + 0.1e1;
  t84 = 0.1e1 / t83;
  t85 = t71 * t84;
  t88 = 0.5e1 / 0.972e3 * t34 * t40 + params->c;
  t90 = t41 * t88 + 0.1e1;
  t91 = pow(t90, 0.1e1 / 0.5e1);
  t92 = t91 * t91;
  t93 = t92 * t92;
  t94 = 0.1e1 / t93;
  t96 = t88 * t94 - t52;
  t98 = t85 * t96 + t52 + 0.1e1;
  t102 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t98);
  t103 = rho[1] <= p->dens_threshold;
  t104 = -t17;
  t106 = my_piecewise5(t15, t12, t11, t16, t104 * t8);
  t107 = 0.1e1 + t106;
  t108 = t107 <= p->zeta_threshold;
  t109 = POW_1_3(t107);
  t111 = my_piecewise3(t108, t23, t109 * t107);
  t112 = t111 * t27;
  t113 = rho[1] * rho[1];
  t114 = POW_1_3(rho[1]);
  t115 = t114 * t114;
  t117 = 0.1e1 / t115 / t113;
  t118 = sigma[2] * t117;
  t122 = 0.1e1 + 0.5e1 / 0.972e3 * t34 * t118 * t41;
  t123 = pow(t122, 0.1e1 / 0.5e1);
  t124 = t123 * t123;
  t125 = t124 * t124;
  t126 = 0.1e1 / t125;
  t129 = 0.5e1 / 0.972e3 * t34 * t118 * t126;
  t131 = 0.1e1 / t115 / rho[1];
  t134 = tau[1] * t131 - t118 / 0.8e1;
  t135 = t134 * t134;
  t136 = params->eta * sigma[2];
  t139 = t61 + t136 * t117 / 0.8e1;
  t140 = t139 * t139;
  t141 = 0.1e1 / t140;
  t143 = -t135 * t141 + 0.1e1;
  t144 = t143 * t143;
  t145 = t144 * t143;
  t146 = t135 * t134;
  t147 = t140 * t139;
  t148 = 0.1e1 / t147;
  t150 = t135 * t135;
  t152 = params->b * t150 * t135;
  t153 = t140 * t140;
  t155 = 0.1e1 / t153 / t140;
  t157 = t146 * t148 + t152 * t155 + 0.1e1;
  t158 = 0.1e1 / t157;
  t159 = t145 * t158;
  t162 = 0.5e1 / 0.972e3 * t34 * t118 + params->c;
  t164 = t162 * t41 + 0.1e1;
  t165 = pow(t164, 0.1e1 / 0.5e1);
  t166 = t165 * t165;
  t167 = t166 * t166;
  t168 = 0.1e1 / t167;
  t170 = t162 * t168 - t129;
  t172 = t159 * t170 + t129 + 0.1e1;
  t176 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t172);
  tzk0 = t102 + t176;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t177 = t7 * t7;
  t178 = 0.1e1 / t177;
  t179 = t17 * t178;
  t181 = my_piecewise5(t11, 0, t15, 0, t8 - t179);
  t184 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t181);
  t185 = t184 * t27;
  t189 = t27 * t27;
  t190 = 0.1e1 / t189;
  t191 = t26 * t190;
  t194 = t6 * t191 * t98 / 0.8e1;
  t195 = t35 * rho[0];
  t197 = 0.1e1 / t37 / t195;
  t198 = sigma[0] * t197;
  t201 = 0.1e2 / 0.729e3 * t34 * t198 * t49;
  t203 = 0.1e1 / t31 / t30;
  t204 = t59 * t203;
  t205 = sigma[0] * sigma[0];
  t206 = t204 * t205;
  t207 = t35 * t35;
  t208 = t207 * t35;
  t210 = 0.1e1 / t36 / t208;
  t212 = 0.1e1 / t48 / t45;
  t214 = t210 * t212 * t41;
  t216 = 0.1e2 / 0.177147e6 * t206 * t214;
  t217 = t70 * t84;
  t218 = t57 * t67;
  t222 = -0.5e1 / 0.3e1 * tau[0] * t39 + t198 / 0.3e1;
  t225 = t58 * t74;
  t226 = t62 * t197;
  t229 = -0.2e1 * t218 * t222 - 0.2e1 / 0.3e1 * t225 * t226;
  t230 = t96 * t229;
  t233 = t83 * t83;
  t234 = 0.1e1 / t233;
  t235 = t71 * t234;
  t238 = 0.1e1 / t79;
  t239 = t72 * t238;
  t242 = params->b * t76 * t57;
  t243 = t81 * t222;
  t247 = 0.1e1 / t79 / t73;
  t248 = t78 * t247;
  t251 = 0.3e1 * t222 * t225 + t226 * t239 + 0.2e1 * t226 * t248 + 0.6e1 * t242 * t243;
  t252 = t96 * t251;
  t258 = 0.1e1 / t93 / t90;
  t260 = t88 * t258 * t29;
  t261 = t33 * sigma[0];
  t266 = -0.1e2 / 0.729e3 * t34 * t198 * t94 + 0.8e1 / 0.729e3 * t260 * t261 * t197 * t41 + t201 - t216;
  t268 = 0.3e1 * t217 * t230 - t235 * t252 + t266 * t85 - t201 + t216;
  t273 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t98 - t194 - 0.3e1 / 0.8e1 * t6 * t28 * t268);
  t274 = t104 * t178;
  t276 = my_piecewise5(t15, 0, t11, 0, -t8 - t274);
  t279 = my_piecewise3(t108, 0, 0.4e1 / 0.3e1 * t109 * t276);
  t280 = t279 * t27;
  t284 = t111 * t190;
  t287 = t6 * t284 * t172 / 0.8e1;
  t289 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t172 - t287);
  tvrho0 = t102 + t176 + t7 * (t273 + t289);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t293 = my_piecewise5(t11, 0, t15, 0, -t8 - t179);
  t296 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t293);
  t297 = t296 * t27;
  t302 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t98 - t194);
  t304 = my_piecewise5(t15, 0, t11, 0, t8 - t274);
  t307 = my_piecewise3(t108, 0, 0.4e1 / 0.3e1 * t109 * t304);
  t308 = t307 * t27;
  t312 = t113 * rho[1];
  t314 = 0.1e1 / t115 / t312;
  t315 = sigma[2] * t314;
  t318 = 0.1e2 / 0.729e3 * t34 * t315 * t126;
  t319 = sigma[2] * sigma[2];
  t320 = t204 * t319;
  t321 = t113 * t113;
  t322 = t321 * t113;
  t324 = 0.1e1 / t114 / t322;
  t326 = 0.1e1 / t125 / t122;
  t328 = t324 * t326 * t41;
  t330 = 0.1e2 / 0.177147e6 * t320 * t328;
  t331 = t144 * t158;
  t332 = t134 * t141;
  t336 = -0.5e1 / 0.3e1 * tau[1] * t117 + t315 / 0.3e1;
  t339 = t135 * t148;
  t340 = t136 * t314;
  t343 = -0.2e1 * t332 * t336 - 0.2e1 / 0.3e1 * t339 * t340;
  t344 = t170 * t343;
  t347 = t157 * t157;
  t348 = 0.1e1 / t347;
  t349 = t145 * t348;
  t352 = 0.1e1 / t153;
  t353 = t146 * t352;
  t356 = params->b * t150 * t134;
  t357 = t155 * t336;
  t361 = 0.1e1 / t153 / t147;
  t362 = t152 * t361;
  t365 = 0.3e1 * t336 * t339 + t340 * t353 + 0.2e1 * t340 * t362 + 0.6e1 * t356 * t357;
  t366 = t170 * t365;
  t372 = 0.1e1 / t167 / t164;
  t374 = t162 * t372 * t29;
  t375 = t33 * sigma[2];
  t380 = -0.1e2 / 0.729e3 * t34 * t315 * t168 + 0.8e1 / 0.729e3 * t374 * t375 * t314 * t41 + t318 - t330;
  t382 = t159 * t380 + 0.3e1 * t331 * t344 - t349 * t366 - t318 + t330;
  t387 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t172 - t287 - 0.3e1 / 0.8e1 * t6 * t112 * t382);
  tvrho1 = t102 + t176 + t7 * (t302 + t387);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t392 = 0.5e1 / 0.972e3 * t34 * t39 * t49;
  t394 = t207 * rho[0];
  t396 = 0.1e1 / t36 / t394;
  t398 = t396 * t212 * t41;
  t400 = 0.5e1 / 0.236196e6 * t204 * sigma[0] * t398;
  t401 = t218 * t39;
  t402 = params->eta * t39;
  t405 = t225 * t402 / 0.4e1 + t401 / 0.4e1;
  t406 = t96 * t405;
  t409 = t225 * t39;
  t413 = t81 * t39;
  t414 = t242 * t413;
  t416 = t247 * params->eta;
  t420 = -0.3e1 / 0.8e1 * t409 - 0.3e1 / 0.8e1 * t239 * t402 - 0.3e1 / 0.4e1 * t414 - 0.3e1 / 0.4e1 * t78 * t416 * t39;
  t421 = t96 * t420;
  t430 = 0.5e1 / 0.972e3 * t34 * t39 * t94 - t260 * t33 * t39 * t41 / 0.243e3 - t392 + t400;
  t432 = 0.3e1 * t217 * t406 - t235 * t421 + t430 * t85 + t392 - t400;
  t436 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t432);
  tvsigma0 = t7 * t436;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t439 = 0.5e1 / 0.972e3 * t34 * t117 * t126;
  t441 = t321 * rho[1];
  t443 = 0.1e1 / t114 / t441;
  t445 = t443 * t326 * t41;
  t447 = 0.5e1 / 0.236196e6 * t204 * sigma[2] * t445;
  t448 = t332 * t117;
  t449 = params->eta * t117;
  t452 = t339 * t449 / 0.4e1 + t448 / 0.4e1;
  t453 = t170 * t452;
  t456 = t339 * t117;
  t460 = t155 * t117;
  t461 = t356 * t460;
  t463 = t361 * params->eta;
  t467 = -0.3e1 / 0.8e1 * t456 - 0.3e1 / 0.8e1 * t353 * t449 - 0.3e1 / 0.4e1 * t461 - 0.3e1 / 0.4e1 * t152 * t463 * t117;
  t468 = t170 * t467;
  t477 = 0.5e1 / 0.972e3 * t34 * t117 * t168 - t374 * t33 * t117 * t41 / 0.243e3 - t439 + t447;
  t479 = t159 * t477 + 0.3e1 * t331 * t453 - t349 * t468 + t439 - t447;
  t483 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t479);
  tvsigma2 = t7 * t483;

  if(out->vsigma != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  tvlapl0 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 0] += tvlapl0;

  tvlapl1 = 0.e0;

  if(out->vlapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vlapl[ip*p->dim.vlapl + 1] += tvlapl1;

  t484 = t217 * t96;
  t485 = t218 * t54;
  t490 = t81 * t54;
  t493 = 0.3e1 * t225 * t54 + 0.6e1 * t242 * t490;
  t494 = t96 * t493;
  t496 = -t235 * t494 - 0.6e1 * t484 * t485;
  t500 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t496);
  tvtau0 = t7 * t500;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 0] += tvtau0;

  t501 = t331 * t170;
  t502 = t332 * t131;
  t507 = t155 * t131;
  t510 = 0.3e1 * t131 * t339 + 0.6e1 * t356 * t507;
  t511 = t170 * t510;
  t513 = -t349 * t511 - 0.6e1 * t501 * t502;
  t517 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t513);
  tvtau1 = t7 * t517;

  if(out->vtau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vtau[ip*p->dim.vtau + 1] += tvtau1;

  t520 = t24 * t24;
  t521 = 0.1e1 / t520;
  t522 = t181 * t181;
  t525 = t177 * t7;
  t526 = 0.1e1 / t525;
  t527 = t17 * t526;
  t530 = my_piecewise5(t11, 0, t15, 0, -0.2e1 * t178 + 0.2e1 * t527);
  t534 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t521 * t522 + 0.4e1 / 0.3e1 * t24 * t530);
  t535 = t534 * t27;
  t539 = t184 * t190;
  t541 = t6 * t539 * t98;
  t547 = 0.1e1 / t189 / t7;
  t548 = t26 * t547;
  t551 = t6 * t548 * t98 / 0.12e2;
  t553 = t6 * t191 * t268;
  t556 = 0.1e1 / t37 / t207;
  t557 = sigma[0] * t556;
  t560 = 0.11e3 / 0.2187e4 * t34 * t557 * t49;
  t561 = t207 * t195;
  t563 = 0.1e1 / t36 / t561;
  t565 = t563 * t212 * t41;
  t567 = 0.1e2 / 0.19683e5 * t206 * t565;
  t568 = t30 * t30;
  t569 = 0.1e1 / t568;
  t570 = t205 * sigma[0];
  t571 = t569 * t570;
  t572 = t207 * t207;
  t573 = t572 * t35;
  t574 = 0.1e1 / t573;
  t575 = t45 * t45;
  t577 = 0.1e1 / t48 / t575;
  t579 = params->kappa * params->kappa;
  t580 = 0.1e1 / t579;
  t583 = 0.4e2 / 0.4782969e7 * t571 * t574 * t577 * t580;
  t584 = t69 * t84;
  t585 = t229 * t229;
  t586 = t96 * t585;
  t589 = t70 * t234;
  t593 = t266 * t229;
  t596 = t222 * t222;
  t599 = t57 * t74;
  t600 = t599 * t222;
  t606 = 0.4e2 / 0.9e1 * tau[0] * t197 - 0.11e2 / 0.9e1 * t557;
  t609 = t58 * t238;
  t610 = params->eta * params->eta;
  t611 = t610 * t205;
  t612 = t611 * t563;
  t615 = t62 * t556;
  t618 = -0.2e1 * t596 * t67 - 0.8e1 / 0.3e1 * t600 * t226 - 0.2e1 * t218 * t606 - 0.2e1 / 0.3e1 * t609 * t612 + 0.22e2 / 0.9e1 * t225 * t615;
  t619 = t96 * t618;
  t623 = 0.1e1 / t233 / t83;
  t624 = t71 * t623;
  t625 = t251 * t251;
  t626 = t96 * t625;
  t629 = t266 * t251;
  t634 = t609 * t222;
  t640 = 0.1e1 / t79 / t65;
  t641 = t72 * t640;
  t646 = params->b * t76;
  t647 = t81 * t596;
  t650 = t242 * t247;
  t651 = t222 * params->eta;
  t658 = t79 * t79;
  t659 = 0.1e1 / t658;
  t660 = t78 * t659;
  t665 = 0.6e1 * t599 * t596 + 0.6e1 * t634 * t226 + 0.3e1 * t225 * t606 + 0.4e1 / 0.3e1 * t641 * t612 - 0.11e2 / 0.3e1 * t239 * t615 + 0.3e2 * t646 * t647 + 0.24e2 * t650 * t651 * t198 + 0.6e1 * t242 * t81 * t606 + 0.14e2 / 0.3e1 * t660 * t612 - 0.22e2 / 0.3e1 * t248 * t615;
  t672 = t563 * t258 * t41;
  t675 = t90 * t90;
  t677 = 0.1e1 / t93 / t675;
  t679 = t88 * t677 * t59;
  t680 = t203 * t205;
  t689 = 0.11e3 / 0.2187e4 * t34 * t557 * t94 - 0.16e3 / 0.531441e6 * t206 * t672 + 0.16e2 / 0.59049e5 * t679 * t680 * t563 * t580 - 0.88e2 / 0.2187e4 * t260 * t261 * t556 * t41 - t560 + t567 - t583;
  t691 = -0.6e1 * t230 * t251 * t589 - t235 * t665 * t96 + 0.6e1 * t217 * t593 + 0.3e1 * t217 * t619 - 0.2e1 * t235 * t629 + 0.6e1 * t584 * t586 + 0.2e1 * t624 * t626 + t689 * t85 + t560 - t567 + t583;
  t696 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t98 - t541 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t268 + t551 - t553 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t691);
  t697 = t109 * t109;
  t698 = 0.1e1 / t697;
  t699 = t276 * t276;
  t702 = t104 * t526;
  t705 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t178 + 0.2e1 * t702);
  t709 = my_piecewise3(t108, 0, 0.4e1 / 0.9e1 * t698 * t699 + 0.4e1 / 0.3e1 * t109 * t705);
  t710 = t709 * t27;
  t714 = t279 * t190;
  t716 = t6 * t714 * t172;
  t718 = t111 * t547;
  t721 = t6 * t718 * t172 / 0.12e2;
  t723 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t172 - t716 / 0.4e1 + t721);
  tv2rho20 = 0.2e1 * t273 + 0.2e1 * t289 + t7 * (t696 + t723);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t726 = t521 * t293;
  t730 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t527);
  t734 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t726 * t181 + 0.4e1 / 0.3e1 * t24 * t730);
  t735 = t734 * t27;
  t739 = t296 * t190;
  t741 = t6 * t739 * t98;
  t749 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t98 - t741 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t268 - t541 / 0.8e1 + t551 - t553 / 0.8e1);
  t750 = t698 * t304;
  t754 = my_piecewise5(t15, 0, t11, 0, 0.2e1 * t702);
  t758 = my_piecewise3(t108, 0, 0.4e1 / 0.9e1 * t750 * t276 + 0.4e1 / 0.3e1 * t109 * t754);
  t759 = t758 * t27;
  t763 = t307 * t190;
  t765 = t6 * t763 * t172;
  t772 = t6 * t284 * t382;
  t775 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t172 - t765 / 0.8e1 - t716 / 0.8e1 + t721 - 0.3e1 / 0.8e1 * t6 * t280 * t382 - t772 / 0.8e1);
  tv2rho21 = t273 + t289 + t302 + t387 + t7 * (t749 + t775);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t780 = t293 * t293;
  t785 = my_piecewise5(t11, 0, t15, 0, 0.2e1 * t178 + 0.2e1 * t527);
  t789 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t521 * t780 + 0.4e1 / 0.3e1 * t24 * t785);
  t790 = t789 * t27;
  t796 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t98 - t741 / 0.4e1 + t551);
  t797 = t304 * t304;
  t802 = my_piecewise5(t15, 0, t11, 0, -0.2e1 * t178 + 0.2e1 * t702);
  t806 = my_piecewise3(t108, 0, 0.4e1 / 0.9e1 * t698 * t797 + 0.4e1 / 0.3e1 * t109 * t802);
  t807 = t806 * t27;
  t817 = 0.1e1 / t115 / t321;
  t818 = sigma[2] * t817;
  t821 = 0.11e3 / 0.2187e4 * t34 * t818 * t126;
  t822 = t321 * t312;
  t824 = 0.1e1 / t114 / t822;
  t826 = t824 * t326 * t41;
  t828 = 0.1e2 / 0.19683e5 * t320 * t826;
  t829 = t319 * sigma[2];
  t830 = t569 * t829;
  t831 = t321 * t321;
  t832 = t831 * t113;
  t833 = 0.1e1 / t832;
  t834 = t122 * t122;
  t836 = 0.1e1 / t125 / t834;
  t840 = 0.4e2 / 0.4782969e7 * t830 * t833 * t836 * t580;
  t841 = t143 * t158;
  t842 = t343 * t343;
  t843 = t170 * t842;
  t846 = t144 * t348;
  t850 = t380 * t343;
  t853 = t336 * t336;
  t856 = t134 * t148;
  t857 = t856 * t336;
  t863 = 0.4e2 / 0.9e1 * tau[1] * t314 - 0.11e2 / 0.9e1 * t818;
  t866 = t135 * t352;
  t867 = t610 * t319;
  t868 = t867 * t824;
  t871 = t136 * t817;
  t874 = -0.2e1 * t853 * t141 - 0.8e1 / 0.3e1 * t857 * t340 - 0.2e1 * t332 * t863 - 0.2e1 / 0.3e1 * t866 * t868 + 0.22e2 / 0.9e1 * t339 * t871;
  t875 = t170 * t874;
  t879 = 0.1e1 / t347 / t157;
  t880 = t145 * t879;
  t881 = t365 * t365;
  t882 = t170 * t881;
  t885 = t380 * t365;
  t890 = t866 * t336;
  t896 = 0.1e1 / t153 / t139;
  t897 = t146 * t896;
  t902 = params->b * t150;
  t903 = t155 * t853;
  t906 = t356 * t361;
  t907 = t336 * params->eta;
  t914 = t153 * t153;
  t915 = 0.1e1 / t914;
  t916 = t152 * t915;
  t921 = 0.6e1 * t856 * t853 + 0.6e1 * t890 * t340 + 0.3e1 * t339 * t863 + 0.4e1 / 0.3e1 * t897 * t868 - 0.11e2 / 0.3e1 * t353 * t871 + 0.3e2 * t902 * t903 + 0.24e2 * t906 * t907 * t315 + 0.6e1 * t356 * t155 * t863 + 0.14e2 / 0.3e1 * t916 * t868 - 0.22e2 / 0.3e1 * t362 * t871;
  t928 = t824 * t372 * t41;
  t931 = t164 * t164;
  t933 = 0.1e1 / t167 / t931;
  t935 = t162 * t933 * t59;
  t936 = t203 * t319;
  t945 = 0.11e3 / 0.2187e4 * t34 * t818 * t168 - 0.16e3 / 0.531441e6 * t320 * t928 + 0.16e2 / 0.59049e5 * t935 * t936 * t824 * t580 - 0.88e2 / 0.2187e4 * t374 * t375 * t817 * t41 - t821 + t828 - t840;
  t947 = -t170 * t349 * t921 - 0.6e1 * t344 * t365 * t846 + t159 * t945 + 0.6e1 * t331 * t850 + 0.3e1 * t331 * t875 - 0.2e1 * t349 * t885 + 0.6e1 * t841 * t843 + 0.2e1 * t880 * t882 + t821 - t828 + t840;
  t952 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t172 - t765 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t382 + t721 - t772 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * t947);
  tv2rho22 = 0.2e1 * t302 + 0.2e1 * t387 + t7 * (t796 + t952);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t960 = t6 * t191 * t432 / 0.8e1;
  t963 = 0.1e2 / 0.729e3 * t34 * t197 * t49;
  t964 = t204 * t210;
  t966 = t212 * sigma[0] * t41;
  t968 = 0.1e2 / 0.59049e5 * t964 * t966;
  t969 = t569 * t205;
  t970 = t572 * rho[0];
  t971 = 0.1e1 / t970;
  t975 = 0.5e1 / 0.1594323e7 * t969 * t971 * t577 * t580;
  t979 = t406 * t251;
  t982 = t266 * t405;
  t985 = t222 * t67;
  t986 = t985 * t39;
  t988 = t210 * params->eta;
  t989 = t988 * sigma[0];
  t992 = t218 * t197;
  t994 = t402 * t222;
  t997 = t610 * t210;
  t998 = t997 * sigma[0];
  t1001 = params->eta * t197;
  t1004 = t986 / 0.4e1 + t599 * t989 / 0.6e1 - 0.2e1 / 0.3e1 * t992 + t599 * t994 / 0.2e1 + t609 * t998 / 0.4e1 - 0.2e1 / 0.3e1 * t225 * t1001;
  t1005 = t96 * t1004;
  t1014 = t266 * t420;
  t1017 = t599 * t39 * t222;
  t1019 = t609 * t989;
  t1021 = t225 * t197;
  t1028 = t646 * t413 * t222;
  t1030 = t650 * t989;
  t1032 = t81 * t197;
  t1033 = t242 * t1032;
  t1042 = -0.3e1 / 0.4e1 * t1017 - 0.3e1 / 0.8e1 * t1019 + t1021 - 0.9e1 / 0.8e1 * t609 * t994 - t641 * t998 / 0.2e1 + t239 * t1001 - 0.15e2 / 0.4e1 * t1028 - 0.3e1 / 0.2e1 * t1030 + 0.2e1 * t1033 - 0.9e1 / 0.2e1 * t650 * t994 - 0.7e1 / 0.4e1 * t660 * t998 + 0.2e1 * t78 * t416 * t197;
  t1043 = t96 * t1042;
  t1045 = t430 * t229;
  t1048 = t430 * t251;
  t1054 = t258 * sigma[0] * t41;
  t1057 = t203 * t210;
  t1058 = t580 * sigma[0];
  t1066 = -0.1e2 / 0.729e3 * t34 * t197 * t94 + 0.2e2 / 0.177147e6 * t964 * t1054 - 0.2e1 / 0.19683e5 * t679 * t1057 * t1058 + 0.8e1 / 0.729e3 * t260 * t33 * t197 * t41 + t963 - t968 + t975;
  t1068 = 0.6e1 * t229 * t406 * t584 - 0.3e1 * t229 * t421 * t589 + 0.2e1 * t251 * t421 * t624 + 0.3e1 * t1005 * t217 - t1014 * t235 - t1043 * t235 + 0.3e1 * t1045 * t217 - t1048 * t235 + t1066 * t85 + 0.3e1 * t217 * t982 - 0.3e1 * t589 * t979 - t963 + t968 - t975;
  t1073 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t432 - t960 - 0.3e1 / 0.8e1 * t6 * t28 * t1068);
  tv2rhosigma0 = t1073 * t7 + t436;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1080 = t6 * t284 * t479 / 0.8e1;
  t1082 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t479 - t1080);
  tv2rhosigma2 = t1082 * t7 + t483;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1088 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t432 - t960);
  tv2rhosigma3 = t1088 * t7 + t436;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1095 = 0.1e2 / 0.729e3 * t34 * t314 * t126;
  t1096 = t204 * t324;
  t1098 = t326 * sigma[2] * t41;
  t1100 = 0.1e2 / 0.59049e5 * t1096 * t1098;
  t1101 = t569 * t319;
  t1102 = t831 * rho[1];
  t1103 = 0.1e1 / t1102;
  t1107 = 0.5e1 / 0.1594323e7 * t1101 * t1103 * t836 * t580;
  t1111 = t453 * t365;
  t1114 = t380 * t452;
  t1117 = t336 * t141;
  t1118 = t1117 * t117;
  t1120 = t324 * params->eta;
  t1121 = t1120 * sigma[2];
  t1124 = t332 * t314;
  t1126 = t449 * t336;
  t1129 = t610 * t324;
  t1130 = t1129 * sigma[2];
  t1133 = params->eta * t314;
  t1136 = t1118 / 0.4e1 + t856 * t1121 / 0.6e1 - 0.2e1 / 0.3e1 * t1124 + t856 * t1126 / 0.2e1 + t866 * t1130 / 0.4e1 - 0.2e1 / 0.3e1 * t339 * t1133;
  t1137 = t170 * t1136;
  t1146 = t380 * t467;
  t1148 = t117 * t336;
  t1149 = t856 * t1148;
  t1151 = t866 * t1121;
  t1153 = t339 * t314;
  t1160 = t902 * t460 * t336;
  t1162 = t906 * t1121;
  t1164 = t155 * t314;
  t1165 = t356 * t1164;
  t1174 = -0.3e1 / 0.4e1 * t1149 - 0.3e1 / 0.8e1 * t1151 + t1153 - 0.9e1 / 0.8e1 * t866 * t1126 - t897 * t1130 / 0.2e1 + t353 * t1133 - 0.15e2 / 0.4e1 * t1160 - 0.3e1 / 0.2e1 * t1162 + 0.2e1 * t1165 - 0.9e1 / 0.2e1 * t906 * t1126 - 0.7e1 / 0.4e1 * t916 * t1130 + 0.2e1 * t152 * t463 * t314;
  t1175 = t170 * t1174;
  t1177 = t477 * t343;
  t1186 = t372 * sigma[2] * t41;
  t1189 = t203 * t324;
  t1190 = t580 * sigma[2];
  t1198 = -0.1e2 / 0.729e3 * t34 * t314 * t168 + 0.2e2 / 0.177147e6 * t1096 * t1186 - 0.2e1 / 0.19683e5 * t935 * t1189 * t1190 + 0.8e1 / 0.729e3 * t374 * t33 * t314 * t41 + t1095 - t1100 + t1107;
  t1200 = 0.6e1 * t343 * t453 * t841 - 0.3e1 * t343 * t468 * t846 - t349 * t365 * t477 + 0.2e1 * t365 * t468 * t880 - 0.3e1 * t1111 * t846 + 0.3e1 * t1114 * t331 + 0.3e1 * t1137 * t331 - t1146 * t349 - t1175 * t349 + 0.3e1 * t1177 * t331 + t1198 * t159 - t1095 + t1100 - t1107;
  t1205 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t479 - t1080 - 0.3e1 / 0.8e1 * t6 * t112 * t1200);
  tv2rhosigma5 = t1205 * t7 + t483;

  if(out->v2rhosigma != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  tv2rholapl0 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 0] += tv2rholapl0;

  tv2rholapl1 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 1] += tv2rholapl1;

  tv2rholapl2 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 2] += tv2rholapl2;

  tv2rholapl3 = 0.e0;

  if(out->v2rholapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rholapl[ip*p->dim.v2rholapl + 3] += tv2rholapl3;

  t1212 = t6 * t191 * t496 / 0.8e1;
  t1213 = t584 * t96;
  t1214 = t54 * t229;
  t1215 = t218 * t1214;
  t1218 = t589 * t96;
  t1219 = t54 * t251;
  t1220 = t218 * t1219;
  t1223 = t217 * t266;
  t1226 = t985 * t54;
  t1229 = t96 * t57;
  t1230 = t217 * t1229;
  t1231 = t74 * t396;
  t1232 = t1231 * t62;
  t1243 = t266 * t493;
  t1245 = t54 * t222;
  t1248 = t396 * params->eta;
  t1249 = t1248 * sigma[0];
  t1259 = 0.3e2 * t222 * t490 * t646 + 0.6e1 * t1245 * t599 + 0.3e1 * t1249 * t609 + 0.12e2 * t1249 * t650 - 0.5e1 * t409 - 0.1e2 * t414;
  t1260 = t96 * t1259;
  t1262 = -0.3e1 * t229 * t494 * t589 + 0.2e1 * t251 * t494 * t624 - 0.12e2 * t1213 * t1215 + 0.6e1 * t1218 * t1220 - 0.6e1 * t1223 * t485 - 0.6e1 * t1226 * t484 - 0.4e1 * t1230 * t1232 - t1243 * t235 - t1260 * t235 + 0.1e2 * t401 * t484;
  t1267 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t496 - t1212 - 0.3e1 / 0.8e1 * t6 * t28 * t1262);
  tv2rhotau0 = t1267 * t7 + t500;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 0] += tv2rhotau0;

  t1274 = t6 * t284 * t513 / 0.8e1;
  t1276 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t513 - t1274);
  tv2rhotau1 = t1276 * t7 + t517;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 1] += tv2rhotau1;

  t1282 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t496 - t1212);
  tv2rhotau2 = t1282 * t7 + t500;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 2] += tv2rhotau2;

  t1287 = t841 * t170;
  t1288 = t131 * t343;
  t1289 = t332 * t1288;
  t1292 = t846 * t170;
  t1293 = t131 * t365;
  t1294 = t332 * t1293;
  t1297 = t331 * t380;
  t1300 = t1117 * t131;
  t1303 = t170 * t134;
  t1304 = t331 * t1303;
  t1305 = t148 * t443;
  t1306 = t1305 * t136;
  t1317 = t380 * t510;
  t1319 = t131 * t336;
  t1322 = t443 * params->eta;
  t1323 = t1322 * sigma[2];
  t1333 = 0.3e2 * t336 * t507 * t902 + 0.6e1 * t1319 * t856 + 0.3e1 * t1323 * t866 + 0.12e2 * t1323 * t906 - 0.5e1 * t456 - 0.1e2 * t461;
  t1334 = t170 * t1333;
  t1336 = -0.3e1 * t343 * t511 * t846 + 0.2e1 * t365 * t511 * t880 - 0.12e2 * t1287 * t1289 + 0.6e1 * t1292 * t1294 - 0.6e1 * t1297 * t502 - 0.6e1 * t1300 * t501 - 0.4e1 * t1304 * t1306 - t1317 * t349 - t1334 * t349 + 0.1e2 * t448 * t501;
  t1341 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t513 - t1274 - 0.3e1 / 0.8e1 * t6 * t112 * t1336);
  tv2rhotau3 = t1341 * t7 + t517;

  if(out->v2rhotau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhotau[ip*p->dim.v2rhotau + 3] += tv2rhotau3;

  t1344 = 0.5e1 / 0.118098e6 * t204 * t398;
  t1345 = t569 * sigma[0];
  t1346 = 0.1e1 / t572;
  t1350 = 0.5e1 / 0.4251528e7 * t1345 * t1346 * t577 * t580;
  t1351 = t405 * t405;
  t1352 = t96 * t1351;
  t1355 = t406 * t420;
  t1358 = t430 * t405;
  t1361 = t396 * t67;
  t1363 = t599 * t1248;
  t1365 = t610 * t396;
  t1368 = -t1361 / 0.32e2 - t1363 / 0.8e1 - 0.3e1 / 0.32e2 * t609 * t1365;
  t1369 = t96 * t1368;
  t1372 = t420 * t420;
  t1373 = t96 * t1372;
  t1376 = t430 * t420;
  t1379 = t599 * t396;
  t1381 = t609 * t1248;
  t1385 = t81 * t396;
  t1386 = t646 * t1385;
  t1390 = t242 * t247 * t396 * params->eta;
  t1392 = t659 * t610;
  t1396 = 0.3e1 / 0.32e2 * t1379 + 0.9e1 / 0.32e2 * t1381 + 0.3e1 / 0.16e2 * t641 * t1365 + 0.15e2 / 0.32e2 * t1386 + 0.9e1 / 0.8e1 * t1390 + 0.21e2 / 0.32e2 * t78 * t1392 * t396;
  t1397 = t96 * t1396;
  t1407 = -0.5e1 / 0.118098e6 * t204 * t396 * t258 * t41 + t679 * t203 * t396 * t580 / 0.26244e5 + t1344 - t1350;
  t1409 = 0.6e1 * t1352 * t584 - 0.6e1 * t1355 * t589 + 0.6e1 * t1358 * t217 + 0.3e1 * t1369 * t217 + 0.2e1 * t1373 * t624 - 0.2e1 * t1376 * t235 - t1397 * t235 + t1407 * t85 - t1344 + t1350;
  t1413 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t1409);
  tv2sigma20 = t7 * t1413;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1415 = 0.5e1 / 0.118098e6 * t204 * t445;
  t1416 = t569 * sigma[2];
  t1417 = 0.1e1 / t831;
  t1421 = 0.5e1 / 0.4251528e7 * t1416 * t1417 * t836 * t580;
  t1422 = t452 * t452;
  t1423 = t170 * t1422;
  t1426 = t453 * t467;
  t1429 = t477 * t452;
  t1432 = t443 * t141;
  t1434 = t856 * t1322;
  t1436 = t610 * t443;
  t1439 = -t1432 / 0.32e2 - t1434 / 0.8e1 - 0.3e1 / 0.32e2 * t866 * t1436;
  t1440 = t170 * t1439;
  t1443 = t467 * t467;
  t1444 = t170 * t1443;
  t1447 = t477 * t467;
  t1450 = t856 * t443;
  t1452 = t866 * t1322;
  t1456 = t155 * t443;
  t1457 = t902 * t1456;
  t1461 = t356 * t361 * t443 * params->eta;
  t1463 = t915 * t610;
  t1467 = 0.3e1 / 0.32e2 * t1450 + 0.9e1 / 0.32e2 * t1452 + 0.3e1 / 0.16e2 * t897 * t1436 + 0.15e2 / 0.32e2 * t1457 + 0.9e1 / 0.8e1 * t1461 + 0.21e2 / 0.32e2 * t152 * t1463 * t443;
  t1468 = t170 * t1467;
  t1478 = -0.5e1 / 0.118098e6 * t204 * t443 * t372 * t41 + t935 * t203 * t443 * t580 / 0.26244e5 + t1415 - t1421;
  t1480 = 0.6e1 * t1423 * t841 - 0.6e1 * t1426 * t846 + 0.6e1 * t1429 * t331 + 0.3e1 * t1440 * t331 + 0.2e1 * t1444 * t880 - 0.2e1 * t1447 * t349 - t1468 * t349 + t1478 * t159 - t1415 + t1421;
  t1484 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t1480);
  tv2sigma25 = t7 * t1484;

  if(out->v2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  tv2sigmalapl0 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 0] += tv2sigmalapl0;

  tv2sigmalapl1 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 1] += tv2sigmalapl1;

  tv2sigmalapl2 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 2] += tv2sigmalapl2;

  tv2sigmalapl3 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 3] += tv2sigmalapl3;

  tv2sigmalapl4 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 4] += tv2sigmalapl4;

  tv2sigmalapl5 = 0.e0;

  if(out->v2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmalapl[ip*p->dim.v2sigmalapl + 5] += tv2sigmalapl5;

  t1485 = t54 * t405;
  t1486 = t218 * t1485;
  t1489 = t54 * t420;
  t1490 = t218 * t1489;
  t1493 = t217 * t430;
  t1497 = 0.1e1 / t36 / t207;
  t1499 = t96 * t1497 * t67;
  t1500 = t217 * t1499;
  t1502 = t1497 * params->eta;
  t1503 = t599 * t1502;
  t1506 = t494 * t405;
  t1512 = t430 * t493;
  t1514 = t599 * t1497;
  t1518 = t81 * t1497;
  t1519 = t646 * t1518;
  t1525 = -0.3e1 / 0.4e1 * t1514 - 0.9e1 / 0.8e1 * t609 * t1502 - 0.15e2 / 0.4e1 * t1519 - 0.9e1 / 0.2e1 * t242 * t247 * t1497 * params->eta;
  t1526 = t96 * t1525;
  t1528 = -0.12e2 * t1213 * t1486 + 0.6e1 * t1218 * t1490 - 0.6e1 * t1493 * t485 + 0.3e1 / 0.4e1 * t1500 + 0.3e1 / 0.2e1 * t484 * t1503 - 0.3e1 * t589 * t1506 + 0.2e1 * t624 * t494 * t420 - t235 * t1512 - t235 * t1526;
  t1532 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t1528);
  tv2sigmatau0 = t7 * t1532;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 0] += tv2sigmatau0;

  tv2sigmatau1 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 1] += tv2sigmatau1;

  tv2sigmatau2 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 2] += tv2sigmatau2;

  tv2sigmatau3 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 3] += tv2sigmatau3;

  tv2sigmatau4 = 0.e0;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 4] += tv2sigmatau4;

  t1533 = t131 * t452;
  t1534 = t332 * t1533;
  t1537 = t131 * t467;
  t1538 = t332 * t1537;
  t1541 = t331 * t477;
  t1545 = 0.1e1 / t114 / t321;
  t1547 = t170 * t1545 * t141;
  t1548 = t331 * t1547;
  t1550 = t1545 * params->eta;
  t1551 = t856 * t1550;
  t1554 = t511 * t452;
  t1560 = t477 * t510;
  t1562 = t856 * t1545;
  t1566 = t155 * t1545;
  t1567 = t902 * t1566;
  t1573 = -0.3e1 / 0.4e1 * t1562 - 0.9e1 / 0.8e1 * t866 * t1550 - 0.15e2 / 0.4e1 * t1567 - 0.9e1 / 0.2e1 * t356 * t361 * t1545 * params->eta;
  t1574 = t170 * t1573;
  t1576 = -0.12e2 * t1287 * t1534 + 0.6e1 * t1292 * t1538 - 0.6e1 * t1541 * t502 + 0.3e1 / 0.4e1 * t1548 + 0.3e1 / 0.2e1 * t501 * t1551 - 0.3e1 * t846 * t1554 + 0.2e1 * t880 * t511 * t467 - t349 * t1560 - t349 * t1574;
  t1580 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t1576);
  tv2sigmatau5 = t7 * t1580;

  if(out->v2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigmatau[ip*p->dim.v2sigmatau + 5] += tv2sigmatau5;

  tv2lapl20 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 0] += tv2lapl20;

  tv2lapl21 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 1] += tv2lapl21;

  tv2lapl22 = 0.e0;

  if(out->v2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapl2[ip*p->dim.v2lapl2 + 2] += tv2lapl22;

  tv2lapltau0 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 0] += tv2lapltau0;

  tv2lapltau1 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 1] += tv2lapltau1;

  tv2lapltau2 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 2] += tv2lapltau2;

  tv2lapltau3 = 0.e0;

  if(out->v2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2lapltau[ip*p->dim.v2lapltau + 3] += tv2lapltau3;

  t1582 = 0.1e1 / t36 / t195;
  t1583 = t609 * t1582;
  t1586 = t54 * t493;
  t1587 = t218 * t1586;
  t1591 = t96 * t1582 * t67;
  t1594 = t493 * t493;
  t1595 = t96 * t1594;
  t1600 = t81 * t1582;
  t1603 = 0.6e1 * t1582 * t599 + 0.3e2 * t1600 * t646;
  t1604 = t96 * t1603;
  t1606 = 0.24e2 * t1213 * t1583 + 0.12e2 * t1218 * t1587 - 0.6e1 * t1591 * t217 + 0.2e1 * t1595 * t624 - t1604 * t235;
  t1610 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t1606);
  tv2tau20 = t7 * t1610;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 0] += tv2tau20;

  tv2tau21 = 0.e0;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 1] += tv2tau21;

  t1612 = 0.1e1 / t114 / t312;
  t1613 = t866 * t1612;
  t1616 = t131 * t510;
  t1617 = t332 * t1616;
  t1621 = t170 * t1612 * t141;
  t1624 = t510 * t510;
  t1625 = t170 * t1624;
  t1630 = t155 * t1612;
  t1633 = 0.6e1 * t1612 * t856 + 0.3e2 * t1630 * t902;
  t1634 = t170 * t1633;
  t1636 = 0.24e2 * t1287 * t1613 + 0.12e2 * t1292 * t1617 - 0.6e1 * t1621 * t331 + 0.2e1 * t1625 * t880 - t1634 * t349;
  t1640 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t1636);
  tv2tau22 = t7 * t1640;

  if(out->v2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2tau2[ip*p->dim.v2tau2 + 2] += tv2tau22;

  t1644 = 0.1e1 / t520 / t20;
  t1645 = t522 * t181;
  t1648 = t521 * t181;
  t1651 = t177 * t177;
  t1652 = 0.1e1 / t1651;
  t1653 = t17 * t1652;
  t1656 = my_piecewise5(t11, 0, t15, 0, 0.6e1 * t526 - 0.6e1 * t1653);
  t1660 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1644 * t1645 + 0.4e1 / 0.3e1 * t1648 * t530 + 0.4e1 / 0.3e1 * t24 * t1656);
  t1661 = t1660 * t27;
  t1665 = t534 * t190;
  t1667 = t6 * t1665 * t98;
  t1672 = t184 * t547;
  t1674 = t6 * t1672 * t98;
  t1677 = t6 * t539 * t268;
  t1683 = 0.1e1 / t189 / t177;
  t1684 = t26 * t1683;
  t1687 = 0.5e1 / 0.36e2 * t6 * t1684 * t98;
  t1689 = t6 * t548 * t268;
  t1692 = t6 * t191 * t691;
  t1694 = t70 * t623;
  t1699 = 0.1e1 / t37 / t394;
  t1700 = sigma[0] * t1699;
  t1703 = 0.154e4 / 0.6561e4 * t34 * t1700 * t49;
  t1705 = 0.1e1 / t36 / t572;
  t1709 = 0.682e4 / 0.1594323e7 * t206 * t1705 * t212 * t41;
  t1710 = t233 * t233;
  t1711 = 0.1e1 / t1710;
  t1712 = t71 * t1711;
  t1713 = t625 * t251;
  t1720 = t572 * t195;
  t1721 = 0.1e1 / t1720;
  t1725 = 0.76e3 / 0.4782969e7 * t571 * t1721 * t577 * t580;
  t1726 = t69 * t234;
  t1742 = 0.18e2 * t1694 * t230 * t625 - 0.6e1 * t1712 * t1713 * t96 - 0.18e2 * t1726 * t251 * t586 + 0.18e2 * t230 * t584 * t618 - 0.9e1 * t230 * t589 * t665 - 0.18e2 * t251 * t589 * t593 - 0.9e1 * t251 * t589 * t619 + 0.6e1 * t252 * t624 * t665 - t1703 + t1709 - t1725;
  t1756 = 0.1e1 / t93 / t675 / t90;
  t1757 = t88 * t1756;
  t1758 = t1757 * t569;
  t1761 = 0.1e1 / t579 / params->kappa;
  t1773 = t205 * t205;
  t1774 = t569 * t1773;
  t1775 = t572 * t394;
  t1777 = 0.1e1 / t37 / t1775;
  t1781 = 0.1e1 / t48 / t575 / t45;
  t1783 = t1781 * t1761 * t34;
  t1785 = 0.112e4 / 0.3486784401e10 * t1774 * t1777 * t1783;
  t1786 = -0.154e4 / 0.6561e4 * t34 * t1700 * t94 + 0.176e4 / 0.531441e6 * t206 * t1705 * t258 * t41 - 0.32e3 / 0.4782969e7 * t571 * t1721 * t677 * t580 + 0.896e3 / 0.14348907e8 * t1758 * t570 * t1721 * t1761 - 0.176e3 / 0.59049e5 * t679 * t680 * t1705 * t580 + 0.1232e4 / 0.6561e4 * t260 * t261 * t1699 * t41 + t1703 - t1709 + t1725 - t1785;
  t1788 = t585 * t229;
  t1789 = t1788 * t84;
  t1792 = t266 * t585;
  t1795 = t689 * t229;
  t1798 = t266 * t618;
  t1803 = t596 * t74;
  t1806 = t57 * t238;
  t1807 = t1806 * t222;
  t1810 = t599 * t606;
  t1818 = -0.44e3 / 0.27e2 * tau[0] * t556 + 0.154e3 / 0.27e2 * t1700;
  t1821 = t58 * t640;
  t1822 = t610 * params->eta;
  t1823 = t1822 * t570;
  t1824 = t1823 * t1721;
  t1827 = t611 * t1705;
  t1830 = t62 * t1699;
  t1833 = -0.6e1 * t985 * t606 - 0.4e1 * t1803 * t226 - 0.4e1 * t1807 * t612 - 0.4e1 * t1810 * t226 + 0.44e2 / 0.3e1 * t600 * t615 - 0.2e1 * t218 * t1818 - 0.8e1 / 0.9e1 * t1821 * t1824 + 0.22e2 / 0.3e1 * t609 * t1827 - 0.308e3 / 0.27e2 * t225 * t1830;
  t1834 = t96 * t1833;
  t1850 = 0.1e1 / t658 / t65;
  t1851 = t78 * t1850;
  t1854 = t1806 * t596;
  t1857 = t609 * t606;
  t1860 = t1821 * t222;
  t1867 = t72 * t81;
  t1870 = params->b * t72;
  t1871 = t596 * t222;
  t1882 = t222 * t606;
  t1890 = t646 * t247;
  t1891 = t596 * params->eta;
  t1895 = t606 * params->eta;
  t1896 = t1895 * t198;
  t1899 = t242 * t659;
  t1900 = t222 * t610;
  t1901 = t205 * t563;
  t1909 = -0.132e3 * t650 * t651 * t557 + 0.112e3 / 0.9e1 * t1851 * t1824 + 0.18e2 * t1854 * t226 + 0.9e1 * t1857 * t226 + 0.12e2 * t1860 * t612 - 0.44e2 / 0.3e1 * t641 * t1827 + 0.154e3 / 0.9e1 * t239 * t1830 + 0.2e2 / 0.9e1 * t1867 * t1824 + 0.12e3 * t1870 * t81 * t1871 + 0.9e2 * t646 * t243 * t606 + 0.6e1 * t1871 * t74 + 0.3e1 * t225 * t1818 + 0.18e2 * t599 * t1882 + 0.6e1 * t242 * t81 * t1818 - 0.33e2 * t634 * t615 + 0.18e3 * t1890 * t1891 * t198 + 0.36e2 * t650 * t1896 + 0.84e2 * t1899 * t1900 * t1901 - 0.154e3 / 0.3e1 * t660 * t1827 + 0.308e3 / 0.9e1 * t248 * t1830;
  t1912 = -t1909 * t235 * t96 - 0.3e1 * t235 * t251 * t689 - 0.3e1 * t235 * t266 * t665 + 0.6e1 * t266 * t624 * t625 + t1786 * t85 + 0.6e1 * t1789 * t96 + 0.18e2 * t1792 * t584 + 0.9e1 * t1795 * t217 + 0.9e1 * t1798 * t217 + 0.3e1 * t1834 * t217 + t1785;
  t1913 = t1742 + t1912;
  t1918 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1661 * t98 - 0.3e1 / 0.8e1 * t1667 - 0.9e1 / 0.8e1 * t6 * t535 * t268 + t1674 / 0.4e1 - 0.3e1 / 0.4e1 * t1677 - 0.9e1 / 0.8e1 * t6 * t185 * t691 - t1687 + t1689 / 0.4e1 - 0.3e1 / 0.8e1 * t1692 - 0.3e1 / 0.8e1 * t6 * t28 * t1913);
  t1920 = 0.1e1 / t697 / t107;
  t1921 = t699 * t276;
  t1924 = t698 * t276;
  t1927 = t104 * t1652;
  t1930 = my_piecewise5(t15, 0, t11, 0, -0.6e1 * t526 - 0.6e1 * t1927);
  t1934 = my_piecewise3(t108, 0, -0.8e1 / 0.27e2 * t1920 * t1921 + 0.4e1 / 0.3e1 * t1924 * t705 + 0.4e1 / 0.3e1 * t109 * t1930);
  t1935 = t1934 * t27;
  t1939 = t709 * t190;
  t1941 = t6 * t1939 * t172;
  t1943 = t279 * t547;
  t1945 = t6 * t1943 * t172;
  t1947 = t111 * t1683;
  t1950 = 0.5e1 / 0.36e2 * t6 * t1947 * t172;
  t1952 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t1935 * t172 - 0.3e1 / 0.8e1 * t1941 + t1945 / 0.4e1 - t1950);
  tv3rho30 = 0.3e1 * t696 + 0.3e1 * t723 + t7 * (t1918 + t1952);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1955 = 0.2e1 * t749;
  t1956 = 0.2e1 * t775;
  t1957 = t1644 * t293;
  t1960 = t521 * t730;
  t1965 = 0.2e1 * t526;
  t1966 = 0.6e1 * t1653;
  t1968 = my_piecewise5(t11, 0, t15, 0, t1965 - t1966);
  t1972 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1957 * t522 + 0.8e1 / 0.9e1 * t1960 * t181 + 0.4e1 / 0.9e1 * t726 * t530 + 0.4e1 / 0.3e1 * t24 * t1968);
  t1973 = t1972 * t27;
  t1977 = t734 * t190;
  t1980 = t6 * t1977 * t98 / 0.4e1;
  t1984 = t296 * t547;
  t1986 = t6 * t1984 * t98;
  t1990 = t6 * t739 * t268 / 0.4e1;
  t1999 = -0.3e1 / 0.8e1 * t6 * t1973 * t98 - t1980 - 0.3e1 / 0.4e1 * t6 * t735 * t268 + t1986 / 0.12e2 - t1990 - 0.3e1 / 0.8e1 * t6 * t297 * t691 - t1667 / 0.8e1 + t1674 / 0.6e1 - t1677 / 0.4e1 - t1687 + t1689 / 0.6e1 - t1692 / 0.8e1;
  t2000 = my_piecewise3(t2, 0, t1999);
  t2001 = t1920 * t304;
  t2004 = t698 * t754;
  t2009 = 0.6e1 * t1927;
  t2011 = my_piecewise5(t15, 0, t11, 0, -t1965 - t2009);
  t2015 = my_piecewise3(t108, 0, -0.8e1 / 0.27e2 * t2001 * t699 + 0.8e1 / 0.9e1 * t2004 * t276 + 0.4e1 / 0.9e1 * t750 * t705 + 0.4e1 / 0.3e1 * t109 * t2011);
  t2016 = t2015 * t27;
  t2020 = t758 * t190;
  t2023 = t6 * t2020 * t172 / 0.4e1;
  t2024 = t307 * t547;
  t2026 = t6 * t2024 * t172;
  t2035 = t6 * t714 * t382 / 0.4e1;
  t2037 = t6 * t718 * t382;
  t2040 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t2016 * t172 - t2023 + t2026 / 0.12e2 - t1941 / 0.8e1 + t1945 / 0.6e1 - t1950 - 0.3e1 / 0.8e1 * t6 * t710 * t382 - t2035 + t2037 / 0.12e2);
  tv3rho31 = t696 + t723 + t1955 + t1956 + t7 * (t2000 + t2040);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2043 = t1644 * t780;
  t2048 = t521 * t785;
  t2052 = my_piecewise5(t11, 0, t15, 0, -t1965 - t1966);
  t2056 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t2043 * t181 + 0.8e1 / 0.9e1 * t726 * t730 + 0.4e1 / 0.9e1 * t2048 * t181 + 0.4e1 / 0.3e1 * t24 * t2052);
  t2057 = t2056 * t27;
  t2061 = t789 * t190;
  t2063 = t6 * t2061 * t98;
  t2072 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2057 * t98 - t2063 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t790 * t268 - t1980 + t1986 / 0.6e1 - t1990 + t1674 / 0.12e2 - t1687 + t1689 / 0.12e2);
  t2073 = t1920 * t797;
  t2078 = t698 * t802;
  t2082 = my_piecewise5(t15, 0, t11, 0, t1965 - t2009);
  t2086 = my_piecewise3(t108, 0, -0.8e1 / 0.27e2 * t2073 * t276 + 0.8e1 / 0.9e1 * t750 * t754 + 0.4e1 / 0.9e1 * t2078 * t276 + 0.4e1 / 0.3e1 * t109 * t2082);
  t2087 = t2086 * t27;
  t2091 = t806 * t190;
  t2093 = t6 * t2091 * t172;
  t2100 = t6 * t763 * t382;
  t2108 = t6 * t284 * t947;
  t2110 = -0.3e1 / 0.8e1 * t6 * t2087 * t172 - t2093 / 0.8e1 - t2023 + t2026 / 0.6e1 - 0.3e1 / 0.4e1 * t6 * t759 * t382 - t2100 / 0.4e1 + t1945 / 0.12e2 - t1950 - t2035 + t2037 / 0.6e1 - 0.3e1 / 0.8e1 * t6 * t280 * t947 - t2108 / 0.8e1;
  t2111 = my_piecewise3(t103, 0, t2110);
  tv3rho32 = t1955 + t1956 + t796 + t952 + t7 * (t2072 + t2111);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2116 = t780 * t293;
  t2123 = my_piecewise5(t11, 0, t15, 0, -0.6e1 * t526 - 0.6e1 * t1653);
  t2127 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1644 * t2116 + 0.4e1 / 0.3e1 * t726 * t785 + 0.4e1 / 0.3e1 * t24 * t2123);
  t2128 = t2127 * t27;
  t2135 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2128 * t98 - 0.3e1 / 0.8e1 * t2063 + t1986 / 0.4e1 - t1687);
  t2136 = t797 * t304;
  t2143 = my_piecewise5(t15, 0, t11, 0, 0.6e1 * t526 - 0.6e1 * t1927);
  t2147 = my_piecewise3(t108, 0, -0.8e1 / 0.27e2 * t1920 * t2136 + 0.4e1 / 0.3e1 * t750 * t802 + 0.4e1 / 0.3e1 * t109 * t2143);
  t2148 = t2147 * t27;
  t2163 = t831 * t312;
  t2164 = 0.1e1 / t2163;
  t2168 = 0.76e3 / 0.4782969e7 * t830 * t2164 * t836 * t580;
  t2169 = t143 * t348;
  t2185 = t347 * t347;
  t2186 = 0.1e1 / t2185;
  t2187 = t145 * t2186;
  t2188 = t881 * t365;
  t2189 = t170 * t2188;
  t2195 = t144 * t879;
  t2200 = 0.1e1 / t115 / t441;
  t2201 = sigma[2] * t2200;
  t2204 = 0.154e4 / 0.6561e4 * t34 * t2201 * t126;
  t2206 = 0.1e1 / t114 / t831;
  t2210 = 0.682e4 / 0.1594323e7 * t320 * t2206 * t326 * t41;
  t2211 = -0.18e2 * t2169 * t365 * t843 + 0.18e2 * t2195 * t344 * t881 + 0.18e2 * t344 * t841 * t874 - 0.9e1 * t344 * t846 * t921 - 0.18e2 * t365 * t846 * t850 - 0.9e1 * t365 * t846 * t875 + 0.6e1 * t366 * t880 * t921 - 0.6e1 * t2187 * t2189 - t2168 - t2204 + t2210;
  t2225 = 0.1e1 / t167 / t931 / t164;
  t2226 = t162 * t2225;
  t2227 = t2226 * t569;
  t2228 = t829 * t2164;
  t2240 = t319 * t319;
  t2241 = t569 * t2240;
  t2242 = t831 * t441;
  t2244 = 0.1e1 / t115 / t2242;
  t2248 = 0.1e1 / t125 / t834 / t122;
  t2250 = t2248 * t1761 * t34;
  t2252 = 0.112e4 / 0.3486784401e10 * t2241 * t2244 * t2250;
  t2253 = -0.154e4 / 0.6561e4 * t34 * t2201 * t168 + 0.176e4 / 0.531441e6 * t320 * t2206 * t372 * t41 - 0.32e3 / 0.4782969e7 * t830 * t2164 * t933 * t580 + 0.896e3 / 0.14348907e8 * t2227 * t2228 * t1761 - 0.176e3 / 0.59049e5 * t935 * t936 * t2206 * t580 + 0.1232e4 / 0.6561e4 * t374 * t375 * t2200 * t41 + t2204 - t2210 + t2168 - t2252;
  t2255 = t842 * t343;
  t2256 = t2255 * t158;
  t2259 = t380 * t842;
  t2262 = t945 * t343;
  t2265 = t380 * t874;
  t2270 = t853 * t148;
  t2273 = t134 * t352;
  t2274 = t2273 * t336;
  t2277 = t856 * t863;
  t2285 = -0.44e3 / 0.27e2 * tau[1] * t817 + 0.154e3 / 0.27e2 * t2201;
  t2288 = t135 * t896;
  t2289 = t1822 * t829;
  t2290 = t2289 * t2164;
  t2293 = t867 * t2206;
  t2296 = t136 * t2200;
  t2299 = -0.6e1 * t1117 * t863 - 0.4e1 * t2270 * t340 - 0.4e1 * t2274 * t868 - 0.4e1 * t2277 * t340 + 0.44e2 / 0.3e1 * t857 * t871 - 0.2e1 * t332 * t2285 - 0.8e1 / 0.9e1 * t2288 * t2290 + 0.22e2 / 0.3e1 * t866 * t2293 - 0.308e3 / 0.27e2 * t339 * t2296;
  t2300 = t170 * t2299;
  t2312 = t146 * t155;
  t2315 = params->b * t146;
  t2316 = t853 * t336;
  t2327 = 0.1e1 / t914 / t139;
  t2328 = t152 * t2327;
  t2331 = t2273 * t853;
  t2334 = t866 * t863;
  t2337 = t2288 * t336;
  t2348 = t336 * t863;
  t2358 = t902 * t361;
  t2359 = t853 * params->eta;
  t2363 = t863 * params->eta;
  t2364 = t2363 * t315;
  t2367 = t356 * t915;
  t2368 = t336 * t610;
  t2369 = t319 * t824;
  t2375 = 0.2e2 / 0.9e1 * t2312 * t2290 + 0.12e3 * t2315 * t155 * t2316 + 0.9e2 * t902 * t357 * t863 - 0.132e3 * t906 * t907 * t818 + 0.112e3 / 0.9e1 * t2328 * t2290 + 0.18e2 * t2331 * t340 + 0.9e1 * t2334 * t340 + 0.12e2 * t2337 * t868 - 0.44e2 / 0.3e1 * t897 * t2293 + 0.154e3 / 0.9e1 * t353 * t2296 + 0.6e1 * t2316 * t148 + 0.3e1 * t339 * t2285 + 0.18e2 * t856 * t2348 + 0.6e1 * t356 * t155 * t2285 + 0.308e3 / 0.9e1 * t362 * t2296 - 0.33e2 * t890 * t871 + 0.18e3 * t2358 * t2359 * t315 + 0.36e2 * t906 * t2364 + 0.84e2 * t2367 * t2368 * t2369 - 0.154e3 / 0.3e1 * t916 * t2293;
  t2378 = -t170 * t2375 * t349 - 0.3e1 * t349 * t365 * t945 - 0.3e1 * t349 * t380 * t921 + 0.6e1 * t380 * t880 * t881 + t159 * t2253 + 0.6e1 * t170 * t2256 + 0.18e2 * t2259 * t841 + 0.9e1 * t2262 * t331 + 0.9e1 * t2265 * t331 + 0.3e1 * t2300 * t331 + t2252;
  t2379 = t2211 + t2378;
  t2384 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t2148 * t172 - 0.3e1 / 0.8e1 * t2093 - 0.9e1 / 0.8e1 * t6 * t807 * t382 + t2026 / 0.4e1 - 0.3e1 / 0.4e1 * t2100 - 0.9e1 / 0.8e1 * t6 * t308 * t947 - t1950 + t2037 / 0.4e1 - 0.3e1 / 0.8e1 * t2108 - 0.3e1 / 0.8e1 * t6 * t112 * t2379);
  tv3rho33 = 0.3e1 * t796 + 0.3e1 * t952 + t7 * (t2135 + t2384);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2392 = t6 * t539 * t432;
  t2399 = t6 * t548 * t432 / 0.12e2;
  t2401 = t6 * t191 * t1068;
  t2427 = t406 * t618;
  t2436 = t569 * t574;
  t2438 = t577 * t205 * t580;
  t2440 = 0.85e2 / 0.1594323e7 * t2436 * t2438;
  t2456 = t1694 * t96;
  t2457 = t420 * t229;
  t2458 = t2457 * t251;
  t2461 = 0.12e2 * t1005 * t229 * t584 - 0.6e1 * t1005 * t251 * t589 - 0.6e1 * t1014 * t229 * t589 + 0.4e1 * t1014 * t251 * t624 - 0.6e1 * t1043 * t229 * t589 + 0.4e1 * t1043 * t251 * t624 - 0.6e1 * t1045 * t251 * t589 + 0.6e1 * t1694 * t406 * t625 - 0.6e1 * t1712 * t421 * t625 - 0.6e1 * t1726 * t421 * t585 + 0.12e2 * t229 * t584 * t982 - 0.6e1 * t251 * t589 * t982 - 0.3e1 * t406 * t589 * t665 - 0.3e1 * t421 * t589 * t618 + 0.2e1 * t421 * t624 * t665 + 0.6e1 * t2427 * t584 + 0.12e2 * t2456 * t2458 + t2440;
  t2462 = t204 * t563;
  t2464 = 0.65e3 / 0.531441e6 * t2462 * t966;
  t2465 = t1726 * t96;
  t2466 = t405 * t229;
  t2467 = t2466 * t251;
  t2470 = t572 * t207;
  t2472 = 0.1e1 / t37 / t2470;
  t2475 = 0.14e3 / 0.1162261467e10 * t571 * t2472 * t1783;
  t2481 = t1066 * t229;
  t2484 = t430 * t618;
  t2487 = t266 * t1042;
  t2490 = t574 * t610;
  t2491 = t2490 * t205;
  t2492 = t1821 * t2491;
  t2494 = t402 * t606;
  t2497 = t1822 * t574;
  t2498 = t2497 * t205;
  t2502 = t646 * t413 * t606;
  t2504 = t563 * params->eta;
  t2505 = t2504 * sigma[0];
  t2506 = t609 * t2505;
  t2508 = t402 * t596;
  t2511 = t1001 * t222;
  t2514 = t610 * t563;
  t2515 = t2514 * sigma[0];
  t2519 = t1870 * t413 * t596;
  t2522 = t646 * t1032 * t222;
  t2527 = t210 * t222;
  t2529 = t1890 * t2527 * t62;
  t2531 = t222 * sigma[0];
  t2535 = t650 * t2505;
  t2537 = -t2492 / 0.2e1 - 0.9e1 / 0.8e1 * t609 * t2494 - 0.5e1 / 0.6e1 * t1867 * t2498 - 0.15e2 / 0.4e1 * t2502 + 0.27e2 / 0.8e1 * t2506 - 0.9e1 / 0.4e1 * t1806 * t2508 + 0.6e1 * t609 * t2511 + 0.9e1 / 0.2e1 * t641 * t2515 - 0.15e2 * t2519 + 0.2e2 * t2522 - 0.22e2 / 0.3e1 * t78 * t416 * t556 - 0.15e2 * t2529 - 0.21e2 * t1899 * t997 * t2531 + 0.27e2 / 0.2e1 * t2535;
  t2544 = t1821 * t610;
  t2545 = t2527 * sigma[0];
  t2548 = t1899 * t2491;
  t2554 = t1806 * t210;
  t2555 = t651 * sigma[0];
  t2556 = t2554 * t2555;
  t2559 = t599 * t197 * t222;
  t2561 = params->eta * t556;
  t2564 = t81 * t556;
  t2565 = t242 * t2564;
  t2567 = t39 * t606;
  t2568 = t599 * t2567;
  t2570 = t1803 * t39;
  t2572 = t225 * t556;
  t2574 = -0.45e2 / 0.2e1 * t1890 * t2508 + 0.24e2 * t650 * t2511 + 0.63e2 / 0.4e1 * t660 * t2515 - 0.3e1 * t2544 * t2545 - 0.7e1 / 0.2e1 * t2548 - 0.9e1 / 0.2e1 * t650 * t2494 - 0.14e2 / 0.3e1 * t1851 * t2498 - 0.3e1 / 0.2e1 * t2556 + 0.4e1 * t2559 - 0.11e2 / 0.3e1 * t239 * t2561 - 0.22e2 / 0.3e1 * t2565 - 0.3e1 / 0.4e1 * t2568 - 0.3e1 / 0.4e1 * t2570 - 0.11e2 / 0.3e1 * t2572;
  t2575 = t2537 + t2574;
  t2576 = t96 * t2575;
  t2578 = t606 * t67;
  t2579 = t2578 * t39;
  t2581 = t222 * t74;
  t2584 = t985 * t197;
  t2590 = t218 * t556;
  t2594 = t1806 * t610;
  t2606 = t2579 / 0.4e1 + t2581 * t989 / 0.3e1 - 0.4e1 / 0.3e1 * t2584 + t1806 * t2491 / 0.6e1 - 0.3e1 / 0.2e1 * t599 * t2505 + 0.22e2 / 0.9e1 * t2590 + t1803 * t402 / 0.2e1 + t2594 * t2545 - 0.8e1 / 0.3e1 * t599 * t2511 + t599 * t2494 / 0.2e1 + t1821 * t2498 / 0.3e1 - 0.9e1 / 0.4e1 * t609 * t2515 + 0.22e2 / 0.9e1 * t225 * t2561;
  t2607 = t96 * t2606;
  t2610 = t689 * t420;
  t2612 = t689 * t405;
  t2615 = t266 * t1004;
  t2624 = t677 * t205 * t580;
  t2627 = t574 * t1761;
  t2631 = t203 * t563;
  t2641 = 0.11e3 / 0.2187e4 * t34 * t556 * t49;
  t2642 = 0.11e3 / 0.2187e4 * t34 * t556 * t94 - 0.2e2 / 0.19683e5 * t2462 * t1054 + 0.4e2 / 0.1594323e7 * t2436 * t2624 - 0.112e3 / 0.4782969e7 * t1758 * t2627 * t205 + 0.2e1 / 0.2187e4 * t679 * t2631 * t1058 - 0.88e2 / 0.2187e4 * t260 * t33 * t556 * t41 - t2641 + t2464 - t2440 + t2475;
  t2644 = t430 * t625;
  t2647 = t430 * t585;
  t2650 = t585 * t84;
  t2653 = -0.2e1 * t1066 * t235 * t251 - t235 * t430 * t665 + 0.6e1 * t217 * t2481 + 0.3e1 * t217 * t2484 + 0.3e1 * t217 * t2607 + 0.3e1 * t217 * t2612 + 0.6e1 * t217 * t2615 - 0.2e1 * t235 * t2487 - t235 * t2576 - t235 * t2610 - 0.12e2 * t2465 * t2467 + t2642 * t85 + 0.2e1 * t2644 * t624 + 0.6e1 * t2647 * t584 + 0.6e1 * t2650 * t406 - t2464 - t2475 + t2641;
  t2654 = t2461 + t2653;
  t2659 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t432 - t2392 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t1068 + t2399 - t2401 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t2654);
  tv3rho2sigma0 = t2659 * t7 + 0.2e1 * t1073;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t2666 = t6 * t714 * t479;
  t2670 = t6 * t718 * t479 / 0.12e2;
  t2672 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t479 - t2666 / 0.4e1 + t2670);
  tv3rho2sigma2 = t2672 * t7 + 0.2e1 * t1082;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t2678 = t6 * t739 * t432;
  t2686 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t432 - t2678 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t1068 - t2392 / 0.8e1 + t2399 - t2401 / 0.8e1);
  tv3rho2sigma3 = t2686 * t7 + t1073 + t1088;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t2692 = t6 * t763 * t479;
  t2699 = t6 * t284 * t1200;
  t2702 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t479 - t2692 / 0.8e1 - t2666 / 0.8e1 + t2670 - 0.3e1 / 0.8e1 * t6 * t280 * t1200 - t2699 / 0.8e1);
  tv3rho2sigma5 = t2702 * t7 + t1082 + t1205;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t2710 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t432 - t2678 / 0.4e1 + t2399);
  tv3rho2sigma6 = t2710 * t7 + 0.2e1 * t1088;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t2721 = t453 * t874;
  t2769 = t569 * t833;
  t2771 = t836 * t319 * t580;
  t2773 = 0.85e2 / 0.1594323e7 * t2769 * t2771;
  t2774 = t2169 * t170;
  t2775 = t452 * t343;
  t2776 = t2775 * t365;
  t2779 = 0.12e2 * t1114 * t343 * t841 - 0.6e1 * t1114 * t365 * t846 + 0.12e2 * t1137 * t343 * t841 - 0.6e1 * t1137 * t365 * t846 - 0.6e1 * t1146 * t343 * t846 + 0.4e1 * t1146 * t365 * t880 - 0.6e1 * t1175 * t343 * t846 + 0.4e1 * t1175 * t365 * t880 - 0.6e1 * t1177 * t365 * t846 - 0.6e1 * t2169 * t468 * t842 - 0.6e1 * t2187 * t468 * t881 + 0.6e1 * t2195 * t453 * t881 - 0.3e1 * t453 * t846 * t921 - 0.3e1 * t468 * t846 * t874 + 0.2e1 * t468 * t880 * t921 + 0.6e1 * t2721 * t841 - 0.12e2 * t2774 * t2776 + t2773;
  t2780 = t2195 * t170;
  t2781 = t467 * t343;
  t2782 = t2781 * t365;
  t2785 = t204 * t824;
  t2787 = 0.65e3 / 0.531441e6 * t2785 * t1098;
  t2788 = t831 * t321;
  t2790 = 0.1e1 / t115 / t2788;
  t2793 = 0.14e3 / 0.1162261467e10 * t830 * t2790 * t2250;
  t2794 = t842 * t158;
  t2800 = t477 * t842;
  t2803 = t945 * t452;
  t2806 = t380 * t1136;
  t2809 = t863 * t141;
  t2810 = t2809 * t117;
  t2812 = t336 * t148;
  t2815 = t1117 * t314;
  t2817 = t833 * t610;
  t2818 = t2817 * t319;
  t2821 = t824 * params->eta;
  t2822 = t2821 * sigma[2];
  t2825 = t332 * t817;
  t2829 = t2273 * t610;
  t2830 = t324 * t336;
  t2831 = t2830 * sigma[2];
  t2833 = t1133 * t336;
  t2836 = t449 * t863;
  t2839 = t1822 * t833;
  t2840 = t2839 * t319;
  t2843 = t610 * t824;
  t2844 = t2843 * sigma[2];
  t2847 = params->eta * t817;
  t2850 = t2810 / 0.4e1 + t2812 * t1121 / 0.3e1 - 0.4e1 / 0.3e1 * t2815 + t2273 * t2818 / 0.6e1 - 0.3e1 / 0.2e1 * t856 * t2822 + 0.22e2 / 0.9e1 * t2825 + t2270 * t449 / 0.2e1 + t2829 * t2831 - 0.8e1 / 0.3e1 * t856 * t2833 + t856 * t2836 / 0.2e1 + t2288 * t2840 / 0.3e1 - 0.9e1 / 0.4e1 * t866 * t2844 + 0.22e2 / 0.9e1 * t339 * t2847;
  t2851 = t170 * t2850;
  t2854 = t477 * t874;
  t2860 = t477 * t921;
  t2865 = t2315 * t460 * t853;
  t2868 = t902 * t1164 * t336;
  t2873 = t866 * t2822;
  t2875 = t449 * t853;
  t2881 = t902 * t460 * t863;
  t2883 = t2288 * t2818;
  t2889 = t2367 * t2818;
  t2895 = 0.9e1 / 0.2e1 * t897 * t2844 - 0.15e2 * t2865 + 0.2e2 * t2868 - 0.22e2 / 0.3e1 * t152 * t463 * t817 + 0.27e2 / 0.8e1 * t2873 - 0.9e1 / 0.4e1 * t2273 * t2875 + 0.6e1 * t866 * t2833 - 0.15e2 / 0.4e1 * t2881 - t2883 / 0.2e1 - 0.9e1 / 0.8e1 * t866 * t2836 - 0.5e1 / 0.6e1 * t2312 * t2840 - 0.7e1 / 0.2e1 * t2889 - 0.9e1 / 0.2e1 * t906 * t2836 - 0.14e2 / 0.3e1 * t2328 * t2840;
  t2896 = t2273 * t324;
  t2897 = t907 * sigma[2];
  t2898 = t2896 * t2897;
  t2900 = t2288 * t610;
  t2905 = t906 * t2822;
  t2912 = t2358 * t2830 * t136;
  t2914 = t336 * sigma[2];
  t2920 = t155 * t817;
  t2921 = t356 * t2920;
  t2924 = t856 * t314 * t336;
  t2926 = t117 * t863;
  t2927 = t856 * t2926;
  t2929 = t2270 * t117;
  t2931 = t339 * t817;
  t2933 = -0.3e1 / 0.2e1 * t2898 - 0.3e1 * t2900 * t2831 + 0.63e2 / 0.4e1 * t916 * t2844 + 0.27e2 / 0.2e1 * t2905 - 0.45e2 / 0.2e1 * t2358 * t2875 + 0.24e2 * t906 * t2833 - 0.15e2 * t2912 - 0.21e2 * t2367 * t1129 * t2914 - 0.11e2 / 0.3e1 * t353 * t2847 - 0.22e2 / 0.3e1 * t2921 + 0.4e1 * t2924 - 0.3e1 / 0.4e1 * t2927 - 0.3e1 / 0.4e1 * t2929 - 0.11e2 / 0.3e1 * t2931;
  t2934 = t2895 + t2933;
  t2935 = t170 * t2934;
  t2937 = t1198 * t343;
  t2940 = t945 * t467;
  t2942 = t380 * t1174;
  t2947 = 0.11e3 / 0.2187e4 * t34 * t817 * t126;
  t2954 = t933 * t319 * t580;
  t2957 = t833 * t1761;
  t2961 = t203 * t824;
  t2969 = 0.11e3 / 0.2187e4 * t34 * t817 * t168 - 0.2e2 / 0.19683e5 * t2785 * t1186 + 0.4e2 / 0.1594323e7 * t2769 * t2954 - 0.112e3 / 0.4782969e7 * t2227 * t2957 * t319 + 0.2e1 / 0.2187e4 * t935 * t2961 * t1190 - 0.88e2 / 0.2187e4 * t374 * t33 * t817 * t41 - t2947 + t2787 - t2773 + t2793;
  t2971 = -0.2e1 * t1198 * t349 * t365 + 0.2e1 * t477 * t880 * t881 + t159 * t2969 + 0.12e2 * t2780 * t2782 + 0.6e1 * t2794 * t453 + 0.6e1 * t2800 * t841 + 0.3e1 * t2803 * t331 + 0.6e1 * t2806 * t331 + 0.3e1 * t2851 * t331 + 0.3e1 * t2854 * t331 - t2860 * t349 - t2935 * t349 + 0.6e1 * t2937 * t331 - t2940 * t349 - 0.2e1 * t2942 * t349 - t2787 - t2793 + t2947;
  t2972 = t2779 + t2971;
  t2977 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t479 - t2692 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t1200 + t2670 - t2699 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * t2972);
  tv3rho2sigma8 = t2977 * t7 + 0.2e1 * t1205;

  if(out->v3rho2sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rho2lapl0 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 0] += tv3rho2lapl0;

  tv3rho2lapl1 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 1] += tv3rho2lapl1;

  tv3rho2lapl2 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 2] += tv3rho2lapl2;

  tv3rho2lapl3 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 3] += tv3rho2lapl3;

  tv3rho2lapl4 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 4] += tv3rho2lapl4;

  tv3rho2lapl5 = 0.e0;

  if(out->v3rho2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2lapl[ip*p->dim.v3rho2lapl + 5] += tv3rho2lapl5;

  t2984 = t6 * t539 * t496;
  t2991 = t6 * t548 * t496 / 0.12e2;
  t2993 = t6 * t191 * t1262;
  t2995 = t689 * t493;
  t2997 = t584 * t1229;
  t2998 = t229 * params->eta;
  t2999 = t2998 * sigma[0];
  t3000 = t1231 * t2999;
  t3003 = t589 * t1229;
  t3004 = t251 * params->eta;
  t3005 = t3004 * sigma[0];
  t3006 = t1231 * t3005;
  t3033 = t589 * t266;
  t3036 = t985 * t1219;
  t3039 = t54 * t665;
  t3040 = t218 * t3039;
  t3043 = t39 * t229;
  t3044 = t218 * t3043;
  t3047 = t54 * t625;
  t3048 = t218 * t3047;
  t3051 = t39 * t251;
  t3052 = t218 * t3051;
  t3055 = -0.6e1 * t1243 * t229 * t589 + 0.4e1 * t1243 * t251 * t624 - 0.6e1 * t1260 * t229 * t589 + 0.4e1 * t1260 * t251 * t624 - 0.6e1 * t1712 * t494 * t625 - 0.6e1 * t1726 * t494 * t585 - 0.3e1 * t494 * t589 * t618 + 0.2e1 * t494 * t624 * t665 + 0.4e2 * t1213 * t3044 + 0.12e2 * t1218 * t3036 + 0.6e1 * t1218 * t3040 - 0.2e2 * t1218 * t3052 + 0.12e2 * t1220 * t3033 - t235 * t2995 - 0.12e2 * t2456 * t3048 - 0.16e2 * t2997 * t3000 + 0.8e1 * t3003 * t3006;
  t3056 = t584 * t266;
  t3059 = t985 * t1214;
  t3062 = t54 * t618;
  t3063 = t218 * t3062;
  t3072 = t2650 * t96;
  t3075 = t217 * t689;
  t3080 = t2578 * t54;
  t3083 = t493 * t229;
  t3084 = t3083 * t251;
  t3087 = t1726 * t1229;
  t3088 = t67 * t54;
  t3089 = t229 * t251;
  t3090 = t3088 * t3089;
  t3093 = t266 * t57;
  t3094 = t217 * t3093;
  t3097 = t96 * t222;
  t3098 = t217 * t3097;
  t3101 = t238 * t971;
  t3102 = t3101 * t611;
  t3105 = t74 * t210;
  t3106 = t3105 * t62;
  t3109 = t266 * t1259;
  t3114 = t1806 * t396;
  t3118 = t54 * t606;
  t3121 = t971 * t610;
  t3122 = t3121 * t205;
  t3142 = 0.6e1 * t1803 * t54 + 0.12e2 * t3114 * t2555 - 0.2e2 * t1017 + 0.6e1 * t599 * t3118 + 0.4e1 * t1821 * t3122 - 0.21e2 * t1019 + 0.4e2 / 0.3e1 * t1021 + 0.12e3 * t1870 * t490 * t596 + 0.12e3 * t1890 * t396 * t222 * t62 - 0.1e3 * t1028 + 0.3e2 * t646 * t490 * t606 + 0.28e2 * t1899 * t3122 - 0.84e2 * t1030 + 0.8e2 / 0.3e1 * t1033;
  t3143 = t96 * t3142;
  t3145 = -0.24e2 * t3056 * t1215 - 0.24e2 * t1213 * t3059 - 0.12e2 * t1213 * t3063 + 0.2e2 * t1223 * t401 + 0.2e2 * t484 * t986 - 0.8e2 / 0.3e1 * t484 * t992 - 0.12e2 * t3072 * t485 - 0.6e1 * t3075 * t485 - 0.12e2 * t1223 * t1226 - 0.6e1 * t484 * t3080 + 0.12e2 * t2456 * t3084 + 0.24e2 * t3087 * t3090 - 0.8e1 * t3094 * t1232 - 0.8e1 * t3098 * t1232 - 0.4e1 * t1230 * t3102 + 0.28e2 * t1230 * t3106 - 0.2e1 * t235 * t3109 - t235 * t3143;
  t3146 = t3055 + t3145;
  t3151 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t496 - t2984 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t1262 + t2991 - t2993 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t3146);
  tv3rho2tau0 = t3151 * t7 + 0.2e1 * t1267;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 0] += tv3rho2tau0;

  t3158 = t6 * t714 * t513;
  t3162 = t6 * t718 * t513 / 0.12e2;
  t3164 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t513 - t3158 / 0.4e1 + t3162);
  tv3rho2tau1 = t3164 * t7 + 0.2e1 * t1276;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 1] += tv3rho2tau1;

  t3170 = t6 * t739 * t496;
  t3178 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t496 - t3170 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t1262 - t2984 / 0.8e1 + t2991 - t2993 / 0.8e1);
  tv3rho2tau2 = t3178 * t7 + t1267 + t1282;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 2] += tv3rho2tau2;

  t3184 = t6 * t763 * t513;
  t3191 = t6 * t284 * t1336;
  t3194 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t513 - t3184 / 0.8e1 - t3158 / 0.8e1 + t3162 - 0.3e1 / 0.8e1 * t6 * t280 * t1336 - t3191 / 0.8e1);
  tv3rho2tau3 = t3194 * t7 + t1276 + t1341;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 3] += tv3rho2tau3;

  t3202 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t496 - t3170 / 0.4e1 + t2991);
  tv3rho2tau4 = t3202 * t7 + 0.2e1 * t1282;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 4] += tv3rho2tau4;

  t3237 = t841 * t1303;
  t3238 = t343 * params->eta;
  t3239 = t3238 * sigma[2];
  t3240 = t1305 * t3239;
  t3243 = t846 * t1303;
  t3244 = t365 * params->eta;
  t3245 = t3244 * sigma[2];
  t3246 = t1305 * t3245;
  t3251 = t2809 * t131;
  t3260 = t2794 * t170;
  t3263 = t510 * t343;
  t3264 = t3263 * t365;
  t3267 = -0.6e1 * t2169 * t511 * t842 - 0.6e1 * t2187 * t511 * t881 + 0.4e1 * t880 * t1334 * t365 + 0.2e1 * t880 * t511 * t921 - 0.6e1 * t846 * t1317 * t343 - 0.6e1 * t846 * t1334 * t343 - 0.3e1 * t846 * t511 * t874 + 0.4e1 * t880 * t1317 * t365 - 0.16e2 * t3237 * t3240 + 0.8e1 * t3243 * t3246 - 0.12e2 * t1297 * t1300 - 0.6e1 * t501 * t3251 + 0.2e2 * t1297 * t448 + 0.2e2 * t501 * t1118 - 0.8e2 / 0.3e1 * t501 * t1124 - 0.12e2 * t3260 * t502 + 0.12e2 * t2780 * t3264;
  t3268 = t331 * t945;
  t3271 = t131 * t921;
  t3272 = t332 * t3271;
  t3275 = t117 * t343;
  t3276 = t332 * t3275;
  t3279 = t131 * t881;
  t3280 = t332 * t3279;
  t3283 = t117 * t365;
  t3284 = t332 * t3283;
  t3287 = t841 * t380;
  t3290 = t1117 * t1288;
  t3293 = t131 * t874;
  t3294 = t332 * t3293;
  t3297 = t846 * t380;
  t3300 = t1117 * t1293;
  t3303 = t148 * t324;
  t3304 = t3303 * t136;
  t3307 = t380 * t134;
  t3308 = t331 * t3307;
  t3311 = t170 * t336;
  t3312 = t331 * t3311;
  t3315 = t352 * t1103;
  t3316 = t3315 * t867;
  t3319 = t2169 * t1303;
  t3320 = t141 * t131;
  t3321 = t343 * t365;
  t3322 = t3320 * t3321;
  t3325 = t380 * t1333;
  t3330 = t2273 * t443;
  t3334 = t131 * t863;
  t3337 = t1103 * t610;
  t3338 = t3337 * t319;
  t3358 = 0.6e1 * t2270 * t131 + 0.12e2 * t3330 * t2897 - 0.2e2 * t1149 + 0.6e1 * t856 * t3334 + 0.4e1 * t2288 * t3338 - 0.21e2 * t1151 + 0.4e2 / 0.3e1 * t1153 + 0.12e3 * t2315 * t507 * t853 + 0.12e3 * t2358 * t443 * t336 * t136 - 0.1e3 * t1160 + 0.3e2 * t902 * t507 * t863 + 0.28e2 * t2367 * t3338 - 0.84e2 * t1162 + 0.8e2 / 0.3e1 * t1165;
  t3359 = t170 * t3358;
  t3361 = t945 * t510;
  t3363 = 0.4e2 * t1287 * t3276 - 0.24e2 * t1287 * t3290 - 0.12e2 * t1287 * t3294 - 0.24e2 * t1289 * t3287 + 0.6e1 * t1292 * t3272 - 0.2e2 * t1292 * t3284 + 0.12e2 * t1292 * t3300 + 0.12e2 * t1294 * t3297 + 0.28e2 * t1304 * t3304 - 0.4e1 * t1304 * t3316 - 0.8e1 * t1306 * t3308 - 0.8e1 * t1306 * t3312 - 0.12e2 * t2780 * t3280 - 0.6e1 * t3268 * t502 + 0.24e2 * t3319 * t3322 - 0.2e1 * t3325 * t349 - t3359 * t349 - t3361 * t349;
  t3364 = t3267 + t3363;
  t3369 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t513 - t3184 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t1336 + t3162 - t3191 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * t3364);
  tv3rho2tau5 = t3369 * t7 + 0.2e1 * t1341;

  if(out->v3rho2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2tau[ip*p->dim.v3rho2tau + 5] += tv3rho2tau5;

  t3376 = t6 * t191 * t1409 / 0.8e1;
  t3377 = t405 * t420;
  t3378 = t3377 * t229;
  t3381 = t3377 * t251;
  t3385 = 0.1e1 / t37 / t1720;
  t3388 = 0.35e2 / 0.774840978e9 * t969 * t3385 * t1783;
  t3391 = t971 * t74;
  t3392 = t3391 * t62;
  t3394 = t2581 * t1248;
  t3396 = t3121 * sigma[0];
  t3399 = t599 * t988;
  t3401 = t1365 * t222;
  t3404 = t1822 * t971;
  t3405 = t3404 * sigma[0];
  t3410 = t210 * t67 / 0.6e1 - t3392 / 0.48e2 - t3394 / 0.8e1 - t1806 * t3396 / 0.8e1 + 0.2e1 / 0.3e1 * t3399 - 0.3e1 / 0.16e2 * t1806 * t3401 - t1821 * t3405 / 0.8e1 + t609 * t997 / 0.2e1;
  t3411 = t96 * t3410;
  t3414 = t1066 * t405;
  t3417 = t430 * t1004;
  t3420 = t266 * t1368;
  t3423 = t2581 * t396;
  t3425 = t971 * params->eta;
  t3426 = t3425 * sigma[0];
  t3427 = t1806 * t3426;
  t3429 = t599 * t210;
  t3431 = t1248 * t222;
  t3432 = t1806 * t3431;
  t3434 = t1821 * t3396;
  t3436 = t609 * t988;
  t3444 = t1870 * t1385 * t222;
  t3446 = t1890 * t3426;
  t3448 = t81 * t210;
  t3449 = t646 * t3448;
  t3451 = t1890 * t3431;
  t3453 = t1899 * t3396;
  t3457 = t242 * t247 * t210 * params->eta;
  t3466 = 0.3e1 / 0.32e2 * t3423 + 0.3e1 / 0.32e2 * t3427 - t3429 / 0.2e1 + 0.9e1 / 0.16e2 * t3432 + 0.3e1 / 0.8e1 * t3434 - 0.3e1 / 0.2e1 * t3436 + 0.9e1 / 0.16e2 * t1821 * t3401 + 0.5e1 / 0.16e2 * t1867 * t3405 - t641 * t997 + 0.15e2 / 0.8e1 * t3444 + 0.15e2 / 0.16e2 * t3446 - 0.5e1 / 0.2e1 * t3449 + 0.45e2 / 0.8e1 * t3451 + 0.21e2 / 0.8e1 * t3453 - 0.6e1 * t3457 + 0.63e2 / 0.16e2 * t1899 * t3401 + 0.7e1 / 0.4e1 * t1851 * t3405 - 0.7e1 / 0.2e1 * t78 * t1392 * t210;
  t3467 = t96 * t3466;
  t3469 = t1407 * t229;
  t3474 = t229 * t84;
  t3477 = t266 * t1351;
  t3480 = t430 * t1042;
  t3483 = t266 * t1396;
  t3485 = t266 * t1372;
  t3488 = t1066 * t420;
  t3495 = t569 * t971;
  t3496 = t677 * t580;
  t3497 = t3496 * sigma[0];
  t3508 = 0.4e2 / 0.177147e6 * t204 * t214;
  t3509 = t577 * t580;
  t3510 = t3509 * sigma[0];
  t3512 = 0.25e2 / 0.1594323e7 * t3495 * t3510;
  t3513 = 0.4e2 / 0.177147e6 * t204 * t210 * t258 * t41 - 0.5e1 / 0.531441e6 * t3495 * t3497 + 0.14e2 / 0.1594323e7 * t1758 * t971 * t1761 * sigma[0] - 0.4e1 / 0.19683e5 * t679 * t1057 * t580 - t3508 + t3512 - t3388;
  t3515 = -t1407 * t235 * t251 + 0.6e1 * t1352 * t3474 + 0.3e1 * t217 * t3411 + 0.6e1 * t217 * t3414 + 0.6e1 * t217 * t3417 + 0.3e1 * t217 * t3420 + 0.3e1 * t217 * t3469 - t235 * t3467 - 0.2e1 * t235 * t3480 - t235 * t3483 - 0.2e1 * t235 * t3488 + 0.12e2 * t2456 * t3381 - 0.12e2 * t2465 * t3378 + 0.6e1 * t3477 * t584 + 0.2e1 * t3485 * t624 + t3513 * t85 + t3388;
  t3537 = t406 * t1004;
  t3540 = t1352 * t251;
  t3564 = -0.6e1 * t1005 * t420 * t589 - 0.6e1 * t1042 * t406 * t589 + 0.4e1 * t1042 * t421 * t624 + 0.12e2 * t1358 * t229 * t584 - 0.6e1 * t1358 * t251 * t589 + 0.6e1 * t1369 * t229 * t584 - 0.3e1 * t1369 * t251 * t589 + 0.6e1 * t1373 * t1694 * t229 - 0.6e1 * t1373 * t1712 * t251 - 0.6e1 * t1376 * t229 * t589 + 0.4e1 * t1376 * t251 * t624 - 0.3e1 * t1397 * t229 * t589 + 0.2e1 * t1397 * t251 * t624 - 0.6e1 * t420 * t589 * t982 - 0.6e1 * t1726 * t3540 + 0.12e2 * t3537 * t584 + t3508 - t3512;
  t3565 = t3515 + t3564;
  t3570 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t1409 - t3376 - 0.3e1 / 0.8e1 * t6 * t28 * t3565);
  tv3rhosigma20 = t3570 * t7 + t1413;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t3577 = t6 * t284 * t1480 / 0.8e1;
  t3579 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t1480 - t3577);
  tv3rhosigma25 = t3579 * t7 + t1484;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t3585 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t1409 - t3376);
  tv3rhosigma26 = t3585 * t7 + t1413;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t3590 = t452 * t467;
  t3591 = t3590 * t343;
  t3594 = t3590 * t365;
  t3598 = 0.1e1 / t115 / t2163;
  t3601 = 0.35e2 / 0.774840978e9 * t1101 * t3598 * t2250;
  t3605 = t569 * t1103;
  t3606 = t836 * t580;
  t3607 = t3606 * sigma[2];
  t3609 = 0.25e2 / 0.1594323e7 * t3605 * t3607;
  t3611 = 0.4e2 / 0.177147e6 * t204 * t328;
  t3645 = -0.6e1 * t1114 * t467 * t846 + 0.4e1 * t1174 * t468 * t880 + 0.12e2 * t1429 * t343 * t841 - 0.6e1 * t1429 * t365 * t846 + 0.6e1 * t1440 * t343 * t841 - 0.3e1 * t1440 * t365 * t846 - 0.6e1 * t1444 * t2187 * t365 + 0.6e1 * t1444 * t2195 * t343 - 0.6e1 * t1447 * t343 * t846 + 0.4e1 * t1447 * t365 * t880 - 0.3e1 * t1468 * t343 * t846 + 0.2e1 * t1468 * t365 * t880 - 0.12e2 * t2774 * t3591 + 0.12e2 * t2780 * t3594 + t3601 - t3609 + t3611;
  t3652 = t1423 * t365;
  t3655 = t453 * t1136;
  t3658 = t1478 * t343;
  t3663 = t343 * t158;
  t3666 = t380 * t1422;
  t3669 = t1198 * t452;
  t3672 = t477 * t1136;
  t3675 = t380 * t1439;
  t3680 = t1103 * t148;
  t3681 = t3680 * t136;
  t3683 = t2812 * t1322;
  t3685 = t3337 * sigma[2];
  t3688 = t856 * t1120;
  t3690 = t1436 * t336;
  t3693 = t1822 * t1103;
  t3694 = t3693 * sigma[2];
  t3699 = t324 * t141 / 0.6e1 - t3681 / 0.48e2 - t3683 / 0.8e1 - t2273 * t3685 / 0.8e1 + 0.2e1 / 0.3e1 * t3688 - 0.3e1 / 0.16e2 * t2273 * t3690 - t2288 * t3694 / 0.8e1 + t866 * t1129 / 0.2e1;
  t3700 = t170 * t3699;
  t3703 = t380 * t1443;
  t3706 = t1198 * t467;
  t3709 = t477 * t1174;
  t3712 = t380 * t1467;
  t3714 = t2812 * t443;
  t3716 = t1103 * params->eta;
  t3717 = t3716 * sigma[2];
  t3718 = t2273 * t3717;
  t3720 = t856 * t324;
  t3722 = t1322 * t336;
  t3723 = t2273 * t3722;
  t3725 = t2288 * t3685;
  t3727 = t866 * t1120;
  t3735 = t2315 * t1456 * t336;
  t3737 = t2358 * t3717;
  t3739 = t155 * t324;
  t3740 = t902 * t3739;
  t3742 = t2358 * t3722;
  t3744 = t2367 * t3685;
  t3748 = t356 * t361 * t324 * params->eta;
  t3757 = 0.3e1 / 0.32e2 * t3714 + 0.3e1 / 0.32e2 * t3718 - t3720 / 0.2e1 + 0.9e1 / 0.16e2 * t3723 + 0.3e1 / 0.8e1 * t3725 - 0.3e1 / 0.2e1 * t3727 + 0.9e1 / 0.16e2 * t2288 * t3690 + 0.5e1 / 0.16e2 * t2312 * t3694 - t897 * t1129 + 0.15e2 / 0.8e1 * t3735 + 0.15e2 / 0.16e2 * t3737 - 0.5e1 / 0.2e1 * t3740 + 0.45e2 / 0.8e1 * t3742 + 0.21e2 / 0.8e1 * t3744 - 0.6e1 * t3748 + 0.63e2 / 0.16e2 * t2367 * t3690 + 0.7e1 / 0.4e1 * t2328 * t3694 - 0.7e1 / 0.2e1 * t152 * t1463 * t324;
  t3758 = t170 * t3757;
  t3764 = t933 * t580;
  t3765 = t3764 * sigma[2];
  t3775 = 0.4e2 / 0.177147e6 * t204 * t324 * t372 * t41 - 0.5e1 / 0.531441e6 * t3605 * t3765 + 0.14e2 / 0.1594323e7 * t2227 * t1103 * t1761 * sigma[2] - 0.4e1 / 0.19683e5 * t935 * t1189 * t580 - t3611 + t3609 - t3601;
  t3777 = -0.6e1 * t1137 * t467 * t846 - 0.6e1 * t1174 * t453 * t846 - t1478 * t349 * t365 + 0.6e1 * t1423 * t3663 + t159 * t3775 - 0.6e1 * t2169 * t3652 + 0.3e1 * t331 * t3658 + 0.6e1 * t331 * t3669 + 0.6e1 * t331 * t3672 + 0.3e1 * t331 * t3675 + 0.3e1 * t331 * t3700 - 0.2e1 * t349 * t3706 - 0.2e1 * t349 * t3709 - t349 * t3712 - t349 * t3758 + 0.12e2 * t3655 * t841 + 0.6e1 * t3666 * t841 + 0.2e1 * t3703 * t880;
  t3778 = t3645 + t3777;
  t3783 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t1480 - t3577 - 0.3e1 / 0.8e1 * t6 * t112 * t3778);
  tv3rhosigma211 = t3783 * t7 + t1484;

  if(out->v3rhosigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  tv3rhosigmalapl0 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 0] += tv3rhosigmalapl0;

  tv3rhosigmalapl1 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 1] += tv3rhosigmalapl1;

  tv3rhosigmalapl2 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 2] += tv3rhosigmalapl2;

  tv3rhosigmalapl3 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 3] += tv3rhosigmalapl3;

  tv3rhosigmalapl4 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 4] += tv3rhosigmalapl4;

  tv3rhosigmalapl5 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 5] += tv3rhosigmalapl5;

  tv3rhosigmalapl6 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 6] += tv3rhosigmalapl6;

  tv3rhosigmalapl7 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 7] += tv3rhosigmalapl7;

  tv3rhosigmalapl8 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 8] += tv3rhosigmalapl8;

  tv3rhosigmalapl9 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 9] += tv3rhosigmalapl9;

  tv3rhosigmalapl10 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 10] += tv3rhosigmalapl10;

  tv3rhosigmalapl11 = 0.e0;

  if(out->v3rhosigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmalapl[ip*p->dim.v3rhosigmalapl + 11] += tv3rhosigmalapl11;

  t3790 = t6 * t191 * t1528 / 0.8e1;
  t3793 = t589 * t430;
  t3796 = t1346 * t74;
  t3797 = t3796 * t62;
  t3798 = t484 * t3797;
  t3800 = t39 * t405;
  t3801 = t218 * t3800;
  t3804 = t39 * t420;
  t3805 = t218 * t3804;
  t3810 = t985 * t1485;
  t3813 = t54 * t1004;
  t3814 = t218 * t3813;
  t3819 = t985 * t1489;
  t3822 = t54 * t1042;
  t3823 = t218 * t3822;
  t3826 = t584 * t430;
  t3829 = -0.13e2 / 0.2e1 * t484 * t1363 + 0.6e1 * t3793 * t1220 + t3798 / 0.2e1 + 0.2e2 * t1213 * t3801 - 0.1e2 * t1218 * t3805 - 0.12e2 * t3056 * t1486 - 0.12e2 * t1213 * t3810 - 0.12e2 * t1213 * t3814 + 0.6e1 * t3033 * t1490 + 0.6e1 * t1218 * t3819 + 0.6e1 * t1218 * t3823 - 0.12e2 * t3826 * t1215;
  t3832 = t2581 * t1502;
  t3835 = t3474 * t96;
  t3838 = t405 * params->eta;
  t3839 = t3838 * sigma[0];
  t3840 = t1231 * t3839;
  t3843 = t420 * params->eta;
  t3844 = t3843 * sigma[0];
  t3845 = t1231 * t3844;
  t3848 = t405 * t251;
  t3849 = t3088 * t3848;
  t3852 = t3088 * t2457;
  t3855 = t1694 * t1229;
  t3856 = t420 * t251;
  t3857 = t3088 * t3856;
  t3860 = t430 * t57;
  t3861 = t217 * t3860;
  t3864 = t74 * t1497;
  t3865 = t3864 * t2998;
  t3868 = t3864 * t3004;
  t3871 = t238 * t1346;
  t3872 = t610 * sigma[0];
  t3873 = t3871 * t3872;
  t3876 = 0.3e1 / 0.2e1 * t1223 * t1503 + 0.3e1 / 0.2e1 * t484 * t3832 - 0.12e2 * t3835 * t1486 - 0.8e1 * t2997 * t3840 + 0.4e1 * t3003 * t3845 + 0.12e2 * t3087 * t3849 + 0.12e2 * t3087 * t3852 - 0.12e2 * t3855 * t3857 - 0.4e1 * t3861 * t1232 + 0.3e1 * t2997 * t3865 - 0.3e1 / 0.2e1 * t3003 * t3868 + 0.3e1 / 0.2e1 * t1230 * t3873;
  t3880 = t217 * t96 * t396 * t67;
  t3911 = t217 * t266 * t1497 * t67;
  t3916 = -0.13e2 / 0.4e1 * t3880 + 0.2e1 * t624 * t1512 * t251 - 0.3e1 * t589 * t1526 * t229 + 0.2e1 * t624 * t1526 * t251 + 0.2e1 * t624 * t1260 * t420 + 0.2e1 * t624 * t494 * t1042 - 0.3e1 * t589 * t1512 * t229 - 0.3e1 * t589 * t1260 * t405 - 0.3e1 * t589 * t494 * t1004 + 0.2e1 * t624 * t1243 * t420 + 0.3e1 / 0.4e1 * t3911 - 0.3e1 * t589 * t1243 * t405;
  t3917 = t1066 * t493;
  t3919 = t266 * t1525;
  t3921 = t2581 * t1497;
  t3923 = t1346 * params->eta;
  t3924 = t3923 * sigma[0];
  t3925 = t1806 * t3924;
  t3928 = t1502 * t222;
  t3931 = t1346 * t610;
  t3932 = t3931 * sigma[0];
  t3937 = t1870 * t1518 * t222;
  t3939 = t1890 * t3924;
  t3947 = -0.3e1 / 0.4e1 * t3921 - 0.3e1 / 0.4e1 * t3925 + 0.13e2 / 0.4e1 * t1379 - 0.9e1 / 0.4e1 * t1806 * t3928 - 0.3e1 / 0.2e1 * t1821 * t3932 + 0.39e2 / 0.8e1 * t1381 - 0.15e2 * t3937 - 0.15e2 / 0.2e1 * t3939 + 0.65e2 / 0.4e1 * t1386 - 0.45e2 / 0.2e1 * t1890 * t3928 - 0.21e2 / 0.2e1 * t1899 * t3932 + 0.39e2 / 0.2e1 * t1390;
  t3948 = t96 * t3947;
  t3950 = t430 * t1259;
  t3954 = t1497 * t67;
  t3955 = t3954 * t229;
  t3956 = t1213 * t3955;
  t3958 = t3954 * t251;
  t3959 = t1218 * t3958;
  t3961 = t493 * t405;
  t3962 = t3961 * t229;
  t3965 = t3961 * t251;
  t3968 = t493 * t420;
  t3969 = t3968 * t229;
  t3972 = t1712 * t96;
  t3973 = t3968 * t251;
  t3976 = t217 * t1066;
  t3981 = -t235 * t3917 - t235 * t3919 - t235 * t3948 - t235 * t3950 + 0.1e2 * t1493 * t401 + 0.3e1 / 0.2e1 * t3956 - 0.3e1 / 0.4e1 * t3959 - 0.6e1 * t2465 * t3962 + 0.6e1 * t2456 * t3965 + 0.6e1 * t2456 * t3969 - 0.6e1 * t3972 * t3973 - 0.6e1 * t3976 * t485 - 0.6e1 * t1493 * t1226;
  t3983 = t3829 + t3876 + t3916 + t3981;
  t3988 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t1528 - t3790 - 0.3e1 / 0.8e1 * t6 * t28 * t3983);
  tv3rhosigmatau0 = t3988 * t7 + t1532;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 0] += tv3rhosigmatau0;

  tv3rhosigmatau1 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 1] += tv3rhosigmatau1;

  tv3rhosigmatau2 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 2] += tv3rhosigmatau2;

  tv3rhosigmatau3 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 3] += tv3rhosigmatau3;

  tv3rhosigmatau4 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 4] += tv3rhosigmatau4;

  t3995 = t6 * t284 * t1576 / 0.8e1;
  t3997 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t1576 - t3995);
  tv3rhosigmatau5 = t3997 * t7 + t1580;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 5] += tv3rhosigmatau5;

  t4003 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t1528 - t3790);
  tv3rhosigmatau6 = t4003 * t7 + t1532;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 6] += tv3rhosigmatau6;

  tv3rhosigmatau7 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 7] += tv3rhosigmatau7;

  tv3rhosigmatau8 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 8] += tv3rhosigmatau8;

  tv3rhosigmatau9 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 9] += tv3rhosigmatau9;

  tv3rhosigmatau10 = 0.e0;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 10] += tv3rhosigmatau10;

  t4008 = t452 * params->eta;
  t4009 = t4008 * sigma[2];
  t4010 = t1305 * t4009;
  t4013 = t467 * params->eta;
  t4014 = t4013 * sigma[2];
  t4015 = t1305 * t4014;
  t4018 = t452 * t365;
  t4019 = t3320 * t4018;
  t4022 = t3320 * t2781;
  t4025 = t2195 * t1303;
  t4026 = t467 * t365;
  t4027 = t3320 * t4026;
  t4030 = t477 * t134;
  t4031 = t331 * t4030;
  t4034 = t148 * t1545;
  t4035 = t4034 * t3238;
  t4038 = t4034 * t3244;
  t4041 = t352 * t1417;
  t4042 = t610 * sigma[2];
  t4043 = t4041 * t4042;
  t4046 = t2812 * t1545;
  t4048 = t1417 * params->eta;
  t4049 = t4048 * sigma[2];
  t4050 = t2273 * t4049;
  t4053 = t1550 * t336;
  t4056 = t1417 * t610;
  t4057 = t4056 * sigma[2];
  t4062 = t2315 * t1566 * t336;
  t4064 = t2358 * t4049;
  t4072 = -0.3e1 / 0.4e1 * t4046 - 0.3e1 / 0.4e1 * t4050 + 0.13e2 / 0.4e1 * t1450 - 0.9e1 / 0.4e1 * t2273 * t4053 - 0.3e1 / 0.2e1 * t2288 * t4057 + 0.39e2 / 0.8e1 * t1452 - 0.15e2 * t4062 - 0.15e2 / 0.2e1 * t4064 + 0.65e2 / 0.4e1 * t1457 - 0.45e2 / 0.2e1 * t2358 * t4053 - 0.21e2 / 0.2e1 * t2367 * t4057 + 0.39e2 / 0.2e1 * t1461;
  t4073 = t170 * t4072;
  t4075 = t1198 * t510;
  t4077 = t477 * t1333;
  t4079 = -0.8e1 * t3237 * t4010 + 0.4e1 * t3243 * t4015 + 0.12e2 * t3319 * t4019 + 0.12e2 * t3319 * t4022 - 0.12e2 * t4025 * t4027 - 0.4e1 * t4031 * t1306 + 0.3e1 * t3237 * t4035 - 0.3e1 / 0.2e1 * t3243 * t4038 + 0.3e1 / 0.2e1 * t1304 * t4043 - t349 * t4073 - t349 * t4075 - t349 * t4077;
  t4080 = t380 * t1573;
  t4084 = t331 * t170 * t443 * t141;
  t4109 = t331 * t380 * t1545 * t141;
  t4117 = -t349 * t4080 - 0.13e2 / 0.4e1 * t4084 + 0.2e1 * t880 * t1560 * t365 - 0.3e1 * t846 * t1574 * t343 + 0.2e1 * t880 * t1574 * t365 + 0.2e1 * t880 * t1317 * t467 + 0.2e1 * t880 * t1334 * t467 + 0.2e1 * t880 * t511 * t1174 - 0.3e1 * t846 * t1560 * t343 + 0.3e1 / 0.4e1 * t4109 - 0.3e1 * t846 * t1317 * t452 - 0.3e1 * t846 * t1334 * t452;
  t4126 = t1545 * t141;
  t4127 = t4126 * t365;
  t4128 = t1292 * t4127;
  t4130 = t510 * t452;
  t4131 = t4130 * t343;
  t4134 = t4130 * t365;
  t4137 = t510 * t467;
  t4138 = t4137 * t343;
  t4141 = t2187 * t170;
  t4142 = t4137 * t365;
  t4145 = t331 * t1198;
  t4148 = t4126 * t343;
  t4149 = t1287 * t4148;
  t4151 = t117 * t467;
  t4152 = t332 * t4151;
  t4157 = -0.3e1 * t846 * t511 * t1136 + 0.1e2 * t1541 * t448 - 0.6e1 * t1541 * t1300 - 0.3e1 / 0.4e1 * t4128 - 0.6e1 * t2774 * t4131 + 0.6e1 * t2780 * t4134 + 0.6e1 * t2780 * t4138 - 0.6e1 * t4141 * t4142 - 0.6e1 * t4145 * t502 + 0.3e1 / 0.2e1 * t4149 - 0.1e2 * t1292 * t4152 - 0.13e2 / 0.2e1 * t501 * t1434;
  t4158 = t1417 * t148;
  t4159 = t4158 * t136;
  t4160 = t501 * t4159;
  t4164 = t2812 * t1550;
  t4167 = t117 * t452;
  t4168 = t332 * t4167;
  t4171 = t131 * t1174;
  t4172 = t332 * t4171;
  t4175 = t841 * t477;
  t4178 = t846 * t477;
  t4181 = t3663 * t170;
  t4186 = t1117 * t1533;
  t4189 = t131 * t1136;
  t4190 = t332 * t4189;
  t4195 = t1117 * t1537;
  t4198 = t4160 / 0.2e1 + 0.3e1 / 0.2e1 * t1297 * t1551 + 0.3e1 / 0.2e1 * t501 * t4164 + 0.2e2 * t1287 * t4168 + 0.6e1 * t1292 * t4172 - 0.12e2 * t4175 * t1289 + 0.6e1 * t4178 * t1294 - 0.12e2 * t4181 * t1534 - 0.12e2 * t3287 * t1534 - 0.12e2 * t1287 * t4186 - 0.12e2 * t1287 * t4190 + 0.6e1 * t3297 * t1538 + 0.6e1 * t1292 * t4195;
  t4200 = t4079 + t4117 + t4157 + t4198;
  t4205 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t1576 - t3995 - 0.3e1 / 0.8e1 * t6 * t112 * t4200);
  tv3rhosigmatau11 = t4205 * t7 + t1580;

  if(out->v3rhosigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigmatau[ip*p->dim.v3rhosigmatau + 11] += tv3rhosigmatau11;

  tv3rholapl20 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 0] += tv3rholapl20;

  tv3rholapl21 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 1] += tv3rholapl21;

  tv3rholapl22 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 2] += tv3rholapl22;

  tv3rholapl23 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 3] += tv3rholapl23;

  tv3rholapl24 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 4] += tv3rholapl24;

  tv3rholapl25 = 0.e0;

  if(out->v3rholapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapl2[ip*p->dim.v3rholapl2 + 5] += tv3rholapl25;

  tv3rholapltau0 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 0] += tv3rholapltau0;

  tv3rholapltau1 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 1] += tv3rholapltau1;

  tv3rholapltau2 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 2] += tv3rholapltau2;

  tv3rholapltau3 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 3] += tv3rholapltau3;

  tv3rholapltau4 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 4] += tv3rholapltau4;

  tv3rholapltau5 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 5] += tv3rholapltau5;

  tv3rholapltau6 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 6] += tv3rholapltau6;

  tv3rholapltau7 = 0.e0;

  if(out->v3rholapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rholapltau[ip*p->dim.v3rholapltau + 7] += tv3rholapltau7;

  t4212 = t6 * t191 * t1606 / 0.8e1;
  t4213 = t493 * params->eta;
  t4214 = t4213 * sigma[0];
  t4215 = t1231 * t4214;
  t4218 = t266 * t1594;
  t4221 = t266 * t1603;
  t4225 = 0.1e1 / t561;
  t4226 = t4225 * params->eta;
  t4227 = t4226 * sigma[0];
  t4237 = 0.12e3 * t1600 * t1870 * t222 + 0.6e1 * t1582 * t2581 + 0.6e1 * t1806 * t4227 + 0.6e2 * t1890 * t4227 - 0.2e2 * t1514 - 0.1e3 * t1519;
  t4238 = t96 * t4237;
  t4240 = t96 * t58;
  t4241 = t584 * t4240;
  t4242 = t640 * t4225;
  t4243 = t4242 * t62;
  t4246 = t3088 * t3083;
  t4249 = t493 * t251;
  t4250 = t3088 * t4249;
  t4272 = -0.6e1 * t1582 * t217 * t266 * t67 + 0.4e1 * t1259 * t494 * t624 + 0.6e1 * t1595 * t1694 * t229 - 0.6e1 * t1595 * t1712 * t251 - 0.3e1 * t1604 * t229 * t589 + 0.2e1 * t1604 * t251 * t624 - t235 * t4221 - t235 * t4238 + 0.8e1 * t3003 * t4215 + 0.24e2 * t3087 * t4246 - 0.24e2 * t3855 * t4250 + 0.2e1 * t4218 * t624 + 0.32e2 * t4241 * t4243;
  t4273 = t609 * t1497;
  t4280 = t1582 * t67;
  t4281 = t4280 * t229;
  t4284 = t4280 * t251;
  t4290 = t985 * t1586;
  t4293 = t54 * t1259;
  t4294 = t218 * t4293;
  t4297 = t4225 * t74;
  t4298 = t4297 * t62;
  t4302 = t609 * t1582 * t251;
  t4306 = t1806 * t1582 * t222;
  t4309 = t39 * t493;
  t4310 = t218 * t4309;
  t4313 = -0.8e2 * t1213 * t4273 - 0.12e2 * t1213 * t4281 + 0.48e2 * t1213 * t4306 + 0.6e1 * t1218 * t4284 + 0.12e2 * t1218 * t4290 + 0.12e2 * t1218 * t4294 - 0.2e2 * t1218 * t4310 + 0.24e2 * t1583 * t3056 + 0.24e2 * t1583 * t3835 + 0.12e2 * t1587 * t3033 - 0.24e2 * t2465 * t4302 - 0.4e1 * t4298 * t484 + 0.2e2 * t1500;
  t4314 = t4272 + t4313;
  t4319 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t1606 - t4212 - 0.3e1 / 0.8e1 * t6 * t28 * t4314);
  tv3rhotau20 = t4319 * t7 + t1610;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 0] += tv3rhotau20;

  tv3rhotau21 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 1] += tv3rhotau21;

  t4326 = t6 * t284 * t1636 / 0.8e1;
  t4328 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t1636 - t4326);
  tv3rhotau22 = t4328 * t7 + t1640;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 2] += tv3rhotau22;

  t4334 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t1606 - t4212);
  tv3rhotau23 = t4334 * t7 + t1610;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 3] += tv3rhotau23;

  tv3rhotau24 = 0.e0;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 4] += tv3rhotau24;

  t4339 = t510 * params->eta;
  t4340 = t4339 * sigma[2];
  t4341 = t1305 * t4340;
  t4344 = t3320 * t3263;
  t4347 = t510 * t365;
  t4348 = t3320 * t4347;
  t4351 = t170 * t135;
  t4352 = t841 * t4351;
  t4353 = 0.1e1 / t822;
  t4354 = t896 * t4353;
  t4355 = t4354 * t136;
  t4377 = t866 * t1545;
  t4380 = t1612 * t141;
  t4381 = t4380 * t343;
  t4384 = t4380 * t365;
  t4387 = -0.6e1 * t141 * t1612 * t331 * t380 + 0.4e1 * t1333 * t511 * t880 - 0.6e1 * t1625 * t2187 * t365 + 0.6e1 * t1625 * t2195 * t343 - 0.3e1 * t1634 * t343 * t846 + 0.2e1 * t1634 * t365 * t880 - 0.8e2 * t1287 * t4377 - 0.12e2 * t1287 * t4381 + 0.6e1 * t1292 * t4384 + 0.8e1 * t3243 * t4341 + 0.24e2 * t3319 * t4344 - 0.24e2 * t4025 * t4348 + 0.32e2 * t4352 * t4355;
  t4393 = t131 * t1333;
  t4394 = t332 * t4393;
  t4397 = t4353 * t148;
  t4398 = t4397 * t136;
  t4401 = t117 * t510;
  t4402 = t332 * t4401;
  t4406 = t866 * t1612 * t365;
  t4410 = t2273 * t1612 * t336;
  t4415 = t1117 * t1616;
  t4418 = t380 * t1624;
  t4421 = t380 * t1633;
  t4425 = t4353 * params->eta;
  t4426 = t4425 * sigma[2];
  t4436 = 0.12e3 * t1630 * t2315 * t336 + 0.6e1 * t1612 * t2812 + 0.6e1 * t2273 * t4426 + 0.6e2 * t2358 * t4426 - 0.2e2 * t1562 - 0.1e3 * t1567;
  t4437 = t170 * t4436;
  t4439 = 0.48e2 * t1287 * t4410 + 0.12e2 * t1292 * t4394 - 0.2e2 * t1292 * t4402 + 0.12e2 * t1292 * t4415 + 0.24e2 * t1613 * t3287 + 0.24e2 * t1613 * t4181 + 0.12e2 * t1617 * t3297 - 0.24e2 * t2774 * t4406 - t349 * t4421 - t349 * t4437 - 0.4e1 * t4398 * t501 + 0.2e1 * t4418 * t880 + 0.2e2 * t1548;
  t4440 = t4387 + t4439;
  t4445 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t1636 - t4326 - 0.3e1 / 0.8e1 * t6 * t112 * t4440);
  tv3rhotau25 = t4445 * t7 + t1640;

  if(out->v3rhotau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhotau2[ip*p->dim.v3rhotau2 + 5] += tv3rhotau25;

  t4447 = t430 * t1372;
  t4450 = t1407 * t420;
  t4453 = t430 * t1396;
  t4457 = t1806 * t3923;
  t4459 = t1821 * t3931;
  t4461 = t1822 * t1346;
  t4464 = t81 * t1346;
  t4465 = t1870 * t4464;
  t4469 = t646 * t247 * t1346 * params->eta;
  t4473 = t242 * t659 * t1346 * t610;
  t4475 = t1850 * t1822;
  t4479 = -0.3e1 / 0.256e3 * t3796 - 0.27e2 / 0.256e3 * t4457 - 0.27e2 / 0.128e3 * t4459 - 0.15e2 / 0.128e3 * t1867 * t4461 - 0.15e2 / 0.64e2 * t4465 - 0.135e3 / 0.128e3 * t4469 - 0.189e3 / 0.128e3 * t4473 - 0.21e2 / 0.32e2 * t78 * t4475 * t1346;
  t4480 = t96 * t4479;
  t4485 = t1372 * t420;
  t4486 = t96 * t4485;
  t4492 = t1352 * t420;
  t4495 = t406 * t1368;
  t4507 = t569 * t1346;
  t4514 = 0.5e1 / 0.1417176e7 * t4507 * t3509;
  t4516 = 0.1e1 / t37 / t573;
  t4519 = 0.35e2 / 0.2066242608e10 * t1345 * t4516 * t1783;
  t4520 = 0.5e1 / 0.1417176e7 * t4507 * t3496 - 0.7e1 / 0.2125764e7 * t1757 * t4507 * t1761 - t4514 + t4519;
  t4522 = t1351 * t405;
  t4523 = t4522 * t84;
  t4526 = t430 * t1351;
  t4529 = t1407 * t405;
  t4532 = t430 * t1368;
  t4535 = t3796 * params->eta;
  t4537 = t1806 * t3931;
  t4541 = 0.3e1 / 0.128e3 * t4535 + 0.9e1 / 0.128e3 * t4537 + 0.3e1 / 0.64e2 * t1821 * t4461;
  t4542 = t96 * t4541;
  t4545 = 0.6e1 * t624 * t4447 - 0.3e1 * t235 * t4450 - 0.3e1 * t235 * t4453 - t235 * t4480 + 0.18e2 * t1694 * t406 * t1372 - 0.6e1 * t1712 * t4486 + 0.6e1 * t624 * t421 * t1396 - 0.18e2 * t1726 * t4492 + 0.18e2 * t584 * t4495 - 0.18e2 * t589 * t1358 * t420 - 0.9e1 * t589 * t1369 * t420 - 0.9e1 * t589 * t406 * t1396 + t85 * t4520 + t4514 + 0.6e1 * t4523 * t96 + 0.18e2 * t584 * t4526 + 0.9e1 * t217 * t4529 + 0.9e1 * t217 * t4532 + 0.3e1 * t217 * t4542 - t4519;
  t4549 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t4545);
  tv3sigma30 = t7 * t4549;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t4550 = t569 * t1417;
  t4557 = 0.5e1 / 0.1417176e7 * t4550 * t3606;
  t4559 = 0.1e1 / t115 / t832;
  t4562 = 0.35e2 / 0.2066242608e10 * t1416 * t4559 * t2250;
  t4563 = 0.5e1 / 0.1417176e7 * t4550 * t3764 - 0.7e1 / 0.2125764e7 * t2226 * t4550 * t1761 - t4557 + t4562;
  t4565 = t1478 * t452;
  t4568 = t477 * t1439;
  t4571 = t4158 * params->eta;
  t4573 = t2273 * t4056;
  t4575 = t1822 * t1417;
  t4578 = 0.3e1 / 0.128e3 * t4571 + 0.9e1 / 0.128e3 * t4573 + 0.3e1 / 0.64e2 * t2288 * t4575;
  t4579 = t170 * t4578;
  t4582 = t477 * t1443;
  t4585 = t1478 * t467;
  t4588 = t477 * t1467;
  t4592 = t2273 * t4048;
  t4594 = t2288 * t4056;
  t4598 = t155 * t1417;
  t4599 = t2315 * t4598;
  t4603 = t902 * t361 * t1417 * params->eta;
  t4607 = t356 * t915 * t1417 * t610;
  t4609 = t2327 * t1822;
  t4613 = -0.3e1 / 0.256e3 * t4158 - 0.27e2 / 0.256e3 * t4592 - 0.27e2 / 0.128e3 * t4594 - 0.15e2 / 0.128e3 * t2312 * t4575 - 0.15e2 / 0.64e2 * t4599 - 0.135e3 / 0.128e3 * t4603 - 0.189e3 / 0.128e3 * t4607 - 0.21e2 / 0.32e2 * t152 * t4609 * t1417;
  t4614 = t170 * t4613;
  t4616 = t1422 * t452;
  t4617 = t4616 * t158;
  t4620 = t477 * t1422;
  t4626 = t1423 * t467;
  t4629 = t453 * t1439;
  t4641 = t1443 * t467;
  t4642 = t170 * t4641;
  t4648 = t159 * t4563 + 0.9e1 * t331 * t4565 + 0.9e1 * t331 * t4568 + 0.3e1 * t331 * t4579 + 0.6e1 * t880 * t4582 - 0.3e1 * t349 * t4585 - 0.3e1 * t349 * t4588 - t349 * t4614 + t4557 + 0.6e1 * t4617 * t170 + 0.18e2 * t841 * t4620 + 0.18e2 * t2195 * t453 * t1443 - 0.18e2 * t2169 * t4626 + 0.18e2 * t841 * t4629 - 0.18e2 * t846 * t1429 * t467 - 0.9e1 * t846 * t1440 * t467 - 0.9e1 * t846 * t453 * t1467 - 0.6e1 * t2187 * t4642 + 0.6e1 * t880 * t468 * t1467 - t4562;
  t4652 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t4648);
  tv3sigma39 = t7 * t4652;

  if(out->v3sigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  tv3sigma2lapl0 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 0] += tv3sigma2lapl0;

  tv3sigma2lapl1 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 1] += tv3sigma2lapl1;

  tv3sigma2lapl2 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 2] += tv3sigma2lapl2;

  tv3sigma2lapl3 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 3] += tv3sigma2lapl3;

  tv3sigma2lapl4 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 4] += tv3sigma2lapl4;

  tv3sigma2lapl5 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 5] += tv3sigma2lapl5;

  tv3sigma2lapl6 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 6] += tv3sigma2lapl6;

  tv3sigma2lapl7 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 7] += tv3sigma2lapl7;

  tv3sigma2lapl8 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 8] += tv3sigma2lapl8;

  tv3sigma2lapl9 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 9] += tv3sigma2lapl9;

  tv3sigma2lapl10 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 10] += tv3sigma2lapl10;

  tv3sigma2lapl11 = 0.e0;

  if(out->v3sigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2lapl[ip*p->dim.v3sigma2lapl + 11] += tv3sigma2lapl11;

  t4656 = t494 * t1351;
  t4661 = t217 * t430 * t1497 * t67;
  t4669 = t3088 * t3377;
  t4672 = t3864 * t3838;
  t4675 = t3864 * t3843;
  t4690 = t3961 * t420;
  t4693 = t1351 * t84;
  t4694 = t4693 * t96;
  t4697 = -0.6e1 * t1712 * t494 * t1372 - 0.6e1 * t1726 * t4656 + 0.3e1 / 0.2e1 * t4661 - 0.6e1 * t589 * t1512 * t405 - 0.6e1 * t589 * t1526 * t405 + 0.24e2 * t3087 * t4669 + 0.6e1 * t2997 * t4672 - 0.3e1 * t3003 * t4675 + 0.4e1 * t624 * t1526 * t420 + 0.2e1 * t624 * t494 * t1396 - 0.3e1 * t589 * t494 * t1368 + 0.4e1 * t624 * t1512 * t420 + 0.12e2 * t2456 * t4690 - 0.12e2 * t4694 * t485;
  t4698 = t3954 * t405;
  t4699 = t1213 * t4698;
  t4701 = t3954 * t420;
  t4702 = t1218 * t4701;
  t4704 = t217 * t1407;
  t4707 = t4297 * params->eta;
  t4708 = t484 * t4707;
  t4711 = t1806 * t4226;
  t4713 = t4225 * t610;
  t4716 = t81 * t4225;
  t4717 = t1870 * t4716;
  t4721 = t646 * t247 * t4225 * params->eta;
  t4727 = 0.3e1 / 0.32e2 * t4297 + 0.9e1 / 0.16e2 * t4711 + 0.9e1 / 0.16e2 * t1821 * t4713 + 0.15e2 / 0.8e1 * t4717 + 0.45e2 / 0.8e1 * t4721 + 0.63e2 / 0.16e2 * t242 * t659 * t4225 * t610;
  t4728 = t96 * t4727;
  t4730 = t1407 * t493;
  t4732 = t430 * t1525;
  t4737 = t54 * t1396;
  t4738 = t218 * t4737;
  t4743 = t1806 * t4713;
  t4746 = t54 * t1372;
  t4747 = t218 * t4746;
  t4752 = t54 * t1368;
  t4753 = t218 * t4752;
  t4756 = 0.3e1 * t4699 - 0.3e1 / 0.2e1 * t4702 - 0.6e1 * t4704 * t485 - 0.3e1 / 0.8e1 * t4708 - t235 * t4728 - t235 * t4730 - 0.2e1 * t235 * t4732 + 0.12e2 * t3793 * t1490 + 0.6e1 * t1218 * t4738 + 0.3e1 * t1493 * t1503 - 0.9e1 / 0.16e2 * t484 * t4743 - 0.12e2 * t2456 * t4747 - 0.24e2 * t3826 * t1486 - 0.12e2 * t1213 * t4753;
  t4757 = t4697 + t4756;
  t4761 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t4757);
  tv3sigma2tau0 = t7 * t4761;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 0] += tv3sigma2tau0;

  tv3sigma2tau1 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 1] += tv3sigma2tau1;

  tv3sigma2tau2 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 2] += tv3sigma2tau2;

  tv3sigma2tau3 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 3] += tv3sigma2tau3;

  tv3sigma2tau4 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 4] += tv3sigma2tau4;

  tv3sigma2tau5 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 5] += tv3sigma2tau5;

  tv3sigma2tau6 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 6] += tv3sigma2tau6;

  tv3sigma2tau7 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 7] += tv3sigma2tau7;

  tv3sigma2tau8 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 8] += tv3sigma2tau8;

  tv3sigma2tau9 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 9] += tv3sigma2tau9;

  tv3sigma2tau10 = 0.e0;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 10] += tv3sigma2tau10;

  t4765 = t511 * t1422;
  t4782 = t331 * t477 * t1545 * t141;
  t4790 = t4034 * t4013;
  t4793 = t3320 * t3590;
  t4796 = t4034 * t4008;
  t4799 = t1478 * t510;
  t4801 = t477 * t1573;
  t4804 = -0.6e1 * t2187 * t511 * t1443 - 0.6e1 * t2169 * t4765 - 0.3e1 * t846 * t511 * t1439 + 0.4e1 * t880 * t1560 * t467 + 0.4e1 * t880 * t1574 * t467 + 0.2e1 * t880 * t511 * t1467 + 0.3e1 / 0.2e1 * t4782 - 0.6e1 * t846 * t1560 * t452 - 0.6e1 * t846 * t1574 * t452 - 0.3e1 * t3243 * t4790 + 0.24e2 * t3319 * t4793 + 0.6e1 * t3237 * t4796 - t349 * t4799 - 0.2e1 * t349 * t4801;
  t4806 = t2273 * t4425;
  t4808 = t4353 * t610;
  t4811 = t155 * t4353;
  t4812 = t2315 * t4811;
  t4816 = t902 * t361 * t4353 * params->eta;
  t4822 = 0.3e1 / 0.32e2 * t4397 + 0.9e1 / 0.16e2 * t4806 + 0.9e1 / 0.16e2 * t2288 * t4808 + 0.15e2 / 0.8e1 * t4812 + 0.45e2 / 0.8e1 * t4816 + 0.63e2 / 0.16e2 * t356 * t915 * t4353 * t610;
  t4823 = t170 * t4822;
  t4825 = t1422 * t158;
  t4826 = t4825 * t170;
  t4829 = t331 * t1478;
  t4832 = t4397 * params->eta;
  t4833 = t501 * t4832;
  t4835 = t4130 * t467;
  t4838 = t4126 * t452;
  t4839 = t1287 * t4838;
  t4841 = t4126 * t467;
  t4842 = t1292 * t4841;
  t4846 = t2273 * t4808;
  t4851 = t131 * t1439;
  t4852 = t332 * t4851;
  t4857 = t131 * t1467;
  t4858 = t332 * t4857;
  t4861 = t131 * t1443;
  t4862 = t332 * t4861;
  t4865 = -t349 * t4823 - 0.12e2 * t4826 * t502 - 0.6e1 * t4829 * t502 - 0.3e1 / 0.8e1 * t4833 + 0.12e2 * t2780 * t4835 + 0.3e1 * t4839 - 0.3e1 / 0.2e1 * t4842 + 0.3e1 * t1541 * t1551 - 0.9e1 / 0.16e2 * t501 * t4846 - 0.24e2 * t4175 * t1534 - 0.12e2 * t1287 * t4852 + 0.12e2 * t4178 * t1538 + 0.6e1 * t1292 * t4858 - 0.12e2 * t2780 * t4862;
  t4866 = t4804 + t4865;
  t4870 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t4866);
  tv3sigma2tau11 = t7 * t4870;

  if(out->v3sigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma2tau[ip*p->dim.v3sigma2tau + 11] += tv3sigma2tau11;

  tv3sigmalapl20 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 0] += tv3sigmalapl20;

  tv3sigmalapl21 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 1] += tv3sigmalapl21;

  tv3sigmalapl22 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 2] += tv3sigmalapl22;

  tv3sigmalapl23 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 3] += tv3sigmalapl23;

  tv3sigmalapl24 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 4] += tv3sigmalapl24;

  tv3sigmalapl25 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 5] += tv3sigmalapl25;

  tv3sigmalapl26 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 6] += tv3sigmalapl26;

  tv3sigmalapl27 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 7] += tv3sigmalapl27;

  tv3sigmalapl28 = 0.e0;

  if(out->v3sigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapl2[ip*p->dim.v3sigmalapl2 + 8] += tv3sigmalapl28;

  tv3sigmalapltau0 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 0] += tv3sigmalapltau0;

  tv3sigmalapltau1 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 1] += tv3sigmalapltau1;

  tv3sigmalapltau2 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 2] += tv3sigmalapltau2;

  tv3sigmalapltau3 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 3] += tv3sigmalapltau3;

  tv3sigmalapltau4 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 4] += tv3sigmalapltau4;

  tv3sigmalapltau5 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 5] += tv3sigmalapltau5;

  tv3sigmalapltau6 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 6] += tv3sigmalapltau6;

  tv3sigmalapltau7 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 7] += tv3sigmalapltau7;

  tv3sigmalapltau8 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 8] += tv3sigmalapltau8;

  tv3sigmalapltau9 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 9] += tv3sigmalapltau9;

  tv3sigmalapltau10 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 10] += tv3sigmalapltau10;

  tv3sigmalapltau11 = 0.e0;

  if(out->v3sigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmalapltau[ip*p->dim.v3sigmalapltau + 11] += tv3sigmalapltau11;

  t4871 = t405 * t84;
  t4872 = t4871 * t96;
  t4876 = t609 * t1582 * t420;
  t4881 = 0.1e1 / t208;
  t4882 = t1806 * t4881;
  t4883 = t1213 * t4882;
  t4885 = t4881 * params->eta;
  t4886 = t1821 * t4885;
  t4889 = t3088 * t3961;
  t4892 = t3088 * t3968;
  t4897 = t3954 * t493;
  t4898 = t1218 * t4897;
  t4900 = t3864 * t4213;
  t4903 = t54 * t1525;
  t4904 = t218 * t4903;
  t4907 = 0.24e2 * t4872 * t1583 - 0.24e2 * t2465 * t4876 + 0.24e2 * t3826 * t1583 - 0.6e1 * t4883 - 0.12e2 * t1213 * t4886 + 0.24e2 * t3087 * t4889 - 0.24e2 * t3855 * t4892 + 0.12e2 * t3793 * t1587 - 0.3e1 / 0.2e1 * t4898 - 0.3e1 * t3003 * t4900 + 0.12e2 * t1218 * t4904;
  t4908 = t4280 * t405;
  t4911 = t4280 * t420;
  t4918 = t4881 * t74;
  t4919 = t4918 * params->eta;
  t4928 = t430 * t1594;
  t4940 = t430 * t1603;
  t4945 = t81 * t4881;
  t4946 = t1870 * t4945;
  t4952 = -0.3e1 / 0.4e1 * t4918 - 0.9e1 / 0.4e1 * t1806 * t4885 - 0.15e2 * t4946 - 0.45e2 / 0.2e1 * t646 * t247 * t4881 * params->eta;
  t4953 = t96 * t4952;
  t4955 = -0.12e2 * t1213 * t4908 + 0.6e1 * t1218 * t4911 - 0.6e1 * t217 * t430 * t1582 * t67 + 0.3e1 / 0.2e1 * t484 * t4919 + 0.6e1 * t1694 * t1595 * t405 - 0.6e1 * t1712 * t1595 * t420 + 0.2e1 * t624 * t4928 + 0.4e1 * t624 * t494 * t1525 - 0.3e1 * t589 * t1604 * t405 + 0.2e1 * t624 * t1604 * t420 - t235 * t4940 - t235 * t4953;
  t4956 = t4907 + t4955;
  t4960 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t4956);
  tv3sigmatau20 = t7 * t4960;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 0] += tv3sigmatau20;

  tv3sigmatau21 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 1] += tv3sigmatau21;

  tv3sigmatau22 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 2] += tv3sigmatau22;

  tv3sigmatau23 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 3] += tv3sigmatau23;

  tv3sigmatau24 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 4] += tv3sigmatau24;

  tv3sigmatau25 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 5] += tv3sigmatau25;

  tv3sigmatau26 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 6] += tv3sigmatau26;

  tv3sigmatau27 = 0.e0;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 7] += tv3sigmatau27;

  t4961 = t452 * t158;
  t4962 = t4961 * t170;
  t4966 = t866 * t1612 * t467;
  t4971 = 0.1e1 / t322;
  t4972 = t2273 * t4971;
  t4973 = t1287 * t4972;
  t4975 = t4971 * params->eta;
  t4976 = t2288 * t4975;
  t4979 = t3320 * t4130;
  t4982 = t3320 * t4137;
  t4987 = t4126 * t510;
  t4988 = t1292 * t4987;
  t4990 = t4034 * t4339;
  t4993 = t131 * t1573;
  t4994 = t332 * t4993;
  t4997 = 0.24e2 * t4962 * t1613 - 0.24e2 * t2774 * t4966 + 0.24e2 * t4175 * t1613 - 0.6e1 * t4973 - 0.12e2 * t1287 * t4976 + 0.24e2 * t3319 * t4979 - 0.24e2 * t4025 * t4982 + 0.12e2 * t4178 * t1617 - 0.3e1 / 0.2e1 * t4988 - 0.3e1 * t3243 * t4990 + 0.12e2 * t1292 * t4994;
  t4998 = t4380 * t452;
  t5001 = t4380 * t467;
  t5008 = t4971 * t148;
  t5009 = t5008 * params->eta;
  t5018 = t477 * t1624;
  t5030 = t477 * t1633;
  t5035 = t155 * t4971;
  t5036 = t2315 * t5035;
  t5042 = -0.3e1 / 0.4e1 * t5008 - 0.9e1 / 0.4e1 * t2273 * t4975 - 0.15e2 * t5036 - 0.45e2 / 0.2e1 * t902 * t361 * t4971 * params->eta;
  t5043 = t170 * t5042;
  t5045 = -0.12e2 * t1287 * t4998 + 0.6e1 * t1292 * t5001 - 0.6e1 * t331 * t477 * t1612 * t141 + 0.3e1 / 0.2e1 * t501 * t5009 + 0.6e1 * t2195 * t1625 * t452 - 0.6e1 * t2187 * t1625 * t467 + 0.2e1 * t880 * t5018 + 0.4e1 * t880 * t511 * t1573 - 0.3e1 * t846 * t1634 * t452 + 0.2e1 * t880 * t1634 * t467 - t349 * t5030 - t349 * t5043;
  t5046 = t4997 + t5045;
  t5050 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t5046);
  tv3sigmatau28 = t7 * t5050;

  if(out->v3sigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigmatau2[ip*p->dim.v3sigmatau2 + 8] += tv3sigmatau28;

  tv3lapl30 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 0] += tv3lapl30;

  tv3lapl31 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 1] += tv3lapl31;

  tv3lapl32 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 2] += tv3lapl32;

  tv3lapl33 = 0.e0;

  if(out->v3lapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl3[ip*p->dim.v3lapl3 + 3] += tv3lapl33;

  tv3lapl2tau0 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 0] += tv3lapl2tau0;

  tv3lapl2tau1 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 1] += tv3lapl2tau1;

  tv3lapl2tau2 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 2] += tv3lapl2tau2;

  tv3lapl2tau3 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 3] += tv3lapl2tau3;

  tv3lapl2tau4 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 4] += tv3lapl2tau4;

  tv3lapl2tau5 = 0.e0;

  if(out->v3lapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapl2tau[ip*p->dim.v3lapl2tau + 5] += tv3lapl2tau5;

  tv3lapltau20 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 0] += tv3lapltau20;

  tv3lapltau21 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 1] += tv3lapltau21;

  tv3lapltau22 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 2] += tv3lapltau22;

  tv3lapltau23 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 3] += tv3lapltau23;

  tv3lapltau24 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 4] += tv3lapltau24;

  tv3lapltau25 = 0.e0;

  if(out->v3lapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3lapltau2[ip*p->dim.v3lapltau2 + 5] += tv3lapltau25;

  t5051 = 0.1e1 / t394;
  t5052 = t5051 * t84;
  t5057 = t609 * t1582 * t493;
  t5060 = t1806 * t5051;
  t5063 = t54 * t1594;
  t5064 = t218 * t5063;
  t5067 = t4280 * t493;
  t5070 = t54 * t1603;
  t5071 = t218 * t5070;
  t5074 = t1594 * t493;
  t5075 = t96 * t5074;
  t5083 = t81 * t5051;
  t5086 = 0.12e3 * t1870 * t5083 + 0.6e1 * t5051 * t74;
  t5087 = t96 * t5086;
  t5089 = 0.6e1 * t1603 * t494 * t624 - 0.48e2 * t1867 * t5052 * t96 + 0.72e2 * t1213 * t5060 + 0.18e2 * t1218 * t5067 + 0.18e2 * t1218 * t5071 - 0.6e1 * t1712 * t5075 - t235 * t5087 - 0.36e2 * t2456 * t5064 - 0.72e2 * t2465 * t5057;
  t5093 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t5089);
  tv3tau30 = t7 * t5093;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 0] += tv3tau30;

  tv3tau31 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 1] += tv3tau31;

  tv3tau32 = 0.e0;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 2] += tv3tau32;

  t5094 = 0.1e1 / t441;
  t5095 = t5094 * t158;
  t5100 = t866 * t1612 * t510;
  t5103 = t2273 * t5094;
  t5106 = t131 * t1624;
  t5107 = t332 * t5106;
  t5110 = t4380 * t510;
  t5113 = t131 * t1633;
  t5114 = t332 * t5113;
  t5117 = t1624 * t510;
  t5118 = t170 * t5117;
  t5126 = t155 * t5094;
  t5129 = 0.6e1 * t148 * t5094 + 0.12e3 * t2315 * t5126;
  t5130 = t170 * t5129;
  t5132 = 0.6e1 * t1633 * t511 * t880 - 0.48e2 * t170 * t2312 * t5095 + 0.72e2 * t1287 * t5103 + 0.18e2 * t1292 * t5110 + 0.18e2 * t1292 * t5114 - 0.6e1 * t2187 * t5118 - 0.72e2 * t2774 * t5100 - 0.36e2 * t2780 * t5107 - t349 * t5130;
  t5136 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t5132);
  tv3tau33 = t7 * t5136;

  if(out->v3tau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3tau3[ip*p->dim.v3tau3 + 3] += tv3tau33;

  t5141 = t6 * t534 * t547 * t98;
  t5145 = t6 * t184 * t1683 * t98;
  t5148 = 0.1e1 / t189 / t525;
  t5152 = 0.1e2 / 0.27e2 * t6 * t26 * t5148 * t98;
  t5155 = t6 * t1660 * t190 * t98;
  t5157 = t20 * t20;
  t5159 = 0.1e1 / t520 / t5157;
  t5160 = t522 * t522;
  t5166 = t530 * t530;
  t5172 = 0.1e1 / t1651 / t7;
  t5173 = t17 * t5172;
  t5176 = my_piecewise5(t11, 0, t15, 0, -0.24e2 * t1652 + 0.24e2 * t5173);
  t5180 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t5159 * t5160 - 0.16e2 / 0.9e1 * t1644 * t522 * t530 + 0.4e1 / 0.3e1 * t521 * t5166 + 0.16e2 / 0.9e1 * t1648 * t1656 + 0.4e1 / 0.3e1 * t24 * t5176);
  t5189 = t6 * t1665 * t268;
  t5195 = t6 * t1672 * t268;
  t5197 = t6 * t539 * t691;
  t5203 = t6 * t1684 * t268;
  t5206 = t6 * t548 * t691;
  t5209 = t6 * t191 * t1913;
  t5214 = 0.1e1 / t37 / t208;
  t5215 = sigma[0] * t5214;
  t5220 = 0.1e1 / t36 / t970;
  t5225 = 0.1e1 / t2470;
  t5230 = t572 * t208;
  t5232 = 0.1e1 / t37 / t5230;
  t5233 = t1774 * t5232;
  t5238 = t675 * t675;
  t5241 = t88 / t93 / t5238;
  t5243 = t579 * t579;
  t5244 = 0.1e1 / t5243;
  t5263 = 0.2618e5 / 0.19683e5 * t34 * t5215 * t49;
  t5267 = 0.6094e5 / 0.1594323e7 * t206 * t5220 * t212 * t41;
  t5271 = 0.10252e6 / 0.43046721e8 * t571 * t5225 * t577 * t580;
  t5273 = 0.10976e6 / 0.10460353203e11 * t5233 * t1783;
  t5276 = t572 * t572;
  t5281 = t575 * t575;
  t5285 = 0.1e1 / t48 / t5281 * t5244 * t204;
  t5287 = 0.4256e5 / 0.2541865828329e13 * t569 * t1773 * sigma[0] / t36 / t5276 / rho[0] * t5285;
  t5288 = 0.2618e5 / 0.19683e5 * t34 * t5215 * t94 - 0.15664e6 / 0.4782969e7 * t206 * t5220 * t258 * t41 + 0.704e4 / 0.4782969e7 * t571 * t5225 * t677 * t580 - 0.3584e5 / 0.10460353203e11 * t5233 * t1756 * t1761 * t34 + 0.34048e5 / 0.10460353203e11 * t5241 * t1774 * t5232 * t5244 * t34 - 0.19712e5 / 0.14348907e8 * t1758 * t570 * t5225 * t1761 + 0.15664e5 / 0.531441e6 * t679 * t680 * t5220 * t580 - 0.20944e5 / 0.19683e5 * t260 * t261 * t5214 * t41 - t5263 + t5267 - t5271 + t5273 - t5287;
  t5290 = t665 * t665;
  t5296 = t71 / t1710 / t83;
  t5297 = t625 * t625;
  t5301 = t618 * t618;
  t5312 = 0.616e4 / 0.81e2 * tau[0] * t1699 - 0.2618e4 / 0.81e2 * t5215;
  t5315 = t606 * t606;
  t5327 = params->b * t58;
  t5328 = t596 * t596;
  t5341 = 0.1e1 / t658 / t66;
  t5342 = t78 * t5341;
  t5343 = t610 * t610;
  t5345 = t5343 * t1773 * t5232;
  t5348 = t57 * t640;
  t5358 = t58 * t81;
  t5362 = t611 * t5220;
  t5365 = t62 * t5214;
  t5368 = t1823 * t5225;
  t5373 = 0.36e2 * t1803 * t606 + 0.3e1 * t225 * t5312 + 0.18e2 * t599 * t5315 + 0.9e2 * t646 * t81 * t5315 + 0.6e1 * t242 * t81 * t5312 + 0.24e2 * t599 * t1818 * t222 + 0.36e3 * t5327 * t81 * t5328 + 0.72e3 * t646 * t247 * t222 * t1896 + 0.616e3 / 0.3e1 * t609 * params->eta * t1700 * t222 + 0.112e3 / 0.3e1 * t5342 * t5345 + 0.48e2 * t5348 * t596 * t612 + 0.12e2 * t609 * t1818 * t226 + 0.24e2 * t1821 * t606 * t612 + 0.8e2 / 0.3e1 * t5358 * t222 * t1824 + 0.13706e5 / 0.27e2 * t660 * t5362 - 0.5236e4 / 0.27e2 * t248 * t5365 - 0.2464e4 / 0.9e1 * t1851 * t5368 - 0.132e3 * t1854 * t615;
  t5390 = t1870 * t247;
  t5399 = t646 * t659;
  t5411 = t242 * t1850;
  t5420 = t1871 * t238;
  t5425 = t72 * t247;
  t5434 = -0.66e2 * t1857 * t615 - 0.176e3 * t1860 * t1827 - 0.132e4 * t1890 * t1891 * t557 + 0.2464e4 / 0.3e1 * t650 * t651 * t1700 + 0.168e3 * t1899 * t606 * t610 * t1901 + 0.72e2 * t1807 * t1896 + 0.96e3 * t5390 * t1871 * params->eta * t198 + 0.48e2 * t650 * t1818 * params->eta * t198 + 0.84e3 * t5399 * t596 * t610 * t1901 - 0.264e3 * t650 * t1895 * t557 - 0.1232e4 * t1899 * t1900 * t205 * t1705 + 0.896e3 / 0.3e1 * t5411 * t1823 * t1721 * t222 + 0.3916e4 / 0.27e2 * t641 * t5362 - 0.2618e4 / 0.27e2 * t239 * t5365 + 0.24e2 * t5420 * t226 - 0.44e3 / 0.9e1 * t1867 * t5368 + 0.4e2 / 0.9e1 * t5425 * t5345 + 0.72e3 * t1870 * t647 * t606 + 0.12e3 * t646 * t243 * t1818;
  t5438 = t1788 * t234;
  t5464 = t596 * t238;
  t5481 = 0.176e3 / 0.9e1 * t1821 * t5368 - 0.1958e4 / 0.27e2 * t609 * t5362 + 0.5236e4 / 0.81e2 * t225 * t5365 - 0.16e2 * t2581 * t606 * t226 + 0.88e2 / 0.3e1 * t1803 * t615 - 0.8e1 * t1806 * t606 * t612 - 0.64e2 / 0.9e1 * t5348 * t222 * t1824 - 0.16e2 / 0.3e1 * t599 * t1818 * t226 - 0.8e1 * t5464 * t612 - 0.4e2 / 0.27e2 * t5358 * t5345 - 0.6e1 * t5315 * t67 - 0.8e1 * t985 * t1818 - 0.2e1 * t218 * t5312 + 0.176e3 / 0.3e1 * t1807 * t1827 + 0.88e2 / 0.3e1 * t1810 * t615 - 0.2464e4 / 0.27e2 * t600 * t1830;
  t5516 = -0.24e2 * t1712 * t1713 * t266 + 0.12e2 * t1786 * t217 * t229 - 0.4e1 * t1786 * t235 * t251 + 0.12e2 * t1833 * t217 * t266 + 0.18e2 * t217 * t618 * t689 - 0.6e1 * t235 * t665 * t689 + 0.72e2 * t2456 * t3089 * t665 - 0.72e2 * t2465 * t3089 * t618 + 0.36e2 * t584 * t585 * t689 + 0.12e2 * t624 * t625 * t689 - t5267;
  t5564 = t69 * t623;
  t5568 = t70 * t1711;
  t5572 = -0.72e2 * t1713 * t230 * t5568 - 0.72e2 * t1726 * t1792 * t251 - 0.36e2 * t1726 * t586 * t665 - 0.36e2 * t1795 * t251 * t589 - 0.36e2 * t1798 * t251 * t589 + 0.24e2 * t1833 * t230 * t584 - 0.12e2 * t1834 * t251 * t589 + 0.72e2 * t5564 * t586 * t625 + 0.72e2 * t584 * t593 * t618 - 0.18e2 * t589 * t619 * t665 + t5263;
  t5578 = t5141 / 0.2e1 - 0.5e1 / 0.9e1 * t5145 + t5152 - t5155 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t5180 * t27 * t98 - 0.3e1 / 0.2e1 * t6 * t1661 * t268 - 0.3e1 / 0.2e1 * t5189 - 0.9e1 / 0.4e1 * t6 * t535 * t691 + t5195 - 0.3e1 / 0.2e1 * t5197 - 0.3e1 / 0.2e1 * t6 * t185 * t1913 - 0.5e1 / 0.9e1 * t5203 + t5206 / 0.2e1 - t5209 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t28 * (0.24e2 * t1789 * t266 + t85 * t5288 + 0.6e1 * t624 * t96 * t5290 + 0.24e2 * t5296 * t96 * t5297 + 0.18e2 * t584 * t96 * t5301 + 0.36e2 * t2650 * t619 - t235 * t96 * (t5373 + t5434) - 0.24e2 * t5438 * t252 - 0.4e1 * t235 * t266 * t1909 + 0.3e1 * t217 * t96 * t5481 + t5516 + 0.72e2 * t1694 * t593 * t625 + 0.36e2 * t1694 * t619 * t625 - 0.36e2 * t1712 * t626 * t665 - 0.12e2 * t589 * t230 * t1909 + 0.8e1 * t624 * t252 * t1909 - 0.36e2 * t589 * t593 * t665 + 0.24e2 * t624 * t629 * t665 + t5271 - t5273 + t5287 + t5572);
  t5579 = my_piecewise3(t2, 0, t5578);
  t5580 = t107 * t107;
  t5582 = 0.1e1 / t697 / t5580;
  t5583 = t699 * t699;
  t5589 = t705 * t705;
  t5594 = t104 * t5172;
  t5597 = my_piecewise5(t15, 0, t11, 0, 0.24e2 * t1652 + 0.24e2 * t5594);
  t5601 = my_piecewise3(t108, 0, 0.4e2 / 0.81e2 * t5582 * t5583 - 0.16e2 / 0.9e1 * t1920 * t699 * t705 + 0.4e1 / 0.3e1 * t698 * t5589 + 0.16e2 / 0.9e1 * t1924 * t1930 + 0.4e1 / 0.3e1 * t109 * t5597);
  t5608 = t6 * t1934 * t190 * t172;
  t5612 = t6 * t709 * t547 * t172;
  t5616 = t6 * t279 * t1683 * t172;
  t5621 = 0.1e2 / 0.27e2 * t6 * t111 * t5148 * t172;
  t5623 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t5601 * t27 * t172 - t5608 / 0.2e1 + t5612 / 0.2e1 - 0.5e1 / 0.9e1 * t5616 + t5621);
  tv4rho40 = 0.4e1 * t1918 + 0.4e1 * t1952 + t7 * (t5579 + t5623);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t5630 = t6 * t1972 * t190 * t98;
  t5634 = t6 * t734 * t547 * t98;
  t5635 = t5634 / 0.4e1;
  t5638 = t6 * t296 * t1683 * t98;
  t5644 = t6 * t739 * t691;
  t5665 = 0.12e2 * t1652;
  t5666 = 0.24e2 * t5173;
  t5668 = my_piecewise5(t11, 0, t15, 0, -t5665 + t5666);
  t5672 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t5159 * t293 * t1645 - 0.8e1 / 0.9e1 * t1644 * t730 * t522 - 0.8e1 / 0.9e1 * t1957 * t181 * t530 + 0.4e1 / 0.3e1 * t521 * t1968 * t181 + 0.4e1 / 0.3e1 * t1960 * t530 + 0.4e1 / 0.9e1 * t726 * t1656 + 0.4e1 / 0.3e1 * t24 * t5668);
  t5681 = t6 * t1977 * t268;
  t5687 = t6 * t1984 * t268;
  t5688 = t5687 / 0.4e1;
  t5695 = -0.3e1 / 0.8e1 * t5630 + t5635 - 0.5e1 / 0.36e2 * t5638 + t5141 / 0.4e1 - 0.5e1 / 0.12e2 * t5145 + t5152 - t5155 / 0.8e1 - 0.3e1 / 0.8e1 * t5644 - 0.3e1 / 0.8e1 * t6 * t297 * t1913 - 0.3e1 / 0.8e1 * t6 * t5672 * t27 * t98 - 0.9e1 / 0.8e1 * t6 * t1973 * t268 - 0.3e1 / 0.4e1 * t5681 - 0.9e1 / 0.8e1 * t6 * t735 * t691 + t5688 - 0.3e1 / 0.8e1 * t5189 + t5195 / 0.2e1 - 0.3e1 / 0.8e1 * t5197 - 0.5e1 / 0.12e2 * t5203 + t5206 / 0.4e1 - t5209 / 0.8e1;
  t5696 = my_piecewise3(t2, 0, t5695);
  t5713 = 0.24e2 * t5594;
  t5715 = my_piecewise5(t15, 0, t11, 0, t5665 + t5713);
  t5719 = my_piecewise3(t108, 0, 0.4e2 / 0.81e2 * t5582 * t304 * t1921 - 0.8e1 / 0.9e1 * t1920 * t754 * t699 - 0.8e1 / 0.9e1 * t2001 * t276 * t705 + 0.4e1 / 0.3e1 * t698 * t2011 * t276 + 0.4e1 / 0.3e1 * t2004 * t705 + 0.4e1 / 0.9e1 * t750 * t1930 + 0.4e1 / 0.3e1 * t109 * t5715);
  t5726 = t6 * t2015 * t190 * t172;
  t5730 = t6 * t758 * t547 * t172;
  t5731 = t5730 / 0.4e1;
  t5734 = t6 * t307 * t1683 * t172;
  t5743 = t6 * t1939 * t382;
  t5746 = t6 * t1943 * t382;
  t5747 = t5746 / 0.4e1;
  t5749 = t6 * t1947 * t382;
  t5751 = -0.3e1 / 0.8e1 * t6 * t5719 * t27 * t172 - 0.3e1 / 0.8e1 * t5726 + t5731 - 0.5e1 / 0.36e2 * t5734 - t5608 / 0.8e1 + t5612 / 0.4e1 - 0.5e1 / 0.12e2 * t5616 + t5621 - 0.3e1 / 0.8e1 * t6 * t1935 * t382 - 0.3e1 / 0.8e1 * t5743 + t5747 - 0.5e1 / 0.36e2 * t5749;
  t5752 = my_piecewise3(t103, 0, t5751);
  tv4rho41 = t1918 + t1952 + 0.3e1 * t2000 + 0.3e1 * t2040 + t7 * (t5696 + t5752);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t5761 = t6 * t2056 * t190 * t98;
  t5765 = t6 * t789 * t547 * t98;
  t5780 = t730 * t730;
  t5793 = my_piecewise5(t11, 0, t15, 0, t5666);
  t5797 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t5159 * t780 * t522 - 0.32e2 / 0.27e2 * t1957 * t181 * t730 - 0.8e1 / 0.27e2 * t2043 * t530 + 0.8e1 / 0.9e1 * t521 * t5780 + 0.8e1 / 0.9e1 * t726 * t1968 - 0.8e1 / 0.27e2 * t1644 * t785 * t522 + 0.8e1 / 0.9e1 * t521 * t2052 * t181 + 0.4e1 / 0.9e1 * t2048 * t530 + 0.4e1 / 0.3e1 * t24 * t5793);
  t5806 = t6 * t2061 * t268;
  t5817 = -t5761 / 0.4e1 + t5765 / 0.12e2 - t5630 / 0.4e1 + t5634 / 0.3e1 - 0.5e1 / 0.18e2 * t5638 + t5141 / 0.12e2 - 0.5e1 / 0.18e2 * t5145 + t5152 - 0.3e1 / 0.8e1 * t6 * t5797 * t27 * t98 - 0.3e1 / 0.4e1 * t6 * t2057 * t268 - t5806 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t790 * t691 - t5644 / 0.4e1 - t5681 / 0.2e1 + t5687 / 0.3e1 + t5195 / 0.6e1 - 0.5e1 / 0.18e2 * t5203 + t5206 / 0.12e2;
  t5818 = my_piecewise3(t2, 0, t5817);
  t5827 = t754 * t754;
  t5840 = my_piecewise5(t15, 0, t11, 0, t5713);
  t5844 = my_piecewise3(t108, 0, 0.4e2 / 0.81e2 * t5582 * t797 * t699 - 0.32e2 / 0.27e2 * t2001 * t276 * t754 - 0.8e1 / 0.27e2 * t2073 * t705 + 0.8e1 / 0.9e1 * t698 * t5827 + 0.8e1 / 0.9e1 * t750 * t2011 - 0.8e1 / 0.27e2 * t1920 * t802 * t699 + 0.8e1 / 0.9e1 * t698 * t2082 * t276 + 0.4e1 / 0.9e1 * t2078 * t705 + 0.4e1 / 0.3e1 * t109 * t5840);
  t5851 = t6 * t2086 * t190 * t172;
  t5855 = t6 * t806 * t547 * t172;
  t5864 = t6 * t2020 * t382;
  t5867 = t6 * t2024 * t382;
  t5878 = t6 * t714 * t947;
  t5881 = t6 * t718 * t947;
  t5883 = -0.3e1 / 0.8e1 * t6 * t5844 * t27 * t172 - t5851 / 0.4e1 + t5855 / 0.12e2 - t5726 / 0.4e1 + t5730 / 0.3e1 - 0.5e1 / 0.18e2 * t5734 - 0.3e1 / 0.4e1 * t6 * t2016 * t382 - t5864 / 0.2e1 + t5867 / 0.6e1 + t5612 / 0.12e2 - 0.5e1 / 0.18e2 * t5616 + t5621 - t5743 / 0.4e1 + t5746 / 0.3e1 - 0.5e1 / 0.18e2 * t5749 - 0.3e1 / 0.8e1 * t6 * t710 * t947 - t5878 / 0.4e1 + t5881 / 0.12e2;
  t5884 = my_piecewise3(t103, 0, t5883);
  tv4rho42 = 0.2e1 * t2000 + 0.2e1 * t2040 + 0.2e1 * t2072 + 0.2e1 * t2111 + t7 * (t5818 + t5884);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t5905 = my_piecewise5(t11, 0, t15, 0, t5665 + t5666);
  t5909 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t5159 * t2116 * t181 - 0.8e1 / 0.9e1 * t2043 * t730 - 0.8e1 / 0.9e1 * t1957 * t785 * t181 + 0.4e1 / 0.3e1 * t1960 * t785 + 0.4e1 / 0.3e1 * t726 * t2052 + 0.4e1 / 0.9e1 * t521 * t2123 * t181 + 0.4e1 / 0.3e1 * t24 * t5905);
  t5916 = t6 * t2127 * t190 * t98;
  t5927 = -0.3e1 / 0.8e1 * t6 * t5909 * t27 * t98 - t5916 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t2128 * t268 - 0.3e1 / 0.8e1 * t5761 + t5765 / 0.4e1 - 0.3e1 / 0.8e1 * t5806 + t5635 - 0.5e1 / 0.12e2 * t5638 + t5688 - 0.5e1 / 0.36e2 * t5145 + t5152 - 0.5e1 / 0.36e2 * t5203;
  t5928 = my_piecewise3(t2, 0, t5927);
  t5945 = my_piecewise5(t15, 0, t11, 0, -t5665 + t5713);
  t5949 = my_piecewise3(t108, 0, 0.4e2 / 0.81e2 * t5582 * t2136 * t276 - 0.8e1 / 0.9e1 * t2073 * t754 - 0.8e1 / 0.9e1 * t2001 * t802 * t276 + 0.4e1 / 0.3e1 * t2004 * t802 + 0.4e1 / 0.3e1 * t750 * t2082 + 0.4e1 / 0.9e1 * t698 * t2143 * t276 + 0.4e1 / 0.3e1 * t109 * t5945);
  t5956 = t6 * t2147 * t190 * t172;
  t5964 = t6 * t2091 * t382;
  t5973 = t6 * t763 * t947;
  t5983 = t6 * t284 * t2379;
  t5985 = -0.3e1 / 0.8e1 * t6 * t5949 * t27 * t172 - t5956 / 0.8e1 - 0.3e1 / 0.8e1 * t5851 + t5855 / 0.4e1 - 0.9e1 / 0.8e1 * t6 * t2087 * t382 - 0.3e1 / 0.8e1 * t5964 + t5731 - 0.5e1 / 0.12e2 * t5734 - 0.3e1 / 0.4e1 * t5864 + t5867 / 0.2e1 - 0.9e1 / 0.8e1 * t6 * t759 * t947 - 0.3e1 / 0.8e1 * t5973 - 0.5e1 / 0.36e2 * t5616 + t5621 + t5747 - 0.5e1 / 0.12e2 * t5749 - 0.3e1 / 0.8e1 * t5878 + t5881 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t280 * t2379 - t5983 / 0.8e1;
  t5986 = my_piecewise3(t103, 0, t5985);
  tv4rho43 = 0.3e1 * t2072 + 0.3e1 * t2111 + t2135 + t2384 + t7 * (t5928 + t5986);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t5991 = t780 * t780;
  t5996 = t785 * t785;
  t6003 = my_piecewise5(t11, 0, t15, 0, 0.24e2 * t1652 + 0.24e2 * t5173);
  t6007 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t5159 * t5991 - 0.16e2 / 0.9e1 * t2043 * t785 + 0.4e1 / 0.3e1 * t521 * t5996 + 0.16e2 / 0.9e1 * t726 * t2123 + 0.4e1 / 0.3e1 * t24 * t6003);
  t6016 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t6007 * t27 * t98 - t5916 / 0.2e1 + t5765 / 0.2e1 - 0.5e1 / 0.9e1 * t5638 + t5152);
  t6032 = 0.1e1 / t115 / t322;
  t6033 = sigma[2] * t6032;
  t6038 = 0.1e1 / t114 / t1102;
  t6043 = 0.1e1 / t2788;
  t6048 = t831 * t322;
  t6050 = 0.1e1 / t115 / t6048;
  t6051 = t2241 * t6050;
  t6056 = t931 * t931;
  t6059 = t162 / t167 / t6056;
  t6079 = 0.2618e5 / 0.19683e5 * t34 * t6033 * t126;
  t6083 = 0.6094e5 / 0.1594323e7 * t320 * t6038 * t326 * t41;
  t6087 = 0.10252e6 / 0.43046721e8 * t830 * t6043 * t836 * t580;
  t6089 = 0.10976e6 / 0.10460353203e11 * t6051 * t2250;
  t6092 = t831 * t831;
  t6097 = t834 * t834;
  t6101 = 0.1e1 / t125 / t6097 * t5244 * t204;
  t6103 = 0.4256e5 / 0.2541865828329e13 * t569 * t2240 * sigma[2] / t114 / t6092 / rho[1] * t6101;
  t6104 = 0.2618e5 / 0.19683e5 * t34 * t6033 * t168 - 0.15664e6 / 0.4782969e7 * t320 * t6038 * t372 * t41 + 0.704e4 / 0.4782969e7 * t830 * t6043 * t933 * t580 - 0.3584e5 / 0.10460353203e11 * t6051 * t2225 * t1761 * t34 + 0.34048e5 / 0.10460353203e11 * t6059 * t2241 * t6050 * t5244 * t34 - 0.19712e5 / 0.14348907e8 * t2227 * t829 * t6043 * t1761 + 0.15664e5 / 0.531441e6 * t935 * t936 * t6038 * t580 - 0.20944e5 / 0.19683e5 * t374 * t375 * t6032 * t41 - t6079 + t6083 - t6087 + t6089 - t6103;
  t6108 = t874 * t874;
  t6114 = t2255 * t348;
  t6121 = t863 * t863;
  t6129 = 0.616e4 / 0.81e2 * tau[1] * t2200 - 0.2618e4 / 0.81e2 * t6033;
  t6141 = params->b * t135;
  t6142 = t853 * t853;
  t6148 = t136 * t6032;
  t6151 = t2289 * t6043;
  t6158 = t867 * t6038;
  t6161 = t135 * t155;
  t6162 = t6161 * t1822;
  t6167 = 0.1e1 / t914 / t140;
  t6168 = t152 * t6167;
  t6170 = t5343 * t2240 * t6050;
  t6173 = t134 * t896;
  t6180 = 0.72e3 * t902 * t361 * t336 * t2364 + 0.18e2 * t856 * t6121 + 0.36e2 * t2270 * t863 + 0.3e1 * t339 * t6129 + 0.9e2 * t902 * t155 * t6121 + 0.24e2 * t856 * t2285 * t336 + 0.6e1 * t356 * t155 * t6129 + 0.36e3 * t6141 * t155 * t6142 - 0.176e3 * t2337 * t2293 - 0.5236e4 / 0.27e2 * t362 * t6148 - 0.2464e4 / 0.9e1 * t2328 * t6151 - 0.132e3 * t2331 * t871 - 0.66e2 * t2334 * t871 + 0.13706e5 / 0.27e2 * t916 * t6158 + 0.8e2 / 0.3e1 * t6162 * t2228 * t336 + 0.112e3 / 0.3e1 * t6168 * t6170 + 0.48e2 * t6173 * t853 * t868 + 0.12e2 * t866 * t2285 * t340;
  t6188 = t146 * t361;
  t6199 = t2316 * t352;
  t6216 = t902 * t915;
  t6225 = t2315 * t361;
  t6237 = t356 * t2327;
  t6244 = 0.24e2 * t2288 * t863 * t868 + 0.616e3 / 0.3e1 * t866 * params->eta * t2201 * t336 + 0.4e2 / 0.9e1 * t6188 * t6170 + 0.72e3 * t2315 * t903 * t863 + 0.12e3 * t902 * t357 * t2285 - 0.44e3 / 0.9e1 * t2312 * t6151 + 0.24e2 * t6199 * t340 + 0.3916e4 / 0.27e2 * t897 * t6158 - 0.2618e4 / 0.27e2 * t353 * t6148 - 0.132e4 * t2358 * t2359 * t818 + 0.2464e4 / 0.3e1 * t906 * t907 * t2201 + 0.48e2 * t906 * t2285 * params->eta * t315 + 0.84e3 * t6216 * t853 * t610 * t2369 + 0.168e3 * t2367 * t863 * t610 * t2369 + 0.96e3 * t6225 * t2316 * params->eta * t315 - 0.264e3 * t906 * t2363 * t818 - 0.1232e4 * t2367 * t2368 * t319 * t2206 + 0.896e3 / 0.3e1 * t6237 * t2289 * t2164 * t336 + 0.72e2 * t2274 * t2364;
  t6254 = t853 * t352;
  t6291 = -0.8e1 * t6254 * t868 - 0.4e2 / 0.27e2 * t6161 * t6170 + 0.176e3 / 0.3e1 * t2274 * t2293 + 0.88e2 / 0.3e1 * t2277 * t871 - 0.2464e4 / 0.27e2 * t857 * t2296 - 0.6e1 * t6121 * t141 - 0.8e1 * t1117 * t2285 - 0.2e1 * t332 * t6129 - 0.1958e4 / 0.27e2 * t866 * t6158 + 0.5236e4 / 0.81e2 * t339 * t6148 - 0.16e2 * t2812 * t863 * t340 + 0.88e2 / 0.3e1 * t2270 * t871 - 0.8e1 * t2273 * t863 * t868 - 0.64e2 / 0.9e1 * t6173 * t336 * t2290 - 0.16e2 / 0.3e1 * t856 * t2285 * t340 + 0.176e3 / 0.9e1 * t2288 * t6151;
  t6317 = t921 * t921;
  t6323 = t145 / t2185 / t157;
  t6324 = t881 * t881;
  t6328 = t343 * t921;
  t6335 = 0.6e1 * t170 * t6317 * t880 + 0.24e2 * t170 * t6323 * t6324 - 0.24e2 * t2187 * t2188 * t380 + 0.12e2 * t2253 * t331 * t343 - 0.4e1 * t2253 * t349 * t365 + 0.12e2 * t2299 * t331 * t380 - 0.72e2 * t2774 * t3321 * t874 + 0.72e2 * t2780 * t365 * t6328 + 0.18e2 * t331 * t874 * t945 + 0.36e2 * t841 * t842 * t945 - t6083;
  t6337 = t144 * t2186;
  t6378 = t143 * t879;
  t6391 = -0.72e2 * t2169 * t2259 * t365 - 0.36e2 * t2187 * t882 * t921 + 0.72e2 * t2195 * t850 * t881 + 0.36e2 * t2195 * t875 * t881 + 0.8e1 * t2375 * t366 * t880 + 0.72e2 * t6378 * t843 * t881 + 0.24e2 * t880 * t885 * t921 + t6079 + t6087 - t6089 + t6103;
  t6397 = t797 * t797;
  t6402 = t802 * t802;
  t6409 = my_piecewise5(t15, 0, t11, 0, -0.24e2 * t1652 + 0.24e2 * t5594);
  t6413 = my_piecewise3(t108, 0, 0.4e2 / 0.81e2 * t5582 * t6397 - 0.16e2 / 0.9e1 * t2073 * t802 + 0.4e1 / 0.3e1 * t698 * t6402 + 0.16e2 / 0.9e1 * t750 * t2143 + 0.4e1 / 0.3e1 * t109 * t6409);
  t6421 = -t5956 / 0.2e1 - 0.3e1 / 0.2e1 * t5964 - 0.3e1 / 0.2e1 * t5973 - t5983 / 0.2e1 + t5855 / 0.2e1 + t5867 + t5881 / 0.2e1 - 0.5e1 / 0.9e1 * t5734 - 0.5e1 / 0.9e1 * t5749 + t5621 - 0.9e1 / 0.4e1 * t6 * t807 * t947 - 0.3e1 / 0.2e1 * t6 * t308 * t2379 - 0.3e1 / 0.8e1 * t6 * t112 * (t159 * t6104 + 0.24e2 * t2256 * t380 + 0.18e2 * t841 * t170 * t6108 + 0.36e2 * t2794 * t875 - 0.24e2 * t6114 * t366 - t349 * t170 * (t6180 + t6244) - 0.6e1 * t349 * t945 * t921 - 0.4e1 * t349 * t380 * t2375 + 0.3e1 * t331 * t170 * t6291 + 0.12e2 * t880 * t945 * t881 + t6335 - 0.36e2 * t2169 * t843 * t921 - 0.72e2 * t6337 * t2189 * t343 - 0.36e2 * t846 * t2262 * t365 - 0.36e2 * t846 * t2265 * t365 + 0.24e2 * t841 * t344 * t2299 - 0.12e2 * t846 * t2300 * t365 - 0.12e2 * t846 * t344 * t2375 + 0.72e2 * t841 * t850 * t874 - 0.36e2 * t846 * t850 * t921 - 0.18e2 * t846 * t875 * t921 + t6391) - 0.3e1 / 0.8e1 * t6 * t6413 * t27 * t172 - 0.3e1 / 0.2e1 * t6 * t2148 * t382;
  t6422 = my_piecewise3(t103, 0, t6421);
  tv4rho44 = 0.4e1 * t2135 + 0.4e1 * t2384 + t7 * (t6016 + t6422);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t6430 = t6 * t1665 * t432;
  t6436 = t6 * t1672 * t432;
  t6439 = t6 * t539 * t1068;
  t6446 = 0.5e1 / 0.36e2 * t6 * t1684 * t432;
  t6448 = t6 * t548 * t1068;
  t6451 = t6 * t191 * t2654;
  t6458 = 0.154e4 / 0.6561e4 * t34 * t1699 * t49;
  t6462 = t204 * t1705;
  t6465 = t569 * t1721;
  t6468 = t569 * t1777;
  t6471 = t570 * t1761 * t34;
  t6492 = 0.506e4 / 0.531441e6 * t6462 * t966;
  t6494 = 0.1025e5 / 0.14348907e8 * t6465 * t2438;
  t6497 = 0.1246e5 / 0.3486784401e10 * t6468 * t1781 * t6471;
  t6502 = 0.532e4 / 0.847288609443e12 * t1774 / t36 / t5276 * t5285;
  t6503 = -0.154e4 / 0.6561e4 * t34 * t1699 * t94 + 0.1364e5 / 0.1594323e7 * t6462 * t1054 - 0.76e3 / 0.1594323e7 * t6465 * t2624 + 0.448e4 / 0.3486784401e10 * t6468 * t1756 * t6471 - 0.4256e4 / 0.3486784401e10 * t5241 * t6468 * t5244 * t570 * t34 + 0.2128e4 / 0.4782969e7 * t1758 * t1721 * t1761 * t205 - 0.1364e4 / 0.177147e6 * t679 * t203 * t1705 * t1058 + 0.1232e4 / 0.6561e4 * t260 * t33 * t1699 * t41 + t6458 - t6492 + t6494 - t6497 + t6502;
  t6527 = t1721 * t610 * t205;
  t6531 = t1705 * params->eta * sigma[0];
  t6534 = t210 * t606;
  t6535 = t6534 * sigma[0];
  t6538 = t5348 * t1822;
  t6539 = t574 * t222;
  t6540 = t6539 * t205;
  t6543 = t2561 * t222;
  t6547 = t1822 * t1721 * t205;
  t6551 = t610 * t1705 * sigma[0];
  t6560 = -0.9e1 / 0.2e1 * t2581 * t2505 - 0.19e2 / 0.6e1 * t1806 * t6527 + 0.341e3 / 0.27e2 * t599 * t6531 + 0.3e1 / 0.2e1 * t2594 * t6535 + 0.2e1 * t6538 * t6540 + 0.44e2 / 0.3e1 * t599 * t6543 - 0.19e2 / 0.3e1 * t1821 * t6547 + 0.341e3 / 0.18e2 * t609 * t6551 + 0.3e1 / 0.2e1 * t2581 * t2494 - 0.4e1 * t1803 * t1001 + 0.3e1 / 0.2e1 * t5464 * t998;
  t6561 = t1001 * t606;
  t6564 = t402 * t1818;
  t6568 = t5343 * t1777 * t570;
  t6571 = params->eta * t1699;
  t6574 = t606 * t74;
  t6577 = t222 * t238;
  t6581 = t1777 * t1822 * t570;
  t6584 = t563 * t222;
  t6585 = t6584 * sigma[0];
  t6588 = t1818 * t67;
  t6597 = -0.4e1 * t599 * t6561 + t599 * t6564 / 0.2e1 + 0.5e1 / 0.9e1 * t5358 * t6568 - 0.308e3 / 0.27e2 * t225 * t6571 + t6574 * t989 / 0.2e1 + t6577 * t2491 / 0.2e1 + 0.2e1 / 0.9e1 * t5348 * t6581 - 0.27e2 / 0.2e1 * t2594 * t6585 + t6588 * t39 / 0.4e1 - 0.2e1 * t2578 * t197 + 0.22e2 / 0.3e1 * t985 * t556 - 0.308e3 / 0.27e2 * t218 * t1699;
  t6602 = t420 * t665;
  t6609 = t420 * t618;
  t6613 = t1042 * t229;
  t6620 = t405 * t665;
  t6624 = t5564 * t96;
  t6629 = t1694 * t266;
  t6635 = -0.6e1 * t1712 * t430 * t1713 - t6458 + t85 * t6503 + 0.18e2 * t2650 * t982 + 0.18e2 * t2650 * t1005 + 0.9e1 * t217 * t2642 * t229 - 0.3e1 * t235 * t2642 * t251 + 0.3e1 * t217 * t1786 * t405 + 0.9e1 * t217 * t689 * t1004 + 0.9e1 * t217 * t266 * t2606 + 0.3e1 * t217 * t96 * (t6560 + t6597) + 0.18e2 * t2456 * t6602 * t229 - 0.18e2 * t3972 * t6602 * t251 + 0.18e2 * t2456 * t6609 * t251 + 0.36e2 * t2456 * t6613 * t251 - 0.18e2 * t2465 * t6609 * t229 + 0.18e2 * t2456 * t6620 * t251 + 0.36e2 * t6624 * t420 * t585 * t251 + 0.36e2 * t6629 * t2458 - 0.18e2 * t2465 * t6620 * t229;
  t6636 = t1726 * t266;
  t6650 = t5568 * t96;
  t6691 = 0.18e2 * t1005 * t1694 * t625 - 0.18e2 * t1014 * t1726 * t585 - 0.18e2 * t1043 * t1726 * t585 - 0.9e1 * t1043 * t589 * t618 + 0.18e2 * t1694 * t625 * t982 - 0.18e2 * t1713 * t406 * t5568 + 0.24e2 * t1713 * t421 * t5296 - 0.3e1 * t1833 * t421 * t589 - 0.18e2 * t229 * t2487 * t589 - 0.9e1 * t229 * t2576 * t589 - t6494;
  t6727 = t585 * t234;
  t6753 = 0.18e2 * t1005 * t584 * t618 - 0.9e1 * t1014 * t589 * t618 + 0.6e1 * t1043 * t624 * t665 - 0.9e1 * t1045 * t589 * t665 + 0.6e1 * t1048 * t624 * t665 + 0.18e2 * t1694 * t229 * t2644 + 0.6e1 * t1833 * t406 * t584 + 0.18e2 * t229 * t2607 * t584 - 0.9e1 * t229 * t2610 * t589 + 0.18e2 * t229 * t2612 * t584 + 0.36e2 * t229 * t2615 * t584 - 0.18e2 * t2481 * t251 * t589 - 0.9e1 * t2484 * t251 * t589 - 0.9e1 * t251 * t2607 * t589 - 0.9e1 * t251 * t2612 * t589 - 0.18e2 * t251 * t2615 * t589 + 0.18e2 * t584 * t618 * t982 - 0.9e1 * t589 * t665 * t982 + 0.18e2 * t2427 * t3474 - 0.18e2 * t6727 * t979;
  t6825 = t611 * t222;
  t6829 = t2567 * t222;
  t6834 = t5358 * t1822;
  t6837 = t1870 * t81;
  t6842 = -0.28e2 / 0.3e1 * t5411 * t6581 - 0.9e1 / 0.2e1 * t650 * t6564 - 0.14e2 * t5342 * t6568 + 0.133e3 / 0.2e1 * t1899 * t6527 + 0.36e2 * t650 * t6561 + 0.266e3 / 0.3e1 * t1851 * t6547 + 0.81e2 / 0.4e1 * t1806 * t563 * t2555 - 0.3e1 * t5348 * t574 * t6825 - 0.27e2 / 0.4e1 * t1806 * params->eta * t6829 - 0.9e1 / 0.2e1 * t2544 * t6535 - 0.15e2 / 0.2e1 * t6834 * t6540 - 0.45e2 * t6837 * t6829 - 0.132e3 * t650 * t6543;
  t6850 = t1001 * t596;
  t6853 = t1895 * sigma[0];
  t6857 = t210 * t596;
  t6886 = -0.2387e4 / 0.18e2 * t660 * t6551 - 0.341e3 / 0.3e1 * t650 * t6531 - 0.9e2 * t5390 * t402 * t1871 + 0.18e3 * t1890 * t6850 - 0.9e1 / 0.4e1 * t2554 * t6853 - 0.9e1 * t5348 * t610 * t6857 * sigma[0] + 0.81e2 / 0.2e1 * t2544 * t6585 - 0.63e2 / 0.2e1 * t1899 * t997 * t606 * sigma[0] - 0.84e2 * t5411 * t2497 * t222 * t205 - 0.45e2 / 0.2e1 * t1890 * t6534 * t62 - 0.105e3 / 0.2e1 * t5399 * t6539 * t611 - 0.135e3 / 0.2e1 * t1890 * t402 * t1882 - 0.9e2 * t5390 * t6857 * t62 + 0.405e3 / 0.2e1 * t1890 * t6584 * t62;
  t6923 = -0.315e3 / 0.2e1 * t5399 * t997 * t596 * sigma[0] + 0.567e3 / 0.2e1 * t1899 * t2514 * t2531 + 0.12e3 * t1870 * t1032 * t596 + 0.308e3 / 0.9e1 * t78 * t416 * t1699 + 0.19e2 / 0.2e1 * t1821 * t6527 + 0.9e1 * t609 * t6561 + 0.95e2 / 0.6e1 * t1867 * t6547 + 0.3e2 * t646 * t1032 * t606 - 0.5e1 / 0.6e1 * t5358 * t6581 - 0.9e1 / 0.8e1 * t609 * t6564 - 0.5e1 / 0.3e1 * t5425 * t6568 - 0.33e2 * t609 * t6543 - 0.341e3 / 0.9e1 * t641 * t6551 - 0.15e2 / 0.4e1 * t646 * t413 * t1818;
  t6958 = -0.11e3 * t646 * t2564 * t222 - 0.9e1 / 0.4e1 * t5464 * t989 - 0.341e3 / 0.12e2 * t609 * t6531 + 0.18e2 * t1806 * t6850 - 0.45e2 * t5327 * t413 * t1871 + 0.154e3 / 0.9e1 * t225 * t1699 + 0.6e1 * t1803 * t197 + 0.308e3 / 0.9e1 * t242 * t81 * t1699 - 0.9e1 / 0.4e1 * t5420 * t402 - 0.22e2 * t599 * t556 * t222 + 0.154e3 / 0.9e1 * t239 * t6571 + 0.6e1 * t599 * t197 * t606 - 0.9e1 / 0.4e1 * t2581 * t2567 - 0.3e1 / 0.4e1 * t599 * t39 * t1818;
  t6965 = 0.3e1 * t217 * t430 * t1833 - 0.3e1 * t235 * t1066 * t665 - t235 * t430 * t1909 + 0.6e1 * t624 * t1066 * t625 + 0.18e2 * t584 * t1066 * t585 + 0.6e1 * t1789 * t430 - t235 * t1786 * t420 - 0.3e1 * t235 * t689 * t1042 - 0.3e1 * t235 * t266 * t2575 - t235 * t96 * (t6842 + t6886 + t6923 + t6958) - 0.6e1 * t5438 * t421;
  t6973 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1661 * t432 - 0.3e1 / 0.8e1 * t6430 - 0.9e1 / 0.8e1 * t6 * t535 * t1068 + t6436 / 0.4e1 - 0.3e1 / 0.4e1 * t6439 - 0.9e1 / 0.8e1 * t6 * t185 * t2654 - t6446 + t6448 / 0.4e1 - 0.3e1 / 0.8e1 * t6451 - 0.3e1 / 0.8e1 * t6 * t28 * (-0.36e2 * t2465 * t1004 * t229 * t251 - 0.18e2 * t2465 * t405 * t618 * t251 - 0.18e2 * t1712 * t1014 * t625 - 0.18e2 * t1712 * t1043 * t625 - 0.54e2 * t6650 * t2457 * t625 + 0.36e2 * t6624 * t2466 * t625 - 0.36e2 * t6636 * t2467 + t6492 + t6497 - t6502 + t6635 + t6691 - 0.9e1 * t589 * t1005 * t665 + 0.6e1 * t624 * t1014 * t665 + 0.18e2 * t584 * t1045 * t618 + 0.9e1 * t217 * t1066 * t618 - 0.18e2 * t1726 * t2647 * t251 - 0.3e1 * t589 * t406 * t1909 + 0.2e1 * t624 * t421 * t1909 + 0.12e2 * t624 * t2487 * t251 + 0.6e1 * t624 * t2576 * t251 + 0.6e1 * t624 * t2610 * t251 + t6753 + t6965));
  tv4rho3sigma0 = t6973 * t7 + 0.3e1 * t2659;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t6980 = t6 * t1939 * t479;
  t6983 = t6 * t1943 * t479;
  t6987 = 0.5e1 / 0.36e2 * t6 * t1947 * t479;
  t6989 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t1935 * t479 - 0.3e1 / 0.8e1 * t6980 + t6983 / 0.4e1 - t6987);
  tv4rho3sigma2 = t6989 * t7 + 0.3e1 * t2672;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t6991 = 0.2e1 * t2686;
  t6997 = t6 * t1977 * t432 / 0.4e1;
  t7002 = t6 * t1984 * t432;
  t7006 = t6 * t739 * t1068 / 0.4e1;
  t7015 = -0.3e1 / 0.8e1 * t6 * t1973 * t432 - t6997 - 0.3e1 / 0.4e1 * t6 * t735 * t1068 + t7002 / 0.12e2 - t7006 - 0.3e1 / 0.8e1 * t6 * t297 * t2654 - t6430 / 0.8e1 + t6436 / 0.6e1 - t6439 / 0.4e1 - t6446 + t6448 / 0.6e1 - t6451 / 0.8e1;
  t7016 = my_piecewise3(t2, 0, t7015);
  tv4rho3sigma3 = t7 * t7016 + t2659 + t6991;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t7018 = 0.2e1 * t2702;
  t7024 = t6 * t2020 * t479 / 0.4e1;
  t7026 = t6 * t2024 * t479;
  t7035 = t6 * t714 * t1200 / 0.4e1;
  t7037 = t6 * t718 * t1200;
  t7040 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t2016 * t479 - t7024 + t7026 / 0.12e2 - t6980 / 0.8e1 + t6983 / 0.6e1 - t6987 - 0.3e1 / 0.8e1 * t6 * t710 * t1200 - t7035 + t7037 / 0.12e2);
  tv4rho3sigma5 = t7 * t7040 + t2672 + t7018;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t7046 = t6 * t2061 * t432;
  t7055 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2057 * t432 - t7046 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t790 * t1068 - t6997 + t7002 / 0.6e1 - t7006 + t6436 / 0.12e2 - t6446 + t6448 / 0.12e2);
  tv4rho3sigma6 = t7 * t7055 + t2710 + t6991;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t7061 = t6 * t2091 * t479;
  t7068 = t6 * t763 * t1200;
  t7076 = t6 * t284 * t2972;
  t7078 = -0.3e1 / 0.8e1 * t6 * t2087 * t479 - t7061 / 0.8e1 - t7024 + t7026 / 0.6e1 - 0.3e1 / 0.4e1 * t6 * t759 * t1200 - t7068 / 0.4e1 + t6983 / 0.12e2 - t6987 - t7035 + t7037 / 0.6e1 - 0.3e1 / 0.8e1 * t6 * t280 * t2972 - t7076 / 0.8e1;
  t7079 = my_piecewise3(t103, 0, t7078);
  tv4rho3sigma8 = t7 * t7079 + t2977 + t7018;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t7088 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2128 * t432 - 0.3e1 / 0.8e1 * t7046 + t7002 / 0.4e1 - t6446);
  tv4rho3sigma9 = t7 * t7088 + 0.3e1 * t2710;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t7120 = t569 * t2164;
  t7122 = 0.1025e5 / 0.14348907e8 * t7120 * t2771;
  t7165 = -0.9e1 * t1146 * t846 * t874 - 0.9e1 * t1175 * t846 * t874 + 0.6e1 * t1175 * t880 * t921 + 0.18e2 * t2803 * t343 * t841 - 0.9e1 * t2803 * t365 * t846 + 0.36e2 * t2806 * t343 * t841 - 0.18e2 * t2806 * t365 * t846 + 0.18e2 * t2851 * t343 * t841 - 0.9e1 * t2851 * t365 * t846 + 0.18e2 * t2854 * t343 * t841 - 0.9e1 * t2854 * t365 * t846 - 0.9e1 * t2860 * t343 * t846 + 0.6e1 * t2860 * t365 * t880 - 0.9e1 * t2935 * t343 * t846 - 0.18e2 * t2937 * t365 * t846 - 0.9e1 * t2940 * t343 * t846 + 0.6e1 * t2940 * t365 * t880 - 0.18e2 * t2942 * t343 * t846 + 0.12e2 * t2942 * t365 * t880 - t7122;
  t7210 = 0.532e4 / 0.847288609443e12 * t2241 / t114 / t6092 * t6101;
  t7225 = t204 * t2206;
  t7227 = 0.506e4 / 0.531441e6 * t7225 * t1098;
  t7228 = t6378 * t170;
  t7232 = 0.18e2 * t1114 * t841 * t874 - 0.9e1 * t1114 * t846 * t921 + 0.18e2 * t1137 * t841 * t874 - 0.9e1 * t1137 * t846 * t921 + 0.6e1 * t2299 * t453 * t841 + 0.2e1 * t2375 * t468 * t880 + 0.36e2 * t2775 * t7228 * t881 - 0.18e2 * t4026 * t4141 * t921 + 0.18e2 * t2721 * t3663 - t7210 + t7227;
  t7235 = t6337 * t170;
  t7239 = t2195 * t380;
  t7242 = t1174 * t343;
  t7246 = t467 * t874;
  t7263 = t569 * t2244;
  t7266 = t829 * t1761 * t34;
  t7268 = 0.1246e5 / 0.3486784401e10 * t7263 * t2248 * t7266;
  t7272 = t2169 * t380;
  t7294 = params->eta * t2200;
  t7297 = t863 * t148;
  t7300 = t336 * t352;
  t7304 = t2244 * t1822 * t829;
  t7313 = t1133 * t863;
  t7316 = t449 * t2285;
  t7320 = t5343 * t2244 * t829;
  t7323 = t324 * t863;
  t7324 = t7323 * sigma[2];
  t7327 = -0.308e3 / 0.27e2 * t339 * t7294 + t7297 * t1121 / 0.2e1 + t7300 * t2818 / 0.2e1 + 0.2e1 / 0.9e1 * t6173 * t7304 + 0.3e1 / 0.2e1 * t2812 * t2836 - 0.4e1 * t2270 * t1133 + 0.3e1 / 0.2e1 * t6254 * t1130 - 0.4e1 * t856 * t7313 + t856 * t7316 / 0.2e1 + 0.5e1 / 0.9e1 * t6161 * t7320 + 0.3e1 / 0.2e1 * t2829 * t7324;
  t7328 = t6173 * t1822;
  t7330 = t833 * t336 * t319;
  t7333 = t2847 * t336;
  t7337 = t1822 * t2164 * t319;
  t7341 = t610 * t2206 * sigma[2];
  t7347 = t2164 * t610 * t319;
  t7351 = t2206 * params->eta * sigma[2];
  t7354 = t824 * t336;
  t7355 = t7354 * sigma[2];
  t7358 = t2285 * t141;
  t7367 = 0.2e1 * t7328 * t7330 + 0.44e2 / 0.3e1 * t856 * t7333 - 0.19e2 / 0.3e1 * t2288 * t7337 + 0.341e3 / 0.18e2 * t866 * t7341 - 0.9e1 / 0.2e1 * t2812 * t2822 - 0.19e2 / 0.6e1 * t2273 * t7347 + 0.341e3 / 0.27e2 * t856 * t7351 - 0.27e2 / 0.2e1 * t2829 * t7355 + t7358 * t117 / 0.4e1 - 0.2e1 * t2809 * t314 + 0.22e2 / 0.3e1 * t1117 * t817 - 0.308e3 / 0.27e2 * t332 * t2200;
  t7378 = -0.54e2 * t7235 * t2781 * t881 + 0.36e2 * t7239 * t2782 + 0.36e2 * t2780 * t7242 * t365 + 0.18e2 * t2780 * t7246 * t365 + 0.18e2 * t2780 * t2781 * t921 + 0.18e2 * t2780 * t4018 * t921 + 0.36e2 * t7228 * t467 * t842 * t365 - 0.18e2 * t2774 * t2781 * t874 + t7268 - 0.18e2 * t2774 * t2775 * t921 - 0.36e2 * t7272 * t2776 - 0.36e2 * t2774 * t1136 * t343 * t365 - 0.18e2 * t2774 * t452 * t874 * t365 - t349 * t2253 * t467 - 0.3e1 * t349 * t945 * t1174 + 0.9e1 * t331 * t2969 * t343 - 0.3e1 * t349 * t2969 * t365 + 0.3e1 * t331 * t170 * (t7327 + t7367) + 0.9e1 * t331 * t945 * t1136 + 0.9e1 * t331 * t380 * t2850;
  t7403 = t324 * t853;
  t7410 = t319 * t336;
  t7432 = 0.567e3 / 0.2e1 * t2367 * t2843 * t2914 - 0.45e2 / 0.2e1 * t2358 * t7323 * t136 - 0.315e3 / 0.2e1 * t6216 * t1129 * t853 * sigma[2] - 0.9e2 * t6225 * t7403 * t136 + 0.405e3 / 0.2e1 * t2358 * t7354 * t136 - 0.105e3 / 0.2e1 * t6216 * t2817 * t7410 - 0.135e3 / 0.2e1 * t2358 * t449 * t2348 - 0.63e2 / 0.2e1 * t2367 * t1129 * t863 * sigma[2] - 0.84e2 * t6237 * t2839 * t7410 - 0.9e1 / 0.2e1 * t906 * t7316 - 0.14e2 * t6168 * t7320 - 0.132e3 * t906 * t7333 - 0.2387e4 / 0.18e2 * t916 * t7341;
  t7434 = t2368 * t319;
  t7438 = t1148 * t863;
  t7449 = t2363 * sigma[2];
  t7454 = t2315 * t155;
  t7464 = t1133 * t853;
  t7471 = -0.3e1 * t6173 * t833 * t7434 - 0.27e2 / 0.4e1 * t2273 * params->eta * t7438 - 0.9e1 * t6173 * t610 * t7403 * sigma[2] - 0.9e1 / 0.2e1 * t2900 * t7324 - 0.15e2 / 0.2e1 * t6162 * t7330 - 0.9e1 / 0.4e1 * t2896 * t7449 + 0.81e2 / 0.2e1 * t2900 * t7355 - 0.45e2 * t7454 * t7438 - 0.28e2 / 0.3e1 * t6237 * t7304 - 0.341e3 / 0.3e1 * t906 * t7351 - 0.9e2 * t6225 * t449 * t2316 + 0.18e3 * t2358 * t7464 + 0.133e3 / 0.2e1 * t2367 * t7347 + 0.36e2 * t906 * t7313;
  t7508 = 0.266e3 / 0.3e1 * t2328 * t7337 + 0.81e2 / 0.4e1 * t2273 * t824 * t2897 - 0.9e1 / 0.4e1 * t2812 * t2926 - 0.3e1 / 0.4e1 * t856 * t117 * t2285 - 0.22e2 * t856 * t817 * t336 + 0.154e3 / 0.9e1 * t353 * t7294 + 0.308e3 / 0.9e1 * t356 * t155 * t2200 + 0.6e1 * t856 * t314 * t863 - 0.9e1 / 0.4e1 * t6199 * t449 + 0.154e3 / 0.9e1 * t339 * t2200 + 0.6e1 * t2270 * t314 + 0.12e3 * t2315 * t1164 * t853 - 0.11e3 * t902 * t2920 * t336 - 0.341e3 / 0.12e2 * t866 * t7351;
  t7541 = 0.95e2 / 0.6e1 * t2312 * t7337 + 0.3e2 * t902 * t1164 * t863 + 0.19e2 / 0.2e1 * t2288 * t7347 + 0.9e1 * t866 * t7313 - 0.15e2 / 0.4e1 * t902 * t460 * t2285 - 0.5e1 / 0.6e1 * t6161 * t7304 - 0.9e1 / 0.8e1 * t866 * t7316 - 0.5e1 / 0.3e1 * t6188 * t7320 - 0.9e1 / 0.4e1 * t6254 * t1121 + 0.308e3 / 0.9e1 * t152 * t463 * t2200 + 0.18e2 * t2273 * t7464 - 0.33e2 * t866 * t7333 - 0.341e3 / 0.9e1 * t897 * t7341 - 0.45e2 * t6141 * t460 * t2316;
  t7565 = t842 * t348;
  t7570 = 0.154e4 / 0.6561e4 * t34 * t2200 * t126;
  t7598 = -0.154e4 / 0.6561e4 * t34 * t2200 * t168 + 0.1364e5 / 0.1594323e7 * t7225 * t1186 - 0.76e3 / 0.1594323e7 * t7120 * t2954 + 0.448e4 / 0.3486784401e10 * t7263 * t2225 * t7266 - 0.4256e4 / 0.3486784401e10 * t6059 * t7263 * t5244 * t829 * t34 + 0.2128e4 / 0.4782969e7 * t2227 * t2164 * t1761 * t319 - 0.1364e4 / 0.177147e6 * t935 * t203 * t2206 * t1190 + 0.1232e4 / 0.6561e4 * t374 * t33 * t2200 * t41 + t7570 - t7227 + t7122 - t7268 + t7210;
  t7614 = 0.18e2 * t1177 * t2195 * t881 + 0.18e2 * t1198 * t841 * t842 + 0.6e1 * t1198 * t880 * t881 - 0.6e1 * t2187 * t2188 * t477 + 0.24e2 * t2188 * t468 * t6323 + 0.6e1 * t2935 * t365 * t880 - 0.18e2 * t1111 * t7565 + t159 * t7598 + 0.6e1 * t2256 * t477 - 0.6e1 * t468 * t6114 - t7570;
  t7622 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t2148 * t479 - 0.3e1 / 0.8e1 * t7061 - 0.9e1 / 0.8e1 * t6 * t807 * t1200 + t7026 / 0.4e1 - 0.3e1 / 0.4e1 * t7068 - 0.9e1 / 0.8e1 * t6 * t308 * t2972 - t6987 + t7037 / 0.4e1 - 0.3e1 / 0.8e1 * t7076 - 0.3e1 / 0.8e1 * t6 * t112 * (0.18e2 * t2195 * t1114 * t881 + 0.18e2 * t2195 * t1137 * t881 - 0.18e2 * t2169 * t1146 * t842 - 0.18e2 * t2187 * t1146 * t881 + 0.6e1 * t880 * t1146 * t921 - 0.18e2 * t2169 * t1175 * t842 - 0.18e2 * t2187 * t1175 * t881 - 0.18e2 * t2169 * t2800 * t365 - 0.3e1 * t846 * t468 * t2299 - 0.3e1 * t846 * t453 * t2375 + t7165 + t7232 + t7378 - t349 * t477 * t2375 + 0.3e1 * t331 * t2253 * t452 - 0.18e2 * t6337 * t453 * t2188 + 0.3e1 * t331 * t477 * t2299 - 0.3e1 * t349 * t1198 * t921 - t349 * t170 * (t7432 + t7471 + t7508 + t7541) + 0.9e1 * t331 * t1198 * t874 - 0.3e1 * t349 * t380 * t2934 + 0.18e2 * t2794 * t1114 + 0.18e2 * t2794 * t1137 + t7614));
  tv4rho3sigma11 = t7 * t7622 + 0.3e1 * t2977;

  if(out->v4rho3sigma != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  tv4rho3lapl0 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 0] += tv4rho3lapl0;

  tv4rho3lapl1 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 1] += tv4rho3lapl1;

  tv4rho3lapl2 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 2] += tv4rho3lapl2;

  tv4rho3lapl3 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 3] += tv4rho3lapl3;

  tv4rho3lapl4 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 4] += tv4rho3lapl4;

  tv4rho3lapl5 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 5] += tv4rho3lapl5;

  tv4rho3lapl6 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 6] += tv4rho3lapl6;

  tv4rho3lapl7 = 0.e0;

  if(out->v4rho3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3lapl[ip*p->dim.v4rho3lapl + 7] += tv4rho3lapl7;

  t7629 = t6 * t1665 * t496;
  t7635 = t6 * t1672 * t496;
  t7638 = t6 * t539 * t1262;
  t7645 = 0.5e1 / 0.36e2 * t6 * t1684 * t496;
  t7647 = t6 * t548 * t1262;
  t7650 = t6 * t191 * t3146;
  t7654 = t251 * t610;
  t7659 = t584 * t3093;
  t7662 = t584 * t3097;
  t7665 = t618 * params->eta;
  t7670 = t229 * t610;
  t7675 = t589 * t3093;
  t7678 = t589 * t3097;
  t7681 = t665 * params->eta;
  t7692 = t625 * params->eta;
  t7697 = -0.24e2 * t1231 * t2997 * t7665 * sigma[0] + 0.12e2 * t1231 * t3003 * t7681 * sigma[0] - 0.24e2 * t1231 * t3855 * t7692 * sigma[0] - 0.24e2 * t205 * t2997 * t3101 * t7670 + 0.12e2 * t205 * t3003 * t3101 * t7654 + 0.168e3 * t2997 * t2999 * t3105 - 0.84e2 * t3003 * t3005 * t3105 - 0.48e2 * t3000 * t7659 - 0.48e2 * t3000 * t7662 + 0.24e2 * t3006 * t7675 + 0.24e2 * t3006 * t7678 - 0.6e1 * t494 * t5438;
  t7717 = 0.18e2 * t2581 * t3118 + 0.6e1 * t599 * t54 * t1818 - 0.64e2 * t2492 - 0.15e3 * t2502 + 0.439e3 / 0.3e1 * t2506 - 0.6e3 * t2519 + 0.4e3 * t2522 - 0.126e4 * t2529 + 0.1756e4 / 0.3e1 * t2535 - 0.448e3 * t2548 - 0.126e3 * t2556 + 0.36e3 * t5327 * t490 * t1871 + 0.18e2 * t5464 * t1249;
  t7718 = t2472 * t1822;
  t7719 = t7718 * t570;
  t7732 = t5348 * t971;
  t7748 = t971 * t222;
  t7752 = 0.2e2 / 0.3e1 * t5358 * t7719 + 0.3e2 * t646 * t490 * t1818 + 0.8e2 * t2559 - 0.88e3 / 0.9e1 * t2565 - 0.3e2 * t2568 - 0.3e2 * t2570 - 0.44e3 / 0.9e1 * t2572 + 0.18e2 * t3114 * t6853 + 0.24e2 * t7732 * t6825 + 0.36e3 * t6837 * t1245 * t606 + 0.224e3 / 0.3e1 * t5411 * t7719 + 0.72e3 * t5390 * t396 * t596 * t62 + 0.18e3 * t1890 * t396 * t606 * t62 + 0.42e3 * t5399 * t7748 * t611;
  t7764 = t1229 * t74;
  t7765 = t1726 * t7764;
  t7789 = t6727 * t96;
  t7792 = -t235 * t96 * (t7717 + t7752) - 0.3e1 * t235 * t689 * t1259 - 0.3e1 * t235 * t266 * t3142 - t235 * t1786 * t493 + 0.48e2 * t7765 * t396 * t229 * t3005 - 0.36e2 * t6629 * t3048 - 0.36e2 * t2456 * t985 * t3047 - 0.3e2 * t1218 * t218 * t39 * t665 - 0.16e3 * t1213 * t218 * t197 * t229 + 0.8e2 * t1218 * t218 * t197 * t251 - 0.36e2 * t3835 * t3063 + 0.36e2 * t7789 * t1220;
  t7828 = t584 * t689;
  t7831 = 0.6e2 * t1213 * t218 * t39 * t618 + 0.6e1 * t1218 * t1909 * t218 * t54 + 0.36e2 * t1713 * t218 * t54 * t6650 + 0.6e2 * t218 * t2456 * t39 * t625 - 0.36e2 * t1213 * t1214 * t2578 + 0.12e3 * t1213 * t3043 * t985 + 0.18e2 * t1218 * t1219 * t2578 - 0.6e2 * t1218 * t3051 * t985 - 0.36e2 * t1215 * t7828 + 0.36e2 * t3033 * t3036 - 0.6e2 * t3033 * t3052 + 0.12e3 * t3044 * t3056;
  t7832 = t589 * t689;
  t7870 = -0.9e1 * t1243 * t589 * t618 + 0.6e1 * t1243 * t624 * t665 - 0.9e1 * t1260 * t589 * t618 - 0.3e1 * t1833 * t494 * t589 + 0.2e1 * t1909 * t494 * t624 - 0.9e1 * t229 * t2995 * t589 - 0.18e2 * t229 * t3109 * t589 - 0.9e1 * t229 * t3143 * t589 + 0.6e1 * t251 * t2995 * t624 + 0.12e2 * t251 * t3109 * t624 + 0.6e1 * t251 * t3143 * t624 + 0.18e2 * t1220 * t7832 - 0.72e2 * t3056 * t3059;
  t7902 = 0.6e1 * t624 * t1260 * t665 - 0.8e2 * t484 * t2584 + 0.88e3 / 0.9e1 * t484 * t2590 + 0.3e2 * t484 * t2579 - 0.8e2 * t1223 * t992 + 0.3e2 * t3075 * t401 + 0.6e2 * t1223 * t986 + 0.6e2 * t3072 * t401 - 0.18e2 * t1712 * t1243 * t625 - 0.18e2 * t1712 * t1260 * t625 - 0.18e2 * t1726 * t1260 * t585 - 0.18e2 * t1726 * t1243 * t585;
  t7906 = t1259 * t229;
  t7910 = t493 * t618;
  t7926 = t493 * t625;
  t7942 = 0.36e2 * t251 * t493 * t585 * t6624 + 0.24e2 * t1713 * t494 * t5296 - 0.6e1 * t1786 * t217 * t485 - 0.18e2 * t229 * t2465 * t7910 - 0.54e2 * t229 * t6650 * t7926 + 0.36e2 * t2456 * t251 * t7906 + 0.18e2 * t2456 * t251 * t7910 - 0.36e2 * t2650 * t266 * t485 - 0.6e1 * t484 * t54 * t6588 - 0.18e2 * t1223 * t3080 - 0.36e2 * t1226 * t3072 - 0.18e2 * t1226 * t3075 + 0.36e2 * t3084 * t6629;
  t7944 = t493 * t665;
  t7973 = t1726 * t3093;
  t7976 = t1726 * t3097;
  t7979 = 0.18e2 * t2456 * t7944 * t229 - 0.18e2 * t3972 * t7944 * t251 - 0.12e2 * t1213 * t218 * t54 * t1833 + 0.18e2 * t3033 * t3040 + 0.18e2 * t1218 * t985 * t3039 - 0.36e2 * t3056 * t3063 - 0.36e2 * t1213 * t985 * t3062 - 0.12e2 * t3094 * t3102 - 0.12e2 * t3098 * t3102 - 0.16e2 / 0.3e1 * t1230 * t640 * t2472 * t1823 + 0.72e2 * t7973 * t3090 + 0.72e2 * t7976 * t3090;
  t8016 = t5564 * t1229;
  t8021 = t67 * t39;
  t8028 = 0.36e2 * t3087 * t3088 * t618 * t251 + 0.36e2 * t3087 * t3088 * t665 * t229 - 0.36e2 * t3855 * t3088 * t665 * t251 + 0.84e2 * t3094 * t3106 + 0.84e2 * t3098 * t3106 + 0.64e2 * t1230 * t238 * t574 * t611 - 0.12e2 * t217 * t689 * t57 * t1232 - 0.24e2 * t217 * t266 * t222 * t1232 - 0.12e2 * t217 * t96 * t606 * t1232 - 0.1756e4 / 0.9e1 * t1230 * t74 * t563 * t62 - 0.72e2 * t8016 * t3088 * t229 * t625 - 0.12e3 * t3087 * t8021 * t3089 - 0.24e2 * t2650 * t1229 * t1232;
  t8036 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1661 * t496 - 0.3e1 / 0.8e1 * t7629 - 0.9e1 / 0.8e1 * t6 * t535 * t1262 + t7635 / 0.4e1 - 0.3e1 / 0.4e1 * t7638 - 0.9e1 / 0.8e1 * t6 * t185 * t3146 - t7645 + t7647 / 0.4e1 - 0.3e1 / 0.8e1 * t7650 - 0.3e1 / 0.8e1 * t6 * t28 * (t7697 + t7792 + t7831 + t7870 + t7902 + t7942 + t7979 + t8028));
  tv4rho3tau0 = t7 * t8036 + 0.3e1 * t3151;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 0] += tv4rho3tau0;

  t8043 = t6 * t1939 * t513;
  t8046 = t6 * t1943 * t513;
  t8050 = 0.5e1 / 0.36e2 * t6 * t1947 * t513;
  t8052 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t1935 * t513 - 0.3e1 / 0.8e1 * t8043 + t8046 / 0.4e1 - t8050);
  tv4rho3tau1 = t7 * t8052 + 0.3e1 * t3164;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 1] += tv4rho3tau1;

  t8054 = 0.2e1 * t3178;
  t8060 = t6 * t1977 * t496 / 0.4e1;
  t8065 = t6 * t1984 * t496;
  t8069 = t6 * t739 * t1262 / 0.4e1;
  t8078 = -0.3e1 / 0.8e1 * t6 * t1973 * t496 - t8060 - 0.3e1 / 0.4e1 * t6 * t735 * t1262 + t8065 / 0.12e2 - t8069 - 0.3e1 / 0.8e1 * t6 * t297 * t3146 - t7629 / 0.8e1 + t7635 / 0.6e1 - t7638 / 0.4e1 - t7645 + t7647 / 0.6e1 - t7650 / 0.8e1;
  t8079 = my_piecewise3(t2, 0, t8078);
  tv4rho3tau2 = t7 * t8079 + t3151 + t8054;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 2] += tv4rho3tau2;

  t8081 = 0.2e1 * t3194;
  t8087 = t6 * t2020 * t513 / 0.4e1;
  t8089 = t6 * t2024 * t513;
  t8098 = t6 * t714 * t1336 / 0.4e1;
  t8100 = t6 * t718 * t1336;
  t8103 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t2016 * t513 - t8087 + t8089 / 0.12e2 - t8043 / 0.8e1 + t8046 / 0.6e1 - t8050 - 0.3e1 / 0.8e1 * t6 * t710 * t1336 - t8098 + t8100 / 0.12e2);
  tv4rho3tau3 = t7 * t8103 + t3164 + t8081;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 3] += tv4rho3tau3;

  t8109 = t6 * t2061 * t496;
  t8118 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2057 * t496 - t8109 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t790 * t1262 - t8060 + t8065 / 0.6e1 - t8069 + t7635 / 0.12e2 - t7645 + t7647 / 0.12e2);
  tv4rho3tau4 = t7 * t8118 + t3202 + t8054;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 4] += tv4rho3tau4;

  t8124 = t6 * t2091 * t513;
  t8131 = t6 * t763 * t1336;
  t8139 = t6 * t284 * t3364;
  t8141 = -0.3e1 / 0.8e1 * t6 * t2087 * t513 - t8124 / 0.8e1 - t8087 + t8089 / 0.6e1 - 0.3e1 / 0.4e1 * t6 * t759 * t1336 - t8131 / 0.4e1 + t8046 / 0.12e2 - t8050 - t8098 + t8100 / 0.6e1 - 0.3e1 / 0.8e1 * t6 * t280 * t3364 - t8139 / 0.8e1;
  t8142 = my_piecewise3(t103, 0, t8141);
  tv4rho3tau5 = t7 * t8142 + t3369 + t8081;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 5] += tv4rho3tau5;

  t8151 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2128 * t496 - 0.3e1 / 0.8e1 * t8109 + t8065 / 0.4e1 - t7645);
  tv4rho3tau6 = t7 * t8151 + 0.3e1 * t3202;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 6] += tv4rho3tau6;

  t8188 = 0.18e2 * t2812 * t3334 + 0.6e1 * t856 * t131 * t2285 - 0.6e3 * t2865 + 0.4e3 * t2868 + 0.439e3 / 0.3e1 * t2873 - 0.15e3 * t2881 - 0.64e2 * t2883 - 0.448e3 * t2889 - 0.126e3 * t2898 + 0.1756e4 / 0.3e1 * t2905 - 0.126e4 * t2912 - 0.88e3 / 0.9e1 * t2921 + 0.8e2 * t2924;
  t8197 = t2790 * t1822;
  t8198 = t8197 * t829;
  t8204 = t6173 * t1103;
  t8222 = t1103 * t336;
  t8226 = -0.3e2 * t2927 - 0.3e2 * t2929 - 0.44e3 / 0.9e1 * t2931 + 0.36e3 * t6141 * t507 * t2316 + 0.18e2 * t6254 * t1323 + 0.2e2 / 0.3e1 * t6161 * t8198 + 0.3e2 * t902 * t507 * t2285 + 0.24e2 * t8204 * t7434 + 0.36e3 * t7454 * t1319 * t863 + 0.224e3 / 0.3e1 * t6237 * t8198 + 0.18e2 * t3330 * t7449 + 0.72e3 * t6225 * t443 * t853 * t136 + 0.18e3 * t2358 * t443 * t863 * t136 + 0.42e3 * t6216 * t8222 * t867;
  t8242 = t1303 * t148;
  t8243 = t2169 * t8242;
  t8257 = 0.88e3 / 0.9e1 * t501 * t2825 + 0.6e2 * t3260 * t448 - t349 * t170 * (t8188 + t8226) - 0.3e1 * t349 * t380 * t3358 - t349 * t2253 * t510 - 0.3e1 * t349 * t945 * t1333 - 0.8e2 * t501 * t2815 - 0.6e1 * t6114 * t511 + 0.48e2 * t8243 * t443 * t343 * t3245 - 0.18e2 * t2187 * t1317 * t881 - 0.18e2 * t2187 * t1334 * t881 - 0.18e2 * t2169 * t1334 * t842;
  t8294 = -0.18e2 * t1317 * t2169 * t842 - 0.9e1 * t1317 * t846 * t874 + 0.6e1 * t1317 * t880 * t921 - 0.9e1 * t1334 * t846 * t874 + 0.6e1 * t1334 * t880 * t921 + 0.24e2 * t2188 * t511 * t6323 - 0.3e1 * t2299 * t511 * t846 + 0.2e1 * t2375 * t511 * t880 + 0.12e2 * t3325 * t365 * t880 - 0.9e1 * t3359 * t343 * t846 + 0.6e1 * t3359 * t365 * t880 + 0.6e1 * t3361 * t365 * t880;
  t8331 = t2169 * t3307;
  t8334 = 0.64e2 * t1304 * t352 * t833 * t867 - 0.12e2 * t1306 * t134 * t331 * t945 - 0.12e2 * t1306 * t170 * t331 * t863 - 0.24e2 * t1306 * t331 * t336 * t380 - 0.36e2 * t3320 * t365 * t4025 * t921 + 0.36e2 * t3319 * t3320 * t6328 - 0.18e2 * t3325 * t343 * t846 - 0.9e1 * t3361 * t343 * t846 + 0.84e2 * t3304 * t3312 - 0.12e2 * t3308 * t3316 - 0.12e2 * t3312 * t3316 + 0.72e2 * t3322 * t8331;
  t8335 = t2169 * t3311;
  t8355 = t6378 * t1303;
  t8360 = t141 * t117;
  t8364 = t881 * params->eta;
  t8372 = t841 * t3311;
  t8375 = t874 * params->eta;
  t8380 = t343 * t610;
  t8385 = 0.72e2 * t8335 * t3322 + 0.84e2 * t3308 * t3304 - 0.1756e4 / 0.9e1 * t1304 * t148 * t824 * t136 - 0.24e2 * t2794 * t1303 * t1306 - 0.16e2 / 0.3e1 * t1304 * t896 * t2790 * t2289 + 0.36e2 * t3319 * t3320 * t874 * t365 - 0.72e2 * t8355 * t3320 * t343 * t881 - 0.12e3 * t3319 * t8360 * t3321 - 0.24e2 * t4025 * t1305 * t8364 * sigma[2] - 0.84e2 * t3243 * t3303 * t3245 - 0.48e2 * t8372 * t3240 - 0.24e2 * t3237 * t1305 * t8375 * sigma[2] - 0.24e2 * t3237 * t3315 * t8380 * t319;
  t8388 = t846 * t3307;
  t8391 = t846 * t3311;
  t8394 = t921 * params->eta;
  t8399 = t365 * t610;
  t8404 = t841 * t3307;
  t8418 = t510 * t921;
  t8425 = 0.12e2 * t1305 * t3243 * t8394 * sigma[2] + 0.12e2 * t319 * t3243 * t3315 * t8399 + 0.18e2 * t2780 * t343 * t8418 + 0.168e3 * t3237 * t3239 * t3303 - 0.18e2 * t365 * t4141 * t8418 + 0.6e2 * t1118 * t1297 - 0.8e2 * t1124 * t1297 + 0.3e2 * t2810 * t501 - 0.48e2 * t3240 * t8404 + 0.24e2 * t3246 * t8388 + 0.24e2 * t3246 * t8391 + 0.3e2 * t3268 * t448;
  t8433 = t1333 * t343;
  t8437 = t510 * t874;
  t8465 = 0.36e2 * t7228 * t510 * t842 * t365 - 0.54e2 * t7235 * t3263 * t881 + 0.36e2 * t2780 * t8433 * t365 - 0.18e2 * t2774 * t8437 * t343 + 0.18e2 * t2780 * t8437 * t365 - 0.36e2 * t3260 * t1300 + 0.36e2 * t7239 * t3264 - 0.6e1 * t331 * t2253 * t502 - 0.18e2 * t3268 * t1300 - 0.18e2 * t1297 * t3251 - 0.6e1 * t501 * t7358 * t131 - 0.36e2 * t2794 * t380 * t502 - 0.3e2 * t1292 * t332 * t117 * t921;
  t8499 = t841 * t945;
  t8502 = 0.6e2 * t117 * t1287 * t332 * t874 + 0.6e2 * t117 * t2780 * t332 * t881 + 0.36e2 * t131 * t2188 * t332 * t7235 + 0.12e3 * t1117 * t1287 * t3275 - 0.36e2 * t1117 * t2780 * t3279 - 0.36e2 * t1287 * t1288 * t2809 + 0.18e2 * t1292 * t1293 * t2809 - 0.36e2 * t1289 * t8499 + 0.12e3 * t3276 * t3287 - 0.36e2 * t3280 * t7239 - 0.6e2 * t3284 * t3297 + 0.36e2 * t3297 * t3300;
  t8503 = t846 * t945;
  t8527 = t7565 * t170;
  t8542 = -0.12e2 * t1287 * t131 * t2299 * t332 - 0.16e3 * t1287 * t314 * t332 * t343 + 0.6e1 * t1292 * t131 * t2375 * t332 + 0.8e2 * t1292 * t314 * t332 * t365 - 0.36e2 * t1117 * t1287 * t3293 + 0.18e2 * t1117 * t1292 * t3271 - 0.6e2 * t1117 * t1292 * t3283 + 0.18e2 * t1294 * t8503 + 0.36e2 * t1294 * t8527 + 0.18e2 * t3272 * t3297 - 0.72e2 * t3287 * t3290 - 0.36e2 * t3287 * t3294 - 0.36e2 * t3294 * t4181;
  t8550 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t2148 * t513 - 0.3e1 / 0.8e1 * t8124 - 0.9e1 / 0.8e1 * t6 * t807 * t1336 + t8089 / 0.4e1 - 0.3e1 / 0.4e1 * t8131 - 0.9e1 / 0.8e1 * t6 * t308 * t3364 - t8050 + t8100 / 0.4e1 - 0.3e1 / 0.8e1 * t8139 - 0.3e1 / 0.8e1 * t6 * t112 * (t8257 + t8294 + t8334 + t8385 + t8425 + t8465 + t8502 + t8542));
  tv4rho3tau7 = t7 * t8550 + 0.3e1 * t3369;

  if(out->v4rho3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3tau[ip*p->dim.v4rho3tau + 7] += tv4rho3tau7;

  t8557 = t6 * t539 * t1409;
  t8564 = t6 * t548 * t1409 / 0.12e2;
  t8566 = t6 * t191 * t3565;
  t8570 = t1004 * t1004;
  t8602 = 0.12e2 * t1352 * t5564 * t625 + 0.12e2 * t1358 * t1694 * t625 + 0.6e1 * t1369 * t1694 * t625 + 0.12e2 * t1373 * t5564 * t585 - 0.12e2 * t1376 * t1712 * t625 - 0.6e1 * t1397 * t1712 * t625 + 0.6e1 * t1407 * t584 * t585 + 0.2e1 * t1407 * t624 * t625 + 0.12e2 * t584 * t8570 * t96 - 0.12e2 * t1355 * t6727 + 0.12e2 * t1358 * t2650 + 0.6e1 * t1369 * t2650;
  t8612 = t1042 * t1042;
  t8619 = t1372 * t229;
  t8625 = t1004 * t420;
  t8629 = t405 * t1042;
  t8642 = t1726 * t430;
  t8645 = 0.24e2 * t1373 * t5296 * t625 - 0.12e2 * t1376 * t1726 * t585 - 0.6e1 * t1397 * t1726 * t585 - 0.24e2 * t229 * t2465 * t8625 - 0.24e2 * t229 * t2465 * t8629 + 0.24e2 * t2456 * t251 * t8625 + 0.24e2 * t2456 * t251 * t8629 + 0.12e2 * t2456 * t3377 * t665 - 0.12e2 * t2465 * t3377 * t618 - 0.36e2 * t251 * t6650 * t8619 + 0.4e1 * t624 * t8612 * t96 - 0.24e2 * t2467 * t8642 + 0.24e2 * t3381 * t6629;
  t8653 = t1396 * t229;
  t8660 = t1694 * t430;
  t8673 = 0.76e3 / 0.531441e6 * t204 * t565;
  t8686 = -0.12e2 * t1368 * t229 * t2465 * t251 - 0.24e2 * t1004 * t2465 * t3848 + 0.24e2 * t1042 * t2456 * t2457 - 0.24e2 * t1042 * t3856 * t3972 - 0.6e1 * t1376 * t589 * t618 + 0.4e1 * t1376 * t624 * t665 - 0.12e2 * t229 * t3480 * t589 + 0.12e2 * t2456 * t251 * t8653 + 0.8e1 * t251 * t3480 * t624 + 0.8e1 * t251 * t3488 * t624 + 0.24e2 * t2458 * t8660 - 0.24e2 * t3378 * t6636 - t8673;
  t8718 = 0.835e3 / 0.4782969e7 * t2436 * t3510;
  t8725 = 0.8e1 * t1014 * t1042 * t624 - 0.6e1 * t1358 * t589 * t665 + 0.6e1 * t1369 * t584 * t618 + 0.6e1 * t1373 * t1694 * t618 - 0.6e1 * t1373 * t1712 * t665 + 0.12e2 * t1694 * t229 * t3485 - 0.12e2 * t1712 * t251 * t3485 + 0.12e2 * t229 * t3411 * t584 + 0.12e2 * t229 * t3420 * t584 - 0.12e2 * t229 * t3488 * t589 - 0.6e1 * t251 * t3420 * t589 + 0.4e1 * t2575 * t421 * t624 + t8718;
  t8764 = 0.24e2 * t1004 * t584 * t982 - 0.12e2 * t1005 * t1042 * t589 - 0.12e2 * t1042 * t589 * t982 + 0.12e2 * t1358 * t584 * t618 + 0.24e2 * t229 * t3414 * t584 + 0.24e2 * t229 * t3417 * t584 - 0.12e2 * t251 * t3414 * t589 - 0.12e2 * t251 * t3417 * t589 - 0.6e1 * t2575 * t406 * t589 - 0.6e1 * t2607 * t420 * t589 - 0.6e1 * t2612 * t420 * t589 - 0.12e2 * t2615 * t420 * t589;
  t8782 = t229 * t234;
  t8803 = -0.6e1 * t1352 * t1726 * t665 - 0.3e1 * t1369 * t589 * t665 - 0.3e1 * t1397 * t589 * t618 + 0.2e1 * t1397 * t624 * t665 - 0.12e2 * t1726 * t251 * t3477 - 0.6e1 * t229 * t3467 * t589 - 0.6e1 * t229 * t3483 * t589 - 0.6e1 * t251 * t3411 * t589 + 0.4e1 * t251 * t3467 * t624 + 0.4e1 * t251 * t3483 * t624 + 0.12e2 * t2606 * t406 * t584 + 0.24e2 * t3474 * t3537 - 0.12e2 * t3540 * t8782;
  t8814 = t569 * t2472;
  t8817 = t1761 * t205 * t34;
  t8819 = 0.875e3 / 0.774840978e9 * t8814 * t1781 * t8817;
  t8825 = 0.665e3 / 0.282429536481e12 * t571 / t36 / t572 / t561 * t5285;
  t8846 = t7718 * t205;
  t8849 = t2490 * sigma[0];
  t8856 = t7748 * sigma[0];
  t8859 = t997 * t222;
  t8862 = t1365 * t606;
  t8866 = t5343 * t2472 * t205;
  t8869 = t2497 * sigma[0];
  t8874 = -0.19e2 / 0.18e2 * t563 * t67 + 0.43e2 / 0.144e3 * t574 * t74 * t62 - t2472 * t238 * t611 / 0.48e2 - t6574 * t1248 / 0.8e1 - t6577 * t3396 / 0.4e1 + 0.4e1 / 0.3e1 * t2581 * t988 - t5348 * t8846 / 0.6e1 + 0.43e2 / 0.24e2 * t1806 * t8849 - 0.38e2 / 0.9e1 * t599 * t2504 - 0.3e1 / 0.16e2 * t5464 * t1365 - t6538 * t8856 / 0.2e1 + 0.2e1 * t1806 * t8859 - 0.3e1 / 0.16e2 * t1806 * t8862 - 0.5e1 / 0.24e2 * t5358 * t8866 + 0.43e2 / 0.24e2 * t1821 * t8869 - 0.19e2 / 0.6e1 * t609 * t2514;
  t8893 = -0.4e1 * t1042 * t1066 * t235 + 0.3e1 * t1368 * t217 * t689 + 0.2e1 * t1372 * t624 * t689 + 0.6e1 * t217 * t229 * t3513 + 0.6e1 * t217 * t266 * t3410 + 0.3e1 * t217 * t8874 * t96 - 0.2e1 * t235 * t251 * t3513 - 0.2e1 * t235 * t2642 * t420 - 0.6e1 * t251 * t3469 * t589 + 0.48e2 * t3089 * t3377 * t6624 - 0.36e2 * t3377 * t625 * t6650 - t8819 + t8825;
  t8910 = t574 * params->eta * sigma[0];
  t8913 = t988 * t222;
  t8918 = t1365 * t596;
  t8937 = t2472 * t610 * t205;
  t8940 = t1248 * t606;
  t8958 = 0.38e2 * t242 * t247 * t563 * params->eta + 0.133e3 / 0.6e1 * t78 * t1392 * t563 - 0.43e2 / 0.32e2 * t1806 * t8910 - 0.6e1 * t1806 * t8913 - 0.43e2 / 0.8e1 * t1821 * t8849 + 0.9e1 / 0.8e1 * t5348 * t8918 - 0.6e1 * t1821 * t8859 - 0.215e3 / 0.48e2 * t1867 * t8869 + 0.45e2 / 0.8e1 * t5327 * t1385 * t596 - 0.2e2 * t1870 * t3448 * t222 + 0.15e2 / 0.8e1 * t1870 * t1385 * t606 + 0.3e1 / 0.16e2 * t6577 * t3426 + t5348 * t8937 / 0.8e1 + 0.9e1 / 0.16e2 * t1806 * t8940 + 0.5e1 / 0.8e1 * t5358 * t8846 + 0.9e1 / 0.16e2 * t1821 * t8862 + 0.5e1 / 0.8e1 * t5425 * t8866 + 0.21e2 * t5411 * t3404 * t2531 + 0.15e2 / 0.2e1 * t5390 * t7748 * t62 + 0.105e3 / 0.4e1 * t5399 * t3121 * t2531;
  t8961 = t1900 * sigma[0];
  t9004 = 0.315e3 / 0.16e2 * t5399 * t8918 + 0.45e2 / 0.8e1 * t1890 * t8940 + 0.7e1 * t5411 * t8846 + 0.63e2 / 0.16e2 * t1899 * t8862 + 0.19e2 / 0.3e1 * t641 * t2514 + 0.95e2 / 0.6e1 * t646 * t81 * t563 + 0.9e1 / 0.16e2 * t5464 * t1248 + 0.19e2 / 0.2e1 * t609 * t2504 + 0.3e1 / 0.32e2 * t6574 * t396 - t2581 * t210 + 0.19e2 / 0.6e1 * t599 * t563;
  t9014 = t618 * t84;
  t9051 = -0.2e1 * t235 * t430 * t2575 - t235 * t689 * t1396 - 0.2e1 * t235 * t266 * t3466 - t235 * t96 * (t8958 + 0.21e2 / 0.4e1 * t5342 * t8866 + 0.3e1 / 0.2e1 * t7732 * t8961 + 0.15e2 / 0.8e1 * t6834 * t8856 + 0.35e2 / 0.16e2 * t5399 * t8937 - 0.42e2 * t1899 * t8859 - 0.301e3 / 0.12e2 * t1851 * t8869 - 0.215e3 / 0.16e2 * t1890 * t8910 + 0.45e2 / 0.2e1 * t5390 * t1248 * t596 - 0.6e2 * t1890 * t8913 - 0.301e3 / 0.8e1 * t1899 * t8849 + t9004) + 0.3e1 * t217 * t1407 * t618 - t235 * t1407 * t665 + 0.6e1 * t9014 * t1352 + 0.12e2 * t3474 * t3477 + 0.6e1 * t584 * t689 * t1351 + 0.6e1 * t217 * t2642 * t405 + 0.12e2 * t217 * t1066 * t1004 + 0.6e1 * t217 * t430 * t2606 + t85 * (-0.76e3 / 0.531441e6 * t204 * t672 + 0.215e3 / 0.1594323e7 * t2436 * t3497 - 0.56e3 / 0.1162261467e10 * t8814 * t1756 * t8817 + 0.532e3 / 0.1162261467e10 * t5241 * t8814 * t5244 * t205 * t34 - 0.602e3 / 0.4782969e7 * t1758 * t2627 * sigma[0] + 0.76e2 / 0.59049e5 * t679 * t2631 * t580 + t8673 - t8718 + t8819 - t8825);
  t9059 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t1409 - t8557 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t3565 + t8564 - t8566 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * (t8602 + t8645 + t8686 + t8725 + t8764 + t8803 + t8893 + t9051));
  tv4rho2sigma20 = t7 * t9059 + 0.2e1 * t3570;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t9066 = t6 * t714 * t1480;
  t9070 = t6 * t718 * t1480 / 0.12e2;
  t9072 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t1480 - t9066 / 0.4e1 + t9070);
  tv4rho2sigma25 = t7 * t9072 + 0.2e1 * t3579;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t9078 = t6 * t739 * t1409;
  t9086 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t1409 - t9078 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t3565 - t8557 / 0.8e1 + t8564 - t8566 / 0.8e1);
  tv4rho2sigma26 = t7 * t9086 + t3570 + t3585;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t9092 = t6 * t763 * t1480;
  t9099 = t6 * t284 * t3778;
  t9102 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t1480 - t9092 / 0.8e1 - t9066 / 0.8e1 + t9070 - 0.3e1 / 0.8e1 * t6 * t280 * t3778 - t9099 / 0.8e1);
  tv4rho2sigma211 = t7 * t9102 + t3579 + t3783;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t9110 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t1409 - t9078 / 0.4e1 + t8564);
  tv4rho2sigma212 = t7 * t9110 + 0.2e1 * t3585;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t9124 = t1136 * t1136;
  t9131 = t1174 * t1174;
  t9144 = 0.835e3 / 0.4782969e7 * t2769 * t3607;
  t9146 = 0.76e3 / 0.531441e6 * t204 * t826;
  t9156 = 0.12e2 * t1423 * t6378 * t881 + 0.12e2 * t1429 * t2195 * t881 - 0.12e2 * t1447 * t2187 * t881 - 0.6e1 * t1468 * t2169 * t842 - 0.6e1 * t1468 * t2187 * t881 + 0.6e1 * t1478 * t841 * t842 + 0.2e1 * t1478 * t880 * t881 + 0.12e2 * t170 * t841 * t9124 + 0.4e1 * t170 * t880 * t9131 + 0.6e1 * t1440 * t2794 + t9144 - t9146;
  t9196 = -0.12e2 * t1439 * t2774 * t343 * t365 + 0.12e2 * t1429 * t841 * t874 - 0.6e1 * t1429 * t846 * t921 + 0.6e1 * t1440 * t2195 * t881 + 0.24e2 * t1444 * t6323 * t881 + 0.12e2 * t1444 * t6378 * t842 - 0.12e2 * t1447 * t2169 * t842 + 0.24e2 * t343 * t3669 * t841 + 0.12e2 * t343 * t3675 * t841 - 0.36e2 * t3590 * t7235 * t881 - 0.12e2 * t365 * t3669 * t846 - 0.12e2 * t365 * t3672 * t846 - 0.12e2 * t1426 * t7565;
  t9230 = t343 * t348;
  t9236 = 0.24e2 * t1114 * t1136 * t841 - 0.12e2 * t1114 * t1174 * t846 - 0.12e2 * t1137 * t1174 * t846 - 0.6e1 * t1423 * t2169 * t921 - 0.12e2 * t2169 * t365 * t3666 - 0.6e1 * t2803 * t467 * t846 - 0.12e2 * t2806 * t467 * t846 + 0.12e2 * t2850 * t453 * t841 - 0.6e1 * t2851 * t467 * t846 - 0.6e1 * t2934 * t453 * t846 + 0.24e2 * t343 * t3672 * t841 - 0.12e2 * t3652 * t9230 + 0.24e2 * t3655 * t3663;
  t9243 = t1136 * t467;
  t9247 = t452 * t1174;
  t9254 = t2169 * t477;
  t9262 = t1467 * t343;
  t9271 = t2195 * t477;
  t9277 = -0.24e2 * t1136 * t2774 * t4018 + 0.24e2 * t1174 * t2780 * t2781 + 0.2e1 * t1468 * t880 * t921 - 0.24e2 * t2774 * t343 * t9243 - 0.24e2 * t2774 * t343 * t9247 + 0.24e2 * t2780 * t365 * t9243 + 0.24e2 * t2780 * t365 * t9247 + 0.12e2 * t2780 * t365 * t9262 - 0.6e1 * t365 * t3658 * t846 - 0.24e2 * t2776 * t9254 + 0.24e2 * t2782 * t9271 - 0.24e2 * t3591 * t7272 + 0.24e2 * t3594 * t7239;
  t9283 = t1443 * t343;
  t9317 = -0.24e2 * t1174 * t4026 * t4141 - 0.6e1 * t1447 * t846 * t874 + 0.4e1 * t1447 * t880 * t921 - 0.3e1 * t1468 * t846 * t874 + 0.4e1 * t2934 * t468 * t880 - 0.6e1 * t343 * t3712 * t846 - 0.6e1 * t343 * t3758 * t846 + 0.8e1 * t365 * t3706 * t880 + 0.8e1 * t365 * t3709 * t880 + 0.4e1 * t365 * t3712 * t880 + 0.4e1 * t365 * t3758 * t880 - 0.36e2 * t365 * t7235 * t9283;
  t9357 = 0.8e1 * t1146 * t1174 * t880 + 0.6e1 * t1440 * t841 * t874 - 0.3e1 * t1440 * t846 * t921 - 0.6e1 * t1444 * t2187 * t921 + 0.6e1 * t1444 * t2195 * t874 - 0.12e2 * t2187 * t365 * t3703 + 0.12e2 * t2195 * t343 * t3703 - 0.12e2 * t2774 * t3590 * t874 + 0.12e2 * t343 * t3700 * t841 - 0.12e2 * t343 * t3706 * t846 - 0.12e2 * t343 * t3709 * t846 - 0.6e1 * t365 * t3675 * t846 - 0.6e1 * t365 * t3700 * t846;
  t9367 = 0.665e3 / 0.282429536481e12 * t830 / t114 / t831 / t822 * t6101;
  t9371 = t569 * t2790;
  t9374 = t1761 * t319 * t34;
  t9376 = 0.875e3 / 0.774840978e9 * t9371 * t2248 * t9374;
  t9385 = t874 * t158;
  t9390 = t2817 * sigma[2];
  t9396 = t2790 * t610 * t319;
  t9399 = t1322 * t863;
  t9402 = t8197 * t319;
  t9405 = t1436 * t863;
  t9409 = t5343 * t2790 * t319;
  t9418 = t1436 * t853;
  t9421 = t1129 * t336;
  t9424 = t2839 * sigma[2];
  t9438 = t833 * params->eta * sigma[2];
  t9441 = t1120 * t336;
  t9446 = t2368 * sigma[2];
  t9451 = -0.43e2 / 0.8e1 * t2288 * t9390 + 0.3e1 / 0.16e2 * t7300 * t3717 + t6173 * t9396 / 0.8e1 + 0.9e1 / 0.16e2 * t2273 * t9399 + 0.5e1 / 0.8e1 * t6161 * t9402 + 0.9e1 / 0.16e2 * t2288 * t9405 + 0.5e1 / 0.8e1 * t6188 * t9409 + 0.15e2 / 0.8e1 * t2315 * t1456 * t863 + 0.133e3 / 0.6e1 * t152 * t1463 * t824 + 0.9e1 / 0.8e1 * t6173 * t9418 - 0.6e1 * t2288 * t9421 - 0.215e3 / 0.48e2 * t2312 * t9424 + 0.45e2 / 0.8e1 * t6141 * t1456 * t853 - 0.2e2 * t2315 * t3739 * t336 + 0.38e2 * t356 * t361 * t824 * params->eta - 0.43e2 / 0.32e2 * t2273 * t9438 - 0.6e1 * t2273 * t9441 + 0.21e2 / 0.4e1 * t6168 * t9409 + 0.3e1 / 0.2e1 * t8204 * t9446 - 0.301e3 / 0.8e1 * t2367 * t9390;
  t9465 = t8222 * sigma[2];
  t9500 = 0.63e2 / 0.16e2 * t2367 * t9405 + 0.15e2 / 0.2e1 * t6225 * t8222 * t136 + 0.105e3 / 0.4e1 * t6216 * t3337 * t2914 + 0.21e2 * t6237 * t3693 * t2914 + 0.9e1 / 0.16e2 * t6254 * t1322 + 0.19e2 / 0.2e1 * t866 * t2821 + 0.19e2 / 0.3e1 * t897 * t2843 + 0.95e2 / 0.6e1 * t902 * t155 * t824 - t2812 * t324 + 0.19e2 / 0.6e1 * t856 * t824 + 0.3e1 / 0.32e2 * t7297 * t443;
  t9514 = 0.12e2 * t2780 * t3590 * t921 + t9367 + 0.48e2 * t7228 * t3590 * t3321 - t9376 + 0.6e1 * t841 * t945 * t1422 + 0.6e1 * t331 * t2969 * t452 - t349 * t1478 * t921 + 0.6e1 * t9385 * t1423 + 0.12e2 * t3663 * t3666 - t349 * t170 * (t9451 + 0.315e3 / 0.16e2 * t6216 * t9418 - 0.42e2 * t2367 * t9421 - 0.301e3 / 0.12e2 * t2328 * t9424 - 0.215e3 / 0.16e2 * t2358 * t9438 + 0.45e2 / 0.2e1 * t6225 * t1322 * t853 - 0.6e2 * t2358 * t9441 + 0.15e2 / 0.8e1 * t6162 * t9465 + 0.35e2 / 0.16e2 * t6216 * t9396 + 0.45e2 / 0.8e1 * t2358 * t9399 + 0.7e1 * t6237 * t9402 + t9500) + 0.6e1 * t331 * t3775 * t343 - 0.2e1 * t349 * t3775 * t365 + 0.3e1 * t331 * t1478 * t874;
  t9563 = -0.19e2 / 0.18e2 * t824 * t141 + 0.43e2 / 0.144e3 * t833 * t148 * t136 - t2790 * t352 * t867 / 0.48e2 - t7297 * t1322 / 0.8e1 - t7300 * t3685 / 0.4e1 + 0.4e1 / 0.3e1 * t2812 * t1120 - t6173 * t9402 / 0.6e1 + 0.43e2 / 0.24e2 * t2273 * t9390 - 0.38e2 / 0.9e1 * t856 * t2821 - 0.3e1 / 0.16e2 * t6254 * t1436 - t7328 * t9465 / 0.2e1 + 0.2e1 * t2273 * t9421 - 0.3e1 / 0.16e2 * t2273 * t9405 - 0.5e1 / 0.24e2 * t6161 * t9409 + 0.43e2 / 0.24e2 * t2288 * t9424 - 0.19e2 / 0.6e1 * t866 * t2843;
  t9604 = -t349 * t945 * t1467 - 0.2e1 * t349 * t380 * t3757 - 0.2e1 * t349 * t477 * t2934 - 0.4e1 * t349 * t1198 * t1174 - 0.2e1 * t349 * t2969 * t467 + 0.3e1 * t331 * t170 * t9563 + 0.2e1 * t880 * t945 * t1443 + 0.3e1 * t331 * t945 * t1439 + 0.6e1 * t331 * t380 * t3699 + 0.12e2 * t331 * t1198 * t1136 + 0.6e1 * t331 * t477 * t2850 + 0.12e2 * t2794 * t1429 + t159 * (-0.76e3 / 0.531441e6 * t204 * t928 + 0.215e3 / 0.1594323e7 * t2769 * t3765 - 0.56e3 / 0.1162261467e10 * t9371 * t2225 * t9374 + 0.532e3 / 0.1162261467e10 * t6059 * t9371 * t5244 * t319 * t34 - 0.602e3 / 0.4782969e7 * t2227 * t2957 * sigma[2] + 0.76e2 / 0.59049e5 * t935 * t2961 * t580 + t9146 - t9144 + t9376 - t9367);
  t9612 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t1480 - t9092 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t3778 + t9070 - t9099 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * (t9156 + t9196 + t9236 + t9277 + t9317 + t9357 + t9514 + t9604));
  tv4rho2sigma217 = t7 * t9612 + 0.2e1 * t3783;

  if(out->v4rho2sigma2 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  tv4rho2sigmalapl0 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 0] += tv4rho2sigmalapl0;

  tv4rho2sigmalapl1 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 1] += tv4rho2sigmalapl1;

  tv4rho2sigmalapl2 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 2] += tv4rho2sigmalapl2;

  tv4rho2sigmalapl3 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 3] += tv4rho2sigmalapl3;

  tv4rho2sigmalapl4 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 4] += tv4rho2sigmalapl4;

  tv4rho2sigmalapl5 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 5] += tv4rho2sigmalapl5;

  tv4rho2sigmalapl6 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 6] += tv4rho2sigmalapl6;

  tv4rho2sigmalapl7 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 7] += tv4rho2sigmalapl7;

  tv4rho2sigmalapl8 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 8] += tv4rho2sigmalapl8;

  tv4rho2sigmalapl9 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 9] += tv4rho2sigmalapl9;

  tv4rho2sigmalapl10 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 10] += tv4rho2sigmalapl10;

  tv4rho2sigmalapl11 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 11] += tv4rho2sigmalapl11;

  tv4rho2sigmalapl12 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 12] += tv4rho2sigmalapl12;

  tv4rho2sigmalapl13 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 13] += tv4rho2sigmalapl13;

  tv4rho2sigmalapl14 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 14] += tv4rho2sigmalapl14;

  tv4rho2sigmalapl15 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 15] += tv4rho2sigmalapl15;

  tv4rho2sigmalapl16 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 16] += tv4rho2sigmalapl16;

  tv4rho2sigmalapl17 = 0.e0;

  if(out->v4rho2sigmalapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmalapl[ip*p->dim.v4rho2sigmalapl + 17] += tv4rho2sigmalapl17;

  t9619 = t6 * t539 * t1528;
  t9626 = t6 * t548 * t1528 / 0.12e2;
  t9628 = t6 * t191 * t3983;
  t9661 = -0.13e2 * t1223 * t1363 - 0.12e2 * t8660 * t3048 - 0.2e2 * t3793 * t3052 - 0.2e2 * t1218 * t218 * t39 * t1042 + 0.4e2 * t3826 * t3044 - 0.2e2 * t1218 * t985 * t3804 + 0.4e2 * t1213 * t218 * t39 * t1004 - 0.2e2 * t3033 * t3805 - 0.16e3 / 0.3e1 * t1213 * t218 * t197 * t405 + 0.12e2 * t7789 * t1490 + 0.8e2 / 0.3e1 * t1218 * t218 * t197 * t420;
  t9675 = t8782 * t1229;
  t9689 = 0.4e2 * t3056 * t3801 + 0.4e2 * t1213 * t985 * t3800 + 0.3e1 * t3072 * t1503 + 0.104e3 / 0.3e1 * t484 * t3399 - 0.3e1 * t7678 * t3868 + 0.3e1 * t3098 * t3873 + 0.24e2 * t9675 * t3849 + 0.24e2 * t7973 * t3849 - 0.26e2 * t2997 * t1231 * t2998 + 0.3e1 * t3855 * t3864 * t7692 + 0.13e2 * t3003 * t1231 * t3004;
  t9701 = t5568 * t1229;
  t9712 = t3385 * t610;
  t9713 = t9712 * t205;
  t9716 = t1502 * t606;
  t9719 = t3385 * t1822;
  t9720 = t9719 * t205;
  t9740 = -0.6e1 * t5348 * t1346 * t8961 - 0.35e2 / 0.2e1 * t5399 * t9713 - 0.45e2 / 0.2e1 * t1890 * t9716 - 0.28e2 * t5411 * t9720 - 0.9e2 * t5390 * t1502 * t596 + 0.185e3 / 0.2e1 * t3446 + 0.195e3 * t3451 + 0.259e3 / 0.2e1 * t3453 - 0.26e2 * t3436 - 0.26e3 / 0.3e1 * t3449 - 0.6e2 * t5390 * t1346 * t222 * t62 - 0.105e3 * t5399 * t3931 * t2531 - 0.9e1 / 0.4e1 * t5464 * t1502;
  t9763 = -0.3e1 / 0.4e1 * t6574 * t1497 + 0.13e2 / 0.2e1 * t3423 - 0.52e2 / 0.3e1 * t3429 - 0.45e2 * t5327 * t1518 * t596 - 0.3e1 / 0.2e1 * t6577 * t3924 - t5348 * t9713 - 0.9e1 / 0.4e1 * t1806 * t9716 - 0.5e1 / 0.2e1 * t5358 * t9720 - 0.15e2 * t1870 * t1518 * t606 + 0.37e2 / 0.4e1 * t3427 + 0.39e2 / 0.2e1 * t3432 + 0.37e2 / 0.2e1 * t3434 + 0.13e3 * t3444 - 0.104e3 * t3457;
  t9779 = -0.24e2 * t8016 * t3088 * t405 * t625 - 0.4e2 * t3087 * t8021 * t3848 - 0.4e2 * t3087 * t8021 * t2457 + 0.36e2 * t9701 * t3088 * t420 * t625 + 0.4e2 * t3855 * t8021 * t3856 - t235 * t96 * (t9740 + t9763) - t235 * t2642 * t493 - 0.2e1 * t235 * t266 * t3947 - 0.2e1 * t235 * t1066 * t1259 - t235 * t430 * t3142 - t235 * t689 * t1525;
  t9780 = t1726 * t3860;
  t9793 = t96 * t1346;
  t9794 = t584 * t9793;
  t9796 = t74 * t229 * t62;
  t9799 = t589 * t9793;
  t9801 = t74 * t251 * t62;
  t9817 = -0.8e1 * t1066 * t1232 * t217 * t57 - 0.8e1 * t1232 * t217 * t222 * t430 + 0.12e2 * t3087 * t3088 * t6609 - 0.12e2 * t3088 * t3855 * t6602 + 0.24e2 * t3090 * t9780 + 0.3e1 * t3094 * t3873 + 0.28e2 * t3106 * t3861 + 0.6e1 * t3865 * t7659 + 0.6e1 * t3865 * t7662 - 0.3e1 * t3868 * t7675 + 0.2e1 * t9794 * t9796 - t9799 * t9801;
  t9828 = t1694 * t3093;
  t9833 = t1694 * t3097;
  t9851 = 0.24e2 * t7976 * t3849 + 0.24e2 * t3087 * t3088 * t1004 * t251 + 0.24e2 * t7973 * t3852 - 0.24e2 * t9828 * t3857 + 0.24e2 * t7976 * t3852 - 0.24e2 * t9833 * t3857 + 0.24e2 * t3087 * t3088 * t6613 - 0.24e2 * t3855 * t3088 * t1042 * t251 - 0.4e1 * t3861 * t3102 + 0.3e1 * t2997 * t3864 * t7665 - 0.3e1 / 0.2e1 * t3003 * t3864 * t7681;
  t9863 = t396 * t405;
  t9867 = t396 * t420;
  t9871 = t1694 * t7764;
  t9890 = -0.37e2 / 0.2e1 * t1230 * t3101 * t3872 + 0.2e1 * t1230 * t640 * t3385 * t1822 * t205 + 0.12e2 * t3087 * t3088 * t6620 + 0.16e2 * t7765 * t9863 * t3005 + 0.16e2 * t7765 * t9867 * t2999 - 0.16e2 * t9871 * t9867 * t3005 - 0.13e2 / 0.2e1 * t217 * t266 * t396 * t67 - 0.6e1 * t6727 * t1506 + 0.52e2 / 0.3e1 * t217 * t96 * t210 * t67 + 0.3e1 / 0.2e1 * t2650 * t1499 - 0.6e1 * t1712 * t1526 * t625;
  t9904 = t5296 * t96;
  t9924 = -0.6e1 * t1726 * t1512 * t585 - 0.6e1 * t1712 * t1512 * t625 - 0.6e1 * t1726 * t1526 * t585 + 0.12e2 * t6624 * t3968 * t585 + 0.24e2 * t9904 * t3968 * t625 + 0.2e2 * t1493 * t986 - 0.13e2 * t1213 * t1361 * t229 + 0.3e1 / 0.2e1 * t2456 * t3954 * t625 + 0.13e2 / 0.2e1 * t1218 * t1361 * t251 - 0.18e2 * t6650 * t3961 * t625 + 0.2e2 * t3976 * t401;
  t9960 = -0.12e2 * t2650 * t430 * t485 - 0.8e2 / 0.3e1 * t1493 * t992 + 0.4e1 * t624 * t3919 * t251 - 0.6e1 * t589 * t3948 * t229 + 0.4e1 * t624 * t3948 * t251 + 0.4e1 * t624 * t3950 * t251 - 0.6e1 * t589 * t3919 * t229 + 0.2e1 * t624 * t494 * t2575 - 0.6e1 * t589 * t3950 * t229 + 0.2e1 * t624 * t3143 * t420 + 0.4e1 * t624 * t1260 * t1042 + 0.4e1 * t624 * t3109 * t420;
  t9998 = 0.4e1 * t624 * t1243 * t1042 - 0.3e1 * t589 * t494 * t2606 + 0.2e1 * t624 * t2995 * t420 - 0.3e1 * t589 * t3143 * t405 - 0.6e1 * t589 * t1260 * t1004 - 0.3e1 * t589 * t2995 * t405 - 0.6e1 * t589 * t3109 * t405 - 0.6e1 * t589 * t1243 * t1004 + 0.4e1 * t624 * t3917 * t251 + 0.3e1 / 0.4e1 * t217 * t689 * t1497 * t67 - 0.3e1 * t589 * t1526 * t618;
  t10015 = t1004 * params->eta;
  t10020 = t405 * t610;
  t10029 = t1042 * params->eta;
  t10034 = -0.16e2 * t10015 * t1231 * t2997 * sigma[0] - 0.8e1 * t10020 * t205 * t2997 * t3101 + 0.8e1 * t10029 * t1231 * t3003 * sigma[0] - 0.3e1 * t1512 * t589 * t618 + 0.2e1 * t1512 * t624 * t665 + 0.2e1 * t1526 * t624 * t665 - 0.6e1 * t229 * t3917 * t589 - 0.16e2 * t3840 * t7659 - 0.16e2 * t3840 * t7662 + 0.8e1 * t3845 * t7675 + 0.8e1 * t3845 * t7678;
  t10036 = t420 * t610;
  t10059 = t584 * t3860;
  t10062 = t589 * t3860;
  t10068 = t3474 * t1229;
  t10071 = t1259 * t405;
  t10075 = 0.4e1 * t10036 * t205 * t3003 * t3101 - 0.6e1 * t251 * t2998 * t3087 * t3864 + 0.6e1 * t2997 * t3871 * t7670 * sigma[0] - 0.3e1 * t3003 * t3871 * t7654 * sigma[0] + 0.12e2 * t10071 * t2456 * t251 - 0.48e2 * t2458 * t3088 * t8016 + 0.56e2 * t2997 * t3105 * t3839 - 0.28e2 * t3003 * t3105 * t3844 - 0.16e2 * t10059 * t3000 + 0.8e1 * t10062 * t3006 - 0.16e2 * t10068 * t3840;
  t10076 = t493 * t1004;
  t10104 = t1525 * t229;
  t10108 = -0.12e2 * t2465 * t10076 * t229 - 0.3e1 / 0.2e1 * t3033 * t3958 - 0.12e2 * t6636 * t3962 + 0.12e2 * t6629 * t3965 - 0.12e2 * t2465 * t10071 * t229 - 0.6e1 * t2465 * t3961 * t618 + 0.3e1 * t3056 * t3955 - 0.12e2 * t3976 * t1226 - 0.6e1 * t1493 * t3080 + 0.3e1 / 0.2e1 * t1213 * t3954 * t618 - 0.3e1 / 0.4e1 * t1218 * t3954 * t665 + 0.12e2 * t2456 * t10104 * t251;
  t10114 = t493 * t1042;
  t10126 = t1259 * t420;
  t10144 = 0.12e2 * t10076 * t2456 * t251 + 0.12e2 * t10114 * t229 * t2456 - 0.12e2 * t10114 * t251 * t3972 + 0.12e2 * t10126 * t229 * t2456 - 0.12e2 * t10126 * t251 * t3972 - 0.12e2 * t1712 * t266 * t3973 - 0.6e1 * t217 * t2642 * t485 + 0.6e1 * t2456 * t3961 * t665 - 0.6e1 * t3968 * t3972 * t665 + 0.12e2 * t3084 * t8660 + 0.12e2 * t3969 * t6629;
  t10174 = 0.6e1 * t2456 * t3968 * t618 + 0.3e1 / 0.2e1 * t3075 * t1503 + 0.3e1 * t1223 * t3832 + 0.3e1 / 0.2e1 * t484 * t6574 * t1502 - 0.3e1 * t2465 * t3954 * t3089 - 0.37e2 / 0.6e1 * t484 * t3392 + 0.24e2 * t6624 * t3961 * t3089 - 0.36e2 * t6650 * t3968 * t3089 - 0.24e2 * t3826 * t3059 + 0.12e2 * t3793 * t3036 + 0.6e1 * t1218 * t218 * t54 * t2575;
  t10177 = t584 * t1066;
  t10180 = t589 * t1066;
  t10204 = -0.12e2 * t1213 * t218 * t2606 * t54 - 0.12e2 * t1213 * t1485 * t2578 - 0.24e2 * t1213 * t3813 * t985 + 0.12e2 * t1218 * t3822 * t985 - 0.24e2 * t10177 * t1215 + 0.12e2 * t10180 * t1220 + t1223 * t3797 + 0.6e1 * t1490 * t7832 + 0.12e2 * t3033 * t3819 + 0.12e2 * t3033 * t3823 - 0.24e2 * t3056 * t3814;
  t10208 = t9014 * t96;
  t10211 = t3474 * t266;
  t10224 = t3385 * t238;
  t10234 = 0.6e1 * t1218 * t2578 * t1489 - 0.12e2 * t10208 * t1486 - 0.24e2 * t10211 * t1486 - 0.24e2 * t3835 * t3810 - 0.24e2 * t3835 * t3814 - 0.12e2 * t7828 * t1486 - 0.24e2 * t3056 * t3810 + 0.6e1 * t3793 * t3040 + t484 * t10224 * t611 / 0.2e1 - 0.12e2 * t3826 * t3063 - 0.13e2 * t484 * t3394 + 0.4e2 * t3835 * t3801;
  t10243 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t1528 - t9619 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t3983 + t9626 - t9628 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * (t9661 + t9689 + t9779 + t9817 + t9851 + t9890 + t9924 + t9960 + t9998 + t10034 + t10075 + t10108 + t10144 + t10174 + t10204 + t10234));
  tv4rho2sigmatau0 = t10243 * t7 + 0.2e1 * t3988;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 0] += tv4rho2sigmatau0;

  tv4rho2sigmatau1 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 1] += tv4rho2sigmatau1;

  tv4rho2sigmatau2 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 2] += tv4rho2sigmatau2;

  tv4rho2sigmatau3 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 3] += tv4rho2sigmatau3;

  tv4rho2sigmatau4 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 4] += tv4rho2sigmatau4;

  t10250 = t6 * t714 * t1576;
  t10254 = t6 * t718 * t1576 / 0.12e2;
  t10256 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t1576 - t10250 / 0.4e1 + t10254);
  tv4rho2sigmatau5 = t10256 * t7 + 0.2e1 * t3997;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 5] += tv4rho2sigmatau5;

  t10262 = t6 * t739 * t1528;
  t10270 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t1528 - t10262 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t3983 - t9619 / 0.8e1 + t9626 - t9628 / 0.8e1);
  tv4rho2sigmatau6 = t10270 * t7 + t3988 + t4003;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 6] += tv4rho2sigmatau6;

  tv4rho2sigmatau7 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 7] += tv4rho2sigmatau7;

  tv4rho2sigmatau8 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 8] += tv4rho2sigmatau8;

  tv4rho2sigmatau9 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 9] += tv4rho2sigmatau9;

  tv4rho2sigmatau10 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 10] += tv4rho2sigmatau10;

  t10276 = t6 * t763 * t1576;
  t10283 = t6 * t284 * t4200;
  t10286 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t1576 - t10276 / 0.8e1 - t10250 / 0.8e1 + t10254 - 0.3e1 / 0.8e1 * t6 * t280 * t4200 - t10283 / 0.8e1);
  tv4rho2sigmatau11 = t10286 * t7 + t3997 + t4205;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 11] += tv4rho2sigmatau11;

  t10294 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t1528 - t10262 / 0.4e1 + t9626);
  tv4rho2sigmatau12 = t10294 * t7 + 0.2e1 * t4003;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 12] += tv4rho2sigmatau12;

  tv4rho2sigmatau13 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 13] += tv4rho2sigmatau13;

  tv4rho2sigmatau14 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 14] += tv4rho2sigmatau14;

  tv4rho2sigmatau15 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 15] += tv4rho2sigmatau15;

  tv4rho2sigmatau16 = 0.e0;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 16] += tv4rho2sigmatau16;

  t10312 = t3598 * t610;
  t10313 = t10312 * t319;
  t10315 = t1550 * t863;
  t10318 = t3598 * t1822;
  t10319 = t10318 * t319;
  t10331 = -0.9e1 / 0.4e1 * t6254 * t1550 + 0.185e3 / 0.2e1 * t3737 + 0.195e3 * t3742 + 0.259e3 / 0.2e1 * t3744 - 0.3e1 / 0.2e1 * t7300 * t4049 - t6173 * t10313 - 0.9e1 / 0.4e1 * t2273 * t10315 - 0.5e1 / 0.2e1 * t6161 * t10319 - 0.15e2 * t2315 * t1566 * t863 - 0.45e2 * t6141 * t1566 * t853 + 0.13e3 * t3735 - 0.104e3 * t3748 + 0.37e2 / 0.4e1 * t3718;
  t10359 = 0.39e2 / 0.2e1 * t3723 + 0.37e2 / 0.2e1 * t3725 - 0.35e2 / 0.2e1 * t6216 * t10313 - 0.45e2 / 0.2e1 * t2358 * t10315 - 0.28e2 * t6237 * t10319 - 0.6e1 * t6173 * t1417 * t9446 - 0.9e2 * t6225 * t1550 * t853 - 0.6e2 * t6225 * t1417 * t336 * t136 - 0.105e3 * t6216 * t4056 * t2914 - 0.26e2 * t3727 - 0.26e3 / 0.3e1 * t3740 - 0.3e1 / 0.4e1 * t7297 * t1545 + 0.13e2 / 0.2e1 * t3714 - 0.52e2 / 0.3e1 * t3720;
  t10383 = t2195 * t3307;
  t10388 = -t349 * t170 * (t10331 + t10359) - t349 * t945 * t1573 - 0.2e1 * t349 * t380 * t4072 - t349 * t2969 * t510 - 0.2e1 * t349 * t1198 * t1333 - t349 * t477 * t3358 + 0.24e2 * t8335 * t4019 + 0.24e2 * t3319 * t3320 * t1136 * t365 + 0.24e2 * t8331 * t4022 - 0.24e2 * t10383 * t4027 + 0.24e2 * t8335 * t4022;
  t10402 = t6337 * t1303;
  t10422 = 0.36e2 * t10402 * t3320 * t467 * t881 - 0.24e2 * t3320 * t452 * t8355 * t881 - 0.26e2 * t1305 * t3237 * t3238 + 0.13e2 * t1305 * t3243 * t3244 - 0.4e2 * t2781 * t3319 * t8360 - 0.4e2 * t3319 * t4018 * t8360 + 0.4e2 * t4025 * t4026 * t8360 + 0.3e1 * t4025 * t4034 * t8364 + 0.3e1 * t3308 * t4043 + 0.6e1 * t4035 * t8404 - 0.3e1 * t4038 * t8388;
  t10430 = t170 * t1417;
  t10431 = t841 * t10430;
  t10433 = t148 * t343 * t136;
  t10436 = t846 * t10430;
  t10438 = t148 * t365 * t136;
  t10448 = t9230 * t1303;
  t10460 = -0.8e1 * t1198 * t1306 * t134 * t331 - 0.8e1 * t1306 * t331 * t336 * t477 + 0.12e2 * t3319 * t3320 * t452 * t921 + 0.12e2 * t3319 * t3320 * t7246 + 0.2e1 * t10431 * t10433 - t10436 * t10438 + 0.24e2 * t10448 * t4019 + 0.3e1 * t3312 * t4043 + 0.24e2 * t4019 * t8331 + 0.6e1 * t4035 * t8372 - 0.3e1 * t4038 * t8391;
  t10467 = t2195 * t3311;
  t10477 = t2169 * t4030;
  t10496 = t443 * t452;
  t10500 = -0.12e2 * t4025 * t3320 * t467 * t921 - 0.4e1 * t4031 * t3316 - 0.24e2 * t10467 * t4027 + 0.24e2 * t3319 * t3320 * t7242 - 0.24e2 * t4025 * t3320 * t1174 * t365 + 0.24e2 * t10477 * t3322 + 0.28e2 * t4031 * t3304 + 0.3e1 * t3237 * t4034 * t8375 - 0.3e1 / 0.2e1 * t3243 * t4034 * t8394 - 0.37e2 / 0.2e1 * t1304 * t3315 * t4042 + 0.2e1 * t1304 * t896 * t3598 * t1822 * t319 + 0.16e2 * t8243 * t10496 * t3245;
  t10503 = t443 * t467;
  t10507 = t2195 * t8242;
  t10535 = 0.16e2 * t8243 * t10503 * t3239 - 0.16e2 * t10507 * t10503 * t3245 - 0.6e1 * t2187 * t1574 * t881 + 0.3e1 / 0.2e1 * t2794 * t1547 + 0.52e2 / 0.3e1 * t331 * t170 * t324 * t141 - 0.6e1 * t7565 * t1554 - 0.6e1 * t2187 * t1560 * t881 - 0.6e1 * t2169 * t1574 * t842 + 0.2e2 * t1541 * t1118 + 0.2e2 * t4145 * t448 - 0.13e2 * t1287 * t1432 * t343;
  t10548 = t6323 * t170;
  t10554 = t841 * t1198;
  t10557 = t846 * t1198;
  t10566 = 0.3e1 / 0.2e1 * t2780 * t4126 * t881 + 0.13e2 / 0.2e1 * t1292 * t1432 * t365 - 0.18e2 * t7235 * t4130 * t881 + 0.12e2 * t7228 * t4137 * t842 + 0.24e2 * t10548 * t4137 * t881 + 0.12e2 * t4178 * t3300 - 0.24e2 * t10554 * t1289 + 0.12e2 * t10557 * t1294 - 0.24e2 * t4175 * t3290 - 0.24e2 * t3287 * t4186 - 0.24e2 * t3287 * t4190;
  t10594 = t9385 * t170;
  t10597 = -0.12e2 * t1287 * t2809 * t1533 - 0.24e2 * t1287 * t1117 * t4189 - 0.12e2 * t1287 * t332 * t131 * t2850 + t1297 * t4159 - 0.3e1 * t2774 * t4126 * t3321 - 0.37e2 / 0.6e1 * t501 * t3681 + 0.24e2 * t7228 * t4130 * t3321 - 0.36e2 * t7235 * t4137 * t3321 + 0.3e1 / 0.2e1 * t3268 * t1551 + 0.3e1 * t1297 * t4164 - 0.12e2 * t10594 * t1534;
  t10598 = t3663 * t380;
  t10611 = t3598 * t352;
  t10630 = -0.24e2 * t10598 * t1534 - 0.24e2 * t4181 * t4186 - 0.24e2 * t4181 * t4190 - 0.12e2 * t8499 * t1534 - 0.12e2 * t4175 * t3294 + 0.6e1 * t4178 * t3272 + t501 * t10611 * t867 / 0.2e1 + 0.6e1 * t1292 * t2809 * t1537 + 0.12e2 * t1292 * t1117 * t4171 + 0.6e1 * t1292 * t332 * t131 * t2934 + 0.3e1 / 0.2e1 * t501 * t7297 * t1550 + 0.6e1 * t8503 * t1538;
  t10661 = 0.4e2 * t1136 * t117 * t1287 * t332 - 0.2e2 * t117 * t1174 * t1292 * t332 + 0.4e2 * t1117 * t1287 * t4167 - 0.13e2 * t1297 * t1434 + 0.4e2 * t3276 * t4175 + 0.4e2 * t3287 * t4168 - 0.2e2 * t3297 * t4152 + 0.12e2 * t3297 * t4172 + 0.12e2 * t3297 * t4195 - 0.13e2 * t3683 * t501 + 0.4e2 * t4168 * t4181;
  t10694 = -0.12e2 * t9271 * t3280 - 0.2e2 * t4178 * t3284 - 0.6e1 * t2169 * t1560 * t842 - 0.13e2 / 0.2e1 * t331 * t380 * t443 * t141 + 0.4e1 * t880 * t1334 * t1174 + 0.2e1 * t880 * t3359 * t467 + 0.4e1 * t880 * t1317 * t1174 + 0.2e1 * t880 * t3361 * t467 + 0.4e1 * t880 * t3325 * t467 - 0.6e1 * t846 * t1334 * t1136 - 0.3e1 * t846 * t511 * t2850;
  t10729 = -0.6e1 * t846 * t3325 * t452 - 0.6e1 * t846 * t1317 * t1136 - 0.3e1 * t846 * t3359 * t452 - 0.8e2 / 0.3e1 * t1541 * t1124 - 0.12e2 * t2794 * t477 * t502 + 0.3e1 / 0.4e1 * t331 * t945 * t1545 * t141 - 0.3e1 * t846 * t3361 * t452 + 0.4e1 * t880 * t4080 * t365 + 0.4e1 * t880 * t4073 * t365 + 0.2e1 * t880 * t1574 * t921 - 0.6e1 * t846 * t4073 * t343;
  t10767 = 0.6e1 * t3237 * t4041 * t8380 * sigma[2] - 0.6e1 * t3238 * t3319 * t365 * t4034 - 0.3e1 * t1560 * t846 * t874 + 0.2e1 * t1560 * t880 * t921 - 0.3e1 * t1574 * t846 * t874 + 0.2e1 * t2934 * t511 * t880 - 0.6e1 * t343 * t4075 * t846 - 0.6e1 * t343 * t4077 * t846 - 0.6e1 * t343 * t4080 * t846 + 0.4e1 * t365 * t4075 * t880 + 0.4e1 * t365 * t4077 * t880 + 0.8e1 * t4015 * t8388;
  t10772 = t1174 * params->eta;
  t10777 = t467 * t610;
  t10782 = t841 * t4030;
  t10785 = t846 * t4030;
  t10788 = t3663 * t1303;
  t10795 = t1136 * params->eta;
  t10800 = t452 * t610;
  t10808 = 0.8e1 * t10772 * t1305 * t3243 * sigma[2] + 0.4e1 * t10777 * t319 * t3243 * t3315 - 0.16e2 * t10795 * t1305 * t3237 * sigma[2] - 0.8e1 * t10800 * t319 * t3237 * t3315 + 0.56e2 * t3237 * t3303 * t4009 - 0.16e2 * t10782 * t3240 + 0.8e1 * t10785 * t3246 - 0.16e2 * t10788 * t4010 - 0.16e2 * t4010 * t8372 - 0.16e2 * t4010 * t8404 + 0.8e1 * t4015 * t8391;
  t10822 = t1573 * t343;
  t10829 = t510 * t1174;
  t10835 = t1333 * t467;
  t10844 = -0.28e2 * t3243 * t3303 * t4014 - 0.3e1 * t3243 * t4041 * t8399 * sigma[2] - 0.48e2 * t8355 * t3320 * t2782 - 0.3e1 / 0.4e1 * t1292 * t4126 * t921 + 0.12e2 * t2780 * t10822 * t365 + 0.3e1 / 0.2e1 * t1287 * t4126 * t874 - 0.12e2 * t4141 * t10829 * t365 + 0.12e2 * t9271 * t3264 - 0.12e2 * t4141 * t10835 * t365 + 0.12e2 * t2780 * t10829 * t343 + 0.12e2 * t7239 * t4138;
  t10852 = t1333 * t452;
  t10856 = t510 * t1136;
  t10877 = 0.12e2 * t10835 * t2780 * t343 - 0.12e2 * t10852 * t2774 * t343 + 0.12e2 * t10852 * t2780 * t365 - 0.12e2 * t10856 * t2774 * t343 + 0.12e2 * t10856 * t2780 * t365 - 0.12e2 * t2187 * t380 * t4142 - 0.6e1 * t2969 * t331 * t502 - 0.12e2 * t1300 * t4145 - 0.6e1 * t1541 * t3251 - 0.12e2 * t4131 * t7272 + 0.12e2 * t4134 * t7239;
  t10911 = 0.3e1 * t3287 * t4148 - 0.3e1 / 0.2e1 * t3297 * t4127 + 0.6e1 * t2780 * t4130 * t921 + 0.6e1 * t2780 * t4137 * t874 - 0.6e1 * t4141 * t4137 * t921 - 0.6e1 * t2774 * t4130 * t874 + 0.104e3 / 0.3e1 * t501 * t3688 - 0.16e3 / 0.3e1 * t1287 * t332 * t314 * t452 + 0.12e2 * t8527 * t1538 + 0.8e2 / 0.3e1 * t1292 * t332 * t314 * t467 - 0.2e2 * t1292 * t1117 * t4151 + 0.3e1 * t3260 * t1551;
  t10920 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t1576 - t10276 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t4200 + t10254 - t10283 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * (t10388 + t10422 + t10460 + t10500 + t10535 + t10566 + t10597 + t10630 + t10661 + t10694 + t10729 + t10767 + t10808 + t10844 + t10877 + t10911));
  tv4rho2sigmatau17 = t10920 * t7 + 0.2e1 * t4205;

  if(out->v4rho2sigmatau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigmatau[ip*p->dim.v4rho2sigmatau + 17] += tv4rho2sigmatau17;

  tv4rho2lapl20 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 0] += tv4rho2lapl20;

  tv4rho2lapl21 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 1] += tv4rho2lapl21;

  tv4rho2lapl22 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 2] += tv4rho2lapl22;

  tv4rho2lapl23 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 3] += tv4rho2lapl23;

  tv4rho2lapl24 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 4] += tv4rho2lapl24;

  tv4rho2lapl25 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 5] += tv4rho2lapl25;

  tv4rho2lapl26 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 6] += tv4rho2lapl26;

  tv4rho2lapl27 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 7] += tv4rho2lapl27;

  tv4rho2lapl28 = 0.e0;

  if(out->v4rho2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapl2[ip*p->dim.v4rho2lapl2 + 8] += tv4rho2lapl28;

  tv4rho2lapltau0 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 0] += tv4rho2lapltau0;

  tv4rho2lapltau1 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 1] += tv4rho2lapltau1;

  tv4rho2lapltau2 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 2] += tv4rho2lapltau2;

  tv4rho2lapltau3 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 3] += tv4rho2lapltau3;

  tv4rho2lapltau4 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 4] += tv4rho2lapltau4;

  tv4rho2lapltau5 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 5] += tv4rho2lapltau5;

  tv4rho2lapltau6 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 6] += tv4rho2lapltau6;

  tv4rho2lapltau7 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 7] += tv4rho2lapltau7;

  tv4rho2lapltau8 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 8] += tv4rho2lapltau8;

  tv4rho2lapltau9 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 9] += tv4rho2lapltau9;

  tv4rho2lapltau10 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 10] += tv4rho2lapltau10;

  tv4rho2lapltau11 = 0.e0;

  if(out->v4rho2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2lapltau[ip*p->dim.v4rho2lapltau + 11] += tv4rho2lapltau11;

  t10927 = t6 * t539 * t1606;
  t10934 = t6 * t548 * t1606 / 0.12e2;
  t10936 = t6 * t191 * t4314;
  t10946 = t81 * t4516;
  t10957 = t96 * t4225;
  t10958 = t584 * t10957;
  t10961 = t589 * t10957;
  t10970 = 0.124e3 / 0.3e1 * t3798 + 0.64e2 * t3474 * t4240 * t4243 + 0.64e2 * t584 * t266 * t58 * t4243 + 0.16e3 / 0.3e1 * t4241 * t10946 * t611 + 0.48e2 * t7973 * t4246 + 0.48e2 * t7976 * t4246 + 0.48e2 * t3087 * t3088 * t7906 - 0.16e2 * t10958 * t9796 + 0.8e1 * t10961 * t9801 - 0.8e2 * t3087 * t8021 * t3083 + 0.72e2 * t9701 * t3088 * t7926;
  t10978 = t238 * t1582;
  t11009 = 0.8e2 * t3855 * t8021 * t4249 - 0.992e3 / 0.3e1 * t4241 * t640 * t1346 * t62 - 0.96e2 * t3087 * t10978 * t251 * t222 + 0.24e2 * t3087 * t3088 * t7910 - 0.48e2 * t9828 * t4250 - 0.48e2 * t9833 * t4250 - 0.48e2 * t3855 * t3088 * t1259 * t251 - 0.24e2 * t3855 * t3088 * t7944 + 0.4e1 * t624 * t4221 * t251 + 0.4e1 * t624 * t4238 * t251 + 0.2e1 * t624 * t1604 * t665 + 0.4e1 * t624 * t494 * t3142;
  t11047 = -0.6e1 * t1582 * t217 * t67 * t689 + 0.8e1 * t1243 * t1259 * t624 + 0.6e1 * t1595 * t1694 * t618 - 0.6e1 * t1595 * t1712 * t665 + 0.24e2 * t1595 * t5296 * t625 - 0.6e1 * t1604 * t1712 * t625 - 0.3e1 * t1604 * t589 * t618 + 0.12e2 * t1694 * t229 * t4218 - 0.12e2 * t1712 * t251 * t4218 - 0.6e1 * t229 * t4221 * t589 - 0.6e1 * t229 * t4238 * t589 - 0.12e2 * t1591 * t2650;
  t11082 = -0.6e1 * t1726 * t1604 * t585 - 0.16e3 * t3835 * t4273 - 0.12e2 * t2456 * t4280 * t625 + 0.104e4 / 0.3e1 * t1213 * t609 * t396 + 0.48e2 * t1213 * t5464 * t1582 - 0.16e3 * t3056 * t4273 + 0.12e2 * t5564 * t1595 * t585 + 0.12e2 * t1218 * t218 * t54 * t3142 - 0.8e1 * t1223 * t4298 - 0.4e2 * t3033 * t4310 - 0.4e2 * t1218 * t985 * t4309 - 0.4e2 * t1218 * t218 * t39 * t1259;
  t11085 = t8782 * t96;
  t11117 = -0.32e3 * t1213 * t1497 * t1806 * t222 + 0.16e3 * t1497 * t2465 * t251 * t609 + 0.12e2 * t1218 * t1586 * t2578 + 0.24e2 * t1218 * t4293 * t985 + 0.24e2 * t2465 * t3089 * t4280 - 0.48e2 * t11085 * t4302 + 0.12e2 * t1587 * t7832 + 0.24e2 * t3033 * t4290 + 0.24e2 * t3033 * t4294 + 0.96e2 * t3056 * t4306 + 0.96e2 * t3835 * t4306 - 0.48e2 * t4302 * t6636;
  t11120 = t4516 * t238;
  t11149 = t1603 * t229;
  t11153 = 0.48e2 * t1213 * t1582 * t1806 * t606 - 0.24e2 * t1582 * t2465 * t609 * t665 - 0.4e1 * t11120 * t484 * t611 + 0.12e2 * t11149 * t2456 * t251 - 0.12e2 * t1213 * t4280 * t618 + 0.6e1 * t1218 * t4280 * t665 - 0.24e2 * t1259 * t3972 * t4249 + 0.48e2 * t10211 * t1583 + 0.24e2 * t1583 * t7828 + 0.24e2 * t1587 * t7789 + 0.12e2 * t3033 * t4284 - 0.24e2 * t3056 * t4281;
  t11157 = t396 * t493;
  t11164 = t1594 * t229;
  t11181 = t1259 * t1259;
  t11190 = t4516 * t610;
  t11191 = t11190 * t205;
  t11211 = 0.6e1 * t6574 * t1582 + 0.12e2 * t6577 * t4227 - 0.4e2 * t3921 + 0.8e1 * t5348 * t11191 - 0.62e2 * t3925 + 0.26e3 / 0.3e1 * t1379 + 0.36e3 * t5327 * t1600 * t596 + 0.48e3 * t5390 * t4225 * t222 * t62 - 0.8e3 * t3937 + 0.12e3 * t1870 * t1600 * t606 + 0.14e3 * t5399 * t11191 - 0.62e3 * t3939 + 0.13e4 / 0.3e1 * t1386;
  t11217 = 0.24e2 * t10208 * t1583 + 0.32e2 * t7765 * t11157 * t2999 - 0.32e2 * t9871 * t11157 * t3005 - 0.36e2 * t6650 * t11164 * t251 + 0.24e2 * t2456 * t3083 * t1259 + 0.48e2 * t6624 * t609 * t1582 * t625 + 0.16e3 / 0.3e1 * t1218 * t218 * t197 * t493 - 0.26e3 / 0.3e1 * t3880 + 0.4e2 * t3911 + 0.4e1 * t624 * t96 * t11181 - t235 * t96 * t11211 + 0.2e1 * t624 * t689 * t1594;
  t11230 = t1259 * params->eta;
  t11235 = t493 * t610;
  t11240 = t1726 * t4240;
  t11252 = 0.16e2 * t11230 * t1231 * t3003 * sigma[0] + 0.8e1 * t11235 * t205 * t3003 * t3101 - 0.64e2 * t11240 * t3005 * t4242 - t1603 * t235 * t689 - 0.2e1 * t235 * t266 * t4237 + 0.128e3 * t2555 * t2997 * t4242 - 0.56e2 * t3003 * t3105 * t4214 - 0.96e2 * t3084 * t3088 * t8016 + 0.16e2 * t4215 * t7675 + 0.16e2 * t4215 * t7678 + 0.8e2 * t3956 - 0.4e2 * t3959;
  t11260 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t535 * t1606 - t10927 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t185 * t4314 + t10934 - t10936 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * (t10970 + t11009 + t11047 + t11082 + t11117 + t11153 + t11217 + t11252));
  tv4rho2tau20 = t11260 * t7 + 0.2e1 * t4319;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 0] += tv4rho2tau20;

  tv4rho2tau21 = 0.e0;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 1] += tv4rho2tau21;

  t11267 = t6 * t714 * t1636;
  t11271 = t6 * t718 * t1636 / 0.12e2;
  t11273 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t710 * t1636 - t11267 / 0.4e1 + t11271);
  tv4rho2tau22 = t11273 * t7 + 0.2e1 * t4328;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 2] += tv4rho2tau22;

  t11279 = t6 * t739 * t1606;
  t11287 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t735 * t1606 - t11279 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t297 * t4314 - t10927 / 0.8e1 + t10934 - t10936 / 0.8e1);
  tv4rho2tau23 = t11287 * t7 + t4319 + t4334;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 3] += tv4rho2tau23;

  tv4rho2tau24 = 0.e0;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 4] += tv4rho2tau24;

  t11293 = t6 * t763 * t1636;
  t11300 = t6 * t284 * t4440;
  t11303 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t759 * t1636 - t11293 / 0.8e1 - t11267 / 0.8e1 + t11271 - 0.3e1 / 0.8e1 * t6 * t280 * t4440 - t11300 / 0.8e1);
  tv4rho2tau25 = t11303 * t7 + t4328 + t4445;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 5] += tv4rho2tau25;

  t11311 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t790 * t1606 - t11279 / 0.4e1 + t10934);
  tv4rho2tau26 = t11311 * t7 + 0.2e1 * t4334;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 6] += tv4rho2tau26;

  tv4rho2tau27 = 0.e0;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 7] += tv4rho2tau27;

  t11322 = t1333 * t1333;
  t11355 = -0.48e2 * t1333 * t3320 * t365 * t4025 + 0.16e3 * t1545 * t2774 * t365 * t866 + 0.48e2 * t1612 * t7228 * t866 * t881 + 0.4e1 * t11322 * t170 * t880 + 0.48e2 * t3319 * t3320 * t8433 + 0.24e2 * t3319 * t3320 * t8437 - 0.24e2 * t3320 * t4025 * t8418 - 0.48e2 * t10383 * t4348 - 0.48e2 * t10467 * t4348 + 0.48e2 * t4344 * t8331 + 0.48e2 * t4344 * t8335;
  t11374 = t4559 * t352;
  t11385 = t4559 * t610;
  t11386 = t11385 * t319;
  t11406 = 0.6e1 * t7297 * t1612 + 0.12e2 * t7300 * t4426 - 0.4e2 * t4046 + 0.8e1 * t6173 * t11386 - 0.62e2 * t4050 + 0.26e3 / 0.3e1 * t1450 + 0.36e3 * t6141 * t1630 * t853 + 0.48e3 * t6225 * t4353 * t336 * t136 - 0.8e3 * t4062 + 0.12e3 * t2315 * t1630 * t863 + 0.14e3 * t6216 * t11386 - 0.62e3 * t4064 + 0.13e4 / 0.3e1 * t1457;
  t11417 = -0.32e3 * t1287 * t2273 * t1545 * t336 + 0.16e3 / 0.3e1 * t1292 * t332 * t314 * t510 + 0.12e2 * t1292 * t2809 * t1616 + 0.24e2 * t1292 * t1117 * t4393 + 0.12e2 * t1292 * t332 * t131 * t3358 - 0.4e1 * t501 * t11374 * t867 + 0.24e2 * t8527 * t1617 - t349 * t170 * t11406 - 0.26e3 / 0.3e1 * t4084 + 0.4e2 * t4109 + 0.4e1 * t880 * t4421 * t365 + 0.4e1 * t880 * t4437 * t365;
  t11441 = t1333 * params->eta;
  t11446 = t510 * t610;
  t11451 = t2169 * t4351;
  t11458 = 0.16e2 * t11441 * t1305 * t3243 * sigma[2] + 0.8e1 * t11446 * t319 * t3243 * t3315 - 0.64e2 * t11451 * t3245 * t4354 - 0.3e1 * t1634 * t846 * t874 + 0.2e1 * t1634 * t880 * t921 + 0.128e3 * t2897 * t3237 * t4354 - 0.56e2 * t3243 * t3303 * t4340 + 0.4e1 * t3358 * t511 * t880 - 0.6e1 * t343 * t4421 * t846 - 0.6e1 * t343 * t4437 * t846 + 0.16e2 * t4341 * t8388 + 0.16e2 * t4341 * t8391;
  t11495 = -0.6e1 * t141 * t1612 * t331 * t945 + 0.8e1 * t1317 * t1333 * t880 - 0.6e1 * t1625 * t2187 * t921 + 0.6e1 * t1625 * t2195 * t874 + 0.24e2 * t1625 * t6323 * t881 + 0.12e2 * t1625 * t6378 * t842 - 0.6e1 * t1634 * t2169 * t842 - 0.6e1 * t1634 * t2187 * t881 - 0.12e2 * t2187 * t365 * t4418 + 0.12e2 * t2195 * t343 * t4418 - 0.96e2 * t3264 * t3320 * t8355 - 0.12e2 * t1621 * t2794;
  t11524 = t1633 * t343;
  t11528 = 0.2e1 * t880 * t945 * t1624 - t349 * t945 * t1633 - 0.2e1 * t349 * t380 * t4436 - 0.4e2 * t4128 - 0.16e3 * t3287 * t4377 - 0.12e2 * t2780 * t4380 * t881 + 0.8e2 * t4149 - 0.16e3 * t4181 * t4377 + 0.48e2 * t1287 * t6254 * t1612 + 0.104e4 / 0.3e1 * t1287 * t866 * t443 - 0.24e2 * t4141 * t4347 * t1333 + 0.12e2 * t2780 * t11524 * t365;
  t11532 = t1624 * t343;
  t11559 = -0.36e2 * t11532 * t365 * t7235 - 0.12e2 * t1287 * t4380 * t874 + 0.6e1 * t1292 * t4380 * t921 + 0.24e2 * t1333 * t2780 * t3263 + 0.24e2 * t2774 * t3321 * t4380 + 0.48e2 * t10598 * t1613 + 0.24e2 * t1613 * t8499 + 0.12e2 * t1617 * t8503 - 0.24e2 * t3287 * t4381 + 0.96e2 * t3287 * t4410 + 0.12e2 * t3297 * t4384 - 0.48e2 * t4406 * t7272;
  t11565 = t9230 * t170;
  t11592 = 0.24e2 * t3297 * t4415 + 0.24e2 * t3297 * t4394 - 0.48e2 * t11565 * t4406 + 0.96e2 * t4181 * t4410 + 0.124e3 / 0.3e1 * t4160 - 0.4e2 * t1292 * t332 * t117 * t1333 - 0.24e2 * t2774 * t866 * t1612 * t921 + 0.48e2 * t1287 * t2273 * t1612 * t863 - 0.8e1 * t1297 * t4398 - 0.4e2 * t3297 * t4402 - 0.4e2 * t1292 * t1117 * t4401 + 0.24e2 * t10594 * t1613;
  t11593 = t352 * t1612;
  t11605 = t170 * t4353;
  t11606 = t841 * t11605;
  t11609 = t846 * t11605;
  t11612 = t155 * t4559;
  t11630 = t443 * t510;
  t11637 = -0.96e2 * t3319 * t11593 * t365 * t336 + 0.64e2 * t3663 * t4351 * t4355 + 0.64e2 * t841 * t380 * t135 * t4355 - 0.16e2 * t11606 * t10433 + 0.8e1 * t11609 * t10438 + 0.16e3 / 0.3e1 * t4352 * t11612 * t867 - 0.992e3 / 0.3e1 * t4352 * t896 * t1417 * t136 - 0.8e2 * t3319 * t8360 * t3263 + 0.72e2 * t10402 * t3320 * t510 * t881 + 0.8e2 * t4025 * t8360 * t4347 + 0.32e2 * t8243 * t11630 * t3239 - 0.32e2 * t10507 * t11630 * t3245;
  t11645 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t807 * t1636 - t11293 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t308 * t4440 + t11271 - t11300 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t112 * (t11355 + t11417 + t11458 + t11495 + t11528 + t11559 + t11592 + t11637));
  tv4rho2tau28 = t11645 * t7 + 0.2e1 * t4445;

  if(out->v4rho2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2tau2[ip*p->dim.v4rho2tau2 + 8] += tv4rho2tau28;

  t11652 = t6 * t191 * t4545 / 0.8e1;
  t11654 = 0.5e1 / 0.177147e6 * t3495 * t3509;
  t11659 = t569 * t3385;
  t11661 = t1761 * t29;
  t11662 = t11661 * t261;
  t11666 = t5244 * t29;
  t11675 = 0.245e3 / 0.774840978e9 * t11659 * t1781 * t11662;
  t11680 = 0.665e3 / 0.753145430616e12 * t969 / t36 / t5230 * t5285;
  t11734 = -t11654 + 0.6e1 * t4523 * t266 + t85 * (-0.5e1 / 0.177147e6 * t3495 * t3496 + 0.7e2 / 0.387420489e9 * t11659 * t1756 * t11662 - 0.133e3 / 0.774840978e9 * t5241 * t11659 * t11666 * t261 + 0.14e2 / 0.531441e6 * t1757 * t3495 * t1761 + t11654 - t11675 + t11680) + 0.18e2 * t1694 * t982 * t1372 + 0.18e2 * t1694 * t1005 * t1372 - 0.18e2 * t5568 * t4486 * t229 - 0.3e1 * t589 * t4480 * t229 + 0.2e1 * t624 * t4480 * t251 - 0.9e1 * t589 * t4453 * t229 + 0.6e1 * t624 * t4453 * t251 - 0.9e1 * t589 * t4450 * t229 + 0.6e1 * t624 * t4450 * t251 + 0.18e2 * t1694 * t4447 * t229 - 0.18e2 * t1712 * t4447 * t251 + 0.12e2 * t624 * t1376 * t1042 - 0.9e1 * t589 * t4532 * t251 + 0.6e1 * t584 * t4542 * t229 - 0.3e1 * t589 * t4542 * t251 + 0.18e2 * t584 * t4529 * t229 - 0.9e1 * t589 * t4529 * t251;
  t11793 = 0.36e2 * t1004 * t1358 * t584 + 0.18e2 * t1005 * t1368 * t584 - 0.9e1 * t1005 * t1396 * t589 - 0.18e2 * t1042 * t1352 * t1726 - 0.18e2 * t1042 * t1358 * t589 - 0.9e1 * t1042 * t1369 * t589 + 0.18e2 * t1368 * t584 * t982 - 0.9e1 * t1396 * t589 * t982 - 0.18e2 * t1726 * t251 * t4526 - 0.18e2 * t1726 * t3477 * t420 + 0.18e2 * t229 * t4532 * t584 + 0.18e2 * t3410 * t406 * t584 - 0.9e1 * t3411 * t420 * t589 - 0.18e2 * t3414 * t420 * t589 - 0.18e2 * t3417 * t420 * t589 - 0.9e1 * t3420 * t420 * t589 - 0.9e1 * t3466 * t406 * t589 + 0.6e1 * t3466 * t421 * t624 + 0.18e2 * t3474 * t4495 - 0.18e2 * t4492 * t8782;
  t11807 = t405 * t1396;
  t11822 = t1368 * t420;
  t11832 = t420 * t1396;
  t11846 = t405 * t1372;
  t11853 = 0.6e1 * t624 * t1043 * t1396 - 0.18e2 * t1712 * t1373 * t1042 + 0.6e1 * t624 * t1014 * t1396 + 0.24e2 * t5296 * t4486 * t251 + 0.18e2 * t2456 * t11807 * t251 - 0.18e2 * t2465 * t11807 * t229 - 0.18e2 * t2465 * t405 * t1368 * t251 - 0.36e2 * t8642 * t3378 + 0.36e2 * t8660 * t3381 - 0.18e2 * t2465 * t11822 * t229 + 0.18e2 * t2456 * t11822 * t251 + 0.36e2 * t2456 * t3377 * t1042 + 0.18e2 * t2456 * t11832 * t229 - 0.18e2 * t3972 * t11832 * t251 + 0.36e2 * t6624 * t1351 * t420 * t251 - 0.36e2 * t2465 * t3377 * t1004 + 0.36e2 * t6624 * t11846 * t229 - 0.54e2 * t6650 * t11846 * t251 + t11675 - t11680;
  t11873 = t9712 * sigma[0];
  t11878 = t3931 * t222;
  t11881 = t9719 * sigma[0];
  t11886 = t4461 * t222;
  t11890 = t5343 * t3385 * sigma[0];
  t11895 = 0.3e1 / 0.32e2 * t3391 - 0.3e1 / 0.256e3 * t10224 * t62 - 0.27e2 / 0.256e3 * t6577 * t3923 - 0.9e1 / 0.64e2 * t5348 * t11873 + 0.27e2 / 0.32e2 * t1806 * t3425 - 0.27e2 / 0.64e2 * t5348 * t11878 - 0.45e2 / 0.128e3 * t5358 * t11881 + 0.27e2 / 0.16e2 * t1821 * t3121 - 0.45e2 / 0.128e3 * t5358 * t11886 - 0.15e2 / 0.64e2 * t5425 * t11890 + 0.15e2 / 0.16e2 * t1867 * t3404;
  t11930 = -0.45e2 / 0.64e2 * t5327 * t4464 * t222 - 0.15e2 / 0.32e2 * t5390 * t3385 * params->eta * sigma[0] + 0.15e2 / 0.8e1 * t1870 * t81 * t971 - 0.135e3 / 0.32e2 * t5390 * t3923 * t222 - 0.315e3 / 0.128e3 * t5399 * t11873 + 0.135e3 / 0.16e2 * t646 * t247 * t971 * params->eta - 0.945e3 / 0.128e3 * t5399 * t11878 - 0.63e2 / 0.16e2 * t5411 * t11881 + 0.189e3 / 0.16e2 * t242 * t659 * t971 * t610 - 0.63e2 / 0.16e2 * t5411 * t11886 - 0.63e2 / 0.32e2 * t5342 * t11890 + 0.21e2 / 0.4e1 * t78 * t4475 * t971;
  t11944 = t4522 * t234;
  t11990 = -0.3e1 * t235 * t3513 * t420 - 0.3e1 * t235 * t1407 * t1042 - 0.3e1 * t235 * t1066 * t1396 - 0.3e1 * t235 * t430 * t3466 - t235 * t266 * t4479 - t235 * t96 * (t11895 + t11930) - 0.6e1 * t1712 * t266 * t4485 + 0.3e1 * t217 * t4520 * t229 - t235 * t4520 * t251 + 0.18e2 * t4693 * t1005 - 0.6e1 * t11944 * t252 + 0.18e2 * t3474 * t4526 + 0.18e2 * t584 * t1066 * t1351 + 0.9e1 * t217 * t3513 * t405 + 0.9e1 * t217 * t1407 * t1004 + 0.9e1 * t217 * t1066 * t1368 + 0.9e1 * t217 * t430 * t3410 + 0.3e1 * t217 * t266 * t4541 + 0.3e1 * t217 * t96 * (-0.3e1 / 0.16e2 * t3391 * params->eta + 0.3e1 / 0.128e3 * t10224 * t3872 + 0.9e1 / 0.128e3 * t6577 * t3931 + 0.3e1 / 0.32e2 * t5348 * t11881 - 0.9e1 / 0.16e2 * t1806 * t3121 + 0.3e1 / 0.32e2 * t5348 * t11886 + 0.5e1 / 0.64e2 * t5358 * t11890 - 0.3e1 / 0.8e1 * t1821 * t3404) + 0.6e1 * t624 * t1066 * t1372;
  t11997 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t4545 - t11652 - 0.3e1 / 0.8e1 * t6 * t28 * (t11734 + t11793 + t11853 + t11990));
  tv4rhosigma30 = t11997 * t7 + t4549;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t12004 = t6 * t284 * t4648 / 0.8e1;
  t12006 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t4648 - t12004);
  tv4rhosigma39 = t12006 * t7 + t4652;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t12012 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t4545 - t11652);
  tv4rhosigma310 = t12012 * t7 + t4549;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t12025 = t4616 * t348;
  t12038 = t10312 * sigma[2];
  t12043 = t4056 * t336;
  t12046 = t10318 * sigma[2];
  t12051 = t4575 * t336;
  t12055 = t5343 * t3598 * sigma[2];
  t12060 = 0.3e1 / 0.32e2 * t3680 - 0.3e1 / 0.256e3 * t10611 * t136 - 0.27e2 / 0.256e3 * t7300 * t4048 - 0.9e1 / 0.64e2 * t6173 * t12038 + 0.27e2 / 0.32e2 * t2273 * t3716 - 0.27e2 / 0.64e2 * t6173 * t12043 - 0.45e2 / 0.128e3 * t6161 * t12046 + 0.27e2 / 0.16e2 * t2288 * t3337 - 0.45e2 / 0.128e3 * t6161 * t12051 - 0.15e2 / 0.64e2 * t6188 * t12055 + 0.15e2 / 0.16e2 * t2312 * t3693;
  t12095 = -0.45e2 / 0.64e2 * t6141 * t4598 * t336 - 0.15e2 / 0.32e2 * t6225 * t3598 * params->eta * sigma[2] + 0.15e2 / 0.8e1 * t2315 * t155 * t1103 - 0.135e3 / 0.32e2 * t6225 * t4048 * t336 - 0.315e3 / 0.128e3 * t6216 * t12038 + 0.135e3 / 0.16e2 * t902 * t361 * t1103 * params->eta - 0.945e3 / 0.128e3 * t6216 * t12043 - 0.63e2 / 0.16e2 * t6237 * t12046 + 0.189e3 / 0.16e2 * t356 * t915 * t1103 * t610 - 0.63e2 / 0.16e2 * t6237 * t12051 - 0.63e2 / 0.32e2 * t6168 * t12055 + 0.21e2 / 0.4e1 * t152 * t4609 * t1103;
  t12153 = -t349 * t4563 * t365 - 0.6e1 * t2187 * t380 * t4641 + 0.3e1 * t331 * t4563 * t343 - 0.6e1 * t12025 * t366 + 0.18e2 * t3663 * t4620 + 0.18e2 * t841 * t1198 * t1422 - t349 * t170 * (t12060 + t12095) + 0.18e2 * t4825 * t1137 - 0.3e1 * t349 * t477 * t3757 - t349 * t380 * t4613 - 0.3e1 * t349 * t1478 * t1174 - 0.3e1 * t349 * t1198 * t1467 + 0.3e1 * t331 * t170 * (-0.3e1 / 0.16e2 * t3680 * params->eta + 0.3e1 / 0.128e3 * t10611 * t4042 + 0.9e1 / 0.128e3 * t7300 * t4056 + 0.3e1 / 0.32e2 * t6173 * t12046 - 0.9e1 / 0.16e2 * t2273 * t3337 + 0.3e1 / 0.32e2 * t6173 * t12051 + 0.5e1 / 0.64e2 * t6161 * t12055 - 0.3e1 / 0.8e1 * t2288 * t3693) + 0.6e1 * t880 * t1198 * t1443 - 0.3e1 * t349 * t3775 * t467 + 0.9e1 * t331 * t1198 * t1439 + 0.9e1 * t331 * t477 * t3699 + 0.3e1 * t331 * t380 * t4578 + 0.9e1 * t331 * t3775 * t452 + 0.9e1 * t331 * t1478 * t1136;
  t12154 = t467 * t1467;
  t12158 = t452 * t1467;
  t12176 = t1439 * t467;
  t12183 = t452 * t1443;
  t12200 = t569 * t3598;
  t12202 = t11661 * t375;
  t12204 = 0.245e3 / 0.774840978e9 * t12200 * t2248 * t12202;
  t12209 = 0.665e3 / 0.753145430616e12 * t1101 / t114 / t6048 * t6101;
  t12211 = 0.5e1 / 0.177147e6 * t3605 * t3606;
  t12231 = -0.18e2 * t4141 * t12154 * t365 - 0.18e2 * t2774 * t12158 * t343 + 0.18e2 * t2780 * t12158 * t365 + 0.18e2 * t2780 * t12154 * t343 - 0.18e2 * t2774 * t452 * t1439 * t365 - 0.36e2 * t9254 * t3591 + 0.36e2 * t9271 * t3594 - 0.18e2 * t2774 * t12176 * t343 + 0.18e2 * t2780 * t12176 * t365 + 0.36e2 * t7228 * t12183 * t343 - 0.54e2 * t7235 * t12183 * t365 + 0.36e2 * t2780 * t3590 * t1174 + 0.36e2 * t7228 * t1422 * t467 * t365 - 0.36e2 * t2774 * t3590 * t1136 + t12204 - t12209 - t12211 + t159 * (-0.5e1 / 0.177147e6 * t3605 * t3764 + 0.7e2 / 0.387420489e9 * t12200 * t2225 * t12202 - 0.133e3 / 0.774840978e9 * t6059 * t12200 * t11666 * t375 + 0.14e2 / 0.531441e6 * t2226 * t3605 * t1761 + t12211 - t12204 + t12209) + 0.6e1 * t4617 * t380 - 0.3e1 * t846 * t4614 * t343;
  t12293 = 0.6e1 * t1146 * t1467 * t880 - 0.18e2 * t1174 * t1444 * t2187 + 0.12e2 * t1174 * t1447 * t880 + 0.6e1 * t1175 * t1467 * t880 - 0.18e2 * t2187 * t365 * t4582 + 0.18e2 * t2195 * t343 * t4582 + 0.18e2 * t343 * t4565 * t841 + 0.18e2 * t343 * t4568 * t841 + 0.6e1 * t343 * t4579 * t841 - 0.9e1 * t343 * t4585 * t846 - 0.9e1 * t343 * t4588 * t846 - 0.18e2 * t343 * t4642 * t6337 - 0.9e1 * t365 * t4565 * t846 - 0.9e1 * t365 * t4568 * t846 - 0.3e1 * t365 * t4579 * t846 + 0.6e1 * t365 * t4585 * t880 + 0.6e1 * t365 * t4588 * t880 + 0.2e1 * t365 * t4614 * t880 + 0.24e2 * t365 * t4642 * t6323 - 0.9e1 * t3757 * t453 * t846;
  t12352 = 0.18e2 * t1114 * t1439 * t841 + 0.18e2 * t1114 * t1443 * t2195 - 0.9e1 * t1114 * t1467 * t846 + 0.36e2 * t1136 * t1429 * t841 + 0.18e2 * t1137 * t1439 * t841 + 0.18e2 * t1137 * t1443 * t2195 - 0.9e1 * t1137 * t1467 * t846 - 0.18e2 * t1174 * t1423 * t2169 - 0.18e2 * t1174 * t1429 * t846 - 0.9e1 * t1174 * t1440 * t846 - 0.18e2 * t2169 * t365 * t4620 - 0.18e2 * t2169 * t3666 * t467 - 0.18e2 * t3669 * t467 * t846 - 0.18e2 * t3672 * t467 * t846 - 0.9e1 * t3675 * t467 * t846 + 0.18e2 * t3699 * t453 * t841 - 0.9e1 * t3700 * t467 * t846 + 0.6e1 * t3757 * t468 * t880 + 0.18e2 * t3663 * t4629 - 0.18e2 * t4626 * t9230;
  t12359 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t4648 - t12004 - 0.3e1 / 0.8e1 * t6 * t112 * (t12153 + t12231 + t12293 + t12352));
  tv4rhosigma319 = t12359 * t7 + t4652;

  if(out->v4rhosigma3 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  tv4rhosigma2lapl0 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 0] += tv4rhosigma2lapl0;

  tv4rhosigma2lapl1 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 1] += tv4rhosigma2lapl1;

  tv4rhosigma2lapl2 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 2] += tv4rhosigma2lapl2;

  tv4rhosigma2lapl3 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 3] += tv4rhosigma2lapl3;

  tv4rhosigma2lapl4 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 4] += tv4rhosigma2lapl4;

  tv4rhosigma2lapl5 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 5] += tv4rhosigma2lapl5;

  tv4rhosigma2lapl6 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 6] += tv4rhosigma2lapl6;

  tv4rhosigma2lapl7 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 7] += tv4rhosigma2lapl7;

  tv4rhosigma2lapl8 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 8] += tv4rhosigma2lapl8;

  tv4rhosigma2lapl9 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 9] += tv4rhosigma2lapl9;

  tv4rhosigma2lapl10 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 10] += tv4rhosigma2lapl10;

  tv4rhosigma2lapl11 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 11] += tv4rhosigma2lapl11;

  tv4rhosigma2lapl12 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 12] += tv4rhosigma2lapl12;

  tv4rhosigma2lapl13 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 13] += tv4rhosigma2lapl13;

  tv4rhosigma2lapl14 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 14] += tv4rhosigma2lapl14;

  tv4rhosigma2lapl15 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 15] += tv4rhosigma2lapl15;

  tv4rhosigma2lapl16 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 16] += tv4rhosigma2lapl16;

  tv4rhosigma2lapl17 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 17] += tv4rhosigma2lapl17;

  tv4rhosigma2lapl18 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 18] += tv4rhosigma2lapl18;

  tv4rhosigma2lapl19 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 19] += tv4rhosigma2lapl19;

  tv4rhosigma2lapl20 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 20] += tv4rhosigma2lapl20;

  tv4rhosigma2lapl21 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 21] += tv4rhosigma2lapl21;

  tv4rhosigma2lapl22 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 22] += tv4rhosigma2lapl22;

  tv4rhosigma2lapl23 = 0.e0;

  if(out->v4rhosigma2lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2lapl[ip*p->dim.v4rhosigma2lapl + 23] += tv4rhosigma2lapl23;

  t12366 = t6 * t191 * t4757 / 0.8e1;
  t12372 = t11190 * sigma[0];
  t12376 = t4713 * t222;
  t12379 = t4516 * t1822;
  t12380 = t12379 * sigma[0];
  t12403 = -0.21e2 / 0.32e2 * t3796 + 0.3e1 / 0.32e2 * t11120 * t62 + 0.9e1 / 0.16e2 * t6577 * t4226 + 0.3e1 / 0.4e1 * t5348 * t12372 - 0.63e2 / 0.16e2 * t4457 + 0.9e1 / 0.8e1 * t5348 * t12376 + 0.15e2 / 0.16e2 * t5358 * t12380 - 0.63e2 / 0.16e2 * t4459 + 0.45e2 / 0.8e1 * t5327 * t4716 * t222 + 0.15e2 / 0.4e1 * t5390 * t4516 * params->eta * sigma[0] - 0.105e3 / 0.8e1 * t4465 + 0.45e2 / 0.2e1 * t5390 * t4226 * t222 + 0.105e3 / 0.8e1 * t5399 * t12372 - 0.315e3 / 0.8e1 * t4469 + 0.315e3 / 0.16e2 * t5399 * t12376 + 0.21e2 / 0.2e1 * t5411 * t12380 - 0.441e3 / 0.16e2 * t4473;
  t12419 = t1351 * t234 * t96;
  t12439 = t584 * t1407;
  t12442 = t589 * t1407;
  t12460 = -t235 * t96 * t12403 - t235 * t3513 * t493 - t235 * t1407 * t1259 - 0.2e1 * t235 * t1066 * t1525 - 0.12e2 * t2456 * t985 * t4746 - 0.24e2 * t4872 * t3814 + 0.12e2 * t12419 * t1220 - 0.13e2 * t1493 * t1363 + 0.63e2 / 0.16e2 * t484 * t4537 + 0.2e2 * t2456 * t218 * t39 * t1372 - 0.3e1 * t2465 * t3954 * t3848 - 0.3e1 * t2465 * t3954 * t2457 + 0.3e1 * t2456 * t3954 * t3856 - 0.12e2 * t12439 * t1215 + 0.6e1 * t12442 * t1220 - 0.3e1 / 0.4e1 * t1213 * t4297 * t2998 + 0.3e1 / 0.8e1 * t1218 * t4297 * t3004 - 0.3e1 / 0.8e1 * t484 * t11120 * t3872 + 0.24e2 * t6624 * t3961 * t2457 - 0.36e2 * t6650 * t3961 * t3856;
  t12501 = t3474 * t430;
  t12508 = -0.12e2 * t6629 * t4747 + 0.6e1 * t3033 * t4738 + 0.6e1 * t1218 * t985 * t4737 + 0.6e1 * t1218 * t218 * t54 * t3466 + 0.3e1 * t3976 * t1503 + 0.3e1 * t1493 * t3832 - 0.9e1 / 0.16e2 * t1223 * t4743 - 0.9e1 / 0.16e2 * t484 * t6577 * t4713 + t1493 * t3797 - 0.24e2 * t3826 * t3814 - 0.12e2 * t3835 * t4753 - 0.12e2 * t3056 * t4753 - 0.12e2 * t1213 * t985 * t4752 - 0.12e2 * t1213 * t218 * t54 * t3410 + 0.12e2 * t10180 * t1490 + 0.12e2 * t3793 * t3819 + 0.12e2 * t3793 * t3823 - 0.24e2 * t12501 * t1486 - 0.24e2 * t10177 * t1486 - 0.24e2 * t3826 * t3810;
  t12571 = -0.2e1 * t235 * t430 * t3947 - t235 * t266 * t4727 - 0.13e2 / 0.2e1 * t217 * t430 * t396 * t67 + 0.2e1 * t624 * t4728 * t251 - 0.6e1 * t589 * t4732 * t229 + 0.4e1 * t624 * t4732 * t251 - 0.3e1 * t589 * t4728 * t229 - 0.3e1 * t589 * t4730 * t229 + 0.2e1 * t624 * t4730 * t251 - 0.6e1 * t589 * t3919 * t405 - 0.6e1 * t589 * t3948 * t405 - 0.6e1 * t589 * t1526 * t1004 - 0.6e1 * t589 * t3917 * t405 - 0.6e1 * t589 * t3950 * t405 - 0.6e1 * t589 * t1512 * t1004 + 0.2e1 * t624 * t494 * t3466 + 0.3e1 / 0.2e1 * t217 * t1066 * t1497 * t67 + 0.4e1 * t624 * t1526 * t1042 + 0.2e1 * t624 * t1243 * t1396 + 0.2e1 * t624 * t1260 * t1396;
  t12583 = t1372 * params->eta;
  t12602 = t1368 * params->eta;
  t12609 = t1396 * params->eta;
  t12641 = 0.4e1 * t624 * t3948 * t420 - 0.6e1 * t3087 * t3864 * t3838 * t251 + 0.6e1 * t2997 * t3871 * t10020 * sigma[0] - 0.8e1 * t3855 * t1231 * t12583 * sigma[0] - 0.6e1 * t3087 * t3864 * t3843 * t229 + 0.6e1 * t3855 * t3864 * t3843 * t251 - 0.3e1 * t3003 * t3871 * t10036 * sigma[0] - 0.16e2 * t10059 * t3840 - 0.8e1 * t2997 * t1231 * t12602 * sigma[0] + 0.8e1 * t10062 * t3845 + 0.4e1 * t3003 * t1231 * t12609 * sigma[0] - 0.48e2 * t8016 * t3088 * t3381 + 0.4e1 * t624 * t1512 * t1042 + 0.4e1 * t624 * t3919 * t420 + 0.4e1 * t624 * t3917 * t420 + 0.4e1 * t624 * t3950 * t420 - 0.3e1 * t589 * t494 * t3410 - 0.6e1 * t1712 * t1260 * t1372 - 0.3e1 * t589 * t1243 * t1368 - 0.3e1 * t589 * t1260 * t1368;
  t12667 = t1525 * t420;
  t12671 = t493 * t1396;
  t12681 = t493 * t1368;
  t12697 = t493 * t1351;
  t12701 = -0.6e1 * t8782 * t4656 - 0.6e1 * t1726 * t1243 * t1351 - 0.6e1 * t1726 * t1260 * t1351 - 0.6e1 * t1712 * t1243 * t1372 + 0.2e2 * t4694 * t401 + 0.21e2 / 0.8e1 * t484 * t4535 + 0.13e2 / 0.2e1 * t1218 * t1361 * t420 + 0.1e2 * t4704 * t401 - 0.13e2 * t1213 * t1361 * t405 - 0.12e2 * t3972 * t12667 * t251 + 0.6e1 * t2456 * t12671 * t229 - 0.6e1 * t3972 * t12671 * t251 + 0.16e2 * t7765 * t9863 * t3844 + 0.6e1 * t2456 * t12681 * t251 + 0.12e2 * t8660 * t3969 - 0.12e2 * t1712 * t430 * t3973 + 0.12e2 * t2456 * t12667 * t229 - 0.6e1 * t4704 * t1226 - 0.3e1 / 0.8e1 * t1223 * t4707 + 0.12e2 * t6624 * t12697 * t251;
  t12727 = t1525 * t405;
  t12743 = t493 * t1372;
  t12756 = -0.12e2 * t2465 * t3961 * t1004 - 0.6e1 * t2465 * t12681 * t229 - 0.3e1 / 0.2e1 * t1218 * t3954 * t1042 - 0.6e1 * t217 * t3513 * t485 + 0.3e1 * t3835 * t4698 + 0.3e1 * t3056 * t4698 + 0.3e1 * t1213 * t3954 * t1004 - 0.3e1 / 0.2e1 * t3033 * t4701 - 0.12e2 * t8642 * t3962 + 0.12e2 * t8660 * t3965 - 0.12e2 * t2465 * t12727 * t229 + 0.12e2 * t2456 * t12727 * t251 - 0.12e2 * t4693 * t266 * t485 - 0.12e2 * t4694 * t1226 + 0.3e1 * t3826 * t3955 - 0.3e1 / 0.2e1 * t3793 * t3958 + 0.24e2 * t9904 * t12743 * t251 - 0.12e2 * t3972 * t3968 * t1042 + 0.12e2 * t2456 * t10071 * t420 + 0.12e2 * t2456 * t10076 * t420;
  t12782 = t238 * t4225;
  t12817 = 0.12e2 * t2456 * t3961 * t1042 - 0.18e2 * t6650 * t12743 * t229 + 0.12e2 * t6629 * t4690 - 0.2e2 * t3793 * t3805 - 0.1e2 * t1218 * t218 * t39 * t1396 + 0.4e2 * t3826 * t3801 + 0.2e2 * t1213 * t218 * t39 * t1368 - 0.3e1 * t10062 * t3868 + 0.3e1 * t3861 * t3873 - 0.9e1 / 0.8e1 * t2997 * t12782 * t7670 + 0.9e1 / 0.16e2 * t3003 * t12782 * t7654 - 0.3e1 / 0.4e1 * t1230 * t640 * t4516 * t1822 * sigma[0] + 0.6e1 * t7662 * t4672 + 0.6e1 * t2997 * t3864 * t10015 - 0.24e2 * t8016 * t3088 * t8619 + 0.36e2 * t9701 * t3088 * t1372 * t251 - 0.24e2 * t3855 * t3088 * t420 * t1042 - 0.3e1 * t7675 * t4675 - 0.3e1 * t7678 * t4675 - 0.3e1 * t3003 * t3864 * t10029;
  t12829 = t1694 * t3860;
  t12842 = t74 * t405 * t62;
  t12846 = t74 * t420 * t62;
  t12878 = -0.4e1 * t1232 * t1407 * t217 * t57 - 0.26e2 * t1231 * t2997 * t3838 + 0.13e2 * t1231 * t3003 * t3843 + 0.24e2 * t3087 * t3088 * t8625 + 0.24e2 * t3087 * t3088 * t8629 - 0.4e2 * t3087 * t3377 * t8021 + 0.6e1 * t10068 * t4672 + 0.24e2 * t4669 * t7973 + 0.24e2 * t4669 * t7976 + 0.24e2 * t4669 * t9675 + 0.6e1 * t4672 * t7659;
  t12887 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t4757 - t12366 - 0.3e1 / 0.8e1 * t6 * t28 * (0.12e2 * t1368 * t251 * t3087 * t3088 - 0.12e2 * t1396 * t251 * t3088 * t3855 - 0.8e1 * t1229 * t1232 * t4693 + 0.12e2 * t3087 * t3088 * t8653 + 0.6e1 * t10059 * t3865 - 0.24e2 * t12829 * t3857 + 0.2e1 * t12842 * t9794 - t12846 * t9799 + 0.24e2 * t3849 * t9780 + 0.24e2 * t3852 * t9780 + t12460 + t12508 + t12571 + t12641 + t12701 + t12756 + t12817 + t12878));
  tv4rhosigma2tau0 = t12887 * t7 + t4761;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 0] += tv4rhosigma2tau0;

  tv4rhosigma2tau1 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 1] += tv4rhosigma2tau1;

  tv4rhosigma2tau2 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 2] += tv4rhosigma2tau2;

  tv4rhosigma2tau3 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 3] += tv4rhosigma2tau3;

  tv4rhosigma2tau4 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 4] += tv4rhosigma2tau4;

  tv4rhosigma2tau5 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 5] += tv4rhosigma2tau5;

  tv4rhosigma2tau6 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 6] += tv4rhosigma2tau6;

  tv4rhosigma2tau7 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 7] += tv4rhosigma2tau7;

  tv4rhosigma2tau8 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 8] += tv4rhosigma2tau8;

  tv4rhosigma2tau9 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 9] += tv4rhosigma2tau9;

  tv4rhosigma2tau10 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 10] += tv4rhosigma2tau10;

  t12894 = t6 * t284 * t4866 / 0.8e1;
  t12896 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t4866 - t12894);
  tv4rhosigma2tau11 = t12896 * t7 + t4870;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 11] += tv4rhosigma2tau11;

  t12902 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t4757 - t12366);
  tv4rhosigma2tau12 = t12902 * t7 + t4761;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 12] += tv4rhosigma2tau12;

  tv4rhosigma2tau13 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 13] += tv4rhosigma2tau13;

  tv4rhosigma2tau14 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 14] += tv4rhosigma2tau14;

  tv4rhosigma2tau15 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 15] += tv4rhosigma2tau15;

  tv4rhosigma2tau16 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 16] += tv4rhosigma2tau16;

  tv4rhosigma2tau17 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 17] += tv4rhosigma2tau17;

  tv4rhosigma2tau18 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 18] += tv4rhosigma2tau18;

  tv4rhosigma2tau19 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 19] += tv4rhosigma2tau19;

  tv4rhosigma2tau20 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 20] += tv4rhosigma2tau20;

  tv4rhosigma2tau21 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 21] += tv4rhosigma2tau21;

  tv4rhosigma2tau22 = 0.e0;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 22] += tv4rhosigma2tau22;

  t12932 = t510 * t1443;
  t12947 = t1573 * t467;
  t12951 = t510 * t1467;
  t12958 = t510 * t1439;
  t12964 = -0.13e2 * t1287 * t1432 * t452 + 0.2e2 * t4826 * t448 + 0.21e2 / 0.8e1 * t501 * t4571 + 0.13e2 / 0.2e1 * t1292 * t1432 * t467 + 0.1e2 * t4829 * t448 + 0.3e1 * t3287 * t4838 + 0.3e1 * t1287 * t4126 * t1136 - 0.12e2 * t4141 * t4137 * t1174 + 0.3e1 * t4181 * t4838 + 0.12e2 * t2780 * t4130 * t1174 - 0.18e2 * t7235 * t12932 * t343 + 0.24e2 * t10548 * t12932 * t365 + 0.12e2 * t7239 * t4835 + 0.12e2 * t2780 * t10852 * t467 + 0.12e2 * t2780 * t10856 * t467 - 0.12e2 * t4141 * t12947 * t365 + 0.6e1 * t2780 * t12951 * t343 - 0.6e1 * t4141 * t12951 * t365 + 0.6e1 * t2780 * t12958 * t365 + 0.12e2 * t9271 * t4138;
  t12975 = t1573 * t452;
  t13001 = t510 * t1422;
  t13013 = t3663 * t477;
  t13018 = -0.12e2 * t2187 * t477 * t4142 + 0.12e2 * t2780 * t12947 * t343 - 0.12e2 * t9254 * t4131 + 0.12e2 * t9271 * t4134 - 0.12e2 * t2774 * t12975 * t343 + 0.12e2 * t2780 * t12975 * t365 - 0.6e1 * t2774 * t12958 * t343 - 0.12e2 * t4825 * t380 * t502 - 0.12e2 * t4826 * t1300 + 0.3e1 * t4175 * t4148 - 0.3e1 / 0.2e1 * t4178 * t4127 - 0.6e1 * t331 * t3775 * t502 - 0.6e1 * t4829 * t1300 - 0.3e1 / 0.8e1 * t1297 * t4832 + 0.12e2 * t7228 * t13001 * t365 - 0.12e2 * t2774 * t4130 * t1136 - 0.3e1 / 0.2e1 * t3297 * t4841 - 0.3e1 / 0.2e1 * t1292 * t4126 * t1174 - 0.24e2 * t13013 * t1534 - 0.24e2 * t10554 * t1534;
  t13051 = t1422 * t348 * t170;
  t13064 = t841 * t1478;
  t13067 = t846 * t1478;
  t13073 = -0.24e2 * t4175 * t4186 - 0.24e2 * t4175 * t4190 + t1541 * t4159 + 0.24e2 * t7228 * t4130 * t2781 - 0.36e2 * t7235 * t4130 * t4026 - 0.3e1 * t2774 * t4126 * t4018 - 0.12e2 * t7239 * t4862 - 0.12e2 * t2780 * t1117 * t4861 + 0.3e1 * t4145 * t1551 + 0.3e1 * t1541 * t4164 - 0.9e1 / 0.16e2 * t1297 * t4846 - 0.9e1 / 0.16e2 * t501 * t7300 * t4808 - 0.24e2 * t4962 * t4190 + 0.12e2 * t13051 * t1294 + 0.6e1 * t1292 * t332 * t131 * t3757 - 0.3e1 * t2774 * t4126 * t2781 + 0.3e1 * t2780 * t4126 * t4026 - 0.12e2 * t13064 * t1289 + 0.6e1 * t13067 * t1294 - 0.3e1 / 0.4e1 * t1287 * t4397 * t3238;
  t13112 = t11385 * sigma[2];
  t13116 = t4808 * t336;
  t13119 = t4559 * t1822;
  t13120 = t13119 * sigma[2];
  t13143 = -0.21e2 / 0.32e2 * t4158 + 0.3e1 / 0.32e2 * t11374 * t136 + 0.9e1 / 0.16e2 * t7300 * t4425 + 0.3e1 / 0.4e1 * t6173 * t13112 - 0.63e2 / 0.16e2 * t4592 + 0.9e1 / 0.8e1 * t6173 * t13116 + 0.15e2 / 0.16e2 * t6161 * t13120 - 0.63e2 / 0.16e2 * t4594 + 0.45e2 / 0.8e1 * t6141 * t4811 * t336 + 0.15e2 / 0.4e1 * t6225 * t4559 * params->eta * sigma[2] - 0.105e3 / 0.8e1 * t4599 + 0.45e2 / 0.2e1 * t6225 * t4425 * t336 + 0.105e3 / 0.8e1 * t6216 * t13112 - 0.315e3 / 0.8e1 * t4603 + 0.315e3 / 0.16e2 * t6216 * t13116 + 0.21e2 / 0.2e1 * t6237 * t13120 - 0.441e3 / 0.16e2 * t4607;
  t13153 = t1467 * params->eta;
  t13166 = 0.3e1 / 0.8e1 * t1292 * t4397 * t3244 - 0.3e1 / 0.8e1 * t501 * t11374 * t4042 + 0.12e2 * t10557 * t1538 + 0.12e2 * t4178 * t4195 + 0.12e2 * t4178 * t4172 + 0.6e1 * t3297 * t4858 + 0.6e1 * t1292 * t1117 * t4857 - 0.12e2 * t4181 * t4852 - 0.12e2 * t3287 * t4852 - 0.12e2 * t1287 * t1117 * t4851 - 0.12e2 * t1287 * t332 * t131 * t3699 - 0.2e1 * t349 * t477 * t4072 - t349 * t380 * t4822 - t349 * t170 * t13143 - t349 * t1478 * t1333 - 0.2e1 * t349 * t1198 * t1573 - t349 * t3775 * t510 + 0.4e1 * t3243 * t1305 * t13153 * sigma[2] - 0.6e1 * t3319 * t4034 * t4013 * t343 + 0.6e1 * t4025 * t4034 * t4013 * t365;
  t13184 = t1443 * params->eta;
  t13191 = t1439 * params->eta;
  t13233 = -0.3e1 * t3243 * t4041 * t10777 * sigma[2] - 0.48e2 * t8355 * t3320 * t3594 - 0.6e1 * t3319 * t4034 * t4008 * t365 + 0.6e1 * t3237 * t4041 * t10800 * sigma[2] - 0.8e1 * t4025 * t1305 * t13184 * sigma[2] - 0.16e2 * t10782 * t4010 - 0.8e1 * t3237 * t1305 * t13191 * sigma[2] + 0.8e1 * t10785 * t4015 + 0.63e2 / 0.16e2 * t501 * t4573 + 0.4e2 * t4175 * t4168 - 0.13e2 * t1541 * t1434 - 0.2e2 * t4178 * t4152 - 0.1e2 * t1292 * t332 * t117 * t1467 + 0.2e2 * t2780 * t332 * t117 * t1443 + 0.2e2 * t1287 * t332 * t117 * t1439 + 0.2e1 * t880 * t4799 * t365 - 0.6e1 * t2169 * t1317 * t1422 - 0.6e1 * t2169 * t1334 * t1422 - 0.3e1 * t846 * t4799 * t343 - 0.6e1 * t2187 * t1317 * t1443;
  t13293 = -0.6e1 * t1136 * t1560 * t846 - 0.6e1 * t1136 * t1574 * t846 + 0.4e1 * t1174 * t1560 * t880 + 0.4e1 * t1174 * t1574 * t880 - 0.3e1 * t1317 * t1439 * t846 + 0.2e1 * t1317 * t1467 * t880 - 0.3e1 * t1334 * t1439 * t846 - 0.6e1 * t1334 * t1443 * t2187 + 0.2e1 * t1334 * t1467 * t880 - 0.3e1 * t3699 * t511 * t846 + 0.2e1 * t3757 * t511 * t880 - 0.6e1 * t4073 * t452 * t846 + 0.4e1 * t4073 * t467 * t880 - 0.6e1 * t4075 * t452 * t846 + 0.4e1 * t4075 * t467 * t880 - 0.6e1 * t4077 * t452 * t846 + 0.4e1 * t4077 * t467 * t880 - 0.6e1 * t4080 * t452 * t846 + 0.4e1 * t4080 * t467 * t880 - 0.6e1 * t4765 * t9230;
  t13324 = t2195 * t4030;
  t13354 = 0.2e1 * t880 * t4823 * t365 + 0.3e1 / 0.2e1 * t331 * t1198 * t1545 * t141 - 0.6e1 * t846 * t4801 * t343 + 0.4e1 * t880 * t4801 * t365 - 0.3e1 * t846 * t4823 * t343 - 0.13e2 / 0.2e1 * t331 * t477 * t443 * t141 + 0.16e2 * t8243 * t10496 * t4014 + 0.12e2 * t3319 * t3320 * t1439 * t365 + 0.24e2 * t10477 * t4022 - 0.24e2 * t13324 * t4027 + 0.12e2 * t3319 * t3320 * t9262 - 0.12e2 * t4025 * t3320 * t1467 * t365 + 0.24e2 * t8335 * t4793 + 0.24e2 * t3319 * t3320 * t9243 + 0.24e2 * t3319 * t3320 * t9247 + 0.6e1 * t10788 * t4796 + 0.6e1 * t8404 * t4796 + 0.6e1 * t8372 * t4796 + 0.6e1 * t3237 * t4034 * t10795 - 0.24e2 * t8355 * t3320 * t9283;
  t13369 = t352 * t4353;
  t13388 = t148 * t452 * t136;
  t13392 = t148 * t467 * t136;
  t13418 = -0.4e1 * t1306 * t134 * t1478 * t331 - 0.3e1 * t10772 * t3243 * t4034 - 0.26e2 * t1305 * t3237 * t4008 + 0.13e2 * t1305 * t3243 * t4013 - 0.4e2 * t3319 * t3590 * t8360 + 0.2e1 * t10431 * t13388 - t10436 * t13392 + 0.24e2 * t10448 * t4793 - 0.3e1 * t4790 * t8388 - 0.3e1 * t4790 * t8391 + 0.24e2 * t4793 * t8331;
  t13427 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t4866 - t12894 - 0.3e1 / 0.8e1 * t6 * t112 * (t12964 + t13018 + t13073 + t13166 + t13233 + t13293 + t13354 + 0.36e2 * t10402 * t3320 * t1443 * t365 - 0.24e2 * t4025 * t3320 * t467 * t1174 + 0.6e1 * t10782 * t4035 - 0.3e1 * t10785 * t4038 + 0.3e1 * t4031 * t4043 - 0.9e1 / 0.8e1 * t3237 * t13369 * t8380 + 0.9e1 / 0.16e2 * t3243 * t13369 * t8399 - 0.3e1 / 0.4e1 * t1304 * t896 * t4559 * t1822 * sigma[2] - 0.8e1 * t4825 * t1303 * t1306 + 0.24e2 * t10477 * t4019 + t13418));
  tv4rhosigma2tau23 = t13427 * t7 + t4870;

  if(out->v4rhosigma2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma2tau[ip*p->dim.v4rhosigma2tau + 23] += tv4rhosigma2tau23;

  tv4rhosigmalapl20 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 0] += tv4rhosigmalapl20;

  tv4rhosigmalapl21 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 1] += tv4rhosigmalapl21;

  tv4rhosigmalapl22 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 2] += tv4rhosigmalapl22;

  tv4rhosigmalapl23 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 3] += tv4rhosigmalapl23;

  tv4rhosigmalapl24 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 4] += tv4rhosigmalapl24;

  tv4rhosigmalapl25 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 5] += tv4rhosigmalapl25;

  tv4rhosigmalapl26 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 6] += tv4rhosigmalapl26;

  tv4rhosigmalapl27 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 7] += tv4rhosigmalapl27;

  tv4rhosigmalapl28 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 8] += tv4rhosigmalapl28;

  tv4rhosigmalapl29 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 9] += tv4rhosigmalapl29;

  tv4rhosigmalapl210 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 10] += tv4rhosigmalapl210;

  tv4rhosigmalapl211 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 11] += tv4rhosigmalapl211;

  tv4rhosigmalapl212 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 12] += tv4rhosigmalapl212;

  tv4rhosigmalapl213 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 13] += tv4rhosigmalapl213;

  tv4rhosigmalapl214 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 14] += tv4rhosigmalapl214;

  tv4rhosigmalapl215 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 15] += tv4rhosigmalapl215;

  tv4rhosigmalapl216 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 16] += tv4rhosigmalapl216;

  tv4rhosigmalapl217 = 0.e0;

  if(out->v4rhosigmalapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapl2[ip*p->dim.v4rhosigmalapl2 + 17] += tv4rhosigmalapl217;

  tv4rhosigmalapltau0 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 0] += tv4rhosigmalapltau0;

  tv4rhosigmalapltau1 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 1] += tv4rhosigmalapltau1;

  tv4rhosigmalapltau2 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 2] += tv4rhosigmalapltau2;

  tv4rhosigmalapltau3 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 3] += tv4rhosigmalapltau3;

  tv4rhosigmalapltau4 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 4] += tv4rhosigmalapltau4;

  tv4rhosigmalapltau5 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 5] += tv4rhosigmalapltau5;

  tv4rhosigmalapltau6 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 6] += tv4rhosigmalapltau6;

  tv4rhosigmalapltau7 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 7] += tv4rhosigmalapltau7;

  tv4rhosigmalapltau8 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 8] += tv4rhosigmalapltau8;

  tv4rhosigmalapltau9 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 9] += tv4rhosigmalapltau9;

  tv4rhosigmalapltau10 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 10] += tv4rhosigmalapltau10;

  tv4rhosigmalapltau11 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 11] += tv4rhosigmalapltau11;

  tv4rhosigmalapltau12 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 12] += tv4rhosigmalapltau12;

  tv4rhosigmalapltau13 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 13] += tv4rhosigmalapltau13;

  tv4rhosigmalapltau14 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 14] += tv4rhosigmalapltau14;

  tv4rhosigmalapltau15 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 15] += tv4rhosigmalapltau15;

  tv4rhosigmalapltau16 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 16] += tv4rhosigmalapltau16;

  tv4rhosigmalapltau17 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 17] += tv4rhosigmalapltau17;

  tv4rhosigmalapltau18 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 18] += tv4rhosigmalapltau18;

  tv4rhosigmalapltau19 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 19] += tv4rhosigmalapltau19;

  tv4rhosigmalapltau20 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 20] += tv4rhosigmalapltau20;

  tv4rhosigmalapltau21 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 21] += tv4rhosigmalapltau21;

  tv4rhosigmalapltau22 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 22] += tv4rhosigmalapltau22;

  tv4rhosigmalapltau23 = 0.e0;

  if(out->v4rhosigmalapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmalapltau[ip*p->dim.v4rhosigmalapltau + 23] += tv4rhosigmalapltau23;

  t13434 = t6 * t191 * t4956 / 0.8e1;
  t13437 = 0.1e1 / t37 / t970;
  t13438 = t13437 * t238;
  t13443 = t13437 * t610;
  t13444 = t13443 * sigma[0];
  t13462 = 0.9e1 / 0.2e1 * t4297 - 0.3e1 / 0.4e1 * t13438 * t62 - 0.9e1 / 0.4e1 * t6577 * t4885 - 0.3e1 * t5348 * t13444 + 0.27e2 / 0.2e1 * t4711 - 0.45e2 * t5327 * t4945 * t222 - 0.3e2 * t5390 * t13437 * params->eta * sigma[0] + 0.9e2 * t4717 - 0.9e2 * t5390 * t4885 * t222 - 0.105e3 / 0.2e1 * t5399 * t13444 + 0.135e3 * t4721;
  t13505 = -t235 * t96 * t13462 + 0.12e2 * t10180 * t1587 + 0.8e2 * t2465 * t609 * t1497 * t420 + 0.72e2 * t1213 * t1821 * t4226 - 0.2e2 * t3793 * t4310 - 0.2e2 * t1218 * t218 * t39 * t1525 + 0.2e2 * t4661 - t235 * t1066 * t1603 - t235 * t430 * t4237 - t235 * t266 * t4952 - 0.3e1 * t589 * t4953 * t229 - 0.3e1 * t589 * t4940 * t229 + 0.2e1 * t624 * t4940 * t251 + 0.2e1 * t624 * t4221 * t420 + 0.2e1 * t624 * t4238 * t420 + 0.2e1 * t624 * t1604 * t1042;
  t13552 = t1525 * params->eta;
  t13560 = -0.3e1 * t589 * t4221 * t405 - 0.3e1 * t589 * t4238 * t405 - 0.3e1 * t589 * t1604 * t1004 + 0.4e1 * t624 * t1260 * t1525 + 0.4e1 * t624 * t494 * t3947 + 0.4e1 * t624 * t1512 * t1259 + 0.4e1 * t624 * t1243 * t1525 - 0.6e1 * t1712 * t1595 * t1042 + 0.6e1 * t1694 * t4928 * t229 - 0.6e1 * t1712 * t4928 * t251 + 0.6e1 * t1694 * t1595 * t1004 - 0.6e1 * t1712 * t4218 * t420 + 0.2e1 * t624 * t4953 * t251 - 0.6e1 * t217 * t1066 * t1582 * t67 + 0.6e1 * t1694 * t4218 * t405 + 0.8e1 * t3003 * t1231 * t13552 * sigma[0] - 0.32e2 * t11240 * t4242 * t3844;
  t13605 = -0.48e2 * t8016 * t3088 * t3965 - 0.48e2 * t8016 * t3088 * t3969 + 0.72e2 * t9701 * t3088 * t3973 + 0.8e1 * t10062 * t4215 - 0.6e1 * t3087 * t3864 * t4213 * t229 + 0.6e1 * t3855 * t3864 * t4213 * t251 - 0.3e1 * t3003 * t3871 * t11235 * sigma[0] + 0.4e2 * t4699 - 0.2e2 * t4702 - 0.9e1 * t4708 + 0.36e2 * t1213 * t1806 * t4225 - 0.8e2 * t3826 * t4273 - 0.8e2 * t4872 * t4273 + 0.13e2 / 0.2e1 * t1218 * t1361 * t493 + 0.2e1 * t624 * t1066 * t1594 + 0.24e2 * t1004 * t84 * t96 * t1583;
  t13611 = t493 * t1525;
  t13618 = t1603 * t405;
  t13625 = t1603 * t420;
  t13635 = t1594 * t420;
  t13647 = t1594 * t405;
  t13660 = 0.24e2 * t4871 * t266 * t1583 + 0.24e2 * t12501 * t1583 + 0.12e2 * t2456 * t13611 * t229 - 0.12e2 * t3972 * t13611 * t251 - 0.6e1 * t2465 * t13618 * t229 + 0.6e1 * t2456 * t13618 * t251 + 0.6e1 * t2456 * t13625 * t229 - 0.6e1 * t3972 * t13625 * t251 + 0.12e2 * t2456 * t3961 * t1259 - 0.18e2 * t6650 * t13635 * t229 + 0.24e2 * t9904 * t13635 * t251 - 0.12e2 * t3972 * t3968 * t1259 + 0.3e1 / 0.2e1 * t1223 * t4919 + 0.12e2 * t6624 * t13647 * t229 - 0.18e2 * t6650 * t13647 * t251 - 0.16e2 * t9871 * t11157 * t3844 + 0.16e2 * t7765 * t11157 * t3839;
  t13699 = 0.6e1 * t1218 * t4280 * t1042 - 0.12e2 * t3826 * t4281 + 0.6e1 * t3793 * t4284 - 0.12e2 * t3056 * t4908 - 0.12e2 * t1213 * t4280 * t1004 + 0.6e1 * t3033 * t4911 - 0.6e1 * t1213 * t6577 * t4881 - 0.3e1 / 0.2e1 * t3033 * t4897 - 0.3e1 / 0.2e1 * t1218 * t3954 * t1259 - 0.12e2 * t3835 * t4908 + 0.24e2 * t10177 * t1583 - 0.6e1 * t3835 * t4882 - 0.6e1 * t3056 * t4882 - 0.12e2 * t3835 * t4886 - 0.12e2 * t3056 * t4886 - 0.24e2 * t8642 * t4302;
  t13726 = t405 * t234 * t96;
  t13749 = 0.48e2 * t3826 * t4306 + 0.6e1 * t2465 * t1806 * t4881 * t251 - 0.24e2 * t11085 * t4876 - 0.24e2 * t6636 * t4876 - 0.24e2 * t2465 * t609 * t1582 * t1042 - 0.4e1 * t1493 * t4298 + 0.3e1 * t1213 * t4918 * t2998 - 0.3e1 / 0.2e1 * t1218 * t4918 * t3004 + 0.3e1 / 0.2e1 * t484 * t13438 * t3872 - 0.24e2 * t13726 * t4302 + 0.48e2 * t4872 * t4306 + 0.12e2 * t1218 * t218 * t54 * t3947 + 0.12e2 * t2465 * t4280 * t3848 + 0.12e2 * t2465 * t4280 * t2457 - 0.12e2 * t2456 * t4280 * t3856 - 0.24e2 * t3855 * t3088 * t10114 + 0.24e2 * t9780 * t4246;
  t13758 = t5564 * t4240;
  t13774 = t640 * t4881;
  t13781 = t81 * t13437;
  t13801 = -0.8e1 * t10958 * t12842 + 0.4e1 * t10961 * t12846 + 0.32e2 * t4871 * t4240 * t4243 + 0.48e2 * t13758 * t10978 * t3856 - 0.48e2 * t3087 * t10978 * t420 * t222 + 0.32e2 * t584 * t430 * t58 * t4243 - 0.8e1 * t2997 * t640 * t13437 * t62 + 0.12e2 * t11240 * t13774 * t3004 - 0.24e2 * t2997 * t13774 * t651 - 0.2e2 * t4241 * t13781 * t3872 + 0.24e2 * t9675 * t4889 + 0.24e2 * t7973 * t4889 + 0.24e2 * t7976 * t4889 + 0.24e2 * t3087 * t3088 * t10071 + 0.24e2 * t3087 * t3088 * t10076 - 0.24e2 * t9828 * t4892 - 0.24e2 * t9833 * t4892;
  t13846 = t74 * t493 * t62;
  t13848 = -0.24e2 * t3855 * t3088 * t10126 - 0.3e1 * t7675 * t4900 - 0.3e1 * t7678 * t4900 - 0.3e1 * t3003 * t3864 * t11230 + 0.24e2 * t3087 * t3088 * t10104 - 0.24e2 * t3855 * t3088 * t1525 * t251 + 0.12e2 * t3793 * t4290 + 0.12e2 * t3793 * t4294 - 0.3e1 * t2465 * t3954 * t3083 + 0.3e1 * t2456 * t3954 * t4249 + 0.12e2 * t3033 * t4904 + 0.12e2 * t1218 * t985 * t4903 - 0.4e2 * t3087 * t8021 * t3961 + 0.4e2 * t3855 * t8021 * t3968 + 0.13e2 * t3003 * t1231 * t4213 - 0.24e2 * t12829 * t4250 - t9799 * t13846;
  t13856 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t4956 - t13434 - 0.3e1 / 0.8e1 * t6 * t28 * (t13505 + t13560 + t13605 + t13660 + t13699 + t13749 + t13801 + t13848));
  tv4rhosigmatau20 = t13856 * t7 + t4960;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 0] += tv4rhosigmatau20;

  tv4rhosigmatau21 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 1] += tv4rhosigmatau21;

  tv4rhosigmatau22 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 2] += tv4rhosigmatau22;

  tv4rhosigmatau23 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 3] += tv4rhosigmatau23;

  tv4rhosigmatau24 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 4] += tv4rhosigmatau24;

  tv4rhosigmatau25 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 5] += tv4rhosigmatau25;

  tv4rhosigmatau26 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 6] += tv4rhosigmatau26;

  tv4rhosigmatau27 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 7] += tv4rhosigmatau27;

  t13863 = t6 * t284 * t5046 / 0.8e1;
  t13865 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t5046 - t13863);
  tv4rhosigmatau28 = t13865 * t7 + t5050;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 8] += tv4rhosigmatau28;

  t13871 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t4956 - t13434);
  tv4rhosigmatau29 = t13871 * t7 + t4960;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 9] += tv4rhosigmatau29;

  tv4rhosigmatau210 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 10] += tv4rhosigmatau210;

  tv4rhosigmatau211 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 11] += tv4rhosigmatau211;

  tv4rhosigmatau212 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 12] += tv4rhosigmatau212;

  tv4rhosigmatau213 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 13] += tv4rhosigmatau213;

  tv4rhosigmatau214 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 14] += tv4rhosigmatau214;

  tv4rhosigmatau215 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 15] += tv4rhosigmatau215;

  tv4rhosigmatau216 = 0.e0;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 16] += tv4rhosigmatau216;

  t13925 = -0.6e1 * t1198 * t141 * t1612 * t331 + 0.6e1 * t1136 * t1625 * t2195 - 0.6e1 * t1174 * t1625 * t2187 + 0.4e1 * t1317 * t1573 * t880 + 0.4e1 * t1333 * t1560 * t880 + 0.4e1 * t1334 * t1573 * t880 - 0.6e1 * t2187 * t365 * t5018 - 0.6e1 * t2187 * t4418 * t467 + 0.6e1 * t2195 * t343 * t5018 + 0.6e1 * t2195 * t4418 * t452 - 0.3e1 * t343 * t5030 * t846 - 0.3e1 * t343 * t5043 * t846 + 0.2e1 * t365 * t5030 * t880 + 0.2e1 * t365 * t5043 * t880 + 0.4e1 * t4072 * t511 * t880 - 0.3e1 * t4421 * t452 * t846;
  t13960 = t452 * t348 * t170;
  t13973 = 0.2e1 * t880 * t1634 * t1174 - 0.3e1 * t846 * t4437 * t452 - 0.3e1 * t846 * t1634 * t1136 + 0.2e1 * t880 * t4421 * t467 + 0.2e1 * t880 * t4437 * t467 + 0.12e2 * t3297 * t4994 + 0.12e2 * t1292 * t1117 * t4993 + 0.12e2 * t1292 * t332 * t131 * t4072 + 0.12e2 * t2774 * t4380 * t4018 + 0.12e2 * t2774 * t4380 * t2781 - 0.12e2 * t2780 * t4380 * t4026 - 0.24e2 * t13960 * t4406 + 0.48e2 * t4962 * t4410 - 0.12e2 * t3287 * t4976 + 0.12e2 * t10557 * t1617 + 0.12e2 * t4178 * t4415 + 0.12e2 * t4178 * t4394;
  t14003 = 0.1e1 / t115 / t1102;
  t14004 = t14003 * t352;
  t14020 = -0.3e1 * t2774 * t4126 * t3263 + 0.3e1 * t2780 * t4126 * t4347 + 0.2e2 * t4782 - 0.24e2 * t9254 * t4406 + 0.48e2 * t4175 * t4410 + 0.6e1 * t2774 * t2273 * t4971 * t365 - 0.12e2 * t4181 * t4976 - 0.2e2 * t4178 * t4402 - 0.4e1 * t1541 * t4398 + 0.3e1 * t1287 * t5008 * t3238 - 0.3e1 / 0.2e1 * t1292 * t5008 * t3244 + 0.3e1 / 0.2e1 * t501 * t14004 * t4042 - 0.24e2 * t11565 * t4966 - 0.24e2 * t7272 * t4966 - 0.24e2 * t2774 * t866 * t1612 * t1174 + 0.8e2 * t2774 * t866 * t1545 * t467;
  t14058 = t1573 * params->eta;
  t14072 = t510 * t1573;
  t14076 = 0.72e2 * t1287 * t2288 * t4425 - 0.2e2 * t1292 * t332 * t117 * t1573 - 0.8e2 * t4962 * t4377 + 0.13e2 / 0.2e1 * t1292 * t1432 * t510 - 0.8e2 * t4175 * t4377 + 0.36e2 * t1287 * t2273 * t4353 - 0.48e2 * t8355 * t3320 * t4138 + 0.72e2 * t10402 * t3320 * t4142 + 0.8e1 * t10785 * t4341 - 0.6e1 * t3319 * t4034 * t4339 * t343 + 0.6e1 * t4025 * t4034 * t4339 * t365 - 0.3e1 * t3243 * t4041 * t11446 * sigma[2] + 0.8e1 * t3243 * t1305 * t14058 * sigma[2] - 0.32e2 * t11451 * t4354 * t4014 - 0.48e2 * t8355 * t3320 * t4134 - 0.12e2 * t4141 * t4137 * t1333 + 0.12e2 * t2780 * t14072 * t343;
  t14082 = t1633 * t452;
  t14089 = t1633 * t467;
  t14097 = t1624 * t452;
  t14107 = t1624 * t467;
  t14126 = -0.12e2 * t4141 * t14072 * t365 - 0.6e1 * t2774 * t14082 * t343 + 0.6e1 * t2780 * t14082 * t365 + 0.6e1 * t2780 * t14089 * t343 + 0.6e1 * t4178 * t4384 + 0.3e1 / 0.2e1 * t1297 * t5009 + 0.12e2 * t7228 * t14097 * t343 - 0.18e2 * t7235 * t14097 * t365 + 0.12e2 * t2780 * t4130 * t1333 - 0.18e2 * t7235 * t14107 * t343 + 0.24e2 * t10548 * t14107 * t365 - 0.12e2 * t1287 * t4380 * t1136 + 0.6e1 * t3297 * t5001 + 0.6e1 * t1292 * t4380 * t1174 - 0.12e2 * t4175 * t4381 - 0.3e1 / 0.2e1 * t3297 * t4987;
  t14163 = t14003 * t610;
  t14164 = t14163 * sigma[2];
  t14182 = 0.9e1 / 0.2e1 * t4397 - 0.3e1 / 0.4e1 * t14004 * t136 - 0.9e1 / 0.4e1 * t7300 * t4975 - 0.3e1 * t6173 * t14164 + 0.27e2 / 0.2e1 * t4806 - 0.45e2 * t6141 * t5035 * t336 - 0.3e2 * t6225 * t14003 * params->eta * sigma[2] + 0.9e2 * t4812 - 0.9e2 * t6225 * t4975 * t336 - 0.105e3 / 0.2e1 * t6216 * t14164 + 0.135e3 * t4816;
  t14189 = -0.3e1 / 0.2e1 * t1292 * t4126 * t1333 - 0.12e2 * t4181 * t4998 - 0.12e2 * t3287 * t4998 + 0.24e2 * t4961 * t380 * t1613 + 0.24e2 * t13013 * t1613 + 0.24e2 * t10554 * t1613 - 0.6e1 * t4181 * t4972 - 0.6e1 * t3287 * t4972 - 0.6e1 * t1287 * t7300 * t4971 - 0.6e1 * t4141 * t14089 * t365 + 0.24e2 * t1136 * t158 * t170 * t1613 - 0.9e1 * t4833 + 0.4e2 * t4839 - 0.2e2 * t4842 - t349 * t170 * t14182 - t349 * t1198 * t1633 - t349 * t477 * t4436;
  t14211 = t148 * t510 * t136;
  t14234 = -t349 * t380 * t5042 + 0.2e1 * t880 * t1198 * t1624 - 0.24e2 * t10383 * t4982 - 0.24e2 * t10467 * t4982 - 0.24e2 * t4025 * t3320 * t10835 - 0.24e2 * t4025 * t3320 * t10829 + 0.24e2 * t10477 * t4344 - 0.24e2 * t13324 * t4348 - t10436 * t14211 - 0.3e1 * t8388 * t4990 - 0.3e1 * t8391 * t4990 - 0.3e1 * t3243 * t4034 * t11441 + 0.24e2 * t3319 * t3320 * t10822 - 0.24e2 * t4025 * t3320 * t1573 * t365 - 0.8e1 * t11606 * t13388 + 0.4e1 * t11609 * t13392 + 0.32e2 * t4961 * t4351 * t4355;
  t14235 = t6378 * t4351;
  t14251 = t896 * t4971;
  t14258 = t155 * t14003;
  t14289 = 0.48e2 * t14235 * t11593 * t4026 - 0.48e2 * t3319 * t11593 * t467 * t336 + 0.32e2 * t841 * t477 * t135 * t4355 - 0.8e1 * t3237 * t896 * t14003 * t136 + 0.12e2 * t11451 * t14251 * t3244 - 0.24e2 * t3237 * t14251 * t907 - 0.2e2 * t4352 * t14258 * t4042 + 0.24e2 * t10448 * t4979 + 0.24e2 * t8331 * t4979 + 0.24e2 * t8335 * t4979 + 0.24e2 * t3319 * t3320 * t10852 + 0.24e2 * t3319 * t3320 * t10856 + 0.4e2 * t4025 * t8360 * t4137 + 0.13e2 * t3243 * t1305 * t4339 - 0.4e2 * t3319 * t8360 * t4130 + 0.16e2 * t8243 * t11630 * t4009 - 0.16e2 * t10507 * t11630 * t4014;
  t14297 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t5046 - t13863 - 0.3e1 / 0.8e1 * t6 * t112 * (t13925 + t13973 + t14020 + t14076 + t14126 + t14189 + t14234 + t14289));
  tv4rhosigmatau217 = t14297 * t7 + t5050;

  if(out->v4rhosigmatau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigmatau2[ip*p->dim.v4rhosigmatau2 + 17] += tv4rhosigmatau217;

  tv4rholapl30 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 0] += tv4rholapl30;

  tv4rholapl31 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 1] += tv4rholapl31;

  tv4rholapl32 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 2] += tv4rholapl32;

  tv4rholapl33 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 3] += tv4rholapl33;

  tv4rholapl34 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 4] += tv4rholapl34;

  tv4rholapl35 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 5] += tv4rholapl35;

  tv4rholapl36 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 6] += tv4rholapl36;

  tv4rholapl37 = 0.e0;

  if(out->v4rholapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl3[ip*p->dim.v4rholapl3 + 7] += tv4rholapl37;

  tv4rholapl2tau0 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 0] += tv4rholapl2tau0;

  tv4rholapl2tau1 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 1] += tv4rholapl2tau1;

  tv4rholapl2tau2 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 2] += tv4rholapl2tau2;

  tv4rholapl2tau3 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 3] += tv4rholapl2tau3;

  tv4rholapl2tau4 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 4] += tv4rholapl2tau4;

  tv4rholapl2tau5 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 5] += tv4rholapl2tau5;

  tv4rholapl2tau6 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 6] += tv4rholapl2tau6;

  tv4rholapl2tau7 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 7] += tv4rholapl2tau7;

  tv4rholapl2tau8 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 8] += tv4rholapl2tau8;

  tv4rholapl2tau9 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 9] += tv4rholapl2tau9;

  tv4rholapl2tau10 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 10] += tv4rholapl2tau10;

  tv4rholapl2tau11 = 0.e0;

  if(out->v4rholapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapl2tau[ip*p->dim.v4rholapl2tau + 11] += tv4rholapl2tau11;

  tv4rholapltau20 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 0] += tv4rholapltau20;

  tv4rholapltau21 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 1] += tv4rholapltau21;

  tv4rholapltau22 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 2] += tv4rholapltau22;

  tv4rholapltau23 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 3] += tv4rholapltau23;

  tv4rholapltau24 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 4] += tv4rholapltau24;

  tv4rholapltau25 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 5] += tv4rholapltau25;

  tv4rholapltau26 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 6] += tv4rholapltau26;

  tv4rholapltau27 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 7] += tv4rholapltau27;

  tv4rholapltau28 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 8] += tv4rholapltau28;

  tv4rholapltau29 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 9] += tv4rholapltau29;

  tv4rholapltau210 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 10] += tv4rholapltau210;

  tv4rholapltau211 = 0.e0;

  if(out->v4rholapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rholapltau2[ip*p->dim.v4rholapltau2 + 11] += tv4rholapltau211;

  t14304 = t6 * t191 * t5089 / 0.8e1;
  t14336 = 0.1e1 / t37 / t572;
  t14338 = t84 * t96;
  t14344 = 0.18e2 * t1218 * t218 * t4237 * t54 - 0.72e2 * t1259 * t1582 * t2465 * t609 - 0.96e2 * t14336 * t14338 * t5425 * t62 - 0.72e2 * t1806 * t2465 * t251 * t5051 + 0.18e2 * t1218 * t5070 * t985 - 0.36e2 * t2456 * t4249 * t4280 - 0.36e2 * t2456 * t5063 * t985 + 0.36e2 * t2465 * t3083 * t4280 - 0.72e2 * t11085 * t5057 + 0.18e2 * t3033 * t5071 - 0.72e2 * t5057 * t6636 - 0.36e2 * t5064 * t6629;
  t14357 = t493 * t1603;
  t14378 = t1867 * t5051;
  t14379 = t234 * t96;
  t14388 = 0.24e3 * t2465 * t609 * t1497 * t493 + 0.6e2 * t2456 * t218 * t39 * t1594 - 0.3e2 * t1218 * t218 * t39 * t1603 - 0.18e2 * t3972 * t14357 * t251 + 0.72e2 * t3056 * t5060 + 0.72e2 * t1213 * t6577 * t5051 + 0.18e2 * t3033 * t5067 + 0.18e2 * t1218 * t4280 * t1259 + 0.18e2 * t2456 * t14357 * t229 - 0.144e3 * t5358 * t5051 * t14338 * t222 + 0.48e2 * t14378 * t14379 * t251 + 0.72e2 * t3835 * t5060 - 0.6e1 * t1712 * t266 * t5074;
  t14393 = t14336 * t238;
  t14399 = t14336 * params->eta;
  t14410 = t1594 * params->eta;
  t14415 = t1603 * params->eta;
  t14440 = -t235 * t266 * t5086 - t235 * t96 * (0.24e3 * t14399 * t5390 * sigma[0] + 0.36e3 * t222 * t5083 * t5327 + 0.6e1 * t14393 * t62 - 0.3e2 * t4918 - 0.6e3 * t4946) - 0.96e2 * t11240 * t4242 * t4214 - 0.24e2 * t3855 * t1231 * t14410 * sigma[0] + 0.12e2 * t3003 * t1231 * t14415 * sigma[0] - 0.36e3 * t4883 - 0.6e2 * t4898 + 0.2e1 * t624 * t5087 * t251 + 0.6e1 * t624 * t494 * t4237 - 0.3e1 * t589 * t5087 * t229 - 0.18e2 * t1712 * t1595 * t1259 + 0.6e1 * t624 * t1243 * t1603 + 0.6e1 * t624 * t1260 * t1603;
  t14485 = -0.48e2 * t1867 * t5052 * t266 - 0.18e2 * t5568 * t5075 * t229 + 0.24e2 * t5296 * t5075 * t251 + 0.24e3 * t1867 * t4881 * t84 * t96 + 0.108e3 * t9701 * t3088 * t1594 * t251 - 0.72e2 * t3855 * t3088 * t493 * t1259 + 0.12e2 * t10961 * t13846 + 0.36e2 * t3087 * t3088 * t11149 - 0.36e2 * t3855 * t3088 * t1603 * t251 + 0.144e3 * t13758 * t10978 * t4249 - 0.144e3 * t3087 * t10978 * t493 * t222 + 0.96e2 * t2997 * t640 * t14336 * t62 - 0.72e2 * t8016 * t3088 * t11164;
  t14492 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t185 * t5089 - t14304 - 0.3e1 / 0.8e1 * t6 * t28 * (t14344 + t14388 + t14440 + t14485));
  tv4rhotau30 = t14492 * t7 + t5093;

  if(out->v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 0] += tv4rhotau30;

  tv4rhotau31 = 0.e0;

  if(out->v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 1] += tv4rhotau31;

  tv4rhotau32 = 0.e0;

  if(out->v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 2] += tv4rhotau32;

  t14499 = t6 * t284 * t5132 / 0.8e1;
  t14501 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t280 * t5132 - t14499);
  tv4rhotau33 = t14501 * t7 + t5136;

  if(out->v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 3] += tv4rhotau33;

  t14507 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t297 * t5089 - t14304);
  tv4rhotau34 = t14507 * t7 + t5093;

  if(out->v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 4] += tv4rhotau34;

  tv4rhotau35 = 0.e0;

  if(out->v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 5] += tv4rhotau35;

  tv4rhotau36 = 0.e0;

  if(out->v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 6] += tv4rhotau36;

  t14514 = 0.1e1 / t115 / t831;
  t14515 = t14514 * t352;
  t14521 = t14514 * params->eta;
  t14538 = t510 * t1633;
  t14558 = t158 * t170;
  t14562 = -t349 * t170 * (0.24e3 * t14521 * t6225 * sigma[2] + 0.36e3 * t336 * t5126 * t6141 + 0.6e1 * t136 * t14515 - 0.3e2 * t5008 - 0.6e3 * t5036) - 0.6e1 * t2187 * t380 * t5117 - t349 * t380 * t5129 + 0.18e2 * t1292 * t332 * t131 * t4436 + 0.18e2 * t2780 * t14538 * t343 - 0.18e2 * t4141 * t14538 * t365 + 0.72e2 * t4181 * t5103 + 0.72e2 * t3287 * t5103 + 0.72e2 * t1287 * t7300 * t5094 + 0.18e2 * t3297 * t5110 + 0.18e2 * t1292 * t4380 * t1333 - 0.144e3 * t6161 * t5094 * t14558 * t336;
  t14563 = t2312 * t5094;
  t14564 = t348 * t170;
  t14571 = t1624 * params->eta;
  t14576 = t1633 * params->eta;
  t14608 = 0.48e2 * t14563 * t14564 * t365 - 0.96e2 * t11451 * t4354 * t4340 - 0.24e2 * t4025 * t1305 * t14571 * sigma[2] + 0.12e2 * t3243 * t1305 * t14576 * sigma[2] - 0.96e2 * t6188 * t14514 * t14558 * t136 - 0.72e2 * t11565 * t5100 - 0.72e2 * t7272 * t5100 - 0.72e2 * t2774 * t866 * t1612 * t1333 - 0.72e2 * t2774 * t2273 * t5094 * t365 - 0.36e2 * t7239 * t5107 - 0.36e2 * t2780 * t1117 * t5106 + 0.36e2 * t2774 * t4380 * t3263 - 0.36e2 * t2780 * t4380 * t4347;
  t14647 = -0.3e2 * t117 * t1292 * t1633 * t332 + 0.6e2 * t117 * t1624 * t2780 * t332 + 0.24e3 * t1545 * t2774 * t510 * t866 + 0.18e2 * t1117 * t1292 * t5113 + 0.6e1 * t1317 * t1633 * t880 + 0.6e1 * t1334 * t1633 * t880 - 0.48e2 * t2312 * t380 * t5095 - 0.18e2 * t343 * t5118 * t6337 + 0.24e2 * t365 * t5118 * t6323 + 0.2e1 * t365 * t5130 * t880 + 0.18e2 * t3297 * t5114 - 0.36e3 * t4973 - 0.6e2 * t4988;
  t14692 = 0.6e1 * t880 * t511 * t4436 - 0.3e1 * t846 * t5130 * t343 - 0.18e2 * t2187 * t1625 * t1333 + 0.24e3 * t2312 * t4971 * t158 * t170 + 0.12e2 * t11609 * t14211 + 0.36e2 * t3319 * t3320 * t11524 - 0.36e2 * t4025 * t3320 * t1633 * t365 + 0.144e3 * t14235 * t11593 * t4347 - 0.144e3 * t3319 * t11593 * t510 * t336 + 0.96e2 * t3237 * t896 * t14514 * t136 - 0.72e2 * t8355 * t3320 * t11532 + 0.108e3 * t10402 * t3320 * t1624 * t365 - 0.72e2 * t4025 * t3320 * t510 * t1333;
  t14699 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t308 * t5132 - t14499 - 0.3e1 / 0.8e1 * t6 * t112 * (t14562 + t14608 + t14647 + t14692));
  tv4rhotau37 = t14699 * t7 + t5136;

  if(out->v4rhotau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhotau3[ip*p->dim.v4rhotau3 + 7] += tv4rhotau37;

  t14718 = t5343 * t4516;
  t14769 = t1368 * t1368;
  t14773 = t1372 * t1372;
  t14783 = 0.665e3 / 0.2008387814976e13 * t1345 / t36 / t1775 * t5285;
  t14784 = t569 * t4516;
  t14786 = t11661 * t33;
  t14796 = 0.35e2 / 0.516560652e9 * t14784 * t1781 * t14786;
  t14802 = -0.24e2 * t11944 * t421 + 0.18e2 * t217 * t1407 * t1368 + 0.12e2 * t217 * t430 * t4541 - 0.4e1 * t235 * t430 * t4479 - t235 * t96 * (0.9e1 / 0.512e3 * t11120 * params->eta + 0.27e2 / 0.256e3 * t5348 * t11190 + 0.45e2 / 0.256e3 * t5358 * t12379 + 0.45e2 / 0.512e3 * t5425 * t14718 + 0.45e2 / 0.512e3 * t5327 * t10946 + 0.45e2 / 0.64e2 * t1870 * t247 * t4516 * params->eta + 0.945e3 / 0.512e3 * t646 * t659 * t4516 * t610 + 0.63e2 / 0.32e2 * t242 * t1850 * t4516 * t1822 + 0.189e3 / 0.256e3 * t78 * t5341 * t5343 * t4516) + 0.12e2 * t217 * t4520 * t405 + 0.36e2 * t584 * t1407 * t1351 - 0.4e1 * t235 * t4520 * t420 - 0.6e1 * t235 * t1407 * t1396 + 0.3e1 * t217 * t96 * (-0.9e1 / 0.512e3 * t11120 * t610 - 0.3e1 / 0.64e2 * t5348 * t12379 - 0.15e2 / 0.512e3 * t5358 * t14718) + 0.12e2 * t624 * t1407 * t1372 + 0.36e2 * t4693 * t1369 + 0.18e2 * t584 * t96 * t14769 + 0.24e2 * t5296 * t96 * t14773 + 0.24e2 * t4523 * t430 + t14783 + t85 * (-0.35e2 / 0.516560652e9 * t14784 * t1756 * t14786 + 0.133e3 / 0.2066242608e10 * t5241 * t569 * t4516 * t5244 * t34 + t14796 - t14783) - 0.72e2 * t2465 * t3377 * t1368 - t14796;
  t14860 = t1396 * t1396;
  t14864 = 0.72e2 * t2456 * t3377 * t1396 - 0.12e2 * t589 * t4480 * t405 + 0.8e1 * t624 * t4480 * t420 - 0.36e2 * t589 * t4453 * t405 + 0.24e2 * t624 * t1376 * t1396 - 0.36e2 * t589 * t4450 * t405 - 0.36e2 * t1712 * t1373 * t1396 + 0.72e2 * t1694 * t4447 * t405 - 0.12e2 * t589 * t4542 * t420 + 0.36e2 * t1694 * t1369 * t1372 + 0.24e2 * t584 * t406 * t4541 - 0.36e2 * t589 * t4532 * t420 + 0.72e2 * t584 * t1358 * t1368 - 0.72e2 * t1726 * t4526 * t420 - 0.36e2 * t1726 * t1352 * t1396 - 0.18e2 * t589 * t1369 * t1396 + 0.72e2 * t5564 * t1352 * t1372 - 0.72e2 * t5568 * t406 * t4485 - 0.24e2 * t1712 * t430 * t4485 + 0.6e1 * t624 * t96 * t14860;
  t14869 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (t14802 + t14864));
  tv4sigma40 = t7 * t14869;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t14870 = t569 * t4559;
  t14881 = 0.35e2 / 0.516560652e9 * t14870 * t2248 * t14786;
  t14886 = 0.665e3 / 0.2008387814976e13 * t1416 / t114 / t2242 * t6101;
  t14898 = t1443 * t1443;
  t14909 = t5343 * t4559;
  t14946 = t159 * (-0.35e2 / 0.516560652e9 * t14870 * t2225 * t14786 + 0.133e3 / 0.2066242608e10 * t6059 * t569 * t4559 * t5244 * t34 + t14881 - t14886) + 0.24e2 * t4617 * t477 + 0.36e2 * t4825 * t1440 - 0.24e2 * t12025 * t468 - 0.4e1 * t349 * t477 * t4613 + 0.24e2 * t6323 * t170 * t14898 + 0.12e2 * t331 * t477 * t4578 + 0.3e1 * t331 * t170 * (-0.9e1 / 0.512e3 * t11374 * t610 - 0.3e1 / 0.64e2 * t6173 * t13119 - 0.15e2 / 0.512e3 * t6161 * t14909) + 0.12e2 * t880 * t1478 * t1443 - 0.6e1 * t349 * t1478 * t1467 + 0.12e2 * t331 * t4563 * t452 - 0.4e1 * t349 * t4563 * t467 + 0.18e2 * t331 * t1478 * t1439 - 0.24e2 * t2187 * t477 * t4641 + t14886 - 0.72e2 * t6337 * t453 * t4641 - 0.12e2 * t846 * t4614 * t452 + 0.8e1 * t880 * t4614 * t467 + 0.72e2 * t6378 * t1423 * t1443;
  t14986 = t1467 * t1467;
  t14990 = t1439 * t1439;
  t15032 = 0.24e2 * t880 * t1447 * t1467 - 0.36e2 * t846 * t4588 * t452 - 0.12e2 * t846 * t4579 * t467 + 0.72e2 * t2195 * t4582 * t452 + 0.72e2 * t841 * t4568 * t452 - 0.36e2 * t846 * t4568 * t467 + 0.24e2 * t841 * t4579 * t452 - 0.36e2 * t846 * t4565 * t467 - 0.36e2 * t2169 * t1423 * t1467 - 0.18e2 * t846 * t1440 * t1467 - 0.72e2 * t2169 * t4620 * t467 + 0.36e2 * t2195 * t1440 * t1443 - 0.36e2 * t2187 * t1444 * t1467 + 0.6e1 * t880 * t170 * t14986 + 0.18e2 * t841 * t170 * t14990 + 0.36e2 * t841 * t1478 * t1422 + 0.72e2 * t2780 * t3590 * t1467 - 0.72e2 * t2774 * t3590 * t1439 - t14881 - t349 * t170 * (0.9e1 / 0.512e3 * t11374 * params->eta + 0.27e2 / 0.256e3 * t6173 * t11385 + 0.45e2 / 0.256e3 * t6161 * t13119 + 0.45e2 / 0.512e3 * t6188 * t14909 + 0.45e2 / 0.512e3 * t6141 * t11612 + 0.45e2 / 0.64e2 * t2315 * t361 * t4559 * params->eta + 0.945e3 / 0.512e3 * t902 * t915 * t4559 * t610 + 0.63e2 / 0.32e2 * t356 * t2327 * t4559 * t1822 + 0.189e3 / 0.256e3 * t152 * t6167 * t5343 * t4559);
  t15037 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * (t14946 + t15032));
  tv4sigma414 = t7 * t15037;

  if(out->v4sigma4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

  tv4sigma3lapl0 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 0] += tv4sigma3lapl0;

  tv4sigma3lapl1 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 1] += tv4sigma3lapl1;

  tv4sigma3lapl2 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 2] += tv4sigma3lapl2;

  tv4sigma3lapl3 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 3] += tv4sigma3lapl3;

  tv4sigma3lapl4 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 4] += tv4sigma3lapl4;

  tv4sigma3lapl5 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 5] += tv4sigma3lapl5;

  tv4sigma3lapl6 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 6] += tv4sigma3lapl6;

  tv4sigma3lapl7 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 7] += tv4sigma3lapl7;

  tv4sigma3lapl8 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 8] += tv4sigma3lapl8;

  tv4sigma3lapl9 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 9] += tv4sigma3lapl9;

  tv4sigma3lapl10 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 10] += tv4sigma3lapl10;

  tv4sigma3lapl11 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 11] += tv4sigma3lapl11;

  tv4sigma3lapl12 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 12] += tv4sigma3lapl12;

  tv4sigma3lapl13 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 13] += tv4sigma3lapl13;

  tv4sigma3lapl14 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 14] += tv4sigma3lapl14;

  tv4sigma3lapl15 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 15] += tv4sigma3lapl15;

  tv4sigma3lapl16 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 16] += tv4sigma3lapl16;

  tv4sigma3lapl17 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 17] += tv4sigma3lapl17;

  tv4sigma3lapl18 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 18] += tv4sigma3lapl18;

  tv4sigma3lapl19 = 0.e0;

  if(out->v4sigma3lapl != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3lapl[ip*p->dim.v4sigma3lapl + 19] += tv4sigma3lapl19;

  t15047 = t13437 * t1822;
  t15105 = -0.6e1 * t11944 * t494 - 0.3e1 * t235 * t430 * t4727 - t235 * t96 * (-0.27e2 / 0.256e3 * t13438 * params->eta - 0.27e2 / 0.64e2 * t5348 * t13443 - 0.45e2 / 0.128e3 * t5358 * t15047 - 0.45e2 / 0.64e2 * t5327 * t13781 - 0.135e3 / 0.32e2 * t1870 * t247 * t13437 * params->eta - 0.945e3 / 0.128e3 * t646 * t659 * t13437 * t610 - 0.63e2 / 0.16e2 * t242 * t1850 * t13437 * t1822) - t235 * t4520 * t493 - 0.3e1 * t235 * t1407 * t1525 + 0.9e1 / 0.2e1 * t4704 * t1503 - 0.36e2 * t8660 * t4747 - 0.36e2 * t4872 * t4753 - 0.36e2 * t3826 * t4753 - 0.9e1 * t2465 * t3954 * t3377 - 0.9e1 / 0.4e1 * t1213 * t4297 * t3838 + 0.36e2 * t6650 * t218 * t54 * t4485 - 0.12e2 * t1213 * t218 * t54 * t4541 + 0.18e2 * t3793 * t4738 + 0.6e1 * t1218 * t218 * t54 * t4479 - 0.27e2 / 0.16e2 * t1493 * t4743 + 0.9e1 / 0.32e2 * t484 * t5348 * t15047;
  t15156 = 0.9e1 / 0.8e1 * t1218 * t4297 * t3843 - 0.36e2 * t12439 * t1486 + 0.18e2 * t12442 * t1490 + 0.36e2 * t12419 * t1490 + 0.9e1 * t4694 * t1503 - 0.18e2 * t3087 * t3864 * t3377 * params->eta - 0.18e2 * t1712 * t1512 * t1372 - 0.18e2 * t1712 * t1526 * t1372 - 0.18e2 * t1726 * t1512 * t1351 - 0.18e2 * t1726 * t1526 * t1351 + 0.9e1 / 0.2e1 * t4693 * t1499 + 0.6e1 * t624 * t4728 * t420 + 0.6e1 * t624 * t1526 * t1396 + 0.24e2 * t5296 * t494 * t4485 + 0.6e1 * t624 * t1512 * t1396 + 0.12e2 * t624 * t4732 * t420 - 0.9e1 * t589 * t1526 * t1368 - 0.3e1 * t589 * t494 * t4541;
  t15210 = 0.6e1 * t624 * t4730 * t420 - 0.18e2 * t589 * t4732 * t405 - 0.9e1 * t589 * t4728 * t405 - 0.9e1 * t589 * t1512 * t1368 - 0.9e1 * t589 * t4730 * t405 + 0.2e1 * t624 * t494 * t4479 + 0.9e1 / 0.4e1 * t217 * t1407 * t1497 * t67 - 0.72e2 * t8016 * t3088 * t11846 + 0.72e2 * t9780 * t4669 + 0.36e2 * t3087 * t3088 * t11822 + 0.36e2 * t3087 * t3088 * t11807 + 0.18e2 * t10059 * t4672 + 0.9e1 * t2997 * t3864 * t12602 - 0.27e2 / 0.8e1 * t2997 * t12782 * t10020 - 0.36e2 * t3855 * t3088 * t11832 + 0.9e1 * t3855 * t3864 * t12583 - 0.9e1 * t10062 * t4675 - 0.9e1 / 0.2e1 * t3003 * t3864 * t12609;
  t15261 = 0.27e2 / 0.16e2 * t3003 * t12782 * t10036 - 0.18e2 * t2465 * t12681 * t405 + 0.18e2 * t2456 * t12681 * t420 + 0.36e2 * t8660 * t4690 + 0.36e2 * t2456 * t12667 * t405 + 0.18e2 * t2456 * t12671 * t405 - 0.9e1 / 0.8e1 * t1493 * t4707 + 0.9e1 / 0.2e1 * t1213 * t3954 * t1368 - 0.9e1 / 0.4e1 * t1218 * t3954 * t1396 - 0.6e1 * t217 * t4520 * t485 + 0.27e2 / 0.128e3 * t484 * t13438 * t610 - 0.18e2 * t3972 * t12671 * t420 + 0.9e1 * t3826 * t4698 - 0.9e1 / 0.2e1 * t3793 * t4701 + 0.36e2 * t6624 * t12697 * t420 - 0.36e2 * t4693 * t430 * t485 - 0.54e2 * t6650 * t3961 * t1372 + 0.9e1 / 0.2e1 * t2456 * t3954 * t1372;
  t15267 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (t15105 + t15156 + t15210 + t15261));
  tv4sigma3tau0 = t7 * t15267;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 0] += tv4sigma3tau0;

  tv4sigma3tau1 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 1] += tv4sigma3tau1;

  tv4sigma3tau2 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 2] += tv4sigma3tau2;

  tv4sigma3tau3 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 3] += tv4sigma3tau3;

  tv4sigma3tau4 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 4] += tv4sigma3tau4;

  tv4sigma3tau5 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 5] += tv4sigma3tau5;

  tv4sigma3tau6 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 6] += tv4sigma3tau6;

  tv4sigma3tau7 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 7] += tv4sigma3tau7;

  tv4sigma3tau8 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 8] += tv4sigma3tau8;

  tv4sigma3tau9 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 9] += tv4sigma3tau9;

  tv4sigma3tau10 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 10] += tv4sigma3tau10;

  tv4sigma3tau11 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 11] += tv4sigma3tau11;

  tv4sigma3tau12 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 12] += tv4sigma3tau12;

  tv4sigma3tau13 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 13] += tv4sigma3tau13;

  tv4sigma3tau14 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 14] += tv4sigma3tau14;

  tv4sigma3tau15 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 15] += tv4sigma3tau15;

  tv4sigma3tau16 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 16] += tv4sigma3tau16;

  tv4sigma3tau17 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 17] += tv4sigma3tau17;

  tv4sigma3tau18 = 0.e0;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 18] += tv4sigma3tau18;

  t15278 = t14003 * t1822;
  t15338 = -0.3e1 * t349 * t1478 * t1573 - 0.3e1 * t349 * t477 * t4822 - t349 * t170 * (-0.27e2 / 0.256e3 * t14004 * params->eta - 0.27e2 / 0.64e2 * t6173 * t14163 - 0.45e2 / 0.128e3 * t6161 * t15278 - 0.45e2 / 0.64e2 * t6141 * t14258 - 0.135e3 / 0.32e2 * t2315 * t361 * t14003 * params->eta - 0.945e3 / 0.128e3 * t902 * t915 * t14003 * t610 - 0.63e2 / 0.16e2 * t356 * t2327 * t14003 * t1822) - t349 * t4563 * t510 - 0.6e1 * t12025 * t511 - 0.18e2 * t3319 * t4034 * t4013 * t452 - 0.18e2 * t2169 * t1574 * t1422 - 0.18e2 * t2169 * t1560 * t1422 + 0.24e2 * t6323 * t511 * t4641 + 0.9e1 / 0.2e1 * t4825 * t1547 - 0.18e2 * t2187 * t1560 * t1443 - 0.18e2 * t2187 * t1574 * t1443 + 0.6e1 * t880 * t4823 * t467 + 0.12e2 * t880 * t4801 * t467 + 0.6e1 * t880 * t1560 * t1467 - 0.9e1 * t846 * t1574 * t1439 - 0.3e1 * t846 * t511 * t4578;
  t15391 = 0.6e1 * t880 * t4799 * t467 - 0.18e2 * t846 * t4801 * t452 - 0.9e1 * t846 * t1560 * t1439 - 0.9e1 * t846 * t4823 * t452 + 0.9e1 / 0.4e1 * t331 * t1478 * t1545 * t141 - 0.9e1 * t846 * t4799 * t452 + 0.6e1 * t880 * t1574 * t1467 + 0.2e1 * t880 * t511 * t4613 - 0.36e2 * t4025 * t3320 * t12154 + 0.9e1 * t4025 * t4034 * t13184 - 0.72e2 * t8355 * t3320 * t12183 - 0.9e1 * t10785 * t4790 - 0.9e1 / 0.2e1 * t3243 * t4034 * t13153 + 0.27e2 / 0.16e2 * t3243 * t13369 * t10777 + 0.72e2 * t10477 * t4793 + 0.36e2 * t3319 * t3320 * t12176 + 0.36e2 * t3319 * t3320 * t12158 + 0.18e2 * t10782 * t4796;
  t15443 = 0.9e1 * t3237 * t4034 * t13191 - 0.27e2 / 0.8e1 * t3237 * t13369 * t10800 + 0.36e2 * t9271 * t4835 + 0.36e2 * t2780 * t12975 * t467 - 0.9e1 / 0.4e1 * t1292 * t4126 * t1467 - 0.6e1 * t331 * t4563 * t502 + 0.27e2 / 0.128e3 * t501 * t14004 * t610 + 0.9e1 * t4175 * t4838 - 0.9e1 / 0.2e1 * t4178 * t4841 - 0.9e1 / 0.8e1 * t1541 * t4832 + 0.18e2 * t2780 * t12951 * t452 - 0.18e2 * t4141 * t12951 * t467 + 0.9e1 / 0.2e1 * t1287 * t4126 * t1439 - 0.36e2 * t4825 * t477 * t502 - 0.18e2 * t2774 * t12958 * t452 + 0.18e2 * t2780 * t12958 * t467 + 0.36e2 * t7228 * t13001 * t467 - 0.54e2 * t7235 * t4130 * t1443;
  t15491 = 0.9e1 / 0.2e1 * t2780 * t4126 * t1443 + 0.36e2 * t13051 * t1538 + 0.9e1 * t4826 * t1551 + 0.36e2 * t7235 * t332 * t131 * t4641 - 0.9e1 / 0.4e1 * t1287 * t4397 * t4008 + 0.9e1 / 0.32e2 * t501 * t6173 * t15278 - 0.36e2 * t4962 * t4852 - 0.9e1 * t2774 * t4126 * t3590 + 0.9e1 / 0.2e1 * t4829 * t1551 - 0.36e2 * t9271 * t4862 - 0.27e2 / 0.16e2 * t1541 * t4846 + 0.18e2 * t4178 * t4858 + 0.6e1 * t1292 * t332 * t131 * t4613 + 0.9e1 / 0.8e1 * t1292 * t4397 * t4013 - 0.36e2 * t13064 * t1534 + 0.18e2 * t13067 * t1538 - 0.12e2 * t1287 * t332 * t131 * t4578 - 0.36e2 * t4175 * t4852;
  t15497 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * (t15338 + t15391 + t15443 + t15491));
  tv4sigma3tau19 = t7 * t15497;

  if(out->v4sigma3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma3tau[ip*p->dim.v4sigma3tau + 19] += tv4sigma3tau19;

  tv4sigma2lapl20 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 0] += tv4sigma2lapl20;

  tv4sigma2lapl21 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 1] += tv4sigma2lapl21;

  tv4sigma2lapl22 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 2] += tv4sigma2lapl22;

  tv4sigma2lapl23 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 3] += tv4sigma2lapl23;

  tv4sigma2lapl24 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 4] += tv4sigma2lapl24;

  tv4sigma2lapl25 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 5] += tv4sigma2lapl25;

  tv4sigma2lapl26 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 6] += tv4sigma2lapl26;

  tv4sigma2lapl27 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 7] += tv4sigma2lapl27;

  tv4sigma2lapl28 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 8] += tv4sigma2lapl28;

  tv4sigma2lapl29 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 9] += tv4sigma2lapl29;

  tv4sigma2lapl210 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 10] += tv4sigma2lapl210;

  tv4sigma2lapl211 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 11] += tv4sigma2lapl211;

  tv4sigma2lapl212 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 12] += tv4sigma2lapl212;

  tv4sigma2lapl213 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 13] += tv4sigma2lapl213;

  tv4sigma2lapl214 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 14] += tv4sigma2lapl214;

  tv4sigma2lapl215 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 15] += tv4sigma2lapl215;

  tv4sigma2lapl216 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 16] += tv4sigma2lapl216;

  tv4sigma2lapl217 = 0.e0;

  if(out->v4sigma2lapl2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapl2[ip*p->dim.v4sigma2lapl2 + 17] += tv4sigma2lapl217;

  tv4sigma2lapltau0 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 0] += tv4sigma2lapltau0;

  tv4sigma2lapltau1 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 1] += tv4sigma2lapltau1;

  tv4sigma2lapltau2 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 2] += tv4sigma2lapltau2;

  tv4sigma2lapltau3 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 3] += tv4sigma2lapltau3;

  tv4sigma2lapltau4 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 4] += tv4sigma2lapltau4;

  tv4sigma2lapltau5 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 5] += tv4sigma2lapltau5;

  tv4sigma2lapltau6 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 6] += tv4sigma2lapltau6;

  tv4sigma2lapltau7 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 7] += tv4sigma2lapltau7;

  tv4sigma2lapltau8 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 8] += tv4sigma2lapltau8;

  tv4sigma2lapltau9 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 9] += tv4sigma2lapltau9;

  tv4sigma2lapltau10 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 10] += tv4sigma2lapltau10;

  tv4sigma2lapltau11 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 11] += tv4sigma2lapltau11;

  tv4sigma2lapltau12 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 12] += tv4sigma2lapltau12;

  tv4sigma2lapltau13 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 13] += tv4sigma2lapltau13;

  tv4sigma2lapltau14 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 14] += tv4sigma2lapltau14;

  tv4sigma2lapltau15 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 15] += tv4sigma2lapltau15;

  tv4sigma2lapltau16 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 16] += tv4sigma2lapltau16;

  tv4sigma2lapltau17 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 17] += tv4sigma2lapltau17;

  tv4sigma2lapltau18 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 18] += tv4sigma2lapltau18;

  tv4sigma2lapltau19 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 19] += tv4sigma2lapltau19;

  tv4sigma2lapltau20 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 20] += tv4sigma2lapltau20;

  tv4sigma2lapltau21 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 21] += tv4sigma2lapltau21;

  tv4sigma2lapltau22 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 22] += tv4sigma2lapltau22;

  tv4sigma2lapltau23 = 0.e0;

  if(out->v4sigma2lapltau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2lapltau[ip*p->dim.v4sigma2lapltau + 23] += tv4sigma2lapltau23;

  t15552 = -0.6e1 * t1407 * t1582 * t217 * t67 + 0.12e2 * t1351 * t1595 * t5564 - 0.6e1 * t1351 * t1604 * t1726 + 0.6e1 * t1368 * t1595 * t1694 - 0.3e1 * t1368 * t1604 * t589 + 0.24e2 * t1372 * t1595 * t5296 - 0.6e1 * t1372 * t1604 * t1712 - 0.6e1 * t1396 * t1595 * t1712 + 0.2e1 * t1396 * t1604 * t624 + 0.8e1 * t1512 * t1525 * t624 + 0.12e2 * t1694 * t405 * t4928 - 0.12e2 * t1712 * t420 * t4928 - 0.6e1 * t405 * t4940 * t589 - 0.6e1 * t405 * t4953 * t589 + 0.4e1 * t420 * t4940 * t624 + 0.4e1 * t420 * t4953 * t624 + 0.4e1 * t4727 * t494 * t624 - 0.12e2 * t1591 * t4693;
  t15608 = 0.3e1 / 0.4e1 * t584 * t96 * t14336 * t238 - 0.96e2 * t8016 * t3088 * t4690 - 0.12e2 * t3087 * t3864 * t3961 * params->eta + 0.12e2 * t3855 * t3864 * t3968 * params->eta + 0.24e2 * t11240 * t13774 * t3843 + 0.48e2 * t9780 * t4889 + 0.48e2 * t3087 * t3088 * t12727 + 0.24e2 * t3087 * t3088 * t12681 - 0.48e2 * t12829 * t4892 - 0.48e2 * t3855 * t3088 * t12667 - 0.24e2 * t3855 * t3088 * t12671 - 0.6e1 * t10062 * t4900 - 0.6e1 * t3003 * t3864 * t13552 + 0.9e1 / 0.8e1 * t3003 * t12782 * t11235 + 0.72e2 * t9701 * t3088 * t12743 - 0.12e2 * t3826 * t4882 - 0.3e1 * t3793 * t4897 - 0.3e1 * t1218 * t3954 * t1525 + 0.48e2 * t4871 * t430 * t1583;
  t15659 = t14336 * t610;
  t15679 = -0.12e2 * t4872 * t4882 + 0.24e2 * t12439 * t1583 + 0.12e2 * t2456 * t13618 * t420 + 0.24e2 * t1368 * t84 * t96 * t1583 + 0.6e1 * t1218 * t4280 * t1396 + 0.3e1 * t1493 * t4919 - 0.9e1 / 0.16e2 * t484 * t14393 * t610 - 0.36e2 * t6650 * t13647 * t420 + 0.24e2 * t2456 * t3961 * t1525 - 0.24e2 * t3972 * t3968 * t1525 - 0.24e2 * t3826 * t4908 - 0.12e2 * t1213 * t4280 * t1368 + 0.12e2 * t3793 * t4911 - 0.12e2 * t2456 * t4280 * t1372 + 0.48e2 * t6624 * t609 * t1582 * t1372 + 0.24e2 * t12419 * t1587 - 0.2e1 * t235 * t430 * t4952 - t235 * t96 * (0.9e1 / 0.16e2 * t14393 * params->eta + 0.9e1 / 0.8e1 * t5348 * t15659 + 0.45e2 / 0.8e1 * t5327 * t81 * t14336 + 0.45e2 / 0.2e1 * t1870 * t247 * t14336 * params->eta + 0.315e3 / 0.16e2 * t646 * t659 * t14336 * t610) + 0.2e1 * t624 * t1407 * t1594;
  t15730 = t1525 * t1525;
  t15734 = -t235 * t1407 * t1603 + 0.12e2 * t1218 * t218 * t54 * t4727 + 0.24e2 * t2465 * t4280 * t3377 - 0.48e2 * t13726 * t4876 - 0.24e2 * t4872 * t4886 - 0.48e2 * t8642 * t4876 - 0.24e2 * t2465 * t609 * t1582 * t1396 + 0.12e2 * t2465 * t1806 * t4881 * t420 - 0.3e1 * t1218 * t4918 * t3843 - 0.24e2 * t3826 * t4886 + 0.6e1 * t1213 * t5348 * t14399 + 0.15e2 / 0.2e1 * t1213 * t5358 * t15659 - 0.6e1 * t2465 * t3954 * t3961 + 0.6e1 * t2456 * t3954 * t3968 + 0.12e2 * t12442 * t1587 + 0.24e2 * t3793 * t4904 + 0.3e1 / 0.4e1 * t1218 * t4297 * t4213 + 0.6e1 * t1213 * t4918 * t3838 + 0.4e1 * t624 * t96 * t15730;
  t15740 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (t15552 + t15608 + t15679 + t15734));
  tv4sigma2tau20 = t7 * t15740;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 0] += tv4sigma2tau20;

  tv4sigma2tau21 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 1] += tv4sigma2tau21;

  tv4sigma2tau22 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 2] += tv4sigma2tau22;

  tv4sigma2tau23 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 3] += tv4sigma2tau23;

  tv4sigma2tau24 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 4] += tv4sigma2tau24;

  tv4sigma2tau25 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 5] += tv4sigma2tau25;

  tv4sigma2tau26 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 6] += tv4sigma2tau26;

  tv4sigma2tau27 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 7] += tv4sigma2tau27;

  tv4sigma2tau28 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 8] += tv4sigma2tau28;

  tv4sigma2tau29 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 9] += tv4sigma2tau29;

  tv4sigma2tau210 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 10] += tv4sigma2tau210;

  tv4sigma2tau211 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 11] += tv4sigma2tau211;

  tv4sigma2tau212 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 12] += tv4sigma2tau212;

  tv4sigma2tau213 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 13] += tv4sigma2tau213;

  tv4sigma2tau214 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 14] += tv4sigma2tau214;

  tv4sigma2tau215 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 15] += tv4sigma2tau215;

  tv4sigma2tau216 = 0.e0;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 16] += tv4sigma2tau216;

  t15796 = -0.6e1 * t2187 * t1625 * t1467 + 0.8e1 * t880 * t1560 * t1573 + 0.4e1 * t880 * t511 * t4822 + 0.3e1 / 0.4e1 * t841 * t170 * t14514 * t352 - 0.6e1 * t331 * t1478 * t1612 * t141 + 0.12e2 * t2195 * t5018 * t452 + 0.6e1 * t2195 * t1625 * t1439 - 0.12e2 * t2187 * t5018 * t467 - 0.96e2 * t8355 * t3320 * t4835 - 0.12e2 * t3319 * t4034 * t4130 * params->eta + 0.12e2 * t4025 * t4034 * t4137 * params->eta - 0.12e2 * t2780 * t4380 * t1443 + 0.3e1 * t1541 * t5009 - 0.24e2 * t4175 * t4998 - 0.12e2 * t1287 * t4380 * t1439 + 0.12e2 * t4178 * t5001 + 0.6e1 * t1292 * t4380 * t1467 - 0.3e1 * t1292 * t4126 * t1573;
  t15848 = 0.24e2 * t1439 * t158 * t170 * t1613 + 0.48e2 * t4961 * t477 * t1613 - 0.12e2 * t4962 * t4972 + 0.24e2 * t13064 * t1613 - 0.12e2 * t4175 * t4972 - 0.3e1 * t4178 * t4987 + 0.24e2 * t2780 * t4130 * t1573 - 0.24e2 * t4141 * t4137 * t1573 + 0.12e2 * t2780 * t14082 * t467 - 0.9e1 / 0.16e2 * t501 * t14515 * t610 - 0.36e2 * t7235 * t14097 * t467 + 0.24e2 * t11451 * t14251 * t4013 + 0.48e2 * t10477 * t4979 + 0.48e2 * t3319 * t3320 * t12975 + 0.24e2 * t3319 * t3320 * t12958 - 0.48e2 * t13324 * t4982 - 0.48e2 * t4025 * t3320 * t12947 - 0.24e2 * t4025 * t3320 * t12951 - 0.6e1 * t10785 * t4990;
  t15866 = t14514 * t610;
  t15921 = -0.6e1 * t3243 * t4034 * t14058 + 0.9e1 / 0.8e1 * t3243 * t13369 * t11446 + 0.72e2 * t10402 * t3320 * t12932 - t349 * t1478 * t1633 - 0.2e1 * t349 * t477 * t5042 - t349 * t170 * (0.9e1 / 0.16e2 * t14515 * params->eta + 0.9e1 / 0.8e1 * t6173 * t15866 + 0.45e2 / 0.8e1 * t6141 * t155 * t14514 + 0.45e2 / 0.2e1 * t2315 * t361 * t14514 * params->eta + 0.315e3 / 0.16e2 * t902 * t915 * t14514 * t610) + 0.2e1 * t880 * t1478 * t1624 + 0.48e2 * t7228 * t866 * t1612 * t1443 + 0.24e2 * t13051 * t1617 - 0.3e1 * t1292 * t5008 * t4013 + 0.6e1 * t1287 * t6173 * t14521 + 0.15e2 / 0.2e1 * t1287 * t6161 * t15866 - 0.6e1 * t2774 * t4126 * t4130 + 0.6e1 * t2780 * t4126 * t4137 + 0.12e2 * t13067 * t1617 + 0.24e2 * t4178 * t4994 + 0.3e1 / 0.4e1 * t1292 * t4397 * t4339 + 0.12e2 * t1292 * t332 * t131 * t4822 + 0.24e2 * t2774 * t4380 * t3590;
  t15941 = t1573 * t1573;
  t15977 = 0.6e1 * t1287 * t5008 * t4008 + 0.12e2 * t2774 * t2273 * t4971 * t467 - 0.24e2 * t4175 * t4976 - 0.48e2 * t13960 * t4966 - 0.24e2 * t4962 * t4976 - 0.48e2 * t9254 * t4966 - 0.24e2 * t2774 * t866 * t1612 * t1467 + 0.4e1 * t880 * t170 * t15941 - 0.12e2 * t4825 * t1621 - 0.6e1 * t2187 * t1634 * t1443 + 0.24e2 * t6323 * t1625 * t1443 - 0.6e1 * t2169 * t1634 * t1422 + 0.12e2 * t6378 * t1625 * t1422 - 0.6e1 * t846 * t5030 * t452 - 0.6e1 * t846 * t5043 * t452 - 0.3e1 * t846 * t1634 * t1439 + 0.4e1 * t880 * t5030 * t467 + 0.4e1 * t880 * t5043 * t467 + 0.2e1 * t880 * t1634 * t1467;
  t15983 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * (t15796 + t15848 + t15921 + t15977));
  tv4sigma2tau217 = t7 * t15983;

  if(out->v4sigma2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma2tau2[ip*p->dim.v4sigma2tau2 + 17] += tv4sigma2tau217;

  tv4sigmalapl30 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 0] += tv4sigmalapl30;

  tv4sigmalapl31 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 1] += tv4sigmalapl31;

  tv4sigmalapl32 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 2] += tv4sigmalapl32;

  tv4sigmalapl33 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 3] += tv4sigmalapl33;

  tv4sigmalapl34 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 4] += tv4sigmalapl34;

  tv4sigmalapl35 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 5] += tv4sigmalapl35;

  tv4sigmalapl36 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 6] += tv4sigmalapl36;

  tv4sigmalapl37 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 7] += tv4sigmalapl37;

  tv4sigmalapl38 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 8] += tv4sigmalapl38;

  tv4sigmalapl39 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 9] += tv4sigmalapl39;

  tv4sigmalapl310 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 10] += tv4sigmalapl310;

  tv4sigmalapl311 = 0.e0;

  if(out->v4sigmalapl3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl3[ip*p->dim.v4sigmalapl3 + 11] += tv4sigmalapl311;

  tv4sigmalapl2tau0 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 0] += tv4sigmalapl2tau0;

  tv4sigmalapl2tau1 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 1] += tv4sigmalapl2tau1;

  tv4sigmalapl2tau2 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 2] += tv4sigmalapl2tau2;

  tv4sigmalapl2tau3 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 3] += tv4sigmalapl2tau3;

  tv4sigmalapl2tau4 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 4] += tv4sigmalapl2tau4;

  tv4sigmalapl2tau5 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 5] += tv4sigmalapl2tau5;

  tv4sigmalapl2tau6 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 6] += tv4sigmalapl2tau6;

  tv4sigmalapl2tau7 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 7] += tv4sigmalapl2tau7;

  tv4sigmalapl2tau8 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 8] += tv4sigmalapl2tau8;

  tv4sigmalapl2tau9 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 9] += tv4sigmalapl2tau9;

  tv4sigmalapl2tau10 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 10] += tv4sigmalapl2tau10;

  tv4sigmalapl2tau11 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 11] += tv4sigmalapl2tau11;

  tv4sigmalapl2tau12 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 12] += tv4sigmalapl2tau12;

  tv4sigmalapl2tau13 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 13] += tv4sigmalapl2tau13;

  tv4sigmalapl2tau14 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 14] += tv4sigmalapl2tau14;

  tv4sigmalapl2tau15 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 15] += tv4sigmalapl2tau15;

  tv4sigmalapl2tau16 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 16] += tv4sigmalapl2tau16;

  tv4sigmalapl2tau17 = 0.e0;

  if(out->v4sigmalapl2tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapl2tau[ip*p->dim.v4sigmalapl2tau + 17] += tv4sigmalapl2tau17;

  tv4sigmalapltau20 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 0] += tv4sigmalapltau20;

  tv4sigmalapltau21 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 1] += tv4sigmalapltau21;

  tv4sigmalapltau22 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 2] += tv4sigmalapltau22;

  tv4sigmalapltau23 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 3] += tv4sigmalapltau23;

  tv4sigmalapltau24 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 4] += tv4sigmalapltau24;

  tv4sigmalapltau25 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 5] += tv4sigmalapltau25;

  tv4sigmalapltau26 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 6] += tv4sigmalapltau26;

  tv4sigmalapltau27 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 7] += tv4sigmalapltau27;

  tv4sigmalapltau28 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 8] += tv4sigmalapltau28;

  tv4sigmalapltau29 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 9] += tv4sigmalapltau29;

  tv4sigmalapltau210 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 10] += tv4sigmalapltau210;

  tv4sigmalapltau211 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 11] += tv4sigmalapltau211;

  tv4sigmalapltau212 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 12] += tv4sigmalapltau212;

  tv4sigmalapltau213 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 13] += tv4sigmalapltau213;

  tv4sigmalapltau214 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 14] += tv4sigmalapltau214;

  tv4sigmalapltau215 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 15] += tv4sigmalapltau215;

  tv4sigmalapltau216 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 16] += tv4sigmalapltau216;

  tv4sigmalapltau217 = 0.e0;

  if(out->v4sigmalapltau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmalapltau2[ip*p->dim.v4sigmalapltau2 + 17] += tv4sigmalapltau217;

  t16002 = 0.1e1 / t37 / t561;
  t16016 = 0.18e2 * t3793 * t5067 + 0.18e2 * t1218 * t4280 * t1525 - 0.9e1 / 0.4e1 * t1218 * t3954 * t1603 + 0.18e2 * t2456 * t14357 * t405 - 0.18e2 * t3972 * t14357 * t420 + 0.48e2 * t14378 * t14379 * t420 + 0.36e2 * t5425 * t16002 * t14338 * params->eta + 0.72e2 * t4872 * t5060 + 0.72e2 * t3826 * t5060 + 0.9e1 / 0.2e1 * t2456 * t3954 * t1594 - t235 * t430 * t5086;
  t16060 = -t235 * t96 * (-0.9e1 / 0.4e1 * t16002 * t238 * params->eta - 0.45e2 * t5327 * t81 * t16002 - 0.9e2 * t1870 * t247 * t16002 * params->eta) - 0.6e1 * t1712 * t430 * t5074 - 0.72e2 * t3855 * t3088 * t13611 + 0.9e1 * t3855 * t3864 * t14410 + 0.36e2 * t3087 * t3088 * t13618 - 0.36e2 * t3855 * t3088 * t13625 - 0.9e1 / 0.2e1 * t3003 * t3864 * t14415 + 0.144e3 * t13758 * t10978 * t3968 + 0.36e2 * t11240 * t13774 * t4213 - 0.72e2 * t8016 * t3088 * t13647 + 0.108e3 * t9701 * t3088 * t13635;
  t16096 = -0.36e2 * t2456 * t4280 * t3968 - 0.9e1 / 0.2e1 * t1218 * t4918 * t4213 + 0.18e2 * t3793 * t5071 + 0.18e2 * t1218 * t218 * t54 * t4952 - 0.72e2 * t13726 * t5057 - 0.72e2 * t8642 * t5057 - 0.72e2 * t2465 * t609 * t1582 * t1525 + 0.18e2 * t2465 * t1806 * t4881 * t493 - 0.72e2 * t2465 * t1806 * t5051 * t420 - 0.36e2 * t1213 * t5348 * t16002 * params->eta - 0.36e2 * t8660 * t5064;
  t16135 = -0.9e1 * t16002 * t238 * t584 * t96 + 0.18e2 * t16002 * t5358 * t84 * t96 + 0.6e1 * t1512 * t1603 * t624 - 0.18e2 * t1525 * t1595 * t1712 + 0.6e1 * t1526 * t1603 * t624 - 0.48e2 * t1867 * t430 * t5052 + 0.36e2 * t2465 * t3961 * t4280 - 0.18e2 * t405 * t5075 * t5568 - 0.3e1 * t405 * t5087 * t589 + 0.24e2 * t420 * t5075 * t5296 + 0.2e1 * t420 * t5087 * t624 + 0.6e1 * t494 * t4952 * t624;
  t16141 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * (t16016 + t16060 + t16096 + t16135));
  tv4sigmatau30 = t7 * t16141;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 0] += tv4sigmatau30;

  tv4sigmatau31 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 1] += tv4sigmatau31;

  tv4sigmatau32 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 2] += tv4sigmatau32;

  tv4sigmatau33 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 3] += tv4sigmatau33;

  tv4sigmatau34 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 4] += tv4sigmatau34;

  tv4sigmatau35 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 5] += tv4sigmatau35;

  tv4sigmatau36 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 6] += tv4sigmatau36;

  tv4sigmatau37 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 7] += tv4sigmatau37;

  tv4sigmatau38 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 8] += tv4sigmatau38;

  tv4sigmatau39 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 9] += tv4sigmatau39;

  tv4sigmatau310 = 0.e0;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 10] += tv4sigmatau310;

  t16143 = 0.1e1 / t115 / t822;
  t16185 = -t349 * t170 * (-0.9e1 / 0.4e1 * t16143 * t352 * params->eta - 0.45e2 * t6141 * t155 * t16143 - 0.9e2 * t2315 * t361 * t16143 * params->eta) + 0.18e2 * t1292 * t4380 * t1573 - 0.9e1 / 0.4e1 * t1292 * t4126 * t1633 + 0.18e2 * t2780 * t14538 * t452 - 0.18e2 * t4141 * t14538 * t467 + 0.48e2 * t14563 * t14564 * t467 + 0.36e2 * t6188 * t16143 * t14558 * params->eta + 0.72e2 * t4962 * t5103 + 0.72e2 * t4175 * t5103 + 0.9e1 / 0.2e1 * t2780 * t4126 * t1624 + 0.18e2 * t4178 * t5110;
  t16218 = -0.6e1 * t2187 * t477 * t5117 - t349 * t477 * t5129 + 0.144e3 * t14235 * t11593 * t4137 + 0.36e2 * t11451 * t14251 * t4339 - 0.72e2 * t8355 * t3320 * t14097 + 0.108e3 * t10402 * t3320 * t14107 - 0.72e2 * t4025 * t3320 * t14072 + 0.9e1 * t4025 * t4034 * t14571 + 0.36e2 * t3319 * t3320 * t14082 - 0.36e2 * t4025 * t3320 * t14089 - 0.9e1 / 0.2e1 * t3243 * t4034 * t14576;
  t16253 = -0.36e2 * t1287 * t6173 * t16143 * params->eta - 0.36e2 * t9271 * t5107 + 0.36e2 * t2774 * t4380 * t4130 - 0.36e2 * t2780 * t4380 * t4137 - 0.9e1 / 0.2e1 * t1292 * t5008 * t4339 + 0.18e2 * t4178 * t5114 + 0.18e2 * t1292 * t332 * t131 * t5042 - 0.72e2 * t13960 * t5100 - 0.72e2 * t9254 * t5100 - 0.72e2 * t2774 * t866 * t1612 * t1573 + 0.18e2 * t2774 * t2273 * t4971 * t510;
  t16293 = 0.18e2 * t158 * t16143 * t170 * t6161 - 0.9e1 * t16143 * t170 * t352 * t841 - 0.72e2 * t2273 * t2774 * t467 * t5094 + 0.6e1 * t1560 * t1633 * t880 - 0.18e2 * t1573 * t1625 * t2187 + 0.6e1 * t1574 * t1633 * t880 - 0.48e2 * t2312 * t477 * t5095 - 0.18e2 * t452 * t5118 * t6337 - 0.3e1 * t452 * t5130 * t846 + 0.24e2 * t467 * t5118 * t6323 + 0.2e1 * t467 * t5130 * t880 + 0.6e1 * t5042 * t511 * t880;
  t16299 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * (t16185 + t16218 + t16253 + t16293));
  tv4sigmatau311 = t7 * t16299;

  if(out->v4sigmatau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigmatau3[ip*p->dim.v4sigmatau3 + 11] += tv4sigmatau311;

  tv4lapl40 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 0] += tv4lapl40;

  tv4lapl41 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 1] += tv4lapl41;

  tv4lapl42 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 2] += tv4lapl42;

  tv4lapl43 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 3] += tv4lapl43;

  tv4lapl44 = 0.e0;

  if(out->v4lapl4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl4[ip*p->dim.v4lapl4 + 4] += tv4lapl44;

  tv4lapl3tau0 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 0] += tv4lapl3tau0;

  tv4lapl3tau1 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 1] += tv4lapl3tau1;

  tv4lapl3tau2 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 2] += tv4lapl3tau2;

  tv4lapl3tau3 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 3] += tv4lapl3tau3;

  tv4lapl3tau4 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 4] += tv4lapl3tau4;

  tv4lapl3tau5 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 5] += tv4lapl3tau5;

  tv4lapl3tau6 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 6] += tv4lapl3tau6;

  tv4lapl3tau7 = 0.e0;

  if(out->v4lapl3tau != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl3tau[ip*p->dim.v4lapl3tau + 7] += tv4lapl3tau7;

  tv4lapl2tau20 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 0] += tv4lapl2tau20;

  tv4lapl2tau21 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 1] += tv4lapl2tau21;

  tv4lapl2tau22 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 2] += tv4lapl2tau22;

  tv4lapl2tau23 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 3] += tv4lapl2tau23;

  tv4lapl2tau24 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 4] += tv4lapl2tau24;

  tv4lapl2tau25 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 5] += tv4lapl2tau25;

  tv4lapl2tau26 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 6] += tv4lapl2tau26;

  tv4lapl2tau27 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 7] += tv4lapl2tau27;

  tv4lapl2tau28 = 0.e0;

  if(out->v4lapl2tau2 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapl2tau2[ip*p->dim.v4lapl2tau2 + 8] += tv4lapl2tau28;

  tv4lapltau30 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 0] += tv4lapltau30;

  tv4lapltau31 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 1] += tv4lapltau31;

  tv4lapltau32 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 2] += tv4lapltau32;

  tv4lapltau33 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 3] += tv4lapltau33;

  tv4lapltau34 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 4] += tv4lapltau34;

  tv4lapltau35 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 5] += tv4lapltau35;

  tv4lapltau36 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 6] += tv4lapltau36;

  tv4lapltau37 = 0.e0;

  if(out->v4lapltau3 != NULL && (p->info->flags & XC_FLAGS_NEEDS_LAPLACIAN) && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4lapltau3[ip*p->dim.v4lapltau3 + 7] += tv4lapltau37;

  t16314 = t1594 * t1594;
  t16321 = t1603 * t1603;
  t16359 = -0.288e3 * t5358 * t5214 * t84 * t96 + 0.192e3 * t14378 * t14379 * t493 + 0.72e2 * t584 * t96 * t5214 * t238 + 0.36e2 * t1218 * t4280 * t1603 + 0.24e2 * t5296 * t96 * t16314 - 0.36e2 * t1712 * t1595 * t1603 + 0.6e1 * t624 * t96 * t16321 + 0.8e1 * t624 * t494 * t5086 + 0.288e3 * t6624 * t609 * t1582 * t1594 - 0.288e3 * t2465 * t1806 * t5051 * t493 + 0.144e3 * t6650 * t218 * t54 * t5074 - 0.144e3 * t3855 * t3088 * t14357 - 0.72e2 * t2456 * t4280 * t1594 + 0.24e2 * t1218 * t218 * t54 * t5086 - 0.36e3 * t235 * t96 * t5327 * t81 * t5214 - 0.144e3 * t2465 * t609 * t1582 * t1603;
  t16363 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t16359);
  tv4tau40 = t7 * t16363;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 0] += tv4tau40;

  tv4tau41 = 0.e0;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 1] += tv4tau41;

  tv4tau42 = 0.e0;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 2] += tv4tau42;

  tv4tau43 = 0.e0;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 3] += tv4tau43;

  t16378 = t1624 * t1624;
  t16385 = t1633 * t1633;
  t16423 = -0.288e3 * t6161 * t6032 * t158 * t170 + 0.192e3 * t14563 * t14564 * t510 + 0.72e2 * t841 * t170 * t6032 * t352 + 0.36e2 * t1292 * t4380 * t1633 + 0.24e2 * t6323 * t170 * t16378 - 0.36e2 * t2187 * t1625 * t1633 + 0.6e1 * t880 * t170 * t16385 + 0.8e1 * t880 * t511 * t5129 + 0.288e3 * t7228 * t866 * t1612 * t1624 - 0.288e3 * t2774 * t2273 * t5094 * t510 + 0.144e3 * t7235 * t332 * t131 * t5117 - 0.144e3 * t4025 * t3320 * t14538 + 0.24e2 * t1292 * t332 * t131 * t5129 - 0.36e3 * t349 * t170 * t6141 * t155 * t6032 - 0.144e3 * t2774 * t866 * t1612 * t1633 - 0.72e2 * t2780 * t4380 * t1624;
  t16427 = my_piecewise3(t103, 0, -0.3e1 / 0.8e1 * t6 * t112 * t16423);
  tv4tau44 = t7 * t16427;

  if(out->v4tau4 != NULL && (p->info->flags & XC_FLAGS_NEEDS_TAU) && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4tau4[ip*p->dim.v4tau4 + 4] += tv4tau44;

}

#endif

